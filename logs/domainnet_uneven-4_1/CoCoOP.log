===2023-04-12 15:25:36===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,18,37,56,75,59,32,38,35,]
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.1236 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1860 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.1257 | Train Acc: 0.3467
 Site-Clipart   | Train Loss: 2.1133 | Train Acc: 0.3000
 Site-Infograph | Train Loss: 2.2522 | Train Acc: 0.1111
 Site-Infograph | Train Loss: 2.2869 | Train Acc: 0.1351
 Site-Infograph | Train Loss: 2.2599 | Train Acc: 0.2143
 Site-Infograph | Train Loss: 2.1794 | Train Acc: 0.2533
 Site-Painting  | Train Loss: 2.1933 | Train Acc: 0.2203
 Site-QuickDraw | Train Loss: 2.3629 | Train Acc: 0.0938
 Site-Real      | Train Loss: 2.2059 | Train Acc: 0.1579
 Site-Sketch    | Train Loss: 2.1674 | Train Acc: 0.2000
============ Train epoch 2 ============
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 2.0631 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.0018 | Train Acc: 0.3400
 Site-Clipart   | Train Loss: 1.9556 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.9610 | Train Acc: 0.4400
 Site-Infograph | Train Loss: 2.2641 | Train Acc: 0.1111
 Site-Infograph | Train Loss: 2.2471 | Train Acc: 0.1351
 Site-Infograph | Train Loss: 2.1787 | Train Acc: 0.2321
 Site-Infograph | Train Loss: 2.1576 | Train Acc: 0.3067
 Site-Painting  | Train Loss: 2.1322 | Train Acc: 0.3220
 Site-QuickDraw | Train Loss: 2.3546 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.0837 | Train Acc: 0.3421
 Site-Sketch    | Train Loss: 1.9907 | Train Acc: 0.3714
 Site-Clipart   | Val  Loss: 1.8794 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 1.9977 | Val  Acc: 0.4242
 Site-Clipart   | Val  Loss: 1.9683 | Val  Acc: 0.4400
 Site-Clipart   | Val  Loss: 1.9666 | Val  Acc: 0.3881
 Site-Infograph | Val  Loss: 2.0679 | Val  Acc: 0.4167
 Site-Infograph | Val  Loss: 2.0763 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.1983 | Val  Acc: 0.2703
 Site-Infograph | Val  Loss: 2.2730 | Val  Acc: 0.1400
 Site-Painting  | Val  Loss: 2.0490 | Val  Acc: 0.4615
 Site-QuickDraw | Val  Loss: 2.1733 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9701 | Val  Acc: 0.4400
 Site-Sketch    | Val  Loss: 1.9809 | Val  Acc: 0.4348
Average Valid Accuracy: 0.3703
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4242
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4400
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3881
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4167
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2703
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1400
 Best site-Painting   | Epoch:1 | Val Acc: 0.4615
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.4400
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 4 ============
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 1.9060 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8744 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 1.9066 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.8534 | Train Acc: 0.5200
 Site-Infograph | Train Loss: 2.3658 | Train Acc: 0.1111
 Site-Infograph | Train Loss: 2.1544 | Train Acc: 0.1892
 Site-Infograph | Train Loss: 2.1322 | Train Acc: 0.2679
 Site-Infograph | Train Loss: 2.0344 | Train Acc: 0.4133
 Site-Painting  | Train Loss: 2.0199 | Train Acc: 0.4407
 Site-QuickDraw | Train Loss: 2.3797 | Train Acc: 0.0000
 Site-Real      | Train Loss: 2.0013 | Train Acc: 0.3947
 Site-Sketch    | Train Loss: 1.8723 | Train Acc: 0.5143
============ Train epoch 6 ============
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 1.8761 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.7573 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.7970 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.7415 | Train Acc: 0.5700
 Site-Infograph | Train Loss: 2.2961 | Train Acc: 0.1667
 Site-Infograph | Train Loss: 2.1043 | Train Acc: 0.1351
 Site-Infograph | Train Loss: 2.0694 | Train Acc: 0.3393
 Site-Infograph | Train Loss: 1.9894 | Train Acc: 0.3867
 Site-Painting  | Train Loss: 1.9077 | Train Acc: 0.4915
 Site-QuickDraw | Train Loss: 2.3304 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.9566 | Train Acc: 0.4474
 Site-Sketch    | Train Loss: 1.6931 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.6045 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.7454 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.6202 | Val  Acc: 0.5800
 Site-Clipart   | Val  Loss: 1.7447 | Val  Acc: 0.5970
 Site-Infograph | Val  Loss: 1.9671 | Val  Acc: 0.4167
 Site-Infograph | Val  Loss: 1.9917 | Val  Acc: 0.4800
 Site-Infograph | Val  Loss: 2.0236 | Val  Acc: 0.2973
 Site-Infograph | Val  Loss: 2.1301 | Val  Acc: 0.2800
 Site-Painting  | Val  Loss: 1.8175 | Val  Acc: 0.5897
 Site-QuickDraw | Val  Loss: 2.1512 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.8363 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.7959 | Val  Acc: 0.4783
Average Valid Accuracy: 0.4799
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5800
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5970
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4167
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4800
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2973
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2800
 Best site-Painting   | Epoch:3 | Val Acc: 0.5897
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1429
 Best site-Real       | Epoch:3 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:3 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7458 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.5523 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.6573 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.5112 | Train Acc: 0.7200
 Site-Infograph | Train Loss: 2.0409 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.0099 | Train Acc: 0.2432
 Site-Infograph | Train Loss: 1.9930 | Train Acc: 0.3571
 Site-Infograph | Train Loss: 1.8929 | Train Acc: 0.5200
 Site-Painting  | Train Loss: 1.7950 | Train Acc: 0.4915
 Site-QuickDraw | Train Loss: 2.3195 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.8022 | Train Acc: 0.5526
 Site-Sketch    | Train Loss: 1.5974 | Train Acc: 0.6857
============ Train epoch 10 ============
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 1.5543 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.4348 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.5171 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.3477 | Train Acc: 0.7200
 Site-Infograph | Train Loss: 2.0321 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 2.0455 | Train Acc: 0.2973
 Site-Infograph | Train Loss: 1.9351 | Train Acc: 0.4107
 Site-Infograph | Train Loss: 1.7994 | Train Acc: 0.4800
 Site-Painting  | Train Loss: 1.6451 | Train Acc: 0.5932
 Site-QuickDraw | Train Loss: 2.3431 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.6079 | Train Acc: 0.6842
 Site-Sketch    | Train Loss: 1.7921 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.3514 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4833 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.3116 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.4857 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 1.7427 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7864 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.9051 | Val  Acc: 0.4865
 Site-Infograph | Val  Loss: 1.9895 | Val  Acc: 0.3600
 Site-Painting  | Val  Loss: 1.5643 | Val  Acc: 0.5641
 Site-QuickDraw | Val  Loss: 2.1138 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.6411 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 1.5927 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6039
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7761
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4865
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3600
 Best site-Painting   | Epoch:5 | Val Acc: 0.5641
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.6400
 Best site-Sketch     | Epoch:5 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 12 ============
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 1.4115 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.4991 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.3990 | Train Acc: 0.6933
 Site-Clipart   | Train Loss: 1.3109 | Train Acc: 0.7800
 Site-Infograph | Train Loss: 1.7067 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.9687 | Train Acc: 0.2973
 Site-Infograph | Train Loss: 1.9708 | Train Acc: 0.3571
 Site-Infograph | Train Loss: 1.7372 | Train Acc: 0.4800
 Site-Painting  | Train Loss: 1.6037 | Train Acc: 0.6441
 Site-QuickDraw | Train Loss: 2.3280 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.5349 | Train Acc: 0.6579
 Site-Sketch    | Train Loss: 1.3506 | Train Acc: 0.7143
============ Train epoch 14 ============
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 1.3324 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2615 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.2983 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.1828 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 2.3028 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 1.9734 | Train Acc: 0.3243
 Site-Infograph | Train Loss: 1.8389 | Train Acc: 0.4107
 Site-Infograph | Train Loss: 1.6818 | Train Acc: 0.5067
 Site-Painting  | Train Loss: 1.4903 | Train Acc: 0.7288
 Site-QuickDraw | Train Loss: 2.3117 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.3741 | Train Acc: 0.7105
 Site-Sketch    | Train Loss: 1.5368 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.1134 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.3190 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.0539 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.2870 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 1.6555 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6787 | Val  Acc: 0.6400
 Site-Infograph | Val  Loss: 1.7507 | Val  Acc: 0.5135
 Site-Infograph | Val  Loss: 1.8593 | Val  Acc: 0.4400
 Site-Painting  | Val  Loss: 1.3231 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0607 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.4249 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.4473 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6466
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7463
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6400
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5135
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4400
 Best site-Painting   | Epoch:7 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2857
 Best site-Real       | Epoch:7 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 16 ============
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 1.3466 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2290 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1835 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0588 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 2.1046 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 1.9941 | Train Acc: 0.3243
 Site-Infograph | Train Loss: 1.7696 | Train Acc: 0.4821
 Site-Infograph | Train Loss: 1.6301 | Train Acc: 0.6133
 Site-Painting  | Train Loss: 1.3647 | Train Acc: 0.7119
 Site-QuickDraw | Train Loss: 2.3385 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.2776 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.2682 | Train Acc: 0.8286
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1854 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.4053 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.1471 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 0.9860 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 1.9518 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.9080 | Train Acc: 0.3243
 Site-Infograph | Train Loss: 1.7239 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.5623 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.2915 | Train Acc: 0.7288
 Site-QuickDraw | Train Loss: 2.2810 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.3373 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.1842 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 1.0084 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9472 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8842 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.1420 | Val  Acc: 0.7313
 Site-Infograph | Val  Loss: 1.5499 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5541 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.6400 | Val  Acc: 0.6486
 Site-Infograph | Val  Loss: 1.7709 | Val  Acc: 0.4400
 Site-Painting  | Val  Loss: 1.1252 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 2.0602 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.2643 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4255 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6863
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7313
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6486
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4400
 Best site-Painting   | Epoch:9 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2857
 Best site-Real       | Epoch:9 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7281
 Test site-Infograph | Epoch:9 | Test Acc: 0.3942
 Test site-Painting  | Epoch:9 | Test Acc: 0.7189
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2590
 Test site-Real      | Epoch:9 | Test Acc: 0.8053
 Test site-Sketch    | Epoch:9 | Test Acc: 0.6697
Average Test Accuracy: 0.5959
============ Train epoch 20 ============
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 1.0217 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.1622 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.1171 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9224 | Train Acc: 0.8400
 Site-Infograph | Train Loss: 2.0464 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.8776 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.7520 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.5286 | Train Acc: 0.6133
 Site-Painting  | Train Loss: 1.2547 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.3549 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.0804 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.2391 | Train Acc: 0.8000
============ Train epoch 22 ============
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.9981 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.1726 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.0299 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8533 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.6802 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.9082 | Train Acc: 0.3514
 Site-Infograph | Train Loss: 1.6298 | Train Acc: 0.5536
 Site-Infograph | Train Loss: 1.4829 | Train Acc: 0.6133
 Site-Painting  | Train Loss: 1.2026 | Train Acc: 0.7288
 Site-QuickDraw | Train Loss: 2.3101 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.9975 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0145 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8352 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9573 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8271 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 0.9835 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.5216 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5450 | Val  Acc: 0.6400
 Site-Infograph | Val  Loss: 1.6127 | Val  Acc: 0.6216
 Site-Infograph | Val  Loss: 1.6745 | Val  Acc: 0.5400
 Site-Painting  | Val  Loss: 1.0409 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 2.0276 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.1382 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.3630 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7077
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:11 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:11 | Val Acc: 0.6400
 Best site-Infograph  | Epoch:11 | Val Acc: 0.6216
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5400
 Best site-Painting   | Epoch:11 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.3333
 Best site-Real       | Epoch:11 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:11 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 24 ============
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.9314 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 1.1605 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.9347 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7712 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8557 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 1.8652 | Train Acc: 0.4324
 Site-Infograph | Train Loss: 1.5563 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.4363 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.1258 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.2788 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.0824 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.8964 | Train Acc: 0.8286
============ Train epoch 26 ============
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.9303 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8823 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.9219 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7292 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.9355 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 1.8818 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.6619 | Train Acc: 0.5357
 Site-Infograph | Train Loss: 1.3873 | Train Acc: 0.6800
 Site-Painting  | Train Loss: 1.0228 | Train Acc: 0.7797
 Site-QuickDraw | Train Loss: 2.3342 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.9429 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.7815 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.8079 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7146 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.7333 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.8707 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.3573 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.4111 | Val  Acc: 0.6800
 Site-Infograph | Val  Loss: 1.4747 | Val  Acc: 0.5946
 Site-Infograph | Val  Loss: 1.5907 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.9670 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.9992 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0161 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2380 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7241
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6800
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5946
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5000
 Best site-Painting   | Epoch:13 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2381
 Best site-Real       | Epoch:13 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.8193 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.0525 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8600 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.7531 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 2.1366 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.8812 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.4958 | Train Acc: 0.6250
 Site-Infograph | Train Loss: 1.3583 | Train Acc: 0.6400
 Site-Painting  | Train Loss: 0.9933 | Train Acc: 0.7797
 Site-QuickDraw | Train Loss: 2.3024 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.0138 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0324 | Train Acc: 0.8000
============ Train epoch 30 ============
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.8134 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8996 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8193 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.6331 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 2.2600 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.7379 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.6157 | Train Acc: 0.4643
 Site-Infograph | Train Loss: 1.4003 | Train Acc: 0.6133
 Site-Painting  | Train Loss: 0.9331 | Train Acc: 0.7966
 Site-QuickDraw | Train Loss: 2.2770 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.9888 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8432 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7101 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.5830 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6071 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.8161 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.2765 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3125 | Val  Acc: 0.7200
 Site-Infograph | Val  Loss: 1.5432 | Val  Acc: 0.5676
 Site-Infograph | Val  Loss: 1.5155 | Val  Acc: 0.5600
 Site-Painting  | Val  Loss: 0.9058 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9984 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9846 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2744 | Val  Acc: 0.5217
Average Valid Accuracy: 0.7269
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:15 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:15 | Val Acc: 0.7200
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5676
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5600
 Best site-Painting   | Epoch:15 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.3333
 Best site-Real       | Epoch:15 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:15 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 32 ============
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.8065 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8013 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.7963 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.5943 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 2.0901 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.8909 | Train Acc: 0.3514
 Site-Infograph | Train Loss: 1.4682 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.3266 | Train Acc: 0.6267
 Site-Painting  | Train Loss: 0.8910 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.2412 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.7651 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.9870 | Train Acc: 0.8286
============ Train epoch 34 ============
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.7578 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9151 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7757 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.5833 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 2.0427 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.8127 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.4166 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.3087 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.9440 | Train Acc: 0.7797
 Site-QuickDraw | Train Loss: 2.2396 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.6964 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.9506 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6335 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6802 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6211 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7444 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.3637 | Val  Acc: 0.5833
 Site-Infograph | Val  Loss: 1.3345 | Val  Acc: 0.7200
 Site-Infograph | Val  Loss: 1.3643 | Val  Acc: 0.6757
 Site-Infograph | Val  Loss: 1.4534 | Val  Acc: 0.5600
 Site-Painting  | Val  Loss: 0.8676 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 2.0084 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.8909 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.1648 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7306
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5833
 Best site-Infograph  | Epoch:17 | Val Acc: 0.7200
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6757
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5600
 Best site-Painting   | Epoch:17 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.3810
 Best site-Real       | Epoch:17 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:17 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 36 ============
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.7697 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7999 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7073 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.6142 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 2.1926 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.6833 | Train Acc: 0.4054
 Site-Infograph | Train Loss: 1.4228 | Train Acc: 0.6071
 Site-Infograph | Train Loss: 1.2416 | Train Acc: 0.6267
 Site-Painting  | Train Loss: 0.8310 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.2309 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7852 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0166 | Train Acc: 0.8571
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.6866 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8030 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.6582 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.5263 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.2629 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.9211 | Train Acc: 0.4054
 Site-Infograph | Train Loss: 1.4137 | Train Acc: 0.5179
 Site-Infograph | Train Loss: 1.2412 | Train Acc: 0.7200
 Site-Painting  | Train Loss: 0.8258 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.2124 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.7641 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.9029 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.4783 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6004 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5202 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6633 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.1524 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2564 | Val  Acc: 0.6800
 Site-Infograph | Val  Loss: 1.3782 | Val  Acc: 0.6757
 Site-Infograph | Val  Loss: 1.4377 | Val  Acc: 0.6400
 Site-Painting  | Val  Loss: 0.7941 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.9482 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7935 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.0641 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7584
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6800
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6757
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6400
 Best site-Painting   | Epoch:19 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.3810
 Best site-Real       | Epoch:19 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:19 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.8175
 Test site-Infograph | Epoch:19 | Test Acc: 0.4627
 Test site-Painting  | Epoch:19 | Test Acc: 0.8126
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.2940
 Test site-Real      | Epoch:19 | Test Acc: 0.8759
 Test site-Sketch    | Epoch:19 | Test Acc: 0.7419
Average Test Accuracy: 0.6674
============ Train epoch 40 ============
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.6297 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.8999 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6996 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4600 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.6797 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.6570 | Train Acc: 0.4054
 Site-Infograph | Train Loss: 1.4332 | Train Acc: 0.6071
 Site-Infograph | Train Loss: 1.2782 | Train Acc: 0.6400
 Site-Painting  | Train Loss: 0.7577 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.2512 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.7060 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.6228 | Train Acc: 0.8857
============ Train epoch 42 ============
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.6281 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9145 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.6123 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.4697 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.4705 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.5819 | Train Acc: 0.4865
 Site-Infograph | Train Loss: 1.4017 | Train Acc: 0.6607
 Site-Infograph | Train Loss: 1.2097 | Train Acc: 0.6800
 Site-Painting  | Train Loss: 0.7450 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.1779 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.6677 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.7520 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5400 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5227 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4884 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6743 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.1100 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.3099 | Val  Acc: 0.7600
 Site-Infograph | Val  Loss: 1.2696 | Val  Acc: 0.7297
 Site-Infograph | Val  Loss: 1.2996 | Val  Acc: 0.5400
 Site-Painting  | Val  Loss: 0.6805 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.8072 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7489 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0729 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7686
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9104
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7600
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7297
 Best site-Infograph  | Epoch:21 | Val Acc: 0.5400
 Best site-Painting   | Epoch:21 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.3333
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:21 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 44 ============
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.5673 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6785 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6255 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4233 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 2.3147 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.6494 | Train Acc: 0.4595
 Site-Infograph | Train Loss: 1.4274 | Train Acc: 0.6250
 Site-Infograph | Train Loss: 1.1501 | Train Acc: 0.7067
 Site-Painting  | Train Loss: 0.7746 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.1997 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7576 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.6000 | Train Acc: 0.8000
============ Train epoch 46 ============
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.6366 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.5396 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5894 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4723 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.6087 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.7752 | Train Acc: 0.4054
 Site-Infograph | Train Loss: 1.2911 | Train Acc: 0.6607
 Site-Infograph | Train Loss: 1.1405 | Train Acc: 0.6933
 Site-Painting  | Train Loss: 0.7484 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.1665 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.5576 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8321 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4977 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.3961 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4221 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6265 | Val  Acc: 0.9403
 Site-Infograph | Val  Loss: 1.2155 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.2517 | Val  Acc: 0.7600
 Site-Infograph | Val  Loss: 1.2887 | Val  Acc: 0.6757
 Site-Infograph | Val  Loss: 1.3591 | Val  Acc: 0.6200
 Site-Painting  | Val  Loss: 0.7249 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.9756 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7598 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.0351 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7691
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9403
 Best site-Infograph  | Epoch:23 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:23 | Val Acc: 0.7600
 Best site-Infograph  | Epoch:23 | Val Acc: 0.6757
 Best site-Infograph  | Epoch:23 | Val Acc: 0.6200
 Best site-Painting   | Epoch:23 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.3333
 Best site-Real       | Epoch:23 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:23 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.6930 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6587 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6300 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4032 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.6258 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.8281 | Train Acc: 0.4865
 Site-Infograph | Train Loss: 1.2539 | Train Acc: 0.6429
 Site-Infograph | Train Loss: 1.1363 | Train Acc: 0.6800
 Site-Painting  | Train Loss: 0.6609 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.1290 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.5837 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8030 | Train Acc: 0.8571
============ Train epoch 50 ============
============ Train epoch 51 ============
 Site-Clipart   | Train Loss: 0.5926 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.7062 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.5408 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3959 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.7727 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.6138 | Train Acc: 0.3784
 Site-Infograph | Train Loss: 1.2556 | Train Acc: 0.6429
 Site-Infograph | Train Loss: 1.1168 | Train Acc: 0.6800
 Site-Painting  | Train Loss: 0.7027 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.1327 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.5720 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.6672 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4640 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.3833 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3674 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.5485 | Val  Acc: 0.9254
 Site-Infograph | Val  Loss: 1.0819 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.0861 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 1.2226 | Val  Acc: 0.7027
 Site-Infograph | Val  Loss: 1.2588 | Val  Acc: 0.5600
 Site-Painting  | Val  Loss: 0.7320 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.9815 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6440 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9918 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7736
 Best site-Clipart    | Epoch:25 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:25 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:25 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:25 | Val Acc: 0.9254
 Best site-Infograph  | Epoch:25 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:25 | Val Acc: 0.8000
 Best site-Infograph  | Epoch:25 | Val Acc: 0.7027
 Best site-Infograph  | Epoch:25 | Val Acc: 0.5600
 Best site-Painting   | Epoch:25 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:25 | Val Acc: 0.3333
 Best site-Real       | Epoch:25 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:25 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 52 ============
============ Train epoch 53 ============
 Site-Clipart   | Train Loss: 0.4813 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6813 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5466 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.3639 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8764 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 1.4570 | Train Acc: 0.4595
 Site-Infograph | Train Loss: 1.2793 | Train Acc: 0.6964
 Site-Infograph | Train Loss: 1.1259 | Train Acc: 0.6933
 Site-Painting  | Train Loss: 0.6054 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.0834 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.6613 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.6365 | Train Acc: 0.7714
============ Train epoch 54 ============
============ Train epoch 55 ============
 Site-Clipart   | Train Loss: 0.6080 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8651 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5731 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3400 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 2.1566 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.6118 | Train Acc: 0.4595
 Site-Infograph | Train Loss: 1.3207 | Train Acc: 0.6071
 Site-Infograph | Train Loss: 1.1129 | Train Acc: 0.7200
 Site-Painting  | Train Loss: 0.6297 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.1569 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.5883 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6334 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4302 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.4348 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4049 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5221 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.0083 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.2097 | Val  Acc: 0.7600
 Site-Infograph | Val  Loss: 1.1474 | Val  Acc: 0.7838
 Site-Infograph | Val  Loss: 1.1077 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.6370 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.9237 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6164 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.0444 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7719
============ Train epoch 56 ============
============ Train epoch 57 ============
 Site-Clipart   | Train Loss: 0.5725 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6149 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4930 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3852 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.9775 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7794 | Train Acc: 0.4054
 Site-Infograph | Train Loss: 1.1619 | Train Acc: 0.6786
 Site-Infograph | Train Loss: 1.0580 | Train Acc: 0.7333
 Site-Painting  | Train Loss: 0.6611 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.0432 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.5145 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8798 | Train Acc: 0.8571
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-Clipart   | Train Loss: 0.5692 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6552 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4703 | Train Acc: 0.9467
 Site-Clipart   | Train Loss: 0.3991 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.6977 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 1.6998 | Train Acc: 0.4324
 Site-Infograph | Train Loss: 1.2529 | Train Acc: 0.6250
 Site-Infograph | Train Loss: 1.0572 | Train Acc: 0.7067
 Site-Painting  | Train Loss: 0.6323 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.0717 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.5709 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.5795 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4024 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.3618 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3960 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.5095 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.0264 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.0302 | Val  Acc: 0.7600
 Site-Infograph | Val  Loss: 1.2750 | Val  Acc: 0.7297
 Site-Infograph | Val  Loss: 1.1285 | Val  Acc: 0.7200
 Site-Painting  | Val  Loss: 0.5593 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.7997 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6250 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9212 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7859
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8955
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7600
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7297
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7200
 Best site-Painting   | Epoch:29 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.3333
 Best site-Real       | Epoch:29 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:29 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8346
 Test site-Infograph | Epoch:29 | Test Acc: 0.5099
 Test site-Painting  | Epoch:29 | Test Acc: 0.8368
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3080
 Test site-Real      | Epoch:29 | Test Acc: 0.8965
 Test site-Sketch    | Epoch:29 | Test Acc: 0.7780
Average Test Accuracy: 0.6940
===2023-04-12 16:04:31===
===2023-04-12 16:04:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,18,37,56,75,59,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8384
 Test site-Infograph | Epoch:29 | Test Acc: 0.5038
 Test site-Painting  | Epoch:29 | Test Acc: 0.8384
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3110
 Test site-Real      | Epoch:29 | Test Acc: 0.8965
 Test site-Sketch    | Epoch:29 | Test Acc: 0.7852
Average Test Accuracy: 0.6956
