===2023-04-14 14:15:50===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[33,67,100,134,41,11,23,35,47,42,51,47,]
domain number = 6
multiply acc by 100 for Ea!
use train acc for Ea
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 2.1464 | Train Acc: 0.2121
 Site-Clipart   | Train Loss: 2.2146 | Train Acc: 0.1343
 Site-Clipart   | Train Loss: 2.1528 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2053 | Train Acc: 0.1791
 Site-Infograph | Train Loss: 2.2432 | Train Acc: 0.1951
 Site-Painting  | Train Loss: 2.1828 | Train Acc: 0.2727
 Site-Painting  | Train Loss: 2.3145 | Train Acc: 0.0870
 Site-Painting  | Train Loss: 2.3218 | Train Acc: 0.1429
 Site-Painting  | Train Loss: 2.2747 | Train Acc: 0.1702
 Site-QuickDraw | Train Loss: 2.3906 | Train Acc: 0.0952
 Site-Real      | Train Loss: 2.2961 | Train Acc: 0.1961
 Site-Sketch    | Train Loss: 2.2138 | Train Acc: 0.1702
 Site-Clipart   | Val  Loss: 2.2036 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.2422 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.2022 | Val  Acc: 0.2800
 Site-Clipart   | Val  Loss: 2.1151 | Val  Acc: 0.1212
 Site-Infograph | Val  Loss: 2.2782 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1136 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.3173 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.3581 | Val  Acc: 0.1250
 Site-Painting  | Val  Loss: 2.2544 | Val  Acc: 0.0909
 Site-QuickDraw | Val  Loss: 2.3840 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 2.0926 | Val  Acc: 0.3333
 Site-Sketch    | Val  Loss: 2.2046 | Val  Acc: 0.3636
Average Valid Accuracy: 0.2074
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2800
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1212
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3000
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.4000
 Best site-Painting   | Epoch:0 | Val Acc: 0.1250
 Best site-Painting   | Epoch:0 | Val Acc: 0.0909
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1000
 Best site-Real       | Epoch:0 | Val Acc: 0.3333
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 1.9999 | Train Acc: 0.3030
 Site-Clipart   | Train Loss: 2.0814 | Train Acc: 0.2985
 Site-Clipart   | Train Loss: 2.0674 | Train Acc: 0.2900
 Site-Clipart   | Train Loss: 2.1090 | Train Acc: 0.2910
 Site-Infograph | Train Loss: 2.2283 | Train Acc: 0.1951
 Site-Painting  | Train Loss: 2.2589 | Train Acc: 0.2727
 Site-Painting  | Train Loss: 2.2596 | Train Acc: 0.3478
 Site-Painting  | Train Loss: 2.1376 | Train Acc: 0.2857
 Site-Painting  | Train Loss: 2.1928 | Train Acc: 0.2553
 Site-QuickDraw | Train Loss: 2.4071 | Train Acc: 0.0714
 Site-Real      | Train Loss: 2.1652 | Train Acc: 0.3529
 Site-Sketch    | Train Loss: 2.0811 | Train Acc: 0.3191
 Site-Clipart   | Val  Loss: 2.0988 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1316 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 2.0753 | Val  Acc: 0.1600
 Site-Clipart   | Val  Loss: 2.0915 | Val  Acc: 0.2727
 Site-Infograph | Val  Loss: 2.1374 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9317 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 2.1932 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.0796 | Val  Acc: 0.3750
 Site-Painting  | Val  Loss: 2.1400 | Val  Acc: 0.1818
 Site-QuickDraw | Val  Loss: 2.3217 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 2.0570 | Val  Acc: 0.3333
 Site-Sketch    | Val  Loss: 2.1160 | Val  Acc: 0.3636
Average Valid Accuracy: 0.3083
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3125
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1600
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2727
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2000
 Best site-Painting   | Epoch:1 | Val Acc: 0.5000
 Best site-Painting   | Epoch:1 | Val Acc: 0.4000
 Best site-Painting   | Epoch:1 | Val Acc: 0.3750
 Best site-Painting   | Epoch:1 | Val Acc: 0.1818
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1000
 Best site-Real       | Epoch:1 | Val Acc: 0.3333
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 2.0933 | Train Acc: 0.3030
 Site-Clipart   | Train Loss: 1.9904 | Train Acc: 0.3881
 Site-Clipart   | Train Loss: 1.9640 | Train Acc: 0.4500
 Site-Clipart   | Train Loss: 2.0145 | Train Acc: 0.4104
 Site-Infograph | Train Loss: 2.2505 | Train Acc: 0.1707
 Site-Painting  | Train Loss: 2.1465 | Train Acc: 0.3636
 Site-Painting  | Train Loss: 2.1288 | Train Acc: 0.3913
 Site-Painting  | Train Loss: 2.1887 | Train Acc: 0.3429
 Site-Painting  | Train Loss: 2.1691 | Train Acc: 0.2553
 Site-QuickDraw | Train Loss: 2.3501 | Train Acc: 0.0714
 Site-Real      | Train Loss: 2.0547 | Train Acc: 0.4118
 Site-Sketch    | Train Loss: 1.9861 | Train Acc: 0.4894
 Site-Clipart   | Val  Loss: 1.9697 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0118 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 2.0334 | Val  Acc: 0.3600
 Site-Clipart   | Val  Loss: 1.9950 | Val  Acc: 0.2727
 Site-Infograph | Val  Loss: 2.2672 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.5811 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 2.0930 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0487 | Val  Acc: 0.3750
 Site-Painting  | Val  Loss: 2.1471 | Val  Acc: 0.2727
 Site-QuickDraw | Val  Loss: 2.2523 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.9140 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.9857 | Val  Acc: 0.6364
Average Valid Accuracy: 0.4465
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3600
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2727
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2000
 Best site-Painting   | Epoch:2 | Val Acc: 1.0000
 Best site-Painting   | Epoch:2 | Val Acc: 0.6000
 Best site-Painting   | Epoch:2 | Val Acc: 0.3750
 Best site-Painting   | Epoch:2 | Val Acc: 0.2727
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1000
 Best site-Real       | Epoch:2 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6364
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 1.9933 | Train Acc: 0.3636
 Site-Clipart   | Train Loss: 1.9112 | Train Acc: 0.4328
 Site-Clipart   | Train Loss: 1.8582 | Train Acc: 0.4900
 Site-Clipart   | Train Loss: 1.9355 | Train Acc: 0.4030
 Site-Infograph | Train Loss: 2.1890 | Train Acc: 0.1463
 Site-Painting  | Train Loss: 2.0163 | Train Acc: 0.4545
 Site-Painting  | Train Loss: 2.1268 | Train Acc: 0.3478
 Site-Painting  | Train Loss: 2.1165 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.0557 | Train Acc: 0.3617
 Site-QuickDraw | Train Loss: 2.3572 | Train Acc: 0.0952
 Site-Real      | Train Loss: 1.8424 | Train Acc: 0.4706
 Site-Sketch    | Train Loss: 1.8677 | Train Acc: 0.5319
 Site-Clipart   | Val  Loss: 2.0080 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9766 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 1.9473 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.9362 | Val  Acc: 0.3939
 Site-Infograph | Val  Loss: 2.2572 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.4471 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 2.0414 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0362 | Val  Acc: 0.3750
 Site-Painting  | Val  Loss: 2.0655 | Val  Acc: 0.2727
 Site-QuickDraw | Val  Loss: 2.2351 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.7576 | Val  Acc: 0.5833
 Site-Sketch    | Val  Loss: 1.8943 | Val  Acc: 0.6364
Average Valid Accuracy: 0.4666
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3939
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3000
 Best site-Painting   | Epoch:3 | Val Acc: 1.0000
 Best site-Painting   | Epoch:3 | Val Acc: 0.6000
 Best site-Painting   | Epoch:3 | Val Acc: 0.3750
 Best site-Painting   | Epoch:3 | Val Acc: 0.2727
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1000
 Best site-Real       | Epoch:3 | Val Acc: 0.5833
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6364
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.8156 | Train Acc: 0.3636
 Site-Clipart   | Train Loss: 1.7421 | Train Acc: 0.4627
 Site-Clipart   | Train Loss: 1.7729 | Train Acc: 0.6100
 Site-Clipart   | Train Loss: 1.8114 | Train Acc: 0.5597
 Site-Infograph | Train Loss: 2.1363 | Train Acc: 0.2195
 Site-Painting  | Train Loss: 2.0000 | Train Acc: 0.3636
 Site-Painting  | Train Loss: 2.0099 | Train Acc: 0.5217
 Site-Painting  | Train Loss: 2.1018 | Train Acc: 0.3143
 Site-Painting  | Train Loss: 1.9747 | Train Acc: 0.4255
 Site-QuickDraw | Train Loss: 2.3257 | Train Acc: 0.0952
 Site-Real      | Train Loss: 1.8911 | Train Acc: 0.5294
 Site-Sketch    | Train Loss: 1.8125 | Train Acc: 0.5532
 Site-Clipart   | Val  Loss: 1.9297 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9065 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 1.8389 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.8132 | Val  Acc: 0.4545
 Site-Infograph | Val  Loss: 2.2456 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.2670 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8854 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9228 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.9971 | Val  Acc: 0.2727
 Site-QuickDraw | Val  Loss: 2.1699 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.7598 | Val  Acc: 0.5833
 Site-Sketch    | Val  Loss: 1.7678 | Val  Acc: 0.7273
Average Valid Accuracy: 0.4844
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4545
 Best site-Infograph  | Epoch:4 | Val Acc: 0.1000
 Best site-Painting   | Epoch:4 | Val Acc: 1.0000
 Best site-Painting   | Epoch:4 | Val Acc: 0.6000
 Best site-Painting   | Epoch:4 | Val Acc: 0.5000
 Best site-Painting   | Epoch:4 | Val Acc: 0.2727
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3000
 Best site-Real       | Epoch:4 | Val Acc: 0.5833
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 2.0200 | Train Acc: 0.4242
 Site-Clipart   | Train Loss: 1.7498 | Train Acc: 0.5821
 Site-Clipart   | Train Loss: 1.6947 | Train Acc: 0.6100
 Site-Clipart   | Train Loss: 1.7850 | Train Acc: 0.5224
 Site-Infograph | Train Loss: 2.1762 | Train Acc: 0.2439
 Site-Painting  | Train Loss: 1.9421 | Train Acc: 0.4545
 Site-Painting  | Train Loss: 1.8907 | Train Acc: 0.5652
 Site-Painting  | Train Loss: 2.0419 | Train Acc: 0.4571
 Site-Painting  | Train Loss: 1.9020 | Train Acc: 0.4468
 Site-QuickDraw | Train Loss: 2.2745 | Train Acc: 0.1429
 Site-Real      | Train Loss: 1.7538 | Train Acc: 0.6078
 Site-Sketch    | Train Loss: 1.7112 | Train Acc: 0.6170
 Site-Clipart   | Val  Loss: 1.7286 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8030 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.8522 | Val  Acc: 0.4400
 Site-Clipart   | Val  Loss: 1.7526 | Val  Acc: 0.5758
 Site-Infograph | Val  Loss: 2.1329 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.2027 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7598 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.7337 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.9281 | Val  Acc: 0.3636
 Site-QuickDraw | Val  Loss: 2.1557 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.6184 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.7351 | Val  Acc: 0.7273
Average Valid Accuracy: 0.5655
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4400
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5758
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3000
 Best site-Painting   | Epoch:5 | Val Acc: 1.0000
 Best site-Painting   | Epoch:5 | Val Acc: 0.6000
 Best site-Painting   | Epoch:5 | Val Acc: 0.5000
 Best site-Painting   | Epoch:5 | Val Acc: 0.3636
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3000
 Best site-Real       | Epoch:5 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 1.6084 | Train Acc: 0.4545
 Site-Clipart   | Train Loss: 1.6260 | Train Acc: 0.6119
 Site-Clipart   | Train Loss: 1.5929 | Train Acc: 0.6500
 Site-Clipart   | Train Loss: 1.6794 | Train Acc: 0.5970
 Site-Infograph | Train Loss: 2.1083 | Train Acc: 0.2927
 Site-Painting  | Train Loss: 1.8259 | Train Acc: 0.4545
 Site-Painting  | Train Loss: 1.7391 | Train Acc: 0.5652
 Site-Painting  | Train Loss: 1.9631 | Train Acc: 0.2857
 Site-Painting  | Train Loss: 1.7420 | Train Acc: 0.5745
 Site-QuickDraw | Train Loss: 2.2816 | Train Acc: 0.1190
 Site-Real      | Train Loss: 1.6316 | Train Acc: 0.5882
 Site-Sketch    | Train Loss: 1.6455 | Train Acc: 0.6383
 Site-Clipart   | Val  Loss: 1.8380 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.7329 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.7009 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.6498 | Val  Acc: 0.4848
 Site-Infograph | Val  Loss: 2.1776 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 0.9820 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.5744 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.6186 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.9172 | Val  Acc: 0.3636
 Site-QuickDraw | Val  Loss: 2.1297 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.5460 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.5647 | Val  Acc: 0.7273
Average Valid Accuracy: 0.5675
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4848
 Best site-Infograph  | Epoch:6 | Val Acc: 0.1000
 Best site-Painting   | Epoch:6 | Val Acc: 1.0000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8000
 Best site-Painting   | Epoch:6 | Val Acc: 0.5000
 Best site-Painting   | Epoch:6 | Val Acc: 0.3636
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3000
 Best site-Real       | Epoch:6 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 1.3650 | Train Acc: 0.5152
 Site-Clipart   | Train Loss: 1.6977 | Train Acc: 0.6418
 Site-Clipart   | Train Loss: 1.5446 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.5351 | Train Acc: 0.6343
 Site-Infograph | Train Loss: 2.0998 | Train Acc: 0.2683
 Site-Painting  | Train Loss: 1.8388 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 1.6275 | Train Acc: 0.5217
 Site-Painting  | Train Loss: 1.7989 | Train Acc: 0.4571
 Site-Painting  | Train Loss: 1.6737 | Train Acc: 0.5745
 Site-QuickDraw | Train Loss: 2.2993 | Train Acc: 0.1429
 Site-Real      | Train Loss: 1.5180 | Train Acc: 0.7059
 Site-Sketch    | Train Loss: 1.5680 | Train Acc: 0.7234
 Site-Clipart   | Val  Loss: 1.7632 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.6541 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 1.6656 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.5078 | Val  Acc: 0.5152
 Site-Infograph | Val  Loss: 2.0897 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.7968 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.5541 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.5510 | Val  Acc: 0.6250
 Site-Painting  | Val  Loss: 1.7551 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 2.1595 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.6016 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 1.4638 | Val  Acc: 0.7273
Average Valid Accuracy: 0.5875
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5152
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3000
 Best site-Painting   | Epoch:7 | Val Acc: 1.0000
 Best site-Painting   | Epoch:7 | Val Acc: 0.6000
 Best site-Painting   | Epoch:7 | Val Acc: 0.6250
 Best site-Painting   | Epoch:7 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2000
 Best site-Real       | Epoch:7 | Val Acc: 0.7500
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 1.5518 | Train Acc: 0.5758
 Site-Clipart   | Train Loss: 1.6371 | Train Acc: 0.6418
 Site-Clipart   | Train Loss: 1.4270 | Train Acc: 0.7900
 Site-Clipart   | Train Loss: 1.4808 | Train Acc: 0.6791
 Site-Infograph | Train Loss: 2.1346 | Train Acc: 0.2927
 Site-Painting  | Train Loss: 1.7590 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 1.6423 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.7865 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.6059 | Train Acc: 0.6170
 Site-QuickDraw | Train Loss: 2.3015 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.6030 | Train Acc: 0.7255
 Site-Sketch    | Train Loss: 1.4658 | Train Acc: 0.7021
 Site-Clipart   | Val  Loss: 1.6178 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.5193 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.5388 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.4057 | Val  Acc: 0.5758
 Site-Infograph | Val  Loss: 1.9237 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.6865 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.3933 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.3844 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.8269 | Val  Acc: 0.3636
 Site-QuickDraw | Val  Loss: 2.0972 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.5382 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.4161 | Val  Acc: 0.8182
Average Valid Accuracy: 0.6389
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5758
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4000
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.8000
 Best site-Painting   | Epoch:8 | Val Acc: 0.7500
 Best site-Painting   | Epoch:8 | Val Acc: 0.3636
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3000
 Best site-Real       | Epoch:8 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8182
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.5830 | Train Acc: 0.5758
 Site-Clipart   | Train Loss: 1.4366 | Train Acc: 0.7164
 Site-Clipart   | Train Loss: 1.3409 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.3952 | Train Acc: 0.7164
 Site-Infograph | Train Loss: 2.0879 | Train Acc: 0.3171
 Site-Painting  | Train Loss: 1.6190 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 1.6479 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.7738 | Train Acc: 0.5143
 Site-Painting  | Train Loss: 1.5100 | Train Acc: 0.6170
 Site-QuickDraw | Train Loss: 2.3101 | Train Acc: 0.1905
 Site-Real      | Train Loss: 1.4307 | Train Acc: 0.6863
 Site-Sketch    | Train Loss: 1.3776 | Train Acc: 0.7872
 Site-Clipart   | Val  Loss: 1.4622 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.4420 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.4982 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.2557 | Val  Acc: 0.5758
 Site-Infograph | Val  Loss: 2.0865 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 0.8935 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.3892 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2860 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.7672 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 2.1442 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.4578 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.2215 | Val  Acc: 0.8182
Average Valid Accuracy: 0.6349
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 1.6338 | Train Acc: 0.6364
 Site-Clipart   | Train Loss: 1.4143 | Train Acc: 0.6418
 Site-Clipart   | Train Loss: 1.2396 | Train Acc: 0.8300
 Site-Clipart   | Train Loss: 1.2724 | Train Acc: 0.7388
 Site-Infograph | Train Loss: 2.0739 | Train Acc: 0.2683
 Site-Painting  | Train Loss: 1.5220 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 1.5270 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.6971 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.4060 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2998 | Train Acc: 0.2143
 Site-Real      | Train Loss: 1.5329 | Train Acc: 0.7255
 Site-Sketch    | Train Loss: 1.3238 | Train Acc: 0.7447
 Site-Clipart   | Val  Loss: 1.5162 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3803 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.3715 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.2271 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8646 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.7066 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.2865 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2764 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.6779 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 2.0837 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.3788 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 1.2382 | Val  Acc: 0.7273
Average Valid Accuracy: 0.6935
 Best site-Clipart    | Epoch:10 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:10 | Val Acc: 0.7200
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5000
 Best site-Painting   | Epoch:10 | Val Acc: 1.0000
 Best site-Painting   | Epoch:10 | Val Acc: 0.8000
 Best site-Painting   | Epoch:10 | Val Acc: 0.7500
 Best site-Painting   | Epoch:10 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3000
 Best site-Real       | Epoch:10 | Val Acc: 0.7500
 Best site-Sketch     | Epoch:10 | Val Acc: 0.7273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 1.2783 | Train Acc: 0.6970
 Site-Clipart   | Train Loss: 1.2971 | Train Acc: 0.7164
 Site-Clipart   | Train Loss: 1.1984 | Train Acc: 0.8100
 Site-Clipart   | Train Loss: 1.2206 | Train Acc: 0.8134
 Site-Infograph | Train Loss: 2.0006 | Train Acc: 0.3171
 Site-Painting  | Train Loss: 1.5249 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 1.5661 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.6855 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.3826 | Train Acc: 0.7021
 Site-QuickDraw | Train Loss: 2.3118 | Train Acc: 0.1905
 Site-Real      | Train Loss: 1.2841 | Train Acc: 0.8039
 Site-Sketch    | Train Loss: 1.2815 | Train Acc: 0.7660
 Site-Clipart   | Val  Loss: 1.3060 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.2852 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.3368 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.1713 | Val  Acc: 0.6061
 Site-Infograph | Val  Loss: 1.9444 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5938 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.2601 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2113 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.7339 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 2.0629 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.3775 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.1079 | Val  Acc: 0.7273
Average Valid Accuracy: 0.6966
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6061
 Best site-Infograph  | Epoch:11 | Val Acc: 0.4000
 Best site-Painting   | Epoch:11 | Val Acc: 1.0000
 Best site-Painting   | Epoch:11 | Val Acc: 0.8000
 Best site-Painting   | Epoch:11 | Val Acc: 0.7500
 Best site-Painting   | Epoch:11 | Val Acc: 0.4545
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.3000
 Best site-Real       | Epoch:11 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:11 | Val Acc: 0.7273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 1.5136 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.2768 | Train Acc: 0.6866
 Site-Clipart   | Train Loss: 1.1130 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1467 | Train Acc: 0.8134
 Site-Infograph | Train Loss: 2.0181 | Train Acc: 0.3415
 Site-Painting  | Train Loss: 1.4309 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.3905 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.4697 | Train Acc: 0.6571
 Site-Painting  | Train Loss: 1.2826 | Train Acc: 0.7660
 Site-QuickDraw | Train Loss: 2.3069 | Train Acc: 0.2143
 Site-Real      | Train Loss: 1.2100 | Train Acc: 0.8431
 Site-Sketch    | Train Loss: 1.2319 | Train Acc: 0.7234
 Site-Clipart   | Val  Loss: 1.3918 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.2248 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3418 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.0522 | Val  Acc: 0.6970
 Site-Infograph | Val  Loss: 1.9720 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4971 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.1278 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9851 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.6159 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.9548 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.2875 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.0056 | Val  Acc: 0.9091
Average Valid Accuracy: 0.7040
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:12 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6970
 Best site-Infograph  | Epoch:12 | Val Acc: 0.4000
 Best site-Painting   | Epoch:12 | Val Acc: 1.0000
 Best site-Painting   | Epoch:12 | Val Acc: 0.8000
 Best site-Painting   | Epoch:12 | Val Acc: 0.8750
 Best site-Painting   | Epoch:12 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.5000
 Best site-Real       | Epoch:12 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:12 | Val Acc: 0.9091
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 1.0588 | Train Acc: 0.6970
 Site-Clipart   | Train Loss: 1.2470 | Train Acc: 0.7015
 Site-Clipart   | Train Loss: 1.0599 | Train Acc: 0.8900
 Site-Clipart   | Train Loss: 1.1329 | Train Acc: 0.8134
 Site-Infograph | Train Loss: 1.9951 | Train Acc: 0.3659
 Site-Painting  | Train Loss: 1.3709 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.3200 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.5620 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.2296 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.3124 | Train Acc: 0.2143
 Site-Real      | Train Loss: 1.2107 | Train Acc: 0.8235
 Site-Sketch    | Train Loss: 1.2357 | Train Acc: 0.7447
 Site-Clipart   | Val  Loss: 1.3478 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.1118 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1065 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9927 | Val  Acc: 0.7273
 Site-Infograph | Val  Loss: 1.8601 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3813 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.1694 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.1482 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.6811 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 1.9965 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.3878 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.0704 | Val  Acc: 0.8182
Average Valid Accuracy: 0.7257
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7273
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5000
 Best site-Painting   | Epoch:13 | Val Acc: 1.0000
 Best site-Painting   | Epoch:13 | Val Acc: 0.8000
 Best site-Painting   | Epoch:13 | Val Acc: 0.7500
 Best site-Painting   | Epoch:13 | Val Acc: 0.4545
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.4000
 Best site-Real       | Epoch:13 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8182
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 0.8966 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.1788 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.0613 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.0491 | Train Acc: 0.8209
 Site-Infograph | Train Loss: 1.9685 | Train Acc: 0.3659
 Site-Painting  | Train Loss: 1.2916 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.3079 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 1.3905 | Train Acc: 0.6571
 Site-Painting  | Train Loss: 1.2030 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2860 | Train Acc: 0.1905
 Site-Real      | Train Loss: 1.2387 | Train Acc: 0.8039
 Site-Sketch    | Train Loss: 1.1976 | Train Acc: 0.6809
 Site-Clipart   | Val  Loss: 1.4131 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.2146 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.0836 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.9685 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8364 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.3133 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.0349 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0388 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.6115 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 2.0648 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.1957 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.9867 | Val  Acc: 0.9091
Average Valid Accuracy: 0.7102
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 1.1252 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 1.1364 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 1.0045 | Train Acc: 0.8500
 Site-Clipart   | Train Loss: 0.9963 | Train Acc: 0.8507
 Site-Infograph | Train Loss: 1.9430 | Train Acc: 0.3902
 Site-Painting  | Train Loss: 1.3254 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.2140 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.6994 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.1089 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.3527 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.0505 | Train Acc: 0.8431
 Site-Sketch    | Train Loss: 1.0476 | Train Acc: 0.7660
 Site-Clipart   | Val  Loss: 1.1399 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0633 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.2084 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 0.9067 | Val  Acc: 0.6364
 Site-Infograph | Val  Loss: 1.8886 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.3390 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.0256 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8785 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.6471 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 2.0978 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.2118 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 0.7925 | Val  Acc: 1.0000
Average Valid Accuracy: 0.7238
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 0.8128 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.9957 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 0.9658 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.9888 | Train Acc: 0.8657
 Site-Infograph | Train Loss: 1.9682 | Train Acc: 0.3659
 Site-Painting  | Train Loss: 1.2665 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.3447 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.1800 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.1060 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2503 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.0752 | Train Acc: 0.8627
 Site-Sketch    | Train Loss: 1.0702 | Train Acc: 0.7447
 Site-Clipart   | Val  Loss: 1.2911 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9762 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.9933 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.9093 | Val  Acc: 0.6364
 Site-Infograph | Val  Loss: 1.8239 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4139 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.9530 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9381 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.5733 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 2.0475 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.3368 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 0.9817 | Val  Acc: 0.9091
Average Valid Accuracy: 0.7286
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:16 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6364
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4000
 Best site-Painting   | Epoch:16 | Val Acc: 1.0000
 Best site-Painting   | Epoch:16 | Val Acc: 0.8000
 Best site-Painting   | Epoch:16 | Val Acc: 0.8750
 Best site-Painting   | Epoch:16 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.3000
 Best site-Real       | Epoch:16 | Val Acc: 0.7500
 Best site-Sketch     | Epoch:16 | Val Acc: 0.9091
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 1.1899 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.1530 | Train Acc: 0.7313
 Site-Clipart   | Train Loss: 0.8494 | Train Acc: 0.8700
 Site-Clipart   | Train Loss: 0.8765 | Train Acc: 0.8881
 Site-Infograph | Train Loss: 1.9162 | Train Acc: 0.3902
 Site-Painting  | Train Loss: 1.2928 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.1115 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.4325 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.1242 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2759 | Train Acc: 0.2381
 Site-Real      | Train Loss: 0.9190 | Train Acc: 0.8627
 Site-Sketch    | Train Loss: 1.0754 | Train Acc: 0.8085
 Site-Clipart   | Val  Loss: 1.1454 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9794 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.0036 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.8159 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.9033 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3893 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.9894 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9454 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.5269 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.9839 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.2574 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.7546 | Val  Acc: 1.0000
Average Valid Accuracy: 0.7573
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:17 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5000
 Best site-Painting   | Epoch:17 | Val Acc: 1.0000
 Best site-Painting   | Epoch:17 | Val Acc: 0.8000
 Best site-Painting   | Epoch:17 | Val Acc: 0.7500
 Best site-Painting   | Epoch:17 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.3000
 Best site-Real       | Epoch:17 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:17 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 0.6831 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 1.0606 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 0.8829 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8505 | Train Acc: 0.9104
 Site-Infograph | Train Loss: 1.9306 | Train Acc: 0.3171
 Site-Painting  | Train Loss: 1.0185 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.1077 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.3991 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.0812 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.1908 | Train Acc: 0.2619
 Site-Real      | Train Loss: 0.8781 | Train Acc: 0.8627
 Site-Sketch    | Train Loss: 1.0162 | Train Acc: 0.8511
 Site-Clipart   | Val  Loss: 0.9687 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9983 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9346 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8140 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7640 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3901 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.9156 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7353 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.4158 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.9554 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.2012 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.8325 | Val  Acc: 0.8182
Average Valid Accuracy: 0.7483
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0610 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 1.0294 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 0.8144 | Train Acc: 0.8700
 Site-Clipart   | Train Loss: 0.7794 | Train Acc: 0.9104
 Site-Infograph | Train Loss: 1.9416 | Train Acc: 0.3171
 Site-Painting  | Train Loss: 1.0798 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.1366 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 1.1325 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 0.9622 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.2558 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.0921 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.9354 | Train Acc: 0.8298
 Site-Clipart   | Val  Loss: 1.1337 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9476 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9635 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 0.8158 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7900 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2965 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.8476 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6700 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.5218 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 1.8311 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.2006 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 0.8459 | Val  Acc: 0.9091
Average Valid Accuracy: 0.7304
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 1.0059 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 1.0761 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 0.7784 | Train Acc: 0.8900
 Site-Clipart   | Train Loss: 0.7902 | Train Acc: 0.9030
 Site-Infograph | Train Loss: 1.8678 | Train Acc: 0.4390
 Site-Painting  | Train Loss: 1.1511 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.0787 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 1.2252 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 0.9560 | Train Acc: 0.8085
 Site-QuickDraw | Train Loss: 2.2568 | Train Acc: 0.2143
 Site-Real      | Train Loss: 1.0301 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.9140 | Train Acc: 0.8085
 Site-Clipart   | Val  Loss: 0.9141 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7761 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8421 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7270 | Val  Acc: 0.7576
 Site-Infograph | Val  Loss: 1.8239 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.3199 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7758 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8230 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.2942 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.9194 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.2295 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.7437 | Val  Acc: 0.9091
Average Valid Accuracy: 0.7590
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:20 | Val Acc: 0.7576
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4000
 Best site-Painting   | Epoch:20 | Val Acc: 1.0000
 Best site-Painting   | Epoch:20 | Val Acc: 0.8000
 Best site-Painting   | Epoch:20 | Val Acc: 0.7500
 Best site-Painting   | Epoch:20 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.5000
 Best site-Real       | Epoch:20 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:20 | Val Acc: 0.9091
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 0.8131 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.9916 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 0.8060 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.7251 | Train Acc: 0.9104
 Site-Infograph | Train Loss: 1.8510 | Train Acc: 0.3902
 Site-Painting  | Train Loss: 0.9564 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.0969 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.2589 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.9210 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.3158 | Train Acc: 0.2143
 Site-Real      | Train Loss: 0.9555 | Train Acc: 0.8627
 Site-Sketch    | Train Loss: 0.9761 | Train Acc: 0.7872
 Site-Clipart   | Val  Loss: 0.9422 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9413 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8078 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.7721 | Val  Acc: 0.7576
 Site-Infograph | Val  Loss: 1.6476 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.1752 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.9608 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7246 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.3847 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 2.0066 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.1047 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.7036 | Val  Acc: 0.9091
Average Valid Accuracy: 0.8037
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:21 | Val Acc: 0.7576
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7000
 Best site-Painting   | Epoch:21 | Val Acc: 1.0000
 Best site-Painting   | Epoch:21 | Val Acc: 0.8000
 Best site-Painting   | Epoch:21 | Val Acc: 0.8750
 Best site-Painting   | Epoch:21 | Val Acc: 0.6364
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.4000
 Best site-Real       | Epoch:21 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:21 | Val Acc: 0.9091
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.6930 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.9033 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 0.8300 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.7187 | Train Acc: 0.9179
 Site-Infograph | Train Loss: 1.9596 | Train Acc: 0.3171
 Site-Painting  | Train Loss: 1.0760 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.0532 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.2771 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.9430 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2720 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.7701 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.8773 | Train Acc: 0.8511
 Site-Clipart   | Val  Loss: 0.9652 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8627 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8758 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6627 | Val  Acc: 0.8182
 Site-Infograph | Val  Loss: 1.6350 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3171 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.8751 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6820 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.3153 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 2.0106 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.0582 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.7262 | Val  Acc: 1.0000
Average Valid Accuracy: 0.7685
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.5866 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.8673 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 0.7412 | Train Acc: 0.9100
 Site-Clipart   | Train Loss: 0.7009 | Train Acc: 0.9179
 Site-Infograph | Train Loss: 1.8971 | Train Acc: 0.3415
 Site-Painting  | Train Loss: 1.0144 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.9795 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.0199 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 0.8633 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1458 | Train Acc: 0.2381
 Site-Real      | Train Loss: 0.8418 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.8691 | Train Acc: 0.7872
 Site-Clipart   | Val  Loss: 0.8882 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7868 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8456 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.6385 | Val  Acc: 0.7273
 Site-Infograph | Val  Loss: 1.6966 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.2218 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.8461 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6515 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.3672 | Val  Acc: 0.7273
 Site-QuickDraw | Val  Loss: 2.0170 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.0231 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 0.7765 | Val  Acc: 0.9091
Average Valid Accuracy: 0.8024
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8606 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.8246 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 0.7261 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6320 | Train Acc: 0.9030
 Site-Infograph | Train Loss: 1.9699 | Train Acc: 0.3415
 Site-Painting  | Train Loss: 0.9957 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.0930 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.3355 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 0.8833 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1768 | Train Acc: 0.2619
 Site-Real      | Train Loss: 0.8545 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.8262 | Train Acc: 0.9149
 Site-Clipart   | Val  Loss: 0.8757 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8854 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7517 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6352 | Val  Acc: 0.7576
 Site-Infograph | Val  Loss: 1.6145 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.1892 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7578 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5790 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.2704 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.9298 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.0421 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.6965 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8131
 Best site-Clipart    | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:24 | Val Acc: 0.7576
 Best site-Infograph  | Epoch:24 | Val Acc: 0.6000
 Best site-Painting   | Epoch:24 | Val Acc: 1.0000
 Best site-Painting   | Epoch:24 | Val Acc: 0.8000
 Best site-Painting   | Epoch:24 | Val Acc: 0.8750
 Best site-Painting   | Epoch:24 | Val Acc: 0.6364
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.5000
 Best site-Real       | Epoch:24 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:24 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.5660 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.8231 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 0.6984 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6326 | Train Acc: 0.9254
 Site-Infograph | Train Loss: 1.9064 | Train Acc: 0.3171
 Site-Painting  | Train Loss: 0.9177 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.0260 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 1.0110 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 0.7859 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.2185 | Train Acc: 0.2619
 Site-Real      | Train Loss: 0.6990 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.8389 | Train Acc: 0.8511
 Site-Clipart   | Val  Loss: 0.7217 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6547 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7884 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6580 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4996 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.1193 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7505 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5991 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.3484 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 2.0725 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.0159 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.6134 | Val  Acc: 1.0000
Average Valid Accuracy: 0.7941
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.7341 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.7863 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.6690 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.6000 | Train Acc: 0.9254
 Site-Infograph | Train Loss: 1.7931 | Train Acc: 0.4634
 Site-Painting  | Train Loss: 0.9291 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8676 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.9291 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 0.7685 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1479 | Train Acc: 0.2619
 Site-Real      | Train Loss: 0.7010 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.7784 | Train Acc: 0.8723
 Site-Clipart   | Val  Loss: 0.6960 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7737 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6954 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6044 | Val  Acc: 0.8182
 Site-Infograph | Val  Loss: 1.5390 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.2045 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6856 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7076 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.2422 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.7624 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.0466 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.6208 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8002
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.5800 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.8963 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.5892 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5992 | Train Acc: 0.9552
 Site-Infograph | Train Loss: 1.7304 | Train Acc: 0.3171
 Site-Painting  | Train Loss: 0.9018 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8484 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.1090 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 0.7706 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2053 | Train Acc: 0.2143
 Site-Real      | Train Loss: 0.7175 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.7135 | Train Acc: 0.8723
 Site-Clipart   | Val  Loss: 0.8133 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7332 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7260 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.6206 | Val  Acc: 0.7273
 Site-Infograph | Val  Loss: 1.4738 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.2097 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6722 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5724 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.2983 | Val  Acc: 0.3636
 Site-QuickDraw | Val  Loss: 1.9301 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 0.8905 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.5327 | Val  Acc: 1.0000
Average Valid Accuracy: 0.7626
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.8373 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.7459 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.6077 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.5700 | Train Acc: 0.9403
 Site-Infograph | Train Loss: 1.8322 | Train Acc: 0.3902
 Site-Painting  | Train Loss: 0.9625 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.0678 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.9403 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 0.8226 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1014 | Train Acc: 0.2619
 Site-Real      | Train Loss: 0.6700 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.7609 | Train Acc: 0.8511
 Site-Clipart   | Val  Loss: 0.7835 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6828 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7457 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5454 | Val  Acc: 0.7879
 Site-Infograph | Val  Loss: 1.5780 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.1634 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7493 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6329 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.2099 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.8181 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.0074 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.5642 | Val  Acc: 1.0000
Average Valid Accuracy: 0.7931
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.5366 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.7519 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.6619 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5232 | Train Acc: 0.9403
 Site-Infograph | Train Loss: 1.7631 | Train Acc: 0.4146
 Site-Painting  | Train Loss: 0.8782 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.0460 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.9290 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.7967 | Train Acc: 0.8085
 Site-QuickDraw | Train Loss: 2.1259 | Train Acc: 0.2619
 Site-Real      | Train Loss: 0.8169 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.7008 | Train Acc: 0.8723
 Site-Clipart   | Val  Loss: 0.8009 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.5557 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6875 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.6032 | Val  Acc: 0.8182
 Site-Infograph | Val  Loss: 1.5390 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.1510 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7894 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5954 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.2109 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.8519 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 0.8990 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.5202 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8065
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.6451 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.7243 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.5868 | Train Acc: 0.8700
 Site-Clipart   | Train Loss: 0.4950 | Train Acc: 0.9478
 Site-Infograph | Train Loss: 1.8861 | Train Acc: 0.3415
 Site-Painting  | Train Loss: 0.8121 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8848 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.8342 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.7445 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.0921 | Train Acc: 0.2619
 Site-Real      | Train Loss: 0.6535 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.8215 | Train Acc: 0.7872
 Site-Clipart   | Val  Loss: 0.6799 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6819 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6726 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6156 | Val  Acc: 0.7273
 Site-Infograph | Val  Loss: 1.5087 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.1700 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7169 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7195 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1878 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.9058 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 0.9010 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.5579 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8075
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 1.0491 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.6946 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.5679 | Train Acc: 0.8900
 Site-Clipart   | Train Loss: 0.4877 | Train Acc: 0.9627
 Site-Infograph | Train Loss: 1.8546 | Train Acc: 0.3659
 Site-Painting  | Train Loss: 0.7434 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.0073 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 1.0829 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.7613 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1324 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.6848 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.7147 | Train Acc: 0.7872
 Site-Clipart   | Val  Loss: 0.7763 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4884 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7236 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.4834 | Val  Acc: 0.7879
 Site-Infograph | Val  Loss: 1.4277 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.1053 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7421 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5049 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.3680 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 1.6839 | Val  Acc: 0.6000
 Site-Real      | Val  Loss: 0.9356 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.5691 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8159
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:31 | Val Acc: 0.7879
 Best site-Infograph  | Epoch:31 | Val Acc: 0.6000
 Best site-Painting   | Epoch:31 | Val Acc: 1.0000
 Best site-Painting   | Epoch:31 | Val Acc: 0.8000
 Best site-Painting   | Epoch:31 | Val Acc: 0.8750
 Best site-Painting   | Epoch:31 | Val Acc: 0.4545
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.6000
 Best site-Real       | Epoch:31 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:31 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.6500 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.8096 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 0.5396 | Train Acc: 0.9100
 Site-Clipart   | Train Loss: 0.5113 | Train Acc: 0.9627
 Site-Infograph | Train Loss: 1.8069 | Train Acc: 0.3171
 Site-Painting  | Train Loss: 0.8834 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.0082 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.7704 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.6818 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1504 | Train Acc: 0.2381
 Site-Real      | Train Loss: 0.6796 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.7121 | Train Acc: 0.8298
 Site-Clipart   | Val  Loss: 0.7682 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5911 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6566 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.4708 | Val  Acc: 0.8788
 Site-Infograph | Val  Loss: 1.5721 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.1735 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6957 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5800 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1657 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.9066 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 0.9119 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.4241 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8008
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.6326 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.6994 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.5644 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4819 | Train Acc: 0.9478
 Site-Infograph | Train Loss: 1.8000 | Train Acc: 0.3902
 Site-Painting  | Train Loss: 0.8298 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.9184 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.9781 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.7615 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.0820 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.8262 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.7001 | Train Acc: 0.9149
 Site-Clipart   | Val  Loss: 0.5935 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6629 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7645 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5554 | Val  Acc: 0.8182
 Site-Infograph | Val  Loss: 1.3892 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.1753 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6491 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5294 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.3228 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 1.7568 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.8762 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.5291 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8099
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.4994 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.6008 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.5433 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.4471 | Train Acc: 0.9627
 Site-Infograph | Train Loss: 1.7636 | Train Acc: 0.3902
 Site-Painting  | Train Loss: 0.8072 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.9315 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.8022 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.6896 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.0550 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.7232 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.6491 | Train Acc: 0.8723
 Site-Clipart   | Val  Loss: 0.5792 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6126 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5593 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.4789 | Val  Acc: 0.8485
 Site-Infograph | Val  Loss: 1.4593 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.0920 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6530 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4965 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.2454 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.7693 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 0.8127 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.3709 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8228
 Best site-Clipart    | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8485
 Best site-Infograph  | Epoch:34 | Val Acc: 0.6000
 Best site-Painting   | Epoch:34 | Val Acc: 1.0000
 Best site-Painting   | Epoch:34 | Val Acc: 0.8000
 Best site-Painting   | Epoch:34 | Val Acc: 0.8750
 Best site-Painting   | Epoch:34 | Val Acc: 0.6364
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.4000
 Best site-Real       | Epoch:34 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:34 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.6323 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.5611 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.5184 | Train Acc: 0.9300
 Site-Clipart   | Train Loss: 0.4822 | Train Acc: 0.9627
 Site-Infograph | Train Loss: 1.7844 | Train Acc: 0.4146
 Site-Painting  | Train Loss: 0.7683 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8901 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.7443 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.6703 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.0383 | Train Acc: 0.3095
 Site-Real      | Train Loss: 0.7056 | Train Acc: 0.9216
 Site-Sketch    | Train Loss: 0.7415 | Train Acc: 0.7660
 Site-Clipart   | Val  Loss: 0.6508 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5630 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6695 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5436 | Val  Acc: 0.7576
 Site-Infograph | Val  Loss: 1.5146 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.0819 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6438 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5838 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.3257 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 1.7387 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 0.7824 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.5365 | Val  Acc: 0.8182
Average Valid Accuracy: 0.7680
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.5966 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.5847 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.5210 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4527 | Train Acc: 0.9701
 Site-Infograph | Train Loss: 1.7396 | Train Acc: 0.4146
 Site-Painting  | Train Loss: 0.7713 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.9845 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.9132 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.6684 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.1467 | Train Acc: 0.3095
 Site-Real      | Train Loss: 0.7533 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.6398 | Train Acc: 0.8723
 Site-Clipart   | Val  Loss: 0.7031 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4860 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5336 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.4629 | Val  Acc: 0.8485
 Site-Infograph | Val  Loss: 1.4691 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.1403 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6153 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7036 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.2471 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.7377 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 0.8275 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.3782 | Val  Acc: 1.0000
Average Valid Accuracy: 0.7964
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.6187 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.6339 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 0.4974 | Train Acc: 0.8900
 Site-Clipart   | Train Loss: 0.4376 | Train Acc: 0.9627
 Site-Infograph | Train Loss: 1.8011 | Train Acc: 0.3902
 Site-Painting  | Train Loss: 0.6205 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.9876 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.8574 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.6448 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1009 | Train Acc: 0.2619
 Site-Real      | Train Loss: 0.5783 | Train Acc: 0.9216
 Site-Sketch    | Train Loss: 0.6405 | Train Acc: 0.8723
 Site-Clipart   | Val  Loss: 0.6322 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5661 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6214 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5078 | Val  Acc: 0.8485
 Site-Infograph | Val  Loss: 1.5075 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.0769 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6430 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5100 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1405 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.7523 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.8336 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.4407 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8226
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.4840 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.6583 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.5482 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4338 | Train Acc: 0.9478
 Site-Infograph | Train Loss: 1.8377 | Train Acc: 0.2927
 Site-Painting  | Train Loss: 0.6778 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8344 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.7890 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 0.6532 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.0363 | Train Acc: 0.2619
 Site-Real      | Train Loss: 0.6424 | Train Acc: 0.9216
 Site-Sketch    | Train Loss: 0.6263 | Train Acc: 0.8936
 Site-Clipart   | Val  Loss: 0.6946 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.5452 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6265 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.4852 | Val  Acc: 0.8485
 Site-Infograph | Val  Loss: 1.3985 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.1318 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6995 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5338 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1015 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.6478 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 0.8387 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.3976 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8123
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.5226 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.6009 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 0.4992 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4169 | Train Acc: 0.9701
 Site-Infograph | Train Loss: 1.8033 | Train Acc: 0.3415
 Site-Painting  | Train Loss: 0.7052 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7047 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.0323 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 0.6841 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.0749 | Train Acc: 0.3571
 Site-Real      | Train Loss: 0.5347 | Train Acc: 0.8627
 Site-Sketch    | Train Loss: 0.6244 | Train Acc: 0.8511
 Site-Clipart   | Val  Loss: 0.6622 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4768 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6194 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.4767 | Val  Acc: 0.8182
 Site-Infograph | Val  Loss: 1.5070 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.0932 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7190 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5443 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1021 | Val  Acc: 0.7273
 Site-QuickDraw | Val  Loss: 1.8123 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.6808 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.4014 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8328
 Best site-Clipart    | Epoch:39 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:39 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8182
 Best site-Infograph  | Epoch:39 | Val Acc: 0.6000
 Best site-Painting   | Epoch:39 | Val Acc: 1.0000
 Best site-Painting   | Epoch:39 | Val Acc: 0.8000
 Best site-Painting   | Epoch:39 | Val Acc: 0.8750
 Best site-Painting   | Epoch:39 | Val Acc: 0.7273
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.5000
 Best site-Real       | Epoch:39 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:39 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8688
 Test site-Infograph | Epoch:39 | Test Acc: 0.4627
 Test site-Painting  | Epoch:39 | Test Acc: 0.8659
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.3310
 Test site-Real      | Epoch:39 | Test Acc: 0.9071
 Test site-Sketch    | Epoch:39 | Test Acc: 0.7924
Average Test Accuracy: 0.7047
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.5069 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.5038 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.5156 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4309 | Train Acc: 0.9552
 Site-Infograph | Train Loss: 1.7694 | Train Acc: 0.4146
 Site-Painting  | Train Loss: 0.6840 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6108 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.7973 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.6297 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 2.0606 | Train Acc: 0.3095
 Site-Real      | Train Loss: 0.7303 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.6673 | Train Acc: 0.8298
 Site-Clipart   | Val  Loss: 0.4914 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4490 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5527 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5256 | Val  Acc: 0.7879
 Site-Infograph | Val  Loss: 1.2575 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.0589 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5942 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4477 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1235 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.6906 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.6558 | Val  Acc: 0.9167
 Site-Sketch    | Val  Loss: 0.4581 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8304
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.6406 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.5831 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.5018 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3912 | Train Acc: 0.9552
 Site-Infograph | Train Loss: 1.7454 | Train Acc: 0.3902
 Site-Painting  | Train Loss: 0.6910 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7007 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 1.2262 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.5971 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.9526 | Train Acc: 0.3095
 Site-Real      | Train Loss: 0.6508 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.6178 | Train Acc: 0.8298
 Site-Clipart   | Val  Loss: 0.7034 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.4641 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6033 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.4703 | Val  Acc: 0.9091
 Site-Infograph | Val  Loss: 1.3281 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.1207 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6451 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4979 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1324 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.6276 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.7803 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 0.4653 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8079
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.4940 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5993 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.5106 | Train Acc: 0.9100
 Site-Clipart   | Train Loss: 0.3757 | Train Acc: 0.9627
 Site-Infograph | Train Loss: 1.8691 | Train Acc: 0.2927
 Site-Painting  | Train Loss: 0.6589 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7308 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.7296 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 0.6018 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.0455 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.5216 | Train Acc: 0.9216
 Site-Sketch    | Train Loss: 0.6391 | Train Acc: 0.8298
 Site-Clipart   | Val  Loss: 0.6078 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4333 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5384 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.3780 | Val  Acc: 0.8788
 Site-Infograph | Val  Loss: 1.4203 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.0922 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5901 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5241 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1306 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.6741 | Val  Acc: 0.6000
 Site-Real      | Val  Loss: 0.6979 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.4546 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8310
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.3815 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.4914 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.4514 | Train Acc: 0.9300
 Site-Clipart   | Train Loss: 0.3655 | Train Acc: 0.9627
 Site-Infograph | Train Loss: 1.7957 | Train Acc: 0.4390
 Site-Painting  | Train Loss: 0.5616 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8683 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.8662 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.6189 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 1.9237 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.5009 | Train Acc: 0.8824
 Site-Sketch    | Train Loss: 0.5519 | Train Acc: 0.8723
 Site-Clipart   | Val  Loss: 0.5880 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5519 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.5199 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.4099 | Val  Acc: 0.8788
 Site-Infograph | Val  Loss: 1.4122 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.1434 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6733 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5823 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.0983 | Val  Acc: 0.7273
 Site-QuickDraw | Val  Loss: 1.6928 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.7443 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.5233 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8222
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.8380 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.5260 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.4790 | Train Acc: 0.9100
 Site-Clipart   | Train Loss: 0.3592 | Train Acc: 0.9627
 Site-Infograph | Train Loss: 1.6587 | Train Acc: 0.3659
 Site-Painting  | Train Loss: 0.6517 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8012 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.7786 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.5133 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 2.0237 | Train Acc: 0.3095
 Site-Real      | Train Loss: 0.4805 | Train Acc: 0.9216
 Site-Sketch    | Train Loss: 0.6525 | Train Acc: 0.8511
 Site-Clipart   | Val  Loss: 0.5079 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4233 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5186 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.4193 | Val  Acc: 0.8182
 Site-Infograph | Val  Loss: 1.4148 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.1206 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5659 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4805 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1104 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.6101 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 0.7689 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.4238 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8319
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.4709 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.4412 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.4393 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.3486 | Train Acc: 0.9552
 Site-Infograph | Train Loss: 1.6909 | Train Acc: 0.3902
 Site-Painting  | Train Loss: 0.5928 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8519 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.5968 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.6173 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 2.0411 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.4853 | Train Acc: 0.9216
 Site-Sketch    | Train Loss: 0.5875 | Train Acc: 0.8723
 Site-Clipart   | Val  Loss: 0.6196 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3997 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4892 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.4419 | Val  Acc: 0.8182
 Site-Infograph | Val  Loss: 1.4989 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.0558 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5266 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5067 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 0.9898 | Val  Acc: 0.7273
 Site-QuickDraw | Val  Loss: 1.6981 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.7050 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.3092 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8311
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.4329 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.4918 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.4305 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.3568 | Train Acc: 0.9478
 Site-Infograph | Train Loss: 1.6746 | Train Acc: 0.4146
 Site-Painting  | Train Loss: 0.5932 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8245 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.6967 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.5164 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 2.0036 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.4351 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.6145 | Train Acc: 0.8936
 Site-Clipart   | Val  Loss: 0.5678 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3996 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5323 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.3714 | Val  Acc: 0.9091
 Site-Infograph | Val  Loss: 1.2731 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.0740 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5956 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4553 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.0930 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.7382 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 0.6914 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.4562 | Val  Acc: 0.9091
Average Valid Accuracy: 0.8286
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.4475 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.5131 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.3744 | Train Acc: 0.9100
 Site-Clipart   | Train Loss: 0.3171 | Train Acc: 0.9776
 Site-Infograph | Train Loss: 1.8216 | Train Acc: 0.3171
 Site-Painting  | Train Loss: 0.6435 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6383 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.7117 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 0.5561 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 1.9755 | Train Acc: 0.3095
 Site-Real      | Train Loss: 0.4638 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.5853 | Train Acc: 0.8511
 Site-Clipart   | Val  Loss: 0.4690 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4014 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5211 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.3683 | Val  Acc: 0.8788
 Site-Infograph | Val  Loss: 1.2538 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.0525 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6097 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4697 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1031 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.5810 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.7486 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.3710 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8344
 Best site-Clipart    | Epoch:47 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:47 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:47 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:47 | Val Acc: 0.8788
 Best site-Infograph  | Epoch:47 | Val Acc: 0.7000
 Best site-Painting   | Epoch:47 | Val Acc: 1.0000
 Best site-Painting   | Epoch:47 | Val Acc: 0.8000
 Best site-Painting   | Epoch:47 | Val Acc: 0.8750
 Best site-Painting   | Epoch:47 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:47 | Val Acc: 0.5000
 Best site-Real       | Epoch:47 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:47 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.4244 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.5833 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.3708 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.3325 | Train Acc: 0.9776
 Site-Infograph | Train Loss: 1.7682 | Train Acc: 0.4146
 Site-Painting  | Train Loss: 0.6820 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6454 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.6542 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.5799 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 2.0238 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.5582 | Train Acc: 0.9216
 Site-Sketch    | Train Loss: 0.5919 | Train Acc: 0.8723
 Site-Clipart   | Val  Loss: 0.5396 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3833 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5154 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.3973 | Val  Acc: 0.9091
 Site-Infograph | Val  Loss: 1.2528 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.0859 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5600 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5331 | Val  Acc: 0.7500
 Site-Painting  | Val  Loss: 1.0455 | Val  Acc: 0.7273
 Site-QuickDraw | Val  Loss: 1.5704 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.7204 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.5356 | Val  Acc: 0.9091
Average Valid Accuracy: 0.8341
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.4247 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.5192 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.4056 | Train Acc: 0.9300
 Site-Clipart   | Train Loss: 0.3572 | Train Acc: 0.9552
 Site-Infograph | Train Loss: 1.6717 | Train Acc: 0.4146
 Site-Painting  | Train Loss: 0.6765 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6189 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.9159 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.5298 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 1.9954 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.4557 | Train Acc: 0.9020
 Site-Sketch    | Train Loss: 0.6069 | Train Acc: 0.8511
 Site-Clipart   | Val  Loss: 0.4257 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4965 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4755 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.3644 | Val  Acc: 0.9394
 Site-Infograph | Val  Loss: 1.1709 | Val  Acc: 0.7000
 Site-Painting  | Val  Loss: 0.0579 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6081 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4351 | Val  Acc: 0.8750
 Site-Painting  | Val  Loss: 1.1916 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.6261 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.6912 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.4246 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8461
 Best site-Clipart    | Epoch:49 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:49 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9394
 Best site-Infograph  | Epoch:49 | Val Acc: 0.7000
 Best site-Painting   | Epoch:49 | Val Acc: 1.0000
 Best site-Painting   | Epoch:49 | Val Acc: 0.8000
 Best site-Painting   | Epoch:49 | Val Acc: 0.8750
 Best site-Painting   | Epoch:49 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.5000
 Best site-Real       | Epoch:49 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:49 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/CoCoOP...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8764
 Test site-Infograph | Epoch:49 | Test Acc: 0.4658
 Test site-Painting  | Epoch:49 | Test Acc: 0.8708
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.3550
 Test site-Real      | Epoch:49 | Test Acc: 0.9137
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8069
Average Test Accuracy: 0.7148
===2023-04-14 14:55:50===
===2023-04-14 14:55:52===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[33,67,100,134,41,11,23,35,47,42,51,47,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8764
 Test site-Infograph | Epoch:49 | Test Acc: 0.4658
 Test site-Painting  | Epoch:49 | Test Acc: 0.8708
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.3550
 Test site-Real      | Epoch:49 | Test Acc: 0.9137
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8069
Average Test Accuracy: 0.7148
