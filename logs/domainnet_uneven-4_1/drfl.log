===2023-04-19 11:49:11===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 2.1881 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.1581 | Train Acc: 0.1400
 Site-Clipart   | Train Loss: 2.2316 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.1935 | Train Acc: 0.2100
 Site-Infograph | Train Loss: 2.3350 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.3068 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.4922 | Train Acc: 0.1176
 Site-Painting  | Train Loss: 2.2144 | Train Acc: 0.3077
 Site-Painting  | Train Loss: 2.3736 | Train Acc: 0.0286
 Site-QuickDraw | Train Loss: 2.2685 | Train Acc: 0.1562
 Site-Real      | Train Loss: 2.3437 | Train Acc: 0.0789
 Site-Sketch    | Train Loss: 2.1979 | Train Acc: 0.1143
 Site-Clipart   | Val  Loss: 2.3454 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.1981 | Val  Acc: 0.0606
 Site-Clipart   | Val  Loss: 2.2653 | Val  Acc: 0.1200
 Site-Clipart   | Val  Loss: 2.2695 | Val  Acc: 0.1791
 Site-Infograph | Val  Loss: 2.4726 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.3789 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.1646 | Val  Acc: 0.2727
 Site-Painting  | Val  Loss: 2.3702 | Val  Acc: 0.1765
 Site-Painting  | Val  Loss: 2.2626 | Val  Acc: 0.3913
 Site-QuickDraw | Val  Loss: 2.3489 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.3875 | Val  Acc: 0.0400
 Site-Sketch    | Val  Loss: 2.1239 | Val  Acc: 0.2174
Average Valid Accuracy: 0.1390
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0625
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0606
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1200
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1791
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1000
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.2727
 Best site-Painting   | Epoch:0 | Val Acc: 0.1765
 Best site-Painting   | Epoch:0 | Val Acc: 0.3913
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0476
 Best site-Real       | Epoch:0 | Val Acc: 0.0400
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.0705 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.0740 | Train Acc: 0.2600
 Site-Clipart   | Train Loss: 2.1744 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.1101 | Train Acc: 0.2700
 Site-Infograph | Train Loss: 2.3089 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.3329 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.2854 | Train Acc: 0.1765
 Site-Painting  | Train Loss: 2.1809 | Train Acc: 0.2692
 Site-Painting  | Train Loss: 2.2146 | Train Acc: 0.0286
 Site-QuickDraw | Train Loss: 2.3054 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.2660 | Train Acc: 0.1316
 Site-Sketch    | Train Loss: 2.1360 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.2280 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.0826 | Val  Acc: 0.1515
 Site-Clipart   | Val  Loss: 2.1400 | Val  Acc: 0.2800
 Site-Clipart   | Val  Loss: 2.1573 | Val  Acc: 0.2537
 Site-Infograph | Val  Loss: 2.3937 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.3145 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.1334 | Val  Acc: 0.1818
 Site-Painting  | Val  Loss: 2.1842 | Val  Acc: 0.1765
 Site-Painting  | Val  Loss: 2.2007 | Val  Acc: 0.2174
 Site-QuickDraw | Val  Loss: 2.3837 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.3642 | Val  Acc: 0.0800
 Site-Sketch    | Val  Loss: 2.0523 | Val  Acc: 0.3043
Average Valid Accuracy: 0.1515
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1515
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2800
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2537
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0000
 Best site-Painting   | Epoch:1 | Val Acc: 0.0000
 Best site-Painting   | Epoch:1 | Val Acc: 0.1818
 Best site-Painting   | Epoch:1 | Val Acc: 0.1765
 Best site-Painting   | Epoch:1 | Val Acc: 0.2174
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0476
 Best site-Real       | Epoch:1 | Val Acc: 0.0800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 2.1000 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.0734 | Train Acc: 0.3200
 Site-Clipart   | Train Loss: 2.0743 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.0552 | Train Acc: 0.3200
 Site-Infograph | Train Loss: 2.2884 | Train Acc: 0.0645
 Site-Painting  | Train Loss: 2.3087 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.2192 | Train Acc: 0.2941
 Site-Painting  | Train Loss: 2.0960 | Train Acc: 0.3462
 Site-Painting  | Train Loss: 2.2181 | Train Acc: 0.2000
 Site-QuickDraw | Train Loss: 2.3235 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.2288 | Train Acc: 0.1579
 Site-Sketch    | Train Loss: 2.0505 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.1432 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 1.9527 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.0259 | Val  Acc: 0.3600
 Site-Clipart   | Val  Loss: 2.1449 | Val  Acc: 0.2537
 Site-Infograph | Val  Loss: 2.4382 | Val  Acc: 0.0500
 Site-Painting  | Val  Loss: 2.1511 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0396 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.3305 | Val  Acc: 0.2941
 Site-Painting  | Val  Loss: 2.2196 | Val  Acc: 0.2609
 Site-QuickDraw | Val  Loss: 2.3474 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2476 | Val  Acc: 0.0800
 Site-Sketch    | Val  Loss: 2.0697 | Val  Acc: 0.3913
Average Valid Accuracy: 0.2469
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3600
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2537
 Best site-Infograph  | Epoch:2 | Val Acc: 0.0500
 Best site-Painting   | Epoch:2 | Val Acc: 0.2000
 Best site-Painting   | Epoch:2 | Val Acc: 0.4545
 Best site-Painting   | Epoch:2 | Val Acc: 0.2941
 Best site-Painting   | Epoch:2 | Val Acc: 0.2609
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.0952
 Best site-Real       | Epoch:2 | Val Acc: 0.0800
 Best site-Sketch     | Epoch:2 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 1.9673 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.0907 | Train Acc: 0.3800
 Site-Clipart   | Train Loss: 1.9775 | Train Acc: 0.3467
 Site-Clipart   | Train Loss: 1.9970 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.3062 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.2607 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.1475 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 2.0176 | Train Acc: 0.3077
 Site-Painting  | Train Loss: 2.1199 | Train Acc: 0.1714
 Site-QuickDraw | Train Loss: 2.3041 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.0226 | Train Acc: 0.3421
 Site-Sketch    | Train Loss: 2.0635 | Train Acc: 0.2571
 Site-Clipart   | Val  Loss: 2.0167 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 1.8238 | Val  Acc: 0.3939
 Site-Clipart   | Val  Loss: 1.9838 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.0357 | Val  Acc: 0.3433
 Site-Infograph | Val  Loss: 2.3880 | Val  Acc: 0.0500
 Site-Painting  | Val  Loss: 2.0744 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0373 | Val  Acc: 0.3636
 Site-Painting  | Val  Loss: 2.2516 | Val  Acc: 0.4706
 Site-Painting  | Val  Loss: 2.0754 | Val  Acc: 0.3478
 Site-QuickDraw | Val  Loss: 2.3612 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1907 | Val  Acc: 0.1600
 Site-Sketch    | Val  Loss: 1.9681 | Val  Acc: 0.3043
Average Valid Accuracy: 0.2784
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3125
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3939
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3433
 Best site-Infograph  | Epoch:3 | Val Acc: 0.0500
 Best site-Painting   | Epoch:3 | Val Acc: 0.2000
 Best site-Painting   | Epoch:3 | Val Acc: 0.3636
 Best site-Painting   | Epoch:3 | Val Acc: 0.4706
 Best site-Painting   | Epoch:3 | Val Acc: 0.3478
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.0952
 Best site-Real       | Epoch:3 | Val Acc: 0.1600
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.9007 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.0712 | Train Acc: 0.3200
 Site-Clipart   | Train Loss: 1.9108 | Train Acc: 0.3867
 Site-Clipart   | Train Loss: 1.9387 | Train Acc: 0.4400
 Site-Infograph | Train Loss: 2.2652 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.2093 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 1.7816 | Train Acc: 0.4118
 Site-Painting  | Train Loss: 2.0206 | Train Acc: 0.3462
 Site-Painting  | Train Loss: 2.0941 | Train Acc: 0.3143
 Site-QuickDraw | Train Loss: 2.2721 | Train Acc: 0.0938
 Site-Real      | Train Loss: 2.0264 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 1.9334 | Train Acc: 0.3714
 Site-Clipart   | Val  Loss: 1.9462 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 1.7243 | Val  Acc: 0.5152
 Site-Clipart   | Val  Loss: 1.9094 | Val  Acc: 0.4800
 Site-Clipart   | Val  Loss: 1.9753 | Val  Acc: 0.3284
 Site-Infograph | Val  Loss: 2.4550 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.0524 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9419 | Val  Acc: 0.2727
 Site-Painting  | Val  Loss: 2.0883 | Val  Acc: 0.2353
 Site-Painting  | Val  Loss: 2.1031 | Val  Acc: 0.3913
 Site-QuickDraw | Val  Loss: 2.3263 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1497 | Val  Acc: 0.2800
 Site-Sketch    | Val  Loss: 1.9390 | Val  Acc: 0.3913
Average Valid Accuracy: 0.3145
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5152
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4800
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3284
 Best site-Infograph  | Epoch:4 | Val Acc: 0.1000
 Best site-Painting   | Epoch:4 | Val Acc: 0.2000
 Best site-Painting   | Epoch:4 | Val Acc: 0.2727
 Best site-Painting   | Epoch:4 | Val Acc: 0.2353
 Best site-Painting   | Epoch:4 | Val Acc: 0.3913
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1429
 Best site-Real       | Epoch:4 | Val Acc: 0.2800
 Best site-Sketch     | Epoch:4 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 1.9198 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 1.8696 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 1.8652 | Train Acc: 0.4533
 Site-Clipart   | Train Loss: 1.7975 | Train Acc: 0.5400
 Site-Infograph | Train Loss: 2.2771 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.1806 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.1988 | Train Acc: 0.4118
 Site-Painting  | Train Loss: 1.9365 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.1313 | Train Acc: 0.3143
 Site-QuickDraw | Train Loss: 2.2861 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.9586 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 1.8010 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 1.8791 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 1.7227 | Val  Acc: 0.5152
 Site-Clipart   | Val  Loss: 1.8383 | Val  Acc: 0.4800
 Site-Clipart   | Val  Loss: 1.8366 | Val  Acc: 0.4478
 Site-Infograph | Val  Loss: 2.3348 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9091 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9986 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.1239 | Val  Acc: 0.3529
 Site-Painting  | Val  Loss: 1.9177 | Val  Acc: 0.4348
 Site-QuickDraw | Val  Loss: 2.3714 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1025 | Val  Acc: 0.4000
 Site-Sketch    | Val  Loss: 1.9032 | Val  Acc: 0.3913
Average Valid Accuracy: 0.3714
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5152
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4800
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4478
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2000
 Best site-Painting   | Epoch:5 | Val Acc: 0.2000
 Best site-Painting   | Epoch:5 | Val Acc: 0.4545
 Best site-Painting   | Epoch:5 | Val Acc: 0.3529
 Best site-Painting   | Epoch:5 | Val Acc: 0.4348
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.1429
 Best site-Real       | Epoch:5 | Val Acc: 0.4000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 1.8603 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.8490 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8271 | Train Acc: 0.5067
 Site-Clipart   | Train Loss: 1.7585 | Train Acc: 0.5700
 Site-Infograph | Train Loss: 2.2223 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.0816 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.2014 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 1.8881 | Train Acc: 0.3846
 Site-Painting  | Train Loss: 2.1440 | Train Acc: 0.3143
 Site-QuickDraw | Train Loss: 2.2894 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.8983 | Train Acc: 0.5526
 Site-Sketch    | Train Loss: 1.8939 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 1.8614 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6717 | Val  Acc: 0.5152
 Site-Clipart   | Val  Loss: 1.7790 | Val  Acc: 0.5400
 Site-Clipart   | Val  Loss: 1.8280 | Val  Acc: 0.5075
 Site-Infograph | Val  Loss: 2.4596 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.9344 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8708 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.0326 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 1.8448 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.3344 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.0700 | Val  Acc: 0.3600
 Site-Sketch    | Val  Loss: 1.8697 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4030
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5152
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5400
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5075
 Best site-Infograph  | Epoch:6 | Val Acc: 0.1000
 Best site-Painting   | Epoch:6 | Val Acc: 0.4000
 Best site-Painting   | Epoch:6 | Val Acc: 0.4545
 Best site-Painting   | Epoch:6 | Val Acc: 0.4118
 Best site-Painting   | Epoch:6 | Val Acc: 0.5652
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.0476
 Best site-Real       | Epoch:6 | Val Acc: 0.3600
 Best site-Sketch     | Epoch:6 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 1.7752 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.7913 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.7417 | Train Acc: 0.5467
 Site-Clipart   | Train Loss: 1.6795 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 2.2620 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1728 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 1.9202 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 1.8257 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 1.9386 | Train Acc: 0.3429
 Site-QuickDraw | Train Loss: 2.2333 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.8047 | Train Acc: 0.6316
 Site-Sketch    | Train Loss: 1.8433 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 1.7338 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.5852 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 1.6876 | Val  Acc: 0.5600
 Site-Clipart   | Val  Loss: 1.7638 | Val  Acc: 0.5075
 Site-Infograph | Val  Loss: 2.4319 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.8420 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.7353 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 1.9809 | Val  Acc: 0.4706
 Site-Painting  | Val  Loss: 1.8592 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.3172 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.0500 | Val  Acc: 0.4000
 Site-Sketch    | Val  Loss: 1.8175 | Val  Acc: 0.5217
Average Valid Accuracy: 0.4347
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5758
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5600
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5075
 Best site-Infograph  | Epoch:7 | Val Acc: 0.1500
 Best site-Painting   | Epoch:7 | Val Acc: 0.2000
 Best site-Painting   | Epoch:7 | Val Acc: 0.5455
 Best site-Painting   | Epoch:7 | Val Acc: 0.4706
 Best site-Painting   | Epoch:7 | Val Acc: 0.5652
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.0952
 Best site-Real       | Epoch:7 | Val Acc: 0.4000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 1.7094 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.7611 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.6937 | Train Acc: 0.6133
 Site-Clipart   | Train Loss: 1.6021 | Train Acc: 0.6700
 Site-Infograph | Train Loss: 2.2612 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.1425 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 1.9444 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 1.7757 | Train Acc: 0.5385
 Site-Painting  | Train Loss: 1.9828 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 2.2499 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.8013 | Train Acc: 0.5526
 Site-Sketch    | Train Loss: 1.7464 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 1.6667 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.5319 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5763 | Val  Acc: 0.6200
 Site-Clipart   | Val  Loss: 1.6606 | Val  Acc: 0.5522
 Site-Infograph | Val  Loss: 2.3314 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.7836 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8123 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 1.8858 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.7692 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.1944 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9284 | Val  Acc: 0.4400
 Site-Sketch    | Val  Loss: 1.8193 | Val  Acc: 0.4348
Average Valid Accuracy: 0.5061
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6200
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5522
 Best site-Infograph  | Epoch:8 | Val Acc: 0.1000
 Best site-Painting   | Epoch:8 | Val Acc: 0.6000
 Best site-Painting   | Epoch:8 | Val Acc: 0.4545
 Best site-Painting   | Epoch:8 | Val Acc: 0.5882
 Best site-Painting   | Epoch:8 | Val Acc: 0.7391
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.1905
 Best site-Real       | Epoch:8 | Val Acc: 0.4400
 Best site-Sketch     | Epoch:8 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6114 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7036 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 1.6248 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.5195 | Train Acc: 0.7000
 Site-Infograph | Train Loss: 2.2402 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.9397 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.7992 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.6925 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 1.9603 | Train Acc: 0.5429
 Site-QuickDraw | Train Loss: 2.2174 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.7217 | Train Acc: 0.6053
 Site-Sketch    | Train Loss: 1.7894 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.7739 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.4192 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.5285 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.6454 | Val  Acc: 0.6418
 Site-Infograph | Val  Loss: 2.4454 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.7117 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.7984 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 1.8321 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 1.7073 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2216 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8921 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.7060 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5042
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 1.6529 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.5808 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.5653 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.4899 | Train Acc: 0.7700
 Site-Infograph | Train Loss: 2.2546 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.8891 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.5578 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 1.7183 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.9863 | Train Acc: 0.4857
 Site-QuickDraw | Train Loss: 2.2012 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.6703 | Train Acc: 0.7105
 Site-Sketch    | Train Loss: 1.4828 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.6324 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.5131 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4539 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.5503 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 2.2942 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.8262 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.7300 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 1.7751 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.6904 | Val  Acc: 0.6087
 Site-QuickDraw | Val  Loss: 2.1727 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8343 | Val  Acc: 0.4400
 Site-Sketch    | Val  Loss: 1.7334 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4985
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 1.5491 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.5370 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.5129 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.4024 | Train Acc: 0.7700
 Site-Infograph | Train Loss: 2.2237 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0117 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 1.6067 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.5850 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 1.7957 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.2028 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.6254 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.5158 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.5336 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.4228 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.3456 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.4732 | Val  Acc: 0.6418
 Site-Infograph | Val  Loss: 2.3037 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.6988 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.6779 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.7423 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.5988 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2162 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.7344 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.6784 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5568
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6418
 Best site-Infograph  | Epoch:11 | Val Acc: 0.1500
 Best site-Painting   | Epoch:11 | Val Acc: 0.4000
 Best site-Painting   | Epoch:11 | Val Acc: 0.6364
 Best site-Painting   | Epoch:11 | Val Acc: 0.6471
 Best site-Painting   | Epoch:11 | Val Acc: 0.6522
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2381
 Best site-Real       | Epoch:11 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:11 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 1.5527 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.5422 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.4520 | Train Acc: 0.6933
 Site-Clipart   | Train Loss: 1.3663 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.1111 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 2.0166 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 1.7096 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 1.6633 | Train Acc: 0.5385
 Site-Painting  | Train Loss: 1.7615 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.2037 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.5198 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.4525 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.4801 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.2927 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.3611 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.4258 | Val  Acc: 0.6716
 Site-Infograph | Val  Loss: 2.2912 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.5468 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.6619 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 1.9082 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.6249 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1694 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.6742 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 1.6097 | Val  Acc: 0.5217
Average Valid Accuracy: 0.5862
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:12 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6716
 Best site-Infograph  | Epoch:12 | Val Acc: 0.3000
 Best site-Painting   | Epoch:12 | Val Acc: 0.6000
 Best site-Painting   | Epoch:12 | Val Acc: 0.4545
 Best site-Painting   | Epoch:12 | Val Acc: 0.7059
 Best site-Painting   | Epoch:12 | Val Acc: 0.7826
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.2857
 Best site-Real       | Epoch:12 | Val Acc: 0.6800
 Best site-Sketch     | Epoch:12 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 1.4273 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.5524 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.3792 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.3294 | Train Acc: 0.7900
 Site-Infograph | Train Loss: 2.1844 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.8010 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.9463 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.5795 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.6742 | Train Acc: 0.5429
 Site-QuickDraw | Train Loss: 2.2007 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.4713 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.5009 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.4314 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.2031 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.2509 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.3594 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 2.4095 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.4783 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.4197 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.6839 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.4797 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1926 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.6388 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.5747 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6409
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6866
 Best site-Infograph  | Epoch:13 | Val Acc: 0.2500
 Best site-Painting   | Epoch:13 | Val Acc: 0.8000
 Best site-Painting   | Epoch:13 | Val Acc: 0.8182
 Best site-Painting   | Epoch:13 | Val Acc: 0.6471
 Best site-Painting   | Epoch:13 | Val Acc: 0.7826
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2857
 Best site-Real       | Epoch:13 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:13 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.3224 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.3373 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.3558 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.2983 | Train Acc: 0.7800
 Site-Infograph | Train Loss: 2.1812 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.7784 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 1.9973 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.4127 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.5672 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.1926 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.3549 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.5023 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.4038 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.2167 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.1598 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.3326 | Val  Acc: 0.7015
 Site-Infograph | Val  Loss: 2.3325 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.4503 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.5341 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.5546 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.3838 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.0977 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.6117 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 1.5180 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6287
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 1.2886 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.3990 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.3172 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.2210 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.1046 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.7248 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.7775 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.4103 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.5190 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.1417 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.4140 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.3570 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4170 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.1782 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.0966 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.2578 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.3970 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.4062 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.3798 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 1.4457 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.3153 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.1493 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.5571 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.5815 | Val  Acc: 0.4783
Average Valid Accuracy: 0.6376
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 1.2670 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2309 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.2692 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.1127 | Train Acc: 0.7700
 Site-Infograph | Train Loss: 2.1254 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.6158 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.6869 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.3920 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.5731 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.1457 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.3063 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.4587 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.2599 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.2385 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.0545 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.2620 | Val  Acc: 0.7313
 Site-Infograph | Val  Loss: 2.2588 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5397 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.2474 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.4918 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.3554 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1066 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.4863 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.5234 | Val  Acc: 0.4783
Average Valid Accuracy: 0.6383
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 1.2353 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.3876 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.2464 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.1211 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 2.1165 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.6503 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.0296 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.3134 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.4462 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1085 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.3249 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.2111 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2463 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.0702 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.0786 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.1742 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.3151 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.3600 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.3719 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 1.5143 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.1888 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 2.0815 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.4953 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.5795 | Val  Acc: 0.4783
Average Valid Accuracy: 0.6726
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:17 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8060
 Best site-Infograph  | Epoch:17 | Val Acc: 0.3000
 Best site-Painting   | Epoch:17 | Val Acc: 0.6000
 Best site-Painting   | Epoch:17 | Val Acc: 0.9091
 Best site-Painting   | Epoch:17 | Val Acc: 0.7647
 Best site-Painting   | Epoch:17 | Val Acc: 0.8696
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.1429
 Best site-Real       | Epoch:17 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:17 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 1.3096 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.4596 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1984 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0568 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 2.0888 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.3995 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.0407 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.3018 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.5142 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.1702 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.4332 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.3367 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2371 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.0959 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 0.9943 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.1572 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.3160 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.1507 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.4448 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.3055 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.2498 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.0928 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.4877 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 1.4538 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6510
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0632 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.2018 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.1498 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.0157 | Train Acc: 0.8400
 Site-Infograph | Train Loss: 2.0417 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.5153 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3622 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.3419 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.3832 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.0732 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.2577 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.1872 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.2673 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.9313 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.9572 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 1.1128 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 2.1494 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.3815 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.2748 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.3176 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.2921 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.0915 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.4348 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 1.4914 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6711
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 1.1067 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.3544 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.1151 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0681 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 2.1199 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.6406 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 0.9154 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.2580 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.3878 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.0646 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.1586 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.2963 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1992 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9724 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.9234 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0947 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.2735 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.1919 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.3330 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.3965 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.2687 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.0716 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3464 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.3931 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7005
 Best site-Clipart    | Epoch:20 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4000
 Best site-Painting   | Epoch:20 | Val Acc: 0.8000
 Best site-Painting   | Epoch:20 | Val Acc: 0.8182
 Best site-Painting   | Epoch:20 | Val Acc: 0.7647
 Best site-Painting   | Epoch:20 | Val Acc: 0.8261
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.2381
 Best site-Real       | Epoch:20 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:20 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 1.0923 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.0438 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.0820 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.9594 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 2.0169 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.4422 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.0327 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.1006 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.3348 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.0177 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.2111 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.2641 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1192 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9293 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.9827 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.0732 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 2.0978 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.2834 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.2552 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.2230 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.1985 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.0341 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.4052 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.4596 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6577
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 1.0481 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0253 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0983 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.9327 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9994 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.5062 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 0.9354 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.1188 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.3674 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.0240 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.0759 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.1164 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.0979 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.9511 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 0.8854 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0717 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.2571 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.2050 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.2043 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.3692 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.1152 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 2.0686 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.3270 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.4078 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6878
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 1.1079 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9941 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.1182 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.9523 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 2.0170 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.2946 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.9632 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.1380 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.2350 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 2.0641 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.0422 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.2758 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.1186 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9654 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.8647 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.0151 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.2237 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.2915 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.3157 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.4121 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.1121 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.0229 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.2640 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.3714 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6912
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.0787 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0165 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.9642 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.8366 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9498 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.5050 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.6469 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.0832 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.4002 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 1.9795 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.1428 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.3529 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0612 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.8720 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.8722 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.9897 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 2.0958 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.0517 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9755 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 1.1848 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.1029 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.0808 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.2514 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.3606 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7246
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:24 | Val Acc: 0.5000
 Best site-Painting   | Epoch:24 | Val Acc: 0.8000
 Best site-Painting   | Epoch:24 | Val Acc: 0.9091
 Best site-Painting   | Epoch:24 | Val Acc: 0.7647
 Best site-Painting   | Epoch:24 | Val Acc: 0.7391
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.2381
 Best site-Real       | Epoch:24 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:24 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 1.1724 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.9007 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.9810 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.8279 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 1.8609 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.3557 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.9007 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 1.0704 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.3650 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 1.9539 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.0834 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.1641 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.1393 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.8341 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7672 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.9641 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 2.1509 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.0414 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2911 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.3485 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.0897 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.0261 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.2851 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.3157 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6926
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.9734 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2916 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9687 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.8593 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9533 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.2844 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.9713 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 1.0157 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.2078 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 1.9927 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.0660 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.1679 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.0412 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7686 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7578 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.9275 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.1741 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.9976 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.1876 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.1216 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 0.9950 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 1.9768 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1606 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.3218 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7235
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.9306 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.0158 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.9635 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.8859 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9927 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.1972 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.7643 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.0023 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.2162 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 1.8909 | Train Acc: 0.4375
 Site-Real      | Train Loss: 1.1956 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.1359 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.9782 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7877 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7789 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.9168 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 2.1249 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.0780 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.1925 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.0584 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.0259 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.0010 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.1971 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2791 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6990
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 1.1322 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0080 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9814 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.8039 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8008 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.3370 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3420 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.0429 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.2989 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.9025 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.9147 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.2773 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.9318 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8629 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.7418 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.8685 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 2.0183 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.0579 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0570 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.0301 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.0482 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.0063 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.2165 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.3851 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7437
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9104
 Best site-Infograph  | Epoch:28 | Val Acc: 0.4500
 Best site-Painting   | Epoch:28 | Val Acc: 0.8000
 Best site-Painting   | Epoch:28 | Val Acc: 0.8182
 Best site-Painting   | Epoch:28 | Val Acc: 0.8235
 Best site-Painting   | Epoch:28 | Val Acc: 0.8261
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.3333
 Best site-Real       | Epoch:28 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:28 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.9364 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9829 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.9008 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.8375 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.8839 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.2201 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.0903 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.9458 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.0653 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 1.9571 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.9591 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.1143 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.1135 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 0.7979 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7122 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.9183 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.2352 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.0663 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.0398 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.0274 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 1.0602 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.0334 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.2026 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.2790 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6911
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.9501 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9601 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8863 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.7329 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9470 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.1809 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 0.8078 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.9657 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.0449 | Train Acc: 0.8286
 Site-QuickDraw | Train Loss: 1.8808 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.9768 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0088 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8383 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7447 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6885 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.8802 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.2387 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.0505 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0764 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.0658 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 0.9124 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.0409 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.2334 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.2237 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7292
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.9211 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8599 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8861 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.7474 | Train Acc: 0.8900
 Site-Infograph | Train Loss: 1.7801 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.2700 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.4287 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 0.9344 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.2209 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.8779 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.9632 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0377 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9065 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7372 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7291 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.8539 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 2.1001 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8838 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0750 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 0.7877 | Val  Acc: 0.9412
 Site-Painting  | Val  Loss: 0.9018 | Val  Acc: 0.9130
 Site-QuickDraw | Val  Loss: 2.0417 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0991 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2485 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7499
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:31 | Val Acc: 0.3500
 Best site-Painting   | Epoch:31 | Val Acc: 0.8000
 Best site-Painting   | Epoch:31 | Val Acc: 0.8182
 Best site-Painting   | Epoch:31 | Val Acc: 0.9412
 Best site-Painting   | Epoch:31 | Val Acc: 0.9130
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.2381
 Best site-Real       | Epoch:31 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:31 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.9173 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8609 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8586 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7548 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.8031 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 1.2643 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 0.6383 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 1.0365 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.0893 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 1.8009 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.8644 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0443 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.9241 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7530 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.7218 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.8021 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 2.0967 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.9250 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0542 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.2623 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 0.9944 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 1.9671 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.0974 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.1629 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7154
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.8271 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0513 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8604 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7067 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.7666 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.1133 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.2737 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 0.9815 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.0247 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 1.8532 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.8594 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8710 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.9499 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6977 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6465 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.7975 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 2.2244 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.9736 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0722 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 0.8770 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.8750 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 1.9570 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.0838 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2497 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7324
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.8307 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8113 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8675 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7055 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.7798 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.2693 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.6468 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.9752 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.1583 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 1.7689 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.9145 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.2039 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.8585 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7164 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6288 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7824 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.8486 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.9238 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8667 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.0419 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.9779 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.0261 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0910 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.2525 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7537
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:34 | Val Acc: 0.4500
 Best site-Painting   | Epoch:34 | Val Acc: 0.8000
 Best site-Painting   | Epoch:34 | Val Acc: 1.0000
 Best site-Painting   | Epoch:34 | Val Acc: 0.8235
 Best site-Painting   | Epoch:34 | Val Acc: 0.7826
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.2381
 Best site-Real       | Epoch:34 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:34 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.8168 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8062 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8242 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7529 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.7819 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.2634 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.2105 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.9459 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.0681 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7989 | Train Acc: 0.5312
 Site-Real      | Train Loss: 0.8534 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.9871 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0094 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.7243 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.6270 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7721 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 2.0453 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 0.8453 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9551 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.9693 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.9103 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 1.9396 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.0128 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.1834 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7357
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.8643 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9092 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.8472 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6694 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.8342 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.1244 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.3599 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 0.9053 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.1290 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 1.8018 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.8676 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8993 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.8652 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.5928 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6202 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.7850 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.9484 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8894 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9078 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 0.9221 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.8292 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 1.9821 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.0436 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2305 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7314
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.8362 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7878 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.8376 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7414 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.6921 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.3056 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.0669 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.9497 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.1874 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.7811 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.7896 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.9704 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.8016 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7143 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5904 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.7256 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.9732 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.9682 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 0.7386 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.8583 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.8542 | Val  Acc: 0.9130
 Site-QuickDraw | Val  Loss: 1.8804 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.9956 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.1777 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7637
 Best site-Clipart    | Epoch:37 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9104
 Best site-Infograph  | Epoch:37 | Val Acc: 0.3500
 Best site-Painting   | Epoch:37 | Val Acc: 0.6000
 Best site-Painting   | Epoch:37 | Val Acc: 0.9091
 Best site-Painting   | Epoch:37 | Val Acc: 0.8235
 Best site-Painting   | Epoch:37 | Val Acc: 0.9130
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.4286
 Best site-Real       | Epoch:37 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:37 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.7829 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8185 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8016 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.6559 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.7937 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.0858 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.1948 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 0.9396 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 0.9092 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 1.7012 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.8932 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.2908 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.8965 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.6381 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6280 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.7870 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 2.0816 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.8209 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7856 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.8427 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.8103 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 1.9876 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.0301 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2041 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7614
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.7258 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7593 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7652 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.6561 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.8310 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.9111 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3786 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 0.8323 | Train Acc: 0.9615
 Site-Painting  | Train Loss: 0.8306 | Train Acc: 0.8286
 Site-QuickDraw | Train Loss: 1.7116 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.8631 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0665 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 0.7192 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6709 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5904 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7677 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 2.0795 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.7411 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.9004 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 0.7153 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.8475 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 1.9551 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.9622 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.1624 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7890
 Best site-Clipart    | Epoch:39 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8955
 Best site-Infograph  | Epoch:39 | Val Acc: 0.3500
 Best site-Painting   | Epoch:39 | Val Acc: 1.0000
 Best site-Painting   | Epoch:39 | Val Acc: 0.8182
 Best site-Painting   | Epoch:39 | Val Acc: 0.8824
 Best site-Painting   | Epoch:39 | Val Acc: 0.8696
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.3810
 Best site-Real       | Epoch:39 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:39 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8308
 Test site-Infograph | Epoch:39 | Test Acc: 0.4444
 Test site-Painting  | Epoch:39 | Test Acc: 0.8110
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.4760
 Test site-Real      | Epoch:39 | Test Acc: 0.8759
 Test site-Sketch    | Epoch:39 | Test Acc: 0.7401
Average Test Accuracy: 0.6964
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.7735 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8155 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7827 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7110 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.6761 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 1.1307 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 0.7290 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 0.8932 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.0301 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.6442 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.8481 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.9076 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8500 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.5958 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5271 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.7629 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.9912 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.7587 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.9002 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.7678 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.8896 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 1.9327 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.0413 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.2079 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7838
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.7514 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8921 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7114 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.6860 | Train Acc: 0.8900
 Site-Infograph | Train Loss: 1.6844 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.1173 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 0.7985 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.8861 | Train Acc: 0.8846
 Site-Painting  | Train Loss: 1.1778 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 1.7102 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.7378 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8134 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.6746 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6465 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5460 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7473 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.8684 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8121 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.8078 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 0.9240 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.8286 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 1.8073 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.0086 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.1582 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7827
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.8472 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7715 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.7666 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.6582 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.7237 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 1.0947 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.2403 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 0.9698 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 0.9073 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.6873 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.8121 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.7358 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.7508 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6593 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5290 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.7173 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.9784 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.7028 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.9428 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.0618 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 0.7414 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 1.8721 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.9360 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.1381 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7666
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.5932 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7465 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7084 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5864 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.6695 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.0893 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.3406 | Train Acc: 0.8824
 Site-Painting  | Train Loss: 0.8867 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 0.9523 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.6494 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.7450 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.7379 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.7202 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.5517 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5929 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6950 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 2.0032 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.7705 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7627 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.7016 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.8272 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 1.8541 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.9377 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.0919 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7691
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.7429 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6867 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6876 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.6198 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.6584 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.0438 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.4007 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.8480 | Train Acc: 0.9231
 Site-Painting  | Train Loss: 1.0891 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.6378 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.7540 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8850 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6961 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6066 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5208 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7430 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.9823 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.7611 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9555 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.8232 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.7855 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 1.9165 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9092 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.0816 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7701
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.7142 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8957 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.7124 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.6464 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.6754 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.0476 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.1036 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 0.8042 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 0.7919 | Train Acc: 0.8286
 Site-QuickDraw | Train Loss: 1.6916 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.8583 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.7754 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7049 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5929 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5589 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6626 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.9164 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.6549 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8136 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.8538 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.7498 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 1.8170 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.9900 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.1049 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7786
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.7148 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.9005 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6603 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5912 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.6587 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.0773 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.6630 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.9353 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 0.9272 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.5790 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.7949 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0058 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.7665 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.5708 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5232 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.6702 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 2.0679 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.7988 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8007 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.7388 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 0.8145 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 1.8413 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.9407 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.0740 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7686
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.7380 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6475 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.6654 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5766 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.6040 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.0711 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.5487 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.8330 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 0.7406 | Train Acc: 0.8857
 Site-QuickDraw | Train Loss: 1.6014 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.6371 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8933 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6236 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5757 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5292 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.5892 | Val  Acc: 0.9254
 Site-Infograph | Val  Loss: 1.9211 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.7443 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.9089 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 0.6934 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.7026 | Val  Acc: 0.8696
 Site-QuickDraw | Val  Loss: 1.7790 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.9718 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.1982 | Val  Acc: 0.6087
Average Valid Accuracy: 0.8134
 Best site-Clipart    | Epoch:47 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:47 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:47 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:47 | Val Acc: 0.9254
 Best site-Infograph  | Epoch:47 | Val Acc: 0.4500
 Best site-Painting   | Epoch:47 | Val Acc: 1.0000
 Best site-Painting   | Epoch:47 | Val Acc: 0.9091
 Best site-Painting   | Epoch:47 | Val Acc: 0.8824
 Best site-Painting   | Epoch:47 | Val Acc: 0.8696
 Best site-QuickDraw  | Epoch:47 | Val Acc: 0.4762
 Best site-Real       | Epoch:47 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:47 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.6429 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6538 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.6629 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6109 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.6241 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 1.0054 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.9022 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.8493 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 0.8233 | Train Acc: 0.8857
 Site-QuickDraw | Train Loss: 1.5578 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.7304 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.7827 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.7116 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.5589 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5225 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6758 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 2.0341 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.7209 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7115 | Val  Acc: 0.9091
 Site-Painting  | Val  Loss: 1.0186 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 0.7647 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 1.8093 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.9056 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.0860 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7599
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.6933 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7671 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6833 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5409 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.5307 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.9983 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.5671 | Train Acc: 0.8235
 Site-Painting  | Train Loss: 0.8653 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 0.8910 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.6170 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.7014 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.9550 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.7193 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.5415 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5432 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6429 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.9275 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.6529 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7882 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.8423 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 0.6917 | Val  Acc: 0.9130
 Site-QuickDraw | Val  Loss: 1.7921 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.8804 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.0924 | Val  Acc: 0.6087
Average Valid Accuracy: 0.8027
===2023-04-19 12:22:56===
===2023-04-19 12:22:58===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:47 | Test Acc: 0.8441
 Test site-Infograph | Epoch:47 | Test Acc: 0.4521
 Test site-Painting  | Epoch:47 | Test Acc: 0.8239
 Test site-QuickDraw | Epoch:47 | Test Acc: 0.5110
 Test site-Real      | Epoch:47 | Test Acc: 0.8956
 Test site-Sketch    | Epoch:47 | Test Acc: 0.7635
Average Test Accuracy: 0.7150
===2023-04-21 00:00:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
===2023-04-21 00:01:00===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
===2023-04-21 10:55:49===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 2.2897 | Train Acc: 0.0800
 Site-Clipart   | Train Loss: 2.3081 | Train Acc: 0.1200
 Site-Clipart   | Train Loss: 2.2800 | Train Acc: 0.1200
 Site-Clipart   | Train Loss: 2.2791 | Train Acc: 0.1600
 Site-Infograph | Train Loss: 2.2829 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.3245 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.3117 | Train Acc: 0.1176
 Site-Painting  | Train Loss: 2.2740 | Train Acc: 0.2692
 Site-Painting  | Train Loss: 2.3213 | Train Acc: 0.0857
 Site-QuickDraw | Train Loss: 2.2770 | Train Acc: 0.1562
 Site-Real      | Train Loss: 2.2655 | Train Acc: 0.1579
 Site-Sketch    | Train Loss: 2.3213 | Train Acc: 0.1429
 Site-Clipart   | Val  Loss: 2.3079 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.3018 | Val  Acc: 0.0909
 Site-Clipart   | Val  Loss: 2.2831 | Val  Acc: 0.1200
 Site-Clipart   | Val  Loss: 2.2814 | Val  Acc: 0.1194
 Site-Infograph | Val  Loss: 2.2832 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.2784 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2728 | Val  Acc: 0.1818
 Site-Painting  | Val  Loss: 2.1905 | Val  Acc: 0.1176
 Site-Painting  | Val  Loss: 2.2751 | Val  Acc: 0.1304
 Site-QuickDraw | Val  Loss: 2.3518 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2804 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 2.2644 | Val  Acc: 0.1739
Average Valid Accuracy: 0.1402
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0625
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0909
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1200
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1194
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1500
 Best site-Painting   | Epoch:0 | Val Acc: 0.2000
 Best site-Painting   | Epoch:0 | Val Acc: 0.1818
 Best site-Painting   | Epoch:0 | Val Acc: 0.1176
 Best site-Painting   | Epoch:0 | Val Acc: 0.1304
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.2655 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.3015 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2658 | Train Acc: 0.1200
 Site-Clipart   | Train Loss: 2.2787 | Train Acc: 0.2100
 Site-Infograph | Train Loss: 2.2814 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2943 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.3984 | Train Acc: 0.0588
 Site-Painting  | Train Loss: 2.2774 | Train Acc: 0.1154
 Site-Painting  | Train Loss: 2.2637 | Train Acc: 0.0857
 Site-QuickDraw | Train Loss: 2.2741 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.2502 | Train Acc: 0.1842
 Site-Sketch    | Train Loss: 2.2633 | Train Acc: 0.1143
 Site-Clipart   | Val  Loss: 2.2788 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2842 | Val  Acc: 0.0606
 Site-Clipart   | Val  Loss: 2.2628 | Val  Acc: 0.0600
 Site-Clipart   | Val  Loss: 2.2645 | Val  Acc: 0.1343
 Site-Infograph | Val  Loss: 2.2897 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2602 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2943 | Val  Acc: 0.1818
 Site-Painting  | Val  Loss: 2.1758 | Val  Acc: 0.1176
 Site-Painting  | Val  Loss: 2.2531 | Val  Acc: 0.2609
 Site-QuickDraw | Val  Loss: 2.3289 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2620 | Val  Acc: 0.2000
 Site-Sketch    | Val  Loss: 2.2576 | Val  Acc: 0.2609
Average Valid Accuracy: 0.1478
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0606
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0600
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1343
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2500
 Best site-Painting   | Epoch:1 | Val Acc: 0.2000
 Best site-Painting   | Epoch:1 | Val Acc: 0.1818
 Best site-Painting   | Epoch:1 | Val Acc: 0.1176
 Best site-Painting   | Epoch:1 | Val Acc: 0.2609
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0476
 Best site-Real       | Epoch:1 | Val Acc: 0.2000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 2.2664 | Train Acc: 0.0800
 Site-Clipart   | Train Loss: 2.2944 | Train Acc: 0.2200
 Site-Clipart   | Train Loss: 2.2559 | Train Acc: 0.1733
 Site-Clipart   | Train Loss: 2.2531 | Train Acc: 0.2100
 Site-Infograph | Train Loss: 2.2821 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2945 | Train Acc: 0.0000
 Site-Painting  | Train Loss: 2.2634 | Train Acc: 0.0588
 Site-Painting  | Train Loss: 2.2720 | Train Acc: 0.1538
 Site-Painting  | Train Loss: 2.2773 | Train Acc: 0.1143
 Site-QuickDraw | Train Loss: 2.2729 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.2530 | Train Acc: 0.2632
 Site-Sketch    | Train Loss: 2.2557 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.2596 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.2741 | Val  Acc: 0.2121
 Site-Clipart   | Val  Loss: 2.2375 | Val  Acc: 0.1800
 Site-Clipart   | Val  Loss: 2.2500 | Val  Acc: 0.1791
 Site-Infograph | Val  Loss: 2.2910 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2746 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2706 | Val  Acc: 0.0909
 Site-Painting  | Val  Loss: 2.1644 | Val  Acc: 0.1176
 Site-Painting  | Val  Loss: 2.2567 | Val  Acc: 0.2174
 Site-QuickDraw | Val  Loss: 2.3455 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2512 | Val  Acc: 0.2800
 Site-Sketch    | Val  Loss: 2.2451 | Val  Acc: 0.2609
Average Valid Accuracy: 0.1926
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2121
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1800
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1791
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2000
 Best site-Painting   | Epoch:2 | Val Acc: 0.4000
 Best site-Painting   | Epoch:2 | Val Acc: 0.0909
 Best site-Painting   | Epoch:2 | Val Acc: 0.1176
 Best site-Painting   | Epoch:2 | Val Acc: 0.2174
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.0476
 Best site-Real       | Epoch:2 | Val Acc: 0.2800
 Best site-Sketch     | Epoch:2 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 2.2372 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2745 | Train Acc: 0.2200
 Site-Clipart   | Train Loss: 2.2347 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2593 | Train Acc: 0.2600
 Site-Infograph | Train Loss: 2.2663 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.2858 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.2266 | Train Acc: 0.1176
 Site-Painting  | Train Loss: 2.2252 | Train Acc: 0.3462
 Site-Painting  | Train Loss: 2.2832 | Train Acc: 0.2000
 Site-QuickDraw | Train Loss: 2.2677 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.2245 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 2.2700 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.2411 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 2.2563 | Val  Acc: 0.2424
 Site-Clipart   | Val  Loss: 2.2167 | Val  Acc: 0.2600
 Site-Clipart   | Val  Loss: 2.2254 | Val  Acc: 0.2985
 Site-Infograph | Val  Loss: 2.2863 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2740 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.2383 | Val  Acc: 0.2727
 Site-Painting  | Val  Loss: 2.2053 | Val  Acc: 0.1765
 Site-Painting  | Val  Loss: 2.2591 | Val  Acc: 0.2609
 Site-QuickDraw | Val  Loss: 2.3242 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2520 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 2.2211 | Val  Acc: 0.2609
Average Valid Accuracy: 0.2579
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2424
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2600
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2985
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2000
 Best site-Painting   | Epoch:3 | Val Acc: 0.6000
 Best site-Painting   | Epoch:3 | Val Acc: 0.2727
 Best site-Painting   | Epoch:3 | Val Acc: 0.1765
 Best site-Painting   | Epoch:3 | Val Acc: 0.2609
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.0952
 Best site-Real       | Epoch:3 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:3 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.2240 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2649 | Train Acc: 0.2200
 Site-Clipart   | Train Loss: 2.2239 | Train Acc: 0.2267
 Site-Clipart   | Train Loss: 2.2242 | Train Acc: 0.3400
 Site-Infograph | Train Loss: 2.2850 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2557 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.3849 | Train Acc: 0.1765
 Site-Painting  | Train Loss: 2.2330 | Train Acc: 0.3462
 Site-Painting  | Train Loss: 2.2711 | Train Acc: 0.2571
 Site-QuickDraw | Train Loss: 2.2552 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.2076 | Train Acc: 0.3684
 Site-Sketch    | Train Loss: 2.2284 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.2213 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 2.2325 | Val  Acc: 0.2424
 Site-Clipart   | Val  Loss: 2.1993 | Val  Acc: 0.3600
 Site-Clipart   | Val  Loss: 2.2119 | Val  Acc: 0.3134
 Site-Infograph | Val  Loss: 2.2916 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2155 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.2259 | Val  Acc: 0.2727
 Site-Painting  | Val  Loss: 2.2126 | Val  Acc: 0.2353
 Site-Painting  | Val  Loss: 2.2409 | Val  Acc: 0.3478
 Site-QuickDraw | Val  Loss: 2.3178 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2360 | Val  Acc: 0.2800
 Site-Sketch    | Val  Loss: 2.2096 | Val  Acc: 0.2609
Average Valid Accuracy: 0.2894
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3125
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2424
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3600
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3134
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2000
 Best site-Painting   | Epoch:4 | Val Acc: 0.6000
 Best site-Painting   | Epoch:4 | Val Acc: 0.2727
 Best site-Painting   | Epoch:4 | Val Acc: 0.2353
 Best site-Painting   | Epoch:4 | Val Acc: 0.3478
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.0476
 Best site-Real       | Epoch:4 | Val Acc: 0.2800
 Best site-Sketch     | Epoch:4 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 2.1988 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2169 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.1982 | Train Acc: 0.2933
 Site-Clipart   | Train Loss: 2.2117 | Train Acc: 0.3400
 Site-Infograph | Train Loss: 2.2758 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2707 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.1834 | Train Acc: 0.2941
 Site-Painting  | Train Loss: 2.2259 | Train Acc: 0.3462
 Site-Painting  | Train Loss: 2.2335 | Train Acc: 0.2571
 Site-QuickDraw | Train Loss: 2.2628 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.1724 | Train Acc: 0.4474
 Site-Sketch    | Train Loss: 2.1828 | Train Acc: 0.3714
 Site-Clipart   | Val  Loss: 2.2050 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.1901 | Val  Acc: 0.3939
 Site-Clipart   | Val  Loss: 2.1809 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.1992 | Val  Acc: 0.3134
 Site-Infograph | Val  Loss: 2.2753 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2302 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2276 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.1509 | Val  Acc: 0.2941
 Site-Painting  | Val  Loss: 2.1973 | Val  Acc: 0.3478
 Site-QuickDraw | Val  Loss: 2.3225 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2220 | Val  Acc: 0.2800
 Site-Sketch    | Val  Loss: 2.1957 | Val  Acc: 0.3043
Average Valid Accuracy: 0.3267
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3939
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3134
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2000
 Best site-Painting   | Epoch:5 | Val Acc: 0.4000
 Best site-Painting   | Epoch:5 | Val Acc: 0.4545
 Best site-Painting   | Epoch:5 | Val Acc: 0.2941
 Best site-Painting   | Epoch:5 | Val Acc: 0.3478
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.0952
 Best site-Real       | Epoch:5 | Val Acc: 0.2800
 Best site-Sketch     | Epoch:5 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 2.1988 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.2295 | Train Acc: 0.3200
 Site-Clipart   | Train Loss: 2.1830 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 2.1899 | Train Acc: 0.4100
 Site-Infograph | Train Loss: 2.2562 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2341 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.2768 | Train Acc: 0.4118
 Site-Painting  | Train Loss: 2.2024 | Train Acc: 0.3462
 Site-Painting  | Train Loss: 2.2426 | Train Acc: 0.3714
 Site-QuickDraw | Train Loss: 2.2514 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.1604 | Train Acc: 0.5000
 Site-Sketch    | Train Loss: 2.1809 | Train Acc: 0.3429
 Site-Clipart   | Val  Loss: 2.1757 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1789 | Val  Acc: 0.4242
 Site-Clipart   | Val  Loss: 2.1679 | Val  Acc: 0.3400
 Site-Clipart   | Val  Loss: 2.1830 | Val  Acc: 0.3582
 Site-Infograph | Val  Loss: 2.2846 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1999 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.1872 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.1892 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 2.2181 | Val  Acc: 0.3478
 Site-QuickDraw | Val  Loss: 2.3220 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2006 | Val  Acc: 0.3600
 Site-Sketch    | Val  Loss: 2.1795 | Val  Acc: 0.3913
Average Valid Accuracy: 0.3530
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4242
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3400
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3582
 Best site-Infograph  | Epoch:6 | Val Acc: 0.2000
 Best site-Painting   | Epoch:6 | Val Acc: 0.4000
 Best site-Painting   | Epoch:6 | Val Acc: 0.4545
 Best site-Painting   | Epoch:6 | Val Acc: 0.4118
 Best site-Painting   | Epoch:6 | Val Acc: 0.3478
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.0476
 Best site-Real       | Epoch:6 | Val Acc: 0.3600
 Best site-Sketch     | Epoch:6 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 2.2101 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 2.2069 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1647 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 2.1877 | Train Acc: 0.3800
 Site-Infograph | Train Loss: 2.2676 | Train Acc: 0.0645
 Site-Painting  | Train Loss: 2.2329 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.2407 | Train Acc: 0.3529
 Site-Painting  | Train Loss: 2.2003 | Train Acc: 0.4231
 Site-Painting  | Train Loss: 2.2209 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.2667 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.1839 | Train Acc: 0.5000
 Site-Sketch    | Train Loss: 2.1846 | Train Acc: 0.3143
 Site-Clipart   | Val  Loss: 2.1614 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.1808 | Val  Acc: 0.3939
 Site-Clipart   | Val  Loss: 2.1438 | Val  Acc: 0.3400
 Site-Clipart   | Val  Loss: 2.1461 | Val  Acc: 0.4925
 Site-Infograph | Val  Loss: 2.2882 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1877 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1942 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.1589 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 2.1957 | Val  Acc: 0.3913
 Site-QuickDraw | Val  Loss: 2.3177 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.1889 | Val  Acc: 0.3200
 Site-Sketch    | Val  Loss: 2.1639 | Val  Acc: 0.3478
Average Valid Accuracy: 0.3698
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.3939
 Best site-Clipart    | Epoch:7 | Val Acc: 0.3400
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4925
 Best site-Infograph  | Epoch:7 | Val Acc: 0.2000
 Best site-Painting   | Epoch:7 | Val Acc: 0.6000
 Best site-Painting   | Epoch:7 | Val Acc: 0.4545
 Best site-Painting   | Epoch:7 | Val Acc: 0.4118
 Best site-Painting   | Epoch:7 | Val Acc: 0.3913
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.0476
 Best site-Real       | Epoch:7 | Val Acc: 0.3200
 Best site-Sketch     | Epoch:7 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 2.1706 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 2.1756 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 2.1684 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.1758 | Train Acc: 0.4800
 Site-Infograph | Train Loss: 2.2728 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2551 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.0625 | Train Acc: 0.2353
 Site-Painting  | Train Loss: 2.1749 | Train Acc: 0.5385
 Site-Painting  | Train Loss: 2.2017 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 2.2554 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.1506 | Train Acc: 0.5263
 Site-Sketch    | Train Loss: 2.1794 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1512 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.1735 | Val  Acc: 0.4242
 Site-Clipart   | Val  Loss: 2.1325 | Val  Acc: 0.4200
 Site-Clipart   | Val  Loss: 2.1594 | Val  Acc: 0.4328
 Site-Infograph | Val  Loss: 2.2899 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1964 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1693 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.1240 | Val  Acc: 0.4706
 Site-Painting  | Val  Loss: 2.1944 | Val  Acc: 0.3913
 Site-QuickDraw | Val  Loss: 2.3012 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1901 | Val  Acc: 0.4000
 Site-Sketch    | Val  Loss: 2.1562 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4013
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4242
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4200
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4328
 Best site-Infograph  | Epoch:8 | Val Acc: 0.2500
 Best site-Painting   | Epoch:8 | Val Acc: 0.6000
 Best site-Painting   | Epoch:8 | Val Acc: 0.4545
 Best site-Painting   | Epoch:8 | Val Acc: 0.4706
 Best site-Painting   | Epoch:8 | Val Acc: 0.3913
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.1429
 Best site-Real       | Epoch:8 | Val Acc: 0.4000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.1505 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.1709 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1366 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 2.1350 | Train Acc: 0.4600
 Site-Infograph | Train Loss: 2.2525 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.2461 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.3017 | Train Acc: 0.4118
 Site-Painting  | Train Loss: 2.1644 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.2085 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.2376 | Train Acc: 0.2812
 Site-Real      | Train Loss: 2.1121 | Train Acc: 0.5000
 Site-Sketch    | Train Loss: 2.1681 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1486 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 2.1475 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1137 | Val  Acc: 0.4400
 Site-Clipart   | Val  Loss: 2.1366 | Val  Acc: 0.5075
 Site-Infograph | Val  Loss: 2.2891 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2013 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1624 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.1658 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 2.1643 | Val  Acc: 0.4783
 Site-QuickDraw | Val  Loss: 2.3014 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1645 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 2.1360 | Val  Acc: 0.4783
Average Valid Accuracy: 0.4339
 Best site-Clipart    | Epoch:9 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:9 | Val Acc: 0.4400
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5075
 Best site-Infograph  | Epoch:9 | Val Acc: 0.2500
 Best site-Painting   | Epoch:9 | Val Acc: 0.6000
 Best site-Painting   | Epoch:9 | Val Acc: 0.5455
 Best site-Painting   | Epoch:9 | Val Acc: 0.4118
 Best site-Painting   | Epoch:9 | Val Acc: 0.4783
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.0952
 Best site-Real       | Epoch:9 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:9 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.4905
 Test site-Infograph | Epoch:9 | Test Acc: 0.2116
 Test site-Painting  | Epoch:9 | Test Acc: 0.5057
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.1550
 Test site-Real      | Epoch:9 | Test Acc: 0.4906
 Test site-Sketch    | Epoch:9 | Test Acc: 0.4440
Average Test Accuracy: 0.3829
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 2.1382 | Train Acc: 0.3200
 Site-Clipart   | Train Loss: 2.1469 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 2.1325 | Train Acc: 0.4933
 Site-Clipart   | Train Loss: 2.1427 | Train Acc: 0.4600
 Site-Infograph | Train Loss: 2.2494 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2103 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.0945 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 2.1374 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.1616 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.2421 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.1271 | Train Acc: 0.6053
 Site-Sketch    | Train Loss: 2.1406 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 2.1164 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 2.1414 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.0977 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1254 | Val  Acc: 0.5075
 Site-Infograph | Val  Loss: 2.2779 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1739 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1508 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.1174 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 2.1470 | Val  Acc: 0.5217
 Site-QuickDraw | Val  Loss: 2.3005 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1536 | Val  Acc: 0.5200
 Site-Sketch    | Val  Loss: 2.1261 | Val  Acc: 0.4783
Average Valid Accuracy: 0.4720
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:10 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5075
 Best site-Infograph  | Epoch:10 | Val Acc: 0.2000
 Best site-Painting   | Epoch:10 | Val Acc: 0.6000
 Best site-Painting   | Epoch:10 | Val Acc: 0.6364
 Best site-Painting   | Epoch:10 | Val Acc: 0.5882
 Best site-Painting   | Epoch:10 | Val Acc: 0.5217
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.0952
 Best site-Real       | Epoch:10 | Val Acc: 0.5200
 Best site-Sketch     | Epoch:10 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 2.1276 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1437 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.1137 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 2.0955 | Train Acc: 0.4900
 Site-Infograph | Train Loss: 2.2722 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2133 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.1962 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.1405 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.1620 | Train Acc: 0.4857
 Site-QuickDraw | Train Loss: 2.2517 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.1241 | Train Acc: 0.7105
 Site-Sketch    | Train Loss: 2.1619 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 2.0868 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0747 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0772 | Val  Acc: 0.5800
 Site-Clipart   | Val  Loss: 2.1042 | Val  Acc: 0.5373
 Site-Infograph | Val  Loss: 2.2823 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.1549 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1619 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.1198 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 2.1247 | Val  Acc: 0.4783
 Site-QuickDraw | Val  Loss: 2.3096 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1314 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 2.0921 | Val  Acc: 0.4783
Average Valid Accuracy: 0.4935
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5800
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5373
 Best site-Infograph  | Epoch:11 | Val Acc: 0.1500
 Best site-Painting   | Epoch:11 | Val Acc: 0.6000
 Best site-Painting   | Epoch:11 | Val Acc: 0.5455
 Best site-Painting   | Epoch:11 | Val Acc: 0.5882
 Best site-Painting   | Epoch:11 | Val Acc: 0.4783
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.1429
 Best site-Real       | Epoch:11 | Val Acc: 0.5600
 Best site-Sketch     | Epoch:11 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 2.0908 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 2.1440 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 2.0949 | Train Acc: 0.5733
 Site-Clipart   | Train Loss: 2.0871 | Train Acc: 0.5200
 Site-Infograph | Train Loss: 2.2483 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1686 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.2141 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 2.1355 | Train Acc: 0.5385
 Site-Painting  | Train Loss: 2.1848 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 2.2526 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.1051 | Train Acc: 0.6316
 Site-Sketch    | Train Loss: 2.1319 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 2.1045 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0970 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 2.0510 | Val  Acc: 0.5200
 Site-Clipart   | Val  Loss: 2.0799 | Val  Acc: 0.5970
 Site-Infograph | Val  Loss: 2.2434 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1526 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1486 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.1164 | Val  Acc: 0.4706
 Site-Painting  | Val  Loss: 2.1368 | Val  Acc: 0.4783
 Site-QuickDraw | Val  Loss: 2.2801 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.1284 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 2.0910 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4758
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 2.0582 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 2.1171 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 2.0790 | Train Acc: 0.5733
 Site-Clipart   | Train Loss: 2.0888 | Train Acc: 0.6100
 Site-Infograph | Train Loss: 2.2334 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2005 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.0586 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 2.1441 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.1348 | Train Acc: 0.5143
 Site-QuickDraw | Train Loss: 2.2519 | Train Acc: 0.2812
 Site-Real      | Train Loss: 2.0942 | Train Acc: 0.6842
 Site-Sketch    | Train Loss: 2.0926 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 2.0683 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0737 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.0273 | Val  Acc: 0.5600
 Site-Clipart   | Val  Loss: 2.0820 | Val  Acc: 0.5970
 Site-Infograph | Val  Loss: 2.2643 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1326 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1382 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.0998 | Val  Acc: 0.4706
 Site-Painting  | Val  Loss: 2.1183 | Val  Acc: 0.4348
 Site-QuickDraw | Val  Loss: 2.2890 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1116 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 2.0803 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4897
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 2.0637 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0845 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 2.0561 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0774 | Train Acc: 0.5600
 Site-Infograph | Train Loss: 2.2430 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1632 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.0086 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 2.1160 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.1032 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 2.2198 | Train Acc: 0.2812
 Site-Real      | Train Loss: 2.0613 | Train Acc: 0.7105
 Site-Sketch    | Train Loss: 2.1489 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 2.0505 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 2.0755 | Val  Acc: 0.5152
 Site-Clipart   | Val  Loss: 2.0098 | Val  Acc: 0.5400
 Site-Clipart   | Val  Loss: 2.0736 | Val  Acc: 0.5373
 Site-Infograph | Val  Loss: 2.2736 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.1377 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1070 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.1095 | Val  Acc: 0.4706
 Site-Painting  | Val  Loss: 2.0953 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2666 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.1048 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 2.0590 | Val  Acc: 0.5217
Average Valid Accuracy: 0.4938
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5152
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5400
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5373
 Best site-Infograph  | Epoch:14 | Val Acc: 0.1500
 Best site-Painting   | Epoch:14 | Val Acc: 0.6000
 Best site-Painting   | Epoch:14 | Val Acc: 0.5455
 Best site-Painting   | Epoch:14 | Val Acc: 0.4706
 Best site-Painting   | Epoch:14 | Val Acc: 0.6522
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.1905
 Best site-Real       | Epoch:14 | Val Acc: 0.6400
 Best site-Sketch     | Epoch:14 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 2.0851 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.1066 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 2.0535 | Train Acc: 0.5733
 Site-Clipart   | Train Loss: 2.0603 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 2.2432 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.1712 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.1857 | Train Acc: 0.4118
 Site-Painting  | Train Loss: 2.1006 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.1629 | Train Acc: 0.5429
 Site-QuickDraw | Train Loss: 2.2238 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.0714 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 2.0843 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0398 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0549 | Val  Acc: 0.5152
 Site-Clipart   | Val  Loss: 2.0071 | Val  Acc: 0.5800
 Site-Clipart   | Val  Loss: 2.0538 | Val  Acc: 0.6269
 Site-Infograph | Val  Loss: 2.2895 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.1264 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1306 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.0752 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 2.1091 | Val  Acc: 0.4348
 Site-QuickDraw | Val  Loss: 2.2847 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 2.1046 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 2.0560 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5042
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:15 | Val Acc: 0.5152
 Best site-Clipart    | Epoch:15 | Val Acc: 0.5800
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6269
 Best site-Infograph  | Epoch:15 | Val Acc: 0.1500
 Best site-Painting   | Epoch:15 | Val Acc: 0.6000
 Best site-Painting   | Epoch:15 | Val Acc: 0.5455
 Best site-Painting   | Epoch:15 | Val Acc: 0.5294
 Best site-Painting   | Epoch:15 | Val Acc: 0.4348
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2381
 Best site-Real       | Epoch:15 | Val Acc: 0.6400
 Best site-Sketch     | Epoch:15 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 2.0476 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.1012 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0298 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 2.0277 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 2.2259 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2329 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.0428 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 2.0654 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.1440 | Train Acc: 0.5429
 Site-QuickDraw | Train Loss: 2.2195 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0412 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 2.0674 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0180 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0546 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.9805 | Val  Acc: 0.5600
 Site-Clipart   | Val  Loss: 2.0253 | Val  Acc: 0.6716
 Site-Infograph | Val  Loss: 2.2741 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.1010 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1200 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0785 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 2.0969 | Val  Acc: 0.4783
 Site-QuickDraw | Val  Loss: 2.2750 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.0757 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 2.0420 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5378
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:16 | Val Acc: 0.5600
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6716
 Best site-Infograph  | Epoch:16 | Val Acc: 0.1500
 Best site-Painting   | Epoch:16 | Val Acc: 0.6000
 Best site-Painting   | Epoch:16 | Val Acc: 0.6364
 Best site-Painting   | Epoch:16 | Val Acc: 0.6471
 Best site-Painting   | Epoch:16 | Val Acc: 0.4783
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.1905
 Best site-Real       | Epoch:16 | Val Acc: 0.6800
 Best site-Sketch     | Epoch:16 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 2.0494 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0182 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 2.0316 | Train Acc: 0.6133
 Site-Clipart   | Train Loss: 2.0369 | Train Acc: 0.6100
 Site-Infograph | Train Loss: 2.2300 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1891 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 2.0172 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.0484 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 2.1243 | Train Acc: 0.5429
 Site-QuickDraw | Train Loss: 2.2363 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.0440 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 2.0638 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 1.9971 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 2.0193 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 1.9751 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0231 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 2.2576 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.0673 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0848 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.0969 | Val  Acc: 0.4706
 Site-Painting  | Val  Loss: 2.0699 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.2785 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0704 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 2.0333 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5120
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 2.0640 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.0575 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0106 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.9977 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 2.2365 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1520 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 2.2417 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.0575 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.1085 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.2135 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.0367 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 2.0311 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 1.9928 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.9980 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9415 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 2.0121 | Val  Acc: 0.6567
 Site-Infograph | Val  Loss: 2.2664 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.1116 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.0393 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0668 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 2.0678 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.2816 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.0498 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 2.0445 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5246
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 2.0415 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 2.0537 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.9943 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.9986 | Train Acc: 0.6100
 Site-Infograph | Train Loss: 2.2122 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1456 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 2.0124 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.0157 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 2.1221 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1956 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.9957 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.9951 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.9682 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0028 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.9280 | Val  Acc: 0.6400
 Site-Clipart   | Val  Loss: 1.9862 | Val  Acc: 0.6418
 Site-Infograph | Val  Loss: 2.2561 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0597 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0099 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 2.0638 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 2.0462 | Val  Acc: 0.5217
 Site-QuickDraw | Val  Loss: 2.2380 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 2.0572 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 1.9988 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5615
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6400
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6418
 Best site-Infograph  | Epoch:19 | Val Acc: 0.2000
 Best site-Painting   | Epoch:19 | Val Acc: 0.6000
 Best site-Painting   | Epoch:19 | Val Acc: 0.7273
 Best site-Painting   | Epoch:19 | Val Acc: 0.5882
 Best site-Painting   | Epoch:19 | Val Acc: 0.5217
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.2381
 Best site-Real       | Epoch:19 | Val Acc: 0.6800
 Best site-Sketch     | Epoch:19 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.6388
 Test site-Infograph | Epoch:19 | Test Acc: 0.3151
 Test site-Painting  | Epoch:19 | Test Acc: 0.6882
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.1760
 Test site-Real      | Epoch:19 | Test Acc: 0.7658
 Test site-Sketch    | Epoch:19 | Test Acc: 0.5975
Average Test Accuracy: 0.5302
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 2.0068 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9906 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9732 | Train Acc: 0.6933
 Site-Clipart   | Train Loss: 2.0099 | Train Acc: 0.6100
 Site-Infograph | Train Loss: 2.2308 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.1349 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 2.0205 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 2.0759 | Train Acc: 0.5385
 Site-Painting  | Train Loss: 2.0520 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.2023 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.9843 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 2.0622 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 1.9622 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.9783 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9167 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.9717 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.2419 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.0144 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 2.0483 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.0546 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 2.0096 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2510 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 2.0482 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 1.9955 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5926
 Best site-Clipart    | Epoch:20 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6600
 Best site-Clipart    | Epoch:20 | Val Acc: 0.7612
 Best site-Infograph  | Epoch:20 | Val Acc: 0.2500
 Best site-Painting   | Epoch:20 | Val Acc: 0.8000
 Best site-Painting   | Epoch:20 | Val Acc: 0.5455
 Best site-Painting   | Epoch:20 | Val Acc: 0.5294
 Best site-Painting   | Epoch:20 | Val Acc: 0.6957
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.2381
 Best site-Real       | Epoch:20 | Val Acc: 0.6800
 Best site-Sketch     | Epoch:20 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 1.9720 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 2.0407 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9658 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.9716 | Train Acc: 0.6700
 Site-Infograph | Train Loss: 2.2097 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1033 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 2.2338 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.0213 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 2.0607 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 2.2062 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.0079 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 2.0142 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.9454 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.9878 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9148 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.9712 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 2.2601 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0795 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9993 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0691 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 2.0136 | Val  Acc: 0.5217
 Site-QuickDraw | Val  Loss: 2.2440 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0093 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.9736 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5660
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 1.9936 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9257 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9653 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.9635 | Train Acc: 0.6700
 Site-Infograph | Train Loss: 2.1805 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1589 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.3070 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.9601 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.0920 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.2026 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9757 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 2.0627 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.9414 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.9547 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.8902 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.9499 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.2444 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0778 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0307 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0245 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 2.0058 | Val  Acc: 0.6087
 Site-QuickDraw | Val  Loss: 2.2724 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0100 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.9731 | Val  Acc: 0.6522
Average Valid Accuracy: 0.5942
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6600
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7761
 Best site-Infograph  | Epoch:22 | Val Acc: 0.2000
 Best site-Painting   | Epoch:22 | Val Acc: 0.6000
 Best site-Painting   | Epoch:22 | Val Acc: 0.6364
 Best site-Painting   | Epoch:22 | Val Acc: 0.6471
 Best site-Painting   | Epoch:22 | Val Acc: 0.6087
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.1429
 Best site-Real       | Epoch:22 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:22 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 1.9633 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.9921 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9393 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.9455 | Train Acc: 0.7200
 Site-Infograph | Train Loss: 2.2323 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.0712 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.9750 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 2.0057 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 1.9929 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.2097 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9706 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.9856 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.9342 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.9133 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8579 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.9383 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 2.2663 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.0431 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0345 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0077 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 2.0372 | Val  Acc: 0.4783
 Site-QuickDraw | Val  Loss: 2.2569 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0024 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.9890 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5710
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.9490 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.9788 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9269 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.9361 | Train Acc: 0.6600
 Site-Infograph | Train Loss: 2.2159 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.0712 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.1872 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 2.0054 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 2.0110 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.2070 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9492 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.9484 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8812 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.9321 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.8802 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.9124 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.2589 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.0478 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.0187 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 1.9956 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 2.0026 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.2663 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9993 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.9467 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5942
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 1.9495 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.9785 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9080 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.9277 | Train Acc: 0.6900
 Site-Infograph | Train Loss: 2.1990 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0824 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.8995 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.9502 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 1.9925 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.2035 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.9133 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9564 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.9063 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.8925 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.8553 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.9217 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.2729 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9788 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0176 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9983 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.9728 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.2626 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9758 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.9291 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5860
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 1.8933 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.9399 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.9056 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.9034 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.2055 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.1199 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.1919 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 1.9862 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.0482 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.2054 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.8816 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.9790 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.8708 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.9034 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8274 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.9063 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.2441 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9550 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 2.0202 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0525 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.9293 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2139 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9681 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.9470 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6311
 Best site-Clipart    | Epoch:26 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:26 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:26 | Val Acc: 0.7612
 Best site-Infograph  | Epoch:26 | Val Acc: 0.2000
 Best site-Painting   | Epoch:26 | Val Acc: 0.8000
 Best site-Painting   | Epoch:26 | Val Acc: 0.6364
 Best site-Painting   | Epoch:26 | Val Acc: 0.5882
 Best site-Painting   | Epoch:26 | Val Acc: 0.6522
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.1429
 Best site-Real       | Epoch:26 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:26 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 1.9407 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9655 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8940 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.8684 | Train Acc: 0.7200
 Site-Infograph | Train Loss: 2.2153 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0537 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.1682 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9758 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 1.9827 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.2039 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.8940 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9412 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8581 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8447 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.8141 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.8923 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.2780 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.0095 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0043 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.9707 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.9499 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.2284 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9689 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.8890 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6311
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 1.9534 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.8301 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8848 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.8596 | Train Acc: 0.7100
 Site-Infograph | Train Loss: 2.2046 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0585 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.8589 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9739 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 1.9554 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.2005 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.8793 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.9462 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.8733 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.9018 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8073 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.8425 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 2.2543 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.9791 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9818 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.9818 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.9687 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.2412 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9516 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.9085 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6150
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.8756 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.9016 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.8594 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 1.8556 | Train Acc: 0.7100
 Site-Infograph | Train Loss: 2.2099 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0054 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.9538 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9279 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.0431 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.1894 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.8568 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.8543 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8770 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8597 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7932 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.8497 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.2463 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0002 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9814 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9868 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.9156 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2259 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9246 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.8697 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6110
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 1.9004 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.8997 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.8538 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8796 | Train Acc: 0.7600
 Site-Infograph | Train Loss: 2.1957 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9893 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.7134 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.9393 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 1.9837 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1896 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.8621 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9674 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.7964 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.8541 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7674 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.8546 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.2744 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.0131 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9737 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.9502 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.9384 | Val  Acc: 0.6087
 Site-QuickDraw | Val  Loss: 2.2301 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9333 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.8900 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6424
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7200
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7761
 Best site-Infograph  | Epoch:30 | Val Acc: 0.1500
 Best site-Painting   | Epoch:30 | Val Acc: 0.6000
 Best site-Painting   | Epoch:30 | Val Acc: 0.7273
 Best site-Painting   | Epoch:30 | Val Acc: 0.7059
 Best site-Painting   | Epoch:30 | Val Acc: 0.6087
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.1905
 Best site-Real       | Epoch:30 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:30 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 1.8976 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9246 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.8563 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8201 | Train Acc: 0.7000
 Site-Infograph | Train Loss: 2.1986 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.0285 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.0699 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.8731 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 1.9896 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.1979 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9008 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.8550 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8144 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8482 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7520 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.8372 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 2.2715 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9312 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9435 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.9734 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.8961 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2307 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9356 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.8881 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6462
 Best site-Clipart    | Epoch:31 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:31 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:31 | Val Acc: 0.7200
 Best site-Clipart    | Epoch:31 | Val Acc: 0.7910
 Best site-Infograph  | Epoch:31 | Val Acc: 0.2000
 Best site-Painting   | Epoch:31 | Val Acc: 0.8000
 Best site-Painting   | Epoch:31 | Val Acc: 0.7273
 Best site-Painting   | Epoch:31 | Val Acc: 0.7647
 Best site-Painting   | Epoch:31 | Val Acc: 0.6957
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.1905
 Best site-Real       | Epoch:31 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:31 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 1.9155 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.9061 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8403 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 1.8186 | Train Acc: 0.7700
 Site-Infograph | Train Loss: 2.1853 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0142 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.6777 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.8723 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 2.0820 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.1797 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.8760 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9045 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.7919 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8276 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7447 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.8246 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.2146 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9079 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9159 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9456 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.9047 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2187 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9100 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.8382 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6579
 Best site-Clipart    | Epoch:32 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:32 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:32 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:32 | Val Acc: 0.8060
 Best site-Infograph  | Epoch:32 | Val Acc: 0.3000
 Best site-Painting   | Epoch:32 | Val Acc: 0.8000
 Best site-Painting   | Epoch:32 | Val Acc: 0.6364
 Best site-Painting   | Epoch:32 | Val Acc: 0.7059
 Best site-Painting   | Epoch:32 | Val Acc: 0.6522
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.2381
 Best site-Real       | Epoch:32 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:32 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 1.8307 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.9683 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.8000 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 1.8219 | Train Acc: 0.7400
 Site-Infograph | Train Loss: 2.1930 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0286 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.0027 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9059 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.9852 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.1637 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.8510 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.7594 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8087 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8070 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7248 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.8482 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.2046 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8563 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9129 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9180 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 1.8637 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.2303 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9007 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.8208 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6871
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7761
 Best site-Infograph  | Epoch:33 | Val Acc: 0.3500
 Best site-Painting   | Epoch:33 | Val Acc: 0.8000
 Best site-Painting   | Epoch:33 | Val Acc: 0.6364
 Best site-Painting   | Epoch:33 | Val Acc: 0.8824
 Best site-Painting   | Epoch:33 | Val Acc: 0.7391
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.1905
 Best site-Real       | Epoch:33 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:33 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.8528 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8600 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8122 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.7901 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.1745 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9561 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.8252 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.8905 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 2.0402 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 2.1802 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.8362 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.9005 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.7912 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.8090 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7383 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.8025 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.2643 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.8966 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9258 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9232 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.8702 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.2071 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8937 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.8560 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6745
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 1.8519 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8140 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8039 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 1.7649 | Train Acc: 0.7600
 Site-Infograph | Train Loss: 2.1794 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9605 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.7773 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.8868 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.9427 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1879 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.7940 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.8588 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.7665 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.7910 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.6837 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.7979 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.1998 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.9458 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9106 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9028 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 1.8627 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1955 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8881 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.8255 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6758
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 1.8582 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.6826 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.7693 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.7546 | Train Acc: 0.7800
 Site-Infograph | Train Loss: 2.1792 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9230 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.6243 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.8691 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.9177 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1799 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.8197 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.8774 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.7435 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.8036 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.6801 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.7774 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 2.2073 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9391 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8956 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9106 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.8477 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.1943 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8813 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.7869 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6672
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 1.7901 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.7916 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7742 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 1.7669 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.1928 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.9935 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.8460 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.8688 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.8224 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1698 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.7944 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.8123 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.7196 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.7692 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.6817 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.7780 | Val  Acc: 0.7313
 Site-Infograph | Val  Loss: 2.2331 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.9036 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8992 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8805 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.8759 | Val  Acc: 0.6087
 Site-QuickDraw | Val  Loss: 2.1881 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8481 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.8456 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6522
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 1.8018 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.7283 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7705 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 1.7461 | Train Acc: 0.7800
 Site-Infograph | Train Loss: 2.1725 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9255 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.7926 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.8380 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.8773 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1575 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.8315 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.8833 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.7760 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.7502 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.6617 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.7548 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.2677 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.8948 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8726 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9143 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.8394 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2043 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8508 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.8266 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6638
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.8012 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8931 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.7813 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 1.7291 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 2.1509 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 2.0019 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.8726 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.8896 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.0104 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1827 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.7860 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.8483 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.7439 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.7518 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.6454 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.7349 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.2534 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.8057 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8788 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.8956 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.8069 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.1989 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8340 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.8074 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6607
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 1.8355 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8439 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.7419 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 1.7399 | Train Acc: 0.7700
 Site-Infograph | Train Loss: 2.1714 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.9506 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.0207 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.8441 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 1.9179 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 2.1663 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.7844 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.7624 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.7740 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.7133 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.6424 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.7655 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.2100 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.8892 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8512 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 1.9422 | Val  Acc: 0.8824
 Site-Painting  | Val  Loss: 1.7976 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2334 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8219 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.7683 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6737
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 1.8010 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7758 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7348 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 1.7577 | Train Acc: 0.7900
 Site-Infograph | Train Loss: 2.1674 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.9463 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.7038 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.8254 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.8608 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.1588 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.7144 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.7933 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.6894 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.7235 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.6122 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.7323 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 2.2406 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.8772 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8889 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 1.8579 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.8219 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.2062 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8179 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.7414 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6797
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 1.7760 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.6795 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7432 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.7103 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.1497 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.9489 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.7147 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.7758 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.8469 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.1606 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.7074 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.8611 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.7330 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.7133 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6199 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.7156 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 2.2592 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.8872 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8388 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8403 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.7813 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1983 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.8107 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.7600 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6555
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 1.7761 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.7498 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7189 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 1.7470 | Train Acc: 0.7700
 Site-Infograph | Train Loss: 2.1598 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9641 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.9992 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.8074 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.8671 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1691 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.7295 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.7836 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.6336 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.6724 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.5850 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.7073 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 2.2127 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8349 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8428 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.8807 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.8059 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1756 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8021 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.7683 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7004
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:43 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:43 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:43 | Val Acc: 0.4000
 Best site-Painting   | Epoch:43 | Val Acc: 0.6000
 Best site-Painting   | Epoch:43 | Val Acc: 0.7273
 Best site-Painting   | Epoch:43 | Val Acc: 0.7647
 Best site-Painting   | Epoch:43 | Val Acc: 0.7826
 Best site-QuickDraw  | Epoch:43 | Val Acc: 0.2381
 Best site-Real       | Epoch:43 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:43 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.7478 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.7903 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7023 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.7126 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.1689 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.9082 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.9753 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.7893 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.7815 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 2.1547 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.6950 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.7681 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.6519 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.6555 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5848 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.6993 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.2575 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.8779 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8530 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.8514 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.8088 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.1804 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.7906 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.7198 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6800
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 1.7601 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8216 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7058 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.6444 | Train Acc: 0.7800
 Site-Infograph | Train Loss: 2.1661 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9224 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.6965 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.7451 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.9000 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 2.1463 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.7597 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.6748 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.6991 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.6631 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5700 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.6759 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.2095 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.7831 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.7690 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.8597 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.7623 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1780 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.7851 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.7030 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6947
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 1.7673 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.6594 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.6808 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.6931 | Train Acc: 0.7900
 Site-Infograph | Train Loss: 2.1662 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.8514 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.2647 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.7938 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.8018 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 2.1635 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.7193 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.6520 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.6435 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.6672 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.5492 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.6538 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.2102 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.7082 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8473 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8467 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.7330 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.1682 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.7590 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.7431 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6931
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 1.7179 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.7457 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.6766 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 1.6610 | Train Acc: 0.7600
 Site-Infograph | Train Loss: 2.1316 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.8661 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.5224 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.7310 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.7987 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1527 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.6823 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.7869 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.6641 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.6661 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.5525 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.6629 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 2.2455 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.8503 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.7535 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8044 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.7358 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.1816 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.7736 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.6957 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6822
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 1.6855 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.7010 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 1.6811 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 1.6431 | Train Acc: 0.7900
 Site-Infograph | Train Loss: 2.1348 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.8881 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.7552 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.7495 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.7384 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1538 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.7094 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.6827 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.6207 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.6288 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.5512 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.6609 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 2.2437 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.7070 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8245 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 1.8057 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.7233 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.1765 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.7549 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.7099 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6925
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 1.6734 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.7158 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.6630 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.6207 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.1603 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8456 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.9347 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.7762 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.7454 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.1356 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.6932 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.5703 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.5972 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.6486 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5253 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.6604 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 2.2143 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.7175 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.7538 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.7843 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.7106 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.1768 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.7489 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.7088 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7010
 Best site-Clipart    | Epoch:49 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:49 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:49 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:49 | Val Acc: 0.7910
 Best site-Infograph  | Epoch:49 | Val Acc: 0.2000
 Best site-Painting   | Epoch:49 | Val Acc: 0.8000
 Best site-Painting   | Epoch:49 | Val Acc: 0.7273
 Best site-Painting   | Epoch:49 | Val Acc: 0.8235
 Best site-Painting   | Epoch:49 | Val Acc: 0.8261
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.1905
 Best site-Real       | Epoch:49 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:49 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/drfl...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.7909
 Test site-Infograph | Epoch:49 | Test Acc: 0.4231
 Test site-Painting  | Epoch:49 | Test Acc: 0.7706
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.2370
 Test site-Real      | Epoch:49 | Test Acc: 0.8973
 Test site-Sketch    | Epoch:49 | Test Acc: 0.7292
Average Test Accuracy: 0.6414
===2023-04-21 11:14:42===
===2023-04-21 11:14:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.7909
 Test site-Infograph | Epoch:49 | Test Acc: 0.4231
 Test site-Painting  | Epoch:49 | Test Acc: 0.7706
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.2370
 Test site-Real      | Epoch:49 | Test Acc: 0.8973
 Test site-Sketch    | Epoch:49 | Test Acc: 0.7292
Average Test Accuracy: 0.6414
