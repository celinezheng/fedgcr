===2023-04-21 00:01:04===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
===2023-04-21 00:01:20===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
===2023-04-21 11:15:54===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
denominator: 27634.6015625
 Site-Clipart   | Train Loss: 2.2948 | Train Acc: 0.0800
 Site-Clipart   | Train Loss: 2.3119 | Train Acc: 0.0800
 Site-Clipart   | Train Loss: 2.2858 | Train Acc: 0.1200
 Site-Clipart   | Train Loss: 2.2851 | Train Acc: 0.1300
 Site-Infograph | Train Loss: 2.2838 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.3245 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.3130 | Train Acc: 0.1176
 Site-Painting  | Train Loss: 2.2761 | Train Acc: 0.2308
 Site-Painting  | Train Loss: 2.3241 | Train Acc: 0.0857
 Site-QuickDraw | Train Loss: 2.2778 | Train Acc: 0.1562
 Site-Real      | Train Loss: 2.2687 | Train Acc: 0.1579
 Site-Sketch    | Train Loss: 2.3262 | Train Acc: 0.1143
 Site-Clipart   | Val  Loss: 2.3162 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.3084 | Val  Acc: 0.0606
 Site-Clipart   | Val  Loss: 2.2898 | Val  Acc: 0.0800
 Site-Clipart   | Val  Loss: 2.2871 | Val  Acc: 0.1194
 Site-Infograph | Val  Loss: 2.2831 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.2814 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2753 | Val  Acc: 0.1818
 Site-Painting  | Val  Loss: 2.1901 | Val  Acc: 0.1176
 Site-Painting  | Val  Loss: 2.2771 | Val  Acc: 0.1304
 Site-QuickDraw | Val  Loss: 2.3540 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2833 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 2.2684 | Val  Acc: 0.1739
Average Valid Accuracy: 0.1343
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0625
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0606
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0800
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1194
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1500
 Best site-Painting   | Epoch:0 | Val Acc: 0.2000
 Best site-Painting   | Epoch:0 | Val Acc: 0.1818
 Best site-Painting   | Epoch:0 | Val Acc: 0.1176
 Best site-Painting   | Epoch:0 | Val Acc: 0.1304
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 1 ============
denominator: 27560.26953125
 Site-Clipart   | Train Loss: 2.2756 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.3102 | Train Acc: 0.1800
 Site-Clipart   | Train Loss: 2.2763 | Train Acc: 0.1200
 Site-Clipart   | Train Loss: 2.2907 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.2827 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2947 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.4021 | Train Acc: 0.0588
 Site-Painting  | Train Loss: 2.2819 | Train Acc: 0.1154
 Site-Painting  | Train Loss: 2.2672 | Train Acc: 0.0857
 Site-QuickDraw | Train Loss: 2.2757 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.2559 | Train Acc: 0.1842
 Site-Sketch    | Train Loss: 2.2729 | Train Acc: 0.1143
 Site-Clipart   | Val  Loss: 2.2937 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2980 | Val  Acc: 0.0606
 Site-Clipart   | Val  Loss: 2.2749 | Val  Acc: 0.0600
 Site-Clipart   | Val  Loss: 2.2748 | Val  Acc: 0.1194
 Site-Infograph | Val  Loss: 2.2902 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2632 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2994 | Val  Acc: 0.1818
 Site-Painting  | Val  Loss: 2.1740 | Val  Acc: 0.1176
 Site-Painting  | Val  Loss: 2.2572 | Val  Acc: 0.2609
 Site-QuickDraw | Val  Loss: 2.3336 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2675 | Val  Acc: 0.1600
 Site-Sketch    | Val  Loss: 2.2658 | Val  Acc: 0.2174
Average Valid Accuracy: 0.1354
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0606
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0600
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1194
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2000
 Best site-Painting   | Epoch:1 | Val Acc: 0.2000
 Best site-Painting   | Epoch:1 | Val Acc: 0.1818
 Best site-Painting   | Epoch:1 | Val Acc: 0.1176
 Best site-Painting   | Epoch:1 | Val Acc: 0.2609
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0476
 Best site-Real       | Epoch:1 | Val Acc: 0.1600
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 2 ============
denominator: 27476.724609375
 Site-Clipart   | Train Loss: 2.2787 | Train Acc: 0.0400
 Site-Clipart   | Train Loss: 2.3069 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.2725 | Train Acc: 0.1333
 Site-Clipart   | Train Loss: 2.2696 | Train Acc: 0.1600
 Site-Infograph | Train Loss: 2.2840 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2937 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.2729 | Train Acc: 0.0588
 Site-Painting  | Train Loss: 2.2774 | Train Acc: 0.1538
 Site-Painting  | Train Loss: 2.2842 | Train Acc: 0.0857
 Site-QuickDraw | Train Loss: 2.2747 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.2613 | Train Acc: 0.2632
 Site-Sketch    | Train Loss: 2.2699 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.2819 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.2943 | Val  Acc: 0.0909
 Site-Clipart   | Val  Loss: 2.2558 | Val  Acc: 0.1200
 Site-Clipart   | Val  Loss: 2.2655 | Val  Acc: 0.1343
 Site-Infograph | Val  Loss: 2.2909 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2810 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2777 | Val  Acc: 0.0909
 Site-Painting  | Val  Loss: 2.1632 | Val  Acc: 0.1176
 Site-Painting  | Val  Loss: 2.2624 | Val  Acc: 0.1304
 Site-QuickDraw | Val  Loss: 2.3513 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2602 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 2.2583 | Val  Acc: 0.2609
Average Valid Accuracy: 0.1631
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:2 | Val Acc: 0.0909
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1200
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1343
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2000
 Best site-Painting   | Epoch:2 | Val Acc: 0.4000
 Best site-Painting   | Epoch:2 | Val Acc: 0.0909
 Best site-Painting   | Epoch:2 | Val Acc: 0.1176
 Best site-Painting   | Epoch:2 | Val Acc: 0.1304
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.0476
 Best site-Real       | Epoch:2 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:2 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 3 ============
denominator: 27275.421875
 Site-Clipart   | Train Loss: 2.2557 | Train Acc: 0.0400
 Site-Clipart   | Train Loss: 2.2868 | Train Acc: 0.2200
 Site-Clipart   | Train Loss: 2.2562 | Train Acc: 0.1333
 Site-Clipart   | Train Loss: 2.2830 | Train Acc: 0.1600
 Site-Infograph | Train Loss: 2.2690 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.2850 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.2374 | Train Acc: 0.1176
 Site-Painting  | Train Loss: 2.2365 | Train Acc: 0.3462
 Site-Painting  | Train Loss: 2.2899 | Train Acc: 0.1143
 Site-QuickDraw | Train Loss: 2.2702 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.2371 | Train Acc: 0.3684
 Site-Sketch    | Train Loss: 2.2834 | Train Acc: 0.1714
 Site-Clipart   | Val  Loss: 2.2700 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.2827 | Val  Acc: 0.1212
 Site-Clipart   | Val  Loss: 2.2417 | Val  Acc: 0.2400
 Site-Clipart   | Val  Loss: 2.2459 | Val  Acc: 0.1940
 Site-Infograph | Val  Loss: 2.2867 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2820 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2487 | Val  Acc: 0.2727
 Site-Painting  | Val  Loss: 2.2072 | Val  Acc: 0.1765
 Site-Painting  | Val  Loss: 2.2663 | Val  Acc: 0.2609
 Site-QuickDraw | Val  Loss: 2.3336 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.2635 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 2.2377 | Val  Acc: 0.2174
Average Valid Accuracy: 0.2161
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1212
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2400
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1940
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2500
 Best site-Painting   | Epoch:3 | Val Acc: 0.4000
 Best site-Painting   | Epoch:3 | Val Acc: 0.2727
 Best site-Painting   | Epoch:3 | Val Acc: 0.1765
 Best site-Painting   | Epoch:3 | Val Acc: 0.2609
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.0952
 Best site-Real       | Epoch:3 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:3 | Val Acc: 0.2174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 4 ============
denominator: 27090.060546875
 Site-Clipart   | Train Loss: 2.2468 | Train Acc: 0.1200
 Site-Clipart   | Train Loss: 2.2879 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2496 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2550 | Train Acc: 0.2700
 Site-Infograph | Train Loss: 2.2884 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2571 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.3847 | Train Acc: 0.1765
 Site-Painting  | Train Loss: 2.2417 | Train Acc: 0.1923
 Site-Painting  | Train Loss: 2.2813 | Train Acc: 0.2286
 Site-QuickDraw | Train Loss: 2.2585 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.2223 | Train Acc: 0.3421
 Site-Sketch    | Train Loss: 2.2457 | Train Acc: 0.2571
 Site-Clipart   | Val  Loss: 2.2572 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 2.2654 | Val  Acc: 0.2424
 Site-Clipart   | Val  Loss: 2.2290 | Val  Acc: 0.2200
 Site-Clipart   | Val  Loss: 2.2380 | Val  Acc: 0.2388
 Site-Infograph | Val  Loss: 2.2913 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2258 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2381 | Val  Acc: 0.2727
 Site-Painting  | Val  Loss: 2.2156 | Val  Acc: 0.2353
 Site-Painting  | Val  Loss: 2.2516 | Val  Acc: 0.3043
 Site-QuickDraw | Val  Loss: 2.3291 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2512 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 2.2338 | Val  Acc: 0.2609
Average Valid Accuracy: 0.2375
 Best site-Clipart    | Epoch:4 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2424
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2200
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2388
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2000
 Best site-Painting   | Epoch:4 | Val Acc: 0.4000
 Best site-Painting   | Epoch:4 | Val Acc: 0.2727
 Best site-Painting   | Epoch:4 | Val Acc: 0.2353
 Best site-Painting   | Epoch:4 | Val Acc: 0.3043
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.0476
 Best site-Real       | Epoch:4 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:4 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 5 ============
denominator: 27026.791015625
 Site-Clipart   | Train Loss: 2.2287 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2426 | Train Acc: 0.2600
 Site-Clipart   | Train Loss: 2.2302 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2455 | Train Acc: 0.2600
 Site-Infograph | Train Loss: 2.2792 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2719 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.2023 | Train Acc: 0.2941
 Site-Painting  | Train Loss: 2.2403 | Train Acc: 0.2692
 Site-Painting  | Train Loss: 2.2454 | Train Acc: 0.2000
 Site-QuickDraw | Train Loss: 2.2653 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.1928 | Train Acc: 0.3684
 Site-Sketch    | Train Loss: 2.2051 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.2465 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 2.2305 | Val  Acc: 0.2121
 Site-Clipart   | Val  Loss: 2.2159 | Val  Acc: 0.2600
 Site-Clipart   | Val  Loss: 2.2303 | Val  Acc: 0.2537
 Site-Infograph | Val  Loss: 2.2742 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2411 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2407 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.1527 | Val  Acc: 0.2941
 Site-Painting  | Val  Loss: 2.2124 | Val  Acc: 0.3478
 Site-QuickDraw | Val  Loss: 2.3349 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2399 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 2.2225 | Val  Acc: 0.3043
Average Valid Accuracy: 0.2772
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.2121
 Best site-Clipart    | Epoch:5 | Val Acc: 0.2600
 Best site-Clipart    | Epoch:5 | Val Acc: 0.2537
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2000
 Best site-Painting   | Epoch:5 | Val Acc: 0.4000
 Best site-Painting   | Epoch:5 | Val Acc: 0.4545
 Best site-Painting   | Epoch:5 | Val Acc: 0.2941
 Best site-Painting   | Epoch:5 | Val Acc: 0.3478
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.0476
 Best site-Real       | Epoch:5 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:5 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 6 ============
denominator: 26964.837890625
 Site-Clipart   | Train Loss: 2.2288 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2571 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.2191 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.2289 | Train Acc: 0.3500
 Site-Infograph | Train Loss: 2.2605 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2395 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.2751 | Train Acc: 0.2941
 Site-Painting  | Train Loss: 2.2189 | Train Acc: 0.3462
 Site-Painting  | Train Loss: 2.2560 | Train Acc: 0.3143
 Site-QuickDraw | Train Loss: 2.2555 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.1829 | Train Acc: 0.3684
 Site-Sketch    | Train Loss: 2.2103 | Train Acc: 0.3429
 Site-Clipart   | Val  Loss: 2.2251 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 2.2260 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2076 | Val  Acc: 0.2200
 Site-Clipart   | Val  Loss: 2.2187 | Val  Acc: 0.2239
 Site-Infograph | Val  Loss: 2.2822 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2135 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2051 | Val  Acc: 0.3636
 Site-Painting  | Val  Loss: 2.1941 | Val  Acc: 0.3529
 Site-Painting  | Val  Loss: 2.2333 | Val  Acc: 0.3043
 Site-QuickDraw | Val  Loss: 2.3343 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2218 | Val  Acc: 0.3200
 Site-Sketch    | Val  Loss: 2.2100 | Val  Acc: 0.2609
Average Valid Accuracy: 0.2732
============ Train epoch 7 ============
denominator: 27020.794921875
 Site-Clipart   | Train Loss: 2.2429 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2323 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.2067 | Train Acc: 0.3467
 Site-Clipart   | Train Loss: 2.2300 | Train Acc: 0.3200
 Site-Infograph | Train Loss: 2.2721 | Train Acc: 0.0645
 Site-Painting  | Train Loss: 2.2400 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.2528 | Train Acc: 0.4118
 Site-Painting  | Train Loss: 2.2177 | Train Acc: 0.3462
 Site-Painting  | Train Loss: 2.2362 | Train Acc: 0.3429
 Site-QuickDraw | Train Loss: 2.2714 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.2075 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.2106 | Train Acc: 0.2286
 Site-Clipart   | Val  Loss: 2.2150 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 2.2338 | Val  Acc: 0.3030
 Site-Clipart   | Val  Loss: 2.1906 | Val  Acc: 0.2800
 Site-Clipart   | Val  Loss: 2.1886 | Val  Acc: 0.3433
 Site-Infograph | Val  Loss: 2.2855 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2039 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.2136 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.1657 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 2.2154 | Val  Acc: 0.3913
 Site-QuickDraw | Val  Loss: 2.3334 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2129 | Val  Acc: 0.2800
 Site-Sketch    | Val  Loss: 2.1982 | Val  Acc: 0.3043
Average Valid Accuracy: 0.3274
 Best site-Clipart    | Epoch:7 | Val Acc: 0.3125
 Best site-Clipart    | Epoch:7 | Val Acc: 0.3030
 Best site-Clipart    | Epoch:7 | Val Acc: 0.2800
 Best site-Clipart    | Epoch:7 | Val Acc: 0.3433
 Best site-Infograph  | Epoch:7 | Val Acc: 0.2000
 Best site-Painting   | Epoch:7 | Val Acc: 0.6000
 Best site-Painting   | Epoch:7 | Val Acc: 0.4545
 Best site-Painting   | Epoch:7 | Val Acc: 0.4118
 Best site-Painting   | Epoch:7 | Val Acc: 0.3913
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.0476
 Best site-Real       | Epoch:7 | Val Acc: 0.2800
 Best site-Sketch     | Epoch:7 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 8 ============
denominator: 26736.806640625
 Site-Clipart   | Train Loss: 2.2097 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2142 | Train Acc: 0.3400
 Site-Clipart   | Train Loss: 2.2147 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.2254 | Train Acc: 0.3400
 Site-Infograph | Train Loss: 2.2776 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2561 | Train Acc: 0.1250
 Site-Painting  | Train Loss: 2.0981 | Train Acc: 0.2353
 Site-Painting  | Train Loss: 2.1961 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.2186 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.2612 | Train Acc: 0.2812
 Site-Real      | Train Loss: 2.1797 | Train Acc: 0.4737
 Site-Sketch    | Train Loss: 2.2069 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.2142 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 2.2345 | Val  Acc: 0.1818
 Site-Clipart   | Val  Loss: 2.1854 | Val  Acc: 0.3800
 Site-Clipart   | Val  Loss: 2.2073 | Val  Acc: 0.3582
 Site-Infograph | Val  Loss: 2.2881 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2126 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1890 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.1263 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 2.2140 | Val  Acc: 0.3043
 Site-QuickDraw | Val  Loss: 2.3183 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2177 | Val  Acc: 0.3200
 Site-Sketch    | Val  Loss: 2.1943 | Val  Acc: 0.3043
Average Valid Accuracy: 0.3327
 Best site-Clipart    | Epoch:8 | Val Acc: 0.3125
 Best site-Clipart    | Epoch:8 | Val Acc: 0.1818
 Best site-Clipart    | Epoch:8 | Val Acc: 0.3800
 Best site-Clipart    | Epoch:8 | Val Acc: 0.3582
 Best site-Infograph  | Epoch:8 | Val Acc: 0.2000
 Best site-Painting   | Epoch:8 | Val Acc: 0.6000
 Best site-Painting   | Epoch:8 | Val Acc: 0.4545
 Best site-Painting   | Epoch:8 | Val Acc: 0.5294
 Best site-Painting   | Epoch:8 | Val Acc: 0.3043
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.0476
 Best site-Real       | Epoch:8 | Val Acc: 0.3200
 Best site-Sketch     | Epoch:8 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 9 ============
denominator: 26662.724609375
 Site-Clipart   | Train Loss: 2.1943 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.2080 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.1867 | Train Acc: 0.3733
 Site-Clipart   | Train Loss: 2.1935 | Train Acc: 0.4100
 Site-Infograph | Train Loss: 2.2597 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.2466 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.3235 | Train Acc: 0.3529
 Site-Painting  | Train Loss: 2.1893 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.2274 | Train Acc: 0.3429
 Site-QuickDraw | Train Loss: 2.2427 | Train Acc: 0.3125
 Site-Real      | Train Loss: 2.1470 | Train Acc: 0.4474
 Site-Sketch    | Train Loss: 2.2008 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.2133 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 2.2158 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.1722 | Val  Acc: 0.3200
 Site-Clipart   | Val  Loss: 2.1865 | Val  Acc: 0.3731
 Site-Infograph | Val  Loss: 2.2874 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2168 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.1823 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.1734 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 2.1870 | Val  Acc: 0.3913
 Site-QuickDraw | Val  Loss: 2.3186 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1950 | Val  Acc: 0.2800
 Site-Sketch    | Val  Loss: 2.1796 | Val  Acc: 0.3478
Average Valid Accuracy: 0.3560
 Best site-Clipart    | Epoch:9 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:9 | Val Acc: 0.3200
 Best site-Clipart    | Epoch:9 | Val Acc: 0.3731
 Best site-Infograph  | Epoch:9 | Val Acc: 0.2000
 Best site-Painting   | Epoch:9 | Val Acc: 0.4000
 Best site-Painting   | Epoch:9 | Val Acc: 0.5455
 Best site-Painting   | Epoch:9 | Val Acc: 0.4118
 Best site-Painting   | Epoch:9 | Val Acc: 0.3913
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.1429
 Best site-Real       | Epoch:9 | Val Acc: 0.2800
 Best site-Sketch     | Epoch:9 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.3726
 Test site-Infograph | Epoch:9 | Test Acc: 0.1629
 Test site-Painting  | Epoch:9 | Test Acc: 0.4362
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.1470
 Test site-Real      | Epoch:9 | Test Acc: 0.3993
 Test site-Sketch    | Epoch:9 | Test Acc: 0.3646
Average Test Accuracy: 0.3138
============ Train epoch 10 ============
denominator: 26463.7734375
 Site-Clipart   | Train Loss: 2.1864 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1979 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1877 | Train Acc: 0.4267
 Site-Clipart   | Train Loss: 2.2025 | Train Acc: 0.3300
 Site-Infograph | Train Loss: 2.2570 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2135 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.1175 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 2.1667 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.1851 | Train Acc: 0.3714
 Site-QuickDraw | Train Loss: 2.2466 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.1609 | Train Acc: 0.5000
 Site-Sketch    | Train Loss: 2.1838 | Train Acc: 0.3714
 Site-Clipart   | Val  Loss: 2.1874 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.2153 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.1593 | Val  Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.1839 | Val  Acc: 0.3284
 Site-Infograph | Val  Loss: 2.2749 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1949 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1772 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.1233 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 2.1726 | Val  Acc: 0.4783
 Site-QuickDraw | Val  Loss: 2.3201 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1875 | Val  Acc: 0.4400
 Site-Sketch    | Val  Loss: 2.1717 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4139
 Best site-Clipart    | Epoch:10 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:10 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:10 | Val Acc: 0.4000
 Best site-Clipart    | Epoch:10 | Val Acc: 0.3284
 Best site-Infograph  | Epoch:10 | Val Acc: 0.2500
 Best site-Painting   | Epoch:10 | Val Acc: 0.6000
 Best site-Painting   | Epoch:10 | Val Acc: 0.6364
 Best site-Painting   | Epoch:10 | Val Acc: 0.5294
 Best site-Painting   | Epoch:10 | Val Acc: 0.4783
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.1429
 Best site-Real       | Epoch:10 | Val Acc: 0.4400
 Best site-Sketch     | Epoch:10 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 11 ============
denominator: 26370.890625
 Site-Clipart   | Train Loss: 2.1771 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2020 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 2.1744 | Train Acc: 0.4133
 Site-Clipart   | Train Loss: 2.1641 | Train Acc: 0.4100
 Site-Infograph | Train Loss: 2.2773 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2175 | Train Acc: 0.2500
 Site-Painting  | Train Loss: 2.1956 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.1648 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.1876 | Train Acc: 0.4857
 Site-QuickDraw | Train Loss: 2.2577 | Train Acc: 0.2812
 Site-Real      | Train Loss: 2.1607 | Train Acc: 0.6053
 Site-Sketch    | Train Loss: 2.1990 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.1674 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.1510 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.1444 | Val  Acc: 0.4600
 Site-Clipart   | Val  Loss: 2.1641 | Val  Acc: 0.3881
 Site-Infograph | Val  Loss: 2.2807 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1777 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1891 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.1284 | Val  Acc: 0.4706
 Site-Painting  | Val  Loss: 2.1532 | Val  Acc: 0.4348
 Site-QuickDraw | Val  Loss: 2.3293 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1682 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 2.1450 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4232
 Best site-Clipart    | Epoch:11 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:11 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:11 | Val Acc: 0.4600
 Best site-Clipart    | Epoch:11 | Val Acc: 0.3881
 Best site-Infograph  | Epoch:11 | Val Acc: 0.2000
 Best site-Painting   | Epoch:11 | Val Acc: 0.6000
 Best site-Painting   | Epoch:11 | Val Acc: 0.6364
 Best site-Painting   | Epoch:11 | Val Acc: 0.4706
 Best site-Painting   | Epoch:11 | Val Acc: 0.4348
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.0952
 Best site-Real       | Epoch:11 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:11 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 12 ============
denominator: 26242.57421875
 Site-Clipart   | Train Loss: 2.1476 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.1899 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1611 | Train Acc: 0.4933
 Site-Clipart   | Train Loss: 2.1591 | Train Acc: 0.4800
 Site-Infograph | Train Loss: 2.2558 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.1703 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.2126 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 2.1639 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.2069 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.2584 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.1438 | Train Acc: 0.5526
 Site-Sketch    | Train Loss: 2.1712 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1875 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.1828 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1233 | Val  Acc: 0.4800
 Site-Clipart   | Val  Loss: 2.1434 | Val  Acc: 0.5373
 Site-Infograph | Val  Loss: 2.2426 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1704 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1759 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.1204 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 2.1640 | Val  Acc: 0.4783
 Site-QuickDraw | Val  Loss: 2.3039 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.1657 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 2.1427 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4181
============ Train epoch 13 ============
denominator: 26242.140625
 Site-Clipart   | Train Loss: 2.1190 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.1632 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 2.1494 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.1640 | Train Acc: 0.5100
 Site-Infograph | Train Loss: 2.2412 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.2023 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.1010 | Train Acc: 0.4118
 Site-Painting  | Train Loss: 2.1759 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.1591 | Train Acc: 0.4857
 Site-QuickDraw | Train Loss: 2.2592 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.1362 | Train Acc: 0.6053
 Site-Sketch    | Train Loss: 2.1422 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1573 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1581 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.1044 | Val  Acc: 0.5200
 Site-Clipart   | Val  Loss: 2.1482 | Val  Acc: 0.4627
 Site-Infograph | Val  Loss: 2.2622 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1584 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1678 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.1038 | Val  Acc: 0.4118
 Site-Painting  | Val  Loss: 2.1464 | Val  Acc: 0.4783
 Site-QuickDraw | Val  Loss: 2.3123 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1518 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 2.1433 | Val  Acc: 0.3478
Average Valid Accuracy: 0.4422
 Best site-Clipart    | Epoch:13 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:13 | Val Acc: 0.5200
 Best site-Clipart    | Epoch:13 | Val Acc: 0.4627
 Best site-Infograph  | Epoch:13 | Val Acc: 0.3000
 Best site-Painting   | Epoch:13 | Val Acc: 0.6000
 Best site-Painting   | Epoch:13 | Val Acc: 0.5455
 Best site-Painting   | Epoch:13 | Val Acc: 0.4118
 Best site-Painting   | Epoch:13 | Val Acc: 0.4783
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.0952
 Best site-Real       | Epoch:13 | Val Acc: 0.5600
 Best site-Sketch     | Epoch:13 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 14 ============
denominator: 26151.796875
 Site-Clipart   | Train Loss: 2.1310 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.1475 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1294 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 2.1577 | Train Acc: 0.4900
 Site-Infograph | Train Loss: 2.2511 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1728 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.0614 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.1452 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.1402 | Train Acc: 0.5143
 Site-QuickDraw | Train Loss: 2.2274 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.1089 | Train Acc: 0.6579
 Site-Sketch    | Train Loss: 2.1937 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1459 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.1697 | Val  Acc: 0.3939
 Site-Clipart   | Val  Loss: 2.0955 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1461 | Val  Acc: 0.4179
 Site-Infograph | Val  Loss: 2.2736 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.1577 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1375 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.1194 | Val  Acc: 0.4706
 Site-Painting  | Val  Loss: 2.1284 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.2941 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1446 | Val  Acc: 0.5200
 Site-Sketch    | Val  Loss: 2.1200 | Val  Acc: 0.4783
Average Valid Accuracy: 0.4351
============ Train epoch 15 ============
denominator: 26059.439453125
 Site-Clipart   | Train Loss: 2.1498 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.1631 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 2.1319 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 2.1441 | Train Acc: 0.5200
 Site-Infograph | Train Loss: 2.2495 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.1763 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.2025 | Train Acc: 0.3529
 Site-Painting  | Train Loss: 2.1372 | Train Acc: 0.4615
 Site-Painting  | Train Loss: 2.1928 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 2.2331 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.1152 | Train Acc: 0.6579
 Site-Sketch    | Train Loss: 2.1406 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 2.1387 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1587 | Val  Acc: 0.5152
 Site-Clipart   | Val  Loss: 2.0949 | Val  Acc: 0.5400
 Site-Clipart   | Val  Loss: 2.1271 | Val  Acc: 0.5373
 Site-Infograph | Val  Loss: 2.2865 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1562 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1649 | Val  Acc: 0.4545
 Site-Painting  | Val  Loss: 2.0849 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 2.1431 | Val  Acc: 0.4348
 Site-QuickDraw | Val  Loss: 2.3142 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1498 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 2.1181 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4553
 Best site-Clipart    | Epoch:15 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:15 | Val Acc: 0.5152
 Best site-Clipart    | Epoch:15 | Val Acc: 0.5400
 Best site-Clipart    | Epoch:15 | Val Acc: 0.5373
 Best site-Infograph  | Epoch:15 | Val Acc: 0.2000
 Best site-Painting   | Epoch:15 | Val Acc: 0.6000
 Best site-Painting   | Epoch:15 | Val Acc: 0.4545
 Best site-Painting   | Epoch:15 | Val Acc: 0.5882
 Best site-Painting   | Epoch:15 | Val Acc: 0.4348
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.1429
 Best site-Real       | Epoch:15 | Val Acc: 0.5600
 Best site-Sketch     | Epoch:15 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 16 ============
denominator: 25897.61328125
 Site-Clipart   | Train Loss: 2.1157 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.1600 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 2.1120 | Train Acc: 0.5733
 Site-Clipart   | Train Loss: 2.1171 | Train Acc: 0.4800
 Site-Infograph | Train Loss: 2.2358 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2267 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.0825 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.1049 | Train Acc: 0.5385
 Site-Painting  | Train Loss: 2.1758 | Train Acc: 0.4857
 Site-QuickDraw | Train Loss: 2.2289 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.0954 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 2.1287 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 2.1240 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.1605 | Val  Acc: 0.4242
 Site-Clipart   | Val  Loss: 2.0744 | Val  Acc: 0.5200
 Site-Clipart   | Val  Loss: 2.1085 | Val  Acc: 0.5522
 Site-Infograph | Val  Loss: 2.2697 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.1309 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1552 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0868 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 2.1308 | Val  Acc: 0.4783
 Site-QuickDraw | Val  Loss: 2.3062 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1227 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 2.1115 | Val  Acc: 0.5652
Average Valid Accuracy: 0.4631
 Best site-Clipart    | Epoch:16 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:16 | Val Acc: 0.4242
 Best site-Clipart    | Epoch:16 | Val Acc: 0.5200
 Best site-Clipart    | Epoch:16 | Val Acc: 0.5522
 Best site-Infograph  | Epoch:16 | Val Acc: 0.1000
 Best site-Painting   | Epoch:16 | Val Acc: 0.6000
 Best site-Painting   | Epoch:16 | Val Acc: 0.6364
 Best site-Painting   | Epoch:16 | Val Acc: 0.5882
 Best site-Painting   | Epoch:16 | Val Acc: 0.4783
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.0952
 Best site-Real       | Epoch:16 | Val Acc: 0.5600
 Best site-Sketch     | Epoch:16 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 17 ============
denominator: 25871.36328125
 Site-Clipart   | Train Loss: 2.1209 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 2.0961 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 2.1169 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 2.1271 | Train Acc: 0.4800
 Site-Infograph | Train Loss: 2.2402 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1888 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.0739 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.0900 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 2.1598 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.2460 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0933 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 2.1243 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 2.1118 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1292 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0722 | Val  Acc: 0.5800
 Site-Clipart   | Val  Loss: 2.1077 | Val  Acc: 0.5821
 Site-Infograph | Val  Loss: 2.2591 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1027 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1225 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.1096 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 2.1085 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.3112 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1180 | Val  Acc: 0.5200
 Site-Sketch    | Val  Loss: 2.1036 | Val  Acc: 0.5652
Average Valid Accuracy: 0.4938
 Best site-Clipart    | Epoch:17 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:17 | Val Acc: 0.5800
 Best site-Clipart    | Epoch:17 | Val Acc: 0.5821
 Best site-Infograph  | Epoch:17 | Val Acc: 0.2500
 Best site-Painting   | Epoch:17 | Val Acc: 0.6000
 Best site-Painting   | Epoch:17 | Val Acc: 0.5455
 Best site-Painting   | Epoch:17 | Val Acc: 0.5294
 Best site-Painting   | Epoch:17 | Val Acc: 0.5652
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.1429
 Best site-Real       | Epoch:17 | Val Acc: 0.5200
 Best site-Sketch     | Epoch:17 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 18 ============
denominator: 25726.423828125
 Site-Clipart   | Train Loss: 2.1250 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 2.1351 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 2.1010 | Train Acc: 0.5467
 Site-Clipart   | Train Loss: 2.0969 | Train Acc: 0.5100
 Site-Infograph | Train Loss: 2.2455 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1525 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 2.2651 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 2.0972 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.1434 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 2.2223 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.0897 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 2.1050 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1089 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 2.1145 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0443 | Val  Acc: 0.5800
 Site-Clipart   | Val  Loss: 2.1008 | Val  Acc: 0.5522
 Site-Infograph | Val  Loss: 2.2648 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1420 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0828 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0815 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 2.1028 | Val  Acc: 0.5217
 Site-QuickDraw | Val  Loss: 2.3104 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1021 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 2.1152 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4954
 Best site-Clipart    | Epoch:18 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:18 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:18 | Val Acc: 0.5800
 Best site-Clipart    | Epoch:18 | Val Acc: 0.5522
 Best site-Infograph  | Epoch:18 | Val Acc: 0.2500
 Best site-Painting   | Epoch:18 | Val Acc: 0.6000
 Best site-Painting   | Epoch:18 | Val Acc: 0.6364
 Best site-Painting   | Epoch:18 | Val Acc: 0.5294
 Best site-Painting   | Epoch:18 | Val Acc: 0.5217
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.0952
 Best site-Real       | Epoch:18 | Val Acc: 0.6800
 Best site-Sketch     | Epoch:18 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 19 ============
denominator: 25684.9609375
 Site-Clipart   | Train Loss: 2.1220 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.1328 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.0883 | Train Acc: 0.6133
 Site-Clipart   | Train Loss: 2.0974 | Train Acc: 0.5100
 Site-Infograph | Train Loss: 2.2259 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1565 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 2.0591 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 2.0663 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 2.1559 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.2083 | Train Acc: 0.3438
 Site-Real      | Train Loss: 2.0541 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 2.0713 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 2.0945 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.1161 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0356 | Val  Acc: 0.5600
 Site-Clipart   | Val  Loss: 2.0798 | Val  Acc: 0.5522
 Site-Infograph | Val  Loss: 2.2554 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0997 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0579 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 2.0818 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 2.0873 | Val  Acc: 0.5217
 Site-QuickDraw | Val  Loss: 2.2754 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1080 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 2.0762 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5335
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:19 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:19 | Val Acc: 0.5600
 Best site-Clipart    | Epoch:19 | Val Acc: 0.5522
 Best site-Infograph  | Epoch:19 | Val Acc: 0.2000
 Best site-Painting   | Epoch:19 | Val Acc: 0.6000
 Best site-Painting   | Epoch:19 | Val Acc: 0.8182
 Best site-Painting   | Epoch:19 | Val Acc: 0.5882
 Best site-Painting   | Epoch:19 | Val Acc: 0.5217
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.1429
 Best site-Real       | Epoch:19 | Val Acc: 0.6400
 Best site-Sketch     | Epoch:19 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.5894
 Test site-Infograph | Epoch:19 | Test Acc: 0.2816
 Test site-Painting  | Epoch:19 | Test Acc: 0.6381
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.1780
 Test site-Real      | Epoch:19 | Test Acc: 0.6746
 Test site-Sketch    | Epoch:19 | Test Acc: 0.5596
Average Test Accuracy: 0.4869
============ Train epoch 20 ============
denominator: 25517.1328125
 Site-Clipart   | Train Loss: 2.0887 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 2.0739 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.0699 | Train Acc: 0.6533
 Site-Clipart   | Train Loss: 2.1116 | Train Acc: 0.5200
 Site-Infograph | Train Loss: 2.2397 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.1412 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 2.0698 | Train Acc: 0.5294
 Site-Painting  | Train Loss: 2.1152 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 2.0935 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.2144 | Train Acc: 0.3750
 Site-Real      | Train Loss: 2.0496 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 2.1240 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 2.0852 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 2.1074 | Val  Acc: 0.5152
 Site-Clipart   | Val  Loss: 2.0281 | Val  Acc: 0.6200
 Site-Clipart   | Val  Loss: 2.0678 | Val  Acc: 0.6567
 Site-Infograph | Val  Loss: 2.2438 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.0586 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 2.0908 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0754 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 2.0580 | Val  Acc: 0.6087
 Site-QuickDraw | Val  Loss: 2.2902 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1050 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 2.0762 | Val  Acc: 0.5217
Average Valid Accuracy: 0.5452
 Best site-Clipart    | Epoch:20 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:20 | Val Acc: 0.5152
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6200
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6567
 Best site-Infograph  | Epoch:20 | Val Acc: 0.2500
 Best site-Painting   | Epoch:20 | Val Acc: 0.8000
 Best site-Painting   | Epoch:20 | Val Acc: 0.6364
 Best site-Painting   | Epoch:20 | Val Acc: 0.5882
 Best site-Painting   | Epoch:20 | Val Acc: 0.6087
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.1429
 Best site-Real       | Epoch:20 | Val Acc: 0.6400
 Best site-Sketch     | Epoch:20 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 21 ============
denominator: 25363.8203125
 Site-Clipart   | Train Loss: 2.0568 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 2.1122 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.0697 | Train Acc: 0.5867
 Site-Clipart   | Train Loss: 2.0806 | Train Acc: 0.5500
 Site-Infograph | Train Loss: 2.2253 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1044 | Train Acc: 0.6250
 Site-Painting  | Train Loss: 2.2208 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.0689 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 2.0967 | Train Acc: 0.5429
 Site-QuickDraw | Train Loss: 2.2163 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.0646 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 2.0783 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 2.0766 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1200 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.0285 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0699 | Val  Acc: 0.6269
 Site-Infograph | Val  Loss: 2.2606 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1115 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0483 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0731 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 2.0582 | Val  Acc: 0.5217
 Site-QuickDraw | Val  Loss: 2.2807 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0681 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 2.0556 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5313
============ Train epoch 22 ============
denominator: 25235.001953125
 Site-Clipart   | Train Loss: 2.0778 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0308 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 2.0691 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 2.0781 | Train Acc: 0.5400
 Site-Infograph | Train Loss: 2.1979 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.1583 | Train Acc: 0.3750
 Site-Painting  | Train Loss: 2.2981 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.0186 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 2.1223 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.2108 | Train Acc: 0.2812
 Site-Real      | Train Loss: 2.0431 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 2.1185 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 2.0742 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0925 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.0128 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0534 | Val  Acc: 0.7313
 Site-Infograph | Val  Loss: 2.2432 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1133 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0818 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 2.0422 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 2.0521 | Val  Acc: 0.6087
 Site-QuickDraw | Val  Loss: 2.3100 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0701 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 2.0563 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5614
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:22 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7313
 Best site-Infograph  | Epoch:22 | Val Acc: 0.3000
 Best site-Painting   | Epoch:22 | Val Acc: 0.6000
 Best site-Painting   | Epoch:22 | Val Acc: 0.7273
 Best site-Painting   | Epoch:22 | Val Acc: 0.5882
 Best site-Painting   | Epoch:22 | Val Acc: 0.6087
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.1429
 Best site-Real       | Epoch:22 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:22 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 23 ============
denominator: 25320.01171875
 Site-Clipart   | Train Loss: 2.0590 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.0685 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 2.0466 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 2.0658 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 2.2425 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.0803 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.0143 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 2.0605 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 2.0482 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.2198 | Train Acc: 0.3125
 Site-Real      | Train Loss: 2.0358 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 2.0602 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0700 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 2.0554 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.9862 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0419 | Val  Acc: 0.6418
 Site-Infograph | Val  Loss: 2.2606 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.0856 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0793 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0039 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 2.0811 | Val  Acc: 0.5217
 Site-QuickDraw | Val  Loss: 2.2970 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0622 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 2.0798 | Val  Acc: 0.4348
Average Valid Accuracy: 0.5270
============ Train epoch 24 ============
denominator: 25244.853515625
 Site-Clipart   | Train Loss: 2.0370 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0657 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 2.0414 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 2.0605 | Train Acc: 0.5300
 Site-Infograph | Train Loss: 2.2248 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.0810 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.2199 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 2.0563 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 2.0569 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.2175 | Train Acc: 0.2812
 Site-Real      | Train Loss: 2.0128 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 2.0335 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0297 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0847 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0035 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0263 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 2.2636 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.0992 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0648 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 2.0068 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 2.0513 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.3084 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0631 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 2.0426 | Val  Acc: 0.5217
Average Valid Accuracy: 0.5416
============ Train epoch 25 ============
denominator: 24818.67578125
 Site-Clipart   | Train Loss: 2.0458 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 2.0787 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 2.0241 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 2.0513 | Train Acc: 0.5600
 Site-Infograph | Train Loss: 2.2144 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.0900 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.9582 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 2.0119 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 2.0467 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 2.2129 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.9892 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 2.0372 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 2.0510 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0422 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.9859 | Val  Acc: 0.5600
 Site-Clipart   | Val  Loss: 2.0320 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 2.2666 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0332 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0726 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0128 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 2.0303 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.3054 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0404 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 2.0213 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5528
============ Train epoch 26 ============
denominator: 24939.16015625
 Site-Clipart   | Train Loss: 1.9966 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 2.0363 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 2.0235 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0312 | Train Acc: 0.5500
 Site-Infograph | Train Loss: 2.2184 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1152 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.2198 | Train Acc: 0.4706
 Site-Painting  | Train Loss: 2.0401 | Train Acc: 0.5769
 Site-Painting  | Train Loss: 2.0813 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.2152 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.9655 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 2.0556 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 2.0248 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 2.0523 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.9676 | Val  Acc: 0.6200
 Site-Clipart   | Val  Loss: 2.0181 | Val  Acc: 0.6418
 Site-Infograph | Val  Loss: 2.2433 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.0068 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 2.0632 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 2.0707 | Val  Acc: 0.5294
 Site-Painting  | Val  Loss: 1.9851 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2595 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0352 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 2.0405 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5695
 Best site-Clipart    | Epoch:26 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:26 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:26 | Val Acc: 0.6200
 Best site-Clipart    | Epoch:26 | Val Acc: 0.6418
 Best site-Infograph  | Epoch:26 | Val Acc: 0.2500
 Best site-Painting   | Epoch:26 | Val Acc: 0.8000
 Best site-Painting   | Epoch:26 | Val Acc: 0.6364
 Best site-Painting   | Epoch:26 | Val Acc: 0.5294
 Best site-Painting   | Epoch:26 | Val Acc: 0.6957
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.1429
 Best site-Real       | Epoch:26 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:26 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 27 ============
denominator: 24714.796875
 Site-Clipart   | Train Loss: 2.0385 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0522 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 2.0165 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0004 | Train Acc: 0.5800
 Site-Infograph | Train Loss: 2.2248 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0580 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.2027 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 2.0259 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 2.0267 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.2138 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.9731 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 2.0166 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 2.0187 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0047 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.9531 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 2.0086 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 2.2755 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.0500 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0595 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.9750 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 2.0046 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2714 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0380 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.9924 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5875
 Best site-Clipart    | Epoch:27 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:27 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.6866
 Best site-Infograph  | Epoch:27 | Val Acc: 0.1500
 Best site-Painting   | Epoch:27 | Val Acc: 0.6000
 Best site-Painting   | Epoch:27 | Val Acc: 0.7273
 Best site-Painting   | Epoch:27 | Val Acc: 0.6471
 Best site-Painting   | Epoch:27 | Val Acc: 0.6957
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.1429
 Best site-Real       | Epoch:27 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:27 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 28 ============
denominator: 24739.837890625
 Site-Clipart   | Train Loss: 2.0480 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9554 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 2.0086 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.9978 | Train Acc: 0.6400
 Site-Infograph | Train Loss: 2.2156 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.0654 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.9306 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 2.0310 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.0134 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.2094 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.9621 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 2.0321 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 2.0301 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 2.0683 | Val  Acc: 0.5152
 Site-Clipart   | Val  Loss: 1.9545 | Val  Acc: 0.6200
 Site-Clipart   | Val  Loss: 1.9718 | Val  Acc: 0.7015
 Site-Infograph | Val  Loss: 2.2627 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.0283 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0423 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 2.0095 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 2.0215 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.2868 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0222 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 2.0050 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5497
============ Train epoch 29 ============
denominator: 24782.109375
 Site-Clipart   | Train Loss: 1.9830 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 2.0010 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.9863 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.9955 | Train Acc: 0.6200
 Site-Infograph | Train Loss: 2.2234 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.0200 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.0171 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9896 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.0780 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.2011 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.9427 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9551 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0282 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 2.0242 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.9373 | Val  Acc: 0.6400
 Site-Clipart   | Val  Loss: 1.9754 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 2.2449 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0495 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0297 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9973 | Val  Acc: 0.5882
 Site-Painting  | Val  Loss: 1.9799 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2715 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0012 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.9736 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5737
============ Train epoch 30 ============
denominator: 24639.43359375
 Site-Clipart   | Train Loss: 2.0026 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 2.0184 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.9835 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 2.0151 | Train Acc: 0.6800
 Site-Infograph | Train Loss: 2.2078 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.0081 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 1.8112 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.9992 | Train Acc: 0.6154
 Site-Painting  | Train Loss: 2.0349 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.2040 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.9422 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 2.0461 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.9680 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 2.0288 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9173 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.9750 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 2.2717 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.0566 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0218 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.9732 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.9966 | Val  Acc: 0.6087
 Site-QuickDraw | Val  Loss: 2.2779 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0100 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.9946 | Val  Acc: 0.6522
Average Valid Accuracy: 0.5857
============ Train epoch 31 ============
denominator: 24342.248046875
 Site-Clipart   | Train Loss: 2.0006 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 2.0189 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.9872 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.9668 | Train Acc: 0.6100
 Site-Infograph | Train Loss: 2.2132 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.0384 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.0951 | Train Acc: 0.5882
 Site-Painting  | Train Loss: 1.9464 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 2.0348 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.2104 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.9808 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.9523 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.9831 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0327 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.9065 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.9676 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 2.2704 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9967 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 2.0076 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.9852 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.9635 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2843 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.0120 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.9952 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5961
 Best site-Clipart    | Epoch:31 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:31 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:31 | Val Acc: 0.6600
 Best site-Clipart    | Epoch:31 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:31 | Val Acc: 0.2000
 Best site-Painting   | Epoch:31 | Val Acc: 0.8000
 Best site-Painting   | Epoch:31 | Val Acc: 0.7273
 Best site-Painting   | Epoch:31 | Val Acc: 0.6471
 Best site-Painting   | Epoch:31 | Val Acc: 0.6957
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.1905
 Best site-Real       | Epoch:31 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:31 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 32 ============
denominator: 24561.896484375
 Site-Clipart   | Train Loss: 2.0121 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 2.0170 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.9765 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.9671 | Train Acc: 0.6500
 Site-Infograph | Train Loss: 2.2022 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.0273 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.7810 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9430 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 2.1165 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.1917 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.9562 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9903 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.9683 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0152 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.9028 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.9516 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.2167 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.9827 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9730 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9568 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.9604 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2685 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9919 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.9498 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6133
 Best site-Clipart    | Epoch:32 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:32 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:32 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:32 | Val Acc: 0.7612
 Best site-Infograph  | Epoch:32 | Val Acc: 0.2500
 Best site-Painting   | Epoch:32 | Val Acc: 0.8000
 Best site-Painting   | Epoch:32 | Val Acc: 0.6364
 Best site-Painting   | Epoch:32 | Val Acc: 0.7059
 Best site-Painting   | Epoch:32 | Val Acc: 0.6522
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.1905
 Best site-Real       | Epoch:32 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:32 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 33 ============
denominator: 24094.708984375
 Site-Clipart   | Train Loss: 1.9452 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 2.0459 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9416 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.9681 | Train Acc: 0.6300
 Site-Infograph | Train Loss: 2.2096 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0299 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.0546 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9755 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 2.0310 | Train Acc: 0.6286
 Site-QuickDraw | Train Loss: 2.1806 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.9342 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.8833 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.9852 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.9795 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.8880 | Val  Acc: 0.6200
 Site-Clipart   | Val  Loss: 1.9756 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 2.2213 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9281 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9695 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9405 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.9324 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2810 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9810 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.9381 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6244
 Best site-Clipart    | Epoch:33 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:33 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:33 | Val Acc: 0.6200
 Best site-Clipart    | Epoch:33 | Val Acc: 0.6866
 Best site-Infograph  | Epoch:33 | Val Acc: 0.3000
 Best site-Painting   | Epoch:33 | Val Acc: 0.8000
 Best site-Painting   | Epoch:33 | Val Acc: 0.6364
 Best site-Painting   | Epoch:33 | Val Acc: 0.8235
 Best site-Painting   | Epoch:33 | Val Acc: 0.6522
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.1905
 Best site-Real       | Epoch:33 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:33 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 34 ============
denominator: 24090.66796875
 Site-Clipart   | Train Loss: 1.9623 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9745 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9546 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.9464 | Train Acc: 0.6200
 Site-Infograph | Train Loss: 2.1953 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.9743 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.8896 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9590 | Train Acc: 0.6538
 Site-Painting  | Train Loss: 2.0774 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.1953 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.9193 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9768 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.9693 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.9875 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.8957 | Val  Acc: 0.6400
 Site-Clipart   | Val  Loss: 1.9336 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 2.2664 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.9486 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9890 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9371 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.9371 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2619 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9774 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.9625 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6277
 Best site-Clipart    | Epoch:34 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:34 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:34 | Val Acc: 0.6400
 Best site-Clipart    | Epoch:34 | Val Acc: 0.7463
 Best site-Infograph  | Epoch:34 | Val Acc: 0.2500
 Best site-Painting   | Epoch:34 | Val Acc: 0.8000
 Best site-Painting   | Epoch:34 | Val Acc: 0.6364
 Best site-Painting   | Epoch:34 | Val Acc: 0.7647
 Best site-Painting   | Epoch:34 | Val Acc: 0.6522
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.2381
 Best site-Real       | Epoch:34 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:34 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 35 ============
denominator: 24096.0703125
 Site-Clipart   | Train Loss: 1.9709 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9288 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.9464 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.9213 | Train Acc: 0.7000
 Site-Infograph | Train Loss: 2.1950 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9782 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.8509 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9456 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.9908 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.1984 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.8923 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9592 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.9401 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.9708 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.8532 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.9359 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.2219 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9987 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9654 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.9308 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.9312 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2478 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9731 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.9385 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6241
============ Train epoch 36 ============
denominator: 23935.546875
 Site-Clipart   | Train Loss: 1.9725 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8305 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9160 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.9224 | Train Acc: 0.6800
 Site-Infograph | Train Loss: 2.1955 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.9429 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.7297 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.9394 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.9722 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1980 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9176 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9660 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.9319 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.9935 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.8513 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.9183 | Val  Acc: 0.7313
 Site-Infograph | Val  Loss: 2.2154 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9865 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9576 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.9236 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.9122 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2536 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9677 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.9071 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6140
============ Train epoch 37 ============
denominator: 23853.44921875
 Site-Clipart   | Train Loss: 1.9138 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.9175 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.9183 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.9326 | Train Acc: 0.6900
 Site-Infograph | Train Loss: 2.2064 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.9930 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.9416 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.9338 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.9035 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1844 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.8939 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9148 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.9102 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.9646 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.8510 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.9169 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 2.2465 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.9627 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9597 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8862 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.9373 | Val  Acc: 0.5217
 Site-QuickDraw | Val  Loss: 2.2470 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9360 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.9520 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5986
============ Train epoch 38 ============
denominator: 23867.044921875
 Site-Clipart   | Train Loss: 1.9213 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8713 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.9159 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.9164 | Train Acc: 0.7200
 Site-Infograph | Train Loss: 2.1895 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9355 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.8619 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9155 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.9467 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1728 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.9189 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.9646 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.9543 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.9397 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.8343 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.8981 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 2.2633 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9529 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9397 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.9218 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.9072 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2621 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9425 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.9369 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6243
============ Train epoch 39 ============
denominator: 23593.189453125
 Site-Clipart   | Train Loss: 1.9276 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 2.0013 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.9262 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.8976 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.1711 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.9978 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.9464 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9472 | Train Acc: 0.5385
 Site-Painting  | Train Loss: 2.0456 | Train Acc: 0.6571
 Site-QuickDraw | Train Loss: 2.1955 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.8783 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.9452 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.9272 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.9425 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.8181 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.8817 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 2.2609 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.8753 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9386 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.9071 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.8859 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.2590 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9288 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.9210 | Val  Acc: 0.4783
Average Valid Accuracy: 0.6312
 Best site-Clipart    | Epoch:39 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:39 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:39 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:39 | Val Acc: 0.7910
 Best site-Infograph  | Epoch:39 | Val Acc: 0.2000
 Best site-Painting   | Epoch:39 | Val Acc: 0.8000
 Best site-Painting   | Epoch:39 | Val Acc: 0.7273
 Best site-Painting   | Epoch:39 | Val Acc: 0.7059
 Best site-Painting   | Epoch:39 | Val Acc: 0.7391
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.2381
 Best site-Real       | Epoch:39 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:39 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.7262
 Test site-Infograph | Epoch:39 | Test Acc: 0.3668
 Test site-Painting  | Epoch:39 | Test Acc: 0.7496
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.2290
 Test site-Real      | Epoch:39 | Test Acc: 0.8431
 Test site-Sketch    | Epoch:39 | Test Acc: 0.6733
Average Test Accuracy: 0.5980
============ Train epoch 40 ============
denominator: 23653.294921875
 Site-Clipart   | Train Loss: 1.9196 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.9264 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9009 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.9241 | Train Acc: 0.6900
 Site-Infograph | Train Loss: 2.2030 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.9233 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.8857 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.9130 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.9144 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.1596 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.8571 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.9480 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.9125 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.9574 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7998 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.8970 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 2.2249 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9726 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9220 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8898 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.9100 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2539 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9220 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.8712 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6033
============ Train epoch 41 ============
denominator: 23811.921875
 Site-Clipart   | Train Loss: 1.9058 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.9045 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8924 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.9218 | Train Acc: 0.7000
 Site-Infograph | Train Loss: 2.1835 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.9332 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.0228 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.8883 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.9732 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.1685 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.8856 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.9058 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.8835 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8999 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.8201 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.8760 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.2357 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.8902 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9449 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8935 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.9285 | Val  Acc: 0.5652
 Site-QuickDraw | Val  Loss: 2.2599 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9131 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.9257 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6237
============ Train epoch 42 ============
denominator: 23507.04296875
 Site-Clipart   | Train Loss: 1.9202 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8896 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8967 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 1.9059 | Train Acc: 0.7100
 Site-Infograph | Train Loss: 2.1840 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.9548 | Train Acc: 0.7500
 Site-Painting  | Train Loss: 2.0557 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.8838 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.9269 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.1690 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.8629 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.8472 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.9047 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.9049 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8130 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.8636 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 2.2092 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.8365 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8817 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.9419 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.8667 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.2309 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9075 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.8511 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6647
 Best site-Clipart    | Epoch:42 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:42 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:42 | Val Acc: 0.7200
 Best site-Clipart    | Epoch:42 | Val Acc: 0.7463
 Best site-Infograph  | Epoch:42 | Val Acc: 0.3000
 Best site-Painting   | Epoch:42 | Val Acc: 0.8000
 Best site-Painting   | Epoch:42 | Val Acc: 0.8182
 Best site-Painting   | Epoch:42 | Val Acc: 0.6471
 Best site-Painting   | Epoch:42 | Val Acc: 0.7826
 Best site-QuickDraw  | Epoch:42 | Val Acc: 0.1905
 Best site-Real       | Epoch:42 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:42 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 43 ============
denominator: 23504.71484375
 Site-Clipart   | Train Loss: 1.9158 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8866 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.8770 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.8736 | Train Acc: 0.7400
 Site-Infograph | Train Loss: 2.1895 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.9129 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.1151 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.8778 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.8714 | Train Acc: 0.7714
 Site-QuickDraw | Train Loss: 2.1741 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.8602 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.8619 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.8344 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.9097 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7837 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.8656 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 2.2314 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.9810 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.9371 | Val  Acc: 0.5455
 Site-Painting  | Val  Loss: 1.8766 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.8802 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.2197 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8962 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.8514 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6219
============ Train epoch 44 ============
denominator: 23209.43359375
 Site-Clipart   | Train Loss: 1.8910 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8592 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.8620 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.9009 | Train Acc: 0.7400
 Site-Infograph | Train Loss: 2.1651 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.8963 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.7712 | Train Acc: 0.7647
 Site-Painting  | Train Loss: 1.9021 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 2.0037 | Train Acc: 0.6857
 Site-QuickDraw | Train Loss: 2.1742 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.8334 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.8326 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8582 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.8823 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.7916 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.8540 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 2.2226 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.8967 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8586 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8626 | Val  Acc: 0.6471
 Site-Painting  | Val  Loss: 1.8581 | Val  Acc: 0.6522
 Site-QuickDraw | Val  Loss: 2.2320 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8800 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.8804 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6322
============ Train epoch 45 ============
denominator: 23166.98046875
 Site-Clipart   | Train Loss: 1.9055 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.9779 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8416 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.8438 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.1783 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.9004 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.7968 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.8546 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 1.9238 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1645 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.8393 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.8727 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.8903 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.8741 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.7806 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.8407 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.2122 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9065 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8969 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8722 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.8548 | Val  Acc: 0.6957
 Site-QuickDraw | Val  Loss: 2.2355 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8846 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.8325 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6458
============ Train epoch 46 ============
denominator: 23244.369140625
 Site-Clipart   | Train Loss: 1.8654 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.7844 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8383 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.8335 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.1737 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9014 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.7764 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.8331 | Train Acc: 0.6923
 Site-Painting  | Train Loss: 1.9586 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.1675 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.8303 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.8681 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.8681 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.8897 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7547 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.8194 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.2053 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.8587 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8507 | Val  Acc: 0.7273
 Site-Painting  | Val  Loss: 1.8584 | Val  Acc: 0.8235
 Site-Painting  | Val  Loss: 1.7908 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.2273 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8778 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.8830 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6636
============ Train epoch 47 ============
denominator: 23125.931640625
 Site-Clipart   | Train Loss: 1.9137 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8694 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8315 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.8028 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.1581 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8613 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.6057 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.8300 | Train Acc: 0.8077
 Site-Painting  | Train Loss: 1.8765 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1575 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.7801 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.9053 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.8897 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8732 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.7485 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.8257 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 2.2481 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.8686 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8813 | Val  Acc: 0.6364
 Site-Painting  | Val  Loss: 1.8261 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.7838 | Val  Acc: 0.8261
 Site-QuickDraw | Val  Loss: 2.2543 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8577 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.8290 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6422
============ Train epoch 48 ============
denominator: 23144.30078125
 Site-Clipart   | Train Loss: 1.8451 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.8065 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8521 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.8129 | Train Acc: 0.7700
 Site-Infograph | Train Loss: 2.1846 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8451 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 2.1735 | Train Acc: 0.7059
 Site-Painting  | Train Loss: 1.8209 | Train Acc: 0.7692
 Site-Painting  | Train Loss: 2.0218 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 2.1699 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.7627 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.8212 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8806 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8642 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7119 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.8348 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.2073 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.8176 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8113 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.8350 | Val  Acc: 0.7059
 Site-Painting  | Val  Loss: 1.8236 | Val  Acc: 0.7826
 Site-QuickDraw | Val  Loss: 2.2314 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8526 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.8137 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6804
 Best site-Clipart    | Epoch:48 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:48 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:48 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:48 | Val Acc: 0.8060
 Best site-Infograph  | Epoch:48 | Val Acc: 0.2500
 Best site-Painting   | Epoch:48 | Val Acc: 0.8000
 Best site-Painting   | Epoch:48 | Val Acc: 0.8182
 Best site-Painting   | Epoch:48 | Val Acc: 0.7059
 Best site-Painting   | Epoch:48 | Val Acc: 0.7826
 Best site-QuickDraw  | Epoch:48 | Val Acc: 0.1905
 Best site-Real       | Epoch:48 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:48 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-4_1/q-ffl...
============ Train epoch 49 ============
denominator: 23115.68359375
 Site-Clipart   | Train Loss: 1.8687 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8838 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.8150 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.8614 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.1581 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.8682 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 1.7577 | Train Acc: 0.6471
 Site-Painting  | Train Loss: 1.8029 | Train Acc: 0.7308
 Site-Painting  | Train Loss: 1.9893 | Train Acc: 0.7429
 Site-QuickDraw | Train Loss: 2.1643 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.8017 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.9525 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8527 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8445 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7245 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.8055 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.2054 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.8881 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8413 | Val  Acc: 0.8182
 Site-Painting  | Val  Loss: 1.8271 | Val  Acc: 0.7647
 Site-Painting  | Val  Loss: 1.7948 | Val  Acc: 0.7391
 Site-QuickDraw | Val  Loss: 2.2018 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8670 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.7948 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6714
===2023-04-21 11:34:57===
===2023-04-21 11:34:58===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,8,17,26,35,32,38,35,]
label set of clients: [10, 10, 10, 10, 10, 6, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:48 | Test Acc: 0.7643
 Test site-Infograph | Epoch:48 | Test Acc: 0.3836
 Test site-Painting  | Epoch:48 | Test Acc: 0.7738
 Test site-QuickDraw | Epoch:48 | Test Acc: 0.2480
 Test site-Real      | Epoch:48 | Test Acc: 0.8652
 Test site-Sketch    | Epoch:48 | Test Acc: 0.6968
Average Test Accuracy: 0.6219
