===2023-03-29 13:58:13===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-Clipart   | Train Loss: 1.9549 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9122 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8206 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.9200 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 2.1963 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1541 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.0808 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 1.9380 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.9631 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 2.3236 | Train Acc: 0.1429
 Site-Real      | Train Loss: 1.8331 | Train Acc: 0.5556
 Site-Sketch    | Train Loss: 1.8843 | Train Acc: 0.5556
 Site-Clipart   | Val  Loss: 1.8008 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.8095 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9098 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0181 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.0936 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0989 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1774 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 1.8036 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 2.0801 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.2609 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 1.9191 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.9864 | Val  Acc: 0.4048
Average Valid Accuracy: 0.3849
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1667
 Best site-Painting   | Epoch:0 | Val Acc: 0.5000
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.5390 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.6430 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.4704 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.4785 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 2.0889 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.9730 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.9037 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.4848 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 1.5277 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 2.2476 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.3327 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.3911 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3463 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.3821 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5909 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6906 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.9142 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 1.9727 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1476 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.2942 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.6489 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.1811 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.4390 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.5876 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5377
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Painting   | Epoch:1 | Val Acc: 0.7857
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1667
 Best site-Real       | Epoch:1 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2304 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.2967 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.1111 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.0636 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.9093 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8300 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.6863 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 1.0803 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 1.0424 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 2.1448 | Train Acc: 0.2698
 Site-Real      | Train Loss: 0.9459 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0508 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.9719 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 1.0509 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.2827 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.3049 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7405 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 1.7914 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9226 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 0.9412 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.1990 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 2.1834 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9613 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.2850 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6548
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2619
 Best site-Painting   | Epoch:2 | Val Acc: 0.8810
 Best site-Painting   | Epoch:2 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3333
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.9445 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.0570 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.8124 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7557 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.7616 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6206 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4989 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 0.8285 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.8310 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.0198 | Train Acc: 0.2540
 Site-Real      | Train Loss: 0.6372 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.8723 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.6874 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6772 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 1.0368 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.0966 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6900 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.5151 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7991 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.7295 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.9534 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 2.0112 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7212 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0438 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6786
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3810
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-Painting   | Epoch:3 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.7199 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.9062 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.6019 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5449 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.6247 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4713 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2955 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.6539 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.6456 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.9053 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.4626 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6509 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4954 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5880 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8366 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8295 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.4609 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.3844 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7121 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.5295 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.7404 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 2.0426 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.5350 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8719 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7202
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4524
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-Painting   | Epoch:4 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2381
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.5509 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6536 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.4667 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3772 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.4426 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2427 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1130 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.5136 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.4434 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.8289 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.4392 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.4975 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3581 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4069 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.7258 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6363 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3926 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.1709 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4028 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.3806 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5463 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.9432 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.4628 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8365 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7659
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5238
 Best site-Painting   | Epoch:5 | Val Acc: 0.9524
 Best site-Painting   | Epoch:5 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2857
 Best site-Real       | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.4641 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5785 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.3938 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2749 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.3146 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.1991 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.1744 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.3847 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.3566 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.5476 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.3397 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5703 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.2666 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3059 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.6367 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4658 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.2178 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0877 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4433 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.3496 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4298 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.7020 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.3299 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7571 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8016
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5238
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3571
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.2672 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4474 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2365 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2073 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.2586 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0173 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.0752 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.2832 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.3089 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.7163 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.2388 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3115 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2019 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2150 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5345 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4301 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.1279 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.0364 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.1943 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.2104 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3230 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.8754 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3117 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6573 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8095
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4524
 Best site-Real       | Epoch:7 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3383 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4055 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2463 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1927 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.0408 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8237 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.8551 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2605 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.1607 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.4093 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.3024 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.2520 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2220 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2093 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3868 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3605 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8598 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.7378 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0194 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.1484 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2751 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.7995 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.3727 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8032 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8472
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7143
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3810
 Best site-Real       | Epoch:8 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2526 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3947 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2246 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1131 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.1711 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8074 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.9686 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.1888 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.1952 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3885 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.1621 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2133 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1621 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1656 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4153 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3244 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.0647 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 0.9440 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1229 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.1948 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.1936 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.8171 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.2358 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6179 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8095
===2023-03-29 14:31:32===
===2023-03-29 14:31:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.8441
 Test site-Infograph | Epoch:8 | Test Acc: 0.4825
 Test site-Painting  | Epoch:8 | Test Acc: 0.8465
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.4530
 Test site-Real      | Epoch:8 | Test Acc: 0.9228
 Test site-Sketch    | Epoch:8 | Test Acc: 0.7978
Average Test Accuracy: 0.7245
===2023-03-30 21:50:09===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
only align at first round
 Site-Clipart   | Train Loss: 1.9868 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9135 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8534 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.8551 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 2.1422 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.1493 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.0123 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.9730 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.9864 | Train Acc: 0.4127
 Site-QuickDraw | Train Loss: 2.3240 | Train Acc: 0.0794
 Site-Real      | Train Loss: 1.8880 | Train Acc: 0.5397
 Site-Sketch    | Train Loss: 1.8889 | Train Acc: 0.4444
 Site-Clipart   | Val  Loss: 1.8830 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.8732 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9567 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9941 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0331 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0882 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.2041 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8548 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 2.0395 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.2806 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.9979 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 2.0408 | Val  Acc: 0.3810
Average Valid Accuracy: 0.3790
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.4762
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-1
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
clients=[(7,)(1,)(4,)]
 Site-Clipart   | Train Loss: 1.6235 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.6205 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.5361 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.4944 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.0617 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.9766 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.8543 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.4520 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 1.4687 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.2295 | Train Acc: 0.1746
 Site-Real      | Train Loss: 1.4023 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.4568 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.4365 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4615 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5986 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.5597 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.9588 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9336 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0979 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.3372 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 1.6006 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.2691 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 1.5232 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.6400 | Val  Acc: 0.5714
Average Valid Accuracy: 0.5218
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2143
 Best site-Painting   | Epoch:1 | Val Acc: 0.7143
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1190
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-1
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
clients=[(4,)(7,)(1,)]
 Site-Clipart   | Train Loss: 1.2559 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.3450 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.1816 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.0685 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.9758 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.7833 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.7091 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.1430 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 1.1055 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.1446 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.0186 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.1891 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0988 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1189 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.3384 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3325 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7699 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.7595 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0375 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 0.9768 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 1.2908 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 2.1826 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.1122 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.4581 | Val  Acc: 0.5952
Average Valid Accuracy: 0.6369
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3095
 Best site-Painting   | Epoch:2 | Val Acc: 0.9048
 Best site-Painting   | Epoch:2 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3095
 Best site-Real       | Epoch:2 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
clients=[(3,)(6,)(3,)]
 Site-Clipart   | Train Loss: 1.0302 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.0632 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 0.9352 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8209 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.8389 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.6036 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.4729 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 0.8827 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.8095 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 2.0467 | Train Acc: 0.3016
 Site-Real      | Train Loss: 0.7964 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.9523 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 0.8627 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8646 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1501 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9697 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.5421 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5114 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.8460 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.6876 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.9660 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 2.0408 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.8239 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.1898 | Val  Acc: 0.5952
Average Valid Accuracy: 0.6865
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3571
 Best site-Painting   | Epoch:3 | Val Acc: 0.9524
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
clients=[(3,)(6,)(3,)]
 Site-Clipart   | Train Loss: 0.6931 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7752 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6758 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5340 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.6231 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.4078 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.2432 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.6378 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.6070 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.9208 | Train Acc: 0.2698
 Site-Real      | Train Loss: 0.5548 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6954 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.5617 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5665 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.9255 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.7780 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3403 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.3546 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7119 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.5372 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.7477 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.9398 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.5088 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9577 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7401
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4048
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-Painting   | Epoch:4 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3810
 Best site-Real       | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
clients=[(3,)(6,)(3,)]
 Site-Clipart   | Train Loss: 0.5219 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.7091 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.5393 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4133 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.5820 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.2835 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.1364 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.5289 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.4886 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.6792 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.4418 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.6048 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4915 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4849 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7493 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.6207 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1061 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1536 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5833 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.4593 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.6433 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.8539 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.4480 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8160 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7619
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.9286
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4048
 Best site-Real       | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
clients=[(3,)(6,)(3,)]
 Site-Clipart   | Train Loss: 0.4173 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7257 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.4468 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3117 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.5191 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.2155 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.1048 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.4469 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.3776 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.4181 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.3309 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6243 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.2953 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3598 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.6291 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4848 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.2509 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.0157 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6113 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.4192 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.5126 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.4987 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3534 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.8298 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7956
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4048
 Best site-Painting   | Epoch:6 | Val Acc: 0.9048
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5000
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
clients=[(3,)(6,)(3,)]
 Site-Clipart   | Train Loss: 0.2638 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.5096 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.3832 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2781 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.2891 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 0.8725 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8917 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2935 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.3178 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3071 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.3814 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.4866 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.2920 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3727 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4577 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4453 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8673 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.8160 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.4854 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.2651 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3542 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.6057 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3780 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.6362 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8214
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3810
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5000
 Best site-Real       | Epoch:7 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
clients=[(3,)(6,)(3,)]
 Site-Clipart   | Train Loss: 0.2754 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3283 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2823 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1982 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.2697 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 0.9519 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.7487 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2189 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2733 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2261 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.2794 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4254 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.2292 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2394 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4169 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3413 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7922 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9185 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.0598 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.1883 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2560 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.3921 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2986 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7106 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8452
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6429
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4762
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
clients=[(3,)(6,)(3,)]
 Site-Clipart   | Train Loss: 0.2878 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3083 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2421 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2077 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.9179 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.6553 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 0.6062 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2596 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.1979 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.3770 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.2999 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3696 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2200 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1762 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2878 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2223 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7016 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.5468 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.8481 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.1224 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2788 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.3961 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.3405 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7170 | Val  Acc: 0.7619
Average Valid Accuracy: 0.8631
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7143
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5714
 Best site-Real       | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
===2023-03-30 22:22:57===
===2023-03-30 22:22:58===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8460
 Test site-Infograph | Epoch:9 | Test Acc: 0.5038
 Test site-Painting  | Epoch:9 | Test Acc: 0.8384
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4300
 Test site-Real      | Epoch:9 | Test Acc: 0.9071
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7834
Average Test Accuracy: 0.7181
