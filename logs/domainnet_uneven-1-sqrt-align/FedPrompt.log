===2023-03-29 13:58:13===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-Clipart   | Train Loss: 1.9549 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9122 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8206 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.9200 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 2.1963 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1541 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.0808 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 1.9380 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.9631 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 2.3236 | Train Acc: 0.1429
 Site-Real      | Train Loss: 1.8331 | Train Acc: 0.5556
 Site-Sketch    | Train Loss: 1.8843 | Train Acc: 0.5556
 Site-Clipart   | Val  Loss: 1.8008 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.8095 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9098 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0181 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.0936 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0989 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1774 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 1.8036 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 2.0801 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.2609 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 1.9191 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.9864 | Val  Acc: 0.4048
Average Valid Accuracy: 0.3849
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1667
 Best site-Painting   | Epoch:0 | Val Acc: 0.5000
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.5390 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.6430 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.4704 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.4785 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 2.0889 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.9730 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.9037 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.4848 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 1.5277 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 2.2476 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.3327 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.3911 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3463 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.3821 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5909 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6906 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.9142 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 1.9727 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1476 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.2942 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.6489 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.1811 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.4390 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.5876 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5377
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Painting   | Epoch:1 | Val Acc: 0.7857
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1667
 Best site-Real       | Epoch:1 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2304 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.2967 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.1111 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.0636 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.9093 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8300 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.6863 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 1.0803 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 1.0424 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 2.1448 | Train Acc: 0.2698
 Site-Real      | Train Loss: 0.9459 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0508 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.9719 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 1.0509 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.2827 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.3049 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7405 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 1.7914 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9226 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 0.9412 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.1990 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 2.1834 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9613 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.2850 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6548
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2619
 Best site-Painting   | Epoch:2 | Val Acc: 0.8810
 Best site-Painting   | Epoch:2 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3333
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.9445 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.0570 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.8124 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7557 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.7616 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6206 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4989 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 0.8285 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.8310 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.0198 | Train Acc: 0.2540
 Site-Real      | Train Loss: 0.6372 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.8723 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.6874 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6772 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 1.0368 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.0966 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6900 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.5151 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7991 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.7295 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.9534 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 2.0112 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7212 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0438 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6786
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3810
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-Painting   | Epoch:3 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.7199 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.9062 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.6019 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5449 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.6247 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4713 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2955 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.6539 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.6456 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.9053 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.4626 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6509 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4954 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5880 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8366 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8295 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.4609 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.3844 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7121 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.5295 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.7404 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 2.0426 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.5350 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8719 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7202
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4524
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-Painting   | Epoch:4 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2381
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.5509 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6536 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.4667 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3772 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.4426 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2427 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1130 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.5136 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.4434 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.8289 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.4392 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.4975 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3581 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4069 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.7258 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6363 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3926 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.1709 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4028 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.3806 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5463 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.9432 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.4628 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8365 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7659
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5238
 Best site-Painting   | Epoch:5 | Val Acc: 0.9524
 Best site-Painting   | Epoch:5 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2857
 Best site-Real       | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.4641 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5785 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.3938 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2749 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.3146 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.1991 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.1744 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.3847 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.3566 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.5476 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.3397 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5703 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.2666 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3059 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.6367 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4658 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.2178 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0877 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4433 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.3496 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4298 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.7020 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.3299 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7571 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8016
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5238
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3571
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.2672 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4474 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2365 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2073 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.2586 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0173 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.0752 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.2832 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.3089 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.7163 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.2388 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3115 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2019 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2150 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5345 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4301 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.1279 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.0364 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.1943 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.2104 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3230 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.8754 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3117 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6573 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8095
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4524
 Best site-Real       | Epoch:7 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3383 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4055 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2463 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1927 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.0408 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8237 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.8551 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2605 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.1607 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.4093 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.3024 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.2520 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2220 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2093 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3868 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3605 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8598 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.7378 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0194 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.1484 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2751 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.7995 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.3727 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8032 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8472
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7143
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3810
 Best site-Real       | Epoch:8 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2526 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3947 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2246 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1131 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.1711 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8074 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.9686 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.1888 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.1952 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3885 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.1621 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2133 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1621 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1656 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4153 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3244 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.0647 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 0.9440 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1229 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.1948 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.1936 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.8171 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.2358 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6179 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8095
===2023-03-29 14:31:32===
===2023-03-29 14:31:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.8441
 Test site-Infograph | Epoch:8 | Test Acc: 0.4825
 Test site-Painting  | Epoch:8 | Test Acc: 0.8465
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.4530
 Test site-Real      | Epoch:8 | Test Acc: 0.9228
 Test site-Sketch    | Epoch:8 | Test Acc: 0.7978
Average Test Accuracy: 0.7245
