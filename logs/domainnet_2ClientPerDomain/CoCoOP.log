===2023-03-24 15:35:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.9906 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 1.9314 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 2.1609 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1421 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 1.8682 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.9313 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2561 | Train Acc: 0.1270
 Site-QuickDraw | Train Loss: 2.1932 | Train Acc: 0.2698
 Site-Real      | Train Loss: 1.8500 | Train Acc: 0.5079
 Site-Real      | Train Loss: 1.9382 | Train Acc: 0.4762
 Site-Sketch    | Train Loss: 1.8876 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.9321 | Train Acc: 0.4127
 Site-Clipart   | Val  Loss: 1.9047 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.9349 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.1282 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1022 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.8200 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 2.0212 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.1374 | Val  Acc: 0.3095
 Site-QuickDraw | Val  Loss: 2.2163 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.8695 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 2.0411 | Val  Acc: 0.3571
 Site-Sketch    | Val  Loss: 1.8986 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.0314 | Val  Acc: 0.3810
Average Valid Accuracy: 0.4028
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Painting   | Epoch:0 | Val Acc: 0.5238
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.3095
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Real       | Epoch:0 | Val Acc: 0.3571
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_2ClientPerDomain/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.5975 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.5950 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.9891 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.9266 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.4780 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 1.4352 | Train Acc: 0.7302
 Site-QuickDraw | Train Loss: 2.1133 | Train Acc: 0.2857
 Site-QuickDraw | Train Loss: 2.0044 | Train Acc: 0.4127
 Site-Real      | Train Loss: 1.3756 | Train Acc: 0.7619
 Site-Real      | Train Loss: 1.3935 | Train Acc: 0.7302
 Site-Sketch    | Train Loss: 1.4298 | Train Acc: 0.6825
 Site-Sketch    | Train Loss: 1.5252 | Train Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.6037 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.6057 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.8931 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.0447 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.3157 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 1.5666 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.8680 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.0697 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.3347 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 1.4393 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.5181 | Val  Acc: 0.6190
 Site-Sketch    | Val  Loss: 1.6398 | Val  Acc: 0.4762
Average Valid Accuracy: 0.5675
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.8095
 Best site-Painting   | Epoch:1 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3333
 Best site-Real       | Epoch:1 | Val Acc: 0.8095
 Best site-Real       | Epoch:1 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6190
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_2ClientPerDomain/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2680 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.3851 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.8192 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7798 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.1270 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 1.0560 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9439 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 1.8882 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.9753 | Train Acc: 0.8254
 Site-Real      | Train Loss: 0.9463 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.1227 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.2445 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.3944 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3402 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6435 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9348 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.9968 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.2331 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.7266 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 1.9646 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9161 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 1.0242 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.1864 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.3355 | Val  Acc: 0.5952
Average Valid Accuracy: 0.6448
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.8333
 Best site-Painting   | Epoch:2 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3333
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_2ClientPerDomain/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0564 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.1351 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.7259 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.6034 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 0.8867 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.8861 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 1.8659 | Train Acc: 0.4127
 Site-QuickDraw | Train Loss: 1.6556 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.6639 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.6410 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.9058 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.0056 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.1130 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.0912 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4690 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8607 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.7099 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 1.0362 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.6066 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.7923 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.6125 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.7099 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0232 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.0792 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7123
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3810
 Best site-Painting   | Epoch:3 | Val Acc: 0.9524
 Best site-Painting   | Epoch:3 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4048
 Best site-Real       | Epoch:3 | Val Acc: 0.9286
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_2ClientPerDomain/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8941 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.8657 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.5441 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.4308 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.6831 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.6688 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.7688 | Train Acc: 0.4603
 Site-QuickDraw | Train Loss: 1.5401 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.5089 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.4807 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7062 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.7375 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.9182 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.8383 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2965 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4536 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.5823 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.7874 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4262 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.7850 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.4123 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.5044 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.7626 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.0431 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7321
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5238
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4286
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Real       | Epoch:4 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_2ClientPerDomain/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6359 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7310 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.4409 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.2109 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.5302 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.5966 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.6820 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 1.4565 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.3897 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.3630 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6318 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6846 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7607 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6924 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.0859 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4106 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.3998 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.6256 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.3303 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.7109 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3292 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3955 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5848 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7875 | Val  Acc: 0.9048
Average Valid Accuracy: 0.7996
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5476
 Best site-Painting   | Epoch:5 | Val Acc: 0.9524
 Best site-Painting   | Epoch:5 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4286
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Real       | Epoch:5 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:5 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:5 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_2ClientPerDomain/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.4974 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6336 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.3102 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1287 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.4629 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.4199 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.6901 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 1.3682 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.2991 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.2711 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5475 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5550 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6645 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5757 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.0194 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3346 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.3810 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.5043 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.1283 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.5419 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.2432 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3427 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5023 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7379 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8115
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-Painting   | Epoch:6 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_2ClientPerDomain/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4367 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5179 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.0047 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.0021 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.3607 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.3360 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3453 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.2477 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.2773 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.2082 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3855 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4375 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.5834 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4423 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8920 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1179 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.2910 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.4495 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.0838 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.4405 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1762 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2536 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4239 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6612 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8452
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5476
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_2ClientPerDomain/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3681 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4574 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.1270 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.9096 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.2930 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.3205 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.4188 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.1169 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.2012 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1639 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3593 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.4006 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.4953 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3910 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8504 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0455 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.1870 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4933 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.1282 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.4053 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1786 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2561 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3203 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.6275 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8393
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.3051 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3925 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.9600 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8116 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.2682 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.1964 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.3151 | Train Acc: 0.6349
 Site-QuickDraw | Train Loss: 1.0451 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.1950 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1842 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3693 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3476 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3945 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2773 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.6838 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1098 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.1760 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3180 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.9274 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2828 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.1280 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3119 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3129 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4708 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8631
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5952
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6190
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Real       | Epoch:9 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_2ClientPerDomain/CoCoOP...
===2023-03-24 16:07:11===
===2023-03-24 16:07:12===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8175
 Test site-Infograph | Epoch:9 | Test Acc: 0.4749
 Test site-Painting  | Epoch:9 | Test Acc: 0.8465
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.5450
 Test site-Real      | Epoch:9 | Test Acc: 0.9219
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7978
Average Test Accuracy: 0.7339
