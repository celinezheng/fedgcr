===2023-08-03 08:25:06===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (4) | Train Loss: 1.6953 | Train Acc: 0.6361
 Site-MNIST                     (4) | Train Loss: 1.7569 | Train Acc: 0.5686
 Site-USPS                      (2) | Train Loss: 1.6787 | Train Acc: 0.6119
 Site-USPS                      (2) | Train Loss: 1.6896 | Train Acc: 0.5892
 Site-SynthDigits               (0) | Train Loss: 2.0828 | Train Acc: 0.3288
 Site-SynthDigits               (0) | Train Loss: 2.0609 | Train Acc: 0.3345
 Site-MNIST_M                   (3) | Train Loss: 2.1527 | Train Acc: 0.2264
 Site-MNIST_M                   (3) | Train Loss: 2.1751 | Train Acc: 0.2054
 Site-SVHN                      (5) | Train Loss: 2.2009 | Train Acc: 0.1833
 Site-SVHN                      (1) | Train Loss: 2.2028 | Train Acc: 0.2108
Average Train Accuracy: 0.3895
 Site-MNIST                     (4) | Val  Loss: 1.7693 | Val  Acc: 0.5435
 Site-MNIST                     (4) | Val  Loss: 1.7402 | Val  Acc: 0.5899
 Site-USPS                      (2) | Val  Loss: 1.7620 | Val  Acc: 0.5543
 Site-USPS                      (2) | Val  Loss: 1.7301 | Val  Acc: 0.5719
 Site-SynthDigits               (0) | Val  Loss: 2.0961 | Val  Acc: 0.3043
 Site-SynthDigits               (0) | Val  Loss: 2.0716 | Val  Acc: 0.3381
 Site-MNIST_M                   (3) | Val  Loss: 2.0927 | Val  Acc: 0.2500
 Site-MNIST_M                   (3) | Val  Loss: 2.1633 | Val  Acc: 0.2230
 Site-SVHN                      (5) | Val  Loss: 2.1702 | Val  Acc: 0.2391
 Site-SVHN                      (1) | Val  Loss: 2.2057 | Val  Acc: 0.2050
Average Valid Accuracy: 0.3819
 Best site-MNIST                    (4)  | Epoch:0 | Val Acc: 0.5435
 Best site-MNIST                    (4)  | Epoch:0 | Val Acc: 0.5899
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5543
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5719
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3043
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3381
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2500
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2230
 Best site-SVHN                     (5)  | Epoch:0 | Val Acc: 0.2391
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
===2023-08-03 08:29:06===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 6
Loading snapshots...
===2023-08-03 15:58:34===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (4) | Train Loss: 1.6953 | Train Acc: 0.6361
 Site-MNIST                     (4) | Train Loss: 1.7569 | Train Acc: 0.5686
 Site-USPS                      (2) | Train Loss: 1.6787 | Train Acc: 0.6119
 Site-USPS                      (2) | Train Loss: 1.6896 | Train Acc: 0.5892
 Site-SynthDigits               (0) | Train Loss: 2.0828 | Train Acc: 0.3288
 Site-SynthDigits               (0) | Train Loss: 2.0609 | Train Acc: 0.3345
 Site-MNIST_M                   (3) | Train Loss: 2.1527 | Train Acc: 0.2264
 Site-MNIST_M                   (3) | Train Loss: 2.1751 | Train Acc: 0.2054
 Site-SVHN                      (5) | Train Loss: 2.2009 | Train Acc: 0.1833
 Site-SVHN                      (1) | Train Loss: 2.2028 | Train Acc: 0.2108
Average Train Accuracy: 0.3895
 Site-MNIST                     (4) | Val  Loss: 1.7693 | Val  Acc: 0.5435
 Site-MNIST                     (4) | Val  Loss: 1.7402 | Val  Acc: 0.5899
 Site-USPS                      (2) | Val  Loss: 1.7620 | Val  Acc: 0.5543
 Site-USPS                      (2) | Val  Loss: 1.7301 | Val  Acc: 0.5719
 Site-SynthDigits               (0) | Val  Loss: 2.0961 | Val  Acc: 0.3043
 Site-SynthDigits               (0) | Val  Loss: 2.0716 | Val  Acc: 0.3381
 Site-MNIST_M                   (3) | Val  Loss: 2.0927 | Val  Acc: 0.2500
 Site-MNIST_M                   (3) | Val  Loss: 2.1633 | Val  Acc: 0.2230
 Site-SVHN                      (5) | Val  Loss: 2.1702 | Val  Acc: 0.2391
 Site-SVHN                      (1) | Val  Loss: 2.2057 | Val  Acc: 0.2050
Average Valid Accuracy: 0.3819
 Best site-MNIST                    (4)  | Epoch:0 | Val Acc: 0.5435
 Best site-MNIST                    (4)  | Epoch:0 | Val Acc: 0.5899
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5543
 Best site-USPS                     (2)  | Epoch:0 | Val Acc: 0.5719
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3043
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3381
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2500
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2230
 Best site-SVHN                     (5)  | Epoch:0 | Val Acc: 0.2391
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2050
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.2965 | Train Acc: 0.7709
 Site-MNIST                     (0) | Train Loss: 1.3775 | Train Acc: 0.7058
 Site-USPS                      (4) | Train Loss: 1.2165 | Train Acc: 0.7466
 Site-USPS                      (4) | Train Loss: 1.2515 | Train Acc: 0.7417
 Site-SynthDigits               (3) | Train Loss: 1.8784 | Train Acc: 0.4178
 Site-SynthDigits               (5) | Train Loss: 1.7997 | Train Acc: 0.4466
 Site-MNIST_M                   (2) | Train Loss: 1.8881 | Train Acc: 0.3747
 Site-MNIST_M                   (2) | Train Loss: 1.9376 | Train Acc: 0.3381
 Site-SVHN                      (1) | Train Loss: 2.0629 | Train Acc: 0.2668
 Site-SVHN                      (1) | Train Loss: 2.0513 | Train Acc: 0.2798
Average Train Accuracy: 0.5089
 Site-MNIST                     (0) | Val  Loss: 1.3574 | Val  Acc: 0.7283
 Site-MNIST                     (0) | Val  Loss: 1.3539 | Val  Acc: 0.7446
 Site-USPS                      (4) | Val  Loss: 1.3211 | Val  Acc: 0.6630
 Site-USPS                      (4) | Val  Loss: 1.3012 | Val  Acc: 0.7194
 Site-SynthDigits               (3) | Val  Loss: 1.8398 | Val  Acc: 0.3696
 Site-SynthDigits               (5) | Val  Loss: 1.8150 | Val  Acc: 0.4209
 Site-MNIST_M                   (2) | Val  Loss: 1.8664 | Val  Acc: 0.3696
 Site-MNIST_M                   (2) | Val  Loss: 1.8973 | Val  Acc: 0.3885
 Site-SVHN                      (1) | Val  Loss: 2.0394 | Val  Acc: 0.3261
 Site-SVHN                      (1) | Val  Loss: 2.0650 | Val  Acc: 0.2986
Average Valid Accuracy: 0.5028
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7283
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7446
 Best site-USPS                     (4)  | Epoch:1 | Val Acc: 0.6630
 Best site-USPS                     (4)  | Epoch:1 | Val Acc: 0.7194
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.3696
 Best site-SynthDigits              (5)  | Epoch:1 | Val Acc: 0.4209
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.3696
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.3885
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.3261
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.2986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (1) | Train Loss: 1.1232 | Train Acc: 0.7574
 Site-MNIST                     (1) | Train Loss: 1.2071 | Train Acc: 0.7112
 Site-USPS                      (4) | Train Loss: 1.0113 | Train Acc: 0.7790
 Site-USPS                      (4) | Train Loss: 1.0267 | Train Acc: 0.7552
 Site-SynthDigits               (2) | Train Loss: 1.6157 | Train Acc: 0.4825
 Site-SynthDigits               (2) | Train Loss: 1.5079 | Train Acc: 0.5300
 Site-MNIST_M                   (0) | Train Loss: 1.6954 | Train Acc: 0.4717
 Site-MNIST_M                   (0) | Train Loss: 1.7697 | Train Acc: 0.4377
 Site-SVHN                      (5) | Train Loss: 1.9160 | Train Acc: 0.3288
 Site-SVHN                      (3) | Train Loss: 1.8720 | Train Acc: 0.3480
Average Train Accuracy: 0.5601
 Site-MNIST                     (1) | Val  Loss: 1.1697 | Val  Acc: 0.7717
 Site-MNIST                     (1) | Val  Loss: 1.1900 | Val  Acc: 0.7626
 Site-USPS                      (4) | Val  Loss: 1.0890 | Val  Acc: 0.7174
 Site-USPS                      (4) | Val  Loss: 1.0980 | Val  Acc: 0.7338
 Site-SynthDigits               (2) | Val  Loss: 1.5154 | Val  Acc: 0.5109
 Site-SynthDigits               (2) | Val  Loss: 1.5328 | Val  Acc: 0.5036
 Site-MNIST_M                   (0) | Val  Loss: 1.7430 | Val  Acc: 0.4674
 Site-MNIST_M                   (0) | Val  Loss: 1.7258 | Val  Acc: 0.4712
 Site-SVHN                      (5) | Val  Loss: 1.9079 | Val  Acc: 0.2609
 Site-SVHN                      (3) | Val  Loss: 1.9331 | Val  Acc: 0.3058
Average Valid Accuracy: 0.5505
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7717
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7626
 Best site-USPS                     (4)  | Epoch:2 | Val Acc: 0.7174
 Best site-USPS                     (4)  | Epoch:2 | Val Acc: 0.7338
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.5109
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.5036
 Best site-MNIST_M                  (0)  | Epoch:2 | Val Acc: 0.4674
 Best site-MNIST_M                  (0)  | Epoch:2 | Val Acc: 0.4712
 Best site-SVHN                     (5)  | Epoch:2 | Val Acc: 0.2609
 Best site-SVHN                     (3)  | Epoch:2 | Val Acc: 0.3058
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.8757 | Train Acc: 0.8167
 Site-MNIST                     (0) | Train Loss: 0.9562 | Train Acc: 0.7848
 Site-USPS                      (2) | Train Loss: 0.8235 | Train Acc: 0.8275
 Site-USPS                      (2) | Train Loss: 0.8394 | Train Acc: 0.8188
 Site-SynthDigits               (4) | Train Loss: 1.3979 | Train Acc: 0.5687
 Site-SynthDigits               (4) | Train Loss: 1.2925 | Train Acc: 0.6251
 Site-MNIST_M                   (1) | Train Loss: 1.5938 | Train Acc: 0.4933
 Site-MNIST_M                   (1) | Train Loss: 1.6388 | Train Acc: 0.4816
 Site-SVHN                      (3) | Train Loss: 1.8112 | Train Acc: 0.3639
 Site-SVHN                      (5) | Train Loss: 1.7447 | Train Acc: 0.4099
Average Train Accuracy: 0.6190
 Site-MNIST                     (0) | Val  Loss: 0.9150 | Val  Acc: 0.8261
 Site-MNIST                     (0) | Val  Loss: 0.9384 | Val  Acc: 0.8273
 Site-USPS                      (2) | Val  Loss: 0.9262 | Val  Acc: 0.7283
 Site-USPS                      (2) | Val  Loss: 0.8978 | Val  Acc: 0.7878
 Site-SynthDigits               (4) | Val  Loss: 1.3378 | Val  Acc: 0.5543
 Site-SynthDigits               (4) | Val  Loss: 1.3151 | Val  Acc: 0.5647
 Site-MNIST_M                   (1) | Val  Loss: 1.6349 | Val  Acc: 0.5109
 Site-MNIST_M                   (1) | Val  Loss: 1.6012 | Val  Acc: 0.5540
 Site-SVHN                      (3) | Val  Loss: 1.7947 | Val  Acc: 0.2826
 Site-SVHN                      (5) | Val  Loss: 1.8148 | Val  Acc: 0.3417
Average Valid Accuracy: 0.5978
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8261
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8273
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.7283
 Best site-USPS                     (2)  | Epoch:3 | Val Acc: 0.7878
 Best site-SynthDigits              (4)  | Epoch:3 | Val Acc: 0.5543
 Best site-SynthDigits              (4)  | Epoch:3 | Val Acc: 0.5647
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.5109
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.5540
 Best site-SVHN                     (3)  | Epoch:3 | Val Acc: 0.2826
 Best site-SVHN                     (5)  | Epoch:3 | Val Acc: 0.3417
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (0) | Train Loss: 0.7550 | Train Acc: 0.8437
 Site-MNIST                     (0) | Train Loss: 0.8418 | Train Acc: 0.8108
 Site-USPS                      (2) | Train Loss: 0.7444 | Train Acc: 0.8518
 Site-USPS                      (5) | Train Loss: 0.7685 | Train Acc: 0.8278
 Site-SynthDigits               (4) | Train Loss: 1.2533 | Train Acc: 0.6065
 Site-SynthDigits               (4) | Train Loss: 1.1505 | Train Acc: 0.6637
 Site-MNIST_M                   (1) | Train Loss: 1.4746 | Train Acc: 0.5660
 Site-MNIST_M                   (1) | Train Loss: 1.5137 | Train Acc: 0.5641
 Site-SVHN                      (3) | Train Loss: 1.6884 | Train Acc: 0.4286
 Site-SVHN                      (3) | Train Loss: 1.6210 | Train Acc: 0.4457
Average Train Accuracy: 0.6609
 Site-MNIST                     (0) | Val  Loss: 0.7696 | Val  Acc: 0.8804
 Site-MNIST                     (0) | Val  Loss: 0.8178 | Val  Acc: 0.8633
 Site-USPS                      (2) | Val  Loss: 0.8618 | Val  Acc: 0.7391
 Site-USPS                      (5) | Val  Loss: 0.8249 | Val  Acc: 0.7986
 Site-SynthDigits               (4) | Val  Loss: 1.1947 | Val  Acc: 0.5978
 Site-SynthDigits               (4) | Val  Loss: 1.1771 | Val  Acc: 0.6079
 Site-MNIST_M                   (1) | Val  Loss: 1.5142 | Val  Acc: 0.5761
 Site-MNIST_M                   (1) | Val  Loss: 1.4782 | Val  Acc: 0.6187
 Site-SVHN                      (3) | Val  Loss: 1.6668 | Val  Acc: 0.3913
 Site-SVHN                      (3) | Val  Loss: 1.6783 | Val  Acc: 0.4317
Average Valid Accuracy: 0.6505
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8804
 Best site-MNIST                    (0)  | Epoch:4 | Val Acc: 0.8633
 Best site-USPS                     (2)  | Epoch:4 | Val Acc: 0.7391
 Best site-USPS                     (5)  | Epoch:4 | Val Acc: 0.7986
 Best site-SynthDigits              (4)  | Epoch:4 | Val Acc: 0.5978
 Best site-SynthDigits              (4)  | Epoch:4 | Val Acc: 0.6079
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.5761
 Best site-MNIST_M                  (1)  | Epoch:4 | Val Acc: 0.6187
 Best site-SVHN                     (3)  | Epoch:4 | Val Acc: 0.3913
 Best site-SVHN                     (3)  | Epoch:4 | Val Acc: 0.4317
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (4) | Train Loss: 0.6659 | Train Acc: 0.8491
 Site-MNIST                     (4) | Train Loss: 0.7506 | Train Acc: 0.8206
 Site-USPS                      (0) | Train Loss: 0.6878 | Train Acc: 0.8464
 Site-USPS                      (0) | Train Loss: 0.7053 | Train Acc: 0.8439
 Site-SynthDigits               (3) | Train Loss: 1.0999 | Train Acc: 0.6631
 Site-SynthDigits               (3) | Train Loss: 1.0085 | Train Acc: 0.7130
 Site-MNIST_M                   (2) | Train Loss: 1.3683 | Train Acc: 0.6011
 Site-MNIST_M                   (5) | Train Loss: 1.3943 | Train Acc: 0.6126
 Site-SVHN                      (1) | Train Loss: 1.5172 | Train Acc: 0.4906
 Site-SVHN                      (1) | Train Loss: 1.4724 | Train Acc: 0.5166
Average Train Accuracy: 0.6957
 Site-MNIST                     (4) | Val  Loss: 0.6625 | Val  Acc: 0.8913
 Site-MNIST                     (4) | Val  Loss: 0.7273 | Val  Acc: 0.8489
 Site-USPS                      (0) | Val  Loss: 0.8074 | Val  Acc: 0.7609
 Site-USPS                      (0) | Val  Loss: 0.7661 | Val  Acc: 0.8129
 Site-SynthDigits               (3) | Val  Loss: 1.0400 | Val  Acc: 0.6304
 Site-SynthDigits               (3) | Val  Loss: 1.0349 | Val  Acc: 0.6439
 Site-MNIST_M                   (2) | Val  Loss: 1.4008 | Val  Acc: 0.5978
 Site-MNIST_M                   (5) | Val  Loss: 1.3661 | Val  Acc: 0.6259
 Site-SVHN                      (1) | Val  Loss: 1.5097 | Val  Acc: 0.4674
 Site-SVHN                      (1) | Val  Loss: 1.5123 | Val  Acc: 0.5036
Average Valid Accuracy: 0.6783
 Best site-MNIST                    (4)  | Epoch:5 | Val Acc: 0.8913
 Best site-MNIST                    (4)  | Epoch:5 | Val Acc: 0.8489
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7609
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8129
 Best site-SynthDigits              (3)  | Epoch:5 | Val Acc: 0.6304
 Best site-SynthDigits              (3)  | Epoch:5 | Val Acc: 0.6439
 Best site-MNIST_M                  (2)  | Epoch:5 | Val Acc: 0.5978
 Best site-MNIST_M                  (5)  | Epoch:5 | Val Acc: 0.6259
 Best site-SVHN                     (1)  | Epoch:5 | Val Acc: 0.4674
 Best site-SVHN                     (1)  | Epoch:5 | Val Acc: 0.5036
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (1) | Train Loss: 0.5855 | Train Acc: 0.8679
 Site-MNIST                     (1) | Train Loss: 0.6675 | Train Acc: 0.8377
 Site-USPS                      (3) | Train Loss: 0.6306 | Train Acc: 0.8652
 Site-USPS                      (3) | Train Loss: 0.6518 | Train Acc: 0.8502
 Site-SynthDigits               (4) | Train Loss: 0.9868 | Train Acc: 0.6900
 Site-SynthDigits               (5) | Train Loss: 0.9094 | Train Acc: 0.7498
 Site-MNIST_M                   (0) | Train Loss: 1.2590 | Train Acc: 0.6307
 Site-MNIST_M                   (0) | Train Loss: 1.2891 | Train Acc: 0.6466
 Site-SVHN                      (2) | Train Loss: 1.4360 | Train Acc: 0.5229
 Site-SVHN                      (2) | Train Loss: 1.3916 | Train Acc: 0.5444
Average Train Accuracy: 0.7206
 Site-MNIST                     (1) | Val  Loss: 0.5737 | Val  Acc: 0.8804
 Site-MNIST                     (1) | Val  Loss: 0.6494 | Val  Acc: 0.8561
 Site-USPS                      (3) | Val  Loss: 0.7648 | Val  Acc: 0.7826
 Site-USPS                      (3) | Val  Loss: 0.7221 | Val  Acc: 0.8237
 Site-SynthDigits               (4) | Val  Loss: 0.9297 | Val  Acc: 0.6630
 Site-SynthDigits               (5) | Val  Loss: 0.9285 | Val  Acc: 0.6835
 Site-MNIST_M                   (0) | Val  Loss: 1.2921 | Val  Acc: 0.6196
 Site-MNIST_M                   (0) | Val  Loss: 1.2432 | Val  Acc: 0.6475
 Site-SVHN                      (2) | Val  Loss: 1.4352 | Val  Acc: 0.5000
 Site-SVHN                      (2) | Val  Loss: 1.4318 | Val  Acc: 0.5360
Average Valid Accuracy: 0.6992
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8804
 Best site-MNIST                    (1)  | Epoch:6 | Val Acc: 0.8561
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7826
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.8237
 Best site-SynthDigits              (4)  | Epoch:6 | Val Acc: 0.6630
 Best site-SynthDigits              (5)  | Epoch:6 | Val Acc: 0.6835
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.6196
 Best site-MNIST_M                  (0)  | Epoch:6 | Val Acc: 0.6475
 Best site-SVHN                     (2)  | Epoch:6 | Val Acc: 0.5000
 Best site-SVHN                     (2)  | Epoch:6 | Val Acc: 0.5360
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (0) | Train Loss: 0.5558 | Train Acc: 0.8491
 Site-MNIST                     (0) | Train Loss: 0.6391 | Train Acc: 0.8251
 Site-USPS                      (3) | Train Loss: 0.5927 | Train Acc: 0.8571
 Site-USPS                      (3) | Train Loss: 0.6133 | Train Acc: 0.8493
 Site-SynthDigits               (4) | Train Loss: 0.9105 | Train Acc: 0.7062
 Site-SynthDigits               (4) | Train Loss: 0.8387 | Train Acc: 0.7641
 Site-MNIST_M                   (5) | Train Loss: 1.2047 | Train Acc: 0.6361
 Site-MNIST_M                   (2) | Train Loss: 1.2200 | Train Acc: 0.6619
 Site-SVHN                      (1) | Train Loss: 1.3732 | Train Acc: 0.5499
 Site-SVHN                      (1) | Train Loss: 1.3011 | Train Acc: 0.5821
Average Train Accuracy: 0.7281
 Site-MNIST                     (0) | Val  Loss: 0.5405 | Val  Acc: 0.8696
 Site-MNIST                     (0) | Val  Loss: 0.6224 | Val  Acc: 0.8453
 Site-USPS                      (3) | Val  Loss: 0.7318 | Val  Acc: 0.7826
 Site-USPS                      (3) | Val  Loss: 0.6862 | Val  Acc: 0.8201
 Site-SynthDigits               (4) | Val  Loss: 0.8614 | Val  Acc: 0.6848
 Site-SynthDigits               (4) | Val  Loss: 0.8604 | Val  Acc: 0.7050
 Site-MNIST_M                   (5) | Val  Loss: 1.2255 | Val  Acc: 0.6739
 Site-MNIST_M                   (2) | Val  Loss: 1.1752 | Val  Acc: 0.6871
 Site-SVHN                      (1) | Val  Loss: 1.3321 | Val  Acc: 0.5435
 Site-SVHN                      (1) | Val  Loss: 1.3468 | Val  Acc: 0.5647
Average Valid Accuracy: 0.7177
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8696
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8453
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.7826
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8201
 Best site-SynthDigits              (4)  | Epoch:7 | Val Acc: 0.6848
 Best site-SynthDigits              (4)  | Epoch:7 | Val Acc: 0.7050
 Best site-MNIST_M                  (5)  | Epoch:7 | Val Acc: 0.6739
 Best site-MNIST_M                  (2)  | Epoch:7 | Val Acc: 0.6871
 Best site-SVHN                     (1)  | Epoch:7 | Val Acc: 0.5435
 Best site-SVHN                     (1)  | Epoch:7 | Val Acc: 0.5647
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (5) | Train Loss: 0.5037 | Train Acc: 0.8679
 Site-MNIST                     (1) | Train Loss: 0.5934 | Train Acc: 0.8287
 Site-USPS                      (3) | Train Loss: 0.5927 | Train Acc: 0.8437
 Site-USPS                      (3) | Train Loss: 0.6084 | Train Acc: 0.8386
 Site-SynthDigits               (4) | Train Loss: 0.8328 | Train Acc: 0.7439
 Site-SynthDigits               (4) | Train Loss: 0.7679 | Train Acc: 0.7704
 Site-MNIST_M                   (2) | Train Loss: 1.1376 | Train Acc: 0.6442
 Site-MNIST_M                   (2) | Train Loss: 1.1375 | Train Acc: 0.6780
 Site-SVHN                      (0) | Train Loss: 1.2587 | Train Acc: 0.5849
 Site-SVHN                      (0) | Train Loss: 1.2028 | Train Acc: 0.6126
Average Train Accuracy: 0.7413
 Site-MNIST                     (5) | Val  Loss: 0.5003 | Val  Acc: 0.8696
 Site-MNIST                     (1) | Val  Loss: 0.5810 | Val  Acc: 0.8453
 Site-USPS                      (3) | Val  Loss: 0.7271 | Val  Acc: 0.7391
 Site-USPS                      (3) | Val  Loss: 0.6922 | Val  Acc: 0.7986
 Site-SynthDigits               (4) | Val  Loss: 0.7945 | Val  Acc: 0.6848
 Site-SynthDigits               (4) | Val  Loss: 0.7963 | Val  Acc: 0.7194
 Site-MNIST_M                   (2) | Val  Loss: 1.1743 | Val  Acc: 0.6413
 Site-MNIST_M                   (2) | Val  Loss: 1.1096 | Val  Acc: 0.6727
 Site-SVHN                      (0) | Val  Loss: 1.2418 | Val  Acc: 0.6087
 Site-SVHN                      (0) | Val  Loss: 1.2368 | Val  Acc: 0.6079
Average Valid Accuracy: 0.7187
 Best site-MNIST                    (5)  | Epoch:8 | Val Acc: 0.8696
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8453
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7391
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7986
 Best site-SynthDigits              (4)  | Epoch:8 | Val Acc: 0.6848
 Best site-SynthDigits              (4)  | Epoch:8 | Val Acc: 0.7194
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.6413
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.6727
 Best site-SVHN                     (0)  | Epoch:8 | Val Acc: 0.6087
 Best site-SVHN                     (0)  | Epoch:8 | Val Acc: 0.6079
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (2) | Train Loss: 0.4572 | Train Acc: 0.8787
 Site-MNIST                     (2) | Train Loss: 0.5300 | Train Acc: 0.8583
 Site-USPS                      (1) | Train Loss: 0.5040 | Train Acc: 0.8518
 Site-USPS                      (1) | Train Loss: 0.5229 | Train Acc: 0.8610
 Site-SynthDigits               (4) | Train Loss: 0.8311 | Train Acc: 0.7412
 Site-SynthDigits               (4) | Train Loss: 0.7532 | Train Acc: 0.7821
 Site-MNIST_M                   (0) | Train Loss: 1.0917 | Train Acc: 0.6792
 Site-MNIST_M                   (5) | Train Loss: 1.0917 | Train Acc: 0.7031
 Site-SVHN                      (3) | Train Loss: 1.2924 | Train Acc: 0.5768
 Site-SVHN                      (3) | Train Loss: 1.2075 | Train Acc: 0.6027
Average Train Accuracy: 0.7535
 Site-MNIST                     (2) | Val  Loss: 0.4301 | Val  Acc: 0.9022
 Site-MNIST                     (2) | Val  Loss: 0.5148 | Val  Acc: 0.8777
 Site-USPS                      (1) | Val  Loss: 0.6567 | Val  Acc: 0.7935
 Site-USPS                      (1) | Val  Loss: 0.5930 | Val  Acc: 0.8201
 Site-SynthDigits               (4) | Val  Loss: 0.7997 | Val  Acc: 0.7283
 Site-SynthDigits               (4) | Val  Loss: 0.7765 | Val  Acc: 0.7266
 Site-MNIST_M                   (0) | Val  Loss: 1.1043 | Val  Acc: 0.6957
 Site-MNIST_M                   (5) | Val  Loss: 1.0479 | Val  Acc: 0.7230
 Site-SVHN                      (3) | Val  Loss: 1.2739 | Val  Acc: 0.5435
 Site-SVHN                      (3) | Val  Loss: 1.2669 | Val  Acc: 0.5827
Average Valid Accuracy: 0.7393
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.9022
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8777
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.7935
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.8201
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.7283
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.7266
 Best site-MNIST_M                  (0)  | Epoch:9 | Val Acc: 0.6957
 Best site-MNIST_M                  (5)  | Epoch:9 | Val Acc: 0.7230
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.5435
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.5827
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (1) | Train Loss: 0.4557 | Train Acc: 0.8544
 Site-MNIST                     (1) | Train Loss: 0.5380 | Train Acc: 0.8413
 Site-USPS                      (0) | Train Loss: 0.5117 | Train Acc: 0.8544
 Site-USPS                      (0) | Train Loss: 0.5290 | Train Acc: 0.8538
 Site-SynthDigits               (5) | Train Loss: 0.7419 | Train Acc: 0.7925
 Site-SynthDigits               (4) | Train Loss: 0.6912 | Train Acc: 0.7982
 Site-MNIST_M                   (2) | Train Loss: 1.0364 | Train Acc: 0.6739
 Site-MNIST_M                   (2) | Train Loss: 1.0309 | Train Acc: 0.7238
 Site-SVHN                      (3) | Train Loss: 1.1967 | Train Acc: 0.6092
 Site-SVHN                      (3) | Train Loss: 1.1310 | Train Acc: 0.6332
Average Train Accuracy: 0.7635
 Site-MNIST                     (1) | Val  Loss: 0.4245 | Val  Acc: 0.8696
 Site-MNIST                     (1) | Val  Loss: 0.5160 | Val  Acc: 0.8453
 Site-USPS                      (0) | Val  Loss: 0.6608 | Val  Acc: 0.7717
 Site-USPS                      (0) | Val  Loss: 0.6032 | Val  Acc: 0.8237
 Site-SynthDigits               (5) | Val  Loss: 0.7081 | Val  Acc: 0.7500
 Site-SynthDigits               (4) | Val  Loss: 0.7102 | Val  Acc: 0.7698
 Site-MNIST_M                   (2) | Val  Loss: 1.0498 | Val  Acc: 0.7174
 Site-MNIST_M                   (2) | Val  Loss: 0.9920 | Val  Acc: 0.7446
 Site-SVHN                      (3) | Val  Loss: 1.1601 | Val  Acc: 0.6522
 Site-SVHN                      (3) | Val  Loss: 1.1655 | Val  Acc: 0.6511
Average Valid Accuracy: 0.7595
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8696
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8453
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.7717
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8237
 Best site-SynthDigits              (5)  | Epoch:10 | Val Acc: 0.7500
 Best site-SynthDigits              (4)  | Epoch:10 | Val Acc: 0.7698
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.7174
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.7446
 Best site-SVHN                     (3)  | Epoch:10 | Val Acc: 0.6522
 Best site-SVHN                     (3)  | Epoch:10 | Val Acc: 0.6511
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (4) | Train Loss: 0.4084 | Train Acc: 0.8787
 Site-MNIST                     (4) | Train Loss: 0.4778 | Train Acc: 0.8637
 Site-USPS                      (3) | Train Loss: 0.4998 | Train Acc: 0.8544
 Site-USPS                      (3) | Train Loss: 0.5094 | Train Acc: 0.8583
 Site-SynthDigits               (0) | Train Loss: 0.6958 | Train Acc: 0.8086
 Site-SynthDigits               (0) | Train Loss: 0.6433 | Train Acc: 0.8179
 Site-MNIST_M                   (2) | Train Loss: 0.9988 | Train Acc: 0.6873
 Site-MNIST_M                   (5) | Train Loss: 0.9822 | Train Acc: 0.7426
 Site-SVHN                      (1) | Train Loss: 1.1545 | Train Acc: 0.6307
 Site-SVHN                      (1) | Train Loss: 1.0800 | Train Acc: 0.6574
Average Train Accuracy: 0.7800
 Site-MNIST                     (4) | Val  Loss: 0.3790 | Val  Acc: 0.9022
 Site-MNIST                     (4) | Val  Loss: 0.4728 | Val  Acc: 0.8813
 Site-USPS                      (3) | Val  Loss: 0.6509 | Val  Acc: 0.8043
 Site-USPS                      (3) | Val  Loss: 0.5864 | Val  Acc: 0.8381
 Site-SynthDigits               (0) | Val  Loss: 0.6676 | Val  Acc: 0.7717
 Site-SynthDigits               (0) | Val  Loss: 0.6620 | Val  Acc: 0.7878
 Site-MNIST_M                   (2) | Val  Loss: 1.0164 | Val  Acc: 0.6957
 Site-MNIST_M                   (5) | Val  Loss: 0.9519 | Val  Acc: 0.7410
 Site-SVHN                      (1) | Val  Loss: 1.1155 | Val  Acc: 0.6304
 Site-SVHN                      (1) | Val  Loss: 1.1167 | Val  Acc: 0.6583
Average Valid Accuracy: 0.7711
 Best site-MNIST                    (4)  | Epoch:11 | Val Acc: 0.9022
 Best site-MNIST                    (4)  | Epoch:11 | Val Acc: 0.8813
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8043
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8381
 Best site-SynthDigits              (0)  | Epoch:11 | Val Acc: 0.7717
 Best site-SynthDigits              (0)  | Epoch:11 | Val Acc: 0.7878
 Best site-MNIST_M                  (2)  | Epoch:11 | Val Acc: 0.6957
 Best site-MNIST_M                  (5)  | Epoch:11 | Val Acc: 0.7410
 Best site-SVHN                     (1)  | Epoch:11 | Val Acc: 0.6304
 Best site-SVHN                     (1)  | Epoch:11 | Val Acc: 0.6583
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (0) | Train Loss: 0.3816 | Train Acc: 0.8922
 Site-MNIST                     (0) | Train Loss: 0.4535 | Train Acc: 0.8762
 Site-USPS                      (1) | Train Loss: 0.4732 | Train Acc: 0.8598
 Site-USPS                      (1) | Train Loss: 0.4899 | Train Acc: 0.8592
 Site-SynthDigits               (4) | Train Loss: 0.6532 | Train Acc: 0.8275
 Site-SynthDigits               (4) | Train Loss: 0.5986 | Train Acc: 0.8386
 Site-MNIST_M                   (3) | Train Loss: 0.9551 | Train Acc: 0.7089
 Site-MNIST_M                   (5) | Train Loss: 0.9350 | Train Acc: 0.7507
 Site-SVHN                      (2) | Train Loss: 1.1167 | Train Acc: 0.6415
 Site-SVHN                      (2) | Train Loss: 1.0320 | Train Acc: 0.6717
Average Train Accuracy: 0.7926
 Site-MNIST                     (0) | Val  Loss: 0.3529 | Val  Acc: 0.9022
 Site-MNIST                     (0) | Val  Loss: 0.4455 | Val  Acc: 0.8921
 Site-USPS                      (1) | Val  Loss: 0.6279 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.5619 | Val  Acc: 0.8345
 Site-SynthDigits               (4) | Val  Loss: 0.6175 | Val  Acc: 0.8043
 Site-SynthDigits               (4) | Val  Loss: 0.6156 | Val  Acc: 0.8237
 Site-MNIST_M                   (3) | Val  Loss: 0.9719 | Val  Acc: 0.6957
 Site-MNIST_M                   (5) | Val  Loss: 0.9022 | Val  Acc: 0.7518
 Site-SVHN                      (2) | Val  Loss: 1.0789 | Val  Acc: 0.6739
 Site-SVHN                      (2) | Val  Loss: 1.0737 | Val  Acc: 0.6727
Average Valid Accuracy: 0.7855
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9022
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8921
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8345
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.8043
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.8237
 Best site-MNIST_M                  (3)  | Epoch:12 | Val Acc: 0.6957
 Best site-MNIST_M                  (5)  | Epoch:12 | Val Acc: 0.7518
 Best site-SVHN                     (2)  | Epoch:12 | Val Acc: 0.6739
 Best site-SVHN                     (2)  | Epoch:12 | Val Acc: 0.6727
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (3) | Train Loss: 0.3556 | Train Acc: 0.9057
 Site-MNIST                     (3) | Train Loss: 0.4266 | Train Acc: 0.8798
 Site-USPS                      (4) | Train Loss: 0.4503 | Train Acc: 0.8679
 Site-USPS                      (4) | Train Loss: 0.4642 | Train Acc: 0.8637
 Site-SynthDigits               (5) | Train Loss: 0.6443 | Train Acc: 0.8167
 Site-SynthDigits               (0) | Train Loss: 0.5916 | Train Acc: 0.8323
 Site-MNIST_M                   (2) | Train Loss: 0.9158 | Train Acc: 0.7385
 Site-MNIST_M                   (2) | Train Loss: 0.8970 | Train Acc: 0.7534
 Site-SVHN                      (1) | Train Loss: 1.0907 | Train Acc: 0.6388
 Site-SVHN                      (1) | Train Loss: 1.0114 | Train Acc: 0.6780
Average Train Accuracy: 0.7975
 Site-MNIST                     (3) | Val  Loss: 0.3222 | Val  Acc: 0.9022
 Site-MNIST                     (3) | Val  Loss: 0.4183 | Val  Acc: 0.9029
 Site-USPS                      (4) | Val  Loss: 0.5953 | Val  Acc: 0.7935
 Site-USPS                      (4) | Val  Loss: 0.5309 | Val  Acc: 0.8345
 Site-SynthDigits               (5) | Val  Loss: 0.6211 | Val  Acc: 0.7826
 Site-SynthDigits               (0) | Val  Loss: 0.6128 | Val  Acc: 0.8022
 Site-MNIST_M                   (2) | Val  Loss: 0.9331 | Val  Acc: 0.7174
 Site-MNIST_M                   (2) | Val  Loss: 0.8646 | Val  Acc: 0.7626
 Site-SVHN                      (1) | Val  Loss: 1.0490 | Val  Acc: 0.6848
 Site-SVHN                      (1) | Val  Loss: 1.0521 | Val  Acc: 0.6763
Average Valid Accuracy: 0.7859
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.9022
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.9029
 Best site-USPS                     (4)  | Epoch:13 | Val Acc: 0.7935
 Best site-USPS                     (4)  | Epoch:13 | Val Acc: 0.8345
 Best site-SynthDigits              (5)  | Epoch:13 | Val Acc: 0.7826
 Best site-SynthDigits              (0)  | Epoch:13 | Val Acc: 0.8022
 Best site-MNIST_M                  (2)  | Epoch:13 | Val Acc: 0.7174
 Best site-MNIST_M                  (2)  | Epoch:13 | Val Acc: 0.7626
 Best site-SVHN                     (1)  | Epoch:13 | Val Acc: 0.6848
 Best site-SVHN                     (1)  | Epoch:13 | Val Acc: 0.6763
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (0) | Train Loss: 0.3326 | Train Acc: 0.9084
 Site-MNIST                     (0) | Train Loss: 0.4070 | Train Acc: 0.8870
 Site-USPS                      (2) | Train Loss: 0.4248 | Train Acc: 0.8652
 Site-USPS                      (2) | Train Loss: 0.4265 | Train Acc: 0.8726
 Site-SynthDigits               (4) | Train Loss: 0.6285 | Train Acc: 0.8194
 Site-SynthDigits               (5) | Train Loss: 0.5675 | Train Acc: 0.8359
 Site-MNIST_M                   (3) | Train Loss: 0.8726 | Train Acc: 0.7466
 Site-MNIST_M                   (3) | Train Loss: 0.8533 | Train Acc: 0.7605
 Site-SVHN                      (1) | Train Loss: 1.0734 | Train Acc: 0.6496
 Site-SVHN                      (1) | Train Loss: 0.9731 | Train Acc: 0.6897
Average Train Accuracy: 0.8035
 Site-MNIST                     (0) | Val  Loss: 0.3023 | Val  Acc: 0.9130
 Site-MNIST                     (0) | Val  Loss: 0.3989 | Val  Acc: 0.9101
 Site-USPS                      (2) | Val  Loss: 0.5729 | Val  Acc: 0.7935
 Site-USPS                      (2) | Val  Loss: 0.5032 | Val  Acc: 0.8309
 Site-SynthDigits               (4) | Val  Loss: 0.6103 | Val  Acc: 0.7826
 Site-SynthDigits               (5) | Val  Loss: 0.5951 | Val  Acc: 0.7950
 Site-MNIST_M                   (3) | Val  Loss: 0.8959 | Val  Acc: 0.7174
 Site-MNIST_M                   (3) | Val  Loss: 0.8197 | Val  Acc: 0.7662
 Site-SVHN                      (1) | Val  Loss: 1.0196 | Val  Acc: 0.7065
 Site-SVHN                      (1) | Val  Loss: 1.0155 | Val  Acc: 0.6727
Average Valid Accuracy: 0.7888
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.9130
 Best site-MNIST                    (0)  | Epoch:14 | Val Acc: 0.9101
 Best site-USPS                     (2)  | Epoch:14 | Val Acc: 0.7935
 Best site-USPS                     (2)  | Epoch:14 | Val Acc: 0.8309
 Best site-SynthDigits              (4)  | Epoch:14 | Val Acc: 0.7826
 Best site-SynthDigits              (5)  | Epoch:14 | Val Acc: 0.7950
 Best site-MNIST_M                  (3)  | Epoch:14 | Val Acc: 0.7174
 Best site-MNIST_M                  (3)  | Epoch:14 | Val Acc: 0.7662
 Best site-SVHN                     (1)  | Epoch:14 | Val Acc: 0.7065
 Best site-SVHN                     (1)  | Epoch:14 | Val Acc: 0.6727
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (3) | Train Loss: 0.3175 | Train Acc: 0.9218
 Site-MNIST                     (3) | Train Loss: 0.3906 | Train Acc: 0.8915
 Site-USPS                      (4) | Train Loss: 0.4121 | Train Acc: 0.8679
 Site-USPS                      (4) | Train Loss: 0.4130 | Train Acc: 0.8762
 Site-SynthDigits               (0) | Train Loss: 0.6135 | Train Acc: 0.8275
 Site-SynthDigits               (0) | Train Loss: 0.5553 | Train Acc: 0.8457
 Site-MNIST_M                   (5) | Train Loss: 0.8329 | Train Acc: 0.7601
 Site-MNIST_M                   (1) | Train Loss: 0.8131 | Train Acc: 0.7767
 Site-SVHN                      (2) | Train Loss: 1.0936 | Train Acc: 0.6334
 Site-SVHN                      (2) | Train Loss: 0.9644 | Train Acc: 0.6879
Average Train Accuracy: 0.8089
 Site-MNIST                     (3) | Val  Loss: 0.2840 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.3844 | Val  Acc: 0.9173
 Site-USPS                      (4) | Val  Loss: 0.5605 | Val  Acc: 0.8152
 Site-USPS                      (4) | Val  Loss: 0.4859 | Val  Acc: 0.8453
 Site-SynthDigits               (0) | Val  Loss: 0.5994 | Val  Acc: 0.8043
 Site-SynthDigits               (0) | Val  Loss: 0.5749 | Val  Acc: 0.8165
 Site-MNIST_M                   (5) | Val  Loss: 0.8639 | Val  Acc: 0.7174
 Site-MNIST_M                   (1) | Val  Loss: 0.7840 | Val  Acc: 0.7878
 Site-SVHN                      (2) | Val  Loss: 1.0077 | Val  Acc: 0.6957
 Site-SVHN                      (2) | Val  Loss: 1.0211 | Val  Acc: 0.6799
Average Valid Accuracy: 0.8014
 Best site-MNIST                    (3)  | Epoch:15 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:15 | Val Acc: 0.9173
 Best site-USPS                     (4)  | Epoch:15 | Val Acc: 0.8152
 Best site-USPS                     (4)  | Epoch:15 | Val Acc: 0.8453
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8043
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8165
 Best site-MNIST_M                  (5)  | Epoch:15 | Val Acc: 0.7174
 Best site-MNIST_M                  (1)  | Epoch:15 | Val Acc: 0.7878
 Best site-SVHN                     (2)  | Epoch:15 | Val Acc: 0.6957
 Best site-SVHN                     (2)  | Epoch:15 | Val Acc: 0.6799
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (1) | Train Loss: 0.3252 | Train Acc: 0.9137
 Site-MNIST                     (1) | Train Loss: 0.3894 | Train Acc: 0.8897
 Site-USPS                      (0) | Train Loss: 0.4104 | Train Acc: 0.8814
 Site-USPS                      (0) | Train Loss: 0.4168 | Train Acc: 0.8825
 Site-SynthDigits               (4) | Train Loss: 0.5663 | Train Acc: 0.8437
 Site-SynthDigits               (4) | Train Loss: 0.5182 | Train Acc: 0.8735
 Site-MNIST_M                   (5) | Train Loss: 0.8326 | Train Acc: 0.7412
 Site-MNIST_M                   (3) | Train Loss: 0.7987 | Train Acc: 0.7740
 Site-SVHN                      (2) | Train Loss: 1.0337 | Train Acc: 0.6631
 Site-SVHN                      (2) | Train Loss: 0.9130 | Train Acc: 0.7094
Average Train Accuracy: 0.8172
 Site-MNIST                     (1) | Val  Loss: 0.2865 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.3916 | Val  Acc: 0.9173
 Site-USPS                      (0) | Val  Loss: 0.5557 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.4849 | Val  Acc: 0.8525
 Site-SynthDigits               (4) | Val  Loss: 0.5567 | Val  Acc: 0.8043
 Site-SynthDigits               (4) | Val  Loss: 0.5316 | Val  Acc: 0.8345
 Site-MNIST_M                   (5) | Val  Loss: 0.8495 | Val  Acc: 0.7283
 Site-MNIST_M                   (3) | Val  Loss: 0.7767 | Val  Acc: 0.7806
 Site-SVHN                      (2) | Val  Loss: 0.9610 | Val  Acc: 0.7174
 Site-SVHN                      (2) | Val  Loss: 0.9695 | Val  Acc: 0.7086
Average Valid Accuracy: 0.8094
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9348
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9173
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8152
 Best site-USPS                     (0)  | Epoch:16 | Val Acc: 0.8525
 Best site-SynthDigits              (4)  | Epoch:16 | Val Acc: 0.8043
 Best site-SynthDigits              (4)  | Epoch:16 | Val Acc: 0.8345
 Best site-MNIST_M                  (5)  | Epoch:16 | Val Acc: 0.7283
 Best site-MNIST_M                  (3)  | Epoch:16 | Val Acc: 0.7806
 Best site-SVHN                     (2)  | Epoch:16 | Val Acc: 0.7174
 Best site-SVHN                     (2)  | Epoch:16 | Val Acc: 0.7086
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (3) | Train Loss: 0.3098 | Train Acc: 0.9137
 Site-MNIST                     (3) | Train Loss: 0.3817 | Train Acc: 0.8906
 Site-USPS                      (1) | Train Loss: 0.3939 | Train Acc: 0.8787
 Site-USPS                      (1) | Train Loss: 0.4116 | Train Acc: 0.8771
 Site-SynthDigits               (4) | Train Loss: 0.5516 | Train Acc: 0.8491
 Site-SynthDigits               (4) | Train Loss: 0.5090 | Train Acc: 0.8619
 Site-MNIST_M                   (5) | Train Loss: 0.7889 | Train Acc: 0.7601
 Site-MNIST_M                   (2) | Train Loss: 0.7694 | Train Acc: 0.7848
 Site-SVHN                      (0) | Train Loss: 1.0312 | Train Acc: 0.6442
 Site-SVHN                      (0) | Train Loss: 0.9214 | Train Acc: 0.7040
Average Train Accuracy: 0.8164
 Site-MNIST                     (3) | Val  Loss: 0.2726 | Val  Acc: 0.9130
 Site-MNIST                     (3) | Val  Loss: 0.3812 | Val  Acc: 0.9209
 Site-USPS                      (1) | Val  Loss: 0.5410 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.4696 | Val  Acc: 0.8453
 Site-SynthDigits               (4) | Val  Loss: 0.5325 | Val  Acc: 0.8152
 Site-SynthDigits               (4) | Val  Loss: 0.5215 | Val  Acc: 0.8453
 Site-MNIST_M                   (5) | Val  Loss: 0.8215 | Val  Acc: 0.7174
 Site-MNIST_M                   (2) | Val  Loss: 0.7437 | Val  Acc: 0.7878
 Site-SVHN                      (0) | Val  Loss: 0.9619 | Val  Acc: 0.7283
 Site-SVHN                      (0) | Val  Loss: 0.9680 | Val  Acc: 0.7050
Average Valid Accuracy: 0.8083
============ Train epoch 18 ============
cnt=[2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (0) | Train Loss: 0.2848 | Train Acc: 0.9218
 Site-MNIST                     (0) | Train Loss: 0.3542 | Train Acc: 0.9040
 Site-USPS                      (2) | Train Loss: 0.3765 | Train Acc: 0.8706
 Site-USPS                      (2) | Train Loss: 0.3756 | Train Acc: 0.8861
 Site-SynthDigits               (4) | Train Loss: 0.5709 | Train Acc: 0.8383
 Site-SynthDigits               (4) | Train Loss: 0.5119 | Train Acc: 0.8547
 Site-MNIST_M                   (3) | Train Loss: 0.7721 | Train Acc: 0.7682
 Site-MNIST_M                   (5) | Train Loss: 0.7450 | Train Acc: 0.7839
 Site-SVHN                      (1) | Train Loss: 1.0289 | Train Acc: 0.6685
 Site-SVHN                      (1) | Train Loss: 0.8982 | Train Acc: 0.7103
Average Train Accuracy: 0.8206
 Site-MNIST                     (0) | Val  Loss: 0.2495 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.3524 | Val  Acc: 0.9281
 Site-USPS                      (2) | Val  Loss: 0.5197 | Val  Acc: 0.8043
 Site-USPS                      (2) | Val  Loss: 0.4393 | Val  Acc: 0.8417
 Site-SynthDigits               (4) | Val  Loss: 0.5665 | Val  Acc: 0.7935
 Site-SynthDigits               (4) | Val  Loss: 0.5360 | Val  Acc: 0.8201
 Site-MNIST_M                   (3) | Val  Loss: 0.8015 | Val  Acc: 0.7609
 Site-MNIST_M                   (5) | Val  Loss: 0.7261 | Val  Acc: 0.7986
 Site-SVHN                      (1) | Val  Loss: 0.9382 | Val  Acc: 0.7174
 Site-SVHN                      (1) | Val  Loss: 0.9529 | Val  Acc: 0.7086
Average Valid Accuracy: 0.8119
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9281
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.8043
 Best site-USPS                     (2)  | Epoch:18 | Val Acc: 0.8417
 Best site-SynthDigits              (4)  | Epoch:18 | Val Acc: 0.7935
 Best site-SynthDigits              (4)  | Epoch:18 | Val Acc: 0.8201
 Best site-MNIST_M                  (3)  | Epoch:18 | Val Acc: 0.7609
 Best site-MNIST_M                  (5)  | Epoch:18 | Val Acc: 0.7986
 Best site-SVHN                     (1)  | Epoch:18 | Val Acc: 0.7174
 Best site-SVHN                     (1)  | Epoch:18 | Val Acc: 0.7086
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (3) | Train Loss: 0.2808 | Train Acc: 0.9218
 Site-MNIST                     (3) | Train Loss: 0.3388 | Train Acc: 0.9058
 Site-USPS                      (1) | Train Loss: 0.3784 | Train Acc: 0.8787
 Site-USPS                      (1) | Train Loss: 0.3744 | Train Acc: 0.8852
 Site-SynthDigits               (4) | Train Loss: 0.5150 | Train Acc: 0.8625
 Site-SynthDigits               (4) | Train Loss: 0.4692 | Train Acc: 0.8762
 Site-MNIST_M                   (5) | Train Loss: 0.7744 | Train Acc: 0.7574
 Site-MNIST_M                   (2) | Train Loss: 0.7338 | Train Acc: 0.7946
 Site-SVHN                      (0) | Train Loss: 0.9801 | Train Acc: 0.6873
 Site-SVHN                      (0) | Train Loss: 0.8709 | Train Acc: 0.7336
Average Train Accuracy: 0.8303
 Site-MNIST                     (3) | Val  Loss: 0.2430 | Val  Acc: 0.9239
 Site-MNIST                     (3) | Val  Loss: 0.3475 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.5192 | Val  Acc: 0.8152
 Site-USPS                      (1) | Val  Loss: 0.4404 | Val  Acc: 0.8489
 Site-SynthDigits               (4) | Val  Loss: 0.5059 | Val  Acc: 0.8478
 Site-SynthDigits               (4) | Val  Loss: 0.4852 | Val  Acc: 0.8489
 Site-MNIST_M                   (5) | Val  Loss: 0.7844 | Val  Acc: 0.7500
 Site-MNIST_M                   (2) | Val  Loss: 0.7193 | Val  Acc: 0.7914
 Site-SVHN                      (0) | Val  Loss: 0.9140 | Val  Acc: 0.7609
 Site-SVHN                      (0) | Val  Loss: 0.9118 | Val  Acc: 0.7482
Average Valid Accuracy: 0.8263
 Best site-MNIST                    (3)  | Epoch:19 | Val Acc: 0.9239
 Best site-MNIST                    (3)  | Epoch:19 | Val Acc: 0.9281
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.8152
 Best site-USPS                     (1)  | Epoch:19 | Val Acc: 0.8489
 Best site-SynthDigits              (4)  | Epoch:19 | Val Acc: 0.8478
 Best site-SynthDigits              (4)  | Epoch:19 | Val Acc: 0.8489
 Best site-MNIST_M                  (5)  | Epoch:19 | Val Acc: 0.7500
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.7914
 Best site-SVHN                     (0)  | Epoch:19 | Val Acc: 0.7609
 Best site-SVHN                     (0)  | Epoch:19 | Val Acc: 0.7482
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 20 ============
cnt=[2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (3) | Train Loss: 0.2676 | Train Acc: 0.9272
 Site-MNIST                     (3) | Train Loss: 0.3307 | Train Acc: 0.9085
 Site-USPS                      (4) | Train Loss: 0.3682 | Train Acc: 0.8814
 Site-USPS                      (5) | Train Loss: 0.3665 | Train Acc: 0.8870
 Site-SynthDigits               (0) | Train Loss: 0.4963 | Train Acc: 0.8625
 Site-SynthDigits               (0) | Train Loss: 0.4540 | Train Acc: 0.8789
 Site-MNIST_M                   (1) | Train Loss: 0.7277 | Train Acc: 0.7601
 Site-MNIST_M                   (1) | Train Loss: 0.7018 | Train Acc: 0.8027
 Site-SVHN                      (2) | Train Loss: 0.9811 | Train Acc: 0.6658
 Site-SVHN                      (2) | Train Loss: 0.8654 | Train Acc: 0.7291
Average Train Accuracy: 0.8303
 Site-MNIST                     (3) | Val  Loss: 0.2253 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.3329 | Val  Acc: 0.9317
 Site-USPS                      (4) | Val  Loss: 0.5098 | Val  Acc: 0.8261
 Site-USPS                      (5) | Val  Loss: 0.4241 | Val  Acc: 0.8561
 Site-SynthDigits               (0) | Val  Loss: 0.4809 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4675 | Val  Acc: 0.8525
 Site-MNIST_M                   (1) | Val  Loss: 0.7418 | Val  Acc: 0.7609
 Site-MNIST_M                   (1) | Val  Loss: 0.6758 | Val  Acc: 0.8022
 Site-SVHN                      (2) | Val  Loss: 0.9161 | Val  Acc: 0.7609
 Site-SVHN                      (2) | Val  Loss: 0.9134 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8314
 Best site-MNIST                    (3)  | Epoch:20 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:20 | Val Acc: 0.9317
 Best site-USPS                     (4)  | Epoch:20 | Val Acc: 0.8261
 Best site-USPS                     (5)  | Epoch:20 | Val Acc: 0.8561
 Best site-SynthDigits              (0)  | Epoch:20 | Val Acc: 0.8478
 Best site-SynthDigits              (0)  | Epoch:20 | Val Acc: 0.8525
 Best site-MNIST_M                  (1)  | Epoch:20 | Val Acc: 0.7609
 Best site-MNIST_M                  (1)  | Epoch:20 | Val Acc: 0.8022
 Best site-SVHN                     (2)  | Epoch:20 | Val Acc: 0.7609
 Best site-SVHN                     (2)  | Epoch:20 | Val Acc: 0.7302
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (1) | Train Loss: 0.2667 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.3262 | Train Acc: 0.9067
 Site-USPS                      (0) | Train Loss: 0.3676 | Train Acc: 0.8868
 Site-USPS                      (0) | Train Loss: 0.3524 | Train Acc: 0.8924
 Site-SynthDigits               (4) | Train Loss: 0.4941 | Train Acc: 0.8491
 Site-SynthDigits               (5) | Train Loss: 0.4514 | Train Acc: 0.8753
 Site-MNIST_M                   (3) | Train Loss: 0.7261 | Train Acc: 0.7763
 Site-MNIST_M                   (3) | Train Loss: 0.6956 | Train Acc: 0.8090
 Site-SVHN                      (2) | Train Loss: 0.9509 | Train Acc: 0.6792
 Site-SVHN                      (2) | Train Loss: 0.8418 | Train Acc: 0.7381
Average Train Accuracy: 0.8335
 Site-MNIST                     (1) | Val  Loss: 0.2271 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.3307 | Val  Acc: 0.9281
 Site-USPS                      (0) | Val  Loss: 0.4955 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.4209 | Val  Acc: 0.8561
 Site-SynthDigits               (4) | Val  Loss: 0.4875 | Val  Acc: 0.8478
 Site-SynthDigits               (5) | Val  Loss: 0.4639 | Val  Acc: 0.8561
 Site-MNIST_M                   (3) | Val  Loss: 0.7279 | Val  Acc: 0.7717
 Site-MNIST_M                   (3) | Val  Loss: 0.6643 | Val  Acc: 0.8022
 Site-SVHN                      (2) | Val  Loss: 0.8874 | Val  Acc: 0.7609
 Site-SVHN                      (2) | Val  Loss: 0.8870 | Val  Acc: 0.7374
Average Valid Accuracy: 0.8299
============ Train epoch 22 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (3) | Train Loss: 0.2568 | Train Acc: 0.9191
 Site-MNIST                     (3) | Train Loss: 0.3135 | Train Acc: 0.9157
 Site-USPS                      (0) | Train Loss: 0.3454 | Train Acc: 0.8841
 Site-USPS                      (0) | Train Loss: 0.3411 | Train Acc: 0.9004
 Site-SynthDigits               (4) | Train Loss: 0.4936 | Train Acc: 0.8571
 Site-SynthDigits               (4) | Train Loss: 0.4503 | Train Acc: 0.8771
 Site-MNIST_M                   (5) | Train Loss: 0.7152 | Train Acc: 0.7709
 Site-MNIST_M                   (1) | Train Loss: 0.6664 | Train Acc: 0.8117
 Site-SVHN                      (2) | Train Loss: 0.9369 | Train Acc: 0.6819
 Site-SVHN                      (2) | Train Loss: 0.8130 | Train Acc: 0.7471
Average Train Accuracy: 0.8365
 Site-MNIST                     (3) | Val  Loss: 0.2197 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.3168 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.4704 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.4006 | Val  Acc: 0.8633
 Site-SynthDigits               (4) | Val  Loss: 0.4952 | Val  Acc: 0.8478
 Site-SynthDigits               (4) | Val  Loss: 0.4647 | Val  Acc: 0.8525
 Site-MNIST_M                   (5) | Val  Loss: 0.7154 | Val  Acc: 0.7717
 Site-MNIST_M                   (1) | Val  Loss: 0.6532 | Val  Acc: 0.7950
 Site-SVHN                      (2) | Val  Loss: 0.8561 | Val  Acc: 0.7609
 Site-SVHN                      (2) | Val  Loss: 0.8639 | Val  Acc: 0.7374
Average Valid Accuracy: 0.8321
 Best site-MNIST                    (3)  | Epoch:22 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:22 | Val Acc: 0.9317
 Best site-USPS                     (0)  | Epoch:22 | Val Acc: 0.8261
 Best site-USPS                     (0)  | Epoch:22 | Val Acc: 0.8633
 Best site-SynthDigits              (4)  | Epoch:22 | Val Acc: 0.8478
 Best site-SynthDigits              (4)  | Epoch:22 | Val Acc: 0.8525
 Best site-MNIST_M                  (5)  | Epoch:22 | Val Acc: 0.7717
 Best site-MNIST_M                  (1)  | Epoch:22 | Val Acc: 0.7950
 Best site-SVHN                     (2)  | Epoch:22 | Val Acc: 0.7609
 Best site-SVHN                     (2)  | Epoch:22 | Val Acc: 0.7374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (3) | Train Loss: 0.2491 | Train Acc: 0.9245
 Site-MNIST                     (5) | Train Loss: 0.3050 | Train Acc: 0.9157
 Site-USPS                      (2) | Train Loss: 0.3375 | Train Acc: 0.8814
 Site-USPS                      (2) | Train Loss: 0.3301 | Train Acc: 0.9040
 Site-SynthDigits               (4) | Train Loss: 0.4699 | Train Acc: 0.8625
 Site-SynthDigits               (4) | Train Loss: 0.4352 | Train Acc: 0.8888
 Site-MNIST_M                   (0) | Train Loss: 0.6911 | Train Acc: 0.7763
 Site-MNIST_M                   (0) | Train Loss: 0.6584 | Train Acc: 0.8117
 Site-SVHN                      (1) | Train Loss: 0.9286 | Train Acc: 0.6954
 Site-SVHN                      (1) | Train Loss: 0.8065 | Train Acc: 0.7444
Average Train Accuracy: 0.8405
 Site-MNIST                     (3) | Val  Loss: 0.2106 | Val  Acc: 0.9348
 Site-MNIST                     (5) | Val  Loss: 0.3060 | Val  Acc: 0.9317
 Site-USPS                      (2) | Val  Loss: 0.4568 | Val  Acc: 0.8152
 Site-USPS                      (2) | Val  Loss: 0.3884 | Val  Acc: 0.8633
 Site-SynthDigits               (4) | Val  Loss: 0.4769 | Val  Acc: 0.8696
 Site-SynthDigits               (4) | Val  Loss: 0.4423 | Val  Acc: 0.8669
 Site-MNIST_M                   (0) | Val  Loss: 0.6891 | Val  Acc: 0.7826
 Site-MNIST_M                   (0) | Val  Loss: 0.6289 | Val  Acc: 0.8201
 Site-SVHN                      (1) | Val  Loss: 0.8649 | Val  Acc: 0.7500
 Site-SVHN                      (1) | Val  Loss: 0.8650 | Val  Acc: 0.7446
Average Valid Accuracy: 0.8379
 Best site-MNIST                    (3)  | Epoch:23 | Val Acc: 0.9348
 Best site-MNIST                    (5)  | Epoch:23 | Val Acc: 0.9317
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8152
 Best site-USPS                     (2)  | Epoch:23 | Val Acc: 0.8633
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8696
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8669
 Best site-MNIST_M                  (0)  | Epoch:23 | Val Acc: 0.7826
 Best site-MNIST_M                  (0)  | Epoch:23 | Val Acc: 0.8201
 Best site-SVHN                     (1)  | Epoch:23 | Val Acc: 0.7500
 Best site-SVHN                     (1)  | Epoch:23 | Val Acc: 0.7446
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (3) | Train Loss: 0.2480 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.3009 | Train Acc: 0.9148
 Site-USPS                      (1) | Train Loss: 0.3481 | Train Acc: 0.8787
 Site-USPS                      (1) | Train Loss: 0.3489 | Train Acc: 0.9004
 Site-SynthDigits               (4) | Train Loss: 0.4508 | Train Acc: 0.8733
 Site-SynthDigits               (4) | Train Loss: 0.4064 | Train Acc: 0.8951
 Site-MNIST_M                   (2) | Train Loss: 0.6809 | Train Acc: 0.7655
 Site-MNIST_M                   (2) | Train Loss: 0.6434 | Train Acc: 0.8135
 Site-SVHN                      (5) | Train Loss: 0.9049 | Train Acc: 0.6900
 Site-SVHN                      (0) | Train Loss: 0.7889 | Train Acc: 0.7650
Average Train Accuracy: 0.8421
 Site-MNIST                     (3) | Val  Loss: 0.2131 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.3157 | Val  Acc: 0.9281
 Site-USPS                      (1) | Val  Loss: 0.4825 | Val  Acc: 0.8152
 Site-USPS                      (1) | Val  Loss: 0.4099 | Val  Acc: 0.8633
 Site-SynthDigits               (4) | Val  Loss: 0.4396 | Val  Acc: 0.8804
 Site-SynthDigits               (4) | Val  Loss: 0.4219 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.6798 | Val  Acc: 0.8043
 Site-MNIST_M                   (2) | Val  Loss: 0.6210 | Val  Acc: 0.8022
 Site-SVHN                      (5) | Val  Loss: 0.8293 | Val  Acc: 0.7717
 Site-SVHN                      (0) | Val  Loss: 0.8230 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8440
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:24 | Val Acc: 0.9281
 Best site-USPS                     (1)  | Epoch:24 | Val Acc: 0.8152
 Best site-USPS                     (1)  | Epoch:24 | Val Acc: 0.8633
 Best site-SynthDigits              (4)  | Epoch:24 | Val Acc: 0.8804
 Best site-SynthDigits              (4)  | Epoch:24 | Val Acc: 0.8813
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.8043
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.8022
 Best site-SVHN                     (5)  | Epoch:24 | Val Acc: 0.7717
 Best site-SVHN                     (0)  | Epoch:24 | Val Acc: 0.7590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (3) | Train Loss: 0.2439 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.3050 | Train Acc: 0.9130
 Site-USPS                      (0) | Train Loss: 0.3212 | Train Acc: 0.8922
 Site-USPS                      (0) | Train Loss: 0.3250 | Train Acc: 0.9067
 Site-SynthDigits               (4) | Train Loss: 0.4479 | Train Acc: 0.8706
 Site-SynthDigits               (4) | Train Loss: 0.4120 | Train Acc: 0.8897
 Site-MNIST_M                   (1) | Train Loss: 0.6731 | Train Acc: 0.7898
 Site-MNIST_M                   (1) | Train Loss: 0.6299 | Train Acc: 0.8197
 Site-SVHN                      (5) | Train Loss: 0.9123 | Train Acc: 0.6954
 Site-SVHN                      (2) | Train Loss: 0.7861 | Train Acc: 0.7632
Average Train Accuracy: 0.8465
 Site-MNIST                     (3) | Val  Loss: 0.2094 | Val  Acc: 0.9239
 Site-MNIST                     (3) | Val  Loss: 0.3050 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.4412 | Val  Acc: 0.8152
 Site-USPS                      (0) | Val  Loss: 0.3752 | Val  Acc: 0.8705
 Site-SynthDigits               (4) | Val  Loss: 0.4431 | Val  Acc: 0.8587
 Site-SynthDigits               (4) | Val  Loss: 0.4217 | Val  Acc: 0.8741
 Site-MNIST_M                   (1) | Val  Loss: 0.6712 | Val  Acc: 0.7935
 Site-MNIST_M                   (1) | Val  Loss: 0.6092 | Val  Acc: 0.8058
 Site-SVHN                      (5) | Val  Loss: 0.8207 | Val  Acc: 0.7717
 Site-SVHN                      (2) | Val  Loss: 0.8307 | Val  Acc: 0.7518
Average Valid Accuracy: 0.8397
============ Train epoch 26 ============
cnt=[2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (2) | Train Loss: 0.2426 | Train Acc: 0.9218
 Site-MNIST                     (2) | Train Loss: 0.3053 | Train Acc: 0.9067
 Site-USPS                      (4) | Train Loss: 0.3206 | Train Acc: 0.8922
 Site-USPS                      (4) | Train Loss: 0.3155 | Train Acc: 0.9004
 Site-SynthDigits               (0) | Train Loss: 0.4305 | Train Acc: 0.8760
 Site-SynthDigits               (0) | Train Loss: 0.4018 | Train Acc: 0.8852
 Site-MNIST_M                   (1) | Train Loss: 0.6537 | Train Acc: 0.7978
 Site-MNIST_M                   (1) | Train Loss: 0.6295 | Train Acc: 0.8224
 Site-SVHN                      (5) | Train Loss: 0.9033 | Train Acc: 0.6981
 Site-SVHN                      (3) | Train Loss: 0.7788 | Train Acc: 0.7641
Average Train Accuracy: 0.8465
 Site-MNIST                     (2) | Val  Loss: 0.2125 | Val  Acc: 0.9239
 Site-MNIST                     (2) | Val  Loss: 0.3060 | Val  Acc: 0.9281
 Site-USPS                      (4) | Val  Loss: 0.4343 | Val  Acc: 0.8152
 Site-USPS                      (4) | Val  Loss: 0.3717 | Val  Acc: 0.8669
 Site-SynthDigits               (0) | Val  Loss: 0.4299 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.4098 | Val  Acc: 0.8705
 Site-MNIST_M                   (1) | Val  Loss: 0.6485 | Val  Acc: 0.8043
 Site-MNIST_M                   (1) | Val  Loss: 0.5912 | Val  Acc: 0.8201
 Site-SVHN                      (5) | Val  Loss: 0.7995 | Val  Acc: 0.7717
 Site-SVHN                      (3) | Val  Loss: 0.8124 | Val  Acc: 0.7518
Average Valid Accuracy: 0.8411
============ Train epoch 27 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (3) | Train Loss: 0.2351 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2932 | Train Acc: 0.9139
 Site-USPS                      (5) | Train Loss: 0.3026 | Train Acc: 0.9030
 Site-USPS                      (1) | Train Loss: 0.2974 | Train Acc: 0.9085
 Site-SynthDigits               (4) | Train Loss: 0.4480 | Train Acc: 0.8679
 Site-SynthDigits               (4) | Train Loss: 0.4068 | Train Acc: 0.8843
 Site-MNIST_M                   (0) | Train Loss: 0.6389 | Train Acc: 0.7925
 Site-MNIST_M                   (0) | Train Loss: 0.6058 | Train Acc: 0.8278
 Site-SVHN                      (2) | Train Loss: 0.9064 | Train Acc: 0.7008
 Site-SVHN                      (2) | Train Loss: 0.7605 | Train Acc: 0.7570
Average Train Accuracy: 0.8486
 Site-MNIST                     (3) | Val  Loss: 0.2040 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.2911 | Val  Acc: 0.9281
 Site-USPS                      (5) | Val  Loss: 0.4158 | Val  Acc: 0.8261
 Site-USPS                      (1) | Val  Loss: 0.3487 | Val  Acc: 0.8777
 Site-SynthDigits               (4) | Val  Loss: 0.4482 | Val  Acc: 0.8370
 Site-SynthDigits               (4) | Val  Loss: 0.4170 | Val  Acc: 0.8669
 Site-MNIST_M                   (0) | Val  Loss: 0.6335 | Val  Acc: 0.8043
 Site-MNIST_M                   (0) | Val  Loss: 0.5767 | Val  Acc: 0.8273
 Site-SVHN                      (2) | Val  Loss: 0.8034 | Val  Acc: 0.7500
 Site-SVHN                      (2) | Val  Loss: 0.8226 | Val  Acc: 0.7410
Average Valid Accuracy: 0.8393
============ Train epoch 28 ============
cnt=[1, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (3) | Train Loss: 0.2337 | Train Acc: 0.9218
 Site-MNIST                     (3) | Train Loss: 0.2998 | Train Acc: 0.9085
 Site-USPS                      (1) | Train Loss: 0.3108 | Train Acc: 0.8895
 Site-USPS                      (1) | Train Loss: 0.3028 | Train Acc: 0.9076
 Site-SynthDigits               (4) | Train Loss: 0.4272 | Train Acc: 0.8706
 Site-SynthDigits               (4) | Train Loss: 0.3930 | Train Acc: 0.8861
 Site-MNIST_M                   (2) | Train Loss: 0.6346 | Train Acc: 0.8032
 Site-MNIST_M                   (2) | Train Loss: 0.5938 | Train Acc: 0.8314
 Site-SVHN                      (0) | Train Loss: 0.8854 | Train Acc: 0.7089
 Site-SVHN                      (5) | Train Loss: 0.7384 | Train Acc: 0.7740
Average Train Accuracy: 0.8502
 Site-MNIST                     (3) | Val  Loss: 0.2086 | Val  Acc: 0.9239
 Site-MNIST                     (3) | Val  Loss: 0.2959 | Val  Acc: 0.9173
 Site-USPS                      (1) | Val  Loss: 0.4203 | Val  Acc: 0.8261
 Site-USPS                      (1) | Val  Loss: 0.3598 | Val  Acc: 0.8777
 Site-SynthDigits               (4) | Val  Loss: 0.4309 | Val  Acc: 0.8587
 Site-SynthDigits               (4) | Val  Loss: 0.4086 | Val  Acc: 0.8705
 Site-MNIST_M                   (2) | Val  Loss: 0.6341 | Val  Acc: 0.8043
 Site-MNIST_M                   (2) | Val  Loss: 0.5720 | Val  Acc: 0.8273
 Site-SVHN                      (0) | Val  Loss: 0.7912 | Val  Acc: 0.7826
 Site-SVHN                      (5) | Val  Loss: 0.7908 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8447
 Best site-MNIST                    (3)  | Epoch:28 | Val Acc: 0.9239
 Best site-MNIST                    (3)  | Epoch:28 | Val Acc: 0.9173
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.8261
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.8777
 Best site-SynthDigits              (4)  | Epoch:28 | Val Acc: 0.8587
 Best site-SynthDigits              (4)  | Epoch:28 | Val Acc: 0.8705
 Best site-MNIST_M                  (2)  | Epoch:28 | Val Acc: 0.8043
 Best site-MNIST_M                  (2)  | Epoch:28 | Val Acc: 0.8273
 Best site-SVHN                     (0)  | Epoch:28 | Val Acc: 0.7826
 Best site-SVHN                     (5)  | Epoch:28 | Val Acc: 0.7590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 29 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (3) | Train Loss: 0.2222 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2784 | Train Acc: 0.9166
 Site-USPS                      (4) | Train Loss: 0.3041 | Train Acc: 0.9030
 Site-USPS                      (4) | Train Loss: 0.2992 | Train Acc: 0.9067
 Site-SynthDigits               (1) | Train Loss: 0.4203 | Train Acc: 0.8841
 Site-SynthDigits               (5) | Train Loss: 0.3839 | Train Acc: 0.8951
 Site-MNIST_M                   (0) | Train Loss: 0.6319 | Train Acc: 0.8032
 Site-MNIST_M                   (0) | Train Loss: 0.5872 | Train Acc: 0.8368
 Site-SVHN                      (2) | Train Loss: 0.8677 | Train Acc: 0.7170
 Site-SVHN                      (2) | Train Loss: 0.7338 | Train Acc: 0.7785
Average Train Accuracy: 0.8574
 Site-MNIST                     (3) | Val  Loss: 0.1927 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.2831 | Val  Acc: 0.9317
 Site-USPS                      (4) | Val  Loss: 0.4168 | Val  Acc: 0.8261
 Site-USPS                      (4) | Val  Loss: 0.3510 | Val  Acc: 0.8741
 Site-SynthDigits               (1) | Val  Loss: 0.4263 | Val  Acc: 0.8804
 Site-SynthDigits               (5) | Val  Loss: 0.3961 | Val  Acc: 0.8777
 Site-MNIST_M                   (0) | Val  Loss: 0.6216 | Val  Acc: 0.8043
 Site-MNIST_M                   (0) | Val  Loss: 0.5602 | Val  Acc: 0.8273
 Site-SVHN                      (2) | Val  Loss: 0.7791 | Val  Acc: 0.7826
 Site-SVHN                      (2) | Val  Loss: 0.7803 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8509
 Best site-MNIST                    (3)  | Epoch:29 | Val Acc: 0.9348
 Best site-MNIST                    (3)  | Epoch:29 | Val Acc: 0.9317
 Best site-USPS                     (4)  | Epoch:29 | Val Acc: 0.8261
 Best site-USPS                     (4)  | Epoch:29 | Val Acc: 0.8741
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.8804
 Best site-SynthDigits              (5)  | Epoch:29 | Val Acc: 0.8777
 Best site-MNIST_M                  (0)  | Epoch:29 | Val Acc: 0.8043
 Best site-MNIST_M                  (0)  | Epoch:29 | Val Acc: 0.8273
 Best site-SVHN                     (2)  | Epoch:29 | Val Acc: 0.7826
 Best site-SVHN                     (2)  | Epoch:29 | Val Acc: 0.7698
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 30 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (3) | Train Loss: 0.2195 | Train Acc: 0.9245
 Site-MNIST                     (3) | Train Loss: 0.2818 | Train Acc: 0.9175
 Site-USPS                      (0) | Train Loss: 0.2990 | Train Acc: 0.9084
 Site-USPS                      (0) | Train Loss: 0.2990 | Train Acc: 0.9121
 Site-SynthDigits               (4) | Train Loss: 0.4003 | Train Acc: 0.8868
 Site-SynthDigits               (4) | Train Loss: 0.3701 | Train Acc: 0.9040
 Site-MNIST_M                   (2) | Train Loss: 0.6208 | Train Acc: 0.8167
 Site-MNIST_M                   (2) | Train Loss: 0.5774 | Train Acc: 0.8386
 Site-SVHN                      (1) | Train Loss: 0.8751 | Train Acc: 0.7197
 Site-SVHN                      (5) | Train Loss: 0.7444 | Train Acc: 0.7686
Average Train Accuracy: 0.8597
 Site-MNIST                     (3) | Val  Loss: 0.1923 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.2828 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.4009 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.3431 | Val  Acc: 0.8813
 Site-SynthDigits               (4) | Val  Loss: 0.3951 | Val  Acc: 0.8696
 Site-SynthDigits               (4) | Val  Loss: 0.3770 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.5994 | Val  Acc: 0.7935
 Site-MNIST_M                   (2) | Val  Loss: 0.5442 | Val  Acc: 0.8345
 Site-SVHN                      (1) | Val  Loss: 0.7809 | Val  Acc: 0.7500
 Site-SVHN                      (5) | Val  Loss: 0.7898 | Val  Acc: 0.7518
Average Valid Accuracy: 0.8465
============ Train epoch 31 ============
cnt=[1, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.2202 | Train Acc: 0.9299
 Site-MNIST                     (1) | Train Loss: 0.2706 | Train Acc: 0.9202
 Site-USPS                      (4) | Train Loss: 0.2929 | Train Acc: 0.9084
 Site-USPS                      (4) | Train Loss: 0.2844 | Train Acc: 0.9157
 Site-SynthDigits               (3) | Train Loss: 0.4012 | Train Acc: 0.8760
 Site-SynthDigits               (3) | Train Loss: 0.3653 | Train Acc: 0.9004
 Site-MNIST_M                   (2) | Train Loss: 0.6105 | Train Acc: 0.8113
 Site-MNIST_M                   (2) | Train Loss: 0.5664 | Train Acc: 0.8404
 Site-SVHN                      (0) | Train Loss: 0.8500 | Train Acc: 0.7035
 Site-SVHN                      (5) | Train Loss: 0.7131 | Train Acc: 0.7821
Average Train Accuracy: 0.8588
 Site-MNIST                     (1) | Val  Loss: 0.1810 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2745 | Val  Acc: 0.9317
 Site-USPS                      (4) | Val  Loss: 0.3978 | Val  Acc: 0.8261
 Site-USPS                      (4) | Val  Loss: 0.3275 | Val  Acc: 0.8885
 Site-SynthDigits               (3) | Val  Loss: 0.4012 | Val  Acc: 0.8696
 Site-SynthDigits               (3) | Val  Loss: 0.3727 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.5955 | Val  Acc: 0.8152
 Site-MNIST_M                   (2) | Val  Loss: 0.5370 | Val  Acc: 0.8417
 Site-SVHN                      (0) | Val  Loss: 0.7676 | Val  Acc: 0.7391
 Site-SVHN                      (5) | Val  Loss: 0.7616 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8498
============ Train epoch 32 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.2147 | Train Acc: 0.9353
 Site-MNIST                     (0) | Train Loss: 0.2685 | Train Acc: 0.9247
 Site-USPS                      (4) | Train Loss: 0.2967 | Train Acc: 0.8976
 Site-USPS                      (4) | Train Loss: 0.2846 | Train Acc: 0.9121
 Site-SynthDigits               (2) | Train Loss: 0.4031 | Train Acc: 0.8841
 Site-SynthDigits               (2) | Train Loss: 0.3675 | Train Acc: 0.8996
 Site-MNIST_M                   (3) | Train Loss: 0.6136 | Train Acc: 0.8113
 Site-MNIST_M                   (3) | Train Loss: 0.5639 | Train Acc: 0.8350
 Site-SVHN                      (5) | Train Loss: 0.8429 | Train Acc: 0.7224
 Site-SVHN                      (1) | Train Loss: 0.7020 | Train Acc: 0.7848
Average Train Accuracy: 0.8607
 Site-MNIST                     (0) | Val  Loss: 0.1757 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2689 | Val  Acc: 0.9353
 Site-USPS                      (4) | Val  Loss: 0.3939 | Val  Acc: 0.8261
 Site-USPS                      (4) | Val  Loss: 0.3307 | Val  Acc: 0.8777
 Site-SynthDigits               (2) | Val  Loss: 0.3971 | Val  Acc: 0.8804
 Site-SynthDigits               (2) | Val  Loss: 0.3739 | Val  Acc: 0.8849
 Site-MNIST_M                   (3) | Val  Loss: 0.5964 | Val  Acc: 0.8152
 Site-MNIST_M                   (3) | Val  Loss: 0.5372 | Val  Acc: 0.8273
 Site-SVHN                      (5) | Val  Loss: 0.7554 | Val  Acc: 0.7826
 Site-SVHN                      (1) | Val  Loss: 0.7450 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8549
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9353
 Best site-USPS                     (4)  | Epoch:32 | Val Acc: 0.8261
 Best site-USPS                     (4)  | Epoch:32 | Val Acc: 0.8777
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.8804
 Best site-SynthDigits              (2)  | Epoch:32 | Val Acc: 0.8849
 Best site-MNIST_M                  (3)  | Epoch:32 | Val Acc: 0.8152
 Best site-MNIST_M                  (3)  | Epoch:32 | Val Acc: 0.8273
 Best site-SVHN                     (5)  | Epoch:32 | Val Acc: 0.7826
 Best site-SVHN                     (1)  | Epoch:32 | Val Acc: 0.7734
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (3) | Train Loss: 0.2111 | Train Acc: 0.9353
 Site-MNIST                     (3) | Train Loss: 0.2640 | Train Acc: 0.9238
 Site-USPS                      (2) | Train Loss: 0.2798 | Train Acc: 0.9111
 Site-USPS                      (2) | Train Loss: 0.2727 | Train Acc: 0.9157
 Site-SynthDigits               (4) | Train Loss: 0.3922 | Train Acc: 0.8814
 Site-SynthDigits               (4) | Train Loss: 0.3529 | Train Acc: 0.9031
 Site-MNIST_M                   (0) | Train Loss: 0.6126 | Train Acc: 0.8005
 Site-MNIST_M                   (0) | Train Loss: 0.5484 | Train Acc: 0.8341
 Site-SVHN                      (1) | Train Loss: 0.8482 | Train Acc: 0.7143
 Site-SVHN                      (5) | Train Loss: 0.6972 | Train Acc: 0.7901
Average Train Accuracy: 0.8609
 Site-MNIST                     (3) | Val  Loss: 0.1728 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2639 | Val  Acc: 0.9353
 Site-USPS                      (2) | Val  Loss: 0.3792 | Val  Acc: 0.8370
 Site-USPS                      (2) | Val  Loss: 0.3134 | Val  Acc: 0.8885
 Site-SynthDigits               (4) | Val  Loss: 0.3861 | Val  Acc: 0.8913
 Site-SynthDigits               (4) | Val  Loss: 0.3643 | Val  Acc: 0.8813
 Site-MNIST_M                   (0) | Val  Loss: 0.5771 | Val  Acc: 0.8152
 Site-MNIST_M                   (0) | Val  Loss: 0.5242 | Val  Acc: 0.8309
 Site-SVHN                      (1) | Val  Loss: 0.7442 | Val  Acc: 0.7826
 Site-SVHN                      (5) | Val  Loss: 0.7463 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8592
 Best site-MNIST                    (3)  | Epoch:33 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:33 | Val Acc: 0.9353
 Best site-USPS                     (2)  | Epoch:33 | Val Acc: 0.8370
 Best site-USPS                     (2)  | Epoch:33 | Val Acc: 0.8885
 Best site-SynthDigits              (4)  | Epoch:33 | Val Acc: 0.8913
 Best site-SynthDigits              (4)  | Epoch:33 | Val Acc: 0.8813
 Best site-MNIST_M                  (0)  | Epoch:33 | Val Acc: 0.8152
 Best site-MNIST_M                  (0)  | Epoch:33 | Val Acc: 0.8309
 Best site-SVHN                     (1)  | Epoch:33 | Val Acc: 0.7826
 Best site-SVHN                     (5)  | Epoch:33 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 34 ============
cnt=[2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (3) | Train Loss: 0.2060 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2622 | Train Acc: 0.9265
 Site-USPS                      (0) | Train Loss: 0.2740 | Train Acc: 0.9191
 Site-USPS                      (0) | Train Loss: 0.2796 | Train Acc: 0.9157
 Site-SynthDigits               (4) | Train Loss: 0.3888 | Train Acc: 0.8868
 Site-SynthDigits               (5) | Train Loss: 0.3554 | Train Acc: 0.9031
 Site-MNIST_M                   (2) | Train Loss: 0.6015 | Train Acc: 0.8194
 Site-MNIST_M                   (2) | Train Loss: 0.5363 | Train Acc: 0.8395
 Site-SVHN                      (1) | Train Loss: 0.8339 | Train Acc: 0.7251
 Site-SVHN                      (1) | Train Loss: 0.6895 | Train Acc: 0.7928
Average Train Accuracy: 0.8658
 Site-MNIST                     (3) | Val  Loss: 0.1666 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2662 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.3773 | Val  Acc: 0.8370
 Site-USPS                      (0) | Val  Loss: 0.3122 | Val  Acc: 0.8921
 Site-SynthDigits               (4) | Val  Loss: 0.3854 | Val  Acc: 0.8913
 Site-SynthDigits               (5) | Val  Loss: 0.3608 | Val  Acc: 0.8849
 Site-MNIST_M                   (2) | Val  Loss: 0.5615 | Val  Acc: 0.8261
 Site-MNIST_M                   (2) | Val  Loss: 0.5181 | Val  Acc: 0.8381
 Site-SVHN                      (1) | Val  Loss: 0.7335 | Val  Acc: 0.7935
 Site-SVHN                      (1) | Val  Loss: 0.7363 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8614
 Best site-MNIST                    (3)  | Epoch:34 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:34 | Val Acc: 0.9353
 Best site-USPS                     (0)  | Epoch:34 | Val Acc: 0.8370
 Best site-USPS                     (0)  | Epoch:34 | Val Acc: 0.8921
 Best site-SynthDigits              (4)  | Epoch:34 | Val Acc: 0.8913
 Best site-SynthDigits              (5)  | Epoch:34 | Val Acc: 0.8849
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8261
 Best site-MNIST_M                  (2)  | Epoch:34 | Val Acc: 0.8381
 Best site-SVHN                     (1)  | Epoch:34 | Val Acc: 0.7935
 Best site-SVHN                     (1)  | Epoch:34 | Val Acc: 0.7698
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 35 ============
cnt=[1, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (3) | Train Loss: 0.2082 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2609 | Train Acc: 0.9247
 Site-USPS                      (1) | Train Loss: 0.2778 | Train Acc: 0.9137
 Site-USPS                      (1) | Train Loss: 0.2731 | Train Acc: 0.9193
 Site-SynthDigits               (4) | Train Loss: 0.3754 | Train Acc: 0.8895
 Site-SynthDigits               (4) | Train Loss: 0.3536 | Train Acc: 0.9085
 Site-MNIST_M                   (5) | Train Loss: 0.5989 | Train Acc: 0.8032
 Site-MNIST_M                   (0) | Train Loss: 0.5336 | Train Acc: 0.8430
 Site-SVHN                      (2) | Train Loss: 0.8269 | Train Acc: 0.7251
 Site-SVHN                      (2) | Train Loss: 0.6698 | Train Acc: 0.8000
Average Train Accuracy: 0.8657
 Site-MNIST                     (3) | Val  Loss: 0.1613 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2665 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.3804 | Val  Acc: 0.8370
 Site-USPS                      (1) | Val  Loss: 0.3161 | Val  Acc: 0.8885
 Site-SynthDigits               (4) | Val  Loss: 0.3772 | Val  Acc: 0.8804
 Site-SynthDigits               (4) | Val  Loss: 0.3481 | Val  Acc: 0.8849
 Site-MNIST_M                   (5) | Val  Loss: 0.5460 | Val  Acc: 0.8370
 Site-MNIST_M                   (0) | Val  Loss: 0.5118 | Val  Acc: 0.8453
 Site-SVHN                      (2) | Val  Loss: 0.7209 | Val  Acc: 0.7391
 Site-SVHN                      (2) | Val  Loss: 0.7267 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8563
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (1) | Train Loss: 0.1979 | Train Acc: 0.9326
 Site-MNIST                     (1) | Train Loss: 0.2547 | Train Acc: 0.9220
 Site-USPS                      (4) | Train Loss: 0.2803 | Train Acc: 0.9164
 Site-USPS                      (5) | Train Loss: 0.2755 | Train Acc: 0.9121
 Site-SynthDigits               (0) | Train Loss: 0.3803 | Train Acc: 0.8868
 Site-SynthDigits               (0) | Train Loss: 0.3547 | Train Acc: 0.9058
 Site-MNIST_M                   (3) | Train Loss: 0.5861 | Train Acc: 0.8194
 Site-MNIST_M                   (3) | Train Loss: 0.5266 | Train Acc: 0.8475
 Site-SVHN                      (2) | Train Loss: 0.8197 | Train Acc: 0.7224
 Site-SVHN                      (2) | Train Loss: 0.6724 | Train Acc: 0.8000
Average Train Accuracy: 0.8665
 Site-MNIST                     (1) | Val  Loss: 0.1600 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2663 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3831 | Val  Acc: 0.8370
 Site-USPS                      (5) | Val  Loss: 0.3231 | Val  Acc: 0.8921
 Site-SynthDigits               (0) | Val  Loss: 0.3806 | Val  Acc: 0.8804
 Site-SynthDigits               (0) | Val  Loss: 0.3542 | Val  Acc: 0.8885
 Site-MNIST_M                   (3) | Val  Loss: 0.5438 | Val  Acc: 0.8370
 Site-MNIST_M                   (3) | Val  Loss: 0.5061 | Val  Acc: 0.8525
 Site-SVHN                      (2) | Val  Loss: 0.7168 | Val  Acc: 0.7826
 Site-SVHN                      (2) | Val  Loss: 0.7092 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8639
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9388
 Best site-USPS                     (4)  | Epoch:36 | Val Acc: 0.8370
 Best site-USPS                     (5)  | Epoch:36 | Val Acc: 0.8921
 Best site-SynthDigits              (0)  | Epoch:36 | Val Acc: 0.8804
 Best site-SynthDigits              (0)  | Epoch:36 | Val Acc: 0.8885
 Best site-MNIST_M                  (3)  | Epoch:36 | Val Acc: 0.8370
 Best site-MNIST_M                  (3)  | Epoch:36 | Val Acc: 0.8525
 Best site-SVHN                     (2)  | Epoch:36 | Val Acc: 0.7826
 Best site-SVHN                     (2)  | Epoch:36 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.1952 | Train Acc: 0.9380
 Site-MNIST                     (3) | Train Loss: 0.2552 | Train Acc: 0.9238
 Site-USPS                      (1) | Train Loss: 0.2687 | Train Acc: 0.9137
 Site-USPS                      (1) | Train Loss: 0.2641 | Train Acc: 0.9175
 Site-SynthDigits               (4) | Train Loss: 0.3819 | Train Acc: 0.8814
 Site-SynthDigits               (4) | Train Loss: 0.3559 | Train Acc: 0.8996
 Site-MNIST_M                   (0) | Train Loss: 0.5713 | Train Acc: 0.8194
 Site-MNIST_M                   (0) | Train Loss: 0.5188 | Train Acc: 0.8493
 Site-SVHN                      (5) | Train Loss: 0.8195 | Train Acc: 0.7170
 Site-SVHN                      (2) | Train Loss: 0.6520 | Train Acc: 0.8000
Average Train Accuracy: 0.8660
 Site-MNIST                     (3) | Val  Loss: 0.1617 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.2602 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.3683 | Val  Acc: 0.8478
 Site-USPS                      (1) | Val  Loss: 0.3092 | Val  Acc: 0.8921
 Site-SynthDigits               (4) | Val  Loss: 0.3878 | Val  Acc: 0.8696
 Site-SynthDigits               (4) | Val  Loss: 0.3523 | Val  Acc: 0.8849
 Site-MNIST_M                   (0) | Val  Loss: 0.5356 | Val  Acc: 0.8261
 Site-MNIST_M                   (0) | Val  Loss: 0.4928 | Val  Acc: 0.8597
 Site-SVHN                      (5) | Val  Loss: 0.7037 | Val  Acc: 0.8043
 Site-SVHN                      (2) | Val  Loss: 0.7102 | Val  Acc: 0.7770
Average Valid Accuracy: 0.8628
============ Train epoch 38 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (3) | Train Loss: 0.2006 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2513 | Train Acc: 0.9265
 Site-USPS                      (4) | Train Loss: 0.2579 | Train Acc: 0.9299
 Site-USPS                      (4) | Train Loss: 0.2563 | Train Acc: 0.9211
 Site-SynthDigits               (0) | Train Loss: 0.3811 | Train Acc: 0.8787
 Site-SynthDigits               (0) | Train Loss: 0.3414 | Train Acc: 0.9049
 Site-MNIST_M                   (1) | Train Loss: 0.5795 | Train Acc: 0.8140
 Site-MNIST_M                   (1) | Train Loss: 0.5218 | Train Acc: 0.8484
 Site-SVHN                      (2) | Train Loss: 0.8100 | Train Acc: 0.7305
 Site-SVHN                      (5) | Train Loss: 0.6517 | Train Acc: 0.7991
Average Train Accuracy: 0.8683
 Site-MNIST                     (3) | Val  Loss: 0.1580 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2578 | Val  Acc: 0.9353
 Site-USPS                      (4) | Val  Loss: 0.3492 | Val  Acc: 0.8478
 Site-USPS                      (4) | Val  Loss: 0.2941 | Val  Acc: 0.8885
 Site-SynthDigits               (0) | Val  Loss: 0.3937 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3503 | Val  Acc: 0.8849
 Site-MNIST_M                   (1) | Val  Loss: 0.5325 | Val  Acc: 0.8370
 Site-MNIST_M                   (1) | Val  Loss: 0.4913 | Val  Acc: 0.8597
 Site-SVHN                      (2) | Val  Loss: 0.6945 | Val  Acc: 0.7717
 Site-SVHN                      (5) | Val  Loss: 0.7047 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8613
============ Train epoch 39 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (0) | Train Loss: 0.1932 | Train Acc: 0.9353
 Site-MNIST                     (0) | Train Loss: 0.2442 | Train Acc: 0.9309
 Site-USPS                      (4) | Train Loss: 0.2685 | Train Acc: 0.9218
 Site-USPS                      (4) | Train Loss: 0.2615 | Train Acc: 0.9175
 Site-SynthDigits               (3) | Train Loss: 0.3596 | Train Acc: 0.8841
 Site-SynthDigits               (3) | Train Loss: 0.3299 | Train Acc: 0.9040
 Site-MNIST_M                   (2) | Train Loss: 0.5592 | Train Acc: 0.8086
 Site-MNIST_M                   (5) | Train Loss: 0.5111 | Train Acc: 0.8422
 Site-SVHN                      (1) | Train Loss: 0.8149 | Train Acc: 0.7224
 Site-SVHN                      (1) | Train Loss: 0.6522 | Train Acc: 0.7982
Average Train Accuracy: 0.8665
 Site-MNIST                     (0) | Val  Loss: 0.1511 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2508 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3519 | Val  Acc: 0.8478
 Site-USPS                      (4) | Val  Loss: 0.2971 | Val  Acc: 0.8921
 Site-SynthDigits               (3) | Val  Loss: 0.3601 | Val  Acc: 0.8696
 Site-SynthDigits               (3) | Val  Loss: 0.3317 | Val  Acc: 0.8849
 Site-MNIST_M                   (2) | Val  Loss: 0.5237 | Val  Acc: 0.8478
 Site-MNIST_M                   (5) | Val  Loss: 0.4815 | Val  Acc: 0.8597
 Site-SVHN                      (1) | Val  Loss: 0.6992 | Val  Acc: 0.7826
 Site-SVHN                      (1) | Val  Loss: 0.7043 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8664
 Best site-MNIST                    (0)  | Epoch:39 | Val Acc: 0.9565
 Best site-MNIST                    (0)  | Epoch:39 | Val Acc: 0.9388
 Best site-USPS                     (4)  | Epoch:39 | Val Acc: 0.8478
 Best site-USPS                     (4)  | Epoch:39 | Val Acc: 0.8921
 Best site-SynthDigits              (3)  | Epoch:39 | Val Acc: 0.8696
 Best site-SynthDigits              (3)  | Epoch:39 | Val Acc: 0.8849
 Best site-MNIST_M                  (2)  | Epoch:39 | Val Acc: 0.8478
 Best site-MNIST_M                  (5)  | Epoch:39 | Val Acc: 0.8597
 Best site-SVHN                     (1)  | Epoch:39 | Val Acc: 0.7826
 Best site-SVHN                     (1)  | Epoch:39 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (3) | Train Loss: 0.1923 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2358 | Train Acc: 0.9327
 Site-USPS                      (4) | Train Loss: 0.2586 | Train Acc: 0.9272
 Site-USPS                      (4) | Train Loss: 0.2491 | Train Acc: 0.9220
 Site-SynthDigits               (0) | Train Loss: 0.3618 | Train Acc: 0.8868
 Site-SynthDigits               (0) | Train Loss: 0.3276 | Train Acc: 0.9121
 Site-MNIST_M                   (1) | Train Loss: 0.5630 | Train Acc: 0.8194
 Site-MNIST_M                   (5) | Train Loss: 0.4985 | Train Acc: 0.8502
 Site-SVHN                      (2) | Train Loss: 0.8220 | Train Acc: 0.7358
 Site-SVHN                      (2) | Train Loss: 0.6468 | Train Acc: 0.8027
Average Train Accuracy: 0.8722
 Site-MNIST                     (3) | Val  Loss: 0.1510 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2489 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3514 | Val  Acc: 0.8478
 Site-USPS                      (4) | Val  Loss: 0.2919 | Val  Acc: 0.8957
 Site-SynthDigits               (0) | Val  Loss: 0.3597 | Val  Acc: 0.8804
 Site-SynthDigits               (0) | Val  Loss: 0.3351 | Val  Acc: 0.8849
 Site-MNIST_M                   (1) | Val  Loss: 0.5198 | Val  Acc: 0.8478
 Site-MNIST_M                   (5) | Val  Loss: 0.4762 | Val  Acc: 0.8525
 Site-SVHN                      (2) | Val  Loss: 0.6937 | Val  Acc: 0.7826
 Site-SVHN                      (2) | Val  Loss: 0.6976 | Val  Acc: 0.7770
Average Valid Accuracy: 0.8664
 Best site-MNIST                    (3)  | Epoch:40 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:40 | Val Acc: 0.9388
 Best site-USPS                     (4)  | Epoch:40 | Val Acc: 0.8478
 Best site-USPS                     (4)  | Epoch:40 | Val Acc: 0.8957
 Best site-SynthDigits              (0)  | Epoch:40 | Val Acc: 0.8804
 Best site-SynthDigits              (0)  | Epoch:40 | Val Acc: 0.8849
 Best site-MNIST_M                  (1)  | Epoch:40 | Val Acc: 0.8478
 Best site-MNIST_M                  (5)  | Epoch:40 | Val Acc: 0.8525
 Best site-SVHN                     (2)  | Epoch:40 | Val Acc: 0.7826
 Best site-SVHN                     (2)  | Epoch:40 | Val Acc: 0.7770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (3) | Train Loss: 0.1930 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2421 | Train Acc: 0.9336
 Site-USPS                      (4) | Train Loss: 0.2537 | Train Acc: 0.9245
 Site-USPS                      (4) | Train Loss: 0.2499 | Train Acc: 0.9247
 Site-SynthDigits               (0) | Train Loss: 0.3559 | Train Acc: 0.8922
 Site-SynthDigits               (0) | Train Loss: 0.3251 | Train Acc: 0.9040
 Site-MNIST_M                   (1) | Train Loss: 0.5552 | Train Acc: 0.8248
 Site-MNIST_M                   (1) | Train Loss: 0.4960 | Train Acc: 0.8529
 Site-SVHN                      (5) | Train Loss: 0.8079 | Train Acc: 0.7358
 Site-SVHN                      (2) | Train Loss: 0.6411 | Train Acc: 0.8018
Average Train Accuracy: 0.8727
 Site-MNIST                     (3) | Val  Loss: 0.1475 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2464 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3430 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.2830 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3543 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3318 | Val  Acc: 0.8885
 Site-MNIST_M                   (1) | Val  Loss: 0.5120 | Val  Acc: 0.8370
 Site-MNIST_M                   (1) | Val  Loss: 0.4701 | Val  Acc: 0.8561
 Site-SVHN                      (5) | Val  Loss: 0.6917 | Val  Acc: 0.7935
 Site-SVHN                      (2) | Val  Loss: 0.6888 | Val  Acc: 0.7878
Average Valid Accuracy: 0.8693
 Best site-MNIST                    (3)  | Epoch:41 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:41 | Val Acc: 0.9388
 Best site-USPS                     (4)  | Epoch:41 | Val Acc: 0.8587
 Best site-USPS                     (4)  | Epoch:41 | Val Acc: 0.9065
 Best site-SynthDigits              (0)  | Epoch:41 | Val Acc: 0.8696
 Best site-SynthDigits              (0)  | Epoch:41 | Val Acc: 0.8885
 Best site-MNIST_M                  (1)  | Epoch:41 | Val Acc: 0.8370
 Best site-MNIST_M                  (1)  | Epoch:41 | Val Acc: 0.8561
 Best site-SVHN                     (5)  | Epoch:41 | Val Acc: 0.7935
 Best site-SVHN                     (2)  | Epoch:41 | Val Acc: 0.7878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (3) | Train Loss: 0.1892 | Train Acc: 0.9380
 Site-MNIST                     (3) | Train Loss: 0.2326 | Train Acc: 0.9363
 Site-USPS                      (1) | Train Loss: 0.2450 | Train Acc: 0.9326
 Site-USPS                      (5) | Train Loss: 0.2498 | Train Acc: 0.9229
 Site-SynthDigits               (4) | Train Loss: 0.3485 | Train Acc: 0.8868
 Site-SynthDigits               (4) | Train Loss: 0.3196 | Train Acc: 0.9076
 Site-MNIST_M                   (2) | Train Loss: 0.5521 | Train Acc: 0.8275
 Site-MNIST_M                   (2) | Train Loss: 0.4918 | Train Acc: 0.8601
 Site-SVHN                      (0) | Train Loss: 0.7983 | Train Acc: 0.7332
 Site-SVHN                      (0) | Train Loss: 0.6230 | Train Acc: 0.8117
Average Train Accuracy: 0.8757
 Site-MNIST                     (3) | Val  Loss: 0.1484 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2468 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3360 | Val  Acc: 0.8478
 Site-USPS                      (5) | Val  Loss: 0.2809 | Val  Acc: 0.8957
 Site-SynthDigits               (4) | Val  Loss: 0.3380 | Val  Acc: 0.8913
 Site-SynthDigits               (4) | Val  Loss: 0.3130 | Val  Acc: 0.8993
 Site-MNIST_M                   (2) | Val  Loss: 0.5005 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.4635 | Val  Acc: 0.8633
 Site-SVHN                      (0) | Val  Loss: 0.6658 | Val  Acc: 0.7935
 Site-SVHN                      (0) | Val  Loss: 0.6823 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8744
 Best site-MNIST                    (3)  | Epoch:42 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:42 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:42 | Val Acc: 0.8478
 Best site-USPS                     (5)  | Epoch:42 | Val Acc: 0.8957
 Best site-SynthDigits              (4)  | Epoch:42 | Val Acc: 0.8913
 Best site-SynthDigits              (4)  | Epoch:42 | Val Acc: 0.8993
 Best site-MNIST_M                  (2)  | Epoch:42 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:42 | Val Acc: 0.8633
 Best site-SVHN                     (0)  | Epoch:42 | Val Acc: 0.7935
 Best site-SVHN                     (0)  | Epoch:42 | Val Acc: 0.7986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (4) | Train Loss: 0.1799 | Train Acc: 0.9434
 Site-MNIST                     (4) | Train Loss: 0.2288 | Train Acc: 0.9336
 Site-USPS                      (0) | Train Loss: 0.2565 | Train Acc: 0.9191
 Site-USPS                      (0) | Train Loss: 0.2387 | Train Acc: 0.9247
 Site-SynthDigits               (3) | Train Loss: 0.3476 | Train Acc: 0.8841
 Site-SynthDigits               (5) | Train Loss: 0.3250 | Train Acc: 0.9094
 Site-MNIST_M                   (2) | Train Loss: 0.5541 | Train Acc: 0.8194
 Site-MNIST_M                   (2) | Train Loss: 0.4842 | Train Acc: 0.8574
 Site-SVHN                      (1) | Train Loss: 0.7871 | Train Acc: 0.7439
 Site-SVHN                      (1) | Train Loss: 0.6168 | Train Acc: 0.8117
Average Train Accuracy: 0.8747
 Site-MNIST                     (4) | Val  Loss: 0.1465 | Val  Acc: 0.9565
 Site-MNIST                     (4) | Val  Loss: 0.2404 | Val  Acc: 0.9424
 Site-USPS                      (0) | Val  Loss: 0.3391 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.2823 | Val  Acc: 0.9029
 Site-SynthDigits               (3) | Val  Loss: 0.3413 | Val  Acc: 0.8913
 Site-SynthDigits               (5) | Val  Loss: 0.3204 | Val  Acc: 0.8921
 Site-MNIST_M                   (2) | Val  Loss: 0.5096 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.4638 | Val  Acc: 0.8489
 Site-SVHN                      (1) | Val  Loss: 0.6631 | Val  Acc: 0.8261
 Site-SVHN                      (1) | Val  Loss: 0.6656 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8773
 Best site-MNIST                    (4)  | Epoch:43 | Val Acc: 0.9565
 Best site-MNIST                    (4)  | Epoch:43 | Val Acc: 0.9424
 Best site-USPS                     (0)  | Epoch:43 | Val Acc: 0.8587
 Best site-USPS                     (0)  | Epoch:43 | Val Acc: 0.9029
 Best site-SynthDigits              (3)  | Epoch:43 | Val Acc: 0.8913
 Best site-SynthDigits              (5)  | Epoch:43 | Val Acc: 0.8921
 Best site-MNIST_M                  (2)  | Epoch:43 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:43 | Val Acc: 0.8489
 Best site-SVHN                     (1)  | Epoch:43 | Val Acc: 0.8261
 Best site-SVHN                     (1)  | Epoch:43 | Val Acc: 0.7950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 44 ============
cnt=[1, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (2) | Train Loss: 0.1747 | Train Acc: 0.9488
 Site-MNIST                     (2) | Train Loss: 0.2298 | Train Acc: 0.9318
 Site-USPS                      (1) | Train Loss: 0.2496 | Train Acc: 0.9272
 Site-USPS                      (1) | Train Loss: 0.2427 | Train Acc: 0.9229
 Site-SynthDigits               (4) | Train Loss: 0.3475 | Train Acc: 0.8895
 Site-SynthDigits               (4) | Train Loss: 0.3165 | Train Acc: 0.9112
 Site-MNIST_M                   (3) | Train Loss: 0.5399 | Train Acc: 0.8221
 Site-MNIST_M                   (3) | Train Loss: 0.4792 | Train Acc: 0.8529
 Site-SVHN                      (0) | Train Loss: 0.7753 | Train Acc: 0.7412
 Site-SVHN                      (5) | Train Loss: 0.6086 | Train Acc: 0.8108
Average Train Accuracy: 0.8758
 Site-MNIST                     (2) | Val  Loss: 0.1411 | Val  Acc: 0.9565
 Site-MNIST                     (2) | Val  Loss: 0.2366 | Val  Acc: 0.9388
 Site-USPS                      (1) | Val  Loss: 0.3397 | Val  Acc: 0.8587
 Site-USPS                      (1) | Val  Loss: 0.2803 | Val  Acc: 0.9029
 Site-SynthDigits               (4) | Val  Loss: 0.3318 | Val  Acc: 0.8804
 Site-SynthDigits               (4) | Val  Loss: 0.3105 | Val  Acc: 0.8921
 Site-MNIST_M                   (3) | Val  Loss: 0.5032 | Val  Acc: 0.8804
 Site-MNIST_M                   (3) | Val  Loss: 0.4564 | Val  Acc: 0.8597
 Site-SVHN                      (0) | Val  Loss: 0.6545 | Val  Acc: 0.8370
 Site-SVHN                      (5) | Val  Loss: 0.6654 | Val  Acc: 0.8094
Average Valid Accuracy: 0.8816
 Best site-MNIST                    (2)  | Epoch:44 | Val Acc: 0.9565
 Best site-MNIST                    (2)  | Epoch:44 | Val Acc: 0.9388
 Best site-USPS                     (1)  | Epoch:44 | Val Acc: 0.8587
 Best site-USPS                     (1)  | Epoch:44 | Val Acc: 0.9029
 Best site-SynthDigits              (4)  | Epoch:44 | Val Acc: 0.8804
 Best site-SynthDigits              (4)  | Epoch:44 | Val Acc: 0.8921
 Best site-MNIST_M                  (3)  | Epoch:44 | Val Acc: 0.8804
 Best site-MNIST_M                  (3)  | Epoch:44 | Val Acc: 0.8597
 Best site-SVHN                     (0)  | Epoch:44 | Val Acc: 0.8370
 Best site-SVHN                     (5)  | Epoch:44 | Val Acc: 0.8094
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 45 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (0) | Train Loss: 0.1771 | Train Acc: 0.9488
 Site-MNIST                     (0) | Train Loss: 0.2307 | Train Acc: 0.9345
 Site-USPS                      (4) | Train Loss: 0.2446 | Train Acc: 0.9299
 Site-USPS                      (4) | Train Loss: 0.2362 | Train Acc: 0.9283
 Site-SynthDigits               (2) | Train Loss: 0.3470 | Train Acc: 0.8922
 Site-SynthDigits               (2) | Train Loss: 0.3126 | Train Acc: 0.9112
 Site-MNIST_M                   (3) | Train Loss: 0.5483 | Train Acc: 0.8140
 Site-MNIST_M                   (3) | Train Loss: 0.4757 | Train Acc: 0.8547
 Site-SVHN                      (5) | Train Loss: 0.7743 | Train Acc: 0.7574
 Site-SVHN                      (1) | Train Loss: 0.6035 | Train Acc: 0.8188
Average Train Accuracy: 0.8790
 Site-MNIST                     (0) | Val  Loss: 0.1401 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2355 | Val  Acc: 0.9424
 Site-USPS                      (4) | Val  Loss: 0.3277 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.2680 | Val  Acc: 0.9101
 Site-SynthDigits               (2) | Val  Loss: 0.3394 | Val  Acc: 0.8696
 Site-SynthDigits               (2) | Val  Loss: 0.3082 | Val  Acc: 0.8957
 Site-MNIST_M                   (3) | Val  Loss: 0.4965 | Val  Acc: 0.8804
 Site-MNIST_M                   (3) | Val  Loss: 0.4525 | Val  Acc: 0.8597
 Site-SVHN                      (5) | Val  Loss: 0.6554 | Val  Acc: 0.8043
 Site-SVHN                      (1) | Val  Loss: 0.6624 | Val  Acc: 0.8022
Average Valid Accuracy: 0.8780
 Test site-MNIST                     (0)| Epoch:44 | Test Acc: 0.9404
 Test site-USPS                      (4)| Epoch:44 | Test Acc: 0.9376
 Test site-SynthDigits               (2)| Epoch:44 | Test Acc: 0.8984
 Test site-MNIST_M                   (3)| Epoch:44 | Test Acc: 0.7806
 Test site-SVHN                      (5)| Epoch:44 | Test Acc: 0.7334
MNIST: 0.9404, USPS: 0.9376, SynthDigits: 0.8984, MNIST_M: 0.7806, SVHN: 0.7334, 
Average Test Accuracy(group): 0.8581, Average Test Accuracy(individual): 0.8581,
domain std=0.0852, cluster std=0.0906, individual std=0.0852, 
Average Test Accuracy: 0.8581
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (0) | Train Loss: 0.1854 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.2241 | Train Acc: 0.9336
 Site-USPS                      (4) | Train Loss: 0.2482 | Train Acc: 0.9326
 Site-USPS                      (4) | Train Loss: 0.2398 | Train Acc: 0.9256
 Site-SynthDigits               (2) | Train Loss: 0.3343 | Train Acc: 0.8949
 Site-SynthDigits               (2) | Train Loss: 0.3101 | Train Acc: 0.9175
 Site-MNIST_M                   (3) | Train Loss: 0.5473 | Train Acc: 0.8167
 Site-MNIST_M                   (3) | Train Loss: 0.4674 | Train Acc: 0.8637
 Site-SVHN                      (1) | Train Loss: 0.7708 | Train Acc: 0.7493
 Site-SVHN                      (5) | Train Loss: 0.6082 | Train Acc: 0.8206
Average Train Accuracy: 0.8793
 Site-MNIST                     (0) | Val  Loss: 0.1405 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2382 | Val  Acc: 0.9424
 Site-USPS                      (4) | Val  Loss: 0.3346 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.2757 | Val  Acc: 0.9065
 Site-SynthDigits               (2) | Val  Loss: 0.3242 | Val  Acc: 0.8913
 Site-SynthDigits               (2) | Val  Loss: 0.2975 | Val  Acc: 0.9065
 Site-MNIST_M                   (3) | Val  Loss: 0.4893 | Val  Acc: 0.8478
 Site-MNIST_M                   (3) | Val  Loss: 0.4492 | Val  Acc: 0.8597
 Site-SVHN                      (1) | Val  Loss: 0.6539 | Val  Acc: 0.8043
 Site-SVHN                      (5) | Val  Loss: 0.6580 | Val  Acc: 0.8058
Average Valid Accuracy: 0.8780
 Test site-MNIST                     (0)| Epoch:45 | Test Acc: 0.9397
 Test site-USPS                      (4)| Epoch:45 | Test Acc: 0.9344
 Test site-SynthDigits               (2)| Epoch:45 | Test Acc: 0.9029
 Test site-MNIST_M                   (3)| Epoch:45 | Test Acc: 0.7803
 Test site-SVHN                      (1)| Epoch:45 | Test Acc: 0.7343
MNIST: 0.9397, USPS: 0.9344, SynthDigits: 0.9029, MNIST_M: 0.7803, SVHN: 0.7343, 
Average Test Accuracy(group): 0.8583, Average Test Accuracy(individual): 0.8583,
domain std=0.0847, cluster std=0.0901, individual std=0.0847, 
Average Test Accuracy: 0.8583
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (3) | Train Loss: 0.1772 | Train Acc: 0.9407
 Site-MNIST                     (3) | Train Loss: 0.2247 | Train Acc: 0.9345
 Site-USPS                      (4) | Train Loss: 0.2360 | Train Acc: 0.9461
 Site-USPS                      (4) | Train Loss: 0.2331 | Train Acc: 0.9291
 Site-SynthDigits               (0) | Train Loss: 0.3302 | Train Acc: 0.8895
 Site-SynthDigits               (0) | Train Loss: 0.3017 | Train Acc: 0.9148
 Site-MNIST_M                   (1) | Train Loss: 0.5428 | Train Acc: 0.8194
 Site-MNIST_M                   (1) | Train Loss: 0.4589 | Train Acc: 0.8655
 Site-SVHN                      (2) | Train Loss: 0.7735 | Train Acc: 0.7493
 Site-SVHN                      (5) | Train Loss: 0.5929 | Train Acc: 0.8179
Average Train Accuracy: 0.8807
 Site-MNIST                     (3) | Val  Loss: 0.1383 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2317 | Val  Acc: 0.9424
 Site-USPS                      (4) | Val  Loss: 0.3208 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.2649 | Val  Acc: 0.9065
 Site-SynthDigits               (0) | Val  Loss: 0.3199 | Val  Acc: 0.8913
 Site-SynthDigits               (0) | Val  Loss: 0.2993 | Val  Acc: 0.8993
 Site-MNIST_M                   (1) | Val  Loss: 0.4909 | Val  Acc: 0.8478
 Site-MNIST_M                   (1) | Val  Loss: 0.4466 | Val  Acc: 0.8633
 Site-SVHN                      (2) | Val  Loss: 0.6435 | Val  Acc: 0.8043
 Site-SVHN                      (5) | Val  Loss: 0.6472 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8769
 Test site-MNIST                     (3)| Epoch:46 | Test Acc: 0.9407
 Test site-USPS                      (4)| Epoch:46 | Test Acc: 0.9376
 Test site-SynthDigits               (0)| Epoch:46 | Test Acc: 0.9009
 Test site-MNIST_M                   (1)| Epoch:46 | Test Acc: 0.7816
 Test site-SVHN                      (2)| Epoch:46 | Test Acc: 0.7330
MNIST: 0.9407, USPS: 0.9376, SynthDigits: 0.9009, MNIST_M: 0.7816, SVHN: 0.7330, 
Average Test Accuracy(group): 0.8588, Average Test Accuracy(individual): 0.8588,
domain std=0.0854, cluster std=0.0910, individual std=0.0854, 
Average Test Accuracy: 0.8588
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (3) | Train Loss: 0.1713 | Train Acc: 0.9407
 Site-MNIST                     (3) | Train Loss: 0.2217 | Train Acc: 0.9399
 Site-USPS                      (4) | Train Loss: 0.2329 | Train Acc: 0.9326
 Site-USPS                      (4) | Train Loss: 0.2242 | Train Acc: 0.9309
 Site-SynthDigits               (0) | Train Loss: 0.3342 | Train Acc: 0.8976
 Site-SynthDigits               (0) | Train Loss: 0.3088 | Train Acc: 0.9157
 Site-MNIST_M                   (1) | Train Loss: 0.5335 | Train Acc: 0.8221
 Site-MNIST_M                   (1) | Train Loss: 0.4564 | Train Acc: 0.8682
 Site-SVHN                      (2) | Train Loss: 0.7698 | Train Acc: 0.7412
 Site-SVHN                      (5) | Train Loss: 0.6008 | Train Acc: 0.8161
Average Train Accuracy: 0.8805
 Site-MNIST                     (3) | Val  Loss: 0.1354 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2299 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3124 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.2525 | Val  Acc: 0.9137
 Site-SynthDigits               (0) | Val  Loss: 0.3208 | Val  Acc: 0.8804
 Site-SynthDigits               (0) | Val  Loss: 0.2947 | Val  Acc: 0.8957
 Site-MNIST_M                   (1) | Val  Loss: 0.4820 | Val  Acc: 0.8587
 Site-MNIST_M                   (1) | Val  Loss: 0.4420 | Val  Acc: 0.8669
 Site-SVHN                      (2) | Val  Loss: 0.6353 | Val  Acc: 0.8043
 Site-SVHN                      (5) | Val  Loss: 0.6504 | Val  Acc: 0.8022
Average Valid Accuracy: 0.8776
 Test site-MNIST                     (3)| Epoch:47 | Test Acc: 0.9393
 Test site-USPS                      (4)| Epoch:47 | Test Acc: 0.9430
 Test site-SynthDigits               (0)| Epoch:47 | Test Acc: 0.9021
 Test site-MNIST_M                   (1)| Epoch:47 | Test Acc: 0.7819
 Test site-SVHN                      (2)| Epoch:47 | Test Acc: 0.7318
MNIST: 0.9393, USPS: 0.9430, SynthDigits: 0.9021, MNIST_M: 0.7819, SVHN: 0.7318, 
Average Test Accuracy(group): 0.8596, Average Test Accuracy(individual): 0.8596,
domain std=0.0866, cluster std=0.0923, individual std=0.0866, 
Average Test Accuracy: 0.8596
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (0) | Train Loss: 0.1664 | Train Acc: 0.9488
 Site-MNIST                     (0) | Train Loss: 0.2213 | Train Acc: 0.9336
 Site-USPS                      (3) | Train Loss: 0.2347 | Train Acc: 0.9380
 Site-USPS                      (3) | Train Loss: 0.2298 | Train Acc: 0.9247
 Site-SynthDigits               (4) | Train Loss: 0.3263 | Train Acc: 0.8949
 Site-SynthDigits               (4) | Train Loss: 0.2956 | Train Acc: 0.9139
 Site-MNIST_M                   (2) | Train Loss: 0.5261 | Train Acc: 0.8248
 Site-MNIST_M                   (2) | Train Loss: 0.4490 | Train Acc: 0.8601
 Site-SVHN                      (1) | Train Loss: 0.7558 | Train Acc: 0.7574
 Site-SVHN                      (5) | Train Loss: 0.5916 | Train Acc: 0.8278
Average Train Accuracy: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1355 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2319 | Val  Acc: 0.9388
 Site-USPS                      (3) | Val  Loss: 0.3289 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.2694 | Val  Acc: 0.9101
 Site-SynthDigits               (4) | Val  Loss: 0.3066 | Val  Acc: 0.9022
 Site-SynthDigits               (4) | Val  Loss: 0.2915 | Val  Acc: 0.9137
 Site-MNIST_M                   (2) | Val  Loss: 0.4777 | Val  Acc: 0.8478
 Site-MNIST_M                   (2) | Val  Loss: 0.4382 | Val  Acc: 0.8597
 Site-SVHN                      (1) | Val  Loss: 0.6418 | Val  Acc: 0.8261
 Site-SVHN                      (5) | Val  Loss: 0.6382 | Val  Acc: 0.8165
Average Valid Accuracy: 0.8830
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9565
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9388
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.8587
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.9101
 Best site-SynthDigits              (4)  | Epoch:49 | Val Acc: 0.9022
 Best site-SynthDigits              (4)  | Epoch:49 | Val Acc: 0.9137
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8478
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8597
 Best site-SVHN                     (1)  | Epoch:49 | Val Acc: 0.8261
 Best site-SVHN                     (5)  | Epoch:49 | Val Acc: 0.8165
 Test site-MNIST                     (0)| Epoch:49 | Test Acc: 0.9399
 Test site-USPS                      (3)| Epoch:49 | Test Acc: 0.9355
 Test site-SynthDigits               (4)| Epoch:49 | Test Acc: 0.9016
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7844
 Test site-SVHN                      (1)| Epoch:49 | Test Acc: 0.7345
MNIST: 0.9399, USPS: 0.9355, SynthDigits: 0.9016, MNIST_M: 0.7844, SVHN: 0.7345, 
Average Test Accuracy(group): 0.8592, Average Test Accuracy(individual): 0.8592,
domain std=0.0840, cluster std=0.0896, individual std=0.0840, 
Average Test Accuracy: 0.8592
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_0_cluster_6/ccop_q=1...
===2023-08-03 21:24:15===
