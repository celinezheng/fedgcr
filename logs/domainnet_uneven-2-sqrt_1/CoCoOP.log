===2023-04-01 08:12:12===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0086 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9542 | Train Acc: 0.4127
 Site-Clipart   | Train Loss: 1.9030 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.9706 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 2.0847 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 2.0827 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.2138 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.2089 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.1178 | Train Acc: 0.3016
 Site-Painting  | Train Loss: 2.0533 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 2.2939 | Train Acc: 0.0952
 Site-Real      | Train Loss: 1.9927 | Train Acc: 0.3810
 Site-Sketch    | Train Loss: 1.9301 | Train Acc: 0.5079
 Site-Clipart   | Val  Loss: 2.1191 | Val  Acc: 0.3095
 Site-Clipart   | Val  Loss: 1.9790 | Val  Acc: 0.3810
 Site-Clipart   | Val  Loss: 1.8779 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.9160 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.9835 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 2.0149 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1460 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1596 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.2151 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 2.1564 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2787 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 2.0657 | Val  Acc: 0.3810
 Site-Sketch    | Val  Loss: 2.0642 | Val  Acc: 0.3095
Average Valid Accuracy: 0.3480
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3095
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1667
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.3810
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7180 | Train Acc: 0.5079
 Site-Clipart   | Train Loss: 1.6922 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.6007 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.6242 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.8517 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.7817 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 2.1075 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.0001 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.9377 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.7570 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 2.2539 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.6740 | Train Acc: 0.6349
 Site-Sketch    | Train Loss: 1.6165 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.8444 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.6247 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.5517 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5389 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.7064 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.7446 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.9674 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9851 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.0902 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.9305 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.2172 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.7143 | Val  Acc: 0.6190
 Site-Sketch    | Val  Loss: 1.7837 | Val  Acc: 0.6429
Average Valid Accuracy: 0.5201
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.6190
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.4617 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.3712 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.2767 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.3371 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.5531 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.5739 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.9409 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.8729 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.7398 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.5067 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 2.1887 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.3220 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.3592 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.5202 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.3092 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.2530 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2453 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.3773 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3862 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.8113 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.8667 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.9810 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.6281 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.1758 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.4251 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.6026 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5971
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3571
 Best site-Painting   | Epoch:2 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3333
 Best site-Real       | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1745 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1528 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.0873 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.0818 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.3603 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.2917 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.9124 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7781 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.6070 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.2526 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.1177 | Train Acc: 0.2540
 Site-Real      | Train Loss: 1.0856 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.2001 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.2998 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.1533 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.0186 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9894 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.2005 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2589 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6134 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7457 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9036 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.4253 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.1047 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1389 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.4434 | Val  Acc: 0.6905
Average Valid Accuracy: 0.6520
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.0435 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0293 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9294 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8865 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.1665 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.1643 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.8860 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6946 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4727 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.0959 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 2.0349 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.9604 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.0187 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.1628 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.9047 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9024 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8671 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 1.0282 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0666 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.5742 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6342 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8533 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 1.2723 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0536 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.0215 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.2665 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6960
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4048
 Best site-Painting   | Epoch:4 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3095
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.9203 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.8682 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.8094 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.8452 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.0480 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.9885 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.8446 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5899 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4174 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 0.9893 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 2.0301 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.9012 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.9132 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.0303 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.7821 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.8374 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7179 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9319 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.9149 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.5430 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5507 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7711 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.1025 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 2.0315 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8617 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1613 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7070
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3810
 Best site-Painting   | Epoch:5 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3333
 Best site-Real       | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.8458 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 0.8324 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7418 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6903 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9043 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9491 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.7567 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5090 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.4010 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.8939 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.9759 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.7327 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8073 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.9048 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6459 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6599 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6920 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7763 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9005 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4118 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4884 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7700 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.0917 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.9785 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7874 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.1341 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7161
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3571
 Best site-Painting   | Epoch:6 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2857
 Best site-Real       | Epoch:6 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.7554 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7270 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6300 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.6094 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.8103 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8120 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.6952 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.4767 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3042 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.7852 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8830 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.6553 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.7560 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.8076 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6131 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5613 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6238 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7789 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7333 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3850 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4739 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6372 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.0210 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.8948 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6728 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9470 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7381
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4286
 Best site-Painting   | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3571
 Best site-Real       | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.6824 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6490 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6396 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4765 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.7221 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.8058 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.6686 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.3930 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.1768 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.7127 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.8619 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.6327 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6801 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7626 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5722 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5724 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5542 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7189 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7087 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3401 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.3682 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.6128 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.9550 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.9370 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6343 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9822 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7326
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.6228 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6033 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5338 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4875 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.7198 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7698 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.6051 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.3796 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.1452 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.6704 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8576 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.5880 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6526 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.6938 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4425 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4817 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5234 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6483 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.6310 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2753 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.3394 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5572 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.8781 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.8687 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.5404 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8809 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7802
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4524
 Best site-Painting   | Epoch:9 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3095
 Best site-Real       | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-Clipart   | Train Loss: 0.5996 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6045 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5328 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4456 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.6358 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.6555 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.5531 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.3149 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.1413 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.6359 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.7776 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.5036 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.6014 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.6174 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4087 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4329 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4850 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.5564 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6053 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.2753 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.2462 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.5599 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.8044 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.8477 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.5214 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8801 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7821
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:10 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:10 | Val Acc: 0.4524
 Best site-Painting   | Epoch:10 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3333
 Best site-Real       | Epoch:10 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-Clipart   | Train Loss: 0.5170 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5839 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5170 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4140 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.5957 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6505 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.5999 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.3083 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.1699 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.6138 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.7291 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.4906 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5897 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.5788 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3523 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3945 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4590 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.5215 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6181 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1373 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2631 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.5452 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.8168 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.7524 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.4998 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8128 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7784
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-Clipart   | Train Loss: 0.4933 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4843 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4699 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.3459 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.5649 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5881 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.5335 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2871 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0991 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.5435 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.7708 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.4167 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6058 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.5357 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3140 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3199 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4327 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.5701 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5280 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.1910 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2501 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4412 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.7812 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.7671 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.4623 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8297 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7857
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:12 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:12 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:12 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:12 | Val Acc: 0.4762
 Best site-Painting   | Epoch:12 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.3571
 Best site-Real       | Epoch:12 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:12 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-Clipart   | Train Loss: 0.4338 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4629 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4627 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3161 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.5518 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6344 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.5268 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.2146 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0951 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.5536 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.6721 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.4269 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5842 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5107 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3195 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3982 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4214 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4854 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4740 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1783 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2904 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4856 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.7656 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.6803 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4484 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7303 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7949
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:13 | Val Acc: 0.4286
 Best site-Painting   | Epoch:13 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.3810
 Best site-Real       | Epoch:13 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-Clipart   | Train Loss: 0.4465 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.4506 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4305 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3261 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.6096 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.6263 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.4693 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.1411 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.0250 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.4862 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.7235 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.3838 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5581 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.5461 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3230 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3232 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4480 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4889 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5246 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.1353 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1236 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3272 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6194 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.6814 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4485 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.7296 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8132
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:14 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:14 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:14 | Val Acc: 0.5714
 Best site-Painting   | Epoch:14 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.3810
 Best site-Real       | Epoch:14 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:14 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-Clipart   | Train Loss: 0.4298 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4230 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4240 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3259 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4945 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5874 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.4634 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.1497 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0573 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.4547 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.6344 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.3766 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5034 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.4876 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3093 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3210 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3323 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5004 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4500 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.1268 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0678 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3326 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.6989 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.7209 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3715 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7068 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8132
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-Clipart   | Train Loss: 0.4324 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4107 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4102 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3130 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4474 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5650 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.4589 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.0880 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.0307 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.4177 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.5970 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.3968 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4521 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4823 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2660 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3133 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3409 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4283 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5135 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.1072 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.0621 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2305 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.6498 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.7155 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3751 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7507 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8242
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:16 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:16 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:16 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:16 | Val Acc: 0.6190
 Best site-Painting   | Epoch:16 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.4286
 Best site-Real       | Epoch:16 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-Clipart   | Train Loss: 0.3616 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3973 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3635 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2499 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4617 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4761 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.4241 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.0910 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.9555 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.4165 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.5991 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.3614 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4572 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.4761 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2304 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2642 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3490 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4541 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4865 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.0002 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.0552 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3258 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.5810 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.6417 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3158 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7336 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8205
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-Clipart   | Train Loss: 0.3350 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3585 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3875 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2233 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4194 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4966 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.3938 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1163 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.9943 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.3903 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.6029 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.3159 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4355 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.4664 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2529 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3101 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3549 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3856 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3938 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 1.0469 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.0901 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2095 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6025 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.6091 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3514 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6319 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8168
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-Clipart   | Train Loss: 0.3830 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3448 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3597 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2642 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5199 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4486 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.3658 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.0125 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8844 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.3788 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.5272 | Train Acc: 0.4921
 Site-Real      | Train Loss: 0.3110 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4491 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4263 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2582 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2823 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3571 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3595 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3663 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0699 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.0341 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2673 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.6164 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.5915 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.3933 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.6468 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8077
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-Clipart   | Train Loss: 0.3595 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3480 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3133 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2143 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4482 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4696 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.3578 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1199 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9522 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.3256 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.5194 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.2964 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4329 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3744 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2329 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2587 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3293 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3652 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3343 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.9673 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0230 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2418 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.5582 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.5302 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2722 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6792 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8315
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:20 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:20 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:20 | Val Acc: 0.6190
 Best site-Painting   | Epoch:20 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.5000
 Best site-Real       | Epoch:20 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:20 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-Clipart   | Train Loss: 0.3218 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3443 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3162 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2633 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4098 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4296 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.3841 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.0101 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.9990 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.3535 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.4837 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.3076 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3945 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3850 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1927 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2276 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3101 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3455 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3700 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.0034 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 0.9927 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.1338 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.6390 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.5732 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3553 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6019 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8333
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:21 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6905
 Best site-Painting   | Epoch:21 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.5000
 Best site-Real       | Epoch:21 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:21 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-Clipart   | Train Loss: 0.3412 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.2995 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3446 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.1812 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3484 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4020 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.2845 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0103 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.9055 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3346 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.5004 | Train Acc: 0.4921
 Site-Real      | Train Loss: 0.2810 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3716 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4069 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1507 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2280 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2807 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3001 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3628 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.9389 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9941 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1799 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4929 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.5355 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.3365 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6493 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8462
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:22 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:22 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:22 | Val Acc: 0.5714
 Best site-Painting   | Epoch:22 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.5714
 Best site-Real       | Epoch:22 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-Clipart   | Train Loss: 0.2710 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2697 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2886 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1719 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3572 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4479 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.2718 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 0.9607 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8756 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.3075 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.3635 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.2380 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3943 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.3728 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1746 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2752 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2683 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3008 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3748 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9511 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.8900 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1677 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.5155 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4699 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2325 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6735 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8297
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-Clipart   | Train Loss: 0.2586 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2750 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3110 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.2108 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3849 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3904 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.2951 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 0.8909 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8834 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3289 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.3804 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.2614 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3485 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3455 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1852 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2301 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2543 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3081 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3044 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9653 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.9599 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.1911 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.5527 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.4259 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.2647 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6894 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8443
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-Clipart   | Train Loss: 0.2528 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2958 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2431 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1506 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3276 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3738 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.1710 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9418 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8472 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.3155 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.4350 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.2224 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3221 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3494 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1865 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2006 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2588 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3304 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3312 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.9264 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.8730 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0218 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.5856 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4290 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.2918 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6334 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8443
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-Clipart   | Train Loss: 0.2448 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2681 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2960 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1796 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4045 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3754 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.3001 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 0.9245 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8798 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.3153 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.3902 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.2437 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3346 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3086 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1643 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1880 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2522 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2722 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2847 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.9223 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.8525 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0523 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.5540 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.5224 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3080 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.5515 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8462
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-Clipart   | Train Loss: 0.2885 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2883 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2852 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1598 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2961 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3834 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.1644 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.9277 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8097 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2474 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.3969 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.2694 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3247 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3364 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1601 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2231 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3027 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2707 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2432 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.8898 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 0.9081 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 0.9811 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.4937 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.4256 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2925 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6233 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8407
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-Clipart   | Train Loss: 0.2228 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2551 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2722 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.1384 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3532 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3391 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.2223 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.8574 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.8399 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2830 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3069 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.2415 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3464 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.2721 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1846 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1846 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2191 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2590 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2164 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.8791 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.8823 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.0425 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.5186 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4562 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2443 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6515 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8571
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:28 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:28 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:28 | Val Acc: 0.6667
 Best site-Painting   | Epoch:28 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.5714
 Best site-Real       | Epoch:28 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:28 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-Clipart   | Train Loss: 0.2768 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2621 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2635 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1275 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2844 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3703 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.2191 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.8533 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.8825 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.2643 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.3131 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.2079 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2938 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2673 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1466 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1484 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2470 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2578 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2348 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.8522 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 0.8639 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0329 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.5382 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4172 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2475 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5362 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8516
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-Clipart   | Train Loss: 0.2074 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2379 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2346 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1215 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3148 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3371 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.1872 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8088 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.7108 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.2447 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.2644 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.1999 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2931 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3043 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1199 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1592 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2451 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2342 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2519 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7462 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.8169 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0144 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.6125 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.4068 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2335 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6311 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8553
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-Clipart   | Train Loss: 0.2046 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2500 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2646 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.1472 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2825 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3337 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.1749 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8637 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.7073 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.2504 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1996 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.2146 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2906 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.2655 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1084 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2135 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2171 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2265 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2159 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8708 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.7221 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9927 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.4733 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.4533 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2641 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6689 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8681
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:31 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:31 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:31 | Val Acc: 0.7619
 Best site-Painting   | Epoch:31 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.5476
 Best site-Real       | Epoch:31 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:31 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-Clipart   | Train Loss: 0.1965 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2540 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2141 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1178 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2481 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2894 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.0767 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.7441 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.7805 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2299 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.2432 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.1968 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3286 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2968 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0888 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1540 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2084 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2326 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2254 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7893 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.8532 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9900 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.6329 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.2958 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2810 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6660 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8608
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-Clipart   | Train Loss: 0.1934 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2620 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2205 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1221 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2868 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3651 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.1215 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8484 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.7229 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2309 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1526 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.1908 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3137 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.2489 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1149 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1557 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2619 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2142 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2271 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9191 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.7700 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.8865 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.5104 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.4060 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2536 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5528 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8681
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-Clipart   | Train Loss: 0.2102 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2400 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2378 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1365 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2759 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3206 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.0658 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.7760 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.7642 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.2234 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2445 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.2091 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2724 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2609 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.0783 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1283 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2062 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2815 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2593 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7811 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.7846 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9336 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.5497 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.3152 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.2607 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5485 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8645
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-Clipart   | Train Loss: 0.2052 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2248 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2554 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.1350 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2541 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2989 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.0581 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.7581 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.6365 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1960 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.1910 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.2167 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2454 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2623 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0783 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1638 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1961 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1925 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2326 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.8056 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.7392 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.8992 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.4210 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.3136 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2344 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6632 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8828
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:35 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:35 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:35 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:35 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:35 | Val Acc: 0.7381
 Best site-Painting   | Epoch:35 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:35 | Val Acc: 0.5714
 Best site-Real       | Epoch:35 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:35 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-Clipart   | Train Loss: 0.1924 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2094 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1785 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.0733 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2631 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3305 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.0274 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7801 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.6546 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.2449 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2018 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.1903 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2853 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2769 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1433 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1591 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2481 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2717 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2033 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7276 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.7618 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9753 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.4902 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.3366 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2176 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5535 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8736
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-Clipart   | Train Loss: 0.1593 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1766 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2002 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1284 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2861 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2995 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.0093 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.8134 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.7429 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.2221 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1381 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.1742 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2733 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.2131 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0822 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1278 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1622 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2460 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1805 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7439 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.7185 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.8537 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.4876 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.4322 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.1698 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.6072 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8883
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:37 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:37 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:37 | Val Acc: 0.7619
 Best site-Painting   | Epoch:37 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.5000
 Best site-Real       | Epoch:37 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:37 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt_1/CoCoOP...
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-Clipart   | Train Loss: 0.1540 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1849 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2317 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.0905 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2204 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2831 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.0288 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.8086 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 0.7463 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.1694 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.1946 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.1549 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2900 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2574 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.0838 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1312 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2166 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2672 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2253 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7510 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.7149 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.8495 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.4212 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.3312 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.2047 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5684 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8773
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-Clipart   | Train Loss: 0.1576 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2163 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2281 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1079 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2924 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2754 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 0.9977 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.7481 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.6591 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1607 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.1189 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.1779 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2887 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2296 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1394 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1591 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1810 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1936 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1724 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7186 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.6953 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.8280 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.4373 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.3112 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1812 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5163 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8810
===2023-04-01 10:28:47===
===2023-04-01 10:28:49===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:37 | Test Acc: 0.8973
 Test site-Infograph | Epoch:37 | Test Acc: 0.5723
 Test site-Painting  | Epoch:37 | Test Acc: 0.9144
 Test site-QuickDraw | Epoch:37 | Test Acc: 0.5420
 Test site-Real      | Epoch:37 | Test Acc: 0.9359
 Test site-Sketch    | Epoch:37 | Test Acc: 0.8682
Average Test Accuracy: 0.7884
