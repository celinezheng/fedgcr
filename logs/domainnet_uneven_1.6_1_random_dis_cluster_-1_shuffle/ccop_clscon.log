===2023-06-28 21:10:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[16,25,41,65,105,168,269,431,690,1104,42,67,108,173,277,444,710,123,197,315,504,137,220,353,170,273,277,
client_nums=[10,7,4,3,2,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[13, 1, 7, 2, 3, 1, ]
cnt=[10, 7, 1, 2, 3, 4, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Real                      (0) | Train Loss: 1.8078 | Train Acc: 0.6250
 Site-Real                      (5) | Train Loss: 1.7054 | Train Acc: 0.6400
 Site-Real                      (0) | Train Loss: 1.7690 | Train Acc: 0.6341
 Site-Real                      (0) | Train Loss: 1.8079 | Train Acc: 0.6615
 Site-Real                      (0) | Train Loss: 1.6113 | Train Acc: 0.7619
 Site-Real                      (0) | Train Loss: 1.6552 | Train Acc: 0.6964
 Site-Real                      (0) | Train Loss: 1.7100 | Train Acc: 0.6171
 Site-Real                      (0) | Train Loss: 1.6948 | Train Acc: 0.6195
 Site-Real                      (0) | Train Loss: 1.6667 | Train Acc: 0.6478
 Site-Real                      (0) | Train Loss: 1.6561 | Train Acc: 0.6649
 Site-Clipart                   (2) | Train Loss: 1.8905 | Train Acc: 0.3571
 Site-Clipart                   (2) | Train Loss: 2.1376 | Train Acc: 0.4179
 Site-Clipart                   (2) | Train Loss: 1.7706 | Train Acc: 0.5185
 Site-Clipart                   (2) | Train Loss: 1.9384 | Train Acc: 0.4162
 Site-Clipart                   (2) | Train Loss: 1.8889 | Train Acc: 0.4404
 Site-Clipart                   (2) | Train Loss: 1.8948 | Train Acc: 0.4257
 Site-Clipart                   (2) | Train Loss: 1.8719 | Train Acc: 0.4577
 Site-Painting                  (0) | Train Loss: 1.8243 | Train Acc: 0.4878
 Site-Painting                  (0) | Train Loss: 1.7400 | Train Acc: 0.5533
 Site-Painting                  (0) | Train Loss: 1.7597 | Train Acc: 0.5587
 Site-Painting                  (0) | Train Loss: 1.7754 | Train Acc: 0.5417
 Site-Sketch                    (4) | Train Loss: 1.8073 | Train Acc: 0.5036
 Site-Sketch                    (4) | Train Loss: 1.8757 | Train Acc: 0.4409
 Site-Sketch                    (4) | Train Loss: 1.8709 | Train Acc: 0.4788
 Site-Infograph                 (3) | Train Loss: 2.1687 | Train Acc: 0.2412
 Site-Infograph                 (3) | Train Loss: 2.1373 | Train Acc: 0.2674
 Site-QuickDraw                 (1) | Train Loss: 2.3276 | Train Acc: 0.1588
Average Train Accuracy: 0.5124
 Site-Real                      (0) | Val  Loss: 1.6271 | Val  Acc: 0.7000
 Site-Real                      (5) | Val  Loss: 1.4521 | Val  Acc: 0.8235
 Site-Real                      (0) | Val  Loss: 1.6017 | Val  Acc: 0.7778
 Site-Real                      (0) | Val  Loss: 1.6753 | Val  Acc: 0.6744
 Site-Real                      (0) | Val  Loss: 1.5408 | Val  Acc: 0.6429
 Site-Real                      (0) | Val  Loss: 1.6832 | Val  Acc: 0.6250
 Site-Real                      (0) | Val  Loss: 1.6244 | Val  Acc: 0.6927
 Site-Real                      (0) | Val  Loss: 1.6804 | Val  Acc: 0.6516
 Site-Real                      (0) | Val  Loss: 1.6512 | Val  Acc: 0.6457
 Site-Real                      (0) | Val  Loss: 1.6870 | Val  Acc: 0.6549
 Site-Clipart                   (2) | Val  Loss: 1.7645 | Val  Acc: 0.4643
 Site-Clipart                   (2) | Val  Loss: 1.9706 | Val  Acc: 0.3778
 Site-Clipart                   (2) | Val  Loss: 1.8441 | Val  Acc: 0.4167
 Site-Clipart                   (2) | Val  Loss: 1.8921 | Val  Acc: 0.4348
 Site-Clipart                   (2) | Val  Loss: 1.9426 | Val  Acc: 0.3784
 Site-Clipart                   (2) | Val  Loss: 1.9183 | Val  Acc: 0.4189
 Site-Clipart                   (2) | Val  Loss: 1.8927 | Val  Acc: 0.4101
 Site-Painting                  (0) | Val  Loss: 1.8154 | Val  Acc: 0.4512
 Site-Painting                  (0) | Val  Loss: 2.0250 | Val  Acc: 0.5725
 Site-Painting                  (0) | Val  Loss: 1.7934 | Val  Acc: 0.5571
 Site-Painting                  (0) | Val  Loss: 1.7562 | Val  Acc: 0.5417
 Site-Sketch                    (4) | Val  Loss: 1.7414 | Val  Acc: 0.5824
 Site-Sketch                    (4) | Val  Loss: 1.8871 | Val  Acc: 0.5137
 Site-Sketch                    (4) | Val  Loss: 1.8587 | Val  Acc: 0.5021
 Site-Infograph                 (3) | Val  Loss: 2.1499 | Val  Acc: 0.2920
 Site-Infograph                 (3) | Val  Loss: 2.1580 | Val  Acc: 0.2582
 Site-QuickDraw                 (1) | Val  Loss: 2.2880 | Val  Acc: 0.2054
Average Valid Accuracy: 0.5284
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.7000
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.8235
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.7778
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6744
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6429
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6250
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6927
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6516
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6457
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6549
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.4643
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3778
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.4167
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.4348
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3784
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.4189
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.4101
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.4512
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.5725
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.5571
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.5417
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.5824
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.5137
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.5021
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2920
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2582
 Best site-QuickDraw                (1)  | Epoch:0 | Val Acc: 0.2054
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 9, 1, 4, 9, 3, ]
cnt=[4, 7, 2, 3, 10, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Real                      (4) | Train Loss: 1.1438 | Train Acc: 0.8125
 Site-Real                      (4) | Train Loss: 0.9973 | Train Acc: 0.9200
 Site-Real                      (4) | Train Loss: 1.1064 | Train Acc: 0.8537
 Site-Real                      (0) | Train Loss: 0.9820 | Train Acc: 0.8769
 Site-Real                      (4) | Train Loss: 0.9221 | Train Acc: 0.9238
 Site-Real                      (4) | Train Loss: 0.9668 | Train Acc: 0.9286
 Site-Real                      (4) | Train Loss: 1.0411 | Train Acc: 0.8885
 Site-Real                      (4) | Train Loss: 1.0592 | Train Acc: 0.8956
 Site-Real                      (4) | Train Loss: 1.0011 | Train Acc: 0.9116
 Site-Real                      (4) | Train Loss: 0.9998 | Train Acc: 0.9103
 Site-Clipart                   (1) | Train Loss: 1.3805 | Train Acc: 0.6905
 Site-Clipart                   (1) | Train Loss: 1.5142 | Train Acc: 0.5224
 Site-Clipart                   (1) | Train Loss: 1.3199 | Train Acc: 0.6852
 Site-Clipart                   (1) | Train Loss: 1.4824 | Train Acc: 0.6243
 Site-Clipart                   (1) | Train Loss: 1.4507 | Train Acc: 0.6462
 Site-Clipart                   (1) | Train Loss: 1.4730 | Train Acc: 0.6509
 Site-Clipart                   (1) | Train Loss: 1.4655 | Train Acc: 0.6606
 Site-Painting                  (3) | Train Loss: 1.3040 | Train Acc: 0.7073
 Site-Painting                  (3) | Train Loss: 1.3457 | Train Acc: 0.7462
 Site-Painting                  (3) | Train Loss: 1.2300 | Train Acc: 0.7429
 Site-Painting                  (3) | Train Loss: 1.2407 | Train Acc: 0.7738
 Site-Sketch                    (5) | Train Loss: 1.3060 | Train Acc: 0.7372
 Site-Sketch                    (5) | Train Loss: 1.4053 | Train Acc: 0.6455
 Site-Sketch                    (5) | Train Loss: 1.4271 | Train Acc: 0.6572
 Site-Infograph                 (1) | Train Loss: 1.9835 | Train Acc: 0.3765
 Site-Infograph                 (1) | Train Loss: 1.9409 | Train Acc: 0.3370
 Site-QuickDraw                 (2) | Train Loss: 2.2658 | Train Acc: 0.1588
Average Train Accuracy: 0.7142
 Site-Real                      (4) | Val  Loss: 1.1849 | Val  Acc: 0.7000
 Site-Real                      (4) | Val  Loss: 0.7810 | Val  Acc: 0.9412
 Site-Real                      (4) | Val  Loss: 0.9452 | Val  Acc: 0.8889
 Site-Real                      (0) | Val  Loss: 1.0125 | Val  Acc: 0.9070
 Site-Real                      (4) | Val  Loss: 0.8587 | Val  Acc: 0.9429
 Site-Real                      (4) | Val  Loss: 0.9692 | Val  Acc: 0.9375
 Site-Real                      (4) | Val  Loss: 0.9760 | Val  Acc: 0.9218
 Site-Real                      (4) | Val  Loss: 1.0258 | Val  Acc: 0.8990
 Site-Real                      (4) | Val  Loss: 0.9932 | Val  Acc: 0.9087
 Site-Real                      (4) | Val  Loss: 1.0280 | Val  Acc: 0.9049
 Site-Clipart                   (1) | Val  Loss: 1.3105 | Val  Acc: 0.8571
 Site-Clipart                   (1) | Val  Loss: 1.5621 | Val  Acc: 0.5778
 Site-Clipart                   (1) | Val  Loss: 1.4172 | Val  Acc: 0.6250
 Site-Clipart                   (1) | Val  Loss: 1.5191 | Val  Acc: 0.6261
 Site-Clipart                   (1) | Val  Loss: 1.5531 | Val  Acc: 0.6216
 Site-Clipart                   (1) | Val  Loss: 1.5035 | Val  Acc: 0.6081
 Site-Clipart                   (1) | Val  Loss: 1.4724 | Val  Acc: 0.6617
 Site-Painting                  (3) | Val  Loss: 1.1514 | Val  Acc: 0.7805
 Site-Painting                  (3) | Val  Loss: 1.5245 | Val  Acc: 0.7023
 Site-Painting                  (3) | Val  Loss: 1.2531 | Val  Acc: 0.7619
 Site-Painting                  (3) | Val  Loss: 1.2194 | Val  Acc: 0.7708
 Site-Sketch                    (5) | Val  Loss: 1.3200 | Val  Acc: 0.7253
 Site-Sketch                    (5) | Val  Loss: 1.4734 | Val  Acc: 0.6507
 Site-Sketch                    (5) | Val  Loss: 1.4132 | Val  Acc: 0.6511
 Site-Infograph                 (1) | Val  Loss: 1.9359 | Val  Acc: 0.3540
 Site-Infograph                 (1) | Val  Loss: 1.9168 | Val  Acc: 0.3791
 Site-QuickDraw                 (2) | Val  Loss: 2.2294 | Val  Acc: 0.1892
Average Valid Accuracy: 0.7220
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.7000
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.9412
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.8889
 Best site-Real                     (0)  | Epoch:1 | Val Acc: 0.9070
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.9429
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.9375
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.9218
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.8990
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.9087
 Best site-Real                     (4)  | Epoch:1 | Val Acc: 0.9049
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.8571
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.5778
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.6250
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.6261
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.6216
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.6081
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.6617
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.7805
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.7023
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.7619
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.7708
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.7253
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.6507
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.6511
 Best site-Infograph                (1)  | Epoch:1 | Val Acc: 0.3540
 Best site-Infograph                (1)  | Epoch:1 | Val Acc: 0.3791
 Best site-QuickDraw                (2)  | Epoch:1 | Val Acc: 0.1892
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[10, 4, 2, 1, 5, 5, ]
cnt=[4, 10, 7, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Real                      (2) | Train Loss: 0.8077 | Train Acc: 0.8125
 Site-Real                      (2) | Train Loss: 0.6378 | Train Acc: 0.9600
 Site-Real                      (0) | Train Loss: 0.7457 | Train Acc: 0.9024
 Site-Real                      (0) | Train Loss: 0.5862 | Train Acc: 0.9231
 Site-Real                      (0) | Train Loss: 0.6208 | Train Acc: 0.9524
 Site-Real                      (1) | Train Loss: 0.6431 | Train Acc: 0.9524
 Site-Real                      (0) | Train Loss: 0.7558 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.7374 | Train Acc: 0.9234
 Site-Real                      (1) | Train Loss: 0.6865 | Train Acc: 0.9319
 Site-Real                      (0) | Train Loss: 0.6867 | Train Acc: 0.9411
 Site-Clipart                   (4) | Train Loss: 1.0845 | Train Acc: 0.6905
 Site-Clipart                   (4) | Train Loss: 1.2132 | Train Acc: 0.7015
 Site-Clipart                   (5) | Train Loss: 1.0514 | Train Acc: 0.7593
 Site-Clipart                   (5) | Train Loss: 1.1429 | Train Acc: 0.7572
 Site-Clipart                   (4) | Train Loss: 1.1539 | Train Acc: 0.7401
 Site-Clipart                   (4) | Train Loss: 1.1630 | Train Acc: 0.7365
 Site-Clipart                   (4) | Train Loss: 1.1881 | Train Acc: 0.7662
 Site-Painting                  (0) | Train Loss: 0.9721 | Train Acc: 0.7967
 Site-Painting                  (0) | Train Loss: 0.9301 | Train Acc: 0.8325
 Site-Painting                  (0) | Train Loss: 0.9288 | Train Acc: 0.7873
 Site-Painting                  (0) | Train Loss: 0.9006 | Train Acc: 0.8452
 Site-Sketch                    (5) | Train Loss: 1.0325 | Train Acc: 0.7956
 Site-Sketch                    (5) | Train Loss: 1.0791 | Train Acc: 0.7136
 Site-Sketch                    (5) | Train Loss: 1.1335 | Train Acc: 0.6969
 Site-Infograph                 (1) | Train Loss: 1.8161 | Train Acc: 0.3706
 Site-Infograph                 (1) | Train Loss: 1.6652 | Train Acc: 0.4835
 Site-QuickDraw                 (3) | Train Loss: 2.2262 | Train Acc: 0.1986
Average Train Accuracy: 0.7734
 Site-Real                      (2) | Val  Loss: 0.9598 | Val  Acc: 0.7000
 Site-Real                      (2) | Val  Loss: 0.5209 | Val  Acc: 0.8824
 Site-Real                      (0) | Val  Loss: 0.6956 | Val  Acc: 0.8889
 Site-Real                      (0) | Val  Loss: 0.7311 | Val  Acc: 0.9302
 Site-Real                      (0) | Val  Loss: 0.5197 | Val  Acc: 0.9571
 Site-Real                      (1) | Val  Loss: 0.6343 | Val  Acc: 0.9554
 Site-Real                      (0) | Val  Loss: 0.6387 | Val  Acc: 0.9218
 Site-Real                      (0) | Val  Loss: 0.6935 | Val  Acc: 0.9199
 Site-Real                      (1) | Val  Loss: 0.6614 | Val  Acc: 0.9348
 Site-Real                      (0) | Val  Loss: 0.7029 | Val  Acc: 0.9334
 Site-Clipart                   (4) | Val  Loss: 1.0530 | Val  Acc: 0.8929
 Site-Clipart                   (4) | Val  Loss: 1.2720 | Val  Acc: 0.6444
 Site-Clipart                   (5) | Val  Loss: 1.0819 | Val  Acc: 0.7222
 Site-Clipart                   (5) | Val  Loss: 1.2246 | Val  Acc: 0.7391
 Site-Clipart                   (4) | Val  Loss: 1.2389 | Val  Acc: 0.7081
 Site-Clipart                   (4) | Val  Loss: 1.1819 | Val  Acc: 0.7399
 Site-Clipart                   (4) | Val  Loss: 1.1430 | Val  Acc: 0.7484
 Site-Painting                  (0) | Val  Loss: 0.7622 | Val  Acc: 0.8780
 Site-Painting                  (0) | Val  Loss: 1.0772 | Val  Acc: 0.8168
 Site-Painting                  (0) | Val  Loss: 0.9381 | Val  Acc: 0.8333
 Site-Painting                  (0) | Val  Loss: 0.8862 | Val  Acc: 0.8006
 Site-Sketch                    (5) | Val  Loss: 1.0182 | Val  Acc: 0.7582
 Site-Sketch                    (5) | Val  Loss: 1.1807 | Val  Acc: 0.7055
 Site-Sketch                    (5) | Val  Loss: 1.1243 | Val  Acc: 0.7064
 Site-Infograph                 (1) | Val  Loss: 1.6500 | Val  Acc: 0.5133
 Site-Infograph                 (1) | Val  Loss: 1.6508 | Val  Acc: 0.5165
 Site-QuickDraw                 (3) | Val  Loss: 2.1200 | Val  Acc: 0.2432
Average Valid Accuracy: 0.7774
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7000
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.8824
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.8889
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.9302
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.9571
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.9554
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.9218
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.9199
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.9348
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.9334
 Best site-Clipart                  (4)  | Epoch:2 | Val Acc: 0.8929
 Best site-Clipart                  (4)  | Epoch:2 | Val Acc: 0.6444
 Best site-Clipart                  (5)  | Epoch:2 | Val Acc: 0.7222
 Best site-Clipart                  (5)  | Epoch:2 | Val Acc: 0.7391
 Best site-Clipart                  (4)  | Epoch:2 | Val Acc: 0.7081
 Best site-Clipart                  (4)  | Epoch:2 | Val Acc: 0.7399
 Best site-Clipart                  (4)  | Epoch:2 | Val Acc: 0.7484
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.8780
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.8168
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.8333
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.8006
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.7582
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.7055
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.7064
 Best site-Infograph                (1)  | Epoch:2 | Val Acc: 0.5133
 Best site-Infograph                (1)  | Epoch:2 | Val Acc: 0.5165
 Best site-QuickDraw                (3)  | Epoch:2 | Val Acc: 0.2432
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[8, 6, 4, 1, 7, 1, ]
cnt=[10, 7, 3, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Real                      (2) | Train Loss: 0.7052 | Train Acc: 0.8125
 Site-Real                      (5) | Train Loss: 0.5026 | Train Acc: 0.9600
 Site-Real                      (2) | Train Loss: 0.6048 | Train Acc: 0.9268
 Site-Real                      (0) | Train Loss: 0.3635 | Train Acc: 0.9385
 Site-Real                      (0) | Train Loss: 0.4471 | Train Acc: 0.9524
 Site-Real                      (2) | Train Loss: 0.5071 | Train Acc: 0.9464
 Site-Real                      (0) | Train Loss: 0.5721 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.5855 | Train Acc: 0.9304
 Site-Real                      (2) | Train Loss: 0.5264 | Train Acc: 0.9362
 Site-Real                      (0) | Train Loss: 0.5272 | Train Acc: 0.9447
 Site-Clipart                   (4) | Train Loss: 0.8720 | Train Acc: 0.8333
 Site-Clipart                   (4) | Train Loss: 0.8769 | Train Acc: 0.7612
 Site-Clipart                   (1) | Train Loss: 0.9082 | Train Acc: 0.7593
 Site-Clipart                   (1) | Train Loss: 0.9767 | Train Acc: 0.7746
 Site-Clipart                   (4) | Train Loss: 0.9991 | Train Acc: 0.7581
 Site-Clipart                   (1) | Train Loss: 0.9805 | Train Acc: 0.7680
 Site-Clipart                   (4) | Train Loss: 0.9680 | Train Acc: 0.7606
 Site-Painting                  (4) | Train Loss: 0.8011 | Train Acc: 0.8374
 Site-Painting                  (4) | Train Loss: 0.7676 | Train Acc: 0.8223
 Site-Painting                  (4) | Train Loss: 0.7664 | Train Acc: 0.8222
 Site-Painting                  (0) | Train Loss: 0.7281 | Train Acc: 0.8651
 Site-Sketch                    (1) | Train Loss: 0.6964 | Train Acc: 0.8029
 Site-Sketch                    (1) | Train Loss: 0.9784 | Train Acc: 0.7545
 Site-Sketch                    (1) | Train Loss: 0.9794 | Train Acc: 0.7224
 Site-Infograph                 (0) | Train Loss: 1.6642 | Train Acc: 0.4765
 Site-Infograph                 (0) | Train Loss: 1.5635 | Train Acc: 0.5128
 Site-QuickDraw                 (3) | Train Loss: 2.1799 | Train Acc: 0.2166
Average Train Accuracy: 0.7965
 Site-Real                      (2) | Val  Loss: 0.8406 | Val  Acc: 0.8000
 Site-Real                      (5) | Val  Loss: 0.3820 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.5788 | Val  Acc: 0.8519
 Site-Real                      (0) | Val  Loss: 0.5837 | Val  Acc: 0.9302
 Site-Real                      (0) | Val  Loss: 0.4357 | Val  Acc: 0.9714
 Site-Real                      (2) | Val  Loss: 0.4831 | Val  Acc: 0.9554
 Site-Real                      (0) | Val  Loss: 0.5281 | Val  Acc: 0.9162
 Site-Real                      (0) | Val  Loss: 0.5525 | Val  Acc: 0.9303
 Site-Real                      (2) | Val  Loss: 0.5225 | Val  Acc: 0.9304
 Site-Real                      (0) | Val  Loss: 0.5624 | Val  Acc: 0.9375
 Site-Clipart                   (4) | Val  Loss: 0.7982 | Val  Acc: 0.8214
 Site-Clipart                   (4) | Val  Loss: 1.2164 | Val  Acc: 0.6889
 Site-Clipart                   (1) | Val  Loss: 0.9863 | Val  Acc: 0.6667
 Site-Clipart                   (1) | Val  Loss: 0.9960 | Val  Acc: 0.7304
 Site-Clipart                   (4) | Val  Loss: 1.0318 | Val  Acc: 0.7405
 Site-Clipart                   (1) | Val  Loss: 1.0258 | Val  Acc: 0.7669
 Site-Clipart                   (4) | Val  Loss: 0.9390 | Val  Acc: 0.7653
 Site-Painting                  (4) | Val  Loss: 0.6716 | Val  Acc: 0.8415
 Site-Painting                  (4) | Val  Loss: 0.9318 | Val  Acc: 0.8550
 Site-Painting                  (4) | Val  Loss: 0.7568 | Val  Acc: 0.8619
 Site-Painting                  (0) | Val  Loss: 0.7204 | Val  Acc: 0.8393
 Site-Sketch                    (1) | Val  Loss: 0.8452 | Val  Acc: 0.8022
 Site-Sketch                    (1) | Val  Loss: 1.0120 | Val  Acc: 0.7534
 Site-Sketch                    (1) | Val  Loss: 0.9248 | Val  Acc: 0.7532
 Site-Infograph                 (0) | Val  Loss: 1.5319 | Val  Acc: 0.5310
 Site-Infograph                 (0) | Val  Loss: 1.5215 | Val  Acc: 0.5275
 Site-QuickDraw                 (3) | Val  Loss: 2.0548 | Val  Acc: 0.2541
Average Valid Accuracy: 0.7934
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8000
 Best site-Real                     (5)  | Epoch:3 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8519
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.9302
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.9714
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.9554
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.9162
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.9303
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.9304
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.9375
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.8214
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.6889
 Best site-Clipart                  (1)  | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart                  (1)  | Epoch:3 | Val Acc: 0.7304
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.7405
 Best site-Clipart                  (1)  | Epoch:3 | Val Acc: 0.7669
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.7653
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.8415
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.8550
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.8619
 Best site-Painting                 (0)  | Epoch:3 | Val Acc: 0.8393
 Best site-Sketch                   (1)  | Epoch:3 | Val Acc: 0.8022
 Best site-Sketch                   (1)  | Epoch:3 | Val Acc: 0.7534
 Best site-Sketch                   (1)  | Epoch:3 | Val Acc: 0.7532
 Best site-Infograph                (0)  | Epoch:3 | Val Acc: 0.5310
 Best site-Infograph                (0)  | Epoch:3 | Val Acc: 0.5275
 Best site-QuickDraw                (3)  | Epoch:3 | Val Acc: 0.2541
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[7, 4, 2, 7, 1, 6, ]
cnt=[3, 10, 7, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Real                      (2) | Train Loss: 0.6245 | Train Acc: 0.8125
 Site-Real                      (2) | Train Loss: 0.4297 | Train Acc: 0.9600
 Site-Real                      (0) | Train Loss: 0.5203 | Train Acc: 0.9268
 Site-Real                      (3) | Train Loss: 0.2859 | Train Acc: 0.9385
 Site-Real                      (5) | Train Loss: 0.3911 | Train Acc: 0.9619
 Site-Real                      (5) | Train Loss: 0.3982 | Train Acc: 0.9464
 Site-Real                      (5) | Train Loss: 0.5019 | Train Acc: 0.9182
 Site-Real                      (5) | Train Loss: 0.4884 | Train Acc: 0.9397
 Site-Real                      (0) | Train Loss: 0.4621 | Train Acc: 0.9362
 Site-Real                      (5) | Train Loss: 0.4466 | Train Acc: 0.9429
 Site-Clipart                   (3) | Train Loss: 0.7103 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 1.0240 | Train Acc: 0.7761
 Site-Clipart                   (1) | Train Loss: 0.7193 | Train Acc: 0.8333
 Site-Clipart                   (3) | Train Loss: 0.8614 | Train Acc: 0.8208
 Site-Clipart                   (0) | Train Loss: 0.8015 | Train Acc: 0.7834
 Site-Clipart                   (3) | Train Loss: 0.8464 | Train Acc: 0.8221
 Site-Clipart                   (3) | Train Loss: 0.8340 | Train Acc: 0.8127
 Site-Painting                  (0) | Train Loss: 0.7408 | Train Acc: 0.8293
 Site-Painting                  (0) | Train Loss: 0.6171 | Train Acc: 0.8274
 Site-Painting                  (0) | Train Loss: 0.6943 | Train Acc: 0.8381
 Site-Painting                  (3) | Train Loss: 0.6717 | Train Acc: 0.8532
 Site-Sketch                    (1) | Train Loss: 0.8233 | Train Acc: 0.8321
 Site-Sketch                    (1) | Train Loss: 0.8609 | Train Acc: 0.7545
 Site-Sketch                    (1) | Train Loss: 0.8476 | Train Acc: 0.7535
 Site-Infograph                 (3) | Train Loss: 1.6477 | Train Acc: 0.4765
 Site-Infograph                 (5) | Train Loss: 1.4964 | Train Acc: 0.5165
 Site-QuickDraw                 (4) | Train Loss: 2.0414 | Train Acc: 0.2744
Average Train Accuracy: 0.8127
 Site-Real                      (2) | Val  Loss: 0.8634 | Val  Acc: 0.8000
 Site-Real                      (2) | Val  Loss: 0.3090 | Val  Acc: 0.9412
 Site-Real                      (0) | Val  Loss: 0.4688 | Val  Acc: 0.8889
 Site-Real                      (3) | Val  Loss: 0.4308 | Val  Acc: 0.9535
 Site-Real                      (5) | Val  Loss: 0.3300 | Val  Acc: 0.9571
 Site-Real                      (5) | Val  Loss: 0.3816 | Val  Acc: 0.9643
 Site-Real                      (5) | Val  Loss: 0.4177 | Val  Acc: 0.9330
 Site-Real                      (5) | Val  Loss: 0.4787 | Val  Acc: 0.9233
 Site-Real                      (0) | Val  Loss: 0.4604 | Val  Acc: 0.9370
 Site-Real                      (5) | Val  Loss: 0.4705 | Val  Acc: 0.9416
 Site-Clipart                   (3) | Val  Loss: 0.6375 | Val  Acc: 0.8929
 Site-Clipart                   (0) | Val  Loss: 1.0350 | Val  Acc: 0.7111
 Site-Clipart                   (1) | Val  Loss: 0.9074 | Val  Acc: 0.7083
 Site-Clipart                   (3) | Val  Loss: 0.9166 | Val  Acc: 0.7391
 Site-Clipart                   (0) | Val  Loss: 0.9153 | Val  Acc: 0.7784
 Site-Clipart                   (3) | Val  Loss: 0.8818 | Val  Acc: 0.8007
 Site-Clipart                   (3) | Val  Loss: 0.8208 | Val  Acc: 0.8013
 Site-Painting                  (0) | Val  Loss: 0.5830 | Val  Acc: 0.8293
 Site-Painting                  (0) | Val  Loss: 0.8337 | Val  Acc: 0.8779
 Site-Painting                  (0) | Val  Loss: 0.7092 | Val  Acc: 0.8476
 Site-Painting                  (3) | Val  Loss: 0.6511 | Val  Acc: 0.8155
 Site-Sketch                    (1) | Val  Loss: 0.7223 | Val  Acc: 0.8242
 Site-Sketch                    (1) | Val  Loss: 0.8277 | Val  Acc: 0.8288
 Site-Sketch                    (1) | Val  Loss: 0.8517 | Val  Acc: 0.7702
 Site-Infograph                 (3) | Val  Loss: 1.4552 | Val  Acc: 0.5841
 Site-Infograph                 (5) | Val  Loss: 1.4976 | Val  Acc: 0.5714
 Site-QuickDraw                 (4) | Val  Loss: 1.8954 | Val  Acc: 0.3297
Average Valid Accuracy: 0.8130
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8000
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.9412
 Best site-Real                     (0)  | Epoch:4 | Val Acc: 0.8889
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.9535
 Best site-Real                     (5)  | Epoch:4 | Val Acc: 0.9571
 Best site-Real                     (5)  | Epoch:4 | Val Acc: 0.9643
 Best site-Real                     (5)  | Epoch:4 | Val Acc: 0.9330
 Best site-Real                     (5)  | Epoch:4 | Val Acc: 0.9233
 Best site-Real                     (0)  | Epoch:4 | Val Acc: 0.9370
 Best site-Real                     (5)  | Epoch:4 | Val Acc: 0.9416
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.8929
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7111
 Best site-Clipart                  (1)  | Epoch:4 | Val Acc: 0.7083
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.7391
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7784
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.8007
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.8013
 Best site-Painting                 (0)  | Epoch:4 | Val Acc: 0.8293
 Best site-Painting                 (0)  | Epoch:4 | Val Acc: 0.8779
 Best site-Painting                 (0)  | Epoch:4 | Val Acc: 0.8476
 Best site-Painting                 (3)  | Epoch:4 | Val Acc: 0.8155
 Best site-Sketch                   (1)  | Epoch:4 | Val Acc: 0.8242
 Best site-Sketch                   (1)  | Epoch:4 | Val Acc: 0.8288
 Best site-Sketch                   (1)  | Epoch:4 | Val Acc: 0.7702
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.5841
 Best site-Infograph                (5)  | Epoch:4 | Val Acc: 0.5714
 Best site-QuickDraw                (4)  | Epoch:4 | Val Acc: 0.3297
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 6, 5, 9, 1, 5, ]
cnt=[10, 3, 7, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Real                      (2) | Train Loss: 0.5827 | Train Acc: 0.8125
 Site-Real                      (4) | Train Loss: 0.3519 | Train Acc: 0.9600
 Site-Real                      (2) | Train Loss: 0.4346 | Train Acc: 0.9268
 Site-Real                      (5) | Train Loss: 1.3634 | Train Acc: 0.9385
 Site-Real                      (2) | Train Loss: 0.3463 | Train Acc: 0.9619
 Site-Real                      (2) | Train Loss: 0.3518 | Train Acc: 0.9524
 Site-Real                      (3) | Train Loss: 0.4285 | Train Acc: 0.9294
 Site-Real                      (2) | Train Loss: 0.4258 | Train Acc: 0.9420
 Site-Real                      (3) | Train Loss: 0.4116 | Train Acc: 0.9420
 Site-Real                      (3) | Train Loss: 0.3847 | Train Acc: 0.9429
 Site-Clipart                   (1) | Train Loss: 0.6551 | Train Acc: 0.9286
 Site-Clipart                   (3) | Train Loss: 0.8095 | Train Acc: 0.7761
 Site-Clipart                   (1) | Train Loss: 0.6640 | Train Acc: 0.8519
 Site-Clipart                   (1) | Train Loss: 0.7870 | Train Acc: 0.7688
 Site-Clipart                   (5) | Train Loss: 0.7709 | Train Acc: 0.8014
 Site-Clipart                   (5) | Train Loss: 0.7482 | Train Acc: 0.8243
 Site-Clipart                   (5) | Train Loss: 0.7492 | Train Acc: 0.8099
 Site-Painting                  (5) | Train Loss: 0.6827 | Train Acc: 0.8374
 Site-Painting                  (3) | Train Loss: 0.6789 | Train Acc: 0.8477
 Site-Painting                  (3) | Train Loss: 0.6508 | Train Acc: 0.8444
 Site-Painting                  (3) | Train Loss: 0.6241 | Train Acc: 0.8571
 Site-Sketch                    (1) | Train Loss: 0.7565 | Train Acc: 0.8321
 Site-Sketch                    (1) | Train Loss: 0.7500 | Train Acc: 0.7818
 Site-Sketch                    (1) | Train Loss: 0.7531 | Train Acc: 0.7677
 Site-Infograph                 (3) | Train Loss: 1.5265 | Train Acc: 0.4941
 Site-Infograph                 (3) | Train Loss: 1.4415 | Train Acc: 0.5238
 Site-QuickDraw                 (0) | Train Loss: 1.8427 | Train Acc: 0.3899
Average Train Accuracy: 0.8239
 Site-Real                      (2) | Val  Loss: 0.6191 | Val  Acc: 0.9000
 Site-Real                      (4) | Val  Loss: 0.2376 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.4133 | Val  Acc: 0.9259
 Site-Real                      (5) | Val  Loss: 0.3720 | Val  Acc: 0.9535
 Site-Real                      (2) | Val  Loss: 0.2852 | Val  Acc: 0.9571
 Site-Real                      (2) | Val  Loss: 0.3452 | Val  Acc: 0.9464
 Site-Real                      (3) | Val  Loss: 0.3756 | Val  Acc: 0.9553
 Site-Real                      (2) | Val  Loss: 0.4381 | Val  Acc: 0.9199
 Site-Real                      (3) | Val  Loss: 0.3864 | Val  Acc: 0.9348
 Site-Real                      (3) | Val  Loss: 0.4051 | Val  Acc: 0.9524
 Site-Clipart                   (1) | Val  Loss: 0.6299 | Val  Acc: 0.8929
 Site-Clipart                   (3) | Val  Loss: 0.9784 | Val  Acc: 0.6444
 Site-Clipart                   (1) | Val  Loss: 0.8449 | Val  Acc: 0.7639
 Site-Clipart                   (1) | Val  Loss: 0.7908 | Val  Acc: 0.8174
 Site-Clipart                   (5) | Val  Loss: 0.8057 | Val  Acc: 0.8108
 Site-Clipart                   (5) | Val  Loss: 0.8101 | Val  Acc: 0.8176
 Site-Clipart                   (5) | Val  Loss: 0.7511 | Val  Acc: 0.8288
 Site-Painting                  (5) | Val  Loss: 0.5329 | Val  Acc: 0.8537
 Site-Painting                  (3) | Val  Loss: 0.7112 | Val  Acc: 0.8550
 Site-Painting                  (3) | Val  Loss: 0.6435 | Val  Acc: 0.8524
 Site-Painting                  (3) | Val  Loss: 0.6042 | Val  Acc: 0.8363
 Site-Sketch                    (1) | Val  Loss: 0.6409 | Val  Acc: 0.8571
 Site-Sketch                    (1) | Val  Loss: 0.8700 | Val  Acc: 0.7603
 Site-Sketch                    (1) | Val  Loss: 0.8221 | Val  Acc: 0.7787
 Site-Infograph                 (3) | Val  Loss: 1.4300 | Val  Acc: 0.5752
 Site-Infograph                 (3) | Val  Loss: 1.4592 | Val  Acc: 0.5824
 Site-QuickDraw                 (0) | Val  Loss: 1.7419 | Val  Acc: 0.3946
Average Valid Accuracy: 0.8284
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9000
 Best site-Real                     (4)  | Epoch:5 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9259
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.9535
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9571
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9464
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9553
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9199
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9348
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9524
 Best site-Clipart                  (1)  | Epoch:5 | Val Acc: 0.8929
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.6444
 Best site-Clipart                  (1)  | Epoch:5 | Val Acc: 0.7639
 Best site-Clipart                  (1)  | Epoch:5 | Val Acc: 0.8174
 Best site-Clipart                  (5)  | Epoch:5 | Val Acc: 0.8108
 Best site-Clipart                  (5)  | Epoch:5 | Val Acc: 0.8176
 Best site-Clipart                  (5)  | Epoch:5 | Val Acc: 0.8288
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8537
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.8550
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.8524
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.8363
 Best site-Sketch                   (1)  | Epoch:5 | Val Acc: 0.8571
 Best site-Sketch                   (1)  | Epoch:5 | Val Acc: 0.7603
 Best site-Sketch                   (1)  | Epoch:5 | Val Acc: 0.7787
 Best site-Infograph                (3)  | Epoch:5 | Val Acc: 0.5752
 Best site-Infograph                (3)  | Epoch:5 | Val Acc: 0.5824
 Best site-QuickDraw                (0)  | Epoch:5 | Val Acc: 0.3946
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 6 ============
cnt=[5, 10, 1, 7, 1, 3, ]
cnt=[3, 4, 1, 10, 7, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Real                      (2) | Train Loss: 0.5713 | Train Acc: 0.8125
 Site-Real                      (5) | Train Loss: 0.3247 | Train Acc: 0.9600
 Site-Real                      (1) | Train Loss: 0.4177 | Train Acc: 0.9024
 Site-Real                      (3) | Train Loss: 0.3661 | Train Acc: 0.9385
 Site-Real                      (5) | Train Loss: 0.3095 | Train Acc: 0.9619
 Site-Real                      (5) | Train Loss: 0.3606 | Train Acc: 0.9583
 Site-Real                      (1) | Train Loss: 0.3596 | Train Acc: 0.9294
 Site-Real                      (1) | Train Loss: 0.3710 | Train Acc: 0.9443
 Site-Real                      (1) | Train Loss: 0.3611 | Train Acc: 0.9420
 Site-Real                      (1) | Train Loss: 0.3415 | Train Acc: 0.9502
 Site-Clipart                   (0) | Train Loss: 0.5372 | Train Acc: 0.9048
 Site-Clipart                   (1) | Train Loss: 0.4487 | Train Acc: 0.8209
 Site-Clipart                   (3) | Train Loss: 0.5865 | Train Acc: 0.8611
 Site-Clipart                   (0) | Train Loss: 0.6931 | Train Acc: 0.8208
 Site-Clipart                   (3) | Train Loss: 0.7246 | Train Acc: 0.8051
 Site-Clipart                   (3) | Train Loss: 0.7007 | Train Acc: 0.8401
 Site-Clipart                   (3) | Train Loss: 0.6804 | Train Acc: 0.8282
 Site-Painting                  (3) | Train Loss: 0.6434 | Train Acc: 0.8211
 Site-Painting                  (1) | Train Loss: 0.6398 | Train Acc: 0.8122
 Site-Painting                  (1) | Train Loss: 0.5860 | Train Acc: 0.8540
 Site-Painting                  (1) | Train Loss: 0.5828 | Train Acc: 0.8492
 Site-Sketch                    (0) | Train Loss: 0.5462 | Train Acc: 0.8905
 Site-Sketch                    (0) | Train Loss: 0.7239 | Train Acc: 0.7591
 Site-Sketch                    (0) | Train Loss: 0.7655 | Train Acc: 0.7875
 Site-Infograph                 (3) | Train Loss: 1.5505 | Train Acc: 0.5000
 Site-Infograph                 (1) | Train Loss: 1.4151 | Train Acc: 0.5568
 Site-QuickDraw                 (4) | Train Loss: 1.7541 | Train Acc: 0.4116
Average Train Accuracy: 0.8305
 Site-Real                      (2) | Val  Loss: 0.5618 | Val  Acc: 0.9000
 Site-Real                      (5) | Val  Loss: 0.1875 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.3782 | Val  Acc: 0.9259
 Site-Real                      (3) | Val  Loss: 0.3800 | Val  Acc: 0.9070
 Site-Real                      (5) | Val  Loss: 0.2025 | Val  Acc: 0.9714
 Site-Real                      (5) | Val  Loss: 0.2885 | Val  Acc: 0.9554
 Site-Real                      (1) | Val  Loss: 0.3291 | Val  Acc: 0.9441
 Site-Real                      (1) | Val  Loss: 0.3867 | Val  Acc: 0.9164
 Site-Real                      (1) | Val  Loss: 0.3520 | Val  Acc: 0.9457
 Site-Real                      (1) | Val  Loss: 0.3615 | Val  Acc: 0.9484
 Site-Clipart                   (0) | Val  Loss: 0.6050 | Val  Acc: 0.8929
 Site-Clipart                   (1) | Val  Loss: 0.9113 | Val  Acc: 0.7111
 Site-Clipart                   (3) | Val  Loss: 0.7020 | Val  Acc: 0.7917
 Site-Clipart                   (0) | Val  Loss: 0.7716 | Val  Acc: 0.8087
 Site-Clipart                   (3) | Val  Loss: 0.7600 | Val  Acc: 0.8324
 Site-Clipart                   (3) | Val  Loss: 0.7353 | Val  Acc: 0.8277
 Site-Clipart                   (3) | Val  Loss: 0.6682 | Val  Acc: 0.8203
 Site-Painting                  (3) | Val  Loss: 0.4120 | Val  Acc: 0.8902
 Site-Painting                  (1) | Val  Loss: 0.7158 | Val  Acc: 0.8702
 Site-Painting                  (1) | Val  Loss: 0.5959 | Val  Acc: 0.8619
 Site-Painting                  (1) | Val  Loss: 0.5596 | Val  Acc: 0.8571
 Site-Sketch                    (0) | Val  Loss: 0.6972 | Val  Acc: 0.8132
 Site-Sketch                    (0) | Val  Loss: 0.8011 | Val  Acc: 0.7671
 Site-Sketch                    (0) | Val  Loss: 0.7411 | Val  Acc: 0.8000
 Site-Infograph                 (3) | Val  Loss: 1.4293 | Val  Acc: 0.5752
 Site-Infograph                 (1) | Val  Loss: 1.3608 | Val  Acc: 0.6319
 Site-QuickDraw                 (4) | Val  Loss: 1.6760 | Val  Acc: 0.4216
Average Valid Accuracy: 0.8366
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.9000
 Best site-Real                     (5)  | Epoch:6 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9259
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.9070
 Best site-Real                     (5)  | Epoch:6 | Val Acc: 0.9714
 Best site-Real                     (5)  | Epoch:6 | Val Acc: 0.9554
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9441
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9164
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9457
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9484
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8929
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.7111
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.7917
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8087
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.8324
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.8277
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.8203
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8902
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8702
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8619
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8571
 Best site-Sketch                   (0)  | Epoch:6 | Val Acc: 0.8132
 Best site-Sketch                   (0)  | Epoch:6 | Val Acc: 0.7671
 Best site-Sketch                   (0)  | Epoch:6 | Val Acc: 0.8000
 Best site-Infograph                (3)  | Epoch:6 | Val Acc: 0.5752
 Best site-Infograph                (1)  | Epoch:6 | Val Acc: 0.6319
 Best site-QuickDraw                (4)  | Epoch:6 | Val Acc: 0.4216
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 4, 9, 1, 8, 3, ]
cnt=[7, 4, 1, 10, 2, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Real                      (0) | Train Loss: 0.5650 | Train Acc: 0.8125
 Site-Real                      (4) | Train Loss: 0.2516 | Train Acc: 0.9600
 Site-Real                      (0) | Train Loss: 0.3545 | Train Acc: 0.9512
 Site-Real                      (2) | Train Loss: 0.2090 | Train Acc: 0.9385
 Site-Real                      (4) | Train Loss: 0.2499 | Train Acc: 0.9619
 Site-Real                      (4) | Train Loss: 0.2762 | Train Acc: 0.9643
 Site-Real                      (2) | Train Loss: 0.3481 | Train Acc: 0.9442
 Site-Real                      (4) | Train Loss: 0.3388 | Train Acc: 0.9490
 Site-Real                      (4) | Train Loss: 0.3350 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.3006 | Train Acc: 0.9457
 Site-Clipart                   (1) | Train Loss: 0.5233 | Train Acc: 0.8810
 Site-Clipart                   (4) | Train Loss: 1.1277 | Train Acc: 0.8358
 Site-Clipart                   (5) | Train Loss: 0.6105 | Train Acc: 0.8519
 Site-Clipart                   (1) | Train Loss: 0.6907 | Train Acc: 0.8324
 Site-Clipart                   (4) | Train Loss: 0.7524 | Train Acc: 0.8014
 Site-Clipart                   (1) | Train Loss: 0.6936 | Train Acc: 0.8288
 Site-Clipart                   (2) | Train Loss: 0.6900 | Train Acc: 0.8113
 Site-Painting                  (2) | Train Loss: 0.6089 | Train Acc: 0.8455
 Site-Painting                  (2) | Train Loss: 0.5049 | Train Acc: 0.8426
 Site-Painting                  (4) | Train Loss: 0.5574 | Train Acc: 0.8571
 Site-Painting                  (2) | Train Loss: 0.5314 | Train Acc: 0.8671
 Site-Sketch                    (5) | Train Loss: 0.6138 | Train Acc: 0.8175
 Site-Sketch                    (1) | Train Loss: 0.7614 | Train Acc: 0.7727
 Site-Sketch                    (5) | Train Loss: 0.7024 | Train Acc: 0.7790
 Site-Infograph                 (2) | Train Loss: 1.5152 | Train Acc: 0.5412
 Site-Infograph                 (2) | Train Loss: 1.4530 | Train Acc: 0.5531
 Site-QuickDraw                 (3) | Train Loss: 1.6364 | Train Acc: 0.4693
Average Train Accuracy: 0.8355
 Site-Real                      (0) | Val  Loss: 0.7325 | Val  Acc: 0.8000
 Site-Real                      (4) | Val  Loss: 0.1653 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.3934 | Val  Acc: 0.8889
 Site-Real                      (2) | Val  Loss: 0.3008 | Val  Acc: 0.9535
 Site-Real                      (4) | Val  Loss: 0.1731 | Val  Acc: 0.9714
 Site-Real                      (4) | Val  Loss: 0.2700 | Val  Acc: 0.9464
 Site-Real                      (2) | Val  Loss: 0.2735 | Val  Acc: 0.9553
 Site-Real                      (4) | Val  Loss: 0.3528 | Val  Acc: 0.9199
 Site-Real                      (4) | Val  Loss: 0.3058 | Val  Acc: 0.9500
 Site-Real                      (2) | Val  Loss: 0.3359 | Val  Acc: 0.9443
 Site-Clipart                   (1) | Val  Loss: 0.5907 | Val  Acc: 0.8929
 Site-Clipart                   (4) | Val  Loss: 0.8513 | Val  Acc: 0.7111
 Site-Clipart                   (5) | Val  Loss: 0.7900 | Val  Acc: 0.7361
 Site-Clipart                   (1) | Val  Loss: 0.7278 | Val  Acc: 0.7913
 Site-Clipart                   (4) | Val  Loss: 0.7624 | Val  Acc: 0.7946
 Site-Clipart                   (1) | Val  Loss: 0.7074 | Val  Acc: 0.8378
 Site-Clipart                   (2) | Val  Loss: 0.6475 | Val  Acc: 0.8351
 Site-Painting                  (2) | Val  Loss: 0.4188 | Val  Acc: 0.8537
 Site-Painting                  (2) | Val  Loss: 0.6441 | Val  Acc: 0.8626
 Site-Painting                  (4) | Val  Loss: 0.5444 | Val  Acc: 0.8714
 Site-Painting                  (2) | Val  Loss: 0.5077 | Val  Acc: 0.8780
 Site-Sketch                    (5) | Val  Loss: 0.5863 | Val  Acc: 0.8132
 Site-Sketch                    (1) | Val  Loss: 0.7326 | Val  Acc: 0.8288
 Site-Sketch                    (5) | Val  Loss: 0.7053 | Val  Acc: 0.7957
 Site-Infograph                 (2) | Val  Loss: 1.3771 | Val  Acc: 0.5487
 Site-Infograph                 (2) | Val  Loss: 1.3490 | Val  Acc: 0.5769
 Site-QuickDraw                 (3) | Val  Loss: 1.5786 | Val  Acc: 0.5243
Average Valid Accuracy: 0.8327
============ Train epoch 8 ============
===2023-06-28 22:15:34===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[8,12,20,32,52,84,134,215,345,552,21,33,54,86,138,222,355,61,98,157,252,68,110,176,85,136,138,
client_nums=[10,7,4,3,2,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[13, 1, 7, 2, 3, 1, ]
cnt=[10, 7, 1, 2, 3, 4, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Real                      (0) | Train Loss: 1.8649 | Train Acc: 0.3750
 Site-Real                      (5) | Train Loss: 2.1175 | Train Acc: 0.5833
 Site-Real                      (0) | Train Loss: 1.9317 | Train Acc: 0.4500
 Site-Real                      (0) | Train Loss: 2.0617 | Train Acc: 0.4688
 Site-Real                      (0) | Train Loss: 2.0130 | Train Acc: 0.4038
 Site-Real                      (0) | Train Loss: 2.0399 | Train Acc: 0.4286
 Site-Real                      (0) | Train Loss: 2.0747 | Train Acc: 0.4403
 Site-Real                      (0) | Train Loss: 2.0053 | Train Acc: 0.4326
 Site-Real                      (0) | Train Loss: 2.0398 | Train Acc: 0.4087
 Site-Real                      (0) | Train Loss: 2.0163 | Train Acc: 0.4529
 Site-Clipart                   (2) | Train Loss: 2.0881 | Train Acc: 0.4286
 Site-Clipart                   (2) | Train Loss: 2.0885 | Train Acc: 0.3636
 Site-Clipart                   (2) | Train Loss: 2.1103 | Train Acc: 0.2778
 Site-Clipart                   (2) | Train Loss: 2.0206 | Train Acc: 0.3721
 Site-Clipart                   (2) | Train Loss: 2.0948 | Train Acc: 0.3188
 Site-Clipart                   (2) | Train Loss: 2.1270 | Train Acc: 0.2658
 Site-Clipart                   (2) | Train Loss: 2.0751 | Train Acc: 0.3211
 Site-Painting                  (0) | Train Loss: 2.1037 | Train Acc: 0.3607
 Site-Painting                  (0) | Train Loss: 2.0755 | Train Acc: 0.3469
 Site-Painting                  (0) | Train Loss: 2.1536 | Train Acc: 0.3248
 Site-Painting                  (0) | Train Loss: 2.1195 | Train Acc: 0.3373
 Site-Sketch                    (4) | Train Loss: 2.1078 | Train Acc: 0.4118
 Site-Sketch                    (4) | Train Loss: 2.0452 | Train Acc: 0.3545
 Site-Sketch                    (4) | Train Loss: 2.1001 | Train Acc: 0.3580
 Site-Infograph                 (3) | Train Loss: 2.2753 | Train Acc: 0.1647
 Site-Infograph                 (3) | Train Loss: 2.2990 | Train Acc: 0.1471
 Site-QuickDraw                 (1) | Train Loss: 2.3309 | Train Acc: 0.1232
Average Train Accuracy: 0.3600
 Site-Real                      (0) | Val  Loss: 1.7546 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 1.8331 | Val  Acc: 0.8750
 Site-Real                      (0) | Val  Loss: 1.9341 | Val  Acc: 0.6923
 Site-Real                      (0) | Val  Loss: 2.0888 | Val  Acc: 0.3333
 Site-Real                      (0) | Val  Loss: 2.0585 | Val  Acc: 0.4000
 Site-Real                      (0) | Val  Loss: 1.9835 | Val  Acc: 0.4821
 Site-Real                      (0) | Val  Loss: 1.9829 | Val  Acc: 0.3933
 Site-Real                      (0) | Val  Loss: 2.0682 | Val  Acc: 0.3357
 Site-Real                      (0) | Val  Loss: 2.0610 | Val  Acc: 0.3712
 Site-Real                      (0) | Val  Loss: 2.0218 | Val  Acc: 0.4251
 Site-Clipart                   (2) | Val  Loss: 2.1296 | Val  Acc: 0.2857
 Site-Clipart                   (2) | Val  Loss: 2.0332 | Val  Acc: 0.4091
 Site-Clipart                   (2) | Val  Loss: 2.0600 | Val  Acc: 0.3333
 Site-Clipart                   (2) | Val  Loss: 2.0548 | Val  Acc: 0.3684
 Site-Clipart                   (2) | Val  Loss: 2.0779 | Val  Acc: 0.3261
 Site-Clipart                   (2) | Val  Loss: 2.1363 | Val  Acc: 0.2500
 Site-Clipart                   (2) | Val  Loss: 2.1457 | Val  Acc: 0.2669
 Site-Painting                  (0) | Val  Loss: 2.1923 | Val  Acc: 0.3415
 Site-Painting                  (0) | Val  Loss: 2.1353 | Val  Acc: 0.2615
 Site-Painting                  (0) | Val  Loss: 2.1100 | Val  Acc: 0.3524
 Site-Painting                  (0) | Val  Loss: 2.1145 | Val  Acc: 0.3095
 Site-Sketch                    (4) | Val  Loss: 2.1467 | Val  Acc: 0.2667
 Site-Sketch                    (4) | Val  Loss: 2.1540 | Val  Acc: 0.1918
 Site-Sketch                    (4) | Val  Loss: 2.1008 | Val  Acc: 0.3333
 Site-Infograph                 (3) | Val  Loss: 2.2416 | Val  Acc: 0.1250
 Site-Infograph                 (3) | Val  Loss: 2.2374 | Val  Acc: 0.0989
 Site-QuickDraw                 (1) | Val  Loss: 2.3376 | Val  Acc: 0.0978
Average Valid Accuracy: 0.3676
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 1.0000
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.8750
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.6923
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4000
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4821
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3933
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3357
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3712
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4251
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.2857
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.4091
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3684
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3261
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.2669
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.3415
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.2615
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.3524
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.3095
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.2667
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.1918
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.1250
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.0989
 Best site-QuickDraw                (1)  | Epoch:0 | Val Acc: 0.0978
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 9, 1, 12, 3, 1, ]
cnt=[1, 7, 13, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Real                      (5) | Train Loss: 1.5543 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 1.7453 | Train Acc: 0.5000
 Site-Real                      (3) | Train Loss: 1.5508 | Train Acc: 0.8500
 Site-Real                      (0) | Train Loss: 1.6545 | Train Acc: 0.6562
 Site-Real                      (3) | Train Loss: 1.6743 | Train Acc: 0.6731
 Site-Real                      (3) | Train Loss: 1.6029 | Train Acc: 0.7262
 Site-Real                      (3) | Train Loss: 1.6426 | Train Acc: 0.6343
 Site-Real                      (3) | Train Loss: 1.6211 | Train Acc: 0.7163
 Site-Real                      (3) | Train Loss: 1.6758 | Train Acc: 0.6551
 Site-Real                      (3) | Train Loss: 1.6084 | Train Acc: 0.7138
 Site-Clipart                   (1) | Train Loss: 1.8279 | Train Acc: 0.5714
 Site-Clipart                   (1) | Train Loss: 1.9584 | Train Acc: 0.3636
 Site-Clipart                   (1) | Train Loss: 1.9511 | Train Acc: 0.3889
 Site-Clipart                   (1) | Train Loss: 1.7977 | Train Acc: 0.4884
 Site-Clipart                   (1) | Train Loss: 1.9372 | Train Acc: 0.4638
 Site-Clipart                   (1) | Train Loss: 1.9184 | Train Acc: 0.3964
 Site-Clipart                   (1) | Train Loss: 1.8706 | Train Acc: 0.4254
 Site-Painting                  (3) | Train Loss: 1.8628 | Train Acc: 0.4262
 Site-Painting                  (3) | Train Loss: 1.7478 | Train Acc: 0.5204
 Site-Painting                  (3) | Train Loss: 1.8577 | Train Acc: 0.4713
 Site-Painting                  (3) | Train Loss: 1.8077 | Train Acc: 0.4960
 Site-Sketch                    (4) | Train Loss: 1.7279 | Train Acc: 0.5147
 Site-Sketch                    (4) | Train Loss: 1.8384 | Train Acc: 0.4273
 Site-Sketch                    (4) | Train Loss: 1.9005 | Train Acc: 0.4148
 Site-Infograph                 (1) | Train Loss: 2.2870 | Train Acc: 0.2235
 Site-Infograph                 (1) | Train Loss: 2.1680 | Train Acc: 0.2059
 Site-QuickDraw                 (2) | Train Loss: 2.2850 | Train Acc: 0.1522
Average Train Accuracy: 0.5120
 Site-Real                      (5) | Val  Loss: 1.3604 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 1.3849 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 1.4904 | Val  Acc: 0.9231
 Site-Real                      (0) | Val  Loss: 1.6672 | Val  Acc: 0.6667
 Site-Real                      (3) | Val  Loss: 1.6821 | Val  Acc: 0.7143
 Site-Real                      (3) | Val  Loss: 1.5813 | Val  Acc: 0.7321
 Site-Real                      (3) | Val  Loss: 1.6316 | Val  Acc: 0.6517
 Site-Real                      (3) | Val  Loss: 1.6903 | Val  Acc: 0.6294
 Site-Real                      (3) | Val  Loss: 1.6723 | Val  Acc: 0.6507
 Site-Real                      (3) | Val  Loss: 1.6302 | Val  Acc: 0.6839
 Site-Clipart                   (1) | Val  Loss: 1.9520 | Val  Acc: 0.4286
 Site-Clipart                   (1) | Val  Loss: 1.7019 | Val  Acc: 0.4545
 Site-Clipart                   (1) | Val  Loss: 1.8477 | Val  Acc: 0.4444
 Site-Clipart                   (1) | Val  Loss: 1.8498 | Val  Acc: 0.4386
 Site-Clipart                   (1) | Val  Loss: 1.8645 | Val  Acc: 0.3804
 Site-Clipart                   (1) | Val  Loss: 1.9450 | Val  Acc: 0.3919
 Site-Clipart                   (1) | Val  Loss: 1.9569 | Val  Acc: 0.3729
 Site-Painting                  (3) | Val  Loss: 1.9276 | Val  Acc: 0.3659
 Site-Painting                  (3) | Val  Loss: 1.7481 | Val  Acc: 0.4462
 Site-Painting                  (3) | Val  Loss: 1.7921 | Val  Acc: 0.4762
 Site-Painting                  (3) | Val  Loss: 1.7758 | Val  Acc: 0.4762
 Site-Sketch                    (4) | Val  Loss: 1.9721 | Val  Acc: 0.3556
 Site-Sketch                    (4) | Val  Loss: 2.0203 | Val  Acc: 0.2603
 Site-Sketch                    (4) | Val  Loss: 1.9313 | Val  Acc: 0.3504
 Site-Infograph                 (1) | Val  Loss: 2.2253 | Val  Acc: 0.2321
 Site-Infograph                 (1) | Val  Loss: 2.1959 | Val  Acc: 0.1648
 Site-QuickDraw                 (2) | Val  Loss: 2.3043 | Val  Acc: 0.1304
Average Valid Accuracy: 0.5119
 Best site-Real                     (5)  | Epoch:1 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.9231
 Best site-Real                     (0)  | Epoch:1 | Val Acc: 0.6667
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.7143
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.7321
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.6517
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.6294
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.6507
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.6839
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.4286
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.4545
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.4444
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.4386
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.3804
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.3919
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.3729
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.3659
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.4462
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.4762
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.4762
 Best site-Sketch                   (4)  | Epoch:1 | Val Acc: 0.3556
 Best site-Sketch                   (4)  | Epoch:1 | Val Acc: 0.2603
 Best site-Sketch                   (4)  | Epoch:1 | Val Acc: 0.3504
 Best site-Infograph                (1)  | Epoch:1 | Val Acc: 0.2321
 Best site-Infograph                (1)  | Epoch:1 | Val Acc: 0.1648
 Best site-QuickDraw                (2)  | Epoch:1 | Val Acc: 0.1304
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[4, 10, 1, 9, 2, 1, ]
cnt=[4, 3, 2, 1, 10, 7, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Real                      (3) | Train Loss: 1.4371 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 1.3883 | Train Acc: 0.7500
 Site-Real                      (5) | Train Loss: 1.2595 | Train Acc: 0.9000
 Site-Real                      (3) | Train Loss: 1.3964 | Train Acc: 0.8125
 Site-Real                      (3) | Train Loss: 1.3918 | Train Acc: 0.7885
 Site-Real                      (3) | Train Loss: 1.2343 | Train Acc: 0.8690
 Site-Real                      (3) | Train Loss: 1.2014 | Train Acc: 0.8134
 Site-Real                      (3) | Train Loss: 1.2688 | Train Acc: 0.8744
 Site-Real                      (3) | Train Loss: 1.3790 | Train Acc: 0.8145
 Site-Real                      (3) | Train Loss: 1.3005 | Train Acc: 0.8678
 Site-Clipart                   (1) | Train Loss: 1.6834 | Train Acc: 0.5714
 Site-Clipart                   (1) | Train Loss: 1.6888 | Train Acc: 0.5152
 Site-Clipart                   (1) | Train Loss: 1.7750 | Train Acc: 0.6111
 Site-Clipart                   (1) | Train Loss: 1.6868 | Train Acc: 0.5698
 Site-Clipart                   (1) | Train Loss: 1.6125 | Train Acc: 0.5290
 Site-Clipart                   (1) | Train Loss: 1.7309 | Train Acc: 0.5315
 Site-Clipart                   (1) | Train Loss: 1.6701 | Train Acc: 0.6113
 Site-Painting                  (0) | Train Loss: 1.5814 | Train Acc: 0.6393
 Site-Painting                  (0) | Train Loss: 1.5138 | Train Acc: 0.6735
 Site-Painting                  (0) | Train Loss: 1.6017 | Train Acc: 0.6369
 Site-Painting                  (0) | Train Loss: 1.5338 | Train Acc: 0.6587
 Site-Sketch                    (1) | Train Loss: 1.3612 | Train Acc: 0.6029
 Site-Sketch                    (1) | Train Loss: 1.6439 | Train Acc: 0.5909
 Site-Sketch                    (1) | Train Loss: 1.7187 | Train Acc: 0.5284
 Site-Infograph                 (4) | Train Loss: 2.2050 | Train Acc: 0.2235
 Site-Infograph                 (4) | Train Loss: 2.1866 | Train Acc: 0.3088
 Site-QuickDraw                 (2) | Train Loss: 2.2744 | Train Acc: 0.1449
Average Train Accuracy: 0.6366
 Site-Real                      (3) | Val  Loss: 0.8264 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 1.1034 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 1.1975 | Val  Acc: 0.9231
 Site-Real                      (3) | Val  Loss: 1.3086 | Val  Acc: 0.9048
 Site-Real                      (3) | Val  Loss: 1.3803 | Val  Acc: 0.8857
 Site-Real                      (3) | Val  Loss: 1.3117 | Val  Acc: 0.8750
 Site-Real                      (3) | Val  Loss: 1.3373 | Val  Acc: 0.8315
 Site-Real                      (3) | Val  Loss: 1.4079 | Val  Acc: 0.7902
 Site-Real                      (3) | Val  Loss: 1.3594 | Val  Acc: 0.8341
 Site-Real                      (3) | Val  Loss: 1.3369 | Val  Acc: 0.8283
 Site-Clipart                   (1) | Val  Loss: 1.8161 | Val  Acc: 0.5714
 Site-Clipart                   (1) | Val  Loss: 1.5435 | Val  Acc: 0.6818
 Site-Clipart                   (1) | Val  Loss: 1.6886 | Val  Acc: 0.5556
 Site-Clipart                   (1) | Val  Loss: 1.7252 | Val  Acc: 0.4912
 Site-Clipart                   (1) | Val  Loss: 1.7390 | Val  Acc: 0.5109
 Site-Clipart                   (1) | Val  Loss: 1.7165 | Val  Acc: 0.5338
 Site-Clipart                   (1) | Val  Loss: 1.7408 | Val  Acc: 0.5424
 Site-Painting                  (0) | Val  Loss: 1.7196 | Val  Acc: 0.5610
 Site-Painting                  (0) | Val  Loss: 1.6453 | Val  Acc: 0.5692
 Site-Painting                  (0) | Val  Loss: 1.5319 | Val  Acc: 0.6762
 Site-Painting                  (0) | Val  Loss: 1.5204 | Val  Acc: 0.6607
 Site-Sketch                    (1) | Val  Loss: 1.8033 | Val  Acc: 0.5111
 Site-Sketch                    (1) | Val  Loss: 1.8654 | Val  Acc: 0.3836
 Site-Sketch                    (1) | Val  Loss: 1.7127 | Val  Acc: 0.5128
 Site-Infograph                 (4) | Val  Loss: 2.0683 | Val  Acc: 0.2857
 Site-Infograph                 (4) | Val  Loss: 2.0383 | Val  Acc: 0.3297
 Site-QuickDraw                 (2) | Val  Loss: 2.2957 | Val  Acc: 0.0978
Average Valid Accuracy: 0.6425
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 1.0000
 Best site-Real                     (5)  | Epoch:2 | Val Acc: 0.9231
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.9048
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.8857
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.8750
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.8315
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.7902
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.8341
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.8283
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.5714
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.6818
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.5556
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.4912
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.5109
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.5338
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.5424
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.5610
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.5692
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.6762
 Best site-Painting                 (0)  | Epoch:2 | Val Acc: 0.6607
 Best site-Sketch                   (1)  | Epoch:2 | Val Acc: 0.5111
 Best site-Sketch                   (1)  | Epoch:2 | Val Acc: 0.3836
 Best site-Sketch                   (1)  | Epoch:2 | Val Acc: 0.5128
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.2857
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.3297
 Best site-QuickDraw                (2)  | Epoch:2 | Val Acc: 0.0978
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[9, 10, 2, 1, 4, 1, ]
cnt=[10, 4, 1, 4, 2, 6, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Real                      (5) | Train Loss: 1.0780 | Train Acc: 0.7500
 Site-Real                      (0) | Train Loss: 1.1306 | Train Acc: 0.9167
 Site-Real                      (0) | Train Loss: 1.0158 | Train Acc: 0.9500
 Site-Real                      (0) | Train Loss: 1.1719 | Train Acc: 0.8438
 Site-Real                      (0) | Train Loss: 1.1376 | Train Acc: 0.9038
 Site-Real                      (0) | Train Loss: 0.9145 | Train Acc: 0.9405
 Site-Real                      (0) | Train Loss: 1.1433 | Train Acc: 0.8582
 Site-Real                      (0) | Train Loss: 1.0453 | Train Acc: 0.8884
 Site-Real                      (0) | Train Loss: 1.1600 | Train Acc: 0.8725
 Site-Real                      (0) | Train Loss: 1.0644 | Train Acc: 0.9058
 Site-Clipart                   (1) | Train Loss: 1.5282 | Train Acc: 0.6190
 Site-Clipart                   (1) | Train Loss: 1.5019 | Train Acc: 0.6061
 Site-Clipart                   (1) | Train Loss: 1.6302 | Train Acc: 0.5741
 Site-Clipart                   (1) | Train Loss: 1.4187 | Train Acc: 0.6977
 Site-Clipart                   (1) | Train Loss: 1.5225 | Train Acc: 0.6594
 Site-Clipart                   (1) | Train Loss: 1.5541 | Train Acc: 0.6171
 Site-Clipart                   (1) | Train Loss: 1.5149 | Train Acc: 0.6507
 Site-Painting                  (4) | Train Loss: 1.3687 | Train Acc: 0.7377
 Site-Painting                  (4) | Train Loss: 1.2505 | Train Acc: 0.7143
 Site-Painting                  (4) | Train Loss: 1.3833 | Train Acc: 0.7197
 Site-Painting                  (4) | Train Loss: 1.3243 | Train Acc: 0.7143
 Site-Sketch                    (1) | Train Loss: 1.2669 | Train Acc: 0.6324
 Site-Sketch                    (1) | Train Loss: 1.3965 | Train Acc: 0.7000
 Site-Sketch                    (1) | Train Loss: 1.5494 | Train Acc: 0.6193
 Site-Infograph                 (2) | Train Loss: 2.1216 | Train Acc: 0.3412
 Site-Infograph                 (2) | Train Loss: 1.9696 | Train Acc: 0.3309
 Site-QuickDraw                 (3) | Train Loss: 2.2648 | Train Acc: 0.1667
Average Train Accuracy: 0.7011
 Site-Real                      (5) | Val  Loss: 0.6555 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.9112 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.8943 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 1.0197 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 1.1148 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 1.0254 | Val  Acc: 0.9464
 Site-Real                      (0) | Val  Loss: 1.0988 | Val  Acc: 0.8539
 Site-Real                      (0) | Val  Loss: 1.2011 | Val  Acc: 0.8531
 Site-Real                      (0) | Val  Loss: 1.1076 | Val  Acc: 0.8996
 Site-Real                      (0) | Val  Loss: 1.0755 | Val  Acc: 0.8828
 Site-Clipart                   (1) | Val  Loss: 1.5947 | Val  Acc: 0.7143
 Site-Clipart                   (1) | Val  Loss: 1.2999 | Val  Acc: 0.7727
 Site-Clipart                   (1) | Val  Loss: 1.5205 | Val  Acc: 0.5833
 Site-Clipart                   (1) | Val  Loss: 1.5874 | Val  Acc: 0.5263
 Site-Clipart                   (1) | Val  Loss: 1.5407 | Val  Acc: 0.5978
 Site-Clipart                   (1) | Val  Loss: 1.4936 | Val  Acc: 0.6486
 Site-Clipart                   (1) | Val  Loss: 1.5681 | Val  Acc: 0.6229
 Site-Painting                  (4) | Val  Loss: 1.4473 | Val  Acc: 0.6098
 Site-Painting                  (4) | Val  Loss: 1.3796 | Val  Acc: 0.6308
 Site-Painting                  (4) | Val  Loss: 1.3217 | Val  Acc: 0.7238
 Site-Painting                  (4) | Val  Loss: 1.3360 | Val  Acc: 0.7024
 Site-Sketch                    (1) | Val  Loss: 1.6517 | Val  Acc: 0.5333
 Site-Sketch                    (1) | Val  Loss: 1.7352 | Val  Acc: 0.4795
 Site-Sketch                    (1) | Val  Loss: 1.5828 | Val  Acc: 0.5470
 Site-Infograph                 (2) | Val  Loss: 1.9736 | Val  Acc: 0.3036
 Site-Infograph                 (2) | Val  Loss: 1.9403 | Val  Acc: 0.3407
 Site-QuickDraw                 (3) | Val  Loss: 2.2814 | Val  Acc: 0.1304
Average Valid Accuracy: 0.6962
 Best site-Real                     (5)  | Epoch:3 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.9429
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.9464
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.8539
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.8531
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.8996
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.8828
 Best site-Clipart                  (1)  | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart                  (1)  | Epoch:3 | Val Acc: 0.7727
 Best site-Clipart                  (1)  | Epoch:3 | Val Acc: 0.5833
 Best site-Clipart                  (1)  | Epoch:3 | Val Acc: 0.5263
 Best site-Clipart                  (1)  | Epoch:3 | Val Acc: 0.5978
 Best site-Clipart                  (1)  | Epoch:3 | Val Acc: 0.6486
 Best site-Clipart                  (1)  | Epoch:3 | Val Acc: 0.6229
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.6098
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.6308
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7238
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7024
 Best site-Sketch                   (1)  | Epoch:3 | Val Acc: 0.5333
 Best site-Sketch                   (1)  | Epoch:3 | Val Acc: 0.4795
 Best site-Sketch                   (1)  | Epoch:3 | Val Acc: 0.5470
 Best site-Infograph                (2)  | Epoch:3 | Val Acc: 0.3036
 Best site-Infograph                (2)  | Epoch:3 | Val Acc: 0.3407
 Best site-QuickDraw                (3)  | Epoch:3 | Val Acc: 0.1304
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[7, 1, 7, 7, 2, 3, ]
cnt=[3, 1, 13, 2, 1, 7, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Real                      (2) | Train Loss: 1.0369 | Train Acc: 0.7500
 Site-Real                      (2) | Train Loss: 0.9838 | Train Acc: 0.8333
 Site-Real                      (0) | Train Loss: 0.8070 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.9710 | Train Acc: 0.8438
 Site-Real                      (2) | Train Loss: 0.9486 | Train Acc: 0.9423
 Site-Real                      (2) | Train Loss: 0.8198 | Train Acc: 0.9524
 Site-Real                      (2) | Train Loss: 0.7841 | Train Acc: 0.9030
 Site-Real                      (2) | Train Loss: 0.8601 | Train Acc: 0.9163
 Site-Real                      (0) | Train Loss: 0.9714 | Train Acc: 0.8957
 Site-Real                      (2) | Train Loss: 0.8931 | Train Acc: 0.9149
 Site-Clipart                   (3) | Train Loss: 1.3539 | Train Acc: 0.7143
 Site-Clipart                   (3) | Train Loss: 1.3570 | Train Acc: 0.5758
 Site-Clipart                   (3) | Train Loss: 1.4493 | Train Acc: 0.6481
 Site-Clipart                   (3) | Train Loss: 1.2814 | Train Acc: 0.7209
 Site-Clipart                   (3) | Train Loss: 1.3817 | Train Acc: 0.7754
 Site-Clipart                   (3) | Train Loss: 1.4010 | Train Acc: 0.6937
 Site-Clipart                   (3) | Train Loss: 1.3376 | Train Acc: 0.7296
 Site-Painting                  (0) | Train Loss: 1.1674 | Train Acc: 0.8197
 Site-Painting                  (0) | Train Loss: 1.1426 | Train Acc: 0.7653
 Site-Painting                  (0) | Train Loss: 1.1783 | Train Acc: 0.7707
 Site-Painting                  (0) | Train Loss: 1.1335 | Train Acc: 0.7579
 Site-Sketch                    (5) | Train Loss: 1.3370 | Train Acc: 0.6618
 Site-Sketch                    (5) | Train Loss: 1.3385 | Train Acc: 0.6727
 Site-Sketch                    (5) | Train Loss: 1.4097 | Train Acc: 0.6193
 Site-Infograph                 (4) | Train Loss: 2.0169 | Train Acc: 0.3765
 Site-Infograph                 (4) | Train Loss: 1.9354 | Train Acc: 0.3676
 Site-QuickDraw                 (1) | Train Loss: 2.3242 | Train Acc: 0.2246
Average Train Accuracy: 0.7350
 Site-Real                      (2) | Val  Loss: 0.4736 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.7601 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.7209 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.8658 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.9927 | Val  Acc: 0.8857
 Site-Real                      (2) | Val  Loss: 0.8689 | Val  Acc: 0.9464
 Site-Real                      (2) | Val  Loss: 0.9522 | Val  Acc: 0.8876
 Site-Real                      (2) | Val  Loss: 1.0516 | Val  Acc: 0.8671
 Site-Real                      (0) | Val  Loss: 0.9413 | Val  Acc: 0.9127
 Site-Real                      (2) | Val  Loss: 0.8926 | Val  Acc: 0.9128
 Site-Clipart                   (3) | Val  Loss: 1.5110 | Val  Acc: 0.7143
 Site-Clipart                   (3) | Val  Loss: 1.1341 | Val  Acc: 0.7727
 Site-Clipart                   (3) | Val  Loss: 1.2716 | Val  Acc: 0.6111
 Site-Clipart                   (3) | Val  Loss: 1.3829 | Val  Acc: 0.6491
 Site-Clipart                   (3) | Val  Loss: 1.3842 | Val  Acc: 0.6522
 Site-Clipart                   (3) | Val  Loss: 1.3479 | Val  Acc: 0.7230
 Site-Clipart                   (3) | Val  Loss: 1.4080 | Val  Acc: 0.6864
 Site-Painting                  (0) | Val  Loss: 1.3229 | Val  Acc: 0.7073
 Site-Painting                  (0) | Val  Loss: 1.3150 | Val  Acc: 0.6615
 Site-Painting                  (0) | Val  Loss: 1.0992 | Val  Acc: 0.7810
 Site-Painting                  (0) | Val  Loss: 1.1306 | Val  Acc: 0.7857
 Site-Sketch                    (5) | Val  Loss: 1.4984 | Val  Acc: 0.6222
 Site-Sketch                    (5) | Val  Loss: 1.5495 | Val  Acc: 0.5479
 Site-Sketch                    (5) | Val  Loss: 1.3751 | Val  Acc: 0.6325
 Site-Infograph                 (4) | Val  Loss: 1.8769 | Val  Acc: 0.3750
 Site-Infograph                 (4) | Val  Loss: 1.8254 | Val  Acc: 0.4615
 Site-QuickDraw                 (1) | Val  Loss: 2.2977 | Val  Acc: 0.1630
Average Valid Accuracy: 0.7357
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:4 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:4 | Val Acc: 0.9048
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8857
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.9464
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8876
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8671
 Best site-Real                     (0)  | Epoch:4 | Val Acc: 0.9127
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.9128
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.7143
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.7727
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.6111
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.6491
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.6522
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.7230
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.6864
 Best site-Painting                 (0)  | Epoch:4 | Val Acc: 0.7073
 Best site-Painting                 (0)  | Epoch:4 | Val Acc: 0.6615
 Best site-Painting                 (0)  | Epoch:4 | Val Acc: 0.7810
 Best site-Painting                 (0)  | Epoch:4 | Val Acc: 0.7857
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6222
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.5479
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6325
 Best site-Infograph                (4)  | Epoch:4 | Val Acc: 0.3750
 Best site-Infograph                (4)  | Epoch:4 | Val Acc: 0.4615
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.1630
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 8, 4, 2, 6, 6, ]
cnt=[1, 7, 13, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Real                      (1) | Train Loss: 0.9317 | Train Acc: 0.7500
 Site-Real                      (1) | Train Loss: 0.8748 | Train Acc: 0.8333
 Site-Real                      (1) | Train Loss: 0.5777 | Train Acc: 1.0000
 Site-Real                      (5) | Train Loss: 0.8410 | Train Acc: 0.8125
 Site-Real                      (5) | Train Loss: 0.8124 | Train Acc: 0.9231
 Site-Real                      (1) | Train Loss: 0.6612 | Train Acc: 0.9643
 Site-Real                      (1) | Train Loss: 0.7205 | Train Acc: 0.9104
 Site-Real                      (1) | Train Loss: 0.7477 | Train Acc: 0.9070
 Site-Real                      (1) | Train Loss: 0.8228 | Train Acc: 0.9333
 Site-Real                      (1) | Train Loss: 0.7459 | Train Acc: 0.9239
 Site-Clipart                   (2) | Train Loss: 1.1374 | Train Acc: 0.8095
 Site-Clipart                   (4) | Train Loss: 1.2094 | Train Acc: 0.7576
 Site-Clipart                   (4) | Train Loss: 1.2919 | Train Acc: 0.6852
 Site-Clipart                   (4) | Train Loss: 1.1883 | Train Acc: 0.7442
 Site-Clipart                   (4) | Train Loss: 1.1819 | Train Acc: 0.7899
 Site-Clipart                   (4) | Train Loss: 1.2144 | Train Acc: 0.7297
 Site-Clipart                   (4) | Train Loss: 1.1732 | Train Acc: 0.7803
 Site-Painting                  (5) | Train Loss: 1.0223 | Train Acc: 0.8361
 Site-Painting                  (5) | Train Loss: 0.9668 | Train Acc: 0.8163
 Site-Painting                  (5) | Train Loss: 1.0426 | Train Acc: 0.7834
 Site-Painting                  (5) | Train Loss: 0.9995 | Train Acc: 0.7817
 Site-Sketch                    (2) | Train Loss: 0.9787 | Train Acc: 0.7500
 Site-Sketch                    (2) | Train Loss: 1.1474 | Train Acc: 0.7182
 Site-Sketch                    (2) | Train Loss: 1.2415 | Train Acc: 0.6932
 Site-Infograph                 (3) | Train Loss: 1.9793 | Train Acc: 0.4000
 Site-Infograph                 (3) | Train Loss: 1.8528 | Train Acc: 0.3971
 Site-QuickDraw                 (0) | Train Loss: 2.1255 | Train Acc: 0.2609
Average Train Accuracy: 0.7663
 Site-Real                      (1) | Val  Loss: 0.3403 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.6186 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.6572 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.7658 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.7769 | Val  Acc: 0.8571
 Site-Real                      (1) | Val  Loss: 0.7735 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.7943 | Val  Acc: 0.9213
 Site-Real                      (1) | Val  Loss: 0.9048 | Val  Acc: 0.9231
 Site-Real                      (1) | Val  Loss: 0.8067 | Val  Acc: 0.9170
 Site-Real                      (1) | Val  Loss: 0.7487 | Val  Acc: 0.9019
 Site-Clipart                   (2) | Val  Loss: 1.3758 | Val  Acc: 0.7857
 Site-Clipart                   (4) | Val  Loss: 0.9590 | Val  Acc: 0.9091
 Site-Clipart                   (4) | Val  Loss: 1.1930 | Val  Acc: 0.6944
 Site-Clipart                   (4) | Val  Loss: 1.2615 | Val  Acc: 0.6491
 Site-Clipart                   (4) | Val  Loss: 1.2911 | Val  Acc: 0.7065
 Site-Clipart                   (4) | Val  Loss: 1.2006 | Val  Acc: 0.7432
 Site-Clipart                   (4) | Val  Loss: 1.2723 | Val  Acc: 0.7415
 Site-Painting                  (5) | Val  Loss: 1.1663 | Val  Acc: 0.7073
 Site-Painting                  (5) | Val  Loss: 1.2645 | Val  Acc: 0.7538
 Site-Painting                  (5) | Val  Loss: 0.9330 | Val  Acc: 0.8286
 Site-Painting                  (5) | Val  Loss: 0.9530 | Val  Acc: 0.8095
 Site-Sketch                    (2) | Val  Loss: 1.3869 | Val  Acc: 0.5778
 Site-Sketch                    (2) | Val  Loss: 1.4231 | Val  Acc: 0.5753
 Site-Sketch                    (2) | Val  Loss: 1.2855 | Val  Acc: 0.6838
 Site-Infograph                 (3) | Val  Loss: 1.7263 | Val  Acc: 0.4821
 Site-Infograph                 (3) | Val  Loss: 1.7454 | Val  Acc: 0.4505
 Site-QuickDraw                 (0) | Val  Loss: 2.2912 | Val  Acc: 0.2065
Average Valid Accuracy: 0.7669
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 1.0000
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.9524
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8571
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.9286
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.9213
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.9231
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.9170
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.9019
 Best site-Clipart                  (2)  | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.9091
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.6944
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.6491
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.7065
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.7432
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.7415
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7073
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7538
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8286
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8095
 Best site-Sketch                   (2)  | Epoch:5 | Val Acc: 0.5778
 Best site-Sketch                   (2)  | Epoch:5 | Val Acc: 0.5753
 Best site-Sketch                   (2)  | Epoch:5 | Val Acc: 0.6838
 Best site-Infograph                (3)  | Epoch:5 | Val Acc: 0.4821
 Best site-Infograph                (3)  | Epoch:5 | Val Acc: 0.4505
 Best site-QuickDraw                (0)  | Epoch:5 | Val Acc: 0.2065
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 2, 10, 5, 1, 6, ]
cnt=[3, 13, 1, 7, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Real                      (2) | Train Loss: 0.8563 | Train Acc: 0.7500
 Site-Real                      (5) | Train Loss: 0.7015 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.4747 | Train Acc: 1.0000
 Site-Real                      (5) | Train Loss: 0.7401 | Train Acc: 0.8438
 Site-Real                      (5) | Train Loss: 0.6680 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.5545 | Train Acc: 0.9881
 Site-Real                      (2) | Train Loss: 0.7421 | Train Acc: 0.9328
 Site-Real                      (5) | Train Loss: 0.5913 | Train Acc: 0.9209
 Site-Real                      (2) | Train Loss: 0.6934 | Train Acc: 0.9130
 Site-Real                      (2) | Train Loss: 0.6313 | Train Acc: 0.9384
 Site-Clipart                   (1) | Train Loss: 0.9732 | Train Acc: 0.7619
 Site-Clipart                   (1) | Train Loss: 1.0863 | Train Acc: 0.7576
 Site-Clipart                   (3) | Train Loss: 1.1374 | Train Acc: 0.7222
 Site-Clipart                   (0) | Train Loss: 1.0311 | Train Acc: 0.7209
 Site-Clipart                   (3) | Train Loss: 1.0063 | Train Acc: 0.8623
 Site-Clipart                   (3) | Train Loss: 1.1482 | Train Acc: 0.7523
 Site-Clipart                   (3) | Train Loss: 1.0298 | Train Acc: 0.7915
 Site-Painting                  (5) | Train Loss: 0.9379 | Train Acc: 0.8197
 Site-Painting                  (2) | Train Loss: 0.8895 | Train Acc: 0.8061
 Site-Painting                  (5) | Train Loss: 0.9122 | Train Acc: 0.8280
 Site-Painting                  (2) | Train Loss: 0.8750 | Train Acc: 0.8135
 Site-Sketch                    (3) | Train Loss: 0.6089 | Train Acc: 0.8088
 Site-Sketch                    (0) | Train Loss: 1.0099 | Train Acc: 0.7545
 Site-Sketch                    (0) | Train Loss: 1.0931 | Train Acc: 0.7159
 Site-Infograph                 (2) | Train Loss: 1.9193 | Train Acc: 0.4235
 Site-Infograph                 (2) | Train Loss: 1.6799 | Train Acc: 0.5000
 Site-QuickDraw                 (4) | Train Loss: 2.1729 | Train Acc: 0.2899
Average Train Accuracy: 0.7842
 Site-Real                      (2) | Val  Loss: 0.2487 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.5315 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.5255 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.6060 | Val  Acc: 0.9048
 Site-Real                      (5) | Val  Loss: 0.6854 | Val  Acc: 0.8857
 Site-Real                      (2) | Val  Loss: 0.6082 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.6635 | Val  Acc: 0.9326
 Site-Real                      (5) | Val  Loss: 0.7788 | Val  Acc: 0.9231
 Site-Real                      (2) | Val  Loss: 0.6589 | Val  Acc: 0.9301
 Site-Real                      (2) | Val  Loss: 0.6368 | Val  Acc: 0.9101
 Site-Clipart                   (1) | Val  Loss: 1.1208 | Val  Acc: 0.8571
 Site-Clipart                   (1) | Val  Loss: 0.8522 | Val  Acc: 0.8636
 Site-Clipart                   (3) | Val  Loss: 1.0131 | Val  Acc: 0.7778
 Site-Clipart                   (0) | Val  Loss: 1.1273 | Val  Acc: 0.7018
 Site-Clipart                   (3) | Val  Loss: 1.1428 | Val  Acc: 0.7609
 Site-Clipart                   (3) | Val  Loss: 1.0697 | Val  Acc: 0.7770
 Site-Clipart                   (3) | Val  Loss: 1.1240 | Val  Acc: 0.7669
 Site-Painting                  (5) | Val  Loss: 1.0523 | Val  Acc: 0.7561
 Site-Painting                  (2) | Val  Loss: 1.0698 | Val  Acc: 0.7538
 Site-Painting                  (5) | Val  Loss: 0.8384 | Val  Acc: 0.8571
 Site-Painting                  (2) | Val  Loss: 0.8505 | Val  Acc: 0.8512
 Site-Sketch                    (3) | Val  Loss: 1.2811 | Val  Acc: 0.6667
 Site-Sketch                    (0) | Val  Loss: 1.3140 | Val  Acc: 0.6712
 Site-Sketch                    (0) | Val  Loss: 1.1259 | Val  Acc: 0.7350
 Site-Infograph                 (2) | Val  Loss: 1.6874 | Val  Acc: 0.4464
 Site-Infograph                 (2) | Val  Loss: 1.6651 | Val  Acc: 0.4725
 Site-QuickDraw                 (4) | Val  Loss: 2.2627 | Val  Acc: 0.2283
Average Valid Accuracy: 0.7911
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 1.0000
 Best site-Real                     (5)  | Epoch:6 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 1.0000
 Best site-Real                     (5)  | Epoch:6 | Val Acc: 0.9048
 Best site-Real                     (5)  | Epoch:6 | Val Acc: 0.8857
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.9326
 Best site-Real                     (5)  | Epoch:6 | Val Acc: 0.9231
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.9301
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.9101
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.8636
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.7778
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7018
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.7609
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.7770
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.7669
 Best site-Painting                 (5)  | Epoch:6 | Val Acc: 0.7561
 Best site-Painting                 (2)  | Epoch:6 | Val Acc: 0.7538
 Best site-Painting                 (5)  | Epoch:6 | Val Acc: 0.8571
 Best site-Painting                 (2)  | Epoch:6 | Val Acc: 0.8512
 Best site-Sketch                   (3)  | Epoch:6 | Val Acc: 0.6667
 Best site-Sketch                   (0)  | Epoch:6 | Val Acc: 0.6712
 Best site-Sketch                   (0)  | Epoch:6 | Val Acc: 0.7350
 Best site-Infograph                (2)  | Epoch:6 | Val Acc: 0.4464
 Best site-Infograph                (2)  | Epoch:6 | Val Acc: 0.4725
 Best site-QuickDraw                (4)  | Epoch:6 | Val Acc: 0.2283
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 4, 8, 7, 1, 5, ]
cnt=[7, 4, 1, 2, 3, 10, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Real                      (0) | Train Loss: 0.7663 | Train Acc: 0.7500
 Site-Real                      (5) | Train Loss: 0.6960 | Train Acc: 0.8333
 Site-Real                      (0) | Train Loss: 0.3748 | Train Acc: 1.0000
 Site-Real                      (5) | Train Loss: 0.6644 | Train Acc: 0.8750
 Site-Real                      (2) | Train Loss: 0.6053 | Train Acc: 0.9038
 Site-Real                      (2) | Train Loss: 0.4722 | Train Acc: 0.9762
 Site-Real                      (5) | Train Loss: 0.4708 | Train Acc: 0.9627
 Site-Real                      (2) | Train Loss: 0.5347 | Train Acc: 0.9209
 Site-Real                      (2) | Train Loss: 0.6084 | Train Acc: 0.9275
 Site-Real                      (5) | Train Loss: 0.5470 | Train Acc: 0.9475
 Site-Clipart                   (5) | Train Loss: 0.8596 | Train Acc: 0.8571
 Site-Clipart                   (1) | Train Loss: 0.9563 | Train Acc: 0.7879
 Site-Clipart                   (3) | Train Loss: 1.0385 | Train Acc: 0.7593
 Site-Clipart                   (3) | Train Loss: 0.9738 | Train Acc: 0.7674
 Site-Clipart                   (3) | Train Loss: 0.9344 | Train Acc: 0.8406
 Site-Clipart                   (3) | Train Loss: 1.0114 | Train Acc: 0.7703
 Site-Clipart                   (1) | Train Loss: 0.9438 | Train Acc: 0.7972
 Site-Painting                  (1) | Train Loss: 0.7542 | Train Acc: 0.8525
 Site-Painting                  (2) | Train Loss: 0.7560 | Train Acc: 0.7959
 Site-Painting                  (2) | Train Loss: 0.8603 | Train Acc: 0.8153
 Site-Painting                  (2) | Train Loss: 0.7791 | Train Acc: 0.8254
 Site-Sketch                    (3) | Train Loss: 0.9096 | Train Acc: 0.8235
 Site-Sketch                    (3) | Train Loss: 0.9574 | Train Acc: 0.7636
 Site-Sketch                    (3) | Train Loss: 1.0214 | Train Acc: 0.7102
 Site-Infograph                 (1) | Train Loss: 1.8589 | Train Acc: 0.4000
 Site-Infograph                 (2) | Train Loss: 1.6470 | Train Acc: 0.5000
 Site-QuickDraw                 (4) | Train Loss: 2.1009 | Train Acc: 0.2754
Average Train Accuracy: 0.7940
 Site-Real                      (0) | Val  Loss: 0.2280 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.4556 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.4083 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.5179 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.6195 | Val  Acc: 0.9143
 Site-Real                      (2) | Val  Loss: 0.5412 | Val  Acc: 0.9464
 Site-Real                      (5) | Val  Loss: 0.5943 | Val  Acc: 0.9213
 Site-Real                      (2) | Val  Loss: 0.6909 | Val  Acc: 0.9371
 Site-Real                      (2) | Val  Loss: 0.5672 | Val  Acc: 0.9432
 Site-Real                      (5) | Val  Loss: 0.5469 | Val  Acc: 0.9237
 Site-Clipart                   (5) | Val  Loss: 1.0508 | Val  Acc: 0.7857
 Site-Clipart                   (1) | Val  Loss: 0.8304 | Val  Acc: 0.7727
 Site-Clipart                   (3) | Val  Loss: 0.9498 | Val  Acc: 0.7500
 Site-Clipart                   (3) | Val  Loss: 1.0471 | Val  Acc: 0.7193
 Site-Clipart                   (3) | Val  Loss: 1.0582 | Val  Acc: 0.7500
 Site-Clipart                   (3) | Val  Loss: 0.9825 | Val  Acc: 0.7770
 Site-Clipart                   (1) | Val  Loss: 1.0361 | Val  Acc: 0.7924
 Site-Painting                  (1) | Val  Loss: 1.0019 | Val  Acc: 0.7561
 Site-Painting                  (2) | Val  Loss: 0.9605 | Val  Acc: 0.8308
 Site-Painting                  (2) | Val  Loss: 0.7054 | Val  Acc: 0.8762
 Site-Painting                  (2) | Val  Loss: 0.7586 | Val  Acc: 0.8393
 Site-Sketch                    (3) | Val  Loss: 1.1297 | Val  Acc: 0.6889
 Site-Sketch                    (3) | Val  Loss: 1.1564 | Val  Acc: 0.6438
 Site-Sketch                    (3) | Val  Loss: 1.0213 | Val  Acc: 0.6923
 Site-Infograph                 (1) | Val  Loss: 1.5461 | Val  Acc: 0.4821
 Site-Infograph                 (2) | Val  Loss: 1.5135 | Val  Acc: 0.4945
 Site-QuickDraw                 (4) | Val  Loss: 2.2469 | Val  Acc: 0.2174
Average Valid Accuracy: 0.7929
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 1.0000
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 1.0000
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9143
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9464
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9213
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9371
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9432
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9237
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.7857
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7727
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7500
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7193
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7500
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7770
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7924
 Best site-Painting                 (1)  | Epoch:7 | Val Acc: 0.7561
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8308
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8762
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8393
 Best site-Sketch                   (3)  | Epoch:7 | Val Acc: 0.6889
 Best site-Sketch                   (3)  | Epoch:7 | Val Acc: 0.6438
 Best site-Sketch                   (3)  | Epoch:7 | Val Acc: 0.6923
 Best site-Infograph                (1)  | Epoch:7 | Val Acc: 0.4821
 Best site-Infograph                (2)  | Epoch:7 | Val Acc: 0.4945
 Best site-QuickDraw                (4)  | Epoch:7 | Val Acc: 0.2174
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 8 ============
cnt=[7, 4, 1, 8, 1, 6, ]
cnt=[10, 7, 3, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Real                      (2) | Train Loss: 0.7733 | Train Acc: 0.7500
 Site-Real                      (5) | Train Loss: 0.6656 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.3305 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.6024 | Train Acc: 0.9062
 Site-Real                      (3) | Train Loss: 0.5384 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.4064 | Train Acc: 0.9762
 Site-Real                      (3) | Train Loss: 0.4574 | Train Acc: 0.9478
 Site-Real                      (3) | Train Loss: 0.4740 | Train Acc: 0.9256
 Site-Real                      (0) | Train Loss: 0.5345 | Train Acc: 0.9362
 Site-Real                      (3) | Train Loss: 0.4738 | Train Acc: 0.9547
 Site-Clipart                   (1) | Train Loss: 0.8245 | Train Acc: 0.8095
 Site-Clipart                   (5) | Train Loss: 0.8953 | Train Acc: 0.7879
 Site-Clipart                   (0) | Train Loss: 0.9207 | Train Acc: 0.7963
 Site-Clipart                   (5) | Train Loss: 0.8955 | Train Acc: 0.8140
 Site-Clipart                   (0) | Train Loss: 0.9379 | Train Acc: 0.8551
 Site-Clipart                   (5) | Train Loss: 0.8918 | Train Acc: 0.7748
 Site-Clipart                   (5) | Train Loss: 0.8400 | Train Acc: 0.8085
 Site-Painting                  (5) | Train Loss: 0.7625 | Train Acc: 0.8197
 Site-Painting                  (0) | Train Loss: 0.7065 | Train Acc: 0.8469
 Site-Painting                  (0) | Train Loss: 0.7435 | Train Acc: 0.8344
 Site-Painting                  (0) | Train Loss: 0.7448 | Train Acc: 0.8333
 Site-Sketch                    (1) | Train Loss: 0.6025 | Train Acc: 0.8382
 Site-Sketch                    (1) | Train Loss: 0.8339 | Train Acc: 0.7909
 Site-Sketch                    (1) | Train Loss: 0.9094 | Train Acc: 0.7670
 Site-Infograph                 (3) | Train Loss: 1.7590 | Train Acc: 0.3765
 Site-Infograph                 (0) | Train Loss: 1.4743 | Train Acc: 0.4853
 Site-QuickDraw                 (4) | Train Loss: 2.0682 | Train Acc: 0.2899
Average Train Accuracy: 0.8030
 Site-Real                      (2) | Val  Loss: 0.2283 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.3854 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.3538 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.4483 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.5890 | Val  Acc: 0.8857
 Site-Real                      (3) | Val  Loss: 0.4489 | Val  Acc: 0.9821
 Site-Real                      (3) | Val  Loss: 0.5070 | Val  Acc: 0.9551
 Site-Real                      (3) | Val  Loss: 0.6440 | Val  Acc: 0.9091
 Site-Real                      (0) | Val  Loss: 0.4965 | Val  Acc: 0.9520
 Site-Real                      (3) | Val  Loss: 0.4953 | Val  Acc: 0.9183
 Site-Clipart                   (1) | Val  Loss: 0.9126 | Val  Acc: 0.7143
 Site-Clipart                   (5) | Val  Loss: 0.6388 | Val  Acc: 0.9091
 Site-Clipart                   (0) | Val  Loss: 0.8007 | Val  Acc: 0.8611
 Site-Clipart                   (5) | Val  Loss: 0.9254 | Val  Acc: 0.7368
 Site-Clipart                   (0) | Val  Loss: 0.9352 | Val  Acc: 0.7609
 Site-Clipart                   (5) | Val  Loss: 0.8662 | Val  Acc: 0.8311
 Site-Clipart                   (5) | Val  Loss: 0.9060 | Val  Acc: 0.8178
 Site-Painting                  (5) | Val  Loss: 0.8786 | Val  Acc: 0.8293
 Site-Painting                  (0) | Val  Loss: 0.8464 | Val  Acc: 0.7385
 Site-Painting                  (0) | Val  Loss: 0.6595 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.6753 | Val  Acc: 0.8690
 Site-Sketch                    (1) | Val  Loss: 1.0922 | Val  Acc: 0.6889
 Site-Sketch                    (1) | Val  Loss: 1.2055 | Val  Acc: 0.6301
 Site-Sketch                    (1) | Val  Loss: 0.9314 | Val  Acc: 0.7692
 Site-Infograph                 (3) | Val  Loss: 1.4981 | Val  Acc: 0.5000
 Site-Infograph                 (0) | Val  Loss: 1.4933 | Val  Acc: 0.5495
 Site-QuickDraw                 (4) | Val  Loss: 2.1814 | Val  Acc: 0.2391
Average Valid Accuracy: 0.8113
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 1.0000
 Best site-Real                     (5)  | Epoch:8 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:8 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:8 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:8 | Val Acc: 0.8857
 Best site-Real                     (3)  | Epoch:8 | Val Acc: 0.9821
 Best site-Real                     (3)  | Epoch:8 | Val Acc: 0.9551
 Best site-Real                     (3)  | Epoch:8 | Val Acc: 0.9091
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.9520
 Best site-Real                     (3)  | Epoch:8 | Val Acc: 0.9183
 Best site-Clipart                  (1)  | Epoch:8 | Val Acc: 0.7143
 Best site-Clipart                  (5)  | Epoch:8 | Val Acc: 0.9091
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8611
 Best site-Clipart                  (5)  | Epoch:8 | Val Acc: 0.7368
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.7609
 Best site-Clipart                  (5)  | Epoch:8 | Val Acc: 0.8311
 Best site-Clipart                  (5)  | Epoch:8 | Val Acc: 0.8178
 Best site-Painting                 (5)  | Epoch:8 | Val Acc: 0.8293
 Best site-Painting                 (0)  | Epoch:8 | Val Acc: 0.7385
 Best site-Painting                 (0)  | Epoch:8 | Val Acc: 0.9048
 Best site-Painting                 (0)  | Epoch:8 | Val Acc: 0.8690
 Best site-Sketch                   (1)  | Epoch:8 | Val Acc: 0.6889
 Best site-Sketch                   (1)  | Epoch:8 | Val Acc: 0.6301
 Best site-Sketch                   (1)  | Epoch:8 | Val Acc: 0.7692
 Best site-Infograph                (3)  | Epoch:8 | Val Acc: 0.5000
 Best site-Infograph                (0)  | Epoch:8 | Val Acc: 0.5495
 Best site-QuickDraw                (4)  | Epoch:8 | Val Acc: 0.2391
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 9 ============
cnt=[3, 6, 1, 10, 6, 1, ]
cnt=[7, 10, 1, 3, 2, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Real                      (2) | Train Loss: 0.7057 | Train Acc: 0.7500
 Site-Real                      (1) | Train Loss: 0.5909 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.2480 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.5168 | Train Acc: 0.9375
 Site-Real                      (3) | Train Loss: 0.4992 | Train Acc: 0.9038
 Site-Real                      (1) | Train Loss: 0.3236 | Train Acc: 0.9881
 Site-Real                      (1) | Train Loss: 0.5155 | Train Acc: 0.9478
 Site-Real                      (3) | Train Loss: 0.4566 | Train Acc: 0.9209
 Site-Real                      (1) | Train Loss: 0.4856 | Train Acc: 0.9304
 Site-Real                      (1) | Train Loss: 0.4354 | Train Acc: 0.9493
 Site-Clipart                   (0) | Train Loss: 0.7851 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.8520 | Train Acc: 0.7576
 Site-Clipart                   (1) | Train Loss: 0.8912 | Train Acc: 0.7593
 Site-Clipart                   (4) | Train Loss: 0.7710 | Train Acc: 0.7674
 Site-Clipart                   (4) | Train Loss: 0.7147 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.9076 | Train Acc: 0.7748
 Site-Clipart                   (4) | Train Loss: 0.7872 | Train Acc: 0.8310
 Site-Painting                  (3) | Train Loss: 0.7589 | Train Acc: 0.8197
 Site-Painting                  (3) | Train Loss: 0.6155 | Train Acc: 0.8673
 Site-Painting                  (3) | Train Loss: 0.7073 | Train Acc: 0.8471
 Site-Painting                  (3) | Train Loss: 0.6690 | Train Acc: 0.8492
 Site-Sketch                    (0) | Train Loss: 0.7252 | Train Acc: 0.8676
 Site-Sketch                    (4) | Train Loss: 0.7862 | Train Acc: 0.8091
 Site-Sketch                    (0) | Train Loss: 0.8854 | Train Acc: 0.7500
 Site-Infograph                 (4) | Train Loss: 1.7662 | Train Acc: 0.4353
 Site-Infograph                 (3) | Train Loss: 1.2787 | Train Acc: 0.5294
 Site-QuickDraw                 (5) | Train Loss: 1.9437 | Train Acc: 0.2899
Average Train Accuracy: 0.8090
 Site-Real                      (2) | Val  Loss: 0.1127 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.3162 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.3165 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.4502 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.5284 | Val  Acc: 0.9143
 Site-Real                      (1) | Val  Loss: 0.4202 | Val  Acc: 0.9643
 Site-Real                      (1) | Val  Loss: 0.4860 | Val  Acc: 0.9326
 Site-Real                      (3) | Val  Loss: 0.5954 | Val  Acc: 0.9301
 Site-Real                      (1) | Val  Loss: 0.4701 | Val  Acc: 0.9389
 Site-Real                      (1) | Val  Loss: 0.4443 | Val  Acc: 0.9319
 Site-Clipart                   (0) | Val  Loss: 0.8129 | Val  Acc: 0.7857
 Site-Clipart                   (3) | Val  Loss: 0.6233 | Val  Acc: 0.8182
 Site-Clipart                   (1) | Val  Loss: 0.8009 | Val  Acc: 0.8611
 Site-Clipart                   (4) | Val  Loss: 0.9722 | Val  Acc: 0.6667
 Site-Clipart                   (4) | Val  Loss: 0.8596 | Val  Acc: 0.7826
 Site-Clipart                   (4) | Val  Loss: 0.8045 | Val  Acc: 0.8243
 Site-Clipart                   (4) | Val  Loss: 0.8859 | Val  Acc: 0.8008
 Site-Painting                  (3) | Val  Loss: 0.9140 | Val  Acc: 0.7805
 Site-Painting                  (3) | Val  Loss: 0.9506 | Val  Acc: 0.7692
 Site-Painting                  (3) | Val  Loss: 0.6051 | Val  Acc: 0.9048
 Site-Painting                  (3) | Val  Loss: 0.6273 | Val  Acc: 0.8512
 Site-Sketch                    (0) | Val  Loss: 0.9800 | Val  Acc: 0.6667
 Site-Sketch                    (4) | Val  Loss: 1.1045 | Val  Acc: 0.7123
 Site-Sketch                    (0) | Val  Loss: 0.8655 | Val  Acc: 0.7436
 Site-Infograph                 (4) | Val  Loss: 1.4504 | Val  Acc: 0.5357
 Site-Infograph                 (3) | Val  Loss: 1.5131 | Val  Acc: 0.4945
 Site-QuickDraw                 (5) | Val  Loss: 2.1276 | Val  Acc: 0.2609
Average Valid Accuracy: 0.8083
 Test site-Real                      (2)| Epoch:8 | Test Acc: 0.9458
 Test site-Clipart                   (0)| Epoch:8 | Test Acc: 0.8175
 Test site-Painting                  (3)| Epoch:8 | Test Acc: 0.8901
 Test site-Sketch                    (0)| Epoch:8 | Test Acc: 0.7906
 Test site-Infograph                 (4)| Epoch:8 | Test Acc: 0.4916
 Test site-QuickDraw                 (5)| Epoch:8 | Test Acc: 0.4080
Real: 0.9458, Clipart: 0.8175, Painting: 0.8901, Sketch: 0.7906, Infograph: 0.4916, QuickDraw: 0.4080, 
Average Test Accuracy(group): 0.7239, Average Test Accuracy(individual): 0.8335,
domain std=0.2016, cluster std=0.1802, individual std=0.1441, 
============ Train epoch 10 ============
cnt=[7, 1, 3, 9, 1, 6, ]
cnt=[14, 3, 1, 2, 1, 6, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Real                      (1) | Train Loss: 0.5946 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.5407 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.2612 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.5231 | Train Acc: 0.9062
 Site-Real                      (0) | Train Loss: 0.4628 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.3248 | Train Acc: 0.9881
 Site-Real                      (3) | Train Loss: 0.4634 | Train Acc: 0.9403
 Site-Real                      (3) | Train Loss: 0.3829 | Train Acc: 0.9488
 Site-Real                      (3) | Train Loss: 0.4722 | Train Acc: 0.9275
 Site-Real                      (3) | Train Loss: 0.4006 | Train Acc: 0.9475
 Site-Clipart                   (2) | Train Loss: 0.6994 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.7907 | Train Acc: 0.7576
 Site-Clipart                   (0) | Train Loss: 0.8306 | Train Acc: 0.7222
 Site-Clipart                   (5) | Train Loss: 0.8166 | Train Acc: 0.8256
 Site-Clipart                   (5) | Train Loss: 0.6969 | Train Acc: 0.8623
 Site-Clipart                   (5) | Train Loss: 0.8496 | Train Acc: 0.8198
 Site-Clipart                   (0) | Train Loss: 0.7252 | Train Acc: 0.8310
 Site-Painting                  (5) | Train Loss: 0.6297 | Train Acc: 0.8361
 Site-Painting                  (0) | Train Loss: 0.6113 | Train Acc: 0.8776
 Site-Painting                  (3) | Train Loss: 0.6739 | Train Acc: 0.8217
 Site-Painting                  (3) | Train Loss: 0.6282 | Train Acc: 0.8452
 Site-Sketch                    (2) | Train Loss: 0.9061 | Train Acc: 0.8088
 Site-Sketch                    (5) | Train Loss: 0.7368 | Train Acc: 0.8000
 Site-Sketch                    (2) | Train Loss: 0.8568 | Train Acc: 0.7614
 Site-Infograph                 (0) | Train Loss: 1.7474 | Train Acc: 0.4824
 Site-Infograph                 (0) | Train Loss: 1.4099 | Train Acc: 0.5000
 Site-QuickDraw                 (0) | Train Loss: 1.8918 | Train Acc: 0.3551
Average Train Accuracy: 0.8122
 Site-Real                      (1) | Val  Loss: 0.1096 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.2697 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2967 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.4018 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.5124 | Val  Acc: 0.8857
 Site-Real                      (3) | Val  Loss: 0.3645 | Val  Acc: 0.9643
 Site-Real                      (3) | Val  Loss: 0.4120 | Val  Acc: 0.9438
 Site-Real                      (3) | Val  Loss: 0.5293 | Val  Acc: 0.9161
 Site-Real                      (3) | Val  Loss: 0.4132 | Val  Acc: 0.9607
 Site-Real                      (3) | Val  Loss: 0.3929 | Val  Acc: 0.9455
 Site-Clipart                   (2) | Val  Loss: 0.8325 | Val  Acc: 0.7143
 Site-Clipart                   (5) | Val  Loss: 0.6537 | Val  Acc: 0.8636
 Site-Clipart                   (0) | Val  Loss: 0.8373 | Val  Acc: 0.7500
 Site-Clipart                   (5) | Val  Loss: 0.8837 | Val  Acc: 0.7193
 Site-Clipart                   (5) | Val  Loss: 0.8108 | Val  Acc: 0.7391
 Site-Clipart                   (5) | Val  Loss: 0.7125 | Val  Acc: 0.8378
 Site-Clipart                   (0) | Val  Loss: 0.7881 | Val  Acc: 0.8390
 Site-Painting                  (5) | Val  Loss: 0.7737 | Val  Acc: 0.8780
 Site-Painting                  (0) | Val  Loss: 0.9012 | Val  Acc: 0.8462
 Site-Painting                  (3) | Val  Loss: 0.5543 | Val  Acc: 0.9143
 Site-Painting                  (3) | Val  Loss: 0.5799 | Val  Acc: 0.8631
 Site-Sketch                    (2) | Val  Loss: 1.0267 | Val  Acc: 0.7111
 Site-Sketch                    (5) | Val  Loss: 1.0196 | Val  Acc: 0.7260
 Site-Sketch                    (2) | Val  Loss: 0.8527 | Val  Acc: 0.7436
 Site-Infograph                 (0) | Val  Loss: 1.4786 | Val  Acc: 0.4643
 Site-Infograph                 (0) | Val  Loss: 1.4416 | Val  Acc: 0.5165
 Site-QuickDraw                 (0) | Val  Loss: 2.1266 | Val  Acc: 0.2174
Average Valid Accuracy: 0.8116
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:10 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.8857
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9643
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9438
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9161
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9607
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9455
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.7143
 Best site-Clipart                  (5)  | Epoch:10 | Val Acc: 0.8636
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.7500
 Best site-Clipart                  (5)  | Epoch:10 | Val Acc: 0.7193
 Best site-Clipart                  (5)  | Epoch:10 | Val Acc: 0.7391
 Best site-Clipart                  (5)  | Epoch:10 | Val Acc: 0.8378
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8390
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8780
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8462
 Best site-Painting                 (3)  | Epoch:10 | Val Acc: 0.9143
 Best site-Painting                 (3)  | Epoch:10 | Val Acc: 0.8631
 Best site-Sketch                   (2)  | Epoch:10 | Val Acc: 0.7111
 Best site-Sketch                   (5)  | Epoch:10 | Val Acc: 0.7260
 Best site-Sketch                   (2)  | Epoch:10 | Val Acc: 0.7436
 Best site-Infograph                (0)  | Epoch:10 | Val Acc: 0.4643
 Best site-Infograph                (0)  | Epoch:10 | Val Acc: 0.5165
 Best site-QuickDraw                (0)  | Epoch:10 | Val Acc: 0.2174
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 11 ============
cnt=[6, 3, 3, 10, 4, 1, ]
cnt=[10, 1, 7, 2, 4, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Real                      (3) | Train Loss: 0.7437 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.5257 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.2319 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.4899 | Train Acc: 0.9062
 Site-Real                      (3) | Train Loss: 0.4254 | Train Acc: 0.9038
 Site-Real                      (4) | Train Loss: 0.2847 | Train Acc: 0.9881
 Site-Real                      (4) | Train Loss: 0.3243 | Train Acc: 0.9478
 Site-Real                      (3) | Train Loss: 0.3608 | Train Acc: 0.9442
 Site-Real                      (4) | Train Loss: 0.4176 | Train Acc: 0.9275
 Site-Real                      (4) | Train Loss: 0.3891 | Train Acc: 0.9457
 Site-Clipart                   (0) | Train Loss: 0.6166 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.6673 | Train Acc: 0.8485
 Site-Clipart                   (1) | Train Loss: 0.7170 | Train Acc: 0.8333
 Site-Clipart                   (2) | Train Loss: 0.7737 | Train Acc: 0.8023
 Site-Clipart                   (0) | Train Loss: 0.7011 | Train Acc: 0.8623
 Site-Clipart                   (0) | Train Loss: 0.7638 | Train Acc: 0.8108
 Site-Clipart                   (0) | Train Loss: 0.7046 | Train Acc: 0.8423
 Site-Painting                  (3) | Train Loss: 0.6954 | Train Acc: 0.7869
 Site-Painting                  (3) | Train Loss: 0.5949 | Train Acc: 0.8776
 Site-Painting                  (3) | Train Loss: 0.6116 | Train Acc: 0.8344
 Site-Painting                  (3) | Train Loss: 0.5864 | Train Acc: 0.8889
 Site-Sketch                    (1) | Train Loss: 0.5908 | Train Acc: 0.8235
 Site-Sketch                    (2) | Train Loss: 0.7319 | Train Acc: 0.8000
 Site-Sketch                    (2) | Train Loss: 0.8297 | Train Acc: 0.7784
 Site-Infograph                 (1) | Train Loss: 1.7041 | Train Acc: 0.4000
 Site-Infograph                 (0) | Train Loss: 1.2600 | Train Acc: 0.5515
 Site-QuickDraw                 (5) | Train Loss: 1.8555 | Train Acc: 0.3696
Average Train Accuracy: 0.8190
 Site-Real                      (3) | Val  Loss: 0.0868 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2080 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2596 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.3799 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.5090 | Val  Acc: 0.9143
 Site-Real                      (4) | Val  Loss: 0.3363 | Val  Acc: 0.9464
 Site-Real                      (4) | Val  Loss: 0.3938 | Val  Acc: 0.9326
 Site-Real                      (3) | Val  Loss: 0.4897 | Val  Acc: 0.9371
 Site-Real                      (4) | Val  Loss: 0.4089 | Val  Acc: 0.9520
 Site-Real                      (4) | Val  Loss: 0.3766 | Val  Acc: 0.9373
 Site-Clipart                   (0) | Val  Loss: 0.7614 | Val  Acc: 0.7143
 Site-Clipart                   (3) | Val  Loss: 0.5844 | Val  Acc: 0.8182
 Site-Clipart                   (1) | Val  Loss: 0.7277 | Val  Acc: 0.8056
 Site-Clipart                   (2) | Val  Loss: 0.8528 | Val  Acc: 0.7544
 Site-Clipart                   (0) | Val  Loss: 0.7381 | Val  Acc: 0.8043
 Site-Clipart                   (0) | Val  Loss: 0.6710 | Val  Acc: 0.8311
 Site-Clipart                   (0) | Val  Loss: 0.7395 | Val  Acc: 0.8644
 Site-Painting                  (3) | Val  Loss: 0.7387 | Val  Acc: 0.8780
 Site-Painting                  (3) | Val  Loss: 1.2040 | Val  Acc: 0.8615
 Site-Painting                  (3) | Val  Loss: 0.5415 | Val  Acc: 0.8571
 Site-Painting                  (3) | Val  Loss: 0.6180 | Val  Acc: 0.8512
 Site-Sketch                    (1) | Val  Loss: 1.0097 | Val  Acc: 0.6222
 Site-Sketch                    (2) | Val  Loss: 0.9390 | Val  Acc: 0.7397
 Site-Sketch                    (2) | Val  Loss: 0.8365 | Val  Acc: 0.7692
 Site-Infograph                 (1) | Val  Loss: 1.3078 | Val  Acc: 0.5000
 Site-Infograph                 (0) | Val  Loss: 1.4330 | Val  Acc: 0.5604
 Site-QuickDraw                 (5) | Val  Loss: 2.0208 | Val  Acc: 0.2500
Average Valid Accuracy: 0.8168
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:11 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9143
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9464
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9326
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9371
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9520
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9373
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.7143
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8182
 Best site-Clipart                  (1)  | Epoch:11 | Val Acc: 0.8056
 Best site-Clipart                  (2)  | Epoch:11 | Val Acc: 0.7544
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8043
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8311
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8644
 Best site-Painting                 (3)  | Epoch:11 | Val Acc: 0.8780
 Best site-Painting                 (3)  | Epoch:11 | Val Acc: 0.8615
 Best site-Painting                 (3)  | Epoch:11 | Val Acc: 0.8571
 Best site-Painting                 (3)  | Epoch:11 | Val Acc: 0.8512
 Best site-Sketch                   (1)  | Epoch:11 | Val Acc: 0.6222
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.7397
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.7692
 Best site-Infograph                (1)  | Epoch:11 | Val Acc: 0.5000
 Best site-Infograph                (0)  | Epoch:11 | Val Acc: 0.5604
 Best site-QuickDraw                (5)  | Epoch:11 | Val Acc: 0.2500
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 12 ============
cnt=[7, 9, 2, 6, 1, 2, ]
cnt=[4, 1, 7, 10, 2, 3, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Real                      (5) | Train Loss: 0.6225 | Train Acc: 0.7500
 Site-Real                      (5) | Train Loss: 0.5005 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.2064 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.4565 | Train Acc: 0.9062
 Site-Real                      (3) | Train Loss: 0.4211 | Train Acc: 0.9038
 Site-Real                      (2) | Train Loss: 0.3055 | Train Acc: 0.9881
 Site-Real                      (3) | Train Loss: 0.3016 | Train Acc: 0.9478
 Site-Real                      (1) | Train Loss: 0.3350 | Train Acc: 0.9302
 Site-Real                      (3) | Train Loss: 0.3797 | Train Acc: 0.9420
 Site-Real                      (3) | Train Loss: 0.3517 | Train Acc: 0.9529
 Site-Clipart                   (0) | Train Loss: 0.5792 | Train Acc: 0.8571
 Site-Clipart                   (1) | Train Loss: 0.6612 | Train Acc: 0.8182
 Site-Clipart                   (1) | Train Loss: 0.8250 | Train Acc: 0.7407
 Site-Clipart                   (0) | Train Loss: 0.6135 | Train Acc: 0.8372
 Site-Clipart                   (0) | Train Loss: 0.5853 | Train Acc: 0.8913
 Site-Clipart                   (0) | Train Loss: 0.7130 | Train Acc: 0.7883
 Site-Clipart                   (1) | Train Loss: 0.6727 | Train Acc: 0.8282
 Site-Painting                  (1) | Train Loss: 0.6388 | Train Acc: 0.8197
 Site-Painting                  (1) | Train Loss: 0.5778 | Train Acc: 0.8776
 Site-Painting                  (1) | Train Loss: 0.5932 | Train Acc: 0.8535
 Site-Painting                  (1) | Train Loss: 0.5996 | Train Acc: 0.8492
 Site-Sketch                    (0) | Train Loss: 0.6474 | Train Acc: 0.7941
 Site-Sketch                    (0) | Train Loss: 0.6872 | Train Acc: 0.8273
 Site-Sketch                    (0) | Train Loss: 0.8876 | Train Acc: 0.7159
 Site-Infograph                 (1) | Train Loss: 1.7274 | Train Acc: 0.4353
 Site-Infograph                 (3) | Train Loss: 1.4914 | Train Acc: 0.5441
 Site-QuickDraw                 (4) | Train Loss: 1.8962 | Train Acc: 0.4130
Average Train Accuracy: 0.8165
 Site-Real                      (5) | Val  Loss: 0.0678 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.2074 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.2441 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.3726 | Val  Acc: 0.9048
 Site-Real                      (3) | Val  Loss: 0.4375 | Val  Acc: 0.8857
 Site-Real                      (2) | Val  Loss: 0.2986 | Val  Acc: 0.9821
 Site-Real                      (3) | Val  Loss: 0.3398 | Val  Acc: 0.9551
 Site-Real                      (1) | Val  Loss: 0.4849 | Val  Acc: 0.9371
 Site-Real                      (3) | Val  Loss: 0.3603 | Val  Acc: 0.9520
 Site-Real                      (3) | Val  Loss: 0.3609 | Val  Acc: 0.9373
 Site-Clipart                   (0) | Val  Loss: 0.6879 | Val  Acc: 0.7857
 Site-Clipart                   (1) | Val  Loss: 0.5774 | Val  Acc: 0.8636
 Site-Clipart                   (1) | Val  Loss: 0.7298 | Val  Acc: 0.8056
 Site-Clipart                   (0) | Val  Loss: 0.8234 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 0.7446 | Val  Acc: 0.7609
 Site-Clipart                   (0) | Val  Loss: 0.6675 | Val  Acc: 0.8378
 Site-Clipart                   (1) | Val  Loss: 0.7451 | Val  Acc: 0.8390
 Site-Painting                  (1) | Val  Loss: 0.6910 | Val  Acc: 0.8293
 Site-Painting                  (1) | Val  Loss: 0.8372 | Val  Acc: 0.8615
 Site-Painting                  (1) | Val  Loss: 0.5357 | Val  Acc: 0.8857
 Site-Painting                  (1) | Val  Loss: 0.5329 | Val  Acc: 0.8690
 Site-Sketch                    (0) | Val  Loss: 0.9810 | Val  Acc: 0.7778
 Site-Sketch                    (0) | Val  Loss: 0.8105 | Val  Acc: 0.7123
 Site-Sketch                    (0) | Val  Loss: 0.7816 | Val  Acc: 0.7692
 Site-Infograph                 (1) | Val  Loss: 1.3187 | Val  Acc: 0.5714
 Site-Infograph                 (3) | Val  Loss: 1.4509 | Val  Acc: 0.5055
 Site-QuickDraw                 (4) | Val  Loss: 1.9268 | Val  Acc: 0.3370
Average Valid Accuracy: 0.8234
 Best site-Real                     (5)  | Epoch:12 | Val Acc: 1.0000
 Best site-Real                     (5)  | Epoch:12 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9048
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.8857
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9821
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9551
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9371
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9520
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9373
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.7857
 Best site-Clipart                  (1)  | Epoch:12 | Val Acc: 0.8636
 Best site-Clipart                  (1)  | Epoch:12 | Val Acc: 0.8056
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.7609
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8378
 Best site-Clipart                  (1)  | Epoch:12 | Val Acc: 0.8390
 Best site-Painting                 (1)  | Epoch:12 | Val Acc: 0.8293
 Best site-Painting                 (1)  | Epoch:12 | Val Acc: 0.8615
 Best site-Painting                 (1)  | Epoch:12 | Val Acc: 0.8857
 Best site-Painting                 (1)  | Epoch:12 | Val Acc: 0.8690
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.7778
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.7123
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.7692
 Best site-Infograph                (1)  | Epoch:12 | Val Acc: 0.5714
 Best site-Infograph                (3)  | Epoch:12 | Val Acc: 0.5055
 Best site-QuickDraw                (4)  | Epoch:12 | Val Acc: 0.3370
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 13 ============
cnt=[6, 4, 1, 3, 8, 5, ]
cnt=[9, 1, 1, 1, 4, 11, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Real                      (3) | Train Loss: 0.6326 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.4648 | Train Acc: 0.8333
 Site-Real                      (4) | Train Loss: 0.1794 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.3905 | Train Acc: 0.9062
 Site-Real                      (4) | Train Loss: 0.3867 | Train Acc: 0.9038
 Site-Real                      (0) | Train Loss: 0.2198 | Train Acc: 0.9881
 Site-Real                      (0) | Train Loss: 0.2532 | Train Acc: 0.9478
 Site-Real                      (0) | Train Loss: 0.3804 | Train Acc: 0.9535
 Site-Real                      (0) | Train Loss: 0.3671 | Train Acc: 0.9391
 Site-Real                      (3) | Train Loss: 0.3237 | Train Acc: 0.9601
 Site-Clipart                   (1) | Train Loss: 0.6046 | Train Acc: 0.9048
 Site-Clipart                   (5) | Train Loss: 0.6559 | Train Acc: 0.8485
 Site-Clipart                   (0) | Train Loss: 0.7734 | Train Acc: 0.7778
 Site-Clipart                   (5) | Train Loss: 0.7839 | Train Acc: 0.8140
 Site-Clipart                   (5) | Train Loss: 0.6356 | Train Acc: 0.8478
 Site-Clipart                   (5) | Train Loss: 0.7287 | Train Acc: 0.8018
 Site-Clipart                   (5) | Train Loss: 0.6375 | Train Acc: 0.8535
 Site-Painting                  (4) | Train Loss: 0.6052 | Train Acc: 0.8197
 Site-Painting                  (4) | Train Loss: 0.5421 | Train Acc: 0.8571
 Site-Painting                  (4) | Train Loss: 0.5655 | Train Acc: 0.8662
 Site-Painting                  (4) | Train Loss: 0.5541 | Train Acc: 0.8611
 Site-Sketch                    (1) | Train Loss: 0.7318 | Train Acc: 0.8824
 Site-Sketch                    (1) | Train Loss: 0.6901 | Train Acc: 0.8273
 Site-Sketch                    (1) | Train Loss: 0.7317 | Train Acc: 0.7955
 Site-Infograph                 (0) | Train Loss: 1.6119 | Train Acc: 0.4471
 Site-Infograph                 (4) | Train Loss: 1.4503 | Train Acc: 0.5294
 Site-QuickDraw                 (2) | Train Loss: 1.6613 | Train Acc: 0.4710
Average Train Accuracy: 0.8291
 Site-Real                      (3) | Val  Loss: 0.0765 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.2135 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.2108 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.3264 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.4260 | Val  Acc: 0.9143
 Site-Real                      (0) | Val  Loss: 0.2891 | Val  Acc: 0.9464
 Site-Real                      (0) | Val  Loss: 0.3609 | Val  Acc: 0.9551
 Site-Real                      (0) | Val  Loss: 0.4409 | Val  Acc: 0.9580
 Site-Real                      (0) | Val  Loss: 0.3675 | Val  Acc: 0.9520
 Site-Real                      (3) | Val  Loss: 0.3535 | Val  Acc: 0.9373
 Site-Clipart                   (1) | Val  Loss: 0.9027 | Val  Acc: 0.7143
 Site-Clipart                   (5) | Val  Loss: 0.5268 | Val  Acc: 0.8636
 Site-Clipart                   (0) | Val  Loss: 0.7917 | Val  Acc: 0.7222
 Site-Clipart                   (5) | Val  Loss: 0.7906 | Val  Acc: 0.7719
 Site-Clipart                   (5) | Val  Loss: 0.7322 | Val  Acc: 0.7935
 Site-Clipart                   (5) | Val  Loss: 0.6307 | Val  Acc: 0.8446
 Site-Clipart                   (5) | Val  Loss: 0.6937 | Val  Acc: 0.8517
 Site-Painting                  (4) | Val  Loss: 0.7301 | Val  Acc: 0.8537
 Site-Painting                  (4) | Val  Loss: 0.6183 | Val  Acc: 0.9077
 Site-Painting                  (4) | Val  Loss: 0.4965 | Val  Acc: 0.8952
 Site-Painting                  (4) | Val  Loss: 0.4974 | Val  Acc: 0.8869
 Site-Sketch                    (1) | Val  Loss: 0.9710 | Val  Acc: 0.6667
 Site-Sketch                    (1) | Val  Loss: 0.8704 | Val  Acc: 0.7808
 Site-Sketch                    (1) | Val  Loss: 0.7215 | Val  Acc: 0.7863
 Site-Infograph                 (0) | Val  Loss: 1.3254 | Val  Acc: 0.6071
 Site-Infograph                 (4) | Val  Loss: 1.4213 | Val  Acc: 0.5495
 Site-QuickDraw                 (2) | Val  Loss: 1.9418 | Val  Acc: 0.3587
Average Valid Accuracy: 0.8322
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9143
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.9464
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.9551
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.9580
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.9520
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9373
 Best site-Clipart                  (1)  | Epoch:13 | Val Acc: 0.7143
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.8636
 Best site-Clipart                  (0)  | Epoch:13 | Val Acc: 0.7222
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.7719
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.7935
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.8446
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.8517
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.8537
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.9077
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.8952
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.8869
 Best site-Sketch                   (1)  | Epoch:13 | Val Acc: 0.6667
 Best site-Sketch                   (1)  | Epoch:13 | Val Acc: 0.7808
 Best site-Sketch                   (1)  | Epoch:13 | Val Acc: 0.7863
 Best site-Infograph                (0)  | Epoch:13 | Val Acc: 0.6071
 Best site-Infograph                (4)  | Epoch:13 | Val Acc: 0.5495
 Best site-QuickDraw                (2)  | Epoch:13 | Val Acc: 0.3587
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 14 ============
cnt=[9, 1, 2, 3, 1, 11, ]
cnt=[3, 4, 1, 10, 2, 7, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Real                      (1) | Train Loss: 0.6258 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.4538 | Train Acc: 0.8333
 Site-Real                      (0) | Train Loss: 0.1785 | Train Acc: 1.0000
 Site-Real                      (5) | Train Loss: 0.4014 | Train Acc: 0.9375
 Site-Real                      (0) | Train Loss: 0.3989 | Train Acc: 0.9231
 Site-Real                      (0) | Train Loss: 0.3438 | Train Acc: 0.9762
 Site-Real                      (3) | Train Loss: 0.2408 | Train Acc: 0.9552
 Site-Real                      (0) | Train Loss: 0.3087 | Train Acc: 0.9302
 Site-Real                      (0) | Train Loss: 0.3612 | Train Acc: 0.9449
 Site-Real                      (3) | Train Loss: 0.3239 | Train Acc: 0.9529
 Site-Clipart                   (5) | Train Loss: 0.5870 | Train Acc: 0.9048
 Site-Clipart                   (5) | Train Loss: 0.5544 | Train Acc: 0.9697
 Site-Clipart                   (5) | Train Loss: 0.7658 | Train Acc: 0.7963
 Site-Clipart                   (5) | Train Loss: 0.6744 | Train Acc: 0.8256
 Site-Clipart                   (5) | Train Loss: 0.6149 | Train Acc: 0.8986
 Site-Clipart                   (5) | Train Loss: 0.7123 | Train Acc: 0.8108
 Site-Clipart                   (5) | Train Loss: 0.5966 | Train Acc: 0.8507
 Site-Painting                  (0) | Train Loss: 0.5900 | Train Acc: 0.8525
 Site-Painting                  (5) | Train Loss: 0.5025 | Train Acc: 0.8673
 Site-Painting                  (0) | Train Loss: 0.5409 | Train Acc: 0.8662
 Site-Painting                  (0) | Train Loss: 0.5127 | Train Acc: 0.8810
 Site-Sketch                    (5) | Train Loss: 0.4345 | Train Acc: 0.8676
 Site-Sketch                    (2) | Train Loss: 0.6201 | Train Acc: 0.8545
 Site-Sketch                    (2) | Train Loss: 0.7097 | Train Acc: 0.8011
 Site-Infograph                 (0) | Train Loss: 1.6659 | Train Acc: 0.4588
 Site-Infograph                 (5) | Train Loss: 1.2737 | Train Acc: 0.5515
 Site-QuickDraw                 (4) | Train Loss: 1.6606 | Train Acc: 0.5145
Average Train Accuracy: 0.8435
 Site-Real                      (1) | Val  Loss: 0.0642 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.1837 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.1993 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.3580 | Val  Acc: 0.9048
 Site-Real                      (0) | Val  Loss: 0.3752 | Val  Acc: 0.9143
 Site-Real                      (0) | Val  Loss: 0.3112 | Val  Acc: 0.9464
 Site-Real                      (3) | Val  Loss: 0.3018 | Val  Acc: 0.9663
 Site-Real                      (0) | Val  Loss: 0.4213 | Val  Acc: 0.9301
 Site-Real                      (0) | Val  Loss: 0.3398 | Val  Acc: 0.9520
 Site-Real                      (3) | Val  Loss: 0.3335 | Val  Acc: 0.9455
 Site-Clipart                   (5) | Val  Loss: 0.7320 | Val  Acc: 0.7857
 Site-Clipart                   (5) | Val  Loss: 0.4667 | Val  Acc: 0.8182
 Site-Clipart                   (5) | Val  Loss: 0.7114 | Val  Acc: 0.8056
 Site-Clipart                   (5) | Val  Loss: 0.8042 | Val  Acc: 0.7368
 Site-Clipart                   (5) | Val  Loss: 0.6860 | Val  Acc: 0.7826
 Site-Clipart                   (5) | Val  Loss: 0.6478 | Val  Acc: 0.8041
 Site-Clipart                   (5) | Val  Loss: 0.7106 | Val  Acc: 0.8263
 Site-Painting                  (0) | Val  Loss: 0.6686 | Val  Acc: 0.8293
 Site-Painting                  (5) | Val  Loss: 0.4827 | Val  Acc: 0.8462
 Site-Painting                  (0) | Val  Loss: 0.4591 | Val  Acc: 0.9238
 Site-Painting                  (0) | Val  Loss: 0.5350 | Val  Acc: 0.8571
 Site-Sketch                    (5) | Val  Loss: 0.8743 | Val  Acc: 0.6667
 Site-Sketch                    (2) | Val  Loss: 0.8610 | Val  Acc: 0.7397
 Site-Sketch                    (2) | Val  Loss: 0.6942 | Val  Acc: 0.8120
 Site-Infograph                 (0) | Val  Loss: 1.2559 | Val  Acc: 0.5714
 Site-Infograph                 (5) | Val  Loss: 1.3664 | Val  Acc: 0.5495
 Site-QuickDraw                 (4) | Val  Loss: 1.8582 | Val  Acc: 0.4022
Average Valid Accuracy: 0.8265
============ Train epoch 15 ============
cnt=[10, 5, 1, 6, 1, 4, ]
cnt=[4, 10, 9, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Real                      (5) | Train Loss: 0.6732 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.4691 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.1690 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.4856 | Train Acc: 0.9062
 Site-Real                      (1) | Train Loss: 0.3951 | Train Acc: 0.9231
 Site-Real                      (5) | Train Loss: 0.2424 | Train Acc: 0.9762
 Site-Real                      (5) | Train Loss: 0.2469 | Train Acc: 0.9627
 Site-Real                      (5) | Train Loss: 0.3091 | Train Acc: 0.9442
 Site-Real                      (1) | Train Loss: 0.3379 | Train Acc: 0.9420
 Site-Real                      (1) | Train Loss: 0.3041 | Train Acc: 0.9529
 Site-Clipart                   (0) | Train Loss: 0.5934 | Train Acc: 0.8571
 Site-Clipart                   (1) | Train Loss: 0.6064 | Train Acc: 0.8788
 Site-Clipart                   (1) | Train Loss: 0.6565 | Train Acc: 0.7963
 Site-Clipart                   (3) | Train Loss: 0.5822 | Train Acc: 0.8023
 Site-Clipart                   (0) | Train Loss: 0.5579 | Train Acc: 0.8623
 Site-Clipart                   (3) | Train Loss: 0.6532 | Train Acc: 0.8198
 Site-Clipart                   (0) | Train Loss: 0.5817 | Train Acc: 0.8620
 Site-Painting                  (0) | Train Loss: 0.6235 | Train Acc: 0.8033
 Site-Painting                  (0) | Train Loss: 0.4625 | Train Acc: 0.8673
 Site-Painting                  (0) | Train Loss: 0.5183 | Train Acc: 0.8535
 Site-Painting                  (0) | Train Loss: 0.5132 | Train Acc: 0.8810
 Site-Sketch                    (3) | Train Loss: 0.6414 | Train Acc: 0.8235
 Site-Sketch                    (3) | Train Loss: 0.6757 | Train Acc: 0.7818
 Site-Sketch                    (3) | Train Loss: 0.6899 | Train Acc: 0.7841
 Site-Infograph                 (0) | Train Loss: 1.6540 | Train Acc: 0.4235
 Site-Infograph                 (0) | Train Loss: 1.2498 | Train Acc: 0.5809
 Site-QuickDraw                 (2) | Train Loss: 1.5121 | Train Acc: 0.5217
Average Train Accuracy: 0.8293
 Site-Real                      (5) | Val  Loss: 0.0502 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.1561 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.1816 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.3183 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.4167 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.2725 | Val  Acc: 0.9464
 Site-Real                      (5) | Val  Loss: 0.2944 | Val  Acc: 0.9438
 Site-Real                      (5) | Val  Loss: 0.3901 | Val  Acc: 0.9510
 Site-Real                      (1) | Val  Loss: 0.3061 | Val  Acc: 0.9520
 Site-Real                      (1) | Val  Loss: 0.3198 | Val  Acc: 0.9401
 Site-Clipart                   (0) | Val  Loss: 0.6763 | Val  Acc: 0.7857
 Site-Clipart                   (1) | Val  Loss: 0.5312 | Val  Acc: 0.8636
 Site-Clipart                   (1) | Val  Loss: 0.6804 | Val  Acc: 0.8333
 Site-Clipart                   (3) | Val  Loss: 0.8268 | Val  Acc: 0.7018
 Site-Clipart                   (0) | Val  Loss: 0.6781 | Val  Acc: 0.7935
 Site-Clipart                   (3) | Val  Loss: 0.5872 | Val  Acc: 0.8514
 Site-Clipart                   (0) | Val  Loss: 0.6639 | Val  Acc: 0.8305
 Site-Painting                  (0) | Val  Loss: 0.6899 | Val  Acc: 0.8780
 Site-Painting                  (0) | Val  Loss: 0.7855 | Val  Acc: 0.8462
 Site-Painting                  (0) | Val  Loss: 0.4117 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.4715 | Val  Acc: 0.8750
 Site-Sketch                    (3) | Val  Loss: 0.8298 | Val  Acc: 0.7111
 Site-Sketch                    (3) | Val  Loss: 0.8745 | Val  Acc: 0.7808
 Site-Sketch                    (3) | Val  Loss: 0.6893 | Val  Acc: 0.8291
 Site-Infograph                 (0) | Val  Loss: 1.2980 | Val  Acc: 0.5357
 Site-Infograph                 (0) | Val  Loss: 1.3000 | Val  Acc: 0.5934
 Site-QuickDraw                 (2) | Val  Loss: 1.8208 | Val  Acc: 0.4239
Average Valid Accuracy: 0.8402
 Best site-Real                     (5)  | Epoch:15 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:15 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:15 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9143
 Best site-Real                     (5)  | Epoch:15 | Val Acc: 0.9464
 Best site-Real                     (5)  | Epoch:15 | Val Acc: 0.9438
 Best site-Real                     (5)  | Epoch:15 | Val Acc: 0.9510
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9520
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9401
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.7857
 Best site-Clipart                  (1)  | Epoch:15 | Val Acc: 0.8636
 Best site-Clipart                  (1)  | Epoch:15 | Val Acc: 0.8333
 Best site-Clipart                  (3)  | Epoch:15 | Val Acc: 0.7018
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.7935
 Best site-Clipart                  (3)  | Epoch:15 | Val Acc: 0.8514
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8305
 Best site-Painting                 (0)  | Epoch:15 | Val Acc: 0.8780
 Best site-Painting                 (0)  | Epoch:15 | Val Acc: 0.8462
 Best site-Painting                 (0)  | Epoch:15 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:15 | Val Acc: 0.8750
 Best site-Sketch                   (3)  | Epoch:15 | Val Acc: 0.7111
 Best site-Sketch                   (3)  | Epoch:15 | Val Acc: 0.7808
 Best site-Sketch                   (3)  | Epoch:15 | Val Acc: 0.8291
 Best site-Infograph                (0)  | Epoch:15 | Val Acc: 0.5357
 Best site-Infograph                (0)  | Epoch:15 | Val Acc: 0.5934
 Best site-QuickDraw                (2)  | Epoch:15 | Val Acc: 0.4239
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 16 ============
cnt=[5, 6, 1, 2, 5, 8, ]
cnt=[13, 2, 1, 7, 3, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Real                      (0) | Train Loss: 0.6672 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.4183 | Train Acc: 0.8333
 Site-Real                      (4) | Train Loss: 0.1760 | Train Acc: 1.0000
 Site-Real                      (1) | Train Loss: 0.3588 | Train Acc: 0.9375
 Site-Real                      (5) | Train Loss: 0.3411 | Train Acc: 0.9231
 Site-Real                      (4) | Train Loss: 0.2021 | Train Acc: 0.9762
 Site-Real                      (4) | Train Loss: 0.2695 | Train Acc: 0.9627
 Site-Real                      (1) | Train Loss: 0.2868 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.3131 | Train Acc: 0.9478
 Site-Real                      (4) | Train Loss: 0.2984 | Train Acc: 0.9565
 Site-Clipart                   (5) | Train Loss: 0.5893 | Train Acc: 0.8095
 Site-Clipart                   (5) | Train Loss: 0.5084 | Train Acc: 0.8788
 Site-Clipart                   (1) | Train Loss: 0.6728 | Train Acc: 0.8148
 Site-Clipart                   (5) | Train Loss: 0.6646 | Train Acc: 0.8023
 Site-Clipart                   (5) | Train Loss: 0.4900 | Train Acc: 0.8913
 Site-Clipart                   (5) | Train Loss: 0.6129 | Train Acc: 0.8468
 Site-Clipart                   (1) | Train Loss: 0.5611 | Train Acc: 0.8789
 Site-Painting                  (5) | Train Loss: 0.6059 | Train Acc: 0.7869
 Site-Painting                  (1) | Train Loss: 0.4957 | Train Acc: 0.8673
 Site-Painting                  (1) | Train Loss: 0.5617 | Train Acc: 0.8599
 Site-Painting                  (0) | Train Loss: 0.4982 | Train Acc: 0.8929
 Site-Sketch                    (5) | Train Loss: 0.9323 | Train Acc: 0.8529
 Site-Sketch                    (3) | Train Loss: 0.6096 | Train Acc: 0.8182
 Site-Sketch                    (3) | Train Loss: 0.7167 | Train Acc: 0.8068
 Site-Infograph                 (0) | Train Loss: 1.8173 | Train Acc: 0.4353
 Site-Infograph                 (0) | Train Loss: 1.2534 | Train Acc: 0.5294
 Site-QuickDraw                 (2) | Train Loss: 1.5076 | Train Acc: 0.6159
Average Train Accuracy: 0.8376
 Site-Real                      (0) | Val  Loss: 0.0604 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.1484 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.1761 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.2908 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.3611 | Val  Acc: 0.9429
 Site-Real                      (4) | Val  Loss: 0.3045 | Val  Acc: 0.9464
 Site-Real                      (4) | Val  Loss: 0.3040 | Val  Acc: 0.9438
 Site-Real                      (1) | Val  Loss: 0.4164 | Val  Acc: 0.9231
 Site-Real                      (0) | Val  Loss: 0.3225 | Val  Acc: 0.9476
 Site-Real                      (4) | Val  Loss: 0.3065 | Val  Acc: 0.9319
 Site-Clipart                   (5) | Val  Loss: 0.6936 | Val  Acc: 0.6429
 Site-Clipart                   (5) | Val  Loss: 0.4824 | Val  Acc: 0.8182
 Site-Clipart                   (1) | Val  Loss: 0.6759 | Val  Acc: 0.8889
 Site-Clipart                   (5) | Val  Loss: 0.6785 | Val  Acc: 0.7719
 Site-Clipart                   (5) | Val  Loss: 0.6414 | Val  Acc: 0.8478
 Site-Clipart                   (5) | Val  Loss: 0.5345 | Val  Acc: 0.8716
 Site-Clipart                   (1) | Val  Loss: 0.6179 | Val  Acc: 0.8559
 Site-Painting                  (5) | Val  Loss: 0.6615 | Val  Acc: 0.9024
 Site-Painting                  (1) | Val  Loss: 0.4274 | Val  Acc: 0.8923
 Site-Painting                  (1) | Val  Loss: 0.4749 | Val  Acc: 0.9143
 Site-Painting                  (0) | Val  Loss: 0.4550 | Val  Acc: 0.8750
 Site-Sketch                    (5) | Val  Loss: 0.9078 | Val  Acc: 0.7111
 Site-Sketch                    (3) | Val  Loss: 0.8430 | Val  Acc: 0.7671
 Site-Sketch                    (3) | Val  Loss: 0.6407 | Val  Acc: 0.8120
 Site-Infograph                 (0) | Val  Loss: 1.3604 | Val  Acc: 0.5000
 Site-Infograph                 (0) | Val  Loss: 1.3220 | Val  Acc: 0.5604
 Site-QuickDraw                 (2) | Val  Loss: 1.7765 | Val  Acc: 0.4674
Average Valid Accuracy: 0.8403
 Best site-Real                     (0)  | Epoch:16 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:16 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:16 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:16 | Val Acc: 0.9524
 Best site-Real                     (5)  | Epoch:16 | Val Acc: 0.9429
 Best site-Real                     (4)  | Epoch:16 | Val Acc: 0.9464
 Best site-Real                     (4)  | Epoch:16 | Val Acc: 0.9438
 Best site-Real                     (1)  | Epoch:16 | Val Acc: 0.9231
 Best site-Real                     (0)  | Epoch:16 | Val Acc: 0.9476
 Best site-Real                     (4)  | Epoch:16 | Val Acc: 0.9319
 Best site-Clipart                  (5)  | Epoch:16 | Val Acc: 0.6429
 Best site-Clipart                  (5)  | Epoch:16 | Val Acc: 0.8182
 Best site-Clipart                  (1)  | Epoch:16 | Val Acc: 0.8889
 Best site-Clipart                  (5)  | Epoch:16 | Val Acc: 0.7719
 Best site-Clipart                  (5)  | Epoch:16 | Val Acc: 0.8478
 Best site-Clipart                  (5)  | Epoch:16 | Val Acc: 0.8716
 Best site-Clipart                  (1)  | Epoch:16 | Val Acc: 0.8559
 Best site-Painting                 (5)  | Epoch:16 | Val Acc: 0.9024
 Best site-Painting                 (1)  | Epoch:16 | Val Acc: 0.8923
 Best site-Painting                 (1)  | Epoch:16 | Val Acc: 0.9143
 Best site-Painting                 (0)  | Epoch:16 | Val Acc: 0.8750
 Best site-Sketch                   (5)  | Epoch:16 | Val Acc: 0.7111
 Best site-Sketch                   (3)  | Epoch:16 | Val Acc: 0.7671
 Best site-Sketch                   (3)  | Epoch:16 | Val Acc: 0.8120
 Best site-Infograph                (0)  | Epoch:16 | Val Acc: 0.5000
 Best site-Infograph                (0)  | Epoch:16 | Val Acc: 0.5604
 Best site-QuickDraw                (2)  | Epoch:16 | Val Acc: 0.4674
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 17 ============
cnt=[8, 5, 4, 1, 7, 2, ]
cnt=[7, 13, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Real                      (0) | Train Loss: 0.6170 | Train Acc: 0.7500
 Site-Real                      (0) | Train Loss: 0.4265 | Train Acc: 0.8333
 Site-Real                      (4) | Train Loss: 0.1523 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.4106 | Train Acc: 0.9062
 Site-Real                      (0) | Train Loss: 0.3498 | Train Acc: 0.9231
 Site-Real                      (4) | Train Loss: 0.2247 | Train Acc: 0.9762
 Site-Real                      (5) | Train Loss: 0.2570 | Train Acc: 0.9627
 Site-Real                      (4) | Train Loss: 0.3072 | Train Acc: 0.9442
 Site-Real                      (0) | Train Loss: 0.3118 | Train Acc: 0.9420
 Site-Real                      (5) | Train Loss: 0.2859 | Train Acc: 0.9601
 Site-Clipart                   (1) | Train Loss: 0.5993 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.5523 | Train Acc: 0.8788
 Site-Clipart                   (2) | Train Loss: 0.7276 | Train Acc: 0.8148
 Site-Clipart                   (1) | Train Loss: 0.5829 | Train Acc: 0.8372
 Site-Clipart                   (2) | Train Loss: 0.4924 | Train Acc: 0.8986
 Site-Clipart                   (2) | Train Loss: 0.6292 | Train Acc: 0.8243
 Site-Clipart                   (2) | Train Loss: 0.5258 | Train Acc: 0.8732
 Site-Painting                  (4) | Train Loss: 0.5206 | Train Acc: 0.8525
 Site-Painting                  (4) | Train Loss: 0.4923 | Train Acc: 0.8878
 Site-Painting                  (4) | Train Loss: 0.5168 | Train Acc: 0.8599
 Site-Painting                  (0) | Train Loss: 0.5095 | Train Acc: 0.8730
 Site-Sketch                    (1) | Train Loss: 1.2056 | Train Acc: 0.8382
 Site-Sketch                    (1) | Train Loss: 0.6175 | Train Acc: 0.8091
 Site-Sketch                    (1) | Train Loss: 0.6926 | Train Acc: 0.7898
 Site-Infograph                 (4) | Train Loss: 1.6017 | Train Acc: 0.4706
 Site-Infograph                 (0) | Train Loss: 1.3926 | Train Acc: 0.6176
 Site-QuickDraw                 (3) | Train Loss: 1.5437 | Train Acc: 0.5652
Average Train Accuracy: 0.8424
 Site-Real                      (0) | Val  Loss: 0.0504 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.1574 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.1481 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.2888 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.3368 | Val  Acc: 0.9714
 Site-Real                      (4) | Val  Loss: 0.2448 | Val  Acc: 0.9643
 Site-Real                      (5) | Val  Loss: 0.2662 | Val  Acc: 0.9775
 Site-Real                      (4) | Val  Loss: 0.3653 | Val  Acc: 0.9580
 Site-Real                      (0) | Val  Loss: 0.2942 | Val  Acc: 0.9520
 Site-Real                      (5) | Val  Loss: 0.2875 | Val  Acc: 0.9455
 Site-Clipart                   (1) | Val  Loss: 0.6329 | Val  Acc: 0.6429
 Site-Clipart                   (0) | Val  Loss: 0.5212 | Val  Acc: 0.8636
 Site-Clipart                   (2) | Val  Loss: 0.7234 | Val  Acc: 0.7778
 Site-Clipart                   (1) | Val  Loss: 0.6647 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.5939 | Val  Acc: 0.8370
 Site-Clipart                   (2) | Val  Loss: 0.5807 | Val  Acc: 0.8446
 Site-Clipart                   (2) | Val  Loss: 0.6064 | Val  Acc: 0.8602
 Site-Painting                  (4) | Val  Loss: 0.6508 | Val  Acc: 0.8049
 Site-Painting                  (4) | Val  Loss: 0.4637 | Val  Acc: 0.8769
 Site-Painting                  (4) | Val  Loss: 0.4375 | Val  Acc: 0.9143
 Site-Painting                  (0) | Val  Loss: 0.4831 | Val  Acc: 0.8631
 Site-Sketch                    (1) | Val  Loss: 0.9071 | Val  Acc: 0.7111
 Site-Sketch                    (1) | Val  Loss: 0.8089 | Val  Acc: 0.7534
 Site-Sketch                    (1) | Val  Loss: 0.6674 | Val  Acc: 0.7778
 Site-Infograph                 (4) | Val  Loss: 1.2532 | Val  Acc: 0.5714
 Site-Infograph                 (0) | Val  Loss: 1.3608 | Val  Acc: 0.5604
 Site-QuickDraw                 (3) | Val  Loss: 1.6889 | Val  Acc: 0.4783
Average Valid Accuracy: 0.8408
 Best site-Real                     (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:17 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:17 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:17 | Val Acc: 0.9714
 Best site-Real                     (4)  | Epoch:17 | Val Acc: 0.9643
 Best site-Real                     (5)  | Epoch:17 | Val Acc: 0.9775
 Best site-Real                     (4)  | Epoch:17 | Val Acc: 0.9580
 Best site-Real                     (0)  | Epoch:17 | Val Acc: 0.9520
 Best site-Real                     (5)  | Epoch:17 | Val Acc: 0.9455
 Best site-Clipart                  (1)  | Epoch:17 | Val Acc: 0.6429
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8636
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.7778
 Best site-Clipart                  (1)  | Epoch:17 | Val Acc: 0.8421
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8370
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8446
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8602
 Best site-Painting                 (4)  | Epoch:17 | Val Acc: 0.8049
 Best site-Painting                 (4)  | Epoch:17 | Val Acc: 0.8769
 Best site-Painting                 (4)  | Epoch:17 | Val Acc: 0.9143
 Best site-Painting                 (0)  | Epoch:17 | Val Acc: 0.8631
 Best site-Sketch                   (1)  | Epoch:17 | Val Acc: 0.7111
 Best site-Sketch                   (1)  | Epoch:17 | Val Acc: 0.7534
 Best site-Sketch                   (1)  | Epoch:17 | Val Acc: 0.7778
 Best site-Infograph                (4)  | Epoch:17 | Val Acc: 0.5714
 Best site-Infograph                (0)  | Epoch:17 | Val Acc: 0.5604
 Best site-QuickDraw                (3)  | Epoch:17 | Val Acc: 0.4783
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 18 ============
cnt=[4, 2, 1, 6, 8, 6, ]
cnt=[4, 3, 1, 10, 2, 7, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Real                      (0) | Train Loss: 0.6445 | Train Acc: 0.7500
 Site-Real                      (0) | Train Loss: 0.4285 | Train Acc: 0.9167
 Site-Real                      (0) | Train Loss: 0.1227 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.3466 | Train Acc: 0.9375
 Site-Real                      (1) | Train Loss: 0.3757 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.1735 | Train Acc: 0.9881
 Site-Real                      (0) | Train Loss: 0.3527 | Train Acc: 0.9552
 Site-Real                      (3) | Train Loss: 0.2999 | Train Acc: 0.9488
 Site-Real                      (3) | Train Loss: 0.2916 | Train Acc: 0.9449
 Site-Real                      (3) | Train Loss: 0.2859 | Train Acc: 0.9547
 Site-Clipart                   (4) | Train Loss: 0.5910 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.5009 | Train Acc: 0.8788
 Site-Clipart                   (5) | Train Loss: 0.5559 | Train Acc: 0.8519
 Site-Clipart                   (4) | Train Loss: 0.5723 | Train Acc: 0.8256
 Site-Clipart                   (4) | Train Loss: 0.5120 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.6388 | Train Acc: 0.8288
 Site-Clipart                   (4) | Train Loss: 0.5247 | Train Acc: 0.8761
 Site-Painting                  (1) | Train Loss: 0.5213 | Train Acc: 0.8525
 Site-Painting                  (5) | Train Loss: 0.4758 | Train Acc: 0.8878
 Site-Painting                  (5) | Train Loss: 0.4389 | Train Acc: 0.8790
 Site-Painting                  (5) | Train Loss: 0.4597 | Train Acc: 0.8968
 Site-Sketch                    (4) | Train Loss: 0.3104 | Train Acc: 0.8676
 Site-Sketch                    (4) | Train Loss: 0.5743 | Train Acc: 0.8545
 Site-Sketch                    (4) | Train Loss: 0.6940 | Train Acc: 0.7955
 Site-Infograph                 (5) | Train Loss: 1.5578 | Train Acc: 0.4941
 Site-Infograph                 (5) | Train Loss: 1.0974 | Train Acc: 0.5882
 Site-QuickDraw                 (2) | Train Loss: 1.4776 | Train Acc: 0.5797
Average Train Accuracy: 0.8536
 Site-Real                      (0) | Val  Loss: 0.0656 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.1432 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.1554 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2843 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.3443 | Val  Acc: 0.9429
 Site-Real                      (3) | Val  Loss: 0.2688 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2771 | Val  Acc: 0.9326
 Site-Real                      (3) | Val  Loss: 0.4066 | Val  Acc: 0.9161
 Site-Real                      (3) | Val  Loss: 0.2794 | Val  Acc: 0.9607
 Site-Real                      (3) | Val  Loss: 0.2988 | Val  Acc: 0.9428
 Site-Clipart                   (4) | Val  Loss: 0.6416 | Val  Acc: 0.7857
 Site-Clipart                   (3) | Val  Loss: 0.3886 | Val  Acc: 0.8636
 Site-Clipart                   (5) | Val  Loss: 0.6305 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 0.7539 | Val  Acc: 0.7544
 Site-Clipart                   (4) | Val  Loss: 0.5575 | Val  Acc: 0.8478
 Site-Clipart                   (4) | Val  Loss: 0.5188 | Val  Acc: 0.8649
 Site-Clipart                   (4) | Val  Loss: 0.6163 | Val  Acc: 0.8432
 Site-Painting                  (1) | Val  Loss: 0.5962 | Val  Acc: 0.8780
 Site-Painting                  (5) | Val  Loss: 0.4233 | Val  Acc: 0.8923
 Site-Painting                  (5) | Val  Loss: 0.4567 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.4112 | Val  Acc: 0.8869
 Site-Sketch                    (4) | Val  Loss: 0.8827 | Val  Acc: 0.7556
 Site-Sketch                    (4) | Val  Loss: 0.8407 | Val  Acc: 0.7534
 Site-Sketch                    (4) | Val  Loss: 0.6133 | Val  Acc: 0.8034
 Site-Infograph                 (5) | Val  Loss: 1.3063 | Val  Acc: 0.5536
 Site-Infograph                 (5) | Val  Loss: 1.4385 | Val  Acc: 0.5275
 Site-QuickDraw                 (2) | Val  Loss: 1.7255 | Val  Acc: 0.4565
Average Valid Accuracy: 0.8461
 Best site-Real                     (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:18 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:18 | Val Acc: 0.9429
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:18 | Val Acc: 0.9326
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9161
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9607
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9428
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.7857
 Best site-Clipart                  (3)  | Epoch:18 | Val Acc: 0.8636
 Best site-Clipart                  (5)  | Epoch:18 | Val Acc: 0.8333
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.7544
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8478
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8649
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8432
 Best site-Painting                 (1)  | Epoch:18 | Val Acc: 0.8780
 Best site-Painting                 (5)  | Epoch:18 | Val Acc: 0.8923
 Best site-Painting                 (5)  | Epoch:18 | Val Acc: 0.9333
 Best site-Painting                 (5)  | Epoch:18 | Val Acc: 0.8869
 Best site-Sketch                   (4)  | Epoch:18 | Val Acc: 0.7556
 Best site-Sketch                   (4)  | Epoch:18 | Val Acc: 0.7534
 Best site-Sketch                   (4)  | Epoch:18 | Val Acc: 0.8034
 Best site-Infograph                (5)  | Epoch:18 | Val Acc: 0.5536
 Best site-Infograph                (5)  | Epoch:18 | Val Acc: 0.5275
 Best site-QuickDraw                (2)  | Epoch:18 | Val Acc: 0.4565
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 19 ============
cnt=[13, 1, 1, 4, 3, 5, ]
cnt=[2, 13, 7, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Real                      (1) | Train Loss: 0.6473 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.4345 | Train Acc: 0.8333
 Site-Real                      (0) | Train Loss: 0.1930 | Train Acc: 0.9500
 Site-Real                      (0) | Train Loss: 0.3919 | Train Acc: 0.9062
 Site-Real                      (0) | Train Loss: 0.3181 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.2635 | Train Acc: 0.9881
 Site-Real                      (3) | Train Loss: 0.2045 | Train Acc: 0.9627
 Site-Real                      (0) | Train Loss: 0.2537 | Train Acc: 0.9442
 Site-Real                      (0) | Train Loss: 0.3119 | Train Acc: 0.9449
 Site-Real                      (3) | Train Loss: 0.2666 | Train Acc: 0.9620
 Site-Clipart                   (4) | Train Loss: 0.6095 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.4320 | Train Acc: 0.9394
 Site-Clipart                   (0) | Train Loss: 0.6202 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.5387 | Train Acc: 0.8488
 Site-Clipart                   (5) | Train Loss: 0.5244 | Train Acc: 0.9058
 Site-Clipart                   (5) | Train Loss: 0.5977 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.5101 | Train Acc: 0.8789
 Site-Painting                  (0) | Train Loss: 0.5488 | Train Acc: 0.8197
 Site-Painting                  (0) | Train Loss: 0.4997 | Train Acc: 0.8878
 Site-Painting                  (0) | Train Loss: 0.4678 | Train Acc: 0.8726
 Site-Painting                  (0) | Train Loss: 0.4665 | Train Acc: 0.9008
 Site-Sketch                    (4) | Train Loss: 0.4181 | Train Acc: 0.8529
 Site-Sketch                    (5) | Train Loss: 0.6099 | Train Acc: 0.8182
 Site-Sketch                    (4) | Train Loss: 0.6277 | Train Acc: 0.8011
 Site-Infograph                 (0) | Train Loss: 1.4945 | Train Acc: 0.4824
 Site-Infograph                 (0) | Train Loss: 1.2491 | Train Acc: 0.5809
 Site-QuickDraw                 (2) | Train Loss: 1.4615 | Train Acc: 0.6087
Average Train Accuracy: 0.8476
 Site-Real                      (1) | Val  Loss: 0.0600 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.1204 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.1541 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.2959 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.3679 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.2172 | Val  Acc: 0.9821
 Site-Real                      (3) | Val  Loss: 0.2544 | Val  Acc: 0.9326
 Site-Real                      (0) | Val  Loss: 0.3669 | Val  Acc: 0.9301
 Site-Real                      (0) | Val  Loss: 0.2858 | Val  Acc: 0.9607
 Site-Real                      (3) | Val  Loss: 0.2686 | Val  Acc: 0.9401
 Site-Clipart                   (4) | Val  Loss: 0.5837 | Val  Acc: 0.7143
 Site-Clipart                   (0) | Val  Loss: 0.5248 | Val  Acc: 0.7727
 Site-Clipart                   (0) | Val  Loss: 0.6269 | Val  Acc: 0.8056
 Site-Clipart                   (5) | Val  Loss: 0.7030 | Val  Acc: 0.7544
 Site-Clipart                   (5) | Val  Loss: 0.6103 | Val  Acc: 0.8152
 Site-Clipart                   (5) | Val  Loss: 0.5112 | Val  Acc: 0.8784
 Site-Clipart                   (5) | Val  Loss: 0.5736 | Val  Acc: 0.8559
 Site-Painting                  (0) | Val  Loss: 0.5738 | Val  Acc: 0.8780
 Site-Painting                  (0) | Val  Loss: 0.4985 | Val  Acc: 0.8769
 Site-Painting                  (0) | Val  Loss: 0.4143 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.4245 | Val  Acc: 0.8690
 Site-Sketch                    (4) | Val  Loss: 0.8510 | Val  Acc: 0.7556
 Site-Sketch                    (5) | Val  Loss: 0.8197 | Val  Acc: 0.8082
 Site-Sketch                    (4) | Val  Loss: 0.6730 | Val  Acc: 0.7949
 Site-Infograph                 (0) | Val  Loss: 1.1757 | Val  Acc: 0.6250
 Site-Infograph                 (0) | Val  Loss: 1.3027 | Val  Acc: 0.5714
 Site-QuickDraw                 (2) | Val  Loss: 1.5734 | Val  Acc: 0.5217
Average Valid Accuracy: 0.8464
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:19 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:19 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:19 | Val Acc: 0.9143
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9821
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9326
 Best site-Real                     (0)  | Epoch:19 | Val Acc: 0.9301
 Best site-Real                     (0)  | Epoch:19 | Val Acc: 0.9607
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9401
 Best site-Clipart                  (4)  | Epoch:19 | Val Acc: 0.7143
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.7727
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8056
 Best site-Clipart                  (5)  | Epoch:19 | Val Acc: 0.7544
 Best site-Clipart                  (5)  | Epoch:19 | Val Acc: 0.8152
 Best site-Clipart                  (5)  | Epoch:19 | Val Acc: 0.8784
 Best site-Clipart                  (5)  | Epoch:19 | Val Acc: 0.8559
 Best site-Painting                 (0)  | Epoch:19 | Val Acc: 0.8780
 Best site-Painting                 (0)  | Epoch:19 | Val Acc: 0.8769
 Best site-Painting                 (0)  | Epoch:19 | Val Acc: 0.9429
 Best site-Painting                 (0)  | Epoch:19 | Val Acc: 0.8690
 Best site-Sketch                   (4)  | Epoch:19 | Val Acc: 0.7556
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8082
 Best site-Sketch                   (4)  | Epoch:19 | Val Acc: 0.7949
 Best site-Infograph                (0)  | Epoch:19 | Val Acc: 0.6250
 Best site-Infograph                (0)  | Epoch:19 | Val Acc: 0.5714
 Best site-QuickDraw                (2)  | Epoch:19 | Val Acc: 0.5217
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Test site-Real                      (1)| Epoch:19 | Test Acc: 0.9441
 Test site-Clipart                   (4)| Epoch:19 | Test Acc: 0.8498
 Test site-Painting                  (0)| Epoch:19 | Test Acc: 0.9095
 Test site-Sketch                    (4)| Epoch:19 | Test Acc: 0.8430
 Test site-Infograph                 (0)| Epoch:19 | Test Acc: 0.5449
 Test site-QuickDraw                 (2)| Epoch:19 | Test Acc: 0.5940
Real: 0.9441, Clipart: 0.8498, Painting: 0.9095, Sketch: 0.8430, Infograph: 0.5449, QuickDraw: 0.5940, 
Average Test Accuracy(group): 0.7809, Average Test Accuracy(individual): 0.8608,
domain std=0.1541, cluster std=0.1173, individual std=0.1141, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 20 ============
cnt=[5, 10, 1, 1, 4, 6, ]
cnt=[7, 10, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Real                      (3) | Train Loss: 0.6925 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.3897 | Train Acc: 0.8333
 Site-Real                      (1) | Train Loss: 0.1622 | Train Acc: 1.0000
 Site-Real                      (1) | Train Loss: 0.3650 | Train Acc: 0.9062
 Site-Real                      (4) | Train Loss: 0.3203 | Train Acc: 0.9038
 Site-Real                      (1) | Train Loss: 0.2091 | Train Acc: 0.9762
 Site-Real                      (1) | Train Loss: 0.1942 | Train Acc: 0.9627
 Site-Real                      (1) | Train Loss: 0.2417 | Train Acc: 0.9488
 Site-Real                      (1) | Train Loss: 0.2960 | Train Acc: 0.9449
 Site-Real                      (1) | Train Loss: 0.2658 | Train Acc: 0.9529
 Site-Clipart                   (0) | Train Loss: 0.5091 | Train Acc: 0.9048
 Site-Clipart                   (5) | Train Loss: 0.4910 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.6061 | Train Acc: 0.8519
 Site-Clipart                   (0) | Train Loss: 0.5151 | Train Acc: 0.8140
 Site-Clipart                   (5) | Train Loss: 0.3695 | Train Acc: 0.9058
 Site-Clipart                   (5) | Train Loss: 0.5558 | Train Acc: 0.8559
 Site-Clipart                   (5) | Train Loss: 0.4878 | Train Acc: 0.8789
 Site-Painting                  (4) | Train Loss: 0.5150 | Train Acc: 0.8525
 Site-Painting                  (1) | Train Loss: 0.4865 | Train Acc: 0.8980
 Site-Painting                  (1) | Train Loss: 0.4492 | Train Acc: 0.8599
 Site-Painting                  (1) | Train Loss: 0.4701 | Train Acc: 0.8889
 Site-Sketch                    (0) | Train Loss: 0.2961 | Train Acc: 0.9559
 Site-Sketch                    (0) | Train Loss: 0.5769 | Train Acc: 0.8364
 Site-Sketch                    (0) | Train Loss: 0.6695 | Train Acc: 0.7898
 Site-Infograph                 (4) | Train Loss: 1.6175 | Train Acc: 0.4824
 Site-Infograph                 (5) | Train Loss: 1.2047 | Train Acc: 0.6324
 Site-QuickDraw                 (2) | Train Loss: 1.2660 | Train Acc: 0.6304
Average Train Accuracy: 0.8565
 Site-Real                      (3) | Val  Loss: 0.0358 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.1191 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.1506 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.2603 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.3502 | Val  Acc: 0.8857
 Site-Real                      (1) | Val  Loss: 0.2252 | Val  Acc: 0.9643
 Site-Real                      (1) | Val  Loss: 0.2580 | Val  Acc: 0.9326
 Site-Real                      (1) | Val  Loss: 0.3024 | Val  Acc: 0.9650
 Site-Real                      (1) | Val  Loss: 0.2744 | Val  Acc: 0.9520
 Site-Real                      (1) | Val  Loss: 0.2653 | Val  Acc: 0.9482
 Site-Clipart                   (0) | Val  Loss: 0.6079 | Val  Acc: 0.7857
 Site-Clipart                   (5) | Val  Loss: 0.3027 | Val  Acc: 0.9545
 Site-Clipart                   (5) | Val  Loss: 0.5746 | Val  Acc: 0.8611
 Site-Clipart                   (0) | Val  Loss: 0.6276 | Val  Acc: 0.8246
 Site-Clipart                   (5) | Val  Loss: 0.5179 | Val  Acc: 0.8370
 Site-Clipart                   (5) | Val  Loss: 0.5066 | Val  Acc: 0.8514
 Site-Clipart                   (5) | Val  Loss: 0.5552 | Val  Acc: 0.8644
 Site-Painting                  (4) | Val  Loss: 0.6117 | Val  Acc: 0.8537
 Site-Painting                  (1) | Val  Loss: 0.6030 | Val  Acc: 0.8462
 Site-Painting                  (1) | Val  Loss: 0.4292 | Val  Acc: 0.9048
 Site-Painting                  (1) | Val  Loss: 0.4199 | Val  Acc: 0.8750
 Site-Sketch                    (0) | Val  Loss: 0.8127 | Val  Acc: 0.7111
 Site-Sketch                    (0) | Val  Loss: 0.7895 | Val  Acc: 0.7397
 Site-Sketch                    (0) | Val  Loss: 0.6585 | Val  Acc: 0.7949
 Site-Infograph                 (4) | Val  Loss: 1.2318 | Val  Acc: 0.5893
 Site-Infograph                 (5) | Val  Loss: 1.3753 | Val  Acc: 0.5495
 Site-QuickDraw                 (2) | Val  Loss: 1.5472 | Val  Acc: 0.5435
Average Valid Accuracy: 0.8513
 Best site-Real                     (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:20 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.8857
 Best site-Real                     (1)  | Epoch:20 | Val Acc: 0.9643
 Best site-Real                     (1)  | Epoch:20 | Val Acc: 0.9326
 Best site-Real                     (1)  | Epoch:20 | Val Acc: 0.9650
 Best site-Real                     (1)  | Epoch:20 | Val Acc: 0.9520
 Best site-Real                     (1)  | Epoch:20 | Val Acc: 0.9482
 Best site-Clipart                  (0)  | Epoch:20 | Val Acc: 0.7857
 Best site-Clipart                  (5)  | Epoch:20 | Val Acc: 0.9545
 Best site-Clipart                  (5)  | Epoch:20 | Val Acc: 0.8611
 Best site-Clipart                  (0)  | Epoch:20 | Val Acc: 0.8246
 Best site-Clipart                  (5)  | Epoch:20 | Val Acc: 0.8370
 Best site-Clipart                  (5)  | Epoch:20 | Val Acc: 0.8514
 Best site-Clipart                  (5)  | Epoch:20 | Val Acc: 0.8644
 Best site-Painting                 (4)  | Epoch:20 | Val Acc: 0.8537
 Best site-Painting                 (1)  | Epoch:20 | Val Acc: 0.8462
 Best site-Painting                 (1)  | Epoch:20 | Val Acc: 0.9048
 Best site-Painting                 (1)  | Epoch:20 | Val Acc: 0.8750
 Best site-Sketch                   (0)  | Epoch:20 | Val Acc: 0.7111
 Best site-Sketch                   (0)  | Epoch:20 | Val Acc: 0.7397
 Best site-Sketch                   (0)  | Epoch:20 | Val Acc: 0.7949
 Best site-Infograph                (4)  | Epoch:20 | Val Acc: 0.5893
 Best site-Infograph                (5)  | Epoch:20 | Val Acc: 0.5495
 Best site-QuickDraw                (2)  | Epoch:20 | Val Acc: 0.5435
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 21 ============
cnt=[8, 1, 3, 7, 5, 3, ]
cnt=[3, 7, 10, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Real                      (2) | Train Loss: 0.6217 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.4051 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.1330 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.4091 | Train Acc: 0.8750
 Site-Real                      (4) | Train Loss: 0.3337 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.1834 | Train Acc: 0.9762
 Site-Real                      (2) | Train Loss: 0.3064 | Train Acc: 0.9627
 Site-Real                      (3) | Train Loss: 0.2295 | Train Acc: 0.9581
 Site-Real                      (3) | Train Loss: 0.2627 | Train Acc: 0.9478
 Site-Real                      (3) | Train Loss: 0.2553 | Train Acc: 0.9565
 Site-Clipart                   (5) | Train Loss: 0.6181 | Train Acc: 0.8095
 Site-Clipart                   (3) | Train Loss: 0.4730 | Train Acc: 0.8788
 Site-Clipart                   (0) | Train Loss: 0.6692 | Train Acc: 0.7963
 Site-Clipart                   (0) | Train Loss: 0.4974 | Train Acc: 0.8837
 Site-Clipart                   (0) | Train Loss: 0.5451 | Train Acc: 0.8986
 Site-Clipart                   (0) | Train Loss: 0.5502 | Train Acc: 0.8378
 Site-Clipart                   (0) | Train Loss: 0.4889 | Train Acc: 0.8817
 Site-Painting                  (4) | Train Loss: 0.4983 | Train Acc: 0.8689
 Site-Painting                  (3) | Train Loss: 0.4395 | Train Acc: 0.8878
 Site-Painting                  (4) | Train Loss: 0.4193 | Train Acc: 0.8726
 Site-Painting                  (3) | Train Loss: 0.4395 | Train Acc: 0.9008
 Site-Sketch                    (0) | Train Loss: 0.2807 | Train Acc: 0.8529
 Site-Sketch                    (5) | Train Loss: 0.5481 | Train Acc: 0.8545
 Site-Sketch                    (5) | Train Loss: 0.6191 | Train Acc: 0.7841
 Site-Infograph                 (0) | Train Loss: 1.6153 | Train Acc: 0.4706
 Site-Infograph                 (0) | Train Loss: 1.2656 | Train Acc: 0.6103
 Site-QuickDraw                 (1) | Train Loss: 1.2483 | Train Acc: 0.6594
Average Train Accuracy: 0.8493
 Site-Real                      (2) | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0976 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.1444 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.2850 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.3532 | Val  Acc: 0.8857
 Site-Real                      (2) | Val  Loss: 0.2363 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2403 | Val  Acc: 0.9213
 Site-Real                      (3) | Val  Loss: 0.3658 | Val  Acc: 0.9161
 Site-Real                      (3) | Val  Loss: 0.2582 | Val  Acc: 0.9563
 Site-Real                      (3) | Val  Loss: 0.2571 | Val  Acc: 0.9401
 Site-Clipart                   (5) | Val  Loss: 0.6853 | Val  Acc: 0.7143
 Site-Clipart                   (3) | Val  Loss: 0.3979 | Val  Acc: 0.9091
 Site-Clipart                   (0) | Val  Loss: 0.6080 | Val  Acc: 0.8889
 Site-Clipart                   (0) | Val  Loss: 0.7060 | Val  Acc: 0.7719
 Site-Clipart                   (0) | Val  Loss: 0.5402 | Val  Acc: 0.8261
 Site-Clipart                   (0) | Val  Loss: 0.4840 | Val  Acc: 0.8649
 Site-Clipart                   (0) | Val  Loss: 0.5515 | Val  Acc: 0.8517
 Site-Painting                  (4) | Val  Loss: 0.5339 | Val  Acc: 0.9024
 Site-Painting                  (3) | Val  Loss: 0.3973 | Val  Acc: 0.8923
 Site-Painting                  (4) | Val  Loss: 0.3963 | Val  Acc: 0.9143
 Site-Painting                  (3) | Val  Loss: 0.4090 | Val  Acc: 0.8869
 Site-Sketch                    (0) | Val  Loss: 0.7160 | Val  Acc: 0.7556
 Site-Sketch                    (5) | Val  Loss: 0.8201 | Val  Acc: 0.7534
 Site-Sketch                    (5) | Val  Loss: 0.5631 | Val  Acc: 0.8291
 Site-Infograph                 (0) | Val  Loss: 1.2619 | Val  Acc: 0.5536
 Site-Infograph                 (0) | Val  Loss: 1.3386 | Val  Acc: 0.5385
 Site-QuickDraw                 (1) | Val  Loss: 1.5099 | Val  Acc: 0.5435
Average Valid Accuracy: 0.8480
============ Train epoch 22 ============
cnt=[7, 1, 4, 10, 2, 3, ]
cnt=[4, 3, 10, 7, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Real                      (2) | Train Loss: 0.6695 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.4122 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.1303 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.3868 | Train Acc: 0.9062
 Site-Real                      (3) | Train Loss: 0.3535 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.2124 | Train Acc: 0.9762
 Site-Real                      (2) | Train Loss: 0.1852 | Train Acc: 0.9776
 Site-Real                      (3) | Train Loss: 0.2494 | Train Acc: 0.9302
 Site-Real                      (3) | Train Loss: 0.2943 | Train Acc: 0.9391
 Site-Real                      (2) | Train Loss: 0.2571 | Train Acc: 0.9475
 Site-Clipart                   (0) | Train Loss: 0.4186 | Train Acc: 0.9048
 Site-Clipart                   (5) | Train Loss: 0.4427 | Train Acc: 0.9394
 Site-Clipart                   (5) | Train Loss: 0.5814 | Train Acc: 0.8333
 Site-Clipart                   (0) | Train Loss: 0.5297 | Train Acc: 0.7907
 Site-Clipart                   (0) | Train Loss: 0.5566 | Train Acc: 0.9058
 Site-Clipart                   (0) | Train Loss: 0.5824 | Train Acc: 0.8243
 Site-Clipart                   (0) | Train Loss: 0.4811 | Train Acc: 0.8620
 Site-Painting                  (3) | Train Loss: 0.5104 | Train Acc: 0.8525
 Site-Painting                  (3) | Train Loss: 0.3898 | Train Acc: 0.8878
 Site-Painting                  (3) | Train Loss: 0.4193 | Train Acc: 0.9045
 Site-Painting                  (3) | Train Loss: 0.4460 | Train Acc: 0.8849
 Site-Sketch                    (0) | Train Loss: 0.3020 | Train Acc: 0.8824
 Site-Sketch                    (4) | Train Loss: 0.5542 | Train Acc: 0.8455
 Site-Sketch                    (4) | Train Loss: 0.6650 | Train Acc: 0.7841
 Site-Infograph                 (5) | Train Loss: 1.5522 | Train Acc: 0.4471
 Site-Infograph                 (0) | Train Loss: 1.2086 | Train Acc: 0.5294
 Site-QuickDraw                 (1) | Train Loss: 1.2272 | Train Acc: 0.6449
Average Train Accuracy: 0.8484
 Site-Real                      (2) | Val  Loss: 0.0433 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.1143 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.1511 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2687 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3584 | Val  Acc: 0.9429
 Site-Real                      (3) | Val  Loss: 0.2018 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.2711 | Val  Acc: 0.9213
 Site-Real                      (3) | Val  Loss: 0.3681 | Val  Acc: 0.9371
 Site-Real                      (3) | Val  Loss: 0.2533 | Val  Acc: 0.9432
 Site-Real                      (2) | Val  Loss: 0.2429 | Val  Acc: 0.9482
 Site-Clipart                   (0) | Val  Loss: 0.5518 | Val  Acc: 0.7143
 Site-Clipart                   (5) | Val  Loss: 0.3984 | Val  Acc: 0.9091
 Site-Clipart                   (5) | Val  Loss: 0.5772 | Val  Acc: 0.8611
 Site-Clipart                   (0) | Val  Loss: 0.6390 | Val  Acc: 0.7719
 Site-Clipart                   (0) | Val  Loss: 0.5489 | Val  Acc: 0.8478
 Site-Clipart                   (0) | Val  Loss: 0.4431 | Val  Acc: 0.8986
 Site-Clipart                   (0) | Val  Loss: 0.5287 | Val  Acc: 0.8729
 Site-Painting                  (3) | Val  Loss: 0.5002 | Val  Acc: 0.9268
 Site-Painting                  (3) | Val  Loss: 0.4105 | Val  Acc: 0.8923
 Site-Painting                  (3) | Val  Loss: 0.4167 | Val  Acc: 0.9048
 Site-Painting                  (3) | Val  Loss: 0.3882 | Val  Acc: 0.8988
 Site-Sketch                    (0) | Val  Loss: 0.8135 | Val  Acc: 0.7778
 Site-Sketch                    (4) | Val  Loss: 0.7555 | Val  Acc: 0.8219
 Site-Sketch                    (4) | Val  Loss: 0.6468 | Val  Acc: 0.7692
 Site-Infograph                 (5) | Val  Loss: 1.1918 | Val  Acc: 0.5714
 Site-Infograph                 (0) | Val  Loss: 1.2734 | Val  Acc: 0.5275
 Site-QuickDraw                 (1) | Val  Loss: 1.4966 | Val  Acc: 0.5761
Average Valid Accuracy: 0.8575
 Best site-Real                     (2)  | Epoch:22 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:22 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9429
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9643
 Best site-Real                     (2)  | Epoch:22 | Val Acc: 0.9213
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9371
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9432
 Best site-Real                     (2)  | Epoch:22 | Val Acc: 0.9482
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.7143
 Best site-Clipart                  (5)  | Epoch:22 | Val Acc: 0.9091
 Best site-Clipart                  (5)  | Epoch:22 | Val Acc: 0.8611
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.7719
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8478
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8986
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8729
 Best site-Painting                 (3)  | Epoch:22 | Val Acc: 0.9268
 Best site-Painting                 (3)  | Epoch:22 | Val Acc: 0.8923
 Best site-Painting                 (3)  | Epoch:22 | Val Acc: 0.9048
 Best site-Painting                 (3)  | Epoch:22 | Val Acc: 0.8988
 Best site-Sketch                   (0)  | Epoch:22 | Val Acc: 0.7778
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8219
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.7692
 Best site-Infograph                (5)  | Epoch:22 | Val Acc: 0.5714
 Best site-Infograph                (0)  | Epoch:22 | Val Acc: 0.5275
 Best site-QuickDraw                (1)  | Epoch:22 | Val Acc: 0.5761
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 23 ============
cnt=[5, 1, 1, 9, 7, 4, ]
cnt=[2, 13, 1, 7, 1, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Real                      (2) | Train Loss: 0.6177 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.4003 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.1111 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.3766 | Train Acc: 0.9375
 Site-Real                      (3) | Train Loss: 0.3270 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.2020 | Train Acc: 0.9881
 Site-Real                      (3) | Train Loss: 0.4398 | Train Acc: 0.9552
 Site-Real                      (3) | Train Loss: 0.2169 | Train Acc: 0.9535
 Site-Real                      (3) | Train Loss: 0.2919 | Train Acc: 0.9333
 Site-Real                      (3) | Train Loss: 0.2370 | Train Acc: 0.9656
 Site-Clipart                   (5) | Train Loss: 0.4681 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.4643 | Train Acc: 0.8788
 Site-Clipart                   (3) | Train Loss: 0.5760 | Train Acc: 0.8148
 Site-Clipart                   (5) | Train Loss: 0.4809 | Train Acc: 0.8721
 Site-Clipart                   (4) | Train Loss: 0.4025 | Train Acc: 0.9203
 Site-Clipart                   (4) | Train Loss: 0.5386 | Train Acc: 0.8514
 Site-Clipart                   (4) | Train Loss: 0.4329 | Train Acc: 0.8901
 Site-Painting                  (0) | Train Loss: 0.4915 | Train Acc: 0.8525
 Site-Painting                  (0) | Train Loss: 0.4423 | Train Acc: 0.8980
 Site-Painting                  (0) | Train Loss: 0.3984 | Train Acc: 0.9108
 Site-Painting                  (0) | Train Loss: 0.4217 | Train Acc: 0.8968
 Site-Sketch                    (4) | Train Loss: 0.6612 | Train Acc: 0.8676
 Site-Sketch                    (5) | Train Loss: 0.5458 | Train Acc: 0.8545
 Site-Sketch                    (5) | Train Loss: 0.6751 | Train Acc: 0.8125
 Site-Infograph                 (4) | Train Loss: 1.5360 | Train Acc: 0.4824
 Site-Infograph                 (4) | Train Loss: 1.2341 | Train Acc: 0.5956
 Site-QuickDraw                 (1) | Train Loss: 1.2028 | Train Acc: 0.6304
Average Train Accuracy: 0.8565
 Site-Real                      (2) | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0734 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.1230 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.2516 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3403 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.2292 | Val  Acc: 0.9464
 Site-Real                      (3) | Val  Loss: 0.2844 | Val  Acc: 0.9101
 Site-Real                      (3) | Val  Loss: 0.3204 | Val  Acc: 0.9441
 Site-Real                      (3) | Val  Loss: 0.2757 | Val  Acc: 0.9432
 Site-Real                      (3) | Val  Loss: 0.2541 | Val  Acc: 0.9428
 Site-Clipart                   (5) | Val  Loss: 0.6646 | Val  Acc: 0.7143
 Site-Clipart                   (4) | Val  Loss: 0.4189 | Val  Acc: 0.9091
 Site-Clipart                   (3) | Val  Loss: 0.5746 | Val  Acc: 0.8611
 Site-Clipart                   (5) | Val  Loss: 0.6989 | Val  Acc: 0.7895
 Site-Clipart                   (4) | Val  Loss: 0.5171 | Val  Acc: 0.8587
 Site-Clipart                   (4) | Val  Loss: 0.4236 | Val  Acc: 0.8851
 Site-Clipart                   (4) | Val  Loss: 0.5075 | Val  Acc: 0.8686
 Site-Painting                  (0) | Val  Loss: 0.5556 | Val  Acc: 0.9024
 Site-Painting                  (0) | Val  Loss: 0.5551 | Val  Acc: 0.8769
 Site-Painting                  (0) | Val  Loss: 0.3823 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.4009 | Val  Acc: 0.8988
 Site-Sketch                    (4) | Val  Loss: 0.7481 | Val  Acc: 0.7111
 Site-Sketch                    (5) | Val  Loss: 0.6472 | Val  Acc: 0.8082
 Site-Sketch                    (5) | Val  Loss: 0.6162 | Val  Acc: 0.8205
 Site-Infograph                 (4) | Val  Loss: 1.1363 | Val  Acc: 0.6607
 Site-Infograph                 (4) | Val  Loss: 1.1969 | Val  Acc: 0.5604
 Site-QuickDraw                 (1) | Val  Loss: 1.5686 | Val  Acc: 0.5217
Average Valid Accuracy: 0.8558
============ Train epoch 24 ============
cnt=[4, 1, 6, 10, 5, 1, ]
cnt=[9, 10, 2, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Real                      (2) | Train Loss: 0.6575 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.3830 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.1175 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.3214 | Train Acc: 0.9375
 Site-Real                      (3) | Train Loss: 0.3123 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.1272 | Train Acc: 0.9881
 Site-Real                      (2) | Train Loss: 0.2265 | Train Acc: 0.9627
 Site-Real                      (2) | Train Loss: 0.2592 | Train Acc: 0.9535
 Site-Real                      (2) | Train Loss: 0.2672 | Train Acc: 0.9391
 Site-Real                      (2) | Train Loss: 0.2303 | Train Acc: 0.9620
 Site-Clipart                   (4) | Train Loss: 0.4908 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.4176 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.5632 | Train Acc: 0.8519
 Site-Clipart                   (4) | Train Loss: 0.5469 | Train Acc: 0.8023
 Site-Clipart                   (0) | Train Loss: 0.3293 | Train Acc: 0.9275
 Site-Clipart                   (4) | Train Loss: 0.5510 | Train Acc: 0.8423
 Site-Clipart                   (4) | Train Loss: 0.4458 | Train Acc: 0.8845
 Site-Painting                  (3) | Train Loss: 0.4164 | Train Acc: 0.9016
 Site-Painting                  (3) | Train Loss: 0.4037 | Train Acc: 0.8673
 Site-Painting                  (3) | Train Loss: 0.3807 | Train Acc: 0.8917
 Site-Painting                  (3) | Train Loss: 0.4100 | Train Acc: 0.9048
 Site-Sketch                    (0) | Train Loss: 0.2886 | Train Acc: 0.9118
 Site-Sketch                    (0) | Train Loss: 0.5527 | Train Acc: 0.8182
 Site-Sketch                    (0) | Train Loss: 0.5560 | Train Acc: 0.8125
 Site-Infograph                 (3) | Train Loss: 1.3403 | Train Acc: 0.5412
 Site-Infograph                 (3) | Train Loss: 1.2186 | Train Acc: 0.6397
 Site-QuickDraw                 (1) | Train Loss: 1.1742 | Train Acc: 0.6667
Average Train Accuracy: 0.8622
 Site-Real                      (2) | Val  Loss: 0.0336 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0705 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.1107 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2145 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3549 | Val  Acc: 0.9143
 Site-Real                      (2) | Val  Loss: 0.1983 | Val  Acc: 0.9821
 Site-Real                      (2) | Val  Loss: 0.1813 | Val  Acc: 0.9775
 Site-Real                      (2) | Val  Loss: 0.3480 | Val  Acc: 0.9301
 Site-Real                      (2) | Val  Loss: 0.2399 | Val  Acc: 0.9651
 Site-Real                      (2) | Val  Loss: 0.2594 | Val  Acc: 0.9401
 Site-Clipart                   (4) | Val  Loss: 0.4504 | Val  Acc: 0.7857
 Site-Clipart                   (5) | Val  Loss: 0.4130 | Val  Acc: 0.9091
 Site-Clipart                   (4) | Val  Loss: 0.6138 | Val  Acc: 0.8056
 Site-Clipart                   (4) | Val  Loss: 0.5956 | Val  Acc: 0.7895
 Site-Clipart                   (0) | Val  Loss: 0.5248 | Val  Acc: 0.8587
 Site-Clipart                   (4) | Val  Loss: 0.4522 | Val  Acc: 0.8716
 Site-Clipart                   (4) | Val  Loss: 0.5175 | Val  Acc: 0.8729
 Site-Painting                  (3) | Val  Loss: 0.5106 | Val  Acc: 0.8780
 Site-Painting                  (3) | Val  Loss: 0.5607 | Val  Acc: 0.8769
 Site-Painting                  (3) | Val  Loss: 0.3506 | Val  Acc: 0.9238
 Site-Painting                  (3) | Val  Loss: 0.3931 | Val  Acc: 0.8810
 Site-Sketch                    (0) | Val  Loss: 0.8396 | Val  Acc: 0.7333
 Site-Sketch                    (0) | Val  Loss: 0.7612 | Val  Acc: 0.7397
 Site-Sketch                    (0) | Val  Loss: 0.5665 | Val  Acc: 0.8376
 Site-Infograph                 (3) | Val  Loss: 1.1475 | Val  Acc: 0.6607
 Site-Infograph                 (3) | Val  Loss: 1.2162 | Val  Acc: 0.5934
 Site-QuickDraw                 (1) | Val  Loss: 1.4630 | Val  Acc: 0.5761
Average Valid Accuracy: 0.8613
 Best site-Real                     (2)  | Epoch:24 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 0.9143
 Best site-Real                     (2)  | Epoch:24 | Val Acc: 0.9821
 Best site-Real                     (2)  | Epoch:24 | Val Acc: 0.9775
 Best site-Real                     (2)  | Epoch:24 | Val Acc: 0.9301
 Best site-Real                     (2)  | Epoch:24 | Val Acc: 0.9651
 Best site-Real                     (2)  | Epoch:24 | Val Acc: 0.9401
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.7857
 Best site-Clipart                  (5)  | Epoch:24 | Val Acc: 0.9091
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8056
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.7895
 Best site-Clipart                  (0)  | Epoch:24 | Val Acc: 0.8587
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8716
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8729
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.8780
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.8769
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.9238
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.8810
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.7333
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.7397
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.8376
 Best site-Infograph                (3)  | Epoch:24 | Val Acc: 0.6607
 Best site-Infograph                (3)  | Epoch:24 | Val Acc: 0.5934
 Best site-QuickDraw                (1)  | Epoch:24 | Val Acc: 0.5761
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 25 ============
cnt=[7, 6, 1, 10, 1, 2, ]
cnt=[14, 1, 1, 2, 6, 3, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Real                      (4) | Train Loss: 0.6655 | Train Acc: 0.7500
 Site-Real                      (1) | Train Loss: 0.3625 | Train Acc: 0.8333
 Site-Real                      (1) | Train Loss: 0.1041 | Train Acc: 1.0000
 Site-Real                      (1) | Train Loss: 0.3816 | Train Acc: 0.9062
 Site-Real                      (0) | Train Loss: 0.3119 | Train Acc: 0.9231
 Site-Real                      (1) | Train Loss: 0.1699 | Train Acc: 0.9881
 Site-Real                      (1) | Train Loss: 0.2811 | Train Acc: 0.9627
 Site-Real                      (0) | Train Loss: 0.2310 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.2385 | Train Acc: 0.9507
 Site-Real                      (1) | Train Loss: 0.2143 | Train Acc: 0.9601
 Site-Clipart                   (3) | Train Loss: 0.4562 | Train Acc: 0.9048
 Site-Clipart                   (5) | Train Loss: 0.4694 | Train Acc: 0.8788
 Site-Clipart                   (5) | Train Loss: 0.4818 | Train Acc: 0.8519
 Site-Clipart                   (3) | Train Loss: 0.4166 | Train Acc: 0.8953
 Site-Clipart                   (3) | Train Loss: 0.3639 | Train Acc: 0.9058
 Site-Clipart                   (3) | Train Loss: 0.4974 | Train Acc: 0.8604
 Site-Clipart                   (3) | Train Loss: 0.4313 | Train Acc: 0.8648
 Site-Painting                  (0) | Train Loss: 0.4822 | Train Acc: 0.8361
 Site-Painting                  (0) | Train Loss: 0.3788 | Train Acc: 0.8878
 Site-Painting                  (0) | Train Loss: 0.3886 | Train Acc: 0.9108
 Site-Painting                  (0) | Train Loss: 0.4164 | Train Acc: 0.9048
 Site-Sketch                    (3) | Train Loss: 0.2723 | Train Acc: 0.8824
 Site-Sketch                    (3) | Train Loss: 0.5063 | Train Acc: 0.8364
 Site-Sketch                    (3) | Train Loss: 0.6367 | Train Acc: 0.8125
 Site-Infograph                 (3) | Train Loss: 1.5453 | Train Acc: 0.4706
 Site-Infograph                 (3) | Train Loss: 1.2380 | Train Acc: 0.5882
 Site-QuickDraw                 (2) | Train Loss: 1.1243 | Train Acc: 0.6667
Average Train Accuracy: 0.8582
 Site-Real                      (4) | Val  Loss: 0.0414 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.0848 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.0930 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.2542 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.3250 | Val  Acc: 0.9143
 Site-Real                      (1) | Val  Loss: 0.1815 | Val  Acc: 0.9643
 Site-Real                      (1) | Val  Loss: 0.2743 | Val  Acc: 0.9326
 Site-Real                      (0) | Val  Loss: 0.2881 | Val  Acc: 0.9301
 Site-Real                      (0) | Val  Loss: 0.2437 | Val  Acc: 0.9520
 Site-Real                      (1) | Val  Loss: 0.2473 | Val  Acc: 0.9373
 Site-Clipart                   (3) | Val  Loss: 0.4835 | Val  Acc: 0.7857
 Site-Clipart                   (5) | Val  Loss: 0.2802 | Val  Acc: 0.9091
 Site-Clipart                   (5) | Val  Loss: 0.5407 | Val  Acc: 0.8611
 Site-Clipart                   (3) | Val  Loss: 0.4903 | Val  Acc: 0.8246
 Site-Clipart                   (3) | Val  Loss: 0.5176 | Val  Acc: 0.8370
 Site-Clipart                   (3) | Val  Loss: 0.4479 | Val  Acc: 0.8716
 Site-Clipart                   (3) | Val  Loss: 0.4920 | Val  Acc: 0.8686
 Site-Painting                  (0) | Val  Loss: 0.5014 | Val  Acc: 0.9268
 Site-Painting                  (0) | Val  Loss: 0.4321 | Val  Acc: 0.9077
 Site-Painting                  (0) | Val  Loss: 0.3441 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3304 | Val  Acc: 0.9167
 Site-Sketch                    (3) | Val  Loss: 0.7306 | Val  Acc: 0.7778
 Site-Sketch                    (3) | Val  Loss: 0.7722 | Val  Acc: 0.7808
 Site-Sketch                    (3) | Val  Loss: 0.4899 | Val  Acc: 0.8462
 Site-Infograph                 (3) | Val  Loss: 1.1496 | Val  Acc: 0.6964
 Site-Infograph                 (3) | Val  Loss: 1.2820 | Val  Acc: 0.5714
 Site-QuickDraw                 (2) | Val  Loss: 1.4488 | Val  Acc: 0.5326
Average Valid Accuracy: 0.8678
 Best site-Real                     (4)  | Epoch:25 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:25 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:25 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:25 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:25 | Val Acc: 0.9143
 Best site-Real                     (1)  | Epoch:25 | Val Acc: 0.9643
 Best site-Real                     (1)  | Epoch:25 | Val Acc: 0.9326
 Best site-Real                     (0)  | Epoch:25 | Val Acc: 0.9301
 Best site-Real                     (0)  | Epoch:25 | Val Acc: 0.9520
 Best site-Real                     (1)  | Epoch:25 | Val Acc: 0.9373
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.7857
 Best site-Clipart                  (5)  | Epoch:25 | Val Acc: 0.9091
 Best site-Clipart                  (5)  | Epoch:25 | Val Acc: 0.8611
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.8246
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.8370
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.8716
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.8686
 Best site-Painting                 (0)  | Epoch:25 | Val Acc: 0.9268
 Best site-Painting                 (0)  | Epoch:25 | Val Acc: 0.9077
 Best site-Painting                 (0)  | Epoch:25 | Val Acc: 0.9333
 Best site-Painting                 (0)  | Epoch:25 | Val Acc: 0.9167
 Best site-Sketch                   (3)  | Epoch:25 | Val Acc: 0.7778
 Best site-Sketch                   (3)  | Epoch:25 | Val Acc: 0.7808
 Best site-Sketch                   (3)  | Epoch:25 | Val Acc: 0.8462
 Best site-Infograph                (3)  | Epoch:25 | Val Acc: 0.6964
 Best site-Infograph                (3)  | Epoch:25 | Val Acc: 0.5714
 Best site-QuickDraw                (2)  | Epoch:25 | Val Acc: 0.5326
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 26 ============
cnt=[3, 8, 1, 7, 1, 7, ]
cnt=[1, 9, 2, 13, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Real                      (4) | Train Loss: 0.7055 | Train Acc: 0.7500
 Site-Real                      (1) | Train Loss: 0.3834 | Train Acc: 0.8333
 Site-Real                      (1) | Train Loss: 0.1072 | Train Acc: 1.0000
 Site-Real                      (1) | Train Loss: 0.2731 | Train Acc: 0.9375
 Site-Real                      (1) | Train Loss: 0.2747 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.1116 | Train Acc: 0.9881
 Site-Real                      (3) | Train Loss: 0.1935 | Train Acc: 0.9552
 Site-Real                      (1) | Train Loss: 0.2333 | Train Acc: 0.9488
 Site-Real                      (3) | Train Loss: 0.2581 | Train Acc: 0.9362
 Site-Real                      (3) | Train Loss: 0.2127 | Train Acc: 0.9620
 Site-Clipart                   (0) | Train Loss: 0.5639 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.4629 | Train Acc: 0.8788
 Site-Clipart                   (3) | Train Loss: 0.5081 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.5094 | Train Acc: 0.8372
 Site-Clipart                   (5) | Train Loss: 0.4354 | Train Acc: 0.8913
 Site-Clipart                   (5) | Train Loss: 0.5073 | Train Acc: 0.8514
 Site-Clipart                   (5) | Train Loss: 0.3956 | Train Acc: 0.8958
 Site-Painting                  (0) | Train Loss: 0.4751 | Train Acc: 0.8525
 Site-Painting                  (1) | Train Loss: 0.3609 | Train Acc: 0.9184
 Site-Painting                  (1) | Train Loss: 0.4120 | Train Acc: 0.8854
 Site-Painting                  (1) | Train Loss: 0.3985 | Train Acc: 0.9008
 Site-Sketch                    (0) | Train Loss: 0.2589 | Train Acc: 0.9265
 Site-Sketch                    (5) | Train Loss: 0.4591 | Train Acc: 0.8727
 Site-Sketch                    (5) | Train Loss: 0.6070 | Train Acc: 0.7841
 Site-Infograph                 (3) | Train Loss: 1.4866 | Train Acc: 0.4706
 Site-Infograph                 (3) | Train Loss: 1.3314 | Train Acc: 0.5956
 Site-QuickDraw                 (2) | Train Loss: 1.1805 | Train Acc: 0.6377
Average Train Accuracy: 0.8564
 Site-Real                      (4) | Val  Loss: 0.0787 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.0731 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.1160 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.2612 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.3076 | Val  Acc: 0.9429
 Site-Real                      (3) | Val  Loss: 0.2165 | Val  Acc: 0.9464
 Site-Real                      (3) | Val  Loss: 0.2297 | Val  Acc: 0.9326
 Site-Real                      (1) | Val  Loss: 0.2930 | Val  Acc: 0.9371
 Site-Real                      (3) | Val  Loss: 0.2337 | Val  Acc: 0.9520
 Site-Real                      (3) | Val  Loss: 0.2360 | Val  Acc: 0.9455
 Site-Clipart                   (0) | Val  Loss: 0.4198 | Val  Acc: 0.8571
 Site-Clipart                   (5) | Val  Loss: 0.3560 | Val  Acc: 0.8636
 Site-Clipart                   (3) | Val  Loss: 0.4950 | Val  Acc: 0.8889
 Site-Clipart                   (5) | Val  Loss: 0.5486 | Val  Acc: 0.8596
 Site-Clipart                   (5) | Val  Loss: 0.5198 | Val  Acc: 0.8587
 Site-Clipart                   (5) | Val  Loss: 0.3554 | Val  Acc: 0.9122
 Site-Clipart                   (5) | Val  Loss: 0.5046 | Val  Acc: 0.8686
 Site-Painting                  (0) | Val  Loss: 0.5386 | Val  Acc: 0.9024
 Site-Painting                  (1) | Val  Loss: 0.3808 | Val  Acc: 0.8923
 Site-Painting                  (1) | Val  Loss: 0.3146 | Val  Acc: 0.9524
 Site-Painting                  (1) | Val  Loss: 0.3627 | Val  Acc: 0.8869
 Site-Sketch                    (0) | Val  Loss: 0.6639 | Val  Acc: 0.8222
 Site-Sketch                    (5) | Val  Loss: 0.6811 | Val  Acc: 0.7671
 Site-Sketch                    (5) | Val  Loss: 0.5941 | Val  Acc: 0.7949
 Site-Infograph                 (3) | Val  Loss: 1.1704 | Val  Acc: 0.6429
 Site-Infograph                 (3) | Val  Loss: 1.1794 | Val  Acc: 0.6044
 Site-QuickDraw                 (2) | Val  Loss: 1.3156 | Val  Acc: 0.6087
Average Valid Accuracy: 0.8738
 Best site-Real                     (4)  | Epoch:26 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:26 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:26 | Val Acc: 1.0000
 Best site-Real                     (1)  | Epoch:26 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:26 | Val Acc: 0.9429
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9464
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9326
 Best site-Real                     (1)  | Epoch:26 | Val Acc: 0.9371
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9520
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9455
 Best site-Clipart                  (0)  | Epoch:26 | Val Acc: 0.8571
 Best site-Clipart                  (5)  | Epoch:26 | Val Acc: 0.8636
 Best site-Clipart                  (3)  | Epoch:26 | Val Acc: 0.8889
 Best site-Clipart                  (5)  | Epoch:26 | Val Acc: 0.8596
 Best site-Clipart                  (5)  | Epoch:26 | Val Acc: 0.8587
 Best site-Clipart                  (5)  | Epoch:26 | Val Acc: 0.9122
 Best site-Clipart                  (5)  | Epoch:26 | Val Acc: 0.8686
 Best site-Painting                 (0)  | Epoch:26 | Val Acc: 0.9024
 Best site-Painting                 (1)  | Epoch:26 | Val Acc: 0.8923
 Best site-Painting                 (1)  | Epoch:26 | Val Acc: 0.9524
 Best site-Painting                 (1)  | Epoch:26 | Val Acc: 0.8869
 Best site-Sketch                   (0)  | Epoch:26 | Val Acc: 0.8222
 Best site-Sketch                   (5)  | Epoch:26 | Val Acc: 0.7671
 Best site-Sketch                   (5)  | Epoch:26 | Val Acc: 0.7949
 Best site-Infograph                (3)  | Epoch:26 | Val Acc: 0.6429
 Best site-Infograph                (3)  | Epoch:26 | Val Acc: 0.6044
 Best site-QuickDraw                (2)  | Epoch:26 | Val Acc: 0.6087
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 1, 8, 6, 4, 7, ]
cnt=[4, 4, 7, 9, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Real                      (0) | Train Loss: 0.6317 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.3792 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.1335 | Train Acc: 1.0000
 Site-Real                      (5) | Train Loss: 0.3541 | Train Acc: 0.9062
 Site-Real                      (5) | Train Loss: 0.2520 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.1115 | Train Acc: 0.9762
 Site-Real                      (3) | Train Loss: 0.1702 | Train Acc: 0.9478
 Site-Real                      (5) | Train Loss: 0.2477 | Train Acc: 0.9442
 Site-Real                      (3) | Train Loss: 0.2345 | Train Acc: 0.9420
 Site-Real                      (3) | Train Loss: 0.2105 | Train Acc: 0.9583
 Site-Clipart                   (4) | Train Loss: 0.4175 | Train Acc: 0.9048
 Site-Clipart                   (2) | Train Loss: 0.3510 | Train Acc: 0.9394
 Site-Clipart                   (2) | Train Loss: 0.5341 | Train Acc: 0.7963
 Site-Clipart                   (2) | Train Loss: 0.4437 | Train Acc: 0.8605
 Site-Clipart                   (2) | Train Loss: 0.5021 | Train Acc: 0.8841
 Site-Clipart                   (2) | Train Loss: 0.4836 | Train Acc: 0.8694
 Site-Clipart                   (2) | Train Loss: 0.3941 | Train Acc: 0.9070
 Site-Painting                  (5) | Train Loss: 0.4370 | Train Acc: 0.8525
 Site-Painting                  (5) | Train Loss: 0.4256 | Train Acc: 0.8980
 Site-Painting                  (5) | Train Loss: 0.3807 | Train Acc: 0.9045
 Site-Painting                  (5) | Train Loss: 0.4007 | Train Acc: 0.8810
 Site-Sketch                    (4) | Train Loss: 0.4459 | Train Acc: 0.8676
 Site-Sketch                    (4) | Train Loss: 0.5805 | Train Acc: 0.8364
 Site-Sketch                    (4) | Train Loss: 0.5653 | Train Acc: 0.8409
 Site-Infograph                 (2) | Train Loss: 1.4638 | Train Acc: 0.5059
 Site-Infograph                 (2) | Train Loss: 1.1165 | Train Acc: 0.6324
 Site-QuickDraw                 (1) | Train Loss: 1.0716 | Train Acc: 0.7029
Average Train Accuracy: 0.8616
 Site-Real                      (0) | Val  Loss: 0.0335 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.1007 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0797 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.1950 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.2704 | Val  Acc: 0.9714
 Site-Real                      (3) | Val  Loss: 0.1827 | Val  Acc: 0.9821
 Site-Real                      (3) | Val  Loss: 0.1893 | Val  Acc: 0.9326
 Site-Real                      (5) | Val  Loss: 0.2882 | Val  Acc: 0.9441
 Site-Real                      (3) | Val  Loss: 0.2219 | Val  Acc: 0.9563
 Site-Real                      (3) | Val  Loss: 0.2302 | Val  Acc: 0.9428
 Site-Clipart                   (4) | Val  Loss: 0.3752 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.3288 | Val  Acc: 0.9091
 Site-Clipart                   (2) | Val  Loss: 0.5350 | Val  Acc: 0.8333
 Site-Clipart                   (2) | Val  Loss: 0.5622 | Val  Acc: 0.8070
 Site-Clipart                   (2) | Val  Loss: 0.4603 | Val  Acc: 0.9022
 Site-Clipart                   (2) | Val  Loss: 0.4006 | Val  Acc: 0.8851
 Site-Clipart                   (2) | Val  Loss: 0.5225 | Val  Acc: 0.8517
 Site-Painting                  (5) | Val  Loss: 0.5553 | Val  Acc: 0.8780
 Site-Painting                  (5) | Val  Loss: 0.4662 | Val  Acc: 0.9231
 Site-Painting                  (5) | Val  Loss: 0.3727 | Val  Acc: 0.9048
 Site-Painting                  (5) | Val  Loss: 0.3929 | Val  Acc: 0.8750
 Site-Sketch                    (4) | Val  Loss: 0.6413 | Val  Acc: 0.8222
 Site-Sketch                    (4) | Val  Loss: 0.7648 | Val  Acc: 0.7671
 Site-Sketch                    (4) | Val  Loss: 0.5797 | Val  Acc: 0.7863
 Site-Infograph                 (2) | Val  Loss: 1.1992 | Val  Acc: 0.6071
 Site-Infograph                 (2) | Val  Loss: 1.2185 | Val  Acc: 0.5934
 Site-QuickDraw                 (1) | Val  Loss: 1.4123 | Val  Acc: 0.5870
Average Valid Accuracy: 0.8693
============ Train epoch 28 ============
cnt=[4, 1, 10, 5, 4, 3, ]
cnt=[9, 1, 1, 10, 2, 4, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Real                      (2) | Train Loss: 0.6763 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.3755 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.0881 | Train Acc: 1.0000
 Site-Real                      (2) | Train Loss: 0.2980 | Train Acc: 0.9062
 Site-Real                      (2) | Train Loss: 0.3017 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.0972 | Train Acc: 0.9881
 Site-Real                      (2) | Train Loss: 0.1495 | Train Acc: 0.9701
 Site-Real                      (2) | Train Loss: 0.2517 | Train Acc: 0.9488
 Site-Real                      (2) | Train Loss: 0.2529 | Train Acc: 0.9420
 Site-Real                      (2) | Train Loss: 0.2226 | Train Acc: 0.9601
 Site-Clipart                   (5) | Train Loss: 0.4596 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.3179 | Train Acc: 0.9394
 Site-Clipart                   (5) | Train Loss: 0.5615 | Train Acc: 0.8148
 Site-Clipart                   (0) | Train Loss: 0.4582 | Train Acc: 0.8721
 Site-Clipart                   (3) | Train Loss: 0.4009 | Train Acc: 0.9348
 Site-Clipart                   (3) | Train Loss: 0.4867 | Train Acc: 0.8378
 Site-Clipart                   (3) | Train Loss: 0.3932 | Train Acc: 0.9042
 Site-Painting                  (4) | Train Loss: 0.4301 | Train Acc: 0.8852
 Site-Painting                  (4) | Train Loss: 0.3975 | Train Acc: 0.8878
 Site-Painting                  (4) | Train Loss: 0.3989 | Train Acc: 0.8662
 Site-Painting                  (2) | Train Loss: 0.3935 | Train Acc: 0.9048
 Site-Sketch                    (0) | Train Loss: 0.4280 | Train Acc: 0.8971
 Site-Sketch                    (0) | Train Loss: 0.5283 | Train Acc: 0.8455
 Site-Sketch                    (0) | Train Loss: 0.5869 | Train Acc: 0.8011
 Site-Infograph                 (3) | Train Loss: 1.6242 | Train Acc: 0.4706
 Site-Infograph                 (3) | Train Loss: 1.0728 | Train Acc: 0.6029
 Site-QuickDraw                 (1) | Train Loss: 1.0662 | Train Acc: 0.6884
Average Train Accuracy: 0.8604
 Site-Real                      (2) | Val  Loss: 0.0297 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0870 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.1030 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.2293 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.3189 | Val  Acc: 0.9143
 Site-Real                      (2) | Val  Loss: 0.1817 | Val  Acc: 0.9821
 Site-Real                      (2) | Val  Loss: 0.2134 | Val  Acc: 0.9438
 Site-Real                      (2) | Val  Loss: 0.3394 | Val  Acc: 0.9301
 Site-Real                      (2) | Val  Loss: 0.2452 | Val  Acc: 0.9345
 Site-Real                      (2) | Val  Loss: 0.2325 | Val  Acc: 0.9346
 Site-Clipart                   (5) | Val  Loss: 0.5100 | Val  Acc: 0.7143
 Site-Clipart                   (5) | Val  Loss: 0.3275 | Val  Acc: 0.9091
 Site-Clipart                   (5) | Val  Loss: 0.5369 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.5922 | Val  Acc: 0.7895
 Site-Clipart                   (3) | Val  Loss: 0.4622 | Val  Acc: 0.8696
 Site-Clipart                   (3) | Val  Loss: 0.3716 | Val  Acc: 0.9054
 Site-Clipart                   (3) | Val  Loss: 0.4675 | Val  Acc: 0.8771
 Site-Painting                  (4) | Val  Loss: 0.4983 | Val  Acc: 0.9024
 Site-Painting                  (4) | Val  Loss: 0.5083 | Val  Acc: 0.8769
 Site-Painting                  (4) | Val  Loss: 0.4153 | Val  Acc: 0.8667
 Site-Painting                  (2) | Val  Loss: 0.3253 | Val  Acc: 0.9048
 Site-Sketch                    (0) | Val  Loss: 0.6956 | Val  Acc: 0.8222
 Site-Sketch                    (0) | Val  Loss: 0.5893 | Val  Acc: 0.8356
 Site-Sketch                    (0) | Val  Loss: 0.5051 | Val  Acc: 0.8462
 Site-Infograph                 (3) | Val  Loss: 1.1512 | Val  Acc: 0.6250
 Site-Infograph                 (3) | Val  Loss: 1.2475 | Val  Acc: 0.5934
 Site-QuickDraw                 (1) | Val  Loss: 1.3451 | Val  Acc: 0.6304
Average Valid Accuracy: 0.8664
============ Train epoch 29 ============
cnt=[4, 1, 6, 7, 8, 1, ]
cnt=[1, 13, 2, 1, 9, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Real                      (5) | Train Loss: 0.5989 | Train Acc: 0.7500
 Site-Real                      (2) | Train Loss: 0.3541 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.1673 | Train Acc: 0.9500
 Site-Real                      (3) | Train Loss: 0.2999 | Train Acc: 0.9375
 Site-Real                      (2) | Train Loss: 0.2831 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.1120 | Train Acc: 0.9762
 Site-Real                      (2) | Train Loss: 0.1423 | Train Acc: 0.9552
 Site-Real                      (3) | Train Loss: 0.2016 | Train Acc: 0.9488
 Site-Real                      (2) | Train Loss: 0.2532 | Train Acc: 0.9478
 Site-Real                      (2) | Train Loss: 0.2180 | Train Acc: 0.9547
 Site-Clipart                   (4) | Train Loss: 0.4498 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.3970 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.5305 | Train Acc: 0.8148
 Site-Clipart                   (0) | Train Loss: 0.3942 | Train Acc: 0.8837
 Site-Clipart                   (4) | Train Loss: 0.3149 | Train Acc: 0.9348
 Site-Clipart                   (4) | Train Loss: 0.4551 | Train Acc: 0.8694
 Site-Clipart                   (4) | Train Loss: 0.4240 | Train Acc: 0.8873
 Site-Painting                  (3) | Train Loss: 0.4104 | Train Acc: 0.8852
 Site-Painting                  (3) | Train Loss: 0.3564 | Train Acc: 0.9184
 Site-Painting                  (3) | Train Loss: 0.3892 | Train Acc: 0.8790
 Site-Painting                  (3) | Train Loss: 0.3897 | Train Acc: 0.9008
 Site-Sketch                    (0) | Train Loss: 0.5111 | Train Acc: 0.8382
 Site-Sketch                    (0) | Train Loss: 0.5156 | Train Acc: 0.8545
 Site-Sketch                    (0) | Train Loss: 0.5789 | Train Acc: 0.8182
 Site-Infograph                 (4) | Train Loss: 1.5566 | Train Acc: 0.4941
 Site-Infograph                 (4) | Train Loss: 1.0402 | Train Acc: 0.6324
 Site-QuickDraw                 (1) | Train Loss: 1.0622 | Train Acc: 0.6739
Average Train Accuracy: 0.8603
 Site-Real                      (5) | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0818 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0770 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2277 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.3304 | Val  Acc: 0.8857
 Site-Real                      (2) | Val  Loss: 0.1898 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.2120 | Val  Acc: 0.9326
 Site-Real                      (3) | Val  Loss: 0.2856 | Val  Acc: 0.9161
 Site-Real                      (2) | Val  Loss: 0.2360 | Val  Acc: 0.9432
 Site-Real                      (2) | Val  Loss: 0.2318 | Val  Acc: 0.9373
 Site-Clipart                   (4) | Val  Loss: 0.4299 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.4075 | Val  Acc: 0.8182
 Site-Clipart                   (4) | Val  Loss: 0.5036 | Val  Acc: 0.8889
 Site-Clipart                   (0) | Val  Loss: 0.6046 | Val  Acc: 0.8070
 Site-Clipart                   (4) | Val  Loss: 0.4373 | Val  Acc: 0.8913
 Site-Clipart                   (4) | Val  Loss: 0.3859 | Val  Acc: 0.9257
 Site-Clipart                   (4) | Val  Loss: 0.4424 | Val  Acc: 0.8941
 Site-Painting                  (3) | Val  Loss: 0.5153 | Val  Acc: 0.9024
 Site-Painting                  (3) | Val  Loss: 0.3909 | Val  Acc: 0.8923
 Site-Painting                  (3) | Val  Loss: 0.3270 | Val  Acc: 0.9333
 Site-Painting                  (3) | Val  Loss: 0.2895 | Val  Acc: 0.9286
 Site-Sketch                    (0) | Val  Loss: 0.7002 | Val  Acc: 0.8222
 Site-Sketch                    (0) | Val  Loss: 0.7275 | Val  Acc: 0.7671
 Site-Sketch                    (0) | Val  Loss: 0.5218 | Val  Acc: 0.8376
 Site-Infograph                 (4) | Val  Loss: 1.1287 | Val  Acc: 0.6786
 Site-Infograph                 (4) | Val  Loss: 1.2369 | Val  Acc: 0.5495
 Site-QuickDraw                 (1) | Val  Loss: 1.4414 | Val  Acc: 0.5761
Average Valid Accuracy: 0.8704
 Test site-Real                      (5)| Epoch:26 | Test Acc: 0.9482
 Test site-Clipart                   (4)| Epoch:26 | Test Acc: 0.8612
 Test site-Painting                  (3)| Epoch:26 | Test Acc: 0.9225
 Test site-Sketch                    (0)| Epoch:26 | Test Acc: 0.8646
 Test site-Infograph                 (4)| Epoch:26 | Test Acc: 0.5449
 Test site-QuickDraw                 (1)| Epoch:26 | Test Acc: 0.6390
Real: 0.9482, Clipart: 0.8612, Painting: 0.9225, Sketch: 0.8646, Infograph: 0.5449, QuickDraw: 0.6390, 
Average Test Accuracy(group): 0.7967, Average Test Accuracy(individual): 0.8712,
domain std=0.1505, cluster std=0.1122, individual std=0.1118, 
============ Train epoch 30 ============
cnt=[2, 1, 8, 10, 1, 5, ]
cnt=[1, 4, 10, 1, 2, 9, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Real                      (4) | Train Loss: 0.6552 | Train Acc: 0.7500
 Site-Real                      (5) | Train Loss: 0.3964 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.0825 | Train Acc: 1.0000
 Site-Real                      (2) | Train Loss: 0.2905 | Train Acc: 0.9375
 Site-Real                      (2) | Train Loss: 0.2808 | Train Acc: 0.9231
 Site-Real                      (5) | Train Loss: 0.1625 | Train Acc: 0.9643
 Site-Real                      (5) | Train Loss: 0.1560 | Train Acc: 0.9627
 Site-Real                      (2) | Train Loss: 0.2432 | Train Acc: 0.9349
 Site-Real                      (5) | Train Loss: 0.2483 | Train Acc: 0.9333
 Site-Real                      (5) | Train Loss: 0.2081 | Train Acc: 0.9565
 Site-Clipart                   (3) | Train Loss: 0.6029 | Train Acc: 0.8095
 Site-Clipart                   (0) | Train Loss: 0.4362 | Train Acc: 0.8788
 Site-Clipart                   (0) | Train Loss: 0.4287 | Train Acc: 0.8889
 Site-Clipart                   (3) | Train Loss: 0.4382 | Train Acc: 0.8372
 Site-Clipart                   (3) | Train Loss: 0.3994 | Train Acc: 0.9130
 Site-Clipart                   (3) | Train Loss: 0.4764 | Train Acc: 0.8559
 Site-Clipart                   (3) | Train Loss: 0.3801 | Train Acc: 0.9155
 Site-Painting                  (2) | Train Loss: 0.4031 | Train Acc: 0.8689
 Site-Painting                  (2) | Train Loss: 0.4120 | Train Acc: 0.8571
 Site-Painting                  (2) | Train Loss: 0.3595 | Train Acc: 0.8854
 Site-Painting                  (2) | Train Loss: 0.3934 | Train Acc: 0.9008
 Site-Sketch                    (3) | Train Loss: 0.6932 | Train Acc: 0.8529
 Site-Sketch                    (3) | Train Loss: 0.5193 | Train Acc: 0.8545
 Site-Sketch                    (3) | Train Loss: 0.5390 | Train Acc: 0.8239
 Site-Infograph                 (3) | Train Loss: 1.4617 | Train Acc: 0.5412
 Site-Infograph                 (3) | Train Loss: 1.0490 | Train Acc: 0.5956
 Site-QuickDraw                 (1) | Train Loss: 1.2069 | Train Acc: 0.6739
Average Train Accuracy: 0.8574
 Site-Real                      (4) | Val  Loss: 0.0225 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.0936 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0977 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.2422 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.3126 | Val  Acc: 0.9429
 Site-Real                      (5) | Val  Loss: 0.1894 | Val  Acc: 0.9464
 Site-Real                      (5) | Val  Loss: 0.1908 | Val  Acc: 0.9551
 Site-Real                      (2) | Val  Loss: 0.2881 | Val  Acc: 0.9371
 Site-Real                      (5) | Val  Loss: 0.2298 | Val  Acc: 0.9520
 Site-Real                      (5) | Val  Loss: 0.2083 | Val  Acc: 0.9537
 Site-Clipart                   (3) | Val  Loss: 0.5176 | Val  Acc: 0.7143
 Site-Clipart                   (0) | Val  Loss: 0.3370 | Val  Acc: 0.8636
 Site-Clipart                   (0) | Val  Loss: 0.5502 | Val  Acc: 0.8889
 Site-Clipart                   (3) | Val  Loss: 0.5144 | Val  Acc: 0.8596
 Site-Clipart                   (3) | Val  Loss: 0.3812 | Val  Acc: 0.9239
 Site-Clipart                   (3) | Val  Loss: 0.3915 | Val  Acc: 0.8649
 Site-Clipart                   (3) | Val  Loss: 0.4478 | Val  Acc: 0.8941
 Site-Painting                  (2) | Val  Loss: 0.5132 | Val  Acc: 0.9268
 Site-Painting                  (2) | Val  Loss: 0.5633 | Val  Acc: 0.8923
 Site-Painting                  (2) | Val  Loss: 0.2997 | Val  Acc: 0.9429
 Site-Painting                  (2) | Val  Loss: 0.4033 | Val  Acc: 0.8929
 Site-Sketch                    (3) | Val  Loss: 0.6883 | Val  Acc: 0.7778
 Site-Sketch                    (3) | Val  Loss: 0.6431 | Val  Acc: 0.7808
 Site-Sketch                    (3) | Val  Loss: 0.5072 | Val  Acc: 0.8291
 Site-Infograph                 (3) | Val  Loss: 1.1020 | Val  Acc: 0.6250
 Site-Infograph                 (3) | Val  Loss: 1.1234 | Val  Acc: 0.5714
 Site-QuickDraw                 (1) | Val  Loss: 1.3656 | Val  Acc: 0.5870
Average Valid Accuracy: 0.8677
============ Train epoch 31 ============
cnt=[7, 1, 13, 3, 1, 2, ]
cnt=[4, 7, 3, 1, 10, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Real                      (2) | Train Loss: 0.5920 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.4005 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.1084 | Train Acc: 1.0000
 Site-Real                      (2) | Train Loss: 0.2956 | Train Acc: 0.9375
 Site-Real                      (2) | Train Loss: 0.2793 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.1083 | Train Acc: 0.9881
 Site-Real                      (2) | Train Loss: 0.3098 | Train Acc: 0.9403
 Site-Real                      (2) | Train Loss: 0.2303 | Train Acc: 0.9442
 Site-Real                      (2) | Train Loss: 0.2338 | Train Acc: 0.9449
 Site-Real                      (2) | Train Loss: 0.2125 | Train Acc: 0.9620
 Site-Clipart                   (0) | Train Loss: 0.4502 | Train Acc: 0.9048
 Site-Clipart                   (0) | Train Loss: 0.3754 | Train Acc: 0.9697
 Site-Clipart                   (3) | Train Loss: 0.4548 | Train Acc: 0.8704
 Site-Clipart                   (0) | Train Loss: 0.4423 | Train Acc: 0.8488
 Site-Clipart                   (0) | Train Loss: 0.3963 | Train Acc: 0.9203
 Site-Clipart                   (3) | Train Loss: 0.4701 | Train Acc: 0.8829
 Site-Clipart                   (3) | Train Loss: 0.3738 | Train Acc: 0.8958
 Site-Painting                  (2) | Train Loss: 0.4749 | Train Acc: 0.8361
 Site-Painting                  (2) | Train Loss: 0.3923 | Train Acc: 0.9286
 Site-Painting                  (2) | Train Loss: 0.3537 | Train Acc: 0.9045
 Site-Painting                  (2) | Train Loss: 0.3670 | Train Acc: 0.9008
 Site-Sketch                    (0) | Train Loss: 0.2906 | Train Acc: 0.8824
 Site-Sketch                    (0) | Train Loss: 0.4604 | Train Acc: 0.8455
 Site-Sketch                    (0) | Train Loss: 0.5720 | Train Acc: 0.8239
 Site-Infograph                 (5) | Train Loss: 1.3676 | Train Acc: 0.5647
 Site-Infograph                 (5) | Train Loss: 1.1437 | Train Acc: 0.5956
 Site-QuickDraw                 (1) | Train Loss: 1.0309 | Train Acc: 0.7174
Average Train Accuracy: 0.8709
 Site-Real                      (2) | Val  Loss: 0.0274 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0982 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0967 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.2415 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2975 | Val  Acc: 0.9429
 Site-Real                      (2) | Val  Loss: 0.1907 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.2494 | Val  Acc: 0.9326
 Site-Real                      (2) | Val  Loss: 0.3367 | Val  Acc: 0.9301
 Site-Real                      (2) | Val  Loss: 0.2279 | Val  Acc: 0.9520
 Site-Real                      (2) | Val  Loss: 0.2321 | Val  Acc: 0.9401
 Site-Clipart                   (0) | Val  Loss: 0.4492 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.3458 | Val  Acc: 0.9091
 Site-Clipart                   (3) | Val  Loss: 0.6112 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.5908 | Val  Acc: 0.7544
 Site-Clipart                   (0) | Val  Loss: 0.5053 | Val  Acc: 0.8370
 Site-Clipart                   (3) | Val  Loss: 0.3916 | Val  Acc: 0.8784
 Site-Clipart                   (3) | Val  Loss: 0.4605 | Val  Acc: 0.8814
 Site-Painting                  (2) | Val  Loss: 0.4955 | Val  Acc: 0.9024
 Site-Painting                  (2) | Val  Loss: 0.4989 | Val  Acc: 0.9077
 Site-Painting                  (2) | Val  Loss: 0.2899 | Val  Acc: 0.9429
 Site-Painting                  (2) | Val  Loss: 0.3412 | Val  Acc: 0.8929
 Site-Sketch                    (0) | Val  Loss: 0.7306 | Val  Acc: 0.7333
 Site-Sketch                    (0) | Val  Loss: 0.8957 | Val  Acc: 0.7671
 Site-Sketch                    (0) | Val  Loss: 0.5519 | Val  Acc: 0.8462
 Site-Infograph                 (5) | Val  Loss: 1.1124 | Val  Acc: 0.6250
 Site-Infograph                 (5) | Val  Loss: 1.2154 | Val  Acc: 0.6154
 Site-QuickDraw                 (1) | Val  Loss: 1.3385 | Val  Acc: 0.6304
Average Valid Accuracy: 0.8677
============ Train epoch 32 ============
cnt=[7, 1, 6, 5, 5, 3, ]
cnt=[4, 10, 7, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Real                      (5) | Train Loss: 0.6178 | Train Acc: 0.7500
 Site-Real                      (5) | Train Loss: 0.4115 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.0913 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.3325 | Train Acc: 0.9062
 Site-Real                      (2) | Train Loss: 0.2529 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.1133 | Train Acc: 0.9881
 Site-Real                      (5) | Train Loss: 0.2375 | Train Acc: 0.9552
 Site-Real                      (2) | Train Loss: 0.2056 | Train Acc: 0.9535
 Site-Real                      (2) | Train Loss: 0.2433 | Train Acc: 0.9478
 Site-Real                      (2) | Train Loss: 0.2201 | Train Acc: 0.9547
 Site-Clipart                   (0) | Train Loss: 0.4714 | Train Acc: 0.9048
 Site-Clipart                   (3) | Train Loss: 0.3209 | Train Acc: 0.9394
 Site-Clipart                   (3) | Train Loss: 0.4799 | Train Acc: 0.8704
 Site-Clipart                   (0) | Train Loss: 0.4130 | Train Acc: 0.8837
 Site-Clipart                   (0) | Train Loss: 0.4191 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.4480 | Train Acc: 0.8829
 Site-Clipart                   (3) | Train Loss: 0.3891 | Train Acc: 0.9014
 Site-Painting                  (4) | Train Loss: 0.4207 | Train Acc: 0.9344
 Site-Painting                  (4) | Train Loss: 0.3643 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.3664 | Train Acc: 0.8854
 Site-Painting                  (4) | Train Loss: 0.3786 | Train Acc: 0.9127
 Site-Sketch                    (0) | Train Loss: 0.2720 | Train Acc: 0.8824
 Site-Sketch                    (0) | Train Loss: 0.4901 | Train Acc: 0.8455
 Site-Sketch                    (0) | Train Loss: 0.5703 | Train Acc: 0.8125
 Site-Infograph                 (3) | Train Loss: 1.4222 | Train Acc: 0.5412
 Site-Infograph                 (3) | Train Loss: 1.0818 | Train Acc: 0.6324
 Site-QuickDraw                 (1) | Train Loss: 0.9381 | Train Acc: 0.7246
Average Train Accuracy: 0.8732
 Site-Real                      (5) | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.0966 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0772 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.2463 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2867 | Val  Acc: 0.9714
 Site-Real                      (2) | Val  Loss: 0.1871 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.1962 | Val  Acc: 0.9438
 Site-Real                      (2) | Val  Loss: 0.3354 | Val  Acc: 0.9091
 Site-Real                      (2) | Val  Loss: 0.2337 | Val  Acc: 0.9520
 Site-Real                      (2) | Val  Loss: 0.2342 | Val  Acc: 0.9455
 Site-Clipart                   (0) | Val  Loss: 0.4401 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.3206 | Val  Acc: 0.8636
 Site-Clipart                   (3) | Val  Loss: 0.5188 | Val  Acc: 0.8611
 Site-Clipart                   (0) | Val  Loss: 0.4980 | Val  Acc: 0.8421
 Site-Clipart                   (0) | Val  Loss: 0.4297 | Val  Acc: 0.8804
 Site-Clipart                   (0) | Val  Loss: 0.3671 | Val  Acc: 0.9054
 Site-Clipart                   (3) | Val  Loss: 0.4684 | Val  Acc: 0.8517
 Site-Painting                  (4) | Val  Loss: 0.5217 | Val  Acc: 0.8780
 Site-Painting                  (4) | Val  Loss: 0.4297 | Val  Acc: 0.9077
 Site-Painting                  (4) | Val  Loss: 0.3152 | Val  Acc: 0.9429
 Site-Painting                  (4) | Val  Loss: 0.3414 | Val  Acc: 0.8988
 Site-Sketch                    (0) | Val  Loss: 0.7303 | Val  Acc: 0.7556
 Site-Sketch                    (0) | Val  Loss: 0.6865 | Val  Acc: 0.8356
 Site-Sketch                    (0) | Val  Loss: 0.5148 | Val  Acc: 0.8291
 Site-Infograph                 (3) | Val  Loss: 1.0351 | Val  Acc: 0.7143
 Site-Infograph                 (3) | Val  Loss: 1.1890 | Val  Acc: 0.6264
 Site-QuickDraw                 (1) | Val  Loss: 1.4016 | Val  Acc: 0.6196
Average Valid Accuracy: 0.8767
 Best site-Real                     (5)  | Epoch:32 | Val Acc: 1.0000
 Best site-Real                     (5)  | Epoch:32 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:32 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:32 | Val Acc: 0.9714
 Best site-Real                     (2)  | Epoch:32 | Val Acc: 0.9286
 Best site-Real                     (5)  | Epoch:32 | Val Acc: 0.9438
 Best site-Real                     (2)  | Epoch:32 | Val Acc: 0.9091
 Best site-Real                     (2)  | Epoch:32 | Val Acc: 0.9520
 Best site-Real                     (2)  | Epoch:32 | Val Acc: 0.9455
 Best site-Clipart                  (0)  | Epoch:32 | Val Acc: 0.8571
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.8636
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.8611
 Best site-Clipart                  (0)  | Epoch:32 | Val Acc: 0.8421
 Best site-Clipart                  (0)  | Epoch:32 | Val Acc: 0.8804
 Best site-Clipart                  (0)  | Epoch:32 | Val Acc: 0.9054
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.8517
 Best site-Painting                 (4)  | Epoch:32 | Val Acc: 0.8780
 Best site-Painting                 (4)  | Epoch:32 | Val Acc: 0.9077
 Best site-Painting                 (4)  | Epoch:32 | Val Acc: 0.9429
 Best site-Painting                 (4)  | Epoch:32 | Val Acc: 0.8988
 Best site-Sketch                   (0)  | Epoch:32 | Val Acc: 0.7556
 Best site-Sketch                   (0)  | Epoch:32 | Val Acc: 0.8356
 Best site-Sketch                   (0)  | Epoch:32 | Val Acc: 0.8291
 Best site-Infograph                (3)  | Epoch:32 | Val Acc: 0.7143
 Best site-Infograph                (3)  | Epoch:32 | Val Acc: 0.6264
 Best site-QuickDraw                (1)  | Epoch:32 | Val Acc: 0.6196
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 33 ============
cnt=[10, 1, 5, 8, 1, 2, ]
cnt=[9, 10, 1, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Real                      (4) | Train Loss: 0.6361 | Train Acc: 0.7500
 Site-Real                      (2) | Train Loss: 0.3841 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.1016 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.2844 | Train Acc: 0.9062
 Site-Real                      (3) | Train Loss: 0.2868 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.1447 | Train Acc: 0.9643
 Site-Real                      (2) | Train Loss: 0.1464 | Train Acc: 0.9627
 Site-Real                      (3) | Train Loss: 0.2367 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.2389 | Train Acc: 0.9449
 Site-Real                      (2) | Train Loss: 0.2113 | Train Acc: 0.9547
 Site-Clipart                   (0) | Train Loss: 0.4050 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.3997 | Train Acc: 0.8788
 Site-Clipart                   (0) | Train Loss: 0.4828 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.4243 | Train Acc: 0.8488
 Site-Clipart                   (0) | Train Loss: 0.3443 | Train Acc: 0.9203
 Site-Clipart                   (0) | Train Loss: 0.3885 | Train Acc: 0.8964
 Site-Clipart                   (0) | Train Loss: 0.3773 | Train Acc: 0.9155
 Site-Painting                  (3) | Train Loss: 0.3768 | Train Acc: 0.9016
 Site-Painting                  (3) | Train Loss: 0.3354 | Train Acc: 0.9184
 Site-Painting                  (3) | Train Loss: 0.3607 | Train Acc: 0.9299
 Site-Painting                  (3) | Train Loss: 0.3781 | Train Acc: 0.9087
 Site-Sketch                    (0) | Train Loss: 0.4136 | Train Acc: 0.8971
 Site-Sketch                    (0) | Train Loss: 0.5224 | Train Acc: 0.8818
 Site-Sketch                    (0) | Train Loss: 0.5742 | Train Acc: 0.8068
 Site-Infograph                 (5) | Train Loss: 1.4867 | Train Acc: 0.5412
 Site-Infograph                 (5) | Train Loss: 1.2558 | Train Acc: 0.6544
 Site-QuickDraw                 (1) | Train Loss: 1.0706 | Train Acc: 0.7101
Average Train Accuracy: 0.8717
 Site-Real                      (4) | Val  Loss: 0.0229 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0798 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0814 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2225 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3216 | Val  Acc: 0.9429
 Site-Real                      (2) | Val  Loss: 0.1958 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2363 | Val  Acc: 0.9213
 Site-Real                      (3) | Val  Loss: 0.2938 | Val  Acc: 0.9371
 Site-Real                      (3) | Val  Loss: 0.2313 | Val  Acc: 0.9476
 Site-Real                      (2) | Val  Loss: 0.2206 | Val  Acc: 0.9482
 Site-Clipart                   (0) | Val  Loss: 0.4061 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.3266 | Val  Acc: 0.9545
 Site-Clipart                   (0) | Val  Loss: 0.5197 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.5103 | Val  Acc: 0.8772
 Site-Clipart                   (0) | Val  Loss: 0.4712 | Val  Acc: 0.8696
 Site-Clipart                   (0) | Val  Loss: 0.3582 | Val  Acc: 0.9054
 Site-Clipart                   (0) | Val  Loss: 0.4474 | Val  Acc: 0.8941
 Site-Painting                  (3) | Val  Loss: 0.5196 | Val  Acc: 0.9268
 Site-Painting                  (3) | Val  Loss: 0.7539 | Val  Acc: 0.8769
 Site-Painting                  (3) | Val  Loss: 0.3355 | Val  Acc: 0.9143
 Site-Painting                  (3) | Val  Loss: 0.3097 | Val  Acc: 0.9226
 Site-Sketch                    (0) | Val  Loss: 0.6581 | Val  Acc: 0.7778
 Site-Sketch                    (0) | Val  Loss: 0.5836 | Val  Acc: 0.7671
 Site-Sketch                    (0) | Val  Loss: 0.5163 | Val  Acc: 0.8462
 Site-Infograph                 (5) | Val  Loss: 1.1182 | Val  Acc: 0.6786
 Site-Infograph                 (5) | Val  Loss: 1.1517 | Val  Acc: 0.6264
 Site-QuickDraw                 (1) | Val  Loss: 1.3674 | Val  Acc: 0.6196
Average Valid Accuracy: 0.8787
 Best site-Real                     (4)  | Epoch:33 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:33 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:33 | Val Acc: 0.9429
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9213
 Best site-Real                     (3)  | Epoch:33 | Val Acc: 0.9371
 Best site-Real                     (3)  | Epoch:33 | Val Acc: 0.9476
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9482
 Best site-Clipart                  (0)  | Epoch:33 | Val Acc: 0.8571
 Best site-Clipart                  (0)  | Epoch:33 | Val Acc: 0.9545
 Best site-Clipart                  (0)  | Epoch:33 | Val Acc: 0.8333
 Best site-Clipart                  (0)  | Epoch:33 | Val Acc: 0.8772
 Best site-Clipart                  (0)  | Epoch:33 | Val Acc: 0.8696
 Best site-Clipart                  (0)  | Epoch:33 | Val Acc: 0.9054
 Best site-Clipart                  (0)  | Epoch:33 | Val Acc: 0.8941
 Best site-Painting                 (3)  | Epoch:33 | Val Acc: 0.9268
 Best site-Painting                 (3)  | Epoch:33 | Val Acc: 0.8769
 Best site-Painting                 (3)  | Epoch:33 | Val Acc: 0.9143
 Best site-Painting                 (3)  | Epoch:33 | Val Acc: 0.9226
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.7778
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.7671
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.8462
 Best site-Infograph                (5)  | Epoch:33 | Val Acc: 0.6786
 Best site-Infograph                (5)  | Epoch:33 | Val Acc: 0.6264
 Best site-QuickDraw                (1)  | Epoch:33 | Val Acc: 0.6196
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 34 ============
cnt=[7, 1, 3, 9, 3, 4, ]
cnt=[10, 3, 1, 7, 4, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Real                      (4) | Train Loss: 0.6515 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.3614 | Train Acc: 0.8333
 Site-Real                      (4) | Train Loss: 0.1257 | Train Acc: 1.0000
 Site-Real                      (5) | Train Loss: 0.2995 | Train Acc: 0.9375
 Site-Real                      (0) | Train Loss: 0.2770 | Train Acc: 0.9231
 Site-Real                      (0) | Train Loss: 0.1073 | Train Acc: 0.9881
 Site-Real                      (0) | Train Loss: 0.1779 | Train Acc: 0.9552
 Site-Real                      (0) | Train Loss: 0.2385 | Train Acc: 0.9488
 Site-Real                      (0) | Train Loss: 0.2351 | Train Acc: 0.9536
 Site-Real                      (0) | Train Loss: 0.1984 | Train Acc: 0.9547
 Site-Clipart                   (2) | Train Loss: 0.4934 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.3377 | Train Acc: 0.9394
 Site-Clipart                   (3) | Train Loss: 0.4204 | Train Acc: 0.9074
 Site-Clipart                   (3) | Train Loss: 0.4314 | Train Acc: 0.8721
 Site-Clipart                   (3) | Train Loss: 0.3220 | Train Acc: 0.9348
 Site-Clipart                   (3) | Train Loss: 0.4496 | Train Acc: 0.8694
 Site-Clipart                   (3) | Train Loss: 0.3557 | Train Acc: 0.9099
 Site-Painting                  (5) | Train Loss: 0.4197 | Train Acc: 0.9016
 Site-Painting                  (5) | Train Loss: 0.3515 | Train Acc: 0.9082
 Site-Painting                  (5) | Train Loss: 0.3592 | Train Acc: 0.8726
 Site-Painting                  (0) | Train Loss: 0.3424 | Train Acc: 0.9087
 Site-Sketch                    (3) | Train Loss: 0.2154 | Train Acc: 0.8971
 Site-Sketch                    (2) | Train Loss: 0.4817 | Train Acc: 0.8364
 Site-Sketch                    (2) | Train Loss: 0.5408 | Train Acc: 0.8352
 Site-Infograph                 (3) | Train Loss: 1.4093 | Train Acc: 0.5294
 Site-Infograph                 (3) | Train Loss: 1.1121 | Train Acc: 0.6397
 Site-QuickDraw                 (1) | Train Loss: 0.9319 | Train Acc: 0.7029
Average Train Accuracy: 0.8728
 Site-Real                      (4) | Val  Loss: 0.0187 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0920 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0718 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.2746 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.3255 | Val  Acc: 0.8857
 Site-Real                      (0) | Val  Loss: 0.1811 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2156 | Val  Acc: 0.9438
 Site-Real                      (0) | Val  Loss: 0.2588 | Val  Acc: 0.9231
 Site-Real                      (0) | Val  Loss: 0.2310 | Val  Acc: 0.9432
 Site-Real                      (0) | Val  Loss: 0.2363 | Val  Acc: 0.9401
 Site-Clipart                   (2) | Val  Loss: 0.4160 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.2500 | Val  Acc: 0.9545
 Site-Clipart                   (3) | Val  Loss: 0.5700 | Val  Acc: 0.8611
 Site-Clipart                   (3) | Val  Loss: 0.4997 | Val  Acc: 0.8596
 Site-Clipart                   (3) | Val  Loss: 0.3790 | Val  Acc: 0.9239
 Site-Clipart                   (3) | Val  Loss: 0.3544 | Val  Acc: 0.9189
 Site-Clipart                   (3) | Val  Loss: 0.4336 | Val  Acc: 0.8771
 Site-Painting                  (5) | Val  Loss: 0.4917 | Val  Acc: 0.9024
 Site-Painting                  (5) | Val  Loss: 0.6551 | Val  Acc: 0.9077
 Site-Painting                  (5) | Val  Loss: 0.3192 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3672 | Val  Acc: 0.8750
 Site-Sketch                    (3) | Val  Loss: 0.7226 | Val  Acc: 0.7111
 Site-Sketch                    (2) | Val  Loss: 0.7872 | Val  Acc: 0.7808
 Site-Sketch                    (2) | Val  Loss: 0.5267 | Val  Acc: 0.8205
 Site-Infograph                 (3) | Val  Loss: 1.0957 | Val  Acc: 0.6250
 Site-Infograph                 (3) | Val  Loss: 1.1489 | Val  Acc: 0.5934
 Site-QuickDraw                 (1) | Val  Loss: 1.3479 | Val  Acc: 0.5761
Average Valid Accuracy: 0.8715
============ Train epoch 35 ============
cnt=[6, 1, 9, 7, 3, 1, ]
cnt=[10, 4, 9, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Real                      (5) | Train Loss: 0.6449 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.3830 | Train Acc: 0.8333
 Site-Real                      (0) | Train Loss: 0.1054 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.3111 | Train Acc: 0.9062
 Site-Real                      (0) | Train Loss: 0.2821 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.1017 | Train Acc: 0.9881
 Site-Real                      (0) | Train Loss: 0.3994 | Train Acc: 0.9552
 Site-Real                      (3) | Train Loss: 0.2179 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.2154 | Train Acc: 0.9333
 Site-Real                      (0) | Train Loss: 0.1900 | Train Acc: 0.9638
 Site-Clipart                   (2) | Train Loss: 0.4868 | Train Acc: 0.8571
 Site-Clipart                   (2) | Train Loss: 0.3877 | Train Acc: 0.8788
 Site-Clipart                   (2) | Train Loss: 0.4241 | Train Acc: 0.8704
 Site-Clipart                   (2) | Train Loss: 0.5211 | Train Acc: 0.8372
 Site-Clipart                   (2) | Train Loss: 0.2687 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.4680 | Train Acc: 0.8514
 Site-Clipart                   (2) | Train Loss: 0.3498 | Train Acc: 0.9014
 Site-Painting                  (3) | Train Loss: 0.4096 | Train Acc: 0.8689
 Site-Painting                  (3) | Train Loss: 0.4487 | Train Acc: 0.8776
 Site-Painting                  (3) | Train Loss: 0.3641 | Train Acc: 0.8854
 Site-Painting                  (3) | Train Loss: 0.3346 | Train Acc: 0.9206
 Site-Sketch                    (4) | Train Loss: 0.2394 | Train Acc: 0.8824
 Site-Sketch                    (4) | Train Loss: 0.4565 | Train Acc: 0.8727
 Site-Sketch                    (4) | Train Loss: 0.4947 | Train Acc: 0.8523
 Site-Infograph                 (2) | Train Loss: 1.4257 | Train Acc: 0.5647
 Site-Infograph                 (2) | Train Loss: 1.1306 | Train Acc: 0.6397
 Site-QuickDraw                 (1) | Train Loss: 0.9806 | Train Acc: 0.6957
Average Train Accuracy: 0.8652
 Site-Real                      (5) | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0814 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.0884 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.2243 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2911 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.1484 | Val  Acc: 0.9821
 Site-Real                      (0) | Val  Loss: 0.1853 | Val  Acc: 0.9438
 Site-Real                      (3) | Val  Loss: 0.3394 | Val  Acc: 0.9231
 Site-Real                      (0) | Val  Loss: 0.2067 | Val  Acc: 0.9563
 Site-Real                      (0) | Val  Loss: 0.2020 | Val  Acc: 0.9455
 Site-Clipart                   (2) | Val  Loss: 0.5783 | Val  Acc: 0.6429
 Site-Clipart                   (2) | Val  Loss: 0.2743 | Val  Acc: 0.9091
 Site-Clipart                   (2) | Val  Loss: 0.5012 | Val  Acc: 0.8056
 Site-Clipart                   (2) | Val  Loss: 0.5300 | Val  Acc: 0.7895
 Site-Clipart                   (2) | Val  Loss: 0.4440 | Val  Acc: 0.9022
 Site-Clipart                   (2) | Val  Loss: 0.3752 | Val  Acc: 0.9122
 Site-Clipart                   (2) | Val  Loss: 0.4154 | Val  Acc: 0.8983
 Site-Painting                  (3) | Val  Loss: 0.4988 | Val  Acc: 0.8780
 Site-Painting                  (3) | Val  Loss: 0.5004 | Val  Acc: 0.8923
 Site-Painting                  (3) | Val  Loss: 0.2373 | Val  Acc: 0.9714
 Site-Painting                  (3) | Val  Loss: 0.2944 | Val  Acc: 0.9286
 Site-Sketch                    (4) | Val  Loss: 0.6565 | Val  Acc: 0.8000
 Site-Sketch                    (4) | Val  Loss: 0.7104 | Val  Acc: 0.8082
 Site-Sketch                    (4) | Val  Loss: 0.5232 | Val  Acc: 0.8376
 Site-Infograph                 (2) | Val  Loss: 1.0765 | Val  Acc: 0.6607
 Site-Infograph                 (2) | Val  Loss: 1.1094 | Val  Acc: 0.6484
 Site-QuickDraw                 (1) | Val  Loss: 1.3708 | Val  Acc: 0.6087
Average Valid Accuracy: 0.8708
============ Train epoch 36 ============
cnt=[2, 1, 9, 2, 12, 1, ]
cnt=[3, 10, 2, 7, 1, 4, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Real                      (0) | Train Loss: 0.6219 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.3592 | Train Acc: 0.8333
 Site-Real                      (4) | Train Loss: 0.0773 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.2988 | Train Acc: 0.9375
 Site-Real                      (4) | Train Loss: 0.2431 | Train Acc: 0.9231
 Site-Real                      (4) | Train Loss: 0.1023 | Train Acc: 0.9881
 Site-Real                      (0) | Train Loss: 0.1245 | Train Acc: 0.9627
 Site-Real                      (4) | Train Loss: 0.2166 | Train Acc: 0.9442
 Site-Real                      (4) | Train Loss: 0.2042 | Train Acc: 0.9478
 Site-Real                      (4) | Train Loss: 0.1963 | Train Acc: 0.9565
 Site-Clipart                   (2) | Train Loss: 0.4207 | Train Acc: 0.9048
 Site-Clipart                   (2) | Train Loss: 0.3352 | Train Acc: 0.8788
 Site-Clipart                   (5) | Train Loss: 0.4697 | Train Acc: 0.8519
 Site-Clipart                   (2) | Train Loss: 0.4626 | Train Acc: 0.8953
 Site-Clipart                   (2) | Train Loss: 0.4479 | Train Acc: 0.9420
 Site-Clipart                   (2) | Train Loss: 0.4611 | Train Acc: 0.8468
 Site-Clipart                   (2) | Train Loss: 0.3932 | Train Acc: 0.8930
 Site-Painting                  (4) | Train Loss: 0.3573 | Train Acc: 0.9180
 Site-Painting                  (4) | Train Loss: 0.3603 | Train Acc: 0.8776
 Site-Painting                  (4) | Train Loss: 0.3521 | Train Acc: 0.8981
 Site-Painting                  (4) | Train Loss: 0.3424 | Train Acc: 0.9286
 Site-Sketch                    (2) | Train Loss: 0.4923 | Train Acc: 0.8676
 Site-Sketch                    (2) | Train Loss: 0.4251 | Train Acc: 0.8727
 Site-Sketch                    (2) | Train Loss: 0.5253 | Train Acc: 0.8352
 Site-Infograph                 (3) | Train Loss: 1.4681 | Train Acc: 0.5059
 Site-Infograph                 (3) | Train Loss: 1.0532 | Train Acc: 0.6765
 Site-QuickDraw                 (1) | Train Loss: 0.9599 | Train Acc: 0.7246
Average Train Accuracy: 0.8726
 Site-Real                      (0) | Val  Loss: 0.0218 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0580 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0682 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.2217 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2941 | Val  Acc: 0.9143
 Site-Real                      (4) | Val  Loss: 0.1859 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.1923 | Val  Acc: 0.9551
 Site-Real                      (4) | Val  Loss: 0.2320 | Val  Acc: 0.9510
 Site-Real                      (4) | Val  Loss: 0.2116 | Val  Acc: 0.9607
 Site-Real                      (4) | Val  Loss: 0.2222 | Val  Acc: 0.9401
 Site-Clipart                   (2) | Val  Loss: 0.4359 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.3420 | Val  Acc: 0.9091
 Site-Clipart                   (5) | Val  Loss: 0.4697 | Val  Acc: 0.8611
 Site-Clipart                   (2) | Val  Loss: 0.4966 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.4224 | Val  Acc: 0.9022
 Site-Clipart                   (2) | Val  Loss: 0.3667 | Val  Acc: 0.8784
 Site-Clipart                   (2) | Val  Loss: 0.4961 | Val  Acc: 0.8517
 Site-Painting                  (4) | Val  Loss: 0.4640 | Val  Acc: 0.9268
 Site-Painting                  (4) | Val  Loss: 0.6848 | Val  Acc: 0.8769
 Site-Painting                  (4) | Val  Loss: 0.3181 | Val  Acc: 0.9333
 Site-Painting                  (4) | Val  Loss: 0.2539 | Val  Acc: 0.9643
 Site-Sketch                    (2) | Val  Loss: 0.7046 | Val  Acc: 0.7333
 Site-Sketch                    (2) | Val  Loss: 0.5734 | Val  Acc: 0.7397
 Site-Sketch                    (2) | Val  Loss: 0.5784 | Val  Acc: 0.7863
 Site-Infograph                 (3) | Val  Loss: 1.1047 | Val  Acc: 0.5893
 Site-Infograph                 (3) | Val  Loss: 1.1265 | Val  Acc: 0.6154
 Site-QuickDraw                 (1) | Val  Loss: 1.2369 | Val  Acc: 0.6196
Average Valid Accuracy: 0.8713
============ Train epoch 37 ============
cnt=[2, 1, 7, 7, 7, 3, ]
cnt=[3, 10, 2, 1, 7, 4, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Real                      (3) | Train Loss: 0.5901 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.3606 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.0844 | Train Acc: 1.0000
 Site-Real                      (2) | Train Loss: 0.2785 | Train Acc: 0.9375
 Site-Real                      (2) | Train Loss: 0.2631 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.1286 | Train Acc: 0.9881
 Site-Real                      (3) | Train Loss: 0.1551 | Train Acc: 0.9552
 Site-Real                      (2) | Train Loss: 0.2155 | Train Acc: 0.9488
 Site-Real                      (3) | Train Loss: 0.2447 | Train Acc: 0.9449
 Site-Real                      (3) | Train Loss: 0.1928 | Train Acc: 0.9583
 Site-Clipart                   (4) | Train Loss: 0.3757 | Train Acc: 0.9048
 Site-Clipart                   (5) | Train Loss: 0.3337 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.4647 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.4402 | Train Acc: 0.8488
 Site-Clipart                   (4) | Train Loss: 0.3109 | Train Acc: 0.9203
 Site-Clipart                   (4) | Train Loss: 0.4645 | Train Acc: 0.8739
 Site-Clipart                   (4) | Train Loss: 0.3688 | Train Acc: 0.9014
 Site-Painting                  (2) | Train Loss: 0.4069 | Train Acc: 0.8361
 Site-Painting                  (2) | Train Loss: 0.3878 | Train Acc: 0.8571
 Site-Painting                  (2) | Train Loss: 0.3524 | Train Acc: 0.9108
 Site-Painting                  (2) | Train Loss: 0.3174 | Train Acc: 0.9246
 Site-Sketch                    (5) | Train Loss: 0.5123 | Train Acc: 0.8824
 Site-Sketch                    (4) | Train Loss: 0.4437 | Train Acc: 0.8545
 Site-Sketch                    (4) | Train Loss: 0.5401 | Train Acc: 0.8409
 Site-Infograph                 (0) | Train Loss: 1.2596 | Train Acc: 0.5294
 Site-Infograph                 (0) | Train Loss: 1.0618 | Train Acc: 0.6691
 Site-QuickDraw                 (1) | Train Loss: 1.0007 | Train Acc: 0.7536
Average Train Accuracy: 0.8720
 Site-Real                      (3) | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0725 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0823 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.2561 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.3296 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.1836 | Val  Acc: 0.9821
 Site-Real                      (3) | Val  Loss: 0.1881 | Val  Acc: 0.9438
 Site-Real                      (2) | Val  Loss: 0.2792 | Val  Acc: 0.9231
 Site-Real                      (3) | Val  Loss: 0.2342 | Val  Acc: 0.9432
 Site-Real                      (3) | Val  Loss: 0.2170 | Val  Acc: 0.9428
 Site-Clipart                   (4) | Val  Loss: 0.3938 | Val  Acc: 0.9286
 Site-Clipart                   (5) | Val  Loss: 0.2873 | Val  Acc: 0.8636
 Site-Clipart                   (5) | Val  Loss: 0.3975 | Val  Acc: 0.8889
 Site-Clipart                   (4) | Val  Loss: 0.5237 | Val  Acc: 0.8421
 Site-Clipart                   (4) | Val  Loss: 0.4289 | Val  Acc: 0.8804
 Site-Clipart                   (4) | Val  Loss: 0.3770 | Val  Acc: 0.8919
 Site-Clipart                   (4) | Val  Loss: 0.4265 | Val  Acc: 0.9025
 Site-Painting                  (2) | Val  Loss: 0.5063 | Val  Acc: 0.9024
 Site-Painting                  (2) | Val  Loss: 0.2992 | Val  Acc: 0.8923
 Site-Painting                  (2) | Val  Loss: 0.3236 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2790 | Val  Acc: 0.9405
 Site-Sketch                    (5) | Val  Loss: 0.7668 | Val  Acc: 0.7333
 Site-Sketch                    (4) | Val  Loss: 0.5945 | Val  Acc: 0.8356
 Site-Sketch                    (4) | Val  Loss: 0.5777 | Val  Acc: 0.8034
 Site-Infograph                 (0) | Val  Loss: 1.0282 | Val  Acc: 0.6786
 Site-Infograph                 (0) | Val  Loss: 1.1735 | Val  Acc: 0.6484
 Site-QuickDraw                 (1) | Val  Loss: 1.2337 | Val  Acc: 0.6630
Average Valid Accuracy: 0.8833
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 1.0000
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:37 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:37 | Val Acc: 0.9143
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 0.9821
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 0.9438
 Best site-Real                     (2)  | Epoch:37 | Val Acc: 0.9231
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 0.9432
 Best site-Real                     (3)  | Epoch:37 | Val Acc: 0.9428
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.9286
 Best site-Clipart                  (5)  | Epoch:37 | Val Acc: 0.8636
 Best site-Clipart                  (5)  | Epoch:37 | Val Acc: 0.8889
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.8421
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.8804
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.8919
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.9025
 Best site-Painting                 (2)  | Epoch:37 | Val Acc: 0.9024
 Best site-Painting                 (2)  | Epoch:37 | Val Acc: 0.8923
 Best site-Painting                 (2)  | Epoch:37 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:37 | Val Acc: 0.9405
 Best site-Sketch                   (5)  | Epoch:37 | Val Acc: 0.7333
 Best site-Sketch                   (4)  | Epoch:37 | Val Acc: 0.8356
 Best site-Sketch                   (4)  | Epoch:37 | Val Acc: 0.8034
 Best site-Infograph                (0)  | Epoch:37 | Val Acc: 0.6786
 Best site-Infograph                (0)  | Epoch:37 | Val Acc: 0.6484
 Best site-QuickDraw                (1)  | Epoch:37 | Val Acc: 0.6630
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 38 ============
cnt=[4, 1, 7, 7, 6, 2, ]
cnt=[2, 10, 9, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Real                      (2) | Train Loss: 0.6582 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.3770 | Train Acc: 0.9167
 Site-Real                      (3) | Train Loss: 0.1068 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.3333 | Train Acc: 0.9062
 Site-Real                      (2) | Train Loss: 0.2765 | Train Acc: 0.9423
 Site-Real                      (3) | Train Loss: 0.0984 | Train Acc: 0.9881
 Site-Real                      (3) | Train Loss: 0.1731 | Train Acc: 0.9701
 Site-Real                      (2) | Train Loss: 0.1949 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.2571 | Train Acc: 0.9420
 Site-Real                      (3) | Train Loss: 0.2061 | Train Acc: 0.9620
 Site-Clipart                   (0) | Train Loss: 0.4829 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.3767 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.4635 | Train Acc: 0.8519
 Site-Clipart                   (4) | Train Loss: 0.4568 | Train Acc: 0.8837
 Site-Clipart                   (0) | Train Loss: 0.3513 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.3969 | Train Acc: 0.8829
 Site-Clipart                   (4) | Train Loss: 0.3646 | Train Acc: 0.8986
 Site-Painting                  (2) | Train Loss: 0.4035 | Train Acc: 0.8689
 Site-Painting                  (2) | Train Loss: 0.3725 | Train Acc: 0.9184
 Site-Painting                  (2) | Train Loss: 0.3788 | Train Acc: 0.8790
 Site-Painting                  (2) | Train Loss: 0.3271 | Train Acc: 0.9087
 Site-Sketch                    (4) | Train Loss: 0.2186 | Train Acc: 0.8676
 Site-Sketch                    (4) | Train Loss: 0.4936 | Train Acc: 0.8818
 Site-Sketch                    (0) | Train Loss: 0.5149 | Train Acc: 0.8409
 Site-Infograph                 (5) | Train Loss: 1.3385 | Train Acc: 0.5412
 Site-Infograph                 (5) | Train Loss: 0.8310 | Train Acc: 0.7132
 Site-QuickDraw                 (1) | Train Loss: 0.8892 | Train Acc: 0.7174
Average Train Accuracy: 0.8759
 Site-Real                      (2) | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0756 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0852 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2092 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.3091 | Val  Acc: 0.9429
 Site-Real                      (3) | Val  Loss: 0.2020 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.1598 | Val  Acc: 0.9663
 Site-Real                      (2) | Val  Loss: 0.2549 | Val  Acc: 0.9371
 Site-Real                      (3) | Val  Loss: 0.2089 | Val  Acc: 0.9520
 Site-Real                      (3) | Val  Loss: 0.2224 | Val  Acc: 0.9401
 Site-Clipart                   (0) | Val  Loss: 0.5919 | Val  Acc: 0.7143
 Site-Clipart                   (4) | Val  Loss: 0.3192 | Val  Acc: 0.9091
 Site-Clipart                   (4) | Val  Loss: 0.4364 | Val  Acc: 0.9167
 Site-Clipart                   (4) | Val  Loss: 0.4860 | Val  Acc: 0.8246
 Site-Clipart                   (0) | Val  Loss: 0.4410 | Val  Acc: 0.8696
 Site-Clipart                   (0) | Val  Loss: 0.3779 | Val  Acc: 0.8378
 Site-Clipart                   (4) | Val  Loss: 0.4343 | Val  Acc: 0.8983
 Site-Painting                  (2) | Val  Loss: 0.4860 | Val  Acc: 0.8780
 Site-Painting                  (2) | Val  Loss: 0.6380 | Val  Acc: 0.8615
 Site-Painting                  (2) | Val  Loss: 0.2842 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2835 | Val  Acc: 0.9286
 Site-Sketch                    (4) | Val  Loss: 0.7669 | Val  Acc: 0.7333
 Site-Sketch                    (4) | Val  Loss: 0.7127 | Val  Acc: 0.7671
 Site-Sketch                    (0) | Val  Loss: 0.5438 | Val  Acc: 0.8291
 Site-Infograph                 (5) | Val  Loss: 1.0406 | Val  Acc: 0.6786
 Site-Infograph                 (5) | Val  Loss: 1.0776 | Val  Acc: 0.6923
 Site-QuickDraw                 (1) | Val  Loss: 1.2564 | Val  Acc: 0.6196
Average Valid Accuracy: 0.8715
============ Train epoch 39 ============
cnt=[9, 1, 3, 10, 2, 2, ]
cnt=[3, 10, 1, 7, 2, 4, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Real                      (4) | Train Loss: 0.6142 | Train Acc: 0.7500
 Site-Real                      (2) | Train Loss: 0.3593 | Train Acc: 0.9167
 Site-Real                      (4) | Train Loss: 0.1236 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.2890 | Train Acc: 0.9375
 Site-Real                      (0) | Train Loss: 0.2671 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.1640 | Train Acc: 0.9881
 Site-Real                      (2) | Train Loss: 0.1443 | Train Acc: 0.9701
 Site-Real                      (0) | Train Loss: 0.2322 | Train Acc: 0.9442
 Site-Real                      (0) | Train Loss: 0.2091 | Train Acc: 0.9420
 Site-Real                      (0) | Train Loss: 0.1885 | Train Acc: 0.9547
 Site-Clipart                   (3) | Train Loss: 0.4328 | Train Acc: 0.8095
 Site-Clipart                   (3) | Train Loss: 0.3261 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.4738 | Train Acc: 0.8519
 Site-Clipart                   (3) | Train Loss: 0.4193 | Train Acc: 0.8256
 Site-Clipart                   (3) | Train Loss: 0.2680 | Train Acc: 0.9565
 Site-Clipart                   (3) | Train Loss: 0.4219 | Train Acc: 0.8694
 Site-Clipart                   (3) | Train Loss: 0.3501 | Train Acc: 0.9042
 Site-Painting                  (0) | Train Loss: 0.4041 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.2730 | Train Acc: 0.9286
 Site-Painting                  (0) | Train Loss: 0.3482 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.3339 | Train Acc: 0.9206
 Site-Sketch                    (3) | Train Loss: 0.2172 | Train Acc: 0.9118
 Site-Sketch                    (3) | Train Loss: 0.4458 | Train Acc: 0.8727
 Site-Sketch                    (3) | Train Loss: 0.5561 | Train Acc: 0.8239
 Site-Infograph                 (5) | Train Loss: 1.3633 | Train Acc: 0.5765
 Site-Infograph                 (5) | Train Loss: 1.0655 | Train Acc: 0.6765
 Site-QuickDraw                 (1) | Train Loss: 0.9152 | Train Acc: 0.7246
Average Train Accuracy: 0.8761
 Site-Real                      (4) | Val  Loss: 0.0191 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0606 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0716 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.1711 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2995 | Val  Acc: 0.9714
 Site-Real                      (2) | Val  Loss: 0.1560 | Val  Acc: 0.9821
 Site-Real                      (2) | Val  Loss: 0.2005 | Val  Acc: 0.9326
 Site-Real                      (0) | Val  Loss: 0.2808 | Val  Acc: 0.9441
 Site-Real                      (0) | Val  Loss: 0.2111 | Val  Acc: 0.9476
 Site-Real                      (0) | Val  Loss: 0.2308 | Val  Acc: 0.9292
 Site-Clipart                   (3) | Val  Loss: 0.4264 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.3030 | Val  Acc: 0.9091
 Site-Clipart                   (3) | Val  Loss: 0.5182 | Val  Acc: 0.8611
 Site-Clipart                   (3) | Val  Loss: 0.5174 | Val  Acc: 0.8246
 Site-Clipart                   (3) | Val  Loss: 0.4067 | Val  Acc: 0.9239
 Site-Clipart                   (3) | Val  Loss: 0.3383 | Val  Acc: 0.9189
 Site-Clipart                   (3) | Val  Loss: 0.4357 | Val  Acc: 0.8729
 Site-Painting                  (0) | Val  Loss: 0.4193 | Val  Acc: 0.9268
 Site-Painting                  (0) | Val  Loss: 0.3757 | Val  Acc: 0.9077
 Site-Painting                  (0) | Val  Loss: 0.2994 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3157 | Val  Acc: 0.9048
 Site-Sketch                    (3) | Val  Loss: 0.5966 | Val  Acc: 0.8889
 Site-Sketch                    (3) | Val  Loss: 0.9552 | Val  Acc: 0.7397
 Site-Sketch                    (3) | Val  Loss: 0.5345 | Val  Acc: 0.8547
 Site-Infograph                 (5) | Val  Loss: 0.9708 | Val  Acc: 0.6964
 Site-Infograph                 (5) | Val  Loss: 1.1110 | Val  Acc: 0.6484
 Site-QuickDraw                 (1) | Val  Loss: 1.2356 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8881
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 1.0000
 Best site-Real                     (2)  | Epoch:39 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 1.0000
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9714
 Best site-Real                     (2)  | Epoch:39 | Val Acc: 0.9821
 Best site-Real                     (2)  | Epoch:39 | Val Acc: 0.9326
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9441
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9476
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9292
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.8571
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.9091
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.8611
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.8246
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.9239
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.9189
 Best site-Clipart                  (3)  | Epoch:39 | Val Acc: 0.8729
 Best site-Painting                 (0)  | Epoch:39 | Val Acc: 0.9268
 Best site-Painting                 (0)  | Epoch:39 | Val Acc: 0.9077
 Best site-Painting                 (0)  | Epoch:39 | Val Acc: 0.9333
 Best site-Painting                 (0)  | Epoch:39 | Val Acc: 0.9048
 Best site-Sketch                   (3)  | Epoch:39 | Val Acc: 0.8889
 Best site-Sketch                   (3)  | Epoch:39 | Val Acc: 0.7397
 Best site-Sketch                   (3)  | Epoch:39 | Val Acc: 0.8547
 Best site-Infograph                (5)  | Epoch:39 | Val Acc: 0.6964
 Best site-Infograph                (5)  | Epoch:39 | Val Acc: 0.6484
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.6522
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Test site-Real                      (4)| Epoch:39 | Test Acc: 0.9515
 Test site-Clipart                   (3)| Epoch:39 | Test Acc: 0.8688
 Test site-Painting                  (0)| Epoch:39 | Test Acc: 0.9273
 Test site-Sketch                    (3)| Epoch:39 | Test Acc: 0.8736
 Test site-Infograph                 (5)| Epoch:39 | Test Acc: 0.5464
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.6560
Real: 0.9515, Clipart: 0.8688, Painting: 0.9273, Sketch: 0.8736, Infograph: 0.5464, QuickDraw: 0.6560, 
Average Test Accuracy(group): 0.8040, Average Test Accuracy(individual): 0.8769,
domain std=0.1496, cluster std=0.1599, individual std=0.1111, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 1, 8, 6, 8, 2, ]
cnt=[6, 9, 7, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Real                      (2) | Train Loss: 0.6546 | Train Acc: 0.7500
 Site-Real                      (2) | Train Loss: 0.3357 | Train Acc: 0.9167
 Site-Real                      (2) | Train Loss: 0.0995 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.3202 | Train Acc: 0.9375
 Site-Real                      (3) | Train Loss: 0.2654 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.1117 | Train Acc: 0.9881
 Site-Real                      (2) | Train Loss: 0.1500 | Train Acc: 0.9627
 Site-Real                      (2) | Train Loss: 0.2299 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.2045 | Train Acc: 0.9565
 Site-Real                      (2) | Train Loss: 0.2002 | Train Acc: 0.9620
 Site-Clipart                   (4) | Train Loss: 0.5783 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.3337 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.4946 | Train Acc: 0.8148
 Site-Clipart                   (4) | Train Loss: 0.4285 | Train Acc: 0.8837
 Site-Clipart                   (4) | Train Loss: 0.2868 | Train Acc: 0.9420
 Site-Clipart                   (4) | Train Loss: 0.4384 | Train Acc: 0.8739
 Site-Clipart                   (4) | Train Loss: 0.3514 | Train Acc: 0.9042
 Site-Painting                  (3) | Train Loss: 0.4497 | Train Acc: 0.8689
 Site-Painting                  (3) | Train Loss: 0.2911 | Train Acc: 0.9184
 Site-Painting                  (3) | Train Loss: 0.3375 | Train Acc: 0.8981
 Site-Painting                  (3) | Train Loss: 0.3251 | Train Acc: 0.9365
 Site-Sketch                    (0) | Train Loss: 0.3148 | Train Acc: 0.8676
 Site-Sketch                    (4) | Train Loss: 0.5094 | Train Acc: 0.8364
 Site-Sketch                    (4) | Train Loss: 0.5182 | Train Acc: 0.8068
 Site-Infograph                 (5) | Train Loss: 1.3057 | Train Acc: 0.5882
 Site-Infograph                 (5) | Train Loss: 0.9534 | Train Acc: 0.6912
 Site-QuickDraw                 (1) | Train Loss: 0.8659 | Train Acc: 0.7029
Average Train Accuracy: 0.8754
 Site-Real                      (2) | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0745 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0832 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2011 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3006 | Val  Acc: 0.9143
 Site-Real                      (2) | Val  Loss: 0.1800 | Val  Acc: 0.9464
 Site-Real                      (2) | Val  Loss: 0.1778 | Val  Acc: 0.9438
 Site-Real                      (2) | Val  Loss: 0.2628 | Val  Acc: 0.9371
 Site-Real                      (2) | Val  Loss: 0.2073 | Val  Acc: 0.9607
 Site-Real                      (2) | Val  Loss: 0.2115 | Val  Acc: 0.9455
 Site-Clipart                   (4) | Val  Loss: 0.4926 | Val  Acc: 0.7857
 Site-Clipart                   (0) | Val  Loss: 0.2761 | Val  Acc: 0.9545
 Site-Clipart                   (4) | Val  Loss: 0.4655 | Val  Acc: 0.8889
 Site-Clipart                   (4) | Val  Loss: 0.4349 | Val  Acc: 0.8596
 Site-Clipart                   (4) | Val  Loss: 0.4681 | Val  Acc: 0.8696
 Site-Clipart                   (4) | Val  Loss: 0.3366 | Val  Acc: 0.8986
 Site-Clipart                   (4) | Val  Loss: 0.4139 | Val  Acc: 0.8729
 Site-Painting                  (3) | Val  Loss: 0.4747 | Val  Acc: 0.9024
 Site-Painting                  (3) | Val  Loss: 0.3671 | Val  Acc: 0.9385
 Site-Painting                  (3) | Val  Loss: 0.2807 | Val  Acc: 0.9238
 Site-Painting                  (3) | Val  Loss: 0.3148 | Val  Acc: 0.8869
 Site-Sketch                    (0) | Val  Loss: 0.6978 | Val  Acc: 0.7333
 Site-Sketch                    (4) | Val  Loss: 0.5916 | Val  Acc: 0.7808
 Site-Sketch                    (4) | Val  Loss: 0.4413 | Val  Acc: 0.8889
 Site-Infograph                 (5) | Val  Loss: 0.9768 | Val  Acc: 0.6786
 Site-Infograph                 (5) | Val  Loss: 1.1170 | Val  Acc: 0.6484
 Site-QuickDraw                 (1) | Val  Loss: 1.2657 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8797
 Test site-Real                      (2)| Epoch:39 | Test Acc: 0.9523
 Test site-Clipart                   (4)| Epoch:39 | Test Acc: 0.8669
 Test site-Painting                  (3)| Epoch:39 | Test Acc: 0.9273
 Test site-Sketch                    (0)| Epoch:39 | Test Acc: 0.8718
 Test site-Infograph                 (5)| Epoch:39 | Test Acc: 0.5510
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.6540
Real: 0.9523, Clipart: 0.8669, Painting: 0.9273, Sketch: 0.8718, Infograph: 0.5510, QuickDraw: 0.6540, 
Average Test Accuracy(group): 0.8039, Average Test Accuracy(individual): 0.8768,
domain std=0.1485, cluster std=0.1496, individual std=0.1105, 
Average Test Accuracy: 0.8039
============ Train epoch 41 ============
cnt=[2, 1, 9, 2, 8, 5, ]
cnt=[10, 1, 3, 7, 2, 4, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Real                      (2) | Train Loss: 0.6178 | Train Acc: 0.7500
 Site-Real                      (2) | Train Loss: 0.3652 | Train Acc: 0.9167
 Site-Real                      (2) | Train Loss: 0.1005 | Train Acc: 1.0000
 Site-Real                      (2) | Train Loss: 0.3567 | Train Acc: 0.9062
 Site-Real                      (2) | Train Loss: 0.2166 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.1313 | Train Acc: 0.9762
 Site-Real                      (2) | Train Loss: 0.1579 | Train Acc: 0.9552
 Site-Real                      (5) | Train Loss: 0.1789 | Train Acc: 0.9488
 Site-Real                      (2) | Train Loss: 0.2099 | Train Acc: 0.9565
 Site-Real                      (2) | Train Loss: 0.1928 | Train Acc: 0.9547
 Site-Clipart                   (4) | Train Loss: 0.5889 | Train Acc: 0.8095
 Site-Clipart                   (0) | Train Loss: 0.3044 | Train Acc: 0.9394
 Site-Clipart                   (0) | Train Loss: 0.5054 | Train Acc: 0.8519
 Site-Clipart                   (4) | Train Loss: 0.4627 | Train Acc: 0.8488
 Site-Clipart                   (4) | Train Loss: 0.3558 | Train Acc: 0.9493
 Site-Clipart                   (4) | Train Loss: 0.4579 | Train Acc: 0.8694
 Site-Clipart                   (4) | Train Loss: 0.3659 | Train Acc: 0.8873
 Site-Painting                  (5) | Train Loss: 0.4170 | Train Acc: 0.8525
 Site-Painting                  (5) | Train Loss: 0.3211 | Train Acc: 0.8878
 Site-Painting                  (5) | Train Loss: 0.3601 | Train Acc: 0.9108
 Site-Painting                  (5) | Train Loss: 0.3356 | Train Acc: 0.9246
 Site-Sketch                    (4) | Train Loss: 0.3469 | Train Acc: 0.8971
 Site-Sketch                    (4) | Train Loss: 0.4718 | Train Acc: 0.8545
 Site-Sketch                    (4) | Train Loss: 0.5227 | Train Acc: 0.8125
 Site-Infograph                 (3) | Train Loss: 1.1829 | Train Acc: 0.6118
 Site-Infograph                 (3) | Train Loss: 1.0033 | Train Acc: 0.7059
 Site-QuickDraw                 (1) | Train Loss: 0.8759 | Train Acc: 0.7391
Average Train Accuracy: 0.8755
 Site-Real                      (2) | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0693 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0830 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.2343 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.3122 | Val  Acc: 0.9143
 Site-Real                      (2) | Val  Loss: 0.1654 | Val  Acc: 0.9821
 Site-Real                      (2) | Val  Loss: 0.2033 | Val  Acc: 0.9551
 Site-Real                      (5) | Val  Loss: 0.2995 | Val  Acc: 0.9161
 Site-Real                      (2) | Val  Loss: 0.2138 | Val  Acc: 0.9432
 Site-Real                      (2) | Val  Loss: 0.2240 | Val  Acc: 0.9373
 Site-Clipart                   (4) | Val  Loss: 0.2550 | Val  Acc: 0.9286
 Site-Clipart                   (0) | Val  Loss: 0.2700 | Val  Acc: 0.8636
 Site-Clipart                   (0) | Val  Loss: 0.5412 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 0.4912 | Val  Acc: 0.8246
 Site-Clipart                   (4) | Val  Loss: 0.4128 | Val  Acc: 0.9022
 Site-Clipart                   (4) | Val  Loss: 0.3350 | Val  Acc: 0.9122
 Site-Clipart                   (4) | Val  Loss: 0.3981 | Val  Acc: 0.8898
 Site-Painting                  (5) | Val  Loss: 0.4550 | Val  Acc: 0.9024
 Site-Painting                  (5) | Val  Loss: 0.5283 | Val  Acc: 0.9077
 Site-Painting                  (5) | Val  Loss: 0.3228 | Val  Acc: 0.8952
 Site-Painting                  (5) | Val  Loss: 0.2920 | Val  Acc: 0.8988
 Site-Sketch                    (4) | Val  Loss: 0.6507 | Val  Acc: 0.7333
 Site-Sketch                    (4) | Val  Loss: 0.6146 | Val  Acc: 0.8082
 Site-Sketch                    (4) | Val  Loss: 0.5355 | Val  Acc: 0.8034
 Site-Infograph                 (3) | Val  Loss: 0.9818 | Val  Acc: 0.6607
 Site-Infograph                 (3) | Val  Loss: 1.0597 | Val  Acc: 0.6484
 Site-QuickDraw                 (1) | Val  Loss: 1.2405 | Val  Acc: 0.5870
Average Valid Accuracy: 0.8723
 Test site-Real                      (2)| Epoch:39 | Test Acc: 0.9507
 Test site-Clipart                   (4)| Epoch:39 | Test Acc: 0.8669
 Test site-Painting                  (5)| Epoch:39 | Test Acc: 0.9305
 Test site-Sketch                    (4)| Epoch:39 | Test Acc: 0.8718
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5495
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.6560
Real: 0.9507, Clipart: 0.8669, Painting: 0.9305, Sketch: 0.8718, Infograph: 0.5495, QuickDraw: 0.6560, 
Average Test Accuracy(group): 0.8042, Average Test Accuracy(individual): 0.8766,
domain std=0.1488, cluster std=0.1491, individual std=0.1105, 
Average Test Accuracy: 0.8042
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 42 ============
cnt=[4, 1, 3, 9, 9, 1, ]
cnt=[1, 10, 1, 9, 4, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Real                      (4) | Train Loss: 0.6686 | Train Acc: 0.7500
 Site-Real                      (5) | Train Loss: 0.3741 | Train Acc: 0.8333
 Site-Real                      (4) | Train Loss: 0.0704 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.3069 | Train Acc: 0.9062
 Site-Real                      (4) | Train Loss: 0.2180 | Train Acc: 0.9423
 Site-Real                      (4) | Train Loss: 0.1128 | Train Acc: 0.9881
 Site-Real                      (4) | Train Loss: 0.3797 | Train Acc: 0.9701
 Site-Real                      (4) | Train Loss: 0.2017 | Train Acc: 0.9442
 Site-Real                      (4) | Train Loss: 0.2293 | Train Acc: 0.9362
 Site-Real                      (4) | Train Loss: 0.1926 | Train Acc: 0.9583
 Site-Clipart                   (3) | Train Loss: 0.5464 | Train Acc: 0.8095
 Site-Clipart                   (2) | Train Loss: 0.3747 | Train Acc: 0.8788
 Site-Clipart                   (2) | Train Loss: 0.5146 | Train Acc: 0.8519
 Site-Clipart                   (3) | Train Loss: 0.3542 | Train Acc: 0.8721
 Site-Clipart                   (3) | Train Loss: 0.3898 | Train Acc: 0.9348
 Site-Clipart                   (3) | Train Loss: 0.4386 | Train Acc: 0.8694
 Site-Clipart                   (3) | Train Loss: 0.3243 | Train Acc: 0.9070
 Site-Painting                  (0) | Train Loss: 0.3874 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.3506 | Train Acc: 0.9184
 Site-Painting                  (0) | Train Loss: 0.2745 | Train Acc: 0.9299
 Site-Painting                  (0) | Train Loss: 0.3295 | Train Acc: 0.9286
 Site-Sketch                    (3) | Train Loss: 0.7111 | Train Acc: 0.8676
 Site-Sketch                    (2) | Train Loss: 0.4171 | Train Acc: 0.8545
 Site-Sketch                    (3) | Train Loss: 0.5097 | Train Acc: 0.8466
 Site-Infograph                 (3) | Train Loss: 1.0872 | Train Acc: 0.5647
 Site-Infograph                 (3) | Train Loss: 1.0203 | Train Acc: 0.6691
 Site-QuickDraw                 (1) | Train Loss: 0.8497 | Train Acc: 0.7536
Average Train Accuracy: 0.8724
 Site-Real                      (4) | Val  Loss: 0.0201 | Val  Acc: 1.0000
 Site-Real                      (5) | Val  Loss: 0.0491 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0663 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.1968 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2882 | Val  Acc: 0.9429
 Site-Real                      (4) | Val  Loss: 0.1840 | Val  Acc: 0.9464
 Site-Real                      (4) | Val  Loss: 0.1711 | Val  Acc: 0.9438
 Site-Real                      (4) | Val  Loss: 0.2352 | Val  Acc: 0.9301
 Site-Real                      (4) | Val  Loss: 0.2028 | Val  Acc: 0.9563
 Site-Real                      (4) | Val  Loss: 0.2061 | Val  Acc: 0.9455
 Site-Clipart                   (3) | Val  Loss: 0.4310 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.3067 | Val  Acc: 0.8636
 Site-Clipart                   (2) | Val  Loss: 0.4929 | Val  Acc: 0.8611
 Site-Clipart                   (3) | Val  Loss: 0.4576 | Val  Acc: 0.8421
 Site-Clipart                   (3) | Val  Loss: 0.4169 | Val  Acc: 0.8804
 Site-Clipart                   (3) | Val  Loss: 0.2986 | Val  Acc: 0.9189
 Site-Clipart                   (3) | Val  Loss: 0.3873 | Val  Acc: 0.8898
 Site-Painting                  (0) | Val  Loss: 0.4603 | Val  Acc: 0.9024
 Site-Painting                  (0) | Val  Loss: 0.3019 | Val  Acc: 0.8923
 Site-Painting                  (0) | Val  Loss: 0.3184 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.2680 | Val  Acc: 0.9464
 Site-Sketch                    (3) | Val  Loss: 0.7263 | Val  Acc: 0.7556
 Site-Sketch                    (2) | Val  Loss: 0.8598 | Val  Acc: 0.7945
 Site-Sketch                    (3) | Val  Loss: 0.5068 | Val  Acc: 0.8120
 Site-Infograph                 (3) | Val  Loss: 0.9054 | Val  Acc: 0.6964
 Site-Infograph                 (3) | Val  Loss: 1.0269 | Val  Acc: 0.6484
 Site-QuickDraw                 (1) | Val  Loss: 1.2194 | Val  Acc: 0.6196
Average Valid Accuracy: 0.8789
 Test site-Real                      (4)| Epoch:41 | Test Acc: 0.9556
 Test site-Clipart                   (3)| Epoch:41 | Test Acc: 0.8745
 Test site-Painting                  (0)| Epoch:41 | Test Acc: 0.9305
 Test site-Sketch                    (3)| Epoch:41 | Test Acc: 0.8755
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5525
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.6590
Real: 0.9556, Clipart: 0.8745, Painting: 0.9305, Sketch: 0.8755, Infograph: 0.5525, QuickDraw: 0.6590, 
Average Test Accuracy(group): 0.8079, Average Test Accuracy(individual): 0.8811,
domain std=0.1490, cluster std=0.1057, individual std=0.1107, 
Average Test Accuracy: 0.8079
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 1, 8, 9, 5, 2, ]
cnt=[2, 7, 10, 1, 4, 3, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Real                      (3) | Train Loss: 0.6319 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.3133 | Train Acc: 0.8333
 Site-Real                      (4) | Train Loss: 0.0584 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.2767 | Train Acc: 0.9062
 Site-Real                      (3) | Train Loss: 0.2396 | Train Acc: 0.9423
 Site-Real                      (3) | Train Loss: 0.0994 | Train Acc: 0.9881
 Site-Real                      (3) | Train Loss: 0.1724 | Train Acc: 0.9701
 Site-Real                      (3) | Train Loss: 0.1987 | Train Acc: 0.9535
 Site-Real                      (3) | Train Loss: 0.1930 | Train Acc: 0.9565
 Site-Real                      (3) | Train Loss: 0.1859 | Train Acc: 0.9493
 Site-Clipart                   (2) | Train Loss: 0.4693 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.2552 | Train Acc: 0.9697
 Site-Clipart                   (5) | Train Loss: 0.4714 | Train Acc: 0.8519
 Site-Clipart                   (2) | Train Loss: 0.3413 | Train Acc: 0.8953
 Site-Clipart                   (2) | Train Loss: 0.3124 | Train Acc: 0.9348
 Site-Clipart                   (2) | Train Loss: 0.4039 | Train Acc: 0.8964
 Site-Clipart                   (2) | Train Loss: 0.3373 | Train Acc: 0.9239
 Site-Painting                  (4) | Train Loss: 0.3907 | Train Acc: 0.9016
 Site-Painting                  (4) | Train Loss: 0.3600 | Train Acc: 0.9184
 Site-Painting                  (4) | Train Loss: 0.3718 | Train Acc: 0.8917
 Site-Painting                  (4) | Train Loss: 0.3158 | Train Acc: 0.9246
 Site-Sketch                    (2) | Train Loss: 0.5982 | Train Acc: 0.8676
 Site-Sketch                    (2) | Train Loss: 0.4323 | Train Acc: 0.8727
 Site-Sketch                    (2) | Train Loss: 0.4967 | Train Acc: 0.8295
 Site-Infograph                 (0) | Train Loss: 1.2886 | Train Acc: 0.5176
 Site-Infograph                 (0) | Train Loss: 0.9470 | Train Acc: 0.6618
 Site-QuickDraw                 (1) | Train Loss: 0.9326 | Train Acc: 0.7681
Average Train Accuracy: 0.8790
 Site-Real                      (3) | Val  Loss: 0.0158 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0759 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0592 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.1698 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2730 | Val  Acc: 0.9714
 Site-Real                      (3) | Val  Loss: 0.1479 | Val  Acc: 0.9643
 Site-Real                      (3) | Val  Loss: 0.1726 | Val  Acc: 0.9326
 Site-Real                      (3) | Val  Loss: 0.2809 | Val  Acc: 0.9371
 Site-Real                      (3) | Val  Loss: 0.1916 | Val  Acc: 0.9563
 Site-Real                      (3) | Val  Loss: 0.1967 | Val  Acc: 0.9537
 Site-Clipart                   (2) | Val  Loss: 0.3881 | Val  Acc: 0.7857
 Site-Clipart                   (5) | Val  Loss: 0.2808 | Val  Acc: 0.8636
 Site-Clipart                   (5) | Val  Loss: 0.5365 | Val  Acc: 0.8333
 Site-Clipart                   (2) | Val  Loss: 0.4701 | Val  Acc: 0.8070
 Site-Clipart                   (2) | Val  Loss: 0.4122 | Val  Acc: 0.8913
 Site-Clipart                   (2) | Val  Loss: 0.2947 | Val  Acc: 0.9054
 Site-Clipart                   (2) | Val  Loss: 0.3683 | Val  Acc: 0.9110
 Site-Painting                  (4) | Val  Loss: 0.5044 | Val  Acc: 0.9024
 Site-Painting                  (4) | Val  Loss: 0.3966 | Val  Acc: 0.9077
 Site-Painting                  (4) | Val  Loss: 0.2967 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2712 | Val  Acc: 0.9345
 Site-Sketch                    (2) | Val  Loss: 0.5763 | Val  Acc: 0.8444
 Site-Sketch                    (2) | Val  Loss: 0.6485 | Val  Acc: 0.7808
 Site-Sketch                    (2) | Val  Loss: 0.5254 | Val  Acc: 0.8376
 Site-Infograph                 (0) | Val  Loss: 1.0208 | Val  Acc: 0.6786
 Site-Infograph                 (0) | Val  Loss: 1.1070 | Val  Acc: 0.6484
 Site-QuickDraw                 (1) | Val  Loss: 1.2050 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8812
 Test site-Real                      (3)| Epoch:42 | Test Acc: 0.9532
 Test site-Clipart                   (2)| Epoch:42 | Test Acc: 0.8688
 Test site-Painting                  (4)| Epoch:42 | Test Acc: 0.9305
 Test site-Sketch                    (2)| Epoch:42 | Test Acc: 0.8773
 Test site-Infograph                 (0)| Epoch:42 | Test Acc: 0.5571
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.6630
Real: 0.9532, Clipart: 0.8688, Painting: 0.9305, Sketch: 0.8773, Infograph: 0.5571, QuickDraw: 0.6630, 
Average Test Accuracy(group): 0.8083, Average Test Accuracy(individual): 0.8794,
domain std=0.1464, cluster std=0.1466, individual std=0.1089, 
Average Test Accuracy: 0.8083
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 44 ============
cnt=[3, 9, 1, 2, 5, 7, ]
cnt=[1, 3, 13, 1, 7, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Real                      (1) | Train Loss: 0.5849 | Train Acc: 0.7500
 Site-Real                      (1) | Train Loss: 0.3633 | Train Acc: 0.8333
 Site-Real                      (1) | Train Loss: 0.0616 | Train Acc: 1.0000
 Site-Real                      (1) | Train Loss: 0.2811 | Train Acc: 0.9375
 Site-Real                      (4) | Train Loss: 0.2621 | Train Acc: 0.9231
 Site-Real                      (1) | Train Loss: 0.1528 | Train Acc: 0.9881
 Site-Real                      (1) | Train Loss: 0.1640 | Train Acc: 0.9627
 Site-Real                      (1) | Train Loss: 0.1786 | Train Acc: 0.9488
 Site-Real                      (1) | Train Loss: 0.1864 | Train Acc: 0.9507
 Site-Real                      (1) | Train Loss: 0.1808 | Train Acc: 0.9692
 Site-Clipart                   (5) | Train Loss: 0.5218 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.3131 | Train Acc: 0.9394
 Site-Clipart                   (5) | Train Loss: 0.5130 | Train Acc: 0.8148
 Site-Clipart                   (5) | Train Loss: 0.4412 | Train Acc: 0.8721
 Site-Clipart                   (5) | Train Loss: 0.3935 | Train Acc: 0.9203
 Site-Clipart                   (5) | Train Loss: 0.4158 | Train Acc: 0.8919
 Site-Clipart                   (5) | Train Loss: 0.3534 | Train Acc: 0.9127
 Site-Painting                  (4) | Train Loss: 0.3651 | Train Acc: 0.8689
 Site-Painting                  (4) | Train Loss: 0.3225 | Train Acc: 0.9184
 Site-Painting                  (4) | Train Loss: 0.3558 | Train Acc: 0.9236
 Site-Painting                  (4) | Train Loss: 0.2967 | Train Acc: 0.9246
 Site-Sketch                    (0) | Train Loss: 0.1919 | Train Acc: 0.9412
 Site-Sketch                    (0) | Train Loss: 0.4694 | Train Acc: 0.8364
 Site-Sketch                    (0) | Train Loss: 0.5356 | Train Acc: 0.8182
 Site-Infograph                 (3) | Train Loss: 1.2831 | Train Acc: 0.5529
 Site-Infograph                 (3) | Train Loss: 0.9396 | Train Acc: 0.7059
 Site-QuickDraw                 (2) | Train Loss: 0.8007 | Train Acc: 0.7899
Average Train Accuracy: 0.8797
 Site-Real                      (1) | Val  Loss: 0.0190 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.0518 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.0463 | Val  Acc: 1.0000
 Site-Real                      (1) | Val  Loss: 0.1896 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2644 | Val  Acc: 0.9429
 Site-Real                      (1) | Val  Loss: 0.1601 | Val  Acc: 0.9464
 Site-Real                      (1) | Val  Loss: 0.1763 | Val  Acc: 0.9326
 Site-Real                      (1) | Val  Loss: 0.2759 | Val  Acc: 0.9441
 Site-Real                      (1) | Val  Loss: 0.2104 | Val  Acc: 0.9563
 Site-Real                      (1) | Val  Loss: 0.2011 | Val  Acc: 0.9455
 Site-Clipart                   (5) | Val  Loss: 0.3964 | Val  Acc: 0.8571
 Site-Clipart                   (5) | Val  Loss: 0.3244 | Val  Acc: 0.9091
 Site-Clipart                   (5) | Val  Loss: 0.5158 | Val  Acc: 0.8333
 Site-Clipart                   (5) | Val  Loss: 0.5127 | Val  Acc: 0.8596
 Site-Clipart                   (5) | Val  Loss: 0.4056 | Val  Acc: 0.8913
 Site-Clipart                   (5) | Val  Loss: 0.3201 | Val  Acc: 0.8986
 Site-Clipart                   (5) | Val  Loss: 0.3809 | Val  Acc: 0.8941
 Site-Painting                  (4) | Val  Loss: 0.4490 | Val  Acc: 0.9268
 Site-Painting                  (4) | Val  Loss: 0.4963 | Val  Acc: 0.8769
 Site-Painting                  (4) | Val  Loss: 0.2919 | Val  Acc: 0.9238
 Site-Painting                  (4) | Val  Loss: 0.2794 | Val  Acc: 0.9226
 Site-Sketch                    (0) | Val  Loss: 0.6196 | Val  Acc: 0.8000
 Site-Sketch                    (0) | Val  Loss: 0.7118 | Val  Acc: 0.8219
 Site-Sketch                    (0) | Val  Loss: 0.4750 | Val  Acc: 0.8632
 Site-Infograph                 (3) | Val  Loss: 1.0033 | Val  Acc: 0.6607
 Site-Infograph                 (3) | Val  Loss: 1.0315 | Val  Acc: 0.6703
 Site-QuickDraw                 (2) | Val  Loss: 1.1737 | Val  Acc: 0.6848
Average Valid Accuracy: 0.8857
 Test site-Real                      (1)| Epoch:43 | Test Acc: 0.9548
 Test site-Clipart                   (5)| Epoch:43 | Test Acc: 0.8688
 Test site-Painting                  (4)| Epoch:43 | Test Acc: 0.9273
 Test site-Sketch                    (0)| Epoch:43 | Test Acc: 0.8773
 Test site-Infograph                 (3)| Epoch:43 | Test Acc: 0.5616
 Test site-QuickDraw                 (2)| Epoch:43 | Test Acc: 0.6680
Real: 0.9548, Clipart: 0.8688, Painting: 0.9273, Sketch: 0.8773, Infograph: 0.5616, QuickDraw: 0.6680, 
Average Test Accuracy(group): 0.8096, Average Test Accuracy(individual): 0.8801,
domain std=0.1441, cluster std=0.1448, individual std=0.1077, 
Average Test Accuracy: 0.8096
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 45 ============
cnt=[9, 1, 7, 5, 2, 3, ]
cnt=[10, 7, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Real                      (3) | Train Loss: 0.5775 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.3642 | Train Acc: 0.8333
 Site-Real                      (0) | Train Loss: 0.0589 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.2393 | Train Acc: 0.9375
 Site-Real                      (0) | Train Loss: 0.2229 | Train Acc: 0.9423
 Site-Real                      (0) | Train Loss: 0.1144 | Train Acc: 0.9881
 Site-Real                      (3) | Train Loss: 0.1643 | Train Acc: 0.9478
 Site-Real                      (0) | Train Loss: 0.1656 | Train Acc: 0.9488
 Site-Real                      (3) | Train Loss: 0.2045 | Train Acc: 0.9507
 Site-Real                      (3) | Train Loss: 0.1820 | Train Acc: 0.9638
 Site-Clipart                   (2) | Train Loss: 0.4166 | Train Acc: 0.8571
 Site-Clipart                   (2) | Train Loss: 0.2983 | Train Acc: 0.9394
 Site-Clipart                   (2) | Train Loss: 0.4600 | Train Acc: 0.8519
 Site-Clipart                   (2) | Train Loss: 0.4273 | Train Acc: 0.8837
 Site-Clipart                   (2) | Train Loss: 0.2809 | Train Acc: 0.9275
 Site-Clipart                   (2) | Train Loss: 0.4023 | Train Acc: 0.8649
 Site-Clipart                   (2) | Train Loss: 0.3142 | Train Acc: 0.9268
 Site-Painting                  (0) | Train Loss: 0.3744 | Train Acc: 0.8525
 Site-Painting                  (0) | Train Loss: 0.3631 | Train Acc: 0.8980
 Site-Painting                  (0) | Train Loss: 0.2914 | Train Acc: 0.9108
 Site-Painting                  (0) | Train Loss: 0.3280 | Train Acc: 0.9246
 Site-Sketch                    (5) | Train Loss: 0.2579 | Train Acc: 0.9265
 Site-Sketch                    (5) | Train Loss: 0.4751 | Train Acc: 0.8364
 Site-Sketch                    (5) | Train Loss: 0.5688 | Train Acc: 0.8239
 Site-Infograph                 (4) | Train Loss: 1.2780 | Train Acc: 0.5294
 Site-Infograph                 (4) | Train Loss: 0.9536 | Train Acc: 0.6838
 Site-QuickDraw                 (1) | Train Loss: 0.9037 | Train Acc: 0.7754
Average Train Accuracy: 0.8768
 Site-Real                      (3) | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0585 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.0554 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.2096 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2897 | Val  Acc: 0.8857
 Site-Real                      (0) | Val  Loss: 0.1441 | Val  Acc: 0.9643
 Site-Real                      (3) | Val  Loss: 0.1443 | Val  Acc: 0.9775
 Site-Real                      (0) | Val  Loss: 0.2995 | Val  Acc: 0.9301
 Site-Real                      (3) | Val  Loss: 0.2011 | Val  Acc: 0.9520
 Site-Real                      (3) | Val  Loss: 0.2190 | Val  Acc: 0.9373
 Site-Clipart                   (2) | Val  Loss: 0.3584 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.3499 | Val  Acc: 0.8636
 Site-Clipart                   (2) | Val  Loss: 0.4524 | Val  Acc: 0.8889
 Site-Clipart                   (2) | Val  Loss: 0.4807 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.3908 | Val  Acc: 0.8804
 Site-Clipart                   (2) | Val  Loss: 0.3367 | Val  Acc: 0.8986
 Site-Clipart                   (2) | Val  Loss: 0.4329 | Val  Acc: 0.8814
 Site-Painting                  (0) | Val  Loss: 0.4884 | Val  Acc: 0.8537
 Site-Painting                  (0) | Val  Loss: 0.2570 | Val  Acc: 0.9231
 Site-Painting                  (0) | Val  Loss: 0.2790 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.2707 | Val  Acc: 0.9107
 Site-Sketch                    (5) | Val  Loss: 0.4969 | Val  Acc: 0.8000
 Site-Sketch                    (5) | Val  Loss: 0.4914 | Val  Acc: 0.8219
 Site-Sketch                    (5) | Val  Loss: 0.5263 | Val  Acc: 0.8291
 Site-Infograph                 (4) | Val  Loss: 0.9594 | Val  Acc: 0.6786
 Site-Infograph                 (4) | Val  Loss: 0.9617 | Val  Acc: 0.6484
 Site-QuickDraw                 (1) | Val  Loss: 1.2929 | Val  Acc: 0.5870
Average Valid Accuracy: 0.8800
 Test site-Real                      (3)| Epoch:44 | Test Acc: 0.9532
 Test site-Clipart                   (2)| Epoch:44 | Test Acc: 0.8707
 Test site-Painting                  (0)| Epoch:44 | Test Acc: 0.9273
 Test site-Sketch                    (5)| Epoch:44 | Test Acc: 0.8736
 Test site-Infograph                 (4)| Epoch:44 | Test Acc: 0.5723
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.6650
Real: 0.9532, Clipart: 0.8707, Painting: 0.9273, Sketch: 0.8736, Infograph: 0.5723, QuickDraw: 0.6650, 
Average Test Accuracy(group): 0.8104, Average Test Accuracy(individual): 0.8802,
domain std=0.1411, cluster std=0.1432, individual std=0.1052, 
Average Test Accuracy: 0.8104
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 46 ============
cnt=[4, 1, 9, 10, 2, 1, ]
cnt=[13, 7, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Real                      (3) | Train Loss: 0.6164 | Train Acc: 0.7500
 Site-Real                      (3) | Train Loss: 0.3576 | Train Acc: 0.9167
 Site-Real                      (3) | Train Loss: 0.1176 | Train Acc: 0.9500
 Site-Real                      (3) | Train Loss: 0.2987 | Train Acc: 0.9375
 Site-Real                      (3) | Train Loss: 0.2348 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.0849 | Train Acc: 0.9881
 Site-Real                      (3) | Train Loss: 0.1982 | Train Acc: 0.9552
 Site-Real                      (3) | Train Loss: 0.1938 | Train Acc: 0.9488
 Site-Real                      (3) | Train Loss: 0.2363 | Train Acc: 0.9507
 Site-Real                      (3) | Train Loss: 0.1840 | Train Acc: 0.9547
 Site-Clipart                   (2) | Train Loss: 0.4234 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.2930 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.4259 | Train Acc: 0.8519
 Site-Clipart                   (2) | Train Loss: 0.4246 | Train Acc: 0.8372
 Site-Clipart                   (2) | Train Loss: 0.2490 | Train Acc: 0.9275
 Site-Clipart                   (2) | Train Loss: 0.4197 | Train Acc: 0.8604
 Site-Clipart                   (2) | Train Loss: 0.3215 | Train Acc: 0.9324
 Site-Painting                  (0) | Train Loss: 0.3687 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.3861 | Train Acc: 0.8980
 Site-Painting                  (0) | Train Loss: 0.3217 | Train Acc: 0.9172
 Site-Painting                  (0) | Train Loss: 0.3186 | Train Acc: 0.9167
 Site-Sketch                    (2) | Train Loss: 0.6026 | Train Acc: 0.8971
 Site-Sketch                    (2) | Train Loss: 0.4629 | Train Acc: 0.8818
 Site-Sketch                    (2) | Train Loss: 0.4953 | Train Acc: 0.8466
 Site-Infograph                 (4) | Train Loss: 1.1528 | Train Acc: 0.6000
 Site-Infograph                 (4) | Train Loss: 0.9649 | Train Acc: 0.7206
 Site-QuickDraw                 (1) | Train Loss: 0.8572 | Train Acc: 0.7536
Average Train Accuracy: 0.8797
 Site-Real                      (3) | Val  Loss: 0.0367 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0519 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.0686 | Val  Acc: 1.0000
 Site-Real                      (3) | Val  Loss: 0.2074 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2885 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.1908 | Val  Acc: 0.9643
 Site-Real                      (3) | Val  Loss: 0.1841 | Val  Acc: 0.9438
 Site-Real                      (3) | Val  Loss: 0.2502 | Val  Acc: 0.9301
 Site-Real                      (3) | Val  Loss: 0.2025 | Val  Acc: 0.9476
 Site-Real                      (3) | Val  Loss: 0.2046 | Val  Acc: 0.9428
 Site-Clipart                   (2) | Val  Loss: 0.4790 | Val  Acc: 0.7857
 Site-Clipart                   (5) | Val  Loss: 0.2976 | Val  Acc: 0.9091
 Site-Clipart                   (2) | Val  Loss: 0.5372 | Val  Acc: 0.8611
 Site-Clipart                   (2) | Val  Loss: 0.5042 | Val  Acc: 0.8246
 Site-Clipart                   (2) | Val  Loss: 0.4208 | Val  Acc: 0.8587
 Site-Clipart                   (2) | Val  Loss: 0.3112 | Val  Acc: 0.9324
 Site-Clipart                   (2) | Val  Loss: 0.4173 | Val  Acc: 0.8941
 Site-Painting                  (0) | Val  Loss: 0.4147 | Val  Acc: 0.8780
 Site-Painting                  (0) | Val  Loss: 0.3403 | Val  Acc: 0.8923
 Site-Painting                  (0) | Val  Loss: 0.2484 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3002 | Val  Acc: 0.8929
 Site-Sketch                    (2) | Val  Loss: 0.5667 | Val  Acc: 0.8000
 Site-Sketch                    (2) | Val  Loss: 0.5141 | Val  Acc: 0.8219
 Site-Sketch                    (2) | Val  Loss: 0.4975 | Val  Acc: 0.8376
 Site-Infograph                 (4) | Val  Loss: 0.9205 | Val  Acc: 0.6429
 Site-Infograph                 (4) | Val  Loss: 1.0080 | Val  Acc: 0.6264
 Site-QuickDraw                 (1) | Val  Loss: 1.1940 | Val  Acc: 0.6304
Average Valid Accuracy: 0.8754
 Test site-Real                      (3)| Epoch:45 | Test Acc: 0.9540
 Test site-Clipart                   (2)| Epoch:45 | Test Acc: 0.8650
 Test site-Painting                  (0)| Epoch:45 | Test Acc: 0.9321
 Test site-Sketch                    (2)| Epoch:45 | Test Acc: 0.8718
 Test site-Infograph                 (4)| Epoch:45 | Test Acc: 0.5753
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.6540
Real: 0.9540, Clipart: 0.8650, Painting: 0.9321, Sketch: 0.8718, Infograph: 0.5753, QuickDraw: 0.6540, 
Average Test Accuracy(group): 0.8087, Average Test Accuracy(individual): 0.8794,
domain std=0.1425, cluster std=0.1422, individual std=0.1061, 
Average Test Accuracy: 0.8087
============ Train epoch 47 ============
cnt=[3, 1, 13, 2, 1, 7, ]
cnt=[1, 1, 13, 9, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Real                      (4) | Train Loss: 0.6398 | Train Acc: 0.7500
 Site-Real                      (2) | Train Loss: 0.3172 | Train Acc: 0.9167
 Site-Real                      (2) | Train Loss: 0.0807 | Train Acc: 1.0000
 Site-Real                      (2) | Train Loss: 0.2678 | Train Acc: 0.9375
 Site-Real                      (2) | Train Loss: 0.2630 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.1741 | Train Acc: 0.9881
 Site-Real                      (2) | Train Loss: 0.1271 | Train Acc: 0.9701
 Site-Real                      (2) | Train Loss: 0.2133 | Train Acc: 0.9581
 Site-Real                      (2) | Train Loss: 0.2373 | Train Acc: 0.9362
 Site-Real                      (2) | Train Loss: 0.1923 | Train Acc: 0.9529
 Site-Clipart                   (5) | Train Loss: 0.3933 | Train Acc: 0.9048
 Site-Clipart                   (5) | Train Loss: 0.3022 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.4427 | Train Acc: 0.8889
 Site-Clipart                   (5) | Train Loss: 0.5050 | Train Acc: 0.8605
 Site-Clipart                   (5) | Train Loss: 0.3044 | Train Acc: 0.9275
 Site-Clipart                   (5) | Train Loss: 0.4243 | Train Acc: 0.8919
 Site-Clipart                   (5) | Train Loss: 0.3025 | Train Acc: 0.9239
 Site-Painting                  (2) | Train Loss: 0.4213 | Train Acc: 0.8689
 Site-Painting                  (2) | Train Loss: 0.3010 | Train Acc: 0.9082
 Site-Painting                  (2) | Train Loss: 0.3261 | Train Acc: 0.9236
 Site-Painting                  (2) | Train Loss: 0.3163 | Train Acc: 0.9286
 Site-Sketch                    (0) | Train Loss: 0.3578 | Train Acc: 0.8382
 Site-Sketch                    (0) | Train Loss: 0.4465 | Train Acc: 0.8727
 Site-Sketch                    (0) | Train Loss: 0.5556 | Train Acc: 0.8239
 Site-Infograph                 (3) | Train Loss: 1.2449 | Train Acc: 0.5412
 Site-Infograph                 (3) | Train Loss: 0.9273 | Train Acc: 0.6838
 Site-QuickDraw                 (1) | Train Loss: 0.7221 | Train Acc: 0.7681
Average Train Accuracy: 0.8813
 Site-Real                      (4) | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0555 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.0589 | Val  Acc: 1.0000
 Site-Real                      (2) | Val  Loss: 0.1905 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.3192 | Val  Acc: 0.8857
 Site-Real                      (2) | Val  Loss: 0.1745 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.1660 | Val  Acc: 0.9551
 Site-Real                      (2) | Val  Loss: 0.2611 | Val  Acc: 0.9650
 Site-Real                      (2) | Val  Loss: 0.2107 | Val  Acc: 0.9563
 Site-Real                      (2) | Val  Loss: 0.1911 | Val  Acc: 0.9373
 Site-Clipart                   (5) | Val  Loss: 0.3491 | Val  Acc: 0.7857
 Site-Clipart                   (5) | Val  Loss: 0.4447 | Val  Acc: 0.8636
 Site-Clipart                   (5) | Val  Loss: 0.4608 | Val  Acc: 0.8333
 Site-Clipart                   (5) | Val  Loss: 0.4610 | Val  Acc: 0.8421
 Site-Clipart                   (5) | Val  Loss: 0.4124 | Val  Acc: 0.8804
 Site-Clipart                   (5) | Val  Loss: 0.3423 | Val  Acc: 0.9189
 Site-Clipart                   (5) | Val  Loss: 0.4008 | Val  Acc: 0.8814
 Site-Painting                  (2) | Val  Loss: 0.4310 | Val  Acc: 0.9024
 Site-Painting                  (2) | Val  Loss: 0.5954 | Val  Acc: 0.9231
 Site-Painting                  (2) | Val  Loss: 0.2632 | Val  Acc: 0.9619
 Site-Painting                  (2) | Val  Loss: 0.2786 | Val  Acc: 0.9226
 Site-Sketch                    (0) | Val  Loss: 0.5565 | Val  Acc: 0.8000
 Site-Sketch                    (0) | Val  Loss: 0.6707 | Val  Acc: 0.7808
 Site-Sketch                    (0) | Val  Loss: 0.4462 | Val  Acc: 0.8462
 Site-Infograph                 (3) | Val  Loss: 0.9282 | Val  Acc: 0.6786
 Site-Infograph                 (3) | Val  Loss: 1.0187 | Val  Acc: 0.6923
 Site-QuickDraw                 (1) | Val  Loss: 1.1963 | Val  Acc: 0.6304
Average Valid Accuracy: 0.8800
 Test site-Real                      (4)| Epoch:45 | Test Acc: 0.9523
 Test site-Clipart                   (5)| Epoch:45 | Test Acc: 0.8669
 Test site-Painting                  (2)| Epoch:45 | Test Acc: 0.9305
 Test site-Sketch                    (0)| Epoch:45 | Test Acc: 0.8791
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5784
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.6600
Real: 0.9523, Clipart: 0.8669, Painting: 0.9305, Sketch: 0.8791, Infograph: 0.5784, QuickDraw: 0.6600, 
Average Test Accuracy(group): 0.8112, Average Test Accuracy(individual): 0.8803,
domain std=0.1408, cluster std=0.1430, individual std=0.1044, 
Average Test Accuracy: 0.8112
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon/ccop_q=1...
============ Train epoch 48 ============
cnt=[9, 1, 3, 7, 2, 5, ]
cnt=[4, 1, 1, 10, 9, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Real                      (0) | Train Loss: 0.6499 | Train Acc: 0.7500
 Site-Real                      (0) | Train Loss: 0.3312 | Train Acc: 0.8333
 Site-Real                      (0) | Train Loss: 0.0984 | Train Acc: 0.9500
 Site-Real                      (0) | Train Loss: 0.3393 | Train Acc: 0.9062
 Site-Real                      (0) | Train Loss: 0.2697 | Train Acc: 0.9231
 Site-Real                      (0) | Train Loss: 0.0867 | Train Acc: 0.9881
 Site-Real                      (0) | Train Loss: 0.3455 | Train Acc: 0.9403
 Site-Real                      (0) | Train Loss: 0.1768 | Train Acc: 0.9349
 Site-Real                      (5) | Train Loss: 0.2062 | Train Acc: 0.9565
 Site-Real                      (0) | Train Loss: 0.1707 | Train Acc: 0.9656
 Site-Clipart                   (3) | Train Loss: 0.4104 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.2670 | Train Acc: 0.9394
 Site-Clipart                   (3) | Train Loss: 0.4435 | Train Acc: 0.8519
 Site-Clipart                   (3) | Train Loss: 0.4382 | Train Acc: 0.8488
 Site-Clipart                   (3) | Train Loss: 0.2791 | Train Acc: 0.9203
 Site-Clipart                   (3) | Train Loss: 0.4110 | Train Acc: 0.8784
 Site-Clipart                   (3) | Train Loss: 0.3243 | Train Acc: 0.9155
 Site-Painting                  (5) | Train Loss: 0.3805 | Train Acc: 0.8852
 Site-Painting                  (5) | Train Loss: 0.2674 | Train Acc: 0.9490
 Site-Painting                  (5) | Train Loss: 0.3214 | Train Acc: 0.8981
 Site-Painting                  (5) | Train Loss: 0.2920 | Train Acc: 0.9246
 Site-Sketch                    (2) | Train Loss: 0.3885 | Train Acc: 0.9265
 Site-Sketch                    (2) | Train Loss: 0.4663 | Train Acc: 0.8545
 Site-Sketch                    (2) | Train Loss: 0.4617 | Train Acc: 0.8580
 Site-Infograph                 (4) | Train Loss: 1.2028 | Train Acc: 0.6353
 Site-Infograph                 (4) | Train Loss: 1.0676 | Train Acc: 0.6765
 Site-QuickDraw                 (1) | Train Loss: 0.9180 | Train Acc: 0.7391
Average Train Accuracy: 0.8780
 Site-Real                      (0) | Val  Loss: 0.0210 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.0427 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.0633 | Val  Acc: 1.0000
 Site-Real                      (0) | Val  Loss: 0.1854 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2979 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.1453 | Val  Acc: 0.9821
 Site-Real                      (0) | Val  Loss: 0.1479 | Val  Acc: 0.9551
 Site-Real                      (0) | Val  Loss: 0.2426 | Val  Acc: 0.9510
 Site-Real                      (5) | Val  Loss: 0.1757 | Val  Acc: 0.9563
 Site-Real                      (0) | Val  Loss: 0.1970 | Val  Acc: 0.9401
 Site-Clipart                   (3) | Val  Loss: 0.4100 | Val  Acc: 0.7857
 Site-Clipart                   (3) | Val  Loss: 0.3157 | Val  Acc: 0.9091
 Site-Clipart                   (3) | Val  Loss: 0.5382 | Val  Acc: 0.8333
 Site-Clipart                   (3) | Val  Loss: 0.4835 | Val  Acc: 0.8070
 Site-Clipart                   (3) | Val  Loss: 0.3706 | Val  Acc: 0.9130
 Site-Clipart                   (3) | Val  Loss: 0.2978 | Val  Acc: 0.9054
 Site-Clipart                   (3) | Val  Loss: 0.3992 | Val  Acc: 0.8856
 Site-Painting                  (5) | Val  Loss: 0.4576 | Val  Acc: 0.8293
 Site-Painting                  (5) | Val  Loss: 0.2651 | Val  Acc: 0.9077
 Site-Painting                  (5) | Val  Loss: 0.3322 | Val  Acc: 0.9048
 Site-Painting                  (5) | Val  Loss: 0.2634 | Val  Acc: 0.9405
 Site-Sketch                    (2) | Val  Loss: 0.6185 | Val  Acc: 0.7333
 Site-Sketch                    (2) | Val  Loss: 0.6192 | Val  Acc: 0.7945
 Site-Sketch                    (2) | Val  Loss: 0.4737 | Val  Acc: 0.8376
 Site-Infograph                 (4) | Val  Loss: 0.9666 | Val  Acc: 0.6786
 Site-Infograph                 (4) | Val  Loss: 1.0121 | Val  Acc: 0.6484
 Site-QuickDraw                 (1) | Val  Loss: 1.1645 | Val  Acc: 0.6739
Average Valid Accuracy: 0.8766
 Test site-Real                      (0)| Epoch:47 | Test Acc: 0.9532
 Test site-Clipart                   (3)| Epoch:47 | Test Acc: 0.8669
 Test site-Painting                  (5)| Epoch:47 | Test Acc: 0.9273
 Test site-Sketch                    (2)| Epoch:47 | Test Acc: 0.8863
 Test site-Infograph                 (4)| Epoch:47 | Test Acc: 0.5632
 Test site-QuickDraw                 (1)| Epoch:47 | Test Acc: 0.6600
Real: 0.9532, Clipart: 0.8669, Painting: 0.9273, Sketch: 0.8863, Infograph: 0.5632, QuickDraw: 0.6600, 
Average Test Accuracy(group): 0.8095, Average Test Accuracy(individual): 0.8798,
domain std=0.1453, cluster std=0.1460, individual std=0.1077, 
Average Test Accuracy: 0.8095
============ Train epoch 49 ============
cnt=[7, 1, 5, 2, 9, 3, ]
cnt=[4, 1, 10, 2, 9, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Real                      (4) | Train Loss: 0.6844 | Train Acc: 0.7500
 Site-Real                      (4) | Train Loss: 0.3319 | Train Acc: 0.8333
 Site-Real                      (4) | Train Loss: 0.0612 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.2800 | Train Acc: 0.9062
 Site-Real                      (4) | Train Loss: 0.2577 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.0724 | Train Acc: 0.9881
 Site-Real                      (4) | Train Loss: 0.3506 | Train Acc: 0.9627
 Site-Real                      (4) | Train Loss: 0.2076 | Train Acc: 0.9442
 Site-Real                      (4) | Train Loss: 0.1964 | Train Acc: 0.9536
 Site-Real                      (4) | Train Loss: 0.1721 | Train Acc: 0.9620
 Site-Clipart                   (0) | Train Loss: 0.4848 | Train Acc: 0.8095
 Site-Clipart                   (0) | Train Loss: 0.2080 | Train Acc: 1.0000
 Site-Clipart                   (0) | Train Loss: 0.4393 | Train Acc: 0.8704
 Site-Clipart                   (0) | Train Loss: 0.4887 | Train Acc: 0.8721
 Site-Clipart                   (0) | Train Loss: 0.3167 | Train Acc: 0.8986
 Site-Clipart                   (0) | Train Loss: 0.3646 | Train Acc: 0.8919
 Site-Clipart                   (0) | Train Loss: 0.3248 | Train Acc: 0.9155
 Site-Painting                  (2) | Train Loss: 0.4020 | Train Acc: 0.8197
 Site-Painting                  (2) | Train Loss: 0.3556 | Train Acc: 0.9082
 Site-Painting                  (2) | Train Loss: 0.3496 | Train Acc: 0.8790
 Site-Painting                  (2) | Train Loss: 0.2954 | Train Acc: 0.9286
 Site-Sketch                    (5) | Train Loss: 0.2098 | Train Acc: 0.8971
 Site-Sketch                    (5) | Train Loss: 0.3912 | Train Acc: 0.8727
 Site-Sketch                    (5) | Train Loss: 0.5085 | Train Acc: 0.8352
 Site-Infograph                 (3) | Train Loss: 1.2720 | Train Acc: 0.6118
 Site-Infograph                 (3) | Train Loss: 0.9442 | Train Acc: 0.6985
 Site-QuickDraw                 (1) | Train Loss: 0.9082 | Train Acc: 0.7681
Average Train Accuracy: 0.8778
 Site-Real                      (4) | Val  Loss: 0.0205 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0456 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.0460 | Val  Acc: 1.0000
 Site-Real                      (4) | Val  Loss: 0.2064 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2507 | Val  Acc: 0.9429
 Site-Real                      (2) | Val  Loss: 0.1372 | Val  Acc: 0.9821
 Site-Real                      (4) | Val  Loss: 0.1687 | Val  Acc: 0.9438
 Site-Real                      (4) | Val  Loss: 0.2428 | Val  Acc: 0.9231
 Site-Real                      (4) | Val  Loss: 0.1958 | Val  Acc: 0.9432
 Site-Real                      (4) | Val  Loss: 0.1989 | Val  Acc: 0.9373
 Site-Clipart                   (0) | Val  Loss: 0.3038 | Val  Acc: 0.9286
 Site-Clipart                   (0) | Val  Loss: 0.3183 | Val  Acc: 0.9091
 Site-Clipart                   (0) | Val  Loss: 0.5632 | Val  Acc: 0.8889
 Site-Clipart                   (0) | Val  Loss: 0.5014 | Val  Acc: 0.8772
 Site-Clipart                   (0) | Val  Loss: 0.4435 | Val  Acc: 0.8804
 Site-Clipart                   (0) | Val  Loss: 0.3463 | Val  Acc: 0.9122
 Site-Clipart                   (0) | Val  Loss: 0.4076 | Val  Acc: 0.8771
 Site-Painting                  (2) | Val  Loss: 0.4106 | Val  Acc: 0.8780
 Site-Painting                  (2) | Val  Loss: 0.4896 | Val  Acc: 0.8923
 Site-Painting                  (2) | Val  Loss: 0.2962 | Val  Acc: 0.9429
 Site-Painting                  (2) | Val  Loss: 0.2519 | Val  Acc: 0.9405
 Site-Sketch                    (5) | Val  Loss: 0.5865 | Val  Acc: 0.8444
 Site-Sketch                    (5) | Val  Loss: 0.7605 | Val  Acc: 0.7671
 Site-Sketch                    (5) | Val  Loss: 0.4680 | Val  Acc: 0.8547
 Site-Infograph                 (3) | Val  Loss: 0.8699 | Val  Acc: 0.6964
 Site-Infograph                 (3) | Val  Loss: 0.9716 | Val  Acc: 0.7033
 Site-QuickDraw                 (1) | Val  Loss: 1.2086 | Val  Acc: 0.6087
Average Valid Accuracy: 0.8899
 Best site-Real                     (4)  | Epoch:49 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:49 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:49 | Val Acc: 1.0000
 Best site-Real                     (4)  | Epoch:49 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:49 | Val Acc: 0.9429
 Best site-Real                     (2)  | Epoch:49 | Val Acc: 0.9821
 Best site-Real                     (4)  | Epoch:49 | Val Acc: 0.9438
 Best site-Real                     (4)  | Epoch:49 | Val Acc: 0.9231
 Best site-Real                     (4)  | Epoch:49 | Val Acc: 0.9432
 Best site-Real                     (4)  | Epoch:49 | Val Acc: 0.9373
 Best site-Clipart                  (0)  | Epoch:49 | Val Acc: 0.9286
 Best site-Clipart                  (0)  | Epoch:49 | Val Acc: 0.9091
 Best site-Clipart                  (0)  | Epoch:49 | Val Acc: 0.8889
 Best site-Clipart                  (0)  | Epoch:49 | Val Acc: 0.8772
 Best site-Clipart                  (0)  | Epoch:49 | Val Acc: 0.8804
 Best site-Clipart                  (0)  | Epoch:49 | Val Acc: 0.9122
 Best site-Clipart                  (0)  | Epoch:49 | Val Acc: 0.8771
 Best site-Painting                 (2)  | Epoch:49 | Val Acc: 0.8780
 Best site-Painting                 (2)  | Epoch:49 | Val Acc: 0.8923
 Best site-Painting                 (2)  | Epoch:49 | Val Acc: 0.9429
 Best site-Painting                 (2)  | Epoch:49 | Val Acc: 0.9405
 Best site-Sketch                   (5)  | Epoch:49 | Val Acc: 0.8444
 Best site-Sketch                   (5)  | Epoch:49 | Val Acc: 0.7671
 Best site-Sketch                   (5)  | Epoch:49 | Val Acc: 0.8547
 Best site-Infograph                (3)  | Epoch:49 | Val Acc: 0.6964
 Best site-Infograph                (3)  | Epoch:49 | Val Acc: 0.7033
 Best site-QuickDraw                (1)  | Epoch:49 | Val Acc: 0.6087
 Test site-Real                      (4)| Epoch:49 | Test Acc: 0.9540
 Test site-Clipart                   (0)| Epoch:49 | Test Acc: 0.8650
 Test site-Painting                  (2)| Epoch:49 | Test Acc: 0.9305
 Test site-Sketch                    (5)| Epoch:49 | Test Acc: 0.8827
 Test site-Infograph                 (3)| Epoch:49 | Test Acc: 0.5738
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.6600
Real: 0.9540, Clipart: 0.8650, Painting: 0.9305, Sketch: 0.8827, Infograph: 0.5738, QuickDraw: 0.6600, 
Average Test Accuracy(group): 0.8110, Average Test Accuracy(individual): 0.8805,
domain std=0.1425, cluster std=0.1432, individual std=0.1058, 
Average Test Accuracy: 0.8110
 Test site-Real                      (4)| Epoch:49 | Test Acc: 0.9540
 Test site-Clipart                   (0)| Epoch:49 | Test Acc: 0.8650
 Test site-Painting                  (2)| Epoch:49 | Test Acc: 0.9305
 Test site-Sketch                    (5)| Epoch:49 | Test Acc: 0.8827
 Test site-Infograph                 (3)| Epoch:49 | Test Acc: 0.5738
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.6600
Real: 0.9540, Clipart: 0.8650, Painting: 0.9305, Sketch: 0.8827, Infograph: 0.5738, QuickDraw: 0.6600, 
Average Test Accuracy(group): 0.8110, Average Test Accuracy(individual): 0.8805,
domain std=0.1425, cluster std=0.1432, individual std=0.1058, 
===2023-06-29 02:11:04===
===2023-06-29 02:11:11===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[8,12,20,32,52,84,134,215,345,552,21,33,54,86,138,222,355,61,98,157,252,68,110,176,85,136,138,
client_nums=[10,7,4,3,2,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
Loading snapshots...
 Test site-Real                      (4)| Epoch:47 | Test Acc: 0.9523
 Test site-Clipart                   (5)| Epoch:47 | Test Acc: 0.8669
 Test site-Painting                  (2)| Epoch:47 | Test Acc: 0.9305
 Test site-Sketch                    (0)| Epoch:47 | Test Acc: 0.8791
 Test site-Infograph                 (3)| Epoch:47 | Test Acc: 0.5784
 Test site-QuickDraw                 (1)| Epoch:47 | Test Acc: 0.6600
Real: 0.9523, Clipart: 0.8669, Painting: 0.9305, Sketch: 0.8791, Infograph: 0.5784, QuickDraw: 0.6600, 
Average Test Accuracy(group): 0.8112, Average Test Accuracy(individual): 0.8803,
domain std=0.1408, cluster std=0.1430, individual std=0.1044, 
