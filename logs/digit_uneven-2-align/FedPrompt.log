===2023-03-29 09:33:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-MNIST     | Train Loss: 1.6948 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.6553 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6739 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.5679 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.6688 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.2305 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1992 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.7311 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.1431 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2028 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.5651 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.5869 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.6434 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.6827 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.6196 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.1791 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2244 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.7401 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.1141 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2299 | Val  Acc: 0.1525
Average Valid Accuracy: 0.4610
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-USPS       | Epoch:0 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.1831 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.1213 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.1487 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.0722 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.1587 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.1722 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.0919 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 1.2643 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.9164 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.0840 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 1.0070 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 1.1085 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.1607 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1917 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.0897 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.0942 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1130 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.3288 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.9010 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1171 | Val  Acc: 0.1695
Average Valid Accuracy: 0.5525
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1525
 Best site-USPS       | Epoch:1 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7490 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.6917 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.6710 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6247 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.7284 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.0781 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 1.8950 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.8374 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7329 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.9827 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 0.5618 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.6500 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6974 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.7369 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.6647 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9661 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.9583 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.9091 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.7423 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0127 | Val  Acc: 0.2542
Average Valid Accuracy: 0.6271
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2542
 Best site-USPS       | Epoch:2 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4424 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.4763 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4335 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3531 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.4666 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.9199 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.7630 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.5879 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.5676 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.8795 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 0.3131 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3734 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4231 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.4484 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4496 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.8410 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.7903 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.6632 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.6069 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.9591 | Val  Acc: 0.3729
Average Valid Accuracy: 0.6814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3898
 Best site-USPS       | Epoch:3 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2804 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.2769 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2733 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2152 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2914 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.8290 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.6043 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.4530 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.3182 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.7509 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.2119 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2151 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2810 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2853 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2977 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.6752 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.6300 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.4805 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.5288 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.9350 | Val  Acc: 0.3898
Average Valid Accuracy: 0.7356
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4407
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2034 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2096 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2213 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1570 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2085 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.5709 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.3743 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 0.3790 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.0061 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.3708 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.1548 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1711 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2243 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2057 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2321 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.4563 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.3461 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.3991 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.3569 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6511 | Val  Acc: 0.4237
Average Valid Accuracy: 0.7780
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5763
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1400 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1297 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1490 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0854 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1274 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.2778 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.1631 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.2700 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.8881 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 1.1027 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.0934 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0995 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1319 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1405 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1372 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.2553 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.1240 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 0.3231 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2466 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.5915 | Val  Acc: 0.4576
Average Valid Accuracy: 0.8017
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6271
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1318 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1109 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1395 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0671 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0991 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.0515 | Train Acc: 0.6136
 Site-SVHN      | Train Loss: 0.9153 | Train Acc: 0.7159
 Site-USPS      | Train Loss: 0.2114 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.6947 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.7810 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.0740 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0859 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1391 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1102 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1183 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.9842 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 0.9319 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 0.2665 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.1206 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.3465 | Val  Acc: 0.5424
Average Valid Accuracy: 0.8356
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6610
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0792 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0556 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0712 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0383 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0583 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.8954 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 0.7415 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.1846 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.5275 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.5942 | Train Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.0447 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0418 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0736 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0593 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0799 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7913 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.7619 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.2575 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0890 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.2993 | Val  Acc: 0.5932
Average Valid Accuracy: 0.8729
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7966
 Best site-USPS       | Epoch:8 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0597 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0506 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0618 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0307 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0422 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.8172 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 0.5897 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.1268 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.4405 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.4770 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0346 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0735 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0553 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0542 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6391 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.6655 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.2333 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.9763 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.1649 | Val  Acc: 0.6610
Average Valid Accuracy: 0.8932
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8305
 Best site-USPS       | Epoch:9 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6610
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-align/FedPrompt...
===2023-03-29 10:07:36===
===2023-03-29 10:07:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8929
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3270
 Test site-USPS      | Epoch:9 | Test Acc: 0.8172
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5355
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3621
Average Test Accuracy: 0.5869
