===2023-05-12 03:33:22===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 1.4871 | Train Acc: 0.7391
 Site-Clipart   | Train Loss: 1.3982 | Train Acc: 0.8261
 Site-Clipart   | Train Loss: 1.4886 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.4081 | Train Acc: 0.8228
 Site-Clipart   | Train Loss: 1.4361 | Train Acc: 0.8077
 Site-Real      | Train Loss: 1.2451 | Train Acc: 0.8968
 Site-Real      | Train Loss: 1.1294 | Train Acc: 0.9435
 Site-Real      | Train Loss: 1.1325 | Train Acc: 0.9476
 Site-Real      | Train Loss: 1.2221 | Train Acc: 0.8994
 Site-Painting  | Train Loss: 1.3424 | Train Acc: 0.8027
 Site-Painting  | Train Loss: 1.3305 | Train Acc: 0.8301
 Site-Painting  | Train Loss: 1.3522 | Train Acc: 0.8304
 Site-Sketch    | Train Loss: 1.4429 | Train Acc: 0.7016
 Site-Sketch    | Train Loss: 1.4752 | Train Acc: 0.7528
 Site-QuickDraw | Train Loss: 2.0978 | Train Acc: 0.3670
 Site-Infograph | Train Loss: 1.9609 | Train Acc: 0.4188
 Site-Clipart   | Val  Loss: 1.3043 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 1.4110 | Val  Acc: 0.8318
 Site-Clipart   | Val  Loss: 1.4418 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.3979 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.4661 | Val  Acc: 0.7831
 Site-Real      | Val  Loss: 1.1997 | Val  Acc: 0.9167
 Site-Real      | Val  Loss: 1.1837 | Val  Acc: 0.9237
 Site-Real      | Val  Loss: 1.1422 | Val  Acc: 0.9455
 Site-Real      | Val  Loss: 1.1374 | Val  Acc: 0.9481
 Site-Painting  | Val  Loss: 1.2835 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.3160 | Val  Acc: 0.8175
 Site-Painting  | Val  Loss: 1.3499 | Val  Acc: 0.8125
 Site-Sketch    | Val  Loss: 1.3867 | Val  Acc: 0.8268
 Site-Sketch    | Val  Loss: 1.4623 | Val  Acc: 0.6966
 Site-QuickDraw | Val  Loss: 2.1109 | Val  Acc: 0.3578
 Site-Infograph | Val  Loss: 1.9259 | Val  Acc: 0.4551
Average Valid Accuracy: 0.7888
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8421
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8318
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7831
 Best site-Real       | Epoch:0 | Val Acc: 0.9167
 Best site-Real       | Epoch:0 | Val Acc: 0.9237
 Best site-Real       | Epoch:0 | Val Acc: 0.9455
 Best site-Real       | Epoch:0 | Val Acc: 0.9481
 Best site-Painting   | Epoch:0 | Val Acc: 0.8571
 Best site-Painting   | Epoch:0 | Val Acc: 0.8175
 Best site-Painting   | Epoch:0 | Val Acc: 0.8125
 Best site-Sketch     | Epoch:0 | Val Acc: 0.8268
 Best site-Sketch     | Epoch:0 | Val Acc: 0.6966
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.3578
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4551
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 1.0411 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9056 | Train Acc: 0.8696
 Site-Clipart   | Train Loss: 1.0549 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9459 | Train Acc: 0.8386
 Site-Clipart   | Train Loss: 0.9766 | Train Acc: 0.8371
 Site-Real      | Train Loss: 0.7127 | Train Acc: 0.8968
 Site-Real      | Train Loss: 0.5847 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.5864 | Train Acc: 0.9556
 Site-Real      | Train Loss: 0.6706 | Train Acc: 0.9253
 Site-Painting  | Train Loss: 0.7741 | Train Acc: 0.8707
 Site-Painting  | Train Loss: 0.8759 | Train Acc: 0.8447
 Site-Painting  | Train Loss: 0.8942 | Train Acc: 0.8304
 Site-Sketch    | Train Loss: 1.0000 | Train Acc: 0.7435
 Site-Sketch    | Train Loss: 1.0131 | Train Acc: 0.7828
 Site-QuickDraw | Train Loss: 1.9086 | Train Acc: 0.3609
 Site-Infograph | Train Loss: 1.7465 | Train Acc: 0.4530
 Site-Clipart   | Val  Loss: 0.7824 | Val  Acc: 0.9342
 Site-Clipart   | Val  Loss: 0.9792 | Val  Acc: 0.7850
 Site-Clipart   | Val  Loss: 0.9687 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9136 | Val  Acc: 0.8524
 Site-Clipart   | Val  Loss: 1.0130 | Val  Acc: 0.8034
 Site-Real      | Val  Loss: 0.6876 | Val  Acc: 0.9167
 Site-Real      | Val  Loss: 0.6599 | Val  Acc: 0.9407
 Site-Real      | Val  Loss: 0.5857 | Val  Acc: 0.9636
 Site-Real      | Val  Loss: 0.5997 | Val  Acc: 0.9610
 Site-Painting  | Val  Loss: 0.6989 | Val  Acc: 0.8980
 Site-Painting  | Val  Loss: 0.8352 | Val  Acc: 0.8175
 Site-Painting  | Val  Loss: 0.8464 | Val  Acc: 0.8698
 Site-Sketch    | Val  Loss: 0.9671 | Val  Acc: 0.7874
 Site-Sketch    | Val  Loss: 0.9646 | Val  Acc: 0.7753
 Site-QuickDraw | Val  Loss: 1.9215 | Val  Acc: 0.3853
 Site-Infograph | Val  Loss: 1.6420 | Val  Acc: 0.4936
Average Valid Accuracy: 0.8136
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9342
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7850
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8524
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8034
 Best site-Real       | Epoch:1 | Val Acc: 0.9167
 Best site-Real       | Epoch:1 | Val Acc: 0.9407
 Best site-Real       | Epoch:1 | Val Acc: 0.9636
 Best site-Real       | Epoch:1 | Val Acc: 0.9610
 Best site-Painting   | Epoch:1 | Val Acc: 0.8980
 Best site-Painting   | Epoch:1 | Val Acc: 0.8175
 Best site-Painting   | Epoch:1 | Val Acc: 0.8698
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7874
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7753
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3853
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4936
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 0.8209 | Train Acc: 0.8609
 Site-Clipart   | Train Loss: 0.6456 | Train Acc: 0.8758
 Site-Clipart   | Train Loss: 0.7756 | Train Acc: 0.8311
 Site-Clipart   | Train Loss: 0.7439 | Train Acc: 0.8449
 Site-Clipart   | Train Loss: 0.7501 | Train Acc: 0.8643
 Site-Real      | Train Loss: 0.4848 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.3628 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.3595 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.4618 | Train Acc: 0.9425
 Site-Painting  | Train Loss: 0.6358 | Train Acc: 0.8980
 Site-Painting  | Train Loss: 0.5399 | Train Acc: 0.8738
 Site-Painting  | Train Loss: 0.6875 | Train Acc: 0.8443
 Site-Sketch    | Train Loss: 0.7929 | Train Acc: 0.7958
 Site-Sketch    | Train Loss: 0.7694 | Train Acc: 0.8202
 Site-QuickDraw | Train Loss: 1.8187 | Train Acc: 0.3853
 Site-Infograph | Train Loss: 1.6178 | Train Acc: 0.4658
 Site-Clipart   | Val  Loss: 0.5444 | Val  Acc: 0.8816
 Site-Clipart   | Val  Loss: 0.7354 | Val  Acc: 0.8598
 Site-Clipart   | Val  Loss: 0.7338 | Val  Acc: 0.8667
 Site-Clipart   | Val  Loss: 0.7023 | Val  Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.8063 | Val  Acc: 0.8373
 Site-Real      | Val  Loss: 0.4481 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.4445 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.3736 | Val  Acc: 0.9636
 Site-Real      | Val  Loss: 0.3568 | Val  Acc: 0.9567
 Site-Painting  | Val  Loss: 0.5619 | Val  Acc: 0.9184
 Site-Painting  | Val  Loss: 0.6331 | Val  Acc: 0.8467
 Site-Painting  | Val  Loss: 0.6613 | Val  Acc: 0.8750
 Site-Sketch    | Val  Loss: 0.7247 | Val  Acc: 0.8425
 Site-Sketch    | Val  Loss: 0.8184 | Val  Acc: 0.7753
 Site-QuickDraw | Val  Loss: 1.8056 | Val  Acc: 0.4128
 Site-Infograph | Val  Loss: 1.5369 | Val  Acc: 0.4936
Average Valid Accuracy: 0.8336
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8816
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8598
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8714
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8373
 Best site-Real       | Epoch:2 | Val Acc: 0.9524
 Best site-Real       | Epoch:2 | Val Acc: 0.9831
 Best site-Real       | Epoch:2 | Val Acc: 0.9636
 Best site-Real       | Epoch:2 | Val Acc: 0.9567
 Best site-Painting   | Epoch:2 | Val Acc: 0.9184
 Best site-Painting   | Epoch:2 | Val Acc: 0.8467
 Best site-Painting   | Epoch:2 | Val Acc: 0.8750
 Best site-Sketch     | Epoch:2 | Val Acc: 0.8425
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7753
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4128
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4936
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 0.6538 | Train Acc: 0.8435
 Site-Clipart   | Train Loss: 0.5559 | Train Acc: 0.8634
 Site-Clipart   | Train Loss: 0.6730 | Train Acc: 0.8578
 Site-Clipart   | Train Loss: 0.6182 | Train Acc: 0.8608
 Site-Clipart   | Train Loss: 0.6354 | Train Acc: 0.8824
 Site-Real      | Train Loss: 0.3816 | Train Acc: 0.9444
 Site-Real      | Train Loss: 0.2576 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.2733 | Train Acc: 0.9637
 Site-Real      | Train Loss: 0.3718 | Train Acc: 0.9569
 Site-Painting  | Train Loss: 0.5279 | Train Acc: 0.8435
 Site-Painting  | Train Loss: 0.5804 | Train Acc: 0.8689
 Site-Painting  | Train Loss: 0.5288 | Train Acc: 0.8720
 Site-Sketch    | Train Loss: 0.7040 | Train Acc: 0.7958
 Site-Sketch    | Train Loss: 0.6221 | Train Acc: 0.8352
 Site-QuickDraw | Train Loss: 1.6677 | Train Acc: 0.4281
 Site-Infograph | Train Loss: 1.5844 | Train Acc: 0.4872
 Site-Clipart   | Val  Loss: 0.4724 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.6465 | Val  Acc: 0.8505
 Site-Clipart   | Val  Loss: 0.6608 | Val  Acc: 0.8733
 Site-Clipart   | Val  Loss: 0.5917 | Val  Acc: 0.8619
 Site-Clipart   | Val  Loss: 0.6877 | Val  Acc: 0.8508
 Site-Real      | Val  Loss: 0.3666 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3592 | Val  Acc: 0.9576
 Site-Real      | Val  Loss: 0.2834 | Val  Acc: 0.9758
 Site-Real      | Val  Loss: 0.2823 | Val  Acc: 0.9567
 Site-Painting  | Val  Loss: 0.4597 | Val  Acc: 0.8980
 Site-Painting  | Val  Loss: 0.5606 | Val  Acc: 0.8540
 Site-Painting  | Val  Loss: 0.5764 | Val  Acc: 0.8698
 Site-Sketch    | Val  Loss: 0.5920 | Val  Acc: 0.8583
 Site-Sketch    | Val  Loss: 0.7015 | Val  Acc: 0.7978
 Site-QuickDraw | Val  Loss: 1.7309 | Val  Acc: 0.4725
 Site-Infograph | Val  Loss: 1.5020 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8390
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8505
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8733
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8619
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8508
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Real       | Epoch:3 | Val Acc: 0.9576
 Best site-Real       | Epoch:3 | Val Acc: 0.9758
 Best site-Real       | Epoch:3 | Val Acc: 0.9567
 Best site-Painting   | Epoch:3 | Val Acc: 0.8980
 Best site-Painting   | Epoch:3 | Val Acc: 0.8540
 Best site-Painting   | Epoch:3 | Val Acc: 0.8698
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8583
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7978
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4725
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 0.6579 | Train Acc: 0.8609
 Site-Clipart   | Train Loss: 0.5199 | Train Acc: 0.8758
 Site-Clipart   | Train Loss: 0.5830 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5309 | Train Acc: 0.8861
 Site-Clipart   | Train Loss: 0.5426 | Train Acc: 0.8937
 Site-Real      | Train Loss: 0.3271 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.2229 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.2283 | Train Acc: 0.9556
 Site-Real      | Train Loss: 0.3115 | Train Acc: 0.9483
 Site-Painting  | Train Loss: 0.5238 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.5326 | Train Acc: 0.8932
 Site-Painting  | Train Loss: 0.5050 | Train Acc: 0.8616
 Site-Sketch    | Train Loss: 0.6606 | Train Acc: 0.7958
 Site-Sketch    | Train Loss: 0.5956 | Train Acc: 0.8390
 Site-QuickDraw | Train Loss: 1.6689 | Train Acc: 0.4771
 Site-Infograph | Train Loss: 1.5762 | Train Acc: 0.4701
 Site-Clipart   | Val  Loss: 0.4015 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.5111 | Val  Acc: 0.8879
 Site-Clipart   | Val  Loss: 0.5791 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5319 | Val  Acc: 0.8952
 Site-Clipart   | Val  Loss: 0.5999 | Val  Acc: 0.8610
 Site-Real      | Val  Loss: 0.3122 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2846 | Val  Acc: 0.9746
 Site-Real      | Val  Loss: 0.2308 | Val  Acc: 0.9818
 Site-Real      | Val  Loss: 0.2318 | Val  Acc: 0.9654
 Site-Painting  | Val  Loss: 0.3974 | Val  Acc: 0.9184
 Site-Painting  | Val  Loss: 0.4939 | Val  Acc: 0.8394
 Site-Painting  | Val  Loss: 0.4453 | Val  Acc: 0.8906
 Site-Sketch    | Val  Loss: 0.5849 | Val  Acc: 0.8346
 Site-Sketch    | Val  Loss: 0.6762 | Val  Acc: 0.7865
 Site-QuickDraw | Val  Loss: 1.6565 | Val  Acc: 0.5046
 Site-Infograph | Val  Loss: 1.4707 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8496
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9211
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8879
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8952
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8610
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Real       | Epoch:4 | Val Acc: 0.9746
 Best site-Real       | Epoch:4 | Val Acc: 0.9818
 Best site-Real       | Epoch:4 | Val Acc: 0.9654
 Best site-Painting   | Epoch:4 | Val Acc: 0.9184
 Best site-Painting   | Epoch:4 | Val Acc: 0.8394
 Best site-Painting   | Epoch:4 | Val Acc: 0.8906
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8346
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7865
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5046
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 0.5294 | Train Acc: 0.8783
 Site-Clipart   | Train Loss: 0.3988 | Train Acc: 0.9068
 Site-Clipart   | Train Loss: 0.5331 | Train Acc: 0.8978
 Site-Clipart   | Train Loss: 0.4955 | Train Acc: 0.8861
 Site-Clipart   | Train Loss: 0.4978 | Train Acc: 0.8824
 Site-Real      | Train Loss: 0.2904 | Train Acc: 0.9286
 Site-Real      | Train Loss: 0.1575 | Train Acc: 0.9831
 Site-Real      | Train Loss: 0.1989 | Train Acc: 0.9677
 Site-Real      | Train Loss: 0.2489 | Train Acc: 0.9511
 Site-Painting  | Train Loss: 0.4777 | Train Acc: 0.8980
 Site-Painting  | Train Loss: 0.4156 | Train Acc: 0.9175
 Site-Painting  | Train Loss: 0.5374 | Train Acc: 0.8720
 Site-Sketch    | Train Loss: 0.6339 | Train Acc: 0.8010
 Site-Sketch    | Train Loss: 0.4401 | Train Acc: 0.8689
 Site-QuickDraw | Train Loss: 1.5748 | Train Acc: 0.4679
 Site-Infograph | Train Loss: 1.4904 | Train Acc: 0.4872
 Site-Clipart   | Val  Loss: 0.3836 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.4954 | Val  Acc: 0.8879
 Site-Clipart   | Val  Loss: 0.5421 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.4706 | Val  Acc: 0.8905
 Site-Clipart   | Val  Loss: 0.5355 | Val  Acc: 0.8746
 Site-Real      | Val  Loss: 0.2480 | Val  Acc: 0.9643
 Site-Real      | Val  Loss: 0.2799 | Val  Acc: 0.9576
 Site-Real      | Val  Loss: 0.2188 | Val  Acc: 0.9636
 Site-Real      | Val  Loss: 0.2052 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.3499 | Val  Acc: 0.9184
 Site-Painting  | Val  Loss: 0.4307 | Val  Acc: 0.8832
 Site-Painting  | Val  Loss: 0.4229 | Val  Acc: 0.9010
 Site-Sketch    | Val  Loss: 0.5106 | Val  Acc: 0.8504
 Site-Sketch    | Val  Loss: 0.5624 | Val  Acc: 0.8483
 Site-QuickDraw | Val  Loss: 1.5733 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.4639 | Val  Acc: 0.5128
Average Valid Accuracy: 0.8537
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8879
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8905
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8746
 Best site-Real       | Epoch:5 | Val Acc: 0.9643
 Best site-Real       | Epoch:5 | Val Acc: 0.9576
 Best site-Real       | Epoch:5 | Val Acc: 0.9636
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Painting   | Epoch:5 | Val Acc: 0.9184
 Best site-Painting   | Epoch:5 | Val Acc: 0.8832
 Best site-Painting   | Epoch:5 | Val Acc: 0.9010
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8504
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8483
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 0.4913 | Train Acc: 0.9130
 Site-Clipart   | Train Loss: 0.3972 | Train Acc: 0.9130
 Site-Clipart   | Train Loss: 0.4412 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4473 | Train Acc: 0.9019
 Site-Clipart   | Train Loss: 0.4300 | Train Acc: 0.9140
 Site-Real      | Train Loss: 0.2956 | Train Acc: 0.9127
 Site-Real      | Train Loss: 0.1661 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.1767 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.2475 | Train Acc: 0.9598
 Site-Painting  | Train Loss: 0.4774 | Train Acc: 0.8776
 Site-Painting  | Train Loss: 0.4049 | Train Acc: 0.8835
 Site-Painting  | Train Loss: 0.4301 | Train Acc: 0.8893
 Site-Sketch    | Train Loss: 0.5416 | Train Acc: 0.8272
 Site-Sketch    | Train Loss: 0.6040 | Train Acc: 0.8502
 Site-QuickDraw | Train Loss: 1.5578 | Train Acc: 0.4985
 Site-Infograph | Train Loss: 1.5176 | Train Acc: 0.5043
 Site-Clipart   | Val  Loss: 0.2954 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.4250 | Val  Acc: 0.9065
 Site-Clipart   | Val  Loss: 0.4711 | Val  Acc: 0.9133
 Site-Clipart   | Val  Loss: 0.4392 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4937 | Val  Acc: 0.8915
 Site-Real      | Val  Loss: 0.1965 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2379 | Val  Acc: 0.9661
 Site-Real      | Val  Loss: 0.1739 | Val  Acc: 0.9818
 Site-Real      | Val  Loss: 0.1793 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.3199 | Val  Acc: 0.9184
 Site-Painting  | Val  Loss: 0.4105 | Val  Acc: 0.8540
 Site-Painting  | Val  Loss: 0.4409 | Val  Acc: 0.8906
 Site-Sketch    | Val  Loss: 0.4126 | Val  Acc: 0.8976
 Site-Sketch    | Val  Loss: 0.5540 | Val  Acc: 0.8315
 Site-QuickDraw | Val  Loss: 1.5293 | Val  Acc: 0.5688
 Site-Infograph | Val  Loss: 1.4297 | Val  Acc: 0.5128
Average Valid Accuracy: 0.8676
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9211
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9065
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9133
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8915
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9661
 Best site-Real       | Epoch:6 | Val Acc: 0.9818
 Best site-Real       | Epoch:6 | Val Acc: 0.9697
 Best site-Painting   | Epoch:6 | Val Acc: 0.9184
 Best site-Painting   | Epoch:6 | Val Acc: 0.8540
 Best site-Painting   | Epoch:6 | Val Acc: 0.8906
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8976
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8315
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5688
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 0.4762 | Train Acc: 0.8783
 Site-Clipart   | Train Loss: 0.3750 | Train Acc: 0.9317
 Site-Clipart   | Train Loss: 0.4918 | Train Acc: 0.8978
 Site-Clipart   | Train Loss: 0.4301 | Train Acc: 0.9019
 Site-Clipart   | Train Loss: 0.4029 | Train Acc: 0.9140
 Site-Real      | Train Loss: 0.2620 | Train Acc: 0.9444
 Site-Real      | Train Loss: 0.1481 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.1632 | Train Acc: 0.9637
 Site-Real      | Train Loss: 0.2114 | Train Acc: 0.9655
 Site-Painting  | Train Loss: 0.4356 | Train Acc: 0.8844
 Site-Painting  | Train Loss: 0.3875 | Train Acc: 0.9272
 Site-Painting  | Train Loss: 0.4204 | Train Acc: 0.8754
 Site-Sketch    | Train Loss: 0.5680 | Train Acc: 0.8272
 Site-Sketch    | Train Loss: 0.5597 | Train Acc: 0.8614
 Site-QuickDraw | Train Loss: 1.5179 | Train Acc: 0.5260
 Site-Infograph | Train Loss: 1.4654 | Train Acc: 0.5171
 Site-Clipart   | Val  Loss: 0.3084 | Val  Acc: 0.8816
 Site-Clipart   | Val  Loss: 0.4061 | Val  Acc: 0.9159
 Site-Clipart   | Val  Loss: 0.4334 | Val  Acc: 0.8933
 Site-Clipart   | Val  Loss: 0.3717 | Val  Acc: 0.9095
 Site-Clipart   | Val  Loss: 0.4792 | Val  Acc: 0.8915
 Site-Real      | Val  Loss: 0.2251 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2341 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.1575 | Val  Acc: 0.9758
 Site-Real      | Val  Loss: 0.1596 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.2775 | Val  Acc: 0.9490
 Site-Painting  | Val  Loss: 0.4352 | Val  Acc: 0.8540
 Site-Painting  | Val  Loss: 0.3799 | Val  Acc: 0.9115
 Site-Sketch    | Val  Loss: 0.4161 | Val  Acc: 0.8898
 Site-Sketch    | Val  Loss: 0.5378 | Val  Acc: 0.8427
 Site-QuickDraw | Val  Loss: 1.4540 | Val  Acc: 0.5872
 Site-Infograph | Val  Loss: 1.4377 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8692
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8816
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9159
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8933
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9095
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8915
 Best site-Real       | Epoch:7 | Val Acc: 0.9524
 Best site-Real       | Epoch:7 | Val Acc: 0.9831
 Best site-Real       | Epoch:7 | Val Acc: 0.9758
 Best site-Real       | Epoch:7 | Val Acc: 0.9697
 Best site-Painting   | Epoch:7 | Val Acc: 0.9490
 Best site-Painting   | Epoch:7 | Val Acc: 0.8540
 Best site-Painting   | Epoch:7 | Val Acc: 0.9115
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8898
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8427
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5872
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 0.4151 | Train Acc: 0.9043
 Site-Clipart   | Train Loss: 0.3362 | Train Acc: 0.9255
 Site-Clipart   | Train Loss: 0.4556 | Train Acc: 0.8978
 Site-Clipart   | Train Loss: 0.3967 | Train Acc: 0.9019
 Site-Clipart   | Train Loss: 0.4112 | Train Acc: 0.9118
 Site-Real      | Train Loss: 0.2450 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.1505 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.1533 | Train Acc: 0.9597
 Site-Real      | Train Loss: 0.1709 | Train Acc: 0.9741
 Site-Painting  | Train Loss: 0.3520 | Train Acc: 0.8912
 Site-Painting  | Train Loss: 0.3286 | Train Acc: 0.9175
 Site-Painting  | Train Loss: 0.4203 | Train Acc: 0.8927
 Site-Sketch    | Train Loss: 0.5463 | Train Acc: 0.8325
 Site-Sketch    | Train Loss: 0.4486 | Train Acc: 0.8577
 Site-QuickDraw | Train Loss: 1.4457 | Train Acc: 0.5596
 Site-Infograph | Train Loss: 1.4913 | Train Acc: 0.4915
 Site-Clipart   | Val  Loss: 0.2632 | Val  Acc: 0.9079
 Site-Clipart   | Val  Loss: 0.4342 | Val  Acc: 0.8879
 Site-Clipart   | Val  Loss: 0.3842 | Val  Acc: 0.9067
 Site-Clipart   | Val  Loss: 0.3926 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4755 | Val  Acc: 0.8847
 Site-Real      | Val  Loss: 0.1906 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1976 | Val  Acc: 0.9661
 Site-Real      | Val  Loss: 0.1490 | Val  Acc: 0.9758
 Site-Real      | Val  Loss: 0.1412 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.3083 | Val  Acc: 0.8980
 Site-Painting  | Val  Loss: 0.4179 | Val  Acc: 0.8613
 Site-Painting  | Val  Loss: 0.3853 | Val  Acc: 0.8802
 Site-Sketch    | Val  Loss: 0.4214 | Val  Acc: 0.8819
 Site-Sketch    | Val  Loss: 0.4930 | Val  Acc: 0.8483
 Site-QuickDraw | Val  Loss: 1.3972 | Val  Acc: 0.5963
 Site-Infograph | Val  Loss: 1.4133 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8671
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 0.4088 | Train Acc: 0.9043
 Site-Clipart   | Train Loss: 0.3155 | Train Acc: 0.9503
 Site-Clipart   | Train Loss: 0.4489 | Train Acc: 0.8844
 Site-Clipart   | Train Loss: 0.3668 | Train Acc: 0.9082
 Site-Clipart   | Train Loss: 0.3492 | Train Acc: 0.9299
 Site-Real      | Train Loss: 0.2571 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1210 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.1199 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.1727 | Train Acc: 0.9799
 Site-Painting  | Train Loss: 0.2876 | Train Acc: 0.9320
 Site-Painting  | Train Loss: 0.3168 | Train Acc: 0.9223
 Site-Painting  | Train Loss: 0.3704 | Train Acc: 0.9031
 Site-Sketch    | Train Loss: 0.5542 | Train Acc: 0.8220
 Site-Sketch    | Train Loss: 0.4327 | Train Acc: 0.8801
 Site-QuickDraw | Train Loss: 1.2911 | Train Acc: 0.5505
 Site-Infograph | Train Loss: 1.4262 | Train Acc: 0.5171
 Site-Clipart   | Val  Loss: 0.2372 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.3509 | Val  Acc: 0.9159
 Site-Clipart   | Val  Loss: 0.3637 | Val  Acc: 0.8933
 Site-Clipart   | Val  Loss: 0.3405 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4003 | Val  Acc: 0.9017
 Site-Real      | Val  Loss: 0.1873 | Val  Acc: 0.9643
 Site-Real      | Val  Loss: 0.1979 | Val  Acc: 0.9661
 Site-Real      | Val  Loss: 0.1363 | Val  Acc: 0.9758
 Site-Real      | Val  Loss: 0.1442 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.2571 | Val  Acc: 0.9388
 Site-Painting  | Val  Loss: 0.3556 | Val  Acc: 0.8905
 Site-Painting  | Val  Loss: 0.3583 | Val  Acc: 0.8854
 Site-Sketch    | Val  Loss: 0.4226 | Val  Acc: 0.8819
 Site-Sketch    | Val  Loss: 0.5196 | Val  Acc: 0.8258
 Site-QuickDraw | Val  Loss: 1.3620 | Val  Acc: 0.6147
 Site-Infograph | Val  Loss: 1.3758 | Val  Acc: 0.5064
Average Valid Accuracy: 0.8721
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9159
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8933
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9017
 Best site-Real       | Epoch:9 | Val Acc: 0.9643
 Best site-Real       | Epoch:9 | Val Acc: 0.9661
 Best site-Real       | Epoch:9 | Val Acc: 0.9758
 Best site-Real       | Epoch:9 | Val Acc: 0.9697
 Best site-Painting   | Epoch:9 | Val Acc: 0.9388
 Best site-Painting   | Epoch:9 | Val Acc: 0.8905
 Best site-Painting   | Epoch:9 | Val Acc: 0.8854
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8819
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8258
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6147
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5064
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.9221
 Test site-Real      | Epoch:9 | Test Acc: 0.9638
 Test site-Painting  | Epoch:9 | Test Acc: 0.9225
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8845
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.5870
 Test site-Infograph | Epoch:9 | Test Acc: 0.5221
Average Test Accuracy: 0.8003
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 0.4410 | Train Acc: 0.8609
 Site-Clipart   | Train Loss: 0.2679 | Train Acc: 0.9627
 Site-Clipart   | Train Loss: 0.4112 | Train Acc: 0.9022
 Site-Clipart   | Train Loss: 0.3472 | Train Acc: 0.9082
 Site-Clipart   | Train Loss: 0.3424 | Train Acc: 0.9253
 Site-Real      | Train Loss: 0.2192 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1129 | Train Acc: 0.9831
 Site-Real      | Train Loss: 0.1272 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.1621 | Train Acc: 0.9655
 Site-Painting  | Train Loss: 0.3918 | Train Acc: 0.8980
 Site-Painting  | Train Loss: 0.3609 | Train Acc: 0.9078
 Site-Painting  | Train Loss: 0.3427 | Train Acc: 0.8997
 Site-Sketch    | Train Loss: 0.5310 | Train Acc: 0.8272
 Site-Sketch    | Train Loss: 0.4057 | Train Acc: 0.8614
 Site-QuickDraw | Train Loss: 1.3586 | Train Acc: 0.5566
 Site-Infograph | Train Loss: 1.4337 | Train Acc: 0.5085
 Site-Clipart   | Val  Loss: 0.2363 | Val  Acc: 0.9079
 Site-Clipart   | Val  Loss: 0.3297 | Val  Acc: 0.9252
 Site-Clipart   | Val  Loss: 0.3602 | Val  Acc: 0.9133
 Site-Clipart   | Val  Loss: 0.3396 | Val  Acc: 0.9095
 Site-Clipart   | Val  Loss: 0.4134 | Val  Acc: 0.9051
 Site-Real      | Val  Loss: 0.1705 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1710 | Val  Acc: 0.9746
 Site-Real      | Val  Loss: 0.1179 | Val  Acc: 0.9697
 Site-Real      | Val  Loss: 0.1545 | Val  Acc: 0.9610
 Site-Painting  | Val  Loss: 0.2368 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.3445 | Val  Acc: 0.8613
 Site-Painting  | Val  Loss: 0.3533 | Val  Acc: 0.9062
 Site-Sketch    | Val  Loss: 0.4137 | Val  Acc: 0.8976
 Site-Sketch    | Val  Loss: 0.5699 | Val  Acc: 0.8258
 Site-QuickDraw | Val  Loss: 1.3353 | Val  Acc: 0.6101
 Site-Infograph | Val  Loss: 1.3780 | Val  Acc: 0.5321
Average Valid Accuracy: 0.8753
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9079
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9252
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9133
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9095
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9051
 Best site-Real       | Epoch:10 | Val Acc: 0.9762
 Best site-Real       | Epoch:10 | Val Acc: 0.9746
 Best site-Real       | Epoch:10 | Val Acc: 0.9697
 Best site-Real       | Epoch:10 | Val Acc: 0.9610
 Best site-Painting   | Epoch:10 | Val Acc: 0.9286
 Best site-Painting   | Epoch:10 | Val Acc: 0.8613
 Best site-Painting   | Epoch:10 | Val Acc: 0.9062
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8976
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8258
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.6101
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5321
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 0.3889 | Train Acc: 0.9043
 Site-Clipart   | Train Loss: 0.2784 | Train Acc: 0.9379
 Site-Clipart   | Train Loss: 0.3140 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.3309 | Train Acc: 0.9272
 Site-Clipart   | Train Loss: 0.3036 | Train Acc: 0.9299
 Site-Real      | Train Loss: 0.2304 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1191 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.1265 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.1625 | Train Acc: 0.9655
 Site-Painting  | Train Loss: 0.4161 | Train Acc: 0.9116
 Site-Painting  | Train Loss: 0.2651 | Train Acc: 0.9175
 Site-Painting  | Train Loss: 0.3679 | Train Acc: 0.8962
 Site-Sketch    | Train Loss: 0.4893 | Train Acc: 0.8429
 Site-Sketch    | Train Loss: 0.4042 | Train Acc: 0.8876
 Site-QuickDraw | Train Loss: 1.3151 | Train Acc: 0.5566
 Site-Infograph | Train Loss: 1.4146 | Train Acc: 0.5128
 Site-Clipart   | Val  Loss: 0.2499 | Val  Acc: 0.9079
 Site-Clipart   | Val  Loss: 0.3507 | Val  Acc: 0.9065
 Site-Clipart   | Val  Loss: 0.3213 | Val  Acc: 0.9333
 Site-Clipart   | Val  Loss: 0.3104 | Val  Acc: 0.9238
 Site-Clipart   | Val  Loss: 0.3868 | Val  Acc: 0.8915
 Site-Real      | Val  Loss: 0.1434 | Val  Acc: 0.9643
 Site-Real      | Val  Loss: 0.1783 | Val  Acc: 0.9661
 Site-Real      | Val  Loss: 0.1091 | Val  Acc: 0.9758
 Site-Real      | Val  Loss: 0.1311 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.2416 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.3712 | Val  Acc: 0.8540
 Site-Painting  | Val  Loss: 0.3347 | Val  Acc: 0.8958
 Site-Sketch    | Val  Loss: 0.3981 | Val  Acc: 0.8346
 Site-Sketch    | Val  Loss: 0.5016 | Val  Acc: 0.8652
 Site-QuickDraw | Val  Loss: 1.3740 | Val  Acc: 0.6055
 Site-Infograph | Val  Loss: 1.4100 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8726
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 0.3115 | Train Acc: 0.9391
 Site-Clipart   | Train Loss: 0.2641 | Train Acc: 0.9441
 Site-Clipart   | Train Loss: 0.3359 | Train Acc: 0.9111
 Site-Clipart   | Train Loss: 0.3213 | Train Acc: 0.9209
 Site-Clipart   | Train Loss: 0.2833 | Train Acc: 0.9457
 Site-Real      | Train Loss: 0.2118 | Train Acc: 0.9444
 Site-Real      | Train Loss: 0.1237 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.1061 | Train Acc: 0.9758
 Site-Real      | Train Loss: 0.1197 | Train Acc: 0.9856
 Site-Painting  | Train Loss: 0.3873 | Train Acc: 0.9116
 Site-Painting  | Train Loss: 0.3138 | Train Acc: 0.9078
 Site-Painting  | Train Loss: 0.3508 | Train Acc: 0.9066
 Site-Sketch    | Train Loss: 0.4958 | Train Acc: 0.8220
 Site-Sketch    | Train Loss: 0.3594 | Train Acc: 0.8801
 Site-QuickDraw | Train Loss: 1.3160 | Train Acc: 0.5933
 Site-Infograph | Train Loss: 1.4417 | Train Acc: 0.4872
 Site-Clipart   | Val  Loss: 0.2206 | Val  Acc: 0.9079
 Site-Clipart   | Val  Loss: 0.3200 | Val  Acc: 0.9346
 Site-Clipart   | Val  Loss: 0.3186 | Val  Acc: 0.9267
 Site-Clipart   | Val  Loss: 0.2949 | Val  Acc: 0.9095
 Site-Clipart   | Val  Loss: 0.4011 | Val  Acc: 0.9051
 Site-Real      | Val  Loss: 0.1433 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1156 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1080 | Val  Acc: 0.9818
 Site-Real      | Val  Loss: 0.1285 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.2689 | Val  Acc: 0.9388
 Site-Painting  | Val  Loss: 0.3816 | Val  Acc: 0.8905
 Site-Painting  | Val  Loss: 0.3224 | Val  Acc: 0.9010
 Site-Sketch    | Val  Loss: 0.4001 | Val  Acc: 0.8740
 Site-Sketch    | Val  Loss: 0.4404 | Val  Acc: 0.8764
 Site-QuickDraw | Val  Loss: 1.3047 | Val  Acc: 0.6330
 Site-Infograph | Val  Loss: 1.3190 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8868
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9079
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9346
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9267
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9095
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9051
 Best site-Real       | Epoch:12 | Val Acc: 0.9762
 Best site-Real       | Epoch:12 | Val Acc: 1.0000
 Best site-Real       | Epoch:12 | Val Acc: 0.9818
 Best site-Real       | Epoch:12 | Val Acc: 0.9697
 Best site-Painting   | Epoch:12 | Val Acc: 0.9388
 Best site-Painting   | Epoch:12 | Val Acc: 0.8905
 Best site-Painting   | Epoch:12 | Val Acc: 0.9010
 Best site-Sketch     | Epoch:12 | Val Acc: 0.8740
 Best site-Sketch     | Epoch:12 | Val Acc: 0.8764
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.6330
 Best site-Infograph  | Epoch:12 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 0.3700 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.2907 | Train Acc: 0.9255
 Site-Clipart   | Train Loss: 0.3780 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.3197 | Train Acc: 0.9082
 Site-Clipart   | Train Loss: 0.2762 | Train Acc: 0.9502
 Site-Real      | Train Loss: 0.2397 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.1109 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.1065 | Train Acc: 0.9758
 Site-Real      | Train Loss: 0.1482 | Train Acc: 0.9856
 Site-Painting  | Train Loss: 0.3134 | Train Acc: 0.9184
 Site-Painting  | Train Loss: 0.2875 | Train Acc: 0.9175
 Site-Painting  | Train Loss: 0.3256 | Train Acc: 0.8962
 Site-Sketch    | Train Loss: 0.5072 | Train Acc: 0.8063
 Site-Sketch    | Train Loss: 0.4445 | Train Acc: 0.8876
 Site-QuickDraw | Train Loss: 1.3820 | Train Acc: 0.5688
 Site-Infograph | Train Loss: 1.4550 | Train Acc: 0.5128
 Site-Clipart   | Val  Loss: 0.2475 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.3345 | Val  Acc: 0.9065
 Site-Clipart   | Val  Loss: 0.3256 | Val  Acc: 0.9067
 Site-Clipart   | Val  Loss: 0.2890 | Val  Acc: 0.9333
 Site-Clipart   | Val  Loss: 0.3582 | Val  Acc: 0.9017
 Site-Real      | Val  Loss: 0.1392 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1550 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0857 | Val  Acc: 0.9818
 Site-Real      | Val  Loss: 0.1159 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.2357 | Val  Acc: 0.9388
 Site-Painting  | Val  Loss: 0.2970 | Val  Acc: 0.8832
 Site-Painting  | Val  Loss: 0.3087 | Val  Acc: 0.9062
 Site-Sketch    | Val  Loss: 0.3065 | Val  Acc: 0.9134
 Site-Sketch    | Val  Loss: 0.4496 | Val  Acc: 0.8539
 Site-QuickDraw | Val  Loss: 1.3025 | Val  Acc: 0.5963
 Site-Infograph | Val  Loss: 1.3074 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8839
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 0.3866 | Train Acc: 0.9043
 Site-Clipart   | Train Loss: 0.2760 | Train Acc: 0.9006
 Site-Clipart   | Train Loss: 0.3566 | Train Acc: 0.9022
 Site-Clipart   | Train Loss: 0.3178 | Train Acc: 0.9241
 Site-Clipart   | Train Loss: 0.2572 | Train Acc: 0.9321
 Site-Real      | Train Loss: 0.2084 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0947 | Train Acc: 0.9831
 Site-Real      | Train Loss: 0.0994 | Train Acc: 0.9758
 Site-Real      | Train Loss: 0.1333 | Train Acc: 0.9799
 Site-Painting  | Train Loss: 0.2370 | Train Acc: 0.9252
 Site-Painting  | Train Loss: 0.2642 | Train Acc: 0.9369
 Site-Painting  | Train Loss: 0.2830 | Train Acc: 0.9273
 Site-Sketch    | Train Loss: 0.4119 | Train Acc: 0.8796
 Site-Sketch    | Train Loss: 0.3487 | Train Acc: 0.8951
 Site-QuickDraw | Train Loss: 1.3297 | Train Acc: 0.6055
 Site-Infograph | Train Loss: 1.3948 | Train Acc: 0.5256
 Site-Clipart   | Val  Loss: 0.1765 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.2936 | Val  Acc: 0.9346
 Site-Clipart   | Val  Loss: 0.3324 | Val  Acc: 0.9133
 Site-Clipart   | Val  Loss: 0.3033 | Val  Acc: 0.9238
 Site-Clipart   | Val  Loss: 0.3246 | Val  Acc: 0.9220
 Site-Real      | Val  Loss: 0.1501 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1297 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0923 | Val  Acc: 0.9879
 Site-Real      | Val  Loss: 0.1121 | Val  Acc: 0.9654
 Site-Painting  | Val  Loss: 0.2348 | Val  Acc: 0.9490
 Site-Painting  | Val  Loss: 0.3319 | Val  Acc: 0.8759
 Site-Painting  | Val  Loss: 0.2835 | Val  Acc: 0.9167
 Site-Sketch    | Val  Loss: 0.3545 | Val  Acc: 0.8819
 Site-Sketch    | Val  Loss: 0.4624 | Val  Acc: 0.8539
 Site-QuickDraw | Val  Loss: 1.3039 | Val  Acc: 0.6284
 Site-Infograph | Val  Loss: 1.4358 | Val  Acc: 0.5064
Average Valid Accuracy: 0.8837
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 0.3128 | Train Acc: 0.9043
 Site-Clipart   | Train Loss: 0.2871 | Train Acc: 0.9193
 Site-Clipart   | Train Loss: 0.3409 | Train Acc: 0.9289
 Site-Clipart   | Train Loss: 0.2995 | Train Acc: 0.9335
 Site-Clipart   | Train Loss: 0.2718 | Train Acc: 0.9412
 Site-Real      | Train Loss: 0.2013 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.1093 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.1035 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.1192 | Train Acc: 0.9770
 Site-Painting  | Train Loss: 0.2895 | Train Acc: 0.9252
 Site-Painting  | Train Loss: 0.2752 | Train Acc: 0.9223
 Site-Painting  | Train Loss: 0.2884 | Train Acc: 0.9308
 Site-Sketch    | Train Loss: 0.4995 | Train Acc: 0.8272
 Site-Sketch    | Train Loss: 0.4475 | Train Acc: 0.8727
 Site-QuickDraw | Train Loss: 1.1699 | Train Acc: 0.6239
 Site-Infograph | Train Loss: 1.3754 | Train Acc: 0.5342
 Site-Clipart   | Val  Loss: 0.2009 | Val  Acc: 0.9079
 Site-Clipart   | Val  Loss: 0.3021 | Val  Acc: 0.9346
 Site-Clipart   | Val  Loss: 0.2839 | Val  Acc: 0.9267
 Site-Clipart   | Val  Loss: 0.3252 | Val  Acc: 0.9095
 Site-Clipart   | Val  Loss: 0.3518 | Val  Acc: 0.9017
 Site-Real      | Val  Loss: 0.1482 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1227 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0712 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1092 | Val  Acc: 0.9740
 Site-Painting  | Val  Loss: 0.2043 | Val  Acc: 0.9490
 Site-Painting  | Val  Loss: 0.3032 | Val  Acc: 0.9051
 Site-Painting  | Val  Loss: 0.3149 | Val  Acc: 0.9167
 Site-Sketch    | Val  Loss: 0.3462 | Val  Acc: 0.9134
 Site-Sketch    | Val  Loss: 0.4023 | Val  Acc: 0.8933
 Site-QuickDraw | Val  Loss: 1.2304 | Val  Acc: 0.6606
 Site-Infograph | Val  Loss: 1.3407 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8931
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9079
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9346
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9267
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9095
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9017
 Best site-Real       | Epoch:15 | Val Acc: 0.9762
 Best site-Real       | Epoch:15 | Val Acc: 0.9831
 Best site-Real       | Epoch:15 | Val Acc: 1.0000
 Best site-Real       | Epoch:15 | Val Acc: 0.9740
 Best site-Painting   | Epoch:15 | Val Acc: 0.9490
 Best site-Painting   | Epoch:15 | Val Acc: 0.9051
 Best site-Painting   | Epoch:15 | Val Acc: 0.9167
 Best site-Sketch     | Epoch:15 | Val Acc: 0.9134
 Best site-Sketch     | Epoch:15 | Val Acc: 0.8933
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.6606
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 0.3824 | Train Acc: 0.9043
 Site-Clipart   | Train Loss: 0.2726 | Train Acc: 0.9255
 Site-Clipart   | Train Loss: 0.2771 | Train Acc: 0.9289
 Site-Clipart   | Train Loss: 0.2667 | Train Acc: 0.9304
 Site-Clipart   | Train Loss: 0.2448 | Train Acc: 0.9457
 Site-Real      | Train Loss: 0.1927 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0931 | Train Acc: 0.9831
 Site-Real      | Train Loss: 0.0922 | Train Acc: 0.9798
 Site-Real      | Train Loss: 0.1218 | Train Acc: 0.9741
 Site-Painting  | Train Loss: 0.2822 | Train Acc: 0.9252
 Site-Painting  | Train Loss: 0.2366 | Train Acc: 0.9223
 Site-Painting  | Train Loss: 0.3162 | Train Acc: 0.9239
 Site-Sketch    | Train Loss: 0.4819 | Train Acc: 0.8586
 Site-Sketch    | Train Loss: 0.3616 | Train Acc: 0.8839
 Site-QuickDraw | Train Loss: 1.1167 | Train Acc: 0.6239
 Site-Infograph | Train Loss: 1.4026 | Train Acc: 0.5299
 Site-Clipart   | Val  Loss: 0.2195 | Val  Acc: 0.9079
 Site-Clipart   | Val  Loss: 0.2778 | Val  Acc: 0.9252
 Site-Clipart   | Val  Loss: 0.2515 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2706 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3512 | Val  Acc: 0.9119
 Site-Real      | Val  Loss: 0.1319 | Val  Acc: 0.9643
 Site-Real      | Val  Loss: 0.1526 | Val  Acc: 0.9746
 Site-Real      | Val  Loss: 0.1026 | Val  Acc: 0.9818
 Site-Real      | Val  Loss: 0.1116 | Val  Acc: 0.9610
 Site-Painting  | Val  Loss: 0.2100 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2903 | Val  Acc: 0.9124
 Site-Painting  | Val  Loss: 0.2867 | Val  Acc: 0.9219
 Site-Sketch    | Val  Loss: 0.3058 | Val  Acc: 0.9213
 Site-Sketch    | Val  Loss: 0.4213 | Val  Acc: 0.8596
 Site-QuickDraw | Val  Loss: 1.2320 | Val  Acc: 0.6284
 Site-Infograph | Val  Loss: 1.3772 | Val  Acc: 0.5449
Average Valid Accuracy: 0.8914
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 0.3694 | Train Acc: 0.8870
 Site-Clipart   | Train Loss: 0.2322 | Train Acc: 0.9503
 Site-Clipart   | Train Loss: 0.2786 | Train Acc: 0.9422
 Site-Clipart   | Train Loss: 0.2770 | Train Acc: 0.9367
 Site-Clipart   | Train Loss: 0.2686 | Train Acc: 0.9412
 Site-Real      | Train Loss: 0.2071 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1019 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.0857 | Train Acc: 0.9839
 Site-Real      | Train Loss: 0.1030 | Train Acc: 0.9828
 Site-Painting  | Train Loss: 0.2961 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.2419 | Train Acc: 0.9466
 Site-Painting  | Train Loss: 0.2619 | Train Acc: 0.9239
 Site-Sketch    | Train Loss: 0.4497 | Train Acc: 0.8691
 Site-Sketch    | Train Loss: 0.4154 | Train Acc: 0.8876
 Site-QuickDraw | Train Loss: 1.2099 | Train Acc: 0.6024
 Site-Infograph | Train Loss: 1.4072 | Train Acc: 0.5043
 Site-Clipart   | Val  Loss: 0.1881 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.2782 | Val  Acc: 0.9346
 Site-Clipart   | Val  Loss: 0.2958 | Val  Acc: 0.9400
 Site-Clipart   | Val  Loss: 0.2827 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3276 | Val  Acc: 0.9254
 Site-Real      | Val  Loss: 0.1080 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.1049 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0778 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.1003 | Val  Acc: 0.9784
 Site-Painting  | Val  Loss: 0.2013 | Val  Acc: 0.9694
 Site-Painting  | Val  Loss: 0.2823 | Val  Acc: 0.9051
 Site-Painting  | Val  Loss: 0.2753 | Val  Acc: 0.9219
 Site-Sketch    | Val  Loss: 0.3115 | Val  Acc: 0.9055
 Site-Sketch    | Val  Loss: 0.4310 | Val  Acc: 0.8764
 Site-QuickDraw | Val  Loss: 1.2303 | Val  Acc: 0.6330
 Site-Infograph | Val  Loss: 1.3256 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8972
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9211
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9346
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9400
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9254
 Best site-Real       | Epoch:17 | Val Acc: 0.9881
 Best site-Real       | Epoch:17 | Val Acc: 0.9831
 Best site-Real       | Epoch:17 | Val Acc: 0.9939
 Best site-Real       | Epoch:17 | Val Acc: 0.9784
 Best site-Painting   | Epoch:17 | Val Acc: 0.9694
 Best site-Painting   | Epoch:17 | Val Acc: 0.9051
 Best site-Painting   | Epoch:17 | Val Acc: 0.9219
 Best site-Sketch     | Epoch:17 | Val Acc: 0.9055
 Best site-Sketch     | Epoch:17 | Val Acc: 0.8764
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.6330
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 0.2739 | Train Acc: 0.9130
 Site-Clipart   | Train Loss: 0.2295 | Train Acc: 0.9379
 Site-Clipart   | Train Loss: 0.3164 | Train Acc: 0.9244
 Site-Clipart   | Train Loss: 0.2596 | Train Acc: 0.9399
 Site-Clipart   | Train Loss: 0.2330 | Train Acc: 0.9502
 Site-Real      | Train Loss: 0.1753 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.1117 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.0907 | Train Acc: 0.9758
 Site-Real      | Train Loss: 0.1148 | Train Acc: 0.9799
 Site-Painting  | Train Loss: 0.2440 | Train Acc: 0.9388
 Site-Painting  | Train Loss: 0.2468 | Train Acc: 0.9369
 Site-Painting  | Train Loss: 0.2713 | Train Acc: 0.9135
 Site-Sketch    | Train Loss: 0.4062 | Train Acc: 0.8691
 Site-Sketch    | Train Loss: 0.3443 | Train Acc: 0.9139
 Site-QuickDraw | Train Loss: 1.0558 | Train Acc: 0.6239
 Site-Infograph | Train Loss: 1.4091 | Train Acc: 0.5043
 Site-Clipart   | Val  Loss: 0.1692 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.2404 | Val  Acc: 0.9346
 Site-Clipart   | Val  Loss: 0.2311 | Val  Acc: 0.9333
 Site-Clipart   | Val  Loss: 0.2635 | Val  Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2903 | Val  Acc: 0.9186
 Site-Real      | Val  Loss: 0.0881 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.1182 | Val  Acc: 0.9746
 Site-Real      | Val  Loss: 0.0789 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.1083 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.1720 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2189 | Val  Acc: 0.9343
 Site-Painting  | Val  Loss: 0.2600 | Val  Acc: 0.9219
 Site-Sketch    | Val  Loss: 0.3253 | Val  Acc: 0.9370
 Site-Sketch    | Val  Loss: 0.3840 | Val  Acc: 0.8764
 Site-QuickDraw | Val  Loss: 1.1443 | Val  Acc: 0.6606
 Site-Infograph | Val  Loss: 1.3535 | Val  Acc: 0.5449
Average Valid Accuracy: 0.9007
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9211
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9346
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9333
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9429
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9186
 Best site-Real       | Epoch:18 | Val Acc: 0.9881
 Best site-Real       | Epoch:18 | Val Acc: 0.9746
 Best site-Real       | Epoch:18 | Val Acc: 0.9939
 Best site-Real       | Epoch:18 | Val Acc: 0.9697
 Best site-Painting   | Epoch:18 | Val Acc: 0.9592
 Best site-Painting   | Epoch:18 | Val Acc: 0.9343
 Best site-Painting   | Epoch:18 | Val Acc: 0.9219
 Best site-Sketch     | Epoch:18 | Val Acc: 0.9370
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8764
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.6606
 Best site-Infograph  | Epoch:18 | Val Acc: 0.5449
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.3089 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.2179 | Train Acc: 0.9441
 Site-Clipart   | Train Loss: 0.3253 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2551 | Train Acc: 0.9304
 Site-Clipart   | Train Loss: 0.2380 | Train Acc: 0.9480
 Site-Real      | Train Loss: 0.1878 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0899 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.0833 | Train Acc: 0.9798
 Site-Real      | Train Loss: 0.1125 | Train Acc: 0.9799
 Site-Painting  | Train Loss: 0.3169 | Train Acc: 0.9388
 Site-Painting  | Train Loss: 0.2308 | Train Acc: 0.9272
 Site-Painting  | Train Loss: 0.2814 | Train Acc: 0.9308
 Site-Sketch    | Train Loss: 0.4203 | Train Acc: 0.8429
 Site-Sketch    | Train Loss: 0.4603 | Train Acc: 0.8951
 Site-QuickDraw | Train Loss: 1.0833 | Train Acc: 0.6239
 Site-Infograph | Train Loss: 1.3247 | Train Acc: 0.5556
 Site-Clipart   | Val  Loss: 0.1500 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2478 | Val  Acc: 0.9439
 Site-Clipart   | Val  Loss: 0.2859 | Val  Acc: 0.9400
 Site-Clipart   | Val  Loss: 0.2358 | Val  Acc: 0.9476
 Site-Clipart   | Val  Loss: 0.2916 | Val  Acc: 0.9288
 Site-Real      | Val  Loss: 0.1033 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0995 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0754 | Val  Acc: 0.9697
 Site-Real      | Val  Loss: 0.0990 | Val  Acc: 0.9784
 Site-Painting  | Val  Loss: 0.1834 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2441 | Val  Acc: 0.9051
 Site-Painting  | Val  Loss: 0.2647 | Val  Acc: 0.9115
 Site-Sketch    | Val  Loss: 0.2894 | Val  Acc: 0.9213
 Site-Sketch    | Val  Loss: 0.3913 | Val  Acc: 0.8764
 Site-QuickDraw | Val  Loss: 1.2042 | Val  Acc: 0.6514
 Site-Infograph | Val  Loss: 1.3788 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8994
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 0.3216 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.1954 | Train Acc: 0.9379
 Site-Clipart   | Train Loss: 0.2669 | Train Acc: 0.9378
 Site-Clipart   | Train Loss: 0.2450 | Train Acc: 0.9367
 Site-Clipart   | Train Loss: 0.2302 | Train Acc: 0.9434
 Site-Real      | Train Loss: 0.1651 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.1230 | Train Acc: 0.9605
 Site-Real      | Train Loss: 0.0859 | Train Acc: 0.9798
 Site-Real      | Train Loss: 0.1188 | Train Acc: 0.9770
 Site-Painting  | Train Loss: 0.2465 | Train Acc: 0.9320
 Site-Painting  | Train Loss: 0.2322 | Train Acc: 0.9417
 Site-Painting  | Train Loss: 0.2881 | Train Acc: 0.9308
 Site-Sketch    | Train Loss: 0.4363 | Train Acc: 0.8639
 Site-Sketch    | Train Loss: 0.3066 | Train Acc: 0.9176
 Site-QuickDraw | Train Loss: 1.0130 | Train Acc: 0.6391
 Site-Infograph | Train Loss: 1.3822 | Train Acc: 0.5342
 Site-Clipart   | Val  Loss: 0.1982 | Val  Acc: 0.9079
 Site-Clipart   | Val  Loss: 0.2385 | Val  Acc: 0.9252
 Site-Clipart   | Val  Loss: 0.2505 | Val  Acc: 0.9267
 Site-Clipart   | Val  Loss: 0.2464 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2944 | Val  Acc: 0.9322
 Site-Real      | Val  Loss: 0.0725 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.1187 | Val  Acc: 0.9746
 Site-Real      | Val  Loss: 0.0616 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0926 | Val  Acc: 0.9740
 Site-Painting  | Val  Loss: 0.1680 | Val  Acc: 0.9694
 Site-Painting  | Val  Loss: 0.2552 | Val  Acc: 0.9197
 Site-Painting  | Val  Loss: 0.2654 | Val  Acc: 0.9271
 Site-Sketch    | Val  Loss: 0.3080 | Val  Acc: 0.9370
 Site-Sketch    | Val  Loss: 0.4034 | Val  Acc: 0.8764
 Site-QuickDraw | Val  Loss: 1.1757 | Val  Acc: 0.6560
 Site-Infograph | Val  Loss: 1.3522 | Val  Acc: 0.5256
Average Valid Accuracy: 0.8977
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 0.3048 | Train Acc: 0.8870
 Site-Clipart   | Train Loss: 0.2592 | Train Acc: 0.9193
 Site-Clipart   | Train Loss: 0.3107 | Train Acc: 0.9022
 Site-Clipart   | Train Loss: 0.2495 | Train Acc: 0.9399
 Site-Clipart   | Train Loss: 0.2087 | Train Acc: 0.9570
 Site-Real      | Train Loss: 0.1900 | Train Acc: 0.9286
 Site-Real      | Train Loss: 0.1062 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.0811 | Train Acc: 0.9839
 Site-Real      | Train Loss: 0.1157 | Train Acc: 0.9799
 Site-Painting  | Train Loss: 0.2987 | Train Acc: 0.9184
 Site-Painting  | Train Loss: 0.2384 | Train Acc: 0.9175
 Site-Painting  | Train Loss: 0.2489 | Train Acc: 0.9377
 Site-Sketch    | Train Loss: 0.4382 | Train Acc: 0.8586
 Site-Sketch    | Train Loss: 0.3149 | Train Acc: 0.9064
 Site-QuickDraw | Train Loss: 1.1969 | Train Acc: 0.6269
 Site-Infograph | Train Loss: 1.3629 | Train Acc: 0.5342
 Site-Clipart   | Val  Loss: 0.1595 | Val  Acc: 0.9079
 Site-Clipart   | Val  Loss: 0.2676 | Val  Acc: 0.9252
 Site-Clipart   | Val  Loss: 0.2625 | Val  Acc: 0.9333
 Site-Clipart   | Val  Loss: 0.2500 | Val  Acc: 0.9333
 Site-Clipart   | Val  Loss: 0.2902 | Val  Acc: 0.9220
 Site-Real      | Val  Loss: 0.1015 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1055 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0672 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0842 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.1637 | Val  Acc: 0.9796
 Site-Painting  | Val  Loss: 0.2584 | Val  Acc: 0.9416
 Site-Painting  | Val  Loss: 0.2324 | Val  Acc: 0.9427
 Site-Sketch    | Val  Loss: 0.3160 | Val  Acc: 0.9134
 Site-Sketch    | Val  Loss: 0.4017 | Val  Acc: 0.8933
 Site-QuickDraw | Val  Loss: 1.1478 | Val  Acc: 0.6606
 Site-Infograph | Val  Loss: 1.2799 | Val  Acc: 0.5769
Average Valid Accuracy: 0.9033
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9079
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9252
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9333
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9333
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9220
 Best site-Real       | Epoch:21 | Val Acc: 0.9762
 Best site-Real       | Epoch:21 | Val Acc: 0.9831
 Best site-Real       | Epoch:21 | Val Acc: 0.9939
 Best site-Real       | Epoch:21 | Val Acc: 0.9697
 Best site-Painting   | Epoch:21 | Val Acc: 0.9796
 Best site-Painting   | Epoch:21 | Val Acc: 0.9416
 Best site-Painting   | Epoch:21 | Val Acc: 0.9427
 Best site-Sketch     | Epoch:21 | Val Acc: 0.9134
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8933
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.6606
 Best site-Infograph  | Epoch:21 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.3496 | Train Acc: 0.8783
 Site-Clipart   | Train Loss: 0.2765 | Train Acc: 0.9255
 Site-Clipart   | Train Loss: 0.2621 | Train Acc: 0.9289
 Site-Clipart   | Train Loss: 0.2472 | Train Acc: 0.9272
 Site-Clipart   | Train Loss: 0.2107 | Train Acc: 0.9502
 Site-Real      | Train Loss: 0.1771 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0753 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0734 | Train Acc: 0.9758
 Site-Real      | Train Loss: 0.1130 | Train Acc: 0.9684
 Site-Painting  | Train Loss: 0.3332 | Train Acc: 0.9320
 Site-Painting  | Train Loss: 0.2054 | Train Acc: 0.9515
 Site-Painting  | Train Loss: 0.2671 | Train Acc: 0.9308
 Site-Sketch    | Train Loss: 0.3777 | Train Acc: 0.8848
 Site-Sketch    | Train Loss: 0.3501 | Train Acc: 0.9288
 Site-QuickDraw | Train Loss: 1.1132 | Train Acc: 0.6116
 Site-Infograph | Train Loss: 1.3985 | Train Acc: 0.5171
 Site-Clipart   | Val  Loss: 0.1420 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2141 | Val  Acc: 0.9439
 Site-Clipart   | Val  Loss: 0.2705 | Val  Acc: 0.9267
 Site-Clipart   | Val  Loss: 0.2304 | Val  Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2884 | Val  Acc: 0.9186
 Site-Real      | Val  Loss: 0.0977 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1182 | Val  Acc: 0.9661
 Site-Real      | Val  Loss: 0.0665 | Val  Acc: 0.9879
 Site-Real      | Val  Loss: 0.0974 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.1966 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2538 | Val  Acc: 0.9197
 Site-Painting  | Val  Loss: 0.2546 | Val  Acc: 0.9427
 Site-Sketch    | Val  Loss: 0.2609 | Val  Acc: 0.9449
 Site-Sketch    | Val  Loss: 0.4166 | Val  Acc: 0.8652
 Site-QuickDraw | Val  Loss: 1.1028 | Val  Acc: 0.6376
 Site-Infograph | Val  Loss: 1.3484 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9024
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.3136 | Train Acc: 0.8957
 Site-Clipart   | Train Loss: 0.2104 | Train Acc: 0.9503
 Site-Clipart   | Train Loss: 0.2444 | Train Acc: 0.9422
 Site-Clipart   | Train Loss: 0.2433 | Train Acc: 0.9430
 Site-Clipart   | Train Loss: 0.2059 | Train Acc: 0.9480
 Site-Real      | Train Loss: 0.1758 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0997 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.0709 | Train Acc: 0.9798
 Site-Real      | Train Loss: 0.0937 | Train Acc: 0.9799
 Site-Painting  | Train Loss: 0.2133 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2210 | Train Acc: 0.9369
 Site-Painting  | Train Loss: 0.2523 | Train Acc: 0.9239
 Site-Sketch    | Train Loss: 0.4388 | Train Acc: 0.8272
 Site-Sketch    | Train Loss: 0.2970 | Train Acc: 0.9139
 Site-QuickDraw | Train Loss: 1.0512 | Train Acc: 0.6483
 Site-Infograph | Train Loss: 1.3765 | Train Acc: 0.5342
 Site-Clipart   | Val  Loss: 0.1423 | Val  Acc: 0.9342
 Site-Clipart   | Val  Loss: 0.2260 | Val  Acc: 0.9346
 Site-Clipart   | Val  Loss: 0.2297 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2190 | Val  Acc: 0.9476
 Site-Clipart   | Val  Loss: 0.2866 | Val  Acc: 0.9254
 Site-Real      | Val  Loss: 0.0797 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0914 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0535 | Val  Acc: 0.9879
 Site-Real      | Val  Loss: 0.0997 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.2032 | Val  Acc: 0.9388
 Site-Painting  | Val  Loss: 0.2787 | Val  Acc: 0.9197
 Site-Painting  | Val  Loss: 0.2194 | Val  Acc: 0.9479
 Site-Sketch    | Val  Loss: 0.2053 | Val  Acc: 0.9213
 Site-Sketch    | Val  Loss: 0.3462 | Val  Acc: 0.9101
 Site-QuickDraw | Val  Loss: 1.0733 | Val  Acc: 0.6927
 Site-Infograph | Val  Loss: 1.2855 | Val  Acc: 0.5769
Average Valid Accuracy: 0.9099
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9342
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9346
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9476
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9254
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Real       | Epoch:23 | Val Acc: 0.9915
 Best site-Real       | Epoch:23 | Val Acc: 0.9879
 Best site-Real       | Epoch:23 | Val Acc: 0.9697
 Best site-Painting   | Epoch:23 | Val Acc: 0.9388
 Best site-Painting   | Epoch:23 | Val Acc: 0.9197
 Best site-Painting   | Epoch:23 | Val Acc: 0.9479
 Best site-Sketch     | Epoch:23 | Val Acc: 0.9213
 Best site-Sketch     | Epoch:23 | Val Acc: 0.9101
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.6927
 Best site-Infograph  | Epoch:23 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.2880 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.2118 | Train Acc: 0.9255
 Site-Clipart   | Train Loss: 0.2338 | Train Acc: 0.9511
 Site-Clipart   | Train Loss: 0.2225 | Train Acc: 0.9462
 Site-Clipart   | Train Loss: 0.2131 | Train Acc: 0.9548
 Site-Real      | Train Loss: 0.2018 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0823 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.0767 | Train Acc: 0.9839
 Site-Real      | Train Loss: 0.0894 | Train Acc: 0.9828
 Site-Painting  | Train Loss: 0.2490 | Train Acc: 0.9320
 Site-Painting  | Train Loss: 0.2187 | Train Acc: 0.9466
 Site-Painting  | Train Loss: 0.2723 | Train Acc: 0.9343
 Site-Sketch    | Train Loss: 0.3886 | Train Acc: 0.8691
 Site-Sketch    | Train Loss: 0.3119 | Train Acc: 0.9064
 Site-QuickDraw | Train Loss: 1.0592 | Train Acc: 0.6391
 Site-Infograph | Train Loss: 1.3902 | Train Acc: 0.5214
 Site-Clipart   | Val  Loss: 0.1584 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.1990 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1982 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.2152 | Val  Acc: 0.9476
 Site-Clipart   | Val  Loss: 0.2988 | Val  Acc: 0.9322
 Site-Real      | Val  Loss: 0.0680 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0800 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0473 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0814 | Val  Acc: 0.9740
 Site-Painting  | Val  Loss: 0.1869 | Val  Acc: 0.9388
 Site-Painting  | Val  Loss: 0.2177 | Val  Acc: 0.9343
 Site-Painting  | Val  Loss: 0.2612 | Val  Acc: 0.9115
 Site-Sketch    | Val  Loss: 0.2476 | Val  Acc: 0.9449
 Site-Sketch    | Val  Loss: 0.3581 | Val  Acc: 0.8820
 Site-QuickDraw | Val  Loss: 1.0543 | Val  Acc: 0.6743
 Site-Infograph | Val  Loss: 1.3174 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9060
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.2456 | Train Acc: 0.9478
 Site-Clipart   | Train Loss: 0.2061 | Train Acc: 0.9565
 Site-Clipart   | Train Loss: 0.2821 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.2323 | Train Acc: 0.9557
 Site-Clipart   | Train Loss: 0.1837 | Train Acc: 0.9615
 Site-Real      | Train Loss: 0.1683 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0739 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0777 | Train Acc: 0.9839
 Site-Real      | Train Loss: 0.0760 | Train Acc: 0.9914
 Site-Painting  | Train Loss: 0.2706 | Train Acc: 0.9592
 Site-Painting  | Train Loss: 0.1738 | Train Acc: 0.9466
 Site-Painting  | Train Loss: 0.2801 | Train Acc: 0.9343
 Site-Sketch    | Train Loss: 0.3791 | Train Acc: 0.8743
 Site-Sketch    | Train Loss: 0.3055 | Train Acc: 0.8989
 Site-QuickDraw | Train Loss: 1.0184 | Train Acc: 0.6850
 Site-Infograph | Train Loss: 1.3038 | Train Acc: 0.5427
 Site-Clipart   | Val  Loss: 0.1309 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2303 | Val  Acc: 0.9626
 Site-Clipart   | Val  Loss: 0.2186 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.2334 | Val  Acc: 0.9476
 Site-Clipart   | Val  Loss: 0.3022 | Val  Acc: 0.9322
 Site-Real      | Val  Loss: 0.0836 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0759 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0636 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0873 | Val  Acc: 0.9697
 Site-Painting  | Val  Loss: 0.1603 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2501 | Val  Acc: 0.9124
 Site-Painting  | Val  Loss: 0.2398 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2776 | Val  Acc: 0.9213
 Site-Sketch    | Val  Loss: 0.3273 | Val  Acc: 0.8989
 Site-QuickDraw | Val  Loss: 1.0760 | Val  Acc: 0.6651
 Site-Infograph | Val  Loss: 1.2542 | Val  Acc: 0.5769
Average Valid Accuracy: 0.9097
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.2687 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.2190 | Train Acc: 0.9565
 Site-Clipart   | Train Loss: 0.2823 | Train Acc: 0.9244
 Site-Clipart   | Train Loss: 0.2619 | Train Acc: 0.9430
 Site-Clipart   | Train Loss: 0.1868 | Train Acc: 0.9593
 Site-Real      | Train Loss: 0.1727 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0884 | Train Acc: 0.9831
 Site-Real      | Train Loss: 0.0692 | Train Acc: 0.9839
 Site-Real      | Train Loss: 0.0723 | Train Acc: 0.9885
 Site-Painting  | Train Loss: 0.2608 | Train Acc: 0.9388
 Site-Painting  | Train Loss: 0.1888 | Train Acc: 0.9466
 Site-Painting  | Train Loss: 0.2569 | Train Acc: 0.9343
 Site-Sketch    | Train Loss: 0.3914 | Train Acc: 0.8639
 Site-Sketch    | Train Loss: 0.3065 | Train Acc: 0.9064
 Site-QuickDraw | Train Loss: 1.0806 | Train Acc: 0.6330
 Site-Infograph | Train Loss: 1.3304 | Train Acc: 0.5598
 Site-Clipart   | Val  Loss: 0.1099 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2053 | Val  Acc: 0.9439
 Site-Clipart   | Val  Loss: 0.2044 | Val  Acc: 0.9467
 Site-Clipart   | Val  Loss: 0.2149 | Val  Acc: 0.9333
 Site-Clipart   | Val  Loss: 0.2534 | Val  Acc: 0.9390
 Site-Real      | Val  Loss: 0.0757 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0732 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0470 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0789 | Val  Acc: 0.9784
 Site-Painting  | Val  Loss: 0.1792 | Val  Acc: 0.9388
 Site-Painting  | Val  Loss: 0.3077 | Val  Acc: 0.9051
 Site-Painting  | Val  Loss: 0.2222 | Val  Acc: 0.9271
 Site-Sketch    | Val  Loss: 0.2682 | Val  Acc: 0.9370
 Site-Sketch    | Val  Loss: 0.3388 | Val  Acc: 0.8820
 Site-QuickDraw | Val  Loss: 1.1153 | Val  Acc: 0.6697
 Site-Infograph | Val  Loss: 1.3170 | Val  Acc: 0.5513
Average Valid Accuracy: 0.9044
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.2305 | Train Acc: 0.9478
 Site-Clipart   | Train Loss: 0.2286 | Train Acc: 0.9317
 Site-Clipart   | Train Loss: 0.2264 | Train Acc: 0.9422
 Site-Clipart   | Train Loss: 0.2107 | Train Acc: 0.9462
 Site-Clipart   | Train Loss: 0.1862 | Train Acc: 0.9638
 Site-Real      | Train Loss: 0.1710 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0691 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.0650 | Train Acc: 0.9798
 Site-Real      | Train Loss: 0.0893 | Train Acc: 0.9828
 Site-Painting  | Train Loss: 0.2047 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2364 | Train Acc: 0.9369
 Site-Painting  | Train Loss: 0.2567 | Train Acc: 0.9273
 Site-Sketch    | Train Loss: 0.3810 | Train Acc: 0.8691
 Site-Sketch    | Train Loss: 0.2419 | Train Acc: 0.9064
 Site-QuickDraw | Train Loss: 1.0215 | Train Acc: 0.6575
 Site-Infograph | Train Loss: 1.3633 | Train Acc: 0.5470
 Site-Clipart   | Val  Loss: 0.1092 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2584 | Val  Acc: 0.9252
 Site-Clipart   | Val  Loss: 0.1899 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.1820 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2497 | Val  Acc: 0.9356
 Site-Real      | Val  Loss: 0.0798 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0918 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0667 | Val  Acc: 0.9879
 Site-Real      | Val  Loss: 0.0863 | Val  Acc: 0.9740
 Site-Painting  | Val  Loss: 0.1576 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2806 | Val  Acc: 0.8832
 Site-Painting  | Val  Loss: 0.2296 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.3079 | Val  Acc: 0.9055
 Site-Sketch    | Val  Loss: 0.3606 | Val  Acc: 0.8708
 Site-QuickDraw | Val  Loss: 1.0828 | Val  Acc: 0.7018
 Site-Infograph | Val  Loss: 1.2281 | Val  Acc: 0.6026
Average Valid Accuracy: 0.9071
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.2794 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.2018 | Train Acc: 0.9379
 Site-Clipart   | Train Loss: 0.2531 | Train Acc: 0.9378
 Site-Clipart   | Train Loss: 0.2318 | Train Acc: 0.9367
 Site-Clipart   | Train Loss: 0.1778 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.1610 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0691 | Train Acc: 0.9831
 Site-Real      | Train Loss: 0.0530 | Train Acc: 0.9960
 Site-Real      | Train Loss: 0.0784 | Train Acc: 0.9885
 Site-Painting  | Train Loss: 0.3302 | Train Acc: 0.9320
 Site-Painting  | Train Loss: 0.1816 | Train Acc: 0.9417
 Site-Painting  | Train Loss: 0.1959 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.3688 | Train Acc: 0.8743
 Site-Sketch    | Train Loss: 0.2430 | Train Acc: 0.9213
 Site-QuickDraw | Train Loss: 1.0317 | Train Acc: 0.6575
 Site-Infograph | Train Loss: 1.3590 | Train Acc: 0.5684
 Site-Clipart   | Val  Loss: 0.1114 | Val  Acc: 0.9605
 Site-Clipart   | Val  Loss: 0.2182 | Val  Acc: 0.9439
 Site-Clipart   | Val  Loss: 0.2061 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.2329 | Val  Acc: 0.9381
 Site-Clipart   | Val  Loss: 0.2830 | Val  Acc: 0.9220
 Site-Real      | Val  Loss: 0.0778 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0889 | Val  Acc: 0.9746
 Site-Real      | Val  Loss: 0.0599 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0794 | Val  Acc: 0.9740
 Site-Painting  | Val  Loss: 0.1580 | Val  Acc: 0.9490
 Site-Painting  | Val  Loss: 0.2750 | Val  Acc: 0.9124
 Site-Painting  | Val  Loss: 0.2383 | Val  Acc: 0.9219
 Site-Sketch    | Val  Loss: 0.2894 | Val  Acc: 0.9134
 Site-Sketch    | Val  Loss: 0.3142 | Val  Acc: 0.8989
 Site-QuickDraw | Val  Loss: 1.0744 | Val  Acc: 0.7064
 Site-Infograph | Val  Loss: 1.3188 | Val  Acc: 0.5705
Average Valid Accuracy: 0.9072
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.2871 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.1750 | Train Acc: 0.9441
 Site-Clipart   | Train Loss: 0.2600 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2306 | Train Acc: 0.9367
 Site-Clipart   | Train Loss: 0.1856 | Train Acc: 0.9593
 Site-Real      | Train Loss: 0.1940 | Train Acc: 0.9444
 Site-Real      | Train Loss: 0.0767 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.0595 | Train Acc: 0.9839
 Site-Real      | Train Loss: 0.0924 | Train Acc: 0.9741
 Site-Painting  | Train Loss: 0.2500 | Train Acc: 0.9388
 Site-Painting  | Train Loss: 0.2455 | Train Acc: 0.9466
 Site-Painting  | Train Loss: 0.1982 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.3656 | Train Acc: 0.8848
 Site-Sketch    | Train Loss: 0.2553 | Train Acc: 0.9251
 Site-QuickDraw | Train Loss: 0.9830 | Train Acc: 0.6758
 Site-Infograph | Train Loss: 1.3635 | Train Acc: 0.5342
 Site-Clipart   | Val  Loss: 0.1778 | Val  Acc: 0.9342
 Site-Clipart   | Val  Loss: 0.1959 | Val  Acc: 0.9439
 Site-Clipart   | Val  Loss: 0.1777 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2118 | Val  Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.2431 | Val  Acc: 0.9424
 Site-Real      | Val  Loss: 0.0662 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0563 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0528 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0759 | Val  Acc: 0.9784
 Site-Painting  | Val  Loss: 0.1705 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2484 | Val  Acc: 0.9197
 Site-Painting  | Val  Loss: 0.1986 | Val  Acc: 0.9531
 Site-Sketch    | Val  Loss: 0.2358 | Val  Acc: 0.9449
 Site-Sketch    | Val  Loss: 0.3015 | Val  Acc: 0.8933
 Site-QuickDraw | Val  Loss: 1.0518 | Val  Acc: 0.6881
 Site-Infograph | Val  Loss: 1.2557 | Val  Acc: 0.5769
Average Valid Accuracy: 0.9140
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9342
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9439
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9571
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9424
 Best site-Real       | Epoch:29 | Val Acc: 0.9881
 Best site-Real       | Epoch:29 | Val Acc: 0.9915
 Best site-Real       | Epoch:29 | Val Acc: 0.9939
 Best site-Real       | Epoch:29 | Val Acc: 0.9784
 Best site-Painting   | Epoch:29 | Val Acc: 0.9592
 Best site-Painting   | Epoch:29 | Val Acc: 0.9197
 Best site-Painting   | Epoch:29 | Val Acc: 0.9531
 Best site-Sketch     | Epoch:29 | Val Acc: 0.9449
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8933
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.6881
 Best site-Infograph  | Epoch:29 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.9392
 Test site-Real      | Epoch:29 | Test Acc: 0.9663
 Test site-Painting  | Epoch:29 | Test Acc: 0.9321
 Test site-Sketch    | Epoch:29 | Test Acc: 0.9097
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.6890
 Test site-Infograph | Epoch:29 | Test Acc: 0.5175
Average Test Accuracy: 0.8256
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.2485 | Train Acc: 0.9391
 Site-Clipart   | Train Loss: 0.1910 | Train Acc: 0.9317
 Site-Clipart   | Train Loss: 0.2458 | Train Acc: 0.9378
 Site-Clipart   | Train Loss: 0.2097 | Train Acc: 0.9557
 Site-Clipart   | Train Loss: 0.1690 | Train Acc: 0.9729
 Site-Real      | Train Loss: 0.1585 | Train Acc: 0.9444
 Site-Real      | Train Loss: 0.0826 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.0638 | Train Acc: 0.9839
 Site-Real      | Train Loss: 0.0761 | Train Acc: 0.9885
 Site-Painting  | Train Loss: 0.2064 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2294 | Train Acc: 0.9466
 Site-Painting  | Train Loss: 0.2424 | Train Acc: 0.9377
 Site-Sketch    | Train Loss: 0.3926 | Train Acc: 0.8534
 Site-Sketch    | Train Loss: 0.2077 | Train Acc: 0.9288
 Site-QuickDraw | Train Loss: 0.9482 | Train Acc: 0.6881
 Site-Infograph | Train Loss: 1.2866 | Train Acc: 0.5684
 Site-Clipart   | Val  Loss: 0.0984 | Val  Acc: 0.9605
 Site-Clipart   | Val  Loss: 0.1549 | Val  Acc: 0.9626
 Site-Clipart   | Val  Loss: 0.2081 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.2168 | Val  Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2538 | Val  Acc: 0.9390
 Site-Real      | Val  Loss: 0.0608 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0774 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0571 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0786 | Val  Acc: 0.9740
 Site-Painting  | Val  Loss: 0.1396 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2501 | Val  Acc: 0.9343
 Site-Painting  | Val  Loss: 0.1993 | Val  Acc: 0.9531
 Site-Sketch    | Val  Loss: 0.2378 | Val  Acc: 0.9370
 Site-Sketch    | Val  Loss: 0.2484 | Val  Acc: 0.9213
 Site-QuickDraw | Val  Loss: 1.0558 | Val  Acc: 0.7339
 Site-Infograph | Val  Loss: 1.2617 | Val  Acc: 0.5962
Average Valid Accuracy: 0.9212
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9605
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9626
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9533
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9429
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9390
 Best site-Real       | Epoch:30 | Val Acc: 0.9881
 Best site-Real       | Epoch:30 | Val Acc: 0.9831
 Best site-Real       | Epoch:30 | Val Acc: 1.0000
 Best site-Real       | Epoch:30 | Val Acc: 0.9740
 Best site-Painting   | Epoch:30 | Val Acc: 0.9592
 Best site-Painting   | Epoch:30 | Val Acc: 0.9343
 Best site-Painting   | Epoch:30 | Val Acc: 0.9531
 Best site-Sketch     | Epoch:30 | Val Acc: 0.9370
 Best site-Sketch     | Epoch:30 | Val Acc: 0.9213
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.7339
 Best site-Infograph  | Epoch:30 | Val Acc: 0.5962
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.2757 | Train Acc: 0.9304
 Site-Clipart   | Train Loss: 0.2006 | Train Acc: 0.9565
 Site-Clipart   | Train Loss: 0.2237 | Train Acc: 0.9467
 Site-Clipart   | Train Loss: 0.1972 | Train Acc: 0.9589
 Site-Clipart   | Train Loss: 0.1605 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.1637 | Train Acc: 0.9444
 Site-Real      | Train Loss: 0.0925 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0703 | Train Acc: 0.9879
 Site-Real      | Train Loss: 0.0790 | Train Acc: 0.9856
 Site-Painting  | Train Loss: 0.2799 | Train Acc: 0.9252
 Site-Painting  | Train Loss: 0.1765 | Train Acc: 0.9320
 Site-Painting  | Train Loss: 0.2180 | Train Acc: 0.9446
 Site-Sketch    | Train Loss: 0.3822 | Train Acc: 0.8743
 Site-Sketch    | Train Loss: 0.2848 | Train Acc: 0.9363
 Site-QuickDraw | Train Loss: 0.8848 | Train Acc: 0.6850
 Site-Infograph | Train Loss: 1.3045 | Train Acc: 0.5556
 Site-Clipart   | Val  Loss: 0.1114 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1798 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1959 | Val  Acc: 0.9400
 Site-Clipart   | Val  Loss: 0.2176 | Val  Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2611 | Val  Acc: 0.9356
 Site-Real      | Val  Loss: 0.0547 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0751 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0514 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0848 | Val  Acc: 0.9784
 Site-Painting  | Val  Loss: 0.1231 | Val  Acc: 0.9694
 Site-Painting  | Val  Loss: 0.2458 | Val  Acc: 0.9124
 Site-Painting  | Val  Loss: 0.2370 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2505 | Val  Acc: 0.9291
 Site-Sketch    | Val  Loss: 0.2981 | Val  Acc: 0.9045
 Site-QuickDraw | Val  Loss: 1.0173 | Val  Acc: 0.7156
 Site-Infograph | Val  Loss: 1.2869 | Val  Acc: 0.5769
Average Valid Accuracy: 0.9134
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.2661 | Train Acc: 0.9304
 Site-Clipart   | Train Loss: 0.1705 | Train Acc: 0.9565
 Site-Clipart   | Train Loss: 0.2893 | Train Acc: 0.9244
 Site-Clipart   | Train Loss: 0.1933 | Train Acc: 0.9652
 Site-Clipart   | Train Loss: 0.1640 | Train Acc: 0.9570
 Site-Real      | Train Loss: 0.1400 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0608 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0591 | Train Acc: 0.9798
 Site-Real      | Train Loss: 0.0662 | Train Acc: 0.9885
 Site-Painting  | Train Loss: 0.2124 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2587 | Train Acc: 0.9417
 Site-Painting  | Train Loss: 0.1924 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.3794 | Train Acc: 0.8586
 Site-Sketch    | Train Loss: 0.2705 | Train Acc: 0.9288
 Site-QuickDraw | Train Loss: 0.9343 | Train Acc: 0.7125
 Site-Infograph | Train Loss: 1.3626 | Train Acc: 0.5171
 Site-Clipart   | Val  Loss: 0.1047 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1888 | Val  Acc: 0.9439
 Site-Clipart   | Val  Loss: 0.2014 | Val  Acc: 0.9467
 Site-Clipart   | Val  Loss: 0.1985 | Val  Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2158 | Val  Acc: 0.9559
 Site-Real      | Val  Loss: 0.0954 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.0841 | Val  Acc: 0.9831
 Site-Real      | Val  Loss: 0.0583 | Val  Acc: 0.9879
 Site-Real      | Val  Loss: 0.0820 | Val  Acc: 0.9784
 Site-Painting  | Val  Loss: 0.1806 | Val  Acc: 0.9490
 Site-Painting  | Val  Loss: 0.2275 | Val  Acc: 0.9124
 Site-Painting  | Val  Loss: 0.2190 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2469 | Val  Acc: 0.9449
 Site-Sketch    | Val  Loss: 0.3823 | Val  Acc: 0.8764
 Site-QuickDraw | Val  Loss: 1.0414 | Val  Acc: 0.6881
 Site-Infograph | Val  Loss: 1.2985 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9069
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.2755 | Train Acc: 0.9304
 Site-Clipart   | Train Loss: 0.1932 | Train Acc: 0.9379
 Site-Clipart   | Train Loss: 0.2595 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.1938 | Train Acc: 0.9557
 Site-Clipart   | Train Loss: 0.1765 | Train Acc: 0.9638
 Site-Real      | Train Loss: 0.1612 | Train Acc: 0.9444
 Site-Real      | Train Loss: 0.0707 | Train Acc: 0.9831
 Site-Real      | Train Loss: 0.0624 | Train Acc: 0.9879
 Site-Real      | Train Loss: 0.0798 | Train Acc: 0.9799
 Site-Painting  | Train Loss: 0.2258 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.1949 | Train Acc: 0.9369
 Site-Painting  | Train Loss: 0.1826 | Train Acc: 0.9516
 Site-Sketch    | Train Loss: 0.3765 | Train Acc: 0.8848
 Site-Sketch    | Train Loss: 0.2313 | Train Acc: 0.9176
 Site-QuickDraw | Train Loss: 0.8227 | Train Acc: 0.6850
 Site-Infograph | Train Loss: 1.2837 | Train Acc: 0.5684
 Site-Clipart   | Val  Loss: 0.1070 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1929 | Val  Acc: 0.9439
 Site-Clipart   | Val  Loss: 0.1968 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1591 | Val  Acc: 0.9619
 Site-Clipart   | Val  Loss: 0.2228 | Val  Acc: 0.9492
 Site-Real      | Val  Loss: 0.0431 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0573 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0486 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0656 | Val  Acc: 0.9870
 Site-Painting  | Val  Loss: 0.1301 | Val  Acc: 0.9796
 Site-Painting  | Val  Loss: 0.2504 | Val  Acc: 0.9270
 Site-Painting  | Val  Loss: 0.2292 | Val  Acc: 0.9219
 Site-Sketch    | Val  Loss: 0.2221 | Val  Acc: 0.9370
 Site-Sketch    | Val  Loss: 0.3227 | Val  Acc: 0.8933
 Site-QuickDraw | Val  Loss: 1.0510 | Val  Acc: 0.7018
 Site-Infograph | Val  Loss: 1.3040 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9151
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.2639 | Train Acc: 0.9043
 Site-Clipart   | Train Loss: 0.1688 | Train Acc: 0.9503
 Site-Clipart   | Train Loss: 0.2885 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.1984 | Train Acc: 0.9494
 Site-Clipart   | Train Loss: 0.1577 | Train Acc: 0.9638
 Site-Real      | Train Loss: 0.1741 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0707 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0500 | Train Acc: 0.9919
 Site-Real      | Train Loss: 0.0716 | Train Acc: 0.9856
 Site-Painting  | Train Loss: 0.2316 | Train Acc: 0.9320
 Site-Painting  | Train Loss: 0.1753 | Train Acc: 0.9417
 Site-Painting  | Train Loss: 0.2324 | Train Acc: 0.9377
 Site-Sketch    | Train Loss: 0.4125 | Train Acc: 0.8691
 Site-Sketch    | Train Loss: 0.2270 | Train Acc: 0.9213
 Site-QuickDraw | Train Loss: 0.8676 | Train Acc: 0.6972
 Site-Infograph | Train Loss: 1.2715 | Train Acc: 0.5513
 Site-Clipart   | Val  Loss: 0.0886 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.1934 | Val  Acc: 0.9626
 Site-Clipart   | Val  Loss: 0.1882 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1601 | Val  Acc: 0.9667
 Site-Clipart   | Val  Loss: 0.2257 | Val  Acc: 0.9424
 Site-Real      | Val  Loss: 0.0570 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0537 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0571 | Val  Acc: 0.9879
 Site-Real      | Val  Loss: 0.0557 | Val  Acc: 0.9827
 Site-Painting  | Val  Loss: 0.1482 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2461 | Val  Acc: 0.9270
 Site-Painting  | Val  Loss: 0.2430 | Val  Acc: 0.9271
 Site-Sketch    | Val  Loss: 0.2149 | Val  Acc: 0.9449
 Site-Sketch    | Val  Loss: 0.3469 | Val  Acc: 0.8989
 Site-QuickDraw | Val  Loss: 1.0235 | Val  Acc: 0.6972
 Site-Infograph | Val  Loss: 1.2860 | Val  Acc: 0.6026
Average Valid Accuracy: 0.9191
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.2150 | Train Acc: 0.9478
 Site-Clipart   | Train Loss: 0.1964 | Train Acc: 0.9379
 Site-Clipart   | Train Loss: 0.2101 | Train Acc: 0.9378
 Site-Clipart   | Train Loss: 0.1727 | Train Acc: 0.9652
 Site-Clipart   | Train Loss: 0.1444 | Train Acc: 0.9706
 Site-Real      | Train Loss: 0.1444 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0677 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0474 | Train Acc: 0.9919
 Site-Real      | Train Loss: 0.0687 | Train Acc: 0.9828
 Site-Painting  | Train Loss: 0.1848 | Train Acc: 0.9456
 Site-Painting  | Train Loss: 0.2249 | Train Acc: 0.9369
 Site-Painting  | Train Loss: 0.1721 | Train Acc: 0.9654
 Site-Sketch    | Train Loss: 0.3893 | Train Acc: 0.8534
 Site-Sketch    | Train Loss: 0.2397 | Train Acc: 0.9176
 Site-QuickDraw | Train Loss: 0.8572 | Train Acc: 0.7003
 Site-Infograph | Train Loss: 1.3153 | Train Acc: 0.5684
 Site-Clipart   | Val  Loss: 0.0845 | Val  Acc: 0.9605
 Site-Clipart   | Val  Loss: 0.1840 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.2296 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1945 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2206 | Val  Acc: 0.9492
 Site-Real      | Val  Loss: 0.0464 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0665 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0532 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0598 | Val  Acc: 0.9870
 Site-Painting  | Val  Loss: 0.1311 | Val  Acc: 0.9694
 Site-Painting  | Val  Loss: 0.2456 | Val  Acc: 0.9124
 Site-Painting  | Val  Loss: 0.1959 | Val  Acc: 0.9479
 Site-Sketch    | Val  Loss: 0.2132 | Val  Acc: 0.9449
 Site-Sketch    | Val  Loss: 0.3628 | Val  Acc: 0.8820
 Site-QuickDraw | Val  Loss: 1.0140 | Val  Acc: 0.7110
 Site-Infograph | Val  Loss: 1.2801 | Val  Acc: 0.5833
Average Valid Accuracy: 0.9175
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.2683 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.1547 | Train Acc: 0.9627
 Site-Clipart   | Train Loss: 0.2274 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.1788 | Train Acc: 0.9557
 Site-Clipart   | Train Loss: 0.1600 | Train Acc: 0.9615
 Site-Real      | Train Loss: 0.1358 | Train Acc: 0.9762
 Site-Real      | Train Loss: 0.0722 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.0604 | Train Acc: 0.9798
 Site-Real      | Train Loss: 0.0588 | Train Acc: 0.9914
 Site-Painting  | Train Loss: 0.2256 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.1918 | Train Acc: 0.9515
 Site-Painting  | Train Loss: 0.1941 | Train Acc: 0.9412
 Site-Sketch    | Train Loss: 0.3350 | Train Acc: 0.8901
 Site-Sketch    | Train Loss: 0.2183 | Train Acc: 0.9213
 Site-QuickDraw | Train Loss: 0.8867 | Train Acc: 0.7125
 Site-Infograph | Train Loss: 1.2975 | Train Acc: 0.5299
 Site-Clipart   | Val  Loss: 0.0889 | Val  Acc: 0.9605
 Site-Clipart   | Val  Loss: 0.1841 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1582 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1889 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2311 | Val  Acc: 0.9390
 Site-Real      | Val  Loss: 0.0397 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0463 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0425 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0707 | Val  Acc: 0.9740
 Site-Painting  | Val  Loss: 0.0956 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2607 | Val  Acc: 0.9343
 Site-Painting  | Val  Loss: 0.2102 | Val  Acc: 0.9427
 Site-Sketch    | Val  Loss: 0.2664 | Val  Acc: 0.9213
 Site-Sketch    | Val  Loss: 0.3123 | Val  Acc: 0.9101
 Site-QuickDraw | Val  Loss: 1.0456 | Val  Acc: 0.7110
 Site-Infograph | Val  Loss: 1.2548 | Val  Acc: 0.6026
Average Valid Accuracy: 0.9216
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9605
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9533
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9533
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9390
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Real       | Epoch:36 | Val Acc: 0.9915
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Real       | Epoch:36 | Val Acc: 0.9740
 Best site-Painting   | Epoch:36 | Val Acc: 1.0000
 Best site-Painting   | Epoch:36 | Val Acc: 0.9343
 Best site-Painting   | Epoch:36 | Val Acc: 0.9427
 Best site-Sketch     | Epoch:36 | Val Acc: 0.9213
 Best site-Sketch     | Epoch:36 | Val Acc: 0.9101
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.7110
 Best site-Infograph  | Epoch:36 | Val Acc: 0.6026
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.1984 | Train Acc: 0.9478
 Site-Clipart   | Train Loss: 0.1646 | Train Acc: 0.9752
 Site-Clipart   | Train Loss: 0.2506 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.1848 | Train Acc: 0.9684
 Site-Clipart   | Train Loss: 0.1511 | Train Acc: 0.9638
 Site-Real      | Train Loss: 0.1535 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0863 | Train Acc: 0.9661
 Site-Real      | Train Loss: 0.0533 | Train Acc: 0.9919
 Site-Real      | Train Loss: 0.0618 | Train Acc: 0.9943
 Site-Painting  | Train Loss: 0.2398 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2162 | Train Acc: 0.9466
 Site-Painting  | Train Loss: 0.1971 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.3437 | Train Acc: 0.8901
 Site-Sketch    | Train Loss: 0.2459 | Train Acc: 0.9326
 Site-QuickDraw | Train Loss: 0.8072 | Train Acc: 0.7217
 Site-Infograph | Train Loss: 1.2915 | Train Acc: 0.5598
 Site-Clipart   | Val  Loss: 0.1308 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1691 | Val  Acc: 0.9626
 Site-Clipart   | Val  Loss: 0.2199 | Val  Acc: 0.9400
 Site-Clipart   | Val  Loss: 0.1747 | Val  Acc: 0.9667
 Site-Clipart   | Val  Loss: 0.2178 | Val  Acc: 0.9458
 Site-Real      | Val  Loss: 0.0376 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0571 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0550 | Val  Acc: 0.9879
 Site-Real      | Val  Loss: 0.0645 | Val  Acc: 0.9870
 Site-Painting  | Val  Loss: 0.1283 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2160 | Val  Acc: 0.9489
 Site-Painting  | Val  Loss: 0.1916 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2035 | Val  Acc: 0.9291
 Site-Sketch    | Val  Loss: 0.2637 | Val  Acc: 0.9270
 Site-QuickDraw | Val  Loss: 1.0451 | Val  Acc: 0.6835
 Site-Infograph | Val  Loss: 1.2895 | Val  Acc: 0.6026
Average Valid Accuracy: 0.9198
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.2056 | Train Acc: 0.9478
 Site-Clipart   | Train Loss: 0.2055 | Train Acc: 0.9317
 Site-Clipart   | Train Loss: 0.2405 | Train Acc: 0.9511
 Site-Clipart   | Train Loss: 0.1883 | Train Acc: 0.9620
 Site-Clipart   | Train Loss: 0.1528 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1315 | Train Acc: 0.9762
 Site-Real      | Train Loss: 0.0805 | Train Acc: 0.9831
 Site-Real      | Train Loss: 0.0458 | Train Acc: 0.9960
 Site-Real      | Train Loss: 0.0686 | Train Acc: 0.9799
 Site-Painting  | Train Loss: 0.1607 | Train Acc: 0.9592
 Site-Painting  | Train Loss: 0.2459 | Train Acc: 0.9369
 Site-Painting  | Train Loss: 0.1785 | Train Acc: 0.9550
 Site-Sketch    | Train Loss: 0.2894 | Train Acc: 0.8953
 Site-Sketch    | Train Loss: 0.2289 | Train Acc: 0.9213
 Site-QuickDraw | Train Loss: 0.8390 | Train Acc: 0.7156
 Site-Infograph | Train Loss: 1.2953 | Train Acc: 0.5769
 Site-Clipart   | Val  Loss: 0.0920 | Val  Acc: 0.9605
 Site-Clipart   | Val  Loss: 0.1625 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1998 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1728 | Val  Acc: 0.9476
 Site-Clipart   | Val  Loss: 0.2260 | Val  Acc: 0.9559
 Site-Real      | Val  Loss: 0.0493 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0557 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0342 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0640 | Val  Acc: 0.9827
 Site-Painting  | Val  Loss: 0.1116 | Val  Acc: 0.9796
 Site-Painting  | Val  Loss: 0.2172 | Val  Acc: 0.9562
 Site-Painting  | Val  Loss: 0.2094 | Val  Acc: 0.9427
 Site-Sketch    | Val  Loss: 0.2158 | Val  Acc: 0.9370
 Site-Sketch    | Val  Loss: 0.3046 | Val  Acc: 0.8989
 Site-QuickDraw | Val  Loss: 0.9602 | Val  Acc: 0.7339
 Site-Infograph | Val  Loss: 1.2428 | Val  Acc: 0.5833
Average Valid Accuracy: 0.9224
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9605
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9533
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9533
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9476
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9559
 Best site-Real       | Epoch:38 | Val Acc: 0.9881
 Best site-Real       | Epoch:38 | Val Acc: 0.9915
 Best site-Real       | Epoch:38 | Val Acc: 0.9939
 Best site-Real       | Epoch:38 | Val Acc: 0.9827
 Best site-Painting   | Epoch:38 | Val Acc: 0.9796
 Best site-Painting   | Epoch:38 | Val Acc: 0.9562
 Best site-Painting   | Epoch:38 | Val Acc: 0.9427
 Best site-Sketch     | Epoch:38 | Val Acc: 0.9370
 Best site-Sketch     | Epoch:38 | Val Acc: 0.8989
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.7339
 Best site-Infograph  | Epoch:38 | Val Acc: 0.5833
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.2554 | Train Acc: 0.9304
 Site-Clipart   | Train Loss: 0.1573 | Train Acc: 0.9503
 Site-Clipart   | Train Loss: 0.2258 | Train Acc: 0.9422
 Site-Clipart   | Train Loss: 0.1735 | Train Acc: 0.9557
 Site-Clipart   | Train Loss: 0.1417 | Train Acc: 0.9729
 Site-Real      | Train Loss: 0.1392 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0597 | Train Acc: 0.9887
 Site-Real      | Train Loss: 0.0428 | Train Acc: 0.9919
 Site-Real      | Train Loss: 0.0603 | Train Acc: 0.9856
 Site-Painting  | Train Loss: 0.1295 | Train Acc: 0.9660
 Site-Painting  | Train Loss: 0.1679 | Train Acc: 0.9466
 Site-Painting  | Train Loss: 0.2146 | Train Acc: 0.9412
 Site-Sketch    | Train Loss: 0.3571 | Train Acc: 0.8586
 Site-Sketch    | Train Loss: 0.2309 | Train Acc: 0.9251
 Site-QuickDraw | Train Loss: 0.8838 | Train Acc: 0.6972
 Site-Infograph | Train Loss: 1.3568 | Train Acc: 0.5684
 Site-Clipart   | Val  Loss: 0.1030 | Val  Acc: 0.9605
 Site-Clipart   | Val  Loss: 0.1384 | Val  Acc: 0.9720
 Site-Clipart   | Val  Loss: 0.1732 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.1622 | Val  Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.2094 | Val  Acc: 0.9525
 Site-Real      | Val  Loss: 0.0445 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0395 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0450 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0776 | Val  Acc: 0.9740
 Site-Painting  | Val  Loss: 0.1464 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2070 | Val  Acc: 0.9489
 Site-Painting  | Val  Loss: 0.1846 | Val  Acc: 0.9479
 Site-Sketch    | Val  Loss: 0.2278 | Val  Acc: 0.9449
 Site-Sketch    | Val  Loss: 0.3100 | Val  Acc: 0.9213
 Site-QuickDraw | Val  Loss: 0.9408 | Val  Acc: 0.7294
 Site-Infograph | Val  Loss: 1.2948 | Val  Acc: 0.5962
Average Valid Accuracy: 0.9256
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9605
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9720
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9571
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9525
 Best site-Real       | Epoch:39 | Val Acc: 1.0000
 Best site-Real       | Epoch:39 | Val Acc: 0.9915
 Best site-Real       | Epoch:39 | Val Acc: 0.9939
 Best site-Real       | Epoch:39 | Val Acc: 0.9740
 Best site-Painting   | Epoch:39 | Val Acc: 0.9592
 Best site-Painting   | Epoch:39 | Val Acc: 0.9489
 Best site-Painting   | Epoch:39 | Val Acc: 0.9479
 Best site-Sketch     | Epoch:39 | Val Acc: 0.9449
 Best site-Sketch     | Epoch:39 | Val Acc: 0.9213
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.7294
 Best site-Infograph  | Epoch:39 | Val Acc: 0.5962
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.9316
 Test site-Real      | Epoch:39 | Test Acc: 0.9671
 Test site-Painting  | Epoch:39 | Test Acc: 0.9289
 Test site-Sketch    | Epoch:39 | Test Acc: 0.9043
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.6930
 Test site-Infograph | Epoch:39 | Test Acc: 0.5099
Average Test Accuracy: 0.8225
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.1715 | Train Acc: 0.9391
 Site-Clipart   | Train Loss: 0.1764 | Train Acc: 0.9627
 Site-Clipart   | Train Loss: 0.2204 | Train Acc: 0.9422
 Site-Clipart   | Train Loss: 0.1750 | Train Acc: 0.9589
 Site-Clipart   | Train Loss: 0.1493 | Train Acc: 0.9615
 Site-Real      | Train Loss: 0.1697 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0623 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0591 | Train Acc: 0.9879
 Site-Real      | Train Loss: 0.0482 | Train Acc: 0.9856
 Site-Painting  | Train Loss: 0.2932 | Train Acc: 0.9456
 Site-Painting  | Train Loss: 0.1737 | Train Acc: 0.9466
 Site-Painting  | Train Loss: 0.1908 | Train Acc: 0.9377
 Site-Sketch    | Train Loss: 0.3458 | Train Acc: 0.8639
 Site-Sketch    | Train Loss: 0.2531 | Train Acc: 0.9139
 Site-QuickDraw | Train Loss: 0.8742 | Train Acc: 0.7125
 Site-Infograph | Train Loss: 1.2626 | Train Acc: 0.5983
 Site-Clipart   | Val  Loss: 0.0730 | Val  Acc: 0.9868
 Site-Clipart   | Val  Loss: 0.1197 | Val  Acc: 0.9813
 Site-Clipart   | Val  Loss: 0.1384 | Val  Acc: 0.9733
 Site-Clipart   | Val  Loss: 0.1676 | Val  Acc: 0.9667
 Site-Clipart   | Val  Loss: 0.2451 | Val  Acc: 0.9390
 Site-Real      | Val  Loss: 0.0504 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0614 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0411 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0667 | Val  Acc: 0.9827
 Site-Painting  | Val  Loss: 0.0983 | Val  Acc: 0.9898
 Site-Painting  | Val  Loss: 0.2215 | Val  Acc: 0.9343
 Site-Painting  | Val  Loss: 0.1886 | Val  Acc: 0.9323
 Site-Sketch    | Val  Loss: 0.2126 | Val  Acc: 0.9528
 Site-Sketch    | Val  Loss: 0.2828 | Val  Acc: 0.8820
 Site-QuickDraw | Val  Loss: 0.9704 | Val  Acc: 0.7294
 Site-Infograph | Val  Loss: 1.2714 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9286
 Best site-Clipart    | Epoch:40 | Val Acc: 0.9868
 Best site-Clipart    | Epoch:40 | Val Acc: 0.9813
 Best site-Clipart    | Epoch:40 | Val Acc: 0.9733
 Best site-Clipart    | Epoch:40 | Val Acc: 0.9667
 Best site-Clipart    | Epoch:40 | Val Acc: 0.9390
 Best site-Real       | Epoch:40 | Val Acc: 1.0000
 Best site-Real       | Epoch:40 | Val Acc: 0.9915
 Best site-Real       | Epoch:40 | Val Acc: 1.0000
 Best site-Real       | Epoch:40 | Val Acc: 0.9827
 Best site-Painting   | Epoch:40 | Val Acc: 0.9898
 Best site-Painting   | Epoch:40 | Val Acc: 0.9343
 Best site-Painting   | Epoch:40 | Val Acc: 0.9323
 Best site-Sketch     | Epoch:40 | Val Acc: 0.9528
 Best site-Sketch     | Epoch:40 | Val Acc: 0.8820
 Best site-QuickDraw  | Epoch:40 | Val Acc: 0.7294
 Best site-Infograph  | Epoch:40 | Val Acc: 0.6154
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.2825 | Train Acc: 0.9304
 Site-Clipart   | Train Loss: 0.2181 | Train Acc: 0.9317
 Site-Clipart   | Train Loss: 0.2513 | Train Acc: 0.9289
 Site-Clipart   | Train Loss: 0.1737 | Train Acc: 0.9557
 Site-Clipart   | Train Loss: 0.1418 | Train Acc: 0.9706
 Site-Real      | Train Loss: 0.1497 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0762 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0426 | Train Acc: 0.9879
 Site-Real      | Train Loss: 0.0541 | Train Acc: 0.9971
 Site-Painting  | Train Loss: 0.2378 | Train Acc: 0.9320
 Site-Painting  | Train Loss: 0.1906 | Train Acc: 0.9563
 Site-Painting  | Train Loss: 0.1620 | Train Acc: 0.9689
 Site-Sketch    | Train Loss: 0.3749 | Train Acc: 0.8639
 Site-Sketch    | Train Loss: 0.2050 | Train Acc: 0.9288
 Site-QuickDraw | Train Loss: 0.9150 | Train Acc: 0.7034
 Site-Infograph | Train Loss: 1.3000 | Train Acc: 0.5812
 Site-Clipart   | Val  Loss: 0.0953 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.1380 | Val  Acc: 0.9626
 Site-Clipart   | Val  Loss: 0.1954 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.1726 | Val  Acc: 0.9476
 Site-Clipart   | Val  Loss: 0.2397 | Val  Acc: 0.9458
 Site-Real      | Val  Loss: 0.0490 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0585 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0409 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0563 | Val  Acc: 0.9870
 Site-Painting  | Val  Loss: 0.1303 | Val  Acc: 0.9796
 Site-Painting  | Val  Loss: 0.1886 | Val  Acc: 0.9489
 Site-Painting  | Val  Loss: 0.1686 | Val  Acc: 0.9583
 Site-Sketch    | Val  Loss: 0.2402 | Val  Acc: 0.9291
 Site-Sketch    | Val  Loss: 0.3380 | Val  Acc: 0.8933
 Site-QuickDraw | Val  Loss: 0.9619 | Val  Acc: 0.7018
 Site-Infograph | Val  Loss: 1.2607 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9211
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.2332 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.1484 | Train Acc: 0.9565
 Site-Clipart   | Train Loss: 0.2351 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.1778 | Train Acc: 0.9620
 Site-Clipart   | Train Loss: 0.1447 | Train Acc: 0.9729
 Site-Real      | Train Loss: 0.1981 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0887 | Train Acc: 0.9605
 Site-Real      | Train Loss: 0.0472 | Train Acc: 0.9960
 Site-Real      | Train Loss: 0.0662 | Train Acc: 0.9885
 Site-Painting  | Train Loss: 0.2391 | Train Acc: 0.9456
 Site-Painting  | Train Loss: 0.1312 | Train Acc: 0.9612
 Site-Painting  | Train Loss: 0.1948 | Train Acc: 0.9585
 Site-Sketch    | Train Loss: 0.3617 | Train Acc: 0.8848
 Site-Sketch    | Train Loss: 0.2625 | Train Acc: 0.9288
 Site-QuickDraw | Train Loss: 0.8162 | Train Acc: 0.7003
 Site-Infograph | Train Loss: 1.2830 | Train Acc: 0.5684
 Site-Clipart   | Val  Loss: 0.0758 | Val  Acc: 0.9605
 Site-Clipart   | Val  Loss: 0.1737 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1505 | Val  Acc: 0.9667
 Site-Clipart   | Val  Loss: 0.1502 | Val  Acc: 0.9619
 Site-Clipart   | Val  Loss: 0.2224 | Val  Acc: 0.9356
 Site-Real      | Val  Loss: 0.0456 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0501 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0434 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0763 | Val  Acc: 0.9740
 Site-Painting  | Val  Loss: 0.1108 | Val  Acc: 0.9898
 Site-Painting  | Val  Loss: 0.2146 | Val  Acc: 0.9270
 Site-Painting  | Val  Loss: 0.1850 | Val  Acc: 0.9479
 Site-Sketch    | Val  Loss: 0.1828 | Val  Acc: 0.9528
 Site-Sketch    | Val  Loss: 0.2997 | Val  Acc: 0.9045
 Site-QuickDraw | Val  Loss: 0.9323 | Val  Acc: 0.7339
 Site-Infograph | Val  Loss: 1.2414 | Val  Acc: 0.6090
Average Valid Accuracy: 0.9255
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.2373 | Train Acc: 0.9391
 Site-Clipart   | Train Loss: 0.2134 | Train Acc: 0.9317
 Site-Clipart   | Train Loss: 0.2299 | Train Acc: 0.9422
 Site-Clipart   | Train Loss: 0.1614 | Train Acc: 0.9557
 Site-Clipart   | Train Loss: 0.1268 | Train Acc: 0.9751
 Site-Real      | Train Loss: 0.1393 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0897 | Train Acc: 0.9605
 Site-Real      | Train Loss: 0.0472 | Train Acc: 0.9879
 Site-Real      | Train Loss: 0.0489 | Train Acc: 0.9914
 Site-Painting  | Train Loss: 0.2061 | Train Acc: 0.9592
 Site-Painting  | Train Loss: 0.1935 | Train Acc: 0.9515
 Site-Painting  | Train Loss: 0.1773 | Train Acc: 0.9412
 Site-Sketch    | Train Loss: 0.3696 | Train Acc: 0.8691
 Site-Sketch    | Train Loss: 0.2955 | Train Acc: 0.9326
 Site-QuickDraw | Train Loss: 0.8967 | Train Acc: 0.7187
 Site-Infograph | Train Loss: 1.2354 | Train Acc: 0.5897
 Site-Clipart   | Val  Loss: 0.0790 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1754 | Val  Acc: 0.9439
 Site-Clipart   | Val  Loss: 0.1267 | Val  Acc: 0.9733
 Site-Clipart   | Val  Loss: 0.1572 | Val  Acc: 0.9619
 Site-Clipart   | Val  Loss: 0.2354 | Val  Acc: 0.9356
 Site-Real      | Val  Loss: 0.0564 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0486 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0309 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0630 | Val  Acc: 0.9827
 Site-Painting  | Val  Loss: 0.1508 | Val  Acc: 0.9796
 Site-Painting  | Val  Loss: 0.2030 | Val  Acc: 0.9416
 Site-Painting  | Val  Loss: 0.1927 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2398 | Val  Acc: 0.9370
 Site-Sketch    | Val  Loss: 0.2979 | Val  Acc: 0.8989
 Site-QuickDraw | Val  Loss: 0.9862 | Val  Acc: 0.7385
 Site-Infograph | Val  Loss: 1.3003 | Val  Acc: 0.5705
Average Valid Accuracy: 0.9234
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.1983 | Train Acc: 0.9565
 Site-Clipart   | Train Loss: 0.1740 | Train Acc: 0.9565
 Site-Clipart   | Train Loss: 0.2239 | Train Acc: 0.9467
 Site-Clipart   | Train Loss: 0.1570 | Train Acc: 0.9525
 Site-Clipart   | Train Loss: 0.1304 | Train Acc: 0.9729
 Site-Real      | Train Loss: 0.1630 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0649 | Train Acc: 0.9718
 Site-Real      | Train Loss: 0.0532 | Train Acc: 0.9960
 Site-Real      | Train Loss: 0.0459 | Train Acc: 0.9943
 Site-Painting  | Train Loss: 0.1410 | Train Acc: 0.9660
 Site-Painting  | Train Loss: 0.2093 | Train Acc: 0.9369
 Site-Painting  | Train Loss: 0.2050 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.3580 | Train Acc: 0.8743
 Site-Sketch    | Train Loss: 0.1804 | Train Acc: 0.9251
 Site-QuickDraw | Train Loss: 0.9556 | Train Acc: 0.7034
 Site-Infograph | Train Loss: 1.2694 | Train Acc: 0.5855
 Site-Clipart   | Val  Loss: 0.0729 | Val  Acc: 0.9868
 Site-Clipart   | Val  Loss: 0.1393 | Val  Acc: 0.9626
 Site-Clipart   | Val  Loss: 0.1287 | Val  Acc: 0.9667
 Site-Clipart   | Val  Loss: 0.1927 | Val  Acc: 0.9476
 Site-Clipart   | Val  Loss: 0.2148 | Val  Acc: 0.9492
 Site-Real      | Val  Loss: 0.0314 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0509 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0240 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0629 | Val  Acc: 0.9827
 Site-Painting  | Val  Loss: 0.1194 | Val  Acc: 0.9796
 Site-Painting  | Val  Loss: 0.1728 | Val  Acc: 0.9562
 Site-Painting  | Val  Loss: 0.2232 | Val  Acc: 0.9479
 Site-Sketch    | Val  Loss: 0.2084 | Val  Acc: 0.9291
 Site-Sketch    | Val  Loss: 0.2715 | Val  Acc: 0.9045
 Site-QuickDraw | Val  Loss: 0.9364 | Val  Acc: 0.7156
 Site-Infograph | Val  Loss: 1.2615 | Val  Acc: 0.5833
Average Valid Accuracy: 0.9252
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.2873 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.1627 | Train Acc: 0.9441
 Site-Clipart   | Train Loss: 0.2033 | Train Acc: 0.9511
 Site-Clipart   | Train Loss: 0.1777 | Train Acc: 0.9589
 Site-Clipart   | Train Loss: 0.1305 | Train Acc: 0.9729
 Site-Real      | Train Loss: 0.1694 | Train Acc: 0.9444
 Site-Real      | Train Loss: 0.0584 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0452 | Train Acc: 0.9879
 Site-Real      | Train Loss: 0.0477 | Train Acc: 0.9943
 Site-Painting  | Train Loss: 0.1888 | Train Acc: 0.9388
 Site-Painting  | Train Loss: 0.1880 | Train Acc: 0.9223
 Site-Painting  | Train Loss: 0.1725 | Train Acc: 0.9516
 Site-Sketch    | Train Loss: 0.3295 | Train Acc: 0.9215
 Site-Sketch    | Train Loss: 0.2373 | Train Acc: 0.9363
 Site-QuickDraw | Train Loss: 0.8783 | Train Acc: 0.7003
 Site-Infograph | Train Loss: 1.2281 | Train Acc: 0.5983
 Site-Clipart   | Val  Loss: 0.0577 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.1357 | Val  Acc: 0.9626
 Site-Clipart   | Val  Loss: 0.1465 | Val  Acc: 0.9800
 Site-Clipart   | Val  Loss: 0.1804 | Val  Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.2287 | Val  Acc: 0.9458
 Site-Real      | Val  Loss: 0.0429 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0508 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0317 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0524 | Val  Acc: 0.9870
 Site-Painting  | Val  Loss: 0.1734 | Val  Acc: 0.9592
 Site-Painting  | Val  Loss: 0.2718 | Val  Acc: 0.9197
 Site-Painting  | Val  Loss: 0.1870 | Val  Acc: 0.9479
 Site-Sketch    | Val  Loss: 0.1970 | Val  Acc: 0.9370
 Site-Sketch    | Val  Loss: 0.2590 | Val  Acc: 0.9157
 Site-QuickDraw | Val  Loss: 0.9395 | Val  Acc: 0.7294
 Site-Infograph | Val  Loss: 1.1910 | Val  Acc: 0.5833
Average Valid Accuracy: 0.9244
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.2344 | Train Acc: 0.9478
 Site-Clipart   | Train Loss: 0.2119 | Train Acc: 0.9503
 Site-Clipart   | Train Loss: 0.2288 | Train Acc: 0.9289
 Site-Clipart   | Train Loss: 0.1714 | Train Acc: 0.9589
 Site-Clipart   | Train Loss: 0.1354 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.1603 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0531 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0466 | Train Acc: 0.9879
 Site-Real      | Train Loss: 0.0572 | Train Acc: 0.9914
 Site-Painting  | Train Loss: 0.2169 | Train Acc: 0.9388
 Site-Painting  | Train Loss: 0.1799 | Train Acc: 0.9515
 Site-Painting  | Train Loss: 0.1728 | Train Acc: 0.9654
 Site-Sketch    | Train Loss: 0.3403 | Train Acc: 0.8848
 Site-Sketch    | Train Loss: 0.2340 | Train Acc: 0.9288
 Site-QuickDraw | Train Loss: 0.7443 | Train Acc: 0.7339
 Site-Infograph | Train Loss: 1.2590 | Train Acc: 0.6026
 Site-Clipart   | Val  Loss: 0.0559 | Val  Acc: 0.9868
 Site-Clipart   | Val  Loss: 0.1443 | Val  Acc: 0.9720
 Site-Clipart   | Val  Loss: 0.1686 | Val  Acc: 0.9733
 Site-Clipart   | Val  Loss: 0.1614 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2005 | Val  Acc: 0.9627
 Site-Real      | Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0480 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0420 | Val  Acc: 0.9879
 Site-Real      | Val  Loss: 0.0529 | Val  Acc: 0.9870
 Site-Painting  | Val  Loss: 0.1344 | Val  Acc: 0.9490
 Site-Painting  | Val  Loss: 0.2298 | Val  Acc: 0.9416
 Site-Painting  | Val  Loss: 0.1791 | Val  Acc: 0.9531
 Site-Sketch    | Val  Loss: 0.1950 | Val  Acc: 0.9449
 Site-Sketch    | Val  Loss: 0.2927 | Val  Acc: 0.9270
 Site-QuickDraw | Val  Loss: 0.9582 | Val  Acc: 0.7110
 Site-Infograph | Val  Loss: 1.2977 | Val  Acc: 0.5705
Average Valid Accuracy: 0.9257
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.2324 | Train Acc: 0.9304
 Site-Clipart   | Train Loss: 0.1296 | Train Acc: 0.9689
 Site-Clipart   | Train Loss: 0.1942 | Train Acc: 0.9422
 Site-Clipart   | Train Loss: 0.1734 | Train Acc: 0.9557
 Site-Clipart   | Train Loss: 0.1389 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1369 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0466 | Train Acc: 0.9831
 Site-Real      | Train Loss: 0.0456 | Train Acc: 0.9919
 Site-Real      | Train Loss: 0.0479 | Train Acc: 0.9914
 Site-Painting  | Train Loss: 0.2058 | Train Acc: 0.9456
 Site-Painting  | Train Loss: 0.1636 | Train Acc: 0.9515
 Site-Painting  | Train Loss: 0.1813 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.3321 | Train Acc: 0.9005
 Site-Sketch    | Train Loss: 0.1937 | Train Acc: 0.9363
 Site-QuickDraw | Train Loss: 0.8186 | Train Acc: 0.7187
 Site-Infograph | Train Loss: 1.2042 | Train Acc: 0.6154
 Site-Clipart   | Val  Loss: 0.0827 | Val  Acc: 0.9605
 Site-Clipart   | Val  Loss: 0.1514 | Val  Acc: 0.9626
 Site-Clipart   | Val  Loss: 0.1262 | Val  Acc: 0.9800
 Site-Clipart   | Val  Loss: 0.1702 | Val  Acc: 0.9381
 Site-Clipart   | Val  Loss: 0.2116 | Val  Acc: 0.9458
 Site-Real      | Val  Loss: 0.0335 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0465 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0397 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0510 | Val  Acc: 0.9870
 Site-Painting  | Val  Loss: 0.1122 | Val  Acc: 0.9898
 Site-Painting  | Val  Loss: 0.2023 | Val  Acc: 0.9562
 Site-Painting  | Val  Loss: 0.1918 | Val  Acc: 0.9427
 Site-Sketch    | Val  Loss: 0.2006 | Val  Acc: 0.9449
 Site-Sketch    | Val  Loss: 0.2438 | Val  Acc: 0.9270
 Site-QuickDraw | Val  Loss: 0.9265 | Val  Acc: 0.7248
 Site-Infograph | Val  Loss: 1.3033 | Val  Acc: 0.5705
Average Valid Accuracy: 0.9260
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.2486 | Train Acc: 0.9217
 Site-Clipart   | Train Loss: 0.2111 | Train Acc: 0.9193
 Site-Clipart   | Train Loss: 0.2606 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.1580 | Train Acc: 0.9747
 Site-Clipart   | Train Loss: 0.1321 | Train Acc: 0.9729
 Site-Real      | Train Loss: 0.1541 | Train Acc: 0.9603
 Site-Real      | Train Loss: 0.0568 | Train Acc: 0.9887
 Site-Real      | Train Loss: 0.0359 | Train Acc: 0.9919
 Site-Real      | Train Loss: 0.0471 | Train Acc: 0.9885
 Site-Painting  | Train Loss: 0.2141 | Train Acc: 0.9592
 Site-Painting  | Train Loss: 0.1634 | Train Acc: 0.9417
 Site-Painting  | Train Loss: 0.2046 | Train Acc: 0.9446
 Site-Sketch    | Train Loss: 0.3594 | Train Acc: 0.8639
 Site-Sketch    | Train Loss: 0.2197 | Train Acc: 0.9176
 Site-QuickDraw | Train Loss: 0.9426 | Train Acc: 0.7095
 Site-Infograph | Train Loss: 1.2457 | Train Acc: 0.5855
 Site-Clipart   | Val  Loss: 0.1289 | Val  Acc: 0.9605
 Site-Clipart   | Val  Loss: 0.1178 | Val  Acc: 0.9813
 Site-Clipart   | Val  Loss: 0.1506 | Val  Acc: 0.9533
 Site-Clipart   | Val  Loss: 0.1386 | Val  Acc: 0.9667
 Site-Clipart   | Val  Loss: 0.2142 | Val  Acc: 0.9356
 Site-Real      | Val  Loss: 0.0374 | Val  Acc: 0.9881
 Site-Real      | Val  Loss: 0.0430 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0315 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0574 | Val  Acc: 0.9827
 Site-Painting  | Val  Loss: 0.1342 | Val  Acc: 0.9694
 Site-Painting  | Val  Loss: 0.1569 | Val  Acc: 0.9270
 Site-Painting  | Val  Loss: 0.2202 | Val  Acc: 0.9271
 Site-Sketch    | Val  Loss: 0.1836 | Val  Acc: 0.9528
 Site-Sketch    | Val  Loss: 0.2656 | Val  Acc: 0.9045
 Site-QuickDraw | Val  Loss: 0.9704 | Val  Acc: 0.7248
 Site-Infograph | Val  Loss: 1.3234 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9202
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2460 | Train Acc: 0.9304
 Site-Clipart   | Train Loss: 0.1800 | Train Acc: 0.9441
 Site-Clipart   | Train Loss: 0.1738 | Train Acc: 0.9556
 Site-Clipart   | Train Loss: 0.1623 | Train Acc: 0.9620
 Site-Clipart   | Train Loss: 0.1343 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1396 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0697 | Train Acc: 0.9774
 Site-Real      | Train Loss: 0.0459 | Train Acc: 0.9919
 Site-Real      | Train Loss: 0.0435 | Train Acc: 0.9914
 Site-Painting  | Train Loss: 0.1365 | Train Acc: 0.9592
 Site-Painting  | Train Loss: 0.1629 | Train Acc: 0.9466
 Site-Painting  | Train Loss: 0.1652 | Train Acc: 0.9516
 Site-Sketch    | Train Loss: 0.3604 | Train Acc: 0.8848
 Site-Sketch    | Train Loss: 0.3127 | Train Acc: 0.9326
 Site-QuickDraw | Train Loss: 0.8188 | Train Acc: 0.7187
 Site-Infograph | Train Loss: 1.2659 | Train Acc: 0.5385
 Site-Clipart   | Val  Loss: 0.0833 | Val  Acc: 0.9868
 Site-Clipart   | Val  Loss: 0.1130 | Val  Acc: 0.9813
 Site-Clipart   | Val  Loss: 0.1440 | Val  Acc: 0.9733
 Site-Clipart   | Val  Loss: 0.1635 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2221 | Val  Acc: 0.9390
 Site-Real      | Val  Loss: 0.0533 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0440 | Val  Acc: 0.9915
 Site-Real      | Val  Loss: 0.0427 | Val  Acc: 0.9939
 Site-Real      | Val  Loss: 0.0618 | Val  Acc: 0.9784
 Site-Painting  | Val  Loss: 0.1019 | Val  Acc: 0.9796
 Site-Painting  | Val  Loss: 0.2190 | Val  Acc: 0.9489
 Site-Painting  | Val  Loss: 0.1792 | Val  Acc: 0.9531
 Site-Sketch    | Val  Loss: 0.2261 | Val  Acc: 0.9291
 Site-Sketch    | Val  Loss: 0.2473 | Val  Acc: 0.9270
 Site-QuickDraw | Val  Loss: 0.9156 | Val  Acc: 0.7523
 Site-Infograph | Val  Loss: 1.2608 | Val  Acc: 0.5769
Average Valid Accuracy: 0.9290
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9868
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9813
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9733
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9390
 Best site-Real       | Epoch:49 | Val Acc: 1.0000
 Best site-Real       | Epoch:49 | Val Acc: 0.9915
 Best site-Real       | Epoch:49 | Val Acc: 0.9939
 Best site-Real       | Epoch:49 | Val Acc: 0.9784
 Best site-Painting   | Epoch:49 | Val Acc: 0.9796
 Best site-Painting   | Epoch:49 | Val Acc: 0.9489
 Best site-Painting   | Epoch:49 | Val Acc: 0.9531
 Best site-Sketch     | Epoch:49 | Val Acc: 0.9291
 Best site-Sketch     | Epoch:49 | Val Acc: 0.9270
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.7523
 Best site-Infograph  | Epoch:49 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/harmo-fl...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.9373
 Test site-Real      | Epoch:49 | Test Acc: 0.9671
 Test site-Painting  | Epoch:49 | Test Acc: 0.9241
 Test site-Sketch    | Epoch:49 | Test Acc: 0.9043
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.7010
 Test site-Infograph | Epoch:49 | Test Acc: 0.5205
Average Test Accuracy: 0.8257
===2023-05-12 07:36:22===
===2023-05-12 07:36:29===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.9373
 Test site-Real      | Epoch:49 | Test Acc: 0.9671
 Test site-Painting  | Epoch:49 | Test Acc: 0.9241
 Test site-Sketch    | Epoch:49 | Test Acc: 0.9043
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.7010
 Test site-Infograph | Epoch:49 | Test Acc: 0.5205
Average Test Accuracy: 0.8257
