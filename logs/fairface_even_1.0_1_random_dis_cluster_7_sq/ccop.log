===2023-06-17 20:03:10===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 2.0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[64,192,64,192,64,192,64,192,64,192,64,192,64,192,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[856,856,856,856,856,856,856,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 4, 1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (0) | Train Loss: 2.3422 | Train Acc: 0.1094
 Site-White_utk                 (0) | Train Loss: 2.3741 | Train Acc: 0.1094
 Site-East_Asian                (1) | Train Loss: 1.9365 | Train Acc: 0.4062
 Site-East_Asian                (1) | Train Loss: 1.8740 | Train Acc: 0.3802
 Site-Indian_utk                (0) | Train Loss: 1.9330 | Train Acc: 0.3750
 Site-Indian_utk                (0) | Train Loss: 1.9844 | Train Acc: 0.3490
 Site-Black_utk                 (5) | Train Loss: 1.9631 | Train Acc: 0.3281
 Site-Black_utk                 (5) | Train Loss: 1.9644 | Train Acc: 0.3281
 Site-Southeast_Asian           (1) | Train Loss: 2.0001 | Train Acc: 0.2969
 Site-Southeast_Asian           (1) | Train Loss: 2.0575 | Train Acc: 0.3021
 Site-Asian_ffhq                (2) | Train Loss: 1.6570 | Train Acc: 0.6719
 Site-Asian_ffhq                (3) | Train Loss: 1.3259 | Train Acc: 0.7292
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.3614 | Train Acc: 0.8438
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.6527 | Train Acc: 0.3594
Average Train Accuracy: 0.3992
 Site-White_utk                 (0) | Val  Loss: 2.3494 | Val  Acc: 0.1429
 Site-White_utk                 (0) | Val  Loss: 2.3679 | Val  Acc: 0.1094
 Site-East_Asian                (1) | Val  Loss: 1.9777 | Val  Acc: 0.2857
 Site-East_Asian                (1) | Val  Loss: 1.8824 | Val  Acc: 0.3828
 Site-Indian_utk                (0) | Val  Loss: 1.9425 | Val  Acc: 0.3571
 Site-Indian_utk                (0) | Val  Loss: 1.9479 | Val  Acc: 0.3516
 Site-Black_utk                 (5) | Val  Loss: 2.0070 | Val  Acc: 0.2619
 Site-Black_utk                 (5) | Val  Loss: 2.0091 | Val  Acc: 0.2969
 Site-Southeast_Asian           (1) | Val  Loss: 2.0936 | Val  Acc: 0.3095
 Site-Southeast_Asian           (1) | Val  Loss: 2.0488 | Val  Acc: 0.3203
 Site-Asian_ffhq                (2) | Val  Loss: 1.2552 | Val  Acc: 0.8333
 Site-Asian_ffhq                (3) | Val  Loss: 1.3985 | Val  Acc: 0.6172
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 2.2725 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.7553 | Val  Acc: 0.3281
Average Valid Accuracy: 0.3283
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1429
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1094
 Best site-East_Asian               (1)  | Epoch:0 | Val Acc: 0.2857
 Best site-East_Asian               (1)  | Epoch:0 | Val Acc: 0.3828
 Best site-Indian_utk               (0)  | Epoch:0 | Val Acc: 0.3571
 Best site-Indian_utk               (0)  | Epoch:0 | Val Acc: 0.3516
 Best site-Black_utk                (5)  | Epoch:0 | Val Acc: 0.2619
 Best site-Black_utk                (5)  | Epoch:0 | Val Acc: 0.2969
 Best site-Southeast_Asian          (1)  | Epoch:0 | Val Acc: 0.3095
 Best site-Southeast_Asian          (1)  | Epoch:0 | Val Acc: 0.3203
 Best site-Asian_ffhq               (2)  | Epoch:0 | Val Acc: 0.8333
 Best site-Asian_ffhq               (3)  | Epoch:0 | Val Acc: 0.6172
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:0 | Val Acc: 0.0000
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:0 | Val Acc: 0.3281
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 1 ============
cnt=[2, 2, 4, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (0) | Train Loss: 2.2063 | Train Acc: 0.1250
 Site-White_utk                 (0) | Train Loss: 2.2558 | Train Acc: 0.1146
 Site-East_Asian                (2) | Train Loss: 1.8776 | Train Acc: 0.4219
 Site-East_Asian                (2) | Train Loss: 1.8697 | Train Acc: 0.3802
 Site-Indian_utk                (3) | Train Loss: 1.9387 | Train Acc: 0.3750
 Site-Indian_utk                (3) | Train Loss: 1.9409 | Train Acc: 0.3438
 Site-Black_utk                 (6) | Train Loss: 1.9158 | Train Acc: 0.3438
 Site-Black_utk                 (6) | Train Loss: 1.9467 | Train Acc: 0.3177
 Site-Southeast_Asian           (2) | Train Loss: 1.9993 | Train Acc: 0.3281
 Site-Southeast_Asian           (2) | Train Loss: 1.9963 | Train Acc: 0.3125
 Site-Asian_ffhq                (4) | Train Loss: 1.6420 | Train Acc: 0.6875
 Site-Asian_ffhq                (1) | Train Loss: 1.3882 | Train Acc: 0.7448
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.3693 | Train Acc: 0.8750
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.7045 | Train Acc: 0.3385
Average Train Accuracy: 0.4077
 Site-White_utk                 (0) | Val  Loss: 2.2068 | Val  Acc: 0.1190
 Site-White_utk                 (0) | Val  Loss: 2.2385 | Val  Acc: 0.1094
 Site-East_Asian                (2) | Val  Loss: 1.9823 | Val  Acc: 0.2619
 Site-East_Asian                (2) | Val  Loss: 1.8672 | Val  Acc: 0.3750
 Site-Indian_utk                (3) | Val  Loss: 1.9319 | Val  Acc: 0.3571
 Site-Indian_utk                (3) | Val  Loss: 1.9154 | Val  Acc: 0.3672
 Site-Black_utk                 (6) | Val  Loss: 1.9838 | Val  Acc: 0.3095
 Site-Black_utk                 (6) | Val  Loss: 1.9868 | Val  Acc: 0.2656
 Site-Southeast_Asian           (2) | Val  Loss: 2.0361 | Val  Acc: 0.3333
 Site-Southeast_Asian           (2) | Val  Loss: 2.0209 | Val  Acc: 0.3281
 Site-Asian_ffhq                (4) | Val  Loss: 1.3158 | Val  Acc: 0.9048
 Site-Asian_ffhq                (1) | Val  Loss: 1.4453 | Val  Acc: 0.6406
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 2.2935 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.7769 | Val  Acc: 0.3359
Average Valid Accuracy: 0.3363
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1190
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1094
 Best site-East_Asian               (2)  | Epoch:1 | Val Acc: 0.2619
 Best site-East_Asian               (2)  | Epoch:1 | Val Acc: 0.3750
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3571
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3672
 Best site-Black_utk                (6)  | Epoch:1 | Val Acc: 0.3095
 Best site-Black_utk                (6)  | Epoch:1 | Val Acc: 0.2656
 Best site-Southeast_Asian          (2)  | Epoch:1 | Val Acc: 0.3333
 Best site-Southeast_Asian          (2)  | Epoch:1 | Val Acc: 0.3281
 Best site-Asian_ffhq               (4)  | Epoch:1 | Val Acc: 0.9048
 Best site-Asian_ffhq               (1)  | Epoch:1 | Val Acc: 0.6406
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:1 | Val Acc: 0.0000
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:1 | Val Acc: 0.3359
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 2 ============
cnt=[2, 2, 1, 2, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk                 (0) | Train Loss: 2.1650 | Train Acc: 0.1094
 Site-White_utk                 (0) | Train Loss: 2.2157 | Train Acc: 0.1146
 Site-East_Asian                (1) | Train Loss: 1.8414 | Train Acc: 0.4062
 Site-East_Asian                (1) | Train Loss: 1.8325 | Train Acc: 0.3906
 Site-Indian_utk                (4) | Train Loss: 1.8926 | Train Acc: 0.3750
 Site-Indian_utk                (4) | Train Loss: 1.9104 | Train Acc: 0.3385
 Site-Black_utk                 (3) | Train Loss: 1.9224 | Train Acc: 0.3125
 Site-Black_utk                 (3) | Train Loss: 1.9310 | Train Acc: 0.3177
 Site-Southeast_Asian           (6) | Train Loss: 1.9908 | Train Acc: 0.3125
 Site-Southeast_Asian           (6) | Train Loss: 1.9586 | Train Acc: 0.3125
 Site-Asian_ffhq                (5) | Train Loss: 1.5935 | Train Acc: 0.7031
 Site-Asian_ffhq                (5) | Train Loss: 1.3618 | Train Acc: 0.7448
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3172 | Train Acc: 0.8906
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.7033 | Train Acc: 0.3542
Average Train Accuracy: 0.4059
 Site-White_utk                 (0) | Val  Loss: 2.1868 | Val  Acc: 0.1429
 Site-White_utk                 (0) | Val  Loss: 2.1763 | Val  Acc: 0.1250
 Site-East_Asian                (1) | Val  Loss: 1.9315 | Val  Acc: 0.2619
 Site-East_Asian                (1) | Val  Loss: 1.8390 | Val  Acc: 0.3984
 Site-Indian_utk                (4) | Val  Loss: 1.8930 | Val  Acc: 0.3571
 Site-Indian_utk                (4) | Val  Loss: 1.8746 | Val  Acc: 0.3672
 Site-Black_utk                 (3) | Val  Loss: 1.9248 | Val  Acc: 0.3095
 Site-Black_utk                 (3) | Val  Loss: 1.9340 | Val  Acc: 0.3281
 Site-Southeast_Asian           (6) | Val  Loss: 1.9389 | Val  Acc: 0.3333
 Site-Southeast_Asian           (6) | Val  Loss: 1.9783 | Val  Acc: 0.3125
 Site-Asian_ffhq                (5) | Val  Loss: 1.2727 | Val  Acc: 0.9286
 Site-Asian_ffhq                (5) | Val  Loss: 1.4209 | Val  Acc: 0.6484
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.3205 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7921 | Val  Acc: 0.3438
Average Valid Accuracy: 0.3469
 Best site-White_utk                (0)  | Epoch:2 | Val Acc: 0.1429
 Best site-White_utk                (0)  | Epoch:2 | Val Acc: 0.1250
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.2619
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.3984
 Best site-Indian_utk               (4)  | Epoch:2 | Val Acc: 0.3571
 Best site-Indian_utk               (4)  | Epoch:2 | Val Acc: 0.3672
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.3095
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.3281
 Best site-Southeast_Asian          (6)  | Epoch:2 | Val Acc: 0.3333
 Best site-Southeast_Asian          (6)  | Epoch:2 | Val Acc: 0.3125
 Best site-Asian_ffhq               (5)  | Epoch:2 | Val Acc: 0.9286
 Best site-Asian_ffhq               (5)  | Epoch:2 | Val Acc: 0.6484
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:2 | Val Acc: 0.0000
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:2 | Val Acc: 0.3438
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 3 ============
cnt=[4, 2, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White_utk                 (4) | Train Loss: 2.1029 | Train Acc: 0.1406
 Site-White_utk                 (4) | Train Loss: 2.1641 | Train Acc: 0.1302
 Site-East_Asian                (0) | Train Loss: 1.8074 | Train Acc: 0.4062
 Site-East_Asian                (0) | Train Loss: 1.8029 | Train Acc: 0.3906
 Site-Indian_utk                (4) | Train Loss: 1.8618 | Train Acc: 0.3906
 Site-Indian_utk                (4) | Train Loss: 1.8469 | Train Acc: 0.3438
 Site-Black_utk                 (1) | Train Loss: 1.8877 | Train Acc: 0.3438
 Site-Black_utk                 (1) | Train Loss: 1.8875 | Train Acc: 0.3385
 Site-Southeast_Asian           (0) | Train Loss: 1.9507 | Train Acc: 0.3125
 Site-Southeast_Asian           (0) | Train Loss: 1.9345 | Train Acc: 0.3125
 Site-Asian_ffhq                (2) | Train Loss: 1.5964 | Train Acc: 0.6719
 Site-Asian_ffhq                (3) | Train Loss: 1.3349 | Train Acc: 0.7604
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.2951 | Train Acc: 0.8750
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.6868 | Train Acc: 0.3542
Average Train Accuracy: 0.4122
 Site-White_utk                 (4) | Val  Loss: 2.1068 | Val  Acc: 0.1190
 Site-White_utk                 (4) | Val  Loss: 2.1417 | Val  Acc: 0.1328
 Site-East_Asian                (0) | Val  Loss: 1.9735 | Val  Acc: 0.2857
 Site-East_Asian                (0) | Val  Loss: 1.8173 | Val  Acc: 0.3906
 Site-Indian_utk                (4) | Val  Loss: 1.8423 | Val  Acc: 0.3571
 Site-Indian_utk                (4) | Val  Loss: 1.8525 | Val  Acc: 0.3516
 Site-Black_utk                 (1) | Val  Loss: 1.9326 | Val  Acc: 0.2619
 Site-Black_utk                 (1) | Val  Loss: 1.8931 | Val  Acc: 0.3125
 Site-Southeast_Asian           (0) | Val  Loss: 1.9531 | Val  Acc: 0.3333
 Site-Southeast_Asian           (0) | Val  Loss: 1.9396 | Val  Acc: 0.3203
 Site-Asian_ffhq                (2) | Val  Loss: 1.2355 | Val  Acc: 0.9286
 Site-Asian_ffhq                (3) | Val  Loss: 1.4050 | Val  Acc: 0.6328
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.3581 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7496 | Val  Acc: 0.3516
Average Valid Accuracy: 0.3413
============ Train epoch 4 ============
cnt=[2, 4, 1, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White_utk                 (6) | Train Loss: 2.1077 | Train Acc: 0.1562
 Site-White_utk                 (6) | Train Loss: 2.1322 | Train Acc: 0.1458
 Site-East_Asian                (1) | Train Loss: 1.7627 | Train Acc: 0.4062
 Site-East_Asian                (1) | Train Loss: 1.7838 | Train Acc: 0.3854
 Site-Indian_utk                (4) | Train Loss: 1.8206 | Train Acc: 0.4062
 Site-Indian_utk                (4) | Train Loss: 1.8399 | Train Acc: 0.3438
 Site-Black_utk                 (0) | Train Loss: 1.8375 | Train Acc: 0.3438
 Site-Black_utk                 (0) | Train Loss: 1.8484 | Train Acc: 0.3333
 Site-Southeast_Asian           (1) | Train Loss: 1.9304 | Train Acc: 0.3281
 Site-Southeast_Asian           (1) | Train Loss: 1.9230 | Train Acc: 0.3177
 Site-Asian_ffhq                (5) | Train Loss: 1.5785 | Train Acc: 0.6406
 Site-Asian_ffhq                (3) | Train Loss: 1.2869 | Train Acc: 0.7604
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.2625 | Train Acc: 0.8906
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.6697 | Train Acc: 0.3542
Average Train Accuracy: 0.4152
 Site-White_utk                 (6) | Val  Loss: 2.0745 | Val  Acc: 0.1667
 Site-White_utk                 (6) | Val  Loss: 2.0905 | Val  Acc: 0.1406
 Site-East_Asian                (1) | Val  Loss: 1.9492 | Val  Acc: 0.2381
 Site-East_Asian                (1) | Val  Loss: 1.7604 | Val  Acc: 0.3906
 Site-Indian_utk                (4) | Val  Loss: 1.8110 | Val  Acc: 0.3571
 Site-Indian_utk                (4) | Val  Loss: 1.8253 | Val  Acc: 0.3672
 Site-Black_utk                 (0) | Val  Loss: 1.9045 | Val  Acc: 0.3095
 Site-Black_utk                 (0) | Val  Loss: 1.8813 | Val  Acc: 0.2969
 Site-Southeast_Asian           (1) | Val  Loss: 1.9733 | Val  Acc: 0.3333
 Site-Southeast_Asian           (1) | Val  Loss: 1.9192 | Val  Acc: 0.3203
 Site-Asian_ffhq                (5) | Val  Loss: 1.1930 | Val  Acc: 0.9286
 Site-Asian_ffhq                (3) | Val  Loss: 1.3799 | Val  Acc: 0.6406
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.3358 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.7544 | Val  Acc: 0.3281
Average Valid Accuracy: 0.3441
============ Train epoch 5 ============
cnt=[2, 2, 4, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White_utk                 (0) | Train Loss: 2.0222 | Train Acc: 0.2188
 Site-White_utk                 (0) | Train Loss: 2.0732 | Train Acc: 0.1875
 Site-East_Asian                (2) | Train Loss: 1.7572 | Train Acc: 0.4062
 Site-East_Asian                (2) | Train Loss: 1.7679 | Train Acc: 0.3854
 Site-Indian_utk                (3) | Train Loss: 1.7841 | Train Acc: 0.3906
 Site-Indian_utk                (3) | Train Loss: 1.7815 | Train Acc: 0.3698
 Site-Black_utk                 (4) | Train Loss: 1.8227 | Train Acc: 0.3281
 Site-Black_utk                 (4) | Train Loss: 1.8393 | Train Acc: 0.3594
 Site-Southeast_Asian           (2) | Train Loss: 1.9147 | Train Acc: 0.3125
 Site-Southeast_Asian           (2) | Train Loss: 1.8945 | Train Acc: 0.3333
 Site-Asian_ffhq                (5) | Train Loss: 1.5428 | Train Acc: 0.6719
 Site-Asian_ffhq                (1) | Train Loss: 1.2930 | Train Acc: 0.7500
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.2517 | Train Acc: 0.9062
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.6707 | Train Acc: 0.3542
Average Train Accuracy: 0.4267
 Site-White_utk                 (0) | Val  Loss: 2.0389 | Val  Acc: 0.1667
 Site-White_utk                 (0) | Val  Loss: 2.0455 | Val  Acc: 0.1484
 Site-East_Asian                (2) | Val  Loss: 1.8873 | Val  Acc: 0.2619
 Site-East_Asian                (2) | Val  Loss: 1.7363 | Val  Acc: 0.3906
 Site-Indian_utk                (3) | Val  Loss: 1.8047 | Val  Acc: 0.3571
 Site-Indian_utk                (3) | Val  Loss: 1.7807 | Val  Acc: 0.4062
 Site-Black_utk                 (4) | Val  Loss: 1.8381 | Val  Acc: 0.3095
 Site-Black_utk                 (4) | Val  Loss: 1.8544 | Val  Acc: 0.3047
 Site-Southeast_Asian           (2) | Val  Loss: 1.9222 | Val  Acc: 0.3571
 Site-Southeast_Asian           (2) | Val  Loss: 1.9025 | Val  Acc: 0.3203
 Site-Asian_ffhq                (5) | Val  Loss: 1.2140 | Val  Acc: 0.9048
 Site-Asian_ffhq                (1) | Val  Loss: 1.3872 | Val  Acc: 0.6484
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.2787 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.7271 | Val  Acc: 0.3359
Average Valid Accuracy: 0.3508
 Best site-White_utk                (0)  | Epoch:5 | Val Acc: 0.1667
 Best site-White_utk                (0)  | Epoch:5 | Val Acc: 0.1484
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.2619
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3906
 Best site-Indian_utk               (3)  | Epoch:5 | Val Acc: 0.3571
 Best site-Indian_utk               (3)  | Epoch:5 | Val Acc: 0.4062
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.3095
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.3047
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3571
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3203
 Best site-Asian_ffhq               (5)  | Epoch:5 | Val Acc: 0.9048
 Best site-Asian_ffhq               (1)  | Epoch:5 | Val Acc: 0.6484
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:5 | Val Acc: 0.0000
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:5 | Val Acc: 0.3359
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 6 ============
cnt=[2, 4, 1, 1, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White_utk                 (0) | Train Loss: 1.9614 | Train Acc: 0.2500
 Site-White_utk                 (0) | Train Loss: 1.9947 | Train Acc: 0.1979
 Site-East_Asian                (1) | Train Loss: 1.7086 | Train Acc: 0.4219
 Site-East_Asian                (1) | Train Loss: 1.7674 | Train Acc: 0.3854
 Site-Indian_utk                (4) | Train Loss: 1.7951 | Train Acc: 0.4062
 Site-Indian_utk                (4) | Train Loss: 1.7616 | Train Acc: 0.4010
 Site-Black_utk                 (6) | Train Loss: 1.7867 | Train Acc: 0.4062
 Site-Black_utk                 (6) | Train Loss: 1.8276 | Train Acc: 0.3438
 Site-Southeast_Asian           (1) | Train Loss: 1.9127 | Train Acc: 0.3125
 Site-Southeast_Asian           (1) | Train Loss: 1.8642 | Train Acc: 0.3490
 Site-Asian_ffhq                (3) | Train Loss: 1.5672 | Train Acc: 0.6250
 Site-Asian_ffhq                (5) | Train Loss: 1.3466 | Train Acc: 0.7083
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.2656 | Train Acc: 0.9219
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.6794 | Train Acc: 0.3542
Average Train Accuracy: 0.4345
 Site-White_utk                 (0) | Val  Loss: 1.9587 | Val  Acc: 0.2381
 Site-White_utk                 (0) | Val  Loss: 1.9504 | Val  Acc: 0.2109
 Site-East_Asian                (1) | Val  Loss: 1.8457 | Val  Acc: 0.3095
 Site-East_Asian                (1) | Val  Loss: 1.7483 | Val  Acc: 0.3984
 Site-Indian_utk                (4) | Val  Loss: 1.7591 | Val  Acc: 0.3571
 Site-Indian_utk                (4) | Val  Loss: 1.7756 | Val  Acc: 0.3984
 Site-Black_utk                 (6) | Val  Loss: 1.8432 | Val  Acc: 0.3333
 Site-Black_utk                 (6) | Val  Loss: 1.8207 | Val  Acc: 0.3438
 Site-Southeast_Asian           (1) | Val  Loss: 1.9489 | Val  Acc: 0.3095
 Site-Southeast_Asian           (1) | Val  Loss: 1.8810 | Val  Acc: 0.3438
 Site-Asian_ffhq                (3) | Val  Loss: 1.2669 | Val  Acc: 0.8333
 Site-Asian_ffhq                (5) | Val  Loss: 1.4136 | Val  Acc: 0.5938
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.2369 | Val  Acc: 0.0238
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7312 | Val  Acc: 0.3359
Average Valid Accuracy: 0.3593
 Best site-White_utk                (0)  | Epoch:6 | Val Acc: 0.2381
 Best site-White_utk                (0)  | Epoch:6 | Val Acc: 0.2109
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.3095
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.3984
 Best site-Indian_utk               (4)  | Epoch:6 | Val Acc: 0.3571
 Best site-Indian_utk               (4)  | Epoch:6 | Val Acc: 0.3984
 Best site-Black_utk                (6)  | Epoch:6 | Val Acc: 0.3333
 Best site-Black_utk                (6)  | Epoch:6 | Val Acc: 0.3438
 Best site-Southeast_Asian          (1)  | Epoch:6 | Val Acc: 0.3095
 Best site-Southeast_Asian          (1)  | Epoch:6 | Val Acc: 0.3438
 Best site-Asian_ffhq               (3)  | Epoch:6 | Val Acc: 0.8333
 Best site-Asian_ffhq               (5)  | Epoch:6 | Val Acc: 0.5938
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:6 | Val Acc: 0.0238
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:6 | Val Acc: 0.3359
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 7 ============
cnt=[4, 2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White_utk                 (5) | Train Loss: 1.8654 | Train Acc: 0.2500
 Site-White_utk                 (5) | Train Loss: 1.8915 | Train Acc: 0.2552
 Site-East_Asian                (0) | Train Loss: 1.6841 | Train Acc: 0.4375
 Site-East_Asian                (0) | Train Loss: 1.7234 | Train Acc: 0.4010
 Site-Indian_utk                (4) | Train Loss: 1.7276 | Train Acc: 0.4219
 Site-Indian_utk                (4) | Train Loss: 1.7201 | Train Acc: 0.4167
 Site-Black_utk                 (1) | Train Loss: 1.7055 | Train Acc: 0.4062
 Site-Black_utk                 (1) | Train Loss: 1.7634 | Train Acc: 0.4271
 Site-Southeast_Asian           (0) | Train Loss: 1.8645 | Train Acc: 0.3281
 Site-Southeast_Asian           (0) | Train Loss: 1.8191 | Train Acc: 0.3542
 Site-Asian_ffhq                (6) | Train Loss: 1.6218 | Train Acc: 0.5625
 Site-Asian_ffhq                (3) | Train Loss: 1.3800 | Train Acc: 0.6146
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3364 | Train Acc: 0.7969
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.6538 | Train Acc: 0.3594
Average Train Accuracy: 0.4308
 Site-White_utk                 (5) | Val  Loss: 1.7999 | Val  Acc: 0.2857
 Site-White_utk                 (5) | Val  Loss: 1.8875 | Val  Acc: 0.2422
 Site-East_Asian                (0) | Val  Loss: 1.8611 | Val  Acc: 0.2619
 Site-East_Asian                (0) | Val  Loss: 1.6958 | Val  Acc: 0.4141
 Site-Indian_utk                (4) | Val  Loss: 1.7564 | Val  Acc: 0.4048
 Site-Indian_utk                (4) | Val  Loss: 1.7645 | Val  Acc: 0.4219
 Site-Black_utk                 (1) | Val  Loss: 1.7978 | Val  Acc: 0.4762
 Site-Black_utk                 (1) | Val  Loss: 1.7975 | Val  Acc: 0.3516
 Site-Southeast_Asian           (0) | Val  Loss: 1.9157 | Val  Acc: 0.3095
 Site-Southeast_Asian           (0) | Val  Loss: 1.8157 | Val  Acc: 0.3750
 Site-Asian_ffhq                (6) | Val  Loss: 1.3041 | Val  Acc: 0.8095
 Site-Asian_ffhq                (3) | Val  Loss: 1.4541 | Val  Acc: 0.5156
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.1885 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.7246 | Val  Acc: 0.2891
Average Valid Accuracy: 0.3718
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2857
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2422
 Best site-East_Asian               (0)  | Epoch:7 | Val Acc: 0.2619
 Best site-East_Asian               (0)  | Epoch:7 | Val Acc: 0.4141
 Best site-Indian_utk               (4)  | Epoch:7 | Val Acc: 0.4048
 Best site-Indian_utk               (4)  | Epoch:7 | Val Acc: 0.4219
 Best site-Black_utk                (1)  | Epoch:7 | Val Acc: 0.4762
 Best site-Black_utk                (1)  | Epoch:7 | Val Acc: 0.3516
 Best site-Southeast_Asian          (0)  | Epoch:7 | Val Acc: 0.3095
 Best site-Southeast_Asian          (0)  | Epoch:7 | Val Acc: 0.3750
 Best site-Asian_ffhq               (6)  | Epoch:7 | Val Acc: 0.8095
 Best site-Asian_ffhq               (3)  | Epoch:7 | Val Acc: 0.5156
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:7 | Val Acc: 0.0476
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:7 | Val Acc: 0.2891
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 8 ============
cnt=[2, 2, 1, 4, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White_utk                 (0) | Train Loss: 1.7240 | Train Acc: 0.3438
 Site-White_utk                 (0) | Train Loss: 1.7984 | Train Acc: 0.3281
 Site-East_Asian                (1) | Train Loss: 1.6358 | Train Acc: 0.4844
 Site-East_Asian                (6) | Train Loss: 1.7150 | Train Acc: 0.3906
 Site-Indian_utk                (3) | Train Loss: 1.6873 | Train Acc: 0.4844
 Site-Indian_utk                (3) | Train Loss: 1.6976 | Train Acc: 0.4010
 Site-Black_utk                 (3) | Train Loss: 1.6599 | Train Acc: 0.4375
 Site-Black_utk                 (3) | Train Loss: 1.7616 | Train Acc: 0.3594
 Site-Southeast_Asian           (1) | Train Loss: 1.8218 | Train Acc: 0.3750
 Site-Southeast_Asian           (6) | Train Loss: 1.7828 | Train Acc: 0.3594
 Site-Asian_ffhq                (2) | Train Loss: 1.7400 | Train Acc: 0.4688
 Site-Asian_ffhq                (4) | Train Loss: 1.5005 | Train Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.4571 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6688 | Train Acc: 0.2969
Average Train Accuracy: 0.4237
 Site-White_utk                 (0) | Val  Loss: 1.7330 | Val  Acc: 0.3571
 Site-White_utk                 (0) | Val  Loss: 1.7593 | Val  Acc: 0.3438
 Site-East_Asian                (1) | Val  Loss: 1.8310 | Val  Acc: 0.3095
 Site-East_Asian                (6) | Val  Loss: 1.7011 | Val  Acc: 0.4062
 Site-Indian_utk                (3) | Val  Loss: 1.7095 | Val  Acc: 0.4286
 Site-Indian_utk                (3) | Val  Loss: 1.7354 | Val  Acc: 0.3906
 Site-Black_utk                 (3) | Val  Loss: 1.7481 | Val  Acc: 0.4524
 Site-Black_utk                 (3) | Val  Loss: 1.7782 | Val  Acc: 0.3438
 Site-Southeast_Asian           (1) | Val  Loss: 1.8398 | Val  Acc: 0.3810
 Site-Southeast_Asian           (6) | Val  Loss: 1.7870 | Val  Acc: 0.3594
 Site-Asian_ffhq                (2) | Val  Loss: 1.4658 | Val  Acc: 0.6429
 Site-Asian_ffhq                (4) | Val  Loss: 1.5131 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 2.0526 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.7115 | Val  Acc: 0.3594
Average Valid Accuracy: 0.3824
 Best site-White_utk                (0)  | Epoch:8 | Val Acc: 0.3571
 Best site-White_utk                (0)  | Epoch:8 | Val Acc: 0.3438
 Best site-East_Asian               (1)  | Epoch:8 | Val Acc: 0.3095
 Best site-East_Asian               (6)  | Epoch:8 | Val Acc: 0.4062
 Best site-Indian_utk               (3)  | Epoch:8 | Val Acc: 0.4286
 Best site-Indian_utk               (3)  | Epoch:8 | Val Acc: 0.3906
 Best site-Black_utk                (3)  | Epoch:8 | Val Acc: 0.4524
 Best site-Black_utk                (3)  | Epoch:8 | Val Acc: 0.3438
 Best site-Southeast_Asian          (1)  | Epoch:8 | Val Acc: 0.3810
 Best site-Southeast_Asian          (6)  | Epoch:8 | Val Acc: 0.3594
 Best site-Asian_ffhq               (2)  | Epoch:8 | Val Acc: 0.6429
 Best site-Asian_ffhq               (4)  | Epoch:8 | Val Acc: 0.5312
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:8 | Val Acc: 0.0476
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:8 | Val Acc: 0.3594
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 9 ============
cnt=[1, 4, 1, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White_utk                 (5) | Train Loss: 1.7245 | Train Acc: 0.3438
 Site-White_utk                 (5) | Train Loss: 1.7526 | Train Acc: 0.3438
 Site-East_Asian                (1) | Train Loss: 1.5595 | Train Acc: 0.4688
 Site-East_Asian                (1) | Train Loss: 1.6646 | Train Acc: 0.4010
 Site-Indian_utk                (4) | Train Loss: 1.6017 | Train Acc: 0.5156
 Site-Indian_utk                (4) | Train Loss: 1.6559 | Train Acc: 0.4531
 Site-Black_utk                 (6) | Train Loss: 1.6222 | Train Acc: 0.4375
 Site-Black_utk                 (0) | Train Loss: 1.6988 | Train Acc: 0.4375
 Site-Southeast_Asian           (1) | Train Loss: 1.8261 | Train Acc: 0.4062
 Site-Southeast_Asian           (1) | Train Loss: 1.7552 | Train Acc: 0.3906
 Site-Asian_ffhq                (2) | Train Loss: 1.6715 | Train Acc: 0.4844
 Site-Asian_ffhq                (3) | Train Loss: 1.4220 | Train Acc: 0.5156
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.3274 | Train Acc: 0.7500
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.6386 | Train Acc: 0.3385
Average Train Accuracy: 0.4490
 Site-White_utk                 (5) | Val  Loss: 1.7147 | Val  Acc: 0.4048
 Site-White_utk                 (5) | Val  Loss: 1.7437 | Val  Acc: 0.3438
 Site-East_Asian                (1) | Val  Loss: 1.7485 | Val  Acc: 0.3095
 Site-East_Asian                (1) | Val  Loss: 1.6614 | Val  Acc: 0.4297
 Site-Indian_utk                (4) | Val  Loss: 1.6678 | Val  Acc: 0.5000
 Site-Indian_utk                (4) | Val  Loss: 1.6764 | Val  Acc: 0.4062
 Site-Black_utk                 (6) | Val  Loss: 1.6827 | Val  Acc: 0.5238
 Site-Black_utk                 (0) | Val  Loss: 1.7171 | Val  Acc: 0.3984
 Site-Southeast_Asian           (1) | Val  Loss: 1.8007 | Val  Acc: 0.3333
 Site-Southeast_Asian           (1) | Val  Loss: 1.7560 | Val  Acc: 0.3516
 Site-Asian_ffhq                (2) | Val  Loss: 1.3418 | Val  Acc: 0.6429
 Site-Asian_ffhq                (3) | Val  Loss: 1.4690 | Val  Acc: 0.4375
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 2.0941 | Val  Acc: 0.0238
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.6498 | Val  Acc: 0.3594
Average Valid Accuracy: 0.3903
 Best site-White_utk                (5)  | Epoch:9 | Val Acc: 0.4048
 Best site-White_utk                (5)  | Epoch:9 | Val Acc: 0.3438
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.3095
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.4297
 Best site-Indian_utk               (4)  | Epoch:9 | Val Acc: 0.5000
 Best site-Indian_utk               (4)  | Epoch:9 | Val Acc: 0.4062
 Best site-Black_utk                (6)  | Epoch:9 | Val Acc: 0.5238
 Best site-Black_utk                (0)  | Epoch:9 | Val Acc: 0.3984
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.3333
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.3516
 Best site-Asian_ffhq               (2)  | Epoch:9 | Val Acc: 0.6429
 Best site-Asian_ffhq               (3)  | Epoch:9 | Val Acc: 0.4375
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:9 | Val Acc: 0.0238
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:9 | Val Acc: 0.3594
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Test site-White_utk                 (5)| Epoch:9 | Test Acc: 0.2909
 Test site-East_Asian                (1)| Epoch:9 | Test Acc: 0.4547
 Test site-Indian_utk                (4)| Epoch:9 | Test Acc: 0.4854
 Test site-Black_utk                 (6)| Epoch:9 | Test Acc: 0.3520
 Test site-Southeast_Asian           (1)| Epoch:9 | Test Acc: 0.3969
 Test site-Asian_ffhq                (2)| Epoch:9 | Test Acc: 0.2702
 Test site-Latino_Hispanic_ffhq      (3)| Epoch:9 | Test Acc: 0.2935
White_utk: 0.2909, East_Asian: 0.4547, Indian_utk: 0.4854, Black_utk: 0.3520, Southeast_Asian: 0.3969, Asian_ffhq: 0.2702, Latino_Hispanic_ffhq: 0.2935, 
Average Test Accuracy(group): 0.3634, Average Test Accuracy(individual): 0.3634,
domain std=0.0787, cluster std=0.0737, individual std=0.0787, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 10 ============
cnt=[4, 4, 1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-White_utk                 (1) | Train Loss: 1.7231 | Train Acc: 0.2969
 Site-White_utk                 (1) | Train Loss: 1.7445 | Train Acc: 0.2917
 Site-East_Asian                (0) | Train Loss: 1.5306 | Train Acc: 0.4531
 Site-East_Asian                (0) | Train Loss: 1.6594 | Train Acc: 0.3906
 Site-Indian_utk                (1) | Train Loss: 1.5655 | Train Acc: 0.5000
 Site-Indian_utk                (1) | Train Loss: 1.5950 | Train Acc: 0.4531
 Site-Black_utk                 (5) | Train Loss: 1.6075 | Train Acc: 0.4375
 Site-Black_utk                 (5) | Train Loss: 1.6540 | Train Acc: 0.4583
 Site-Southeast_Asian           (0) | Train Loss: 1.8000 | Train Acc: 0.4062
 Site-Southeast_Asian           (0) | Train Loss: 1.7268 | Train Acc: 0.3854
 Site-Asian_ffhq                (3) | Train Loss: 1.6022 | Train Acc: 0.5000
 Site-Asian_ffhq                (6) | Train Loss: 1.3204 | Train Acc: 0.6094
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.1717 | Train Acc: 0.8281
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6056 | Train Acc: 0.3229
Average Train Accuracy: 0.4524
 Site-White_utk                 (1) | Val  Loss: 1.7166 | Val  Acc: 0.2857
 Site-White_utk                 (1) | Val  Loss: 1.7258 | Val  Acc: 0.3047
 Site-East_Asian                (0) | Val  Loss: 1.8040 | Val  Acc: 0.3333
 Site-East_Asian                (0) | Val  Loss: 1.6194 | Val  Acc: 0.4219
 Site-Indian_utk                (1) | Val  Loss: 1.6077 | Val  Acc: 0.5238
 Site-Indian_utk                (1) | Val  Loss: 1.5900 | Val  Acc: 0.4297
 Site-Black_utk                 (5) | Val  Loss: 1.6380 | Val  Acc: 0.4762
 Site-Black_utk                 (5) | Val  Loss: 1.6645 | Val  Acc: 0.3984
 Site-Southeast_Asian           (0) | Val  Loss: 1.7460 | Val  Acc: 0.3571
 Site-Southeast_Asian           (0) | Val  Loss: 1.7324 | Val  Acc: 0.3594
 Site-Asian_ffhq                (3) | Val  Loss: 1.1960 | Val  Acc: 0.6667
 Site-Asian_ffhq                (6) | Val  Loss: 1.4251 | Val  Acc: 0.5078
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 2.1476 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.6369 | Val  Acc: 0.3281
Average Valid Accuracy: 0.3886
============ Train epoch 11 ============
cnt=[1, 2, 3, 1, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-White_utk                 (1) | Train Loss: 1.6546 | Train Acc: 0.3281
 Site-White_utk                 (1) | Train Loss: 1.6668 | Train Acc: 0.3646
 Site-East_Asian                (6) | Train Loss: 1.4856 | Train Acc: 0.4531
 Site-East_Asian                (6) | Train Loss: 1.6398 | Train Acc: 0.4115
 Site-Indian_utk                (5) | Train Loss: 1.5990 | Train Acc: 0.4375
 Site-Indian_utk                (5) | Train Loss: 1.5950 | Train Acc: 0.4271
 Site-Black_utk                 (4) | Train Loss: 1.5714 | Train Acc: 0.5000
 Site-Black_utk                 (4) | Train Loss: 1.6315 | Train Acc: 0.4375
 Site-Southeast_Asian           (3) | Train Loss: 1.7465 | Train Acc: 0.3594
 Site-Southeast_Asian           (6) | Train Loss: 1.6948 | Train Acc: 0.3906
 Site-Asian_ffhq                (0) | Train Loss: 1.6209 | Train Acc: 0.5000
 Site-Asian_ffhq                (2) | Train Loss: 1.3728 | Train Acc: 0.5521
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.2666 | Train Acc: 0.7344
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6099 | Train Acc: 0.3229
Average Train Accuracy: 0.4442
 Site-White_utk                 (1) | Val  Loss: 1.6449 | Val  Acc: 0.4524
 Site-White_utk                 (1) | Val  Loss: 1.6405 | Val  Acc: 0.4141
 Site-East_Asian                (6) | Val  Loss: 1.7277 | Val  Acc: 0.3333
 Site-East_Asian                (6) | Val  Loss: 1.6024 | Val  Acc: 0.4609
 Site-Indian_utk                (5) | Val  Loss: 1.5971 | Val  Acc: 0.4524
 Site-Indian_utk                (5) | Val  Loss: 1.6173 | Val  Acc: 0.4219
 Site-Black_utk                 (4) | Val  Loss: 1.5858 | Val  Acc: 0.5952
 Site-Black_utk                 (4) | Val  Loss: 1.6654 | Val  Acc: 0.4375
 Site-Southeast_Asian           (3) | Val  Loss: 1.7427 | Val  Acc: 0.3333
 Site-Southeast_Asian           (6) | Val  Loss: 1.7056 | Val  Acc: 0.3750
 Site-Asian_ffhq                (0) | Val  Loss: 1.3339 | Val  Acc: 0.6429
 Site-Asian_ffhq                (2) | Val  Loss: 1.4538 | Val  Acc: 0.4688
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.0883 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.6396 | Val  Acc: 0.3047
Average Valid Accuracy: 0.4100
 Best site-White_utk                (1)  | Epoch:11 | Val Acc: 0.4524
 Best site-White_utk                (1)  | Epoch:11 | Val Acc: 0.4141
 Best site-East_Asian               (6)  | Epoch:11 | Val Acc: 0.3333
 Best site-East_Asian               (6)  | Epoch:11 | Val Acc: 0.4609
 Best site-Indian_utk               (5)  | Epoch:11 | Val Acc: 0.4524
 Best site-Indian_utk               (5)  | Epoch:11 | Val Acc: 0.4219
 Best site-Black_utk                (4)  | Epoch:11 | Val Acc: 0.5952
 Best site-Black_utk                (4)  | Epoch:11 | Val Acc: 0.4375
 Best site-Southeast_Asian          (3)  | Epoch:11 | Val Acc: 0.3333
 Best site-Southeast_Asian          (6)  | Epoch:11 | Val Acc: 0.3750
 Best site-Asian_ffhq               (0)  | Epoch:11 | Val Acc: 0.6429
 Best site-Asian_ffhq               (2)  | Epoch:11 | Val Acc: 0.4688
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:11 | Val Acc: 0.0476
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:11 | Val Acc: 0.3047
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 12 ============
cnt=[2, 2, 4, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-White_utk                 (5) | Train Loss: 1.6717 | Train Acc: 0.3125
 Site-White_utk                 (5) | Train Loss: 1.6439 | Train Acc: 0.3490
 Site-East_Asian                (2) | Train Loss: 1.4433 | Train Acc: 0.4844
 Site-East_Asian                (2) | Train Loss: 1.6060 | Train Acc: 0.4115
 Site-Indian_utk                (1) | Train Loss: 1.5575 | Train Acc: 0.4688
 Site-Indian_utk                (1) | Train Loss: 1.5629 | Train Acc: 0.4375
 Site-Black_utk                 (3) | Train Loss: 1.5451 | Train Acc: 0.4375
 Site-Black_utk                 (3) | Train Loss: 1.6102 | Train Acc: 0.4740
 Site-Southeast_Asian           (2) | Train Loss: 1.8185 | Train Acc: 0.3750
 Site-Southeast_Asian           (2) | Train Loss: 1.6786 | Train Acc: 0.3854
 Site-Asian_ffhq                (6) | Train Loss: 1.5518 | Train Acc: 0.5312
 Site-Asian_ffhq                (0) | Train Loss: 1.2979 | Train Acc: 0.6094
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.1875 | Train Acc: 0.7812
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.5401 | Train Acc: 0.3542
Average Train Accuracy: 0.4580
 Site-White_utk                 (5) | Val  Loss: 1.6005 | Val  Acc: 0.3810
 Site-White_utk                 (5) | Val  Loss: 1.6287 | Val  Acc: 0.3906
 Site-East_Asian                (2) | Val  Loss: 1.7696 | Val  Acc: 0.3571
 Site-East_Asian                (2) | Val  Loss: 1.5908 | Val  Acc: 0.4297
 Site-Indian_utk                (1) | Val  Loss: 1.5631 | Val  Acc: 0.4524
 Site-Indian_utk                (1) | Val  Loss: 1.6123 | Val  Acc: 0.4219
 Site-Black_utk                 (3) | Val  Loss: 1.5209 | Val  Acc: 0.5714
 Site-Black_utk                 (3) | Val  Loss: 1.6436 | Val  Acc: 0.4141
 Site-Southeast_Asian           (2) | Val  Loss: 1.7433 | Val  Acc: 0.3333
 Site-Southeast_Asian           (2) | Val  Loss: 1.6883 | Val  Acc: 0.3594
 Site-Asian_ffhq                (6) | Val  Loss: 1.2740 | Val  Acc: 0.6429
 Site-Asian_ffhq                (0) | Val  Loss: 1.3651 | Val  Acc: 0.4922
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 2.0858 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.5628 | Val  Acc: 0.3359
Average Valid Accuracy: 0.4021
============ Train epoch 13 ============
cnt=[4, 2, 2, 1, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-White_utk                 (1) | Train Loss: 1.5648 | Train Acc: 0.4062
 Site-White_utk                 (1) | Train Loss: 1.5784 | Train Acc: 0.4271
 Site-East_Asian                (0) | Train Loss: 1.4111 | Train Acc: 0.4688
 Site-East_Asian                (0) | Train Loss: 1.5936 | Train Acc: 0.4167
 Site-Indian_utk                (5) | Train Loss: 1.5452 | Train Acc: 0.4531
 Site-Indian_utk                (5) | Train Loss: 1.5656 | Train Acc: 0.4479
 Site-Black_utk                 (6) | Train Loss: 1.5625 | Train Acc: 0.5469
 Site-Black_utk                 (6) | Train Loss: 1.6474 | Train Acc: 0.4479
 Site-Southeast_Asian           (0) | Train Loss: 1.7051 | Train Acc: 0.4531
 Site-Southeast_Asian           (0) | Train Loss: 1.6366 | Train Acc: 0.3958
 Site-Asian_ffhq                (3) | Train Loss: 1.7623 | Train Acc: 0.4062
 Site-Asian_ffhq                (2) | Train Loss: 1.4916 | Train Acc: 0.5000
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.3505 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6142 | Train Acc: 0.3542
Average Train Accuracy: 0.4568
 Site-White_utk                 (1) | Val  Loss: 1.5606 | Val  Acc: 0.4286
 Site-White_utk                 (1) | Val  Loss: 1.5635 | Val  Acc: 0.3984
 Site-East_Asian                (0) | Val  Loss: 1.7152 | Val  Acc: 0.3810
 Site-East_Asian                (0) | Val  Loss: 1.5697 | Val  Acc: 0.4297
 Site-Indian_utk                (5) | Val  Loss: 1.5880 | Val  Acc: 0.4524
 Site-Indian_utk                (5) | Val  Loss: 1.6063 | Val  Acc: 0.4062
 Site-Black_utk                 (6) | Val  Loss: 1.5708 | Val  Acc: 0.5714
 Site-Black_utk                 (6) | Val  Loss: 1.6160 | Val  Acc: 0.4766
 Site-Southeast_Asian           (0) | Val  Loss: 1.7175 | Val  Acc: 0.3095
 Site-Southeast_Asian           (0) | Val  Loss: 1.6548 | Val  Acc: 0.4219
 Site-Asian_ffhq                (3) | Val  Loss: 1.4726 | Val  Acc: 0.6429
 Site-Asian_ffhq                (2) | Val  Loss: 1.5463 | Val  Acc: 0.3906
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 2.0089 | Val  Acc: 0.0952
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.6380 | Val  Acc: 0.3594
Average Valid Accuracy: 0.4117
 Best site-White_utk                (1)  | Epoch:13 | Val Acc: 0.4286
 Best site-White_utk                (1)  | Epoch:13 | Val Acc: 0.3984
 Best site-East_Asian               (0)  | Epoch:13 | Val Acc: 0.3810
 Best site-East_Asian               (0)  | Epoch:13 | Val Acc: 0.4297
 Best site-Indian_utk               (5)  | Epoch:13 | Val Acc: 0.4524
 Best site-Indian_utk               (5)  | Epoch:13 | Val Acc: 0.4062
 Best site-Black_utk                (6)  | Epoch:13 | Val Acc: 0.5714
 Best site-Black_utk                (6)  | Epoch:13 | Val Acc: 0.4766
 Best site-Southeast_Asian          (0)  | Epoch:13 | Val Acc: 0.3095
 Best site-Southeast_Asian          (0)  | Epoch:13 | Val Acc: 0.4219
 Best site-Asian_ffhq               (3)  | Epoch:13 | Val Acc: 0.6429
 Best site-Asian_ffhq               (2)  | Epoch:13 | Val Acc: 0.3906
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:13 | Val Acc: 0.0952
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:13 | Val Acc: 0.3594
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 14 ============
cnt=[4, 1, 1, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-White_utk                 (4) | Train Loss: 1.6485 | Train Acc: 0.3281
 Site-White_utk                 (4) | Train Loss: 1.6601 | Train Acc: 0.3021
 Site-East_Asian                (0) | Train Loss: 1.4396 | Train Acc: 0.4531
 Site-East_Asian                (0) | Train Loss: 1.5690 | Train Acc: 0.4323
 Site-Indian_utk                (2) | Train Loss: 1.4870 | Train Acc: 0.5000
 Site-Indian_utk                (4) | Train Loss: 1.5209 | Train Acc: 0.4323
 Site-Black_utk                 (3) | Train Loss: 1.5128 | Train Acc: 0.4688
 Site-Black_utk                 (3) | Train Loss: 1.5511 | Train Acc: 0.4479
 Site-Southeast_Asian           (0) | Train Loss: 1.7537 | Train Acc: 0.3906
 Site-Southeast_Asian           (0) | Train Loss: 1.6884 | Train Acc: 0.3646
 Site-Asian_ffhq                (6) | Train Loss: 1.4986 | Train Acc: 0.5156
 Site-Asian_ffhq                (5) | Train Loss: 1.2202 | Train Acc: 0.6302
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.0815 | Train Acc: 0.7969
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.4802 | Train Acc: 0.3646
Average Train Accuracy: 0.4591
 Site-White_utk                 (4) | Val  Loss: 1.6042 | Val  Acc: 0.3095
 Site-White_utk                 (4) | Val  Loss: 1.6284 | Val  Acc: 0.3516
 Site-East_Asian                (0) | Val  Loss: 1.7390 | Val  Acc: 0.3333
 Site-East_Asian                (0) | Val  Loss: 1.5468 | Val  Acc: 0.4297
 Site-Indian_utk                (2) | Val  Loss: 1.4857 | Val  Acc: 0.4524
 Site-Indian_utk                (4) | Val  Loss: 1.5502 | Val  Acc: 0.4453
 Site-Black_utk                 (3) | Val  Loss: 1.5526 | Val  Acc: 0.5238
 Site-Black_utk                 (3) | Val  Loss: 1.5580 | Val  Acc: 0.4531
 Site-Southeast_Asian           (0) | Val  Loss: 1.7409 | Val  Acc: 0.3571
 Site-Southeast_Asian           (0) | Val  Loss: 1.7166 | Val  Acc: 0.3750
 Site-Asian_ffhq                (6) | Val  Loss: 1.1343 | Val  Acc: 0.6905
 Site-Asian_ffhq                (5) | Val  Loss: 1.3059 | Val  Acc: 0.4922
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 2.0945 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.5380 | Val  Acc: 0.3516
Average Valid Accuracy: 0.4009
============ Train epoch 15 ============
cnt=[2, 4, 1, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-White_utk                 (4) | Train Loss: 1.5544 | Train Acc: 0.3125
 Site-White_utk                 (4) | Train Loss: 1.5871 | Train Acc: 0.3750
 Site-East_Asian                (1) | Train Loss: 1.3829 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.5452 | Train Acc: 0.4115
 Site-Indian_utk                (3) | Train Loss: 1.4891 | Train Acc: 0.5312
 Site-Indian_utk                (3) | Train Loss: 1.5107 | Train Acc: 0.4792
 Site-Black_utk                 (0) | Train Loss: 1.4880 | Train Acc: 0.5312
 Site-Black_utk                 (0) | Train Loss: 1.5329 | Train Acc: 0.4792
 Site-Southeast_Asian           (1) | Train Loss: 1.6745 | Train Acc: 0.4219
 Site-Southeast_Asian           (1) | Train Loss: 1.6212 | Train Acc: 0.3802
 Site-Asian_ffhq                (5) | Train Loss: 1.7173 | Train Acc: 0.4844
 Site-Asian_ffhq                (6) | Train Loss: 1.4034 | Train Acc: 0.5573
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.2266 | Train Acc: 0.7656
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.5943 | Train Acc: 0.3594
Average Train Accuracy: 0.4706
 Site-White_utk                 (4) | Val  Loss: 1.5086 | Val  Acc: 0.4286
 Site-White_utk                 (4) | Val  Loss: 1.5607 | Val  Acc: 0.3672
 Site-East_Asian                (1) | Val  Loss: 1.6680 | Val  Acc: 0.4048
 Site-East_Asian                (1) | Val  Loss: 1.5419 | Val  Acc: 0.4375
 Site-Indian_utk                (3) | Val  Loss: 1.4497 | Val  Acc: 0.5238
 Site-Indian_utk                (3) | Val  Loss: 1.5315 | Val  Acc: 0.4531
 Site-Black_utk                 (0) | Val  Loss: 1.5184 | Val  Acc: 0.5714
 Site-Black_utk                 (0) | Val  Loss: 1.5466 | Val  Acc: 0.4922
 Site-Southeast_Asian           (1) | Val  Loss: 1.6445 | Val  Acc: 0.4048
 Site-Southeast_Asian           (1) | Val  Loss: 1.6406 | Val  Acc: 0.3672
 Site-Asian_ffhq                (5) | Val  Loss: 1.3874 | Val  Acc: 0.5238
 Site-Asian_ffhq                (6) | Val  Loss: 1.4943 | Val  Acc: 0.4766
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.0998 | Val  Acc: 0.0952
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.6057 | Val  Acc: 0.3438
Average Valid Accuracy: 0.4207
 Best site-White_utk                (4)  | Epoch:15 | Val Acc: 0.4286
 Best site-White_utk                (4)  | Epoch:15 | Val Acc: 0.3672
 Best site-East_Asian               (1)  | Epoch:15 | Val Acc: 0.4048
 Best site-East_Asian               (1)  | Epoch:15 | Val Acc: 0.4375
 Best site-Indian_utk               (3)  | Epoch:15 | Val Acc: 0.5238
 Best site-Indian_utk               (3)  | Epoch:15 | Val Acc: 0.4531
 Best site-Black_utk                (0)  | Epoch:15 | Val Acc: 0.5714
 Best site-Black_utk                (0)  | Epoch:15 | Val Acc: 0.4922
 Best site-Southeast_Asian          (1)  | Epoch:15 | Val Acc: 0.4048
 Best site-Southeast_Asian          (1)  | Epoch:15 | Val Acc: 0.3672
 Best site-Asian_ffhq               (5)  | Epoch:15 | Val Acc: 0.5238
 Best site-Asian_ffhq               (6)  | Epoch:15 | Val Acc: 0.4766
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:15 | Val Acc: 0.0952
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:15 | Val Acc: 0.3438
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 16 ============
cnt=[2, 2, 1, 4, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-White_utk                 (1) | Train Loss: 1.5140 | Train Acc: 0.3750
 Site-White_utk                 (1) | Train Loss: 1.5508 | Train Acc: 0.4010
 Site-East_Asian                (3) | Train Loss: 1.4035 | Train Acc: 0.4531
 Site-East_Asian                (3) | Train Loss: 1.5240 | Train Acc: 0.4375
 Site-Indian_utk                (6) | Train Loss: 1.4629 | Train Acc: 0.5156
 Site-Indian_utk                (6) | Train Loss: 1.4962 | Train Acc: 0.4583
 Site-Black_utk                 (4) | Train Loss: 1.4957 | Train Acc: 0.5000
 Site-Black_utk                 (4) | Train Loss: 1.5267 | Train Acc: 0.4844
 Site-Southeast_Asian           (3) | Train Loss: 1.6585 | Train Acc: 0.4219
 Site-Southeast_Asian           (3) | Train Loss: 1.6111 | Train Acc: 0.3906
 Site-Asian_ffhq                (2) | Train Loss: 1.6379 | Train Acc: 0.5000
 Site-Asian_ffhq                (0) | Train Loss: 1.3774 | Train Acc: 0.5469
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.2763 | Train Acc: 0.7031
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.5167 | Train Acc: 0.3646
Average Train Accuracy: 0.4680
 Site-White_utk                 (1) | Val  Loss: 1.4861 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.5120 | Val  Acc: 0.4297
 Site-East_Asian                (3) | Val  Loss: 1.6971 | Val  Acc: 0.3571
 Site-East_Asian                (3) | Val  Loss: 1.5187 | Val  Acc: 0.4453
 Site-Indian_utk                (6) | Val  Loss: 1.5074 | Val  Acc: 0.3571
 Site-Indian_utk                (6) | Val  Loss: 1.5591 | Val  Acc: 0.4219
 Site-Black_utk                 (4) | Val  Loss: 1.4816 | Val  Acc: 0.5238
 Site-Black_utk                 (4) | Val  Loss: 1.5502 | Val  Acc: 0.4297
 Site-Southeast_Asian           (3) | Val  Loss: 1.6560 | Val  Acc: 0.3333
 Site-Southeast_Asian           (3) | Val  Loss: 1.6263 | Val  Acc: 0.3672
 Site-Asian_ffhq                (2) | Val  Loss: 1.3304 | Val  Acc: 0.6190
 Site-Asian_ffhq                (0) | Val  Loss: 1.3896 | Val  Acc: 0.4688
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.9386 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.5459 | Val  Acc: 0.3828
Average Valid Accuracy: 0.4111
============ Train epoch 17 ============
cnt=[1, 2, 4, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-White_utk                 (1) | Train Loss: 1.5787 | Train Acc: 0.3125
 Site-White_utk                 (1) | Train Loss: 1.5402 | Train Acc: 0.4115
 Site-East_Asian                (2) | Train Loss: 1.3888 | Train Acc: 0.4375
 Site-East_Asian                (2) | Train Loss: 1.5307 | Train Acc: 0.4271
 Site-Indian_utk                (4) | Train Loss: 1.4906 | Train Acc: 0.4375
 Site-Indian_utk                (4) | Train Loss: 1.5031 | Train Acc: 0.4479
 Site-Black_utk                 (5) | Train Loss: 1.5193 | Train Acc: 0.5156
 Site-Black_utk                 (5) | Train Loss: 1.5684 | Train Acc: 0.4688
 Site-Southeast_Asian           (2) | Train Loss: 1.6824 | Train Acc: 0.4062
 Site-Southeast_Asian           (2) | Train Loss: 1.5969 | Train Acc: 0.4271
 Site-Asian_ffhq                (0) | Train Loss: 1.6569 | Train Acc: 0.4531
 Site-Asian_ffhq                (3) | Train Loss: 1.3500 | Train Acc: 0.5417
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.2300 | Train Acc: 0.6562
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.5025 | Train Acc: 0.3854
Average Train Accuracy: 0.4520
 Site-White_utk                 (1) | Val  Loss: 1.4568 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.5256 | Val  Acc: 0.4219
 Site-East_Asian                (2) | Val  Loss: 1.6149 | Val  Acc: 0.3810
 Site-East_Asian                (2) | Val  Loss: 1.4755 | Val  Acc: 0.4531
 Site-Indian_utk                (4) | Val  Loss: 1.4654 | Val  Acc: 0.4524
 Site-Indian_utk                (4) | Val  Loss: 1.5450 | Val  Acc: 0.4609
 Site-Black_utk                 (5) | Val  Loss: 1.4741 | Val  Acc: 0.5238
 Site-Black_utk                 (5) | Val  Loss: 1.5422 | Val  Acc: 0.5000
 Site-Southeast_Asian           (2) | Val  Loss: 1.6809 | Val  Acc: 0.3333
 Site-Southeast_Asian           (2) | Val  Loss: 1.6245 | Val  Acc: 0.3906
 Site-Asian_ffhq                (0) | Val  Loss: 1.3368 | Val  Acc: 0.5714
 Site-Asian_ffhq                (3) | Val  Loss: 1.3867 | Val  Acc: 0.4531
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.8994 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.5108 | Val  Acc: 0.3594
Average Valid Accuracy: 0.4229
 Best site-White_utk                (1)  | Epoch:17 | Val Acc: 0.5000
 Best site-White_utk                (1)  | Epoch:17 | Val Acc: 0.4219
 Best site-East_Asian               (2)  | Epoch:17 | Val Acc: 0.3810
 Best site-East_Asian               (2)  | Epoch:17 | Val Acc: 0.4531
 Best site-Indian_utk               (4)  | Epoch:17 | Val Acc: 0.4524
 Best site-Indian_utk               (4)  | Epoch:17 | Val Acc: 0.4609
 Best site-Black_utk                (5)  | Epoch:17 | Val Acc: 0.5238
 Best site-Black_utk                (5)  | Epoch:17 | Val Acc: 0.5000
 Best site-Southeast_Asian          (2)  | Epoch:17 | Val Acc: 0.3333
 Best site-Southeast_Asian          (2)  | Epoch:17 | Val Acc: 0.3906
 Best site-Asian_ffhq               (0)  | Epoch:17 | Val Acc: 0.5714
 Best site-Asian_ffhq               (3)  | Epoch:17 | Val Acc: 0.4531
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:17 | Val Acc: 0.1190
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:17 | Val Acc: 0.3594
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 18 ============
cnt=[1, 2, 1, 2, 4, 1, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-White_utk                 (1) | Train Loss: 1.5611 | Train Acc: 0.3281
 Site-White_utk                 (1) | Train Loss: 1.4758 | Train Acc: 0.4427
 Site-East_Asian                (6) | Train Loss: 1.3949 | Train Acc: 0.4688
 Site-East_Asian                (6) | Train Loss: 1.5273 | Train Acc: 0.4062
 Site-Indian_utk                (4) | Train Loss: 1.4946 | Train Acc: 0.4531
 Site-Indian_utk                (4) | Train Loss: 1.4980 | Train Acc: 0.4583
 Site-Black_utk                 (4) | Train Loss: 1.5241 | Train Acc: 0.5000
 Site-Black_utk                 (4) | Train Loss: 1.5232 | Train Acc: 0.5104
 Site-Southeast_Asian           (2) | Train Loss: 1.6424 | Train Acc: 0.4219
 Site-Southeast_Asian           (6) | Train Loss: 1.5698 | Train Acc: 0.4115
 Site-Asian_ffhq                (5) | Train Loss: 1.6393 | Train Acc: 0.5156
 Site-Asian_ffhq                (3) | Train Loss: 1.3416 | Train Acc: 0.5521
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.2306 | Train Acc: 0.7031
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.5097 | Train Acc: 0.3906
Average Train Accuracy: 0.4687
 Site-White_utk                 (1) | Val  Loss: 1.4654 | Val  Acc: 0.5238
 Site-White_utk                 (1) | Val  Loss: 1.4688 | Val  Acc: 0.4375
 Site-East_Asian                (6) | Val  Loss: 1.6001 | Val  Acc: 0.4048
 Site-East_Asian                (6) | Val  Loss: 1.4924 | Val  Acc: 0.4375
 Site-Indian_utk                (4) | Val  Loss: 1.4617 | Val  Acc: 0.4762
 Site-Indian_utk                (4) | Val  Loss: 1.5230 | Val  Acc: 0.4375
 Site-Black_utk                 (4) | Val  Loss: 1.4488 | Val  Acc: 0.5714
 Site-Black_utk                 (4) | Val  Loss: 1.5296 | Val  Acc: 0.4922
 Site-Southeast_Asian           (2) | Val  Loss: 1.6436 | Val  Acc: 0.3810
 Site-Southeast_Asian           (6) | Val  Loss: 1.6240 | Val  Acc: 0.3984
 Site-Asian_ffhq                (5) | Val  Loss: 1.2748 | Val  Acc: 0.6905
 Site-Asian_ffhq                (3) | Val  Loss: 1.4151 | Val  Acc: 0.4375
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.9733 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.5121 | Val  Acc: 0.4141
Average Valid Accuracy: 0.4444
 Best site-White_utk                (1)  | Epoch:18 | Val Acc: 0.5238
 Best site-White_utk                (1)  | Epoch:18 | Val Acc: 0.4375
 Best site-East_Asian               (6)  | Epoch:18 | Val Acc: 0.4048
 Best site-East_Asian               (6)  | Epoch:18 | Val Acc: 0.4375
 Best site-Indian_utk               (4)  | Epoch:18 | Val Acc: 0.4762
 Best site-Indian_utk               (4)  | Epoch:18 | Val Acc: 0.4375
 Best site-Black_utk                (4)  | Epoch:18 | Val Acc: 0.5714
 Best site-Black_utk                (4)  | Epoch:18 | Val Acc: 0.4922
 Best site-Southeast_Asian          (2)  | Epoch:18 | Val Acc: 0.3810
 Best site-Southeast_Asian          (6)  | Epoch:18 | Val Acc: 0.3984
 Best site-Asian_ffhq               (5)  | Epoch:18 | Val Acc: 0.6905
 Best site-Asian_ffhq               (3)  | Epoch:18 | Val Acc: 0.4375
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:18 | Val Acc: 0.1190
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:18 | Val Acc: 0.4141
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 19 ============
cnt=[4, 4, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-White_utk                 (3) | Train Loss: 1.5277 | Train Acc: 0.4062
 Site-White_utk                 (3) | Train Loss: 1.4726 | Train Acc: 0.4479
 Site-East_Asian                (1) | Train Loss: 1.3742 | Train Acc: 0.4844
 Site-East_Asian                (1) | Train Loss: 1.5433 | Train Acc: 0.4271
 Site-Indian_utk                (0) | Train Loss: 1.4744 | Train Acc: 0.5000
 Site-Indian_utk                (0) | Train Loss: 1.4608 | Train Acc: 0.4740
 Site-Black_utk                 (0) | Train Loss: 1.5000 | Train Acc: 0.5000
 Site-Black_utk                 (0) | Train Loss: 1.5084 | Train Acc: 0.4844
 Site-Southeast_Asian           (1) | Train Loss: 1.6738 | Train Acc: 0.3906
 Site-Southeast_Asian           (1) | Train Loss: 1.5659 | Train Acc: 0.4323
 Site-Asian_ffhq                (4) | Train Loss: 1.5654 | Train Acc: 0.5000
 Site-Asian_ffhq                (2) | Train Loss: 1.2619 | Train Acc: 0.5781
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.1292 | Train Acc: 0.7656
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.5029 | Train Acc: 0.3542
Average Train Accuracy: 0.4818
 Site-White_utk                 (3) | Val  Loss: 1.4493 | Val  Acc: 0.5000
 Site-White_utk                 (3) | Val  Loss: 1.4738 | Val  Acc: 0.4844
 Site-East_Asian                (1) | Val  Loss: 1.6728 | Val  Acc: 0.3571
 Site-East_Asian                (1) | Val  Loss: 1.4519 | Val  Acc: 0.4375
 Site-Indian_utk                (0) | Val  Loss: 1.3690 | Val  Acc: 0.5000
 Site-Indian_utk                (0) | Val  Loss: 1.4914 | Val  Acc: 0.4766
 Site-Black_utk                 (0) | Val  Loss: 1.4240 | Val  Acc: 0.5476
 Site-Black_utk                 (0) | Val  Loss: 1.4947 | Val  Acc: 0.4922
 Site-Southeast_Asian           (1) | Val  Loss: 1.6410 | Val  Acc: 0.4048
 Site-Southeast_Asian           (1) | Val  Loss: 1.5496 | Val  Acc: 0.4297
 Site-Asian_ffhq                (4) | Val  Loss: 1.1910 | Val  Acc: 0.6667
 Site-Asian_ffhq                (2) | Val  Loss: 1.3196 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.0052 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.5195 | Val  Acc: 0.3047
Average Valid Accuracy: 0.4465
 Best site-White_utk                (3)  | Epoch:19 | Val Acc: 0.5000
 Best site-White_utk                (3)  | Epoch:19 | Val Acc: 0.4844
 Best site-East_Asian               (1)  | Epoch:19 | Val Acc: 0.3571
 Best site-East_Asian               (1)  | Epoch:19 | Val Acc: 0.4375
 Best site-Indian_utk               (0)  | Epoch:19 | Val Acc: 0.5000
 Best site-Indian_utk               (0)  | Epoch:19 | Val Acc: 0.4766
 Best site-Black_utk                (0)  | Epoch:19 | Val Acc: 0.5476
 Best site-Black_utk                (0)  | Epoch:19 | Val Acc: 0.4922
 Best site-Southeast_Asian          (1)  | Epoch:19 | Val Acc: 0.4048
 Best site-Southeast_Asian          (1)  | Epoch:19 | Val Acc: 0.4297
 Best site-Asian_ffhq               (4)  | Epoch:19 | Val Acc: 0.6667
 Best site-Asian_ffhq               (2)  | Epoch:19 | Val Acc: 0.5312
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:19 | Val Acc: 0.1190
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:19 | Val Acc: 0.3047
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Test site-White_utk                 (3)| Epoch:19 | Test Acc: 0.3186
 Test site-East_Asian                (1)| Epoch:19 | Test Acc: 0.4716
 Test site-Indian_utk                (0)| Epoch:19 | Test Acc: 0.5146
 Test site-Black_utk                 (0)| Epoch:19 | Test Acc: 0.4082
 Test site-Southeast_Asian           (1)| Epoch:19 | Test Acc: 0.4159
 Test site-Asian_ffhq                (4)| Epoch:19 | Test Acc: 0.3107
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:19 | Test Acc: 0.2985
White_utk: 0.3186, East_Asian: 0.4716, Indian_utk: 0.5146, Black_utk: 0.4082, Southeast_Asian: 0.4159, Asian_ffhq: 0.3107, Latino_Hispanic_ffhq: 0.2985, 
Average Test Accuracy(group): 0.3912, Average Test Accuracy(individual): 0.3912,
domain std=0.0783, cluster std=0.0661, individual std=0.0783, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 20 ============
cnt=[2, 2, 4, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-White_utk                 (1) | Train Loss: 1.5031 | Train Acc: 0.3906
 Site-White_utk                 (1) | Train Loss: 1.4628 | Train Acc: 0.4583
 Site-East_Asian                (2) | Train Loss: 1.3618 | Train Acc: 0.5156
 Site-East_Asian                (2) | Train Loss: 1.5090 | Train Acc: 0.4219
 Site-Indian_utk                (5) | Train Loss: 1.4525 | Train Acc: 0.4688
 Site-Indian_utk                (5) | Train Loss: 1.4672 | Train Acc: 0.4844
 Site-Black_utk                 (4) | Train Loss: 1.4979 | Train Acc: 0.4844
 Site-Black_utk                 (4) | Train Loss: 1.5041 | Train Acc: 0.4844
 Site-Southeast_Asian           (2) | Train Loss: 1.6082 | Train Acc: 0.4531
 Site-Southeast_Asian           (2) | Train Loss: 1.5442 | Train Acc: 0.4167
 Site-Asian_ffhq                (3) | Train Loss: 1.6630 | Train Acc: 0.5000
 Site-Asian_ffhq                (0) | Train Loss: 1.3350 | Train Acc: 0.5781
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.1896 | Train Acc: 0.7188
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.5187 | Train Acc: 0.3646
Average Train Accuracy: 0.4814
 Site-White_utk                 (1) | Val  Loss: 1.4315 | Val  Acc: 0.4286
 Site-White_utk                 (1) | Val  Loss: 1.4424 | Val  Acc: 0.4453
 Site-East_Asian                (2) | Val  Loss: 1.6087 | Val  Acc: 0.3810
 Site-East_Asian                (2) | Val  Loss: 1.4309 | Val  Acc: 0.4609
 Site-Indian_utk                (5) | Val  Loss: 1.4300 | Val  Acc: 0.5476
 Site-Indian_utk                (5) | Val  Loss: 1.4960 | Val  Acc: 0.5234
 Site-Black_utk                 (4) | Val  Loss: 1.4433 | Val  Acc: 0.5476
 Site-Black_utk                 (4) | Val  Loss: 1.4956 | Val  Acc: 0.4766
 Site-Southeast_Asian           (2) | Val  Loss: 1.5819 | Val  Acc: 0.4048
 Site-Southeast_Asian           (2) | Val  Loss: 1.5172 | Val  Acc: 0.4375
 Site-Asian_ffhq                (3) | Val  Loss: 1.2624 | Val  Acc: 0.6905
 Site-Asian_ffhq                (0) | Val  Loss: 1.4337 | Val  Acc: 0.4453
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.0169 | Val  Acc: 0.0952
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.5349 | Val  Acc: 0.3438
Average Valid Accuracy: 0.4449
============ Train epoch 21 ============
cnt=[1, 2, 4, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-White_utk                 (6) | Train Loss: 1.6039 | Train Acc: 0.3594
 Site-White_utk                 (6) | Train Loss: 1.5164 | Train Acc: 0.3906
 Site-East_Asian                (2) | Train Loss: 1.4033 | Train Acc: 0.4531
 Site-East_Asian                (2) | Train Loss: 1.4796 | Train Acc: 0.4323
 Site-Indian_utk                (1) | Train Loss: 1.4326 | Train Acc: 0.4062
 Site-Indian_utk                (1) | Train Loss: 1.4728 | Train Acc: 0.4427
 Site-Black_utk                 (5) | Train Loss: 1.5009 | Train Acc: 0.4375
 Site-Black_utk                 (5) | Train Loss: 1.4843 | Train Acc: 0.4635
 Site-Southeast_Asian           (2) | Train Loss: 1.6616 | Train Acc: 0.3906
 Site-Southeast_Asian           (2) | Train Loss: 1.5401 | Train Acc: 0.4271
 Site-Asian_ffhq                (4) | Train Loss: 1.5511 | Train Acc: 0.4844
 Site-Asian_ffhq                (3) | Train Loss: 1.1981 | Train Acc: 0.5729
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.1588 | Train Acc: 0.6875
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.3857 | Train Acc: 0.3906
Average Train Accuracy: 0.4528
 Site-White_utk                 (6) | Val  Loss: 1.4814 | Val  Acc: 0.5476
 Site-White_utk                 (6) | Val  Loss: 1.4914 | Val  Acc: 0.4375
 Site-East_Asian                (2) | Val  Loss: 1.6520 | Val  Acc: 0.3571
 Site-East_Asian                (2) | Val  Loss: 1.4325 | Val  Acc: 0.4375
 Site-Indian_utk                (1) | Val  Loss: 1.4276 | Val  Acc: 0.4524
 Site-Indian_utk                (1) | Val  Loss: 1.5383 | Val  Acc: 0.4141
 Site-Black_utk                 (5) | Val  Loss: 1.4354 | Val  Acc: 0.5952
 Site-Black_utk                 (5) | Val  Loss: 1.5087 | Val  Acc: 0.4688
 Site-Southeast_Asian           (2) | Val  Loss: 1.5965 | Val  Acc: 0.4286
 Site-Southeast_Asian           (2) | Val  Loss: 1.5527 | Val  Acc: 0.4219
 Site-Asian_ffhq                (4) | Val  Loss: 1.1620 | Val  Acc: 0.6429
 Site-Asian_ffhq                (3) | Val  Loss: 1.2384 | Val  Acc: 0.5000
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.8116 | Val  Acc: 0.1667
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.3901 | Val  Acc: 0.3672
Average Valid Accuracy: 0.4455
============ Train epoch 22 ============
cnt=[3, 4, 2, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-White_utk                 (0) | Train Loss: 1.5237 | Train Acc: 0.3125
 Site-White_utk                 (0) | Train Loss: 1.4458 | Train Acc: 0.4323
 Site-East_Asian                (1) | Train Loss: 1.3544 | Train Acc: 0.5156
 Site-East_Asian                (1) | Train Loss: 1.4650 | Train Acc: 0.4167
 Site-Indian_utk                (5) | Train Loss: 1.4197 | Train Acc: 0.5312
 Site-Indian_utk                (0) | Train Loss: 1.4515 | Train Acc: 0.4896
 Site-Black_utk                 (6) | Train Loss: 1.4528 | Train Acc: 0.4844
 Site-Black_utk                 (6) | Train Loss: 1.4858 | Train Acc: 0.5052
 Site-Southeast_Asian           (1) | Train Loss: 1.5971 | Train Acc: 0.4531
 Site-Southeast_Asian           (1) | Train Loss: 1.4931 | Train Acc: 0.4219
 Site-Asian_ffhq                (4) | Train Loss: 1.6302 | Train Acc: 0.4844
 Site-Asian_ffhq                (2) | Train Loss: 1.2961 | Train Acc: 0.5573
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.1935 | Train Acc: 0.7031
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.4468 | Train Acc: 0.3854
Average Train Accuracy: 0.4781
 Site-White_utk                 (0) | Val  Loss: 1.4101 | Val  Acc: 0.4048
 Site-White_utk                 (0) | Val  Loss: 1.4425 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.5957 | Val  Acc: 0.4048
 Site-East_Asian                (1) | Val  Loss: 1.4175 | Val  Acc: 0.4609
 Site-Indian_utk                (5) | Val  Loss: 1.3999 | Val  Acc: 0.4524
 Site-Indian_utk                (0) | Val  Loss: 1.4925 | Val  Acc: 0.4297
 Site-Black_utk                 (6) | Val  Loss: 1.3957 | Val  Acc: 0.6190
 Site-Black_utk                 (6) | Val  Loss: 1.4565 | Val  Acc: 0.4531
 Site-Southeast_Asian           (1) | Val  Loss: 1.6508 | Val  Acc: 0.3571
 Site-Southeast_Asian           (1) | Val  Loss: 1.5234 | Val  Acc: 0.4453
 Site-Asian_ffhq                (4) | Val  Loss: 1.2782 | Val  Acc: 0.6429
 Site-Asian_ffhq                (2) | Val  Loss: 1.3584 | Val  Acc: 0.4688
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.8790 | Val  Acc: 0.2619
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.4717 | Val  Acc: 0.4219
Average Valid Accuracy: 0.4516
 Best site-White_utk                (0)  | Epoch:22 | Val Acc: 0.4048
 Best site-White_utk                (0)  | Epoch:22 | Val Acc: 0.5000
 Best site-East_Asian               (1)  | Epoch:22 | Val Acc: 0.4048
 Best site-East_Asian               (1)  | Epoch:22 | Val Acc: 0.4609
 Best site-Indian_utk               (5)  | Epoch:22 | Val Acc: 0.4524
 Best site-Indian_utk               (0)  | Epoch:22 | Val Acc: 0.4297
 Best site-Black_utk                (6)  | Epoch:22 | Val Acc: 0.6190
 Best site-Black_utk                (6)  | Epoch:22 | Val Acc: 0.4531
 Best site-Southeast_Asian          (1)  | Epoch:22 | Val Acc: 0.3571
 Best site-Southeast_Asian          (1)  | Epoch:22 | Val Acc: 0.4453
 Best site-Asian_ffhq               (4)  | Epoch:22 | Val Acc: 0.6429
 Best site-Asian_ffhq               (2)  | Epoch:22 | Val Acc: 0.4688
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:22 | Val Acc: 0.2619
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:22 | Val Acc: 0.4219
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 23 ============
cnt=[4, 2, 2, 1, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-White_utk                 (5) | Train Loss: 1.5693 | Train Acc: 0.3750
 Site-White_utk                 (5) | Train Loss: 1.5307 | Train Acc: 0.4062
 Site-East_Asian                (0) | Train Loss: 1.4129 | Train Acc: 0.4531
 Site-East_Asian                (0) | Train Loss: 1.4910 | Train Acc: 0.4323
 Site-Indian_utk                (1) | Train Loss: 1.3936 | Train Acc: 0.5156
 Site-Indian_utk                (1) | Train Loss: 1.4259 | Train Acc: 0.4792
 Site-Black_utk                 (6) | Train Loss: 1.4158 | Train Acc: 0.4688
 Site-Black_utk                 (6) | Train Loss: 1.4563 | Train Acc: 0.5052
 Site-Southeast_Asian           (0) | Train Loss: 1.6254 | Train Acc: 0.4062
 Site-Southeast_Asian           (0) | Train Loss: 1.5535 | Train Acc: 0.4062
 Site-Asian_ffhq                (3) | Train Loss: 1.5043 | Train Acc: 0.5156
 Site-Asian_ffhq                (2) | Train Loss: 1.1536 | Train Acc: 0.5990
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.0285 | Train Acc: 0.7812
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.4040 | Train Acc: 0.4010
Average Train Accuracy: 0.4818
 Site-White_utk                 (5) | Val  Loss: 1.4600 | Val  Acc: 0.4524
 Site-White_utk                 (5) | Val  Loss: 1.4802 | Val  Acc: 0.3828
 Site-East_Asian                (0) | Val  Loss: 1.6722 | Val  Acc: 0.3810
 Site-East_Asian                (0) | Val  Loss: 1.4844 | Val  Acc: 0.4297
 Site-Indian_utk                (1) | Val  Loss: 1.4079 | Val  Acc: 0.5238
 Site-Indian_utk                (1) | Val  Loss: 1.4724 | Val  Acc: 0.4688
 Site-Black_utk                 (6) | Val  Loss: 1.3419 | Val  Acc: 0.6190
 Site-Black_utk                 (6) | Val  Loss: 1.4321 | Val  Acc: 0.4844
 Site-Southeast_Asian           (0) | Val  Loss: 1.6491 | Val  Acc: 0.4048
 Site-Southeast_Asian           (0) | Val  Loss: 1.5872 | Val  Acc: 0.4219
 Site-Asian_ffhq                (3) | Val  Loss: 1.0198 | Val  Acc: 0.7143
 Site-Asian_ffhq                (2) | Val  Loss: 1.2187 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 2.0395 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.4680 | Val  Acc: 0.3281
Average Valid Accuracy: 0.4421
============ Train epoch 24 ============
cnt=[4, 1, 4, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-White_utk                 (2) | Train Loss: 1.4510 | Train Acc: 0.4219
 Site-White_utk                 (2) | Train Loss: 1.3741 | Train Acc: 0.5000
 Site-East_Asian                (0) | Train Loss: 1.4041 | Train Acc: 0.4844
 Site-East_Asian                (0) | Train Loss: 1.4756 | Train Acc: 0.4583
 Site-Indian_utk                (2) | Train Loss: 1.4077 | Train Acc: 0.5312
 Site-Indian_utk                (2) | Train Loss: 1.4259 | Train Acc: 0.5000
 Site-Black_utk                 (5) | Train Loss: 1.4950 | Train Acc: 0.4688
 Site-Black_utk                 (5) | Train Loss: 1.4776 | Train Acc: 0.4948
 Site-Southeast_Asian           (0) | Train Loss: 1.6167 | Train Acc: 0.4531
 Site-Southeast_Asian           (0) | Train Loss: 1.4691 | Train Acc: 0.4583
 Site-Asian_ffhq                (3) | Train Loss: 1.9082 | Train Acc: 0.3906
 Site-Asian_ffhq                (1) | Train Loss: 1.5402 | Train Acc: 0.4688
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.3671 | Train Acc: 0.5938
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6278 | Train Acc: 0.3802
Average Train Accuracy: 0.4717
 Site-White_utk                 (2) | Val  Loss: 1.3148 | Val  Acc: 0.5952
 Site-White_utk                 (2) | Val  Loss: 1.3958 | Val  Acc: 0.5000
 Site-East_Asian                (0) | Val  Loss: 1.5192 | Val  Acc: 0.4762
 Site-East_Asian                (0) | Val  Loss: 1.4452 | Val  Acc: 0.4922
 Site-Indian_utk                (2) | Val  Loss: 1.4096 | Val  Acc: 0.4524
 Site-Indian_utk                (2) | Val  Loss: 1.4836 | Val  Acc: 0.5000
 Site-Black_utk                 (5) | Val  Loss: 1.3924 | Val  Acc: 0.5714
 Site-Black_utk                 (5) | Val  Loss: 1.4873 | Val  Acc: 0.4844
 Site-Southeast_Asian           (0) | Val  Loss: 1.4980 | Val  Acc: 0.4762
 Site-Southeast_Asian           (0) | Val  Loss: 1.4878 | Val  Acc: 0.4453
 Site-Asian_ffhq                (3) | Val  Loss: 1.4218 | Val  Acc: 0.6429
 Site-Asian_ffhq                (1) | Val  Loss: 1.6336 | Val  Acc: 0.4141
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.0181 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.6161 | Val  Acc: 0.3828
Average Valid Accuracy: 0.4680
 Best site-White_utk                (2)  | Epoch:24 | Val Acc: 0.5952
 Best site-White_utk                (2)  | Epoch:24 | Val Acc: 0.5000
 Best site-East_Asian               (0)  | Epoch:24 | Val Acc: 0.4762
 Best site-East_Asian               (0)  | Epoch:24 | Val Acc: 0.4922
 Best site-Indian_utk               (2)  | Epoch:24 | Val Acc: 0.4524
 Best site-Indian_utk               (2)  | Epoch:24 | Val Acc: 0.5000
 Best site-Black_utk                (5)  | Epoch:24 | Val Acc: 0.5714
 Best site-Black_utk                (5)  | Epoch:24 | Val Acc: 0.4844
 Best site-Southeast_Asian          (0)  | Epoch:24 | Val Acc: 0.4762
 Best site-Southeast_Asian          (0)  | Epoch:24 | Val Acc: 0.4453
 Best site-Asian_ffhq               (3)  | Epoch:24 | Val Acc: 0.6429
 Best site-Asian_ffhq               (1)  | Epoch:24 | Val Acc: 0.4141
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:24 | Val Acc: 0.1190
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:24 | Val Acc: 0.3828
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 25 ============
cnt=[4, 1, 4, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-White_utk                 (0) | Train Loss: 1.8213 | Train Acc: 0.2812
 Site-White_utk                 (0) | Train Loss: 1.6991 | Train Acc: 0.3385
 Site-East_Asian                (2) | Train Loss: 1.5469 | Train Acc: 0.4375
 Site-East_Asian                (2) | Train Loss: 1.5988 | Train Acc: 0.3958
 Site-Indian_utk                (0) | Train Loss: 1.5114 | Train Acc: 0.4531
 Site-Indian_utk                (0) | Train Loss: 1.5198 | Train Acc: 0.4167
 Site-Black_utk                 (5) | Train Loss: 1.4634 | Train Acc: 0.4531
 Site-Black_utk                 (5) | Train Loss: 1.4984 | Train Acc: 0.4427
 Site-Southeast_Asian           (2) | Train Loss: 1.8116 | Train Acc: 0.3750
 Site-Southeast_Asian           (2) | Train Loss: 1.7169 | Train Acc: 0.3854
 Site-Asian_ffhq                (1) | Train Loss: 1.2743 | Train Acc: 0.6250
 Site-Asian_ffhq                (6) | Train Loss: 0.8316 | Train Acc: 0.6667
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 0.8139 | Train Acc: 0.8281
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.2029 | Train Acc: 0.4583
Average Train Accuracy: 0.4684
 Site-White_utk                 (0) | Val  Loss: 1.6219 | Val  Acc: 0.4524
 Site-White_utk                 (0) | Val  Loss: 1.6951 | Val  Acc: 0.3203
 Site-East_Asian                (2) | Val  Loss: 1.7858 | Val  Acc: 0.3333
 Site-East_Asian                (2) | Val  Loss: 1.5535 | Val  Acc: 0.4297
 Site-Indian_utk                (0) | Val  Loss: 1.4328 | Val  Acc: 0.4286
 Site-Indian_utk                (0) | Val  Loss: 1.5163 | Val  Acc: 0.4297
 Site-Black_utk                 (5) | Val  Loss: 1.4454 | Val  Acc: 0.4762
 Site-Black_utk                 (5) | Val  Loss: 1.5396 | Val  Acc: 0.4297
 Site-Southeast_Asian           (2) | Val  Loss: 1.7813 | Val  Acc: 0.3810
 Site-Southeast_Asian           (2) | Val  Loss: 1.7606 | Val  Acc: 0.3750
 Site-Asian_ffhq                (1) | Val  Loss: 0.7526 | Val  Acc: 0.7143
 Site-Asian_ffhq                (6) | Val  Loss: 0.9140 | Val  Acc: 0.5938
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 2.0789 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.2873 | Val  Acc: 0.4219
Average Valid Accuracy: 0.4218
============ Train epoch 26 ============
cnt=[2, 4, 1, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-White_utk                 (3) | Train Loss: 1.4989 | Train Acc: 0.3906
 Site-White_utk                 (3) | Train Loss: 1.3943 | Train Acc: 0.4479
 Site-East_Asian                (1) | Train Loss: 1.3774 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.4421 | Train Acc: 0.4479
 Site-Indian_utk                (3) | Train Loss: 1.3968 | Train Acc: 0.4688
 Site-Indian_utk                (3) | Train Loss: 1.4070 | Train Acc: 0.4844
 Site-Black_utk                 (0) | Train Loss: 1.4944 | Train Acc: 0.4375
 Site-Black_utk                 (0) | Train Loss: 1.4262 | Train Acc: 0.5208
 Site-Southeast_Asian           (1) | Train Loss: 1.6143 | Train Acc: 0.4219
 Site-Southeast_Asian           (1) | Train Loss: 1.4399 | Train Acc: 0.4792
 Site-Asian_ffhq                (6) | Train Loss: 1.7233 | Train Acc: 0.4844
 Site-Asian_ffhq                (2) | Train Loss: 1.3243 | Train Acc: 0.5365
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.2389 | Train Acc: 0.7031
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.4377 | Train Acc: 0.4115
Average Train Accuracy: 0.4810
 Site-White_utk                 (3) | Val  Loss: 1.3946 | Val  Acc: 0.4286
 Site-White_utk                 (3) | Val  Loss: 1.3641 | Val  Acc: 0.5156
 Site-East_Asian                (1) | Val  Loss: 1.5515 | Val  Acc: 0.4286
 Site-East_Asian                (1) | Val  Loss: 1.3879 | Val  Acc: 0.4922
 Site-Indian_utk                (3) | Val  Loss: 1.3777 | Val  Acc: 0.4762
 Site-Indian_utk                (3) | Val  Loss: 1.4692 | Val  Acc: 0.4531
 Site-Black_utk                 (0) | Val  Loss: 1.3678 | Val  Acc: 0.6429
 Site-Black_utk                 (0) | Val  Loss: 1.4889 | Val  Acc: 0.5000
 Site-Southeast_Asian           (1) | Val  Loss: 1.5225 | Val  Acc: 0.4048
 Site-Southeast_Asian           (1) | Val  Loss: 1.5015 | Val  Acc: 0.4453
 Site-Asian_ffhq                (6) | Val  Loss: 1.2892 | Val  Acc: 0.6190
 Site-Asian_ffhq                (2) | Val  Loss: 1.3514 | Val  Acc: 0.4609
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.9035 | Val  Acc: 0.0952
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.4461 | Val  Acc: 0.4375
Average Valid Accuracy: 0.4571
============ Train epoch 27 ============
cnt=[4, 2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-White_utk                 (1) | Train Loss: 1.4901 | Train Acc: 0.3594
 Site-White_utk                 (1) | Train Loss: 1.3704 | Train Acc: 0.4896
 Site-East_Asian                (0) | Train Loss: 1.3328 | Train Acc: 0.4844
 Site-East_Asian                (0) | Train Loss: 1.4586 | Train Acc: 0.4479
 Site-Indian_utk                (5) | Train Loss: 1.4216 | Train Acc: 0.4844
 Site-Indian_utk                (5) | Train Loss: 1.3885 | Train Acc: 0.5260
 Site-Black_utk                 (3) | Train Loss: 1.4486 | Train Acc: 0.4688
 Site-Black_utk                 (3) | Train Loss: 1.4473 | Train Acc: 0.4688
 Site-Southeast_Asian           (0) | Train Loss: 1.5843 | Train Acc: 0.3906
 Site-Southeast_Asian           (0) | Train Loss: 1.4692 | Train Acc: 0.4427
 Site-Asian_ffhq                (6) | Train Loss: 1.7810 | Train Acc: 0.4688
 Site-Asian_ffhq                (4) | Train Loss: 1.3847 | Train Acc: 0.5208
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.2945 | Train Acc: 0.6406
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5121 | Train Acc: 0.4062
Average Train Accuracy: 0.4714
 Site-White_utk                 (1) | Val  Loss: 1.3402 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.3447 | Val  Acc: 0.5234
 Site-East_Asian                (0) | Val  Loss: 1.5078 | Val  Acc: 0.4286
 Site-East_Asian                (0) | Val  Loss: 1.4070 | Val  Acc: 0.4766
 Site-Indian_utk                (5) | Val  Loss: 1.4044 | Val  Acc: 0.4524
 Site-Indian_utk                (5) | Val  Loss: 1.4487 | Val  Acc: 0.4766
 Site-Black_utk                 (3) | Val  Loss: 1.3282 | Val  Acc: 0.5952
 Site-Black_utk                 (3) | Val  Loss: 1.4224 | Val  Acc: 0.5391
 Site-Southeast_Asian           (0) | Val  Loss: 1.4669 | Val  Acc: 0.4762
 Site-Southeast_Asian           (0) | Val  Loss: 1.5188 | Val  Acc: 0.3984
 Site-Asian_ffhq                (6) | Val  Loss: 1.3259 | Val  Acc: 0.6190
 Site-Asian_ffhq                (4) | Val  Loss: 1.4865 | Val  Acc: 0.4453
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8994 | Val  Acc: 0.1429
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.4810 | Val  Acc: 0.4141
Average Valid Accuracy: 0.4634
============ Train epoch 28 ============
cnt=[2, 2, 4, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-White_utk                 (3) | Train Loss: 1.4772 | Train Acc: 0.3281
 Site-White_utk                 (3) | Train Loss: 1.3518 | Train Acc: 0.5365
 Site-East_Asian                (2) | Train Loss: 1.3234 | Train Acc: 0.4844
 Site-East_Asian                (2) | Train Loss: 1.4555 | Train Acc: 0.4323
 Site-Indian_utk                (0) | Train Loss: 1.3619 | Train Acc: 0.5312
 Site-Indian_utk                (0) | Train Loss: 1.3836 | Train Acc: 0.5156
 Site-Black_utk                 (6) | Train Loss: 1.4354 | Train Acc: 0.5000
 Site-Black_utk                 (6) | Train Loss: 1.4624 | Train Acc: 0.4844
 Site-Southeast_Asian           (2) | Train Loss: 1.6007 | Train Acc: 0.4531
 Site-Southeast_Asian           (2) | Train Loss: 1.4658 | Train Acc: 0.4740
 Site-Asian_ffhq                (5) | Train Loss: 1.8644 | Train Acc: 0.3594
 Site-Asian_ffhq                (1) | Train Loss: 1.4394 | Train Acc: 0.5000
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.3255 | Train Acc: 0.5938
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.5106 | Train Acc: 0.3750
Average Train Accuracy: 0.4691
 Site-White_utk                 (3) | Val  Loss: 1.3172 | Val  Acc: 0.6190
 Site-White_utk                 (3) | Val  Loss: 1.3534 | Val  Acc: 0.5625
 Site-East_Asian                (2) | Val  Loss: 1.5598 | Val  Acc: 0.4762
 Site-East_Asian                (2) | Val  Loss: 1.4079 | Val  Acc: 0.4844
 Site-Indian_utk                (0) | Val  Loss: 1.4649 | Val  Acc: 0.4286
 Site-Indian_utk                (0) | Val  Loss: 1.4500 | Val  Acc: 0.4609
 Site-Black_utk                 (6) | Val  Loss: 1.3719 | Val  Acc: 0.5714
 Site-Black_utk                 (6) | Val  Loss: 1.4375 | Val  Acc: 0.5156
 Site-Southeast_Asian           (2) | Val  Loss: 1.5348 | Val  Acc: 0.4762
 Site-Southeast_Asian           (2) | Val  Loss: 1.4778 | Val  Acc: 0.4922
 Site-Asian_ffhq                (5) | Val  Loss: 1.3778 | Val  Acc: 0.6429
 Site-Asian_ffhq                (1) | Val  Loss: 1.4982 | Val  Acc: 0.3984
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8148 | Val  Acc: 0.2619
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.4666 | Val  Acc: 0.4375
Average Valid Accuracy: 0.4877
 Best site-White_utk                (3)  | Epoch:28 | Val Acc: 0.6190
 Best site-White_utk                (3)  | Epoch:28 | Val Acc: 0.5625
 Best site-East_Asian               (2)  | Epoch:28 | Val Acc: 0.4762
 Best site-East_Asian               (2)  | Epoch:28 | Val Acc: 0.4844
 Best site-Indian_utk               (0)  | Epoch:28 | Val Acc: 0.4286
 Best site-Indian_utk               (0)  | Epoch:28 | Val Acc: 0.4609
 Best site-Black_utk                (6)  | Epoch:28 | Val Acc: 0.5714
 Best site-Black_utk                (6)  | Epoch:28 | Val Acc: 0.5156
 Best site-Southeast_Asian          (2)  | Epoch:28 | Val Acc: 0.4762
 Best site-Southeast_Asian          (2)  | Epoch:28 | Val Acc: 0.4922
 Best site-Asian_ffhq               (5)  | Epoch:28 | Val Acc: 0.6429
 Best site-Asian_ffhq               (1)  | Epoch:28 | Val Acc: 0.3984
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:28 | Val Acc: 0.2619
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:28 | Val Acc: 0.4375
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 29 ============
cnt=[1, 1, 4, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-White_utk                 (2) | Train Loss: 1.5054 | Train Acc: 0.3750
 Site-White_utk                 (2) | Train Loss: 1.3716 | Train Acc: 0.5052
 Site-East_Asian                (3) | Train Loss: 1.3279 | Train Acc: 0.5000
 Site-East_Asian                (3) | Train Loss: 1.3863 | Train Acc: 0.4688
 Site-Indian_utk                (2) | Train Loss: 1.3627 | Train Acc: 0.5312
 Site-Indian_utk                (2) | Train Loss: 1.3683 | Train Acc: 0.5469
 Site-Black_utk                 (5) | Train Loss: 1.4257 | Train Acc: 0.5000
 Site-Black_utk                 (5) | Train Loss: 1.4364 | Train Acc: 0.5260
 Site-Southeast_Asian           (3) | Train Loss: 1.6001 | Train Acc: 0.3750
 Site-Southeast_Asian           (3) | Train Loss: 1.4596 | Train Acc: 0.4896
 Site-Asian_ffhq                (0) | Train Loss: 1.6781 | Train Acc: 0.4531
 Site-Asian_ffhq                (6) | Train Loss: 1.3250 | Train Acc: 0.5260
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.1698 | Train Acc: 0.7188
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.4539 | Train Acc: 0.4062
Average Train Accuracy: 0.4944
 Site-White_utk                 (2) | Val  Loss: 1.3114 | Val  Acc: 0.5476
 Site-White_utk                 (2) | Val  Loss: 1.3536 | Val  Acc: 0.4922
 Site-East_Asian                (3) | Val  Loss: 1.4981 | Val  Acc: 0.4286
 Site-East_Asian                (3) | Val  Loss: 1.3799 | Val  Acc: 0.4922
 Site-Indian_utk                (2) | Val  Loss: 1.3887 | Val  Acc: 0.4048
 Site-Indian_utk                (2) | Val  Loss: 1.4318 | Val  Acc: 0.5156
 Site-Black_utk                 (5) | Val  Loss: 1.4087 | Val  Acc: 0.5238
 Site-Black_utk                 (5) | Val  Loss: 1.4484 | Val  Acc: 0.5391
 Site-Southeast_Asian           (3) | Val  Loss: 1.4616 | Val  Acc: 0.4524
 Site-Southeast_Asian           (3) | Val  Loss: 1.4750 | Val  Acc: 0.4453
 Site-Asian_ffhq                (0) | Val  Loss: 1.2785 | Val  Acc: 0.6429
 Site-Asian_ffhq                (6) | Val  Loss: 1.4510 | Val  Acc: 0.4453
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.7913 | Val  Acc: 0.2143
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.4233 | Val  Acc: 0.4453
Average Valid Accuracy: 0.4707
 Test site-White_utk                 (2)| Epoch:28 | Test Acc: 0.3350
 Test site-East_Asian                (3)| Epoch:28 | Test Acc: 0.4826
 Test site-Indian_utk                (2)| Epoch:28 | Test Acc: 0.5000
 Test site-Black_utk                 (5)| Epoch:28 | Test Acc: 0.3929
 Test site-Southeast_Asian           (3)| Epoch:28 | Test Acc: 0.4229
 Test site-Asian_ffhq                (0)| Epoch:28 | Test Acc: 0.3015
 Test site-Latino_Hispanic_ffhq      (4)| Epoch:28 | Test Acc: 0.2836
White_utk: 0.3350, East_Asian: 0.4826, Indian_utk: 0.5000, Black_utk: 0.3929, Southeast_Asian: 0.4229, Asian_ffhq: 0.3015, Latino_Hispanic_ffhq: 0.2836, 
Average Test Accuracy(group): 0.3883, Average Test Accuracy(individual): 0.3883,
domain std=0.0792, cluster std=0.0659, individual std=0.0792, 
============ Train epoch 30 ============
cnt=[4, 2, 1, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-White_utk                 (3) | Train Loss: 1.5726 | Train Acc: 0.3438
 Site-White_utk                 (3) | Train Loss: 1.4600 | Train Acc: 0.4323
 Site-East_Asian                (0) | Train Loss: 1.3876 | Train Acc: 0.4688
 Site-East_Asian                (0) | Train Loss: 1.4083 | Train Acc: 0.4479
 Site-Indian_utk                (3) | Train Loss: 1.3621 | Train Acc: 0.4844
 Site-Indian_utk                (3) | Train Loss: 1.3486 | Train Acc: 0.4896
 Site-Black_utk                 (1) | Train Loss: 1.4061 | Train Acc: 0.4688
 Site-Black_utk                 (1) | Train Loss: 1.4020 | Train Acc: 0.5208
 Site-Southeast_Asian           (0) | Train Loss: 1.6791 | Train Acc: 0.4375
 Site-Southeast_Asian           (0) | Train Loss: 1.5232 | Train Acc: 0.4323
 Site-Asian_ffhq                (2) | Train Loss: 1.4462 | Train Acc: 0.5000
 Site-Asian_ffhq                (4) | Train Loss: 1.1008 | Train Acc: 0.6146
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.0081 | Train Acc: 0.7500
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.2843 | Train Acc: 0.4583
Average Train Accuracy: 0.4892
 Site-White_utk                 (3) | Val  Loss: 1.4139 | Val  Acc: 0.5000
 Site-White_utk                 (3) | Val  Loss: 1.4318 | Val  Acc: 0.4453
 Site-East_Asian                (0) | Val  Loss: 1.5528 | Val  Acc: 0.3810
 Site-East_Asian                (0) | Val  Loss: 1.4279 | Val  Acc: 0.4531
 Site-Indian_utk                (3) | Val  Loss: 1.3069 | Val  Acc: 0.4762
 Site-Indian_utk                (3) | Val  Loss: 1.3989 | Val  Acc: 0.5000
 Site-Black_utk                 (1) | Val  Loss: 1.3440 | Val  Acc: 0.6429
 Site-Black_utk                 (1) | Val  Loss: 1.4279 | Val  Acc: 0.5000
 Site-Southeast_Asian           (0) | Val  Loss: 1.6229 | Val  Acc: 0.4286
 Site-Southeast_Asian           (0) | Val  Loss: 1.5475 | Val  Acc: 0.4219
 Site-Asian_ffhq                (2) | Val  Loss: 1.0255 | Val  Acc: 0.7143
 Site-Asian_ffhq                (4) | Val  Loss: 1.1739 | Val  Acc: 0.5234
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.8321 | Val  Acc: 0.1905
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.3064 | Val  Acc: 0.4062
Average Valid Accuracy: 0.4702
============ Train epoch 31 ============
cnt=[4, 4, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-White_utk                 (0) | Train Loss: 1.4869 | Train Acc: 0.3906
 Site-White_utk                 (0) | Train Loss: 1.3982 | Train Acc: 0.4740
 Site-East_Asian                (1) | Train Loss: 1.3348 | Train Acc: 0.4844
 Site-East_Asian                (1) | Train Loss: 1.4251 | Train Acc: 0.4479
 Site-Indian_utk                (0) | Train Loss: 1.3448 | Train Acc: 0.5312
 Site-Indian_utk                (0) | Train Loss: 1.3411 | Train Acc: 0.4740
 Site-Black_utk                 (3) | Train Loss: 1.3898 | Train Acc: 0.5312
 Site-Black_utk                 (3) | Train Loss: 1.3889 | Train Acc: 0.5156
 Site-Southeast_Asian           (1) | Train Loss: 1.5976 | Train Acc: 0.4219
 Site-Southeast_Asian           (1) | Train Loss: 1.4307 | Train Acc: 0.4688
 Site-Asian_ffhq                (6) | Train Loss: 1.6234 | Train Acc: 0.4844
 Site-Asian_ffhq                (4) | Train Loss: 1.2672 | Train Acc: 0.5625
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.1572 | Train Acc: 0.6562
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.4121 | Train Acc: 0.4167
Average Train Accuracy: 0.4900
 Site-White_utk                 (0) | Val  Loss: 1.3680 | Val  Acc: 0.5000
 Site-White_utk                 (0) | Val  Loss: 1.3847 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.5450 | Val  Acc: 0.4286
 Site-East_Asian                (1) | Val  Loss: 1.3649 | Val  Acc: 0.4844
 Site-Indian_utk                (0) | Val  Loss: 1.3263 | Val  Acc: 0.4524
 Site-Indian_utk                (0) | Val  Loss: 1.3927 | Val  Acc: 0.4766
 Site-Black_utk                 (3) | Val  Loss: 1.2869 | Val  Acc: 0.6667
 Site-Black_utk                 (3) | Val  Loss: 1.4229 | Val  Acc: 0.5078
 Site-Southeast_Asian           (1) | Val  Loss: 1.4993 | Val  Acc: 0.3571
 Site-Southeast_Asian           (1) | Val  Loss: 1.5099 | Val  Acc: 0.4375
 Site-Asian_ffhq                (6) | Val  Loss: 1.2108 | Val  Acc: 0.6905
 Site-Asian_ffhq                (4) | Val  Loss: 1.3196 | Val  Acc: 0.4688
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8358 | Val  Acc: 0.1667
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.4059 | Val  Acc: 0.4062
Average Valid Accuracy: 0.4674
============ Train epoch 32 ============
cnt=[2, 4, 2, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-White_utk                 (4) | Train Loss: 1.4670 | Train Acc: 0.3750
 Site-White_utk                 (4) | Train Loss: 1.3744 | Train Acc: 0.4531
 Site-East_Asian                (1) | Train Loss: 1.3069 | Train Acc: 0.5156
 Site-East_Asian                (1) | Train Loss: 1.4033 | Train Acc: 0.4583
 Site-Indian_utk                (2) | Train Loss: 1.3096 | Train Acc: 0.5469
 Site-Indian_utk                (2) | Train Loss: 1.3560 | Train Acc: 0.4792
 Site-Black_utk                 (6) | Train Loss: 1.4177 | Train Acc: 0.4375
 Site-Black_utk                 (6) | Train Loss: 1.3739 | Train Acc: 0.5208
 Site-Southeast_Asian           (1) | Train Loss: 1.5889 | Train Acc: 0.4375
 Site-Southeast_Asian           (1) | Train Loss: 1.4471 | Train Acc: 0.4375
 Site-Asian_ffhq                (3) | Train Loss: 1.5467 | Train Acc: 0.5000
 Site-Asian_ffhq                (0) | Train Loss: 1.2189 | Train Acc: 0.5677
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.1315 | Train Acc: 0.6250
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.3420 | Train Acc: 0.4531
Average Train Accuracy: 0.4862
 Site-White_utk                 (4) | Val  Loss: 1.3673 | Val  Acc: 0.5476
 Site-White_utk                 (4) | Val  Loss: 1.3510 | Val  Acc: 0.4766
 Site-East_Asian                (1) | Val  Loss: 1.5466 | Val  Acc: 0.4762
 Site-East_Asian                (1) | Val  Loss: 1.3644 | Val  Acc: 0.4844
 Site-Indian_utk                (2) | Val  Loss: 1.3403 | Val  Acc: 0.4286
 Site-Indian_utk                (2) | Val  Loss: 1.3598 | Val  Acc: 0.4922
 Site-Black_utk                 (6) | Val  Loss: 1.3149 | Val  Acc: 0.5952
 Site-Black_utk                 (6) | Val  Loss: 1.3908 | Val  Acc: 0.4922
 Site-Southeast_Asian           (1) | Val  Loss: 1.5505 | Val  Acc: 0.3571
 Site-Southeast_Asian           (1) | Val  Loss: 1.4592 | Val  Acc: 0.4375
 Site-Asian_ffhq                (3) | Val  Loss: 1.1910 | Val  Acc: 0.6429
 Site-Asian_ffhq                (0) | Val  Loss: 1.2934 | Val  Acc: 0.4844
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7994 | Val  Acc: 0.2143
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.3876 | Val  Acc: 0.4141
Average Valid Accuracy: 0.4674
============ Train epoch 33 ============
cnt=[4, 4, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-White_utk                 (0) | Train Loss: 1.5289 | Train Acc: 0.3125
 Site-White_utk                 (0) | Train Loss: 1.3886 | Train Acc: 0.4948
 Site-East_Asian                (1) | Train Loss: 1.2960 | Train Acc: 0.4688
 Site-East_Asian                (1) | Train Loss: 1.4068 | Train Acc: 0.4740
 Site-Indian_utk                (0) | Train Loss: 1.3323 | Train Acc: 0.4844
 Site-Indian_utk                (0) | Train Loss: 1.3511 | Train Acc: 0.5104
 Site-Black_utk                 (4) | Train Loss: 1.4062 | Train Acc: 0.4531
 Site-Black_utk                 (4) | Train Loss: 1.3503 | Train Acc: 0.5208
 Site-Southeast_Asian           (1) | Train Loss: 1.6023 | Train Acc: 0.4062
 Site-Southeast_Asian           (1) | Train Loss: 1.4510 | Train Acc: 0.4323
 Site-Asian_ffhq                (6) | Train Loss: 1.5168 | Train Acc: 0.4844
 Site-Asian_ffhq                (5) | Train Loss: 1.2123 | Train Acc: 0.5521
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.1635 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.3134 | Train Acc: 0.4583
Average Train Accuracy: 0.4803
 Site-White_utk                 (0) | Val  Loss: 1.2884 | Val  Acc: 0.5238
 Site-White_utk                 (0) | Val  Loss: 1.3727 | Val  Acc: 0.4922
 Site-East_Asian                (1) | Val  Loss: 1.5268 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.3801 | Val  Acc: 0.5000
 Site-Indian_utk                (0) | Val  Loss: 1.3358 | Val  Acc: 0.5238
 Site-Indian_utk                (0) | Val  Loss: 1.3775 | Val  Acc: 0.5312
 Site-Black_utk                 (4) | Val  Loss: 1.2602 | Val  Acc: 0.6429
 Site-Black_utk                 (4) | Val  Loss: 1.3784 | Val  Acc: 0.5312
 Site-Southeast_Asian           (1) | Val  Loss: 1.5459 | Val  Acc: 0.4286
 Site-Southeast_Asian           (1) | Val  Loss: 1.4819 | Val  Acc: 0.4375
 Site-Asian_ffhq                (6) | Val  Loss: 1.1863 | Val  Acc: 0.6429
 Site-Asian_ffhq                (5) | Val  Loss: 1.2591 | Val  Acc: 0.4766
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.7482 | Val  Acc: 0.2857
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.3065 | Val  Acc: 0.4453
Average Valid Accuracy: 0.4973
 Best site-White_utk                (0)  | Epoch:33 | Val Acc: 0.5238
 Best site-White_utk                (0)  | Epoch:33 | Val Acc: 0.4922
 Best site-East_Asian               (1)  | Epoch:33 | Val Acc: 0.5000
 Best site-East_Asian               (1)  | Epoch:33 | Val Acc: 0.5000
 Best site-Indian_utk               (0)  | Epoch:33 | Val Acc: 0.5238
 Best site-Indian_utk               (0)  | Epoch:33 | Val Acc: 0.5312
 Best site-Black_utk                (4)  | Epoch:33 | Val Acc: 0.6429
 Best site-Black_utk                (4)  | Epoch:33 | Val Acc: 0.5312
 Best site-Southeast_Asian          (1)  | Epoch:33 | Val Acc: 0.4286
 Best site-Southeast_Asian          (1)  | Epoch:33 | Val Acc: 0.4375
 Best site-Asian_ffhq               (6)  | Epoch:33 | Val Acc: 0.6429
 Best site-Asian_ffhq               (5)  | Epoch:33 | Val Acc: 0.4766
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:33 | Val Acc: 0.2857
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:33 | Val Acc: 0.4453
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 34 ============
cnt=[3, 2, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-White_utk                 (4) | Train Loss: 1.4668 | Train Acc: 0.3750
 Site-White_utk                 (4) | Train Loss: 1.3592 | Train Acc: 0.4792
 Site-East_Asian                (3) | Train Loss: 1.3399 | Train Acc: 0.4844
 Site-East_Asian                (3) | Train Loss: 1.4101 | Train Acc: 0.4740
 Site-Indian_utk                (6) | Train Loss: 1.3495 | Train Acc: 0.4531
 Site-Indian_utk                (5) | Train Loss: 1.3382 | Train Acc: 0.5104
 Site-Black_utk                 (1) | Train Loss: 1.3812 | Train Acc: 0.5000
 Site-Black_utk                 (1) | Train Loss: 1.3855 | Train Acc: 0.5052
 Site-Southeast_Asian           (3) | Train Loss: 1.5916 | Train Acc: 0.4219
 Site-Southeast_Asian           (3) | Train Loss: 1.4331 | Train Acc: 0.4688
 Site-Asian_ffhq                (2) | Train Loss: 1.6397 | Train Acc: 0.5156
 Site-Asian_ffhq                (0) | Train Loss: 1.2605 | Train Acc: 0.5469
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.1793 | Train Acc: 0.6250
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.3819 | Train Acc: 0.4375
Average Train Accuracy: 0.4855
 Site-White_utk                 (4) | Val  Loss: 1.3773 | Val  Acc: 0.4762
 Site-White_utk                 (4) | Val  Loss: 1.3697 | Val  Acc: 0.4688
 Site-East_Asian                (3) | Val  Loss: 1.4687 | Val  Acc: 0.4762
 Site-East_Asian                (3) | Val  Loss: 1.3688 | Val  Acc: 0.4922
 Site-Indian_utk                (6) | Val  Loss: 1.3341 | Val  Acc: 0.4524
 Site-Indian_utk                (5) | Val  Loss: 1.3767 | Val  Acc: 0.4766
 Site-Black_utk                 (1) | Val  Loss: 1.2780 | Val  Acc: 0.5952
 Site-Black_utk                 (1) | Val  Loss: 1.4132 | Val  Acc: 0.5078
 Site-Southeast_Asian           (3) | Val  Loss: 1.5082 | Val  Acc: 0.4762
 Site-Southeast_Asian           (3) | Val  Loss: 1.4585 | Val  Acc: 0.4922
 Site-Asian_ffhq                (2) | Val  Loss: 1.2075 | Val  Acc: 0.6905
 Site-Asian_ffhq                (0) | Val  Loss: 1.3236 | Val  Acc: 0.4609
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.7909 | Val  Acc: 0.2143
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.3788 | Val  Acc: 0.4297
Average Valid Accuracy: 0.4792
============ Train epoch 35 ============
cnt=[2, 1, 1, 2, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-White_utk                 (4) | Train Loss: 1.5368 | Train Acc: 0.3281
 Site-White_utk                 (4) | Train Loss: 1.4127 | Train Acc: 0.4427
 Site-East_Asian                (5) | Train Loss: 1.3315 | Train Acc: 0.4688
 Site-East_Asian                (5) | Train Loss: 1.3691 | Train Acc: 0.4531
 Site-Indian_utk                (4) | Train Loss: 1.3437 | Train Acc: 0.5000
 Site-Indian_utk                (4) | Train Loss: 1.3127 | Train Acc: 0.5000
 Site-Black_utk                 (0) | Train Loss: 1.4051 | Train Acc: 0.4844
 Site-Black_utk                 (0) | Train Loss: 1.4114 | Train Acc: 0.5052
 Site-Southeast_Asian           (2) | Train Loss: 1.6279 | Train Acc: 0.4219
 Site-Southeast_Asian           (5) | Train Loss: 1.4708 | Train Acc: 0.4219
 Site-Asian_ffhq                (6) | Train Loss: 1.4136 | Train Acc: 0.5312
 Site-Asian_ffhq                (3) | Train Loss: 1.0534 | Train Acc: 0.5990
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.0107 | Train Acc: 0.7344
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.2827 | Train Acc: 0.4427
Average Train Accuracy: 0.4881
 Site-White_utk                 (4) | Val  Loss: 1.3771 | Val  Acc: 0.5238
 Site-White_utk                 (4) | Val  Loss: 1.4339 | Val  Acc: 0.4375
 Site-East_Asian                (5) | Val  Loss: 1.5463 | Val  Acc: 0.3810
 Site-East_Asian                (5) | Val  Loss: 1.3847 | Val  Acc: 0.4688
 Site-Indian_utk                (4) | Val  Loss: 1.3221 | Val  Acc: 0.4524
 Site-Indian_utk                (4) | Val  Loss: 1.3681 | Val  Acc: 0.5000
 Site-Black_utk                 (0) | Val  Loss: 1.3147 | Val  Acc: 0.5476
 Site-Black_utk                 (0) | Val  Loss: 1.3864 | Val  Acc: 0.5078
 Site-Southeast_Asian           (2) | Val  Loss: 1.5073 | Val  Acc: 0.4286
 Site-Southeast_Asian           (5) | Val  Loss: 1.4718 | Val  Acc: 0.4219
 Site-Asian_ffhq                (6) | Val  Loss: 1.0111 | Val  Acc: 0.7381
 Site-Asian_ffhq                (3) | Val  Loss: 1.1487 | Val  Acc: 0.5234
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.7889 | Val  Acc: 0.1905
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.2965 | Val  Acc: 0.4766
Average Valid Accuracy: 0.4713
============ Train epoch 36 ============
cnt=[2, 2, 4, 1, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-White_utk                 (1) | Train Loss: 1.4991 | Train Acc: 0.3594
 Site-White_utk                 (1) | Train Loss: 1.3411 | Train Acc: 0.5104
 Site-East_Asian                (2) | Train Loss: 1.3564 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.3429 | Train Acc: 0.4844
 Site-Indian_utk                (6) | Train Loss: 1.3558 | Train Acc: 0.5000
 Site-Indian_utk                (6) | Train Loss: 1.3419 | Train Acc: 0.5260
 Site-Black_utk                 (5) | Train Loss: 1.3979 | Train Acc: 0.5000
 Site-Black_utk                 (5) | Train Loss: 1.4308 | Train Acc: 0.5469
 Site-Southeast_Asian           (2) | Train Loss: 1.6042 | Train Acc: 0.4219
 Site-Southeast_Asian           (2) | Train Loss: 1.4179 | Train Acc: 0.4844
 Site-Asian_ffhq                (3) | Train Loss: 1.5018 | Train Acc: 0.4688
 Site-Asian_ffhq                (0) | Train Loss: 1.1624 | Train Acc: 0.5833
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.1253 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.3446 | Train Acc: 0.4427
Average Train Accuracy: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.3354 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.3372 | Val  Acc: 0.5234
 Site-East_Asian                (2) | Val  Loss: 1.4681 | Val  Acc: 0.4762
 Site-East_Asian                (2) | Val  Loss: 1.3479 | Val  Acc: 0.4922
 Site-Indian_utk                (6) | Val  Loss: 1.3030 | Val  Acc: 0.4762
 Site-Indian_utk                (6) | Val  Loss: 1.3851 | Val  Acc: 0.5391
 Site-Black_utk                 (5) | Val  Loss: 1.2949 | Val  Acc: 0.6190
 Site-Black_utk                 (5) | Val  Loss: 1.3539 | Val  Acc: 0.5391
 Site-Southeast_Asian           (2) | Val  Loss: 1.4417 | Val  Acc: 0.4524
 Site-Southeast_Asian           (2) | Val  Loss: 1.4427 | Val  Acc: 0.4766
 Site-Asian_ffhq                (3) | Val  Loss: 1.1278 | Val  Acc: 0.6190
 Site-Asian_ffhq                (0) | Val  Loss: 1.2284 | Val  Acc: 0.5000
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.7661 | Val  Acc: 0.1667
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.3228 | Val  Acc: 0.4609
Average Valid Accuracy: 0.4886
============ Train epoch 37 ============
cnt=[4, 2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-White_utk                 (1) | Train Loss: 1.4679 | Train Acc: 0.3438
 Site-White_utk                 (1) | Train Loss: 1.3614 | Train Acc: 0.4844
 Site-East_Asian                (0) | Train Loss: 1.3262 | Train Acc: 0.4844
 Site-East_Asian                (0) | Train Loss: 1.3839 | Train Acc: 0.4479
 Site-Indian_utk                (5) | Train Loss: 1.2885 | Train Acc: 0.5469
 Site-Indian_utk                (5) | Train Loss: 1.3404 | Train Acc: 0.4948
 Site-Black_utk                 (4) | Train Loss: 1.3584 | Train Acc: 0.5312
 Site-Black_utk                 (4) | Train Loss: 1.3772 | Train Acc: 0.5000
 Site-Southeast_Asian           (0) | Train Loss: 1.5584 | Train Acc: 0.4531
 Site-Southeast_Asian           (0) | Train Loss: 1.3799 | Train Acc: 0.4583
 Site-Asian_ffhq                (3) | Train Loss: 1.4538 | Train Acc: 0.5312
 Site-Asian_ffhq                (2) | Train Loss: 1.0966 | Train Acc: 0.6302
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 0.9925 | Train Acc: 0.7656
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3311 | Train Acc: 0.4062
Average Train Accuracy: 0.5056
 Site-White_utk                 (1) | Val  Loss: 1.2713 | Val  Acc: 0.4524
 Site-White_utk                 (1) | Val  Loss: 1.3614 | Val  Acc: 0.4766
 Site-East_Asian                (0) | Val  Loss: 1.5007 | Val  Acc: 0.4286
 Site-East_Asian                (0) | Val  Loss: 1.3736 | Val  Acc: 0.4766
 Site-Indian_utk                (5) | Val  Loss: 1.3061 | Val  Acc: 0.5000
 Site-Indian_utk                (5) | Val  Loss: 1.3952 | Val  Acc: 0.4766
 Site-Black_utk                 (4) | Val  Loss: 1.2659 | Val  Acc: 0.6429
 Site-Black_utk                 (4) | Val  Loss: 1.3717 | Val  Acc: 0.5234
 Site-Southeast_Asian           (0) | Val  Loss: 1.4465 | Val  Acc: 0.4762
 Site-Southeast_Asian           (0) | Val  Loss: 1.4529 | Val  Acc: 0.4844
 Site-Asian_ffhq                (3) | Val  Loss: 0.9942 | Val  Acc: 0.7143
 Site-Asian_ffhq                (2) | Val  Loss: 1.2113 | Val  Acc: 0.5078
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.7881 | Val  Acc: 0.1905
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.3306 | Val  Acc: 0.4297
Average Valid Accuracy: 0.4843
============ Train epoch 38 ============
cnt=[1, 4, 4, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-White_utk                 (1) | Train Loss: 1.4646 | Train Acc: 0.3750
 Site-White_utk                 (1) | Train Loss: 1.3441 | Train Acc: 0.4948
 Site-East_Asian                (2) | Train Loss: 1.3346 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.3775 | Train Acc: 0.4740
 Site-Indian_utk                (1) | Train Loss: 1.3169 | Train Acc: 0.5781
 Site-Indian_utk                (1) | Train Loss: 1.3545 | Train Acc: 0.5000
 Site-Black_utk                 (3) | Train Loss: 1.3695 | Train Acc: 0.5312
 Site-Black_utk                 (3) | Train Loss: 1.3370 | Train Acc: 0.5573
 Site-Southeast_Asian           (2) | Train Loss: 1.5066 | Train Acc: 0.4531
 Site-Southeast_Asian           (2) | Train Loss: 1.3627 | Train Acc: 0.5000
 Site-Asian_ffhq                (0) | Train Loss: 1.6939 | Train Acc: 0.4375
 Site-Asian_ffhq                (4) | Train Loss: 1.3175 | Train Acc: 0.5469
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.1884 | Train Acc: 0.6875
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.4016 | Train Acc: 0.4375
Average Train Accuracy: 0.5052
 Site-White_utk                 (1) | Val  Loss: 1.3307 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.3467 | Val  Acc: 0.5000
 Site-East_Asian                (2) | Val  Loss: 1.4824 | Val  Acc: 0.4762
 Site-East_Asian                (2) | Val  Loss: 1.3621 | Val  Acc: 0.4922
 Site-Indian_utk                (1) | Val  Loss: 1.2738 | Val  Acc: 0.5238
 Site-Indian_utk                (1) | Val  Loss: 1.3667 | Val  Acc: 0.5000
 Site-Black_utk                 (3) | Val  Loss: 1.2975 | Val  Acc: 0.5714
 Site-Black_utk                 (3) | Val  Loss: 1.3826 | Val  Acc: 0.5078
 Site-Southeast_Asian           (2) | Val  Loss: 1.3923 | Val  Acc: 0.5000
 Site-Southeast_Asian           (2) | Val  Loss: 1.4027 | Val  Acc: 0.4688
 Site-Asian_ffhq                (0) | Val  Loss: 1.2284 | Val  Acc: 0.6190
 Site-Asian_ffhq                (4) | Val  Loss: 1.4033 | Val  Acc: 0.4297
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7913 | Val  Acc: 0.2143
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.4260 | Val  Acc: 0.4297
Average Valid Accuracy: 0.4809
============ Train epoch 39 ============
cnt=[1, 1, 4, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-White_utk                 (4) | Train Loss: 1.4556 | Train Acc: 0.3906
 Site-White_utk                 (4) | Train Loss: 1.3522 | Train Acc: 0.5104
 Site-East_Asian                (2) | Train Loss: 1.3200 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.3381 | Train Acc: 0.5000
 Site-Indian_utk                (6) | Train Loss: 1.2933 | Train Acc: 0.5469
 Site-Indian_utk                (6) | Train Loss: 1.3112 | Train Acc: 0.5469
 Site-Black_utk                 (0) | Train Loss: 1.3774 | Train Acc: 0.5000
 Site-Black_utk                 (6) | Train Loss: 1.3451 | Train Acc: 0.5156
 Site-Southeast_Asian           (2) | Train Loss: 1.6196 | Train Acc: 0.4062
 Site-Southeast_Asian           (2) | Train Loss: 1.3910 | Train Acc: 0.5156
 Site-Asian_ffhq                (3) | Train Loss: 1.5148 | Train Acc: 0.4688
 Site-Asian_ffhq                (5) | Train Loss: 1.2009 | Train Acc: 0.5365
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.1250 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.3073 | Train Acc: 0.4583
Average Train Accuracy: 0.5048
 Site-White_utk                 (4) | Val  Loss: 1.3049 | Val  Acc: 0.5238
 Site-White_utk                 (4) | Val  Loss: 1.3634 | Val  Acc: 0.4844
 Site-East_Asian                (2) | Val  Loss: 1.4820 | Val  Acc: 0.5000
 Site-East_Asian                (2) | Val  Loss: 1.3315 | Val  Acc: 0.5312
 Site-Indian_utk                (6) | Val  Loss: 1.2826 | Val  Acc: 0.4762
 Site-Indian_utk                (6) | Val  Loss: 1.3754 | Val  Acc: 0.5078
 Site-Black_utk                 (0) | Val  Loss: 1.2569 | Val  Acc: 0.5238
 Site-Black_utk                 (6) | Val  Loss: 1.3584 | Val  Acc: 0.5469
 Site-Southeast_Asian           (2) | Val  Loss: 1.4640 | Val  Acc: 0.4524
 Site-Southeast_Asian           (2) | Val  Loss: 1.3880 | Val  Acc: 0.5234
 Site-Asian_ffhq                (3) | Val  Loss: 1.0937 | Val  Acc: 0.6667
 Site-Asian_ffhq                (5) | Val  Loss: 1.2352 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.7099 | Val  Acc: 0.2619
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.3223 | Val  Acc: 0.4531
Average Valid Accuracy: 0.4988
 Best site-White_utk                (4)  | Epoch:39 | Val Acc: 0.5238
 Best site-White_utk                (4)  | Epoch:39 | Val Acc: 0.4844
 Best site-East_Asian               (2)  | Epoch:39 | Val Acc: 0.5000
 Best site-East_Asian               (2)  | Epoch:39 | Val Acc: 0.5312
 Best site-Indian_utk               (6)  | Epoch:39 | Val Acc: 0.4762
 Best site-Indian_utk               (6)  | Epoch:39 | Val Acc: 0.5078
 Best site-Black_utk                (0)  | Epoch:39 | Val Acc: 0.5238
 Best site-Black_utk                (6)  | Epoch:39 | Val Acc: 0.5469
 Best site-Southeast_Asian          (2)  | Epoch:39 | Val Acc: 0.4524
 Best site-Southeast_Asian          (2)  | Epoch:39 | Val Acc: 0.5234
 Best site-Asian_ffhq               (3)  | Epoch:39 | Val Acc: 0.6667
 Best site-Asian_ffhq               (5)  | Epoch:39 | Val Acc: 0.5312
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:39 | Val Acc: 0.2619
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:39 | Val Acc: 0.4531
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Test site-White_utk                 (4)| Epoch:39 | Test Acc: 0.3227
 Test site-East_Asian                (2)| Epoch:39 | Test Acc: 0.4836
 Test site-Indian_utk                (6)| Epoch:39 | Test Acc: 0.5146
 Test site-Black_utk                 (0)| Epoch:39 | Test Acc: 0.4388
 Test site-Southeast_Asian           (2)| Epoch:39 | Test Acc: 0.4281
 Test site-Asian_ffhq                (3)| Epoch:39 | Test Acc: 0.3162
 Test site-Latino_Hispanic_ffhq      (3)| Epoch:39 | Test Acc: 0.3284
White_utk: 0.3227, East_Asian: 0.4836, Indian_utk: 0.5146, Black_utk: 0.4388, Southeast_Asian: 0.4281, Asian_ffhq: 0.3162, Latino_Hispanic_ffhq: 0.3284, 
Average Test Accuracy(group): 0.4046, Average Test Accuracy(individual): 0.4046,
domain std=0.0760, cluster std=0.0702, individual std=0.0760, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 40 ============
cnt=[1, 4, 2, 2, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-White_utk                 (6) | Train Loss: 1.4494 | Train Acc: 0.3906
 Site-White_utk                 (6) | Train Loss: 1.3366 | Train Acc: 0.4688
 Site-East_Asian                (1) | Train Loss: 1.3675 | Train Acc: 0.4688
 Site-East_Asian                (1) | Train Loss: 1.3542 | Train Acc: 0.4792
 Site-Indian_utk                (0) | Train Loss: 1.3428 | Train Acc: 0.5312
 Site-Indian_utk                (6) | Train Loss: 1.3270 | Train Acc: 0.5052
 Site-Black_utk                 (3) | Train Loss: 1.3447 | Train Acc: 0.4844
 Site-Black_utk                 (3) | Train Loss: 1.3162 | Train Acc: 0.5469
 Site-Southeast_Asian           (1) | Train Loss: 1.5241 | Train Acc: 0.4688
 Site-Southeast_Asian           (1) | Train Loss: 1.3774 | Train Acc: 0.4896
 Site-Asian_ffhq                (2) | Train Loss: 1.5277 | Train Acc: 0.5156
 Site-Asian_ffhq                (5) | Train Loss: 1.2370 | Train Acc: 0.5573
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.1565 | Train Acc: 0.7188
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.3580 | Train Acc: 0.4375
Average Train Accuracy: 0.5045
 Site-White_utk                 (6) | Val  Loss: 1.2726 | Val  Acc: 0.5238
 Site-White_utk                 (6) | Val  Loss: 1.3019 | Val  Acc: 0.4922
 Site-East_Asian                (1) | Val  Loss: 1.5125 | Val  Acc: 0.4762
 Site-East_Asian                (1) | Val  Loss: 1.3143 | Val  Acc: 0.5156
 Site-Indian_utk                (0) | Val  Loss: 1.2704 | Val  Acc: 0.5000
 Site-Indian_utk                (6) | Val  Loss: 1.3329 | Val  Acc: 0.5156
 Site-Black_utk                 (3) | Val  Loss: 1.2234 | Val  Acc: 0.6190
 Site-Black_utk                 (3) | Val  Loss: 1.3261 | Val  Acc: 0.5391
 Site-Southeast_Asian           (1) | Val  Loss: 1.4491 | Val  Acc: 0.4762
 Site-Southeast_Asian           (1) | Val  Loss: 1.3971 | Val  Acc: 0.5234
 Site-Asian_ffhq                (2) | Val  Loss: 1.1328 | Val  Acc: 0.6667
 Site-Asian_ffhq                (5) | Val  Loss: 1.2731 | Val  Acc: 0.4922
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.7392 | Val  Acc: 0.2143
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.3192 | Val  Acc: 0.4297
Average Valid Accuracy: 0.4989
 Best site-White_utk                (6)  | Epoch:40 | Val Acc: 0.5238
 Best site-White_utk                (6)  | Epoch:40 | Val Acc: 0.4922
 Best site-East_Asian               (1)  | Epoch:40 | Val Acc: 0.4762
 Best site-East_Asian               (1)  | Epoch:40 | Val Acc: 0.5156
 Best site-Indian_utk               (0)  | Epoch:40 | Val Acc: 0.5000
 Best site-Indian_utk               (6)  | Epoch:40 | Val Acc: 0.5156
 Best site-Black_utk                (3)  | Epoch:40 | Val Acc: 0.6190
 Best site-Black_utk                (3)  | Epoch:40 | Val Acc: 0.5391
 Best site-Southeast_Asian          (1)  | Epoch:40 | Val Acc: 0.4762
 Best site-Southeast_Asian          (1)  | Epoch:40 | Val Acc: 0.5234
 Best site-Asian_ffhq               (2)  | Epoch:40 | Val Acc: 0.6667
 Best site-Asian_ffhq               (5)  | Epoch:40 | Val Acc: 0.4922
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:40 | Val Acc: 0.2143
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:40 | Val Acc: 0.4297
 Test site-White_utk                 (6)| Epoch:40 | Test Acc: 0.3279
 Test site-East_Asian                (1)| Epoch:40 | Test Acc: 0.4905
 Test site-Indian_utk                (0)| Epoch:40 | Test Acc: 0.5167
 Test site-Black_utk                 (3)| Epoch:40 | Test Acc: 0.4235
 Test site-Southeast_Asian           (1)| Epoch:40 | Test Acc: 0.4333
 Test site-Asian_ffhq                (2)| Epoch:40 | Test Acc: 0.3088
 Test site-Latino_Hispanic_ffhq      (2)| Epoch:40 | Test Acc: 0.3085
White_utk: 0.3279, East_Asian: 0.4905, Indian_utk: 0.5167, Black_utk: 0.4235, Southeast_Asian: 0.4333, Asian_ffhq: 0.3088, Latino_Hispanic_ffhq: 0.3085, 
Average Test Accuracy(group): 0.4013, Average Test Accuracy(individual): 0.4013,
domain std=0.0805, cluster std=0.0776, individual std=0.0805, 
Average Test Accuracy: 0.4013
============ Train epoch 41 ============
cnt=[4, 2, 1, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-White_utk                 (1) | Train Loss: 1.5215 | Train Acc: 0.3594
 Site-White_utk                 (1) | Train Loss: 1.3234 | Train Acc: 0.5365
 Site-East_Asian                (0) | Train Loss: 1.3539 | Train Acc: 0.4375
 Site-East_Asian                (0) | Train Loss: 1.3488 | Train Acc: 0.4844
 Site-Indian_utk                (6) | Train Loss: 1.3224 | Train Acc: 0.5000
 Site-Indian_utk                (2) | Train Loss: 1.3220 | Train Acc: 0.4740
 Site-Black_utk                 (5) | Train Loss: 1.3942 | Train Acc: 0.5156
 Site-Black_utk                 (5) | Train Loss: 1.3529 | Train Acc: 0.5260
 Site-Southeast_Asian           (0) | Train Loss: 1.5607 | Train Acc: 0.4531
 Site-Southeast_Asian           (0) | Train Loss: 1.3712 | Train Acc: 0.5156
 Site-Asian_ffhq                (4) | Train Loss: 1.4783 | Train Acc: 0.5312
 Site-Asian_ffhq                (3) | Train Loss: 1.1275 | Train Acc: 0.5990
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.0895 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.2658 | Train Acc: 0.4375
Average Train Accuracy: 0.5030
 Site-White_utk                 (1) | Val  Loss: 1.3131 | Val  Acc: 0.5714
 Site-White_utk                 (1) | Val  Loss: 1.3414 | Val  Acc: 0.4766
 Site-East_Asian                (0) | Val  Loss: 1.4777 | Val  Acc: 0.4048
 Site-East_Asian                (0) | Val  Loss: 1.3513 | Val  Acc: 0.5078
 Site-Indian_utk                (6) | Val  Loss: 1.3501 | Val  Acc: 0.4524
 Site-Indian_utk                (2) | Val  Loss: 1.3726 | Val  Acc: 0.4375
 Site-Black_utk                 (5) | Val  Loss: 1.2718 | Val  Acc: 0.5714
 Site-Black_utk                 (5) | Val  Loss: 1.3333 | Val  Acc: 0.5625
 Site-Southeast_Asian           (0) | Val  Loss: 1.3582 | Val  Acc: 0.5238
 Site-Southeast_Asian           (0) | Val  Loss: 1.4119 | Val  Acc: 0.5312
 Site-Asian_ffhq                (4) | Val  Loss: 1.0868 | Val  Acc: 0.6667
 Site-Asian_ffhq                (3) | Val  Loss: 1.1921 | Val  Acc: 0.5000
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.6454 | Val  Acc: 0.2381
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.2802 | Val  Acc: 0.4453
Average Valid Accuracy: 0.4921
 Test site-White_utk                 (1)| Epoch:40 | Test Acc: 0.3186
 Test site-East_Asian                (0)| Epoch:40 | Test Acc: 0.4856
 Test site-Indian_utk                (6)| Epoch:40 | Test Acc: 0.5104
 Test site-Black_utk                 (5)| Epoch:40 | Test Acc: 0.4286
 Test site-Southeast_Asian           (0)| Epoch:40 | Test Acc: 0.4229
 Test site-Asian_ffhq                (4)| Epoch:40 | Test Acc: 0.3235
 Test site-Latino_Hispanic_ffhq      (3)| Epoch:40 | Test Acc: 0.3284
White_utk: 0.3186, East_Asian: 0.4856, Indian_utk: 0.5104, Black_utk: 0.4286, Southeast_Asian: 0.4229, Asian_ffhq: 0.3235, Latino_Hispanic_ffhq: 0.3284, 
Average Test Accuracy(group): 0.4026, Average Test Accuracy(individual): 0.4026,
domain std=0.0741, cluster std=0.0804, individual std=0.0741, 
Average Test Accuracy: 0.4026
============ Train epoch 42 ============
cnt=[2, 1, 4, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-White_utk                 (5) | Train Loss: 1.4302 | Train Acc: 0.3125
 Site-White_utk                 (5) | Train Loss: 1.3201 | Train Acc: 0.5052
 Site-East_Asian                (2) | Train Loss: 1.3021 | Train Acc: 0.5156
 Site-East_Asian                (2) | Train Loss: 1.3607 | Train Acc: 0.5000
 Site-Indian_utk                (3) | Train Loss: 1.3272 | Train Acc: 0.5469
 Site-Indian_utk                (3) | Train Loss: 1.2995 | Train Acc: 0.5260
 Site-Black_utk                 (0) | Train Loss: 1.3586 | Train Acc: 0.5000
 Site-Black_utk                 (0) | Train Loss: 1.3288 | Train Acc: 0.5521
 Site-Southeast_Asian           (2) | Train Loss: 1.4957 | Train Acc: 0.4375
 Site-Southeast_Asian           (2) | Train Loss: 1.3246 | Train Acc: 0.5208
 Site-Asian_ffhq                (6) | Train Loss: 1.6058 | Train Acc: 0.4688
 Site-Asian_ffhq                (4) | Train Loss: 1.2496 | Train Acc: 0.5625
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.1257 | Train Acc: 0.6875
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.3941 | Train Acc: 0.4062
Average Train Accuracy: 0.5030
 Site-White_utk                 (5) | Val  Loss: 1.2740 | Val  Acc: 0.5476
 Site-White_utk                 (5) | Val  Loss: 1.3017 | Val  Acc: 0.5234
 Site-East_Asian                (2) | Val  Loss: 1.4550 | Val  Acc: 0.4762
 Site-East_Asian                (2) | Val  Loss: 1.2995 | Val  Acc: 0.5312
 Site-Indian_utk                (3) | Val  Loss: 1.2396 | Val  Acc: 0.5238
 Site-Indian_utk                (3) | Val  Loss: 1.3384 | Val  Acc: 0.5078
 Site-Black_utk                 (0) | Val  Loss: 1.2732 | Val  Acc: 0.6429
 Site-Black_utk                 (0) | Val  Loss: 1.2949 | Val  Acc: 0.5547
 Site-Southeast_Asian           (2) | Val  Loss: 1.3804 | Val  Acc: 0.4762
 Site-Southeast_Asian           (2) | Val  Loss: 1.3729 | Val  Acc: 0.5156
 Site-Asian_ffhq                (6) | Val  Loss: 1.2029 | Val  Acc: 0.6905
 Site-Asian_ffhq                (4) | Val  Loss: 1.3504 | Val  Acc: 0.5156
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.7381 | Val  Acc: 0.1905
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.3636 | Val  Acc: 0.4219
Average Valid Accuracy: 0.5084
 Best site-White_utk                (5)  | Epoch:42 | Val Acc: 0.5476
 Best site-White_utk                (5)  | Epoch:42 | Val Acc: 0.5234
 Best site-East_Asian               (2)  | Epoch:42 | Val Acc: 0.4762
 Best site-East_Asian               (2)  | Epoch:42 | Val Acc: 0.5312
 Best site-Indian_utk               (3)  | Epoch:42 | Val Acc: 0.5238
 Best site-Indian_utk               (3)  | Epoch:42 | Val Acc: 0.5078
 Best site-Black_utk                (0)  | Epoch:42 | Val Acc: 0.6429
 Best site-Black_utk                (0)  | Epoch:42 | Val Acc: 0.5547
 Best site-Southeast_Asian          (2)  | Epoch:42 | Val Acc: 0.4762
 Best site-Southeast_Asian          (2)  | Epoch:42 | Val Acc: 0.5156
 Best site-Asian_ffhq               (6)  | Epoch:42 | Val Acc: 0.6905
 Best site-Asian_ffhq               (4)  | Epoch:42 | Val Acc: 0.5156
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:42 | Val Acc: 0.1905
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:42 | Val Acc: 0.4219
 Test site-White_utk                 (5)| Epoch:42 | Test Acc: 0.3381
 Test site-East_Asian                (2)| Epoch:42 | Test Acc: 0.4955
 Test site-Indian_utk                (3)| Epoch:42 | Test Acc: 0.5167
 Test site-Black_utk                 (0)| Epoch:42 | Test Acc: 0.4082
 Test site-Southeast_Asian           (2)| Epoch:42 | Test Acc: 0.4367
 Test site-Asian_ffhq                (6)| Epoch:42 | Test Acc: 0.3051
 Test site-Latino_Hispanic_ffhq      (1)| Epoch:42 | Test Acc: 0.2886
White_utk: 0.3381, East_Asian: 0.4955, Indian_utk: 0.5167, Black_utk: 0.4082, Southeast_Asian: 0.4367, Asian_ffhq: 0.3051, Latino_Hispanic_ffhq: 0.2886, 
Average Test Accuracy(group): 0.3984, Average Test Accuracy(individual): 0.3984,
domain std=0.0840, cluster std=0.0839, individual std=0.0840, 
Average Test Accuracy: 0.3984
============ Train epoch 43 ============
cnt=[2, 1, 4, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-White_utk                 (5) | Train Loss: 1.4873 | Train Acc: 0.3594
 Site-White_utk                 (5) | Train Loss: 1.3578 | Train Acc: 0.4583
 Site-East_Asian                (2) | Train Loss: 1.3130 | Train Acc: 0.4688
 Site-East_Asian                (2) | Train Loss: 1.3742 | Train Acc: 0.4792
 Site-Indian_utk                (5) | Train Loss: 1.2742 | Train Acc: 0.5625
 Site-Indian_utk                (5) | Train Loss: 1.3007 | Train Acc: 0.5104
 Site-Black_utk                 (1) | Train Loss: 1.3298 | Train Acc: 0.5312
 Site-Black_utk                 (4) | Train Loss: 1.3152 | Train Acc: 0.5417
 Site-Southeast_Asian           (2) | Train Loss: 1.5409 | Train Acc: 0.4531
 Site-Southeast_Asian           (2) | Train Loss: 1.3574 | Train Acc: 0.4740
 Site-Asian_ffhq                (6) | Train Loss: 1.4642 | Train Acc: 0.4844
 Site-Asian_ffhq                (0) | Train Loss: 1.1320 | Train Acc: 0.6042
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.0474 | Train Acc: 0.7031
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.2902 | Train Acc: 0.4583
Average Train Accuracy: 0.5063
 Site-White_utk                 (5) | Val  Loss: 1.2830 | Val  Acc: 0.5476
 Site-White_utk                 (5) | Val  Loss: 1.3252 | Val  Acc: 0.4609
 Site-East_Asian                (2) | Val  Loss: 1.3490 | Val  Acc: 0.5714
 Site-East_Asian                (2) | Val  Loss: 1.3136 | Val  Acc: 0.4922
 Site-Indian_utk                (5) | Val  Loss: 1.2496 | Val  Acc: 0.5714
 Site-Indian_utk                (5) | Val  Loss: 1.3295 | Val  Acc: 0.5078
 Site-Black_utk                 (1) | Val  Loss: 1.2715 | Val  Acc: 0.5476
 Site-Black_utk                 (4) | Val  Loss: 1.3201 | Val  Acc: 0.5312
 Site-Southeast_Asian           (2) | Val  Loss: 1.4152 | Val  Acc: 0.4762
 Site-Southeast_Asian           (2) | Val  Loss: 1.3851 | Val  Acc: 0.5156
 Site-Asian_ffhq                (6) | Val  Loss: 1.0468 | Val  Acc: 0.7143
 Site-Asian_ffhq                (0) | Val  Loss: 1.2196 | Val  Acc: 0.4844
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.7764 | Val  Acc: 0.2143
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.2822 | Val  Acc: 0.4922
Average Valid Accuracy: 0.5091
 Best site-White_utk                (5)  | Epoch:43 | Val Acc: 0.5476
 Best site-White_utk                (5)  | Epoch:43 | Val Acc: 0.4609
 Best site-East_Asian               (2)  | Epoch:43 | Val Acc: 0.5714
 Best site-East_Asian               (2)  | Epoch:43 | Val Acc: 0.4922
 Best site-Indian_utk               (5)  | Epoch:43 | Val Acc: 0.5714
 Best site-Indian_utk               (5)  | Epoch:43 | Val Acc: 0.5078
 Best site-Black_utk                (1)  | Epoch:43 | Val Acc: 0.5476
 Best site-Black_utk                (4)  | Epoch:43 | Val Acc: 0.5312
 Best site-Southeast_Asian          (2)  | Epoch:43 | Val Acc: 0.4762
 Best site-Southeast_Asian          (2)  | Epoch:43 | Val Acc: 0.5156
 Best site-Asian_ffhq               (6)  | Epoch:43 | Val Acc: 0.7143
 Best site-Asian_ffhq               (0)  | Epoch:43 | Val Acc: 0.4844
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:43 | Val Acc: 0.2143
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:43 | Val Acc: 0.4922
 Test site-White_utk                 (5)| Epoch:43 | Test Acc: 0.3186
 Test site-East_Asian                (2)| Epoch:43 | Test Acc: 0.4896
 Test site-Indian_utk                (5)| Epoch:43 | Test Acc: 0.5146
 Test site-Black_utk                 (1)| Epoch:43 | Test Acc: 0.4337
 Test site-Southeast_Asian           (2)| Epoch:43 | Test Acc: 0.4229
 Test site-Asian_ffhq                (6)| Epoch:43 | Test Acc: 0.3235
 Test site-Latino_Hispanic_ffhq      (3)| Epoch:43 | Test Acc: 0.3234
White_utk: 0.3186, East_Asian: 0.4896, Indian_utk: 0.5146, Black_utk: 0.4337, Southeast_Asian: 0.4229, Asian_ffhq: 0.3235, Latino_Hispanic_ffhq: 0.3234, 
Average Test Accuracy(group): 0.4037, Average Test Accuracy(individual): 0.4037,
domain std=0.0766, cluster std=0.0562, individual std=0.0766, 
Average Test Accuracy: 0.4037
============ Train epoch 44 ============
cnt=[2, 2, 4, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-White_utk                 (5) | Train Loss: 1.5234 | Train Acc: 0.3750
 Site-White_utk                 (5) | Train Loss: 1.3821 | Train Acc: 0.4896
 Site-East_Asian                (2) | Train Loss: 1.3312 | Train Acc: 0.4844
 Site-East_Asian                (2) | Train Loss: 1.3319 | Train Acc: 0.4740
 Site-Indian_utk                (3) | Train Loss: 1.2807 | Train Acc: 0.5469
 Site-Indian_utk                (3) | Train Loss: 1.3144 | Train Acc: 0.5000
 Site-Black_utk                 (1) | Train Loss: 1.3282 | Train Acc: 0.5469
 Site-Black_utk                 (1) | Train Loss: 1.3402 | Train Acc: 0.5208
 Site-Southeast_Asian           (2) | Train Loss: 1.5249 | Train Acc: 0.4062
 Site-Southeast_Asian           (2) | Train Loss: 1.3562 | Train Acc: 0.5208
 Site-Asian_ffhq                (4) | Train Loss: 1.4162 | Train Acc: 0.5156
 Site-Asian_ffhq                (0) | Train Loss: 1.0521 | Train Acc: 0.6354
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.0107 | Train Acc: 0.7344
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.2530 | Train Acc: 0.4583
Average Train Accuracy: 0.5149
 Site-White_utk                 (5) | Val  Loss: 1.3660 | Val  Acc: 0.4286
 Site-White_utk                 (5) | Val  Loss: 1.3756 | Val  Acc: 0.4531
 Site-East_Asian                (2) | Val  Loss: 1.4541 | Val  Acc: 0.4762
 Site-East_Asian                (2) | Val  Loss: 1.3203 | Val  Acc: 0.5234
 Site-Indian_utk                (3) | Val  Loss: 1.2725 | Val  Acc: 0.4286
 Site-Indian_utk                (3) | Val  Loss: 1.3340 | Val  Acc: 0.5078
 Site-Black_utk                 (1) | Val  Loss: 1.1920 | Val  Acc: 0.6905
 Site-Black_utk                 (1) | Val  Loss: 1.3010 | Val  Acc: 0.5547
 Site-Southeast_Asian           (2) | Val  Loss: 1.4060 | Val  Acc: 0.4762
 Site-Southeast_Asian           (2) | Val  Loss: 1.4401 | Val  Acc: 0.5078
 Site-Asian_ffhq                (4) | Val  Loss: 0.9488 | Val  Acc: 0.7143
 Site-Asian_ffhq                (0) | Val  Loss: 1.1435 | Val  Acc: 0.5156
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.7294 | Val  Acc: 0.2143
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.2502 | Val  Acc: 0.4844
Average Valid Accuracy: 0.4982
 Test site-White_utk                 (5)| Epoch:43 | Test Acc: 0.3073
 Test site-East_Asian                (2)| Epoch:43 | Test Acc: 0.4876
 Test site-Indian_utk                (3)| Epoch:43 | Test Acc: 0.5000
 Test site-Black_utk                 (1)| Epoch:43 | Test Acc: 0.4592
 Test site-Southeast_Asian           (2)| Epoch:43 | Test Acc: 0.4194
 Test site-Asian_ffhq                (4)| Epoch:43 | Test Acc: 0.3401
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:43 | Test Acc: 0.3483
White_utk: 0.3073, East_Asian: 0.4876, Indian_utk: 0.5000, Black_utk: 0.4592, Southeast_Asian: 0.4194, Asian_ffhq: 0.3401, Latino_Hispanic_ffhq: 0.3483, 
Average Test Accuracy(group): 0.4088, Average Test Accuracy(individual): 0.4088,
domain std=0.0716, cluster std=0.0697, individual std=0.0716, 
Average Test Accuracy: 0.4088
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 45 ============
cnt=[1, 4, 4, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-White_utk                 (2) | Train Loss: 1.4013 | Train Acc: 0.4062
 Site-White_utk                 (2) | Train Loss: 1.2564 | Train Acc: 0.5469
 Site-East_Asian                (1) | Train Loss: 1.3604 | Train Acc: 0.5156
 Site-East_Asian                (1) | Train Loss: 1.3296 | Train Acc: 0.5156
 Site-Indian_utk                (2) | Train Loss: 1.2957 | Train Acc: 0.5000
 Site-Indian_utk                (2) | Train Loss: 1.3136 | Train Acc: 0.5260
 Site-Black_utk                 (3) | Train Loss: 1.3440 | Train Acc: 0.5156
 Site-Black_utk                 (3) | Train Loss: 1.3131 | Train Acc: 0.5625
 Site-Southeast_Asian           (1) | Train Loss: 1.6101 | Train Acc: 0.4375
 Site-Southeast_Asian           (1) | Train Loss: 1.3282 | Train Acc: 0.5156
 Site-Asian_ffhq                (0) | Train Loss: 1.8148 | Train Acc: 0.3750
 Site-Asian_ffhq                (4) | Train Loss: 1.4619 | Train Acc: 0.4688
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.3794 | Train Acc: 0.5938
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.4940 | Train Acc: 0.4271
Average Train Accuracy: 0.4933
 Site-White_utk                 (2) | Val  Loss: 1.1611 | Val  Acc: 0.5952
 Site-White_utk                 (2) | Val  Loss: 1.2394 | Val  Acc: 0.6094
 Site-East_Asian                (1) | Val  Loss: 1.3802 | Val  Acc: 0.5238
 Site-East_Asian                (1) | Val  Loss: 1.2917 | Val  Acc: 0.5391
 Site-Indian_utk                (2) | Val  Loss: 1.2624 | Val  Acc: 0.5000
 Site-Indian_utk                (2) | Val  Loss: 1.3200 | Val  Acc: 0.5312
 Site-Black_utk                 (3) | Val  Loss: 1.2305 | Val  Acc: 0.6667
 Site-Black_utk                 (3) | Val  Loss: 1.3229 | Val  Acc: 0.5703
 Site-Southeast_Asian           (1) | Val  Loss: 1.3831 | Val  Acc: 0.4286
 Site-Southeast_Asian           (1) | Val  Loss: 1.3487 | Val  Acc: 0.5391
 Site-Asian_ffhq                (0) | Val  Loss: 1.3743 | Val  Acc: 0.5952
 Site-Asian_ffhq                (4) | Val  Loss: 1.5234 | Val  Acc: 0.3906
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7769 | Val  Acc: 0.2143
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.4269 | Val  Acc: 0.4688
Average Valid Accuracy: 0.5123
 Best site-White_utk                (2)  | Epoch:45 | Val Acc: 0.5952
 Best site-White_utk                (2)  | Epoch:45 | Val Acc: 0.6094
 Best site-East_Asian               (1)  | Epoch:45 | Val Acc: 0.5238
 Best site-East_Asian               (1)  | Epoch:45 | Val Acc: 0.5391
 Best site-Indian_utk               (2)  | Epoch:45 | Val Acc: 0.5000
 Best site-Indian_utk               (2)  | Epoch:45 | Val Acc: 0.5312
 Best site-Black_utk                (3)  | Epoch:45 | Val Acc: 0.6667
 Best site-Black_utk                (3)  | Epoch:45 | Val Acc: 0.5703
 Best site-Southeast_Asian          (1)  | Epoch:45 | Val Acc: 0.4286
 Best site-Southeast_Asian          (1)  | Epoch:45 | Val Acc: 0.5391
 Best site-Asian_ffhq               (0)  | Epoch:45 | Val Acc: 0.5952
 Best site-Asian_ffhq               (4)  | Epoch:45 | Val Acc: 0.3906
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:45 | Val Acc: 0.2143
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:45 | Val Acc: 0.4688
 Test site-White_utk                 (2)| Epoch:45 | Test Acc: 0.3484
 Test site-East_Asian                (1)| Epoch:45 | Test Acc: 0.4826
 Test site-Indian_utk                (2)| Epoch:45 | Test Acc: 0.5062
 Test site-Black_utk                 (3)| Epoch:45 | Test Acc: 0.3929
 Test site-Southeast_Asian           (1)| Epoch:45 | Test Acc: 0.4315
 Test site-Asian_ffhq                (0)| Epoch:45 | Test Acc: 0.2702
 Test site-Latino_Hispanic_ffhq      (5)| Epoch:45 | Test Acc: 0.2886
White_utk: 0.3484, East_Asian: 0.4826, Indian_utk: 0.5062, Black_utk: 0.3929, Southeast_Asian: 0.4315, Asian_ffhq: 0.2702, Latino_Hispanic_ffhq: 0.2886, 
Average Test Accuracy(group): 0.3886, Average Test Accuracy(individual): 0.3886,
domain std=0.0847, cluster std=0.0748, individual std=0.0847, 
Average Test Accuracy: 0.3886
============ Train epoch 46 ============
cnt=[1, 2, 3, 2, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-White_utk                 (1) | Train Loss: 1.8136 | Train Acc: 0.2812
 Site-White_utk                 (1) | Train Loss: 1.7245 | Train Acc: 0.3229
 Site-East_Asian                (6) | Train Loss: 1.4704 | Train Acc: 0.4375
 Site-East_Asian                (6) | Train Loss: 1.5175 | Train Acc: 0.4167
 Site-Indian_utk                (5) | Train Loss: 1.4932 | Train Acc: 0.4375
 Site-Indian_utk                (5) | Train Loss: 1.4591 | Train Acc: 0.4167
 Site-Black_utk                 (3) | Train Loss: 1.4285 | Train Acc: 0.4688
 Site-Black_utk                 (3) | Train Loss: 1.3651 | Train Acc: 0.4896
 Site-Southeast_Asian           (0) | Train Loss: 1.8257 | Train Acc: 0.3438
 Site-Southeast_Asian           (6) | Train Loss: 1.5965 | Train Acc: 0.4219
 Site-Asian_ffhq                (4) | Train Loss: 1.1615 | Train Acc: 0.6719
 Site-Asian_ffhq                (2) | Train Loss: 0.7025 | Train Acc: 0.7344
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 0.7124 | Train Acc: 0.8750
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.1049 | Train Acc: 0.4740
Average Train Accuracy: 0.4851
 Site-White_utk                 (1) | Val  Loss: 1.6527 | Val  Acc: 0.3571
 Site-White_utk                 (1) | Val  Loss: 1.7386 | Val  Acc: 0.3281
 Site-East_Asian                (6) | Val  Loss: 1.6471 | Val  Acc: 0.3571
 Site-East_Asian                (6) | Val  Loss: 1.4580 | Val  Acc: 0.4375
 Site-Indian_utk                (5) | Val  Loss: 1.3610 | Val  Acc: 0.4286
 Site-Indian_utk                (5) | Val  Loss: 1.4360 | Val  Acc: 0.4219
 Site-Black_utk                 (3) | Val  Loss: 1.3072 | Val  Acc: 0.5238
 Site-Black_utk                 (3) | Val  Loss: 1.3762 | Val  Acc: 0.4453
 Site-Southeast_Asian           (0) | Val  Loss: 1.7186 | Val  Acc: 0.3571
 Site-Southeast_Asian           (6) | Val  Loss: 1.6381 | Val  Acc: 0.4297
 Site-Asian_ffhq                (4) | Val  Loss: 0.5842 | Val  Acc: 0.8810
 Site-Asian_ffhq                (2) | Val  Loss: 0.8206 | Val  Acc: 0.6328
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9091 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.1610 | Val  Acc: 0.4531
Average Valid Accuracy: 0.4409
 Test site-White_utk                 (1)| Epoch:45 | Test Acc: 0.2425
 Test site-East_Asian                (6)| Epoch:45 | Test Acc: 0.4577
 Test site-Indian_utk                (5)| Epoch:45 | Test Acc: 0.4771
 Test site-Black_utk                 (3)| Epoch:45 | Test Acc: 0.4286
 Test site-Southeast_Asian           (0)| Epoch:45 | Test Acc: 0.3882
 Test site-Asian_ffhq                (4)| Epoch:45 | Test Acc: 0.4173
 Test site-Latino_Hispanic_ffhq      (2)| Epoch:45 | Test Acc: 0.3831
White_utk: 0.2425, East_Asian: 0.4577, Indian_utk: 0.4771, Black_utk: 0.4286, Southeast_Asian: 0.3882, Asian_ffhq: 0.4173, Latino_Hispanic_ffhq: 0.3831, 
Average Test Accuracy(group): 0.3992, Average Test Accuracy(individual): 0.3992,
domain std=0.0713, cluster std=0.0688, individual std=0.0713, 
Average Test Accuracy: 0.3992
============ Train epoch 47 ============
cnt=[1, 2, 4, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-White_utk                 (1) | Train Loss: 1.4144 | Train Acc: 0.4062
 Site-White_utk                 (1) | Train Loss: 1.2691 | Train Acc: 0.5781
 Site-East_Asian                (2) | Train Loss: 1.3154 | Train Acc: 0.4688
 Site-East_Asian                (2) | Train Loss: 1.3194 | Train Acc: 0.4844
 Site-Indian_utk                (5) | Train Loss: 1.2763 | Train Acc: 0.5469
 Site-Indian_utk                (5) | Train Loss: 1.3119 | Train Acc: 0.5104
 Site-Black_utk                 (4) | Train Loss: 1.3804 | Train Acc: 0.5000
 Site-Black_utk                 (4) | Train Loss: 1.3421 | Train Acc: 0.5417
 Site-Southeast_Asian           (2) | Train Loss: 1.5033 | Train Acc: 0.4375
 Site-Southeast_Asian           (2) | Train Loss: 1.3209 | Train Acc: 0.5156
 Site-Asian_ffhq                (0) | Train Loss: 1.6798 | Train Acc: 0.3594
 Site-Asian_ffhq                (3) | Train Loss: 1.3690 | Train Acc: 0.4688
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.3052 | Train Acc: 0.5000
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.3559 | Train Acc: 0.4531
Average Train Accuracy: 0.4836
 Site-White_utk                 (1) | Val  Loss: 1.2855 | Val  Acc: 0.5476
 Site-White_utk                 (1) | Val  Loss: 1.2253 | Val  Acc: 0.5625
 Site-East_Asian                (2) | Val  Loss: 1.3605 | Val  Acc: 0.5714
 Site-East_Asian                (2) | Val  Loss: 1.3036 | Val  Acc: 0.5312
 Site-Indian_utk                (5) | Val  Loss: 1.2792 | Val  Acc: 0.5476
 Site-Indian_utk                (5) | Val  Loss: 1.3596 | Val  Acc: 0.5156
 Site-Black_utk                 (4) | Val  Loss: 1.2485 | Val  Acc: 0.6190
 Site-Black_utk                 (4) | Val  Loss: 1.3368 | Val  Acc: 0.5547
 Site-Southeast_Asian           (2) | Val  Loss: 1.3594 | Val  Acc: 0.5000
 Site-Southeast_Asian           (2) | Val  Loss: 1.3491 | Val  Acc: 0.5469
 Site-Asian_ffhq                (0) | Val  Loss: 1.3799 | Val  Acc: 0.5952
 Site-Asian_ffhq                (3) | Val  Loss: 1.3700 | Val  Acc: 0.4375
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.6708 | Val  Acc: 0.2619
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.3747 | Val  Acc: 0.4844
Average Valid Accuracy: 0.5197
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.5476
 Best site-White_utk                (1)  | Epoch:47 | Val Acc: 0.5625
 Best site-East_Asian               (2)  | Epoch:47 | Val Acc: 0.5714
 Best site-East_Asian               (2)  | Epoch:47 | Val Acc: 0.5312
 Best site-Indian_utk               (5)  | Epoch:47 | Val Acc: 0.5476
 Best site-Indian_utk               (5)  | Epoch:47 | Val Acc: 0.5156
 Best site-Black_utk                (4)  | Epoch:47 | Val Acc: 0.6190
 Best site-Black_utk                (4)  | Epoch:47 | Val Acc: 0.5547
 Best site-Southeast_Asian          (2)  | Epoch:47 | Val Acc: 0.5000
 Best site-Southeast_Asian          (2)  | Epoch:47 | Val Acc: 0.5469
 Best site-Asian_ffhq               (0)  | Epoch:47 | Val Acc: 0.5952
 Best site-Asian_ffhq               (3)  | Epoch:47 | Val Acc: 0.4375
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:47 | Val Acc: 0.2619
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:47 | Val Acc: 0.4844
 Test site-White_utk                 (1)| Epoch:47 | Test Acc: 0.3597
 Test site-East_Asian                (2)| Epoch:47 | Test Acc: 0.4925
 Test site-Indian_utk                (5)| Epoch:47 | Test Acc: 0.4958
 Test site-Black_utk                 (4)| Epoch:47 | Test Acc: 0.3673
 Test site-Southeast_Asian           (2)| Epoch:47 | Test Acc: 0.4298
 Test site-Asian_ffhq                (0)| Epoch:47 | Test Acc: 0.2960
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:47 | Test Acc: 0.2935
White_utk: 0.3597, East_Asian: 0.4925, Indian_utk: 0.4958, Black_utk: 0.3673, Southeast_Asian: 0.4298, Asian_ffhq: 0.2960, Latino_Hispanic_ffhq: 0.2935, 
Average Test Accuracy(group): 0.3907, Average Test Accuracy(individual): 0.3907,
domain std=0.0783, cluster std=0.0767, individual std=0.0783, 
Average Test Accuracy: 0.3907
============ Train epoch 48 ============
cnt=[4, 4, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-White_utk                 (1) | Train Loss: 1.5578 | Train Acc: 0.3438
 Site-White_utk                 (1) | Train Loss: 1.4184 | Train Acc: 0.4427
 Site-East_Asian                (0) | Train Loss: 1.3571 | Train Acc: 0.4688
 Site-East_Asian                (0) | Train Loss: 1.3817 | Train Acc: 0.4375
 Site-Indian_utk                (1) | Train Loss: 1.3047 | Train Acc: 0.5469
 Site-Indian_utk                (1) | Train Loss: 1.2959 | Train Acc: 0.5052
 Site-Black_utk                 (4) | Train Loss: 1.3107 | Train Acc: 0.5156
 Site-Black_utk                 (4) | Train Loss: 1.3191 | Train Acc: 0.5417
 Site-Southeast_Asian           (0) | Train Loss: 1.5965 | Train Acc: 0.4531
 Site-Southeast_Asian           (0) | Train Loss: 1.4080 | Train Acc: 0.4740
 Site-Asian_ffhq                (3) | Train Loss: 1.1803 | Train Acc: 0.6250
 Site-Asian_ffhq                (2) | Train Loss: 0.8780 | Train Acc: 0.6615
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 0.8152 | Train Acc: 0.8281
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.1840 | Train Acc: 0.4688
Average Train Accuracy: 0.5223
 Site-White_utk                 (1) | Val  Loss: 1.3260 | Val  Acc: 0.4762
 Site-White_utk                 (1) | Val  Loss: 1.3560 | Val  Acc: 0.4688
 Site-East_Asian                (0) | Val  Loss: 1.5649 | Val  Acc: 0.3810
 Site-East_Asian                (0) | Val  Loss: 1.3617 | Val  Acc: 0.4531
 Site-Indian_utk                (1) | Val  Loss: 1.3284 | Val  Acc: 0.4048
 Site-Indian_utk                (1) | Val  Loss: 1.3417 | Val  Acc: 0.4844
 Site-Black_utk                 (4) | Val  Loss: 1.2508 | Val  Acc: 0.5952
 Site-Black_utk                 (4) | Val  Loss: 1.3164 | Val  Acc: 0.5859
 Site-Southeast_Asian           (0) | Val  Loss: 1.5343 | Val  Acc: 0.4286
 Site-Southeast_Asian           (0) | Val  Loss: 1.4593 | Val  Acc: 0.4766
 Site-Asian_ffhq                (3) | Val  Loss: 0.7932 | Val  Acc: 0.7143
 Site-Asian_ffhq                (2) | Val  Loss: 0.9351 | Val  Acc: 0.5938
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.8241 | Val  Acc: 0.1905
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.2290 | Val  Acc: 0.4375
Average Valid Accuracy: 0.4779
 Test site-White_utk                 (1)| Epoch:47 | Test Acc: 0.3022
 Test site-East_Asian                (0)| Epoch:47 | Test Acc: 0.4697
 Test site-Indian_utk                (1)| Epoch:47 | Test Acc: 0.4917
 Test site-Black_utk                 (4)| Epoch:47 | Test Acc: 0.4490
 Test site-Southeast_Asian           (0)| Epoch:47 | Test Acc: 0.4090
 Test site-Asian_ffhq                (3)| Epoch:47 | Test Acc: 0.3750
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:47 | Test Acc: 0.3731
White_utk: 0.3022, East_Asian: 0.4697, Indian_utk: 0.4917, Black_utk: 0.4490, Southeast_Asian: 0.4090, Asian_ffhq: 0.3750, Latino_Hispanic_ffhq: 0.3731, 
Average Test Accuracy(group): 0.4099, Average Test Accuracy(individual): 0.4099,
domain std=0.0609, cluster std=0.0307, individual std=0.0609, 
Average Test Accuracy: 0.4099
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_sq/ccop_q=1_pcs=2.0...
============ Train epoch 49 ============
cnt=[4, 2, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-White_utk                 (1) | Train Loss: 1.3860 | Train Acc: 0.4219
 Site-White_utk                 (1) | Train Loss: 1.2535 | Train Acc: 0.5885
 Site-East_Asian                (0) | Train Loss: 1.3570 | Train Acc: 0.4844
 Site-East_Asian                (0) | Train Loss: 1.3453 | Train Acc: 0.4740
 Site-Indian_utk                (5) | Train Loss: 1.3377 | Train Acc: 0.5312
 Site-Indian_utk                (5) | Train Loss: 1.3083 | Train Acc: 0.5208
 Site-Black_utk                 (3) | Train Loss: 1.3687 | Train Acc: 0.5312
 Site-Black_utk                 (3) | Train Loss: 1.3340 | Train Acc: 0.5833
 Site-Southeast_Asian           (0) | Train Loss: 1.5138 | Train Acc: 0.4219
 Site-Southeast_Asian           (0) | Train Loss: 1.3292 | Train Acc: 0.5365
 Site-Asian_ffhq                (4) | Train Loss: 1.6274 | Train Acc: 0.3750
 Site-Asian_ffhq                (2) | Train Loss: 1.3394 | Train Acc: 0.5052
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.2870 | Train Acc: 0.5156
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.4260 | Train Acc: 0.4635
Average Train Accuracy: 0.4967
 Site-White_utk                 (1) | Val  Loss: 1.2773 | Val  Acc: 0.5238
 Site-White_utk                 (1) | Val  Loss: 1.2282 | Val  Acc: 0.5938
 Site-East_Asian                (0) | Val  Loss: 1.4097 | Val  Acc: 0.5476
 Site-East_Asian                (0) | Val  Loss: 1.2939 | Val  Acc: 0.5078
 Site-Indian_utk                (5) | Val  Loss: 1.2897 | Val  Acc: 0.5000
 Site-Indian_utk                (5) | Val  Loss: 1.3365 | Val  Acc: 0.5391
 Site-Black_utk                 (3) | Val  Loss: 1.2240 | Val  Acc: 0.6905
 Site-Black_utk                 (3) | Val  Loss: 1.3186 | Val  Acc: 0.5625
 Site-Southeast_Asian           (0) | Val  Loss: 1.4010 | Val  Acc: 0.4524
 Site-Southeast_Asian           (0) | Val  Loss: 1.3506 | Val  Acc: 0.5156
 Site-Asian_ffhq                (4) | Val  Loss: 1.2803 | Val  Acc: 0.5952
 Site-Asian_ffhq                (2) | Val  Loss: 1.4260 | Val  Acc: 0.4531
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.8026 | Val  Acc: 0.2143
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.3845 | Val  Acc: 0.4141
Average Valid Accuracy: 0.5078
 Test site-White_utk                 (1)| Epoch:48 | Test Acc: 0.3494
 Test site-East_Asian                (0)| Epoch:48 | Test Acc: 0.4955
 Test site-Indian_utk                (5)| Epoch:48 | Test Acc: 0.4938
 Test site-Black_utk                 (3)| Epoch:48 | Test Acc: 0.3673
 Test site-Southeast_Asian           (0)| Epoch:48 | Test Acc: 0.4350
 Test site-Asian_ffhq                (4)| Epoch:48 | Test Acc: 0.2886
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:48 | Test Acc: 0.3085
White_utk: 0.3494, East_Asian: 0.4955, Indian_utk: 0.4938, Black_utk: 0.3673, Southeast_Asian: 0.4350, Asian_ffhq: 0.2886, Latino_Hispanic_ffhq: 0.3085, 
Average Test Accuracy(group): 0.3912, Average Test Accuracy(individual): 0.3912,
domain std=0.0784, cluster std=0.0759, individual std=0.0784, 
Average Test Accuracy: 0.3912
 Test site-White_utk                 (1)| Epoch:48 | Test Acc: 0.3494
 Test site-East_Asian                (0)| Epoch:48 | Test Acc: 0.4955
 Test site-Indian_utk                (5)| Epoch:48 | Test Acc: 0.4938
 Test site-Black_utk                 (3)| Epoch:48 | Test Acc: 0.3673
 Test site-Southeast_Asian           (0)| Epoch:48 | Test Acc: 0.4350
 Test site-Asian_ffhq                (4)| Epoch:48 | Test Acc: 0.2886
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:48 | Test Acc: 0.3085
White_utk: 0.3494, East_Asian: 0.4955, Indian_utk: 0.4938, Black_utk: 0.3673, Southeast_Asian: 0.4350, Asian_ffhq: 0.2886, Latino_Hispanic_ffhq: 0.3085, 
Average Test Accuracy(group): 0.3912, Average Test Accuracy(individual): 0.3912,
domain std=0.0784, cluster std=0.0759, individual std=0.0784, 
===2023-06-17 22:09:58===
===2023-06-17 22:10:14===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 2.0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: True
