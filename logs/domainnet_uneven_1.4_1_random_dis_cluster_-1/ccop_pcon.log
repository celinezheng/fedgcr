===2023-06-22 06:55:46===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.0858 | Train Acc: 0.3391
 Site-Clipart                   (1) | Train Loss: 2.0585 | Train Acc: 0.3540
 Site-Clipart                   (1) | Train Loss: 2.1267 | Train Acc: 0.2844
 Site-Clipart                   (1) | Train Loss: 2.0741 | Train Acc: 0.3196
 Site-Clipart                   (1) | Train Loss: 2.0931 | Train Acc: 0.3348
 Site-Real                      (0) | Train Loss: 2.0859 | Train Acc: 0.3810
 Site-Real                      (0) | Train Loss: 2.0974 | Train Acc: 0.3672
 Site-Real                      (0) | Train Loss: 2.0698 | Train Acc: 0.3589
 Site-Real                      (0) | Train Loss: 2.1134 | Train Acc: 0.2615
 Site-Painting                  (3) | Train Loss: 2.1130 | Train Acc: 0.3333
 Site-Painting                  (3) | Train Loss: 2.1752 | Train Acc: 0.3350
 Site-Painting                  (3) | Train Loss: 2.1292 | Train Acc: 0.3218
 Site-Sketch                    (5) | Train Loss: 2.0857 | Train Acc: 0.3403
 Site-Sketch                    (5) | Train Loss: 2.1309 | Train Acc: 0.2959
 Site-QuickDraw                 (2) | Train Loss: 2.2497 | Train Acc: 0.1315
 Site-Infograph                 (4) | Train Loss: 2.2833 | Train Acc: 0.1581
Average Train Accuracy: 0.3073
 Site-Clipart                   (1) | Val  Loss: 2.0560 | Val  Acc: 0.3158
 Site-Clipart                   (1) | Val  Loss: 2.0891 | Val  Acc: 0.3364
 Site-Clipart                   (1) | Val  Loss: 2.0740 | Val  Acc: 0.3400
 Site-Clipart                   (1) | Val  Loss: 2.0767 | Val  Acc: 0.3524
 Site-Clipart                   (1) | Val  Loss: 2.1122 | Val  Acc: 0.2678
 Site-Real                      (0) | Val  Loss: 2.0682 | Val  Acc: 0.3333
 Site-Real                      (0) | Val  Loss: 2.0784 | Val  Acc: 0.3475
 Site-Real                      (0) | Val  Loss: 2.0664 | Val  Acc: 0.3212
 Site-Real                      (0) | Val  Loss: 2.0660 | Val  Acc: 0.3680
 Site-Painting                  (3) | Val  Loss: 2.1100 | Val  Acc: 0.3673
 Site-Painting                  (3) | Val  Loss: 2.0368 | Val  Acc: 0.3723
 Site-Painting                  (3) | Val  Loss: 2.1406 | Val  Acc: 0.3021
 Site-Sketch                    (5) | Val  Loss: 2.0788 | Val  Acc: 0.3622
 Site-Sketch                    (5) | Val  Loss: 2.1273 | Val  Acc: 0.2978
 Site-QuickDraw                 (2) | Val  Loss: 2.2924 | Val  Acc: 0.1422
 Site-Infograph                 (4) | Val  Loss: 2.2863 | Val  Acc: 0.1346
Average Valid Accuracy: 0.3101
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3158
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3364
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3400
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3524
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2678
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3475
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3212
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3680
 Best site-Painting                 (3)  | Epoch:0 | Val Acc: 0.3673
 Best site-Painting                 (3)  | Epoch:0 | Val Acc: 0.3723
 Best site-Painting                 (3)  | Epoch:0 | Val Acc: 0.3021
 Best site-Sketch                   (5)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (5)  | Epoch:0 | Val Acc: 0.2978
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1422
 Best site-Infograph                (4)  | Epoch:0 | Val Acc: 0.1346
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.8991 | Train Acc: 0.4783
 Site-Clipart                   (0) | Train Loss: 1.8464 | Train Acc: 0.4969
 Site-Clipart                   (0) | Train Loss: 1.9324 | Train Acc: 0.4444
 Site-Clipart                   (0) | Train Loss: 1.8586 | Train Acc: 0.4873
 Site-Clipart                   (0) | Train Loss: 1.8856 | Train Acc: 0.5113
 Site-Real                      (2) | Train Loss: 1.8324 | Train Acc: 0.5635
 Site-Real                      (2) | Train Loss: 1.8032 | Train Acc: 0.6215
 Site-Real                      (2) | Train Loss: 1.7646 | Train Acc: 0.6129
 Site-Real                      (2) | Train Loss: 1.8445 | Train Acc: 0.5546
 Site-Painting                  (3) | Train Loss: 1.8710 | Train Acc: 0.4490
 Site-Painting                  (3) | Train Loss: 1.9069 | Train Acc: 0.5146
 Site-Painting                  (3) | Train Loss: 1.8748 | Train Acc: 0.5156
 Site-Sketch                    (5) | Train Loss: 1.8744 | Train Acc: 0.5183
 Site-Sketch                    (5) | Train Loss: 1.8978 | Train Acc: 0.4869
 Site-QuickDraw                 (1) | Train Loss: 2.2135 | Train Acc: 0.2202
 Site-Infograph                 (4) | Train Loss: 2.1816 | Train Acc: 0.2735
Average Train Accuracy: 0.4843
 Site-Clipart                   (0) | Val  Loss: 1.7987 | Val  Acc: 0.5526
 Site-Clipart                   (0) | Val  Loss: 1.8584 | Val  Acc: 0.5047
 Site-Clipart                   (0) | Val  Loss: 1.8664 | Val  Acc: 0.4933
 Site-Clipart                   (0) | Val  Loss: 1.8436 | Val  Acc: 0.5238
 Site-Clipart                   (0) | Val  Loss: 1.9220 | Val  Acc: 0.4407
 Site-Real                      (2) | Val  Loss: 1.7614 | Val  Acc: 0.5595
 Site-Real                      (2) | Val  Loss: 1.8216 | Val  Acc: 0.5169
 Site-Real                      (2) | Val  Loss: 1.7357 | Val  Acc: 0.6364
 Site-Real                      (2) | Val  Loss: 1.7739 | Val  Acc: 0.6320
 Site-Painting                  (3) | Val  Loss: 1.8551 | Val  Acc: 0.5918
 Site-Painting                  (3) | Val  Loss: 1.8226 | Val  Acc: 0.5182
 Site-Painting                  (3) | Val  Loss: 1.8813 | Val  Acc: 0.5260
 Site-Sketch                    (5) | Val  Loss: 1.9068 | Val  Acc: 0.4724
 Site-Sketch                    (5) | Val  Loss: 1.9210 | Val  Acc: 0.4270
 Site-QuickDraw                 (1) | Val  Loss: 2.2316 | Val  Acc: 0.2064
 Site-Infograph                 (4) | Val  Loss: 2.1591 | Val  Acc: 0.2692
Average Valid Accuracy: 0.4919
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5526
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5047
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4933
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4407
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5595
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5169
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6364
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6320
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5918
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5182
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5260
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4724
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4270
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.2064
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.2692
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.6911 | Train Acc: 0.5913
 Site-Clipart                   (0) | Train Loss: 1.5879 | Train Acc: 0.5776
 Site-Clipart                   (0) | Train Loss: 1.7056 | Train Acc: 0.5911
 Site-Clipart                   (0) | Train Loss: 1.6216 | Train Acc: 0.6076
 Site-Clipart                   (0) | Train Loss: 1.6417 | Train Acc: 0.6403
 Site-Real                      (2) | Train Loss: 1.5156 | Train Acc: 0.7540
 Site-Real                      (2) | Train Loss: 1.4629 | Train Acc: 0.7514
 Site-Real                      (2) | Train Loss: 1.3872 | Train Acc: 0.8065
 Site-Real                      (2) | Train Loss: 1.5340 | Train Acc: 0.6925
 Site-Painting                  (3) | Train Loss: 1.5579 | Train Acc: 0.6599
 Site-Painting                  (3) | Train Loss: 1.5751 | Train Acc: 0.5971
 Site-Painting                  (3) | Train Loss: 1.5703 | Train Acc: 0.6574
 Site-Sketch                    (5) | Train Loss: 1.6268 | Train Acc: 0.6021
 Site-Sketch                    (5) | Train Loss: 1.7021 | Train Acc: 0.5843
 Site-QuickDraw                 (1) | Train Loss: 2.1554 | Train Acc: 0.2294
 Site-Infograph                 (4) | Train Loss: 2.0665 | Train Acc: 0.3077
Average Train Accuracy: 0.6031
 Site-Clipart                   (0) | Val  Loss: 1.5617 | Val  Acc: 0.6316
 Site-Clipart                   (0) | Val  Loss: 1.6003 | Val  Acc: 0.6916
 Site-Clipart                   (0) | Val  Loss: 1.6391 | Val  Acc: 0.6800
 Site-Clipart                   (0) | Val  Loss: 1.5789 | Val  Acc: 0.6333
 Site-Clipart                   (0) | Val  Loss: 1.6938 | Val  Acc: 0.5763
 Site-Real                      (2) | Val  Loss: 1.4081 | Val  Acc: 0.7381
 Site-Real                      (2) | Val  Loss: 1.4492 | Val  Acc: 0.7712
 Site-Real                      (2) | Val  Loss: 1.3461 | Val  Acc: 0.8242
 Site-Real                      (2) | Val  Loss: 1.4144 | Val  Acc: 0.7965
 Site-Painting                  (3) | Val  Loss: 1.4988 | Val  Acc: 0.7143
 Site-Painting                  (3) | Val  Loss: 1.5094 | Val  Acc: 0.6642
 Site-Painting                  (3) | Val  Loss: 1.5713 | Val  Acc: 0.6719
 Site-Sketch                    (5) | Val  Loss: 1.6612 | Val  Acc: 0.6063
 Site-Sketch                    (5) | Val  Loss: 1.6694 | Val  Acc: 0.5787
 Site-QuickDraw                 (1) | Val  Loss: 2.2025 | Val  Acc: 0.2202
 Site-Infograph                 (4) | Val  Loss: 2.0352 | Val  Acc: 0.3333
Average Valid Accuracy: 0.6332
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6316
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6916
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6800
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6333
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5763
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7381
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7712
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.8242
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7965
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.7143
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.6642
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.6719
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.6063
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5787
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2202
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.4638 | Train Acc: 0.6957
 Site-Clipart                   (0) | Train Loss: 1.3638 | Train Acc: 0.7267
 Site-Clipart                   (0) | Train Loss: 1.4887 | Train Acc: 0.6800
 Site-Clipart                   (0) | Train Loss: 1.4255 | Train Acc: 0.6962
 Site-Clipart                   (0) | Train Loss: 1.4260 | Train Acc: 0.7059
 Site-Real                      (1) | Train Loss: 1.2616 | Train Acc: 0.8175
 Site-Real                      (1) | Train Loss: 1.1892 | Train Acc: 0.8305
 Site-Real                      (1) | Train Loss: 1.1135 | Train Acc: 0.8871
 Site-Real                      (1) | Train Loss: 1.2600 | Train Acc: 0.8132
 Site-Painting                  (3) | Train Loss: 1.3610 | Train Acc: 0.7143
 Site-Painting                  (3) | Train Loss: 1.3780 | Train Acc: 0.6893
 Site-Painting                  (3) | Train Loss: 1.3327 | Train Acc: 0.7405
 Site-Sketch                    (4) | Train Loss: 1.4262 | Train Acc: 0.6649
 Site-Sketch                    (4) | Train Loss: 1.4410 | Train Acc: 0.6517
 Site-QuickDraw                 (2) | Train Loss: 2.1094 | Train Acc: 0.2385
 Site-Infograph                 (5) | Train Loss: 1.9427 | Train Acc: 0.3718
Average Train Accuracy: 0.6827
 Site-Clipart                   (0) | Val  Loss: 1.3194 | Val  Acc: 0.7368
 Site-Clipart                   (0) | Val  Loss: 1.4111 | Val  Acc: 0.6916
 Site-Clipart                   (0) | Val  Loss: 1.3902 | Val  Acc: 0.7533
 Site-Clipart                   (0) | Val  Loss: 1.3764 | Val  Acc: 0.7286
 Site-Clipart                   (0) | Val  Loss: 1.4912 | Val  Acc: 0.6644
 Site-Real                      (1) | Val  Loss: 1.1968 | Val  Acc: 0.7381
 Site-Real                      (1) | Val  Loss: 1.2097 | Val  Acc: 0.8220
 Site-Real                      (1) | Val  Loss: 1.1182 | Val  Acc: 0.8667
 Site-Real                      (1) | Val  Loss: 1.1475 | Val  Acc: 0.8788
 Site-Painting                  (3) | Val  Loss: 1.2472 | Val  Acc: 0.8367
 Site-Painting                  (3) | Val  Loss: 1.2398 | Val  Acc: 0.7664
 Site-Painting                  (3) | Val  Loss: 1.3517 | Val  Acc: 0.7292
 Site-Sketch                    (4) | Val  Loss: 1.4432 | Val  Acc: 0.6535
 Site-Sketch                    (4) | Val  Loss: 1.4898 | Val  Acc: 0.6404
 Site-QuickDraw                 (2) | Val  Loss: 2.1126 | Val  Acc: 0.2248
 Site-Infograph                 (5) | Val  Loss: 1.9100 | Val  Acc: 0.3846
Average Valid Accuracy: 0.6948
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7368
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6916
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7533
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7286
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6644
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.7381
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8220
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8667
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8788
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.8367
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7664
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7292
 Best site-Sketch                   (4)  | Epoch:3 | Val Acc: 0.6535
 Best site-Sketch                   (4)  | Epoch:3 | Val Acc: 0.6404
 Best site-QuickDraw                (2)  | Epoch:3 | Val Acc: 0.2248
 Best site-Infograph                (5)  | Epoch:3 | Val Acc: 0.3846
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.2994 | Train Acc: 0.7043
 Site-Clipart                   (0) | Train Loss: 1.2057 | Train Acc: 0.7702
 Site-Clipart                   (0) | Train Loss: 1.3413 | Train Acc: 0.7467
 Site-Clipart                   (0) | Train Loss: 1.2262 | Train Acc: 0.7658
 Site-Clipart                   (0) | Train Loss: 1.2435 | Train Acc: 0.7647
 Site-Real                      (3) | Train Loss: 1.0747 | Train Acc: 0.8651
 Site-Real                      (3) | Train Loss: 0.9885 | Train Acc: 0.8531
 Site-Real                      (3) | Train Loss: 0.9174 | Train Acc: 0.8911
 Site-Real                      (3) | Train Loss: 1.1168 | Train Acc: 0.8391
 Site-Painting                  (1) | Train Loss: 1.1953 | Train Acc: 0.7551
 Site-Painting                  (1) | Train Loss: 1.2700 | Train Acc: 0.7718
 Site-Painting                  (1) | Train Loss: 1.1332 | Train Acc: 0.7958
 Site-Sketch                    (5) | Train Loss: 1.2182 | Train Acc: 0.7173
 Site-Sketch                    (5) | Train Loss: 1.1610 | Train Acc: 0.7041
 Site-QuickDraw                 (2) | Train Loss: 2.0276 | Train Acc: 0.2905
 Site-Infograph                 (4) | Train Loss: 1.8377 | Train Acc: 0.4188
Average Train Accuracy: 0.7284
 Site-Clipart                   (0) | Val  Loss: 1.1149 | Val  Acc: 0.8026
 Site-Clipart                   (0) | Val  Loss: 1.2463 | Val  Acc: 0.7757
 Site-Clipart                   (0) | Val  Loss: 1.2312 | Val  Acc: 0.7600
 Site-Clipart                   (0) | Val  Loss: 1.1923 | Val  Acc: 0.7381
 Site-Clipart                   (0) | Val  Loss: 1.3017 | Val  Acc: 0.7186
 Site-Real                      (3) | Val  Loss: 1.0042 | Val  Acc: 0.8095
 Site-Real                      (3) | Val  Loss: 1.0007 | Val  Acc: 0.8814
 Site-Real                      (3) | Val  Loss: 0.9376 | Val  Acc: 0.8667
 Site-Real                      (3) | Val  Loss: 0.9615 | Val  Acc: 0.8831
 Site-Painting                  (1) | Val  Loss: 1.0425 | Val  Acc: 0.8571
 Site-Painting                  (1) | Val  Loss: 1.1127 | Val  Acc: 0.7445
 Site-Painting                  (1) | Val  Loss: 1.1666 | Val  Acc: 0.7552
 Site-Sketch                    (5) | Val  Loss: 1.2533 | Val  Acc: 0.7087
 Site-Sketch                    (5) | Val  Loss: 1.2570 | Val  Acc: 0.6742
 Site-QuickDraw                 (2) | Val  Loss: 2.0107 | Val  Acc: 0.3028
 Site-Infograph                 (4) | Val  Loss: 1.7591 | Val  Acc: 0.4808
Average Valid Accuracy: 0.7349
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.8026
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7757
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7600
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7186
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8095
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8814
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8667
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8831
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.8571
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7445
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7552
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.7087
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6742
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.3028
 Best site-Infograph                (4)  | Epoch:4 | Val Acc: 0.4808
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 1, 4, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (5) | Train Loss: 1.1233 | Train Acc: 0.7652
 Site-Clipart                   (0) | Train Loss: 1.0162 | Train Acc: 0.8261
 Site-Clipart                   (5) | Train Loss: 1.1351 | Train Acc: 0.7822
 Site-Clipart                   (5) | Train Loss: 1.0650 | Train Acc: 0.7753
 Site-Clipart                   (5) | Train Loss: 1.1050 | Train Acc: 0.7805
 Site-Real                      (2) | Train Loss: 0.9203 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.8113 | Train Acc: 0.9040
 Site-Real                      (2) | Train Loss: 0.8006 | Train Acc: 0.8750
 Site-Real                      (2) | Train Loss: 0.8904 | Train Acc: 0.8678
 Site-Painting                  (3) | Train Loss: 1.0039 | Train Acc: 0.7687
 Site-Painting                  (3) | Train Loss: 1.0759 | Train Acc: 0.8010
 Site-Painting                  (3) | Train Loss: 0.9803 | Train Acc: 0.8062
 Site-Sketch                    (0) | Train Loss: 1.0833 | Train Acc: 0.7120
 Site-Sketch                    (0) | Train Loss: 1.1813 | Train Acc: 0.7341
 Site-QuickDraw                 (1) | Train Loss: 1.8546 | Train Acc: 0.3517
 Site-Infograph                 (4) | Train Loss: 1.7478 | Train Acc: 0.4359
Average Train Accuracy: 0.7557
 Site-Clipart                   (5) | Val  Loss: 0.9512 | Val  Acc: 0.7895
 Site-Clipart                   (0) | Val  Loss: 1.0747 | Val  Acc: 0.8224
 Site-Clipart                   (5) | Val  Loss: 1.0367 | Val  Acc: 0.8200
 Site-Clipart                   (5) | Val  Loss: 1.0337 | Val  Acc: 0.7857
 Site-Clipart                   (5) | Val  Loss: 1.1411 | Val  Acc: 0.7356
 Site-Real                      (2) | Val  Loss: 0.8365 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.8458 | Val  Acc: 0.8898
 Site-Real                      (2) | Val  Loss: 0.7689 | Val  Acc: 0.8909
 Site-Real                      (2) | Val  Loss: 0.7978 | Val  Acc: 0.9134
 Site-Painting                  (3) | Val  Loss: 0.8560 | Val  Acc: 0.8878
 Site-Painting                  (3) | Val  Loss: 0.9485 | Val  Acc: 0.8029
 Site-Painting                  (3) | Val  Loss: 0.9814 | Val  Acc: 0.8021
 Site-Sketch                    (0) | Val  Loss: 1.0787 | Val  Acc: 0.7244
 Site-Sketch                    (0) | Val  Loss: 1.0947 | Val  Acc: 0.7135
 Site-QuickDraw                 (1) | Val  Loss: 1.9038 | Val  Acc: 0.3853
 Site-Infograph                 (4) | Val  Loss: 1.6780 | Val  Acc: 0.4679
Average Valid Accuracy: 0.7710
 Best site-Clipart                  (5)  | Epoch:5 | Val Acc: 0.7895
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.8224
 Best site-Clipart                  (5)  | Epoch:5 | Val Acc: 0.8200
 Best site-Clipart                  (5)  | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart                  (5)  | Epoch:5 | Val Acc: 0.7356
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9048
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8898
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8909
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9134
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.8878
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.8029
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.8021
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.7244
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.7135
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.3853
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.4679
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 4, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (0) | Train Loss: 0.9911 | Train Acc: 0.8087
 Site-Clipart                   (5) | Train Loss: 0.8570 | Train Acc: 0.8385
 Site-Clipart                   (5) | Train Loss: 1.0346 | Train Acc: 0.8044
 Site-Clipart                   (0) | Train Loss: 0.9519 | Train Acc: 0.8101
 Site-Clipart                   (5) | Train Loss: 0.9839 | Train Acc: 0.8100
 Site-Real                      (1) | Train Loss: 0.7884 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.7141 | Train Acc: 0.9266
 Site-Real                      (1) | Train Loss: 0.6809 | Train Acc: 0.9113
 Site-Real                      (1) | Train Loss: 0.8126 | Train Acc: 0.8908
 Site-Painting                  (3) | Train Loss: 0.8566 | Train Acc: 0.8367
 Site-Painting                  (3) | Train Loss: 0.8558 | Train Acc: 0.8252
 Site-Painting                  (3) | Train Loss: 0.8934 | Train Acc: 0.8339
 Site-Sketch                    (0) | Train Loss: 0.9467 | Train Acc: 0.7749
 Site-Sketch                    (5) | Train Loss: 0.9686 | Train Acc: 0.7566
 Site-QuickDraw                 (2) | Train Loss: 1.6146 | Train Acc: 0.4924
 Site-Infograph                 (4) | Train Loss: 1.6571 | Train Acc: 0.4872
Average Train Accuracy: 0.7945
 Site-Clipart                   (0) | Val  Loss: 0.8235 | Val  Acc: 0.8158
 Site-Clipart                   (5) | Val  Loss: 0.9633 | Val  Acc: 0.8224
 Site-Clipart                   (5) | Val  Loss: 0.9256 | Val  Acc: 0.8467
 Site-Clipart                   (0) | Val  Loss: 0.9098 | Val  Acc: 0.8095
 Site-Clipart                   (5) | Val  Loss: 1.0088 | Val  Acc: 0.7729
 Site-Real                      (1) | Val  Loss: 0.7159 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.7201 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.6908 | Val  Acc: 0.8788
 Site-Real                      (1) | Val  Loss: 0.6960 | Val  Acc: 0.9221
 Site-Painting                  (3) | Val  Loss: 0.7911 | Val  Acc: 0.8265
 Site-Painting                  (3) | Val  Loss: 0.8306 | Val  Acc: 0.8321
 Site-Painting                  (3) | Val  Loss: 0.8934 | Val  Acc: 0.8333
 Site-Sketch                    (0) | Val  Loss: 0.9432 | Val  Acc: 0.7795
 Site-Sketch                    (5) | Val  Loss: 0.9678 | Val  Acc: 0.7697
 Site-QuickDraw                 (2) | Val  Loss: 1.7258 | Val  Acc: 0.5367
 Site-Infograph                 (4) | Val  Loss: 1.5786 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8006
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8158
 Best site-Clipart                  (5)  | Epoch:6 | Val Acc: 0.8224
 Best site-Clipart                  (5)  | Epoch:6 | Val Acc: 0.8467
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8095
 Best site-Clipart                  (5)  | Epoch:6 | Val Acc: 0.7729
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.8788
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9221
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8265
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8321
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8333
 Best site-Sketch                   (0)  | Epoch:6 | Val Acc: 0.7795
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7697
 Best site-QuickDraw                (2)  | Epoch:6 | Val Acc: 0.5367
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.5513
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 4, 1, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (5) | Train Loss: 0.8923 | Train Acc: 0.7826
 Site-Clipart                   (1) | Train Loss: 0.7828 | Train Acc: 0.8509
 Site-Clipart                   (1) | Train Loss: 0.9189 | Train Acc: 0.8267
 Site-Clipart                   (5) | Train Loss: 0.8513 | Train Acc: 0.8165
 Site-Clipart                   (5) | Train Loss: 0.8888 | Train Acc: 0.8235
 Site-Real                      (0) | Train Loss: 0.6970 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.6282 | Train Acc: 0.9322
 Site-Real                      (0) | Train Loss: 0.5883 | Train Acc: 0.9113
 Site-Real                      (0) | Train Loss: 0.6711 | Train Acc: 0.9167
 Site-Painting                  (4) | Train Loss: 0.8077 | Train Acc: 0.8503
 Site-Painting                  (4) | Train Loss: 0.7632 | Train Acc: 0.8398
 Site-Painting                  (4) | Train Loss: 0.7815 | Train Acc: 0.8720
 Site-Sketch                    (1) | Train Loss: 0.8558 | Train Acc: 0.8115
 Site-Sketch                    (1) | Train Loss: 0.8593 | Train Acc: 0.7790
 Site-QuickDraw                 (2) | Train Loss: 1.5024 | Train Acc: 0.5229
 Site-Infograph                 (3) | Train Loss: 1.5713 | Train Acc: 0.5085
Average Train Accuracy: 0.8088
 Site-Clipart                   (5) | Val  Loss: 0.7268 | Val  Acc: 0.8289
 Site-Clipart                   (1) | Val  Loss: 0.8758 | Val  Acc: 0.8224
 Site-Clipart                   (1) | Val  Loss: 0.8563 | Val  Acc: 0.8267
 Site-Clipart                   (5) | Val  Loss: 0.7951 | Val  Acc: 0.8238
 Site-Clipart                   (5) | Val  Loss: 0.9130 | Val  Acc: 0.7729
 Site-Real                      (0) | Val  Loss: 0.6307 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.6470 | Val  Acc: 0.8983
 Site-Real                      (0) | Val  Loss: 0.5912 | Val  Acc: 0.9030
 Site-Real                      (0) | Val  Loss: 0.6200 | Val  Acc: 0.9351
 Site-Painting                  (4) | Val  Loss: 0.6711 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.7624 | Val  Acc: 0.8467
 Site-Painting                  (4) | Val  Loss: 0.7759 | Val  Acc: 0.8490
 Site-Sketch                    (1) | Val  Loss: 0.8080 | Val  Acc: 0.8189
 Site-Sketch                    (1) | Val  Loss: 0.8682 | Val  Acc: 0.7697
 Site-QuickDraw                 (2) | Val  Loss: 1.6138 | Val  Acc: 0.5505
 Site-Infograph                 (3) | Val  Loss: 1.4890 | Val  Acc: 0.5449
Average Valid Accuracy: 0.8142
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.8289
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8224
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8267
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.8238
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.7729
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 0.9286
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 0.8983
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 0.9030
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 0.9351
 Best site-Painting                 (4)  | Epoch:7 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:7 | Val Acc: 0.8467
 Best site-Painting                 (4)  | Epoch:7 | Val Acc: 0.8490
 Best site-Sketch                   (1)  | Epoch:7 | Val Acc: 0.8189
 Best site-Sketch                   (1)  | Epoch:7 | Val Acc: 0.7697
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.5505
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.5449
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 8 ============
cnt=[4, 5, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (4) | Train Loss: 0.8168 | Train Acc: 0.8000
 Site-Clipart                   (0) | Train Loss: 0.7172 | Train Acc: 0.8882
 Site-Clipart                   (0) | Train Loss: 0.8157 | Train Acc: 0.8533
 Site-Clipart                   (4) | Train Loss: 0.7698 | Train Acc: 0.8133
 Site-Clipart                   (4) | Train Loss: 0.8135 | Train Acc: 0.8326
 Site-Real                      (1) | Train Loss: 0.5805 | Train Acc: 0.9206
 Site-Real                      (1) | Train Loss: 0.5632 | Train Acc: 0.9266
 Site-Real                      (1) | Train Loss: 0.5215 | Train Acc: 0.9395
 Site-Real                      (1) | Train Loss: 0.6087 | Train Acc: 0.9195
 Site-Painting                  (3) | Train Loss: 0.8050 | Train Acc: 0.8503
 Site-Painting                  (3) | Train Loss: 0.7094 | Train Acc: 0.8398
 Site-Painting                  (1) | Train Loss: 0.7138 | Train Acc: 0.8547
 Site-Sketch                    (0) | Train Loss: 0.7767 | Train Acc: 0.8010
 Site-Sketch                    (0) | Train Loss: 0.8186 | Train Acc: 0.7790
 Site-QuickDraw                 (2) | Train Loss: 1.4926 | Train Acc: 0.5657
 Site-Infograph                 (5) | Train Loss: 1.5399 | Train Acc: 0.4957
Average Train Accuracy: 0.8175
 Site-Clipart                   (4) | Val  Loss: 0.6568 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.8057 | Val  Acc: 0.8318
 Site-Clipart                   (0) | Val  Loss: 0.8343 | Val  Acc: 0.8067
 Site-Clipart                   (4) | Val  Loss: 0.7547 | Val  Acc: 0.8048
 Site-Clipart                   (4) | Val  Loss: 0.8327 | Val  Acc: 0.7966
 Site-Real                      (1) | Val  Loss: 0.5614 | Val  Acc: 0.8929
 Site-Real                      (1) | Val  Loss: 0.5500 | Val  Acc: 0.9153
 Site-Real                      (1) | Val  Loss: 0.5037 | Val  Acc: 0.9030
 Site-Real                      (1) | Val  Loss: 0.5333 | Val  Acc: 0.9307
 Site-Painting                  (3) | Val  Loss: 0.6284 | Val  Acc: 0.8878
 Site-Painting                  (3) | Val  Loss: 0.7256 | Val  Acc: 0.8321
 Site-Painting                  (1) | Val  Loss: 0.7111 | Val  Acc: 0.8698
 Site-Sketch                    (0) | Val  Loss: 0.7740 | Val  Acc: 0.7953
 Site-Sketch                    (0) | Val  Loss: 0.8080 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 1.4866 | Val  Acc: 0.6330
 Site-Infograph                 (5) | Val  Loss: 1.4526 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8184
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8553
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8318
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8067
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8048
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.7966
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.8929
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9153
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9030
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9307
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8878
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8321
 Best site-Painting                 (1)  | Epoch:8 | Val Acc: 0.8698
 Best site-Sketch                   (0)  | Epoch:8 | Val Acc: 0.7953
 Best site-Sketch                   (0)  | Epoch:8 | Val Acc: 0.7753
 Best site-QuickDraw                (2)  | Epoch:8 | Val Acc: 0.6330
 Best site-Infograph                (5)  | Epoch:8 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 4, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (4) | Train Loss: 0.7270 | Train Acc: 0.8087
 Site-Clipart                   (5) | Train Loss: 0.6596 | Train Acc: 0.8758
 Site-Clipart                   (5) | Train Loss: 0.7440 | Train Acc: 0.8489
 Site-Clipart                   (4) | Train Loss: 0.7106 | Train Acc: 0.8228
 Site-Clipart                   (5) | Train Loss: 0.7580 | Train Acc: 0.8258
 Site-Real                      (2) | Train Loss: 0.5849 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.4896 | Train Acc: 0.9379
 Site-Real                      (2) | Train Loss: 0.4728 | Train Acc: 0.9274
 Site-Real                      (2) | Train Loss: 0.5492 | Train Acc: 0.9282
 Site-Painting                  (1) | Train Loss: 0.6671 | Train Acc: 0.8367
 Site-Painting                  (1) | Train Loss: 0.6429 | Train Acc: 0.8592
 Site-Painting                  (1) | Train Loss: 0.6677 | Train Acc: 0.8616
 Site-Sketch                    (0) | Train Loss: 0.7420 | Train Acc: 0.8063
 Site-Sketch                    (0) | Train Loss: 0.7457 | Train Acc: 0.7978
 Site-QuickDraw                 (3) | Train Loss: 1.3219 | Train Acc: 0.6300
 Site-Infograph                 (1) | Train Loss: 1.4671 | Train Acc: 0.5256
Average Train Accuracy: 0.8253
 Site-Clipart                   (4) | Val  Loss: 0.5627 | Val  Acc: 0.8684
 Site-Clipart                   (5) | Val  Loss: 0.6994 | Val  Acc: 0.8224
 Site-Clipart                   (5) | Val  Loss: 0.7448 | Val  Acc: 0.8400
 Site-Clipart                   (4) | Val  Loss: 0.6693 | Val  Acc: 0.8381
 Site-Clipart                   (5) | Val  Loss: 0.7659 | Val  Acc: 0.8169
 Site-Real                      (2) | Val  Loss: 0.4938 | Val  Acc: 0.9167
 Site-Real                      (2) | Val  Loss: 0.5023 | Val  Acc: 0.9153
 Site-Real                      (2) | Val  Loss: 0.5151 | Val  Acc: 0.8788
 Site-Real                      (2) | Val  Loss: 0.5015 | Val  Acc: 0.9307
 Site-Painting                  (1) | Val  Loss: 0.5705 | Val  Acc: 0.8776
 Site-Painting                  (1) | Val  Loss: 0.6733 | Val  Acc: 0.8175
 Site-Painting                  (1) | Val  Loss: 0.6393 | Val  Acc: 0.8750
 Site-Sketch                    (0) | Val  Loss: 0.6858 | Val  Acc: 0.8189
 Site-Sketch                    (0) | Val  Loss: 0.7719 | Val  Acc: 0.7809
 Site-QuickDraw                 (3) | Val  Loss: 1.4535 | Val  Acc: 0.5826
 Site-Infograph                 (1) | Val  Loss: 1.3880 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8207
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8684
 Best site-Clipart                  (5)  | Epoch:9 | Val Acc: 0.8224
 Best site-Clipart                  (5)  | Epoch:9 | Val Acc: 0.8400
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8381
 Best site-Clipart                  (5)  | Epoch:9 | Val Acc: 0.8169
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9167
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9153
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.8788
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9307
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8776
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8175
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8750
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.8189
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.7809
 Best site-QuickDraw                (3)  | Epoch:9 | Val Acc: 0.5826
 Best site-Infograph                (1)  | Epoch:9 | Val Acc: 0.5513
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Test site-Clipart                   (4)| Epoch:9 | Test Acc: 0.8536
 Test site-Real                      (2)| Epoch:9 | Test Acc: 0.9252
 Test site-Painting                  (1)| Epoch:9 | Test Acc: 0.8837
 Test site-Sketch                    (0)| Epoch:9 | Test Acc: 0.8231
 Test site-QuickDraw                 (3)| Epoch:9 | Test Acc: 0.6070
 Test site-Infograph                 (1)| Epoch:9 | Test Acc: 0.5129
Clipart: 0.8536, Real: 0.9252, Painting: 0.8837, Sketch: 0.8231, QuickDraw: 0.6070, Infograph: 0.5129, 
Average Test Accuracy(group): 0.7676, Average Test Accuracy(individual): 0.8366,
domain std=0.1524, cluster std=0.0990, individual std=0.1111, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 1, 4, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (3) | Train Loss: 0.6915 | Train Acc: 0.8261
 Site-Clipart                   (3) | Train Loss: 0.5703 | Train Acc: 0.9006
 Site-Clipart                   (3) | Train Loss: 0.7111 | Train Acc: 0.8356
 Site-Clipart                   (0) | Train Loss: 0.6542 | Train Acc: 0.8513
 Site-Clipart                   (3) | Train Loss: 0.6728 | Train Acc: 0.8394
 Site-Real                      (2) | Train Loss: 0.5370 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.4576 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.4397 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.5442 | Train Acc: 0.9253
 Site-Painting                  (4) | Train Loss: 0.6224 | Train Acc: 0.8639
 Site-Painting                  (4) | Train Loss: 0.6235 | Train Acc: 0.8689
 Site-Painting                  (4) | Train Loss: 0.6366 | Train Acc: 0.8651
 Site-Sketch                    (3) | Train Loss: 0.6724 | Train Acc: 0.8377
 Site-Sketch                    (3) | Train Loss: 0.7898 | Train Acc: 0.8165
 Site-QuickDraw                 (1) | Train Loss: 1.2999 | Train Acc: 0.6024
 Site-Infograph                 (5) | Train Loss: 1.3999 | Train Acc: 0.5641
Average Train Accuracy: 0.8363
 Site-Clipart                   (3) | Val  Loss: 0.5471 | Val  Acc: 0.8816
 Site-Clipart                   (3) | Val  Loss: 0.6523 | Val  Acc: 0.8598
 Site-Clipart                   (3) | Val  Loss: 0.6617 | Val  Acc: 0.8533
 Site-Clipart                   (0) | Val  Loss: 0.6118 | Val  Acc: 0.8619
 Site-Clipart                   (3) | Val  Loss: 0.7335 | Val  Acc: 0.8136
 Site-Real                      (2) | Val  Loss: 0.4488 | Val  Acc: 0.9167
 Site-Real                      (2) | Val  Loss: 0.4940 | Val  Acc: 0.9068
 Site-Real                      (2) | Val  Loss: 0.4701 | Val  Acc: 0.8970
 Site-Real                      (2) | Val  Loss: 0.4578 | Val  Acc: 0.9437
 Site-Painting                  (4) | Val  Loss: 0.4976 | Val  Acc: 0.8878
 Site-Painting                  (4) | Val  Loss: 0.6389 | Val  Acc: 0.8540
 Site-Painting                  (4) | Val  Loss: 0.6166 | Val  Acc: 0.8802
 Site-Sketch                    (3) | Val  Loss: 0.6309 | Val  Acc: 0.8425
 Site-Sketch                    (3) | Val  Loss: 0.7376 | Val  Acc: 0.7809
 Site-QuickDraw                 (1) | Val  Loss: 1.3460 | Val  Acc: 0.6422
 Site-Infograph                 (5) | Val  Loss: 1.3284 | Val  Acc: 0.5962
Average Valid Accuracy: 0.8386
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8816
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8598
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8533
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8619
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8136
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9167
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9068
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.8970
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9437
 Best site-Painting                 (4)  | Epoch:10 | Val Acc: 0.8878
 Best site-Painting                 (4)  | Epoch:10 | Val Acc: 0.8540
 Best site-Painting                 (4)  | Epoch:10 | Val Acc: 0.8802
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8425
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.7809
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.6422
 Best site-Infograph                (5)  | Epoch:10 | Val Acc: 0.5962
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 11 ============
cnt=[3, 1, 5, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (4) | Train Loss: 0.6094 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.5768 | Train Acc: 0.8882
 Site-Clipart                   (2) | Train Loss: 0.6846 | Train Acc: 0.8533
 Site-Clipart                   (4) | Train Loss: 0.6219 | Train Acc: 0.8544
 Site-Clipart                   (2) | Train Loss: 0.6684 | Train Acc: 0.8484
 Site-Real                      (3) | Train Loss: 0.5002 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.4304 | Train Acc: 0.9379
 Site-Real                      (3) | Train Loss: 0.4246 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.4947 | Train Acc: 0.9224
 Site-Painting                  (0) | Train Loss: 0.6082 | Train Acc: 0.8571
 Site-Painting                  (0) | Train Loss: 0.5570 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.5749 | Train Acc: 0.8754
 Site-Sketch                    (2) | Train Loss: 0.6290 | Train Acc: 0.8377
 Site-Sketch                    (2) | Train Loss: 0.6886 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 1.1764 | Train Acc: 0.6147
 Site-Infograph                 (5) | Train Loss: 1.4043 | Train Acc: 0.5385
Average Train Accuracy: 0.8367
 Site-Clipart                   (4) | Val  Loss: 0.5030 | Val  Acc: 0.8684
 Site-Clipart                   (2) | Val  Loss: 0.6154 | Val  Acc: 0.8785
 Site-Clipart                   (2) | Val  Loss: 0.6225 | Val  Acc: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.5945 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.7010 | Val  Acc: 0.8339
 Site-Real                      (3) | Val  Loss: 0.4500 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.4596 | Val  Acc: 0.9068
 Site-Real                      (3) | Val  Loss: 0.4314 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.4398 | Val  Acc: 0.9394
 Site-Painting                  (0) | Val  Loss: 0.4815 | Val  Acc: 0.8980
 Site-Painting                  (0) | Val  Loss: 0.5995 | Val  Acc: 0.8248
 Site-Painting                  (0) | Val  Loss: 0.5735 | Val  Acc: 0.8854
 Site-Sketch                    (2) | Val  Loss: 0.5800 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.7471 | Val  Acc: 0.7809
 Site-QuickDraw                 (1) | Val  Loss: 1.2548 | Val  Acc: 0.6743
 Site-Infograph                 (5) | Val  Loss: 1.2694 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8460
 Best site-Clipart                  (4)  | Epoch:11 | Val Acc: 0.8684
 Best site-Clipart                  (2)  | Epoch:11 | Val Acc: 0.8785
 Best site-Clipart                  (2)  | Epoch:11 | Val Acc: 0.8733
 Best site-Clipart                  (4)  | Epoch:11 | Val Acc: 0.8524
 Best site-Clipart                  (2)  | Epoch:11 | Val Acc: 0.8339
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9068
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9273
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9394
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8980
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8248
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8854
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.8740
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.7809
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.6743
 Best site-Infograph                (5)  | Epoch:11 | Val Acc: 0.5897
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 12 ============
cnt=[5, 1, 3, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (4) | Train Loss: 0.5836 | Train Acc: 0.8261
 Site-Clipart                   (4) | Train Loss: 0.5100 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.6410 | Train Acc: 0.8533
 Site-Clipart                   (4) | Train Loss: 0.5921 | Train Acc: 0.8449
 Site-Clipart                   (4) | Train Loss: 0.6235 | Train Acc: 0.8575
 Site-Real                      (0) | Train Loss: 0.4762 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.4248 | Train Acc: 0.9322
 Site-Real                      (0) | Train Loss: 0.3822 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.4748 | Train Acc: 0.9138
 Site-Painting                  (3) | Train Loss: 0.6271 | Train Acc: 0.8367
 Site-Painting                  (3) | Train Loss: 0.5925 | Train Acc: 0.8835
 Site-Painting                  (0) | Train Loss: 0.5552 | Train Acc: 0.8789
 Site-Sketch                    (2) | Train Loss: 0.5996 | Train Acc: 0.8377
 Site-Sketch                    (2) | Train Loss: 0.6414 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 1.1951 | Train Acc: 0.6453
 Site-Infograph                 (5) | Train Loss: 1.4199 | Train Acc: 0.5556
Average Train Accuracy: 0.8392
 Site-Clipart                   (4) | Val  Loss: 0.5274 | Val  Acc: 0.8553
 Site-Clipart                   (4) | Val  Loss: 0.6213 | Val  Acc: 0.8505
 Site-Clipart                   (2) | Val  Loss: 0.5639 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.5233 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.6697 | Val  Acc: 0.8373
 Site-Real                      (0) | Val  Loss: 0.3791 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.4244 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.3981 | Val  Acc: 0.9273
 Site-Real                      (0) | Val  Loss: 0.3780 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.4806 | Val  Acc: 0.8878
 Site-Painting                  (3) | Val  Loss: 0.5246 | Val  Acc: 0.8905
 Site-Painting                  (0) | Val  Loss: 0.5693 | Val  Acc: 0.8594
 Site-Sketch                    (2) | Val  Loss: 0.6049 | Val  Acc: 0.8425
 Site-Sketch                    (2) | Val  Loss: 0.7108 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.2782 | Val  Acc: 0.6468
 Site-Infograph                 (5) | Val  Loss: 1.2511 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8488
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8553
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8505
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8867
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8373
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9286
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9273
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8878
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8905
 Best site-Painting                 (0)  | Epoch:12 | Val Acc: 0.8594
 Best site-Sketch                   (2)  | Epoch:12 | Val Acc: 0.8425
 Best site-Sketch                   (2)  | Epoch:12 | Val Acc: 0.7978
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.6468
 Best site-Infograph                (5)  | Epoch:12 | Val Acc: 0.6154
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 1, 4, 4, 3, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (5) | Train Loss: 0.6112 | Train Acc: 0.8087
 Site-Clipart                   (3) | Train Loss: 0.5097 | Train Acc: 0.8696
 Site-Clipart                   (3) | Train Loss: 0.5908 | Train Acc: 0.8400
 Site-Clipart                   (5) | Train Loss: 0.5510 | Train Acc: 0.8544
 Site-Clipart                   (5) | Train Loss: 0.5927 | Train Acc: 0.8665
 Site-Real                      (2) | Train Loss: 0.4456 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.3925 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.3720 | Train Acc: 0.9355
 Site-Real                      (2) | Train Loss: 0.4529 | Train Acc: 0.9310
 Site-Painting                  (4) | Train Loss: 0.6044 | Train Acc: 0.8571
 Site-Painting                  (4) | Train Loss: 0.5097 | Train Acc: 0.8641
 Site-Painting                  (4) | Train Loss: 0.5130 | Train Acc: 0.8997
 Site-Sketch                    (3) | Train Loss: 0.5979 | Train Acc: 0.8534
 Site-Sketch                    (3) | Train Loss: 0.6042 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 1.1978 | Train Acc: 0.6606
 Site-Infograph                 (0) | Train Loss: 1.3261 | Train Acc: 0.5470
Average Train Accuracy: 0.8428
 Site-Clipart                   (5) | Val  Loss: 0.4906 | Val  Acc: 0.8684
 Site-Clipart                   (3) | Val  Loss: 0.5357 | Val  Acc: 0.8785
 Site-Clipart                   (3) | Val  Loss: 0.6085 | Val  Acc: 0.8400
 Site-Clipart                   (5) | Val  Loss: 0.5603 | Val  Acc: 0.8429
 Site-Clipart                   (5) | Val  Loss: 0.6316 | Val  Acc: 0.8407
 Site-Real                      (2) | Val  Loss: 0.3984 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.4286 | Val  Acc: 0.9068
 Site-Real                      (2) | Val  Loss: 0.3921 | Val  Acc: 0.9152
 Site-Real                      (2) | Val  Loss: 0.3875 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.4548 | Val  Acc: 0.8776
 Site-Painting                  (4) | Val  Loss: 0.5338 | Val  Acc: 0.8759
 Site-Painting                  (4) | Val  Loss: 0.5198 | Val  Acc: 0.8646
 Site-Sketch                    (3) | Val  Loss: 0.5876 | Val  Acc: 0.8504
 Site-Sketch                    (3) | Val  Loss: 0.6434 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.1603 | Val  Acc: 0.6651
 Site-Infograph                 (0) | Val  Loss: 1.2395 | Val  Acc: 0.5962
Average Valid Accuracy: 0.8427
============ Train epoch 14 ============
cnt=[2, 4, 1, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (3) | Train Loss: 0.5787 | Train Acc: 0.8348
 Site-Clipart                   (3) | Train Loss: 0.5014 | Train Acc: 0.8882
 Site-Clipart                   (3) | Train Loss: 0.6034 | Train Acc: 0.8667
 Site-Clipart                   (3) | Train Loss: 0.5418 | Train Acc: 0.8576
 Site-Clipart                   (3) | Train Loss: 0.5541 | Train Acc: 0.8688
 Site-Real                      (5) | Train Loss: 0.4103 | Train Acc: 0.9206
 Site-Real                      (5) | Train Loss: 0.3494 | Train Acc: 0.9548
 Site-Real                      (5) | Train Loss: 0.3412 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.4406 | Train Acc: 0.9109
 Site-Painting                  (1) | Train Loss: 0.5465 | Train Acc: 0.8707
 Site-Painting                  (1) | Train Loss: 0.5442 | Train Acc: 0.8738
 Site-Painting                  (1) | Train Loss: 0.4922 | Train Acc: 0.8581
 Site-Sketch                    (0) | Train Loss: 0.5545 | Train Acc: 0.8429
 Site-Sketch                    (0) | Train Loss: 0.5490 | Train Acc: 0.8240
 Site-QuickDraw                 (2) | Train Loss: 1.1205 | Train Acc: 0.6728
 Site-Infograph                 (4) | Train Loss: 1.2959 | Train Acc: 0.5726
Average Train Accuracy: 0.8476
 Site-Clipart                   (3) | Val  Loss: 0.4369 | Val  Acc: 0.8421
 Site-Clipart                   (3) | Val  Loss: 0.5498 | Val  Acc: 0.8505
 Site-Clipart                   (3) | Val  Loss: 0.5785 | Val  Acc: 0.8600
 Site-Clipart                   (3) | Val  Loss: 0.5020 | Val  Acc: 0.8476
 Site-Clipart                   (3) | Val  Loss: 0.6072 | Val  Acc: 0.8407
 Site-Real                      (5) | Val  Loss: 0.3483 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.3956 | Val  Acc: 0.9322
 Site-Real                      (5) | Val  Loss: 0.3457 | Val  Acc: 0.9394
 Site-Real                      (1) | Val  Loss: 0.3395 | Val  Acc: 0.9610
 Site-Painting                  (1) | Val  Loss: 0.4478 | Val  Acc: 0.8980
 Site-Painting                  (1) | Val  Loss: 0.4732 | Val  Acc: 0.8686
 Site-Painting                  (1) | Val  Loss: 0.5072 | Val  Acc: 0.8854
 Site-Sketch                    (0) | Val  Loss: 0.6014 | Val  Acc: 0.8110
 Site-Sketch                    (0) | Val  Loss: 0.6506 | Val  Acc: 0.8034
 Site-QuickDraw                 (2) | Val  Loss: 1.1476 | Val  Acc: 0.6972
 Site-Infograph                 (4) | Val  Loss: 1.1863 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8484
============ Train epoch 15 ============
cnt=[3, 1, 4, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (0) | Train Loss: 0.5882 | Train Acc: 0.8435
 Site-Clipart                   (4) | Train Loss: 0.4476 | Train Acc: 0.9068
 Site-Clipart                   (4) | Train Loss: 0.5780 | Train Acc: 0.8667
 Site-Clipart                   (0) | Train Loss: 0.5333 | Train Acc: 0.8418
 Site-Clipart                   (0) | Train Loss: 0.5468 | Train Acc: 0.8710
 Site-Real                      (2) | Train Loss: 0.3955 | Train Acc: 0.9286
 Site-Real                      (2) | Train Loss: 0.3399 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.3380 | Train Acc: 0.9556
 Site-Real                      (2) | Train Loss: 0.3797 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.4831 | Train Acc: 0.8367
 Site-Painting                  (3) | Train Loss: 0.4798 | Train Acc: 0.8981
 Site-Painting                  (3) | Train Loss: 0.4685 | Train Acc: 0.9135
 Site-Sketch                    (5) | Train Loss: 0.5016 | Train Acc: 0.8743
 Site-Sketch                    (5) | Train Loss: 0.6098 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 1.1166 | Train Acc: 0.6789
 Site-Infograph                 (3) | Train Loss: 1.2707 | Train Acc: 0.5855
Average Train Accuracy: 0.8577
 Site-Clipart                   (0) | Val  Loss: 0.3945 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.4960 | Val  Acc: 0.8598
 Site-Clipart                   (4) | Val  Loss: 0.5119 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.5162 | Val  Acc: 0.8619
 Site-Clipart                   (0) | Val  Loss: 0.5934 | Val  Acc: 0.8407
 Site-Real                      (2) | Val  Loss: 0.3471 | Val  Acc: 0.9167
 Site-Real                      (2) | Val  Loss: 0.3827 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.3287 | Val  Acc: 0.9394
 Site-Real                      (2) | Val  Loss: 0.3474 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.3605 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.4610 | Val  Acc: 0.8686
 Site-Painting                  (3) | Val  Loss: 0.4650 | Val  Acc: 0.9115
 Site-Sketch                    (5) | Val  Loss: 0.5301 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.6289 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 1.1106 | Val  Acc: 0.7110
 Site-Infograph                 (3) | Val  Loss: 1.1638 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8608
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8816
 Best site-Clipart                  (4)  | Epoch:15 | Val Acc: 0.8598
 Best site-Clipart                  (4)  | Epoch:15 | Val Acc: 0.8733
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8619
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8407
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9167
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9394
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9437
 Best site-Painting                 (3)  | Epoch:15 | Val Acc: 0.9184
 Best site-Painting                 (3)  | Epoch:15 | Val Acc: 0.8686
 Best site-Painting                 (3)  | Epoch:15 | Val Acc: 0.9115
 Best site-Sketch                   (5)  | Epoch:15 | Val Acc: 0.8661
 Best site-Sketch                   (5)  | Epoch:15 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.7110
 Best site-Infograph                (3)  | Epoch:15 | Val Acc: 0.6282
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 1, 3, 4, 4, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (0) | Train Loss: 0.4706 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.3903 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.5638 | Train Acc: 0.8622
 Site-Clipart                   (0) | Train Loss: 0.4913 | Train Acc: 0.8703
 Site-Clipart                   (4) | Train Loss: 0.5452 | Train Acc: 0.8575
 Site-Real                      (3) | Train Loss: 0.4219 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.3248 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.3356 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3839 | Train Acc: 0.9224
 Site-Painting                  (2) | Train Loss: 0.4749 | Train Acc: 0.8639
 Site-Painting                  (2) | Train Loss: 0.4481 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.4668 | Train Acc: 0.8997
 Site-Sketch                    (4) | Train Loss: 0.5414 | Train Acc: 0.8534
 Site-Sketch                    (4) | Train Loss: 0.5824 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.9600 | Train Acc: 0.7003
 Site-Infograph                 (5) | Train Loss: 1.2365 | Train Acc: 0.5855
Average Train Accuracy: 0.8595
 Site-Clipart                   (0) | Val  Loss: 0.3840 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.5143 | Val  Acc: 0.8505
 Site-Clipart                   (4) | Val  Loss: 0.5034 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.4798 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.5553 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.3294 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.3616 | Val  Acc: 0.9153
 Site-Real                      (3) | Val  Loss: 0.3588 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3317 | Val  Acc: 0.9351
 Site-Painting                  (2) | Val  Loss: 0.3724 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.4643 | Val  Acc: 0.8978
 Site-Painting                  (2) | Val  Loss: 0.4888 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.5690 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.5858 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 1.0439 | Val  Acc: 0.7018
 Site-Infograph                 (5) | Val  Loss: 1.1790 | Val  Acc: 0.6026
Average Valid Accuracy: 0.8570
============ Train epoch 17 ============
cnt=[2, 1, 4, 2, 4, 3, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (0) | Train Loss: 0.5479 | Train Acc: 0.8348
 Site-Clipart                   (5) | Train Loss: 0.4275 | Train Acc: 0.9006
 Site-Clipart                   (5) | Train Loss: 0.5326 | Train Acc: 0.8667
 Site-Clipart                   (0) | Train Loss: 0.4924 | Train Acc: 0.8703
 Site-Clipart                   (5) | Train Loss: 0.4838 | Train Acc: 0.8778
 Site-Real                      (2) | Train Loss: 0.4091 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.3208 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.3218 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.3530 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.4809 | Train Acc: 0.8912
 Site-Painting                  (4) | Train Loss: 0.4444 | Train Acc: 0.8932
 Site-Painting                  (4) | Train Loss: 0.4384 | Train Acc: 0.8893
 Site-Sketch                    (3) | Train Loss: 0.5305 | Train Acc: 0.8691
 Site-Sketch                    (3) | Train Loss: 0.5088 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.9333 | Train Acc: 0.6911
 Site-Infograph                 (4) | Train Loss: 1.2326 | Train Acc: 0.6026
Average Train Accuracy: 0.8602
 Site-Clipart                   (0) | Val  Loss: 0.4100 | Val  Acc: 0.8684
 Site-Clipart                   (5) | Val  Loss: 0.4605 | Val  Acc: 0.8598
 Site-Clipart                   (5) | Val  Loss: 0.5197 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4811 | Val  Acc: 0.8571
 Site-Clipart                   (5) | Val  Loss: 0.5476 | Val  Acc: 0.8508
 Site-Real                      (2) | Val  Loss: 0.3291 | Val  Acc: 0.9167
 Site-Real                      (2) | Val  Loss: 0.3721 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.3113 | Val  Acc: 0.9455
 Site-Real                      (2) | Val  Loss: 0.3354 | Val  Acc: 0.9394
 Site-Painting                  (4) | Val  Loss: 0.3726 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.3702 | Val  Acc: 0.9197
 Site-Painting                  (4) | Val  Loss: 0.4659 | Val  Acc: 0.8802
 Site-Sketch                    (3) | Val  Loss: 0.5007 | Val  Acc: 0.8661
 Site-Sketch                    (3) | Val  Loss: 0.6068 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.0142 | Val  Acc: 0.7431
 Site-Infograph                 (4) | Val  Loss: 1.1878 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8624
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8684
 Best site-Clipart                  (5)  | Epoch:17 | Val Acc: 0.8598
 Best site-Clipart                  (5)  | Epoch:17 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8571
 Best site-Clipart                  (5)  | Epoch:17 | Val Acc: 0.8508
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9167
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9455
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9394
 Best site-Painting                 (4)  | Epoch:17 | Val Acc: 0.9286
 Best site-Painting                 (4)  | Epoch:17 | Val Acc: 0.9197
 Best site-Painting                 (4)  | Epoch:17 | Val Acc: 0.8802
 Best site-Sketch                   (3)  | Epoch:17 | Val Acc: 0.8661
 Best site-Sketch                   (3)  | Epoch:17 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:17 | Val Acc: 0.7431
 Best site-Infograph                (4)  | Epoch:17 | Val Acc: 0.6154
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 4, 2, 4, 4, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (2) | Train Loss: 0.4724 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.3886 | Train Acc: 0.9068
 Site-Clipart                   (4) | Train Loss: 0.5141 | Train Acc: 0.8711
 Site-Clipart                   (2) | Train Loss: 0.4884 | Train Acc: 0.8639
 Site-Clipart                   (4) | Train Loss: 0.4965 | Train Acc: 0.8688
 Site-Real                      (3) | Train Loss: 0.3803 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2841 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3090 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3396 | Train Acc: 0.9454
 Site-Painting                  (1) | Train Loss: 0.5161 | Train Acc: 0.8571
 Site-Painting                  (1) | Train Loss: 0.4429 | Train Acc: 0.8981
 Site-Painting                  (1) | Train Loss: 0.4653 | Train Acc: 0.8824
 Site-Sketch                    (5) | Train Loss: 0.4749 | Train Acc: 0.8534
 Site-Sketch                    (4) | Train Loss: 0.5194 | Train Acc: 0.8464
 Site-QuickDraw                 (0) | Train Loss: 0.9630 | Train Acc: 0.6942
 Site-Infograph                 (1) | Train Loss: 1.2620 | Train Acc: 0.5855
Average Train Accuracy: 0.8591
 Site-Clipart                   (2) | Val  Loss: 0.3581 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.4611 | Val  Acc: 0.8692
 Site-Clipart                   (4) | Val  Loss: 0.4678 | Val  Acc: 0.8733
 Site-Clipart                   (2) | Val  Loss: 0.4588 | Val  Acc: 0.8714
 Site-Clipart                   (4) | Val  Loss: 0.5275 | Val  Acc: 0.8576
 Site-Real                      (3) | Val  Loss: 0.3061 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.3001 | Val  Acc: 0.9661
 Site-Real                      (3) | Val  Loss: 0.3181 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2959 | Val  Acc: 0.9524
 Site-Painting                  (1) | Val  Loss: 0.3896 | Val  Acc: 0.8673
 Site-Painting                  (1) | Val  Loss: 0.3887 | Val  Acc: 0.9124
 Site-Painting                  (1) | Val  Loss: 0.4032 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.4882 | Val  Acc: 0.8740
 Site-Sketch                    (4) | Val  Loss: 0.5457 | Val  Acc: 0.8146
 Site-QuickDraw                 (0) | Val  Loss: 1.0000 | Val  Acc: 0.7248
 Site-Infograph                 (1) | Val  Loss: 1.1340 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8705
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.9079
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8692
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8733
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8714
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8576
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9661
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9394
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9524
 Best site-Painting                 (1)  | Epoch:18 | Val Acc: 0.8673
 Best site-Painting                 (1)  | Epoch:18 | Val Acc: 0.9124
 Best site-Painting                 (1)  | Epoch:18 | Val Acc: 0.9219
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.8740
 Best site-Sketch                   (4)  | Epoch:18 | Val Acc: 0.8146
 Best site-QuickDraw                (0)  | Epoch:18 | Val Acc: 0.7248
 Best site-Infograph                (1)  | Epoch:18 | Val Acc: 0.6474
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 1, 5, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (0) | Train Loss: 0.5009 | Train Acc: 0.8696
 Site-Clipart                   (5) | Train Loss: 0.3663 | Train Acc: 0.9130
 Site-Clipart                   (5) | Train Loss: 0.4948 | Train Acc: 0.8711
 Site-Clipart                   (0) | Train Loss: 0.4606 | Train Acc: 0.8734
 Site-Clipart                   (5) | Train Loss: 0.4751 | Train Acc: 0.8778
 Site-Real                      (4) | Train Loss: 0.3557 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.2962 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2920 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.3578 | Train Acc: 0.9195
 Site-Painting                  (2) | Train Loss: 0.4252 | Train Acc: 0.8844
 Site-Painting                  (2) | Train Loss: 0.3642 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.4117 | Train Acc: 0.8927
 Site-Sketch                    (3) | Train Loss: 0.5108 | Train Acc: 0.8482
 Site-Sketch                    (3) | Train Loss: 0.5223 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.9582 | Train Acc: 0.7187
 Site-Infograph                 (2) | Train Loss: 1.2111 | Train Acc: 0.6111
Average Train Accuracy: 0.8653
 Site-Clipart                   (0) | Val  Loss: 0.3662 | Val  Acc: 0.8947
 Site-Clipart                   (5) | Val  Loss: 0.4527 | Val  Acc: 0.8972
 Site-Clipart                   (5) | Val  Loss: 0.4483 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.4591 | Val  Acc: 0.8810
 Site-Clipart                   (5) | Val  Loss: 0.5113 | Val  Acc: 0.8644
 Site-Real                      (4) | Val  Loss: 0.2903 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.3346 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2950 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2933 | Val  Acc: 0.9394
 Site-Painting                  (2) | Val  Loss: 0.3185 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.4096 | Val  Acc: 0.8759
 Site-Painting                  (2) | Val  Loss: 0.4473 | Val  Acc: 0.9167
 Site-Sketch                    (3) | Val  Loss: 0.4841 | Val  Acc: 0.8898
 Site-Sketch                    (3) | Val  Loss: 0.5782 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.9457 | Val  Acc: 0.7615
 Site-Infograph                 (2) | Val  Loss: 1.1905 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8746
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8947
 Best site-Clipart                  (5)  | Epoch:19 | Val Acc: 0.8972
 Best site-Clipart                  (5)  | Epoch:19 | Val Acc: 0.8800
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8810
 Best site-Clipart                  (5)  | Epoch:19 | Val Acc: 0.8644
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:19 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9394
 Best site-Painting                 (2)  | Epoch:19 | Val Acc: 0.9286
 Best site-Painting                 (2)  | Epoch:19 | Val Acc: 0.8759
 Best site-Painting                 (2)  | Epoch:19 | Val Acc: 0.9167
 Best site-Sketch                   (3)  | Epoch:19 | Val Acc: 0.8898
 Best site-Sketch                   (3)  | Epoch:19 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:19 | Val Acc: 0.7615
 Best site-Infograph                (2)  | Epoch:19 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Test site-Clipart                   (0)| Epoch:19 | Test Acc: 0.8935
 Test site-Real                      (4)| Epoch:19 | Test Acc: 0.9384
 Test site-Painting                  (2)| Epoch:19 | Test Acc: 0.9257
 Test site-Sketch                    (3)| Epoch:19 | Test Acc: 0.8556
 Test site-QuickDraw                 (1)| Epoch:19 | Test Acc: 0.7020
 Test site-Infograph                 (2)| Epoch:19 | Test Acc: 0.5388
Clipart: 0.8935, Real: 0.9384, Painting: 0.9257, Sketch: 0.8556, QuickDraw: 0.7020, Infograph: 0.5388, 
Average Test Accuracy(group): 0.8090, Average Test Accuracy(individual): 0.8719,
domain std=0.1438, cluster std=0.0745, individual std=0.1028, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 1, 3, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (5) | Train Loss: 0.4924 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.3899 | Train Acc: 0.8634
 Site-Clipart                   (2) | Train Loss: 0.5045 | Train Acc: 0.8756
 Site-Clipart                   (5) | Train Loss: 0.4654 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.4533 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.3424 | Train Acc: 0.9286
 Site-Real                      (3) | Train Loss: 0.2861 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2691 | Train Acc: 0.9637
 Site-Real                      (3) | Train Loss: 0.3260 | Train Acc: 0.9282
 Site-Painting                  (0) | Train Loss: 0.3971 | Train Acc: 0.8844
 Site-Painting                  (0) | Train Loss: 0.3831 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.4057 | Train Acc: 0.9031
 Site-Sketch                    (4) | Train Loss: 0.5000 | Train Acc: 0.8429
 Site-Sketch                    (4) | Train Loss: 0.6351 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.9541 | Train Acc: 0.7431
 Site-Infograph                 (0) | Train Loss: 1.2247 | Train Acc: 0.5983
Average Train Accuracy: 0.8629
 Site-Clipart                   (5) | Val  Loss: 0.3269 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.4242 | Val  Acc: 0.8692
 Site-Clipart                   (2) | Val  Loss: 0.4374 | Val  Acc: 0.8867
 Site-Clipart                   (5) | Val  Loss: 0.4534 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.5135 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.3039 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3291 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2662 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2951 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3212 | Val  Acc: 0.9490
 Site-Painting                  (0) | Val  Loss: 0.4191 | Val  Acc: 0.9197
 Site-Painting                  (0) | Val  Loss: 0.4413 | Val  Acc: 0.8750
 Site-Sketch                    (4) | Val  Loss: 0.5078 | Val  Acc: 0.8740
 Site-Sketch                    (4) | Val  Loss: 0.5185 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.9493 | Val  Acc: 0.7431
 Site-Infograph                 (0) | Val  Loss: 1.1272 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8743
============ Train epoch 21 ============
cnt=[5, 1, 3, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.5329 | Train Acc: 0.8087
 Site-Clipart                   (0) | Train Loss: 0.3925 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.4784 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.4734 | Train Acc: 0.8608
 Site-Clipart                   (0) | Train Loss: 0.4557 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.3568 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2603 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2783 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.3218 | Train Acc: 0.9425
 Site-Painting                  (5) | Train Loss: 0.3584 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.3924 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.3821 | Train Acc: 0.9273
 Site-Sketch                    (4) | Train Loss: 0.4942 | Train Acc: 0.8586
 Site-Sketch                    (4) | Train Loss: 0.5025 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.8526 | Train Acc: 0.7584
 Site-Infograph                 (2) | Train Loss: 1.2514 | Train Acc: 0.5897
Average Train Accuracy: 0.8655
 Site-Clipart                   (0) | Val  Loss: 0.3317 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.3997 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.4394 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.4061 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.5003 | Val  Acc: 0.8746
 Site-Real                      (3) | Val  Loss: 0.2694 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.2931 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.3231 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.2704 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2664 | Val  Acc: 0.9592
 Site-Painting                  (5) | Val  Loss: 0.4323 | Val  Acc: 0.8905
 Site-Painting                  (2) | Val  Loss: 0.3944 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.4808 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.5384 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.9080 | Val  Acc: 0.7431
 Site-Infograph                 (2) | Val  Loss: 1.1868 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8707
============ Train epoch 22 ============
cnt=[5, 1, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.4303 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.3694 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.4501 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.4438 | Train Acc: 0.8671
 Site-Clipart                   (0) | Train Loss: 0.4580 | Train Acc: 0.8778
 Site-Real                      (3) | Train Loss: 0.3647 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2815 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2844 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.3387 | Train Acc: 0.9282
 Site-Painting                  (2) | Train Loss: 0.3900 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.3940 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.3998 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.4979 | Train Acc: 0.8429
 Site-Sketch                    (5) | Train Loss: 0.4668 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.8717 | Train Acc: 0.7462
 Site-Infograph                 (4) | Train Loss: 1.1248 | Train Acc: 0.6581
Average Train Accuracy: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.3448 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.4061 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.4911 | Val  Acc: 0.8600
 Site-Clipart                   (0) | Val  Loss: 0.4172 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.4827 | Val  Acc: 0.8678
 Site-Real                      (3) | Val  Loss: 0.2662 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.3150 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2984 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.3000 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.3415 | Val  Acc: 0.8878
 Site-Painting                  (2) | Val  Loss: 0.3819 | Val  Acc: 0.8978
 Site-Painting                  (2) | Val  Loss: 0.4414 | Val  Acc: 0.8594
 Site-Sketch                    (5) | Val  Loss: 0.4908 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.5745 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 0.9117 | Val  Acc: 0.7385
 Site-Infograph                 (4) | Val  Loss: 1.0924 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8640
============ Train epoch 23 ============
cnt=[1, 4, 4, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.5010 | Train Acc: 0.8174
 Site-Clipart                   (2) | Train Loss: 0.3537 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.4642 | Train Acc: 0.8933
 Site-Clipart                   (5) | Train Loss: 0.4195 | Train Acc: 0.8861
 Site-Clipart                   (2) | Train Loss: 0.4422 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.3483 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2684 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2755 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3300 | Train Acc: 0.9397
 Site-Painting                  (1) | Train Loss: 0.4828 | Train Acc: 0.8639
 Site-Painting                  (1) | Train Loss: 0.3834 | Train Acc: 0.9223
 Site-Painting                  (1) | Train Loss: 0.3814 | Train Acc: 0.9100
 Site-Sketch                    (4) | Train Loss: 0.4715 | Train Acc: 0.8586
 Site-Sketch                    (4) | Train Loss: 0.5223 | Train Acc: 0.8502
 Site-QuickDraw                 (0) | Train Loss: 0.8844 | Train Acc: 0.7645
 Site-Infograph                 (1) | Train Loss: 1.1500 | Train Acc: 0.6581
Average Train Accuracy: 0.8739
 Site-Clipart                   (2) | Val  Loss: 0.3271 | Val  Acc: 0.8684
 Site-Clipart                   (2) | Val  Loss: 0.4034 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.4554 | Val  Acc: 0.8933
 Site-Clipart                   (5) | Val  Loss: 0.3925 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.4960 | Val  Acc: 0.8678
 Site-Real                      (3) | Val  Loss: 0.2870 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2926 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.2795 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2703 | Val  Acc: 0.9524
 Site-Painting                  (1) | Val  Loss: 0.2635 | Val  Acc: 0.9796
 Site-Painting                  (1) | Val  Loss: 0.3355 | Val  Acc: 0.9051
 Site-Painting                  (1) | Val  Loss: 0.3800 | Val  Acc: 0.9115
 Site-Sketch                    (4) | Val  Loss: 0.4893 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.5051 | Val  Acc: 0.8427
 Site-QuickDraw                 (0) | Val  Loss: 0.8881 | Val  Acc: 0.7752
 Site-Infograph                 (1) | Val  Loss: 1.1292 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8783
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8684
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8879
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8933
 Best site-Clipart                  (5)  | Epoch:23 | Val Acc: 0.8905
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8678
 Best site-Real                     (3)  | Epoch:23 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:23 | Val Acc: 0.9237
 Best site-Real                     (3)  | Epoch:23 | Val Acc: 0.9394
 Best site-Real                     (3)  | Epoch:23 | Val Acc: 0.9524
 Best site-Painting                 (1)  | Epoch:23 | Val Acc: 0.9796
 Best site-Painting                 (1)  | Epoch:23 | Val Acc: 0.9051
 Best site-Painting                 (1)  | Epoch:23 | Val Acc: 0.9115
 Best site-Sketch                   (4)  | Epoch:23 | Val Acc: 0.8583
 Best site-Sketch                   (4)  | Epoch:23 | Val Acc: 0.8427
 Best site-QuickDraw                (0)  | Epoch:23 | Val Acc: 0.7752
 Best site-Infograph                (1)  | Epoch:23 | Val Acc: 0.6282
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 24 ============
cnt=[2, 1, 4, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (3) | Train Loss: 0.4819 | Train Acc: 0.8435
 Site-Clipart                   (3) | Train Loss: 0.3751 | Train Acc: 0.9193
 Site-Clipart                   (3) | Train Loss: 0.4840 | Train Acc: 0.8844
 Site-Clipart                   (3) | Train Loss: 0.4377 | Train Acc: 0.8892
 Site-Clipart                   (3) | Train Loss: 0.4378 | Train Acc: 0.8643
 Site-Real                      (2) | Train Loss: 0.3550 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.2721 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2771 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.3267 | Train Acc: 0.9310
 Site-Painting                  (4) | Train Loss: 0.4510 | Train Acc: 0.8844
 Site-Painting                  (4) | Train Loss: 0.4151 | Train Acc: 0.9078
 Site-Painting                  (4) | Train Loss: 0.4050 | Train Acc: 0.8927
 Site-Sketch                    (0) | Train Loss: 0.4827 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.5135 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.7390 | Train Acc: 0.7768
 Site-Infograph                 (5) | Train Loss: 1.1254 | Train Acc: 0.5983
Average Train Accuracy: 0.8688
 Site-Clipart                   (3) | Val  Loss: 0.3004 | Val  Acc: 0.9211
 Site-Clipart                   (3) | Val  Loss: 0.4185 | Val  Acc: 0.8692
 Site-Clipart                   (3) | Val  Loss: 0.3927 | Val  Acc: 0.8933
 Site-Clipart                   (3) | Val  Loss: 0.3983 | Val  Acc: 0.9190
 Site-Clipart                   (3) | Val  Loss: 0.4610 | Val  Acc: 0.8780
 Site-Real                      (2) | Val  Loss: 0.2681 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2836 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2574 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.2761 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2608 | Val  Acc: 0.9796
 Site-Painting                  (4) | Val  Loss: 0.3544 | Val  Acc: 0.9051
 Site-Painting                  (4) | Val  Loss: 0.3677 | Val  Acc: 0.9062
 Site-Sketch                    (0) | Val  Loss: 0.5111 | Val  Acc: 0.8661
 Site-Sketch                    (0) | Val  Loss: 0.5381 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.8820 | Val  Acc: 0.7890
 Site-Infograph                 (5) | Val  Loss: 1.1019 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8874
 Best site-Clipart                  (3)  | Epoch:24 | Val Acc: 0.9211
 Best site-Clipart                  (3)  | Epoch:24 | Val Acc: 0.8692
 Best site-Clipart                  (3)  | Epoch:24 | Val Acc: 0.8933
 Best site-Clipart                  (3)  | Epoch:24 | Val Acc: 0.9190
 Best site-Clipart                  (3)  | Epoch:24 | Val Acc: 0.8780
 Best site-Real                     (2)  | Epoch:24 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:24 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:24 | Val Acc: 0.9576
 Best site-Real                     (2)  | Epoch:24 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:24 | Val Acc: 0.9796
 Best site-Painting                 (4)  | Epoch:24 | Val Acc: 0.9051
 Best site-Painting                 (4)  | Epoch:24 | Val Acc: 0.9062
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.8661
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.8258
 Best site-QuickDraw                (1)  | Epoch:24 | Val Acc: 0.7890
 Best site-Infograph                (5)  | Epoch:24 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 1, 5, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (2) | Train Loss: 0.4145 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.3201 | Train Acc: 0.9379
 Site-Clipart                   (2) | Train Loss: 0.4420 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.4125 | Train Acc: 0.8829
 Site-Clipart                   (2) | Train Loss: 0.4349 | Train Acc: 0.8891
 Site-Real                      (3) | Train Loss: 0.3568 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2537 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2574 | Train Acc: 0.9597
 Site-Real                      (3) | Train Loss: 0.2869 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.4113 | Train Acc: 0.8776
 Site-Painting                  (5) | Train Loss: 0.3687 | Train Acc: 0.8932
 Site-Painting                  (3) | Train Loss: 0.3515 | Train Acc: 0.9135
 Site-Sketch                    (4) | Train Loss: 0.4260 | Train Acc: 0.8901
 Site-Sketch                    (4) | Train Loss: 0.6058 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.7666 | Train Acc: 0.7492
 Site-Infograph                 (0) | Train Loss: 1.0913 | Train Acc: 0.6538
Average Train Accuracy: 0.8765
 Site-Clipart                   (2) | Val  Loss: 0.2933 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.4251 | Val  Acc: 0.8692
 Site-Clipart                   (2) | Val  Loss: 0.4526 | Val  Acc: 0.8533
 Site-Clipart                   (2) | Val  Loss: 0.3953 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.4616 | Val  Acc: 0.8746
 Site-Real                      (3) | Val  Loss: 0.3019 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2903 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2659 | Val  Acc: 0.9515
 Site-Real                      (3) | Val  Loss: 0.2730 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2838 | Val  Acc: 0.9184
 Site-Painting                  (5) | Val  Loss: 0.3777 | Val  Acc: 0.8905
 Site-Painting                  (3) | Val  Loss: 0.3694 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.5058 | Val  Acc: 0.8740
 Site-Sketch                    (4) | Val  Loss: 0.5434 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 0.9009 | Val  Acc: 0.7477
 Site-Infograph                 (0) | Val  Loss: 1.0888 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8747
============ Train epoch 26 ============
cnt=[3, 1, 2, 4, 5, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (4) | Train Loss: 0.4260 | Train Acc: 0.8522
 Site-Clipart                   (4) | Train Loss: 0.3638 | Train Acc: 0.8820
 Site-Clipart                   (4) | Train Loss: 0.4766 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.4168 | Train Acc: 0.8892
 Site-Clipart                   (4) | Train Loss: 0.4143 | Train Acc: 0.8959
 Site-Real                      (3) | Train Loss: 0.3332 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2557 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2794 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.2914 | Train Acc: 0.9454
 Site-Painting                  (0) | Train Loss: 0.4198 | Train Acc: 0.8844
 Site-Painting                  (0) | Train Loss: 0.4089 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.3576 | Train Acc: 0.9135
 Site-Sketch                    (2) | Train Loss: 0.4604 | Train Acc: 0.8534
 Site-Sketch                    (2) | Train Loss: 0.4824 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.7734 | Train Acc: 0.7768
 Site-Infograph                 (5) | Train Loss: 1.0631 | Train Acc: 0.6581
Average Train Accuracy: 0.8756
 Site-Clipart                   (4) | Val  Loss: 0.2768 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.3828 | Val  Acc: 0.8785
 Site-Clipart                   (4) | Val  Loss: 0.4083 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.3799 | Val  Acc: 0.8952
 Site-Clipart                   (4) | Val  Loss: 0.4514 | Val  Acc: 0.8746
 Site-Real                      (3) | Val  Loss: 0.2631 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2765 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.2825 | Val  Acc: 0.9515
 Site-Real                      (3) | Val  Loss: 0.2700 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.3011 | Val  Acc: 0.9490
 Site-Painting                  (0) | Val  Loss: 0.3450 | Val  Acc: 0.9051
 Site-Painting                  (0) | Val  Loss: 0.3537 | Val  Acc: 0.9323
 Site-Sketch                    (2) | Val  Loss: 0.4383 | Val  Acc: 0.8898
 Site-Sketch                    (2) | Val  Loss: 0.5105 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.8219 | Val  Acc: 0.7569
 Site-Infograph                 (5) | Val  Loss: 1.0680 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8844
============ Train epoch 27 ============
cnt=[2, 1, 4, 3, 4, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (0) | Train Loss: 0.4510 | Train Acc: 0.8348
 Site-Clipart                   (3) | Train Loss: 0.3330 | Train Acc: 0.9317
 Site-Clipart                   (3) | Train Loss: 0.4549 | Train Acc: 0.8978
 Site-Clipart                   (0) | Train Loss: 0.3996 | Train Acc: 0.8829
 Site-Clipart                   (3) | Train Loss: 0.4059 | Train Acc: 0.8891
 Site-Real                      (2) | Train Loss: 0.3174 | Train Acc: 0.9365
 Site-Real                      (2) | Train Loss: 0.2257 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.2322 | Train Acc: 0.9597
 Site-Real                      (2) | Train Loss: 0.2886 | Train Acc: 0.9195
 Site-Painting                  (4) | Train Loss: 0.3642 | Train Acc: 0.8912
 Site-Painting                  (4) | Train Loss: 0.3886 | Train Acc: 0.9029
 Site-Painting                  (4) | Train Loss: 0.3362 | Train Acc: 0.9308
 Site-Sketch                    (5) | Train Loss: 0.4071 | Train Acc: 0.8901
 Site-Sketch                    (5) | Train Loss: 0.4800 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.8594 | Train Acc: 0.7401
 Site-Infograph                 (4) | Train Loss: 1.0741 | Train Acc: 0.6453
Average Train Accuracy: 0.8788
 Site-Clipart                   (0) | Val  Loss: 0.2947 | Val  Acc: 0.8947
 Site-Clipart                   (3) | Val  Loss: 0.3761 | Val  Acc: 0.9252
 Site-Clipart                   (3) | Val  Loss: 0.4334 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.3916 | Val  Acc: 0.8714
 Site-Clipart                   (3) | Val  Loss: 0.4549 | Val  Acc: 0.8644
 Site-Real                      (2) | Val  Loss: 0.2435 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2444 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.2613 | Val  Acc: 0.9152
 Site-Real                      (2) | Val  Loss: 0.2594 | Val  Acc: 0.9610
 Site-Painting                  (4) | Val  Loss: 0.2765 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.3036 | Val  Acc: 0.9124
 Site-Painting                  (4) | Val  Loss: 0.3734 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.3822 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.5161 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.8535 | Val  Acc: 0.7615
 Site-Infograph                 (4) | Val  Loss: 1.0912 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8815
============ Train epoch 28 ============
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (0) | Train Loss: 0.4125 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.3484 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.4703 | Train Acc: 0.8756
 Site-Clipart                   (0) | Train Loss: 0.4083 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.4066 | Train Acc: 0.8891
 Site-Real                      (2) | Train Loss: 0.3165 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.2244 | Train Acc: 0.9718
 Site-Real                      (2) | Train Loss: 0.2520 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2973 | Train Acc: 0.9339
 Site-Painting                  (3) | Train Loss: 0.3882 | Train Acc: 0.8980
 Site-Painting                  (3) | Train Loss: 0.3984 | Train Acc: 0.8981
 Site-Painting                  (3) | Train Loss: 0.3124 | Train Acc: 0.9343
 Site-Sketch                    (5) | Train Loss: 0.4567 | Train Acc: 0.8639
 Site-Sketch                    (5) | Train Loss: 0.5170 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.7253 | Train Acc: 0.7829
 Site-Infograph                 (4) | Train Loss: 1.0965 | Train Acc: 0.6197
Average Train Accuracy: 0.8761
 Site-Clipart                   (0) | Val  Loss: 0.2766 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.3412 | Val  Acc: 0.8879
 Site-Clipart                   (0) | Val  Loss: 0.3960 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.3960 | Val  Acc: 0.8810
 Site-Clipart                   (0) | Val  Loss: 0.4355 | Val  Acc: 0.8847
 Site-Real                      (2) | Val  Loss: 0.2481 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2760 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2473 | Val  Acc: 0.9394
 Site-Real                      (2) | Val  Loss: 0.2253 | Val  Acc: 0.9654
 Site-Painting                  (3) | Val  Loss: 0.2544 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.3208 | Val  Acc: 0.9197
 Site-Painting                  (3) | Val  Loss: 0.3242 | Val  Acc: 0.9115
 Site-Sketch                    (5) | Val  Loss: 0.3831 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.5005 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.8021 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 1.0755 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8853
============ Train epoch 29 ============
cnt=[5, 1, 3, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (0) | Train Loss: 0.4807 | Train Acc: 0.8348
 Site-Clipart                   (0) | Train Loss: 0.3290 | Train Acc: 0.9255
 Site-Clipart                   (0) | Train Loss: 0.4410 | Train Acc: 0.8756
 Site-Clipart                   (0) | Train Loss: 0.4165 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.4020 | Train Acc: 0.8914
 Site-Real                      (3) | Train Loss: 0.3370 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2338 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2414 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.2866 | Train Acc: 0.9253
 Site-Painting                  (2) | Train Loss: 0.3676 | Train Acc: 0.8844
 Site-Painting                  (2) | Train Loss: 0.3384 | Train Acc: 0.9078
 Site-Painting                  (2) | Train Loss: 0.3319 | Train Acc: 0.9273
 Site-Sketch                    (4) | Train Loss: 0.4262 | Train Acc: 0.8796
 Site-Sketch                    (4) | Train Loss: 0.4933 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.7696 | Train Acc: 0.7645
 Site-Infograph                 (5) | Train Loss: 1.0567 | Train Acc: 0.6453
Average Train Accuracy: 0.8764
 Site-Clipart                   (0) | Val  Loss: 0.2639 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.3560 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.4122 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.3864 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.4331 | Val  Acc: 0.8814
 Site-Real                      (3) | Val  Loss: 0.2464 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2524 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2580 | Val  Acc: 0.9515
 Site-Real                      (3) | Val  Loss: 0.2571 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.2574 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3568 | Val  Acc: 0.8905
 Site-Painting                  (2) | Val  Loss: 0.3624 | Val  Acc: 0.8906
 Site-Sketch                    (4) | Val  Loss: 0.4242 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.5225 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7995 | Val  Acc: 0.7706
 Site-Infograph                 (5) | Val  Loss: 1.0409 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8818
 Test site-Clipart                   (0)| Epoch:24 | Test Acc: 0.8935
 Test site-Real                      (3)| Epoch:24 | Test Acc: 0.9359
 Test site-Painting                  (2)| Epoch:24 | Test Acc: 0.9273
 Test site-Sketch                    (4)| Epoch:24 | Test Acc: 0.8682
 Test site-QuickDraw                 (1)| Epoch:24 | Test Acc: 0.7400
 Test site-Infograph                 (5)| Epoch:24 | Test Acc: 0.5632
Clipart: 0.8935, Real: 0.9359, Painting: 0.9273, Sketch: 0.8682, QuickDraw: 0.7400, Infograph: 0.5632, 
Average Test Accuracy(group): 0.8214, Average Test Accuracy(individual): 0.8771,
domain std=0.1323, cluster std=0.1323, individual std=0.0936, 
============ Train epoch 30 ============
cnt=[1, 5, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (1) | Train Loss: 0.4242 | Train Acc: 0.8696
 Site-Clipart                   (1) | Train Loss: 0.3350 | Train Acc: 0.9130
 Site-Clipart                   (1) | Train Loss: 0.4301 | Train Acc: 0.8800
 Site-Clipart                   (1) | Train Loss: 0.3743 | Train Acc: 0.8861
 Site-Clipart                   (1) | Train Loss: 0.3725 | Train Acc: 0.9095
 Site-Real                      (3) | Train Loss: 0.3053 | Train Acc: 0.9206
 Site-Real                      (5) | Train Loss: 0.2277 | Train Acc: 0.9605
 Site-Real                      (5) | Train Loss: 0.2341 | Train Acc: 0.9556
 Site-Real                      (5) | Train Loss: 0.3095 | Train Acc: 0.9253
 Site-Painting                  (2) | Train Loss: 0.3809 | Train Acc: 0.9184
 Site-Painting                  (2) | Train Loss: 0.3275 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.3431 | Train Acc: 0.9066
 Site-Sketch                    (4) | Train Loss: 0.4382 | Train Acc: 0.8743
 Site-Sketch                    (4) | Train Loss: 0.5100 | Train Acc: 0.8577
 Site-QuickDraw                 (0) | Train Loss: 0.7870 | Train Acc: 0.7737
 Site-Infograph                 (2) | Train Loss: 1.0935 | Train Acc: 0.6368
Average Train Accuracy: 0.8807
 Site-Clipart                   (1) | Val  Loss: 0.2712 | Val  Acc: 0.9474
 Site-Clipart                   (1) | Val  Loss: 0.3562 | Val  Acc: 0.9159
 Site-Clipart                   (1) | Val  Loss: 0.3931 | Val  Acc: 0.8933
 Site-Clipart                   (1) | Val  Loss: 0.3770 | Val  Acc: 0.8905
 Site-Clipart                   (1) | Val  Loss: 0.4189 | Val  Acc: 0.8949
 Site-Real                      (3) | Val  Loss: 0.2245 | Val  Acc: 0.9405
 Site-Real                      (5) | Val  Loss: 0.2638 | Val  Acc: 0.9322
 Site-Real                      (5) | Val  Loss: 0.2730 | Val  Acc: 0.9394
 Site-Real                      (5) | Val  Loss: 0.2286 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.2615 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.3111 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.3270 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.4083 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.4824 | Val  Acc: 0.8146
 Site-QuickDraw                 (0) | Val  Loss: 0.8093 | Val  Acc: 0.7752
 Site-Infograph                 (2) | Val  Loss: 1.0195 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8883
 Best site-Clipart                  (1)  | Epoch:30 | Val Acc: 0.9474
 Best site-Clipart                  (1)  | Epoch:30 | Val Acc: 0.9159
 Best site-Clipart                  (1)  | Epoch:30 | Val Acc: 0.8933
 Best site-Clipart                  (1)  | Epoch:30 | Val Acc: 0.8905
 Best site-Clipart                  (1)  | Epoch:30 | Val Acc: 0.8949
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9405
 Best site-Real                     (5)  | Epoch:30 | Val Acc: 0.9322
 Best site-Real                     (5)  | Epoch:30 | Val Acc: 0.9394
 Best site-Real                     (5)  | Epoch:30 | Val Acc: 0.9610
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9184
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9270
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9062
 Best site-Sketch                   (4)  | Epoch:30 | Val Acc: 0.8583
 Best site-Sketch                   (4)  | Epoch:30 | Val Acc: 0.8146
 Best site-QuickDraw                (0)  | Epoch:30 | Val Acc: 0.7752
 Best site-Infograph                (2)  | Epoch:30 | Val Acc: 0.6987
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 31 ============
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (0) | Train Loss: 0.4045 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.3512 | Train Acc: 0.8944
 Site-Clipart                   (0) | Train Loss: 0.3760 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.3937 | Train Acc: 0.8892
 Site-Clipart                   (0) | Train Loss: 0.3903 | Train Acc: 0.9027
 Site-Real                      (2) | Train Loss: 0.3186 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.2287 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.2389 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2734 | Train Acc: 0.9282
 Site-Painting                  (3) | Train Loss: 0.3315 | Train Acc: 0.9116
 Site-Painting                  (3) | Train Loss: 0.4329 | Train Acc: 0.8932
 Site-Painting                  (3) | Train Loss: 0.3284 | Train Acc: 0.9031
 Site-Sketch                    (5) | Train Loss: 0.4401 | Train Acc: 0.8482
 Site-Sketch                    (5) | Train Loss: 0.4683 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.7251 | Train Acc: 0.8073
 Site-Infograph                 (4) | Train Loss: 1.0635 | Train Acc: 0.6282
Average Train Accuracy: 0.8772
 Site-Clipart                   (0) | Val  Loss: 0.2553 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.3358 | Val  Acc: 0.8879
 Site-Clipart                   (0) | Val  Loss: 0.3721 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.3561 | Val  Acc: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.4088 | Val  Acc: 0.8814
 Site-Real                      (2) | Val  Loss: 0.2255 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2485 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.2900 | Val  Acc: 0.9212
 Site-Real                      (2) | Val  Loss: 0.2410 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.2507 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.3324 | Val  Acc: 0.8978
 Site-Painting                  (3) | Val  Loss: 0.3100 | Val  Acc: 0.9323
 Site-Sketch                    (5) | Val  Loss: 0.3925 | Val  Acc: 0.9134
 Site-Sketch                    (5) | Val  Loss: 0.5292 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.8602 | Val  Acc: 0.7569
 Site-Infograph                 (4) | Val  Loss: 1.0162 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8874
============ Train epoch 32 ============
cnt=[3, 1, 5, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (2) | Train Loss: 0.4448 | Train Acc: 0.8348
 Site-Clipart                   (2) | Train Loss: 0.2991 | Train Acc: 0.9317
 Site-Clipart                   (2) | Train Loss: 0.3822 | Train Acc: 0.9156
 Site-Clipart                   (2) | Train Loss: 0.3638 | Train Acc: 0.8987
 Site-Clipart                   (2) | Train Loss: 0.3935 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.3435 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2339 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2245 | Train Acc: 0.9677
 Site-Real                      (3) | Train Loss: 0.2642 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.3396 | Train Acc: 0.9048
 Site-Painting                  (0) | Train Loss: 0.3899 | Train Acc: 0.8786
 Site-Painting                  (0) | Train Loss: 0.3201 | Train Acc: 0.9135
 Site-Sketch                    (5) | Train Loss: 0.4263 | Train Acc: 0.8639
 Site-Sketch                    (5) | Train Loss: 0.4156 | Train Acc: 0.8764
 Site-QuickDraw                 (1) | Train Loss: 0.7488 | Train Acc: 0.8135
 Site-Infograph                 (4) | Train Loss: 1.0579 | Train Acc: 0.6752
Average Train Accuracy: 0.8858
 Site-Clipart                   (2) | Val  Loss: 0.2628 | Val  Acc: 0.9605
 Site-Clipart                   (2) | Val  Loss: 0.3484 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.3941 | Val  Acc: 0.8600
 Site-Clipart                   (2) | Val  Loss: 0.3941 | Val  Acc: 0.8714
 Site-Clipart                   (2) | Val  Loss: 0.4275 | Val  Acc: 0.8780
 Site-Real                      (3) | Val  Loss: 0.2603 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.2911 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2653 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.2185 | Val  Acc: 0.9697
 Site-Painting                  (0) | Val  Loss: 0.2802 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.3276 | Val  Acc: 0.8905
 Site-Painting                  (0) | Val  Loss: 0.3188 | Val  Acc: 0.9271
 Site-Sketch                    (5) | Val  Loss: 0.4396 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.4547 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7816 | Val  Acc: 0.7890
 Site-Infograph                 (4) | Val  Loss: 1.0130 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8863
============ Train epoch 33 ============
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (2) | Train Loss: 0.3486 | Train Acc: 0.9304
 Site-Clipart                   (2) | Train Loss: 0.2717 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.4035 | Train Acc: 0.8800
 Site-Clipart                   (2) | Train Loss: 0.3849 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.3873 | Train Acc: 0.9095
 Site-Real                      (0) | Train Loss: 0.3147 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2234 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2400 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2647 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.3479 | Train Acc: 0.8980
 Site-Painting                  (3) | Train Loss: 0.2927 | Train Acc: 0.9126
 Site-Painting                  (3) | Train Loss: 0.3236 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4364 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.4051 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.7516 | Train Acc: 0.7920
 Site-Infograph                 (4) | Train Loss: 0.9463 | Train Acc: 0.6838
Average Train Accuracy: 0.8880
 Site-Clipart                   (2) | Val  Loss: 0.2766 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.3271 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.3746 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.3638 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.4388 | Val  Acc: 0.8780
 Site-Real                      (0) | Val  Loss: 0.2402 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2765 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2756 | Val  Acc: 0.9212
 Site-Real                      (0) | Val  Loss: 0.2251 | Val  Acc: 0.9697
 Site-Painting                  (3) | Val  Loss: 0.2134 | Val  Acc: 0.9592
 Site-Painting                  (3) | Val  Loss: 0.3472 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.3428 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.3919 | Val  Acc: 0.9055
 Site-Sketch                    (5) | Val  Loss: 0.4914 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7667 | Val  Acc: 0.7936
 Site-Infograph                 (4) | Val  Loss: 1.0364 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8898
 Best site-Clipart                  (2)  | Epoch:33 | Val Acc: 0.9211
 Best site-Clipart                  (2)  | Epoch:33 | Val Acc: 0.9159
 Best site-Clipart                  (2)  | Epoch:33 | Val Acc: 0.8867
 Best site-Clipart                  (2)  | Epoch:33 | Val Acc: 0.8762
 Best site-Clipart                  (2)  | Epoch:33 | Val Acc: 0.8780
 Best site-Real                     (0)  | Epoch:33 | Val Acc: 0.9286
 Best site-Real                     (0)  | Epoch:33 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:33 | Val Acc: 0.9212
 Best site-Real                     (0)  | Epoch:33 | Val Acc: 0.9697
 Best site-Painting                 (3)  | Epoch:33 | Val Acc: 0.9592
 Best site-Painting                 (3)  | Epoch:33 | Val Acc: 0.9051
 Best site-Painting                 (3)  | Epoch:33 | Val Acc: 0.9062
 Best site-Sketch                   (5)  | Epoch:33 | Val Acc: 0.9055
 Best site-Sketch                   (5)  | Epoch:33 | Val Acc: 0.8427
 Best site-QuickDraw                (1)  | Epoch:33 | Val Acc: 0.7936
 Best site-Infograph                (4)  | Epoch:33 | Val Acc: 0.6859
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 34 ============
cnt=[3, 1, 5, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (2) | Train Loss: 0.3738 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.3535 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.3931 | Train Acc: 0.8844
 Site-Clipart                   (2) | Train Loss: 0.3502 | Train Acc: 0.8797
 Site-Clipart                   (2) | Train Loss: 0.3744 | Train Acc: 0.8959
 Site-Real                      (3) | Train Loss: 0.3403 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2229 | Train Acc: 0.9718
 Site-Real                      (3) | Train Loss: 0.2076 | Train Acc: 0.9597
 Site-Real                      (3) | Train Loss: 0.2739 | Train Acc: 0.9454
 Site-Painting                  (0) | Train Loss: 0.3616 | Train Acc: 0.9048
 Site-Painting                  (0) | Train Loss: 0.3708 | Train Acc: 0.9175
 Site-Painting                  (0) | Train Loss: 0.3315 | Train Acc: 0.9066
 Site-Sketch                    (4) | Train Loss: 0.4051 | Train Acc: 0.8743
 Site-Sketch                    (4) | Train Loss: 0.4917 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.6450 | Train Acc: 0.7951
 Site-Infograph                 (5) | Train Loss: 1.0022 | Train Acc: 0.6709
Average Train Accuracy: 0.8865
 Site-Clipart                   (2) | Val  Loss: 0.2369 | Val  Acc: 0.9605
 Site-Clipart                   (2) | Val  Loss: 0.3261 | Val  Acc: 0.9065
 Site-Clipart                   (2) | Val  Loss: 0.3479 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.3211 | Val  Acc: 0.9095
 Site-Clipart                   (2) | Val  Loss: 0.3953 | Val  Acc: 0.9220
 Site-Real                      (3) | Val  Loss: 0.2303 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2230 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.2202 | Val  Acc: 0.9515
 Site-Real                      (3) | Val  Loss: 0.2293 | Val  Acc: 0.9610
 Site-Painting                  (0) | Val  Loss: 0.2633 | Val  Acc: 0.8878
 Site-Painting                  (0) | Val  Loss: 0.3979 | Val  Acc: 0.8759
 Site-Painting                  (0) | Val  Loss: 0.2957 | Val  Acc: 0.9323
 Site-Sketch                    (4) | Val  Loss: 0.3715 | Val  Acc: 0.8898
 Site-Sketch                    (4) | Val  Loss: 0.4879 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.7734 | Val  Acc: 0.7523
 Site-Infograph                 (5) | Val  Loss: 1.0303 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8885
============ Train epoch 35 ============
cnt=[5, 1, 3, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (0) | Train Loss: 0.4446 | Train Acc: 0.8348
 Site-Clipart                   (0) | Train Loss: 0.2976 | Train Acc: 0.9317
 Site-Clipart                   (0) | Train Loss: 0.3765 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.3756 | Train Acc: 0.8892
 Site-Clipart                   (0) | Train Loss: 0.3631 | Train Acc: 0.8959
 Site-Real                      (3) | Train Loss: 0.3377 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2459 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2273 | Train Acc: 0.9556
 Site-Real                      (3) | Train Loss: 0.2801 | Train Acc: 0.9282
 Site-Painting                  (2) | Train Loss: 0.4011 | Train Acc: 0.8776
 Site-Painting                  (2) | Train Loss: 0.2829 | Train Acc: 0.9126
 Site-Painting                  (2) | Train Loss: 0.3157 | Train Acc: 0.9377
 Site-Sketch                    (4) | Train Loss: 0.4367 | Train Acc: 0.8691
 Site-Sketch                    (4) | Train Loss: 0.4850 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.6503 | Train Acc: 0.8165
 Site-Infograph                 (5) | Train Loss: 0.9609 | Train Acc: 0.6923
Average Train Accuracy: 0.8848
 Site-Clipart                   (0) | Val  Loss: 0.2602 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.3545 | Val  Acc: 0.8879
 Site-Clipart                   (0) | Val  Loss: 0.3491 | Val  Acc: 0.9067
 Site-Clipart                   (0) | Val  Loss: 0.3462 | Val  Acc: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.4311 | Val  Acc: 0.8780
 Site-Real                      (3) | Val  Loss: 0.2446 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2370 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2626 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2348 | Val  Acc: 0.9654
 Site-Painting                  (2) | Val  Loss: 0.2247 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.2956 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.3578 | Val  Acc: 0.9010
 Site-Sketch                    (4) | Val  Loss: 0.3740 | Val  Acc: 0.8898
 Site-Sketch                    (4) | Val  Loss: 0.4989 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8148 | Val  Acc: 0.7385
 Site-Infograph                 (5) | Val  Loss: 0.9864 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8836
============ Train epoch 36 ============
cnt=[3, 1, 5, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (2) | Train Loss: 0.4064 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.3008 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.3845 | Train Acc: 0.8933
 Site-Clipart                   (2) | Train Loss: 0.3669 | Train Acc: 0.8861
 Site-Clipart                   (2) | Train Loss: 0.3468 | Train Acc: 0.9118
 Site-Real                      (5) | Train Loss: 0.3062 | Train Acc: 0.9206
 Site-Real                      (5) | Train Loss: 0.2186 | Train Acc: 0.9605
 Site-Real                      (5) | Train Loss: 0.2180 | Train Acc: 0.9597
 Site-Real                      (5) | Train Loss: 0.2907 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.3812 | Train Acc: 0.8844
 Site-Painting                  (0) | Train Loss: 0.3406 | Train Acc: 0.9029
 Site-Painting                  (0) | Train Loss: 0.3228 | Train Acc: 0.9170
 Site-Sketch                    (4) | Train Loss: 0.3951 | Train Acc: 0.8691
 Site-Sketch                    (4) | Train Loss: 0.4585 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.6960 | Train Acc: 0.7706
 Site-Infograph                 (3) | Train Loss: 0.9499 | Train Acc: 0.6624
Average Train Accuracy: 0.8823
 Site-Clipart                   (2) | Val  Loss: 0.2578 | Val  Acc: 0.9474
 Site-Clipart                   (2) | Val  Loss: 0.3050 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.3386 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.3486 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.4061 | Val  Acc: 0.8915
 Site-Real                      (5) | Val  Loss: 0.2293 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.2534 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.2386 | Val  Acc: 0.9394
 Site-Real                      (5) | Val  Loss: 0.2351 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.2209 | Val  Acc: 0.9796
 Site-Painting                  (0) | Val  Loss: 0.3035 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3242 | Val  Acc: 0.9167
 Site-Sketch                    (4) | Val  Loss: 0.3978 | Val  Acc: 0.8898
 Site-Sketch                    (4) | Val  Loss: 0.4830 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.7585 | Val  Acc: 0.7844
 Site-Infograph                 (3) | Val  Loss: 1.0357 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8922
 Best site-Clipart                  (2)  | Epoch:36 | Val Acc: 0.9474
 Best site-Clipart                  (2)  | Epoch:36 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:36 | Val Acc: 0.8800
 Best site-Clipart                  (2)  | Epoch:36 | Val Acc: 0.8905
 Best site-Clipart                  (2)  | Epoch:36 | Val Acc: 0.8915
 Best site-Real                     (5)  | Epoch:36 | Val Acc: 0.9286
 Best site-Real                     (5)  | Epoch:36 | Val Acc: 0.9407
 Best site-Real                     (5)  | Epoch:36 | Val Acc: 0.9394
 Best site-Real                     (5)  | Epoch:36 | Val Acc: 0.9567
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9796
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9124
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9167
 Best site-Sketch                   (4)  | Epoch:36 | Val Acc: 0.8898
 Best site-Sketch                   (4)  | Epoch:36 | Val Acc: 0.8539
 Best site-QuickDraw                (1)  | Epoch:36 | Val Acc: 0.7844
 Best site-Infograph                (3)  | Epoch:36 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 37 ============
cnt=[1, 5, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (1) | Train Loss: 0.4065 | Train Acc: 0.8522
 Site-Clipart                   (1) | Train Loss: 0.2823 | Train Acc: 0.9255
 Site-Clipart                   (1) | Train Loss: 0.3925 | Train Acc: 0.8844
 Site-Clipart                   (1) | Train Loss: 0.3541 | Train Acc: 0.8956
 Site-Clipart                   (1) | Train Loss: 0.3691 | Train Acc: 0.9050
 Site-Real                      (2) | Train Loss: 0.2771 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.2300 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2198 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2790 | Train Acc: 0.9483
 Site-Painting                  (5) | Train Loss: 0.3313 | Train Acc: 0.8776
 Site-Painting                  (5) | Train Loss: 0.3046 | Train Acc: 0.9029
 Site-Painting                  (5) | Train Loss: 0.3406 | Train Acc: 0.9100
 Site-Sketch                    (4) | Train Loss: 0.4082 | Train Acc: 0.8743
 Site-Sketch                    (4) | Train Loss: 0.4245 | Train Acc: 0.8427
 Site-QuickDraw                 (0) | Train Loss: 0.6298 | Train Acc: 0.8012
 Site-Infograph                 (3) | Train Loss: 0.8976 | Train Acc: 0.6966
Average Train Accuracy: 0.8835
 Site-Clipart                   (1) | Val  Loss: 0.2677 | Val  Acc: 0.9079
 Site-Clipart                   (1) | Val  Loss: 0.3255 | Val  Acc: 0.8972
 Site-Clipart                   (1) | Val  Loss: 0.3659 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.3387 | Val  Acc: 0.8905
 Site-Clipart                   (1) | Val  Loss: 0.4237 | Val  Acc: 0.8847
 Site-Real                      (2) | Val  Loss: 0.2379 | Val  Acc: 0.9167
 Site-Real                      (2) | Val  Loss: 0.2725 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.1924 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.2369 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2159 | Val  Acc: 0.9694
 Site-Painting                  (5) | Val  Loss: 0.2987 | Val  Acc: 0.9197
 Site-Painting                  (5) | Val  Loss: 0.3398 | Val  Acc: 0.9010
 Site-Sketch                    (4) | Val  Loss: 0.3825 | Val  Acc: 0.8976
 Site-Sketch                    (4) | Val  Loss: 0.4652 | Val  Acc: 0.8427
 Site-QuickDraw                 (0) | Val  Loss: 0.7504 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 1.0172 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8861
============ Train epoch 38 ============
cnt=[1, 1, 5, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (2) | Train Loss: 0.3901 | Train Acc: 0.8957
 Site-Clipart                   (2) | Train Loss: 0.3174 | Train Acc: 0.9317
 Site-Clipart                   (2) | Train Loss: 0.4029 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.3646 | Train Acc: 0.9019
 Site-Clipart                   (2) | Train Loss: 0.3268 | Train Acc: 0.9231
 Site-Real                      (3) | Train Loss: 0.3253 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2260 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2304 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2959 | Train Acc: 0.9397
 Site-Painting                  (5) | Train Loss: 0.3758 | Train Acc: 0.8844
 Site-Painting                  (5) | Train Loss: 0.3894 | Train Acc: 0.8786
 Site-Painting                  (5) | Train Loss: 0.3075 | Train Acc: 0.9273
 Site-Sketch                    (4) | Train Loss: 0.4109 | Train Acc: 0.8691
 Site-Sketch                    (4) | Train Loss: 0.4385 | Train Acc: 0.8727
 Site-QuickDraw                 (1) | Train Loss: 0.7385 | Train Acc: 0.8073
 Site-Infograph                 (0) | Train Loss: 0.9118 | Train Acc: 0.7350
Average Train Accuracy: 0.8919
 Site-Clipart                   (2) | Val  Loss: 0.2007 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.3275 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.3570 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.3385 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.3728 | Val  Acc: 0.9119
 Site-Real                      (3) | Val  Loss: 0.2222 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2342 | Val  Acc: 0.9746
 Site-Real                      (3) | Val  Loss: 0.2449 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2431 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2376 | Val  Acc: 0.9592
 Site-Painting                  (5) | Val  Loss: 0.2926 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.2990 | Val  Acc: 0.9479
 Site-Sketch                    (4) | Val  Loss: 0.3759 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.4425 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.7263 | Val  Acc: 0.8165
 Site-Infograph                 (0) | Val  Loss: 0.9481 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8971
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.9211
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.9000
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.8905
 Best site-Clipart                  (2)  | Epoch:38 | Val Acc: 0.9119
 Best site-Real                     (3)  | Epoch:38 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:38 | Val Acc: 0.9746
 Best site-Real                     (3)  | Epoch:38 | Val Acc: 0.9333
 Best site-Real                     (3)  | Epoch:38 | Val Acc: 0.9567
 Best site-Painting                 (5)  | Epoch:38 | Val Acc: 0.9592
 Best site-Painting                 (5)  | Epoch:38 | Val Acc: 0.9051
 Best site-Painting                 (5)  | Epoch:38 | Val Acc: 0.9479
 Best site-Sketch                   (4)  | Epoch:38 | Val Acc: 0.8819
 Best site-Sketch                   (4)  | Epoch:38 | Val Acc: 0.8371
 Best site-QuickDraw                (1)  | Epoch:38 | Val Acc: 0.8165
 Best site-Infograph                (0)  | Epoch:38 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 1, 4, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (3) | Train Loss: 0.4332 | Train Acc: 0.8348
 Site-Clipart                   (3) | Train Loss: 0.2648 | Train Acc: 0.9503
 Site-Clipart                   (3) | Train Loss: 0.3821 | Train Acc: 0.8978
 Site-Clipart                   (3) | Train Loss: 0.3344 | Train Acc: 0.8956
 Site-Clipart                   (3) | Train Loss: 0.3386 | Train Acc: 0.9186
 Site-Real                      (2) | Train Loss: 0.3003 | Train Acc: 0.9365
 Site-Real                      (2) | Train Loss: 0.1954 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.2587 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.2894 | Train Acc: 0.9368
 Site-Painting                  (5) | Train Loss: 0.2968 | Train Acc: 0.9048
 Site-Painting                  (5) | Train Loss: 0.3512 | Train Acc: 0.9175
 Site-Painting                  (5) | Train Loss: 0.3493 | Train Acc: 0.9204
 Site-Sketch                    (0) | Train Loss: 0.4427 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.4370 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.7000 | Train Acc: 0.8226
 Site-Infograph                 (4) | Train Loss: 0.9272 | Train Acc: 0.7051
Average Train Accuracy: 0.8900
 Site-Clipart                   (3) | Val  Loss: 0.2201 | Val  Acc: 0.9474
 Site-Clipart                   (3) | Val  Loss: 0.3489 | Val  Acc: 0.9065
 Site-Clipart                   (3) | Val  Loss: 0.2999 | Val  Acc: 0.9000
 Site-Clipart                   (3) | Val  Loss: 0.3455 | Val  Acc: 0.9000
 Site-Clipart                   (3) | Val  Loss: 0.3822 | Val  Acc: 0.8949
 Site-Real                      (2) | Val  Loss: 0.2079 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2213 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.2412 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.2196 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2129 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2569 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.3248 | Val  Acc: 0.9271
 Site-Sketch                    (0) | Val  Loss: 0.3473 | Val  Acc: 0.9213
 Site-Sketch                    (0) | Val  Loss: 0.4605 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7425 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 0.9781 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8970
 Test site-Clipart                   (3)| Epoch:38 | Test Acc: 0.8992
 Test site-Real                      (2)| Epoch:38 | Test Acc: 0.9384
 Test site-Painting                  (5)| Epoch:38 | Test Acc: 0.9305
 Test site-Sketch                    (0)| Epoch:38 | Test Acc: 0.8773
 Test site-QuickDraw                 (1)| Epoch:38 | Test Acc: 0.7440
 Test site-Infograph                 (4)| Epoch:38 | Test Acc: 0.5677
Clipart: 0.8992, Real: 0.9384, Painting: 0.9305, Sketch: 0.8773, QuickDraw: 0.7440, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8262, Average Test Accuracy(individual): 0.8817,
domain std=0.1323, cluster std=0.1323, individual std=0.0932, 
============ Train epoch 40 ============
cnt=[4, 1, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (2) | Train Loss: 0.3942 | Train Acc: 0.8957
 Site-Clipart                   (2) | Train Loss: 0.2864 | Train Acc: 0.9503
 Site-Clipart                   (2) | Train Loss: 0.3844 | Train Acc: 0.8844
 Site-Clipart                   (2) | Train Loss: 0.3650 | Train Acc: 0.8924
 Site-Clipart                   (2) | Train Loss: 0.3377 | Train Acc: 0.9072
 Site-Real                      (0) | Train Loss: 0.2753 | Train Acc: 0.9365
 Site-Real                      (0) | Train Loss: 0.1957 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2036 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2606 | Train Acc: 0.9368
 Site-Painting                  (5) | Train Loss: 0.2854 | Train Acc: 0.8980
 Site-Painting                  (5) | Train Loss: 0.3431 | Train Acc: 0.9175
 Site-Painting                  (5) | Train Loss: 0.3105 | Train Acc: 0.9239
 Site-Sketch                    (4) | Train Loss: 0.4194 | Train Acc: 0.8901
 Site-Sketch                    (4) | Train Loss: 0.4557 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.7205 | Train Acc: 0.7982
 Site-Infograph                 (3) | Train Loss: 0.9099 | Train Acc: 0.7094
Average Train Accuracy: 0.8943
 Site-Clipart                   (2) | Val  Loss: 0.2284 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3075 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.3306 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.3491 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.3931 | Val  Acc: 0.8847
 Site-Real                      (0) | Val  Loss: 0.2291 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2612 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2004 | Val  Acc: 0.9515
 Site-Real                      (0) | Val  Loss: 0.2068 | Val  Acc: 0.9610
 Site-Painting                  (5) | Val  Loss: 0.1906 | Val  Acc: 0.9592
 Site-Painting                  (5) | Val  Loss: 0.2971 | Val  Acc: 0.8978
 Site-Painting                  (5) | Val  Loss: 0.3469 | Val  Acc: 0.9219
 Site-Sketch                    (4) | Val  Loss: 0.3715 | Val  Acc: 0.8898
 Site-Sketch                    (4) | Val  Loss: 0.5065 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7336 | Val  Acc: 0.8073
 Site-Infograph                 (3) | Val  Loss: 0.9367 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8943
 Test site-Clipart                   (2)| Epoch:38 | Test Acc: 0.8973
 Test site-Real                      (0)| Epoch:38 | Test Acc: 0.9376
 Test site-Painting                  (5)| Epoch:38 | Test Acc: 0.9338
 Test site-Sketch                    (4)| Epoch:38 | Test Acc: 0.8755
 Test site-QuickDraw                 (1)| Epoch:38 | Test Acc: 0.7440
 Test site-Infograph                 (3)| Epoch:38 | Test Acc: 0.5753
Clipart: 0.8973, Real: 0.9376, Painting: 0.9338, Sketch: 0.8755, QuickDraw: 0.7440, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8272, Average Test Accuracy(individual): 0.8818,
domain std=0.1298, cluster std=0.1298, individual std=0.0918, 
Average Test Accuracy: 0.8272
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 41 ============
cnt=[4, 1, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (2) | Train Loss: 0.4163 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.2632 | Train Acc: 0.9379
 Site-Clipart                   (2) | Train Loss: 0.4463 | Train Acc: 0.8800
 Site-Clipart                   (2) | Train Loss: 0.3304 | Train Acc: 0.9051
 Site-Clipart                   (2) | Train Loss: 0.3334 | Train Acc: 0.9140
 Site-Real                      (0) | Train Loss: 0.2948 | Train Acc: 0.9286
 Site-Real                      (0) | Train Loss: 0.2126 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2249 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2778 | Train Acc: 0.9224
 Site-Painting                  (3) | Train Loss: 0.3628 | Train Acc: 0.9048
 Site-Painting                  (3) | Train Loss: 0.2890 | Train Acc: 0.9466
 Site-Painting                  (3) | Train Loss: 0.3164 | Train Acc: 0.9273
 Site-Sketch                    (4) | Train Loss: 0.3785 | Train Acc: 0.8953
 Site-Sketch                    (4) | Train Loss: 0.4566 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.6653 | Train Acc: 0.8104
 Site-Infograph                 (5) | Train Loss: 0.8828 | Train Acc: 0.7265
Average Train Accuracy: 0.8953
 Site-Clipart                   (2) | Val  Loss: 0.2328 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.3293 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.3280 | Val  Acc: 0.9067
 Site-Clipart                   (2) | Val  Loss: 0.3518 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.4007 | Val  Acc: 0.8746
 Site-Real                      (0) | Val  Loss: 0.2129 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2789 | Val  Acc: 0.9068
 Site-Real                      (0) | Val  Loss: 0.2003 | Val  Acc: 0.9636
 Site-Real                      (0) | Val  Loss: 0.2102 | Val  Acc: 0.9610
 Site-Painting                  (3) | Val  Loss: 0.1933 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.2558 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.2915 | Val  Acc: 0.9271
 Site-Sketch                    (4) | Val  Loss: 0.3503 | Val  Acc: 0.8740
 Site-Sketch                    (4) | Val  Loss: 0.4527 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7305 | Val  Acc: 0.7798
 Site-Infograph                 (5) | Val  Loss: 1.0091 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8885
 Test site-Clipart                   (2)| Epoch:40 | Test Acc: 0.8973
 Test site-Real                      (0)| Epoch:40 | Test Acc: 0.9400
 Test site-Painting                  (3)| Epoch:40 | Test Acc: 0.9354
 Test site-Sketch                    (4)| Epoch:40 | Test Acc: 0.8773
 Test site-QuickDraw                 (1)| Epoch:40 | Test Acc: 0.7460
 Test site-Infograph                 (5)| Epoch:40 | Test Acc: 0.5784
Clipart: 0.8973, Real: 0.9400, Painting: 0.9354, Sketch: 0.8773, QuickDraw: 0.7460, Infograph: 0.5784, 
Average Test Accuracy(group): 0.8291, Average Test Accuracy(individual): 0.8832,
domain std=0.1293, cluster std=0.1293, individual std=0.0915, 
Average Test Accuracy: 0.8291
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 42 ============
cnt=[5, 1, 3, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (0) | Train Loss: 0.3862 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.2871 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.3376 | Train Acc: 0.9244
 Site-Clipart                   (0) | Train Loss: 0.3412 | Train Acc: 0.9051
 Site-Clipart                   (0) | Train Loss: 0.3523 | Train Acc: 0.9095
 Site-Real                      (4) | Train Loss: 0.2867 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.1975 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2120 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2546 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.3948 | Train Acc: 0.8912
 Site-Painting                  (2) | Train Loss: 0.3061 | Train Acc: 0.9369
 Site-Painting                  (2) | Train Loss: 0.2913 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.4160 | Train Acc: 0.8639
 Site-Sketch                    (5) | Train Loss: 0.4137 | Train Acc: 0.8876
 Site-QuickDraw                 (1) | Train Loss: 0.6703 | Train Acc: 0.8226
 Site-Infograph                 (3) | Train Loss: 0.8385 | Train Acc: 0.7009
Average Train Accuracy: 0.8944
 Site-Clipart                   (0) | Val  Loss: 0.2196 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3122 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.3269 | Val  Acc: 0.9133
 Site-Clipart                   (0) | Val  Loss: 0.3444 | Val  Acc: 0.8810
 Site-Clipart                   (0) | Val  Loss: 0.3970 | Val  Acc: 0.8881
 Site-Real                      (4) | Val  Loss: 0.2331 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2510 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.1894 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2227 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.1945 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.2717 | Val  Acc: 0.9343
 Site-Painting                  (2) | Val  Loss: 0.2712 | Val  Acc: 0.9323
 Site-Sketch                    (5) | Val  Loss: 0.3440 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.4394 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.7176 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 0.9527 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8966
 Test site-Clipart                   (0)| Epoch:41 | Test Acc: 0.8973
 Test site-Real                      (4)| Epoch:41 | Test Acc: 0.9367
 Test site-Painting                  (2)| Epoch:41 | Test Acc: 0.9370
 Test site-Sketch                    (5)| Epoch:41 | Test Acc: 0.8755
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7540
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5708
Clipart: 0.8973, Real: 0.9367, Painting: 0.9370, Sketch: 0.8755, QuickDraw: 0.7540, Infograph: 0.5708, 
Average Test Accuracy(group): 0.8285, Average Test Accuracy(individual): 0.8825,
domain std=0.1306, cluster std=0.1306, individual std=0.0920, 
Average Test Accuracy: 0.8285
============ Train epoch 43 ============
cnt=[2, 1, 4, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (4) | Train Loss: 0.3704 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.2757 | Train Acc: 0.9317
 Site-Clipart                   (4) | Train Loss: 0.3576 | Train Acc: 0.9022
 Site-Clipart                   (4) | Train Loss: 0.3177 | Train Acc: 0.9114
 Site-Clipart                   (4) | Train Loss: 0.3367 | Train Acc: 0.9163
 Site-Real                      (2) | Train Loss: 0.2724 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.2091 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.2273 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2799 | Train Acc: 0.9310
 Site-Painting                  (5) | Train Loss: 0.4092 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.2840 | Train Acc: 0.9320
 Site-Painting                  (5) | Train Loss: 0.2837 | Train Acc: 0.9308
 Site-Sketch                    (0) | Train Loss: 0.3709 | Train Acc: 0.9215
 Site-Sketch                    (0) | Train Loss: 0.4170 | Train Acc: 0.8951
 Site-QuickDraw                 (1) | Train Loss: 0.6535 | Train Acc: 0.8073
 Site-Infograph                 (3) | Train Loss: 0.8697 | Train Acc: 0.7179
Average Train Accuracy: 0.8977
 Site-Clipart                   (4) | Val  Loss: 0.2338 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.2822 | Val  Acc: 0.9252
 Site-Clipart                   (4) | Val  Loss: 0.3605 | Val  Acc: 0.8800
 Site-Clipart                   (4) | Val  Loss: 0.3099 | Val  Acc: 0.9190
 Site-Clipart                   (4) | Val  Loss: 0.3835 | Val  Acc: 0.9017
 Site-Real                      (2) | Val  Loss: 0.1994 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2294 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2189 | Val  Acc: 0.9515
 Site-Real                      (2) | Val  Loss: 0.2081 | Val  Acc: 0.9654
 Site-Painting                  (5) | Val  Loss: 0.2055 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.2491 | Val  Acc: 0.9343
 Site-Painting                  (5) | Val  Loss: 0.2952 | Val  Acc: 0.9271
 Site-Sketch                    (0) | Val  Loss: 0.3253 | Val  Acc: 0.9055
 Site-Sketch                    (0) | Val  Loss: 0.4749 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.7067 | Val  Acc: 0.8028
 Site-Infograph                 (3) | Val  Loss: 0.9052 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8971
 Best site-Clipart                  (4)  | Epoch:43 | Val Acc: 0.9079
 Best site-Clipart                  (4)  | Epoch:43 | Val Acc: 0.9252
 Best site-Clipart                  (4)  | Epoch:43 | Val Acc: 0.8800
 Best site-Clipart                  (4)  | Epoch:43 | Val Acc: 0.9190
 Best site-Clipart                  (4)  | Epoch:43 | Val Acc: 0.9017
 Best site-Real                     (2)  | Epoch:43 | Val Acc: 0.9405
 Best site-Real                     (2)  | Epoch:43 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:43 | Val Acc: 0.9515
 Best site-Real                     (2)  | Epoch:43 | Val Acc: 0.9654
 Best site-Painting                 (5)  | Epoch:43 | Val Acc: 0.9388
 Best site-Painting                 (5)  | Epoch:43 | Val Acc: 0.9343
 Best site-Painting                 (5)  | Epoch:43 | Val Acc: 0.9271
 Best site-Sketch                   (0)  | Epoch:43 | Val Acc: 0.9055
 Best site-Sketch                   (0)  | Epoch:43 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:43 | Val Acc: 0.8028
 Best site-Infograph                (3)  | Epoch:43 | Val Acc: 0.6923
 Test site-Clipart                   (4)| Epoch:43 | Test Acc: 0.9030
 Test site-Real                      (2)| Epoch:43 | Test Acc: 0.9351
 Test site-Painting                  (5)| Epoch:43 | Test Acc: 0.9402
 Test site-Sketch                    (0)| Epoch:43 | Test Acc: 0.8809
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7510
 Test site-Infograph                 (3)| Epoch:43 | Test Acc: 0.5723
Clipart: 0.9030, Real: 0.9351, Painting: 0.9402, Sketch: 0.8809, QuickDraw: 0.7510, Infograph: 0.5723, 
Average Test Accuracy(group): 0.8304, Average Test Accuracy(individual): 0.8851,
domain std=0.1315, cluster std=0.1315, individual std=0.0924, 
Average Test Accuracy: 0.8304
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 1, 7, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (0) | Train Loss: 0.3953 | Train Acc: 0.8783
 Site-Clipart                   (5) | Train Loss: 0.2773 | Train Acc: 0.9130
 Site-Clipart                   (5) | Train Loss: 0.3537 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.3178 | Train Acc: 0.9019
 Site-Clipart                   (5) | Train Loss: 0.3320 | Train Acc: 0.9118
 Site-Real                      (2) | Train Loss: 0.2804 | Train Acc: 0.9365
 Site-Real                      (2) | Train Loss: 0.2021 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2088 | Train Acc: 0.9677
 Site-Real                      (2) | Train Loss: 0.2417 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.3609 | Train Acc: 0.8912
 Site-Painting                  (2) | Train Loss: 0.3277 | Train Acc: 0.9320
 Site-Painting                  (2) | Train Loss: 0.2776 | Train Acc: 0.9273
 Site-Sketch                    (4) | Train Loss: 0.3638 | Train Acc: 0.8953
 Site-Sketch                    (4) | Train Loss: 0.3985 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.6919 | Train Acc: 0.7890
 Site-Infograph                 (3) | Train Loss: 0.8539 | Train Acc: 0.7222
Average Train Accuracy: 0.8948
 Site-Clipart                   (0) | Val  Loss: 0.1849 | Val  Acc: 0.9605
 Site-Clipart                   (5) | Val  Loss: 0.2861 | Val  Acc: 0.9346
 Site-Clipart                   (5) | Val  Loss: 0.3265 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.3517 | Val  Acc: 0.8810
 Site-Clipart                   (5) | Val  Loss: 0.3872 | Val  Acc: 0.8983
 Site-Real                      (2) | Val  Loss: 0.2211 | Val  Acc: 0.9167
 Site-Real                      (2) | Val  Loss: 0.2232 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.2110 | Val  Acc: 0.9636
 Site-Real                      (2) | Val  Loss: 0.2103 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.2335 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.2850 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.2910 | Val  Acc: 0.9271
 Site-Sketch                    (4) | Val  Loss: 0.3652 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.4371 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.7191 | Val  Acc: 0.7661
 Site-Infograph                 (3) | Val  Loss: 0.9852 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8966
 Test site-Clipart                   (0)| Epoch:43 | Test Acc: 0.9030
 Test site-Real                      (2)| Epoch:43 | Test Acc: 0.9359
 Test site-Painting                  (2)| Epoch:43 | Test Acc: 0.9354
 Test site-Sketch                    (4)| Epoch:43 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7460
 Test site-Infograph                 (3)| Epoch:43 | Test Acc: 0.5723
Clipart: 0.9030, Real: 0.9359, Painting: 0.9354, Sketch: 0.8791, QuickDraw: 0.7460, Infograph: 0.5723, 
Average Test Accuracy(group): 0.8286, Average Test Accuracy(individual): 0.8838,
domain std=0.1314, cluster std=0.1274, individual std=0.0925, 
Average Test Accuracy: 0.8286
============ Train epoch 45 ============
cnt=[4, 1, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (2) | Train Loss: 0.3291 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.2636 | Train Acc: 0.9317
 Site-Clipart                   (2) | Train Loss: 0.4050 | Train Acc: 0.8800
 Site-Clipart                   (2) | Train Loss: 0.3240 | Train Acc: 0.9019
 Site-Clipart                   (2) | Train Loss: 0.3135 | Train Acc: 0.9276
 Site-Real                      (0) | Train Loss: 0.2818 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2196 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.1975 | Train Acc: 0.9556
 Site-Real                      (0) | Train Loss: 0.2342 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.2844 | Train Acc: 0.9116
 Site-Painting                  (5) | Train Loss: 0.3512 | Train Acc: 0.9126
 Site-Painting                  (5) | Train Loss: 0.3015 | Train Acc: 0.9377
 Site-Sketch                    (4) | Train Loss: 0.3315 | Train Acc: 0.9162
 Site-Sketch                    (4) | Train Loss: 0.3794 | Train Acc: 0.8727
 Site-QuickDraw                 (1) | Train Loss: 0.6128 | Train Acc: 0.7890
 Site-Infograph                 (3) | Train Loss: 0.8739 | Train Acc: 0.7051
Average Train Accuracy: 0.8992
 Site-Clipart                   (2) | Val  Loss: 0.2027 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.2823 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.3791 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.3577 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.3864 | Val  Acc: 0.8847
 Site-Real                      (0) | Val  Loss: 0.1854 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2194 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2094 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2139 | Val  Acc: 0.9610
 Site-Painting                  (5) | Val  Loss: 0.2210 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.2662 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.2836 | Val  Acc: 0.9271
 Site-Sketch                    (4) | Val  Loss: 0.3312 | Val  Acc: 0.9291
 Site-Sketch                    (4) | Val  Loss: 0.4576 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.7327 | Val  Acc: 0.7844
 Site-Infograph                 (3) | Val  Loss: 0.9143 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8983
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.9211
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.9159
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.8867
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.8905
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.8847
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9455
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9610
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9388
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9270
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9271
 Best site-Sketch                   (4)  | Epoch:45 | Val Acc: 0.9291
 Best site-Sketch                   (4)  | Epoch:45 | Val Acc: 0.8371
 Best site-QuickDraw                (1)  | Epoch:45 | Val Acc: 0.7844
 Best site-Infograph                (3)  | Epoch:45 | Val Acc: 0.7308
 Test site-Clipart                   (2)| Epoch:45 | Test Acc: 0.9087
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9376
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9354
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8773
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7550
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5769
Clipart: 0.9087, Real: 0.9376, Painting: 0.9354, Sketch: 0.8773, QuickDraw: 0.7550, Infograph: 0.5769, 
Average Test Accuracy(group): 0.8318, Average Test Accuracy(individual): 0.8867,
domain std=0.1296, cluster std=0.1296, individual std=0.0913, 
Average Test Accuracy: 0.8318
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 46 ============
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (2) | Train Loss: 0.3548 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.2526 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.3436 | Train Acc: 0.9022
 Site-Clipart                   (2) | Train Loss: 0.3240 | Train Acc: 0.8956
 Site-Clipart                   (2) | Train Loss: 0.3436 | Train Acc: 0.9118
 Site-Real                      (0) | Train Loss: 0.2918 | Train Acc: 0.9286
 Site-Real                      (0) | Train Loss: 0.1835 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.1958 | Train Acc: 0.9556
 Site-Real                      (0) | Train Loss: 0.2363 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.3515 | Train Acc: 0.8980
 Site-Painting                  (3) | Train Loss: 0.2664 | Train Acc: 0.9466
 Site-Painting                  (3) | Train Loss: 0.2960 | Train Acc: 0.9308
 Site-Sketch                    (5) | Train Loss: 0.3808 | Train Acc: 0.9005
 Site-Sketch                    (5) | Train Loss: 0.3814 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.5946 | Train Acc: 0.8471
 Site-Infograph                 (4) | Train Loss: 0.8467 | Train Acc: 0.7479
Average Train Accuracy: 0.9008
 Site-Clipart                   (2) | Val  Loss: 0.1854 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.2932 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.3484 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.3038 | Val  Acc: 0.9048
 Site-Clipart                   (2) | Val  Loss: 0.3906 | Val  Acc: 0.8949
 Site-Real                      (0) | Val  Loss: 0.2203 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2340 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2108 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2146 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.1890 | Val  Acc: 0.9592
 Site-Painting                  (3) | Val  Loss: 0.2458 | Val  Acc: 0.9197
 Site-Painting                  (3) | Val  Loss: 0.2885 | Val  Acc: 0.9323
 Site-Sketch                    (5) | Val  Loss: 0.3560 | Val  Acc: 0.9213
 Site-Sketch                    (5) | Val  Loss: 0.4230 | Val  Acc: 0.8764
 Site-QuickDraw                 (1) | Val  Loss: 0.6782 | Val  Acc: 0.7982
 Site-Infograph                 (4) | Val  Loss: 0.8962 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9015
 Best site-Clipart                  (2)  | Epoch:46 | Val Acc: 0.9342
 Best site-Clipart                  (2)  | Epoch:46 | Val Acc: 0.8879
 Best site-Clipart                  (2)  | Epoch:46 | Val Acc: 0.8667
 Best site-Clipart                  (2)  | Epoch:46 | Val Acc: 0.9048
 Best site-Clipart                  (2)  | Epoch:46 | Val Acc: 0.8949
 Best site-Real                     (0)  | Epoch:46 | Val Acc: 0.9286
 Best site-Real                     (0)  | Epoch:46 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:46 | Val Acc: 0.9576
 Best site-Real                     (0)  | Epoch:46 | Val Acc: 0.9524
 Best site-Painting                 (3)  | Epoch:46 | Val Acc: 0.9592
 Best site-Painting                 (3)  | Epoch:46 | Val Acc: 0.9197
 Best site-Painting                 (3)  | Epoch:46 | Val Acc: 0.9323
 Best site-Sketch                   (5)  | Epoch:46 | Val Acc: 0.9213
 Best site-Sketch                   (5)  | Epoch:46 | Val Acc: 0.8764
 Best site-QuickDraw                (1)  | Epoch:46 | Val Acc: 0.7982
 Best site-Infograph                (4)  | Epoch:46 | Val Acc: 0.7500
 Test site-Clipart                   (2)| Epoch:46 | Test Acc: 0.9011
 Test site-Real                      (0)| Epoch:46 | Test Acc: 0.9400
 Test site-Painting                  (3)| Epoch:46 | Test Acc: 0.9354
 Test site-Sketch                    (5)| Epoch:46 | Test Acc: 0.8773
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7570
 Test site-Infograph                 (4)| Epoch:46 | Test Acc: 0.5769
Clipart: 0.9011, Real: 0.9400, Painting: 0.9354, Sketch: 0.8773, QuickDraw: 0.7570, Infograph: 0.5769, 
Average Test Accuracy(group): 0.8313, Average Test Accuracy(individual): 0.8850,
domain std=0.1290, cluster std=0.1290, individual std=0.0910, 
Average Test Accuracy: 0.8313
============ Train epoch 47 ============
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (0) | Train Loss: 0.3936 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.3190 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.3638 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.3210 | Train Acc: 0.8987
 Site-Clipart                   (0) | Train Loss: 0.3254 | Train Acc: 0.9208
 Site-Real                      (2) | Train Loss: 0.2922 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.1973 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2425 | Train Acc: 0.9355
 Site-Real                      (2) | Train Loss: 0.2255 | Train Acc: 0.9511
 Site-Painting                  (5) | Train Loss: 0.3408 | Train Acc: 0.8980
 Site-Painting                  (5) | Train Loss: 0.2910 | Train Acc: 0.9078
 Site-Painting                  (5) | Train Loss: 0.2765 | Train Acc: 0.9308
 Site-Sketch                    (4) | Train Loss: 0.3685 | Train Acc: 0.8953
 Site-Sketch                    (4) | Train Loss: 0.3417 | Train Acc: 0.8839
 Site-QuickDraw                 (1) | Train Loss: 0.5700 | Train Acc: 0.8379
 Site-Infograph                 (3) | Train Loss: 0.8170 | Train Acc: 0.7479
Average Train Accuracy: 0.8976
 Site-Clipart                   (0) | Val  Loss: 0.2098 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.2765 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3006 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.3017 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.3502 | Val  Acc: 0.8847
 Site-Real                      (2) | Val  Loss: 0.1803 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2306 | Val  Acc: 0.9237
 Site-Real                      (2) | Val  Loss: 0.2367 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.1980 | Val  Acc: 0.9654
 Site-Painting                  (5) | Val  Loss: 0.1791 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2669 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.2849 | Val  Acc: 0.9427
 Site-Sketch                    (4) | Val  Loss: 0.3951 | Val  Acc: 0.8976
 Site-Sketch                    (4) | Val  Loss: 0.4954 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.6945 | Val  Acc: 0.7982
 Site-Infograph                 (3) | Val  Loss: 0.9809 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8926
 Test site-Clipart                   (0)| Epoch:46 | Test Acc: 0.8992
 Test site-Real                      (2)| Epoch:46 | Test Acc: 0.9359
 Test site-Painting                  (5)| Epoch:46 | Test Acc: 0.9354
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8755
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7570
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5708
Clipart: 0.8992, Real: 0.9359, Painting: 0.9354, Sketch: 0.8755, QuickDraw: 0.7570, Infograph: 0.5708, 
Average Test Accuracy(group): 0.8290, Average Test Accuracy(individual): 0.8828,
domain std=0.1302, cluster std=0.1302, individual std=0.0916, 
Average Test Accuracy: 0.8290
============ Train epoch 48 ============
cnt=[1, 5, 3, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (1) | Train Loss: 0.3598 | Train Acc: 0.8696
 Site-Clipart                   (1) | Train Loss: 0.3036 | Train Acc: 0.9130
 Site-Clipart                   (1) | Train Loss: 0.3366 | Train Acc: 0.9289
 Site-Clipart                   (1) | Train Loss: 0.3280 | Train Acc: 0.9019
 Site-Clipart                   (1) | Train Loss: 0.3249 | Train Acc: 0.9027
 Site-Real                      (5) | Train Loss: 0.2966 | Train Acc: 0.9127
 Site-Real                      (5) | Train Loss: 0.1940 | Train Acc: 0.9605
 Site-Real                      (5) | Train Loss: 0.2204 | Train Acc: 0.9395
 Site-Real                      (5) | Train Loss: 0.2420 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.3105 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.3180 | Train Acc: 0.9078
 Site-Painting                  (2) | Train Loss: 0.3020 | Train Acc: 0.9446
 Site-Sketch                    (4) | Train Loss: 0.3426 | Train Acc: 0.9162
 Site-Sketch                    (4) | Train Loss: 0.3931 | Train Acc: 0.8914
 Site-QuickDraw                 (0) | Train Loss: 0.5929 | Train Acc: 0.8073
 Site-Infograph                 (3) | Train Loss: 0.8026 | Train Acc: 0.7692
Average Train Accuracy: 0.9005
 Site-Clipart                   (1) | Val  Loss: 0.1867 | Val  Acc: 0.9474
 Site-Clipart                   (1) | Val  Loss: 0.2772 | Val  Acc: 0.9252
 Site-Clipart                   (1) | Val  Loss: 0.2798 | Val  Acc: 0.9133
 Site-Clipart                   (1) | Val  Loss: 0.2948 | Val  Acc: 0.9048
 Site-Clipart                   (1) | Val  Loss: 0.3537 | Val  Acc: 0.9085
 Site-Real                      (5) | Val  Loss: 0.2019 | Val  Acc: 0.9405
 Site-Real                      (5) | Val  Loss: 0.2307 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.2312 | Val  Acc: 0.9333
 Site-Real                      (5) | Val  Loss: 0.1981 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.1785 | Val  Acc: 0.9796
 Site-Painting                  (2) | Val  Loss: 0.2734 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.2819 | Val  Acc: 0.9271
 Site-Sketch                    (4) | Val  Loss: 0.2866 | Val  Acc: 0.9291
 Site-Sketch                    (4) | Val  Loss: 0.4286 | Val  Acc: 0.8427
 Site-QuickDraw                 (0) | Val  Loss: 0.7120 | Val  Acc: 0.8028
 Site-Infograph                 (3) | Val  Loss: 0.9370 | Val  Acc: 0.7115
Average Valid Accuracy: 0.9052
 Best site-Clipart                  (1)  | Epoch:48 | Val Acc: 0.9474
 Best site-Clipart                  (1)  | Epoch:48 | Val Acc: 0.9252
 Best site-Clipart                  (1)  | Epoch:48 | Val Acc: 0.9133
 Best site-Clipart                  (1)  | Epoch:48 | Val Acc: 0.9048
 Best site-Clipart                  (1)  | Epoch:48 | Val Acc: 0.9085
 Best site-Real                     (5)  | Epoch:48 | Val Acc: 0.9405
 Best site-Real                     (5)  | Epoch:48 | Val Acc: 0.9407
 Best site-Real                     (5)  | Epoch:48 | Val Acc: 0.9333
 Best site-Real                     (5)  | Epoch:48 | Val Acc: 0.9567
 Best site-Painting                 (2)  | Epoch:48 | Val Acc: 0.9796
 Best site-Painting                 (2)  | Epoch:48 | Val Acc: 0.9197
 Best site-Painting                 (2)  | Epoch:48 | Val Acc: 0.9271
 Best site-Sketch                   (4)  | Epoch:48 | Val Acc: 0.9291
 Best site-Sketch                   (4)  | Epoch:48 | Val Acc: 0.8427
 Best site-QuickDraw                (0)  | Epoch:48 | Val Acc: 0.8028
 Best site-Infograph                (3)  | Epoch:48 | Val Acc: 0.7115
 Test site-Clipart                   (1)| Epoch:48 | Test Acc: 0.8973
 Test site-Real                      (5)| Epoch:48 | Test Acc: 0.9376
 Test site-Painting                  (2)| Epoch:48 | Test Acc: 0.9370
 Test site-Sketch                    (4)| Epoch:48 | Test Acc: 0.8809
 Test site-QuickDraw                 (0)| Epoch:48 | Test Acc: 0.7550
 Test site-Infograph                 (3)| Epoch:48 | Test Acc: 0.5753
Clipart: 0.8973, Real: 0.9376, Painting: 0.9370, Sketch: 0.8809, QuickDraw: 0.7550, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8305, Average Test Accuracy(individual): 0.8837,
domain std=0.1295, cluster std=0.1295, individual std=0.0911, 
Average Test Accuracy: 0.8305
============ Train epoch 49 ============
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (0) | Train Loss: 0.3563 | Train Acc: 0.8783
 Site-Clipart                   (0) | Train Loss: 0.2834 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.3812 | Train Acc: 0.8933
 Site-Clipart                   (0) | Train Loss: 0.2941 | Train Acc: 0.9177
 Site-Clipart                   (0) | Train Loss: 0.3172 | Train Acc: 0.9276
 Site-Real                      (2) | Train Loss: 0.2934 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.1878 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.1864 | Train Acc: 0.9637
 Site-Real                      (2) | Train Loss: 0.2253 | Train Acc: 0.9425
 Site-Painting                  (5) | Train Loss: 0.3198 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.2823 | Train Acc: 0.9175
 Site-Painting                  (5) | Train Loss: 0.2968 | Train Acc: 0.9239
 Site-Sketch                    (4) | Train Loss: 0.3904 | Train Acc: 0.8848
 Site-Sketch                    (4) | Train Loss: 0.3699 | Train Acc: 0.8801
 Site-QuickDraw                 (1) | Train Loss: 0.5653 | Train Acc: 0.8410
 Site-Infograph                 (3) | Train Loss: 0.8188 | Train Acc: 0.7308
Average Train Accuracy: 0.8979
 Site-Clipart                   (0) | Val  Loss: 0.1941 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.2624 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.2913 | Val  Acc: 0.9133
 Site-Clipart                   (0) | Val  Loss: 0.3181 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.3524 | Val  Acc: 0.9051
 Site-Real                      (2) | Val  Loss: 0.2153 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2270 | Val  Acc: 0.9492
 Site-Real                      (2) | Val  Loss: 0.2137 | Val  Acc: 0.9455
 Site-Real                      (2) | Val  Loss: 0.2070 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2059 | Val  Acc: 0.9694
 Site-Painting                  (5) | Val  Loss: 0.2243 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.2911 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.3091 | Val  Acc: 0.9213
 Site-Sketch                    (4) | Val  Loss: 0.4422 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.7052 | Val  Acc: 0.7982
 Site-Infograph                 (3) | Val  Loss: 0.9422 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9003
 Test site-Clipart                   (0)| Epoch:48 | Test Acc: 0.9087
 Test site-Real                      (2)| Epoch:48 | Test Acc: 0.9359
 Test site-Painting                  (5)| Epoch:48 | Test Acc: 0.9402
 Test site-Sketch                    (4)| Epoch:48 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:48 | Test Acc: 0.7540
 Test site-Infograph                 (3)| Epoch:48 | Test Acc: 0.5753
Clipart: 0.9087, Real: 0.9359, Painting: 0.9402, Sketch: 0.8791, QuickDraw: 0.7540, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8322, Average Test Accuracy(individual): 0.8872,
domain std=0.1307, cluster std=0.1307, individual std=0.0920, 
Average Test Accuracy: 0.8322
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Test site-Clipart                   (0)| Epoch:49 | Test Acc: 0.9087
 Test site-Real                      (2)| Epoch:49 | Test Acc: 0.9359
 Test site-Painting                  (5)| Epoch:49 | Test Acc: 0.9402
 Test site-Sketch                    (4)| Epoch:49 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7540
 Test site-Infograph                 (3)| Epoch:49 | Test Acc: 0.5753
Clipart: 0.9087, Real: 0.9359, Painting: 0.9402, Sketch: 0.8791, QuickDraw: 0.7540, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8322, Average Test Accuracy(individual): 0.8872,
domain std=0.1307, cluster std=0.1307, individual std=0.0920, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
===2023-06-22 09:54:01===
===2023-06-22 09:54:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:49 | Test Acc: 0.9087
 Test site-Real                      (2)| Epoch:49 | Test Acc: 0.9359
 Test site-Painting                  (5)| Epoch:49 | Test Acc: 0.9402
 Test site-Sketch                    (4)| Epoch:49 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7540
 Test site-Infograph                 (3)| Epoch:49 | Test Acc: 0.5753
Clipart: 0.9087, Real: 0.9359, Painting: 0.9402, Sketch: 0.8791, QuickDraw: 0.7540, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8322, Average Test Accuracy(individual): 0.8872,
domain std=0.1307, cluster std=0.1307, individual std=0.0920, 
===2023-06-22 18:49:00===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1100 | Train Acc: 0.2522
 Site-Clipart                   (1) | Train Loss: 2.0453 | Train Acc: 0.3540
 Site-Clipart                   (1) | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-Clipart                   (1) | Train Loss: 2.0738 | Train Acc: 0.2911
 Site-Clipart                   (1) | Train Loss: 2.1005 | Train Acc: 0.2715
 Site-Real                      (0) | Train Loss: 2.0876 | Train Acc: 0.3571
 Site-Real                      (0) | Train Loss: 2.0787 | Train Acc: 0.3559
 Site-Real                      (0) | Train Loss: 2.0687 | Train Acc: 0.3589
 Site-Real                      (0) | Train Loss: 2.1167 | Train Acc: 0.2816
 Site-Painting                  (5) | Train Loss: 2.1118 | Train Acc: 0.3605
 Site-Painting                  (5) | Train Loss: 2.1080 | Train Acc: 0.3495
 Site-Painting                  (5) | Train Loss: 2.0811 | Train Acc: 0.3149
 Site-Sketch                    (4) | Train Loss: 2.0476 | Train Acc: 0.3508
 Site-Sketch                    (4) | Train Loss: 2.1048 | Train Acc: 0.3558
 Site-QuickDraw                 (2) | Train Loss: 2.3103 | Train Acc: 0.1713
 Site-Infograph                 (3) | Train Loss: 2.2553 | Train Acc: 0.1880
Average Train Accuracy: 0.3067
 Site-Clipart                   (1) | Val  Loss: 2.0400 | Val  Acc: 0.2500
 Site-Clipart                   (1) | Val  Loss: 2.1068 | Val  Acc: 0.2991
 Site-Clipart                   (1) | Val  Loss: 2.0650 | Val  Acc: 0.3333
 Site-Clipart                   (1) | Val  Loss: 2.0566 | Val  Acc: 0.3571
 Site-Clipart                   (1) | Val  Loss: 2.1134 | Val  Acc: 0.2678
 Site-Real                      (0) | Val  Loss: 2.0676 | Val  Acc: 0.3452
 Site-Real                      (0) | Val  Loss: 2.0913 | Val  Acc: 0.3220
 Site-Real                      (0) | Val  Loss: 2.0499 | Val  Acc: 0.4061
 Site-Real                      (0) | Val  Loss: 2.0611 | Val  Acc: 0.3766
 Site-Painting                  (5) | Val  Loss: 2.1028 | Val  Acc: 0.3776
 Site-Painting                  (5) | Val  Loss: 2.0467 | Val  Acc: 0.3650
 Site-Painting                  (5) | Val  Loss: 2.1136 | Val  Acc: 0.3385
 Site-Sketch                    (4) | Val  Loss: 2.0787 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0737 | Val  Acc: 0.3539
 Site-QuickDraw                 (2) | Val  Loss: 2.3222 | Val  Acc: 0.1881
 Site-Infograph                 (3) | Val  Loss: 2.2939 | Val  Acc: 0.1603
Average Valid Accuracy: 0.3189
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2991
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2678
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3452
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3220
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4061
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3766
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3776
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3650
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3385
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3539
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1881
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.1603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 4, 3, 1, 6, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (5) | Train Loss: 1.8866 | Train Acc: 0.4783
 Site-Clipart                   (5) | Train Loss: 1.8277 | Train Acc: 0.4907
 Site-Clipart                   (5) | Train Loss: 1.9295 | Train Acc: 0.4356
 Site-Clipart                   (0) | Train Loss: 1.8639 | Train Acc: 0.4937
 Site-Clipart                   (5) | Train Loss: 1.9076 | Train Acc: 0.4593
 Site-Real                      (2) | Train Loss: 1.8107 | Train Acc: 0.5952
 Site-Real                      (2) | Train Loss: 1.7488 | Train Acc: 0.6328
 Site-Real                      (2) | Train Loss: 1.7480 | Train Acc: 0.6290
 Site-Real                      (2) | Train Loss: 1.8225 | Train Acc: 0.5632
 Site-Painting                  (3) | Train Loss: 1.8348 | Train Acc: 0.5034
 Site-Painting                  (3) | Train Loss: 1.8375 | Train Acc: 0.5243
 Site-Painting                  (3) | Train Loss: 1.8317 | Train Acc: 0.5156
 Site-Sketch                    (5) | Train Loss: 1.8357 | Train Acc: 0.5340
 Site-Sketch                    (5) | Train Loss: 1.8858 | Train Acc: 0.4607
 Site-QuickDraw                 (1) | Train Loss: 2.2346 | Train Acc: 0.1682
 Site-Infograph                 (4) | Train Loss: 2.2041 | Train Acc: 0.2051
Average Train Accuracy: 0.4806
 Site-Clipart                   (5) | Val  Loss: 1.7841 | Val  Acc: 0.4868
 Site-Clipart                   (5) | Val  Loss: 1.8818 | Val  Acc: 0.4579
 Site-Clipart                   (5) | Val  Loss: 1.8618 | Val  Acc: 0.5333
 Site-Clipart                   (0) | Val  Loss: 1.8584 | Val  Acc: 0.4571
 Site-Clipart                   (5) | Val  Loss: 1.9227 | Val  Acc: 0.3932
 Site-Real                      (2) | Val  Loss: 1.7422 | Val  Acc: 0.5595
 Site-Real                      (2) | Val  Loss: 1.7933 | Val  Acc: 0.5847
 Site-Real                      (2) | Val  Loss: 1.7414 | Val  Acc: 0.6242
 Site-Real                      (2) | Val  Loss: 1.7656 | Val  Acc: 0.6104
 Site-Painting                  (3) | Val  Loss: 1.8260 | Val  Acc: 0.5918
 Site-Painting                  (3) | Val  Loss: 1.8087 | Val  Acc: 0.5255
 Site-Painting                  (3) | Val  Loss: 1.8563 | Val  Acc: 0.4948
 Site-Sketch                    (5) | Val  Loss: 1.8072 | Val  Acc: 0.5512
 Site-Sketch                    (5) | Val  Loss: 1.8910 | Val  Acc: 0.4326
 Site-QuickDraw                 (1) | Val  Loss: 2.2509 | Val  Acc: 0.1789
 Site-Infograph                 (4) | Val  Loss: 2.1633 | Val  Acc: 0.1923
Average Valid Accuracy: 0.4797
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4868
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4579
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5333
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4571
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.3932
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5595
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5847
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6242
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6104
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5918
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5255
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.4948
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5512
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4326
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.1789
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.1923
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[2, 1, 4, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.6673 | Train Acc: 0.5739
 Site-Clipart                   (0) | Train Loss: 1.5994 | Train Acc: 0.6025
 Site-Clipart                   (0) | Train Loss: 1.7060 | Train Acc: 0.5600
 Site-Clipart                   (0) | Train Loss: 1.6488 | Train Acc: 0.6108
 Site-Clipart                   (0) | Train Loss: 1.6670 | Train Acc: 0.6199
 Site-Real                      (2) | Train Loss: 1.5728 | Train Acc: 0.7143
 Site-Real                      (2) | Train Loss: 1.4752 | Train Acc: 0.7288
 Site-Real                      (2) | Train Loss: 1.4512 | Train Acc: 0.7540
 Site-Real                      (2) | Train Loss: 1.5584 | Train Acc: 0.7040
 Site-Painting                  (4) | Train Loss: 1.5750 | Train Acc: 0.6599
 Site-Painting                  (4) | Train Loss: 1.6031 | Train Acc: 0.6650
 Site-Painting                  (4) | Train Loss: 1.5384 | Train Acc: 0.7093
 Site-Sketch                    (5) | Train Loss: 1.6445 | Train Acc: 0.6126
 Site-Sketch                    (5) | Train Loss: 1.6714 | Train Acc: 0.6030
 Site-QuickDraw                 (1) | Train Loss: 2.2387 | Train Acc: 0.1957
 Site-Infograph                 (3) | Train Loss: 2.0518 | Train Acc: 0.3376
Average Train Accuracy: 0.6032
 Site-Clipart                   (0) | Val  Loss: 1.5395 | Val  Acc: 0.6316
 Site-Clipart                   (0) | Val  Loss: 1.6326 | Val  Acc: 0.6729
 Site-Clipart                   (0) | Val  Loss: 1.6532 | Val  Acc: 0.6467
 Site-Clipart                   (0) | Val  Loss: 1.6459 | Val  Acc: 0.6381
 Site-Clipart                   (0) | Val  Loss: 1.7141 | Val  Acc: 0.5898
 Site-Real                      (2) | Val  Loss: 1.4811 | Val  Acc: 0.6786
 Site-Real                      (2) | Val  Loss: 1.4883 | Val  Acc: 0.7373
 Site-Real                      (2) | Val  Loss: 1.3994 | Val  Acc: 0.7879
 Site-Real                      (2) | Val  Loss: 1.4735 | Val  Acc: 0.7749
 Site-Painting                  (4) | Val  Loss: 1.5346 | Val  Acc: 0.7245
 Site-Painting                  (4) | Val  Loss: 1.5338 | Val  Acc: 0.6569
 Site-Painting                  (4) | Val  Loss: 1.5772 | Val  Acc: 0.6875
 Site-Sketch                    (5) | Val  Loss: 1.6583 | Val  Acc: 0.5984
 Site-Sketch                    (5) | Val  Loss: 1.7147 | Val  Acc: 0.5393
 Site-QuickDraw                 (1) | Val  Loss: 2.2423 | Val  Acc: 0.2248
 Site-Infograph                 (3) | Val  Loss: 2.0234 | Val  Acc: 0.3654
Average Valid Accuracy: 0.6222
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6316
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6729
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6467
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6381
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5898
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.6786
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7373
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7879
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7749
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.7245
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6569
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6875
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5984
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5393
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2248
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.3654
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 1, 4, 2, 3, 1, ]
cnt=[3, 5, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.4789 | Train Acc: 0.6261
 Site-Clipart                   (0) | Train Loss: 1.3669 | Train Acc: 0.7516
 Site-Clipart                   (0) | Train Loss: 1.5318 | Train Acc: 0.6622
 Site-Clipart                   (0) | Train Loss: 1.4399 | Train Acc: 0.7120
 Site-Clipart                   (0) | Train Loss: 1.4534 | Train Acc: 0.7149
 Site-Real                      (2) | Train Loss: 1.2866 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 1.2092 | Train Acc: 0.8588
 Site-Real                      (2) | Train Loss: 1.1930 | Train Acc: 0.8266
 Site-Real                      (2) | Train Loss: 1.2983 | Train Acc: 0.8190
 Site-Painting                  (4) | Train Loss: 1.3982 | Train Acc: 0.7075
 Site-Painting                  (4) | Train Loss: 1.3882 | Train Acc: 0.7427
 Site-Painting                  (4) | Train Loss: 1.3568 | Train Acc: 0.7543
 Site-Sketch                    (3) | Train Loss: 1.3913 | Train Acc: 0.6963
 Site-Sketch                    (3) | Train Loss: 1.4307 | Train Acc: 0.6517
 Site-QuickDraw                 (1) | Train Loss: 2.1364 | Train Acc: 0.2263
 Site-Infograph                 (5) | Train Loss: 1.9551 | Train Acc: 0.4060
Average Train Accuracy: 0.6868
 Site-Clipart                   (0) | Val  Loss: 1.3467 | Val  Acc: 0.7105
 Site-Clipart                   (0) | Val  Loss: 1.4263 | Val  Acc: 0.7196
 Site-Clipart                   (0) | Val  Loss: 1.4194 | Val  Acc: 0.7333
 Site-Clipart                   (0) | Val  Loss: 1.3989 | Val  Acc: 0.7238
 Site-Clipart                   (0) | Val  Loss: 1.4940 | Val  Acc: 0.6678
 Site-Real                      (2) | Val  Loss: 1.1734 | Val  Acc: 0.8214
 Site-Real                      (2) | Val  Loss: 1.2131 | Val  Acc: 0.8220
 Site-Real                      (2) | Val  Loss: 1.1648 | Val  Acc: 0.8485
 Site-Real                      (2) | Val  Loss: 1.1998 | Val  Acc: 0.8658
 Site-Painting                  (4) | Val  Loss: 1.2713 | Val  Acc: 0.7857
 Site-Painting                  (4) | Val  Loss: 1.3490 | Val  Acc: 0.7591
 Site-Painting                  (4) | Val  Loss: 1.3581 | Val  Acc: 0.7240
 Site-Sketch                    (3) | Val  Loss: 1.3997 | Val  Acc: 0.7323
 Site-Sketch                    (3) | Val  Loss: 1.5173 | Val  Acc: 0.6236
 Site-QuickDraw                 (1) | Val  Loss: 2.1420 | Val  Acc: 0.2477
 Site-Infograph                 (5) | Val  Loss: 1.9078 | Val  Acc: 0.4295
Average Valid Accuracy: 0.7009
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7105
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7196
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7333
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7238
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6678
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8214
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8220
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8485
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8658
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7857
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7591
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7240
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.7323
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.6236
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.2477
 Best site-Infograph                (5)  | Epoch:3 | Val Acc: 0.4295
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 4, 3, 1, 3, 1, ]
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (4) | Train Loss: 1.3082 | Train Acc: 0.7304
 Site-Clipart                   (0) | Train Loss: 1.2178 | Train Acc: 0.7826
 Site-Clipart                   (0) | Train Loss: 1.3577 | Train Acc: 0.7422
 Site-Clipart                   (4) | Train Loss: 1.2496 | Train Acc: 0.7500
 Site-Clipart                   (4) | Train Loss: 1.2931 | Train Acc: 0.7489
 Site-Real                      (1) | Train Loss: 1.0870 | Train Acc: 0.8730
 Site-Real                      (1) | Train Loss: 0.9925 | Train Acc: 0.8757
 Site-Real                      (1) | Train Loss: 0.9600 | Train Acc: 0.8911
 Site-Real                      (1) | Train Loss: 1.0858 | Train Acc: 0.8678
 Site-Painting                  (2) | Train Loss: 1.1503 | Train Acc: 0.7891
 Site-Painting                  (2) | Train Loss: 1.1086 | Train Acc: 0.7621
 Site-Painting                  (2) | Train Loss: 1.1182 | Train Acc: 0.7993
 Site-Sketch                    (0) | Train Loss: 1.2148 | Train Acc: 0.7487
 Site-Sketch                    (0) | Train Loss: 1.2666 | Train Acc: 0.7266
 Site-QuickDraw                 (3) | Train Loss: 2.1022 | Train Acc: 0.2813
 Site-Infograph                 (5) | Train Loss: 1.8448 | Train Acc: 0.4274
Average Train Accuracy: 0.7373
 Site-Clipart                   (4) | Val  Loss: 1.1691 | Val  Acc: 0.7632
 Site-Clipart                   (0) | Val  Loss: 1.2403 | Val  Acc: 0.8037
 Site-Clipart                   (0) | Val  Loss: 1.2501 | Val  Acc: 0.7467
 Site-Clipart                   (4) | Val  Loss: 1.2103 | Val  Acc: 0.7524
 Site-Clipart                   (4) | Val  Loss: 1.3350 | Val  Acc: 0.7186
 Site-Real                      (1) | Val  Loss: 0.9840 | Val  Acc: 0.8929
 Site-Real                      (1) | Val  Loss: 0.9837 | Val  Acc: 0.8814
 Site-Real                      (1) | Val  Loss: 0.9297 | Val  Acc: 0.9030
 Site-Real                      (1) | Val  Loss: 0.9972 | Val  Acc: 0.8788
 Site-Painting                  (2) | Val  Loss: 1.0523 | Val  Acc: 0.8469
 Site-Painting                  (2) | Val  Loss: 1.1467 | Val  Acc: 0.7664
 Site-Painting                  (2) | Val  Loss: 1.1639 | Val  Acc: 0.7604
 Site-Sketch                    (0) | Val  Loss: 1.2794 | Val  Acc: 0.6850
 Site-Sketch                    (0) | Val  Loss: 1.3008 | Val  Acc: 0.6629
 Site-QuickDraw                 (3) | Val  Loss: 2.0814 | Val  Acc: 0.3073
 Site-Infograph                 (5) | Val  Loss: 1.7719 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7419
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7632
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.8037
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7467
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7524
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7186
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8929
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8814
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.9030
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8788
 Best site-Painting                 (2)  | Epoch:4 | Val Acc: 0.8469
 Best site-Painting                 (2)  | Epoch:4 | Val Acc: 0.7664
 Best site-Painting                 (2)  | Epoch:4 | Val Acc: 0.7604
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.6850
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.6629
 Best site-QuickDraw                (3)  | Epoch:4 | Val Acc: 0.3073
 Best site-Infograph                (5)  | Epoch:4 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 4, 4, 2, 3, ]
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 1.1632 | Train Acc: 0.7565
 Site-Clipart                   (3) | Train Loss: 1.0257 | Train Acc: 0.7888
 Site-Clipart                   (3) | Train Loss: 1.1751 | Train Acc: 0.7600
 Site-Clipart                   (0) | Train Loss: 1.0825 | Train Acc: 0.7911
 Site-Clipart                   (3) | Train Loss: 1.1436 | Train Acc: 0.7738
 Site-Real                      (2) | Train Loss: 0.8988 | Train Acc: 0.8730
 Site-Real                      (2) | Train Loss: 0.8466 | Train Acc: 0.8814
 Site-Real                      (2) | Train Loss: 0.8232 | Train Acc: 0.8911
 Site-Real                      (2) | Train Loss: 0.9344 | Train Acc: 0.8994
 Site-Painting                  (5) | Train Loss: 0.9806 | Train Acc: 0.8299
 Site-Painting                  (5) | Train Loss: 1.0387 | Train Acc: 0.8058
 Site-Painting                  (5) | Train Loss: 0.9869 | Train Acc: 0.8097
 Site-Sketch                    (4) | Train Loss: 1.0677 | Train Acc: 0.7592
 Site-Sketch                    (4) | Train Loss: 1.0501 | Train Acc: 0.7191
 Site-QuickDraw                 (1) | Train Loss: 1.9737 | Train Acc: 0.3211
 Site-Infograph                 (0) | Train Loss: 1.7846 | Train Acc: 0.3974
Average Train Accuracy: 0.7536
 Site-Clipart                   (3) | Val  Loss: 0.9596 | Val  Acc: 0.8026
 Site-Clipart                   (3) | Val  Loss: 1.0698 | Val  Acc: 0.8037
 Site-Clipart                   (3) | Val  Loss: 1.0723 | Val  Acc: 0.7867
 Site-Clipart                   (0) | Val  Loss: 1.0570 | Val  Acc: 0.7905
 Site-Clipart                   (3) | Val  Loss: 1.1597 | Val  Acc: 0.7559
 Site-Real                      (2) | Val  Loss: 0.8416 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.8523 | Val  Acc: 0.8729
 Site-Real                      (2) | Val  Loss: 0.8027 | Val  Acc: 0.9030
 Site-Real                      (2) | Val  Loss: 0.8402 | Val  Acc: 0.9091
 Site-Painting                  (5) | Val  Loss: 0.9417 | Val  Acc: 0.8469
 Site-Painting                  (5) | Val  Loss: 0.9600 | Val  Acc: 0.8102
 Site-Painting                  (5) | Val  Loss: 1.0203 | Val  Acc: 0.8073
 Site-Sketch                    (4) | Val  Loss: 1.0891 | Val  Acc: 0.7795
 Site-Sketch                    (4) | Val  Loss: 1.1438 | Val  Acc: 0.7191
 Site-QuickDraw                 (1) | Val  Loss: 1.9946 | Val  Acc: 0.3165
 Site-Infograph                 (0) | Val  Loss: 1.7023 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7717
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.8026
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.8037
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7867
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7905
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7559
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9048
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8729
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9030
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9091
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8469
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8102
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8073
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7795
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7191
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.3165
 Best site-Infograph                (0)  | Epoch:5 | Val Acc: 0.5385
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 4, 1, 2, 4, 1, ]
cnt=[1, 3, 1, 5, 4, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (4) | Train Loss: 1.0253 | Train Acc: 0.7826
 Site-Clipart                   (1) | Train Loss: 0.8493 | Train Acc: 0.8385
 Site-Clipart                   (1) | Train Loss: 1.0309 | Train Acc: 0.7644
 Site-Clipart                   (4) | Train Loss: 0.9270 | Train Acc: 0.8228
 Site-Clipart                   (4) | Train Loss: 0.9813 | Train Acc: 0.8032
 Site-Real                      (0) | Train Loss: 0.7834 | Train Acc: 0.8889
 Site-Real                      (0) | Train Loss: 0.7343 | Train Acc: 0.9040
 Site-Real                      (0) | Train Loss: 0.7103 | Train Acc: 0.8992
 Site-Real                      (0) | Train Loss: 0.7834 | Train Acc: 0.9109
 Site-Painting                  (5) | Train Loss: 0.9357 | Train Acc: 0.8163
 Site-Painting                  (3) | Train Loss: 0.9425 | Train Acc: 0.8252
 Site-Painting                  (3) | Train Loss: 0.9150 | Train Acc: 0.8166
 Site-Sketch                    (1) | Train Loss: 0.9357 | Train Acc: 0.7801
 Site-Sketch                    (1) | Train Loss: 0.9815 | Train Acc: 0.7678
 Site-QuickDraw                 (2) | Train Loss: 1.8617 | Train Acc: 0.3211
 Site-Infograph                 (4) | Train Loss: 1.6857 | Train Acc: 0.4872
Average Train Accuracy: 0.7768
 Site-Clipart                   (4) | Val  Loss: 0.8494 | Val  Acc: 0.7895
 Site-Clipart                   (1) | Val  Loss: 0.9121 | Val  Acc: 0.7944
 Site-Clipart                   (1) | Val  Loss: 0.9779 | Val  Acc: 0.7933
 Site-Clipart                   (4) | Val  Loss: 0.9038 | Val  Acc: 0.8238
 Site-Clipart                   (4) | Val  Loss: 1.0117 | Val  Acc: 0.7661
 Site-Real                      (0) | Val  Loss: 0.7231 | Val  Acc: 0.8929
 Site-Real                      (0) | Val  Loss: 0.7358 | Val  Acc: 0.8898
 Site-Real                      (0) | Val  Loss: 0.7131 | Val  Acc: 0.8848
 Site-Real                      (0) | Val  Loss: 0.7467 | Val  Acc: 0.9221
 Site-Painting                  (5) | Val  Loss: 0.8138 | Val  Acc: 0.8367
 Site-Painting                  (3) | Val  Loss: 0.8581 | Val  Acc: 0.8394
 Site-Painting                  (3) | Val  Loss: 0.8980 | Val  Acc: 0.8021
 Site-Sketch                    (1) | Val  Loss: 0.9933 | Val  Acc: 0.7559
 Site-Sketch                    (1) | Val  Loss: 1.0009 | Val  Acc: 0.7697
 Site-QuickDraw                 (2) | Val  Loss: 1.9283 | Val  Acc: 0.3257
 Site-Infograph                 (4) | Val  Loss: 1.6202 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7741
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7895
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.7944
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.7933
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.8238
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7661
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8929
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8898
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8848
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.9221
 Best site-Painting                 (5)  | Epoch:6 | Val Acc: 0.8367
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8394
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8021
 Best site-Sketch                   (1)  | Epoch:6 | Val Acc: 0.7559
 Best site-Sketch                   (1)  | Epoch:6 | Val Acc: 0.7697
 Best site-QuickDraw                (2)  | Epoch:6 | Val Acc: 0.3257
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 3, 1, 5, 1, 3, ]
cnt=[5, 1, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (3) | Train Loss: 0.8293 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.7955 | Train Acc: 0.8447
 Site-Clipart                   (3) | Train Loss: 0.8919 | Train Acc: 0.8356
 Site-Clipart                   (3) | Train Loss: 0.8603 | Train Acc: 0.8165
 Site-Clipart                   (3) | Train Loss: 0.9030 | Train Acc: 0.8009
 Site-Real                      (4) | Train Loss: 0.7103 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.6460 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.6134 | Train Acc: 0.8992
 Site-Real                      (1) | Train Loss: 0.7095 | Train Acc: 0.9224
 Site-Painting                  (5) | Train Loss: 0.8568 | Train Acc: 0.8095
 Site-Painting                  (5) | Train Loss: 0.8038 | Train Acc: 0.8447
 Site-Painting                  (5) | Train Loss: 0.7930 | Train Acc: 0.8374
 Site-Sketch                    (0) | Train Loss: 0.8179 | Train Acc: 0.8010
 Site-Sketch                    (0) | Train Loss: 0.8566 | Train Acc: 0.7715
 Site-QuickDraw                 (2) | Train Loss: 1.7996 | Train Acc: 0.4190
 Site-Infograph                 (3) | Train Loss: 1.6124 | Train Acc: 0.4658
Average Train Accuracy: 0.7970
 Site-Clipart                   (3) | Val  Loss: 0.7829 | Val  Acc: 0.8026
 Site-Clipart                   (0) | Val  Loss: 0.8415 | Val  Acc: 0.8224
 Site-Clipart                   (3) | Val  Loss: 0.8877 | Val  Acc: 0.7933
 Site-Clipart                   (3) | Val  Loss: 0.8379 | Val  Acc: 0.8000
 Site-Clipart                   (3) | Val  Loss: 0.9263 | Val  Acc: 0.7831
 Site-Real                      (4) | Val  Loss: 0.6329 | Val  Acc: 0.9167
 Site-Real                      (1) | Val  Loss: 0.6311 | Val  Acc: 0.9153
 Site-Real                      (1) | Val  Loss: 0.6089 | Val  Acc: 0.9030
 Site-Real                      (1) | Val  Loss: 0.6580 | Val  Acc: 0.9134
 Site-Painting                  (5) | Val  Loss: 0.7306 | Val  Acc: 0.8163
 Site-Painting                  (5) | Val  Loss: 0.7925 | Val  Acc: 0.8029
 Site-Painting                  (5) | Val  Loss: 0.8122 | Val  Acc: 0.8333
 Site-Sketch                    (0) | Val  Loss: 0.8781 | Val  Acc: 0.7953
 Site-Sketch                    (0) | Val  Loss: 0.9283 | Val  Acc: 0.7022
 Site-QuickDraw                 (2) | Val  Loss: 1.8169 | Val  Acc: 0.4037
 Site-Infograph                 (3) | Val  Loss: 1.5137 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7831
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8026
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8224
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7933
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8000
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7831
 Best site-Real                     (4)  | Epoch:7 | Val Acc: 0.9167
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9153
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9030
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9134
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8163
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8029
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8333
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7953
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7022
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.4037
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.5256
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 8 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[5, 1, 4, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 0.8207 | Train Acc: 0.8348
 Site-Clipart                   (4) | Train Loss: 0.7192 | Train Acc: 0.8758
 Site-Clipart                   (0) | Train Loss: 0.8653 | Train Acc: 0.8178
 Site-Clipart                   (0) | Train Loss: 0.7934 | Train Acc: 0.8101
 Site-Clipart                   (0) | Train Loss: 0.8224 | Train Acc: 0.8213
 Site-Real                      (2) | Train Loss: 0.6354 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.5521 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.5501 | Train Acc: 0.9194
 Site-Real                      (2) | Train Loss: 0.6266 | Train Acc: 0.9224
 Site-Painting                  (3) | Train Loss: 0.7844 | Train Acc: 0.8231
 Site-Painting                  (3) | Train Loss: 0.7712 | Train Acc: 0.8301
 Site-Painting                  (3) | Train Loss: 0.7143 | Train Acc: 0.8339
 Site-Sketch                    (4) | Train Loss: 0.7750 | Train Acc: 0.8010
 Site-Sketch                    (4) | Train Loss: 0.8807 | Train Acc: 0.7828
 Site-QuickDraw                 (1) | Train Loss: 1.6608 | Train Acc: 0.4648
 Site-Infograph                 (5) | Train Loss: 1.5513 | Train Acc: 0.5043
Average Train Accuracy: 0.8051
 Site-Clipart                   (0) | Val  Loss: 0.6713 | Val  Acc: 0.8421
 Site-Clipart                   (4) | Val  Loss: 0.7464 | Val  Acc: 0.8879
 Site-Clipart                   (0) | Val  Loss: 0.7870 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.7607 | Val  Acc: 0.8000
 Site-Clipart                   (0) | Val  Loss: 0.8600 | Val  Acc: 0.8169
 Site-Real                      (2) | Val  Loss: 0.5297 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.5696 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.5535 | Val  Acc: 0.8970
 Site-Real                      (2) | Val  Loss: 0.5660 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.6168 | Val  Acc: 0.8673
 Site-Painting                  (3) | Val  Loss: 0.6802 | Val  Acc: 0.8175
 Site-Painting                  (3) | Val  Loss: 0.7461 | Val  Acc: 0.8490
 Site-Sketch                    (4) | Val  Loss: 0.8296 | Val  Acc: 0.7953
 Site-Sketch                    (4) | Val  Loss: 0.8593 | Val  Acc: 0.7640
 Site-QuickDraw                 (1) | Val  Loss: 1.6959 | Val  Acc: 0.5275
 Site-Infograph                 (5) | Val  Loss: 1.4571 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8180
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8421
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8879
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8333
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8000
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8169
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.8970
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9394
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8673
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8175
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8490
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.7953
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.7640
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.5275
 Best site-Infograph                (5)  | Epoch:8 | Val Acc: 0.5577
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 3, 4, 3, 4, 1, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (1) | Train Loss: 0.7190 | Train Acc: 0.8348
 Site-Clipart                   (3) | Train Loss: 0.6828 | Train Acc: 0.8261
 Site-Clipart                   (1) | Train Loss: 0.8148 | Train Acc: 0.8356
 Site-Clipart                   (4) | Train Loss: 0.7332 | Train Acc: 0.8101
 Site-Clipart                   (1) | Train Loss: 0.7623 | Train Acc: 0.8348
 Site-Real                      (2) | Train Loss: 0.5559 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.4579 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.4628 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.5418 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.6914 | Train Acc: 0.8503
 Site-Painting                  (4) | Train Loss: 0.7139 | Train Acc: 0.8689
 Site-Painting                  (4) | Train Loss: 0.6584 | Train Acc: 0.8339
 Site-Sketch                    (3) | Train Loss: 0.7201 | Train Acc: 0.8220
 Site-Sketch                    (3) | Train Loss: 0.7297 | Train Acc: 0.7828
 Site-QuickDraw                 (0) | Train Loss: 1.5279 | Train Acc: 0.5199
 Site-Infograph                 (5) | Train Loss: 1.5365 | Train Acc: 0.5342
Average Train Accuracy: 0.8184
 Site-Clipart                   (1) | Val  Loss: 0.5857 | Val  Acc: 0.8816
 Site-Clipart                   (3) | Val  Loss: 0.6920 | Val  Acc: 0.8598
 Site-Clipart                   (1) | Val  Loss: 0.7356 | Val  Acc: 0.8200
 Site-Clipart                   (4) | Val  Loss: 0.6649 | Val  Acc: 0.8429
 Site-Clipart                   (1) | Val  Loss: 0.8074 | Val  Acc: 0.8203
 Site-Real                      (2) | Val  Loss: 0.4910 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.4727 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.4788 | Val  Acc: 0.9212
 Site-Real                      (2) | Val  Loss: 0.5096 | Val  Acc: 0.9264
 Site-Painting                  (4) | Val  Loss: 0.6046 | Val  Acc: 0.8571
 Site-Painting                  (4) | Val  Loss: 0.6680 | Val  Acc: 0.8102
 Site-Painting                  (4) | Val  Loss: 0.6789 | Val  Acc: 0.8594
 Site-Sketch                    (3) | Val  Loss: 0.7626 | Val  Acc: 0.7874
 Site-Sketch                    (3) | Val  Loss: 0.8386 | Val  Acc: 0.7809
 Site-QuickDraw                 (0) | Val  Loss: 1.5909 | Val  Acc: 0.5780
 Site-Infograph                 (5) | Val  Loss: 1.4262 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8266
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8816
 Best site-Clipart                  (3)  | Epoch:9 | Val Acc: 0.8598
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8200
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8429
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8203
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9576
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9212
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9264
 Best site-Painting                 (4)  | Epoch:9 | Val Acc: 0.8571
 Best site-Painting                 (4)  | Epoch:9 | Val Acc: 0.8102
 Best site-Painting                 (4)  | Epoch:9 | Val Acc: 0.8594
 Best site-Sketch                   (3)  | Epoch:9 | Val Acc: 0.7874
 Best site-Sketch                   (3)  | Epoch:9 | Val Acc: 0.7809
 Best site-QuickDraw                (0)  | Epoch:9 | Val Acc: 0.5780
 Best site-Infograph                (5)  | Epoch:9 | Val Acc: 0.5705
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Test site-Clipart                   (1)| Epoch:9 | Test Acc: 0.8479
 Test site-Real                      (2)| Epoch:9 | Test Acc: 0.9425
 Test site-Painting                  (4)| Epoch:9 | Test Acc: 0.8740
 Test site-Sketch                    (3)| Epoch:9 | Test Acc: 0.8520
 Test site-QuickDraw                 (0)| Epoch:9 | Test Acc: 0.5700
 Test site-Infograph                 (5)| Epoch:9 | Test Acc: 0.5175
Clipart: 0.8479, Real: 0.9425, Painting: 0.8740, Sketch: 0.8520, QuickDraw: 0.5700, Infograph: 0.5175, 
Average Test Accuracy(group): 0.7673, Average Test Accuracy(individual): 0.8389,
domain std=0.1618, cluster std=0.1610, individual std=0.1180, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 1, 3, 3, 4, 1, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (4) | Train Loss: 0.6766 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.6132 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.7517 | Train Acc: 0.8400
 Site-Clipart                   (4) | Train Loss: 0.6844 | Train Acc: 0.8291
 Site-Clipart                   (3) | Train Loss: 0.7338 | Train Acc: 0.8258
 Site-Real                      (2) | Train Loss: 0.5430 | Train Acc: 0.8810
 Site-Real                      (2) | Train Loss: 0.4588 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.4644 | Train Acc: 0.9194
 Site-Real                      (2) | Train Loss: 0.5041 | Train Acc: 0.9310
 Site-Painting                  (0) | Train Loss: 0.6234 | Train Acc: 0.8639
 Site-Painting                  (0) | Train Loss: 0.6731 | Train Acc: 0.8592
 Site-Painting                  (0) | Train Loss: 0.6531 | Train Acc: 0.8651
 Site-Sketch                    (3) | Train Loss: 0.7050 | Train Acc: 0.8325
 Site-Sketch                    (3) | Train Loss: 0.7359 | Train Acc: 0.7940
 Site-QuickDraw                 (1) | Train Loss: 1.4484 | Train Acc: 0.5810
 Site-Infograph                 (5) | Train Loss: 1.4677 | Train Acc: 0.5342
Average Train Accuracy: 0.8283
 Site-Clipart                   (4) | Val  Loss: 0.5572 | Val  Acc: 0.8553
 Site-Clipart                   (4) | Val  Loss: 0.6816 | Val  Acc: 0.8505
 Site-Clipart                   (4) | Val  Loss: 0.6646 | Val  Acc: 0.8600
 Site-Clipart                   (4) | Val  Loss: 0.6859 | Val  Acc: 0.7952
 Site-Clipart                   (3) | Val  Loss: 0.7390 | Val  Acc: 0.8271
 Site-Real                      (2) | Val  Loss: 0.4484 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.4644 | Val  Acc: 0.9153
 Site-Real                      (0) | Val  Loss: 0.4199 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.4807 | Val  Acc: 0.9264
 Site-Painting                  (0) | Val  Loss: 0.5162 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.6449 | Val  Acc: 0.8467
 Site-Painting                  (0) | Val  Loss: 0.6249 | Val  Acc: 0.8594
 Site-Sketch                    (3) | Val  Loss: 0.6871 | Val  Acc: 0.8504
 Site-Sketch                    (3) | Val  Loss: 0.7454 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.5420 | Val  Acc: 0.5872
 Site-Infograph                 (5) | Val  Loss: 1.3562 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8362
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8553
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8505
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8600
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.7952
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8271
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9153
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9576
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9264
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.9286
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8467
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8594
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8504
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.5872
 Best site-Infograph                (5)  | Epoch:10 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 1, 5, 2, 4, 2, ]
cnt=[1, 4, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (2) | Train Loss: 0.6709 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.5486 | Train Acc: 0.8571
 Site-Clipart                   (2) | Train Loss: 0.6888 | Train Acc: 0.8311
 Site-Clipart                   (0) | Train Loss: 0.6252 | Train Acc: 0.8513
 Site-Clipart                   (0) | Train Loss: 0.6864 | Train Acc: 0.8213
 Site-Real                      (5) | Train Loss: 0.4948 | Train Acc: 0.8968
 Site-Real                      (5) | Train Loss: 0.4254 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.4141 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.4524 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.6006 | Train Acc: 0.8435
 Site-Painting                  (4) | Train Loss: 0.5956 | Train Acc: 0.8689
 Site-Painting                  (4) | Train Loss: 0.6198 | Train Acc: 0.8478
 Site-Sketch                    (2) | Train Loss: 0.6458 | Train Acc: 0.8063
 Site-Sketch                    (2) | Train Loss: 0.6889 | Train Acc: 0.8127
 Site-QuickDraw                 (1) | Train Loss: 1.5432 | Train Acc: 0.5474
 Site-Infograph                 (4) | Train Loss: 1.4086 | Train Acc: 0.5427
Average Train Accuracy: 0.8230
 Site-Clipart                   (2) | Val  Loss: 0.5700 | Val  Acc: 0.8158
 Site-Clipart                   (2) | Val  Loss: 0.6056 | Val  Acc: 0.8598
 Site-Clipart                   (2) | Val  Loss: 0.6281 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.6365 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.6962 | Val  Acc: 0.8373
 Site-Real                      (5) | Val  Loss: 0.4228 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.4182 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.4315 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.4528 | Val  Acc: 0.9177
 Site-Painting                  (4) | Val  Loss: 0.5582 | Val  Acc: 0.8776
 Site-Painting                  (4) | Val  Loss: 0.5778 | Val  Acc: 0.8321
 Site-Painting                  (4) | Val  Loss: 0.6354 | Val  Acc: 0.8438
 Site-Sketch                    (2) | Val  Loss: 0.6350 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.7630 | Val  Acc: 0.7753
 Site-QuickDraw                 (1) | Val  Loss: 1.4443 | Val  Acc: 0.5917
 Site-Infograph                 (4) | Val  Loss: 1.3375 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8306
============ Train epoch 12 ============
cnt=[2, 1, 4, 4, 3, 2, ]
cnt=[1, 5, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (4) | Train Loss: 0.6304 | Train Acc: 0.8522
 Site-Clipart                   (4) | Train Loss: 0.5101 | Train Acc: 0.8944
 Site-Clipart                   (4) | Train Loss: 0.6557 | Train Acc: 0.8489
 Site-Clipart                   (5) | Train Loss: 0.6112 | Train Acc: 0.8259
 Site-Clipart                   (5) | Train Loss: 0.6310 | Train Acc: 0.8529
 Site-Real                      (2) | Train Loss: 0.4811 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.3874 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.4051 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.4556 | Train Acc: 0.9425
 Site-Painting                  (3) | Train Loss: 0.7333 | Train Acc: 0.8707
 Site-Painting                  (3) | Train Loss: 0.6352 | Train Acc: 0.8544
 Site-Painting                  (3) | Train Loss: 0.5756 | Train Acc: 0.8547
 Site-Sketch                    (0) | Train Loss: 0.6154 | Train Acc: 0.8377
 Site-Sketch                    (0) | Train Loss: 0.6851 | Train Acc: 0.7940
 Site-QuickDraw                 (1) | Train Loss: 1.2633 | Train Acc: 0.6116
 Site-Infograph                 (3) | Train Loss: 1.4408 | Train Acc: 0.5385
Average Train Accuracy: 0.8365
 Site-Clipart                   (4) | Val  Loss: 0.4998 | Val  Acc: 0.8947
 Site-Clipart                   (4) | Val  Loss: 0.5747 | Val  Acc: 0.8692
 Site-Clipart                   (4) | Val  Loss: 0.6119 | Val  Acc: 0.8400
 Site-Clipart                   (5) | Val  Loss: 0.5980 | Val  Acc: 0.8238
 Site-Clipart                   (5) | Val  Loss: 0.6863 | Val  Acc: 0.8271
 Site-Real                      (2) | Val  Loss: 0.3742 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.3810 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.3774 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.4165 | Val  Acc: 0.9307
 Site-Painting                  (3) | Val  Loss: 0.5160 | Val  Acc: 0.8980
 Site-Painting                  (3) | Val  Loss: 0.5494 | Val  Acc: 0.8467
 Site-Painting                  (3) | Val  Loss: 0.5873 | Val  Acc: 0.8438
 Site-Sketch                    (0) | Val  Loss: 0.6575 | Val  Acc: 0.8504
 Site-Sketch                    (0) | Val  Loss: 0.7346 | Val  Acc: 0.7809
 Site-QuickDraw                 (1) | Val  Loss: 1.3773 | Val  Acc: 0.6055
 Site-Infograph                 (3) | Val  Loss: 1.3644 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8394
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8947
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8692
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8400
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8238
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8271
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9643
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9576
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9333
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9307
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8980
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8467
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8438
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8504
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.7809
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.6055
 Best site-Infograph                (3)  | Epoch:12 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 1, 3, 4, 4, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (2) | Train Loss: 0.6127 | Train Acc: 0.8435
 Site-Clipart                   (3) | Train Loss: 0.5601 | Train Acc: 0.8758
 Site-Clipart                   (3) | Train Loss: 0.6498 | Train Acc: 0.8444
 Site-Clipart                   (2) | Train Loss: 0.6112 | Train Acc: 0.8323
 Site-Clipart                   (2) | Train Loss: 0.6497 | Train Acc: 0.8394
 Site-Real                      (4) | Train Loss: 0.4670 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.3514 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.3578 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.4164 | Train Acc: 0.9425
 Site-Painting                  (5) | Train Loss: 0.5465 | Train Acc: 0.8776
 Site-Painting                  (0) | Train Loss: 0.5344 | Train Acc: 0.8932
 Site-Painting                  (0) | Train Loss: 0.5357 | Train Acc: 0.8581
 Site-Sketch                    (3) | Train Loss: 0.6120 | Train Acc: 0.8482
 Site-Sketch                    (3) | Train Loss: 0.6366 | Train Acc: 0.8052
 Site-QuickDraw                 (1) | Train Loss: 1.3522 | Train Acc: 0.5902
 Site-Infograph                 (5) | Train Loss: 1.3665 | Train Acc: 0.5299
Average Train Accuracy: 0.8364
 Site-Clipart                   (2) | Val  Loss: 0.4343 | Val  Acc: 0.8816
 Site-Clipart                   (3) | Val  Loss: 0.5743 | Val  Acc: 0.8785
 Site-Clipart                   (3) | Val  Loss: 0.6286 | Val  Acc: 0.8467
 Site-Clipart                   (2) | Val  Loss: 0.5963 | Val  Acc: 0.8286
 Site-Clipart                   (2) | Val  Loss: 0.6589 | Val  Acc: 0.8407
 Site-Real                      (4) | Val  Loss: 0.3617 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.3541 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.3835 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.4066 | Val  Acc: 0.9394
 Site-Painting                  (5) | Val  Loss: 0.4158 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.4820 | Val  Acc: 0.8613
 Site-Painting                  (0) | Val  Loss: 0.4958 | Val  Acc: 0.8854
 Site-Sketch                    (3) | Val  Loss: 0.5943 | Val  Acc: 0.8346
 Site-Sketch                    (3) | Val  Loss: 0.6813 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.3289 | Val  Acc: 0.6239
 Site-Infograph                 (5) | Val  Loss: 1.2713 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8472
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8816
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8785
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8467
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8286
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8407
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9237
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9394
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.9388
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8613
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8854
 Best site-Sketch                   (3)  | Epoch:13 | Val Acc: 0.8346
 Best site-Sketch                   (3)  | Epoch:13 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.6239
 Best site-Infograph                (5)  | Epoch:13 | Val Acc: 0.5897
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 14 ============
cnt=[5, 1, 4, 2, 2, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (0) | Train Loss: 0.5566 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.4940 | Train Acc: 0.9006
 Site-Clipart                   (0) | Train Loss: 0.5848 | Train Acc: 0.8711
 Site-Clipart                   (0) | Train Loss: 0.5694 | Train Acc: 0.8481
 Site-Clipart                   (0) | Train Loss: 0.5762 | Train Acc: 0.8575
 Site-Real                      (2) | Train Loss: 0.4174 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.3375 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.3443 | Train Acc: 0.9516
 Site-Real                      (2) | Train Loss: 0.3985 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.5237 | Train Acc: 0.8435
 Site-Painting                  (4) | Train Loss: 0.5904 | Train Acc: 0.8641
 Site-Painting                  (3) | Train Loss: 0.5316 | Train Acc: 0.8651
 Site-Sketch                    (5) | Train Loss: 0.5705 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.7147 | Train Acc: 0.8165
 Site-QuickDraw                 (1) | Train Loss: 1.1930 | Train Acc: 0.6239
 Site-Infograph                 (4) | Train Loss: 1.3651 | Train Acc: 0.5513
Average Train Accuracy: 0.8455
 Site-Clipart                   (0) | Val  Loss: 0.4332 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.5277 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.5327 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.5572 | Val  Acc: 0.8381
 Site-Clipart                   (0) | Val  Loss: 0.6230 | Val  Acc: 0.8373
 Site-Real                      (2) | Val  Loss: 0.3512 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.3577 | Val  Acc: 0.9153
 Site-Real                      (2) | Val  Loss: 0.3882 | Val  Acc: 0.9091
 Site-Real                      (2) | Val  Loss: 0.3665 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.4336 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.5056 | Val  Acc: 0.8686
 Site-Painting                  (3) | Val  Loss: 0.5368 | Val  Acc: 0.8646
 Site-Sketch                    (5) | Val  Loss: 0.6094 | Val  Acc: 0.8504
 Site-Sketch                    (5) | Val  Loss: 0.7337 | Val  Acc: 0.7584
 Site-QuickDraw                 (1) | Val  Loss: 1.2108 | Val  Acc: 0.6743
 Site-Infograph                 (4) | Val  Loss: 1.2263 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8480
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.9079
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8692
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8381
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8373
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9153
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9091
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9394
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:14 | Val Acc: 0.8686
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.8646
 Best site-Sketch                   (5)  | Epoch:14 | Val Acc: 0.8504
 Best site-Sketch                   (5)  | Epoch:14 | Val Acc: 0.7584
 Best site-QuickDraw                (1)  | Epoch:14 | Val Acc: 0.6743
 Best site-Infograph                (4)  | Epoch:14 | Val Acc: 0.6090
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 3, 3, 4, 3, 2, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (1) | Train Loss: 0.5885 | Train Acc: 0.8522
 Site-Clipart                   (3) | Train Loss: 0.4501 | Train Acc: 0.9255
 Site-Clipart                   (3) | Train Loss: 0.5969 | Train Acc: 0.8533
 Site-Clipart                   (1) | Train Loss: 0.5283 | Train Acc: 0.8734
 Site-Clipart                   (1) | Train Loss: 0.5540 | Train Acc: 0.8620
 Site-Real                      (4) | Train Loss: 0.4305 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.3252 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.3334 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.3710 | Train Acc: 0.9368
 Site-Painting                  (5) | Train Loss: 0.5154 | Train Acc: 0.8503
 Site-Painting                  (2) | Train Loss: 0.4717 | Train Acc: 0.8592
 Site-Painting                  (2) | Train Loss: 0.4999 | Train Acc: 0.8893
 Site-Sketch                    (3) | Train Loss: 0.5891 | Train Acc: 0.8429
 Site-Sketch                    (3) | Train Loss: 0.6210 | Train Acc: 0.8502
 Site-QuickDraw                 (0) | Train Loss: 1.0777 | Train Acc: 0.6667
 Site-Infograph                 (5) | Train Loss: 1.3026 | Train Acc: 0.5855
Average Train Accuracy: 0.8534
 Site-Clipart                   (1) | Val  Loss: 0.4068 | Val  Acc: 0.9079
 Site-Clipart                   (3) | Val  Loss: 0.4995 | Val  Acc: 0.8692
 Site-Clipart                   (3) | Val  Loss: 0.5224 | Val  Acc: 0.8800
 Site-Clipart                   (1) | Val  Loss: 0.5336 | Val  Acc: 0.8476
 Site-Clipart                   (1) | Val  Loss: 0.6181 | Val  Acc: 0.8102
 Site-Real                      (4) | Val  Loss: 0.3311 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.3590 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.3450 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.3445 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.4016 | Val  Acc: 0.9082
 Site-Painting                  (2) | Val  Loss: 0.4684 | Val  Acc: 0.8686
 Site-Painting                  (2) | Val  Loss: 0.5054 | Val  Acc: 0.8698
 Site-Sketch                    (3) | Val  Loss: 0.5947 | Val  Acc: 0.8268
 Site-Sketch                    (3) | Val  Loss: 0.6230 | Val  Acc: 0.8090
 Site-QuickDraw                 (0) | Val  Loss: 1.2292 | Val  Acc: 0.6651
 Site-Infograph                 (5) | Val  Loss: 1.1696 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8533
 Best site-Clipart                  (1)  | Epoch:15 | Val Acc: 0.9079
 Best site-Clipart                  (3)  | Epoch:15 | Val Acc: 0.8692
 Best site-Clipart                  (3)  | Epoch:15 | Val Acc: 0.8800
 Best site-Clipart                  (1)  | Epoch:15 | Val Acc: 0.8476
 Best site-Clipart                  (1)  | Epoch:15 | Val Acc: 0.8102
 Best site-Real                     (4)  | Epoch:15 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:15 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9273
 Best site-Real                     (4)  | Epoch:15 | Val Acc: 0.9437
 Best site-Painting                 (5)  | Epoch:15 | Val Acc: 0.9082
 Best site-Painting                 (2)  | Epoch:15 | Val Acc: 0.8686
 Best site-Painting                 (2)  | Epoch:15 | Val Acc: 0.8698
 Best site-Sketch                   (3)  | Epoch:15 | Val Acc: 0.8268
 Best site-Sketch                   (3)  | Epoch:15 | Val Acc: 0.8090
 Best site-QuickDraw                (0)  | Epoch:15 | Val Acc: 0.6651
 Best site-Infograph                (5)  | Epoch:15 | Val Acc: 0.6346
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 1, 7, 3, 1, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (2) | Train Loss: 0.5987 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.4335 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.6000 | Train Acc: 0.8533
 Site-Clipart                   (2) | Train Loss: 0.5293 | Train Acc: 0.8608
 Site-Clipart                   (2) | Train Loss: 0.5255 | Train Acc: 0.8733
 Site-Real                      (3) | Train Loss: 0.4239 | Train Acc: 0.8968
 Site-Real                      (5) | Train Loss: 0.3325 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.3193 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3729 | Train Acc: 0.9339
 Site-Painting                  (0) | Train Loss: 0.5448 | Train Acc: 0.8639
 Site-Painting                  (0) | Train Loss: 0.5573 | Train Acc: 0.8592
 Site-Painting                  (0) | Train Loss: 0.5178 | Train Acc: 0.8754
 Site-Sketch                    (2) | Train Loss: 0.5874 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.6720 | Train Acc: 0.8127
 Site-QuickDraw                 (1) | Train Loss: 1.1134 | Train Acc: 0.6881
 Site-Infograph                 (4) | Train Loss: 1.3212 | Train Acc: 0.5726
Average Train Accuracy: 0.8474
 Site-Clipart                   (2) | Val  Loss: 0.4292 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.4756 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.5343 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.5272 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.6090 | Val  Acc: 0.8271
 Site-Real                      (3) | Val  Loss: 0.3126 | Val  Acc: 0.9167
 Site-Real                      (5) | Val  Loss: 0.3050 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.3493 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3329 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3662 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.4407 | Val  Acc: 0.8978
 Site-Painting                  (0) | Val  Loss: 0.5046 | Val  Acc: 0.8646
 Site-Sketch                    (2) | Val  Loss: 0.5619 | Val  Acc: 0.8661
 Site-Sketch                    (2) | Val  Loss: 0.6495 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.1564 | Val  Acc: 0.6927
 Site-Infograph                 (4) | Val  Loss: 1.1852 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8576
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8816
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8667
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8476
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8271
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9167
 Best site-Real                     (5)  | Epoch:16 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:16 | Val Acc: 0.9184
 Best site-Painting                 (0)  | Epoch:16 | Val Acc: 0.8978
 Best site-Painting                 (0)  | Epoch:16 | Val Acc: 0.8646
 Best site-Sketch                   (2)  | Epoch:16 | Val Acc: 0.8661
 Best site-Sketch                   (2)  | Epoch:16 | Val Acc: 0.7865
 Best site-QuickDraw                (1)  | Epoch:16 | Val Acc: 0.6927
 Best site-Infograph                (4)  | Epoch:16 | Val Acc: 0.6282
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 17 ============
cnt=[4, 1, 3, 4, 2, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (4) | Train Loss: 0.4967 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.4121 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.5544 | Train Acc: 0.8489
 Site-Clipart                   (4) | Train Loss: 0.4895 | Train Acc: 0.8766
 Site-Clipart                   (2) | Train Loss: 0.5287 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.4028 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.3024 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3026 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.3384 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4947 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.4625 | Train Acc: 0.8544
 Site-Painting                  (0) | Train Loss: 0.4447 | Train Acc: 0.8962
 Site-Sketch                    (5) | Train Loss: 0.5529 | Train Acc: 0.8272
 Site-Sketch                    (5) | Train Loss: 0.5356 | Train Acc: 0.8090
 Site-QuickDraw                 (1) | Train Loss: 1.0821 | Train Acc: 0.6758
 Site-Infograph                 (0) | Train Loss: 1.2832 | Train Acc: 0.5769
Average Train Accuracy: 0.8545
 Site-Clipart                   (4) | Val  Loss: 0.3969 | Val  Acc: 0.8553
 Site-Clipart                   (2) | Val  Loss: 0.4461 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.4854 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.5271 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.6138 | Val  Acc: 0.8068
 Site-Real                      (3) | Val  Loss: 0.3057 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3365 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.3012 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.3217 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3612 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.4446 | Val  Acc: 0.8759
 Site-Painting                  (0) | Val  Loss: 0.4598 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.5529 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.6331 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 1.1605 | Val  Acc: 0.6651
 Site-Infograph                 (0) | Val  Loss: 1.2295 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8572
============ Train epoch 18 ============
cnt=[4, 1, 1, 4, 5, 1, ]
cnt=[1, 4, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (4) | Train Loss: 0.5204 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.4018 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.5703 | Train Acc: 0.8267
 Site-Clipart                   (4) | Train Loss: 0.4861 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.5083 | Train Acc: 0.8710
 Site-Real                      (3) | Train Loss: 0.3861 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2897 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2788 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3277 | Train Acc: 0.9454
 Site-Painting                  (0) | Train Loss: 0.4510 | Train Acc: 0.8912
 Site-Painting                  (0) | Train Loss: 0.4436 | Train Acc: 0.8786
 Site-Painting                  (0) | Train Loss: 0.4281 | Train Acc: 0.8893
 Site-Sketch                    (4) | Train Loss: 0.5865 | Train Acc: 0.8325
 Site-Sketch                    (5) | Train Loss: 0.4914 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 1.0142 | Train Acc: 0.7064
 Site-Infograph                 (0) | Train Loss: 1.2630 | Train Acc: 0.5897
Average Train Accuracy: 0.8572
 Site-Clipart                   (4) | Val  Loss: 0.3841 | Val  Acc: 0.8947
 Site-Clipart                   (4) | Val  Loss: 0.4377 | Val  Acc: 0.8972
 Site-Clipart                   (4) | Val  Loss: 0.5321 | Val  Acc: 0.8400
 Site-Clipart                   (4) | Val  Loss: 0.5287 | Val  Acc: 0.8238
 Site-Clipart                   (2) | Val  Loss: 0.5446 | Val  Acc: 0.8475
 Site-Real                      (3) | Val  Loss: 0.2887 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2916 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.3085 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3037 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3711 | Val  Acc: 0.8980
 Site-Painting                  (0) | Val  Loss: 0.4523 | Val  Acc: 0.8978
 Site-Painting                  (0) | Val  Loss: 0.4544 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.4733 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.6093 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.1095 | Val  Acc: 0.7018
 Site-Infograph                 (0) | Val  Loss: 1.1848 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8622
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8947
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8972
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8400
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8238
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8475
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8980
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8978
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8958
 Best site-Sketch                   (4)  | Epoch:18 | Val Acc: 0.8819
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:18 | Val Acc: 0.7018
 Best site-Infograph                (0)  | Epoch:18 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 19 ============
cnt=[1, 1, 6, 4, 3, 1, ]
cnt=[2, 3, 5, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (2) | Train Loss: 0.5182 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.4130 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.5425 | Train Acc: 0.8667
 Site-Clipart                   (5) | Train Loss: 0.4919 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.4870 | Train Acc: 0.8846
 Site-Real                      (3) | Train Loss: 0.3997 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.2638 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2917 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.3188 | Train Acc: 0.9224
 Site-Painting                  (4) | Train Loss: 0.5568 | Train Acc: 0.8639
 Site-Painting                  (4) | Train Loss: 0.5044 | Train Acc: 0.8786
 Site-Painting                  (4) | Train Loss: 0.4275 | Train Acc: 0.8858
 Site-Sketch                    (2) | Train Loss: 0.5215 | Train Acc: 0.8639
 Site-Sketch                    (2) | Train Loss: 0.5638 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 1.0519 | Train Acc: 0.7034
 Site-Infograph                 (0) | Train Loss: 1.2335 | Train Acc: 0.6111
Average Train Accuracy: 0.8585
 Site-Clipart                   (2) | Val  Loss: 0.3935 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.4480 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.4869 | Val  Acc: 0.8733
 Site-Clipart                   (5) | Val  Loss: 0.5119 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.5705 | Val  Acc: 0.8475
 Site-Real                      (3) | Val  Loss: 0.2760 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3398 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.3011 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.2871 | Val  Acc: 0.9567
 Site-Painting                  (4) | Val  Loss: 0.3559 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.4341 | Val  Acc: 0.9051
 Site-Painting                  (4) | Val  Loss: 0.4390 | Val  Acc: 0.9010
 Site-Sketch                    (2) | Val  Loss: 0.5785 | Val  Acc: 0.8346
 Site-Sketch                    (2) | Val  Loss: 0.6490 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.1067 | Val  Acc: 0.7064
 Site-Infograph                 (0) | Val  Loss: 1.1745 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8653
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8947
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8733
 Best site-Clipart                  (5)  | Epoch:19 | Val Acc: 0.8571
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8475
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9567
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.9388
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.9051
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.9010
 Best site-Sketch                   (2)  | Epoch:19 | Val Acc: 0.8346
 Best site-Sketch                   (2)  | Epoch:19 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:19 | Val Acc: 0.7064
 Best site-Infograph                (0)  | Epoch:19 | Val Acc: 0.6346
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:19 | Test Acc: 0.8574
 Test site-Real                      (3)| Epoch:19 | Test Acc: 0.9400
 Test site-Painting                  (4)| Epoch:19 | Test Acc: 0.9208
 Test site-Sketch                    (2)| Epoch:19 | Test Acc: 0.8610
 Test site-QuickDraw                 (1)| Epoch:19 | Test Acc: 0.6930
 Test site-Infograph                 (0)| Epoch:19 | Test Acc: 0.5571
Clipart: 0.8574, Real: 0.9400, Painting: 0.9208, Sketch: 0.8610, QuickDraw: 0.6930, Infograph: 0.5571, 
Average Test Accuracy(group): 0.8049, Average Test Accuracy(individual): 0.8614,
domain std=0.1363, cluster std=0.1362, individual std=0.0989, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 1, 4, 1, 3, 3, ]
cnt=[4, 5, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (4) | Train Loss: 0.4912 | Train Acc: 0.8870
 Site-Clipart                   (4) | Train Loss: 0.4426 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.5239 | Train Acc: 0.8267
 Site-Clipart                   (4) | Train Loss: 0.5046 | Train Acc: 0.8576
 Site-Clipart                   (2) | Train Loss: 0.5094 | Train Acc: 0.8801
 Site-Real                      (0) | Train Loss: 0.3714 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2606 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2874 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.3368 | Train Acc: 0.9310
 Site-Painting                  (5) | Train Loss: 0.4974 | Train Acc: 0.8912
 Site-Painting                  (5) | Train Loss: 0.4508 | Train Acc: 0.8835
 Site-Painting                  (5) | Train Loss: 0.4324 | Train Acc: 0.8893
 Site-Sketch                    (2) | Train Loss: 0.5428 | Train Acc: 0.8220
 Site-Sketch                    (2) | Train Loss: 0.6416 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 1.1046 | Train Acc: 0.7278
 Site-Infograph                 (3) | Train Loss: 1.2103 | Train Acc: 0.6026
Average Train Accuracy: 0.8608
 Site-Clipart                   (4) | Val  Loss: 0.3715 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.4763 | Val  Acc: 0.8411
 Site-Clipart                   (2) | Val  Loss: 0.5085 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4694 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.5577 | Val  Acc: 0.8475
 Site-Real                      (0) | Val  Loss: 0.2788 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.3009 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2963 | Val  Acc: 0.9152
 Site-Real                      (0) | Val  Loss: 0.3091 | Val  Acc: 0.9394
 Site-Painting                  (5) | Val  Loss: 0.3469 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.4240 | Val  Acc: 0.8905
 Site-Painting                  (5) | Val  Loss: 0.4438 | Val  Acc: 0.8854
 Site-Sketch                    (2) | Val  Loss: 0.5163 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.5799 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.0674 | Val  Acc: 0.7339
 Site-Infograph                 (3) | Val  Loss: 1.1143 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8653
============ Train epoch 21 ============
cnt=[7, 1, 3, 2, 2, 1, ]
cnt=[2, 5, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.4926 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.4373 | Train Acc: 0.9006
 Site-Clipart                   (0) | Train Loss: 0.5795 | Train Acc: 0.8578
 Site-Clipart                   (0) | Train Loss: 0.4513 | Train Acc: 0.8797
 Site-Clipart                   (0) | Train Loss: 0.4762 | Train Acc: 0.8688
 Site-Real                      (4) | Train Loss: 0.3625 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2595 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2983 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.3357 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.5420 | Train Acc: 0.8639
 Site-Painting                  (2) | Train Loss: 0.5015 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.4351 | Train Acc: 0.8927
 Site-Sketch                    (0) | Train Loss: 0.5351 | Train Acc: 0.8272
 Site-Sketch                    (0) | Train Loss: 0.5905 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 1.0030 | Train Acc: 0.6820
 Site-Infograph                 (5) | Train Loss: 1.2616 | Train Acc: 0.5855
Average Train Accuracy: 0.8546
 Site-Clipart                   (0) | Val  Loss: 0.3836 | Val  Acc: 0.8421
 Site-Clipart                   (0) | Val  Loss: 0.4087 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.4591 | Val  Acc: 0.8600
 Site-Clipart                   (0) | Val  Loss: 0.4868 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.5342 | Val  Acc: 0.8475
 Site-Real                      (4) | Val  Loss: 0.2807 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2763 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2838 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.3042 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.3401 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.4253 | Val  Acc: 0.8832
 Site-Painting                  (2) | Val  Loss: 0.4253 | Val  Acc: 0.9010
 Site-Sketch                    (0) | Val  Loss: 0.5160 | Val  Acc: 0.8740
 Site-Sketch                    (0) | Val  Loss: 0.5940 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 1.0677 | Val  Acc: 0.7018
 Site-Infograph                 (5) | Val  Loss: 1.1315 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8642
============ Train epoch 22 ============
cnt=[4, 1, 3, 4, 3, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.4919 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.3824 | Train Acc: 0.9006
 Site-Clipart                   (4) | Train Loss: 0.5499 | Train Acc: 0.8533
 Site-Clipart                   (0) | Train Loss: 0.4747 | Train Acc: 0.8608
 Site-Clipart                   (0) | Train Loss: 0.4763 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.3574 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2525 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2905 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.3267 | Train Acc: 0.9310
 Site-Painting                  (2) | Train Loss: 0.4702 | Train Acc: 0.8844
 Site-Painting                  (2) | Train Loss: 0.4652 | Train Acc: 0.8689
 Site-Painting                  (2) | Train Loss: 0.4163 | Train Acc: 0.8997
 Site-Sketch                    (4) | Train Loss: 0.4852 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.5032 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 1.0327 | Train Acc: 0.7064
 Site-Infograph                 (5) | Train Loss: 1.1952 | Train Acc: 0.6154
Average Train Accuracy: 0.8627
 Site-Clipart                   (0) | Val  Loss: 0.3287 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.4086 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.4198 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.4813 | Val  Acc: 0.8429
 Site-Clipart                   (0) | Val  Loss: 0.5361 | Val  Acc: 0.8441
 Site-Real                      (3) | Val  Loss: 0.2713 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2826 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2933 | Val  Acc: 0.9091
 Site-Real                      (3) | Val  Loss: 0.2785 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.3186 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3870 | Val  Acc: 0.8978
 Site-Painting                  (2) | Val  Loss: 0.4445 | Val  Acc: 0.8854
 Site-Sketch                    (4) | Val  Loss: 0.5158 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.5582 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 1.0358 | Val  Acc: 0.7018
 Site-Infograph                 (5) | Val  Loss: 1.0785 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8655
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8879
 Best site-Clipart                  (4)  | Epoch:22 | Val Acc: 0.8933
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8429
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8441
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9091
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9481
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9286
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.8978
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.8854
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8504
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8315
 Best site-QuickDraw                (1)  | Epoch:22 | Val Acc: 0.7018
 Best site-Infograph                (5)  | Epoch:22 | Val Acc: 0.6346
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 23 ============
cnt=[4, 1, 6, 3, 1, 1, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.4601 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.3870 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.5024 | Train Acc: 0.8444
 Site-Clipart                   (2) | Train Loss: 0.4570 | Train Acc: 0.8703
 Site-Clipart                   (2) | Train Loss: 0.5050 | Train Acc: 0.8575
 Site-Real                      (0) | Train Loss: 0.3705 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2508 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2765 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.2961 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.4638 | Train Acc: 0.8639
 Site-Painting                  (3) | Train Loss: 0.4000 | Train Acc: 0.8835
 Site-Painting                  (3) | Train Loss: 0.3652 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.5321 | Train Acc: 0.8429
 Site-Sketch                    (2) | Train Loss: 0.5847 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.9609 | Train Acc: 0.7064
 Site-Infograph                 (4) | Train Loss: 1.1979 | Train Acc: 0.5897
Average Train Accuracy: 0.8587
 Site-Clipart                   (2) | Val  Loss: 0.3125 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.3979 | Val  Acc: 0.9065
 Site-Clipart                   (2) | Val  Loss: 0.4124 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.4440 | Val  Acc: 0.8714
 Site-Clipart                   (2) | Val  Loss: 0.5383 | Val  Acc: 0.8373
 Site-Real                      (0) | Val  Loss: 0.2334 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2680 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2408 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2652 | Val  Acc: 0.9654
 Site-Painting                  (3) | Val  Loss: 0.3241 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.3774 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.4118 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.4828 | Val  Acc: 0.8504
 Site-Sketch                    (2) | Val  Loss: 0.5188 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 1.0177 | Val  Acc: 0.7523
 Site-Infograph                 (4) | Val  Loss: 1.1111 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8787
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8947
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.9065
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8800
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8714
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8373
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9576
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9654
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.9286
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.9051
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.8958
 Best site-Sketch                   (5)  | Epoch:23 | Val Acc: 0.8504
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8427
 Best site-QuickDraw                (1)  | Epoch:23 | Val Acc: 0.7523
 Best site-Infograph                (4)  | Epoch:23 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 5, 3, 4, 1, 2, ]
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (1) | Train Loss: 0.4996 | Train Acc: 0.8435
 Site-Clipart                   (1) | Train Loss: 0.3476 | Train Acc: 0.9441
 Site-Clipart                   (1) | Train Loss: 0.5227 | Train Acc: 0.8667
 Site-Clipart                   (1) | Train Loss: 0.4528 | Train Acc: 0.8671
 Site-Clipart                   (1) | Train Loss: 0.4542 | Train Acc: 0.8846
 Site-Real                      (3) | Train Loss: 0.3680 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2697 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2622 | Train Acc: 0.9597
 Site-Real                      (3) | Train Loss: 0.3121 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.5010 | Train Acc: 0.8639
 Site-Painting                  (2) | Train Loss: 0.4376 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.4042 | Train Acc: 0.8997
 Site-Sketch                    (5) | Train Loss: 0.5051 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.4751 | Train Acc: 0.8502
 Site-QuickDraw                 (0) | Train Loss: 0.8709 | Train Acc: 0.7370
 Site-Infograph                 (4) | Train Loss: 1.1402 | Train Acc: 0.6325
Average Train Accuracy: 0.8675
 Site-Clipart                   (1) | Val  Loss: 0.3415 | Val  Acc: 0.9079
 Site-Clipart                   (1) | Val  Loss: 0.4062 | Val  Acc: 0.9159
 Site-Clipart                   (1) | Val  Loss: 0.4686 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.4690 | Val  Acc: 0.8476
 Site-Clipart                   (1) | Val  Loss: 0.5218 | Val  Acc: 0.8508
 Site-Real                      (3) | Val  Loss: 0.2775 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2833 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2922 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.3005 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.3160 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3706 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.4136 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.4962 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5317 | Val  Acc: 0.8315
 Site-QuickDraw                 (0) | Val  Loss: 0.9440 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 1.0405 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8817
 Best site-Clipart                  (1)  | Epoch:24 | Val Acc: 0.9079
 Best site-Clipart                  (1)  | Epoch:24 | Val Acc: 0.9159
 Best site-Clipart                  (1)  | Epoch:24 | Val Acc: 0.8667
 Best site-Clipart                  (1)  | Epoch:24 | Val Acc: 0.8476
 Best site-Clipart                  (1)  | Epoch:24 | Val Acc: 0.8508
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 0.9394
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 0.9481
 Best site-Painting                 (2)  | Epoch:24 | Val Acc: 0.9286
 Best site-Painting                 (2)  | Epoch:24 | Val Acc: 0.9197
 Best site-Painting                 (2)  | Epoch:24 | Val Acc: 0.8906
 Best site-Sketch                   (5)  | Epoch:24 | Val Acc: 0.8661
 Best site-Sketch                   (5)  | Epoch:24 | Val Acc: 0.8315
 Best site-QuickDraw                (0)  | Epoch:24 | Val Acc: 0.7798
 Best site-Infograph                (4)  | Epoch:24 | Val Acc: 0.7051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 3, 1, 5, 4, 1, ]
cnt=[5, 3, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (3) | Train Loss: 0.4222 | Train Acc: 0.8957
 Site-Clipart                   (3) | Train Loss: 0.3260 | Train Acc: 0.9255
 Site-Clipart                   (3) | Train Loss: 0.5271 | Train Acc: 0.8667
 Site-Clipart                   (3) | Train Loss: 0.4494 | Train Acc: 0.8829
 Site-Clipart                   (3) | Train Loss: 0.4545 | Train Acc: 0.8891
 Site-Real                      (4) | Train Loss: 0.3808 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2352 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2933 | Train Acc: 0.9355
 Site-Real                      (4) | Train Loss: 0.3228 | Train Acc: 0.9310
 Site-Painting                  (1) | Train Loss: 0.4532 | Train Acc: 0.8844
 Site-Painting                  (1) | Train Loss: 0.5065 | Train Acc: 0.8835
 Site-Painting                  (1) | Train Loss: 0.4228 | Train Acc: 0.9066
 Site-Sketch                    (0) | Train Loss: 0.4788 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.5583 | Train Acc: 0.8577
 Site-QuickDraw                 (2) | Train Loss: 0.8661 | Train Acc: 0.7401
 Site-Infograph                 (5) | Train Loss: 1.1247 | Train Acc: 0.6197
Average Train Accuracy: 0.8714
 Site-Clipart                   (3) | Val  Loss: 0.3547 | Val  Acc: 0.8816
 Site-Clipart                   (3) | Val  Loss: 0.4063 | Val  Acc: 0.8972
 Site-Clipart                   (3) | Val  Loss: 0.4229 | Val  Acc: 0.8933
 Site-Clipart                   (3) | Val  Loss: 0.4473 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.5230 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2709 | Val  Acc: 0.9167
 Site-Real                      (4) | Val  Loss: 0.2782 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2818 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2989 | Val  Acc: 0.9481
 Site-Painting                  (1) | Val  Loss: 0.3052 | Val  Acc: 0.9490
 Site-Painting                  (1) | Val  Loss: 0.3893 | Val  Acc: 0.9051
 Site-Painting                  (1) | Val  Loss: 0.4089 | Val  Acc: 0.8906
 Site-Sketch                    (0) | Val  Loss: 0.4629 | Val  Acc: 0.8740
 Site-Sketch                    (0) | Val  Loss: 0.5478 | Val  Acc: 0.8427
 Site-QuickDraw                 (2) | Val  Loss: 0.9755 | Val  Acc: 0.7202
 Site-Infograph                 (5) | Val  Loss: 1.0805 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8756
============ Train epoch 26 ============
cnt=[3, 1, 6, 4, 1, 1, ]
cnt=[3, 5, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (2) | Train Loss: 0.4626 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.3695 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.4526 | Train Acc: 0.8667
 Site-Clipart                   (2) | Train Loss: 0.4289 | Train Acc: 0.8766
 Site-Clipart                   (2) | Train Loss: 0.4500 | Train Acc: 0.8778
 Site-Real                      (3) | Train Loss: 0.3495 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.2454 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2639 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3122 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4263 | Train Acc: 0.8776
 Site-Painting                  (0) | Train Loss: 0.4139 | Train Acc: 0.8738
 Site-Painting                  (0) | Train Loss: 0.4103 | Train Acc: 0.9100
 Site-Sketch                    (5) | Train Loss: 0.4723 | Train Acc: 0.8377
 Site-Sketch                    (2) | Train Loss: 0.4751 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.8578 | Train Acc: 0.7309
 Site-Infograph                 (4) | Train Loss: 1.1099 | Train Acc: 0.6239
Average Train Accuracy: 0.8659
 Site-Clipart                   (2) | Val  Loss: 0.3144 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3847 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.4188 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.4132 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.4980 | Val  Acc: 0.8678
 Site-Real                      (3) | Val  Loss: 0.2723 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2680 | Val  Acc: 0.9661
 Site-Real                      (3) | Val  Loss: 0.2576 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2670 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.3079 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.3492 | Val  Acc: 0.8978
 Site-Painting                  (0) | Val  Loss: 0.4184 | Val  Acc: 0.9115
 Site-Sketch                    (5) | Val  Loss: 0.4499 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.5663 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 0.9636 | Val  Acc: 0.7202
 Site-Infograph                 (4) | Val  Loss: 1.0989 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8778
============ Train epoch 27 ============
cnt=[4, 1, 3, 3, 4, 1, ]
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (4) | Train Loss: 0.4434 | Train Acc: 0.8957
 Site-Clipart                   (2) | Train Loss: 0.3581 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.4884 | Train Acc: 0.8978
 Site-Clipart                   (4) | Train Loss: 0.4262 | Train Acc: 0.8703
 Site-Clipart                   (4) | Train Loss: 0.4455 | Train Acc: 0.8801
 Site-Real                      (0) | Train Loss: 0.3205 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2344 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2555 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.3003 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.4746 | Train Acc: 0.8707
 Site-Painting                  (3) | Train Loss: 0.4337 | Train Acc: 0.8932
 Site-Painting                  (3) | Train Loss: 0.3496 | Train Acc: 0.9273
 Site-Sketch                    (2) | Train Loss: 0.4639 | Train Acc: 0.8796
 Site-Sketch                    (2) | Train Loss: 0.5032 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.8730 | Train Acc: 0.7248
 Site-Infograph                 (5) | Train Loss: 1.1243 | Train Acc: 0.6154
Average Train Accuracy: 0.8740
 Site-Clipart                   (4) | Val  Loss: 0.2989 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3653 | Val  Acc: 0.9252
 Site-Clipart                   (4) | Val  Loss: 0.4225 | Val  Acc: 0.8600
 Site-Clipart                   (4) | Val  Loss: 0.4546 | Val  Acc: 0.8381
 Site-Clipart                   (4) | Val  Loss: 0.5140 | Val  Acc: 0.8475
 Site-Real                      (0) | Val  Loss: 0.2441 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2957 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2965 | Val  Acc: 0.9152
 Site-Real                      (0) | Val  Loss: 0.2723 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.3062 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.3449 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3652 | Val  Acc: 0.9062
 Site-Sketch                    (2) | Val  Loss: 0.5126 | Val  Acc: 0.8425
 Site-Sketch                    (2) | Val  Loss: 0.5898 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.9568 | Val  Acc: 0.7339
 Site-Infograph                 (5) | Val  Loss: 1.0895 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8697
============ Train epoch 28 ============
cnt=[4, 1, 4, 1, 3, 3, ]
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (0) | Train Loss: 0.3868 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.3518 | Train Acc: 0.9379
 Site-Clipart                   (5) | Train Loss: 0.4634 | Train Acc: 0.8711
 Site-Clipart                   (0) | Train Loss: 0.4243 | Train Acc: 0.8766
 Site-Clipart                   (0) | Train Loss: 0.4117 | Train Acc: 0.9005
 Site-Real                      (4) | Train Loss: 0.3508 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2319 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2607 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2698 | Train Acc: 0.9569
 Site-Painting                  (2) | Train Loss: 0.4650 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.4526 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.3803 | Train Acc: 0.9135
 Site-Sketch                    (5) | Train Loss: 0.4784 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.4688 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.8227 | Train Acc: 0.7309
 Site-Infograph                 (3) | Train Loss: 1.0878 | Train Acc: 0.6239
Average Train Accuracy: 0.8731
 Site-Clipart                   (0) | Val  Loss: 0.2487 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.3590 | Val  Acc: 0.9065
 Site-Clipart                   (5) | Val  Loss: 0.4276 | Val  Acc: 0.8467
 Site-Clipart                   (0) | Val  Loss: 0.4391 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.4936 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.2542 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2254 | Val  Acc: 0.9661
 Site-Real                      (4) | Val  Loss: 0.2532 | Val  Acc: 0.9212
 Site-Real                      (2) | Val  Loss: 0.2632 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.2937 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3517 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.4182 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.4514 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5775 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 0.9501 | Val  Acc: 0.7615
 Site-Infograph                 (3) | Val  Loss: 1.0661 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8771
============ Train epoch 29 ============
cnt=[1, 1, 7, 3, 2, 2, ]
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (2) | Train Loss: 0.4374 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.3906 | Train Acc: 0.8820
 Site-Clipart                   (2) | Train Loss: 0.4764 | Train Acc: 0.8711
 Site-Clipart                   (2) | Train Loss: 0.4191 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.4099 | Train Acc: 0.9005
 Site-Real                      (5) | Train Loss: 0.3318 | Train Acc: 0.9127
 Site-Real                      (5) | Train Loss: 0.2425 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2354 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2701 | Train Acc: 0.9425
 Site-Painting                  (3) | Train Loss: 0.3573 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.4262 | Train Acc: 0.8738
 Site-Painting                  (3) | Train Loss: 0.3626 | Train Acc: 0.9273
 Site-Sketch                    (2) | Train Loss: 0.4822 | Train Acc: 0.8639
 Site-Sketch                    (2) | Train Loss: 0.4771 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.8429 | Train Acc: 0.7492
 Site-Infograph                 (0) | Train Loss: 1.0324 | Train Acc: 0.6538
Average Train Accuracy: 0.8724
 Site-Clipart                   (2) | Val  Loss: 0.2823 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3518 | Val  Acc: 0.9439
 Site-Clipart                   (2) | Val  Loss: 0.4153 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.4376 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.5011 | Val  Acc: 0.8441
 Site-Real                      (5) | Val  Loss: 0.2580 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.2712 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.2643 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.2450 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.3169 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.2880 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.3579 | Val  Acc: 0.9010
 Site-Sketch                    (2) | Val  Loss: 0.4872 | Val  Acc: 0.8661
 Site-Sketch                    (2) | Val  Loss: 0.5492 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.9177 | Val  Acc: 0.7248
 Site-Infograph                 (0) | Val  Loss: 1.0324 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8726
 Test site-Clipart                   (2)| Epoch:24 | Test Acc: 0.8650
 Test site-Real                      (5)| Epoch:24 | Test Acc: 0.9433
 Test site-Painting                  (3)| Epoch:24 | Test Acc: 0.9192
 Test site-Sketch                    (2)| Epoch:24 | Test Acc: 0.8646
 Test site-QuickDraw                 (1)| Epoch:24 | Test Acc: 0.7330
 Test site-Infograph                 (0)| Epoch:24 | Test Acc: 0.5738
Clipart: 0.8650, Real: 0.9433, Painting: 0.9192, Sketch: 0.8646, QuickDraw: 0.7330, Infograph: 0.5738, 
Average Test Accuracy(group): 0.8165, Average Test Accuracy(individual): 0.8683,
domain std=0.1273, cluster std=0.1353, individual std=0.0920, 
============ Train epoch 30 ============
cnt=[5, 1, 3, 4, 1, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (0) | Train Loss: 0.4422 | Train Acc: 0.8783
 Site-Clipart                   (0) | Train Loss: 0.3247 | Train Acc: 0.9255
 Site-Clipart                   (0) | Train Loss: 0.4609 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.4028 | Train Acc: 0.8829
 Site-Clipart                   (0) | Train Loss: 0.4275 | Train Acc: 0.8891
 Site-Real                      (3) | Train Loss: 0.3365 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2336 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2530 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.2887 | Train Acc: 0.9339
 Site-Painting                  (2) | Train Loss: 0.3567 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3709 | Train Acc: 0.8981
 Site-Painting                  (2) | Train Loss: 0.3679 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.4586 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.5507 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.8944 | Train Acc: 0.7584
 Site-Infograph                 (4) | Train Loss: 1.0729 | Train Acc: 0.6709
Average Train Accuracy: 0.8772
 Site-Clipart                   (0) | Val  Loss: 0.2780 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3419 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.3939 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4128 | Val  Acc: 0.8476
 Site-Clipart                   (0) | Val  Loss: 0.4903 | Val  Acc: 0.8712
 Site-Real                      (3) | Val  Loss: 0.2538 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2373 | Val  Acc: 0.9661
 Site-Real                      (3) | Val  Loss: 0.2157 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2577 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2993 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3479 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.3978 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.4947 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5559 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.9218 | Val  Acc: 0.7615
 Site-Infograph                 (4) | Val  Loss: 1.0829 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8782
============ Train epoch 31 ============
cnt=[4, 1, 4, 1, 3, 3, ]
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (5) | Train Loss: 0.4043 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.2999 | Train Acc: 0.9317
 Site-Clipart                   (2) | Train Loss: 0.5162 | Train Acc: 0.8533
 Site-Clipart                   (5) | Train Loss: 0.4407 | Train Acc: 0.8703
 Site-Clipart                   (5) | Train Loss: 0.4088 | Train Acc: 0.8959
 Site-Real                      (0) | Train Loss: 0.3446 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2398 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2373 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2921 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.4443 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.3382 | Train Acc: 0.9223
 Site-Painting                  (4) | Train Loss: 0.3792 | Train Acc: 0.9066
 Site-Sketch                    (2) | Train Loss: 0.4917 | Train Acc: 0.8534
 Site-Sketch                    (2) | Train Loss: 0.5168 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.7550 | Train Acc: 0.7737
 Site-Infograph                 (3) | Train Loss: 1.0845 | Train Acc: 0.6410
Average Train Accuracy: 0.8746
 Site-Clipart                   (5) | Val  Loss: 0.2923 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.3595 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.3989 | Val  Acc: 0.8933
 Site-Clipart                   (5) | Val  Loss: 0.4008 | Val  Acc: 0.8571
 Site-Clipart                   (5) | Val  Loss: 0.4849 | Val  Acc: 0.8475
 Site-Real                      (0) | Val  Loss: 0.2535 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2553 | Val  Acc: 0.9661
 Site-Real                      (0) | Val  Loss: 0.2379 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2667 | Val  Acc: 0.9437
 Site-Painting                  (4) | Val  Loss: 0.2920 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.3565 | Val  Acc: 0.9051
 Site-Painting                  (4) | Val  Loss: 0.3736 | Val  Acc: 0.8958
 Site-Sketch                    (2) | Val  Loss: 0.4571 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.5067 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.8837 | Val  Acc: 0.7523
 Site-Infograph                 (3) | Val  Loss: 0.9916 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8788
============ Train epoch 32 ============
cnt=[1, 5, 3, 1, 4, 2, ]
cnt=[1, 5, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (1) | Train Loss: 0.4683 | Train Acc: 0.8609
 Site-Clipart                   (1) | Train Loss: 0.3137 | Train Acc: 0.9441
 Site-Clipart                   (1) | Train Loss: 0.5033 | Train Acc: 0.8622
 Site-Clipart                   (1) | Train Loss: 0.4111 | Train Acc: 0.8892
 Site-Clipart                   (1) | Train Loss: 0.3964 | Train Acc: 0.9072
 Site-Real                      (4) | Train Loss: 0.3297 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2339 | Train Acc: 0.9379
 Site-Real                      (4) | Train Loss: 0.2458 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2854 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.3519 | Train Acc: 0.8912
 Site-Painting                  (2) | Train Loss: 0.3853 | Train Acc: 0.9126
 Site-Painting                  (2) | Train Loss: 0.3493 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.4325 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.4933 | Train Acc: 0.8464
 Site-QuickDraw                 (0) | Train Loss: 0.8447 | Train Acc: 0.7584
 Site-Infograph                 (3) | Train Loss: 1.0118 | Train Acc: 0.6752
Average Train Accuracy: 0.8780
 Site-Clipart                   (1) | Val  Loss: 0.2601 | Val  Acc: 0.9474
 Site-Clipart                   (1) | Val  Loss: 0.3628 | Val  Acc: 0.9252
 Site-Clipart                   (1) | Val  Loss: 0.3701 | Val  Acc: 0.8800
 Site-Clipart                   (1) | Val  Loss: 0.4234 | Val  Acc: 0.8524
 Site-Clipart                   (1) | Val  Loss: 0.4808 | Val  Acc: 0.8644
 Site-Real                      (4) | Val  Loss: 0.2322 | Val  Acc: 0.9643
 Site-Real                      (4) | Val  Loss: 0.2509 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2585 | Val  Acc: 0.9152
 Site-Real                      (4) | Val  Loss: 0.2576 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.2183 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.3886 | Val  Acc: 0.8832
 Site-Painting                  (2) | Val  Loss: 0.3598 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.4456 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5354 | Val  Acc: 0.8258
 Site-QuickDraw                 (0) | Val  Loss: 0.8946 | Val  Acc: 0.7523
 Site-Infograph                 (3) | Val  Loss: 0.9856 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8831
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.9474
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.9252
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.8800
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.8524
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.8644
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9643
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9576
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9152
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9437
 Best site-Painting                 (2)  | Epoch:32 | Val Acc: 0.9592
 Best site-Painting                 (2)  | Epoch:32 | Val Acc: 0.8832
 Best site-Painting                 (2)  | Epoch:32 | Val Acc: 0.9219
 Best site-Sketch                   (5)  | Epoch:32 | Val Acc: 0.8583
 Best site-Sketch                   (5)  | Epoch:32 | Val Acc: 0.8258
 Best site-QuickDraw                (0)  | Epoch:32 | Val Acc: 0.7523
 Best site-Infograph                (3)  | Epoch:32 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 1, 4, 1, 5, 3, ]
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (4) | Train Loss: 0.4249 | Train Acc: 0.8870
 Site-Clipart                   (4) | Train Loss: 0.3006 | Train Acc: 0.9379
 Site-Clipart                   (4) | Train Loss: 0.4188 | Train Acc: 0.8711
 Site-Clipart                   (4) | Train Loss: 0.3870 | Train Acc: 0.8766
 Site-Clipart                   (4) | Train Loss: 0.3946 | Train Acc: 0.9072
 Site-Real                      (2) | Train Loss: 0.3613 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.2155 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.2523 | Train Acc: 0.9355
 Site-Real                      (2) | Train Loss: 0.2829 | Train Acc: 0.9397
 Site-Painting                  (5) | Train Loss: 0.4056 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.3898 | Train Acc: 0.8786
 Site-Painting                  (5) | Train Loss: 0.3241 | Train Acc: 0.9239
 Site-Sketch                    (0) | Train Loss: 0.4572 | Train Acc: 0.8743
 Site-Sketch                    (0) | Train Loss: 0.4302 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.8343 | Train Acc: 0.7462
 Site-Infograph                 (3) | Train Loss: 1.0447 | Train Acc: 0.6795
Average Train Accuracy: 0.8792
 Site-Clipart                   (4) | Val  Loss: 0.3063 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.3527 | Val  Acc: 0.9065
 Site-Clipart                   (4) | Val  Loss: 0.3657 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.3964 | Val  Acc: 0.8810
 Site-Clipart                   (4) | Val  Loss: 0.4973 | Val  Acc: 0.8542
 Site-Real                      (2) | Val  Loss: 0.2247 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2214 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2531 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2379 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2233 | Val  Acc: 0.9694
 Site-Painting                  (5) | Val  Loss: 0.3050 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.3235 | Val  Acc: 0.9167
 Site-Sketch                    (0) | Val  Loss: 0.4719 | Val  Acc: 0.8740
 Site-Sketch                    (0) | Val  Loss: 0.5260 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.8648 | Val  Acc: 0.7477
 Site-Infograph                 (3) | Val  Loss: 1.0607 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8846
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.9211
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.9065
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.8867
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.8810
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.8542
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9333
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9524
 Best site-Painting                 (5)  | Epoch:33 | Val Acc: 0.9694
 Best site-Painting                 (5)  | Epoch:33 | Val Acc: 0.9051
 Best site-Painting                 (5)  | Epoch:33 | Val Acc: 0.9167
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.8740
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.8258
 Best site-QuickDraw                (1)  | Epoch:33 | Val Acc: 0.7477
 Best site-Infograph                (3)  | Epoch:33 | Val Acc: 0.6859
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 4, 5, 1, 2, 3, ]
cnt=[5, 4, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (2) | Train Loss: 0.3772 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.3154 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.3983 | Train Acc: 0.8844
 Site-Clipart                   (2) | Train Loss: 0.3836 | Train Acc: 0.8956
 Site-Clipart                   (2) | Train Loss: 0.4138 | Train Acc: 0.8891
 Site-Real                      (1) | Train Loss: 0.3494 | Train Acc: 0.9206
 Site-Real                      (1) | Train Loss: 0.2192 | Train Acc: 0.9605
 Site-Real                      (1) | Train Loss: 0.2195 | Train Acc: 0.9556
 Site-Real                      (1) | Train Loss: 0.3081 | Train Acc: 0.9368
 Site-Painting                  (5) | Train Loss: 0.4648 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.4397 | Train Acc: 0.8932
 Site-Painting                  (5) | Train Loss: 0.3463 | Train Acc: 0.9066
 Site-Sketch                    (4) | Train Loss: 0.5095 | Train Acc: 0.8429
 Site-Sketch                    (4) | Train Loss: 0.4681 | Train Acc: 0.8464
 Site-QuickDraw                 (0) | Train Loss: 0.8582 | Train Acc: 0.7706
 Site-Infograph                 (3) | Train Loss: 0.9954 | Train Acc: 0.6709
Average Train Accuracy: 0.8785
 Site-Clipart                   (2) | Val  Loss: 0.2756 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.2982 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.3692 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.3948 | Val  Acc: 0.8429
 Site-Clipart                   (2) | Val  Loss: 0.4711 | Val  Acc: 0.8542
 Site-Real                      (1) | Val  Loss: 0.2326 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2410 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.2429 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.2694 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2699 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.2709 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.3430 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.4165 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.5064 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 0.8700 | Val  Acc: 0.7477
 Site-Infograph                 (3) | Val  Loss: 0.9893 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8783
============ Train epoch 35 ============
cnt=[4, 1, 1, 5, 3, 2, ]
cnt=[1, 5, 3, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (3) | Train Loss: 0.3987 | Train Acc: 0.8870
 Site-Clipart                   (3) | Train Loss: 0.2866 | Train Acc: 0.9255
 Site-Clipart                   (3) | Train Loss: 0.4487 | Train Acc: 0.8844
 Site-Clipart                   (3) | Train Loss: 0.4206 | Train Acc: 0.8671
 Site-Clipart                   (3) | Train Loss: 0.4019 | Train Acc: 0.9072
 Site-Real                      (0) | Train Loss: 0.3043 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2198 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2227 | Train Acc: 0.9556
 Site-Real                      (0) | Train Loss: 0.2928 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.4002 | Train Acc: 0.8844
 Site-Painting                  (4) | Train Loss: 0.3754 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.3374 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.4431 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.4534 | Train Acc: 0.8727
 Site-QuickDraw                 (1) | Train Loss: 0.8472 | Train Acc: 0.7890
 Site-Infograph                 (2) | Train Loss: 0.9689 | Train Acc: 0.6795
Average Train Accuracy: 0.8829
 Site-Clipart                   (3) | Val  Loss: 0.2879 | Val  Acc: 0.9079
 Site-Clipart                   (3) | Val  Loss: 0.3680 | Val  Acc: 0.9065
 Site-Clipart                   (3) | Val  Loss: 0.3570 | Val  Acc: 0.8867
 Site-Clipart                   (3) | Val  Loss: 0.4271 | Val  Acc: 0.8810
 Site-Clipart                   (3) | Val  Loss: 0.4708 | Val  Acc: 0.8542
 Site-Real                      (0) | Val  Loss: 0.2298 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2453 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2276 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2504 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2276 | Val  Acc: 0.9592
 Site-Painting                  (4) | Val  Loss: 0.2867 | Val  Acc: 0.9124
 Site-Painting                  (4) | Val  Loss: 0.3635 | Val  Acc: 0.9115
 Site-Sketch                    (5) | Val  Loss: 0.3783 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.4926 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.8434 | Val  Acc: 0.7569
 Site-Infograph                 (2) | Val  Loss: 0.9976 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8877
 Best site-Clipart                  (3)  | Epoch:35 | Val Acc: 0.9079
 Best site-Clipart                  (3)  | Epoch:35 | Val Acc: 0.9065
 Best site-Clipart                  (3)  | Epoch:35 | Val Acc: 0.8867
 Best site-Clipart                  (3)  | Epoch:35 | Val Acc: 0.8810
 Best site-Clipart                  (3)  | Epoch:35 | Val Acc: 0.8542
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9455
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:35 | Val Acc: 0.9592
 Best site-Painting                 (4)  | Epoch:35 | Val Acc: 0.9124
 Best site-Painting                 (4)  | Epoch:35 | Val Acc: 0.9115
 Best site-Sketch                   (5)  | Epoch:35 | Val Acc: 0.8819
 Best site-Sketch                   (5)  | Epoch:35 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.7569
 Best site-Infograph                (2)  | Epoch:35 | Val Acc: 0.7179
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 36 ============
cnt=[3, 1, 2, 1, 4, 5, ]
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (5) | Train Loss: 0.3738 | Train Acc: 0.8609
 Site-Clipart                   (5) | Train Loss: 0.3007 | Train Acc: 0.9255
 Site-Clipart                   (5) | Train Loss: 0.4607 | Train Acc: 0.8933
 Site-Clipart                   (5) | Train Loss: 0.4038 | Train Acc: 0.8639
 Site-Clipart                   (5) | Train Loss: 0.3801 | Train Acc: 0.9118
 Site-Real                      (4) | Train Loss: 0.3243 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.2300 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2132 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2591 | Train Acc: 0.9454
 Site-Painting                  (0) | Train Loss: 0.3804 | Train Acc: 0.8980
 Site-Painting                  (0) | Train Loss: 0.3896 | Train Acc: 0.9029
 Site-Painting                  (0) | Train Loss: 0.3175 | Train Acc: 0.9204
 Site-Sketch                    (2) | Train Loss: 0.4590 | Train Acc: 0.8482
 Site-Sketch                    (2) | Train Loss: 0.5347 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.8296 | Train Acc: 0.7706
 Site-Infograph                 (3) | Train Loss: 0.9714 | Train Acc: 0.6923
Average Train Accuracy: 0.8825
 Site-Clipart                   (5) | Val  Loss: 0.2730 | Val  Acc: 0.9342
 Site-Clipart                   (5) | Val  Loss: 0.3254 | Val  Acc: 0.9252
 Site-Clipart                   (5) | Val  Loss: 0.3670 | Val  Acc: 0.9067
 Site-Clipart                   (5) | Val  Loss: 0.4106 | Val  Acc: 0.8429
 Site-Clipart                   (5) | Val  Loss: 0.4209 | Val  Acc: 0.8881
 Site-Real                      (4) | Val  Loss: 0.2309 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2258 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2616 | Val  Acc: 0.9152
 Site-Real                      (4) | Val  Loss: 0.2507 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.2633 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.2820 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3500 | Val  Acc: 0.9271
 Site-Sketch                    (2) | Val  Loss: 0.4183 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.5295 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.8490 | Val  Acc: 0.7615
 Site-Infograph                 (3) | Val  Loss: 0.9981 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8873
============ Train epoch 37 ============
cnt=[2, 1, 3, 1, 5, 4, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (4) | Train Loss: 0.4212 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.3244 | Train Acc: 0.9006
 Site-Clipart                   (4) | Train Loss: 0.4071 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.3693 | Train Acc: 0.8924
 Site-Clipart                   (4) | Train Loss: 0.3871 | Train Acc: 0.8846
 Site-Real                      (5) | Train Loss: 0.3008 | Train Acc: 0.9127
 Site-Real                      (5) | Train Loss: 0.1865 | Train Acc: 0.9605
 Site-Real                      (5) | Train Loss: 0.2295 | Train Acc: 0.9355
 Site-Real                      (5) | Train Loss: 0.2719 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.4282 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.4037 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.3246 | Train Acc: 0.9308
 Site-Sketch                    (0) | Train Loss: 0.4301 | Train Acc: 0.8691
 Site-Sketch                    (0) | Train Loss: 0.4135 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.7630 | Train Acc: 0.7798
 Site-Infograph                 (3) | Train Loss: 0.9520 | Train Acc: 0.7137
Average Train Accuracy: 0.8827
 Site-Clipart                   (4) | Val  Loss: 0.2828 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.3236 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.3872 | Val  Acc: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.3732 | Val  Acc: 0.8762
 Site-Clipart                   (4) | Val  Loss: 0.4336 | Val  Acc: 0.8746
 Site-Real                      (5) | Val  Loss: 0.2107 | Val  Acc: 0.9643
 Site-Real                      (5) | Val  Loss: 0.2438 | Val  Acc: 0.9322
 Site-Real                      (5) | Val  Loss: 0.2739 | Val  Acc: 0.9152
 Site-Real                      (5) | Val  Loss: 0.2207 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2151 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.2663 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.3437 | Val  Acc: 0.9219
 Site-Sketch                    (0) | Val  Loss: 0.3834 | Val  Acc: 0.9055
 Site-Sketch                    (0) | Val  Loss: 0.5134 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.8309 | Val  Acc: 0.7339
 Site-Infograph                 (3) | Val  Loss: 1.0100 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8861
============ Train epoch 38 ============
cnt=[3, 1, 5, 1, 4, 2, ]
cnt=[5, 1, 4, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (2) | Train Loss: 0.3555 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.3061 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.4328 | Train Acc: 0.8800
 Site-Clipart                   (2) | Train Loss: 0.3954 | Train Acc: 0.8703
 Site-Clipart                   (2) | Train Loss: 0.3668 | Train Acc: 0.9163
 Site-Real                      (4) | Train Loss: 0.3403 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2178 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2180 | Train Acc: 0.9556
 Site-Real                      (4) | Train Loss: 0.2823 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.4342 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.3174 | Train Acc: 0.8883
 Site-Painting                  (0) | Train Loss: 0.3225 | Train Acc: 0.9308
 Site-Sketch                    (5) | Train Loss: 0.4019 | Train Acc: 0.9005
 Site-Sketch                    (5) | Train Loss: 0.4478 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.7362 | Train Acc: 0.7706
 Site-Infograph                 (3) | Train Loss: 0.9536 | Train Acc: 0.6966
Average Train Accuracy: 0.8834
 Site-Clipart                   (2) | Val  Loss: 0.2617 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.3393 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.3254 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.3636 | Val  Acc: 0.8714
 Site-Clipart                   (2) | Val  Loss: 0.4667 | Val  Acc: 0.8678
 Site-Real                      (4) | Val  Loss: 0.2207 | Val  Acc: 0.9643
 Site-Real                      (4) | Val  Loss: 0.2079 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2075 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2302 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.2383 | Val  Acc: 0.9694
 Site-Painting                  (0) | Val  Loss: 0.3081 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3436 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.4428 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5290 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 0.7776 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 1.0797 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8868
============ Train epoch 39 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (0) | Train Loss: 0.3734 | Train Acc: 0.8957
 Site-Clipart                   (0) | Train Loss: 0.2826 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.4206 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.4068 | Train Acc: 0.8797
 Site-Clipart                   (0) | Train Loss: 0.3603 | Train Acc: 0.9140
 Site-Real                      (4) | Train Loss: 0.3202 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2213 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2346 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2873 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.3889 | Train Acc: 0.8912
 Site-Painting                  (2) | Train Loss: 0.3278 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.3211 | Train Acc: 0.9308
 Site-Sketch                    (5) | Train Loss: 0.4261 | Train Acc: 0.8639
 Site-Sketch                    (5) | Train Loss: 0.5406 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.7590 | Train Acc: 0.8104
 Site-Infograph                 (3) | Train Loss: 0.9066 | Train Acc: 0.7265
Average Train Accuracy: 0.8876
 Site-Clipart                   (0) | Val  Loss: 0.2314 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3544 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.3467 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.3794 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.4280 | Val  Acc: 0.8915
 Site-Real                      (4) | Val  Loss: 0.2072 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2310 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.2004 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2372 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.2397 | Val  Acc: 0.9694
 Site-Painting                  (2) | Val  Loss: 0.2701 | Val  Acc: 0.9416
 Site-Painting                  (2) | Val  Loss: 0.3199 | Val  Acc: 0.9115
 Site-Sketch                    (5) | Val  Loss: 0.4253 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.4795 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.8149 | Val  Acc: 0.7890
 Site-Infograph                 (3) | Val  Loss: 0.9961 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8903
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.9342
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.9065
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8800
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8762
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8915
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9322
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9455
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9437
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9694
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9416
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9115
 Best site-Sketch                   (5)  | Epoch:39 | Val Acc: 0.8661
 Best site-Sketch                   (5)  | Epoch:39 | Val Acc: 0.8315
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.7890
 Best site-Infograph                (3)  | Epoch:39 | Val Acc: 0.6859
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Test site-Clipart                   (0)| Epoch:39 | Test Acc: 0.8878
 Test site-Real                      (4)| Epoch:39 | Test Acc: 0.9400
 Test site-Painting                  (2)| Epoch:39 | Test Acc: 0.9241
 Test site-Sketch                    (5)| Epoch:39 | Test Acc: 0.8628
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7390
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5647
Clipart: 0.8878, Real: 0.9400, Painting: 0.9241, Sketch: 0.8628, QuickDraw: 0.7390, Infograph: 0.5647, 
Average Test Accuracy(group): 0.8197, Average Test Accuracy(individual): 0.8750,
domain std=0.1313, cluster std=0.1313, individual std=0.0936, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 1, 4, 1, 5, 3, ]
cnt=[2, 4, 5, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (4) | Train Loss: 0.3805 | Train Acc: 0.8957
 Site-Clipart                   (4) | Train Loss: 0.2690 | Train Acc: 0.9379
 Site-Clipart                   (4) | Train Loss: 0.4203 | Train Acc: 0.8578
 Site-Clipart                   (4) | Train Loss: 0.3832 | Train Acc: 0.8734
 Site-Clipart                   (4) | Train Loss: 0.3843 | Train Acc: 0.9072
 Site-Real                      (2) | Train Loss: 0.2987 | Train Acc: 0.9286
 Site-Real                      (2) | Train Loss: 0.2077 | Train Acc: 0.9379
 Site-Real                      (2) | Train Loss: 0.2286 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.2577 | Train Acc: 0.9511
 Site-Painting                  (5) | Train Loss: 0.4321 | Train Acc: 0.8844
 Site-Painting                  (5) | Train Loss: 0.3747 | Train Acc: 0.9078
 Site-Painting                  (5) | Train Loss: 0.3263 | Train Acc: 0.9170
 Site-Sketch                    (0) | Train Loss: 0.4225 | Train Acc: 0.8534
 Site-Sketch                    (0) | Train Loss: 0.3888 | Train Acc: 0.8727
 Site-QuickDraw                 (1) | Train Loss: 0.7844 | Train Acc: 0.7737
 Site-Infograph                 (3) | Train Loss: 0.9315 | Train Acc: 0.6923
Average Train Accuracy: 0.8831
 Site-Clipart                   (4) | Val  Loss: 0.2604 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.3250 | Val  Acc: 0.9252
 Site-Clipart                   (4) | Val  Loss: 0.3488 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.3704 | Val  Acc: 0.8810
 Site-Clipart                   (4) | Val  Loss: 0.4030 | Val  Acc: 0.8915
 Site-Real                      (2) | Val  Loss: 0.2100 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.2254 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.2420 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2215 | Val  Acc: 0.9481
 Site-Painting                  (5) | Val  Loss: 0.2189 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.2926 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.3158 | Val  Acc: 0.9323
 Site-Sketch                    (0) | Val  Loss: 0.4086 | Val  Acc: 0.8504
 Site-Sketch                    (0) | Val  Loss: 0.4868 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.8325 | Val  Acc: 0.7706
 Site-Infograph                 (3) | Val  Loss: 0.9855 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8862
 Test site-Clipart                   (4)| Epoch:39 | Test Acc: 0.8859
 Test site-Real                      (2)| Epoch:39 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:39 | Test Acc: 0.9208
 Test site-Sketch                    (0)| Epoch:39 | Test Acc: 0.8809
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7470
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5693
Clipart: 0.8859, Real: 0.9441, Painting: 0.9208, Sketch: 0.8809, QuickDraw: 0.7470, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8247, Average Test Accuracy(individual): 0.8779,
domain std=0.1302, cluster std=0.1302, individual std=0.0921, 
Average Test Accuracy: 0.8247
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 41 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[5, 4, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (0) | Train Loss: 0.3735 | Train Acc: 0.8957
 Site-Clipart                   (0) | Train Loss: 0.2909 | Train Acc: 0.9255
 Site-Clipart                   (0) | Train Loss: 0.3673 | Train Acc: 0.8978
 Site-Clipart                   (0) | Train Loss: 0.3608 | Train Acc: 0.8829
 Site-Clipart                   (0) | Train Loss: 0.3428 | Train Acc: 0.9253
 Site-Real                      (4) | Train Loss: 0.2949 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.1874 | Train Acc: 0.9774
 Site-Real                      (4) | Train Loss: 0.2173 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2582 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.2697 | Train Acc: 0.9252
 Site-Painting                  (2) | Train Loss: 0.4112 | Train Acc: 0.8689
 Site-Painting                  (2) | Train Loss: 0.3246 | Train Acc: 0.9135
 Site-Sketch                    (5) | Train Loss: 0.4003 | Train Acc: 0.8848
 Site-Sketch                    (5) | Train Loss: 0.4223 | Train Acc: 0.8876
 Site-QuickDraw                 (1) | Train Loss: 0.7598 | Train Acc: 0.8073
 Site-Infograph                 (3) | Train Loss: 0.9274 | Train Acc: 0.6880
Average Train Accuracy: 0.8924
 Site-Clipart                   (0) | Val  Loss: 0.2641 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.2763 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.3486 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.3742 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4314 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2131 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2318 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.1883 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2234 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2189 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.3020 | Val  Acc: 0.9051
 Site-Painting                  (2) | Val  Loss: 0.3128 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.3715 | Val  Acc: 0.9055
 Site-Sketch                    (5) | Val  Loss: 0.4660 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.7887 | Val  Acc: 0.7661
 Site-Infograph                 (3) | Val  Loss: 0.9881 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8910
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8816
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.9346
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.9000
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8857
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8712
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9407
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9455
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9567
 Best site-Painting                 (2)  | Epoch:41 | Val Acc: 0.9490
 Best site-Painting                 (2)  | Epoch:41 | Val Acc: 0.9051
 Best site-Painting                 (2)  | Epoch:41 | Val Acc: 0.9219
 Best site-Sketch                   (5)  | Epoch:41 | Val Acc: 0.9055
 Best site-Sketch                   (5)  | Epoch:41 | Val Acc: 0.8539
 Best site-QuickDraw                (1)  | Epoch:41 | Val Acc: 0.7661
 Best site-Infograph                (3)  | Epoch:41 | Val Acc: 0.6987
 Test site-Clipart                   (0)| Epoch:41 | Test Acc: 0.8878
 Test site-Real                      (4)| Epoch:41 | Test Acc: 0.9433
 Test site-Painting                  (2)| Epoch:41 | Test Acc: 0.9241
 Test site-Sketch                    (5)| Epoch:41 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7490
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5647
Clipart: 0.8878, Real: 0.9433, Painting: 0.9241, Sketch: 0.8863, QuickDraw: 0.7490, Infograph: 0.5647, 
Average Test Accuracy(group): 0.8259, Average Test Accuracy(individual): 0.8794,
domain std=0.1323, cluster std=0.1323, individual std=0.0931, 
Average Test Accuracy: 0.8259
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 42 ============
cnt=[3, 1, 5, 1, 4, 2, ]
cnt=[4, 1, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (2) | Train Loss: 0.3574 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.2967 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.4330 | Train Acc: 0.8622
 Site-Clipart                   (2) | Train Loss: 0.3630 | Train Acc: 0.8987
 Site-Clipart                   (2) | Train Loss: 0.3546 | Train Acc: 0.9118
 Site-Real                      (4) | Train Loss: 0.3081 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.1822 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2300 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2453 | Train Acc: 0.9339
 Site-Painting                  (0) | Train Loss: 0.3488 | Train Acc: 0.8912
 Site-Painting                  (0) | Train Loss: 0.3429 | Train Acc: 0.9126
 Site-Painting                  (0) | Train Loss: 0.2842 | Train Acc: 0.9308
 Site-Sketch                    (5) | Train Loss: 0.4201 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.5139 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.7237 | Train Acc: 0.7859
 Site-Infograph                 (3) | Train Loss: 0.9063 | Train Acc: 0.6966
Average Train Accuracy: 0.8878
 Site-Clipart                   (2) | Val  Loss: 0.2163 | Val  Acc: 0.9605
 Site-Clipart                   (2) | Val  Loss: 0.2692 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.2996 | Val  Acc: 0.9067
 Site-Clipart                   (2) | Val  Loss: 0.3745 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.4492 | Val  Acc: 0.8610
 Site-Real                      (4) | Val  Loss: 0.2059 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2407 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2107 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2238 | Val  Acc: 0.9437
 Site-Painting                  (0) | Val  Loss: 0.2405 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.2660 | Val  Acc: 0.9489
 Site-Painting                  (0) | Val  Loss: 0.3160 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.3988 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.4889 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.8089 | Val  Acc: 0.7615
 Site-Infograph                 (3) | Val  Loss: 1.0210 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8926
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9605
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9252
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9067
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.8810
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.8610
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9407
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9455
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9437
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9388
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9489
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9062
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8819
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:42 | Val Acc: 0.7615
 Best site-Infograph                (3)  | Epoch:42 | Val Acc: 0.6795
 Test site-Clipart                   (2)| Epoch:42 | Test Acc: 0.8897
 Test site-Real                      (4)| Epoch:42 | Test Acc: 0.9441
 Test site-Painting                  (0)| Epoch:42 | Test Acc: 0.9257
 Test site-Sketch                    (5)| Epoch:42 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7570
 Test site-Infograph                 (3)| Epoch:42 | Test Acc: 0.5708
Clipart: 0.8897, Real: 0.9441, Painting: 0.9257, Sketch: 0.8881, QuickDraw: 0.7570, Infograph: 0.5708, 
Average Test Accuracy(group): 0.8292, Average Test Accuracy(individual): 0.8816,
domain std=0.1302, cluster std=0.1302, individual std=0.0915, 
Average Test Accuracy: 0.8292
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 43 ============
cnt=[4, 1, 5, 1, 3, 2, ]
cnt=[4, 5, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (2) | Train Loss: 0.3198 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.2927 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.3872 | Train Acc: 0.9156
 Site-Clipart                   (2) | Train Loss: 0.3631 | Train Acc: 0.8829
 Site-Clipart                   (2) | Train Loss: 0.3570 | Train Acc: 0.9163
 Site-Real                      (0) | Train Loss: 0.3069 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.1996 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2142 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2491 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.3703 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.3408 | Train Acc: 0.8981
 Site-Painting                  (4) | Train Loss: 0.3205 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.4520 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.4428 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.7870 | Train Acc: 0.8135
 Site-Infograph                 (3) | Train Loss: 0.8717 | Train Acc: 0.7308
Average Train Accuracy: 0.8940
 Site-Clipart                   (2) | Val  Loss: 0.2512 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.2768 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.3099 | Val  Acc: 0.9067
 Site-Clipart                   (2) | Val  Loss: 0.3794 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.4098 | Val  Acc: 0.8814
 Site-Real                      (0) | Val  Loss: 0.2280 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2281 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2178 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2331 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2253 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.3032 | Val  Acc: 0.9416
 Site-Painting                  (4) | Val  Loss: 0.3223 | Val  Acc: 0.9167
 Site-Sketch                    (5) | Val  Loss: 0.3741 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4523 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.7794 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 0.9682 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8947
 Best site-Clipart                  (2)  | Epoch:43 | Val Acc: 0.9342
 Best site-Clipart                  (2)  | Epoch:43 | Val Acc: 0.9346
 Best site-Clipart                  (2)  | Epoch:43 | Val Acc: 0.9067
 Best site-Clipart                  (2)  | Epoch:43 | Val Acc: 0.8571
 Best site-Clipart                  (2)  | Epoch:43 | Val Acc: 0.8814
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9576
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:43 | Val Acc: 0.9490
 Best site-Painting                 (4)  | Epoch:43 | Val Acc: 0.9416
 Best site-Painting                 (4)  | Epoch:43 | Val Acc: 0.9167
 Best site-Sketch                   (5)  | Epoch:43 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:43 | Val Acc: 0.8539
 Best site-QuickDraw                (1)  | Epoch:43 | Val Acc: 0.7752
 Best site-Infograph                (3)  | Epoch:43 | Val Acc: 0.6795
 Test site-Clipart                   (2)| Epoch:43 | Test Acc: 0.8897
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9474
 Test site-Painting                  (4)| Epoch:43 | Test Acc: 0.9208
 Test site-Sketch                    (5)| Epoch:43 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7580
 Test site-Infograph                 (3)| Epoch:43 | Test Acc: 0.5708
Clipart: 0.8897, Real: 0.9474, Painting: 0.9208, Sketch: 0.8863, QuickDraw: 0.7580, Infograph: 0.5708, 
Average Test Accuracy(group): 0.8288, Average Test Accuracy(individual): 0.8814,
domain std=0.1298, cluster std=0.1298, individual std=0.0916, 
Average Test Accuracy: 0.8288
============ Train epoch 44 ============
cnt=[4, 1, 1, 5, 3, 2, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (3) | Train Loss: 0.3887 | Train Acc: 0.8783
 Site-Clipart                   (3) | Train Loss: 0.2558 | Train Acc: 0.9317
 Site-Clipart                   (3) | Train Loss: 0.3853 | Train Acc: 0.8933
 Site-Clipart                   (3) | Train Loss: 0.3750 | Train Acc: 0.8766
 Site-Clipart                   (3) | Train Loss: 0.3405 | Train Acc: 0.9095
 Site-Real                      (0) | Train Loss: 0.3179 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2116 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2067 | Train Acc: 0.9597
 Site-Real                      (0) | Train Loss: 0.2511 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.2836 | Train Acc: 0.9048
 Site-Painting                  (4) | Train Loss: 0.3368 | Train Acc: 0.9126
 Site-Painting                  (4) | Train Loss: 0.3262 | Train Acc: 0.9412
 Site-Sketch                    (5) | Train Loss: 0.4007 | Train Acc: 0.8743
 Site-Sketch                    (5) | Train Loss: 0.4395 | Train Acc: 0.8764
 Site-QuickDraw                 (1) | Train Loss: 0.7154 | Train Acc: 0.7829
 Site-Infograph                 (2) | Train Loss: 0.8892 | Train Acc: 0.7094
Average Train Accuracy: 0.8911
 Site-Clipart                   (3) | Val  Loss: 0.2556 | Val  Acc: 0.9211
 Site-Clipart                   (3) | Val  Loss: 0.2919 | Val  Acc: 0.9252
 Site-Clipart                   (3) | Val  Loss: 0.3552 | Val  Acc: 0.8933
 Site-Clipart                   (3) | Val  Loss: 0.3468 | Val  Acc: 0.8857
 Site-Clipart                   (3) | Val  Loss: 0.4391 | Val  Acc: 0.8678
 Site-Real                      (0) | Val  Loss: 0.2193 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2472 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.2196 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2358 | Val  Acc: 0.9481
 Site-Painting                  (4) | Val  Loss: 0.2274 | Val  Acc: 0.9592
 Site-Painting                  (4) | Val  Loss: 0.2794 | Val  Acc: 0.9197
 Site-Painting                  (4) | Val  Loss: 0.2918 | Val  Acc: 0.9427
 Site-Sketch                    (5) | Val  Loss: 0.3992 | Val  Acc: 0.8740
 Site-Sketch                    (5) | Val  Loss: 0.4892 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.7620 | Val  Acc: 0.7752
 Site-Infograph                 (2) | Val  Loss: 0.9141 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8957
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.9211
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.9252
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.8933
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.8857
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.8678
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9237
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9455
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9481
 Best site-Painting                 (4)  | Epoch:44 | Val Acc: 0.9592
 Best site-Painting                 (4)  | Epoch:44 | Val Acc: 0.9197
 Best site-Painting                 (4)  | Epoch:44 | Val Acc: 0.9427
 Best site-Sketch                   (5)  | Epoch:44 | Val Acc: 0.8740
 Best site-Sketch                   (5)  | Epoch:44 | Val Acc: 0.8596
 Best site-QuickDraw                (1)  | Epoch:44 | Val Acc: 0.7752
 Best site-Infograph                (2)  | Epoch:44 | Val Acc: 0.7500
 Test site-Clipart                   (3)| Epoch:44 | Test Acc: 0.8859
 Test site-Real                      (0)| Epoch:44 | Test Acc: 0.9491
 Test site-Painting                  (4)| Epoch:44 | Test Acc: 0.9192
 Test site-Sketch                    (5)| Epoch:44 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.7640
 Test site-Infograph                 (2)| Epoch:44 | Test Acc: 0.5693
Clipart: 0.8859, Real: 0.9491, Painting: 0.9192, Sketch: 0.8845, QuickDraw: 0.7640, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8287, Average Test Accuracy(individual): 0.8804,
domain std=0.1295, cluster std=0.1295, individual std=0.0915, 
Average Test Accuracy: 0.8287
============ Train epoch 45 ============
cnt=[4, 1, 5, 1, 2, 3, ]
cnt=[3, 4, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (2) | Train Loss: 0.4023 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.2731 | Train Acc: 0.9379
 Site-Clipart                   (2) | Train Loss: 0.3987 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.3734 | Train Acc: 0.8861
 Site-Clipart                   (2) | Train Loss: 0.3362 | Train Acc: 0.9231
 Site-Real                      (0) | Train Loss: 0.3104 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2170 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2193 | Train Acc: 0.9597
 Site-Real                      (0) | Train Loss: 0.2585 | Train Acc: 0.9483
 Site-Painting                  (5) | Train Loss: 0.3237 | Train Acc: 0.8980
 Site-Painting                  (5) | Train Loss: 0.3082 | Train Acc: 0.9126
 Site-Painting                  (5) | Train Loss: 0.2998 | Train Acc: 0.9377
 Site-Sketch                    (4) | Train Loss: 0.4196 | Train Acc: 0.8482
 Site-Sketch                    (4) | Train Loss: 0.4188 | Train Acc: 0.8801
 Site-QuickDraw                 (1) | Train Loss: 0.6781 | Train Acc: 0.7676
 Site-Infograph                 (3) | Train Loss: 0.8940 | Train Acc: 0.6966
Average Train Accuracy: 0.8887
 Site-Clipart                   (2) | Val  Loss: 0.2093 | Val  Acc: 0.9474
 Site-Clipart                   (2) | Val  Loss: 0.2895 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.3132 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.3584 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.4081 | Val  Acc: 0.8814
 Site-Real                      (0) | Val  Loss: 0.2139 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2460 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2070 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2225 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.1972 | Val  Acc: 0.9592
 Site-Painting                  (5) | Val  Loss: 0.2589 | Val  Acc: 0.9197
 Site-Painting                  (5) | Val  Loss: 0.3263 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.4027 | Val  Acc: 0.8740
 Site-Sketch                    (4) | Val  Loss: 0.4138 | Val  Acc: 0.8764
 Site-QuickDraw                 (1) | Val  Loss: 0.7921 | Val  Acc: 0.7844
 Site-Infograph                 (3) | Val  Loss: 0.9954 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8962
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.9474
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.9346
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.8933
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.8762
 Best site-Clipart                  (2)  | Epoch:45 | Val Acc: 0.8814
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9322
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9437
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9592
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9197
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9062
 Best site-Sketch                   (4)  | Epoch:45 | Val Acc: 0.8740
 Best site-Sketch                   (4)  | Epoch:45 | Val Acc: 0.8764
 Best site-QuickDraw                (1)  | Epoch:45 | Val Acc: 0.7844
 Best site-Infograph                (3)  | Epoch:45 | Val Acc: 0.7244
 Test site-Clipart                   (2)| Epoch:45 | Test Acc: 0.8878
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9507
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9160
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7610
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5677
Clipart: 0.8878, Real: 0.9507, Painting: 0.9160, Sketch: 0.8881, QuickDraw: 0.7610, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8286, Average Test Accuracy(individual): 0.8809,
domain std=0.1305, cluster std=0.1305, individual std=0.0922, 
Average Test Accuracy: 0.8286
============ Train epoch 46 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[2, 5, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (0) | Train Loss: 0.3645 | Train Acc: 0.8957
 Site-Clipart                   (0) | Train Loss: 0.3045 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.4351 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.3566 | Train Acc: 0.9082
 Site-Clipart                   (0) | Train Loss: 0.3413 | Train Acc: 0.9118
 Site-Real                      (4) | Train Loss: 0.2975 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.1863 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2076 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2495 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.3279 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3262 | Train Acc: 0.8981
 Site-Painting                  (2) | Train Loss: 0.2583 | Train Acc: 0.9481
 Site-Sketch                    (5) | Train Loss: 0.4259 | Train Acc: 0.8796
 Site-Sketch                    (5) | Train Loss: 0.4300 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.6546 | Train Acc: 0.8043
 Site-Infograph                 (3) | Train Loss: 0.8783 | Train Acc: 0.7479
Average Train Accuracy: 0.8963
 Site-Clipart                   (0) | Val  Loss: 0.2303 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.2871 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.3369 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.3724 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.4187 | Val  Acc: 0.8780
 Site-Real                      (4) | Val  Loss: 0.2202 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2590 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2010 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2062 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.1990 | Val  Acc: 0.9796
 Site-Painting                  (2) | Val  Loss: 0.2489 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.2994 | Val  Acc: 0.9375
 Site-Sketch                    (5) | Val  Loss: 0.3576 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.4802 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.8061 | Val  Acc: 0.7523
 Site-Infograph                 (3) | Val  Loss: 0.9604 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8938
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.8935
 Test site-Real                      (4)| Epoch:45 | Test Acc: 0.9466
 Test site-Painting                  (2)| Epoch:45 | Test Acc: 0.9225
 Test site-Sketch                    (5)| Epoch:45 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7600
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5784
Clipart: 0.8935, Real: 0.9466, Painting: 0.9225, Sketch: 0.8845, QuickDraw: 0.7600, Infograph: 0.5784, 
Average Test Accuracy(group): 0.8309, Average Test Accuracy(individual): 0.8830,
domain std=0.1274, cluster std=0.1274, individual std=0.0899, 
Average Test Accuracy: 0.8309
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 47 ============
cnt=[1, 5, 1, 4, 2, 3, ]
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (1) | Train Loss: 0.3634 | Train Acc: 0.9043
 Site-Clipart                   (1) | Train Loss: 0.2783 | Train Acc: 0.9379
 Site-Clipart                   (1) | Train Loss: 0.4258 | Train Acc: 0.8978
 Site-Clipart                   (1) | Train Loss: 0.3504 | Train Acc: 0.8924
 Site-Clipart                   (1) | Train Loss: 0.3278 | Train Acc: 0.9186
 Site-Real                      (3) | Train Loss: 0.2823 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.1976 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2069 | Train Acc: 0.9556
 Site-Real                      (3) | Train Loss: 0.2491 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.3685 | Train Acc: 0.9116
 Site-Painting                  (5) | Train Loss: 0.3748 | Train Acc: 0.9029
 Site-Painting                  (5) | Train Loss: 0.3134 | Train Acc: 0.9273
 Site-Sketch                    (4) | Train Loss: 0.4043 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.4182 | Train Acc: 0.8502
 Site-QuickDraw                 (2) | Train Loss: 0.7119 | Train Acc: 0.8073
 Site-Infograph                 (0) | Train Loss: 0.8712 | Train Acc: 0.7436
Average Train Accuracy: 0.8947
 Site-Clipart                   (1) | Val  Loss: 0.2097 | Val  Acc: 0.9474
 Site-Clipart                   (1) | Val  Loss: 0.2597 | Val  Acc: 0.9439
 Site-Clipart                   (1) | Val  Loss: 0.3434 | Val  Acc: 0.8733
 Site-Clipart                   (1) | Val  Loss: 0.3274 | Val  Acc: 0.8857
 Site-Clipart                   (1) | Val  Loss: 0.4217 | Val  Acc: 0.8678
 Site-Real                      (3) | Val  Loss: 0.2149 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2448 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.1880 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2236 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2079 | Val  Acc: 0.9592
 Site-Painting                  (5) | Val  Loss: 0.2439 | Val  Acc: 0.9343
 Site-Painting                  (5) | Val  Loss: 0.3631 | Val  Acc: 0.8906
 Site-Sketch                    (4) | Val  Loss: 0.4128 | Val  Acc: 0.8740
 Site-Sketch                    (4) | Val  Loss: 0.4658 | Val  Acc: 0.8315
 Site-QuickDraw                 (2) | Val  Loss: 0.7207 | Val  Acc: 0.8073
 Site-Infograph                 (0) | Val  Loss: 0.9839 | Val  Acc: 0.7372
Average Valid Accuracy: 0.8952
 Test site-Clipart                   (1)| Epoch:46 | Test Acc: 0.8935
 Test site-Real                      (3)| Epoch:46 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:46 | Test Acc: 0.9289
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8845
 Test site-QuickDraw                 (2)| Epoch:46 | Test Acc: 0.7520
 Test site-Infograph                 (0)| Epoch:46 | Test Acc: 0.5753
Clipart: 0.8935, Real: 0.9441, Painting: 0.9289, Sketch: 0.8845, QuickDraw: 0.7520, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8297, Average Test Accuracy(individual): 0.8830,
domain std=0.1296, cluster std=0.1296, individual std=0.0914, 
Average Test Accuracy: 0.8297
============ Train epoch 48 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[4, 5, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.4329 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.2520 | Train Acc: 0.9317
 Site-Clipart                   (0) | Train Loss: 0.3942 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3729 | Train Acc: 0.8734
 Site-Clipart                   (0) | Train Loss: 0.3058 | Train Acc: 0.9253
 Site-Real                      (4) | Train Loss: 0.3072 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2236 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2171 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2482 | Train Acc: 0.9310
 Site-Painting                  (2) | Train Loss: 0.3068 | Train Acc: 0.9116
 Site-Painting                  (2) | Train Loss: 0.3151 | Train Acc: 0.8981
 Site-Painting                  (2) | Train Loss: 0.3116 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.3993 | Train Acc: 0.8639
 Site-Sketch                    (5) | Train Loss: 0.3978 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.6697 | Train Acc: 0.7829
 Site-Infograph                 (3) | Train Loss: 0.8706 | Train Acc: 0.7051
Average Train Accuracy: 0.8843
 Site-Clipart                   (0) | Val  Loss: 0.2058 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.2707 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.3050 | Val  Acc: 0.9200
 Site-Clipart                   (0) | Val  Loss: 0.3624 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4217 | Val  Acc: 0.8746
 Site-Real                      (4) | Val  Loss: 0.2149 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2199 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.1916 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2056 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2220 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.2769 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.3225 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.3664 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.4683 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7775 | Val  Acc: 0.7798
 Site-Infograph                 (3) | Val  Loss: 0.9759 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8949
 Test site-Clipart                   (0)| Epoch:46 | Test Acc: 0.8897
 Test site-Real                      (4)| Epoch:46 | Test Acc: 0.9417
 Test site-Painting                  (2)| Epoch:46 | Test Acc: 0.9241
 Test site-Sketch                    (5)| Epoch:46 | Test Acc: 0.8899
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7610
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5662
Clipart: 0.8897, Real: 0.9417, Painting: 0.9241, Sketch: 0.8899, QuickDraw: 0.7610, Infograph: 0.5662, 
Average Test Accuracy(group): 0.8288, Average Test Accuracy(individual): 0.8809,
domain std=0.1309, cluster std=0.1309, individual std=0.0916, 
Average Test Accuracy: 0.8288
============ Train epoch 49 ============
cnt=[7, 1, 3, 1, 2, 2, ]
cnt=[1, 5, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (2) | Train Loss: 0.3528 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.2705 | Train Acc: 0.9317
 Site-Clipart                   (5) | Train Loss: 0.3682 | Train Acc: 0.9067
 Site-Clipart                   (5) | Train Loss: 0.3382 | Train Acc: 0.9114
 Site-Clipart                   (2) | Train Loss: 0.3162 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.2960 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2013 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2126 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2422 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.3596 | Train Acc: 0.8844
 Site-Painting                  (0) | Train Loss: 0.2598 | Train Acc: 0.9272
 Site-Painting                  (0) | Train Loss: 0.2979 | Train Acc: 0.9273
 Site-Sketch                    (4) | Train Loss: 0.4103 | Train Acc: 0.8586
 Site-Sketch                    (4) | Train Loss: 0.4923 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.6297 | Train Acc: 0.8196
 Site-Infograph                 (3) | Train Loss: 0.8258 | Train Acc: 0.7735
Average Train Accuracy: 0.8984
 Site-Clipart                   (2) | Val  Loss: 0.2372 | Val  Acc: 0.9474
 Site-Clipart                   (2) | Val  Loss: 0.2853 | Val  Acc: 0.9065
 Site-Clipart                   (5) | Val  Loss: 0.3474 | Val  Acc: 0.9000
 Site-Clipart                   (5) | Val  Loss: 0.3411 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.4137 | Val  Acc: 0.8780
 Site-Real                      (0) | Val  Loss: 0.2139 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2367 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2106 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2122 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.1947 | Val  Acc: 0.9592
 Site-Painting                  (0) | Val  Loss: 0.2758 | Val  Acc: 0.9197
 Site-Painting                  (0) | Val  Loss: 0.3001 | Val  Acc: 0.9167
 Site-Sketch                    (4) | Val  Loss: 0.4084 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.4539 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.7796 | Val  Acc: 0.8119
 Site-Infograph                 (3) | Val  Loss: 1.0163 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8946
 Test site-Clipart                   (2)| Epoch:46 | Test Acc: 0.8916
 Test site-Real                      (0)| Epoch:46 | Test Acc: 0.9458
 Test site-Painting                  (0)| Epoch:46 | Test Acc: 0.9241
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8989
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7650
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5693
Clipart: 0.8916, Real: 0.9458, Painting: 0.9241, Sketch: 0.8989, QuickDraw: 0.7650, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8324, Average Test Accuracy(individual): 0.8841,
domain std=0.1310, cluster std=0.1263, individual std=0.0915, 
Average Test Accuracy: 0.8324
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:49 | Test Acc: 0.8916
 Test site-Real                      (0)| Epoch:49 | Test Acc: 0.9458
 Test site-Painting                  (0)| Epoch:49 | Test Acc: 0.9241
 Test site-Sketch                    (4)| Epoch:49 | Test Acc: 0.8989
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7650
 Test site-Infograph                 (3)| Epoch:49 | Test Acc: 0.5693
Clipart: 0.8916, Real: 0.9458, Painting: 0.9241, Sketch: 0.8989, QuickDraw: 0.7650, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8324, Average Test Accuracy(individual): 0.8841,
domain std=0.1310, cluster std=0.1263, individual std=0.0915, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
===2023-06-22 21:58:21===
===2023-06-22 21:58:24===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (2)| Epoch:49 | Test Acc: 0.8916
 Test site-Real                      (0)| Epoch:49 | Test Acc: 0.9458
 Test site-Painting                  (0)| Epoch:49 | Test Acc: 0.9241
 Test site-Sketch                    (4)| Epoch:49 | Test Acc: 0.8989
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7650
 Test site-Infograph                 (3)| Epoch:49 | Test Acc: 0.5693
Clipart: 0.8916, Real: 0.9458, Painting: 0.9241, Sketch: 0.8989, QuickDraw: 0.7650, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8324, Average Test Accuracy(individual): 0.8841,
domain std=0.1310, cluster std=0.1263, individual std=0.0915, 
===2023-06-24 13:12:47===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1100 | Train Acc: 0.2522
 Site-Clipart                   (1) | Train Loss: 2.0453 | Train Acc: 0.3540
 Site-Clipart                   (1) | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-Clipart                   (1) | Train Loss: 2.0738 | Train Acc: 0.2911
 Site-Clipart                   (1) | Train Loss: 2.1005 | Train Acc: 0.2715
 Site-Real                      (0) | Train Loss: 2.0876 | Train Acc: 0.3571
 Site-Real                      (0) | Train Loss: 2.0787 | Train Acc: 0.3559
 Site-Real                      (0) | Train Loss: 2.0687 | Train Acc: 0.3589
 Site-Real                      (0) | Train Loss: 2.1167 | Train Acc: 0.2816
 Site-Painting                  (5) | Train Loss: 2.1118 | Train Acc: 0.3605
 Site-Painting                  (5) | Train Loss: 2.1080 | Train Acc: 0.3495
 Site-Painting                  (5) | Train Loss: 2.0811 | Train Acc: 0.3149
 Site-Sketch                    (4) | Train Loss: 2.0476 | Train Acc: 0.3508
 Site-Sketch                    (4) | Train Loss: 2.1048 | Train Acc: 0.3558
 Site-QuickDraw                 (2) | Train Loss: 2.3103 | Train Acc: 0.1713
 Site-Infograph                 (3) | Train Loss: 2.2553 | Train Acc: 0.1880
Average Train Accuracy: 0.3067
 Site-Clipart                   (1) | Val  Loss: 2.0400 | Val  Acc: 0.2500
 Site-Clipart                   (1) | Val  Loss: 2.1068 | Val  Acc: 0.2991
 Site-Clipart                   (1) | Val  Loss: 2.0650 | Val  Acc: 0.3333
 Site-Clipart                   (1) | Val  Loss: 2.0566 | Val  Acc: 0.3571
 Site-Clipart                   (1) | Val  Loss: 2.1134 | Val  Acc: 0.2678
 Site-Real                      (0) | Val  Loss: 2.0676 | Val  Acc: 0.3452
 Site-Real                      (0) | Val  Loss: 2.0913 | Val  Acc: 0.3220
 Site-Real                      (0) | Val  Loss: 2.0499 | Val  Acc: 0.4061
 Site-Real                      (0) | Val  Loss: 2.0611 | Val  Acc: 0.3766
 Site-Painting                  (5) | Val  Loss: 2.1028 | Val  Acc: 0.3776
 Site-Painting                  (5) | Val  Loss: 2.0467 | Val  Acc: 0.3650
 Site-Painting                  (5) | Val  Loss: 2.1136 | Val  Acc: 0.3385
 Site-Sketch                    (4) | Val  Loss: 2.0787 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0737 | Val  Acc: 0.3539
 Site-QuickDraw                 (2) | Val  Loss: 2.3222 | Val  Acc: 0.1881
 Site-Infograph                 (3) | Val  Loss: 2.2939 | Val  Acc: 0.1603
Average Valid Accuracy: 0.3189
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2991
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2678
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3452
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3220
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4061
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3766
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3776
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3650
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3385
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3539
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1881
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.1603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 4, 3, 1, 6, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (5) | Train Loss: 1.9004 | Train Acc: 0.4783
 Site-Clipart                   (5) | Train Loss: 1.8297 | Train Acc: 0.4969
 Site-Clipart                   (5) | Train Loss: 1.9243 | Train Acc: 0.4711
 Site-Clipart                   (0) | Train Loss: 1.8719 | Train Acc: 0.4968
 Site-Clipart                   (5) | Train Loss: 1.9155 | Train Acc: 0.4638
 Site-Real                      (2) | Train Loss: 1.8191 | Train Acc: 0.6190
 Site-Real                      (2) | Train Loss: 1.7576 | Train Acc: 0.6667
 Site-Real                      (2) | Train Loss: 1.7584 | Train Acc: 0.6411
 Site-Real                      (2) | Train Loss: 1.8181 | Train Acc: 0.5920
 Site-Painting                  (3) | Train Loss: 1.8344 | Train Acc: 0.5238
 Site-Painting                  (3) | Train Loss: 1.8507 | Train Acc: 0.5388
 Site-Painting                  (3) | Train Loss: 1.8307 | Train Acc: 0.5260
 Site-Sketch                    (5) | Train Loss: 1.8503 | Train Acc: 0.5497
 Site-Sketch                    (5) | Train Loss: 1.9016 | Train Acc: 0.4794
 Site-QuickDraw                 (1) | Train Loss: 2.2560 | Train Acc: 0.1835
 Site-Infograph                 (4) | Train Loss: 2.2068 | Train Acc: 0.2350
Average Train Accuracy: 0.4976
 Site-Clipart                   (5) | Val  Loss: 1.7867 | Val  Acc: 0.5132
 Site-Clipart                   (5) | Val  Loss: 1.8906 | Val  Acc: 0.4299
 Site-Clipart                   (5) | Val  Loss: 1.8706 | Val  Acc: 0.5133
 Site-Clipart                   (0) | Val  Loss: 1.8597 | Val  Acc: 0.4476
 Site-Clipart                   (5) | Val  Loss: 1.9239 | Val  Acc: 0.4169
 Site-Real                      (2) | Val  Loss: 1.7409 | Val  Acc: 0.5714
 Site-Real                      (2) | Val  Loss: 1.7955 | Val  Acc: 0.6102
 Site-Real                      (2) | Val  Loss: 1.7464 | Val  Acc: 0.6667
 Site-Real                      (2) | Val  Loss: 1.7724 | Val  Acc: 0.6190
 Site-Painting                  (3) | Val  Loss: 1.8258 | Val  Acc: 0.5918
 Site-Painting                  (3) | Val  Loss: 1.8201 | Val  Acc: 0.5109
 Site-Painting                  (3) | Val  Loss: 1.8610 | Val  Acc: 0.5104
 Site-Sketch                    (5) | Val  Loss: 1.8311 | Val  Acc: 0.5354
 Site-Sketch                    (5) | Val  Loss: 1.9118 | Val  Acc: 0.4494
 Site-QuickDraw                 (1) | Val  Loss: 2.2843 | Val  Acc: 0.1835
 Site-Infograph                 (4) | Val  Loss: 2.1593 | Val  Acc: 0.2115
Average Valid Accuracy: 0.4863
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5132
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4299
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5133
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4476
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4169
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5714
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6102
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6667
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6190
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5918
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5109
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5104
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5354
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4494
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.1835
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.2115
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[2, 1, 4, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.6693 | Train Acc: 0.5826
 Site-Clipart                   (0) | Train Loss: 1.6029 | Train Acc: 0.6087
 Site-Clipart                   (0) | Train Loss: 1.7072 | Train Acc: 0.6000
 Site-Clipart                   (0) | Train Loss: 1.6543 | Train Acc: 0.6108
 Site-Clipart                   (0) | Train Loss: 1.6698 | Train Acc: 0.6222
 Site-Real                      (2) | Train Loss: 1.5617 | Train Acc: 0.7143
 Site-Real                      (2) | Train Loss: 1.4750 | Train Acc: 0.7345
 Site-Real                      (2) | Train Loss: 1.4488 | Train Acc: 0.7661
 Site-Real                      (2) | Train Loss: 1.5536 | Train Acc: 0.7270
 Site-Painting                  (4) | Train Loss: 1.5697 | Train Acc: 0.6667
 Site-Painting                  (4) | Train Loss: 1.6076 | Train Acc: 0.6845
 Site-Painting                  (4) | Train Loss: 1.5443 | Train Acc: 0.7163
 Site-Sketch                    (5) | Train Loss: 1.6553 | Train Acc: 0.6230
 Site-Sketch                    (5) | Train Loss: 1.6844 | Train Acc: 0.5918
 Site-QuickDraw                 (1) | Train Loss: 2.2666 | Train Acc: 0.1743
 Site-Infograph                 (3) | Train Loss: 2.0562 | Train Acc: 0.3376
Average Train Accuracy: 0.6100
 Site-Clipart                   (0) | Val  Loss: 1.5332 | Val  Acc: 0.6711
 Site-Clipart                   (0) | Val  Loss: 1.6320 | Val  Acc: 0.6636
 Site-Clipart                   (0) | Val  Loss: 1.6561 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 1.6560 | Val  Acc: 0.6333
 Site-Clipart                   (0) | Val  Loss: 1.7150 | Val  Acc: 0.5966
 Site-Real                      (2) | Val  Loss: 1.4749 | Val  Acc: 0.6786
 Site-Real                      (2) | Val  Loss: 1.4864 | Val  Acc: 0.7627
 Site-Real                      (2) | Val  Loss: 1.4015 | Val  Acc: 0.7818
 Site-Real                      (2) | Val  Loss: 1.4720 | Val  Acc: 0.7879
 Site-Painting                  (4) | Val  Loss: 1.5475 | Val  Acc: 0.6939
 Site-Painting                  (4) | Val  Loss: 1.5349 | Val  Acc: 0.6642
 Site-Painting                  (4) | Val  Loss: 1.5845 | Val  Acc: 0.6823
 Site-Sketch                    (5) | Val  Loss: 1.6742 | Val  Acc: 0.6063
 Site-Sketch                    (5) | Val  Loss: 1.7222 | Val  Acc: 0.5225
 Site-QuickDraw                 (1) | Val  Loss: 2.2683 | Val  Acc: 0.2064
 Site-Infograph                 (3) | Val  Loss: 2.0246 | Val  Acc: 0.3846
Average Valid Accuracy: 0.6252
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6711
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6636
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6333
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5966
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.6786
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7627
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7818
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7879
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6939
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6642
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6823
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.6063
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5225
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2064
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.3846
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 1, 4, 2, 3, 1, ]
cnt=[3, 5, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.4831 | Train Acc: 0.6348
 Site-Clipart                   (0) | Train Loss: 1.3733 | Train Acc: 0.7640
 Site-Clipart                   (0) | Train Loss: 1.5405 | Train Acc: 0.6756
 Site-Clipart                   (0) | Train Loss: 1.4480 | Train Acc: 0.7120
 Site-Clipart                   (0) | Train Loss: 1.4607 | Train Acc: 0.7081
 Site-Real                      (2) | Train Loss: 1.2773 | Train Acc: 0.8571
 Site-Real                      (2) | Train Loss: 1.2095 | Train Acc: 0.8701
 Site-Real                      (2) | Train Loss: 1.1906 | Train Acc: 0.8347
 Site-Real                      (2) | Train Loss: 1.2926 | Train Acc: 0.8276
 Site-Painting                  (4) | Train Loss: 1.3998 | Train Acc: 0.7143
 Site-Painting                  (4) | Train Loss: 1.3964 | Train Acc: 0.7476
 Site-Painting                  (4) | Train Loss: 1.3616 | Train Acc: 0.7509
 Site-Sketch                    (3) | Train Loss: 1.4059 | Train Acc: 0.7120
 Site-Sketch                    (3) | Train Loss: 1.4465 | Train Acc: 0.6517
 Site-QuickDraw                 (1) | Train Loss: 2.1676 | Train Acc: 0.2018
 Site-Infograph                 (5) | Train Loss: 1.9568 | Train Acc: 0.4103
Average Train Accuracy: 0.6920
 Site-Clipart                   (0) | Val  Loss: 1.3536 | Val  Acc: 0.7368
 Site-Clipart                   (0) | Val  Loss: 1.4308 | Val  Acc: 0.7290
 Site-Clipart                   (0) | Val  Loss: 1.4249 | Val  Acc: 0.7267
 Site-Clipart                   (0) | Val  Loss: 1.4103 | Val  Acc: 0.7238
 Site-Clipart                   (0) | Val  Loss: 1.4996 | Val  Acc: 0.6780
 Site-Real                      (2) | Val  Loss: 1.1714 | Val  Acc: 0.8452
 Site-Real                      (2) | Val  Loss: 1.2164 | Val  Acc: 0.8390
 Site-Real                      (2) | Val  Loss: 1.1639 | Val  Acc: 0.8667
 Site-Real                      (2) | Val  Loss: 1.1982 | Val  Acc: 0.8701
 Site-Painting                  (4) | Val  Loss: 1.2781 | Val  Acc: 0.7857
 Site-Painting                  (4) | Val  Loss: 1.3483 | Val  Acc: 0.7518
 Site-Painting                  (4) | Val  Loss: 1.3644 | Val  Acc: 0.7240
 Site-Sketch                    (3) | Val  Loss: 1.4179 | Val  Acc: 0.7244
 Site-Sketch                    (3) | Val  Loss: 1.5308 | Val  Acc: 0.6236
 Site-QuickDraw                 (1) | Val  Loss: 2.1710 | Val  Acc: 0.2385
 Site-Infograph                 (5) | Val  Loss: 1.9133 | Val  Acc: 0.4359
Average Valid Accuracy: 0.7062
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7368
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7290
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7267
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7238
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6780
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8452
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8390
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8667
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8701
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7857
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7518
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7240
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.7244
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.6236
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.2385
 Best site-Infograph                (5)  | Epoch:3 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 4, 1, 3, 3, 1, ]
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (4) | Train Loss: 1.3358 | Train Acc: 0.7391
 Site-Clipart                   (0) | Train Loss: 1.2492 | Train Acc: 0.7578
 Site-Clipart                   (0) | Train Loss: 1.3882 | Train Acc: 0.7200
 Site-Clipart                   (4) | Train Loss: 1.2739 | Train Acc: 0.7437
 Site-Clipart                   (4) | Train Loss: 1.3197 | Train Acc: 0.7443
 Site-Real                      (1) | Train Loss: 1.0910 | Train Acc: 0.8730
 Site-Real                      (1) | Train Loss: 1.0019 | Train Acc: 0.8757
 Site-Real                      (1) | Train Loss: 0.9701 | Train Acc: 0.8871
 Site-Real                      (1) | Train Loss: 1.0925 | Train Acc: 0.8793
 Site-Painting                  (3) | Train Loss: 1.1666 | Train Acc: 0.7891
 Site-Painting                  (3) | Train Loss: 1.1229 | Train Acc: 0.7718
 Site-Painting                  (3) | Train Loss: 1.1344 | Train Acc: 0.7993
 Site-Sketch                    (0) | Train Loss: 1.2486 | Train Acc: 0.7330
 Site-Sketch                    (0) | Train Loss: 1.3057 | Train Acc: 0.7041
 Site-QuickDraw                 (2) | Train Loss: 2.1393 | Train Acc: 0.2477
 Site-Infograph                 (5) | Train Loss: 1.8458 | Train Acc: 0.4231
Average Train Accuracy: 0.7305
 Site-Clipart                   (4) | Val  Loss: 1.1859 | Val  Acc: 0.7632
 Site-Clipart                   (0) | Val  Loss: 1.2670 | Val  Acc: 0.8037
 Site-Clipart                   (0) | Val  Loss: 1.2752 | Val  Acc: 0.7667
 Site-Clipart                   (4) | Val  Loss: 1.2380 | Val  Acc: 0.7476
 Site-Clipart                   (4) | Val  Loss: 1.3630 | Val  Acc: 0.7119
 Site-Real                      (1) | Val  Loss: 0.9931 | Val  Acc: 0.8929
 Site-Real                      (1) | Val  Loss: 0.9985 | Val  Acc: 0.8983
 Site-Real                      (1) | Val  Loss: 0.9396 | Val  Acc: 0.9091
 Site-Real                      (1) | Val  Loss: 1.0041 | Val  Acc: 0.8788
 Site-Painting                  (3) | Val  Loss: 1.0684 | Val  Acc: 0.8469
 Site-Painting                  (3) | Val  Loss: 1.1605 | Val  Acc: 0.7664
 Site-Painting                  (3) | Val  Loss: 1.1815 | Val  Acc: 0.7656
 Site-Sketch                    (0) | Val  Loss: 1.3142 | Val  Acc: 0.6693
 Site-Sketch                    (0) | Val  Loss: 1.3246 | Val  Acc: 0.6573
 Site-QuickDraw                 (2) | Val  Loss: 2.1252 | Val  Acc: 0.2890
 Site-Infograph                 (5) | Val  Loss: 1.7696 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7409
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7632
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.8037
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7667
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7476
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7119
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8929
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8983
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.9091
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8788
 Best site-Painting                 (3)  | Epoch:4 | Val Acc: 0.8469
 Best site-Painting                 (3)  | Epoch:4 | Val Acc: 0.7664
 Best site-Painting                 (3)  | Epoch:4 | Val Acc: 0.7656
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.6693
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.6573
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.2890
 Best site-Infograph                (5)  | Epoch:4 | Val Acc: 0.4872
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 4, 4, 2, 3, ]
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 1.1948 | Train Acc: 0.7478
 Site-Clipart                   (3) | Train Loss: 1.0437 | Train Acc: 0.8075
 Site-Clipart                   (3) | Train Loss: 1.2027 | Train Acc: 0.7511
 Site-Clipart                   (0) | Train Loss: 1.1042 | Train Acc: 0.7880
 Site-Clipart                   (3) | Train Loss: 1.1642 | Train Acc: 0.7851
 Site-Real                      (2) | Train Loss: 0.8994 | Train Acc: 0.8730
 Site-Real                      (2) | Train Loss: 0.8570 | Train Acc: 0.8927
 Site-Real                      (2) | Train Loss: 0.8324 | Train Acc: 0.8992
 Site-Real                      (2) | Train Loss: 0.9435 | Train Acc: 0.9052
 Site-Painting                  (5) | Train Loss: 1.0008 | Train Acc: 0.8299
 Site-Painting                  (5) | Train Loss: 1.0642 | Train Acc: 0.7961
 Site-Painting                  (5) | Train Loss: 1.0131 | Train Acc: 0.7924
 Site-Sketch                    (4) | Train Loss: 1.0995 | Train Acc: 0.7435
 Site-Sketch                    (4) | Train Loss: 1.0860 | Train Acc: 0.7116
 Site-QuickDraw                 (1) | Train Loss: 2.0350 | Train Acc: 0.2446
 Site-Infograph                 (0) | Train Loss: 1.8135 | Train Acc: 0.3974
Average Train Accuracy: 0.7478
 Site-Clipart                   (3) | Val  Loss: 0.9836 | Val  Acc: 0.8026
 Site-Clipart                   (3) | Val  Loss: 1.0867 | Val  Acc: 0.8037
 Site-Clipart                   (3) | Val  Loss: 1.0940 | Val  Acc: 0.7933
 Site-Clipart                   (0) | Val  Loss: 1.0775 | Val  Acc: 0.7810
 Site-Clipart                   (3) | Val  Loss: 1.1819 | Val  Acc: 0.7492
 Site-Real                      (2) | Val  Loss: 0.8528 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.8692 | Val  Acc: 0.8814
 Site-Real                      (2) | Val  Loss: 0.8151 | Val  Acc: 0.9152
 Site-Real                      (2) | Val  Loss: 0.8512 | Val  Acc: 0.9004
 Site-Painting                  (5) | Val  Loss: 0.9711 | Val  Acc: 0.8367
 Site-Painting                  (5) | Val  Loss: 0.9767 | Val  Acc: 0.8102
 Site-Painting                  (5) | Val  Loss: 1.0512 | Val  Acc: 0.8021
 Site-Sketch                    (4) | Val  Loss: 1.1323 | Val  Acc: 0.7638
 Site-Sketch                    (4) | Val  Loss: 1.1802 | Val  Acc: 0.6854
 Site-QuickDraw                 (1) | Val  Loss: 2.0572 | Val  Acc: 0.2431
 Site-Infograph                 (0) | Val  Loss: 1.7275 | Val  Acc: 0.5192
Average Valid Accuracy: 0.7620
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.8026
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.8037
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7933
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7810
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7492
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9048
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8814
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9152
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9004
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8367
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8102
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8021
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7638
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.6854
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.2431
 Best site-Infograph                (0)  | Epoch:5 | Val Acc: 0.5192
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 1, 5, 3, 2, 1, ]
cnt=[1, 4, 2, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (3) | Train Loss: 1.0488 | Train Acc: 0.7739
 Site-Clipart                   (2) | Train Loss: 0.8752 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 1.0600 | Train Acc: 0.7733
 Site-Clipart                   (3) | Train Loss: 0.9577 | Train Acc: 0.8228
 Site-Clipart                   (3) | Train Loss: 1.0106 | Train Acc: 0.8009
 Site-Real                      (0) | Train Loss: 0.7854 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.7394 | Train Acc: 0.9153
 Site-Real                      (0) | Train Loss: 0.7142 | Train Acc: 0.9153
 Site-Real                      (0) | Train Loss: 0.7934 | Train Acc: 0.9167
 Site-Painting                  (2) | Train Loss: 0.9419 | Train Acc: 0.8095
 Site-Painting                  (4) | Train Loss: 0.9467 | Train Acc: 0.8204
 Site-Painting                  (4) | Train Loss: 0.9202 | Train Acc: 0.8097
 Site-Sketch                    (2) | Train Loss: 0.9691 | Train Acc: 0.7749
 Site-Sketch                    (2) | Train Loss: 1.0122 | Train Acc: 0.7678
 Site-QuickDraw                 (1) | Train Loss: 1.9503 | Train Acc: 0.2813
 Site-Infograph                 (5) | Train Loss: 1.7079 | Train Acc: 0.4658
Average Train Accuracy: 0.7732
 Site-Clipart                   (3) | Val  Loss: 0.8692 | Val  Acc: 0.7895
 Site-Clipart                   (2) | Val  Loss: 0.9460 | Val  Acc: 0.7850
 Site-Clipart                   (2) | Val  Loss: 0.9984 | Val  Acc: 0.7867
 Site-Clipart                   (3) | Val  Loss: 0.9291 | Val  Acc: 0.8143
 Site-Clipart                   (3) | Val  Loss: 1.0407 | Val  Acc: 0.7661
 Site-Real                      (0) | Val  Loss: 0.7342 | Val  Acc: 0.8929
 Site-Real                      (0) | Val  Loss: 0.7497 | Val  Acc: 0.8983
 Site-Real                      (0) | Val  Loss: 0.7216 | Val  Acc: 0.8848
 Site-Real                      (0) | Val  Loss: 0.7518 | Val  Acc: 0.9221
 Site-Painting                  (2) | Val  Loss: 0.8223 | Val  Acc: 0.8163
 Site-Painting                  (4) | Val  Loss: 0.8761 | Val  Acc: 0.8321
 Site-Painting                  (4) | Val  Loss: 0.9056 | Val  Acc: 0.8125
 Site-Sketch                    (2) | Val  Loss: 1.0331 | Val  Acc: 0.7323
 Site-Sketch                    (2) | Val  Loss: 1.0288 | Val  Acc: 0.7472
 Site-QuickDraw                 (1) | Val  Loss: 1.9938 | Val  Acc: 0.2936
 Site-Infograph                 (5) | Val  Loss: 1.6345 | Val  Acc: 0.5064
Average Valid Accuracy: 0.7675
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.7895
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7850
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7867
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.8143
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.7661
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8929
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8983
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8848
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.9221
 Best site-Painting                 (2)  | Epoch:6 | Val Acc: 0.8163
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.8321
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.8125
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.7323
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.7472
 Best site-QuickDraw                (1)  | Epoch:6 | Val Acc: 0.2936
 Best site-Infograph                (5)  | Epoch:6 | Val Acc: 0.5064
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 3, 1, 5, 1, 3, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (3) | Train Loss: 0.8538 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.8257 | Train Acc: 0.8137
 Site-Clipart                   (3) | Train Loss: 0.9328 | Train Acc: 0.8267
 Site-Clipart                   (3) | Train Loss: 0.8954 | Train Acc: 0.8070
 Site-Clipart                   (3) | Train Loss: 0.9454 | Train Acc: 0.7851
 Site-Real                      (4) | Train Loss: 0.7233 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.6581 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.6249 | Train Acc: 0.8992
 Site-Real                      (1) | Train Loss: 0.7266 | Train Acc: 0.9195
 Site-Painting                  (5) | Train Loss: 0.8608 | Train Acc: 0.8095
 Site-Painting                  (5) | Train Loss: 0.8060 | Train Acc: 0.8641
 Site-Painting                  (5) | Train Loss: 0.7980 | Train Acc: 0.8374
 Site-Sketch                    (0) | Train Loss: 0.8513 | Train Acc: 0.8063
 Site-Sketch                    (0) | Train Loss: 0.8853 | Train Acc: 0.7640
 Site-QuickDraw                 (2) | Train Loss: 1.8954 | Train Acc: 0.3823
 Site-Infograph                 (3) | Train Loss: 1.6066 | Train Acc: 0.4957
Average Train Accuracy: 0.7942
 Site-Clipart                   (3) | Val  Loss: 0.8093 | Val  Acc: 0.8026
 Site-Clipart                   (0) | Val  Loss: 0.8797 | Val  Acc: 0.8037
 Site-Clipart                   (3) | Val  Loss: 0.9243 | Val  Acc: 0.8133
 Site-Clipart                   (3) | Val  Loss: 0.8687 | Val  Acc: 0.7952
 Site-Clipart                   (3) | Val  Loss: 0.9641 | Val  Acc: 0.7695
 Site-Real                      (4) | Val  Loss: 0.6517 | Val  Acc: 0.9167
 Site-Real                      (1) | Val  Loss: 0.6531 | Val  Acc: 0.9153
 Site-Real                      (1) | Val  Loss: 0.6249 | Val  Acc: 0.9091
 Site-Real                      (1) | Val  Loss: 0.6701 | Val  Acc: 0.9134
 Site-Painting                  (5) | Val  Loss: 0.7400 | Val  Acc: 0.8571
 Site-Painting                  (5) | Val  Loss: 0.8028 | Val  Acc: 0.8321
 Site-Painting                  (5) | Val  Loss: 0.8130 | Val  Acc: 0.8438
 Site-Sketch                    (0) | Val  Loss: 0.9041 | Val  Acc: 0.7953
 Site-Sketch                    (0) | Val  Loss: 0.9489 | Val  Acc: 0.7135
 Site-QuickDraw                 (2) | Val  Loss: 1.8969 | Val  Acc: 0.3624
 Site-Infograph                 (3) | Val  Loss: 1.5178 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7863
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8026
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8037
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8133
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7952
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7695
 Best site-Real                     (4)  | Epoch:7 | Val Acc: 0.9167
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9153
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9091
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9134
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8571
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8321
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8438
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7953
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7135
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.3624
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.5385
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 8 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[5, 1, 4, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 0.8366 | Train Acc: 0.8348
 Site-Clipart                   (4) | Train Loss: 0.7258 | Train Acc: 0.8820
 Site-Clipart                   (0) | Train Loss: 0.8851 | Train Acc: 0.8133
 Site-Clipart                   (0) | Train Loss: 0.8094 | Train Acc: 0.8165
 Site-Clipart                   (0) | Train Loss: 0.8366 | Train Acc: 0.8167
 Site-Real                      (2) | Train Loss: 0.6380 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.5722 | Train Acc: 0.9379
 Site-Real                      (2) | Train Loss: 0.5732 | Train Acc: 0.9234
 Site-Real                      (2) | Train Loss: 0.6426 | Train Acc: 0.9282
 Site-Painting                  (3) | Train Loss: 0.8151 | Train Acc: 0.8163
 Site-Painting                  (3) | Train Loss: 0.8036 | Train Acc: 0.8350
 Site-Painting                  (3) | Train Loss: 0.7552 | Train Acc: 0.8028
 Site-Sketch                    (4) | Train Loss: 0.8019 | Train Acc: 0.8063
 Site-Sketch                    (4) | Train Loss: 0.9291 | Train Acc: 0.7715
 Site-QuickDraw                 (1) | Train Loss: 1.7362 | Train Acc: 0.4159
 Site-Infograph                 (5) | Train Loss: 1.5814 | Train Acc: 0.4915
Average Train Accuracy: 0.7993
 Site-Clipart                   (0) | Val  Loss: 0.6821 | Val  Acc: 0.8553
 Site-Clipart                   (4) | Val  Loss: 0.7630 | Val  Acc: 0.8411
 Site-Clipart                   (0) | Val  Loss: 0.8099 | Val  Acc: 0.8200
 Site-Clipart                   (0) | Val  Loss: 0.7726 | Val  Acc: 0.8143
 Site-Clipart                   (0) | Val  Loss: 0.8779 | Val  Acc: 0.8068
 Site-Real                      (2) | Val  Loss: 0.5558 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.5976 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.5820 | Val  Acc: 0.8909
 Site-Real                      (2) | Val  Loss: 0.5961 | Val  Acc: 0.9221
 Site-Painting                  (3) | Val  Loss: 0.6568 | Val  Acc: 0.8571
 Site-Painting                  (3) | Val  Loss: 0.7106 | Val  Acc: 0.7956
 Site-Painting                  (3) | Val  Loss: 0.7927 | Val  Acc: 0.8438
 Site-Sketch                    (4) | Val  Loss: 0.8797 | Val  Acc: 0.8031
 Site-Sketch                    (4) | Val  Loss: 0.9028 | Val  Acc: 0.7472
 Site-QuickDraw                 (1) | Val  Loss: 1.7721 | Val  Acc: 0.4495
 Site-Infograph                 (5) | Val  Loss: 1.4798 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8056
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8553
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8411
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8200
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8143
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8068
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.8909
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9221
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8571
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.7956
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8438
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.8031
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.7472
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.4495
 Best site-Infograph                (5)  | Epoch:8 | Val Acc: 0.5577
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 1, 3, 5, 3, 3, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (2) | Train Loss: 0.7348 | Train Acc: 0.8435
 Site-Clipart                   (5) | Train Loss: 0.6962 | Train Acc: 0.8385
 Site-Clipart                   (2) | Train Loss: 0.8416 | Train Acc: 0.8178
 Site-Clipart                   (4) | Train Loss: 0.7579 | Train Acc: 0.7943
 Site-Clipart                   (2) | Train Loss: 0.7823 | Train Acc: 0.8281
 Site-Real                      (3) | Train Loss: 0.5494 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.4632 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.4699 | Train Acc: 0.9556
 Site-Real                      (3) | Train Loss: 0.5438 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.6981 | Train Acc: 0.8367
 Site-Painting                  (4) | Train Loss: 0.7329 | Train Acc: 0.8689
 Site-Painting                  (1) | Train Loss: 0.6729 | Train Acc: 0.8512
 Site-Sketch                    (5) | Train Loss: 0.7380 | Train Acc: 0.8482
 Site-Sketch                    (5) | Train Loss: 0.7541 | Train Acc: 0.7715
 Site-QuickDraw                 (0) | Train Loss: 1.6247 | Train Acc: 0.4924
 Site-Infograph                 (3) | Train Loss: 1.5778 | Train Acc: 0.5128
Average Train Accuracy: 0.8158
 Site-Clipart                   (2) | Val  Loss: 0.5953 | Val  Acc: 0.8816
 Site-Clipart                   (5) | Val  Loss: 0.7110 | Val  Acc: 0.8692
 Site-Clipart                   (2) | Val  Loss: 0.7605 | Val  Acc: 0.8267
 Site-Clipart                   (4) | Val  Loss: 0.6927 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.8290 | Val  Acc: 0.8102
 Site-Real                      (3) | Val  Loss: 0.4989 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.4835 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.4901 | Val  Acc: 0.9152
 Site-Real                      (3) | Val  Loss: 0.5165 | Val  Acc: 0.9351
 Site-Painting                  (4) | Val  Loss: 0.6181 | Val  Acc: 0.8469
 Site-Painting                  (4) | Val  Loss: 0.6688 | Val  Acc: 0.8102
 Site-Painting                  (1) | Val  Loss: 0.6931 | Val  Acc: 0.8594
 Site-Sketch                    (5) | Val  Loss: 0.7980 | Val  Acc: 0.7874
 Site-Sketch                    (5) | Val  Loss: 0.8567 | Val  Acc: 0.7753
 Site-QuickDraw                 (0) | Val  Loss: 1.6875 | Val  Acc: 0.4954
 Site-Infograph                 (3) | Val  Loss: 1.4516 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8213
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8816
 Best site-Clipart                  (5)  | Epoch:9 | Val Acc: 0.8692
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8267
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8476
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8102
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9152
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9351
 Best site-Painting                 (4)  | Epoch:9 | Val Acc: 0.8469
 Best site-Painting                 (4)  | Epoch:9 | Val Acc: 0.8102
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8594
 Best site-Sketch                   (5)  | Epoch:9 | Val Acc: 0.7874
 Best site-Sketch                   (5)  | Epoch:9 | Val Acc: 0.7753
 Best site-QuickDraw                (0)  | Epoch:9 | Val Acc: 0.4954
 Best site-Infograph                (3)  | Epoch:9 | Val Acc: 0.5705
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:9 | Test Acc: 0.8441
 Test site-Real                      (3)| Epoch:9 | Test Acc: 0.9433
 Test site-Painting                  (4)| Epoch:9 | Test Acc: 0.8853
 Test site-Sketch                    (5)| Epoch:9 | Test Acc: 0.8502
 Test site-QuickDraw                 (0)| Epoch:9 | Test Acc: 0.5440
 Test site-Infograph                 (3)| Epoch:9 | Test Acc: 0.5023
Clipart: 0.8441, Real: 0.9433, Painting: 0.8853, Sketch: 0.8502, QuickDraw: 0.5440, Infograph: 0.5023, 
Average Test Accuracy(group): 0.7615, Average Test Accuracy(individual): 0.8373,
domain std=0.1720, cluster std=0.1189, individual std=0.1252, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 1, 3, 1, 4, 3, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (4) | Train Loss: 0.6885 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.6304 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.7749 | Train Acc: 0.8311
 Site-Clipart                   (4) | Train Loss: 0.7043 | Train Acc: 0.8323
 Site-Clipart                   (2) | Train Loss: 0.7543 | Train Acc: 0.8371
 Site-Real                      (5) | Train Loss: 0.5348 | Train Acc: 0.8889
 Site-Real                      (5) | Train Loss: 0.4618 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.4694 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.5031 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.6310 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.6705 | Train Acc: 0.8544
 Site-Painting                  (0) | Train Loss: 0.6567 | Train Acc: 0.8685
 Site-Sketch                    (2) | Train Loss: 0.7191 | Train Acc: 0.8377
 Site-Sketch                    (2) | Train Loss: 0.7497 | Train Acc: 0.7678
 Site-QuickDraw                 (1) | Train Loss: 1.5533 | Train Acc: 0.5229
 Site-Infograph                 (5) | Train Loss: 1.5053 | Train Acc: 0.5214
Average Train Accuracy: 0.8256
 Site-Clipart                   (4) | Val  Loss: 0.5643 | Val  Acc: 0.8553
 Site-Clipart                   (4) | Val  Loss: 0.7000 | Val  Acc: 0.8411
 Site-Clipart                   (4) | Val  Loss: 0.6821 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.7080 | Val  Acc: 0.8000
 Site-Clipart                   (2) | Val  Loss: 0.7626 | Val  Acc: 0.8237
 Site-Real                      (5) | Val  Loss: 0.4441 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.4695 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.4256 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.4839 | Val  Acc: 0.9437
 Site-Painting                  (0) | Val  Loss: 0.5273 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.6453 | Val  Acc: 0.8321
 Site-Painting                  (0) | Val  Loss: 0.6308 | Val  Acc: 0.8594
 Site-Sketch                    (2) | Val  Loss: 0.7064 | Val  Acc: 0.8268
 Site-Sketch                    (2) | Val  Loss: 0.7643 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.6434 | Val  Acc: 0.5321
 Site-Infograph                 (5) | Val  Loss: 1.3915 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8294
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8553
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8411
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8000
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8237
 Best site-Real                     (5)  | Epoch:10 | Val Acc: 0.9524
 Best site-Real                     (5)  | Epoch:10 | Val Acc: 0.9237
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9437
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.9184
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8321
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8594
 Best site-Sketch                   (2)  | Epoch:10 | Val Acc: 0.8268
 Best site-Sketch                   (2)  | Epoch:10 | Val Acc: 0.7865
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.5321
 Best site-Infograph                (5)  | Epoch:10 | Val Acc: 0.5513
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 1, 5, 1, 2, 5, ]
cnt=[1, 4, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (5) | Train Loss: 0.6891 | Train Acc: 0.8261
 Site-Clipart                   (5) | Train Loss: 0.5673 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.7028 | Train Acc: 0.8267
 Site-Clipart                   (0) | Train Loss: 0.6434 | Train Acc: 0.8354
 Site-Clipart                   (5) | Train Loss: 0.7049 | Train Acc: 0.8122
 Site-Real                      (4) | Train Loss: 0.4964 | Train Acc: 0.8968
 Site-Real                      (4) | Train Loss: 0.4470 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.4351 | Train Acc: 0.9355
 Site-Real                      (2) | Train Loss: 0.4731 | Train Acc: 0.9339
 Site-Painting                  (2) | Train Loss: 0.6349 | Train Acc: 0.8503
 Site-Painting                  (2) | Train Loss: 0.6323 | Train Acc: 0.8641
 Site-Painting                  (2) | Train Loss: 0.6561 | Train Acc: 0.8408
 Site-Sketch                    (5) | Train Loss: 0.6750 | Train Acc: 0.8115
 Site-Sketch                    (3) | Train Loss: 0.7221 | Train Acc: 0.7865
 Site-QuickDraw                 (1) | Train Loss: 1.6077 | Train Acc: 0.5076
 Site-Infograph                 (0) | Train Loss: 1.4464 | Train Acc: 0.5385
Average Train Accuracy: 0.8167
 Site-Clipart                   (5) | Val  Loss: 0.5989 | Val  Acc: 0.8289
 Site-Clipart                   (5) | Val  Loss: 0.6185 | Val  Acc: 0.8598
 Site-Clipart                   (5) | Val  Loss: 0.6478 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.6499 | Val  Acc: 0.8238
 Site-Clipart                   (5) | Val  Loss: 0.7127 | Val  Acc: 0.8237
 Site-Real                      (4) | Val  Loss: 0.4385 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.4434 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.4539 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.4774 | Val  Acc: 0.9177
 Site-Painting                  (2) | Val  Loss: 0.5891 | Val  Acc: 0.8469
 Site-Painting                  (2) | Val  Loss: 0.6135 | Val  Acc: 0.8175
 Site-Painting                  (2) | Val  Loss: 0.6698 | Val  Acc: 0.8385
 Site-Sketch                    (5) | Val  Loss: 0.6765 | Val  Acc: 0.8504
 Site-Sketch                    (3) | Val  Loss: 0.7962 | Val  Acc: 0.7640
 Site-QuickDraw                 (1) | Val  Loss: 1.5051 | Val  Acc: 0.5780
 Site-Infograph                 (0) | Val  Loss: 1.3803 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8238
============ Train epoch 12 ============
cnt=[2, 4, 1, 4, 3, 2, ]
cnt=[1, 5, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (4) | Train Loss: 0.6457 | Train Acc: 0.8435
 Site-Clipart                   (4) | Train Loss: 0.5374 | Train Acc: 0.9006
 Site-Clipart                   (4) | Train Loss: 0.6807 | Train Acc: 0.8489
 Site-Clipart                   (5) | Train Loss: 0.6397 | Train Acc: 0.8133
 Site-Clipart                   (5) | Train Loss: 0.6567 | Train Acc: 0.8507
 Site-Real                      (1) | Train Loss: 0.4848 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.3990 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.4141 | Train Acc: 0.9395
 Site-Real                      (1) | Train Loss: 0.4714 | Train Acc: 0.9425
 Site-Painting                  (3) | Train Loss: 0.7286 | Train Acc: 0.8639
 Site-Painting                  (3) | Train Loss: 0.6398 | Train Acc: 0.8495
 Site-Painting                  (3) | Train Loss: 0.5780 | Train Acc: 0.8651
 Site-Sketch                    (0) | Train Loss: 0.6414 | Train Acc: 0.8429
 Site-Sketch                    (0) | Train Loss: 0.7086 | Train Acc: 0.7940
 Site-QuickDraw                 (2) | Train Loss: 1.3577 | Train Acc: 0.5657
 Site-Infograph                 (3) | Train Loss: 1.4559 | Train Acc: 0.5299
Average Train Accuracy: 0.8320
 Site-Clipart                   (4) | Val  Loss: 0.5263 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.6019 | Val  Acc: 0.8598
 Site-Clipart                   (4) | Val  Loss: 0.6400 | Val  Acc: 0.8400
 Site-Clipart                   (5) | Val  Loss: 0.6276 | Val  Acc: 0.8190
 Site-Clipart                   (5) | Val  Loss: 0.7144 | Val  Acc: 0.8305
 Site-Real                      (1) | Val  Loss: 0.3891 | Val  Acc: 0.9643
 Site-Real                      (1) | Val  Loss: 0.3959 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.3917 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.4253 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.5156 | Val  Acc: 0.8980
 Site-Painting                  (3) | Val  Loss: 0.5649 | Val  Acc: 0.8613
 Site-Painting                  (3) | Val  Loss: 0.5909 | Val  Acc: 0.8438
 Site-Sketch                    (0) | Val  Loss: 0.6797 | Val  Acc: 0.8268
 Site-Sketch                    (0) | Val  Loss: 0.7509 | Val  Acc: 0.7809
 Site-QuickDraw                 (2) | Val  Loss: 1.4636 | Val  Acc: 0.5826
 Site-Infograph                 (3) | Val  Loss: 1.3805 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8385
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.9079
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8598
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8400
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8190
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8305
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9643
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9333
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9394
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8980
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8613
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8438
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8268
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.7809
 Best site-QuickDraw                (2)  | Epoch:12 | Val Acc: 0.5826
 Best site-Infograph                (3)  | Epoch:12 | Val Acc: 0.5705
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 1, 3, 4, 4, 2, ]
cnt=[5, 4, 2, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (2) | Train Loss: 0.6246 | Train Acc: 0.8348
 Site-Clipart                   (3) | Train Loss: 0.5755 | Train Acc: 0.8634
 Site-Clipart                   (3) | Train Loss: 0.6636 | Train Acc: 0.8311
 Site-Clipart                   (2) | Train Loss: 0.6289 | Train Acc: 0.8323
 Site-Clipart                   (2) | Train Loss: 0.6653 | Train Acc: 0.8416
 Site-Real                      (4) | Train Loss: 0.4604 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.3613 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.3674 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.4246 | Train Acc: 0.9397
 Site-Painting                  (5) | Train Loss: 0.5562 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.5514 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.5501 | Train Acc: 0.8581
 Site-Sketch                    (3) | Train Loss: 0.6233 | Train Acc: 0.8482
 Site-Sketch                    (3) | Train Loss: 0.6561 | Train Acc: 0.7978
 Site-QuickDraw                 (1) | Train Loss: 1.4102 | Train Acc: 0.5780
 Site-Infograph                 (5) | Train Loss: 1.3927 | Train Acc: 0.5342
Average Train Accuracy: 0.8328
 Site-Clipart                   (2) | Val  Loss: 0.4536 | Val  Acc: 0.8684
 Site-Clipart                   (3) | Val  Loss: 0.5879 | Val  Acc: 0.8785
 Site-Clipart                   (3) | Val  Loss: 0.6449 | Val  Acc: 0.8467
 Site-Clipart                   (2) | Val  Loss: 0.6161 | Val  Acc: 0.8238
 Site-Clipart                   (2) | Val  Loss: 0.6739 | Val  Acc: 0.8407
 Site-Real                      (4) | Val  Loss: 0.3665 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.3621 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.3956 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.4174 | Val  Acc: 0.9394
 Site-Painting                  (5) | Val  Loss: 0.4361 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.4987 | Val  Acc: 0.8540
 Site-Painting                  (0) | Val  Loss: 0.5138 | Val  Acc: 0.8854
 Site-Sketch                    (3) | Val  Loss: 0.6114 | Val  Acc: 0.8268
 Site-Sketch                    (3) | Val  Loss: 0.6927 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.3859 | Val  Acc: 0.6101
 Site-Infograph                 (5) | Val  Loss: 1.2973 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8451
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8684
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8785
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8467
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8238
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8407
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9286
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9492
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9394
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.9388
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8540
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8854
 Best site-Sketch                   (3)  | Epoch:13 | Val Acc: 0.8268
 Best site-Sketch                   (3)  | Epoch:13 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.6101
 Best site-Infograph                (5)  | Epoch:13 | Val Acc: 0.5897
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 14 ============
cnt=[5, 1, 4, 3, 1, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (0) | Train Loss: 0.5806 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.5203 | Train Acc: 0.8820
 Site-Clipart                   (0) | Train Loss: 0.6058 | Train Acc: 0.8622
 Site-Clipart                   (0) | Train Loss: 0.5923 | Train Acc: 0.8386
 Site-Clipart                   (0) | Train Loss: 0.6003 | Train Acc: 0.8552
 Site-Real                      (2) | Train Loss: 0.4189 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.3504 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.3635 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.4152 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.5432 | Train Acc: 0.8571
 Site-Painting                  (3) | Train Loss: 0.6187 | Train Acc: 0.8495
 Site-Painting                  (3) | Train Loss: 0.5651 | Train Acc: 0.8581
 Site-Sketch                    (5) | Train Loss: 0.5958 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.7513 | Train Acc: 0.7978
 Site-QuickDraw                 (1) | Train Loss: 1.2614 | Train Acc: 0.6055
 Site-Infograph                 (4) | Train Loss: 1.3919 | Train Acc: 0.5342
Average Train Accuracy: 0.8372
 Site-Clipart                   (0) | Val  Loss: 0.4673 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.5444 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.5608 | Val  Acc: 0.8600
 Site-Clipart                   (0) | Val  Loss: 0.5787 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.6447 | Val  Acc: 0.8305
 Site-Real                      (2) | Val  Loss: 0.3617 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.3785 | Val  Acc: 0.9068
 Site-Real                      (2) | Val  Loss: 0.4090 | Val  Acc: 0.9030
 Site-Real                      (2) | Val  Loss: 0.3844 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.4658 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.5357 | Val  Acc: 0.8686
 Site-Painting                  (3) | Val  Loss: 0.5803 | Val  Acc: 0.8594
 Site-Sketch                    (5) | Val  Loss: 0.6489 | Val  Acc: 0.8268
 Site-Sketch                    (5) | Val  Loss: 0.7657 | Val  Acc: 0.7528
 Site-QuickDraw                 (1) | Val  Loss: 1.2790 | Val  Acc: 0.6560
 Site-Infograph                 (4) | Val  Loss: 1.2548 | Val  Acc: 0.6026
Average Valid Accuracy: 0.8429
============ Train epoch 15 ============
cnt=[1, 1, 5, 4, 2, 3, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (2) | Train Loss: 0.6051 | Train Acc: 0.8348
 Site-Clipart                   (2) | Train Loss: 0.4670 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.6199 | Train Acc: 0.8356
 Site-Clipart                   (2) | Train Loss: 0.5476 | Train Acc: 0.8639
 Site-Clipart                   (2) | Train Loss: 0.5749 | Train Acc: 0.8620
 Site-Real                      (3) | Train Loss: 0.4375 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.3418 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.3502 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.3892 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.5331 | Train Acc: 0.8571
 Site-Painting                  (5) | Train Loss: 0.4917 | Train Acc: 0.8544
 Site-Painting                  (5) | Train Loss: 0.5140 | Train Acc: 0.8962
 Site-Sketch                    (4) | Train Loss: 0.6006 | Train Acc: 0.8429
 Site-Sketch                    (4) | Train Loss: 0.6394 | Train Acc: 0.8502
 Site-QuickDraw                 (0) | Train Loss: 1.1549 | Train Acc: 0.6361
 Site-Infograph                 (1) | Train Loss: 1.3161 | Train Acc: 0.5726
Average Train Accuracy: 0.8479
 Site-Clipart                   (2) | Val  Loss: 0.4218 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.5216 | Val  Acc: 0.8598
 Site-Clipart                   (2) | Val  Loss: 0.5440 | Val  Acc: 0.8733
 Site-Clipart                   (2) | Val  Loss: 0.5547 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.6429 | Val  Acc: 0.8136
 Site-Real                      (3) | Val  Loss: 0.3457 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3802 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.3646 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3613 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.4205 | Val  Acc: 0.9082
 Site-Painting                  (5) | Val  Loss: 0.4896 | Val  Acc: 0.8759
 Site-Painting                  (5) | Val  Loss: 0.5254 | Val  Acc: 0.8646
 Site-Sketch                    (4) | Val  Loss: 0.6224 | Val  Acc: 0.8268
 Site-Sketch                    (4) | Val  Loss: 0.6402 | Val  Acc: 0.8090
 Site-QuickDraw                 (0) | Val  Loss: 1.3054 | Val  Acc: 0.6514
 Site-Infograph                 (1) | Val  Loss: 1.1849 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8508
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.9079
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8598
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8733
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8381
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8136
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9437
 Best site-Painting                 (5)  | Epoch:15 | Val Acc: 0.9082
 Best site-Painting                 (5)  | Epoch:15 | Val Acc: 0.8759
 Best site-Painting                 (5)  | Epoch:15 | Val Acc: 0.8646
 Best site-Sketch                   (4)  | Epoch:15 | Val Acc: 0.8268
 Best site-Sketch                   (4)  | Epoch:15 | Val Acc: 0.8090
 Best site-QuickDraw                (0)  | Epoch:15 | Val Acc: 0.6514
 Best site-Infograph                (1)  | Epoch:15 | Val Acc: 0.6474
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 1, 5, 4, 1, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (2) | Train Loss: 0.6148 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.4446 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.6140 | Train Acc: 0.8444
 Site-Clipart                   (2) | Train Loss: 0.5440 | Train Acc: 0.8608
 Site-Clipart                   (2) | Train Loss: 0.5405 | Train Acc: 0.8597
 Site-Real                      (3) | Train Loss: 0.4192 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.3399 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3286 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3800 | Train Acc: 0.9339
 Site-Painting                  (0) | Train Loss: 0.5547 | Train Acc: 0.8503
 Site-Painting                  (0) | Train Loss: 0.5777 | Train Acc: 0.8398
 Site-Painting                  (0) | Train Loss: 0.5322 | Train Acc: 0.8754
 Site-Sketch                    (5) | Train Loss: 0.5907 | Train Acc: 0.8325
 Site-Sketch                    (5) | Train Loss: 0.6856 | Train Acc: 0.8015
 Site-QuickDraw                 (1) | Train Loss: 1.1926 | Train Acc: 0.6514
 Site-Infograph                 (4) | Train Loss: 1.3478 | Train Acc: 0.5726
Average Train Accuracy: 0.8404
 Site-Clipart                   (2) | Val  Loss: 0.4351 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.4832 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.5545 | Val  Acc: 0.8467
 Site-Clipart                   (2) | Val  Loss: 0.5435 | Val  Acc: 0.8429
 Site-Clipart                   (2) | Val  Loss: 0.6233 | Val  Acc: 0.8271
 Site-Real                      (3) | Val  Loss: 0.3205 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.3168 | Val  Acc: 0.9661
 Site-Real                      (3) | Val  Loss: 0.3619 | Val  Acc: 0.9091
 Site-Real                      (3) | Val  Loss: 0.3417 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3768 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.4530 | Val  Acc: 0.8905
 Site-Painting                  (0) | Val  Loss: 0.5186 | Val  Acc: 0.8594
 Site-Sketch                    (5) | Val  Loss: 0.5738 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.6668 | Val  Acc: 0.7697
 Site-QuickDraw                 (1) | Val  Loss: 1.2210 | Val  Acc: 0.6789
 Site-Infograph                 (4) | Val  Loss: 1.2025 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8508
============ Train epoch 17 ============
cnt=[4, 1, 3, 4, 2, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (4) | Train Loss: 0.5153 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.4241 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.5745 | Train Acc: 0.8400
 Site-Clipart                   (4) | Train Loss: 0.5094 | Train Acc: 0.8639
 Site-Clipart                   (2) | Train Loss: 0.5489 | Train Acc: 0.8801
 Site-Real                      (3) | Train Loss: 0.3963 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.3118 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3095 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3458 | Train Acc: 0.9454
 Site-Painting                  (0) | Train Loss: 0.5067 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.4752 | Train Acc: 0.8544
 Site-Painting                  (0) | Train Loss: 0.4572 | Train Acc: 0.8893
 Site-Sketch                    (5) | Train Loss: 0.5636 | Train Acc: 0.8325
 Site-Sketch                    (5) | Train Loss: 0.5501 | Train Acc: 0.8090
 Site-QuickDraw                 (1) | Train Loss: 1.1558 | Train Acc: 0.6453
 Site-Infograph                 (0) | Train Loss: 1.3135 | Train Acc: 0.5641
Average Train Accuracy: 0.8502
 Site-Clipart                   (4) | Val  Loss: 0.4129 | Val  Acc: 0.8684
 Site-Clipart                   (2) | Val  Loss: 0.4582 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.5023 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.5490 | Val  Acc: 0.8286
 Site-Clipart                   (2) | Val  Loss: 0.6336 | Val  Acc: 0.8136
 Site-Real                      (3) | Val  Loss: 0.3082 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3449 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.3120 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.3258 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3733 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.4573 | Val  Acc: 0.8686
 Site-Painting                  (0) | Val  Loss: 0.4706 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.5734 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6514 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.2325 | Val  Acc: 0.6376
 Site-Infograph                 (0) | Val  Loss: 1.2575 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8536
 Best site-Clipart                  (4)  | Epoch:17 | Val Acc: 0.8684
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8867
 Best site-Clipart                  (4)  | Epoch:17 | Val Acc: 0.8286
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8136
 Best site-Real                     (3)  | Epoch:17 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:17 | Val Acc: 0.9492
 Best site-Real                     (3)  | Epoch:17 | Val Acc: 0.9333
 Best site-Real                     (3)  | Epoch:17 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:17 | Val Acc: 0.9286
 Best site-Painting                 (0)  | Epoch:17 | Val Acc: 0.8686
 Best site-Painting                 (0)  | Epoch:17 | Val Acc: 0.8854
 Best site-Sketch                   (5)  | Epoch:17 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:17 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:17 | Val Acc: 0.6376
 Best site-Infograph                (0)  | Epoch:17 | Val Acc: 0.6154
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 18 ============
cnt=[3, 1, 1, 4, 6, 1, ]
cnt=[1, 4, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (4) | Train Loss: 0.5516 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.4280 | Train Acc: 0.8944
 Site-Clipart                   (4) | Train Loss: 0.5929 | Train Acc: 0.8267
 Site-Clipart                   (4) | Train Loss: 0.5167 | Train Acc: 0.8608
 Site-Clipart                   (2) | Train Loss: 0.5347 | Train Acc: 0.8665
 Site-Real                      (3) | Train Loss: 0.3917 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.3136 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3053 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3546 | Train Acc: 0.9483
 Site-Painting                  (0) | Train Loss: 0.4842 | Train Acc: 0.8844
 Site-Painting                  (0) | Train Loss: 0.4721 | Train Acc: 0.8786
 Site-Painting                  (0) | Train Loss: 0.4573 | Train Acc: 0.8789
 Site-Sketch                    (4) | Train Loss: 0.6173 | Train Acc: 0.8429
 Site-Sketch                    (4) | Train Loss: 0.5270 | Train Acc: 0.8240
 Site-QuickDraw                 (1) | Train Loss: 1.0946 | Train Acc: 0.6820
 Site-Infograph                 (5) | Train Loss: 1.2594 | Train Acc: 0.6068
Average Train Accuracy: 0.8539
 Site-Clipart                   (4) | Val  Loss: 0.4251 | Val  Acc: 0.8947
 Site-Clipart                   (4) | Val  Loss: 0.4588 | Val  Acc: 0.8972
 Site-Clipart                   (4) | Val  Loss: 0.5605 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 0.5578 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.5710 | Val  Acc: 0.8508
 Site-Real                      (3) | Val  Loss: 0.3012 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3196 | Val  Acc: 0.9661
 Site-Real                      (3) | Val  Loss: 0.3402 | Val  Acc: 0.9091
 Site-Real                      (3) | Val  Loss: 0.3315 | Val  Acc: 0.9437
 Site-Painting                  (0) | Val  Loss: 0.4028 | Val  Acc: 0.8980
 Site-Painting                  (0) | Val  Loss: 0.4850 | Val  Acc: 0.8613
 Site-Painting                  (0) | Val  Loss: 0.4899 | Val  Acc: 0.8906
 Site-Sketch                    (4) | Val  Loss: 0.5255 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.6408 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.1900 | Val  Acc: 0.6881
 Site-Infograph                 (5) | Val  Loss: 1.1968 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8546
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8947
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8972
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8333
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8508
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9661
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9091
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9437
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8980
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8613
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8906
 Best site-Sketch                   (4)  | Epoch:18 | Val Acc: 0.8504
 Best site-Sketch                   (4)  | Epoch:18 | Val Acc: 0.7978
 Best site-QuickDraw                (1)  | Epoch:18 | Val Acc: 0.6881
 Best site-Infograph                (5)  | Epoch:18 | Val Acc: 0.6218
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 19 ============
cnt=[1, 1, 6, 4, 3, 1, ]
cnt=[2, 3, 5, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (2) | Train Loss: 0.5383 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.4307 | Train Acc: 0.8944
 Site-Clipart                   (2) | Train Loss: 0.5681 | Train Acc: 0.8533
 Site-Clipart                   (5) | Train Loss: 0.5121 | Train Acc: 0.8703
 Site-Clipart                   (2) | Train Loss: 0.5110 | Train Acc: 0.8846
 Site-Real                      (3) | Train Loss: 0.4012 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2812 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.3050 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.3344 | Train Acc: 0.9253
 Site-Painting                  (4) | Train Loss: 0.5804 | Train Acc: 0.8639
 Site-Painting                  (4) | Train Loss: 0.5364 | Train Acc: 0.8786
 Site-Painting                  (4) | Train Loss: 0.4514 | Train Acc: 0.8789
 Site-Sketch                    (2) | Train Loss: 0.5360 | Train Acc: 0.8639
 Site-Sketch                    (2) | Train Loss: 0.5851 | Train Acc: 0.8240
 Site-QuickDraw                 (1) | Train Loss: 1.1192 | Train Acc: 0.6636
 Site-Infograph                 (0) | Train Loss: 1.2514 | Train Acc: 0.5983
Average Train Accuracy: 0.8549
 Site-Clipart                   (2) | Val  Loss: 0.4189 | Val  Acc: 0.8553
 Site-Clipart                   (2) | Val  Loss: 0.4640 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.5117 | Val  Acc: 0.8667
 Site-Clipart                   (5) | Val  Loss: 0.5366 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.5927 | Val  Acc: 0.8475
 Site-Real                      (3) | Val  Loss: 0.2883 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3564 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.3183 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3043 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.3769 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.4543 | Val  Acc: 0.8832
 Site-Painting                  (4) | Val  Loss: 0.4644 | Val  Acc: 0.8854
 Site-Sketch                    (2) | Val  Loss: 0.6035 | Val  Acc: 0.8268
 Site-Sketch                    (2) | Val  Loss: 0.6680 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.1582 | Val  Acc: 0.6697
 Site-Infograph                 (0) | Val  Loss: 1.1992 | Val  Acc: 0.6026
Average Valid Accuracy: 0.8532
 Test site-Clipart                   (2)| Epoch:18 | Test Acc: 0.8536
 Test site-Real                      (3)| Epoch:18 | Test Acc: 0.9392
 Test site-Painting                  (4)| Epoch:18 | Test Acc: 0.9063
 Test site-Sketch                    (2)| Epoch:18 | Test Acc: 0.8574
 Test site-QuickDraw                 (1)| Epoch:18 | Test Acc: 0.6820
 Test site-Infograph                 (0)| Epoch:18 | Test Acc: 0.5449
Clipart: 0.8536, Real: 0.9392, Painting: 0.9063, Sketch: 0.8574, QuickDraw: 0.6820, Infograph: 0.5449, 
Average Test Accuracy(group): 0.7972, Average Test Accuracy(individual): 0.8553,
domain std=0.1389, cluster std=0.1387, individual std=0.1007, 
============ Train epoch 20 ============
cnt=[4, 1, 6, 1, 3, 1, ]
cnt=[4, 5, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (2) | Train Loss: 0.5036 | Train Acc: 0.8957
 Site-Clipart                   (2) | Train Loss: 0.4548 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.5389 | Train Acc: 0.8267
 Site-Clipart                   (5) | Train Loss: 0.5231 | Train Acc: 0.8418
 Site-Clipart                   (2) | Train Loss: 0.5294 | Train Acc: 0.8733
 Site-Real                      (0) | Train Loss: 0.3634 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2722 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2974 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.3455 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.5151 | Train Acc: 0.8844
 Site-Painting                  (4) | Train Loss: 0.4680 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.4478 | Train Acc: 0.8893
 Site-Sketch                    (2) | Train Loss: 0.5583 | Train Acc: 0.8220
 Site-Sketch                    (2) | Train Loss: 0.6555 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 1.1675 | Train Acc: 0.6881
 Site-Infograph                 (3) | Train Loss: 1.2446 | Train Acc: 0.5855
Average Train Accuracy: 0.8558
 Site-Clipart                   (2) | Val  Loss: 0.3813 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.4926 | Val  Acc: 0.8505
 Site-Clipart                   (2) | Val  Loss: 0.5367 | Val  Acc: 0.8533
 Site-Clipart                   (5) | Val  Loss: 0.4873 | Val  Acc: 0.8429
 Site-Clipart                   (2) | Val  Loss: 0.5759 | Val  Acc: 0.8475
 Site-Real                      (0) | Val  Loss: 0.2839 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.3124 | Val  Acc: 0.9661
 Site-Real                      (0) | Val  Loss: 0.3108 | Val  Acc: 0.9212
 Site-Real                      (0) | Val  Loss: 0.3211 | Val  Acc: 0.9437
 Site-Painting                  (4) | Val  Loss: 0.3620 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.4292 | Val  Acc: 0.8832
 Site-Painting                  (4) | Val  Loss: 0.4576 | Val  Acc: 0.8750
 Site-Sketch                    (2) | Val  Loss: 0.5265 | Val  Acc: 0.8425
 Site-Sketch                    (2) | Val  Loss: 0.5995 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 1.1214 | Val  Acc: 0.7202
 Site-Infograph                 (3) | Val  Loss: 1.1406 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8612
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8816
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8505
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8533
 Best site-Clipart                  (5)  | Epoch:20 | Val Acc: 0.8429
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8475
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9661
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9212
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9437
 Best site-Painting                 (4)  | Epoch:20 | Val Acc: 0.9286
 Best site-Painting                 (4)  | Epoch:20 | Val Acc: 0.8832
 Best site-Painting                 (4)  | Epoch:20 | Val Acc: 0.8750
 Best site-Sketch                   (2)  | Epoch:20 | Val Acc: 0.8425
 Best site-Sketch                   (2)  | Epoch:20 | Val Acc: 0.7921
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.7202
 Best site-Infograph                (3)  | Epoch:20 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 21 ============
cnt=[6, 1, 3, 4, 1, 1, ]
cnt=[2, 5, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.5060 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.4578 | Train Acc: 0.8820
 Site-Clipart                   (0) | Train Loss: 0.6035 | Train Acc: 0.8533
 Site-Clipart                   (0) | Train Loss: 0.4763 | Train Acc: 0.8734
 Site-Clipart                   (0) | Train Loss: 0.5001 | Train Acc: 0.8688
 Site-Real                      (3) | Train Loss: 0.3604 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2761 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3122 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.3451 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.5538 | Train Acc: 0.8571
 Site-Painting                  (2) | Train Loss: 0.5113 | Train Acc: 0.8738
 Site-Painting                  (2) | Train Loss: 0.4542 | Train Acc: 0.8824
 Site-Sketch                    (5) | Train Loss: 0.5510 | Train Acc: 0.8272
 Site-Sketch                    (0) | Train Loss: 0.6123 | Train Acc: 0.8127
 Site-QuickDraw                 (1) | Train Loss: 1.0597 | Train Acc: 0.6636
 Site-Infograph                 (4) | Train Loss: 1.2856 | Train Acc: 0.6026
Average Train Accuracy: 0.8502
 Site-Clipart                   (0) | Val  Loss: 0.4040 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.4283 | Val  Acc: 0.8879
 Site-Clipart                   (0) | Val  Loss: 0.4828 | Val  Acc: 0.8600
 Site-Clipart                   (0) | Val  Loss: 0.5115 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.5565 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.2854 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2891 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2997 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.3203 | Val  Acc: 0.9394
 Site-Painting                  (2) | Val  Loss: 0.3509 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.4283 | Val  Acc: 0.8832
 Site-Painting                  (2) | Val  Loss: 0.4431 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.5386 | Val  Acc: 0.8504
 Site-Sketch                    (0) | Val  Loss: 0.6071 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 1.1091 | Val  Acc: 0.6927
 Site-Infograph                 (4) | Val  Loss: 1.1577 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8582
============ Train epoch 22 ============
cnt=[4, 1, 3, 4, 1, 3, ]
cnt=[4, 5, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.5103 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.4019 | Train Acc: 0.9006
 Site-Clipart                   (5) | Train Loss: 0.5724 | Train Acc: 0.8489
 Site-Clipart                   (0) | Train Loss: 0.5008 | Train Acc: 0.8544
 Site-Clipart                   (0) | Train Loss: 0.5060 | Train Acc: 0.8733
 Site-Real                      (3) | Train Loss: 0.3605 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2722 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.3045 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.3392 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.4824 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.4712 | Train Acc: 0.8689
 Site-Painting                  (2) | Train Loss: 0.4233 | Train Acc: 0.8962
 Site-Sketch                    (5) | Train Loss: 0.5068 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.5187 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 1.0776 | Train Acc: 0.6789
 Site-Infograph                 (4) | Train Loss: 1.2226 | Train Acc: 0.5983
Average Train Accuracy: 0.8588
 Site-Clipart                   (0) | Val  Loss: 0.3366 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.4289 | Val  Acc: 0.8972
 Site-Clipart                   (5) | Val  Loss: 0.4395 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.5087 | Val  Acc: 0.8286
 Site-Clipart                   (0) | Val  Loss: 0.5605 | Val  Acc: 0.8441
 Site-Real                      (3) | Val  Loss: 0.2801 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3022 | Val  Acc: 0.9661
 Site-Real                      (3) | Val  Loss: 0.3105 | Val  Acc: 0.9091
 Site-Real                      (3) | Val  Loss: 0.2965 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.3241 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3933 | Val  Acc: 0.8978
 Site-Painting                  (2) | Val  Loss: 0.4591 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.5448 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.5757 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 1.0877 | Val  Acc: 0.6651
 Site-Infograph                 (4) | Val  Loss: 1.0965 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8606
============ Train epoch 23 ============
cnt=[4, 1, 6, 3, 1, 1, ]
cnt=[5, 4, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.4726 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.4027 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.5190 | Train Acc: 0.8356
 Site-Clipart                   (2) | Train Loss: 0.4743 | Train Acc: 0.8576
 Site-Clipart                   (2) | Train Loss: 0.5261 | Train Acc: 0.8507
 Site-Real                      (0) | Train Loss: 0.3687 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2672 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2861 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.3056 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.4727 | Train Acc: 0.8639
 Site-Painting                  (3) | Train Loss: 0.4162 | Train Acc: 0.8641
 Site-Painting                  (3) | Train Loss: 0.3759 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.5487 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.6098 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 1.0162 | Train Acc: 0.6942
 Site-Infograph                 (4) | Train Loss: 1.2205 | Train Acc: 0.5812
Average Train Accuracy: 0.8541
 Site-Clipart                   (2) | Val  Loss: 0.3228 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.4145 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.4248 | Val  Acc: 0.8733
 Site-Clipart                   (2) | Val  Loss: 0.4631 | Val  Acc: 0.8619
 Site-Clipart                   (2) | Val  Loss: 0.5590 | Val  Acc: 0.8271
 Site-Real                      (0) | Val  Loss: 0.2394 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2765 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2545 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2783 | Val  Acc: 0.9654
 Site-Painting                  (3) | Val  Loss: 0.3279 | Val  Acc: 0.9388
 Site-Painting                  (3) | Val  Loss: 0.3775 | Val  Acc: 0.9197
 Site-Painting                  (3) | Val  Loss: 0.4318 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.5061 | Val  Acc: 0.8504
 Site-Sketch                    (2) | Val  Loss: 0.5415 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 1.0570 | Val  Acc: 0.7294
 Site-Infograph                 (4) | Val  Loss: 1.1319 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8748
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8816
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.9159
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8733
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8619
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8271
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9492
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9455
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9654
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.9388
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.9197
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.8906
 Best site-Sketch                   (5)  | Epoch:23 | Val Acc: 0.8504
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8371
 Best site-QuickDraw                (1)  | Epoch:23 | Val Acc: 0.7294
 Best site-Infograph                (4)  | Epoch:23 | Val Acc: 0.6474
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 5, 3, 1, 4, 2, ]
cnt=[5, 4, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (1) | Train Loss: 0.5202 | Train Acc: 0.8522
 Site-Clipart                   (1) | Train Loss: 0.3662 | Train Acc: 0.9317
 Site-Clipart                   (1) | Train Loss: 0.5374 | Train Acc: 0.8578
 Site-Clipart                   (1) | Train Loss: 0.4730 | Train Acc: 0.8608
 Site-Clipart                   (1) | Train Loss: 0.4741 | Train Acc: 0.8733
 Site-Real                      (4) | Train Loss: 0.3640 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2883 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2742 | Train Acc: 0.9556
 Site-Real                      (4) | Train Loss: 0.3223 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.5309 | Train Acc: 0.8571
 Site-Painting                  (2) | Train Loss: 0.4717 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.4308 | Train Acc: 0.8893
 Site-Sketch                    (5) | Train Loss: 0.5198 | Train Acc: 0.8429
 Site-Sketch                    (5) | Train Loss: 0.5041 | Train Acc: 0.8427
 Site-QuickDraw                 (0) | Train Loss: 0.9307 | Train Acc: 0.7064
 Site-Infograph                 (3) | Train Loss: 1.1712 | Train Acc: 0.6154
Average Train Accuracy: 0.8600
 Site-Clipart                   (1) | Val  Loss: 0.3623 | Val  Acc: 0.9079
 Site-Clipart                   (1) | Val  Loss: 0.4170 | Val  Acc: 0.8972
 Site-Clipart                   (1) | Val  Loss: 0.4863 | Val  Acc: 0.8533
 Site-Clipart                   (1) | Val  Loss: 0.4879 | Val  Acc: 0.8381
 Site-Clipart                   (1) | Val  Loss: 0.5362 | Val  Acc: 0.8475
 Site-Real                      (4) | Val  Loss: 0.2837 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.3027 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.3119 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.3174 | Val  Acc: 0.9394
 Site-Painting                  (2) | Val  Loss: 0.3374 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3854 | Val  Acc: 0.8905
 Site-Painting                  (2) | Val  Loss: 0.4457 | Val  Acc: 0.8750
 Site-Sketch                    (5) | Val  Loss: 0.5259 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5659 | Val  Acc: 0.8090
 Site-QuickDraw                 (0) | Val  Loss: 0.9857 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 1.0642 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8716
============ Train epoch 25 ============
cnt=[2, 3, 1, 5, 4, 1, ]
cnt=[5, 3, 1, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (3) | Train Loss: 0.4501 | Train Acc: 0.8783
 Site-Clipart                   (3) | Train Loss: 0.3463 | Train Acc: 0.9255
 Site-Clipart                   (3) | Train Loss: 0.5505 | Train Acc: 0.8533
 Site-Clipart                   (3) | Train Loss: 0.4783 | Train Acc: 0.8766
 Site-Clipart                   (3) | Train Loss: 0.4826 | Train Acc: 0.8824
 Site-Real                      (4) | Train Loss: 0.3787 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2576 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.3116 | Train Acc: 0.9315
 Site-Real                      (4) | Train Loss: 0.3399 | Train Acc: 0.9282
 Site-Painting                  (1) | Train Loss: 0.4860 | Train Acc: 0.8707
 Site-Painting                  (1) | Train Loss: 0.5307 | Train Acc: 0.8738
 Site-Painting                  (1) | Train Loss: 0.4581 | Train Acc: 0.8927
 Site-Sketch                    (0) | Train Loss: 0.5033 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.6021 | Train Acc: 0.8502
 Site-QuickDraw                 (2) | Train Loss: 0.9285 | Train Acc: 0.7095
 Site-Infograph                 (5) | Train Loss: 1.1664 | Train Acc: 0.6068
Average Train Accuracy: 0.8628
 Site-Clipart                   (3) | Val  Loss: 0.3832 | Val  Acc: 0.8684
 Site-Clipart                   (3) | Val  Loss: 0.4245 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.4459 | Val  Acc: 0.8667
 Site-Clipart                   (3) | Val  Loss: 0.4762 | Val  Acc: 0.8381
 Site-Clipart                   (3) | Val  Loss: 0.5500 | Val  Acc: 0.8678
 Site-Real                      (4) | Val  Loss: 0.2785 | Val  Acc: 0.9167
 Site-Real                      (4) | Val  Loss: 0.2928 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.3065 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.3145 | Val  Acc: 0.9481
 Site-Painting                  (1) | Val  Loss: 0.3304 | Val  Acc: 0.9490
 Site-Painting                  (1) | Val  Loss: 0.4021 | Val  Acc: 0.9124
 Site-Painting                  (1) | Val  Loss: 0.4419 | Val  Acc: 0.8854
 Site-Sketch                    (0) | Val  Loss: 0.4916 | Val  Acc: 0.8819
 Site-Sketch                    (0) | Val  Loss: 0.5757 | Val  Acc: 0.8202
 Site-QuickDraw                 (2) | Val  Loss: 1.0271 | Val  Acc: 0.7156
 Site-Infograph                 (5) | Val  Loss: 1.1184 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8685
============ Train epoch 26 ============
cnt=[3, 1, 5, 4, 1, 2, ]
cnt=[3, 5, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (2) | Train Loss: 0.4926 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.4050 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.4858 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.4670 | Train Acc: 0.8734
 Site-Clipart                   (2) | Train Loss: 0.4964 | Train Acc: 0.8710
 Site-Real                      (3) | Train Loss: 0.3443 | Train Acc: 0.8889
 Site-Real                      (3) | Train Loss: 0.2621 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2772 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3270 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4694 | Train Acc: 0.8639
 Site-Painting                  (0) | Train Loss: 0.4259 | Train Acc: 0.8786
 Site-Painting                  (0) | Train Loss: 0.4387 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.5002 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.5066 | Train Acc: 0.8240
 Site-QuickDraw                 (1) | Train Loss: 0.9219 | Train Acc: 0.6942
 Site-Infograph                 (4) | Train Loss: 1.1579 | Train Acc: 0.6282
Average Train Accuracy: 0.8588
 Site-Clipart                   (2) | Val  Loss: 0.3578 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.4162 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.4520 | Val  Acc: 0.8533
 Site-Clipart                   (2) | Val  Loss: 0.4511 | Val  Acc: 0.8619
 Site-Clipart                   (2) | Val  Loss: 0.5400 | Val  Acc: 0.8678
 Site-Real                      (3) | Val  Loss: 0.2790 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2868 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.2745 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2843 | Val  Acc: 0.9610
 Site-Painting                  (0) | Val  Loss: 0.3206 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.3659 | Val  Acc: 0.8832
 Site-Painting                  (0) | Val  Loss: 0.4423 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.4877 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.6007 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.0199 | Val  Acc: 0.7339
 Site-Infograph                 (4) | Val  Loss: 1.1357 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8686
============ Train epoch 27 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (4) | Train Loss: 0.4594 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3836 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.5288 | Train Acc: 0.8667
 Site-Clipart                   (4) | Train Loss: 0.4513 | Train Acc: 0.8576
 Site-Clipart                   (4) | Train Loss: 0.4799 | Train Acc: 0.8778
 Site-Real                      (0) | Train Loss: 0.3153 | Train Acc: 0.9286
 Site-Real                      (0) | Train Loss: 0.2491 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2634 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.3122 | Train Acc: 0.9282
 Site-Painting                  (5) | Train Loss: 0.5029 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.4418 | Train Acc: 0.8883
 Site-Painting                  (5) | Train Loss: 0.3680 | Train Acc: 0.9170
 Site-Sketch                    (2) | Train Loss: 0.4950 | Train Acc: 0.8482
 Site-Sketch                    (2) | Train Loss: 0.5421 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.9458 | Train Acc: 0.6820
 Site-Infograph                 (3) | Train Loss: 1.1683 | Train Acc: 0.6068
Average Train Accuracy: 0.8622
 Site-Clipart                   (4) | Val  Loss: 0.3217 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.3946 | Val  Acc: 0.9252
 Site-Clipart                   (4) | Val  Loss: 0.4589 | Val  Acc: 0.8600
 Site-Clipart                   (4) | Val  Loss: 0.4829 | Val  Acc: 0.8381
 Site-Clipart                   (4) | Val  Loss: 0.5513 | Val  Acc: 0.8407
 Site-Real                      (0) | Val  Loss: 0.2499 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.3102 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.3067 | Val  Acc: 0.9152
 Site-Real                      (0) | Val  Loss: 0.2831 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.3101 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.3465 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.3811 | Val  Acc: 0.8802
 Site-Sketch                    (2) | Val  Loss: 0.5356 | Val  Acc: 0.8268
 Site-Sketch                    (2) | Val  Loss: 0.6152 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.0119 | Val  Acc: 0.7064
 Site-Infograph                 (3) | Val  Loss: 1.1211 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8621
============ Train epoch 28 ============
cnt=[2, 1, 7, 1, 2, 3, ]
cnt=[4, 1, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (5) | Train Loss: 0.4030 | Train Acc: 0.8870
 Site-Clipart                   (5) | Train Loss: 0.3628 | Train Acc: 0.9441
 Site-Clipart                   (5) | Train Loss: 0.4866 | Train Acc: 0.8756
 Site-Clipart                   (0) | Train Loss: 0.4400 | Train Acc: 0.8703
 Site-Clipart                   (0) | Train Loss: 0.4313 | Train Acc: 0.8959
 Site-Real                      (2) | Train Loss: 0.3442 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.2452 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2669 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2772 | Train Acc: 0.9483
 Site-Painting                  (2) | Train Loss: 0.4752 | Train Acc: 0.8639
 Site-Painting                  (2) | Train Loss: 0.4719 | Train Acc: 0.8689
 Site-Painting                  (2) | Train Loss: 0.3963 | Train Acc: 0.9135
 Site-Sketch                    (4) | Train Loss: 0.5026 | Train Acc: 0.8377
 Site-Sketch                    (4) | Train Loss: 0.4971 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.8832 | Train Acc: 0.7156
 Site-Infograph                 (3) | Train Loss: 1.1301 | Train Acc: 0.6068
Average Train Accuracy: 0.8659
 Site-Clipart                   (5) | Val  Loss: 0.2629 | Val  Acc: 0.9474
 Site-Clipart                   (5) | Val  Loss: 0.3684 | Val  Acc: 0.9065
 Site-Clipart                   (5) | Val  Loss: 0.4356 | Val  Acc: 0.8533
 Site-Clipart                   (0) | Val  Loss: 0.4570 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.5177 | Val  Acc: 0.8441
 Site-Real                      (2) | Val  Loss: 0.2572 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2315 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.2671 | Val  Acc: 0.9212
 Site-Real                      (2) | Val  Loss: 0.2738 | Val  Acc: 0.9351
 Site-Painting                  (2) | Val  Loss: 0.3036 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3553 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.4323 | Val  Acc: 0.8906
 Site-Sketch                    (4) | Val  Loss: 0.4759 | Val  Acc: 0.8661
 Site-Sketch                    (4) | Val  Loss: 0.6006 | Val  Acc: 0.7753
 Site-QuickDraw                 (1) | Val  Loss: 0.9937 | Val  Acc: 0.7615
 Site-Infograph                 (3) | Val  Loss: 1.0838 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8746
============ Train epoch 29 ============
cnt=[1, 2, 1, 3, 4, 5, ]
cnt=[4, 1, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (5) | Train Loss: 0.4556 | Train Acc: 0.8696
 Site-Clipart                   (5) | Train Loss: 0.4159 | Train Acc: 0.8696
 Site-Clipart                   (5) | Train Loss: 0.4975 | Train Acc: 0.8667
 Site-Clipart                   (5) | Train Loss: 0.4369 | Train Acc: 0.8671
 Site-Clipart                   (5) | Train Loss: 0.4327 | Train Acc: 0.8959
 Site-Real                      (4) | Train Loss: 0.3286 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.2513 | Train Acc: 0.9379
 Site-Real                      (4) | Train Loss: 0.2409 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2768 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.3682 | Train Acc: 0.8639
 Site-Painting                  (3) | Train Loss: 0.4335 | Train Acc: 0.8641
 Site-Painting                  (3) | Train Loss: 0.3727 | Train Acc: 0.9273
 Site-Sketch                    (1) | Train Loss: 0.4998 | Train Acc: 0.8586
 Site-Sketch                    (1) | Train Loss: 0.4969 | Train Acc: 0.8315
 Site-QuickDraw                 (2) | Train Loss: 0.9049 | Train Acc: 0.7309
 Site-Infograph                 (0) | Train Loss: 1.0586 | Train Acc: 0.6496
Average Train Accuracy: 0.8648
 Site-Clipart                   (5) | Val  Loss: 0.3006 | Val  Acc: 0.9079
 Site-Clipart                   (5) | Val  Loss: 0.3699 | Val  Acc: 0.9252
 Site-Clipart                   (5) | Val  Loss: 0.4241 | Val  Acc: 0.8800
 Site-Clipart                   (5) | Val  Loss: 0.4521 | Val  Acc: 0.8476
 Site-Clipart                   (5) | Val  Loss: 0.5223 | Val  Acc: 0.8407
 Site-Real                      (4) | Val  Loss: 0.2567 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2799 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.2796 | Val  Acc: 0.9152
 Site-Real                      (4) | Val  Loss: 0.2572 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.3225 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.2931 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.3677 | Val  Acc: 0.9010
 Site-Sketch                    (1) | Val  Loss: 0.5150 | Val  Acc: 0.8425
 Site-Sketch                    (1) | Val  Loss: 0.5681 | Val  Acc: 0.8034
 Site-QuickDraw                 (2) | Val  Loss: 0.9607 | Val  Acc: 0.7156
 Site-Infograph                 (0) | Val  Loss: 1.0423 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8696
 Test site-Clipart                   (5)| Epoch:23 | Test Acc: 0.8555
 Test site-Real                      (4)| Epoch:23 | Test Acc: 0.9408
 Test site-Painting                  (3)| Epoch:23 | Test Acc: 0.9128
 Test site-Sketch                    (1)| Epoch:23 | Test Acc: 0.8574
 Test site-QuickDraw                 (2)| Epoch:23 | Test Acc: 0.7240
 Test site-Infograph                 (0)| Epoch:23 | Test Acc: 0.5601
Clipart: 0.8555, Real: 0.9408, Painting: 0.9128, Sketch: 0.8574, QuickDraw: 0.7240, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8084, Average Test Accuracy(individual): 0.8611,
domain std=0.1303, cluster std=0.1303, individual std=0.0945, 
============ Train epoch 30 ============
cnt=[5, 1, 3, 4, 1, 2, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (0) | Train Loss: 0.4532 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.3261 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.4775 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.4085 | Train Acc: 0.8766
 Site-Clipart                   (0) | Train Loss: 0.4353 | Train Acc: 0.8778
 Site-Real                      (3) | Train Loss: 0.3325 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2334 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2535 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.2857 | Train Acc: 0.9339
 Site-Painting                  (2) | Train Loss: 0.3573 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3721 | Train Acc: 0.9078
 Site-Painting                  (2) | Train Loss: 0.3673 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.4520 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.5539 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 0.9522 | Train Acc: 0.7492
 Site-Infograph                 (4) | Train Loss: 1.1047 | Train Acc: 0.6239
Average Train Accuracy: 0.8720
 Site-Clipart                   (0) | Val  Loss: 0.2754 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3467 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.4022 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.4195 | Val  Acc: 0.8524
 Site-Clipart                   (0) | Val  Loss: 0.5046 | Val  Acc: 0.8678
 Site-Real                      (3) | Val  Loss: 0.2458 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2276 | Val  Acc: 0.9661
 Site-Real                      (3) | Val  Loss: 0.2198 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2580 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2883 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3386 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.4002 | Val  Acc: 0.8750
 Site-Sketch                    (5) | Val  Loss: 0.5048 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5621 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.9648 | Val  Acc: 0.7477
 Site-Infograph                 (4) | Val  Loss: 1.1069 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8761
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.9342
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.9065
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8800
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8524
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8678
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9661
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9455
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9481
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9388
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9197
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.8750
 Best site-Sketch                   (5)  | Epoch:30 | Val Acc: 0.8583
 Best site-Sketch                   (5)  | Epoch:30 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:30 | Val Acc: 0.7477
 Best site-Infograph                (4)  | Epoch:30 | Val Acc: 0.6346
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 31 ============
cnt=[4, 1, 3, 1, 4, 3, ]
cnt=[5, 4, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (2) | Train Loss: 0.4220 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.3018 | Train Acc: 0.9255
 Site-Clipart                   (4) | Train Loss: 0.5388 | Train Acc: 0.8489
 Site-Clipart                   (2) | Train Loss: 0.4586 | Train Acc: 0.8608
 Site-Clipart                   (2) | Train Loss: 0.4314 | Train Acc: 0.8959
 Site-Real                      (0) | Train Loss: 0.3438 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2440 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2365 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2883 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.4571 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.3406 | Train Acc: 0.9078
 Site-Painting                  (5) | Train Loss: 0.3832 | Train Acc: 0.9100
 Site-Sketch                    (4) | Train Loss: 0.5095 | Train Acc: 0.8429
 Site-Sketch                    (4) | Train Loss: 0.5336 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 0.8037 | Train Acc: 0.7431
 Site-Infograph                 (3) | Train Loss: 1.1176 | Train Acc: 0.6154
Average Train Accuracy: 0.8661
 Site-Clipart                   (2) | Val  Loss: 0.3002 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.3709 | Val  Acc: 0.9065
 Site-Clipart                   (4) | Val  Loss: 0.4168 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.4154 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.5056 | Val  Acc: 0.8373
 Site-Real                      (0) | Val  Loss: 0.2466 | Val  Acc: 0.9167
 Site-Real                      (0) | Val  Loss: 0.2532 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2375 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2684 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2877 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.3525 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.3782 | Val  Acc: 0.8906
 Site-Sketch                    (4) | Val  Loss: 0.4772 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.5296 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 0.9252 | Val  Acc: 0.7523
 Site-Infograph                 (3) | Val  Loss: 1.0110 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8700
============ Train epoch 32 ============
cnt=[1, 4, 1, 5, 3, 2, ]
cnt=[1, 5, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (3) | Train Loss: 0.4907 | Train Acc: 0.8435
 Site-Clipart                   (3) | Train Loss: 0.3374 | Train Acc: 0.9503
 Site-Clipart                   (3) | Train Loss: 0.5218 | Train Acc: 0.8489
 Site-Clipart                   (3) | Train Loss: 0.4304 | Train Acc: 0.8892
 Site-Clipart                   (3) | Train Loss: 0.4291 | Train Acc: 0.8846
 Site-Real                      (1) | Train Loss: 0.3295 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.2606 | Train Acc: 0.9322
 Site-Real                      (1) | Train Loss: 0.2638 | Train Acc: 0.9516
 Site-Real                      (1) | Train Loss: 0.3003 | Train Acc: 0.9425
 Site-Painting                  (4) | Train Loss: 0.3921 | Train Acc: 0.8776
 Site-Painting                  (4) | Train Loss: 0.4073 | Train Acc: 0.8981
 Site-Painting                  (4) | Train Loss: 0.3853 | Train Acc: 0.9031
 Site-Sketch                    (5) | Train Loss: 0.4550 | Train Acc: 0.8639
 Site-Sketch                    (5) | Train Loss: 0.5220 | Train Acc: 0.8464
 Site-QuickDraw                 (0) | Train Loss: 0.8795 | Train Acc: 0.7431
 Site-Infograph                 (2) | Train Loss: 1.0495 | Train Acc: 0.6667
Average Train Accuracy: 0.8717
 Site-Clipart                   (3) | Val  Loss: 0.3007 | Val  Acc: 0.9474
 Site-Clipart                   (3) | Val  Loss: 0.3868 | Val  Acc: 0.9252
 Site-Clipart                   (3) | Val  Loss: 0.4009 | Val  Acc: 0.8667
 Site-Clipart                   (3) | Val  Loss: 0.4486 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.5122 | Val  Acc: 0.8542
 Site-Real                      (1) | Val  Loss: 0.2384 | Val  Acc: 0.9643
 Site-Real                      (1) | Val  Loss: 0.2731 | Val  Acc: 0.9661
 Site-Real                      (1) | Val  Loss: 0.2787 | Val  Acc: 0.9091
 Site-Real                      (1) | Val  Loss: 0.2741 | Val  Acc: 0.9481
 Site-Painting                  (4) | Val  Loss: 0.2427 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.4015 | Val  Acc: 0.8905
 Site-Painting                  (4) | Val  Loss: 0.3927 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.4835 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5604 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 0.9235 | Val  Acc: 0.7385
 Site-Infograph                 (2) | Val  Loss: 1.0159 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8799
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.9474
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.9252
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.8667
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.8571
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.8542
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9643
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9661
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9091
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9481
 Best site-Painting                 (4)  | Epoch:32 | Val Acc: 0.9490
 Best site-Painting                 (4)  | Epoch:32 | Val Acc: 0.8905
 Best site-Painting                 (4)  | Epoch:32 | Val Acc: 0.8906
 Best site-Sketch                   (5)  | Epoch:32 | Val Acc: 0.8661
 Best site-Sketch                   (5)  | Epoch:32 | Val Acc: 0.8202
 Best site-QuickDraw                (0)  | Epoch:32 | Val Acc: 0.7385
 Best site-Infograph                (2)  | Epoch:32 | Val Acc: 0.6859
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 1, 4, 1, 5, 3, ]
cnt=[5, 4, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (4) | Train Loss: 0.4383 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.3135 | Train Acc: 0.9317
 Site-Clipart                   (4) | Train Loss: 0.4387 | Train Acc: 0.8667
 Site-Clipart                   (4) | Train Loss: 0.4058 | Train Acc: 0.8734
 Site-Clipart                   (4) | Train Loss: 0.4166 | Train Acc: 0.8846
 Site-Real                      (2) | Train Loss: 0.3681 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.2364 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.2635 | Train Acc: 0.9355
 Site-Real                      (2) | Train Loss: 0.2974 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.4305 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.4149 | Train Acc: 0.8786
 Site-Painting                  (5) | Train Loss: 0.3494 | Train Acc: 0.9135
 Site-Sketch                    (0) | Train Loss: 0.4764 | Train Acc: 0.8482
 Site-Sketch                    (0) | Train Loss: 0.4580 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.8686 | Train Acc: 0.7278
 Site-Infograph                 (3) | Train Loss: 1.0888 | Train Acc: 0.6538
Average Train Accuracy: 0.8687
 Site-Clipart                   (4) | Val  Loss: 0.3327 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.3658 | Val  Acc: 0.9065
 Site-Clipart                   (4) | Val  Loss: 0.3779 | Val  Acc: 0.8933
 Site-Clipart                   (4) | Val  Loss: 0.4165 | Val  Acc: 0.8714
 Site-Clipart                   (4) | Val  Loss: 0.5210 | Val  Acc: 0.8407
 Site-Real                      (2) | Val  Loss: 0.2314 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2331 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2739 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.2580 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2457 | Val  Acc: 0.9694
 Site-Painting                  (5) | Val  Loss: 0.3298 | Val  Acc: 0.8905
 Site-Painting                  (5) | Val  Loss: 0.3517 | Val  Acc: 0.9062
 Site-Sketch                    (0) | Val  Loss: 0.5046 | Val  Acc: 0.8740
 Site-Sketch                    (0) | Val  Loss: 0.5499 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8986 | Val  Acc: 0.7339
 Site-Infograph                 (3) | Val  Loss: 1.0885 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8780
============ Train epoch 34 ============
cnt=[1, 4, 5, 1, 3, 2, ]
cnt=[5, 4, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (2) | Train Loss: 0.3851 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.3240 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.4144 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.3997 | Train Acc: 0.8924
 Site-Clipart                   (2) | Train Loss: 0.4326 | Train Acc: 0.8778
 Site-Real                      (1) | Train Loss: 0.3489 | Train Acc: 0.9286
 Site-Real                      (1) | Train Loss: 0.2332 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.2291 | Train Acc: 0.9476
 Site-Real                      (1) | Train Loss: 0.3185 | Train Acc: 0.9397
 Site-Painting                  (4) | Train Loss: 0.4912 | Train Acc: 0.8707
 Site-Painting                  (4) | Train Loss: 0.4671 | Train Acc: 0.8883
 Site-Painting                  (4) | Train Loss: 0.3718 | Train Acc: 0.8927
 Site-Sketch                    (5) | Train Loss: 0.5299 | Train Acc: 0.8220
 Site-Sketch                    (5) | Train Loss: 0.4865 | Train Acc: 0.8464
 Site-QuickDraw                 (0) | Train Loss: 0.8902 | Train Acc: 0.7523
 Site-Infograph                 (3) | Train Loss: 1.0319 | Train Acc: 0.6709
Average Train Accuracy: 0.8738
 Site-Clipart                   (2) | Val  Loss: 0.2854 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3042 | Val  Acc: 0.9439
 Site-Clipart                   (2) | Val  Loss: 0.3822 | Val  Acc: 0.8467
 Site-Clipart                   (2) | Val  Loss: 0.4112 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.4913 | Val  Acc: 0.8576
 Site-Real                      (1) | Val  Loss: 0.2361 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2507 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2578 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.2849 | Val  Acc: 0.9394
 Site-Painting                  (4) | Val  Loss: 0.2839 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.2859 | Val  Acc: 0.9270
 Site-Painting                  (4) | Val  Loss: 0.3627 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4425 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5268 | Val  Acc: 0.8090
 Site-QuickDraw                 (0) | Val  Loss: 0.9076 | Val  Acc: 0.7294
 Site-Infograph                 (3) | Val  Loss: 1.0061 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8756
============ Train epoch 35 ============
cnt=[4, 1, 2, 1, 3, 5, ]
cnt=[1, 4, 2, 3, 5, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (5) | Train Loss: 0.4141 | Train Acc: 0.8870
 Site-Clipart                   (5) | Train Loss: 0.2959 | Train Acc: 0.9193
 Site-Clipart                   (5) | Train Loss: 0.4707 | Train Acc: 0.8889
 Site-Clipart                   (5) | Train Loss: 0.4379 | Train Acc: 0.8703
 Site-Clipart                   (5) | Train Loss: 0.4148 | Train Acc: 0.9027
 Site-Real                      (0) | Train Loss: 0.3050 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2348 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2274 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2979 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.4234 | Train Acc: 0.8707
 Site-Painting                  (4) | Train Loss: 0.3965 | Train Acc: 0.8786
 Site-Painting                  (4) | Train Loss: 0.3557 | Train Acc: 0.9135
 Site-Sketch                    (2) | Train Loss: 0.4637 | Train Acc: 0.8482
 Site-Sketch                    (2) | Train Loss: 0.4646 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.8943 | Train Acc: 0.7920
 Site-Infograph                 (3) | Train Loss: 1.0090 | Train Acc: 0.6709
Average Train Accuracy: 0.8782
 Site-Clipart                   (5) | Val  Loss: 0.2904 | Val  Acc: 0.8947
 Site-Clipart                   (5) | Val  Loss: 0.3827 | Val  Acc: 0.8972
 Site-Clipart                   (5) | Val  Loss: 0.3764 | Val  Acc: 0.8800
 Site-Clipart                   (5) | Val  Loss: 0.4397 | Val  Acc: 0.8667
 Site-Clipart                   (5) | Val  Loss: 0.4884 | Val  Acc: 0.8441
 Site-Real                      (0) | Val  Loss: 0.2290 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2527 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2406 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2593 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2449 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.3037 | Val  Acc: 0.9197
 Site-Painting                  (4) | Val  Loss: 0.3880 | Val  Acc: 0.8854
 Site-Sketch                    (2) | Val  Loss: 0.4011 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.5029 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.8894 | Val  Acc: 0.7385
 Site-Infograph                 (3) | Val  Loss: 1.0290 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8793
============ Train epoch 36 ============
cnt=[3, 1, 2, 1, 4, 5, ]
cnt=[3, 5, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (5) | Train Loss: 0.3850 | Train Acc: 0.8696
 Site-Clipart                   (5) | Train Loss: 0.3162 | Train Acc: 0.9379
 Site-Clipart                   (5) | Train Loss: 0.4845 | Train Acc: 0.8800
 Site-Clipart                   (5) | Train Loss: 0.4166 | Train Acc: 0.8639
 Site-Clipart                   (5) | Train Loss: 0.3992 | Train Acc: 0.8937
 Site-Real                      (4) | Train Loss: 0.3185 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.2429 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2173 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2634 | Train Acc: 0.9454
 Site-Painting                  (0) | Train Loss: 0.3995 | Train Acc: 0.8844
 Site-Painting                  (0) | Train Loss: 0.4210 | Train Acc: 0.8932
 Site-Painting                  (0) | Train Loss: 0.3322 | Train Acc: 0.9031
 Site-Sketch                    (2) | Train Loss: 0.4753 | Train Acc: 0.8482
 Site-Sketch                    (2) | Train Loss: 0.5605 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.8696 | Train Acc: 0.7462
 Site-Infograph                 (3) | Train Loss: 1.0234 | Train Acc: 0.6838
Average Train Accuracy: 0.8768
 Site-Clipart                   (5) | Val  Loss: 0.2771 | Val  Acc: 0.9211
 Site-Clipart                   (5) | Val  Loss: 0.3461 | Val  Acc: 0.8972
 Site-Clipart                   (5) | Val  Loss: 0.3771 | Val  Acc: 0.9000
 Site-Clipart                   (5) | Val  Loss: 0.4155 | Val  Acc: 0.8619
 Site-Clipart                   (5) | Val  Loss: 0.4351 | Val  Acc: 0.8814
 Site-Real                      (4) | Val  Loss: 0.2278 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2338 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2735 | Val  Acc: 0.9152
 Site-Real                      (4) | Val  Loss: 0.2573 | Val  Acc: 0.9394
 Site-Painting                  (0) | Val  Loss: 0.2665 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.2892 | Val  Acc: 0.8905
 Site-Painting                  (0) | Val  Loss: 0.3702 | Val  Acc: 0.9167
 Site-Sketch                    (2) | Val  Loss: 0.4376 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.5395 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 0.8890 | Val  Acc: 0.7615
 Site-Infograph                 (3) | Val  Loss: 1.0276 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8800
 Best site-Clipart                  (5)  | Epoch:36 | Val Acc: 0.9211
 Best site-Clipart                  (5)  | Epoch:36 | Val Acc: 0.8972
 Best site-Clipart                  (5)  | Epoch:36 | Val Acc: 0.9000
 Best site-Clipart                  (5)  | Epoch:36 | Val Acc: 0.8619
 Best site-Clipart                  (5)  | Epoch:36 | Val Acc: 0.8814
 Best site-Real                     (4)  | Epoch:36 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:36 | Val Acc: 0.9492
 Best site-Real                     (4)  | Epoch:36 | Val Acc: 0.9152
 Best site-Real                     (4)  | Epoch:36 | Val Acc: 0.9394
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9286
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.8905
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9167
 Best site-Sketch                   (2)  | Epoch:36 | Val Acc: 0.8819
 Best site-Sketch                   (2)  | Epoch:36 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:36 | Val Acc: 0.7615
 Best site-Infograph                (3)  | Epoch:36 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 1, 4, 1, 5, 3, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (4) | Train Loss: 0.4239 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.3345 | Train Acc: 0.8944
 Site-Clipart                   (4) | Train Loss: 0.4183 | Train Acc: 0.8800
 Site-Clipart                   (4) | Train Loss: 0.3780 | Train Acc: 0.8892
 Site-Clipart                   (4) | Train Loss: 0.4011 | Train Acc: 0.8869
 Site-Real                      (2) | Train Loss: 0.2997 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.1954 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.2344 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.2756 | Train Acc: 0.9425
 Site-Painting                  (5) | Train Loss: 0.4434 | Train Acc: 0.9048
 Site-Painting                  (5) | Train Loss: 0.4285 | Train Acc: 0.8689
 Site-Painting                  (5) | Train Loss: 0.3424 | Train Acc: 0.9170
 Site-Sketch                    (0) | Train Loss: 0.4364 | Train Acc: 0.8691
 Site-Sketch                    (0) | Train Loss: 0.4229 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.8096 | Train Acc: 0.7706
 Site-Infograph                 (3) | Train Loss: 1.0081 | Train Acc: 0.6667
Average Train Accuracy: 0.8759
 Site-Clipart                   (4) | Val  Loss: 0.2943 | Val  Acc: 0.8947
 Site-Clipart                   (4) | Val  Loss: 0.3372 | Val  Acc: 0.9065
 Site-Clipart                   (4) | Val  Loss: 0.3946 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.3803 | Val  Acc: 0.8762
 Site-Clipart                   (4) | Val  Loss: 0.4445 | Val  Acc: 0.8542
 Site-Real                      (2) | Val  Loss: 0.2090 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.2528 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.2837 | Val  Acc: 0.9091
 Site-Real                      (2) | Val  Loss: 0.2289 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2252 | Val  Acc: 0.9592
 Site-Painting                  (5) | Val  Loss: 0.2801 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.3630 | Val  Acc: 0.9115
 Site-Sketch                    (0) | Val  Loss: 0.4002 | Val  Acc: 0.8976
 Site-Sketch                    (0) | Val  Loss: 0.5298 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.8649 | Val  Acc: 0.7156
 Site-Infograph                 (3) | Val  Loss: 1.0311 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8802
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.8947
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.9065
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.8762
 Best site-Clipart                  (4)  | Epoch:37 | Val Acc: 0.8542
 Best site-Real                     (2)  | Epoch:37 | Val Acc: 0.9643
 Best site-Real                     (2)  | Epoch:37 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:37 | Val Acc: 0.9091
 Best site-Real                     (2)  | Epoch:37 | Val Acc: 0.9567
 Best site-Painting                 (5)  | Epoch:37 | Val Acc: 0.9592
 Best site-Painting                 (5)  | Epoch:37 | Val Acc: 0.9270
 Best site-Painting                 (5)  | Epoch:37 | Val Acc: 0.9115
 Best site-Sketch                   (0)  | Epoch:37 | Val Acc: 0.8976
 Best site-Sketch                   (0)  | Epoch:37 | Val Acc: 0.8315
 Best site-QuickDraw                (1)  | Epoch:37 | Val Acc: 0.7156
 Best site-Infograph                (3)  | Epoch:37 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 38 ============
cnt=[3, 1, 1, 5, 4, 2, ]
cnt=[5, 3, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (3) | Train Loss: 0.3683 | Train Acc: 0.8609
 Site-Clipart                   (3) | Train Loss: 0.3160 | Train Acc: 0.9193
 Site-Clipart                   (3) | Train Loss: 0.4469 | Train Acc: 0.8711
 Site-Clipart                   (3) | Train Loss: 0.4041 | Train Acc: 0.8734
 Site-Clipart                   (3) | Train Loss: 0.3826 | Train Acc: 0.9118
 Site-Real                      (4) | Train Loss: 0.3427 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2358 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2327 | Train Acc: 0.9556
 Site-Real                      (4) | Train Loss: 0.2934 | Train Acc: 0.9368
 Site-Painting                  (0) | Train Loss: 0.4698 | Train Acc: 0.8571
 Site-Painting                  (0) | Train Loss: 0.3601 | Train Acc: 0.8835
 Site-Painting                  (0) | Train Loss: 0.3574 | Train Acc: 0.9100
 Site-Sketch                    (5) | Train Loss: 0.4254 | Train Acc: 0.8848
 Site-Sketch                    (5) | Train Loss: 0.4779 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.7843 | Train Acc: 0.7523
 Site-Infograph                 (2) | Train Loss: 1.0067 | Train Acc: 0.6709
Average Train Accuracy: 0.8747
 Site-Clipart                   (3) | Val  Loss: 0.2818 | Val  Acc: 0.9211
 Site-Clipart                   (3) | Val  Loss: 0.3511 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.3378 | Val  Acc: 0.8933
 Site-Clipart                   (3) | Val  Loss: 0.3702 | Val  Acc: 0.8762
 Site-Clipart                   (3) | Val  Loss: 0.4764 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2235 | Val  Acc: 0.9643
 Site-Real                      (4) | Val  Loss: 0.2202 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2313 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2472 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.2708 | Val  Acc: 0.9592
 Site-Painting                  (0) | Val  Loss: 0.3438 | Val  Acc: 0.8905
 Site-Painting                  (0) | Val  Loss: 0.3821 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4737 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5485 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 0.8197 | Val  Acc: 0.7706
 Site-Infograph                 (2) | Val  Loss: 1.1152 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8784
============ Train epoch 39 ============
cnt=[5, 1, 1, 4, 3, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (0) | Train Loss: 0.3991 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.2977 | Train Acc: 0.9317
 Site-Clipart                   (0) | Train Loss: 0.4478 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.4227 | Train Acc: 0.8829
 Site-Clipart                   (0) | Train Loss: 0.3890 | Train Acc: 0.9027
 Site-Real                      (3) | Train Loss: 0.3249 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2342 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.2477 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.3009 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.4205 | Train Acc: 0.8776
 Site-Painting                  (4) | Train Loss: 0.3611 | Train Acc: 0.8883
 Site-Painting                  (4) | Train Loss: 0.3525 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4649 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.5724 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.8074 | Train Acc: 0.7920
 Site-Infograph                 (2) | Train Loss: 0.9448 | Train Acc: 0.7094
Average Train Accuracy: 0.8832
 Site-Clipart                   (0) | Val  Loss: 0.2607 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.3813 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.3674 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.4038 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.4514 | Val  Acc: 0.8847
 Site-Real                      (3) | Val  Loss: 0.2156 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2464 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2245 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2553 | Val  Acc: 0.9394
 Site-Painting                  (4) | Val  Loss: 0.2689 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.2994 | Val  Acc: 0.9197
 Site-Painting                  (4) | Val  Loss: 0.3515 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.4571 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.5064 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.8556 | Val  Acc: 0.7890
 Site-Infograph                 (2) | Val  Loss: 1.0367 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8798
 Test site-Clipart                   (0)| Epoch:37 | Test Acc: 0.8764
 Test site-Real                      (3)| Epoch:37 | Test Acc: 0.9417
 Test site-Painting                  (4)| Epoch:37 | Test Acc: 0.9144
 Test site-Sketch                    (5)| Epoch:37 | Test Acc: 0.8610
 Test site-QuickDraw                 (1)| Epoch:37 | Test Acc: 0.7470
 Test site-Infograph                 (2)| Epoch:37 | Test Acc: 0.5662
Clipart: 0.8764, Real: 0.9417, Painting: 0.9144, Sketch: 0.8610, QuickDraw: 0.7470, Infograph: 0.5662, 
Average Test Accuracy(group): 0.8178, Average Test Accuracy(individual): 0.8704,
domain std=0.1280, cluster std=0.1280, individual std=0.0916, 
============ Train epoch 40 ============
cnt=[2, 1, 4, 1, 5, 3, ]
cnt=[2, 4, 5, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (4) | Train Loss: 0.4005 | Train Acc: 0.8870
 Site-Clipart                   (4) | Train Loss: 0.2900 | Train Acc: 0.9255
 Site-Clipart                   (4) | Train Loss: 0.4550 | Train Acc: 0.8756
 Site-Clipart                   (4) | Train Loss: 0.4171 | Train Acc: 0.8766
 Site-Clipart                   (4) | Train Loss: 0.4263 | Train Acc: 0.8982
 Site-Real                      (2) | Train Loss: 0.2929 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.2318 | Train Acc: 0.9322
 Site-Real                      (2) | Train Loss: 0.2363 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2690 | Train Acc: 0.9540
 Site-Painting                  (5) | Train Loss: 0.4643 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.4152 | Train Acc: 0.8786
 Site-Painting                  (5) | Train Loss: 0.3711 | Train Acc: 0.8997
 Site-Sketch                    (0) | Train Loss: 0.4562 | Train Acc: 0.8377
 Site-Sketch                    (0) | Train Loss: 0.4216 | Train Acc: 0.8764
 Site-QuickDraw                 (1) | Train Loss: 0.8325 | Train Acc: 0.7584
 Site-Infograph                 (3) | Train Loss: 0.9973 | Train Acc: 0.7009
Average Train Accuracy: 0.8775
 Site-Clipart                   (4) | Val  Loss: 0.2928 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.3553 | Val  Acc: 0.8972
 Site-Clipart                   (4) | Val  Loss: 0.3785 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.4067 | Val  Acc: 0.8619
 Site-Clipart                   (4) | Val  Loss: 0.4404 | Val  Acc: 0.8915
 Site-Real                      (2) | Val  Loss: 0.2114 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.2457 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2581 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.2432 | Val  Acc: 0.9394
 Site-Painting                  (5) | Val  Loss: 0.2590 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.3168 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.3514 | Val  Acc: 0.9323
 Site-Sketch                    (0) | Val  Loss: 0.4446 | Val  Acc: 0.8425
 Site-Sketch                    (0) | Val  Loss: 0.5175 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.8821 | Val  Acc: 0.7523
 Site-Infograph                 (3) | Val  Loss: 1.0527 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8780
 Test site-Clipart                   (4)| Epoch:37 | Test Acc: 0.8764
 Test site-Real                      (2)| Epoch:37 | Test Acc: 0.9491
 Test site-Painting                  (5)| Epoch:37 | Test Acc: 0.9192
 Test site-Sketch                    (0)| Epoch:37 | Test Acc: 0.8773
 Test site-QuickDraw                 (1)| Epoch:37 | Test Acc: 0.7370
 Test site-Infograph                 (3)| Epoch:37 | Test Acc: 0.5753
Clipart: 0.8764, Real: 0.9491, Painting: 0.9192, Sketch: 0.8773, QuickDraw: 0.7370, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8224, Average Test Accuracy(individual): 0.8752,
domain std=0.1289, cluster std=0.1289, individual std=0.0924, 
Average Test Accuracy: 0.8224
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 41 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[3, 5, 3, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (0) | Train Loss: 0.4032 | Train Acc: 0.8783
 Site-Clipart                   (0) | Train Loss: 0.3107 | Train Acc: 0.9255
 Site-Clipart                   (0) | Train Loss: 0.4049 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3928 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.3759 | Train Acc: 0.9163
 Site-Real                      (2) | Train Loss: 0.3005 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.2085 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.2324 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2808 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.2991 | Train Acc: 0.9184
 Site-Painting                  (4) | Train Loss: 0.4421 | Train Acc: 0.8738
 Site-Painting                  (4) | Train Loss: 0.3649 | Train Acc: 0.9031
 Site-Sketch                    (5) | Train Loss: 0.4394 | Train Acc: 0.8848
 Site-Sketch                    (5) | Train Loss: 0.4680 | Train Acc: 0.8876
 Site-QuickDraw                 (1) | Train Loss: 0.8376 | Train Acc: 0.7706
 Site-Infograph                 (3) | Train Loss: 0.9872 | Train Acc: 0.6966
Average Train Accuracy: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.2907 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.3024 | Val  Acc: 0.9439
 Site-Clipart                   (0) | Val  Loss: 0.3817 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.4138 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.4647 | Val  Acc: 0.8576
 Site-Real                      (2) | Val  Loss: 0.2218 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2539 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2117 | Val  Acc: 0.9394
 Site-Real                      (2) | Val  Loss: 0.2423 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2536 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.3438 | Val  Acc: 0.9124
 Site-Painting                  (4) | Val  Loss: 0.3459 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.4268 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.5020 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.8360 | Val  Acc: 0.7706
 Site-Infograph                 (3) | Val  Loss: 1.0507 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8835
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.9439
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.9000
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8762
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8576
 Best site-Real                     (2)  | Epoch:41 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:41 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:41 | Val Acc: 0.9394
 Best site-Real                     (2)  | Epoch:41 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:41 | Val Acc: 0.9388
 Best site-Painting                 (4)  | Epoch:41 | Val Acc: 0.9124
 Best site-Painting                 (4)  | Epoch:41 | Val Acc: 0.9062
 Best site-Sketch                   (5)  | Epoch:41 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:41 | Val Acc: 0.8371
 Best site-QuickDraw                (1)  | Epoch:41 | Val Acc: 0.7706
 Best site-Infograph                (3)  | Epoch:41 | Val Acc: 0.6474
 Test site-Clipart                   (0)| Epoch:41 | Test Acc: 0.8821
 Test site-Real                      (2)| Epoch:41 | Test Acc: 0.9441
 Test site-Painting                  (4)| Epoch:41 | Test Acc: 0.9128
 Test site-Sketch                    (5)| Epoch:41 | Test Acc: 0.8827
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7380
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5708
Clipart: 0.8821, Real: 0.9441, Painting: 0.9128, Sketch: 0.8827, QuickDraw: 0.7380, Infograph: 0.5708, 
Average Test Accuracy(group): 0.8217, Average Test Accuracy(individual): 0.8750,
domain std=0.1295, cluster std=0.1295, individual std=0.0919, 
Average Test Accuracy: 0.8217
============ Train epoch 42 ============
cnt=[3, 1, 5, 1, 4, 2, ]
cnt=[5, 1, 1, 3, 2, 4, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (2) | Train Loss: 0.3662 | Train Acc: 0.9043
 Site-Clipart                   (2) | Train Loss: 0.3119 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.4492 | Train Acc: 0.8622
 Site-Clipart                   (2) | Train Loss: 0.3753 | Train Acc: 0.9019
 Site-Clipart                   (2) | Train Loss: 0.3695 | Train Acc: 0.9095
 Site-Real                      (4) | Train Loss: 0.3123 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.2022 | Train Acc: 0.9605
 Site-Real                      (4) | Train Loss: 0.2451 | Train Acc: 0.9315
 Site-Real                      (4) | Train Loss: 0.2571 | Train Acc: 0.9368
 Site-Painting                  (0) | Train Loss: 0.3752 | Train Acc: 0.8776
 Site-Painting                  (0) | Train Loss: 0.3607 | Train Acc: 0.8883
 Site-Painting                  (0) | Train Loss: 0.3070 | Train Acc: 0.9343
 Site-Sketch                    (5) | Train Loss: 0.4316 | Train Acc: 0.8429
 Site-Sketch                    (5) | Train Loss: 0.5446 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.7872 | Train Acc: 0.7676
 Site-Infograph                 (3) | Train Loss: 0.9562 | Train Acc: 0.6752
Average Train Accuracy: 0.8799
 Site-Clipart                   (2) | Val  Loss: 0.2252 | Val  Acc: 0.9474
 Site-Clipart                   (2) | Val  Loss: 0.2841 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.3065 | Val  Acc: 0.9133
 Site-Clipart                   (2) | Val  Loss: 0.3870 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.4700 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.2081 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2494 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2306 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2380 | Val  Acc: 0.9394
 Site-Painting                  (0) | Val  Loss: 0.2530 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.2829 | Val  Acc: 0.9197
 Site-Painting                  (0) | Val  Loss: 0.3373 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4306 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5132 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.8470 | Val  Acc: 0.7661
 Site-Infograph                 (3) | Val  Loss: 1.0423 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8885
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9474
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9252
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9133
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.8667
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.8542
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9576
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9394
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9388
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9197
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9010
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8661
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:42 | Val Acc: 0.7661
 Best site-Infograph                (3)  | Epoch:42 | Val Acc: 0.6859
 Test site-Clipart                   (2)| Epoch:42 | Test Acc: 0.8783
 Test site-Real                      (4)| Epoch:42 | Test Acc: 0.9433
 Test site-Painting                  (0)| Epoch:42 | Test Acc: 0.9192
 Test site-Sketch                    (5)| Epoch:42 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7400
 Test site-Infograph                 (3)| Epoch:42 | Test Acc: 0.5814
Clipart: 0.8783, Real: 0.9433, Painting: 0.9192, Sketch: 0.8863, QuickDraw: 0.7400, Infograph: 0.5814, 
Average Test Accuracy(group): 0.8248, Average Test Accuracy(individual): 0.8760,
domain std=0.1265, cluster std=0.1265, individual std=0.0899, 
Average Test Accuracy: 0.8248
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 43 ============
cnt=[4, 1, 1, 5, 3, 2, ]
cnt=[4, 5, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (3) | Train Loss: 0.3278 | Train Acc: 0.9130
 Site-Clipart                   (3) | Train Loss: 0.2972 | Train Acc: 0.9193
 Site-Clipart                   (3) | Train Loss: 0.3986 | Train Acc: 0.9200
 Site-Clipart                   (3) | Train Loss: 0.3739 | Train Acc: 0.8797
 Site-Clipart                   (3) | Train Loss: 0.3708 | Train Acc: 0.9027
 Site-Real                      (0) | Train Loss: 0.3072 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2112 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2208 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2588 | Train Acc: 0.9425
 Site-Painting                  (4) | Train Loss: 0.3787 | Train Acc: 0.8776
 Site-Painting                  (4) | Train Loss: 0.3499 | Train Acc: 0.8981
 Site-Painting                  (4) | Train Loss: 0.3299 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.4648 | Train Acc: 0.8325
 Site-Sketch                    (5) | Train Loss: 0.4505 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.8294 | Train Acc: 0.7676
 Site-Infograph                 (2) | Train Loss: 0.9162 | Train Acc: 0.7222
Average Train Accuracy: 0.8863
 Site-Clipart                   (3) | Val  Loss: 0.2508 | Val  Acc: 0.9342
 Site-Clipart                   (3) | Val  Loss: 0.2830 | Val  Acc: 0.9346
 Site-Clipart                   (3) | Val  Loss: 0.3164 | Val  Acc: 0.9067
 Site-Clipart                   (3) | Val  Loss: 0.3858 | Val  Acc: 0.8619
 Site-Clipart                   (3) | Val  Loss: 0.4250 | Val  Acc: 0.8881
 Site-Real                      (0) | Val  Loss: 0.2247 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2349 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2329 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2472 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2346 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.3108 | Val  Acc: 0.9416
 Site-Painting                  (4) | Val  Loss: 0.3365 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.3833 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4651 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.8110 | Val  Acc: 0.7661
 Site-Infograph                 (2) | Val  Loss: 0.9959 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8925
 Best site-Clipart                  (3)  | Epoch:43 | Val Acc: 0.9342
 Best site-Clipart                  (3)  | Epoch:43 | Val Acc: 0.9346
 Best site-Clipart                  (3)  | Epoch:43 | Val Acc: 0.9067
 Best site-Clipart                  (3)  | Epoch:43 | Val Acc: 0.8619
 Best site-Clipart                  (3)  | Epoch:43 | Val Acc: 0.8881
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:43 | Val Acc: 0.9388
 Best site-Painting                 (4)  | Epoch:43 | Val Acc: 0.9416
 Best site-Painting                 (4)  | Epoch:43 | Val Acc: 0.9062
 Best site-Sketch                   (5)  | Epoch:43 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:43 | Val Acc: 0.8539
 Best site-QuickDraw                (1)  | Epoch:43 | Val Acc: 0.7661
 Best site-Infograph                (2)  | Epoch:43 | Val Acc: 0.6795
 Test site-Clipart                   (3)| Epoch:43 | Test Acc: 0.8783
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9449
 Test site-Painting                  (4)| Epoch:43 | Test Acc: 0.9257
 Test site-Sketch                    (5)| Epoch:43 | Test Acc: 0.8773
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7360
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.5799
Clipart: 0.8783, Real: 0.9449, Painting: 0.9257, Sketch: 0.8773, QuickDraw: 0.7360, Infograph: 0.5799, 
Average Test Accuracy(group): 0.8237, Average Test Accuracy(individual): 0.8762,
domain std=0.1279, cluster std=0.1279, individual std=0.0914, 
Average Test Accuracy: 0.8237
============ Train epoch 44 ============
cnt=[4, 1, 1, 5, 3, 2, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (3) | Train Loss: 0.3972 | Train Acc: 0.8870
 Site-Clipart                   (3) | Train Loss: 0.2601 | Train Acc: 0.9441
 Site-Clipart                   (3) | Train Loss: 0.3977 | Train Acc: 0.8844
 Site-Clipart                   (3) | Train Loss: 0.3875 | Train Acc: 0.8703
 Site-Clipart                   (3) | Train Loss: 0.3510 | Train Acc: 0.9118
 Site-Real                      (0) | Train Loss: 0.3124 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2202 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2148 | Train Acc: 0.9556
 Site-Real                      (0) | Train Loss: 0.2546 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.2952 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.3471 | Train Acc: 0.9029
 Site-Painting                  (4) | Train Loss: 0.3410 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.4158 | Train Acc: 0.8743
 Site-Sketch                    (5) | Train Loss: 0.4561 | Train Acc: 0.8764
 Site-QuickDraw                 (1) | Train Loss: 0.7538 | Train Acc: 0.7615
 Site-Infograph                 (2) | Train Loss: 0.9317 | Train Acc: 0.7009
Average Train Accuracy: 0.8867
 Site-Clipart                   (3) | Val  Loss: 0.2594 | Val  Acc: 0.9342
 Site-Clipart                   (3) | Val  Loss: 0.2995 | Val  Acc: 0.9252
 Site-Clipart                   (3) | Val  Loss: 0.3693 | Val  Acc: 0.9000
 Site-Clipart                   (3) | Val  Loss: 0.3578 | Val  Acc: 0.8857
 Site-Clipart                   (3) | Val  Loss: 0.4512 | Val  Acc: 0.8576
 Site-Real                      (0) | Val  Loss: 0.2173 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2508 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.2279 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2463 | Val  Acc: 0.9481
 Site-Painting                  (4) | Val  Loss: 0.2347 | Val  Acc: 0.9592
 Site-Painting                  (4) | Val  Loss: 0.2870 | Val  Acc: 0.9124
 Site-Painting                  (4) | Val  Loss: 0.3042 | Val  Acc: 0.9323
 Site-Sketch                    (5) | Val  Loss: 0.4118 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.5016 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.8029 | Val  Acc: 0.7569
 Site-Infograph                 (2) | Val  Loss: 0.9430 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8948
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.9342
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.9252
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.9000
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.8857
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.8576
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9237
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9455
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9481
 Best site-Painting                 (4)  | Epoch:44 | Val Acc: 0.9592
 Best site-Painting                 (4)  | Epoch:44 | Val Acc: 0.9124
 Best site-Painting                 (4)  | Epoch:44 | Val Acc: 0.9323
 Best site-Sketch                   (5)  | Epoch:44 | Val Acc: 0.8819
 Best site-Sketch                   (5)  | Epoch:44 | Val Acc: 0.8596
 Best site-QuickDraw                (1)  | Epoch:44 | Val Acc: 0.7569
 Best site-Infograph                (2)  | Epoch:44 | Val Acc: 0.7308
 Test site-Clipart                   (3)| Epoch:44 | Test Acc: 0.8783
 Test site-Real                      (0)| Epoch:44 | Test Acc: 0.9474
 Test site-Painting                  (4)| Epoch:44 | Test Acc: 0.9225
 Test site-Sketch                    (5)| Epoch:44 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.7460
 Test site-Infograph                 (2)| Epoch:44 | Test Acc: 0.5738
Clipart: 0.8783, Real: 0.9474, Painting: 0.9225, Sketch: 0.8791, QuickDraw: 0.7460, Infograph: 0.5738, 
Average Test Accuracy(group): 0.8245, Average Test Accuracy(individual): 0.8767,
domain std=0.1288, cluster std=0.1288, individual std=0.0919, 
Average Test Accuracy: 0.8245
============ Train epoch 45 ============
cnt=[4, 1, 1, 5, 2, 3, ]
cnt=[3, 4, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (3) | Train Loss: 0.4143 | Train Acc: 0.8609
 Site-Clipart                   (3) | Train Loss: 0.2857 | Train Acc: 0.9255
 Site-Clipart                   (3) | Train Loss: 0.4200 | Train Acc: 0.8800
 Site-Clipart                   (3) | Train Loss: 0.3926 | Train Acc: 0.8797
 Site-Clipart                   (3) | Train Loss: 0.3616 | Train Acc: 0.9163
 Site-Real                      (0) | Train Loss: 0.3080 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2349 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2317 | Train Acc: 0.9556
 Site-Real                      (0) | Train Loss: 0.2710 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.3518 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.3241 | Train Acc: 0.9175
 Site-Painting                  (5) | Train Loss: 0.3268 | Train Acc: 0.9239
 Site-Sketch                    (4) | Train Loss: 0.4493 | Train Acc: 0.8482
 Site-Sketch                    (4) | Train Loss: 0.4472 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.7287 | Train Acc: 0.7523
 Site-Infograph                 (2) | Train Loss: 0.9467 | Train Acc: 0.6966
Average Train Accuracy: 0.8817
 Site-Clipart                   (3) | Val  Loss: 0.2192 | Val  Acc: 0.9474
 Site-Clipart                   (3) | Val  Loss: 0.3054 | Val  Acc: 0.9346
 Site-Clipart                   (3) | Val  Loss: 0.3354 | Val  Acc: 0.9000
 Site-Clipart                   (3) | Val  Loss: 0.3824 | Val  Acc: 0.8667
 Site-Clipart                   (3) | Val  Loss: 0.4269 | Val  Acc: 0.8712
 Site-Real                      (0) | Val  Loss: 0.2248 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2639 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2279 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2370 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2189 | Val  Acc: 0.9592
 Site-Painting                  (5) | Val  Loss: 0.2847 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.3510 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.4341 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.4337 | Val  Acc: 0.8708
 Site-QuickDraw                 (1) | Val  Loss: 0.8420 | Val  Acc: 0.7661
 Site-Infograph                 (2) | Val  Loss: 1.0386 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8942
 Test site-Clipart                   (3)| Epoch:44 | Test Acc: 0.8802
 Test site-Real                      (0)| Epoch:44 | Test Acc: 0.9491
 Test site-Painting                  (5)| Epoch:44 | Test Acc: 0.9160
 Test site-Sketch                    (4)| Epoch:44 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.7430
 Test site-Infograph                 (2)| Epoch:44 | Test Acc: 0.5708
Clipart: 0.8802, Real: 0.9491, Painting: 0.9160, Sketch: 0.8863, QuickDraw: 0.7430, Infograph: 0.5708, 
Average Test Accuracy(group): 0.8242, Average Test Accuracy(individual): 0.8770,
domain std=0.1303, cluster std=0.1303, individual std=0.0926, 
Average Test Accuracy: 0.8242
============ Train epoch 46 ============
cnt=[5, 1, 1, 3, 4, 2, ]
cnt=[2, 1, 5, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (0) | Train Loss: 0.3928 | Train Acc: 0.8957
 Site-Clipart                   (0) | Train Loss: 0.3258 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.4694 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3838 | Train Acc: 0.9019
 Site-Clipart                   (0) | Train Loss: 0.3726 | Train Acc: 0.9050
 Site-Real                      (4) | Train Loss: 0.3031 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2150 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2259 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.2747 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.3588 | Train Acc: 0.9048
 Site-Painting                  (3) | Train Loss: 0.3484 | Train Acc: 0.8932
 Site-Painting                  (3) | Train Loss: 0.2904 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.4613 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.4707 | Train Acc: 0.8727
 Site-QuickDraw                 (1) | Train Loss: 0.7276 | Train Acc: 0.7768
 Site-Infograph                 (2) | Train Loss: 0.9386 | Train Acc: 0.7265
Average Train Accuracy: 0.8869
 Site-Clipart                   (0) | Val  Loss: 0.2468 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.3215 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.3715 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.4016 | Val  Acc: 0.8429
 Site-Clipart                   (0) | Val  Loss: 0.4525 | Val  Acc: 0.8780
 Site-Real                      (4) | Val  Loss: 0.2305 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2787 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2269 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.2280 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.2412 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.2815 | Val  Acc: 0.9343
 Site-Painting                  (3) | Val  Loss: 0.3302 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.3967 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.5167 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.8737 | Val  Acc: 0.7431
 Site-Infograph                 (2) | Val  Loss: 0.9997 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8891
 Test site-Clipart                   (0)| Epoch:44 | Test Acc: 0.8878
 Test site-Real                      (4)| Epoch:44 | Test Acc: 0.9433
 Test site-Painting                  (3)| Epoch:44 | Test Acc: 0.9176
 Test site-Sketch                    (5)| Epoch:44 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.7490
 Test site-Infograph                 (2)| Epoch:44 | Test Acc: 0.5769
Clipart: 0.8878, Real: 0.9433, Painting: 0.9176, Sketch: 0.8917, QuickDraw: 0.7490, Infograph: 0.5769, 
Average Test Accuracy(group): 0.8277, Average Test Accuracy(individual): 0.8797,
domain std=0.1280, cluster std=0.1280, individual std=0.0901, 
Average Test Accuracy: 0.8277
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 47 ============
cnt=[1, 5, 1, 4, 2, 3, ]
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (1) | Train Loss: 0.3899 | Train Acc: 0.8783
 Site-Clipart                   (1) | Train Loss: 0.2863 | Train Acc: 0.9193
 Site-Clipart                   (1) | Train Loss: 0.4535 | Train Acc: 0.8978
 Site-Clipart                   (1) | Train Loss: 0.3752 | Train Acc: 0.8829
 Site-Clipart                   (1) | Train Loss: 0.3519 | Train Acc: 0.9140
 Site-Real                      (3) | Train Loss: 0.2851 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2188 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2228 | Train Acc: 0.9597
 Site-Real                      (3) | Train Loss: 0.2680 | Train Acc: 0.9368
 Site-Painting                  (5) | Train Loss: 0.4013 | Train Acc: 0.9116
 Site-Painting                  (5) | Train Loss: 0.4170 | Train Acc: 0.8835
 Site-Painting                  (5) | Train Loss: 0.3591 | Train Acc: 0.9100
 Site-Sketch                    (4) | Train Loss: 0.4357 | Train Acc: 0.8586
 Site-Sketch                    (4) | Train Loss: 0.4473 | Train Acc: 0.8427
 Site-QuickDraw                 (2) | Train Loss: 0.7683 | Train Acc: 0.7798
 Site-Infograph                 (0) | Train Loss: 0.9245 | Train Acc: 0.7393
Average Train Accuracy: 0.8860
 Site-Clipart                   (1) | Val  Loss: 0.2340 | Val  Acc: 0.9474
 Site-Clipart                   (1) | Val  Loss: 0.2757 | Val  Acc: 0.9439
 Site-Clipart                   (1) | Val  Loss: 0.3628 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.3525 | Val  Acc: 0.8810
 Site-Clipart                   (1) | Val  Loss: 0.4498 | Val  Acc: 0.8712
 Site-Real                      (3) | Val  Loss: 0.2268 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2677 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2093 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2480 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2459 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2848 | Val  Acc: 0.9197
 Site-Painting                  (5) | Val  Loss: 0.4023 | Val  Acc: 0.8906
 Site-Sketch                    (4) | Val  Loss: 0.4393 | Val  Acc: 0.8740
 Site-Sketch                    (4) | Val  Loss: 0.4901 | Val  Acc: 0.8315
 Site-QuickDraw                 (2) | Val  Loss: 0.7731 | Val  Acc: 0.8211
 Site-Infograph                 (0) | Val  Loss: 1.0257 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8932
 Test site-Clipart                   (1)| Epoch:46 | Test Acc: 0.8821
 Test site-Real                      (3)| Epoch:46 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:46 | Test Acc: 0.9208
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8935
 Test site-QuickDraw                 (2)| Epoch:46 | Test Acc: 0.7500
 Test site-Infograph                 (0)| Epoch:46 | Test Acc: 0.5753
Clipart: 0.8821, Real: 0.9441, Painting: 0.9208, Sketch: 0.8935, QuickDraw: 0.7500, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8277, Average Test Accuracy(individual): 0.8789,
domain std=0.1286, cluster std=0.1286, individual std=0.0907, 
Average Test Accuracy: 0.8277
============ Train epoch 48 ============
cnt=[5, 1, 3, 1, 2, 4, ]
cnt=[4, 5, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.4600 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.2708 | Train Acc: 0.9255
 Site-Clipart                   (0) | Train Loss: 0.4161 | Train Acc: 0.8978
 Site-Clipart                   (0) | Train Loss: 0.3925 | Train Acc: 0.8734
 Site-Clipart                   (0) | Train Loss: 0.3267 | Train Acc: 0.9231
 Site-Real                      (5) | Train Loss: 0.3146 | Train Acc: 0.9127
 Site-Real                      (5) | Train Loss: 0.2465 | Train Acc: 0.9435
 Site-Real                      (5) | Train Loss: 0.2372 | Train Acc: 0.9315
 Site-Real                      (5) | Train Loss: 0.2642 | Train Acc: 0.9282
 Site-Painting                  (2) | Train Loss: 0.3414 | Train Acc: 0.9116
 Site-Painting                  (2) | Train Loss: 0.3557 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.3486 | Train Acc: 0.8997
 Site-Sketch                    (4) | Train Loss: 0.4266 | Train Acc: 0.8691
 Site-Sketch                    (4) | Train Loss: 0.4265 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.7167 | Train Acc: 0.7615
 Site-Infograph                 (3) | Train Loss: 0.9223 | Train Acc: 0.6923
Average Train Accuracy: 0.8792
 Site-Clipart                   (0) | Val  Loss: 0.2316 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.2875 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.3294 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.3848 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.4488 | Val  Acc: 0.8780
 Site-Real                      (5) | Val  Loss: 0.2249 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.2423 | Val  Acc: 0.9492
 Site-Real                      (5) | Val  Loss: 0.2241 | Val  Acc: 0.9455
 Site-Real                      (5) | Val  Loss: 0.2273 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2593 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3115 | Val  Acc: 0.8905
 Site-Painting                  (2) | Val  Loss: 0.3614 | Val  Acc: 0.8802
 Site-Sketch                    (4) | Val  Loss: 0.4060 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.4885 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.8199 | Val  Acc: 0.7798
 Site-Infograph                 (3) | Val  Loss: 1.0095 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8886
 Test site-Clipart                   (0)| Epoch:46 | Test Acc: 0.8821
 Test site-Real                      (5)| Epoch:46 | Test Acc: 0.9433
 Test site-Painting                  (2)| Epoch:46 | Test Acc: 0.9176
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7500
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5753
Clipart: 0.8821, Real: 0.9433, Painting: 0.9176, Sketch: 0.8863, QuickDraw: 0.7500, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8258, Average Test Accuracy(individual): 0.8772,
domain std=0.1275, cluster std=0.1275, individual std=0.0901, 
Average Test Accuracy: 0.8258
============ Train epoch 49 ============
cnt=[4, 1, 1, 5, 2, 3, ]
cnt=[1, 5, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (3) | Train Loss: 0.3704 | Train Acc: 0.8957
 Site-Clipart                   (3) | Train Loss: 0.2910 | Train Acc: 0.9255
 Site-Clipart                   (3) | Train Loss: 0.3784 | Train Acc: 0.9200
 Site-Clipart                   (3) | Train Loss: 0.3634 | Train Acc: 0.8956
 Site-Clipart                   (3) | Train Loss: 0.3345 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.3086 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2203 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.2330 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2617 | Train Acc: 0.9397
 Site-Painting                  (5) | Train Loss: 0.3771 | Train Acc: 0.8776
 Site-Painting                  (5) | Train Loss: 0.2779 | Train Acc: 0.9078
 Site-Painting                  (5) | Train Loss: 0.3147 | Train Acc: 0.9239
 Site-Sketch                    (4) | Train Loss: 0.4304 | Train Acc: 0.8586
 Site-Sketch                    (4) | Train Loss: 0.5214 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.6748 | Train Acc: 0.8043
 Site-Infograph                 (2) | Train Loss: 0.8788 | Train Acc: 0.7393
Average Train Accuracy: 0.8936
 Site-Clipart                   (3) | Val  Loss: 0.2466 | Val  Acc: 0.9342
 Site-Clipart                   (3) | Val  Loss: 0.3032 | Val  Acc: 0.9065
 Site-Clipart                   (3) | Val  Loss: 0.3734 | Val  Acc: 0.8867
 Site-Clipart                   (3) | Val  Loss: 0.3707 | Val  Acc: 0.8857
 Site-Clipart                   (3) | Val  Loss: 0.4303 | Val  Acc: 0.8746
 Site-Real                      (0) | Val  Loss: 0.2240 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2448 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2378 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2318 | Val  Acc: 0.9481
 Site-Painting                  (5) | Val  Loss: 0.2161 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2934 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.3283 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.4390 | Val  Acc: 0.8661
 Site-Sketch                    (4) | Val  Loss: 0.4725 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.8247 | Val  Acc: 0.7798
 Site-Infograph                 (2) | Val  Loss: 1.0362 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8881
 Test site-Clipart                   (3)| Epoch:46 | Test Acc: 0.8802
 Test site-Real                      (0)| Epoch:46 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:46 | Test Acc: 0.9208
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7600
 Test site-Infograph                 (2)| Epoch:46 | Test Acc: 0.5753
Clipart: 0.8802, Real: 0.9441, Painting: 0.9208, Sketch: 0.8881, QuickDraw: 0.7600, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8281, Average Test Accuracy(individual): 0.8782,
domain std=0.1271, cluster std=0.1271, individual std=0.0897, 
Average Test Accuracy: 0.8281
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Test site-Clipart                   (3)| Epoch:49 | Test Acc: 0.8802
 Test site-Real                      (0)| Epoch:49 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:49 | Test Acc: 0.9208
 Test site-Sketch                    (4)| Epoch:49 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7600
 Test site-Infograph                 (2)| Epoch:49 | Test Acc: 0.5753
Clipart: 0.8802, Real: 0.9441, Painting: 0.9208, Sketch: 0.8881, QuickDraw: 0.7600, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8281, Average Test Accuracy(individual): 0.8782,
domain std=0.1271, cluster std=0.1271, individual std=0.0897, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
===2023-06-24 16:23:39===
===2023-06-24 16:23:47===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (3)| Epoch:49 | Test Acc: 0.8802
 Test site-Real                      (0)| Epoch:49 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:49 | Test Acc: 0.9208
 Test site-Sketch                    (4)| Epoch:49 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7600
 Test site-Infograph                 (2)| Epoch:49 | Test Acc: 0.5753
Clipart: 0.8802, Real: 0.9441, Painting: 0.9208, Sketch: 0.8881, QuickDraw: 0.7600, Infograph: 0.5753, 
Average Test Accuracy(group): 0.8281, Average Test Accuracy(individual): 0.8782,
domain std=0.1271, cluster std=0.1271, individual std=0.0897, 
===2023-06-25 00:54:29===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1100 | Train Acc: 0.2522
 Site-Clipart                   (1) | Train Loss: 2.0453 | Train Acc: 0.3540
 Site-Clipart                   (1) | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-Clipart                   (1) | Train Loss: 2.0738 | Train Acc: 0.2911
 Site-Clipart                   (1) | Train Loss: 2.1005 | Train Acc: 0.2715
 Site-Real                      (0) | Train Loss: 2.0876 | Train Acc: 0.3571
 Site-Real                      (0) | Train Loss: 2.0787 | Train Acc: 0.3559
 Site-Real                      (0) | Train Loss: 2.0687 | Train Acc: 0.3589
 Site-Real                      (0) | Train Loss: 2.1167 | Train Acc: 0.2816
 Site-Painting                  (5) | Train Loss: 2.1118 | Train Acc: 0.3605
 Site-Painting                  (5) | Train Loss: 2.1080 | Train Acc: 0.3495
 Site-Painting                  (5) | Train Loss: 2.0811 | Train Acc: 0.3149
 Site-Sketch                    (4) | Train Loss: 2.0476 | Train Acc: 0.3508
 Site-Sketch                    (4) | Train Loss: 2.1048 | Train Acc: 0.3558
 Site-QuickDraw                 (2) | Train Loss: 2.3103 | Train Acc: 0.1713
 Site-Infograph                 (3) | Train Loss: 2.2553 | Train Acc: 0.1880
Average Train Accuracy: 0.3067
 Site-Clipart                   (1) | Val  Loss: 2.0400 | Val  Acc: 0.2500
 Site-Clipart                   (1) | Val  Loss: 2.1068 | Val  Acc: 0.2991
 Site-Clipart                   (1) | Val  Loss: 2.0650 | Val  Acc: 0.3333
 Site-Clipart                   (1) | Val  Loss: 2.0566 | Val  Acc: 0.3571
 Site-Clipart                   (1) | Val  Loss: 2.1134 | Val  Acc: 0.2678
 Site-Real                      (0) | Val  Loss: 2.0676 | Val  Acc: 0.3452
 Site-Real                      (0) | Val  Loss: 2.0913 | Val  Acc: 0.3220
 Site-Real                      (0) | Val  Loss: 2.0499 | Val  Acc: 0.4061
 Site-Real                      (0) | Val  Loss: 2.0611 | Val  Acc: 0.3766
 Site-Painting                  (5) | Val  Loss: 2.1028 | Val  Acc: 0.3776
 Site-Painting                  (5) | Val  Loss: 2.0467 | Val  Acc: 0.3650
 Site-Painting                  (5) | Val  Loss: 2.1136 | Val  Acc: 0.3385
 Site-Sketch                    (4) | Val  Loss: 2.0787 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0737 | Val  Acc: 0.3539
 Site-QuickDraw                 (2) | Val  Loss: 2.3222 | Val  Acc: 0.1881
 Site-Infograph                 (3) | Val  Loss: 2.2939 | Val  Acc: 0.1603
Average Valid Accuracy: 0.3189
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2991
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2678
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3452
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3220
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4061
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3766
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3776
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3650
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3385
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3539
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1881
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.1603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 4, 3, 1, 6, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (5) | Train Loss: 1.9000 | Train Acc: 0.4783
 Site-Clipart                   (5) | Train Loss: 1.8283 | Train Acc: 0.5093
 Site-Clipart                   (5) | Train Loss: 1.9242 | Train Acc: 0.4844
 Site-Clipart                   (0) | Train Loss: 1.8714 | Train Acc: 0.4937
 Site-Clipart                   (5) | Train Loss: 1.9148 | Train Acc: 0.4570
 Site-Real                      (2) | Train Loss: 1.8142 | Train Acc: 0.6270
 Site-Real                      (2) | Train Loss: 1.7542 | Train Acc: 0.6610
 Site-Real                      (2) | Train Loss: 1.7560 | Train Acc: 0.6492
 Site-Real                      (2) | Train Loss: 1.8146 | Train Acc: 0.5891
 Site-Painting                  (3) | Train Loss: 1.8310 | Train Acc: 0.5170
 Site-Painting                  (3) | Train Loss: 1.8474 | Train Acc: 0.5388
 Site-Painting                  (3) | Train Loss: 1.8287 | Train Acc: 0.5294
 Site-Sketch                    (5) | Train Loss: 1.8483 | Train Acc: 0.5654
 Site-Sketch                    (5) | Train Loss: 1.9002 | Train Acc: 0.4719
 Site-QuickDraw                 (1) | Train Loss: 2.2553 | Train Acc: 0.1804
 Site-Infograph                 (4) | Train Loss: 2.2097 | Train Acc: 0.2393
Average Train Accuracy: 0.4995
 Site-Clipart                   (5) | Val  Loss: 1.7847 | Val  Acc: 0.5000
 Site-Clipart                   (5) | Val  Loss: 1.8880 | Val  Acc: 0.4299
 Site-Clipart                   (5) | Val  Loss: 1.8707 | Val  Acc: 0.5067
 Site-Clipart                   (0) | Val  Loss: 1.8591 | Val  Acc: 0.4571
 Site-Clipart                   (5) | Val  Loss: 1.9221 | Val  Acc: 0.4203
 Site-Real                      (2) | Val  Loss: 1.7391 | Val  Acc: 0.5714
 Site-Real                      (2) | Val  Loss: 1.7925 | Val  Acc: 0.5847
 Site-Real                      (2) | Val  Loss: 1.7437 | Val  Acc: 0.6606
 Site-Real                      (2) | Val  Loss: 1.7696 | Val  Acc: 0.6104
 Site-Painting                  (3) | Val  Loss: 1.8251 | Val  Acc: 0.5816
 Site-Painting                  (3) | Val  Loss: 1.8171 | Val  Acc: 0.5109
 Site-Painting                  (3) | Val  Loss: 1.8605 | Val  Acc: 0.5104
 Site-Sketch                    (5) | Val  Loss: 1.8299 | Val  Acc: 0.5433
 Site-Sketch                    (5) | Val  Loss: 1.9099 | Val  Acc: 0.4438
 Site-QuickDraw                 (1) | Val  Loss: 2.2823 | Val  Acc: 0.1835
 Site-Infograph                 (4) | Val  Loss: 2.1611 | Val  Acc: 0.2115
Average Valid Accuracy: 0.4829
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4299
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5067
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4571
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4203
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5714
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5847
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6606
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6104
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5816
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5109
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5104
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5433
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4438
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.1835
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.2115
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[2, 1, 4, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.6656 | Train Acc: 0.5826
 Site-Clipart                   (0) | Train Loss: 1.6015 | Train Acc: 0.6273
 Site-Clipart                   (0) | Train Loss: 1.7062 | Train Acc: 0.5867
 Site-Clipart                   (0) | Train Loss: 1.6521 | Train Acc: 0.6203
 Site-Clipart                   (0) | Train Loss: 1.6686 | Train Acc: 0.6267
 Site-Real                      (2) | Train Loss: 1.5628 | Train Acc: 0.7063
 Site-Real                      (2) | Train Loss: 1.4713 | Train Acc: 0.7345
 Site-Real                      (2) | Train Loss: 1.4476 | Train Acc: 0.7621
 Site-Real                      (2) | Train Loss: 1.5511 | Train Acc: 0.7241
 Site-Painting                  (4) | Train Loss: 1.5658 | Train Acc: 0.6735
 Site-Painting                  (4) | Train Loss: 1.6032 | Train Acc: 0.6699
 Site-Painting                  (4) | Train Loss: 1.5395 | Train Acc: 0.7128
 Site-Sketch                    (5) | Train Loss: 1.6534 | Train Acc: 0.6283
 Site-Sketch                    (5) | Train Loss: 1.6788 | Train Acc: 0.5918
 Site-QuickDraw                 (1) | Train Loss: 2.2676 | Train Acc: 0.1743
 Site-Infograph                 (3) | Train Loss: 2.0541 | Train Acc: 0.3462
Average Train Accuracy: 0.6105
 Site-Clipart                   (0) | Val  Loss: 1.5288 | Val  Acc: 0.6842
 Site-Clipart                   (0) | Val  Loss: 1.6313 | Val  Acc: 0.6729
 Site-Clipart                   (0) | Val  Loss: 1.6547 | Val  Acc: 0.6600
 Site-Clipart                   (0) | Val  Loss: 1.6536 | Val  Acc: 0.6381
 Site-Clipart                   (0) | Val  Loss: 1.7140 | Val  Acc: 0.5864
 Site-Real                      (2) | Val  Loss: 1.4714 | Val  Acc: 0.6786
 Site-Real                      (2) | Val  Loss: 1.4839 | Val  Acc: 0.7627
 Site-Real                      (2) | Val  Loss: 1.3996 | Val  Acc: 0.7879
 Site-Real                      (2) | Val  Loss: 1.4707 | Val  Acc: 0.7879
 Site-Painting                  (4) | Val  Loss: 1.5418 | Val  Acc: 0.7041
 Site-Painting                  (4) | Val  Loss: 1.5315 | Val  Acc: 0.6569
 Site-Painting                  (4) | Val  Loss: 1.5794 | Val  Acc: 0.6927
 Site-Sketch                    (5) | Val  Loss: 1.6699 | Val  Acc: 0.5984
 Site-Sketch                    (5) | Val  Loss: 1.7198 | Val  Acc: 0.5281
 Site-QuickDraw                 (1) | Val  Loss: 2.2697 | Val  Acc: 0.2064
 Site-Infograph                 (3) | Val  Loss: 2.0222 | Val  Acc: 0.3782
Average Valid Accuracy: 0.6265
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6842
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6729
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6600
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6381
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5864
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.6786
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7627
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7879
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7879
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.7041
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6569
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6927
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5984
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5281
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2064
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.3782
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 1, 4, 2, 3, 1, ]
cnt=[3, 5, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.4816 | Train Acc: 0.6348
 Site-Clipart                   (0) | Train Loss: 1.3714 | Train Acc: 0.7578
 Site-Clipart                   (0) | Train Loss: 1.5371 | Train Acc: 0.6756
 Site-Clipart                   (0) | Train Loss: 1.4460 | Train Acc: 0.7184
 Site-Clipart                   (0) | Train Loss: 1.4597 | Train Acc: 0.7104
 Site-Real                      (2) | Train Loss: 1.2708 | Train Acc: 0.8413
 Site-Real                      (2) | Train Loss: 1.2029 | Train Acc: 0.8701
 Site-Real                      (2) | Train Loss: 1.1878 | Train Acc: 0.8306
 Site-Real                      (2) | Train Loss: 1.2851 | Train Acc: 0.8333
 Site-Painting                  (4) | Train Loss: 1.3969 | Train Acc: 0.7143
 Site-Painting                  (4) | Train Loss: 1.3895 | Train Acc: 0.7524
 Site-Painting                  (4) | Train Loss: 1.3586 | Train Acc: 0.7509
 Site-Sketch                    (3) | Train Loss: 1.4021 | Train Acc: 0.7120
 Site-Sketch                    (3) | Train Loss: 1.4424 | Train Acc: 0.6554
 Site-QuickDraw                 (1) | Train Loss: 2.1671 | Train Acc: 0.2080
 Site-Infograph                 (5) | Train Loss: 1.9529 | Train Acc: 0.4145
Average Train Accuracy: 0.6925
 Site-Clipart                   (0) | Val  Loss: 1.3529 | Val  Acc: 0.7105
 Site-Clipart                   (0) | Val  Loss: 1.4287 | Val  Acc: 0.7290
 Site-Clipart                   (0) | Val  Loss: 1.4232 | Val  Acc: 0.7267
 Site-Clipart                   (0) | Val  Loss: 1.4077 | Val  Acc: 0.7286
 Site-Clipart                   (0) | Val  Loss: 1.4976 | Val  Acc: 0.6746
 Site-Real                      (2) | Val  Loss: 1.1685 | Val  Acc: 0.8452
 Site-Real                      (2) | Val  Loss: 1.2101 | Val  Acc: 0.8305
 Site-Real                      (2) | Val  Loss: 1.1600 | Val  Acc: 0.8606
 Site-Real                      (2) | Val  Loss: 1.1945 | Val  Acc: 0.8745
 Site-Painting                  (4) | Val  Loss: 1.2724 | Val  Acc: 0.7857
 Site-Painting                  (4) | Val  Loss: 1.3421 | Val  Acc: 0.7445
 Site-Painting                  (4) | Val  Loss: 1.3601 | Val  Acc: 0.7240
 Site-Sketch                    (3) | Val  Loss: 1.4168 | Val  Acc: 0.7323
 Site-Sketch                    (3) | Val  Loss: 1.5287 | Val  Acc: 0.6348
 Site-QuickDraw                 (1) | Val  Loss: 2.1724 | Val  Acc: 0.2385
 Site-Infograph                 (5) | Val  Loss: 1.9104 | Val  Acc: 0.4359
Average Valid Accuracy: 0.7047
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7105
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7290
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7267
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7286
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6746
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8452
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8305
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8606
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8745
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7857
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7445
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7240
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.7323
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.6348
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.2385
 Best site-Infograph                (5)  | Epoch:3 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 4, 1, 3, 3, 1, ]
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (4) | Train Loss: 1.3323 | Train Acc: 0.7478
 Site-Clipart                   (0) | Train Loss: 1.2462 | Train Acc: 0.7764
 Site-Clipart                   (0) | Train Loss: 1.3853 | Train Acc: 0.7244
 Site-Clipart                   (4) | Train Loss: 1.2708 | Train Acc: 0.7468
 Site-Clipart                   (4) | Train Loss: 1.3178 | Train Acc: 0.7443
 Site-Real                      (1) | Train Loss: 1.0855 | Train Acc: 0.8730
 Site-Real                      (1) | Train Loss: 0.9959 | Train Acc: 0.8757
 Site-Real                      (1) | Train Loss: 0.9659 | Train Acc: 0.8871
 Site-Real                      (1) | Train Loss: 1.0853 | Train Acc: 0.8851
 Site-Painting                  (3) | Train Loss: 1.1604 | Train Acc: 0.7891
 Site-Painting                  (3) | Train Loss: 1.1147 | Train Acc: 0.7816
 Site-Painting                  (3) | Train Loss: 1.1277 | Train Acc: 0.8028
 Site-Sketch                    (0) | Train Loss: 1.2435 | Train Acc: 0.7330
 Site-Sketch                    (0) | Train Loss: 1.2999 | Train Acc: 0.7041
 Site-QuickDraw                 (2) | Train Loss: 2.1395 | Train Acc: 0.2446
 Site-Infograph                 (5) | Train Loss: 1.8402 | Train Acc: 0.4316
Average Train Accuracy: 0.7342
 Site-Clipart                   (4) | Val  Loss: 1.1846 | Val  Acc: 0.7632
 Site-Clipart                   (0) | Val  Loss: 1.2632 | Val  Acc: 0.8037
 Site-Clipart                   (0) | Val  Loss: 1.2728 | Val  Acc: 0.7600
 Site-Clipart                   (4) | Val  Loss: 1.2340 | Val  Acc: 0.7524
 Site-Clipart                   (4) | Val  Loss: 1.3597 | Val  Acc: 0.7220
 Site-Real                      (1) | Val  Loss: 0.9882 | Val  Acc: 0.8929
 Site-Real                      (1) | Val  Loss: 0.9914 | Val  Acc: 0.8898
 Site-Real                      (1) | Val  Loss: 0.9347 | Val  Acc: 0.9030
 Site-Real                      (1) | Val  Loss: 0.9992 | Val  Acc: 0.8788
 Site-Painting                  (3) | Val  Loss: 1.0608 | Val  Acc: 0.8367
 Site-Painting                  (3) | Val  Loss: 1.1545 | Val  Acc: 0.7664
 Site-Painting                  (3) | Val  Loss: 1.1748 | Val  Acc: 0.7917
 Site-Sketch                    (0) | Val  Loss: 1.3075 | Val  Acc: 0.6772
 Site-Sketch                    (0) | Val  Loss: 1.3198 | Val  Acc: 0.6629
 Site-QuickDraw                 (2) | Val  Loss: 2.1242 | Val  Acc: 0.2844
 Site-Infograph                 (5) | Val  Loss: 1.7655 | Val  Acc: 0.5064
Average Valid Accuracy: 0.7432
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7632
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.8037
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7600
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7524
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.7220
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8929
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8898
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.9030
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8788
 Best site-Painting                 (3)  | Epoch:4 | Val Acc: 0.8367
 Best site-Painting                 (3)  | Epoch:4 | Val Acc: 0.7664
 Best site-Painting                 (3)  | Epoch:4 | Val Acc: 0.7917
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.6772
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.6629
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.2844
 Best site-Infograph                (5)  | Epoch:4 | Val Acc: 0.5064
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 4, 4, 2, 3, ]
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (2) | Train Loss: 1.1815 | Train Acc: 0.7478
 Site-Clipart                   (2) | Train Loss: 1.0342 | Train Acc: 0.8012
 Site-Clipart                   (2) | Train Loss: 1.1946 | Train Acc: 0.7644
 Site-Clipart                   (0) | Train Loss: 1.0957 | Train Acc: 0.7943
 Site-Clipart                   (2) | Train Loss: 1.1569 | Train Acc: 0.7896
 Site-Real                      (3) | Train Loss: 0.8937 | Train Acc: 0.8810
 Site-Real                      (3) | Train Loss: 0.8514 | Train Acc: 0.8983
 Site-Real                      (3) | Train Loss: 0.8293 | Train Acc: 0.8952
 Site-Real                      (3) | Train Loss: 0.9358 | Train Acc: 0.9023
 Site-Painting                  (5) | Train Loss: 0.9927 | Train Acc: 0.8367
 Site-Painting                  (5) | Train Loss: 1.0559 | Train Acc: 0.8058
 Site-Painting                  (5) | Train Loss: 1.0044 | Train Acc: 0.7889
 Site-Sketch                    (4) | Train Loss: 1.0886 | Train Acc: 0.7539
 Site-Sketch                    (4) | Train Loss: 1.0749 | Train Acc: 0.7228
 Site-QuickDraw                 (1) | Train Loss: 2.0334 | Train Acc: 0.2508
 Site-Infograph                 (0) | Train Loss: 1.8049 | Train Acc: 0.3974
Average Train Accuracy: 0.7519
 Site-Clipart                   (2) | Val  Loss: 0.9717 | Val  Acc: 0.8026
 Site-Clipart                   (2) | Val  Loss: 1.0798 | Val  Acc: 0.8037
 Site-Clipart                   (2) | Val  Loss: 1.0867 | Val  Acc: 0.7867
 Site-Clipart                   (0) | Val  Loss: 1.0709 | Val  Acc: 0.7905
 Site-Clipart                   (2) | Val  Loss: 1.1722 | Val  Acc: 0.7559
 Site-Real                      (3) | Val  Loss: 0.8463 | Val  Acc: 0.9048
 Site-Real                      (3) | Val  Loss: 0.8626 | Val  Acc: 0.8898
 Site-Real                      (3) | Val  Loss: 0.8104 | Val  Acc: 0.9152
 Site-Real                      (3) | Val  Loss: 0.8480 | Val  Acc: 0.9004
 Site-Painting                  (5) | Val  Loss: 0.9633 | Val  Acc: 0.8367
 Site-Painting                  (5) | Val  Loss: 0.9685 | Val  Acc: 0.8102
 Site-Painting                  (5) | Val  Loss: 1.0451 | Val  Acc: 0.8021
 Site-Sketch                    (4) | Val  Loss: 1.1206 | Val  Acc: 0.7559
 Site-Sketch                    (4) | Val  Loss: 1.1693 | Val  Acc: 0.6966
 Site-QuickDraw                 (1) | Val  Loss: 2.0560 | Val  Acc: 0.2431
 Site-Infograph                 (0) | Val  Loss: 1.7195 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7645
 Best site-Clipart                  (2)  | Epoch:5 | Val Acc: 0.8026
 Best site-Clipart                  (2)  | Epoch:5 | Val Acc: 0.8037
 Best site-Clipart                  (2)  | Epoch:5 | Val Acc: 0.7867
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7905
 Best site-Clipart                  (2)  | Epoch:5 | Val Acc: 0.7559
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9048
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.8898
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9152
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9004
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8367
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8102
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8021
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7559
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.6966
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.2431
 Best site-Infograph                (0)  | Epoch:5 | Val Acc: 0.5385
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[1, 4, 2, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (4) | Train Loss: 1.0368 | Train Acc: 0.7826
 Site-Clipart                   (2) | Train Loss: 0.8676 | Train Acc: 0.8385
 Site-Clipart                   (2) | Train Loss: 1.0547 | Train Acc: 0.7733
 Site-Clipart                   (4) | Train Loss: 0.9468 | Train Acc: 0.8259
 Site-Clipart                   (4) | Train Loss: 1.0042 | Train Acc: 0.7986
 Site-Real                      (0) | Train Loss: 0.7865 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.7416 | Train Acc: 0.9096
 Site-Real                      (0) | Train Loss: 0.7194 | Train Acc: 0.9113
 Site-Real                      (0) | Train Loss: 0.7941 | Train Acc: 0.9167
 Site-Painting                  (3) | Train Loss: 0.9414 | Train Acc: 0.8027
 Site-Painting                  (3) | Train Loss: 0.9490 | Train Acc: 0.8252
 Site-Painting                  (3) | Train Loss: 0.9230 | Train Acc: 0.8062
 Site-Sketch                    (2) | Train Loss: 0.9584 | Train Acc: 0.7853
 Site-Sketch                    (2) | Train Loss: 1.0052 | Train Acc: 0.7678
 Site-QuickDraw                 (1) | Train Loss: 1.9367 | Train Acc: 0.2966
 Site-Infograph                 (5) | Train Loss: 1.6967 | Train Acc: 0.4701
Average Train Accuracy: 0.7755
 Site-Clipart                   (4) | Val  Loss: 0.8677 | Val  Acc: 0.7895
 Site-Clipart                   (2) | Val  Loss: 0.9372 | Val  Acc: 0.7944
 Site-Clipart                   (2) | Val  Loss: 0.9939 | Val  Acc: 0.7867
 Site-Clipart                   (4) | Val  Loss: 0.9220 | Val  Acc: 0.8048
 Site-Clipart                   (4) | Val  Loss: 1.0324 | Val  Acc: 0.7763
 Site-Real                      (0) | Val  Loss: 0.7366 | Val  Acc: 0.8929
 Site-Real                      (0) | Val  Loss: 0.7517 | Val  Acc: 0.8983
 Site-Real                      (0) | Val  Loss: 0.7250 | Val  Acc: 0.8788
 Site-Real                      (0) | Val  Loss: 0.7554 | Val  Acc: 0.9221
 Site-Painting                  (3) | Val  Loss: 0.8231 | Val  Acc: 0.8265
 Site-Painting                  (3) | Val  Loss: 0.8706 | Val  Acc: 0.8321
 Site-Painting                  (3) | Val  Loss: 0.9085 | Val  Acc: 0.8073
 Site-Sketch                    (2) | Val  Loss: 1.0208 | Val  Acc: 0.7480
 Site-Sketch                    (2) | Val  Loss: 1.0201 | Val  Acc: 0.7584
 Site-QuickDraw                 (1) | Val  Loss: 1.9841 | Val  Acc: 0.2982
 Site-Infograph                 (5) | Val  Loss: 1.6233 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7704
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7895
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7944
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7867
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.8048
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7763
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8929
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8983
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8788
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.9221
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8265
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8321
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8073
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.7480
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.7584
 Best site-QuickDraw                (1)  | Epoch:6 | Val Acc: 0.2982
 Best site-Infograph                (5)  | Epoch:6 | Val Acc: 0.5128
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 3, 1, 5, 1, 3, ]
cnt=[5, 1, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (3) | Train Loss: 0.8482 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.8192 | Train Acc: 0.8199
 Site-Clipart                   (3) | Train Loss: 0.9249 | Train Acc: 0.8222
 Site-Clipart                   (3) | Train Loss: 0.8882 | Train Acc: 0.8101
 Site-Clipart                   (3) | Train Loss: 0.9373 | Train Acc: 0.7941
 Site-Real                      (4) | Train Loss: 0.7210 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.6577 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.6258 | Train Acc: 0.8992
 Site-Real                      (1) | Train Loss: 0.7255 | Train Acc: 0.9224
 Site-Painting                  (5) | Train Loss: 0.8621 | Train Acc: 0.8163
 Site-Painting                  (5) | Train Loss: 0.8099 | Train Acc: 0.8544
 Site-Painting                  (5) | Train Loss: 0.8015 | Train Acc: 0.8443
 Site-Sketch                    (0) | Train Loss: 0.8443 | Train Acc: 0.8063
 Site-Sketch                    (0) | Train Loss: 0.8797 | Train Acc: 0.7566
 Site-QuickDraw                 (2) | Train Loss: 1.8808 | Train Acc: 0.4006
 Site-Infograph                 (3) | Train Loss: 1.6076 | Train Acc: 0.4829
Average Train Accuracy: 0.7946
 Site-Clipart                   (3) | Val  Loss: 0.8135 | Val  Acc: 0.8158
 Site-Clipart                   (0) | Val  Loss: 0.8752 | Val  Acc: 0.8037
 Site-Clipart                   (3) | Val  Loss: 0.9174 | Val  Acc: 0.8000
 Site-Clipart                   (3) | Val  Loss: 0.8641 | Val  Acc: 0.8000
 Site-Clipart                   (3) | Val  Loss: 0.9564 | Val  Acc: 0.7763
 Site-Real                      (4) | Val  Loss: 0.6497 | Val  Acc: 0.9167
 Site-Real                      (1) | Val  Loss: 0.6521 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.6255 | Val  Acc: 0.9030
 Site-Real                      (1) | Val  Loss: 0.6711 | Val  Acc: 0.9134
 Site-Painting                  (5) | Val  Loss: 0.7429 | Val  Acc: 0.8469
 Site-Painting                  (5) | Val  Loss: 0.8009 | Val  Acc: 0.8321
 Site-Painting                  (5) | Val  Loss: 0.8189 | Val  Acc: 0.8385
 Site-Sketch                    (0) | Val  Loss: 0.9030 | Val  Acc: 0.7795
 Site-Sketch                    (0) | Val  Loss: 0.9453 | Val  Acc: 0.7135
 Site-QuickDraw                 (2) | Val  Loss: 1.8827 | Val  Acc: 0.3853
 Site-Infograph                 (3) | Val  Loss: 1.5147 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7856
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8158
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8037
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8000
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8000
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7763
 Best site-Real                     (4)  | Epoch:7 | Val Acc: 0.9167
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9030
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9134
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8469
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8321
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8385
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7795
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7135
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.3853
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.5385
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 8 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[5, 1, 4, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 0.8291 | Train Acc: 0.8348
 Site-Clipart                   (4) | Train Loss: 0.7246 | Train Acc: 0.8820
 Site-Clipart                   (0) | Train Loss: 0.8806 | Train Acc: 0.8089
 Site-Clipart                   (0) | Train Loss: 0.8066 | Train Acc: 0.8165
 Site-Clipart                   (0) | Train Loss: 0.8337 | Train Acc: 0.8122
 Site-Real                      (2) | Train Loss: 0.6337 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.5618 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.5638 | Train Acc: 0.9274
 Site-Real                      (2) | Train Loss: 0.6330 | Train Acc: 0.9339
 Site-Painting                  (3) | Train Loss: 0.8021 | Train Acc: 0.8231
 Site-Painting                  (3) | Train Loss: 0.7905 | Train Acc: 0.8350
 Site-Painting                  (3) | Train Loss: 0.7384 | Train Acc: 0.8201
 Site-Sketch                    (4) | Train Loss: 0.7952 | Train Acc: 0.8010
 Site-Sketch                    (4) | Train Loss: 0.9121 | Train Acc: 0.7678
 Site-QuickDraw                 (1) | Train Loss: 1.7446 | Train Acc: 0.4128
 Site-Infograph                 (5) | Train Loss: 1.5674 | Train Acc: 0.5043
Average Train Accuracy: 0.8013
 Site-Clipart                   (0) | Val  Loss: 0.6699 | Val  Acc: 0.8553
 Site-Clipart                   (4) | Val  Loss: 0.7582 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.8024 | Val  Acc: 0.8267
 Site-Clipart                   (0) | Val  Loss: 0.7706 | Val  Acc: 0.8000
 Site-Clipart                   (0) | Val  Loss: 0.8758 | Val  Acc: 0.8169
 Site-Real                      (2) | Val  Loss: 0.5447 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.5866 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.5710 | Val  Acc: 0.8909
 Site-Real                      (2) | Val  Loss: 0.5842 | Val  Acc: 0.9351
 Site-Painting                  (3) | Val  Loss: 0.6391 | Val  Acc: 0.8776
 Site-Painting                  (3) | Val  Loss: 0.6983 | Val  Acc: 0.8029
 Site-Painting                  (3) | Val  Loss: 0.7746 | Val  Acc: 0.8438
 Site-Sketch                    (4) | Val  Loss: 0.8630 | Val  Acc: 0.7953
 Site-Sketch                    (4) | Val  Loss: 0.8886 | Val  Acc: 0.7528
 Site-QuickDraw                 (1) | Val  Loss: 1.7765 | Val  Acc: 0.4587
 Site-Infograph                 (5) | Val  Loss: 1.4687 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8105
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8553
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8692
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8267
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8000
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8169
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.8909
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9351
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8776
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8029
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8438
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.7953
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.7528
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.4587
 Best site-Infograph                (5)  | Epoch:8 | Val Acc: 0.5577
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 1, 3, 5, 3, 3, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (2) | Train Loss: 0.7326 | Train Acc: 0.8435
 Site-Clipart                   (5) | Train Loss: 0.6936 | Train Acc: 0.8385
 Site-Clipart                   (2) | Train Loss: 0.8365 | Train Acc: 0.8178
 Site-Clipart                   (4) | Train Loss: 0.7518 | Train Acc: 0.8006
 Site-Clipart                   (2) | Train Loss: 0.7769 | Train Acc: 0.8281
 Site-Real                      (3) | Train Loss: 0.5446 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.4563 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.4656 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.5379 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.6965 | Train Acc: 0.8367
 Site-Painting                  (4) | Train Loss: 0.7325 | Train Acc: 0.8689
 Site-Painting                  (1) | Train Loss: 0.6730 | Train Acc: 0.8478
 Site-Sketch                    (5) | Train Loss: 0.7323 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.7501 | Train Acc: 0.7715
 Site-QuickDraw                 (0) | Train Loss: 1.6154 | Train Acc: 0.4862
 Site-Infograph                 (3) | Train Loss: 1.5774 | Train Acc: 0.5000
Average Train Accuracy: 0.8139
 Site-Clipart                   (2) | Val  Loss: 0.5912 | Val  Acc: 0.8816
 Site-Clipart                   (5) | Val  Loss: 0.7053 | Val  Acc: 0.8598
 Site-Clipart                   (2) | Val  Loss: 0.7545 | Val  Acc: 0.8267
 Site-Clipart                   (4) | Val  Loss: 0.6871 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.8244 | Val  Acc: 0.8203
 Site-Real                      (3) | Val  Loss: 0.4949 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.4793 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.4849 | Val  Acc: 0.9091
 Site-Real                      (3) | Val  Loss: 0.5120 | Val  Acc: 0.9264
 Site-Painting                  (4) | Val  Loss: 0.6150 | Val  Acc: 0.8469
 Site-Painting                  (4) | Val  Loss: 0.6698 | Val  Acc: 0.8102
 Site-Painting                  (1) | Val  Loss: 0.6938 | Val  Acc: 0.8594
 Site-Sketch                    (5) | Val  Loss: 0.7929 | Val  Acc: 0.7953
 Site-Sketch                    (5) | Val  Loss: 0.8565 | Val  Acc: 0.7809
 Site-QuickDraw                 (0) | Val  Loss: 1.6799 | Val  Acc: 0.5183
 Site-Infograph                 (3) | Val  Loss: 1.4505 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8235
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8816
 Best site-Clipart                  (5)  | Epoch:9 | Val Acc: 0.8598
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8267
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8476
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8203
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9091
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9264
 Best site-Painting                 (4)  | Epoch:9 | Val Acc: 0.8469
 Best site-Painting                 (4)  | Epoch:9 | Val Acc: 0.8102
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8594
 Best site-Sketch                   (5)  | Epoch:9 | Val Acc: 0.7953
 Best site-Sketch                   (5)  | Epoch:9 | Val Acc: 0.7809
 Best site-QuickDraw                (0)  | Epoch:9 | Val Acc: 0.5183
 Best site-Infograph                (3)  | Epoch:9 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:9 | Test Acc: 0.8479
 Test site-Real                      (3)| Epoch:9 | Test Acc: 0.9449
 Test site-Painting                  (4)| Epoch:9 | Test Acc: 0.8805
 Test site-Sketch                    (5)| Epoch:9 | Test Acc: 0.8502
 Test site-QuickDraw                 (0)| Epoch:9 | Test Acc: 0.5410
 Test site-Infograph                 (3)| Epoch:9 | Test Acc: 0.5053
Clipart: 0.8479, Real: 0.9449, Painting: 0.8805, Sketch: 0.8502, QuickDraw: 0.5410, Infograph: 0.5053, 
Average Test Accuracy(group): 0.7616, Average Test Accuracy(individual): 0.8380,
domain std=0.1719, cluster std=0.1198, individual std=0.1252, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 1, 3, 3, 4, 1, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (4) | Train Loss: 0.6920 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.6384 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.7803 | Train Acc: 0.8311
 Site-Clipart                   (4) | Train Loss: 0.7098 | Train Acc: 0.8291
 Site-Clipart                   (3) | Train Loss: 0.7611 | Train Acc: 0.8281
 Site-Real                      (2) | Train Loss: 0.5429 | Train Acc: 0.8889
 Site-Real                      (2) | Train Loss: 0.4640 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.4732 | Train Acc: 0.9315
 Site-Real                      (2) | Train Loss: 0.5087 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.6316 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.6727 | Train Acc: 0.8592
 Site-Painting                  (0) | Train Loss: 0.6581 | Train Acc: 0.8685
 Site-Sketch                    (3) | Train Loss: 0.7265 | Train Acc: 0.8377
 Site-Sketch                    (3) | Train Loss: 0.7527 | Train Acc: 0.7715
 Site-QuickDraw                 (1) | Train Loss: 1.5415 | Train Acc: 0.5413
 Site-Infograph                 (5) | Train Loss: 1.4849 | Train Acc: 0.5342
Average Train Accuracy: 0.8269
 Site-Clipart                   (4) | Val  Loss: 0.5740 | Val  Acc: 0.8421
 Site-Clipart                   (4) | Val  Loss: 0.7096 | Val  Acc: 0.8411
 Site-Clipart                   (4) | Val  Loss: 0.6902 | Val  Acc: 0.8600
 Site-Clipart                   (4) | Val  Loss: 0.7124 | Val  Acc: 0.7857
 Site-Clipart                   (3) | Val  Loss: 0.7677 | Val  Acc: 0.8237
 Site-Real                      (2) | Val  Loss: 0.4497 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.4744 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.4293 | Val  Acc: 0.9515
 Site-Real                      (2) | Val  Loss: 0.4873 | Val  Acc: 0.9351
 Site-Painting                  (0) | Val  Loss: 0.5283 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.6513 | Val  Acc: 0.8321
 Site-Painting                  (0) | Val  Loss: 0.6312 | Val  Acc: 0.8594
 Site-Sketch                    (3) | Val  Loss: 0.7107 | Val  Acc: 0.8268
 Site-Sketch                    (3) | Val  Loss: 0.7645 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.6300 | Val  Acc: 0.5367
 Site-Infograph                 (5) | Val  Loss: 1.3756 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8285
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8421
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8411
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8600
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.7857
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8237
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9237
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9515
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9351
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.9286
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8321
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8594
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8268
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.7865
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.5367
 Best site-Infograph                (5)  | Epoch:10 | Val Acc: 0.5705
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 1, 6, 2, 3, 2, ]
cnt=[1, 4, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (2) | Train Loss: 0.6887 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.5645 | Train Acc: 0.8509
 Site-Clipart                   (2) | Train Loss: 0.7022 | Train Acc: 0.8222
 Site-Clipart                   (0) | Train Loss: 0.6427 | Train Acc: 0.8323
 Site-Clipart                   (2) | Train Loss: 0.7017 | Train Acc: 0.8190
 Site-Real                      (5) | Train Loss: 0.4957 | Train Acc: 0.9048
 Site-Real                      (5) | Train Loss: 0.4428 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.4325 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.4697 | Train Acc: 0.9397
 Site-Painting                  (4) | Train Loss: 0.6305 | Train Acc: 0.8571
 Site-Painting                  (4) | Train Loss: 0.6295 | Train Acc: 0.8592
 Site-Painting                  (4) | Train Loss: 0.6518 | Train Acc: 0.8374
 Site-Sketch                    (2) | Train Loss: 0.6700 | Train Acc: 0.8115
 Site-Sketch                    (2) | Train Loss: 0.7184 | Train Acc: 0.7903
 Site-QuickDraw                 (1) | Train Loss: 1.5994 | Train Acc: 0.5199
 Site-Infograph                 (0) | Train Loss: 1.4353 | Train Acc: 0.5385
Average Train Accuracy: 0.8180
 Site-Clipart                   (2) | Val  Loss: 0.5944 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.6188 | Val  Acc: 0.8505
 Site-Clipart                   (2) | Val  Loss: 0.6467 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.6479 | Val  Acc: 0.8238
 Site-Clipart                   (2) | Val  Loss: 0.7110 | Val  Acc: 0.8203
 Site-Real                      (5) | Val  Loss: 0.4373 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.4409 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.4519 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.4740 | Val  Acc: 0.9177
 Site-Painting                  (4) | Val  Loss: 0.5864 | Val  Acc: 0.8367
 Site-Painting                  (4) | Val  Loss: 0.6101 | Val  Acc: 0.8175
 Site-Painting                  (4) | Val  Loss: 0.6677 | Val  Acc: 0.8385
 Site-Sketch                    (2) | Val  Loss: 0.6716 | Val  Acc: 0.8425
 Site-Sketch                    (2) | Val  Loss: 0.7928 | Val  Acc: 0.7584
 Site-QuickDraw                 (1) | Val  Loss: 1.5020 | Val  Acc: 0.5872
 Site-Infograph                 (0) | Val  Loss: 1.3680 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8243
============ Train epoch 12 ============
cnt=[2, 4, 1, 4, 3, 2, ]
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (4) | Train Loss: 0.6429 | Train Acc: 0.8522
 Site-Clipart                   (4) | Train Loss: 0.5331 | Train Acc: 0.9006
 Site-Clipart                   (4) | Train Loss: 0.6783 | Train Acc: 0.8489
 Site-Clipart                   (5) | Train Loss: 0.6366 | Train Acc: 0.8133
 Site-Clipart                   (5) | Train Loss: 0.6535 | Train Acc: 0.8529
 Site-Real                      (1) | Train Loss: 0.4817 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.3955 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.4119 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.4676 | Train Acc: 0.9425
 Site-Painting                  (3) | Train Loss: 0.7264 | Train Acc: 0.8707
 Site-Painting                  (3) | Train Loss: 0.6392 | Train Acc: 0.8495
 Site-Painting                  (3) | Train Loss: 0.5783 | Train Acc: 0.8581
 Site-Sketch                    (0) | Train Loss: 0.6356 | Train Acc: 0.8377
 Site-Sketch                    (0) | Train Loss: 0.7032 | Train Acc: 0.7940
 Site-QuickDraw                 (2) | Train Loss: 1.3457 | Train Acc: 0.5688
 Site-Infograph                 (3) | Train Loss: 1.4514 | Train Acc: 0.5256
Average Train Accuracy: 0.8322
 Site-Clipart                   (4) | Val  Loss: 0.5225 | Val  Acc: 0.8947
 Site-Clipart                   (4) | Val  Loss: 0.5987 | Val  Acc: 0.8598
 Site-Clipart                   (4) | Val  Loss: 0.6367 | Val  Acc: 0.8400
 Site-Clipart                   (5) | Val  Loss: 0.6243 | Val  Acc: 0.8238
 Site-Clipart                   (5) | Val  Loss: 0.7099 | Val  Acc: 0.8203
 Site-Real                      (1) | Val  Loss: 0.3868 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.3934 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.3892 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.4237 | Val  Acc: 0.9351
 Site-Painting                  (3) | Val  Loss: 0.5151 | Val  Acc: 0.8980
 Site-Painting                  (3) | Val  Loss: 0.5618 | Val  Acc: 0.8613
 Site-Painting                  (3) | Val  Loss: 0.5909 | Val  Acc: 0.8490
 Site-Sketch                    (0) | Val  Loss: 0.6759 | Val  Acc: 0.8268
 Site-Sketch                    (0) | Val  Loss: 0.7483 | Val  Acc: 0.7809
 Site-QuickDraw                 (2) | Val  Loss: 1.4535 | Val  Acc: 0.5780
 Site-Infograph                 (3) | Val  Loss: 1.3768 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8363
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8947
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8598
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8400
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8238
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8203
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9333
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9351
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8980
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8613
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8490
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8268
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.7809
 Best site-QuickDraw                (2)  | Epoch:12 | Val Acc: 0.5780
 Best site-Infograph                (3)  | Epoch:12 | Val Acc: 0.5705
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_pcon/ccop_q=1...
============ Train epoch 13 ============
===2023-06-25 19:57:26===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
===2023-06-25 20:06:19===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
===2023-06-25 20:19:45===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-06-25 20:26:56===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9660 | Train Acc: 0.3130
 Site-Clipart                   (1) | Train Loss: 1.9446 | Train Acc: 0.3292
 Site-Clipart                   (1) | Train Loss: 2.0524 | Train Acc: 0.2800
 Site-Clipart                   (1) | Train Loss: 1.9556 | Train Acc: 0.3703
 Site-Clipart                   (0) | Train Loss: 2.0161 | Train Acc: 0.2715
 Site-Real                      (1) | Train Loss: 2.0393 | Train Acc: 0.2937
 Site-Real                      (3) | Train Loss: 1.9578 | Train Acc: 0.2994
 Site-Real                      (0) | Train Loss: 1.9105 | Train Acc: 0.3226
 Site-Real                      (1) | Train Loss: 2.0180 | Train Acc: 0.2529
 Site-Painting                  (1) | Train Loss: 1.9814 | Train Acc: 0.3197
 Site-Painting                  (1) | Train Loss: 1.9745 | Train Acc: 0.3786
 Site-Painting                  (3) | Train Loss: 1.9639 | Train Acc: 0.3668
 Site-Sketch                    (5) | Train Loss: 1.9493 | Train Acc: 0.2827
 Site-Sketch                    (2) | Train Loss: 1.9630 | Train Acc: 0.2959
 Site-QuickDraw                 (4) | Train Loss: 2.3494 | Train Acc: 0.0917
 Site-Infograph                 (3) | Train Loss: 2.0543 | Train Acc: 0.2393
Average Train Accuracy: 0.2942
 Site-Clipart                   (0) | Val  Loss: 1.9455 | Val  Acc: 0.3816
 Site-Clipart                   (1) | Val  Loss: 2.0090 | Val  Acc: 0.3364
 Site-Clipart                   (1) | Val  Loss: 1.9667 | Val  Acc: 0.3600
 Site-Clipart                   (1) | Val  Loss: 1.9362 | Val  Acc: 0.3333
 Site-Clipart                   (0) | Val  Loss: 2.0333 | Val  Acc: 0.2678
 Site-Real                      (1) | Val  Loss: 1.9926 | Val  Acc: 0.2857
 Site-Real                      (3) | Val  Loss: 1.9429 | Val  Acc: 0.3136
 Site-Real                      (0) | Val  Loss: 1.8815 | Val  Acc: 0.2848
 Site-Real                      (1) | Val  Loss: 1.9396 | Val  Acc: 0.3160
 Site-Painting                  (1) | Val  Loss: 1.9212 | Val  Acc: 0.3980
 Site-Painting                  (1) | Val  Loss: 1.9626 | Val  Acc: 0.3723
 Site-Painting                  (3) | Val  Loss: 1.9350 | Val  Acc: 0.4219
 Site-Sketch                    (5) | Val  Loss: 1.9491 | Val  Acc: 0.3465
 Site-Sketch                    (2) | Val  Loss: 1.9695 | Val  Acc: 0.3034
 Site-QuickDraw                 (4) | Val  Loss: 2.3198 | Val  Acc: 0.1147
 Site-Infograph                 (3) | Val  Loss: 2.0782 | Val  Acc: 0.2756
Average Valid Accuracy: 0.3195
============ Train epoch 2 ============
cnt=[2, 1, 2, 4, 3, 4, ]
cnt=[2, 1, 2, 4, 3, 4, ]
cnt=[2, 1, 2, 4, 3, 4, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (3) | Train Loss: 1.9292 | Train Acc: 0.2435
 Site-Clipart                   (5) | Train Loss: 1.8591 | Train Acc: 0.3168
 Site-Clipart                   (2) | Train Loss: 1.9867 | Train Acc: 0.1911
 Site-Clipart                   (0) | Train Loss: 1.8989 | Train Acc: 0.2753
 Site-Clipart                   (0) | Train Loss: 1.9415 | Train Acc: 0.2240
 Site-Real                      (5) | Train Loss: 1.9662 | Train Acc: 0.1746
 Site-Real                      (4) | Train Loss: 1.9439 | Train Acc: 0.1582
 Site-Real                      (4) | Train Loss: 1.8201 | Train Acc: 0.1935
 Site-Real                      (5) | Train Loss: 1.9255 | Train Acc: 0.1695
 Site-Painting                  (2) | Train Loss: 1.9049 | Train Acc: 0.2789
 Site-Painting                  (3) | Train Loss: 1.9000 | Train Acc: 0.2621
 Site-Painting                  (1) | Train Loss: 1.8883 | Train Acc: 0.2664
 Site-Sketch                    (4) | Train Loss: 1.8851 | Train Acc: 0.2199
 Site-Sketch                    (5) | Train Loss: 1.9311 | Train Acc: 0.2360
 Site-QuickDraw                 (3) | Train Loss: 2.4216 | Train Acc: 0.0734
 Site-Infograph                 (3) | Train Loss: 1.9654 | Train Acc: 0.2991
Average Train Accuracy: 0.2239
 Site-Clipart                   (3) | Val  Loss: 1.8587 | Val  Acc: 0.2632
 Site-Clipart                   (5) | Val  Loss: 1.9254 | Val  Acc: 0.2523
 Site-Clipart                   (2) | Val  Loss: 1.9001 | Val  Acc: 0.2600
 Site-Clipart                   (0) | Val  Loss: 1.8739 | Val  Acc: 0.2429
 Site-Clipart                   (0) | Val  Loss: 1.9790 | Val  Acc: 0.2169
 Site-Real                      (5) | Val  Loss: 1.9067 | Val  Acc: 0.1548
 Site-Real                      (4) | Val  Loss: 1.8679 | Val  Acc: 0.1610
 Site-Real                      (4) | Val  Loss: 1.8108 | Val  Acc: 0.1758
 Site-Real                      (5) | Val  Loss: 1.8252 | Val  Acc: 0.1688
 Site-Painting                  (2) | Val  Loss: 1.8254 | Val  Acc: 0.2857
 Site-Painting                  (3) | Val  Loss: 1.8702 | Val  Acc: 0.3066
 Site-Painting                  (1) | Val  Loss: 1.8655 | Val  Acc: 0.3021
 Site-Sketch                    (4) | Val  Loss: 1.8760 | Val  Acc: 0.2520
 Site-Sketch                    (5) | Val  Loss: 1.8970 | Val  Acc: 0.2079
 Site-QuickDraw                 (3) | Val  Loss: 2.3804 | Val  Acc: 0.1147
 Site-Infograph                 (3) | Val  Loss: 1.9641 | Val  Acc: 0.3141
Average Valid Accuracy: 0.2299
============ Train epoch 3 ============
===2023-06-25 20:45:05===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9760 | Train Acc: 0.2609
 Site-Clipart                   (1) | Train Loss: 1.9501 | Train Acc: 0.2795
 Site-Clipart                   (1) | Train Loss: 2.0612 | Train Acc: 0.2222
 Site-Clipart                   (1) | Train Loss: 1.9645 | Train Acc: 0.3418
 Site-Clipart                   (0) | Train Loss: 2.0229 | Train Acc: 0.2443
 Site-Real                      (1) | Train Loss: 2.0449 | Train Acc: 0.2619
 Site-Real                      (3) | Train Loss: 1.9651 | Train Acc: 0.2429
 Site-Real                      (0) | Train Loss: 1.9147 | Train Acc: 0.2903
 Site-Real                      (1) | Train Loss: 2.0218 | Train Acc: 0.2069
 Site-Painting                  (1) | Train Loss: 1.9848 | Train Acc: 0.2925
 Site-Painting                  (1) | Train Loss: 1.9805 | Train Acc: 0.3592
 Site-Painting                  (3) | Train Loss: 1.9661 | Train Acc: 0.3080
 Site-Sketch                    (5) | Train Loss: 1.9583 | Train Acc: 0.2513
 Site-Sketch                    (2) | Train Loss: 1.9693 | Train Acc: 0.2659
 Site-QuickDraw                 (4) | Train Loss: 2.3620 | Train Acc: 0.0856
 Site-Infograph                 (3) | Train Loss: 2.0504 | Train Acc: 0.2521
Average Train Accuracy: 0.2603
 Site-Clipart                   (0) | Val  Loss: 1.9519 | Val  Acc: 0.3553
 Site-Clipart                   (1) | Val  Loss: 2.0221 | Val  Acc: 0.3178
 Site-Clipart                   (1) | Val  Loss: 1.9738 | Val  Acc: 0.3400
 Site-Clipart                   (1) | Val  Loss: 1.9432 | Val  Acc: 0.2952
 Site-Clipart                   (0) | Val  Loss: 2.0436 | Val  Acc: 0.2271
 Site-Real                      (1) | Val  Loss: 1.9946 | Val  Acc: 0.2619
 Site-Real                      (3) | Val  Loss: 1.9467 | Val  Acc: 0.2966
 Site-Real                      (0) | Val  Loss: 1.8858 | Val  Acc: 0.2545
 Site-Real                      (1) | Val  Loss: 1.9426 | Val  Acc: 0.2814
 Site-Painting                  (1) | Val  Loss: 1.9236 | Val  Acc: 0.3673
 Site-Painting                  (1) | Val  Loss: 1.9663 | Val  Acc: 0.3504
 Site-Painting                  (3) | Val  Loss: 1.9381 | Val  Acc: 0.3802
 Site-Sketch                    (5) | Val  Loss: 1.9561 | Val  Acc: 0.3307
 Site-Sketch                    (2) | Val  Loss: 1.9785 | Val  Acc: 0.2809
 Site-QuickDraw                 (4) | Val  Loss: 2.3325 | Val  Acc: 0.1101
 Site-Infograph                 (3) | Val  Loss: 2.0724 | Val  Acc: 0.2756
Average Valid Accuracy: 0.2953
============ Train epoch 2 ============
===2023-06-25 20:57:22===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9552 | Train Acc: 0.3739
 Site-Clipart                   (1) | Train Loss: 1.9517 | Train Acc: 0.3665
 Site-Clipart                   (1) | Train Loss: 2.0605 | Train Acc: 0.3156
 Site-Clipart                   (1) | Train Loss: 1.9670 | Train Acc: 0.3703
 Site-Clipart                   (0) | Train Loss: 2.0278 | Train Acc: 0.2941
 Site-Real                      (1) | Train Loss: 2.0305 | Train Acc: 0.3571
 Site-Real                      (3) | Train Loss: 1.9353 | Train Acc: 0.3729
 Site-Real                      (0) | Train Loss: 1.8959 | Train Acc: 0.4274
 Site-Real                      (1) | Train Loss: 2.0176 | Train Acc: 0.3161
 Site-Painting                  (1) | Train Loss: 1.9646 | Train Acc: 0.3946
 Site-Painting                  (1) | Train Loss: 1.9588 | Train Acc: 0.4223
 Site-Painting                  (3) | Train Loss: 1.9514 | Train Acc: 0.4048
 Site-Sketch                    (5) | Train Loss: 1.9293 | Train Acc: 0.3717
 Site-Sketch                    (2) | Train Loss: 1.9446 | Train Acc: 0.3521
 Site-QuickDraw                 (4) | Train Loss: 2.3159 | Train Acc: 0.0887
 Site-Infograph                 (3) | Train Loss: 2.0724 | Train Acc: 0.2650
Average Train Accuracy: 0.3433
 Site-Clipart                   (0) | Val  Loss: 1.9687 | Val  Acc: 0.3684
 Site-Clipart                   (1) | Val  Loss: 2.0085 | Val  Acc: 0.3551
 Site-Clipart                   (1) | Val  Loss: 1.9843 | Val  Acc: 0.3667
 Site-Clipart                   (1) | Val  Loss: 1.9421 | Val  Acc: 0.3571
 Site-Clipart                   (0) | Val  Loss: 2.0371 | Val  Acc: 0.3085
 Site-Real                      (1) | Val  Loss: 1.9851 | Val  Acc: 0.3810
 Site-Real                      (3) | Val  Loss: 1.9440 | Val  Acc: 0.4153
 Site-Real                      (0) | Val  Loss: 1.8728 | Val  Acc: 0.4424
 Site-Real                      (1) | Val  Loss: 1.9340 | Val  Acc: 0.4069
 Site-Painting                  (1) | Val  Loss: 1.9094 | Val  Acc: 0.4388
 Site-Painting                  (1) | Val  Loss: 1.9607 | Val  Acc: 0.3796
 Site-Painting                  (3) | Val  Loss: 1.9192 | Val  Acc: 0.4583
 Site-Sketch                    (5) | Val  Loss: 1.9273 | Val  Acc: 0.4016
 Site-Sketch                    (2) | Val  Loss: 1.9463 | Val  Acc: 0.3764
 Site-QuickDraw                 (4) | Val  Loss: 2.2882 | Val  Acc: 0.1193
 Site-Infograph                 (3) | Val  Loss: 2.0938 | Val  Acc: 0.2949
Average Valid Accuracy: 0.3669
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.3684
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.3551
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.3667
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.3571
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.3085
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.3810
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.4153
 Best site-Real                     (0)  | Epoch:1 | Val Acc: 0.4424
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.4069
 Best site-Painting                 (1)  | Epoch:1 | Val Acc: 0.4388
 Best site-Painting                 (1)  | Epoch:1 | Val Acc: 0.3796
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.4583
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4016
 Best site-Sketch                   (2)  | Epoch:1 | Val Acc: 0.3764
 Best site-QuickDraw                (4)  | Epoch:1 | Val Acc: 0.1193
 Best site-Infograph                (3)  | Epoch:1 | Val Acc: 0.2949
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 2 ============
===2023-06-25 21:07:45===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-06-25 21:20:54===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9776 | Train Acc: 0.2609
 Site-Clipart                   (1) | Train Loss: 1.9510 | Train Acc: 0.2733
 Site-Clipart                   (1) | Train Loss: 2.0626 | Train Acc: 0.2222
 Site-Clipart                   (1) | Train Loss: 1.9659 | Train Acc: 0.3354
 Site-Clipart                   (0) | Train Loss: 2.0240 | Train Acc: 0.2443
 Site-Real                      (1) | Train Loss: 2.0460 | Train Acc: 0.2619
 Site-Real                      (3) | Train Loss: 1.9663 | Train Acc: 0.2373
 Site-Real                      (0) | Train Loss: 1.9154 | Train Acc: 0.2903
 Site-Real                      (1) | Train Loss: 2.0225 | Train Acc: 0.2040
 Site-Painting                  (1) | Train Loss: 1.9853 | Train Acc: 0.2789
 Site-Painting                  (1) | Train Loss: 1.9814 | Train Acc: 0.3544
 Site-Painting                  (3) | Train Loss: 1.9665 | Train Acc: 0.3045
 Site-Sketch                    (5) | Train Loss: 1.9597 | Train Acc: 0.2461
 Site-Sketch                    (2) | Train Loss: 1.9702 | Train Acc: 0.2659
 Site-QuickDraw                 (4) | Train Loss: 2.3641 | Train Acc: 0.0826
 Site-Infograph                 (3) | Train Loss: 2.0499 | Train Acc: 0.2521
Average Train Accuracy: 0.2571
 Site-Clipart                   (0) | Val  Loss: 1.9529 | Val  Acc: 0.3421
 Site-Clipart                   (1) | Val  Loss: 2.0241 | Val  Acc: 0.3178
 Site-Clipart                   (1) | Val  Loss: 1.9749 | Val  Acc: 0.3400
 Site-Clipart                   (1) | Val  Loss: 1.9443 | Val  Acc: 0.3000
 Site-Clipart                   (0) | Val  Loss: 2.0451 | Val  Acc: 0.2237
 Site-Real                      (1) | Val  Loss: 1.9950 | Val  Acc: 0.2619
 Site-Real                      (3) | Val  Loss: 1.9474 | Val  Acc: 0.2797
 Site-Real                      (0) | Val  Loss: 1.8863 | Val  Acc: 0.2485
 Site-Real                      (1) | Val  Loss: 1.9431 | Val  Acc: 0.2814
 Site-Painting                  (1) | Val  Loss: 1.9239 | Val  Acc: 0.3571
 Site-Painting                  (1) | Val  Loss: 1.9670 | Val  Acc: 0.3504
 Site-Painting                  (3) | Val  Loss: 1.9384 | Val  Acc: 0.3750
 Site-Sketch                    (5) | Val  Loss: 1.9571 | Val  Acc: 0.3228
 Site-Sketch                    (2) | Val  Loss: 1.9798 | Val  Acc: 0.2809
 Site-QuickDraw                 (4) | Val  Loss: 2.3347 | Val  Acc: 0.1101
 Site-Infograph                 (3) | Val  Loss: 2.0715 | Val  Acc: 0.2756
Average Valid Accuracy: 0.2917
============ Train epoch 2 ============
cnt=[2, 1, 2, 4, 3, 4, ]
cnt=[2, 1, 2, 4, 3, 4, ]
cnt=[2, 1, 2, 4, 3, 4, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (3) | Train Loss: 1.9330 | Train Acc: 0.2435
 Site-Clipart                   (5) | Train Loss: 1.8586 | Train Acc: 0.3354
 Site-Clipart                   (2) | Train Loss: 1.9916 | Train Acc: 0.2222
 Site-Clipart                   (0) | Train Loss: 1.9126 | Train Acc: 0.2911
 Site-Clipart                   (0) | Train Loss: 1.9438 | Train Acc: 0.2421
 Site-Real                      (5) | Train Loss: 1.9510 | Train Acc: 0.2222
 Site-Real                      (4) | Train Loss: 1.9341 | Train Acc: 0.1695
 Site-Real                      (4) | Train Loss: 1.8000 | Train Acc: 0.2661
 Site-Real                      (5) | Train Loss: 1.9057 | Train Acc: 0.2155
 Site-Painting                  (2) | Train Loss: 1.8946 | Train Acc: 0.3061
 Site-Painting                  (3) | Train Loss: 1.8957 | Train Acc: 0.2670
 Site-Painting                  (1) | Train Loss: 1.8753 | Train Acc: 0.3010
 Site-Sketch                    (4) | Train Loss: 1.8852 | Train Acc: 0.2670
 Site-Sketch                    (5) | Train Loss: 1.9192 | Train Acc: 0.2772
 Site-QuickDraw                 (3) | Train Loss: 2.4152 | Train Acc: 0.0673
 Site-Infograph                 (3) | Train Loss: 1.9624 | Train Acc: 0.2991
Average Train Accuracy: 0.2495
 Site-Clipart                   (3) | Val  Loss: 1.8603 | Val  Acc: 0.2895
 Site-Clipart                   (5) | Val  Loss: 1.9433 | Val  Acc: 0.2617
 Site-Clipart                   (2) | Val  Loss: 1.9196 | Val  Acc: 0.3000
 Site-Clipart                   (0) | Val  Loss: 1.8854 | Val  Acc: 0.2619
 Site-Clipart                   (0) | Val  Loss: 1.9872 | Val  Acc: 0.2136
 Site-Real                      (5) | Val  Loss: 1.8802 | Val  Acc: 0.2143
 Site-Real                      (4) | Val  Loss: 1.8489 | Val  Acc: 0.2119
 Site-Real                      (4) | Val  Loss: 1.7921 | Val  Acc: 0.2485
 Site-Real                      (5) | Val  Loss: 1.8066 | Val  Acc: 0.2641
 Site-Painting                  (2) | Val  Loss: 1.8191 | Val  Acc: 0.3061
 Site-Painting                  (3) | Val  Loss: 1.8606 | Val  Acc: 0.3504
 Site-Painting                  (1) | Val  Loss: 1.8634 | Val  Acc: 0.3281
 Site-Sketch                    (4) | Val  Loss: 1.8720 | Val  Acc: 0.2913
 Site-Sketch                    (5) | Val  Loss: 1.8885 | Val  Acc: 0.2640
 Site-QuickDraw                 (3) | Val  Loss: 2.3776 | Val  Acc: 0.1147
 Site-Infograph                 (3) | Val  Loss: 1.9625 | Val  Acc: 0.3205
Average Valid Accuracy: 0.2650
============ Train epoch 3 ============
===2023-06-25 21:36:10===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
===2023-06-25 21:41:19===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9581 | Train Acc: 0.3565
 Site-Clipart                   (1) | Train Loss: 1.9442 | Train Acc: 0.3478
 Site-Clipart                   (1) | Train Loss: 2.0521 | Train Acc: 0.2889
 Site-Clipart                   (1) | Train Loss: 1.9558 | Train Acc: 0.3797
 Site-Clipart                   (0) | Train Loss: 2.0167 | Train Acc: 0.2873
 Site-Real                      (1) | Train Loss: 2.0322 | Train Acc: 0.3175
 Site-Real                      (3) | Train Loss: 1.9474 | Train Acc: 0.3559
 Site-Real                      (0) | Train Loss: 1.9033 | Train Acc: 0.3710
 Site-Real                      (1) | Train Loss: 2.0147 | Train Acc: 0.2874
 Site-Painting                  (1) | Train Loss: 1.9745 | Train Acc: 0.3469
 Site-Painting                  (1) | Train Loss: 1.9685 | Train Acc: 0.3883
 Site-Painting                  (3) | Train Loss: 1.9592 | Train Acc: 0.3841
 Site-Sketch                    (5) | Train Loss: 1.9398 | Train Acc: 0.3246
 Site-Sketch                    (2) | Train Loss: 1.9547 | Train Acc: 0.3184
 Site-QuickDraw                 (4) | Train Loss: 2.3304 | Train Acc: 0.0887
 Site-Infograph                 (3) | Train Loss: 2.0611 | Train Acc: 0.2564
Average Train Accuracy: 0.3187
 Site-Clipart                   (0) | Val  Loss: 1.9489 | Val  Acc: 0.3684
 Site-Clipart                   (1) | Val  Loss: 2.0043 | Val  Acc: 0.3458
 Site-Clipart                   (1) | Val  Loss: 1.9695 | Val  Acc: 0.3600
 Site-Clipart                   (1) | Val  Loss: 1.9353 | Val  Acc: 0.3524
 Site-Clipart                   (0) | Val  Loss: 2.0310 | Val  Acc: 0.2814
 Site-Real                      (1) | Val  Loss: 1.9874 | Val  Acc: 0.3095
 Site-Real                      (3) | Val  Loss: 1.9398 | Val  Acc: 0.3390
 Site-Real                      (0) | Val  Loss: 1.8771 | Val  Acc: 0.3212
 Site-Real                      (1) | Val  Loss: 1.9354 | Val  Acc: 0.3636
 Site-Painting                  (1) | Val  Loss: 1.9174 | Val  Acc: 0.4592
 Site-Painting                  (1) | Val  Loss: 1.9585 | Val  Acc: 0.4088
 Site-Painting                  (3) | Val  Loss: 1.9302 | Val  Acc: 0.4323
 Site-Sketch                    (5) | Val  Loss: 1.9392 | Val  Acc: 0.3780
 Site-Sketch                    (2) | Val  Loss: 1.9580 | Val  Acc: 0.3258
 Site-QuickDraw                 (4) | Val  Loss: 2.3010 | Val  Acc: 0.1147
 Site-Infograph                 (3) | Val  Loss: 2.0849 | Val  Acc: 0.2821
Average Valid Accuracy: 0.3401
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.3684
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.3458
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.3600
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.3524
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.2814
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.3095
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.3390
 Best site-Real                     (0)  | Epoch:1 | Val Acc: 0.3212
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.3636
 Best site-Painting                 (1)  | Epoch:1 | Val Acc: 0.4592
 Best site-Painting                 (1)  | Epoch:1 | Val Acc: 0.4088
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.4323
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.3780
 Best site-Sketch                   (2)  | Epoch:1 | Val Acc: 0.3258
 Best site-QuickDraw                (4)  | Epoch:1 | Val Acc: 0.1147
 Best site-Infograph                (3)  | Epoch:1 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 2 ============
===2023-06-25 21:59:10===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
===2023-06-25 22:03:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (1)| Epoch:0 | Test Acc: 0.2871
 Test site-Real                      (0)| Epoch:0 | Test Acc: 0.3418
 Test site-Painting                  (5)| Epoch:0 | Test Acc: 0.3667
 Test site-Sketch                    (4)| Epoch:0 | Test Acc: 0.3412
===2023-06-25 22:06:57===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
===2023-06-25 22:11:23===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (1)| Epoch:0 | Test Acc: 0.2871
 Test site-Real                      (0)| Epoch:0 | Test Acc: 0.3418
 Test site-Painting                  (5)| Epoch:0 | Test Acc: 0.3667
 Test site-Sketch                    (4)| Epoch:0 | Test Acc: 0.3412
 Test site-QuickDraw                 (2)| Epoch:0 | Test Acc: 0.1680
 Test site-Infograph                 (3)| Epoch:0 | Test Acc: 0.1887
Clipart: 0.2871, Real: 0.3418, Painting: 0.3667, Sketch: 0.3412, QuickDraw: 0.1680, Infograph: 0.1887, 
Average Test Accuracy(group): 0.2823, Average Test Accuracy(individual): 0.3089,
domain std=0.0774, cluster std=0.0774, individual std=0.0576, 
===2023-06-25 22:16:06===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
cnt=[2, 2, 1, 2, 3, 6, ]
cnt=[2, 2, 1, 2, 3, 6, ]
cnt=[2, 2, 1, 2, 3, 6, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (4) | Train Loss: 1.9776 | Train Acc: 0.2609
 Site-Clipart                   (5) | Train Loss: 1.9510 | Train Acc: 0.2733
 Site-Clipart                   (5) | Train Loss: 2.0626 | Train Acc: 0.2222
 Site-Clipart                   (1) | Train Loss: 1.9659 | Train Acc: 0.3354
 Site-Clipart                   (4) | Train Loss: 2.0240 | Train Acc: 0.2443
 Site-Real                      (5) | Train Loss: 2.0460 | Train Acc: 0.2619
 Site-Real                      (3) | Train Loss: 1.9663 | Train Acc: 0.2373
 Site-Real                      (0) | Train Loss: 1.9153 | Train Acc: 0.2903
 Site-Real                      (5) | Train Loss: 2.0225 | Train Acc: 0.2011
 Site-Painting                  (1) | Train Loss: 1.9853 | Train Acc: 0.2789
 Site-Painting                  (5) | Train Loss: 1.9814 | Train Acc: 0.3544
 Site-Painting                  (3) | Train Loss: 1.9665 | Train Acc: 0.3045
 Site-Sketch                    (5) | Train Loss: 1.9597 | Train Acc: 0.2461
 Site-Sketch                    (4) | Train Loss: 1.9702 | Train Acc: 0.2659
 Site-QuickDraw                 (0) | Train Loss: 2.3643 | Train Acc: 0.0826
 Site-Infograph                 (2) | Train Loss: 2.0498 | Train Acc: 0.2521
Average Train Accuracy: 0.2570
 Site-Clipart                   (4) | Val  Loss: 1.9529 | Val  Acc: 0.3421
 Site-Clipart                   (5) | Val  Loss: 2.0241 | Val  Acc: 0.3178
 Site-Clipart                   (5) | Val  Loss: 1.9749 | Val  Acc: 0.3333
 Site-Clipart                   (1) | Val  Loss: 1.9443 | Val  Acc: 0.3000
 Site-Clipart                   (4) | Val  Loss: 2.0452 | Val  Acc: 0.2237
 Site-Real                      (5) | Val  Loss: 1.9949 | Val  Acc: 0.2619
 Site-Real                      (3) | Val  Loss: 1.9474 | Val  Acc: 0.2797
 Site-Real                      (0) | Val  Loss: 1.8863 | Val  Acc: 0.2485
 Site-Real                      (5) | Val  Loss: 1.9431 | Val  Acc: 0.2814
 Site-Painting                  (1) | Val  Loss: 1.9239 | Val  Acc: 0.3571
 Site-Painting                  (5) | Val  Loss: 1.9671 | Val  Acc: 0.3504
 Site-Painting                  (3) | Val  Loss: 1.9384 | Val  Acc: 0.3750
 Site-Sketch                    (5) | Val  Loss: 1.9571 | Val  Acc: 0.3228
 Site-Sketch                    (4) | Val  Loss: 1.9798 | Val  Acc: 0.2809
 Site-QuickDraw                 (0) | Val  Loss: 2.3349 | Val  Acc: 0.1101
 Site-Infograph                 (2) | Val  Loss: 2.0715 | Val  Acc: 0.2756
Average Valid Accuracy: 0.2913
============ Train epoch 2 ============
===2023-06-25 22:32:32===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
===2023-06-25 22:35:30===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-06-25 22:35:37===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
===2023-06-25 22:36:02===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-06-25 22:37:57===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
===2023-06-25 22:42:23===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (1)| Epoch:0 | Test Acc: 0.2871
 Test site-Real                      (0)| Epoch:0 | Test Acc: 0.3418
 Test site-Painting                  (5)| Epoch:0 | Test Acc: 0.3667
 Test site-Sketch                    (4)| Epoch:0 | Test Acc: 0.3412
 Test site-QuickDraw                 (2)| Epoch:0 | Test Acc: 0.1680
 Test site-Infograph                 (3)| Epoch:0 | Test Acc: 0.1887
Clipart: 0.2871, Real: 0.3418, Painting: 0.3667, Sketch: 0.3412, QuickDraw: 0.1680, Infograph: 0.1887, 
Average Test Accuracy(group): 0.2823, Average Test Accuracy(individual): 0.3089,
domain std=0.0774, cluster std=0.0774, individual std=0.0576, 
===2023-06-25 23:09:36===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
cnt=[3, 7, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9777 | Train Acc: 0.2609
 Site-Clipart                   (1) | Train Loss: 1.9510 | Train Acc: 0.2733
 Site-Clipart                   (1) | Train Loss: 2.0625 | Train Acc: 0.2222
 Site-Clipart                   (1) | Train Loss: 1.9658 | Train Acc: 0.3354
 Site-Clipart                   (0) | Train Loss: 2.0239 | Train Acc: 0.2443
 Site-Real                      (1) | Train Loss: 2.0462 | Train Acc: 0.2619
 Site-Real                      (3) | Train Loss: 1.9665 | Train Acc: 0.2373
 Site-Real                      (0) | Train Loss: 1.9155 | Train Acc: 0.2903
 Site-Real                      (1) | Train Loss: 2.0227 | Train Acc: 0.1983
 Site-Painting                  (1) | Train Loss: 1.9855 | Train Acc: 0.2789
 Site-Painting                  (1) | Train Loss: 1.9815 | Train Acc: 0.3544
 Site-Painting                  (3) | Train Loss: 1.9666 | Train Acc: 0.3045
 Site-Sketch                    (5) | Train Loss: 1.9598 | Train Acc: 0.2461
 Site-Sketch                    (2) | Train Loss: 1.9703 | Train Acc: 0.2622
 Site-QuickDraw                 (4) | Train Loss: 2.3645 | Train Acc: 0.0826
 Site-Infograph                 (3) | Train Loss: 2.0498 | Train Acc: 0.2521
Average Train Accuracy: 0.2565
 Site-Clipart                   (0) | Val  Loss: 1.9528 | Val  Acc: 0.3421
 Site-Clipart                   (1) | Val  Loss: 2.0241 | Val  Acc: 0.3178
 Site-Clipart                   (1) | Val  Loss: 1.9748 | Val  Acc: 0.3333
 Site-Clipart                   (1) | Val  Loss: 1.9443 | Val  Acc: 0.3000
 Site-Clipart                   (0) | Val  Loss: 2.0451 | Val  Acc: 0.2203
 Site-Real                      (1) | Val  Loss: 1.9951 | Val  Acc: 0.2619
 Site-Real                      (3) | Val  Loss: 1.9475 | Val  Acc: 0.2797
 Site-Real                      (0) | Val  Loss: 1.8864 | Val  Acc: 0.2485
 Site-Real                      (1) | Val  Loss: 1.9432 | Val  Acc: 0.2814
 Site-Painting                  (1) | Val  Loss: 1.9240 | Val  Acc: 0.3673
 Site-Painting                  (1) | Val  Loss: 1.9672 | Val  Acc: 0.3504
 Site-Painting                  (3) | Val  Loss: 1.9384 | Val  Acc: 0.3750
 Site-Sketch                    (5) | Val  Loss: 1.9572 | Val  Acc: 0.3228
 Site-Sketch                    (2) | Val  Loss: 1.9800 | Val  Acc: 0.2753
 Site-QuickDraw                 (4) | Val  Loss: 2.3352 | Val  Acc: 0.1101
 Site-Infograph                 (3) | Val  Loss: 2.0714 | Val  Acc: 0.2756
Average Valid Accuracy: 0.2913
============ Train epoch 2 ============
cnt=[2, 1, 2, 4, 3, 4, ]
cnt=[2, 1, 2, 4, 3, 4, ]
cnt=[2, 1, 2, 4, 3, 4, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (3) | Train Loss: 1.9329 | Train Acc: 0.2435
 Site-Clipart                   (5) | Train Loss: 1.8584 | Train Acc: 0.3354
 Site-Clipart                   (2) | Train Loss: 1.9912 | Train Acc: 0.2222
 Site-Clipart                   (0) | Train Loss: 1.9123 | Train Acc: 0.2911
 Site-Clipart                   (0) | Train Loss: 1.9436 | Train Acc: 0.2421
 Site-Real                      (5) | Train Loss: 1.9510 | Train Acc: 0.2143
 Site-Real                      (4) | Train Loss: 1.9342 | Train Acc: 0.1695
 Site-Real                      (4) | Train Loss: 1.8001 | Train Acc: 0.2661
 Site-Real                      (5) | Train Loss: 1.9057 | Train Acc: 0.2155
 Site-Painting                  (2) | Train Loss: 1.8947 | Train Acc: 0.3061
 Site-Painting                  (3) | Train Loss: 1.8957 | Train Acc: 0.2670
 Site-Painting                  (1) | Train Loss: 1.8755 | Train Acc: 0.3010
 Site-Sketch                    (4) | Train Loss: 1.8852 | Train Acc: 0.2670
 Site-Sketch                    (5) | Train Loss: 1.9192 | Train Acc: 0.2772
 Site-QuickDraw                 (3) | Train Loss: 2.4155 | Train Acc: 0.0673
 Site-Infograph                 (3) | Train Loss: 1.9624 | Train Acc: 0.2991
Average Train Accuracy: 0.2490
 Site-Clipart                   (3) | Val  Loss: 1.8601 | Val  Acc: 0.2895
 Site-Clipart                   (5) | Val  Loss: 1.9429 | Val  Acc: 0.2617
 Site-Clipart                   (2) | Val  Loss: 1.9192 | Val  Acc: 0.3000
 Site-Clipart                   (0) | Val  Loss: 1.8851 | Val  Acc: 0.2619
 Site-Clipart                   (0) | Val  Loss: 1.9869 | Val  Acc: 0.2136
 Site-Real                      (5) | Val  Loss: 1.8803 | Val  Acc: 0.2143
 Site-Real                      (4) | Val  Loss: 1.8489 | Val  Acc: 0.2203
 Site-Real                      (4) | Val  Loss: 1.7922 | Val  Acc: 0.2485
 Site-Real                      (5) | Val  Loss: 1.8066 | Val  Acc: 0.2641
 Site-Painting                  (2) | Val  Loss: 1.8191 | Val  Acc: 0.3061
 Site-Painting                  (3) | Val  Loss: 1.8607 | Val  Acc: 0.3431
 Site-Painting                  (1) | Val  Loss: 1.8634 | Val  Acc: 0.3281
 Site-Sketch                    (4) | Val  Loss: 1.8721 | Val  Acc: 0.2913
 Site-Sketch                    (5) | Val  Loss: 1.8885 | Val  Acc: 0.2640
 Site-QuickDraw                 (3) | Val  Loss: 2.3779 | Val  Acc: 0.1147
 Site-Infograph                 (3) | Val  Loss: 1.9624 | Val  Acc: 0.3205
Average Valid Accuracy: 0.2651
============ Train epoch 3 ============
===2023-06-26 02:08:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1100 | Train Acc: 0.2522
 Site-Clipart                   (1) | Train Loss: 2.0453 | Train Acc: 0.3540
 Site-Clipart                   (1) | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-Clipart                   (1) | Train Loss: 2.0738 | Train Acc: 0.2911
 Site-Clipart                   (1) | Train Loss: 2.1005 | Train Acc: 0.2715
 Site-Real                      (0) | Train Loss: 2.0876 | Train Acc: 0.3571
 Site-Real                      (0) | Train Loss: 2.0787 | Train Acc: 0.3559
 Site-Real                      (0) | Train Loss: 2.0687 | Train Acc: 0.3589
 Site-Real                      (0) | Train Loss: 2.1167 | Train Acc: 0.2816
 Site-Painting                  (5) | Train Loss: 2.1118 | Train Acc: 0.3605
 Site-Painting                  (5) | Train Loss: 2.1080 | Train Acc: 0.3495
 Site-Painting                  (5) | Train Loss: 2.0811 | Train Acc: 0.3149
 Site-Sketch                    (4) | Train Loss: 2.0476 | Train Acc: 0.3508
 Site-Sketch                    (4) | Train Loss: 2.1048 | Train Acc: 0.3558
 Site-QuickDraw                 (2) | Train Loss: 2.3103 | Train Acc: 0.1713
 Site-Infograph                 (3) | Train Loss: 2.2553 | Train Acc: 0.1880
Average Train Accuracy: 0.3067
 Site-Clipart                   (1) | Val  Loss: 2.0400 | Val  Acc: 0.2500
 Site-Clipart                   (1) | Val  Loss: 2.1068 | Val  Acc: 0.2991
 Site-Clipart                   (1) | Val  Loss: 2.0650 | Val  Acc: 0.3333
 Site-Clipart                   (1) | Val  Loss: 2.0566 | Val  Acc: 0.3571
 Site-Clipart                   (1) | Val  Loss: 2.1134 | Val  Acc: 0.2678
 Site-Real                      (0) | Val  Loss: 2.0676 | Val  Acc: 0.3452
 Site-Real                      (0) | Val  Loss: 2.0913 | Val  Acc: 0.3220
 Site-Real                      (0) | Val  Loss: 2.0499 | Val  Acc: 0.4061
 Site-Real                      (0) | Val  Loss: 2.0611 | Val  Acc: 0.3766
 Site-Painting                  (5) | Val  Loss: 2.1028 | Val  Acc: 0.3776
 Site-Painting                  (5) | Val  Loss: 2.0467 | Val  Acc: 0.3650
 Site-Painting                  (5) | Val  Loss: 2.1136 | Val  Acc: 0.3385
 Site-Sketch                    (4) | Val  Loss: 2.0787 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0737 | Val  Acc: 0.3539
 Site-QuickDraw                 (2) | Val  Loss: 2.3222 | Val  Acc: 0.1881
 Site-Infograph                 (3) | Val  Loss: 2.2939 | Val  Acc: 0.1603
Average Valid Accuracy: 0.3189
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2991
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2678
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3452
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3220
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4061
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3766
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3776
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3650
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3385
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3539
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1881
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.1603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 1 ============
cnt=[1, 1, 4, 3, 1, 6, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (5) | Train Loss: 1.8917 | Train Acc: 0.4783
 Site-Clipart                   (5) | Train Loss: 1.8296 | Train Acc: 0.4720
 Site-Clipart                   (5) | Train Loss: 1.9283 | Train Acc: 0.4311
 Site-Clipart                   (0) | Train Loss: 1.8618 | Train Acc: 0.4873
 Site-Clipart                   (5) | Train Loss: 1.9102 | Train Acc: 0.4367
 Site-Real                      (2) | Train Loss: 1.8105 | Train Acc: 0.5952
 Site-Real                      (2) | Train Loss: 1.7453 | Train Acc: 0.6271
 Site-Real                      (2) | Train Loss: 1.7490 | Train Acc: 0.6210
 Site-Real                      (2) | Train Loss: 1.8217 | Train Acc: 0.5575
 Site-Painting                  (3) | Train Loss: 1.8388 | Train Acc: 0.4966
 Site-Painting                  (3) | Train Loss: 1.8331 | Train Acc: 0.5340
 Site-Painting                  (3) | Train Loss: 1.8299 | Train Acc: 0.5052
 Site-Sketch                    (5) | Train Loss: 1.8373 | Train Acc: 0.5026
 Site-Sketch                    (5) | Train Loss: 1.8849 | Train Acc: 0.4719
 Site-QuickDraw                 (1) | Train Loss: 2.2339 | Train Acc: 0.1682
 Site-Infograph                 (4) | Train Loss: 2.1991 | Train Acc: 0.2051
Average Train Accuracy: 0.4744
 Site-Clipart                   (5) | Val  Loss: 1.7933 | Val  Acc: 0.5132
 Site-Clipart                   (5) | Val  Loss: 1.8835 | Val  Acc: 0.4299
 Site-Clipart                   (5) | Val  Loss: 1.8586 | Val  Acc: 0.5200
 Site-Clipart                   (0) | Val  Loss: 1.8560 | Val  Acc: 0.4571
 Site-Clipart                   (5) | Val  Loss: 1.9249 | Val  Acc: 0.3898
 Site-Real                      (2) | Val  Loss: 1.7446 | Val  Acc: 0.5833
 Site-Real                      (2) | Val  Loss: 1.7921 | Val  Acc: 0.5932
 Site-Real                      (2) | Val  Loss: 1.7421 | Val  Acc: 0.6485
 Site-Real                      (2) | Val  Loss: 1.7647 | Val  Acc: 0.6104
 Site-Painting                  (3) | Val  Loss: 1.8233 | Val  Acc: 0.5612
 Site-Painting                  (3) | Val  Loss: 1.8102 | Val  Acc: 0.5182
 Site-Painting                  (3) | Val  Loss: 1.8519 | Val  Acc: 0.4948
 Site-Sketch                    (5) | Val  Loss: 1.8071 | Val  Acc: 0.5276
 Site-Sketch                    (5) | Val  Loss: 1.8915 | Val  Acc: 0.4326
 Site-QuickDraw                 (1) | Val  Loss: 2.2509 | Val  Acc: 0.1789
 Site-Infograph                 (4) | Val  Loss: 2.1629 | Val  Acc: 0.1859
Average Valid Accuracy: 0.4778
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5132
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4299
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5200
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4571
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.3898
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5833
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5932
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6485
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6104
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5612
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5182
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.4948
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5276
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4326
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.1789
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.1859
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 2 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[2, 1, 4, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.6685 | Train Acc: 0.5739
 Site-Clipart                   (0) | Train Loss: 1.6010 | Train Acc: 0.6025
 Site-Clipart                   (0) | Train Loss: 1.7030 | Train Acc: 0.5822
 Site-Clipart                   (0) | Train Loss: 1.6479 | Train Acc: 0.6171
 Site-Clipart                   (0) | Train Loss: 1.6650 | Train Acc: 0.6154
 Site-Real                      (2) | Train Loss: 1.5857 | Train Acc: 0.6984
 Site-Real                      (2) | Train Loss: 1.4961 | Train Acc: 0.7175
 Site-Real                      (2) | Train Loss: 1.4613 | Train Acc: 0.7540
 Site-Real                      (2) | Train Loss: 1.5663 | Train Acc: 0.7069
 Site-Painting                  (4) | Train Loss: 1.6000 | Train Acc: 0.6599
 Site-Painting                  (4) | Train Loss: 1.6138 | Train Acc: 0.6553
 Site-Painting                  (4) | Train Loss: 1.5515 | Train Acc: 0.7093
 Site-Sketch                    (5) | Train Loss: 1.6524 | Train Acc: 0.5864
 Site-Sketch                    (5) | Train Loss: 1.6854 | Train Acc: 0.6067
 Site-QuickDraw                 (1) | Train Loss: 2.2384 | Train Acc: 0.1957
 Site-Infograph                 (3) | Train Loss: 2.0477 | Train Acc: 0.3419
Average Train Accuracy: 0.6015
 Site-Clipart                   (0) | Val  Loss: 1.5396 | Val  Acc: 0.6447
 Site-Clipart                   (0) | Val  Loss: 1.6379 | Val  Acc: 0.6822
 Site-Clipart                   (0) | Val  Loss: 1.6524 | Val  Acc: 0.6733
 Site-Clipart                   (0) | Val  Loss: 1.6453 | Val  Acc: 0.6429
 Site-Clipart                   (0) | Val  Loss: 1.7136 | Val  Acc: 0.5932
 Site-Real                      (2) | Val  Loss: 1.5019 | Val  Acc: 0.6786
 Site-Real                      (2) | Val  Loss: 1.5013 | Val  Acc: 0.7288
 Site-Real                      (2) | Val  Loss: 1.4070 | Val  Acc: 0.7879
 Site-Real                      (2) | Val  Loss: 1.4822 | Val  Acc: 0.7662
 Site-Painting                  (4) | Val  Loss: 1.5493 | Val  Acc: 0.7143
 Site-Painting                  (4) | Val  Loss: 1.5443 | Val  Acc: 0.6569
 Site-Painting                  (4) | Val  Loss: 1.5912 | Val  Acc: 0.6719
 Site-Sketch                    (5) | Val  Loss: 1.6704 | Val  Acc: 0.5984
 Site-Sketch                    (5) | Val  Loss: 1.7278 | Val  Acc: 0.5393
 Site-QuickDraw                 (1) | Val  Loss: 2.2452 | Val  Acc: 0.2110
 Site-Infograph                 (3) | Val  Loss: 2.0165 | Val  Acc: 0.3462
Average Valid Accuracy: 0.6210
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6447
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6822
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6733
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6429
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5932
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.6786
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7288
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7879
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7662
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.7143
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6569
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6719
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5984
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5393
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2110
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.3462
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 3 ============
cnt=[5, 1, 4, 2, 3, 1, ]
cnt=[3, 5, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.4797 | Train Acc: 0.6174
 Site-Clipart                   (0) | Train Loss: 1.3693 | Train Acc: 0.7516
 Site-Clipart                   (0) | Train Loss: 1.5398 | Train Acc: 0.6844
 Site-Clipart                   (0) | Train Loss: 1.4456 | Train Acc: 0.7152
 Site-Clipart                   (0) | Train Loss: 1.4611 | Train Acc: 0.7081
 Site-Real                      (2) | Train Loss: 1.2940 | Train Acc: 0.8571
 Site-Real                      (2) | Train Loss: 1.2125 | Train Acc: 0.8644
 Site-Real                      (2) | Train Loss: 1.1988 | Train Acc: 0.8347
 Site-Real                      (2) | Train Loss: 1.3090 | Train Acc: 0.8276
 Site-Painting                  (4) | Train Loss: 1.4046 | Train Acc: 0.7075
 Site-Painting                  (4) | Train Loss: 1.3967 | Train Acc: 0.7282
 Site-Painting                  (4) | Train Loss: 1.3616 | Train Acc: 0.7612
 Site-Sketch                    (3) | Train Loss: 1.4004 | Train Acc: 0.7016
 Site-Sketch                    (3) | Train Loss: 1.4324 | Train Acc: 0.6592
 Site-QuickDraw                 (1) | Train Loss: 2.1270 | Train Acc: 0.2232
 Site-Infograph                 (5) | Train Loss: 1.9565 | Train Acc: 0.3974
Average Train Accuracy: 0.6899
 Site-Clipart                   (0) | Val  Loss: 1.3537 | Val  Acc: 0.7237
 Site-Clipart                   (0) | Val  Loss: 1.4319 | Val  Acc: 0.7196
 Site-Clipart                   (0) | Val  Loss: 1.4244 | Val  Acc: 0.7200
 Site-Clipart                   (0) | Val  Loss: 1.4047 | Val  Acc: 0.7286
 Site-Clipart                   (0) | Val  Loss: 1.5007 | Val  Acc: 0.6814
 Site-Real                      (2) | Val  Loss: 1.1879 | Val  Acc: 0.8095
 Site-Real                      (2) | Val  Loss: 1.2222 | Val  Acc: 0.8220
 Site-Real                      (2) | Val  Loss: 1.1695 | Val  Acc: 0.8606
 Site-Real                      (2) | Val  Loss: 1.2076 | Val  Acc: 0.8615
 Site-Painting                  (4) | Val  Loss: 1.2805 | Val  Acc: 0.7857
 Site-Painting                  (4) | Val  Loss: 1.3546 | Val  Acc: 0.7591
 Site-Painting                  (4) | Val  Loss: 1.3633 | Val  Acc: 0.7500
 Site-Sketch                    (3) | Val  Loss: 1.4029 | Val  Acc: 0.7165
 Site-Sketch                    (3) | Val  Loss: 1.5191 | Val  Acc: 0.6180
 Site-QuickDraw                 (1) | Val  Loss: 2.1348 | Val  Acc: 0.2569
 Site-Infograph                 (5) | Val  Loss: 1.9121 | Val  Acc: 0.4423
Average Valid Accuracy: 0.7035
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7237
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7196
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7200
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7286
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6814
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8095
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8220
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8606
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8615
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7857
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7591
 Best site-Painting                 (4)  | Epoch:3 | Val Acc: 0.7500
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.7165
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.6180
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.2569
 Best site-Infograph                (5)  | Epoch:3 | Val Acc: 0.4423
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 4 ============
cnt=[5, 1, 4, 3, 1, 2, ]
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.3106 | Train Acc: 0.7217
 Site-Clipart                   (0) | Train Loss: 1.2293 | Train Acc: 0.7640
 Site-Clipart                   (0) | Train Loss: 1.3567 | Train Acc: 0.7378
 Site-Clipart                   (0) | Train Loss: 1.2548 | Train Acc: 0.7342
 Site-Clipart                   (0) | Train Loss: 1.2940 | Train Acc: 0.7534
 Site-Real                      (2) | Train Loss: 1.0913 | Train Acc: 0.8810
 Site-Real                      (2) | Train Loss: 0.9973 | Train Acc: 0.8757
 Site-Real                      (2) | Train Loss: 0.9628 | Train Acc: 0.8831
 Site-Real                      (2) | Train Loss: 1.0861 | Train Acc: 0.8621
 Site-Painting                  (3) | Train Loss: 1.1541 | Train Acc: 0.7891
 Site-Painting                  (3) | Train Loss: 1.1106 | Train Acc: 0.7864
 Site-Painting                  (3) | Train Loss: 1.1175 | Train Acc: 0.8028
 Site-Sketch                    (5) | Train Loss: 1.2278 | Train Acc: 0.7382
 Site-Sketch                    (5) | Train Loss: 1.2797 | Train Acc: 0.7041
 Site-QuickDraw                 (1) | Train Loss: 2.1121 | Train Acc: 0.2324
 Site-Infograph                 (4) | Train Loss: 1.8382 | Train Acc: 0.4274
Average Train Accuracy: 0.7308
 Site-Clipart                   (0) | Val  Loss: 1.1604 | Val  Acc: 0.7632
 Site-Clipart                   (0) | Val  Loss: 1.2435 | Val  Acc: 0.8037
 Site-Clipart                   (0) | Val  Loss: 1.2504 | Val  Acc: 0.7667
 Site-Clipart                   (0) | Val  Loss: 1.2154 | Val  Acc: 0.7619
 Site-Clipart                   (0) | Val  Loss: 1.3405 | Val  Acc: 0.7288
 Site-Real                      (2) | Val  Loss: 0.9811 | Val  Acc: 0.8929
 Site-Real                      (2) | Val  Loss: 0.9835 | Val  Acc: 0.8898
 Site-Real                      (2) | Val  Loss: 0.9329 | Val  Acc: 0.8970
 Site-Real                      (2) | Val  Loss: 0.9976 | Val  Acc: 0.8831
 Site-Painting                  (3) | Val  Loss: 1.0527 | Val  Acc: 0.8469
 Site-Painting                  (3) | Val  Loss: 1.1477 | Val  Acc: 0.7737
 Site-Painting                  (3) | Val  Loss: 1.1696 | Val  Acc: 0.7760
 Site-Sketch                    (5) | Val  Loss: 1.2957 | Val  Acc: 0.6693
 Site-Sketch                    (5) | Val  Loss: 1.3083 | Val  Acc: 0.6517
 Site-QuickDraw                 (1) | Val  Loss: 2.0921 | Val  Acc: 0.2706
 Site-Infograph                 (4) | Val  Loss: 1.7716 | Val  Acc: 0.4936
Average Valid Accuracy: 0.7418
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7632
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.8037
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7667
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7288
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8929
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8898
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8970
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8831
 Best site-Painting                 (3)  | Epoch:4 | Val Acc: 0.8469
 Best site-Painting                 (3)  | Epoch:4 | Val Acc: 0.7737
 Best site-Painting                 (3)  | Epoch:4 | Val Acc: 0.7760
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6693
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6517
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.2706
 Best site-Infograph                (4)  | Epoch:4 | Val Acc: 0.4936
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 5 ============
cnt=[2, 1, 3, 4, 5, 1, ]
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (0) | Train Loss: 1.1732 | Train Acc: 0.7652
 Site-Clipart                   (4) | Train Loss: 1.0292 | Train Acc: 0.8075
 Site-Clipart                   (4) | Train Loss: 1.1771 | Train Acc: 0.7511
 Site-Clipart                   (0) | Train Loss: 1.0847 | Train Acc: 0.7943
 Site-Clipart                   (4) | Train Loss: 1.1435 | Train Acc: 0.7670
 Site-Real                      (3) | Train Loss: 0.8994 | Train Acc: 0.8730
 Site-Real                      (3) | Train Loss: 0.8466 | Train Acc: 0.8870
 Site-Real                      (3) | Train Loss: 0.8213 | Train Acc: 0.8871
 Site-Real                      (3) | Train Loss: 0.9367 | Train Acc: 0.8966
 Site-Painting                  (2) | Train Loss: 0.9807 | Train Acc: 0.8163
 Site-Painting                  (2) | Train Loss: 1.0398 | Train Acc: 0.7961
 Site-Painting                  (2) | Train Loss: 0.9853 | Train Acc: 0.8097
 Site-Sketch                    (4) | Train Loss: 1.0744 | Train Acc: 0.7435
 Site-Sketch                    (4) | Train Loss: 1.0577 | Train Acc: 0.7228
 Site-QuickDraw                 (1) | Train Loss: 1.9954 | Train Acc: 0.3211
 Site-Infograph                 (5) | Train Loss: 1.7869 | Train Acc: 0.4017
Average Train Accuracy: 0.7525
 Site-Clipart                   (0) | Val  Loss: 0.9603 | Val  Acc: 0.8158
 Site-Clipart                   (4) | Val  Loss: 1.0676 | Val  Acc: 0.7944
 Site-Clipart                   (4) | Val  Loss: 1.0761 | Val  Acc: 0.7867
 Site-Clipart                   (0) | Val  Loss: 1.0610 | Val  Acc: 0.7905
 Site-Clipart                   (4) | Val  Loss: 1.1646 | Val  Acc: 0.7525
 Site-Real                      (3) | Val  Loss: 0.8444 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.8565 | Val  Acc: 0.8559
 Site-Real                      (3) | Val  Loss: 0.8031 | Val  Acc: 0.9030
 Site-Real                      (3) | Val  Loss: 0.8410 | Val  Acc: 0.9091
 Site-Painting                  (2) | Val  Loss: 0.9467 | Val  Acc: 0.8367
 Site-Painting                  (2) | Val  Loss: 0.9623 | Val  Acc: 0.8102
 Site-Painting                  (2) | Val  Loss: 1.0216 | Val  Acc: 0.7917
 Site-Sketch                    (4) | Val  Loss: 1.0959 | Val  Acc: 0.7638
 Site-Sketch                    (4) | Val  Loss: 1.1481 | Val  Acc: 0.7135
 Site-QuickDraw                 (1) | Val  Loss: 2.0137 | Val  Acc: 0.3165
 Site-Infograph                 (5) | Val  Loss: 1.7047 | Val  Acc: 0.5064
Average Valid Accuracy: 0.7665
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.8158
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.7944
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.7867
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7905
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.7525
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9167
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.8559
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9030
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9091
 Best site-Painting                 (2)  | Epoch:5 | Val Acc: 0.8367
 Best site-Painting                 (2)  | Epoch:5 | Val Acc: 0.8102
 Best site-Painting                 (2)  | Epoch:5 | Val Acc: 0.7917
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7638
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7135
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.3165
 Best site-Infograph                (5)  | Epoch:5 | Val Acc: 0.5064
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 6 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[1, 3, 1, 5, 4, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (4) | Train Loss: 1.0349 | Train Acc: 0.7826
 Site-Clipart                   (2) | Train Loss: 0.8628 | Train Acc: 0.8323
 Site-Clipart                   (2) | Train Loss: 1.0441 | Train Acc: 0.7600
 Site-Clipart                   (4) | Train Loss: 0.9385 | Train Acc: 0.8196
 Site-Clipart                   (4) | Train Loss: 0.9953 | Train Acc: 0.7919
 Site-Real                      (0) | Train Loss: 0.7942 | Train Acc: 0.8889
 Site-Real                      (0) | Train Loss: 0.7378 | Train Acc: 0.9096
 Site-Real                      (0) | Train Loss: 0.7132 | Train Acc: 0.9113
 Site-Real                      (0) | Train Loss: 0.7942 | Train Acc: 0.9138
 Site-Painting                  (3) | Train Loss: 0.9403 | Train Acc: 0.8163
 Site-Painting                  (3) | Train Loss: 0.9484 | Train Acc: 0.8252
 Site-Painting                  (3) | Train Loss: 0.9115 | Train Acc: 0.8097
 Site-Sketch                    (2) | Train Loss: 0.9442 | Train Acc: 0.7801
 Site-Sketch                    (2) | Train Loss: 0.9793 | Train Acc: 0.7753
 Site-QuickDraw                 (1) | Train Loss: 1.8793 | Train Acc: 0.3211
 Site-Infograph                 (5) | Train Loss: 1.6813 | Train Acc: 0.4701
Average Train Accuracy: 0.7755
 Site-Clipart                   (4) | Val  Loss: 0.8670 | Val  Acc: 0.7500
 Site-Clipart                   (2) | Val  Loss: 0.9240 | Val  Acc: 0.8037
 Site-Clipart                   (2) | Val  Loss: 0.9874 | Val  Acc: 0.7933
 Site-Clipart                   (4) | Val  Loss: 0.9093 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 1.0256 | Val  Acc: 0.7593
 Site-Real                      (0) | Val  Loss: 0.7330 | Val  Acc: 0.8810
 Site-Real                      (0) | Val  Loss: 0.7448 | Val  Acc: 0.8814
 Site-Real                      (0) | Val  Loss: 0.7174 | Val  Acc: 0.8788
 Site-Real                      (0) | Val  Loss: 0.7484 | Val  Acc: 0.9221
 Site-Painting                  (3) | Val  Loss: 0.8097 | Val  Acc: 0.8367
 Site-Painting                  (3) | Val  Loss: 0.8666 | Val  Acc: 0.8248
 Site-Painting                  (3) | Val  Loss: 0.8956 | Val  Acc: 0.8125
 Site-Sketch                    (2) | Val  Loss: 0.9975 | Val  Acc: 0.7559
 Site-Sketch                    (2) | Val  Loss: 1.0066 | Val  Acc: 0.7584
 Site-QuickDraw                 (1) | Val  Loss: 1.9334 | Val  Acc: 0.3257
 Site-Infograph                 (5) | Val  Loss: 1.6191 | Val  Acc: 0.4936
Average Valid Accuracy: 0.7694
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7500
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.8037
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7933
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7593
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8810
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8814
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8788
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.9221
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8367
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8248
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8125
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.7559
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.7584
 Best site-QuickDraw                (1)  | Epoch:6 | Val Acc: 0.3257
 Best site-Infograph                (5)  | Epoch:6 | Val Acc: 0.4936
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 7 ============
cnt=[3, 1, 4, 4, 3, 1, ]
cnt=[5, 1, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (3) | Train Loss: 0.8516 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.8219 | Train Acc: 0.8199
 Site-Clipart                   (3) | Train Loss: 0.9302 | Train Acc: 0.8044
 Site-Clipart                   (3) | Train Loss: 0.8932 | Train Acc: 0.8006
 Site-Clipart                   (3) | Train Loss: 0.9400 | Train Acc: 0.7805
 Site-Real                      (2) | Train Loss: 0.7328 | Train Acc: 0.8889
 Site-Real                      (2) | Train Loss: 0.6537 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.6201 | Train Acc: 0.8992
 Site-Real                      (2) | Train Loss: 0.7251 | Train Acc: 0.9167
 Site-Painting                  (4) | Train Loss: 0.8561 | Train Acc: 0.7891
 Site-Painting                  (4) | Train Loss: 0.7936 | Train Acc: 0.8544
 Site-Painting                  (4) | Train Loss: 0.7814 | Train Acc: 0.8443
 Site-Sketch                    (0) | Train Loss: 0.8358 | Train Acc: 0.8010
 Site-Sketch                    (0) | Train Loss: 0.8627 | Train Acc: 0.7640
 Site-QuickDraw                 (1) | Train Loss: 1.7922 | Train Acc: 0.4434
 Site-Infograph                 (5) | Train Loss: 1.5932 | Train Acc: 0.4915
Average Train Accuracy: 0.7928
 Site-Clipart                   (3) | Val  Loss: 0.8031 | Val  Acc: 0.8026
 Site-Clipart                   (0) | Val  Loss: 0.8715 | Val  Acc: 0.8037
 Site-Clipart                   (3) | Val  Loss: 0.9214 | Val  Acc: 0.8200
 Site-Clipart                   (3) | Val  Loss: 0.8630 | Val  Acc: 0.7952
 Site-Clipart                   (3) | Val  Loss: 0.9615 | Val  Acc: 0.7661
 Site-Real                      (2) | Val  Loss: 0.6496 | Val  Acc: 0.9167
 Site-Real                      (2) | Val  Loss: 0.6434 | Val  Acc: 0.9068
 Site-Real                      (2) | Val  Loss: 0.6185 | Val  Acc: 0.8970
 Site-Real                      (2) | Val  Loss: 0.6636 | Val  Acc: 0.9091
 Site-Painting                  (4) | Val  Loss: 0.7162 | Val  Acc: 0.8571
 Site-Painting                  (4) | Val  Loss: 0.8010 | Val  Acc: 0.8248
 Site-Painting                  (4) | Val  Loss: 0.7997 | Val  Acc: 0.8438
 Site-Sketch                    (0) | Val  Loss: 0.8778 | Val  Acc: 0.7953
 Site-Sketch                    (0) | Val  Loss: 0.9361 | Val  Acc: 0.7191
 Site-QuickDraw                 (1) | Val  Loss: 1.8105 | Val  Acc: 0.4128
 Site-Infograph                 (5) | Val  Loss: 1.5071 | Val  Acc: 0.5449
Average Valid Accuracy: 0.7884
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8026
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8037
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8200
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7952
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7661
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9167
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9068
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.8970
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9091
 Best site-Painting                 (4)  | Epoch:7 | Val Acc: 0.8571
 Best site-Painting                 (4)  | Epoch:7 | Val Acc: 0.8248
 Best site-Painting                 (4)  | Epoch:7 | Val Acc: 0.8438
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7953
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7191
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.4128
 Best site-Infograph                (5)  | Epoch:7 | Val Acc: 0.5449
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 8 ============
cnt=[5, 1, 4, 3, 1, 2, ]
cnt=[5, 1, 4, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 0.8309 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.7168 | Train Acc: 0.8820
 Site-Clipart                   (0) | Train Loss: 0.8637 | Train Acc: 0.8311
 Site-Clipart                   (0) | Train Loss: 0.7871 | Train Acc: 0.8196
 Site-Clipart                   (0) | Train Loss: 0.8158 | Train Acc: 0.8032
 Site-Real                      (2) | Train Loss: 0.6433 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.5680 | Train Acc: 0.9322
 Site-Real                      (2) | Train Loss: 0.5635 | Train Acc: 0.9113
 Site-Real                      (2) | Train Loss: 0.6346 | Train Acc: 0.9282
 Site-Painting                  (3) | Train Loss: 0.7953 | Train Acc: 0.8231
 Site-Painting                  (3) | Train Loss: 0.7886 | Train Acc: 0.8301
 Site-Painting                  (3) | Train Loss: 0.7314 | Train Acc: 0.8131
 Site-Sketch                    (5) | Train Loss: 0.7754 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.9056 | Train Acc: 0.7753
 Site-QuickDraw                 (1) | Train Loss: 1.6517 | Train Acc: 0.4587
 Site-Infograph                 (4) | Train Loss: 1.5526 | Train Acc: 0.4957
Average Train Accuracy: 0.8037
 Site-Clipart                   (0) | Val  Loss: 0.6731 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.7418 | Val  Acc: 0.8505
 Site-Clipart                   (0) | Val  Loss: 0.7769 | Val  Acc: 0.8400
 Site-Clipart                   (0) | Val  Loss: 0.7544 | Val  Acc: 0.8048
 Site-Clipart                   (0) | Val  Loss: 0.8595 | Val  Acc: 0.8169
 Site-Real                      (2) | Val  Loss: 0.5385 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.5804 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.5691 | Val  Acc: 0.8848
 Site-Real                      (2) | Val  Loss: 0.5804 | Val  Acc: 0.9264
 Site-Painting                  (3) | Val  Loss: 0.6283 | Val  Acc: 0.8571
 Site-Painting                  (3) | Val  Loss: 0.6909 | Val  Acc: 0.8175
 Site-Painting                  (3) | Val  Loss: 0.7668 | Val  Acc: 0.8385
 Site-Sketch                    (5) | Val  Loss: 0.8433 | Val  Acc: 0.8031
 Site-Sketch                    (5) | Val  Loss: 0.8730 | Val  Acc: 0.7753
 Site-QuickDraw                 (1) | Val  Loss: 1.7048 | Val  Acc: 0.5092
 Site-Infograph                 (4) | Val  Loss: 1.4557 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8139
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8553
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8505
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8400
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8048
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8169
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.8848
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9264
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8571
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8175
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8385
 Best site-Sketch                   (5)  | Epoch:8 | Val Acc: 0.8031
 Best site-Sketch                   (5)  | Epoch:8 | Val Acc: 0.7753
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.5092
 Best site-Infograph                (4)  | Epoch:8 | Val Acc: 0.5577
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 9 ============
cnt=[1, 5, 4, 3, 2, 1, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (1) | Train Loss: 0.7233 | Train Acc: 0.8435
 Site-Clipart                   (4) | Train Loss: 0.6851 | Train Acc: 0.8323
 Site-Clipart                   (1) | Train Loss: 0.8138 | Train Acc: 0.8400
 Site-Clipart                   (1) | Train Loss: 0.7302 | Train Acc: 0.8070
 Site-Clipart                   (1) | Train Loss: 0.7594 | Train Acc: 0.8439
 Site-Real                      (2) | Train Loss: 0.5617 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.4629 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.4650 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.5432 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.6876 | Train Acc: 0.8367
 Site-Painting                  (3) | Train Loss: 0.7099 | Train Acc: 0.8689
 Site-Painting                  (3) | Train Loss: 0.6515 | Train Acc: 0.8408
 Site-Sketch                    (1) | Train Loss: 0.7188 | Train Acc: 0.8325
 Site-Sketch                    (4) | Train Loss: 0.7289 | Train Acc: 0.7865
 Site-QuickDraw                 (0) | Train Loss: 1.5395 | Train Acc: 0.5229
 Site-Infograph                 (5) | Train Loss: 1.5258 | Train Acc: 0.5342
Average Train Accuracy: 0.8210
 Site-Clipart                   (1) | Val  Loss: 0.5827 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.6891 | Val  Acc: 0.8598
 Site-Clipart                   (1) | Val  Loss: 0.7327 | Val  Acc: 0.8133
 Site-Clipart                   (1) | Val  Loss: 0.6632 | Val  Acc: 0.8571
 Site-Clipart                   (1) | Val  Loss: 0.8109 | Val  Acc: 0.8102
 Site-Real                      (2) | Val  Loss: 0.4921 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.4724 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.4812 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.5115 | Val  Acc: 0.9264
 Site-Painting                  (3) | Val  Loss: 0.5953 | Val  Acc: 0.8673
 Site-Painting                  (3) | Val  Loss: 0.6654 | Val  Acc: 0.8102
 Site-Painting                  (3) | Val  Loss: 0.6762 | Val  Acc: 0.8594
 Site-Sketch                    (1) | Val  Loss: 0.7600 | Val  Acc: 0.7874
 Site-Sketch                    (4) | Val  Loss: 0.8369 | Val  Acc: 0.7640
 Site-QuickDraw                 (0) | Val  Loss: 1.5939 | Val  Acc: 0.5688
 Site-Infograph                 (5) | Val  Loss: 1.4143 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8258
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8816
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8598
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8133
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8571
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8102
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9576
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9273
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9264
 Best site-Painting                 (3)  | Epoch:9 | Val Acc: 0.8673
 Best site-Painting                 (3)  | Epoch:9 | Val Acc: 0.8102
 Best site-Painting                 (3)  | Epoch:9 | Val Acc: 0.8594
 Best site-Sketch                   (1)  | Epoch:9 | Val Acc: 0.7874
 Best site-Sketch                   (4)  | Epoch:9 | Val Acc: 0.7640
 Best site-QuickDraw                (0)  | Epoch:9 | Val Acc: 0.5688
 Best site-Infograph                (5)  | Epoch:9 | Val Acc: 0.5705
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Test site-Clipart                   (1)| Epoch:9 | Test Acc: 0.8574
 Test site-Real                      (2)| Epoch:9 | Test Acc: 0.9408
 Test site-Painting                  (3)| Epoch:9 | Test Acc: 0.8853
 Test site-Sketch                    (1)| Epoch:9 | Test Acc: 0.8502
 Test site-QuickDraw                 (0)| Epoch:9 | Test Acc: 0.5610
 Test site-Infograph                 (5)| Epoch:9 | Test Acc: 0.5068
Clipart: 0.8574, Real: 0.9408, Painting: 0.8853, Sketch: 0.8502, QuickDraw: 0.5610, Infograph: 0.5068, 
Average Test Accuracy(group): 0.7669, Average Test Accuracy(individual): 0.8422,
domain std=0.1680, cluster std=0.1682, individual std=0.1218, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 10 ============
cnt=[4, 1, 2, 3, 5, 1, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (4) | Train Loss: 0.6859 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.6248 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.7596 | Train Acc: 0.8311
 Site-Clipart                   (4) | Train Loss: 0.6920 | Train Acc: 0.8259
 Site-Clipart                   (2) | Train Loss: 0.7408 | Train Acc: 0.8213
 Site-Real                      (3) | Train Loss: 0.5451 | Train Acc: 0.8810
 Site-Real                      (3) | Train Loss: 0.4558 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.4619 | Train Acc: 0.9274
 Site-Real                      (3) | Train Loss: 0.5038 | Train Acc: 0.9368
 Site-Painting                  (0) | Train Loss: 0.6156 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.6683 | Train Acc: 0.8544
 Site-Painting                  (0) | Train Loss: 0.6440 | Train Acc: 0.8651
 Site-Sketch                    (4) | Train Loss: 0.7091 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.7396 | Train Acc: 0.7940
 Site-QuickDraw                 (1) | Train Loss: 1.4270 | Train Acc: 0.5719
 Site-Infograph                 (5) | Train Loss: 1.4615 | Train Acc: 0.5342
Average Train Accuracy: 0.8274
 Site-Clipart                   (4) | Val  Loss: 0.5582 | Val  Acc: 0.8421
 Site-Clipart                   (4) | Val  Loss: 0.6889 | Val  Acc: 0.8318
 Site-Clipart                   (4) | Val  Loss: 0.6696 | Val  Acc: 0.8600
 Site-Clipart                   (4) | Val  Loss: 0.6890 | Val  Acc: 0.7952
 Site-Clipart                   (2) | Val  Loss: 0.7497 | Val  Acc: 0.8271
 Site-Real                      (3) | Val  Loss: 0.4478 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.4624 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.4172 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.4782 | Val  Acc: 0.9264
 Site-Painting                  (0) | Val  Loss: 0.5079 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.6449 | Val  Acc: 0.8394
 Site-Painting                  (0) | Val  Loss: 0.6175 | Val  Acc: 0.8646
 Site-Sketch                    (4) | Val  Loss: 0.6908 | Val  Acc: 0.8346
 Site-Sketch                    (2) | Val  Loss: 0.7456 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.5240 | Val  Acc: 0.5826
 Site-Infograph                 (5) | Val  Loss: 1.3472 | Val  Acc: 0.5769
Average Valid Accuracy: 0.8339
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8421
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8318
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8600
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.7952
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8271
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9322
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9455
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9264
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.9286
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8394
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8646
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.8346
 Best site-Sketch                   (2)  | Epoch:10 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.5826
 Best site-Infograph                (5)  | Epoch:10 | Val Acc: 0.5769
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 11 ============
cnt=[5, 1, 3, 4, 1, 2, ]
cnt=[1, 4, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.6782 | Train Acc: 0.8174
 Site-Clipart                   (0) | Train Loss: 0.5532 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.6951 | Train Acc: 0.8400
 Site-Clipart                   (0) | Train Loss: 0.6241 | Train Acc: 0.8544
 Site-Clipart                   (0) | Train Loss: 0.6909 | Train Acc: 0.8213
 Site-Real                      (3) | Train Loss: 0.5073 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.4283 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.4181 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.4604 | Train Acc: 0.9339
 Site-Painting                  (2) | Train Loss: 0.6018 | Train Acc: 0.8503
 Site-Painting                  (2) | Train Loss: 0.6055 | Train Acc: 0.8592
 Site-Painting                  (2) | Train Loss: 0.6210 | Train Acc: 0.8478
 Site-Sketch                    (5) | Train Loss: 0.6561 | Train Acc: 0.8010
 Site-Sketch                    (5) | Train Loss: 0.6974 | Train Acc: 0.8165
 Site-QuickDraw                 (1) | Train Loss: 1.5192 | Train Acc: 0.5657
 Site-Infograph                 (4) | Train Loss: 1.3921 | Train Acc: 0.5427
Average Train Accuracy: 0.8251
 Site-Clipart                   (0) | Val  Loss: 0.5823 | Val  Acc: 0.8421
 Site-Clipart                   (0) | Val  Loss: 0.6087 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.6307 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.6343 | Val  Acc: 0.8381
 Site-Clipart                   (0) | Val  Loss: 0.7002 | Val  Acc: 0.8373
 Site-Real                      (3) | Val  Loss: 0.4323 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.4276 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.4402 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.4582 | Val  Acc: 0.9134
 Site-Painting                  (2) | Val  Loss: 0.5555 | Val  Acc: 0.8571
 Site-Painting                  (2) | Val  Loss: 0.5897 | Val  Acc: 0.8394
 Site-Painting                  (2) | Val  Loss: 0.6427 | Val  Acc: 0.8490
 Site-Sketch                    (5) | Val  Loss: 0.6444 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.7730 | Val  Acc: 0.7697
 Site-QuickDraw                 (1) | Val  Loss: 1.4156 | Val  Acc: 0.6101
 Site-Infograph                 (4) | Val  Loss: 1.3258 | Val  Acc: 0.5705
Average Valid Accuracy: 0.8317
============ Train epoch 12 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[1, 5, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (3) | Train Loss: 0.6363 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.5152 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.6601 | Train Acc: 0.8489
 Site-Clipart                   (3) | Train Loss: 0.6074 | Train Acc: 0.8323
 Site-Clipart                   (3) | Train Loss: 0.6336 | Train Acc: 0.8507
 Site-Real                      (2) | Train Loss: 0.4955 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.3967 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.4126 | Train Acc: 0.9315
 Site-Real                      (2) | Train Loss: 0.4659 | Train Acc: 0.9397
 Site-Painting                  (4) | Train Loss: 0.7373 | Train Acc: 0.8707
 Site-Painting                  (4) | Train Loss: 0.6504 | Train Acc: 0.8495
 Site-Painting                  (4) | Train Loss: 0.5811 | Train Acc: 0.8581
 Site-Sketch                    (0) | Train Loss: 0.6308 | Train Acc: 0.8220
 Site-Sketch                    (0) | Train Loss: 0.6907 | Train Acc: 0.7903
 Site-QuickDraw                 (1) | Train Loss: 1.2442 | Train Acc: 0.6269
 Site-Infograph                 (5) | Train Loss: 1.4070 | Train Acc: 0.5556
Average Train Accuracy: 0.8368
 Site-Clipart                   (3) | Val  Loss: 0.5115 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.5805 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.6068 | Val  Acc: 0.8400
 Site-Clipart                   (3) | Val  Loss: 0.5899 | Val  Acc: 0.8286
 Site-Clipart                   (3) | Val  Loss: 0.6892 | Val  Acc: 0.8203
 Site-Real                      (2) | Val  Loss: 0.3811 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.3902 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.3858 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.4258 | Val  Acc: 0.9264
 Site-Painting                  (4) | Val  Loss: 0.5150 | Val  Acc: 0.8980
 Site-Painting                  (4) | Val  Loss: 0.5611 | Val  Acc: 0.8467
 Site-Painting                  (4) | Val  Loss: 0.5943 | Val  Acc: 0.8542
 Site-Sketch                    (0) | Val  Loss: 0.6642 | Val  Acc: 0.8504
 Site-Sketch                    (0) | Val  Loss: 0.7387 | Val  Acc: 0.7809
 Site-QuickDraw                 (1) | Val  Loss: 1.3685 | Val  Acc: 0.6009
 Site-Infograph                 (5) | Val  Loss: 1.3394 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8390
 Best site-Clipart                  (3)  | Epoch:12 | Val Acc: 0.8816
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8692
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8400
 Best site-Clipart                  (3)  | Epoch:12 | Val Acc: 0.8286
 Best site-Clipart                  (3)  | Epoch:12 | Val Acc: 0.8203
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9576
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9333
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9264
 Best site-Painting                 (4)  | Epoch:12 | Val Acc: 0.8980
 Best site-Painting                 (4)  | Epoch:12 | Val Acc: 0.8467
 Best site-Painting                 (4)  | Epoch:12 | Val Acc: 0.8542
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8504
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.7809
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.6009
 Best site-Infograph                (5)  | Epoch:12 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 13 ============
cnt=[3, 1, 3, 4, 4, 1, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (2) | Train Loss: 0.6221 | Train Acc: 0.8348
 Site-Clipart                   (4) | Train Loss: 0.5631 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.6555 | Train Acc: 0.8356
 Site-Clipart                   (2) | Train Loss: 0.6092 | Train Acc: 0.8354
 Site-Clipart                   (2) | Train Loss: 0.6548 | Train Acc: 0.8394
 Site-Real                      (3) | Train Loss: 0.4775 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.3551 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3601 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.4195 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.5498 | Train Acc: 0.8776
 Site-Painting                  (0) | Train Loss: 0.5420 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.5360 | Train Acc: 0.8581
 Site-Sketch                    (4) | Train Loss: 0.6209 | Train Acc: 0.8377
 Site-Sketch                    (4) | Train Loss: 0.6457 | Train Acc: 0.8052
 Site-QuickDraw                 (1) | Train Loss: 1.3178 | Train Acc: 0.6086
 Site-Infograph                 (5) | Train Loss: 1.3338 | Train Acc: 0.5726
Average Train Accuracy: 0.8380
 Site-Clipart                   (2) | Val  Loss: 0.4376 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.5774 | Val  Acc: 0.8692
 Site-Clipart                   (4) | Val  Loss: 0.6243 | Val  Acc: 0.8533
 Site-Clipart                   (2) | Val  Loss: 0.5925 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.6637 | Val  Acc: 0.8203
 Site-Real                      (3) | Val  Loss: 0.3618 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.3607 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.3858 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.4098 | Val  Acc: 0.9307
 Site-Painting                  (0) | Val  Loss: 0.4156 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.4815 | Val  Acc: 0.8540
 Site-Painting                  (0) | Val  Loss: 0.4976 | Val  Acc: 0.8906
 Site-Sketch                    (4) | Val  Loss: 0.6104 | Val  Acc: 0.8268
 Site-Sketch                    (4) | Val  Loss: 0.6953 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.3027 | Val  Acc: 0.6193
 Site-Infograph                 (5) | Val  Loss: 1.2532 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8446
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8816
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8692
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8533
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8203
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9237
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9273
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9307
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.9388
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8540
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8906
 Best site-Sketch                   (4)  | Epoch:13 | Val Acc: 0.8268
 Best site-Sketch                   (4)  | Epoch:13 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.6193
 Best site-Infograph                (5)  | Epoch:13 | Val Acc: 0.6218
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 14 ============
cnt=[4, 1, 3, 4, 1, 3, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (0) | Train Loss: 0.5636 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.4925 | Train Acc: 0.9006
 Site-Clipart                   (5) | Train Loss: 0.5896 | Train Acc: 0.8578
 Site-Clipart                   (5) | Train Loss: 0.5710 | Train Acc: 0.8544
 Site-Clipart                   (5) | Train Loss: 0.5776 | Train Acc: 0.8643
 Site-Real                      (3) | Train Loss: 0.4221 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.3348 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3400 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3964 | Train Acc: 0.9310
 Site-Painting                  (2) | Train Loss: 0.5201 | Train Acc: 0.8503
 Site-Painting                  (2) | Train Loss: 0.5906 | Train Acc: 0.8689
 Site-Painting                  (2) | Train Loss: 0.5182 | Train Acc: 0.8754
 Site-Sketch                    (0) | Train Loss: 0.5734 | Train Acc: 0.8325
 Site-Sketch                    (0) | Train Loss: 0.7223 | Train Acc: 0.8090
 Site-QuickDraw                 (1) | Train Loss: 1.2033 | Train Acc: 0.6361
 Site-Infograph                 (4) | Train Loss: 1.3328 | Train Acc: 0.5513
Average Train Accuracy: 0.8442
 Site-Clipart                   (0) | Val  Loss: 0.4305 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.5378 | Val  Acc: 0.8692
 Site-Clipart                   (5) | Val  Loss: 0.5320 | Val  Acc: 0.8800
 Site-Clipart                   (5) | Val  Loss: 0.5612 | Val  Acc: 0.8381
 Site-Clipart                   (5) | Val  Loss: 0.6332 | Val  Acc: 0.8305
 Site-Real                      (3) | Val  Loss: 0.3517 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3548 | Val  Acc: 0.9068
 Site-Real                      (3) | Val  Loss: 0.3847 | Val  Acc: 0.9030
 Site-Real                      (3) | Val  Loss: 0.3624 | Val  Acc: 0.9394
 Site-Painting                  (2) | Val  Loss: 0.4208 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.5014 | Val  Acc: 0.8686
 Site-Painting                  (2) | Val  Loss: 0.5235 | Val  Acc: 0.8750
 Site-Sketch                    (0) | Val  Loss: 0.6099 | Val  Acc: 0.8268
 Site-Sketch                    (0) | Val  Loss: 0.7367 | Val  Acc: 0.7416
 Site-QuickDraw                 (1) | Val  Loss: 1.2130 | Val  Acc: 0.6835
 Site-Infograph                 (4) | Val  Loss: 1.1990 | Val  Acc: 0.6026
Average Valid Accuracy: 0.8465
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.9079
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8692
 Best site-Clipart                  (5)  | Epoch:14 | Val Acc: 0.8800
 Best site-Clipart                  (5)  | Epoch:14 | Val Acc: 0.8381
 Best site-Clipart                  (5)  | Epoch:14 | Val Acc: 0.8305
 Best site-Real                     (3)  | Epoch:14 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:14 | Val Acc: 0.9068
 Best site-Real                     (3)  | Epoch:14 | Val Acc: 0.9030
 Best site-Real                     (3)  | Epoch:14 | Val Acc: 0.9394
 Best site-Painting                 (2)  | Epoch:14 | Val Acc: 0.9184
 Best site-Painting                 (2)  | Epoch:14 | Val Acc: 0.8686
 Best site-Painting                 (2)  | Epoch:14 | Val Acc: 0.8750
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.8268
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.7416
 Best site-QuickDraw                (1)  | Epoch:14 | Val Acc: 0.6835
 Best site-Infograph                (4)  | Epoch:14 | Val Acc: 0.6026
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 15 ============
cnt=[1, 1, 4, 4, 3, 3, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (5) | Train Loss: 0.5913 | Train Acc: 0.8348
 Site-Clipart                   (2) | Train Loss: 0.4503 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.5889 | Train Acc: 0.8622
 Site-Clipart                   (5) | Train Loss: 0.5255 | Train Acc: 0.8703
 Site-Clipart                   (5) | Train Loss: 0.5535 | Train Acc: 0.8620
 Site-Real                      (3) | Train Loss: 0.4342 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.3263 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.3345 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3692 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.5192 | Train Acc: 0.8367
 Site-Painting                  (4) | Train Loss: 0.4865 | Train Acc: 0.8495
 Site-Painting                  (4) | Train Loss: 0.5064 | Train Acc: 0.8824
 Site-Sketch                    (2) | Train Loss: 0.6042 | Train Acc: 0.8272
 Site-Sketch                    (2) | Train Loss: 0.6359 | Train Acc: 0.8464
 Site-QuickDraw                 (0) | Train Loss: 1.0589 | Train Acc: 0.6758
 Site-Infograph                 (1) | Train Loss: 1.2744 | Train Acc: 0.5940
Average Train Accuracy: 0.8499
 Site-Clipart                   (5) | Val  Loss: 0.4103 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.4955 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.5175 | Val  Acc: 0.8733
 Site-Clipart                   (5) | Val  Loss: 0.5247 | Val  Acc: 0.8476
 Site-Clipart                   (5) | Val  Loss: 0.6171 | Val  Acc: 0.8136
 Site-Real                      (3) | Val  Loss: 0.3348 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3614 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.3495 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3436 | Val  Acc: 0.9394
 Site-Painting                  (4) | Val  Loss: 0.4078 | Val  Acc: 0.8878
 Site-Painting                  (4) | Val  Loss: 0.4770 | Val  Acc: 0.8759
 Site-Painting                  (4) | Val  Loss: 0.5144 | Val  Acc: 0.8698
 Site-Sketch                    (2) | Val  Loss: 0.6022 | Val  Acc: 0.8189
 Site-Sketch                    (2) | Val  Loss: 0.6367 | Val  Acc: 0.8090
 Site-QuickDraw                 (0) | Val  Loss: 1.2314 | Val  Acc: 0.6835
 Site-Infograph                 (1) | Val  Loss: 1.1517 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8527
 Best site-Clipart                  (5)  | Epoch:15 | Val Acc: 0.9079
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8879
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8733
 Best site-Clipart                  (5)  | Epoch:15 | Val Acc: 0.8476
 Best site-Clipart                  (5)  | Epoch:15 | Val Acc: 0.8136
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9394
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8878
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8759
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8698
 Best site-Sketch                   (2)  | Epoch:15 | Val Acc: 0.8189
 Best site-Sketch                   (2)  | Epoch:15 | Val Acc: 0.8090
 Best site-QuickDraw                (0)  | Epoch:15 | Val Acc: 0.6835
 Best site-Infograph                (1)  | Epoch:15 | Val Acc: 0.6346
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 16 ============
cnt=[3, 1, 4, 4, 3, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (4) | Train Loss: 0.6126 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.4316 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.6003 | Train Acc: 0.8489
 Site-Clipart                   (2) | Train Loss: 0.5289 | Train Acc: 0.8639
 Site-Clipart                   (2) | Train Loss: 0.5271 | Train Acc: 0.8643
 Site-Real                      (3) | Train Loss: 0.4179 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.3239 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3120 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3653 | Train Acc: 0.9339
 Site-Painting                  (0) | Train Loss: 0.5387 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.5540 | Train Acc: 0.8495
 Site-Painting                  (0) | Train Loss: 0.5102 | Train Acc: 0.8754
 Site-Sketch                    (4) | Train Loss: 0.5849 | Train Acc: 0.8220
 Site-Sketch                    (4) | Train Loss: 0.6738 | Train Acc: 0.8240
 Site-QuickDraw                 (1) | Train Loss: 1.1134 | Train Acc: 0.6820
 Site-Infograph                 (5) | Train Loss: 1.3001 | Train Acc: 0.5812
Average Train Accuracy: 0.8464
 Site-Clipart                   (4) | Val  Loss: 0.4211 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.4850 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.5321 | Val  Acc: 0.8467
 Site-Clipart                   (2) | Val  Loss: 0.5260 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.6178 | Val  Acc: 0.8305
 Site-Real                      (3) | Val  Loss: 0.3080 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3048 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.3395 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.3251 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.3694 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.4390 | Val  Acc: 0.8905
 Site-Painting                  (0) | Val  Loss: 0.4959 | Val  Acc: 0.8750
 Site-Sketch                    (4) | Val  Loss: 0.5608 | Val  Acc: 0.8346
 Site-Sketch                    (4) | Val  Loss: 0.6491 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.1431 | Val  Acc: 0.7018
 Site-Infograph                 (5) | Val  Loss: 1.1780 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8579
 Best site-Clipart                  (4)  | Epoch:16 | Val Acc: 0.8947
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8467
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8571
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8305
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9492
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9273
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9481
 Best site-Painting                 (0)  | Epoch:16 | Val Acc: 0.9184
 Best site-Painting                 (0)  | Epoch:16 | Val Acc: 0.8905
 Best site-Painting                 (0)  | Epoch:16 | Val Acc: 0.8750
 Best site-Sketch                   (4)  | Epoch:16 | Val Acc: 0.8346
 Best site-Sketch                   (4)  | Epoch:16 | Val Acc: 0.7865
 Best site-QuickDraw                (1)  | Epoch:16 | Val Acc: 0.7018
 Best site-Infograph                (5)  | Epoch:16 | Val Acc: 0.6282
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 17 ============
cnt=[4, 1, 2, 4, 3, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (2) | Train Loss: 0.5029 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.4228 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.5671 | Train Acc: 0.8267
 Site-Clipart                   (2) | Train Loss: 0.4955 | Train Acc: 0.8703
 Site-Clipart                   (4) | Train Loss: 0.5335 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.4040 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2945 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2952 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.3326 | Train Acc: 0.9368
 Site-Painting                  (0) | Train Loss: 0.4820 | Train Acc: 0.8639
 Site-Painting                  (0) | Train Loss: 0.4483 | Train Acc: 0.8544
 Site-Painting                  (0) | Train Loss: 0.4334 | Train Acc: 0.8962
 Site-Sketch                    (5) | Train Loss: 0.5641 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.5381 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 1.0892 | Train Acc: 0.6728
 Site-Infograph                 (0) | Train Loss: 1.2626 | Train Acc: 0.5855
Average Train Accuracy: 0.8519
 Site-Clipart                   (2) | Val  Loss: 0.3949 | Val  Acc: 0.8421
 Site-Clipart                   (4) | Val  Loss: 0.4572 | Val  Acc: 0.8972
 Site-Clipart                   (4) | Val  Loss: 0.4885 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.5279 | Val  Acc: 0.8381
 Site-Clipart                   (4) | Val  Loss: 0.6266 | Val  Acc: 0.8068
 Site-Real                      (3) | Val  Loss: 0.3006 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3292 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2988 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.3184 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.3548 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.4350 | Val  Acc: 0.8686
 Site-Painting                  (0) | Val  Loss: 0.4489 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.5529 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6362 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 1.1634 | Val  Acc: 0.6606
 Site-Infograph                 (0) | Val  Loss: 1.2071 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8548
============ Train epoch 18 ============
cnt=[4, 1, 1, 4, 5, 1, ]
cnt=[1, 4, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (4) | Train Loss: 0.5215 | Train Acc: 0.8522
 Site-Clipart                   (4) | Train Loss: 0.4072 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.5774 | Train Acc: 0.8267
 Site-Clipart                   (4) | Train Loss: 0.4860 | Train Acc: 0.8734
 Site-Clipart                   (4) | Train Loss: 0.5142 | Train Acc: 0.8688
 Site-Real                      (3) | Train Loss: 0.3982 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2894 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2737 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3216 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4406 | Train Acc: 0.8980
 Site-Painting                  (0) | Train Loss: 0.4454 | Train Acc: 0.8786
 Site-Painting                  (0) | Train Loss: 0.4228 | Train Acc: 0.8824
 Site-Sketch                    (5) | Train Loss: 0.5927 | Train Acc: 0.8482
 Site-Sketch                    (2) | Train Loss: 0.4958 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 1.0278 | Train Acc: 0.6942
 Site-Infograph                 (0) | Train Loss: 1.2470 | Train Acc: 0.6026
Average Train Accuracy: 0.8575
 Site-Clipart                   (4) | Val  Loss: 0.3742 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.4518 | Val  Acc: 0.8972
 Site-Clipart                   (4) | Val  Loss: 0.5370 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 0.5285 | Val  Acc: 0.8238
 Site-Clipart                   (4) | Val  Loss: 0.5551 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.2905 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2943 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.3060 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.3005 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.3564 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.4532 | Val  Acc: 0.8905
 Site-Painting                  (0) | Val  Loss: 0.4445 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4799 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.6269 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.1020 | Val  Acc: 0.7156
 Site-Infograph                 (0) | Val  Loss: 1.1664 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8583
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8816
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8972
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8333
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8238
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8542
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9237
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9273
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9481
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.9184
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8905
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8854
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.8740
 Best site-Sketch                   (2)  | Epoch:18 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:18 | Val Acc: 0.7156
 Best site-Infograph                (0)  | Epoch:18 | Val Acc: 0.6154
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 19 ============
cnt=[1, 1, 5, 3, 4, 2, ]
cnt=[2, 3, 5, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (2) | Train Loss: 0.5376 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.4116 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.5382 | Train Acc: 0.8667
 Site-Clipart                   (2) | Train Loss: 0.4896 | Train Acc: 0.8639
 Site-Clipart                   (2) | Train Loss: 0.4870 | Train Acc: 0.8801
 Site-Real                      (4) | Train Loss: 0.3974 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2659 | Train Acc: 0.9605
 Site-Real                      (4) | Train Loss: 0.2909 | Train Acc: 0.9315
 Site-Real                      (4) | Train Loss: 0.3148 | Train Acc: 0.9282
 Site-Painting                  (3) | Train Loss: 0.5592 | Train Acc: 0.8707
 Site-Painting                  (3) | Train Loss: 0.5051 | Train Acc: 0.8641
 Site-Painting                  (3) | Train Loss: 0.4279 | Train Acc: 0.8962
 Site-Sketch                    (5) | Train Loss: 0.5210 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.5762 | Train Acc: 0.8127
 Site-QuickDraw                 (1) | Train Loss: 1.0411 | Train Acc: 0.7003
 Site-Infograph                 (0) | Train Loss: 1.2210 | Train Acc: 0.6026
Average Train Accuracy: 0.8572
 Site-Clipart                   (2) | Val  Loss: 0.3953 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.4513 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.4793 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.4948 | Val  Acc: 0.8714
 Site-Clipart                   (2) | Val  Loss: 0.5761 | Val  Acc: 0.8441
 Site-Real                      (4) | Val  Loss: 0.2761 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.3464 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.3028 | Val  Acc: 0.9212
 Site-Real                      (4) | Val  Loss: 0.2892 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.3564 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.4274 | Val  Acc: 0.8978
 Site-Painting                  (3) | Val  Loss: 0.4411 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.5733 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.6616 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 1.1001 | Val  Acc: 0.6881
 Site-Infograph                 (0) | Val  Loss: 1.1654 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8651
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8947
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8867
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8714
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8441
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9322
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9212
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9567
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.9286
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.8978
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.9010
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.7921
 Best site-QuickDraw                (1)  | Epoch:19 | Val Acc: 0.6881
 Best site-Infograph                (0)  | Epoch:19 | Val Acc: 0.6538
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Test site-Clipart                   (2)| Epoch:19 | Test Acc: 0.8669
 Test site-Real                      (4)| Epoch:19 | Test Acc: 0.9441
 Test site-Painting                  (3)| Epoch:19 | Test Acc: 0.9225
 Test site-Sketch                    (5)| Epoch:19 | Test Acc: 0.8556
 Test site-QuickDraw                 (1)| Epoch:19 | Test Acc: 0.6900
 Test site-Infograph                 (0)| Epoch:19 | Test Acc: 0.5449
Clipart: 0.8669, Real: 0.9441, Painting: 0.9225, Sketch: 0.8556, QuickDraw: 0.6900, Infograph: 0.5449, 
Average Test Accuracy(group): 0.8040, Average Test Accuracy(individual): 0.8640,
domain std=0.1417, cluster std=0.1417, individual std=0.1025, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 20 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[4, 5, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (2) | Train Loss: 0.5095 | Train Acc: 0.8870
 Site-Clipart                   (4) | Train Loss: 0.4501 | Train Acc: 0.8882
 Site-Clipart                   (4) | Train Loss: 0.5309 | Train Acc: 0.8311
 Site-Clipart                   (2) | Train Loss: 0.5034 | Train Acc: 0.8576
 Site-Clipart                   (4) | Train Loss: 0.5145 | Train Acc: 0.8778
 Site-Real                      (0) | Train Loss: 0.3826 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2624 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2875 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.3354 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.5073 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.4534 | Train Acc: 0.8738
 Site-Painting                  (3) | Train Loss: 0.4361 | Train Acc: 0.8824
 Site-Sketch                    (2) | Train Loss: 0.5400 | Train Acc: 0.8168
 Site-Sketch                    (2) | Train Loss: 0.6584 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 1.0827 | Train Acc: 0.7187
 Site-Infograph                 (5) | Train Loss: 1.1828 | Train Acc: 0.6197
Average Train Accuracy: 0.8575
 Site-Clipart                   (2) | Val  Loss: 0.3639 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.4831 | Val  Acc: 0.8505
 Site-Clipart                   (4) | Val  Loss: 0.5113 | Val  Acc: 0.8733
 Site-Clipart                   (2) | Val  Loss: 0.4638 | Val  Acc: 0.8476
 Site-Clipart                   (4) | Val  Loss: 0.5647 | Val  Acc: 0.8475
 Site-Real                      (0) | Val  Loss: 0.2781 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.3019 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2948 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.3112 | Val  Acc: 0.9351
 Site-Painting                  (3) | Val  Loss: 0.3469 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.4276 | Val  Acc: 0.8978
 Site-Painting                  (3) | Val  Loss: 0.4537 | Val  Acc: 0.8698
 Site-Sketch                    (2) | Val  Loss: 0.5192 | Val  Acc: 0.8504
 Site-Sketch                    (2) | Val  Loss: 0.5914 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.0560 | Val  Acc: 0.7523
 Site-Infograph                 (5) | Val  Loss: 1.1101 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8650
============ Train epoch 21 ============
cnt=[6, 1, 3, 4, 1, 1, ]
cnt=[2, 5, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.5078 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.4460 | Train Acc: 0.8820
 Site-Clipart                   (0) | Train Loss: 0.5852 | Train Acc: 0.8489
 Site-Clipart                   (0) | Train Loss: 0.4466 | Train Acc: 0.8797
 Site-Clipart                   (0) | Train Loss: 0.4817 | Train Acc: 0.8801
 Site-Real                      (3) | Train Loss: 0.3772 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.2646 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2952 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.3360 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.5367 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.5022 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.4281 | Train Acc: 0.8858
 Site-Sketch                    (4) | Train Loss: 0.5394 | Train Acc: 0.8272
 Site-Sketch                    (0) | Train Loss: 0.5977 | Train Acc: 0.8240
 Site-QuickDraw                 (1) | Train Loss: 1.0252 | Train Acc: 0.6820
 Site-Infograph                 (5) | Train Loss: 1.2346 | Train Acc: 0.6026
Average Train Accuracy: 0.8533
 Site-Clipart                   (0) | Val  Loss: 0.3851 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.4164 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.4527 | Val  Acc: 0.8600
 Site-Clipart                   (0) | Val  Loss: 0.4802 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.5411 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.2808 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2846 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2872 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.3047 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.3283 | Val  Acc: 0.9082
 Site-Painting                  (2) | Val  Loss: 0.4320 | Val  Acc: 0.8905
 Site-Painting                  (2) | Val  Loss: 0.4152 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.5218 | Val  Acc: 0.8425
 Site-Sketch                    (0) | Val  Loss: 0.6149 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 1.0785 | Val  Acc: 0.6927
 Site-Infograph                 (5) | Val  Loss: 1.1237 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8640
============ Train epoch 22 ============
cnt=[5, 1, 3, 4, 2, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.5008 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.3823 | Train Acc: 0.8944
 Site-Clipart                   (0) | Train Loss: 0.5549 | Train Acc: 0.8533
 Site-Clipart                   (0) | Train Loss: 0.4648 | Train Acc: 0.8639
 Site-Clipart                   (0) | Train Loss: 0.4733 | Train Acc: 0.8914
 Site-Real                      (3) | Train Loss: 0.3731 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2540 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2888 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.3286 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.4608 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.4714 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.4111 | Train Acc: 0.9066
 Site-Sketch                    (4) | Train Loss: 0.4916 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.5181 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 1.0277 | Train Acc: 0.7064
 Site-Infograph                 (5) | Train Loss: 1.1650 | Train Acc: 0.6154
Average Train Accuracy: 0.8647
 Site-Clipart                   (0) | Val  Loss: 0.3335 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.4156 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.4128 | Val  Acc: 0.9067
 Site-Clipart                   (0) | Val  Loss: 0.4652 | Val  Acc: 0.8429
 Site-Clipart                   (0) | Val  Loss: 0.5433 | Val  Acc: 0.8339
 Site-Real                      (3) | Val  Loss: 0.2768 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2866 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2993 | Val  Acc: 0.9091
 Site-Real                      (3) | Val  Loss: 0.2766 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.3187 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.3927 | Val  Acc: 0.9051
 Site-Painting                  (2) | Val  Loss: 0.4536 | Val  Acc: 0.8854
 Site-Sketch                    (4) | Val  Loss: 0.5188 | Val  Acc: 0.8346
 Site-Sketch                    (4) | Val  Loss: 0.5750 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 1.0277 | Val  Acc: 0.6835
 Site-Infograph                 (5) | Val  Loss: 1.0687 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8657
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.9065
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.9067
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8429
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8339
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9091
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9567
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9184
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9051
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.8854
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8346
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:22 | Val Acc: 0.6835
 Best site-Infograph                (5)  | Epoch:22 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 23 ============
cnt=[4, 1, 3, 4, 1, 3, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.4736 | Train Acc: 0.8435
 Site-Clipart                   (3) | Train Loss: 0.3879 | Train Acc: 0.9193
 Site-Clipart                   (3) | Train Loss: 0.5068 | Train Acc: 0.8400
 Site-Clipart                   (3) | Train Loss: 0.4573 | Train Acc: 0.8734
 Site-Clipart                   (3) | Train Loss: 0.5080 | Train Acc: 0.8575
 Site-Real                      (0) | Train Loss: 0.3743 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2509 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2696 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.2941 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.4639 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.4056 | Train Acc: 0.8689
 Site-Painting                  (5) | Train Loss: 0.3703 | Train Acc: 0.9204
 Site-Sketch                    (2) | Train Loss: 0.5479 | Train Acc: 0.8220
 Site-Sketch                    (2) | Train Loss: 0.5808 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.9651 | Train Acc: 0.7034
 Site-Infograph                 (4) | Train Loss: 1.1790 | Train Acc: 0.6068
Average Train Accuracy: 0.8575
 Site-Clipart                   (2) | Val  Loss: 0.3203 | Val  Acc: 0.8816
 Site-Clipart                   (3) | Val  Loss: 0.4126 | Val  Acc: 0.8972
 Site-Clipart                   (3) | Val  Loss: 0.4222 | Val  Acc: 0.8733
 Site-Clipart                   (3) | Val  Loss: 0.4377 | Val  Acc: 0.9048
 Site-Clipart                   (3) | Val  Loss: 0.5430 | Val  Acc: 0.8407
 Site-Real                      (0) | Val  Loss: 0.2371 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2736 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.2399 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2632 | Val  Acc: 0.9610
 Site-Painting                  (5) | Val  Loss: 0.3381 | Val  Acc: 0.9184
 Site-Painting                  (5) | Val  Loss: 0.3928 | Val  Acc: 0.8978
 Site-Painting                  (5) | Val  Loss: 0.4175 | Val  Acc: 0.8854
 Site-Sketch                    (2) | Val  Loss: 0.4942 | Val  Acc: 0.8425
 Site-Sketch                    (2) | Val  Loss: 0.5307 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 1.0120 | Val  Acc: 0.7202
 Site-Infograph                 (4) | Val  Loss: 1.1109 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8732
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8816
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.8972
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.8733
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.9048
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.8407
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9237
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9455
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9610
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.9184
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.8978
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.8854
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8425
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8539
 Best site-QuickDraw                (1)  | Epoch:23 | Val Acc: 0.7202
 Best site-Infograph                (4)  | Epoch:23 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 24 ============
cnt=[1, 4, 2, 3, 5, 1, ]
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (4) | Train Loss: 0.5159 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.3532 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.5512 | Train Acc: 0.8667
 Site-Clipart                   (4) | Train Loss: 0.4554 | Train Acc: 0.8703
 Site-Clipart                   (4) | Train Loss: 0.4658 | Train Acc: 0.8688
 Site-Real                      (1) | Train Loss: 0.3796 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.2661 | Train Acc: 0.9605
 Site-Real                      (1) | Train Loss: 0.2523 | Train Acc: 0.9556
 Site-Real                      (1) | Train Loss: 0.3040 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.4883 | Train Acc: 0.8707
 Site-Painting                  (3) | Train Loss: 0.4173 | Train Acc: 0.8883
 Site-Painting                  (3) | Train Loss: 0.3941 | Train Acc: 0.9031
 Site-Sketch                    (2) | Train Loss: 0.5134 | Train Acc: 0.8586
 Site-Sketch                    (2) | Train Loss: 0.4843 | Train Acc: 0.8464
 Site-QuickDraw                 (0) | Train Loss: 0.8971 | Train Acc: 0.7401
 Site-Infograph                 (5) | Train Loss: 1.1186 | Train Acc: 0.6282
Average Train Accuracy: 0.8676
 Site-Clipart                   (4) | Val  Loss: 0.3419 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.4207 | Val  Acc: 0.8785
 Site-Clipart                   (4) | Val  Loss: 0.4828 | Val  Acc: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.4771 | Val  Acc: 0.8524
 Site-Clipart                   (4) | Val  Loss: 0.5408 | Val  Acc: 0.8576
 Site-Real                      (1) | Val  Loss: 0.2748 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2693 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2812 | Val  Acc: 0.9273
 Site-Real                      (1) | Val  Loss: 0.2903 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.3077 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.3664 | Val  Acc: 0.9197
 Site-Painting                  (3) | Val  Loss: 0.4043 | Val  Acc: 0.8958
 Site-Sketch                    (2) | Val  Loss: 0.5014 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.5356 | Val  Acc: 0.8090
 Site-QuickDraw                 (0) | Val  Loss: 0.9619 | Val  Acc: 0.7385
 Site-Infograph                 (5) | Val  Loss: 1.0290 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8743
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.9342
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8785
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8733
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8524
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8576
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9407
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9273
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9437
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.9286
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.9197
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.8958
 Best site-Sketch                   (2)  | Epoch:24 | Val Acc: 0.8583
 Best site-Sketch                   (2)  | Epoch:24 | Val Acc: 0.8090
 Best site-QuickDraw                (0)  | Epoch:24 | Val Acc: 0.7385
 Best site-Infograph                (5)  | Epoch:24 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 25 ============
cnt=[2, 1, 3, 5, 4, 1, ]
cnt=[5, 3, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (3) | Train Loss: 0.4222 | Train Acc: 0.8870
 Site-Clipart                   (3) | Train Loss: 0.3200 | Train Acc: 0.9193
 Site-Clipart                   (3) | Train Loss: 0.5185 | Train Acc: 0.8578
 Site-Clipart                   (3) | Train Loss: 0.4392 | Train Acc: 0.8892
 Site-Clipart                   (3) | Train Loss: 0.4536 | Train Acc: 0.8869
 Site-Real                      (4) | Train Loss: 0.3858 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2274 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2791 | Train Acc: 0.9315
 Site-Real                      (4) | Train Loss: 0.3050 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.4315 | Train Acc: 0.8844
 Site-Painting                  (2) | Train Loss: 0.5016 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.4030 | Train Acc: 0.9100
 Site-Sketch                    (0) | Train Loss: 0.4826 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.5537 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.8804 | Train Acc: 0.7492
 Site-Infograph                 (5) | Train Loss: 1.1081 | Train Acc: 0.6154
Average Train Accuracy: 0.8721
 Site-Clipart                   (3) | Val  Loss: 0.3364 | Val  Acc: 0.8947
 Site-Clipart                   (3) | Val  Loss: 0.4123 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.4111 | Val  Acc: 0.9000
 Site-Clipart                   (3) | Val  Loss: 0.4401 | Val  Acc: 0.8714
 Site-Clipart                   (3) | Val  Loss: 0.5265 | Val  Acc: 0.8610
 Site-Real                      (4) | Val  Loss: 0.2606 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2700 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2704 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2855 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2969 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3892 | Val  Acc: 0.9051
 Site-Painting                  (2) | Val  Loss: 0.3910 | Val  Acc: 0.8906
 Site-Sketch                    (0) | Val  Loss: 0.4675 | Val  Acc: 0.8425
 Site-Sketch                    (0) | Val  Loss: 0.5525 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.9866 | Val  Acc: 0.7294
 Site-Infograph                 (5) | Val  Loss: 1.0733 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8721
============ Train epoch 26 ============
cnt=[3, 1, 5, 4, 2, 1, ]
cnt=[3, 5, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (2) | Train Loss: 0.4824 | Train Acc: 0.8435
 Site-Clipart                   (2) | Train Loss: 0.3569 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.4578 | Train Acc: 0.8711
 Site-Clipart                   (2) | Train Loss: 0.4234 | Train Acc: 0.8703
 Site-Clipart                   (2) | Train Loss: 0.4417 | Train Acc: 0.8891
 Site-Real                      (3) | Train Loss: 0.3557 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2428 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2555 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.2962 | Train Acc: 0.9511
 Site-Painting                  (0) | Train Loss: 0.4230 | Train Acc: 0.8844
 Site-Painting                  (0) | Train Loss: 0.4058 | Train Acc: 0.8738
 Site-Painting                  (0) | Train Loss: 0.3970 | Train Acc: 0.9066
 Site-Sketch                    (4) | Train Loss: 0.4818 | Train Acc: 0.8534
 Site-Sketch                    (4) | Train Loss: 0.4759 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.8499 | Train Acc: 0.7401
 Site-Infograph                 (5) | Train Loss: 1.0871 | Train Acc: 0.6239
Average Train Accuracy: 0.8677
 Site-Clipart                   (2) | Val  Loss: 0.3086 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.3920 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.4127 | Val  Acc: 0.8600
 Site-Clipart                   (2) | Val  Loss: 0.3967 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.5064 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2660 | Val  Acc: 0.9643
 Site-Real                      (3) | Val  Loss: 0.2595 | Val  Acc: 0.9746
 Site-Real                      (3) | Val  Loss: 0.2523 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2592 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.2984 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.3435 | Val  Acc: 0.8978
 Site-Painting                  (0) | Val  Loss: 0.4104 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.4518 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.5802 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 0.9627 | Val  Acc: 0.7110
 Site-Infograph                 (5) | Val  Loss: 1.0907 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8736
============ Train epoch 27 ============
cnt=[4, 1, 2, 3, 5, 1, ]
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (4) | Train Loss: 0.4628 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.3573 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.4827 | Train Acc: 0.8800
 Site-Clipart                   (4) | Train Loss: 0.4208 | Train Acc: 0.8639
 Site-Clipart                   (4) | Train Loss: 0.4430 | Train Acc: 0.8846
 Site-Real                      (0) | Train Loss: 0.3363 | Train Acc: 0.9286
 Site-Real                      (0) | Train Loss: 0.2314 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2449 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2884 | Train Acc: 0.9483
 Site-Painting                  (3) | Train Loss: 0.4774 | Train Acc: 0.8707
 Site-Painting                  (3) | Train Loss: 0.4431 | Train Acc: 0.8835
 Site-Painting                  (3) | Train Loss: 0.3376 | Train Acc: 0.9273
 Site-Sketch                    (2) | Train Loss: 0.4849 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.5286 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 0.8656 | Train Acc: 0.7217
 Site-Infograph                 (5) | Train Loss: 1.0977 | Train Acc: 0.6282
Average Train Accuracy: 0.8683
 Site-Clipart                   (4) | Val  Loss: 0.2933 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.3789 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.4195 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4445 | Val  Acc: 0.8619
 Site-Clipart                   (4) | Val  Loss: 0.5225 | Val  Acc: 0.8508
 Site-Real                      (0) | Val  Loss: 0.2406 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2948 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2896 | Val  Acc: 0.9152
 Site-Real                      (0) | Val  Loss: 0.2672 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.2989 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.3412 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3663 | Val  Acc: 0.9010
 Site-Sketch                    (2) | Val  Loss: 0.5363 | Val  Acc: 0.8425
 Site-Sketch                    (2) | Val  Loss: 0.6054 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 0.9528 | Val  Acc: 0.7339
 Site-Infograph                 (5) | Val  Loss: 1.0739 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8698
============ Train epoch 28 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (0) | Train Loss: 0.4032 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.3417 | Train Acc: 0.9441
 Site-Clipart                   (0) | Train Loss: 0.4630 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.4250 | Train Acc: 0.8829
 Site-Clipart                   (0) | Train Loss: 0.4092 | Train Acc: 0.9163
 Site-Real                      (2) | Train Loss: 0.3731 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.2349 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.2592 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2684 | Train Acc: 0.9511
 Site-Painting                  (4) | Train Loss: 0.4645 | Train Acc: 0.8776
 Site-Painting                  (4) | Train Loss: 0.4516 | Train Acc: 0.8786
 Site-Painting                  (4) | Train Loss: 0.3725 | Train Acc: 0.9170
 Site-Sketch                    (5) | Train Loss: 0.4801 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.4905 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.8163 | Train Acc: 0.7248
 Site-Infograph                 (3) | Train Loss: 1.0624 | Train Acc: 0.6410
Average Train Accuracy: 0.8749
 Site-Clipart                   (0) | Val  Loss: 0.2483 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.3869 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.4408 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4413 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.5060 | Val  Acc: 0.8475
 Site-Real                      (2) | Val  Loss: 0.2551 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2325 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.2497 | Val  Acc: 0.9394
 Site-Real                      (2) | Val  Loss: 0.2551 | Val  Acc: 0.9437
 Site-Painting                  (4) | Val  Loss: 0.2936 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.3699 | Val  Acc: 0.9197
 Site-Painting                  (4) | Val  Loss: 0.4208 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.4589 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5770 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 0.9418 | Val  Acc: 0.7615
 Site-Infograph                 (3) | Val  Loss: 1.0770 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8782
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.9474
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.9159
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8714
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8475
 Best site-Real                     (2)  | Epoch:28 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:28 | Val Acc: 0.9576
 Best site-Real                     (2)  | Epoch:28 | Val Acc: 0.9394
 Best site-Real                     (2)  | Epoch:28 | Val Acc: 0.9437
 Best site-Painting                 (4)  | Epoch:28 | Val Acc: 0.9286
 Best site-Painting                 (4)  | Epoch:28 | Val Acc: 0.9197
 Best site-Painting                 (4)  | Epoch:28 | Val Acc: 0.8906
 Best site-Sketch                   (5)  | Epoch:28 | Val Acc: 0.8661
 Best site-Sketch                   (5)  | Epoch:28 | Val Acc: 0.7865
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.7615
 Best site-Infograph                (3)  | Epoch:28 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 29 ============
cnt=[1, 1, 2, 3, 4, 5, ]
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (5) | Train Loss: 0.4530 | Train Acc: 0.8783
 Site-Clipart                   (5) | Train Loss: 0.3865 | Train Acc: 0.8882
 Site-Clipart                   (5) | Train Loss: 0.4801 | Train Acc: 0.8622
 Site-Clipart                   (5) | Train Loss: 0.4264 | Train Acc: 0.8766
 Site-Clipart                   (5) | Train Loss: 0.4146 | Train Acc: 0.9095
 Site-Real                      (4) | Train Loss: 0.3437 | Train Acc: 0.8968
 Site-Real                      (4) | Train Loss: 0.2474 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2372 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2691 | Train Acc: 0.9425
 Site-Painting                  (3) | Train Loss: 0.3636 | Train Acc: 0.8776
 Site-Painting                  (3) | Train Loss: 0.4269 | Train Acc: 0.8689
 Site-Painting                  (3) | Train Loss: 0.3700 | Train Acc: 0.9066
 Site-Sketch                    (2) | Train Loss: 0.4917 | Train Acc: 0.8429
 Site-Sketch                    (2) | Train Loss: 0.4861 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.8261 | Train Acc: 0.7890
 Site-Infograph                 (0) | Train Loss: 1.0183 | Train Acc: 0.6624
Average Train Accuracy: 0.8719
 Site-Clipart                   (5) | Val  Loss: 0.2872 | Val  Acc: 0.9079
 Site-Clipart                   (5) | Val  Loss: 0.3635 | Val  Acc: 0.9159
 Site-Clipart                   (5) | Val  Loss: 0.4163 | Val  Acc: 0.8867
 Site-Clipart                   (5) | Val  Loss: 0.4439 | Val  Acc: 0.8524
 Site-Clipart                   (5) | Val  Loss: 0.5171 | Val  Acc: 0.8407
 Site-Real                      (4) | Val  Loss: 0.2633 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2687 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2614 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2414 | Val  Acc: 0.9610
 Site-Painting                  (3) | Val  Loss: 0.3244 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.3045 | Val  Acc: 0.9416
 Site-Painting                  (3) | Val  Loss: 0.3654 | Val  Acc: 0.8906
 Site-Sketch                    (2) | Val  Loss: 0.4941 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.5549 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.9186 | Val  Acc: 0.7431
 Site-Infograph                 (0) | Val  Loss: 1.0439 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8756
 Test site-Clipart                   (5)| Epoch:28 | Test Acc: 0.8688
 Test site-Real                      (4)| Epoch:28 | Test Acc: 0.9441
 Test site-Painting                  (3)| Epoch:28 | Test Acc: 0.9208
 Test site-Sketch                    (2)| Epoch:28 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:28 | Test Acc: 0.7300
 Test site-Infograph                 (0)| Epoch:28 | Test Acc: 0.5586
Clipart: 0.8688, Real: 0.9441, Painting: 0.9208, Sketch: 0.8791, QuickDraw: 0.7300, Infograph: 0.5586, 
Average Test Accuracy(group): 0.8169, Average Test Accuracy(individual): 0.8706,
domain std=0.1341, cluster std=0.1341, individual std=0.0957, 
============ Train epoch 30 ============
cnt=[5, 1, 3, 4, 1, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (0) | Train Loss: 0.4461 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.3184 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.4646 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3968 | Train Acc: 0.8766
 Site-Clipart                   (0) | Train Loss: 0.4189 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.3400 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2252 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2491 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.2781 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.3544 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3737 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.3711 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.4504 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.5591 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 0.8810 | Train Acc: 0.7554
 Site-Infograph                 (4) | Train Loss: 1.0574 | Train Acc: 0.6667
Average Train Accuracy: 0.8724
 Site-Clipart                   (0) | Val  Loss: 0.2637 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3451 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.4013 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.4080 | Val  Acc: 0.8524
 Site-Clipart                   (0) | Val  Loss: 0.5006 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2504 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2327 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2182 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2458 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2936 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3583 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.3960 | Val  Acc: 0.8698
 Site-Sketch                    (5) | Val  Loss: 0.4870 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5642 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.9179 | Val  Acc: 0.7661
 Site-Infograph                 (4) | Val  Loss: 1.0832 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8788
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.9342
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8972
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8867
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8524
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8644
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9455
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9567
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9388
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9124
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.8698
 Best site-Sketch                   (5)  | Epoch:30 | Val Acc: 0.8583
 Best site-Sketch                   (5)  | Epoch:30 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:30 | Val Acc: 0.7661
 Best site-Infograph                (4)  | Epoch:30 | Val Acc: 0.6538
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 31 ============
cnt=[4, 1, 5, 3, 1, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (2) | Train Loss: 0.4155 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.2939 | Train Acc: 0.9441
 Site-Clipart                   (2) | Train Loss: 0.5190 | Train Acc: 0.8622
 Site-Clipart                   (2) | Train Loss: 0.4360 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.4079 | Train Acc: 0.8914
 Site-Real                      (0) | Train Loss: 0.3626 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.2332 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2280 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2860 | Train Acc: 0.9425
 Site-Painting                  (3) | Train Loss: 0.4389 | Train Acc: 0.8980
 Site-Painting                  (3) | Train Loss: 0.3387 | Train Acc: 0.9223
 Site-Painting                  (3) | Train Loss: 0.3690 | Train Acc: 0.9031
 Site-Sketch                    (5) | Train Loss: 0.4873 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.5209 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.7512 | Train Acc: 0.7676
 Site-Infograph                 (4) | Train Loss: 1.0696 | Train Acc: 0.6581
Average Train Accuracy: 0.8751
 Site-Clipart                   (2) | Val  Loss: 0.2914 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.3662 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.4073 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.3874 | Val  Acc: 0.8714
 Site-Clipart                   (2) | Val  Loss: 0.5012 | Val  Acc: 0.8373
 Site-Real                      (0) | Val  Loss: 0.2555 | Val  Acc: 0.9167
 Site-Real                      (0) | Val  Loss: 0.2487 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2298 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2602 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.2790 | Val  Acc: 0.9388
 Site-Painting                  (3) | Val  Loss: 0.3565 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3596 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4496 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5109 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.8833 | Val  Acc: 0.7294
 Site-Infograph                 (4) | Val  Loss: 0.9899 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8750
============ Train epoch 32 ============
cnt=[1, 4, 2, 1, 5, 3, ]
cnt=[1, 5, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (4) | Train Loss: 0.4733 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.3154 | Train Acc: 0.9503
 Site-Clipart                   (4) | Train Loss: 0.5140 | Train Acc: 0.8444
 Site-Clipart                   (4) | Train Loss: 0.4137 | Train Acc: 0.8861
 Site-Clipart                   (4) | Train Loss: 0.3930 | Train Acc: 0.8937
 Site-Real                      (1) | Train Loss: 0.3409 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.2341 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.2472 | Train Acc: 0.9476
 Site-Real                      (1) | Train Loss: 0.2823 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.3653 | Train Acc: 0.8844
 Site-Painting                  (5) | Train Loss: 0.3946 | Train Acc: 0.9078
 Site-Painting                  (5) | Train Loss: 0.3508 | Train Acc: 0.9204
 Site-Sketch                    (2) | Train Loss: 0.4385 | Train Acc: 0.8639
 Site-Sketch                    (2) | Train Loss: 0.5053 | Train Acc: 0.8315
 Site-QuickDraw                 (0) | Train Loss: 0.8512 | Train Acc: 0.7523
 Site-Infograph                 (3) | Train Loss: 0.9916 | Train Acc: 0.6624
Average Train Accuracy: 0.8753
 Site-Clipart                   (4) | Val  Loss: 0.2511 | Val  Acc: 0.9474
 Site-Clipart                   (4) | Val  Loss: 0.3750 | Val  Acc: 0.9065
 Site-Clipart                   (4) | Val  Loss: 0.3808 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.4164 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4911 | Val  Acc: 0.8712
 Site-Real                      (1) | Val  Loss: 0.2409 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2554 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.2637 | Val  Acc: 0.9152
 Site-Real                      (1) | Val  Loss: 0.2623 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2260 | Val  Acc: 0.9592
 Site-Painting                  (5) | Val  Loss: 0.4211 | Val  Acc: 0.8978
 Site-Painting                  (5) | Val  Loss: 0.3732 | Val  Acc: 0.8958
 Site-Sketch                    (2) | Val  Loss: 0.4482 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.5539 | Val  Acc: 0.8034
 Site-QuickDraw                 (0) | Val  Loss: 0.8943 | Val  Acc: 0.7982
 Site-Infograph                 (3) | Val  Loss: 0.9824 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8824
 Best site-Clipart                  (4)  | Epoch:32 | Val Acc: 0.9474
 Best site-Clipart                  (4)  | Epoch:32 | Val Acc: 0.9065
 Best site-Clipart                  (4)  | Epoch:32 | Val Acc: 0.8867
 Best site-Clipart                  (4)  | Epoch:32 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:32 | Val Acc: 0.8712
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9492
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9152
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9437
 Best site-Painting                 (5)  | Epoch:32 | Val Acc: 0.9592
 Best site-Painting                 (5)  | Epoch:32 | Val Acc: 0.8978
 Best site-Painting                 (5)  | Epoch:32 | Val Acc: 0.8958
 Best site-Sketch                   (2)  | Epoch:32 | Val Acc: 0.8583
 Best site-Sketch                   (2)  | Epoch:32 | Val Acc: 0.8034
 Best site-QuickDraw                (0)  | Epoch:32 | Val Acc: 0.7982
 Best site-Infograph                (3)  | Epoch:32 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 33 ============
cnt=[2, 1, 4, 3, 5, 1, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (4) | Train Loss: 0.4347 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.2954 | Train Acc: 0.9441
 Site-Clipart                   (4) | Train Loss: 0.4354 | Train Acc: 0.8622
 Site-Clipart                   (4) | Train Loss: 0.3924 | Train Acc: 0.8892
 Site-Clipart                   (4) | Train Loss: 0.3845 | Train Acc: 0.9050
 Site-Real                      (2) | Train Loss: 0.3699 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.2171 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.2517 | Train Acc: 0.9355
 Site-Real                      (2) | Train Loss: 0.2789 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.4273 | Train Acc: 0.8571
 Site-Painting                  (3) | Train Loss: 0.3984 | Train Acc: 0.8835
 Site-Painting                  (3) | Train Loss: 0.3340 | Train Acc: 0.9204
 Site-Sketch                    (0) | Train Loss: 0.4754 | Train Acc: 0.8482
 Site-Sketch                    (0) | Train Loss: 0.4364 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.8562 | Train Acc: 0.7462
 Site-Infograph                 (5) | Train Loss: 1.0142 | Train Acc: 0.6752
Average Train Accuracy: 0.8747
 Site-Clipart                   (4) | Val  Loss: 0.3095 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.3536 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.3690 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.3891 | Val  Acc: 0.8762
 Site-Clipart                   (4) | Val  Loss: 0.5018 | Val  Acc: 0.8475
 Site-Real                      (2) | Val  Loss: 0.2314 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2284 | Val  Acc: 0.9492
 Site-Real                      (2) | Val  Loss: 0.2606 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.2357 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.2285 | Val  Acc: 0.9694
 Site-Painting                  (3) | Val  Loss: 0.3190 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3333 | Val  Acc: 0.9167
 Site-Sketch                    (0) | Val  Loss: 0.4597 | Val  Acc: 0.8583
 Site-Sketch                    (0) | Val  Loss: 0.5340 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.8653 | Val  Acc: 0.7615
 Site-Infograph                 (5) | Val  Loss: 1.0662 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8845
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.9211
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.9159
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.9000
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.8762
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.8475
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9492
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9273
 Best site-Real                     (2)  | Epoch:33 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:33 | Val Acc: 0.9694
 Best site-Painting                 (3)  | Epoch:33 | Val Acc: 0.9124
 Best site-Painting                 (3)  | Epoch:33 | Val Acc: 0.9167
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.8583
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:33 | Val Acc: 0.7615
 Best site-Infograph                (5)  | Epoch:33 | Val Acc: 0.7051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 34 ============
cnt=[1, 4, 5, 1, 3, 2, ]
cnt=[5, 4, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (2) | Train Loss: 0.3907 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.3171 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.4133 | Train Acc: 0.8667
 Site-Clipart                   (2) | Train Loss: 0.3825 | Train Acc: 0.8924
 Site-Clipart                   (2) | Train Loss: 0.4121 | Train Acc: 0.8959
 Site-Real                      (1) | Train Loss: 0.3574 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.2199 | Train Acc: 0.9605
 Site-Real                      (1) | Train Loss: 0.2147 | Train Acc: 0.9516
 Site-Real                      (1) | Train Loss: 0.3061 | Train Acc: 0.9397
 Site-Painting                  (4) | Train Loss: 0.4624 | Train Acc: 0.8912
 Site-Painting                  (4) | Train Loss: 0.4526 | Train Acc: 0.8689
 Site-Painting                  (4) | Train Loss: 0.3502 | Train Acc: 0.8997
 Site-Sketch                    (5) | Train Loss: 0.5095 | Train Acc: 0.8272
 Site-Sketch                    (5) | Train Loss: 0.4799 | Train Acc: 0.8390
 Site-QuickDraw                 (0) | Train Loss: 0.8395 | Train Acc: 0.7737
 Site-Infograph                 (3) | Train Loss: 0.9807 | Train Acc: 0.6624
Average Train Accuracy: 0.8742
 Site-Clipart                   (2) | Val  Loss: 0.2715 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.3112 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.3727 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.3919 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.4857 | Val  Acc: 0.8542
 Site-Real                      (1) | Val  Loss: 0.2362 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2446 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2455 | Val  Acc: 0.9273
 Site-Real                      (1) | Val  Loss: 0.2637 | Val  Acc: 0.9481
 Site-Painting                  (4) | Val  Loss: 0.2557 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.2876 | Val  Acc: 0.9124
 Site-Painting                  (4) | Val  Loss: 0.3478 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.4227 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5055 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 0.8885 | Val  Acc: 0.7477
 Site-Infograph                 (3) | Val  Loss: 0.9728 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8804
============ Train epoch 35 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[1, 4, 3, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (4) | Train Loss: 0.4063 | Train Acc: 0.8870
 Site-Clipart                   (4) | Train Loss: 0.3022 | Train Acc: 0.9255
 Site-Clipart                   (4) | Train Loss: 0.4577 | Train Acc: 0.8800
 Site-Clipart                   (4) | Train Loss: 0.4241 | Train Acc: 0.8671
 Site-Clipart                   (4) | Train Loss: 0.3966 | Train Acc: 0.9027
 Site-Real                      (0) | Train Loss: 0.3179 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2252 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2209 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2895 | Train Acc: 0.9368
 Site-Painting                  (5) | Train Loss: 0.4073 | Train Acc: 0.8844
 Site-Painting                  (5) | Train Loss: 0.3811 | Train Acc: 0.8786
 Site-Painting                  (5) | Train Loss: 0.3325 | Train Acc: 0.9273
 Site-Sketch                    (2) | Train Loss: 0.4515 | Train Acc: 0.8639
 Site-Sketch                    (2) | Train Loss: 0.4480 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.8782 | Train Acc: 0.7890
 Site-Infograph                 (3) | Train Loss: 0.9580 | Train Acc: 0.6966
Average Train Accuracy: 0.8821
 Site-Clipart                   (4) | Val  Loss: 0.2839 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.3750 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.3794 | Val  Acc: 0.9067
 Site-Clipart                   (4) | Val  Loss: 0.4269 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4809 | Val  Acc: 0.8542
 Site-Real                      (0) | Val  Loss: 0.2353 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2443 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2350 | Val  Acc: 0.9273
 Site-Real                      (0) | Val  Loss: 0.2491 | Val  Acc: 0.9481
 Site-Painting                  (5) | Val  Loss: 0.2322 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.3058 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.3596 | Val  Acc: 0.9115
 Site-Sketch                    (2) | Val  Loss: 0.3734 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.5018 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8397 | Val  Acc: 0.7661
 Site-Infograph                 (3) | Val  Loss: 1.0055 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8848
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.9342
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.8879
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.9067
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.8542
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9492
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9273
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9481
 Best site-Painting                 (5)  | Epoch:35 | Val Acc: 0.9388
 Best site-Painting                 (5)  | Epoch:35 | Val Acc: 0.9051
 Best site-Painting                 (5)  | Epoch:35 | Val Acc: 0.9115
 Best site-Sketch                   (2)  | Epoch:35 | Val Acc: 0.8819
 Best site-Sketch                   (2)  | Epoch:35 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.7661
 Best site-Infograph                (3)  | Epoch:35 | Val Acc: 0.7179
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 36 ============
cnt=[3, 1, 2, 5, 1, 4, ]
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (3) | Train Loss: 0.3937 | Train Acc: 0.8696
 Site-Clipart                   (3) | Train Loss: 0.3055 | Train Acc: 0.9068
 Site-Clipart                   (3) | Train Loss: 0.4773 | Train Acc: 0.8711
 Site-Clipart                   (3) | Train Loss: 0.3978 | Train Acc: 0.8829
 Site-Clipart                   (3) | Train Loss: 0.3828 | Train Acc: 0.9095
 Site-Real                      (5) | Train Loss: 0.3374 | Train Acc: 0.9127
 Site-Real                      (5) | Train Loss: 0.2373 | Train Acc: 0.9492
 Site-Real                      (5) | Train Loss: 0.2192 | Train Acc: 0.9476
 Site-Real                      (5) | Train Loss: 0.2567 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.3921 | Train Acc: 0.8912
 Site-Painting                  (0) | Train Loss: 0.3913 | Train Acc: 0.9029
 Site-Painting                  (0) | Train Loss: 0.3196 | Train Acc: 0.9066
 Site-Sketch                    (2) | Train Loss: 0.4530 | Train Acc: 0.8429
 Site-Sketch                    (2) | Train Loss: 0.5726 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.8302 | Train Acc: 0.7829
 Site-Infograph                 (4) | Train Loss: 0.9589 | Train Acc: 0.6838
Average Train Accuracy: 0.8783
 Site-Clipart                   (3) | Val  Loss: 0.2706 | Val  Acc: 0.9474
 Site-Clipart                   (3) | Val  Loss: 0.3345 | Val  Acc: 0.9159
 Site-Clipart                   (3) | Val  Loss: 0.3622 | Val  Acc: 0.8867
 Site-Clipart                   (3) | Val  Loss: 0.4132 | Val  Acc: 0.8667
 Site-Clipart                   (3) | Val  Loss: 0.4281 | Val  Acc: 0.8949
 Site-Real                      (5) | Val  Loss: 0.2405 | Val  Acc: 0.9405
 Site-Real                      (5) | Val  Loss: 0.2345 | Val  Acc: 0.9576
 Site-Real                      (5) | Val  Loss: 0.2698 | Val  Acc: 0.9212
 Site-Real                      (5) | Val  Loss: 0.2482 | Val  Acc: 0.9437
 Site-Painting                  (0) | Val  Loss: 0.2676 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.2926 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3579 | Val  Acc: 0.9167
 Site-Sketch                    (2) | Val  Loss: 0.4122 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.5200 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.8656 | Val  Acc: 0.7706
 Site-Infograph                 (4) | Val  Loss: 0.9949 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8878
 Best site-Clipart                  (3)  | Epoch:36 | Val Acc: 0.9474
 Best site-Clipart                  (3)  | Epoch:36 | Val Acc: 0.9159
 Best site-Clipart                  (3)  | Epoch:36 | Val Acc: 0.8867
 Best site-Clipart                  (3)  | Epoch:36 | Val Acc: 0.8667
 Best site-Clipart                  (3)  | Epoch:36 | Val Acc: 0.8949
 Best site-Real                     (5)  | Epoch:36 | Val Acc: 0.9405
 Best site-Real                     (5)  | Epoch:36 | Val Acc: 0.9576
 Best site-Real                     (5)  | Epoch:36 | Val Acc: 0.9212
 Best site-Real                     (5)  | Epoch:36 | Val Acc: 0.9437
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9286
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9124
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9167
 Best site-Sketch                   (2)  | Epoch:36 | Val Acc: 0.8819
 Best site-Sketch                   (2)  | Epoch:36 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:36 | Val Acc: 0.7706
 Best site-Infograph                (4)  | Epoch:36 | Val Acc: 0.7115
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 37 ============
cnt=[2, 1, 4, 1, 5, 3, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (4) | Train Loss: 0.4231 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3173 | Train Acc: 0.9006
 Site-Clipart                   (4) | Train Loss: 0.4214 | Train Acc: 0.8711
 Site-Clipart                   (4) | Train Loss: 0.3750 | Train Acc: 0.8892
 Site-Clipart                   (4) | Train Loss: 0.3923 | Train Acc: 0.8846
 Site-Real                      (2) | Train Loss: 0.3089 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.1925 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.2317 | Train Acc: 0.9315
 Site-Real                      (2) | Train Loss: 0.2739 | Train Acc: 0.9425
 Site-Painting                  (5) | Train Loss: 0.4277 | Train Acc: 0.8980
 Site-Painting                  (5) | Train Loss: 0.4218 | Train Acc: 0.8689
 Site-Painting                  (5) | Train Loss: 0.3230 | Train Acc: 0.9100
 Site-Sketch                    (0) | Train Loss: 0.4374 | Train Acc: 0.8586
 Site-Sketch                    (0) | Train Loss: 0.4108 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.7636 | Train Acc: 0.7890
 Site-Infograph                 (3) | Train Loss: 0.9384 | Train Acc: 0.6966
Average Train Accuracy: 0.8779
 Site-Clipart                   (4) | Val  Loss: 0.2840 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.3328 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.3949 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.3717 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4394 | Val  Acc: 0.8712
 Site-Real                      (2) | Val  Loss: 0.2202 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2599 | Val  Acc: 0.9153
 Site-Real                      (2) | Val  Loss: 0.2760 | Val  Acc: 0.9152
 Site-Real                      (2) | Val  Loss: 0.2226 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2345 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2759 | Val  Acc: 0.9197
 Site-Painting                  (5) | Val  Loss: 0.3398 | Val  Acc: 0.9115
 Site-Sketch                    (0) | Val  Loss: 0.3871 | Val  Acc: 0.8898
 Site-Sketch                    (0) | Val  Loss: 0.5079 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.8200 | Val  Acc: 0.7569
 Site-Infograph                 (3) | Val  Loss: 1.0122 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8823
============ Train epoch 38 ============
cnt=[3, 1, 2, 1, 5, 4, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (4) | Train Loss: 0.3582 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3030 | Train Acc: 0.9317
 Site-Clipart                   (4) | Train Loss: 0.4460 | Train Acc: 0.8756
 Site-Clipart                   (4) | Train Loss: 0.3934 | Train Acc: 0.8639
 Site-Clipart                   (4) | Train Loss: 0.3709 | Train Acc: 0.9118
 Site-Real                      (5) | Train Loss: 0.3522 | Train Acc: 0.8968
 Site-Real                      (5) | Train Loss: 0.2225 | Train Acc: 0.9492
 Site-Real                      (5) | Train Loss: 0.2162 | Train Acc: 0.9476
 Site-Real                      (5) | Train Loss: 0.2818 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4406 | Train Acc: 0.8639
 Site-Painting                  (0) | Train Loss: 0.3201 | Train Acc: 0.8883
 Site-Painting                  (0) | Train Loss: 0.3279 | Train Acc: 0.9239
 Site-Sketch                    (2) | Train Loss: 0.4099 | Train Acc: 0.8901
 Site-Sketch                    (2) | Train Loss: 0.4558 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.7492 | Train Acc: 0.7951
 Site-Infograph                 (3) | Train Loss: 0.9507 | Train Acc: 0.7094
Average Train Accuracy: 0.8834
 Site-Clipart                   (4) | Val  Loss: 0.2540 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.3428 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.3250 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.3574 | Val  Acc: 0.8810
 Site-Clipart                   (4) | Val  Loss: 0.4613 | Val  Acc: 0.8576
 Site-Real                      (5) | Val  Loss: 0.2296 | Val  Acc: 0.9643
 Site-Real                      (5) | Val  Loss: 0.2230 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.2087 | Val  Acc: 0.9394
 Site-Real                      (5) | Val  Loss: 0.2299 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.2433 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.3251 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3430 | Val  Acc: 0.9115
 Site-Sketch                    (2) | Val  Loss: 0.4291 | Val  Acc: 0.8425
 Site-Sketch                    (2) | Val  Loss: 0.5294 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.7994 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 1.0662 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8824
============ Train epoch 39 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (0) | Train Loss: 0.3976 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.2823 | Train Acc: 0.9317
 Site-Clipart                   (0) | Train Loss: 0.4271 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.4067 | Train Acc: 0.8797
 Site-Clipart                   (0) | Train Loss: 0.3527 | Train Acc: 0.9231
 Site-Real                      (4) | Train Loss: 0.3258 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2207 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2382 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2883 | Train Acc: 0.9339
 Site-Painting                  (2) | Train Loss: 0.3870 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.3409 | Train Acc: 0.8835
 Site-Painting                  (2) | Train Loss: 0.3324 | Train Acc: 0.9100
 Site-Sketch                    (5) | Train Loss: 0.4240 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.5465 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.7915 | Train Acc: 0.8043
 Site-Infograph                 (3) | Train Loss: 0.9090 | Train Acc: 0.6966
Average Train Accuracy: 0.8835
 Site-Clipart                   (0) | Val  Loss: 0.2153 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.3561 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3461 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.3689 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4181 | Val  Acc: 0.8949
 Site-Real                      (4) | Val  Loss: 0.2171 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2439 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2056 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2375 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.2471 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.2805 | Val  Acc: 0.9343
 Site-Painting                  (2) | Val  Loss: 0.3304 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4061 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4928 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8635 | Val  Acc: 0.7661
 Site-Infograph                 (3) | Val  Loss: 0.9912 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8888
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.9211
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.9159
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8867
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8857
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8949
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9407
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9455
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9437
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9592
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9343
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.8854
 Best site-Sketch                   (5)  | Epoch:39 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:39 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.7661
 Best site-Infograph                (3)  | Epoch:39 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Test site-Clipart                   (0)| Epoch:39 | Test Acc: 0.8764
 Test site-Real                      (4)| Epoch:39 | Test Acc: 0.9441
 Test site-Painting                  (2)| Epoch:39 | Test Acc: 0.9305
 Test site-Sketch                    (5)| Epoch:39 | Test Acc: 0.8809
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7460
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5677
Clipart: 0.8764, Real: 0.9441, Painting: 0.9305, Sketch: 0.8809, QuickDraw: 0.7460, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8243, Average Test Accuracy(individual): 0.8766,
domain std=0.1314, cluster std=0.1314, individual std=0.0934, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 40 ============
cnt=[2, 1, 4, 1, 5, 3, ]
cnt=[2, 4, 1, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (4) | Train Loss: 0.3833 | Train Acc: 0.8957
 Site-Clipart                   (4) | Train Loss: 0.2796 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.4226 | Train Acc: 0.8844
 Site-Clipart                   (4) | Train Loss: 0.3731 | Train Acc: 0.8892
 Site-Clipart                   (4) | Train Loss: 0.3829 | Train Acc: 0.9072
 Site-Real                      (2) | Train Loss: 0.3051 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.2234 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2321 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.2600 | Train Acc: 0.9540
 Site-Painting                  (5) | Train Loss: 0.4379 | Train Acc: 0.8912
 Site-Painting                  (5) | Train Loss: 0.3821 | Train Acc: 0.8932
 Site-Painting                  (5) | Train Loss: 0.3433 | Train Acc: 0.9066
 Site-Sketch                    (0) | Train Loss: 0.4341 | Train Acc: 0.8429
 Site-Sketch                    (0) | Train Loss: 0.3943 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.8132 | Train Acc: 0.7798
 Site-Infograph                 (3) | Train Loss: 0.9182 | Train Acc: 0.7137
Average Train Accuracy: 0.8844
 Site-Clipart                   (4) | Val  Loss: 0.2499 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.3230 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.3352 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.3597 | Val  Acc: 0.8905
 Site-Clipart                   (4) | Val  Loss: 0.4054 | Val  Acc: 0.9017
 Site-Real                      (2) | Val  Loss: 0.2196 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2431 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.2500 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2189 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2300 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.3089 | Val  Acc: 0.9197
 Site-Painting                  (5) | Val  Loss: 0.3336 | Val  Acc: 0.9115
 Site-Sketch                    (0) | Val  Loss: 0.3990 | Val  Acc: 0.8583
 Site-Sketch                    (0) | Val  Loss: 0.4849 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.8507 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 0.9737 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8862
 Test site-Clipart                   (4)| Epoch:39 | Test Acc: 0.8821
 Test site-Real                      (2)| Epoch:39 | Test Acc: 0.9466
 Test site-Painting                  (5)| Epoch:39 | Test Acc: 0.9241
 Test site-Sketch                    (0)| Epoch:39 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7560
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5540
Clipart: 0.8821, Real: 0.9466, Painting: 0.9241, Sketch: 0.8863, QuickDraw: 0.7560, Infograph: 0.5540, 
Average Test Accuracy(group): 0.8249, Average Test Accuracy(individual): 0.8782,
domain std=0.1353, cluster std=0.1353, individual std=0.0953, 
Average Test Accuracy: 0.8249
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 41 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[5, 4, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (0) | Train Loss: 0.3946 | Train Acc: 0.8957
 Site-Clipart                   (0) | Train Loss: 0.2923 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.3717 | Train Acc: 0.8978
 Site-Clipart                   (0) | Train Loss: 0.3655 | Train Acc: 0.8829
 Site-Clipart                   (0) | Train Loss: 0.3523 | Train Acc: 0.9050
 Site-Real                      (4) | Train Loss: 0.3063 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.1915 | Train Acc: 0.9718
 Site-Real                      (4) | Train Loss: 0.2197 | Train Acc: 0.9355
 Site-Real                      (4) | Train Loss: 0.2571 | Train Acc: 0.9511
 Site-Painting                  (2) | Train Loss: 0.2765 | Train Acc: 0.9184
 Site-Painting                  (2) | Train Loss: 0.4241 | Train Acc: 0.8544
 Site-Painting                  (2) | Train Loss: 0.3364 | Train Acc: 0.9170
 Site-Sketch                    (5) | Train Loss: 0.4076 | Train Acc: 0.8848
 Site-Sketch                    (5) | Train Loss: 0.4208 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.7677 | Train Acc: 0.7951
 Site-Infograph                 (3) | Train Loss: 0.9103 | Train Acc: 0.7009
Average Train Accuracy: 0.8871
 Site-Clipart                   (0) | Val  Loss: 0.2619 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.2845 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.3508 | Val  Acc: 0.9133
 Site-Clipart                   (0) | Val  Loss: 0.3693 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4414 | Val  Acc: 0.8644
 Site-Real                      (4) | Val  Loss: 0.2185 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2489 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.2017 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2306 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2320 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3212 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.3309 | Val  Acc: 0.9271
 Site-Sketch                    (5) | Val  Loss: 0.3791 | Val  Acc: 0.9213
 Site-Sketch                    (5) | Val  Loss: 0.4807 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.8093 | Val  Acc: 0.7569
 Site-Infograph                 (3) | Val  Loss: 0.9862 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8893
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8816
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.9346
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.9133
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8857
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8644
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9322
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9394
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9567
 Best site-Painting                 (2)  | Epoch:41 | Val Acc: 0.9286
 Best site-Painting                 (2)  | Epoch:41 | Val Acc: 0.9124
 Best site-Painting                 (2)  | Epoch:41 | Val Acc: 0.9271
 Best site-Sketch                   (5)  | Epoch:41 | Val Acc: 0.9213
 Best site-Sketch                   (5)  | Epoch:41 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:41 | Val Acc: 0.7569
 Best site-Infograph                (3)  | Epoch:41 | Val Acc: 0.6859
 Test site-Clipart                   (0)| Epoch:41 | Test Acc: 0.8821
 Test site-Real                      (4)| Epoch:41 | Test Acc: 0.9466
 Test site-Painting                  (2)| Epoch:41 | Test Acc: 0.9273
 Test site-Sketch                    (5)| Epoch:41 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7560
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5556
Clipart: 0.8821, Real: 0.9466, Painting: 0.9273, Sketch: 0.8917, QuickDraw: 0.7560, Infograph: 0.5556, 
Average Test Accuracy(group): 0.8265, Average Test Accuracy(individual): 0.8796,
domain std=0.1356, cluster std=0.1356, individual std=0.0953, 
Average Test Accuracy: 0.8265
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 42 ============
cnt=[3, 1, 5, 1, 2, 4, ]
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (2) | Train Loss: 0.3703 | Train Acc: 0.9043
 Site-Clipart                   (2) | Train Loss: 0.3082 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.4393 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.3534 | Train Acc: 0.9114
 Site-Clipart                   (2) | Train Loss: 0.3577 | Train Acc: 0.9118
 Site-Real                      (5) | Train Loss: 0.3206 | Train Acc: 0.9127
 Site-Real                      (5) | Train Loss: 0.1916 | Train Acc: 0.9605
 Site-Real                      (5) | Train Loss: 0.2313 | Train Acc: 0.9476
 Site-Real                      (5) | Train Loss: 0.2476 | Train Acc: 0.9339
 Site-Painting                  (0) | Train Loss: 0.3517 | Train Acc: 0.8980
 Site-Painting                  (0) | Train Loss: 0.3589 | Train Acc: 0.8932
 Site-Painting                  (0) | Train Loss: 0.2859 | Train Acc: 0.9343
 Site-Sketch                    (4) | Train Loss: 0.4238 | Train Acc: 0.8534
 Site-Sketch                    (4) | Train Loss: 0.5360 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.7269 | Train Acc: 0.8073
 Site-Infograph                 (3) | Train Loss: 0.8953 | Train Acc: 0.7265
Average Train Accuracy: 0.8893
 Site-Clipart                   (2) | Val  Loss: 0.2190 | Val  Acc: 0.9474
 Site-Clipart                   (2) | Val  Loss: 0.2748 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.2906 | Val  Acc: 0.9067
 Site-Clipart                   (2) | Val  Loss: 0.3640 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.4607 | Val  Acc: 0.8576
 Site-Real                      (5) | Val  Loss: 0.2214 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.2516 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.2219 | Val  Acc: 0.9394
 Site-Real                      (5) | Val  Loss: 0.2252 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.2505 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.2907 | Val  Acc: 0.9270
 Site-Painting                  (0) | Val  Loss: 0.3254 | Val  Acc: 0.9115
 Site-Sketch                    (4) | Val  Loss: 0.3943 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.5025 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.8058 | Val  Acc: 0.7569
 Site-Infograph                 (3) | Val  Loss: 1.0302 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8875
 Test site-Clipart                   (2)| Epoch:41 | Test Acc: 0.8859
 Test site-Real                      (5)| Epoch:41 | Test Acc: 0.9474
 Test site-Painting                  (0)| Epoch:41 | Test Acc: 0.9241
 Test site-Sketch                    (4)| Epoch:41 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7560
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5601
Clipart: 0.8859, Real: 0.9474, Painting: 0.9241, Sketch: 0.8845, QuickDraw: 0.7560, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8263, Average Test Accuracy(individual): 0.8798,
domain std=0.1335, cluster std=0.1335, individual std=0.0942, 
Average Test Accuracy: 0.8263
============ Train epoch 43 ============
cnt=[4, 1, 1, 5, 2, 3, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (3) | Train Loss: 0.3279 | Train Acc: 0.9130
 Site-Clipart                   (3) | Train Loss: 0.3016 | Train Acc: 0.8944
 Site-Clipart                   (3) | Train Loss: 0.4003 | Train Acc: 0.9067
 Site-Clipart                   (3) | Train Loss: 0.3560 | Train Acc: 0.8861
 Site-Clipart                   (3) | Train Loss: 0.3610 | Train Acc: 0.9072
 Site-Real                      (0) | Train Loss: 0.3144 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2092 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2139 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.2417 | Train Acc: 0.9425
 Site-Painting                  (5) | Train Loss: 0.3763 | Train Acc: 0.9116
 Site-Painting                  (5) | Train Loss: 0.3388 | Train Acc: 0.8981
 Site-Painting                  (5) | Train Loss: 0.3231 | Train Acc: 0.9239
 Site-Sketch                    (4) | Train Loss: 0.4655 | Train Acc: 0.8325
 Site-Sketch                    (4) | Train Loss: 0.4520 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.8252 | Train Acc: 0.7890
 Site-Infograph                 (2) | Train Loss: 0.8721 | Train Acc: 0.7179
Average Train Accuracy: 0.8875
 Site-Clipart                   (3) | Val  Loss: 0.2470 | Val  Acc: 0.9342
 Site-Clipart                   (3) | Val  Loss: 0.2825 | Val  Acc: 0.9346
 Site-Clipart                   (3) | Val  Loss: 0.3310 | Val  Acc: 0.8933
 Site-Clipart                   (3) | Val  Loss: 0.3790 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.4212 | Val  Acc: 0.8847
 Site-Real                      (0) | Val  Loss: 0.2341 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2241 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2197 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2369 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2454 | Val  Acc: 0.9082
 Site-Painting                  (5) | Val  Loss: 0.3246 | Val  Acc: 0.9416
 Site-Painting                  (5) | Val  Loss: 0.3266 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.3547 | Val  Acc: 0.8898
 Site-Sketch                    (4) | Val  Loss: 0.4788 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.8151 | Val  Acc: 0.7706
 Site-Infograph                 (2) | Val  Loss: 0.9805 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8902
 Best site-Clipart                  (3)  | Epoch:43 | Val Acc: 0.9342
 Best site-Clipart                  (3)  | Epoch:43 | Val Acc: 0.9346
 Best site-Clipart                  (3)  | Epoch:43 | Val Acc: 0.8933
 Best site-Clipart                  (3)  | Epoch:43 | Val Acc: 0.8571
 Best site-Clipart                  (3)  | Epoch:43 | Val Acc: 0.8847
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9437
 Best site-Painting                 (5)  | Epoch:43 | Val Acc: 0.9082
 Best site-Painting                 (5)  | Epoch:43 | Val Acc: 0.9416
 Best site-Painting                 (5)  | Epoch:43 | Val Acc: 0.9062
 Best site-Sketch                   (4)  | Epoch:43 | Val Acc: 0.8898
 Best site-Sketch                   (4)  | Epoch:43 | Val Acc: 0.8596
 Best site-QuickDraw                (1)  | Epoch:43 | Val Acc: 0.7706
 Best site-Infograph                (2)  | Epoch:43 | Val Acc: 0.6923
 Test site-Clipart                   (3)| Epoch:43 | Test Acc: 0.8878
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9466
 Test site-Painting                  (5)| Epoch:43 | Test Acc: 0.9257
 Test site-Sketch                    (4)| Epoch:43 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7530
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.5632
Clipart: 0.8878, Real: 0.9466, Painting: 0.9257, Sketch: 0.8881, QuickDraw: 0.7530, Infograph: 0.5632, 
Average Test Accuracy(group): 0.8274, Average Test Accuracy(individual): 0.8809,
domain std=0.1333, cluster std=0.1333, individual std=0.0939, 
Average Test Accuracy: 0.8274
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 44 ============
cnt=[4, 1, 1, 5, 2, 3, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (3) | Train Loss: 0.4158 | Train Acc: 0.8696
 Site-Clipart                   (3) | Train Loss: 0.2664 | Train Acc: 0.9317
 Site-Clipart                   (3) | Train Loss: 0.3965 | Train Acc: 0.8756
 Site-Clipart                   (3) | Train Loss: 0.3565 | Train Acc: 0.8861
 Site-Clipart                   (3) | Train Loss: 0.3367 | Train Acc: 0.9095
 Site-Real                      (0) | Train Loss: 0.3306 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.2153 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2065 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.2492 | Train Acc: 0.9511
 Site-Painting                  (5) | Train Loss: 0.2822 | Train Acc: 0.8980
 Site-Painting                  (5) | Train Loss: 0.3499 | Train Acc: 0.9126
 Site-Painting                  (5) | Train Loss: 0.3324 | Train Acc: 0.9135
 Site-Sketch                    (4) | Train Loss: 0.4039 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.4534 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.7425 | Train Acc: 0.8012
 Site-Infograph                 (2) | Train Loss: 0.8771 | Train Acc: 0.7436
Average Train Accuracy: 0.8885
 Site-Clipart                   (3) | Val  Loss: 0.2477 | Val  Acc: 0.9342
 Site-Clipart                   (3) | Val  Loss: 0.2789 | Val  Acc: 0.9346
 Site-Clipart                   (3) | Val  Loss: 0.3586 | Val  Acc: 0.8800
 Site-Clipart                   (3) | Val  Loss: 0.3461 | Val  Acc: 0.9000
 Site-Clipart                   (3) | Val  Loss: 0.4576 | Val  Acc: 0.8576
 Site-Real                      (0) | Val  Loss: 0.2272 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2532 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.2246 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2232 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2365 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2913 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.2899 | Val  Acc: 0.9323
 Site-Sketch                    (4) | Val  Loss: 0.3926 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.4968 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7706 | Val  Acc: 0.7798
 Site-Infograph                 (2) | Val  Loss: 0.9099 | Val  Acc: 0.7564
Average Valid Accuracy: 0.8950
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.9342
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.9346
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.8800
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.9000
 Best site-Clipart                  (3)  | Epoch:44 | Val Acc: 0.8576
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9237
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9394
 Best site-Real                     (0)  | Epoch:44 | Val Acc: 0.9524
 Best site-Painting                 (5)  | Epoch:44 | Val Acc: 0.9490
 Best site-Painting                 (5)  | Epoch:44 | Val Acc: 0.9270
 Best site-Painting                 (5)  | Epoch:44 | Val Acc: 0.9323
 Best site-Sketch                   (4)  | Epoch:44 | Val Acc: 0.8583
 Best site-Sketch                   (4)  | Epoch:44 | Val Acc: 0.8427
 Best site-QuickDraw                (1)  | Epoch:44 | Val Acc: 0.7798
 Best site-Infograph                (2)  | Epoch:44 | Val Acc: 0.7564
 Test site-Clipart                   (3)| Epoch:44 | Test Acc: 0.8802
 Test site-Real                      (0)| Epoch:44 | Test Acc: 0.9466
 Test site-Painting                  (5)| Epoch:44 | Test Acc: 0.9257
 Test site-Sketch                    (4)| Epoch:44 | Test Acc: 0.8953
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.7510
 Test site-Infograph                 (2)| Epoch:44 | Test Acc: 0.5601
Clipart: 0.8802, Real: 0.9466, Painting: 0.9257, Sketch: 0.8953, QuickDraw: 0.7510, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8265, Average Test Accuracy(individual): 0.8791,
domain std=0.1345, cluster std=0.1345, individual std=0.0947, 
Average Test Accuracy: 0.8265
============ Train epoch 45 ============
cnt=[4, 1, 1, 5, 2, 3, ]
cnt=[3, 1, 5, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (3) | Train Loss: 0.4066 | Train Acc: 0.8522
 Site-Clipart                   (3) | Train Loss: 0.2853 | Train Acc: 0.9130
 Site-Clipart                   (3) | Train Loss: 0.4073 | Train Acc: 0.8667
 Site-Clipart                   (3) | Train Loss: 0.3642 | Train Acc: 0.8987
 Site-Clipart                   (3) | Train Loss: 0.3311 | Train Acc: 0.9231
 Site-Real                      (5) | Train Loss: 0.3251 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2218 | Train Acc: 0.9605
 Site-Real                      (5) | Train Loss: 0.2242 | Train Acc: 0.9476
 Site-Real                      (5) | Train Loss: 0.2653 | Train Acc: 0.9569
 Site-Painting                  (0) | Train Loss: 0.3347 | Train Acc: 0.8912
 Site-Painting                  (0) | Train Loss: 0.3226 | Train Acc: 0.8883
 Site-Painting                  (0) | Train Loss: 0.3118 | Train Acc: 0.9273
 Site-Sketch                    (4) | Train Loss: 0.4097 | Train Acc: 0.8586
 Site-Sketch                    (4) | Train Loss: 0.4201 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.6984 | Train Acc: 0.7829
 Site-Infograph                 (2) | Train Loss: 0.8880 | Train Acc: 0.7308
Average Train Accuracy: 0.8852
 Site-Clipart                   (3) | Val  Loss: 0.2004 | Val  Acc: 0.9342
 Site-Clipart                   (3) | Val  Loss: 0.2990 | Val  Acc: 0.9252
 Site-Clipart                   (3) | Val  Loss: 0.3144 | Val  Acc: 0.9133
 Site-Clipart                   (3) | Val  Loss: 0.3474 | Val  Acc: 0.8905
 Site-Clipart                   (3) | Val  Loss: 0.4160 | Val  Acc: 0.8780
 Site-Real                      (5) | Val  Loss: 0.2232 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2727 | Val  Acc: 0.9153
 Site-Real                      (5) | Val  Loss: 0.2089 | Val  Acc: 0.9515
 Site-Real                      (5) | Val  Loss: 0.2187 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.2101 | Val  Acc: 0.9694
 Site-Painting                  (0) | Val  Loss: 0.3097 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3343 | Val  Acc: 0.9010
 Site-Sketch                    (4) | Val  Loss: 0.3924 | Val  Acc: 0.8661
 Site-Sketch                    (4) | Val  Loss: 0.4406 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.8065 | Val  Acc: 0.7523
 Site-Infograph                 (2) | Val  Loss: 0.9914 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8913
 Test site-Clipart                   (3)| Epoch:44 | Test Acc: 0.8859
 Test site-Real                      (5)| Epoch:44 | Test Acc: 0.9458
 Test site-Painting                  (0)| Epoch:44 | Test Acc: 0.9225
 Test site-Sketch                    (4)| Epoch:44 | Test Acc: 0.8899
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.7590
 Test site-Infograph                 (2)| Epoch:44 | Test Acc: 0.5647
Clipart: 0.8859, Real: 0.9458, Painting: 0.9225, Sketch: 0.8899, QuickDraw: 0.7590, Infograph: 0.5647, 
Average Test Accuracy(group): 0.8280, Average Test Accuracy(individual): 0.8802,
domain std=0.1317, cluster std=0.1324, individual std=0.0926, 
Average Test Accuracy: 0.8280
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_pcon...
============ Train epoch 46 ============
cnt=[5, 1, 1, 4, 2, 3, ]
cnt=[2, 5, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (0) | Train Loss: 0.3855 | Train Acc: 0.8783
 Site-Clipart                   (0) | Train Loss: 0.3061 | Train Acc: 0.8944
 Site-Clipart                   (0) | Train Loss: 0.4403 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3479 | Train Acc: 0.9082
 Site-Clipart                   (0) | Train Loss: 0.3431 | Train Acc: 0.9072
 Site-Real                      (3) | Train Loss: 0.3301 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.1913 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2052 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2435 | Train Acc: 0.9397
 Site-Painting                  (5) | Train Loss: 0.3341 | Train Acc: 0.9048
 Site-Painting                  (5) | Train Loss: 0.3519 | Train Acc: 0.8738
 Site-Painting                  (5) | Train Loss: 0.2655 | Train Acc: 0.9273
 Site-Sketch                    (4) | Train Loss: 0.4257 | Train Acc: 0.8901
 Site-Sketch                    (4) | Train Loss: 0.4498 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.6702 | Train Acc: 0.8226
 Site-Infograph                 (2) | Train Loss: 0.8880 | Train Acc: 0.7479
Average Train Accuracy: 0.8898
 Site-Clipart                   (0) | Val  Loss: 0.2339 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.2850 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.3307 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.3554 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.4375 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2354 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2677 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2053 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2026 | Val  Acc: 0.9654
 Site-Painting                  (5) | Val  Loss: 0.2035 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2707 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.3208 | Val  Acc: 0.9375
 Site-Sketch                    (4) | Val  Loss: 0.3661 | Val  Acc: 0.8819
 Site-Sketch                    (4) | Val  Loss: 0.4916 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.8237 | Val  Acc: 0.7661
 Site-Infograph                 (2) | Val  Loss: 0.9721 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8919
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.8878
 Test site-Real                      (3)| Epoch:45 | Test Acc: 0.9458
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9257
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7480
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.5601
Clipart: 0.8878, Real: 0.9458, Painting: 0.9257, Sketch: 0.8863, QuickDraw: 0.7480, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8256, Average Test Accuracy(individual): 0.8800,
domain std=0.1345, cluster std=0.1345, individual std=0.0948, 
Average Test Accuracy: 0.8256
============ Train epoch 47 ============
cnt=[1, 5, 1, 4, 2, 3, ]
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (1) | Train Loss: 0.3817 | Train Acc: 0.9043
 Site-Clipart                   (1) | Train Loss: 0.3000 | Train Acc: 0.9193
 Site-Clipart                   (1) | Train Loss: 0.4360 | Train Acc: 0.8978
 Site-Clipart                   (1) | Train Loss: 0.3468 | Train Acc: 0.8924
 Site-Clipart                   (1) | Train Loss: 0.3320 | Train Acc: 0.9095
 Site-Real                      (3) | Train Loss: 0.2956 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2091 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2084 | Train Acc: 0.9556
 Site-Real                      (3) | Train Loss: 0.2429 | Train Acc: 0.9425
 Site-Painting                  (5) | Train Loss: 0.3757 | Train Acc: 0.8980
 Site-Painting                  (5) | Train Loss: 0.4063 | Train Acc: 0.8689
 Site-Painting                  (5) | Train Loss: 0.3336 | Train Acc: 0.9170
 Site-Sketch                    (4) | Train Loss: 0.4311 | Train Acc: 0.8586
 Site-Sketch                    (4) | Train Loss: 0.4207 | Train Acc: 0.8539
 Site-QuickDraw                 (2) | Train Loss: 0.7465 | Train Acc: 0.8043
 Site-Infograph                 (0) | Train Loss: 0.8901 | Train Acc: 0.7393
Average Train Accuracy: 0.8898
 Site-Clipart                   (1) | Val  Loss: 0.2170 | Val  Acc: 0.9342
 Site-Clipart                   (1) | Val  Loss: 0.2570 | Val  Acc: 0.9346
 Site-Clipart                   (1) | Val  Loss: 0.3355 | Val  Acc: 0.8867
 Site-Clipart                   (1) | Val  Loss: 0.3095 | Val  Acc: 0.9048
 Site-Clipart                   (1) | Val  Loss: 0.4214 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2322 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2581 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2039 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2299 | Val  Acc: 0.9481
 Site-Painting                  (5) | Val  Loss: 0.2345 | Val  Acc: 0.9694
 Site-Painting                  (5) | Val  Loss: 0.2728 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.4036 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.4174 | Val  Acc: 0.8740
 Site-Sketch                    (4) | Val  Loss: 0.4700 | Val  Acc: 0.8427
 Site-QuickDraw                 (2) | Val  Loss: 0.7462 | Val  Acc: 0.8165
 Site-Infograph                 (0) | Val  Loss: 1.0259 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8908
 Test site-Clipart                   (1)| Epoch:45 | Test Acc: 0.8878
 Test site-Real                      (3)| Epoch:45 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9241
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8899
 Test site-QuickDraw                 (2)| Epoch:45 | Test Acc: 0.7470
 Test site-Infograph                 (0)| Epoch:45 | Test Acc: 0.5647
Clipart: 0.8878, Real: 0.9449, Painting: 0.9241, Sketch: 0.8899, QuickDraw: 0.7470, Infograph: 0.5647, 
Average Test Accuracy(group): 0.8264, Average Test Accuracy(individual): 0.8802,
domain std=0.1330, cluster std=0.1330, individual std=0.0936, 
Average Test Accuracy: 0.8264
============ Train epoch 48 ============
cnt=[5, 1, 1, 4, 2, 3, ]
cnt=[4, 5, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.4653 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.2567 | Train Acc: 0.9255
 Site-Clipart                   (0) | Train Loss: 0.4028 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3740 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.3141 | Train Acc: 0.9163
 Site-Real                      (5) | Train Loss: 0.3097 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2349 | Train Acc: 0.9435
 Site-Real                      (5) | Train Loss: 0.2252 | Train Acc: 0.9597
 Site-Real                      (5) | Train Loss: 0.2511 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.3148 | Train Acc: 0.8980
 Site-Painting                  (3) | Train Loss: 0.3324 | Train Acc: 0.8835
 Site-Painting                  (3) | Train Loss: 0.3430 | Train Acc: 0.9066
 Site-Sketch                    (4) | Train Loss: 0.4150 | Train Acc: 0.8534
 Site-Sketch                    (4) | Train Loss: 0.4252 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.6973 | Train Acc: 0.7951
 Site-Infograph                 (2) | Train Loss: 0.8930 | Train Acc: 0.7179
Average Train Accuracy: 0.8818
 Site-Clipart                   (0) | Val  Loss: 0.2135 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.2717 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.2970 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.3509 | Val  Acc: 0.9048
 Site-Clipart                   (0) | Val  Loss: 0.4298 | Val  Acc: 0.8712
 Site-Real                      (5) | Val  Loss: 0.2293 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2357 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.2022 | Val  Acc: 0.9515
 Site-Real                      (5) | Val  Loss: 0.2028 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.2462 | Val  Acc: 0.9694
 Site-Painting                  (3) | Val  Loss: 0.3191 | Val  Acc: 0.8978
 Site-Painting                  (3) | Val  Loss: 0.3549 | Val  Acc: 0.8906
 Site-Sketch                    (4) | Val  Loss: 0.3785 | Val  Acc: 0.8661
 Site-Sketch                    (4) | Val  Loss: 0.4700 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7935 | Val  Acc: 0.8028
 Site-Infograph                 (2) | Val  Loss: 1.0112 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8936
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.8897
 Test site-Real                      (5)| Epoch:45 | Test Acc: 0.9449
 Test site-Painting                  (3)| Epoch:45 | Test Acc: 0.9241
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7490
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.5571
Clipart: 0.8897, Real: 0.9449, Painting: 0.9241, Sketch: 0.8881, QuickDraw: 0.7490, Infograph: 0.5571, 
Average Test Accuracy(group): 0.8255, Average Test Accuracy(individual): 0.8802,
domain std=0.1354, cluster std=0.1360, individual std=0.0951, 
Average Test Accuracy: 0.8255
============ Train epoch 49 ============
cnt=[4, 1, 1, 5, 2, 3, ]
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (3) | Train Loss: 0.3689 | Train Acc: 0.8870
 Site-Clipart                   (3) | Train Loss: 0.2921 | Train Acc: 0.9317
 Site-Clipart                   (3) | Train Loss: 0.3883 | Train Acc: 0.8800
 Site-Clipart                   (3) | Train Loss: 0.3415 | Train Acc: 0.9019
 Site-Clipart                   (3) | Train Loss: 0.3281 | Train Acc: 0.9186
 Site-Real                      (0) | Train Loss: 0.3097 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2176 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2236 | Train Acc: 0.9355
 Site-Real                      (0) | Train Loss: 0.2531 | Train Acc: 0.9310
 Site-Painting                  (5) | Train Loss: 0.3725 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.2760 | Train Acc: 0.8981
 Site-Painting                  (5) | Train Loss: 0.3174 | Train Acc: 0.9239
 Site-Sketch                    (4) | Train Loss: 0.4283 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.4984 | Train Acc: 0.8727
 Site-QuickDraw                 (1) | Train Loss: 0.6415 | Train Acc: 0.8012
 Site-Infograph                 (2) | Train Loss: 0.8584 | Train Acc: 0.7692
Average Train Accuracy: 0.8899
 Site-Clipart                   (3) | Val  Loss: 0.2570 | Val  Acc: 0.9211
 Site-Clipart                   (3) | Val  Loss: 0.2916 | Val  Acc: 0.9065
 Site-Clipart                   (3) | Val  Loss: 0.3519 | Val  Acc: 0.8800
 Site-Clipart                   (3) | Val  Loss: 0.3372 | Val  Acc: 0.8905
 Site-Clipart                   (3) | Val  Loss: 0.4326 | Val  Acc: 0.8610
 Site-Real                      (0) | Val  Loss: 0.2342 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2628 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2230 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2157 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2066 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.3002 | Val  Acc: 0.9343
 Site-Painting                  (5) | Val  Loss: 0.3104 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.4129 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.4650 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7963 | Val  Acc: 0.7798
 Site-Infograph                 (2) | Val  Loss: 1.0466 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8858
 Test site-Clipart                   (3)| Epoch:45 | Test Acc: 0.8840
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9208
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8827
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7500
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.5616
Clipart: 0.8840, Real: 0.9441, Painting: 0.9208, Sketch: 0.8827, QuickDraw: 0.7500, Infograph: 0.5616, 
Average Test Accuracy(group): 0.8239, Average Test Accuracy(individual): 0.8773,
domain std=0.1324, cluster std=0.1324, individual std=0.0934, 
Average Test Accuracy: 0.8239
 Test site-Clipart                   (3)| Epoch:45 | Test Acc: 0.8840
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9208
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8827
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7500
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.5616
Clipart: 0.8840, Real: 0.9441, Painting: 0.9208, Sketch: 0.8827, QuickDraw: 0.7500, Infograph: 0.5616, 
Average Test Accuracy(group): 0.8239, Average Test Accuracy(individual): 0.8773,
domain std=0.1324, cluster std=0.1324, individual std=0.0934, 
===2023-06-26 05:30:16===
===2023-06-26 05:30:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (3)| Epoch:45 | Test Acc: 0.8859
 Test site-Real                      (5)| Epoch:45 | Test Acc: 0.9458
 Test site-Painting                  (0)| Epoch:45 | Test Acc: 0.9225
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8899
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7590
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.5647
Clipart: 0.8859, Real: 0.9458, Painting: 0.9225, Sketch: 0.8899, QuickDraw: 0.7590, Infograph: 0.5647, 
Average Test Accuracy(group): 0.8280, Average Test Accuracy(individual): 0.8802,
domain std=0.1317, cluster std=0.1324, individual std=0.0926, 
