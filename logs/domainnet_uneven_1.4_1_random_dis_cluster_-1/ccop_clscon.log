===2023-06-25 16:25:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9713 | Train Acc: 0.3826
 Site-Clipart                   (0) | Train Loss: 1.8921 | Train Acc: 0.5280
 Site-Clipart                   (0) | Train Loss: 1.9593 | Train Acc: 0.4356
 Site-Clipart                   (0) | Train Loss: 1.9197 | Train Acc: 0.4747
 Site-Clipart                   (0) | Train Loss: 1.9253 | Train Acc: 0.4706
 Site-Real                      (1) | Train Loss: 1.8506 | Train Acc: 0.5397
 Site-Real                      (1) | Train Loss: 1.8393 | Train Acc: 0.5650
 Site-Real                      (1) | Train Loss: 1.7489 | Train Acc: 0.6694
 Site-Real                      (1) | Train Loss: 1.8380 | Train Acc: 0.5718
 Site-Painting                  (3) | Train Loss: 1.8676 | Train Acc: 0.5714
 Site-Painting                  (3) | Train Loss: 1.8978 | Train Acc: 0.4951
 Site-Painting                  (3) | Train Loss: 1.8278 | Train Acc: 0.5294
 Site-Sketch                    (5) | Train Loss: 1.9030 | Train Acc: 0.5183
 Site-Sketch                    (5) | Train Loss: 1.9004 | Train Acc: 0.4794
 Site-QuickDraw                 (2) | Train Loss: 2.2887 | Train Acc: 0.2110
 Site-Infograph                 (4) | Train Loss: 2.1232 | Train Acc: 0.3248
Average Train Accuracy: 0.4854
 Site-Clipart                   (0) | Val  Loss: 1.8428 | Val  Acc: 0.4605
 Site-Clipart                   (0) | Val  Loss: 1.9054 | Val  Acc: 0.4766
 Site-Clipart                   (0) | Val  Loss: 1.9243 | Val  Acc: 0.4867
 Site-Clipart                   (0) | Val  Loss: 1.9198 | Val  Acc: 0.4476
 Site-Clipart                   (0) | Val  Loss: 1.9588 | Val  Acc: 0.4169
 Site-Real                      (1) | Val  Loss: 1.7831 | Val  Acc: 0.5238
 Site-Real                      (1) | Val  Loss: 1.7804 | Val  Acc: 0.6186
 Site-Real                      (1) | Val  Loss: 1.7215 | Val  Acc: 0.7030
 Site-Real                      (1) | Val  Loss: 1.7623 | Val  Acc: 0.6320
 Site-Painting                  (3) | Val  Loss: 1.8176 | Val  Acc: 0.5000
 Site-Painting                  (3) | Val  Loss: 1.7870 | Val  Acc: 0.5036
 Site-Painting                  (3) | Val  Loss: 1.8782 | Val  Acc: 0.5104
 Site-Sketch                    (5) | Val  Loss: 1.8812 | Val  Acc: 0.5039
 Site-Sketch                    (5) | Val  Loss: 1.9038 | Val  Acc: 0.4775
 Site-QuickDraw                 (2) | Val  Loss: 2.2838 | Val  Acc: 0.1881
 Site-Infograph                 (4) | Val  Loss: 2.1075 | Val  Acc: 0.2821
Average Valid Accuracy: 0.4832
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4605
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4766
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4867
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4476
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4169
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.5238
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6186
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.7030
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6320
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5000
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5036
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5104
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5039
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4775
 Best site-QuickDraw                (2)  | Epoch:1 | Val Acc: 0.1881
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.7678 | Train Acc: 0.5826
 Site-Clipart                   (0) | Train Loss: 1.6916 | Train Acc: 0.6211
 Site-Clipart                   (0) | Train Loss: 1.7987 | Train Acc: 0.5378
 Site-Clipart                   (0) | Train Loss: 1.7295 | Train Acc: 0.5601
 Site-Clipart                   (0) | Train Loss: 1.7517 | Train Acc: 0.5792
 Site-Real                      (1) | Train Loss: 1.6031 | Train Acc: 0.6667
 Site-Real                      (1) | Train Loss: 1.5730 | Train Acc: 0.6949
 Site-Real                      (1) | Train Loss: 1.4972 | Train Acc: 0.7984
 Site-Real                      (1) | Train Loss: 1.6215 | Train Acc: 0.7069
 Site-Painting                  (3) | Train Loss: 1.6430 | Train Acc: 0.6259
 Site-Painting                  (3) | Train Loss: 1.7215 | Train Acc: 0.5583
 Site-Painting                  (3) | Train Loss: 1.6782 | Train Acc: 0.6194
 Site-Sketch                    (5) | Train Loss: 1.7145 | Train Acc: 0.6283
 Site-Sketch                    (5) | Train Loss: 1.7182 | Train Acc: 0.5805
 Site-QuickDraw                 (2) | Train Loss: 2.2169 | Train Acc: 0.2385
 Site-Infograph                 (4) | Train Loss: 2.1202 | Train Acc: 0.3248
Average Train Accuracy: 0.5827
 Site-Clipart                   (0) | Val  Loss: 1.6020 | Val  Acc: 0.6053
 Site-Clipart                   (0) | Val  Loss: 1.7219 | Val  Acc: 0.5794
 Site-Clipart                   (0) | Val  Loss: 1.7558 | Val  Acc: 0.6200
 Site-Clipart                   (0) | Val  Loss: 1.7045 | Val  Acc: 0.5810
 Site-Clipart                   (0) | Val  Loss: 1.7796 | Val  Acc: 0.5390
 Site-Real                      (1) | Val  Loss: 1.5140 | Val  Acc: 0.6905
 Site-Real                      (1) | Val  Loss: 1.5485 | Val  Acc: 0.7712
 Site-Real                      (1) | Val  Loss: 1.4959 | Val  Acc: 0.8000
 Site-Real                      (1) | Val  Loss: 1.5418 | Val  Acc: 0.7576
 Site-Painting                  (3) | Val  Loss: 1.5977 | Val  Acc: 0.6939
 Site-Painting                  (3) | Val  Loss: 1.5970 | Val  Acc: 0.5912
 Site-Painting                  (3) | Val  Loss: 1.6988 | Val  Acc: 0.5573
 Site-Sketch                    (5) | Val  Loss: 1.7181 | Val  Acc: 0.6142
 Site-Sketch                    (5) | Val  Loss: 1.7512 | Val  Acc: 0.5281
 Site-QuickDraw                 (2) | Val  Loss: 2.2259 | Val  Acc: 0.2431
 Site-Infograph                 (4) | Val  Loss: 2.0824 | Val  Acc: 0.3141
Average Valid Accuracy: 0.5929
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6053
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5794
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6200
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5810
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5390
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.6905
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7712
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.8000
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7576
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.6939
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.5912
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.5573
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.6142
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5281
 Best site-QuickDraw                (2)  | Epoch:2 | Val Acc: 0.2431
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.3141
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.6026 | Train Acc: 0.6348
 Site-Clipart                   (0) | Train Loss: 1.5139 | Train Acc: 0.6770
 Site-Clipart                   (0) | Train Loss: 1.6515 | Train Acc: 0.6311
 Site-Clipart                   (0) | Train Loss: 1.5504 | Train Acc: 0.7025
 Site-Clipart                   (0) | Train Loss: 1.5889 | Train Acc: 0.6516
 Site-Real                      (1) | Train Loss: 1.4403 | Train Acc: 0.8175
 Site-Real                      (1) | Train Loss: 1.3460 | Train Acc: 0.8531
 Site-Real                      (1) | Train Loss: 1.3191 | Train Acc: 0.8347
 Site-Real                      (1) | Train Loss: 1.4092 | Train Acc: 0.8362
 Site-Painting                  (3) | Train Loss: 1.4899 | Train Acc: 0.6803
 Site-Painting                  (3) | Train Loss: 1.5256 | Train Acc: 0.7087
 Site-Painting                  (3) | Train Loss: 1.5082 | Train Acc: 0.6782
 Site-Sketch                    (5) | Train Loss: 1.4975 | Train Acc: 0.7435
 Site-Sketch                    (5) | Train Loss: 1.6031 | Train Acc: 0.6554
 Site-QuickDraw                 (2) | Train Loss: 2.1396 | Train Acc: 0.2416
 Site-Infograph                 (4) | Train Loss: 2.0487 | Train Acc: 0.3632
Average Train Accuracy: 0.6693
 Site-Clipart                   (0) | Val  Loss: 1.4361 | Val  Acc: 0.6579
 Site-Clipart                   (0) | Val  Loss: 1.5221 | Val  Acc: 0.6822
 Site-Clipart                   (0) | Val  Loss: 1.5656 | Val  Acc: 0.6733
 Site-Clipart                   (0) | Val  Loss: 1.5147 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 1.6335 | Val  Acc: 0.6136
 Site-Real                      (1) | Val  Loss: 1.3281 | Val  Acc: 0.8452
 Site-Real                      (1) | Val  Loss: 1.3664 | Val  Acc: 0.8475
 Site-Real                      (1) | Val  Loss: 1.2903 | Val  Acc: 0.8424
 Site-Real                      (1) | Val  Loss: 1.3517 | Val  Acc: 0.8528
 Site-Painting                  (3) | Val  Loss: 1.4484 | Val  Acc: 0.7551
 Site-Painting                  (3) | Val  Loss: 1.4369 | Val  Acc: 0.6496
 Site-Painting                  (3) | Val  Loss: 1.5098 | Val  Acc: 0.6875
 Site-Sketch                    (5) | Val  Loss: 1.5652 | Val  Acc: 0.6457
 Site-Sketch                    (5) | Val  Loss: 1.5881 | Val  Acc: 0.6124
 Site-QuickDraw                 (2) | Val  Loss: 2.1706 | Val  Acc: 0.2569
 Site-Infograph                 (4) | Val  Loss: 1.9853 | Val  Acc: 0.3718
Average Valid Accuracy: 0.6663
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6579
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6822
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6733
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6136
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8452
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8475
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8424
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8528
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7551
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6496
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6875
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6457
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6124
 Best site-QuickDraw                (2)  | Epoch:3 | Val Acc: 0.2569
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.3718
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 3, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.4594 | Train Acc: 0.6870
 Site-Clipart                   (0) | Train Loss: 1.4670 | Train Acc: 0.6522
 Site-Clipart                   (0) | Train Loss: 1.5452 | Train Acc: 0.6533
 Site-Clipart                   (0) | Train Loss: 1.4688 | Train Acc: 0.6677
 Site-Clipart                   (0) | Train Loss: 1.5278 | Train Acc: 0.6448
 Site-Real                      (4) | Train Loss: 1.3223 | Train Acc: 0.8571
 Site-Real                      (4) | Train Loss: 1.2130 | Train Acc: 0.8588
 Site-Real                      (4) | Train Loss: 1.2011 | Train Acc: 0.8669
 Site-Real                      (4) | Train Loss: 1.3401 | Train Acc: 0.8276
 Site-Painting                  (1) | Train Loss: 1.3124 | Train Acc: 0.7347
 Site-Painting                  (1) | Train Loss: 1.3754 | Train Acc: 0.6748
 Site-Painting                  (1) | Train Loss: 1.3481 | Train Acc: 0.7301
 Site-Sketch                    (5) | Train Loss: 1.4513 | Train Acc: 0.6859
 Site-Sketch                    (5) | Train Loss: 1.5874 | Train Acc: 0.6629
 Site-QuickDraw                 (2) | Train Loss: 2.0900 | Train Acc: 0.2875
 Site-Infograph                 (3) | Train Loss: 2.0283 | Train Acc: 0.3419
Average Train Accuracy: 0.6771
 Site-Clipart                   (0) | Val  Loss: 1.3386 | Val  Acc: 0.6842
 Site-Clipart                   (0) | Val  Loss: 1.4237 | Val  Acc: 0.7196
 Site-Clipart                   (0) | Val  Loss: 1.4804 | Val  Acc: 0.6733
 Site-Clipart                   (0) | Val  Loss: 1.4343 | Val  Acc: 0.6810
 Site-Clipart                   (0) | Val  Loss: 1.5468 | Val  Acc: 0.6339
 Site-Real                      (4) | Val  Loss: 1.2431 | Val  Acc: 0.8690
 Site-Real                      (4) | Val  Loss: 1.2760 | Val  Acc: 0.7881
 Site-Real                      (4) | Val  Loss: 1.1871 | Val  Acc: 0.8909
 Site-Real                      (4) | Val  Loss: 1.2091 | Val  Acc: 0.8398
 Site-Painting                  (1) | Val  Loss: 1.2462 | Val  Acc: 0.8367
 Site-Painting                  (1) | Val  Loss: 1.3228 | Val  Acc: 0.7299
 Site-Painting                  (1) | Val  Loss: 1.3864 | Val  Acc: 0.7188
 Site-Sketch                    (5) | Val  Loss: 1.4178 | Val  Acc: 0.7323
 Site-Sketch                    (5) | Val  Loss: 1.5066 | Val  Acc: 0.6854
 Site-QuickDraw                 (2) | Val  Loss: 2.1305 | Val  Acc: 0.2844
 Site-Infograph                 (3) | Val  Loss: 1.9730 | Val  Acc: 0.3782
Average Valid Accuracy: 0.6966
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6842
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7196
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6733
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6810
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6339
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8690
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.7881
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8909
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8398
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.8367
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7299
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7188
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.7323
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6854
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.2844
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.3782
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 3, 1, 5, 1, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 1.4192 | Train Acc: 0.7130
 Site-Clipart                   (3) | Train Loss: 1.3495 | Train Acc: 0.6832
 Site-Clipart                   (3) | Train Loss: 1.4784 | Train Acc: 0.6844
 Site-Clipart                   (3) | Train Loss: 1.3897 | Train Acc: 0.7089
 Site-Clipart                   (3) | Train Loss: 1.4533 | Train Acc: 0.6810
 Site-Real                      (5) | Train Loss: 1.2519 | Train Acc: 0.8492
 Site-Real                      (5) | Train Loss: 1.1187 | Train Acc: 0.8531
 Site-Real                      (5) | Train Loss: 1.1228 | Train Acc: 0.8669
 Site-Real                      (5) | Train Loss: 1.2670 | Train Acc: 0.8448
 Site-Painting                  (1) | Train Loss: 1.4536 | Train Acc: 0.7075
 Site-Painting                  (1) | Train Loss: 1.3632 | Train Acc: 0.7379
 Site-Painting                  (1) | Train Loss: 1.3019 | Train Acc: 0.7509
 Site-Sketch                    (0) | Train Loss: 1.3341 | Train Acc: 0.7592
 Site-Sketch                    (0) | Train Loss: 1.4928 | Train Acc: 0.6779
 Site-QuickDraw                 (2) | Train Loss: 2.0663 | Train Acc: 0.2630
 Site-Infograph                 (4) | Train Loss: 1.9598 | Train Acc: 0.3675
Average Train Accuracy: 0.6968
 Site-Clipart                   (3) | Val  Loss: 1.2899 | Val  Acc: 0.7237
 Site-Clipart                   (3) | Val  Loss: 1.3636 | Val  Acc: 0.7383
 Site-Clipart                   (3) | Val  Loss: 1.3848 | Val  Acc: 0.7067
 Site-Clipart                   (3) | Val  Loss: 1.3550 | Val  Acc: 0.6714
 Site-Clipart                   (3) | Val  Loss: 1.4575 | Val  Acc: 0.6576
 Site-Real                      (5) | Val  Loss: 1.1594 | Val  Acc: 0.8571
 Site-Real                      (5) | Val  Loss: 1.2064 | Val  Acc: 0.8559
 Site-Real                      (5) | Val  Loss: 1.1098 | Val  Acc: 0.8485
 Site-Real                      (5) | Val  Loss: 1.1365 | Val  Acc: 0.8658
 Site-Painting                  (1) | Val  Loss: 1.1944 | Val  Acc: 0.8367
 Site-Painting                  (1) | Val  Loss: 1.2705 | Val  Acc: 0.7518
 Site-Painting                  (1) | Val  Loss: 1.2951 | Val  Acc: 0.7552
 Site-Sketch                    (0) | Val  Loss: 1.4326 | Val  Acc: 0.6535
 Site-Sketch                    (0) | Val  Loss: 1.4471 | Val  Acc: 0.6517
 Site-QuickDraw                 (2) | Val  Loss: 2.1047 | Val  Acc: 0.2844
 Site-Infograph                 (4) | Val  Loss: 1.9222 | Val  Acc: 0.3526
Average Valid Accuracy: 0.7007
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7237
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7383
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7067
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.6714
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.6576
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8571
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8559
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8485
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8658
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.8367
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.7518
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.7552
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.6535
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.6517
 Best site-QuickDraw                (2)  | Epoch:5 | Val Acc: 0.2844
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.3526
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 6 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (0) | Train Loss: 1.2979 | Train Acc: 0.7391
 Site-Clipart                   (0) | Train Loss: 1.2016 | Train Acc: 0.7516
 Site-Clipart                   (0) | Train Loss: 1.3080 | Train Acc: 0.7644
 Site-Clipart                   (0) | Train Loss: 1.2251 | Train Acc: 0.7785
 Site-Clipart                   (0) | Train Loss: 1.2861 | Train Acc: 0.7398
 Site-Real                      (3) | Train Loss: 1.0980 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 1.0000 | Train Acc: 0.8814
 Site-Real                      (3) | Train Loss: 0.9759 | Train Acc: 0.8952
 Site-Real                      (3) | Train Loss: 1.0843 | Train Acc: 0.8879
 Site-Painting                  (1) | Train Loss: 1.2439 | Train Acc: 0.7891
 Site-Painting                  (1) | Train Loss: 1.2061 | Train Acc: 0.7621
 Site-Painting                  (1) | Train Loss: 1.1624 | Train Acc: 0.7785
 Site-Sketch                    (5) | Train Loss: 1.2455 | Train Acc: 0.7592
===2023-06-25 17:13:25===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9677 | Train Acc: 0.4000
 Site-Clipart                   (0) | Train Loss: 1.8876 | Train Acc: 0.5652
 Site-Clipart                   (0) | Train Loss: 1.9552 | Train Acc: 0.4578
 Site-Clipart                   (0) | Train Loss: 1.9152 | Train Acc: 0.5032
 Site-Clipart                   (0) | Train Loss: 1.9241 | Train Acc: 0.4955
 Site-Real                      (1) | Train Loss: 1.8430 | Train Acc: 0.5635
 Site-Real                      (1) | Train Loss: 1.8285 | Train Acc: 0.6045
 Site-Real                      (1) | Train Loss: 1.7412 | Train Acc: 0.6774
 Site-Real                      (1) | Train Loss: 1.8387 | Train Acc: 0.5920
 Site-Painting                  (3) | Train Loss: 1.8635 | Train Acc: 0.5646
 Site-Painting                  (3) | Train Loss: 1.8940 | Train Acc: 0.4903
 Site-Painting                  (3) | Train Loss: 1.8257 | Train Acc: 0.5502
 Site-Sketch                    (5) | Train Loss: 1.8973 | Train Acc: 0.5236
 Site-Sketch                    (5) | Train Loss: 1.8964 | Train Acc: 0.4869
 Site-QuickDraw                 (2) | Train Loss: 2.2847 | Train Acc: 0.1774
 Site-Infograph                 (4) | Train Loss: 2.1139 | Train Acc: 0.3291
Average Train Accuracy: 0.4988
 Site-Clipart                   (0) | Val  Loss: 1.8421 | Val  Acc: 0.4868
 Site-Clipart                   (0) | Val  Loss: 1.8988 | Val  Acc: 0.4860
 Site-Clipart                   (0) | Val  Loss: 1.9235 | Val  Acc: 0.5133
 Site-Clipart                   (0) | Val  Loss: 1.9186 | Val  Acc: 0.4810
 Site-Clipart                   (0) | Val  Loss: 1.9547 | Val  Acc: 0.4373
 Site-Real                      (1) | Val  Loss: 1.7841 | Val  Acc: 0.5595
 Site-Real                      (1) | Val  Loss: 1.7761 | Val  Acc: 0.6780
 Site-Real                      (1) | Val  Loss: 1.7139 | Val  Acc: 0.6970
 Site-Real                      (1) | Val  Loss: 1.7579 | Val  Acc: 0.6667
 Site-Painting                  (3) | Val  Loss: 1.8183 | Val  Acc: 0.5408
 Site-Painting                  (3) | Val  Loss: 1.7872 | Val  Acc: 0.5036
 Site-Painting                  (3) | Val  Loss: 1.8778 | Val  Acc: 0.5156
 Site-Sketch                    (5) | Val  Loss: 1.8753 | Val  Acc: 0.5118
 Site-Sketch                    (5) | Val  Loss: 1.8963 | Val  Acc: 0.5000
 Site-QuickDraw                 (2) | Val  Loss: 2.2776 | Val  Acc: 0.1789
 Site-Infograph                 (4) | Val  Loss: 2.1095 | Val  Acc: 0.3141
Average Valid Accuracy: 0.5044
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4868
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4860
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5133
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4810
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4373
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.5595
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6780
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6970
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6667
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5408
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5036
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5156
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5118
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5000
 Best site-QuickDraw                (2)  | Epoch:1 | Val Acc: 0.1789
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.3141
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.7695 | Train Acc: 0.5739
 Site-Clipart                   (0) | Train Loss: 1.6824 | Train Acc: 0.6087
 Site-Clipart                   (0) | Train Loss: 1.7971 | Train Acc: 0.5511
 Site-Clipart                   (0) | Train Loss: 1.7245 | Train Acc: 0.5570
 Site-Clipart                   (0) | Train Loss: 1.7541 | Train Acc: 0.5860
 Site-Real                      (1) | Train Loss: 1.5871 | Train Acc: 0.7540
 Site-Real                      (1) | Train Loss: 1.5576 | Train Acc: 0.7175
 Site-Real                      (1) | Train Loss: 1.4853 | Train Acc: 0.8185
 Site-Real                      (1) | Train Loss: 1.6139 | Train Acc: 0.7241
 Site-Painting                  (3) | Train Loss: 1.6386 | Train Acc: 0.6122
 Site-Painting                  (3) | Train Loss: 1.7096 | Train Acc: 0.5777
 Site-Painting                  (3) | Train Loss: 1.6712 | Train Acc: 0.6090
 Site-Sketch                    (5) | Train Loss: 1.7113 | Train Acc: 0.6230
 Site-Sketch                    (5) | Train Loss: 1.7106 | Train Acc: 0.5805
 Site-QuickDraw                 (2) | Train Loss: 2.2111 | Train Acc: 0.2691
 Site-Infograph                 (4) | Train Loss: 2.1139 | Train Acc: 0.3333
Average Train Accuracy: 0.5935
 Site-Clipart                   (0) | Val  Loss: 1.6093 | Val  Acc: 0.5658
 Site-Clipart                   (0) | Val  Loss: 1.7227 | Val  Acc: 0.5701
 Site-Clipart                   (0) | Val  Loss: 1.7499 | Val  Acc: 0.6067
 Site-Clipart                   (0) | Val  Loss: 1.7015 | Val  Acc: 0.5762
 Site-Clipart                   (0) | Val  Loss: 1.7787 | Val  Acc: 0.5390
 Site-Real                      (1) | Val  Loss: 1.5162 | Val  Acc: 0.7262
 Site-Real                      (1) | Val  Loss: 1.5395 | Val  Acc: 0.7627
 Site-Real                      (1) | Val  Loss: 1.4840 | Val  Acc: 0.8061
 Site-Real                      (1) | Val  Loss: 1.5308 | Val  Acc: 0.7792
 Site-Painting                  (3) | Val  Loss: 1.5901 | Val  Acc: 0.7041
 Site-Painting                  (3) | Val  Loss: 1.5970 | Val  Acc: 0.5985
 Site-Painting                  (3) | Val  Loss: 1.6909 | Val  Acc: 0.5677
 Site-Sketch                    (5) | Val  Loss: 1.7058 | Val  Acc: 0.6378
 Site-Sketch                    (5) | Val  Loss: 1.7460 | Val  Acc: 0.5393
 Site-QuickDraw                 (2) | Val  Loss: 2.2207 | Val  Acc: 0.2477
 Site-Infograph                 (4) | Val  Loss: 2.0807 | Val  Acc: 0.3333
Average Valid Accuracy: 0.5975
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5658
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5701
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6067
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5762
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5390
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7262
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7627
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.8061
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7792
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.7041
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.5985
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.5677
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.6378
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5393
 Best site-QuickDraw                (2)  | Epoch:2 | Val Acc: 0.2477
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.6054 | Train Acc: 0.6348
 Site-Clipart                   (0) | Train Loss: 1.5013 | Train Acc: 0.6894
 Site-Clipart                   (0) | Train Loss: 1.6443 | Train Acc: 0.6267
 Site-Clipart                   (0) | Train Loss: 1.5455 | Train Acc: 0.6772
 Site-Clipart                   (0) | Train Loss: 1.5890 | Train Acc: 0.6448
 Site-Real                      (1) | Train Loss: 1.4223 | Train Acc: 0.8254
 Site-Real                      (1) | Train Loss: 1.3259 | Train Acc: 0.8475
 Site-Real                      (1) | Train Loss: 1.2980 | Train Acc: 0.8427
 Site-Real                      (1) | Train Loss: 1.3916 | Train Acc: 0.8333
 Site-Painting                  (3) | Train Loss: 1.4717 | Train Acc: 0.7143
 Site-Painting                  (3) | Train Loss: 1.5108 | Train Acc: 0.7087
 Site-Painting                  (3) | Train Loss: 1.4911 | Train Acc: 0.6817
 Site-Sketch                    (5) | Train Loss: 1.4929 | Train Acc: 0.7330
 Site-Sketch                    (5) | Train Loss: 1.5800 | Train Acc: 0.6704
 Site-QuickDraw                 (2) | Train Loss: 2.1309 | Train Acc: 0.2569
 Site-Infograph                 (4) | Train Loss: 2.0366 | Train Acc: 0.3632
Average Train Accuracy: 0.6719
 Site-Clipart                   (0) | Val  Loss: 1.4506 | Val  Acc: 0.6579
 Site-Clipart                   (0) | Val  Loss: 1.5176 | Val  Acc: 0.6542
 Site-Clipart                   (0) | Val  Loss: 1.5583 | Val  Acc: 0.6533
 Site-Clipart                   (0) | Val  Loss: 1.5069 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 1.6290 | Val  Acc: 0.6068
 Site-Real                      (1) | Val  Loss: 1.3176 | Val  Acc: 0.8095
 Site-Real                      (1) | Val  Loss: 1.3578 | Val  Acc: 0.8136
 Site-Real                      (1) | Val  Loss: 1.2733 | Val  Acc: 0.8606
 Site-Real                      (1) | Val  Loss: 1.3316 | Val  Acc: 0.8442
 Site-Painting                  (3) | Val  Loss: 1.4314 | Val  Acc: 0.7449
 Site-Painting                  (3) | Val  Loss: 1.4183 | Val  Acc: 0.6642
 Site-Painting                  (3) | Val  Loss: 1.4913 | Val  Acc: 0.6771
 Site-Sketch                    (5) | Val  Loss: 1.5483 | Val  Acc: 0.6614
 Site-Sketch                    (5) | Val  Loss: 1.5798 | Val  Acc: 0.6124
 Site-QuickDraw                 (2) | Val  Loss: 2.1654 | Val  Acc: 0.2615
 Site-Infograph                 (4) | Val  Loss: 1.9674 | Val  Acc: 0.3974
Average Valid Accuracy: 0.6616
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6579
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6542
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6533
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6068
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8095
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8136
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8606
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8442
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7449
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6642
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6771
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6614
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6124
 Best site-QuickDraw                (2)  | Epoch:3 | Val Acc: 0.2615
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.3974
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 3, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.3984 | Train Acc: 0.6957
 Site-Clipart                   (0) | Train Loss: 1.3759 | Train Acc: 0.7019
 Site-Clipart                   (0) | Train Loss: 1.4754 | Train Acc: 0.6756
 Site-Clipart                   (0) | Train Loss: 1.3833 | Train Acc: 0.7310
 Site-Clipart                   (0) | Train Loss: 1.4289 | Train Acc: 0.7240
 Site-Real                      (4) | Train Loss: 1.2606 | Train Acc: 0.8492
 Site-Real                      (4) | Train Loss: 1.1772 | Train Acc: 0.8475
 Site-Real                      (4) | Train Loss: 1.1257 | Train Acc: 0.8750
 Site-Real                      (4) | Train Loss: 1.2720 | Train Acc: 0.8218
 Site-Painting                  (1) | Train Loss: 1.2812 | Train Acc: 0.7211
 Site-Painting                  (1) | Train Loss: 1.3486 | Train Acc: 0.7039
 Site-Painting                  (1) | Train Loss: 1.3280 | Train Acc: 0.7197
 Site-Sketch                    (5) | Train Loss: 1.3753 | Train Acc: 0.6806
 Site-Sketch                    (5) | Train Loss: 1.4733 | Train Acc: 0.6667
 Site-QuickDraw                 (2) | Train Loss: 2.0489 | Train Acc: 0.2813
 Site-Infograph                 (3) | Train Loss: 1.9574 | Train Acc: 0.3761
Average Train Accuracy: 0.6919
 Site-Clipart                   (0) | Val  Loss: 1.2442 | Val  Acc: 0.7500
 Site-Clipart                   (0) | Val  Loss: 1.3502 | Val  Acc: 0.7570
 Site-Clipart                   (0) | Val  Loss: 1.3926 | Val  Acc: 0.7067
 Site-Clipart                   (0) | Val  Loss: 1.3472 | Val  Acc: 0.7000
 Site-Clipart                   (0) | Val  Loss: 1.4768 | Val  Acc: 0.6644
 Site-Real                      (4) | Val  Loss: 1.1572 | Val  Acc: 0.8571
 Site-Real                      (4) | Val  Loss: 1.1851 | Val  Acc: 0.8136
 Site-Real                      (4) | Val  Loss: 1.1165 | Val  Acc: 0.8727
 Site-Real                      (4) | Val  Loss: 1.1536 | Val  Acc: 0.8398
 Site-Painting                  (1) | Val  Loss: 1.2253 | Val  Acc: 0.8163
 Site-Painting                  (1) | Val  Loss: 1.2934 | Val  Acc: 0.7299
 Site-Painting                  (1) | Val  Loss: 1.3579 | Val  Acc: 0.7292
 Site-Sketch                    (5) | Val  Loss: 1.3199 | Val  Acc: 0.7874
 Site-Sketch                    (5) | Val  Loss: 1.4098 | Val  Acc: 0.6910
 Site-QuickDraw                 (2) | Val  Loss: 2.0961 | Val  Acc: 0.2890
 Site-Infograph                 (3) | Val  Loss: 1.9361 | Val  Acc: 0.4359
Average Valid Accuracy: 0.7150
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7570
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7067
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7000
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6644
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8571
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8136
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8727
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8398
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.8163
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7299
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7292
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.7874
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6910
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.2890
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 4, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 1.3116 | Train Acc: 0.7304
 Site-Clipart                   (3) | Train Loss: 1.2158 | Train Acc: 0.6957
 Site-Clipart                   (3) | Train Loss: 1.3715 | Train Acc: 0.6800
 Site-Clipart                   (3) | Train Loss: 1.2369 | Train Acc: 0.7373
 Site-Clipart                   (3) | Train Loss: 1.2906 | Train Acc: 0.7398
 Site-Real                      (2) | Train Loss: 1.1202 | Train Acc: 0.8651
 Site-Real                      (2) | Train Loss: 1.0160 | Train Acc: 0.8588
 Site-Real                      (2) | Train Loss: 0.9788 | Train Acc: 0.8871
 Site-Real                      (2) | Train Loss: 1.1168 | Train Acc: 0.8621
 Site-Painting                  (5) | Train Loss: 1.3274 | Train Acc: 0.7687
 Site-Painting                  (5) | Train Loss: 1.2407 | Train Acc: 0.7427
 Site-Painting                  (5) | Train Loss: 1.1867 | Train Acc: 0.7716
 Site-Sketch                    (0) | Train Loss: 1.2134 | Train Acc: 0.7487
 Site-Sketch                    (0) | Train Loss: 1.3370 | Train Acc: 0.6966
 Site-QuickDraw                 (1) | Train Loss: 2.0403 | Train Acc: 0.3058
 Site-Infograph                 (4) | Train Loss: 1.8839 | Train Acc: 0.3889
Average Train Accuracy: 0.7175
 Site-Clipart                   (3) | Val  Loss: 1.1418 | Val  Acc: 0.7500
 Site-Clipart                   (3) | Val  Loss: 1.2232 | Val  Acc: 0.8131
 Site-Clipart                   (3) | Val  Loss: 1.2361 | Val  Acc: 0.7733
 Site-Clipart                   (3) | Val  Loss: 1.2238 | Val  Acc: 0.7524
 Site-Clipart                   (3) | Val  Loss: 1.3287 | Val  Acc: 0.6847
 Site-Real                      (2) | Val  Loss: 1.0198 | Val  Acc: 0.8690
 Site-Real                      (2) | Val  Loss: 1.0455 | Val  Acc: 0.8559
 Site-Real                      (2) | Val  Loss: 0.9646 | Val  Acc: 0.8788
 Site-Real                      (2) | Val  Loss: 1.0127 | Val  Acc: 0.8918
 Site-Painting                  (5) | Val  Loss: 1.0755 | Val  Acc: 0.8469
 Site-Painting                  (5) | Val  Loss: 1.1299 | Val  Acc: 0.7737
 Site-Painting                  (5) | Val  Loss: 1.1821 | Val  Acc: 0.7760
 Site-Sketch                    (0) | Val  Loss: 1.2611 | Val  Acc: 0.7008
 Site-Sketch                    (0) | Val  Loss: 1.3064 | Val  Acc: 0.6517
 Site-QuickDraw                 (1) | Val  Loss: 2.0750 | Val  Acc: 0.3119
 Site-Infograph                 (4) | Val  Loss: 1.8335 | Val  Acc: 0.4038
Average Valid Accuracy: 0.7334
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7500
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.8131
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7733
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7524
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.6847
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8690
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8559
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8788
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8918
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8469
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7737
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7760
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.7008
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.6517
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.3119
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.4038
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 6 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (0) | Train Loss: 1.2156 | Train Acc: 0.7217
 Site-Clipart                   (0) | Train Loss: 1.1151 | Train Acc: 0.7391
 Site-Clipart                   (0) | Train Loss: 1.2801 | Train Acc: 0.7289
 Site-Clipart                   (0) | Train Loss: 1.1513 | Train Acc: 0.7310
 Site-Clipart                   (0) | Train Loss: 1.2289 | Train Acc: 0.7376
 Site-Real                      (3) | Train Loss: 1.0547 | Train Acc: 0.8730
 Site-Real                      (3) | Train Loss: 0.9389 | Train Acc: 0.8757
 Site-Real                      (3) | Train Loss: 0.9135 | Train Acc: 0.9113
 Site-Real                      (3) | Train Loss: 1.0553 | Train Acc: 0.8736
 Site-Painting                  (1) | Train Loss: 1.1632 | Train Acc: 0.7687
 Site-Painting                  (1) | Train Loss: 1.1237 | Train Acc: 0.7718
 Site-Painting                  (1) | Train Loss: 1.0702 | Train Acc: 0.7889
 Site-Sketch                    (5) | Train Loss: 1.1911 | Train Acc: 0.7277
 Site-Sketch                    (5) | Train Loss: 1.2250 | Train Acc: 0.7079
 Site-QuickDraw                 (2) | Train Loss: 1.9755 | Train Acc: 0.3517
 Site-Infograph                 (4) | Train Loss: 1.8498 | Train Acc: 0.4103
Average Train Accuracy: 0.7324
 Site-Clipart                   (0) | Val  Loss: 1.0709 | Val  Acc: 0.7763
 Site-Clipart                   (0) | Val  Loss: 1.1796 | Val  Acc: 0.7290
 Site-Clipart                   (0) | Val  Loss: 1.1319 | Val  Acc: 0.7733
 Site-Clipart                   (0) | Val  Loss: 1.1450 | Val  Acc: 0.7619
 Site-Clipart                   (0) | Val  Loss: 1.2840 | Val  Acc: 0.7153
 Site-Real                      (3) | Val  Loss: 0.9475 | Val  Acc: 0.9048
 Site-Real                      (3) | Val  Loss: 0.9658 | Val  Acc: 0.8475
 Site-Real                      (3) | Val  Loss: 0.9003 | Val  Acc: 0.8848
 Site-Real                      (3) | Val  Loss: 0.9446 | Val  Acc: 0.8874
 Site-Painting                  (1) | Val  Loss: 0.9863 | Val  Acc: 0.8469
 Site-Painting                  (1) | Val  Loss: 1.0624 | Val  Acc: 0.7445
 Site-Painting                  (1) | Val  Loss: 1.0966 | Val  Acc: 0.7917
 Site-Sketch                    (5) | Val  Loss: 1.1437 | Val  Acc: 0.7402
 Site-Sketch                    (5) | Val  Loss: 1.1912 | Val  Acc: 0.7360
 Site-QuickDraw                 (2) | Val  Loss: 2.0298 | Val  Acc: 0.3257
 Site-Infograph                 (4) | Val  Loss: 1.8011 | Val  Acc: 0.4167
Average Valid Accuracy: 0.7426
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7763
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7290
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7733
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7619
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7153
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.9048
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.8475
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.8848
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.8874
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8469
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.7445
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.7917
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7402
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7360
 Best site-QuickDraw                (2)  | Epoch:6 | Val Acc: 0.3257
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.4167
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 5, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (1) | Train Loss: 1.1123 | Train Acc: 0.8087
 Site-Clipart                   (1) | Train Loss: 1.0449 | Train Acc: 0.7826
 Site-Clipart                   (1) | Train Loss: 1.1907 | Train Acc: 0.7333
 Site-Clipart                   (1) | Train Loss: 1.1002 | Train Acc: 0.7627
 Site-Clipart                   (1) | Train Loss: 1.1206 | Train Acc: 0.7715
 Site-Real                      (5) | Train Loss: 0.9847 | Train Acc: 0.8571
 Site-Real                      (5) | Train Loss: 0.8466 | Train Acc: 0.8983
 Site-Real                      (5) | Train Loss: 0.8447 | Train Acc: 0.9032
 Site-Real                      (5) | Train Loss: 0.9719 | Train Acc: 0.8879
 Site-Painting                  (0) | Train Loss: 1.0477 | Train Acc: 0.7483
 Site-Painting                  (0) | Train Loss: 1.1418 | Train Acc: 0.7816
 Site-Painting                  (0) | Train Loss: 1.0377 | Train Acc: 0.8201
 Site-Sketch                    (4) | Train Loss: 1.1263 | Train Acc: 0.7382
 Site-Sketch                    (4) | Train Loss: 1.1580 | Train Acc: 0.7079
 Site-QuickDraw                 (2) | Train Loss: 1.9306 | Train Acc: 0.3670
 Site-Infograph                 (3) | Train Loss: 1.7897 | Train Acc: 0.4017
Average Train Accuracy: 0.7481
 Site-Clipart                   (1) | Val  Loss: 0.9633 | Val  Acc: 0.8026
 Site-Clipart                   (1) | Val  Loss: 1.0686 | Val  Acc: 0.8037
 Site-Clipart                   (1) | Val  Loss: 1.0747 | Val  Acc: 0.8000
 Site-Clipart                   (1) | Val  Loss: 1.0804 | Val  Acc: 0.7381
 Site-Clipart                   (1) | Val  Loss: 1.1835 | Val  Acc: 0.7254
 Site-Real                      (5) | Val  Loss: 0.8992 | Val  Acc: 0.9167
 Site-Real                      (5) | Val  Loss: 0.8962 | Val  Acc: 0.9068
 Site-Real                      (5) | Val  Loss: 0.8240 | Val  Acc: 0.9212
 Site-Real                      (5) | Val  Loss: 0.8542 | Val  Acc: 0.8961
 Site-Painting                  (0) | Val  Loss: 0.9290 | Val  Acc: 0.8673
 Site-Painting                  (0) | Val  Loss: 1.0239 | Val  Acc: 0.7956
 Site-Painting                  (0) | Val  Loss: 1.0267 | Val  Acc: 0.8073
 Site-Sketch                    (4) | Val  Loss: 1.0295 | Val  Acc: 0.7717
 Site-Sketch                    (4) | Val  Loss: 1.1673 | Val  Acc: 0.6854
 Site-QuickDraw                 (2) | Val  Loss: 1.9090 | Val  Acc: 0.4358
 Site-Infograph                 (3) | Val  Loss: 1.7746 | Val  Acc: 0.4295
Average Valid Accuracy: 0.7690
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8026
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8037
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8000
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7381
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7254
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9167
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9068
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9212
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.8961
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.8673
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.7956
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.8073
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.7717
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.6854
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.4358
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.4295
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 4, 2, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 1.0400 | Train Acc: 0.7913
 Site-Clipart                   (0) | Train Loss: 0.9227 | Train Acc: 0.8075
 Site-Clipart                   (0) | Train Loss: 1.1005 | Train Acc: 0.7822
 Site-Clipart                   (0) | Train Loss: 0.9953 | Train Acc: 0.7690
 Site-Clipart                   (0) | Train Loss: 1.0076 | Train Acc: 0.8213
 Site-Real                      (1) | Train Loss: 0.8622 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.7849 | Train Acc: 0.9209
 Site-Real                      (1) | Train Loss: 0.7430 | Train Acc: 0.9234
 Site-Real                      (1) | Train Loss: 0.8708 | Train Acc: 0.9023
 Site-Painting                  (5) | Train Loss: 0.9472 | Train Acc: 0.8163
 Site-Painting                  (5) | Train Loss: 1.0257 | Train Acc: 0.7767
 Site-Painting                  (5) | Train Loss: 0.9675 | Train Acc: 0.7924
 Site-Sketch                    (2) | Train Loss: 1.0302 | Train Acc: 0.7696
 Site-Sketch                    (2) | Train Loss: 1.0407 | Train Acc: 0.7416
 Site-QuickDraw                 (3) | Train Loss: 1.8605 | Train Acc: 0.4220
 Site-Infograph                 (4) | Train Loss: 1.7492 | Train Acc: 0.4359
Average Train Accuracy: 0.7731
 Site-Clipart                   (0) | Val  Loss: 0.8791 | Val  Acc: 0.8158
 Site-Clipart                   (0) | Val  Loss: 0.9387 | Val  Acc: 0.8318
 Site-Clipart                   (0) | Val  Loss: 0.9785 | Val  Acc: 0.8067
 Site-Clipart                   (0) | Val  Loss: 0.9366 | Val  Acc: 0.7857
 Site-Clipart                   (0) | Val  Loss: 1.1195 | Val  Acc: 0.7186
 Site-Real                      (1) | Val  Loss: 0.7988 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.7584 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.7332 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.7611 | Val  Acc: 0.9264
 Site-Painting                  (5) | Val  Loss: 0.9006 | Val  Acc: 0.8061
 Site-Painting                  (5) | Val  Loss: 0.9443 | Val  Acc: 0.8248
 Site-Painting                  (5) | Val  Loss: 0.9433 | Val  Acc: 0.8177
 Site-Sketch                    (2) | Val  Loss: 0.9888 | Val  Acc: 0.7717
 Site-Sketch                    (2) | Val  Loss: 1.0885 | Val  Acc: 0.7022
 Site-QuickDraw                 (3) | Val  Loss: 1.8920 | Val  Acc: 0.3807
 Site-Infograph                 (4) | Val  Loss: 1.6935 | Val  Acc: 0.4551
Average Valid Accuracy: 0.7761
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8158
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8318
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8067
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.7857
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.7186
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9286
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9237
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9212
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9264
 Best site-Painting                 (5)  | Epoch:8 | Val Acc: 0.8061
 Best site-Painting                 (5)  | Epoch:8 | Val Acc: 0.8248
 Best site-Painting                 (5)  | Epoch:8 | Val Acc: 0.8177
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.7717
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.7022
 Best site-QuickDraw                (3)  | Epoch:8 | Val Acc: 0.3807
 Best site-Infograph                (4)  | Epoch:8 | Val Acc: 0.4551
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (2) | Train Loss: 0.9672 | Train Acc: 0.7913
 Site-Clipart                   (2) | Train Loss: 0.8629 | Train Acc: 0.8323
 Site-Clipart                   (2) | Train Loss: 1.0039 | Train Acc: 0.8222
 Site-Clipart                   (2) | Train Loss: 0.9263 | Train Acc: 0.7943
 Site-Clipart                   (2) | Train Loss: 0.9279 | Train Acc: 0.8190
 Site-Real                      (5) | Train Loss: 0.8157 | Train Acc: 0.8968
 Site-Real                      (5) | Train Loss: 0.7117 | Train Acc: 0.8927
 Site-Real                      (5) | Train Loss: 0.6722 | Train Acc: 0.9153
 Site-Real                      (5) | Train Loss: 0.7781 | Train Acc: 0.9195
 Site-Painting                  (1) | Train Loss: 0.9574 | Train Acc: 0.8027
 Site-Painting                  (1) | Train Loss: 0.9543 | Train Acc: 0.7961
 Site-Painting                  (1) | Train Loss: 0.8813 | Train Acc: 0.8339
 Site-Sketch                    (0) | Train Loss: 0.9555 | Train Acc: 0.7330
 Site-Sketch                    (0) | Train Loss: 0.9573 | Train Acc: 0.7603
 Site-QuickDraw                 (3) | Train Loss: 1.8766 | Train Acc: 0.4251
 Site-Infograph                 (4) | Train Loss: 1.6781 | Train Acc: 0.4744
Average Train Accuracy: 0.7818
 Site-Clipart                   (2) | Val  Loss: 0.7528 | Val  Acc: 0.8289
 Site-Clipart                   (2) | Val  Loss: 0.8830 | Val  Acc: 0.7944
 Site-Clipart                   (2) | Val  Loss: 0.9326 | Val  Acc: 0.8200
 Site-Clipart                   (2) | Val  Loss: 0.9064 | Val  Acc: 0.8000
 Site-Clipart                   (2) | Val  Loss: 1.0033 | Val  Acc: 0.7729
 Site-Real                      (5) | Val  Loss: 0.6887 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.7246 | Val  Acc: 0.9153
 Site-Real                      (5) | Val  Loss: 0.6769 | Val  Acc: 0.9030
 Site-Real                      (5) | Val  Loss: 0.6976 | Val  Acc: 0.9177
 Site-Painting                  (1) | Val  Loss: 0.8195 | Val  Acc: 0.8776
 Site-Painting                  (1) | Val  Loss: 0.8544 | Val  Acc: 0.7956
 Site-Painting                  (1) | Val  Loss: 0.9111 | Val  Acc: 0.8177
 Site-Sketch                    (0) | Val  Loss: 0.9395 | Val  Acc: 0.7953
 Site-Sketch                    (0) | Val  Loss: 1.0309 | Val  Acc: 0.6966
 Site-QuickDraw                 (3) | Val  Loss: 1.8448 | Val  Acc: 0.4679
 Site-Infograph                 (4) | Val  Loss: 1.5805 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7934
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8289
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.7944
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8200
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8000
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.7729
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9153
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9030
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9177
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8776
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.7956
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8177
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.7953
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.6966
 Best site-QuickDraw                (3)  | Epoch:9 | Val Acc: 0.4679
 Best site-Infograph                (4)  | Epoch:9 | Val Acc: 0.5385
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:9 | Test Acc: 0.8460
 Test site-Real                      (5)| Epoch:9 | Test Acc: 0.9071
 Test site-Painting                  (1)| Epoch:9 | Test Acc: 0.8465
 Test site-Sketch                    (0)| Epoch:9 | Test Acc: 0.8014
 Test site-QuickDraw                 (3)| Epoch:9 | Test Acc: 0.4810
 Test site-Infograph                 (4)| Epoch:9 | Test Acc: 0.4627
Clipart: 0.8460, Real: 0.9071, Painting: 0.8465, Sketch: 0.8014, QuickDraw: 0.4810, Infograph: 0.4627, 
Average Test Accuracy(group): 0.7241, Average Test Accuracy(individual): 0.8091,
domain std=0.1811, cluster std=0.1811, individual std=0.1316, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 10 ============
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (0) | Train Loss: 0.9414 | Train Acc: 0.7565
 Site-Clipart                   (0) | Train Loss: 0.8149 | Train Acc: 0.8323
 Site-Clipart                   (0) | Train Loss: 0.9701 | Train Acc: 0.8000
 Site-Clipart                   (0) | Train Loss: 0.8792 | Train Acc: 0.8165
 Site-Clipart                   (0) | Train Loss: 0.8870 | Train Acc: 0.8100
 Site-Real                      (1) | Train Loss: 0.7194 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.6605 | Train Acc: 0.8870
 Site-Real                      (1) | Train Loss: 0.6177 | Train Acc: 0.9234
 Site-Real                      (1) | Train Loss: 0.7247 | Train Acc: 0.9253
 Site-Painting                  (5) | Train Loss: 0.9626 | Train Acc: 0.8027
 Site-Painting                  (5) | Train Loss: 0.8560 | Train Acc: 0.8155
 Site-Painting                  (5) | Train Loss: 0.8016 | Train Acc: 0.8478
 Site-Sketch                    (4) | Train Loss: 0.9651 | Train Acc: 0.7801
 Site-Sketch                    (4) | Train Loss: 0.9473 | Train Acc: 0.7566
 Site-QuickDraw                 (2) | Train Loss: 1.6978 | Train Acc: 0.5229
 Site-Infograph                 (3) | Train Loss: 1.6255 | Train Acc: 0.4658
Average Train Accuracy: 0.7904
 Site-Clipart                   (0) | Val  Loss: 0.7011 | Val  Acc: 0.8289
 Site-Clipart                   (0) | Val  Loss: 0.8455 | Val  Acc: 0.8131
 Site-Clipart                   (0) | Val  Loss: 0.8398 | Val  Acc: 0.8267
 Site-Clipart                   (0) | Val  Loss: 0.8014 | Val  Acc: 0.8286
 Site-Clipart                   (0) | Val  Loss: 0.9752 | Val  Acc: 0.7661
 Site-Real                      (1) | Val  Loss: 0.6708 | Val  Acc: 0.8929
 Site-Real                      (1) | Val  Loss: 0.6634 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.6183 | Val  Acc: 0.9091
 Site-Real                      (1) | Val  Loss: 0.6345 | Val  Acc: 0.9307
 Site-Painting                  (5) | Val  Loss: 0.7677 | Val  Acc: 0.8469
 Site-Painting                  (5) | Val  Loss: 0.7748 | Val  Acc: 0.8467
 Site-Painting                  (5) | Val  Loss: 0.8567 | Val  Acc: 0.8177
 Site-Sketch                    (4) | Val  Loss: 0.8742 | Val  Acc: 0.7795
 Site-Sketch                    (4) | Val  Loss: 0.9580 | Val  Acc: 0.7416
 Site-QuickDraw                 (2) | Val  Loss: 1.7431 | Val  Acc: 0.5275
 Site-Infograph                 (3) | Val  Loss: 1.5597 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7993
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8289
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8131
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8267
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8286
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.7661
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.8929
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9091
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9307
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8469
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8467
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8177
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.7795
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.7416
 Best site-QuickDraw                (2)  | Epoch:10 | Val Acc: 0.5275
 Best site-Infograph                (3)  | Epoch:10 | Val Acc: 0.5256
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 11 ============
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (3) | Train Loss: 0.8796 | Train Acc: 0.8000
 Site-Clipart                   (3) | Train Loss: 0.7418 | Train Acc: 0.8323
 Site-Clipart                   (3) | Train Loss: 0.8918 | Train Acc: 0.8267
 Site-Clipart                   (3) | Train Loss: 0.8332 | Train Acc: 0.8038
 Site-Clipart                   (3) | Train Loss: 0.8607 | Train Acc: 0.8190
 Site-Real                      (4) | Train Loss: 0.6912 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.5899 | Train Acc: 0.9209
 Site-Real                      (4) | Train Loss: 0.6050 | Train Acc: 0.9194
 Site-Real                      (4) | Train Loss: 0.6676 | Train Acc: 0.9109
 Site-Painting                  (0) | Train Loss: 0.7877 | Train Acc: 0.8027
 Site-Painting                  (0) | Train Loss: 0.8301 | Train Acc: 0.8155
 Site-Painting                  (0) | Train Loss: 0.7789 | Train Acc: 0.8547
 Site-Sketch                    (2) | Train Loss: 0.8943 | Train Acc: 0.7539
 Site-Sketch                    (2) | Train Loss: 0.8735 | Train Acc: 0.7453
 Site-QuickDraw                 (1) | Train Loss: 1.6972 | Train Acc: 0.4924
 Site-Infograph                 (5) | Train Loss: 1.6074 | Train Acc: 0.4615
Average Train Accuracy: 0.7920
 Site-Clipart                   (3) | Val  Loss: 0.6870 | Val  Acc: 0.8421
 Site-Clipart                   (3) | Val  Loss: 0.7741 | Val  Acc: 0.8598
 Site-Clipart                   (3) | Val  Loss: 0.7706 | Val  Acc: 0.8400
 Site-Clipart                   (3) | Val  Loss: 0.8079 | Val  Acc: 0.8048
 Site-Clipart                   (3) | Val  Loss: 0.8935 | Val  Acc: 0.7966
 Site-Real                      (4) | Val  Loss: 0.6019 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.6246 | Val  Acc: 0.9153
 Site-Real                      (4) | Val  Loss: 0.5790 | Val  Acc: 0.9212
 Site-Real                      (4) | Val  Loss: 0.5959 | Val  Acc: 0.9307
 Site-Painting                  (0) | Val  Loss: 0.7421 | Val  Acc: 0.8673
 Site-Painting                  (0) | Val  Loss: 0.7377 | Val  Acc: 0.8467
 Site-Painting                  (0) | Val  Loss: 0.7862 | Val  Acc: 0.8333
 Site-Sketch                    (2) | Val  Loss: 0.8649 | Val  Acc: 0.8425
 Site-Sketch                    (2) | Val  Loss: 0.9342 | Val  Acc: 0.7360
 Site-QuickDraw                 (1) | Val  Loss: 1.6848 | Val  Acc: 0.5367
 Site-Infograph                 (5) | Val  Loss: 1.5681 | Val  Acc: 0.5192
Average Valid Accuracy: 0.8145
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8421
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8598
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8400
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8048
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.7966
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9153
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9212
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9307
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8673
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8467
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8333
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.8425
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.7360
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.5367
 Best site-Infograph                (5)  | Epoch:11 | Val Acc: 0.5192
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 12 ============
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (2) | Train Loss: 0.8409 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.6740 | Train Acc: 0.8634
 Site-Clipart                   (2) | Train Loss: 0.8960 | Train Acc: 0.8222
 Site-Clipart                   (2) | Train Loss: 0.7519 | Train Acc: 0.8323
 Site-Clipart                   (2) | Train Loss: 0.7991 | Train Acc: 0.8190
 Site-Real                      (0) | Train Loss: 0.6606 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.5748 | Train Acc: 0.9266
 Site-Real                      (0) | Train Loss: 0.5723 | Train Acc: 0.9073
 Site-Real                      (0) | Train Loss: 0.6538 | Train Acc: 0.9310
 Site-Painting                  (4) | Train Loss: 0.8062 | Train Acc: 0.7891
 Site-Painting                  (4) | Train Loss: 0.7213 | Train Acc: 0.8447
 Site-Painting                  (4) | Train Loss: 0.7274 | Train Acc: 0.8581
 Site-Sketch                    (5) | Train Loss: 0.8222 | Train Acc: 0.7749
 Site-Sketch                    (5) | Train Loss: 0.8958 | Train Acc: 0.7416
 Site-QuickDraw                 (1) | Train Loss: 1.5745 | Train Acc: 0.5199
 Site-Infograph                 (3) | Train Loss: 1.5969 | Train Acc: 0.5085
Average Train Accuracy: 0.8048
 Site-Clipart                   (2) | Val  Loss: 0.6285 | Val  Acc: 0.8553
 Site-Clipart                   (2) | Val  Loss: 0.7454 | Val  Acc: 0.8318
 Site-Clipart                   (2) | Val  Loss: 0.7948 | Val  Acc: 0.8267
 Site-Clipart                   (2) | Val  Loss: 0.7871 | Val  Acc: 0.7905
 Site-Clipart                   (2) | Val  Loss: 0.8691 | Val  Acc: 0.7932
 Site-Real                      (0) | Val  Loss: 0.5493 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.6034 | Val  Acc: 0.9153
 Site-Real                      (0) | Val  Loss: 0.5438 | Val  Acc: 0.9212
 Site-Real                      (0) | Val  Loss: 0.5564 | Val  Acc: 0.9264
 Site-Painting                  (4) | Val  Loss: 0.6580 | Val  Acc: 0.8776
 Site-Painting                  (4) | Val  Loss: 0.6631 | Val  Acc: 0.8686
 Site-Painting                  (4) | Val  Loss: 0.7680 | Val  Acc: 0.8229
 Site-Sketch                    (5) | Val  Loss: 0.8574 | Val  Acc: 0.7874
 Site-Sketch                    (5) | Val  Loss: 0.9506 | Val  Acc: 0.7191
 Site-QuickDraw                 (1) | Val  Loss: 1.6627 | Val  Acc: 0.5550
 Site-Infograph                 (3) | Val  Loss: 1.5146 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8111
============ Train epoch 13 ============
cnt=[1, 4, 2, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (4) | Train Loss: 0.8090 | Train Acc: 0.7913
 Site-Clipart                   (4) | Train Loss: 0.6515 | Train Acc: 0.8634
 Site-Clipart                   (4) | Train Loss: 0.8573 | Train Acc: 0.8311
 Site-Clipart                   (4) | Train Loss: 0.7186 | Train Acc: 0.8291
 Site-Clipart                   (4) | Train Loss: 0.7462 | Train Acc: 0.8484
 Site-Real                      (1) | Train Loss: 0.6280 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.5312 | Train Acc: 0.9379
 Site-Real                      (1) | Train Loss: 0.5200 | Train Acc: 0.9274
 Site-Real                      (1) | Train Loss: 0.6065 | Train Acc: 0.9167
 Site-Painting                  (5) | Train Loss: 0.7803 | Train Acc: 0.7823
 Site-Painting                  (5) | Train Loss: 0.7550 | Train Acc: 0.8252
 Site-Painting                  (5) | Train Loss: 0.6773 | Train Acc: 0.8754
 Site-Sketch                    (2) | Train Loss: 0.8222 | Train Acc: 0.7539
 Site-Sketch                    (2) | Train Loss: 0.8727 | Train Acc: 0.7715
 Site-QuickDraw                 (3) | Train Loss: 1.6055 | Train Acc: 0.5566
 Site-Infograph                 (0) | Train Loss: 1.5225 | Train Acc: 0.5171
Average Train Accuracy: 0.8083
 Site-Clipart                   (4) | Val  Loss: 0.5427 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.7096 | Val  Acc: 0.8131
 Site-Clipart                   (4) | Val  Loss: 0.7358 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.7295 | Val  Acc: 0.8095
 Site-Clipart                   (4) | Val  Loss: 0.8155 | Val  Acc: 0.7831
 Site-Real                      (1) | Val  Loss: 0.5214 | Val  Acc: 0.9167
 Site-Real                      (1) | Val  Loss: 0.5446 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.5330 | Val  Acc: 0.8970
 Site-Real                      (1) | Val  Loss: 0.5607 | Val  Acc: 0.9307
 Site-Painting                  (5) | Val  Loss: 0.6056 | Val  Acc: 0.8980
 Site-Painting                  (5) | Val  Loss: 0.7173 | Val  Acc: 0.8394
 Site-Painting                  (5) | Val  Loss: 0.7090 | Val  Acc: 0.8385
 Site-Sketch                    (2) | Val  Loss: 0.7587 | Val  Acc: 0.8189
 Site-Sketch                    (2) | Val  Loss: 0.8516 | Val  Acc: 0.7640
 Site-QuickDraw                 (3) | Val  Loss: 1.6006 | Val  Acc: 0.5459
 Site-Infograph                 (0) | Val  Loss: 1.4778 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8166
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8684
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8131
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8095
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.7831
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9167
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9237
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.8970
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9307
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.8980
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.8394
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.8385
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8189
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.7640
 Best site-QuickDraw                (3)  | Epoch:13 | Val Acc: 0.5459
 Best site-Infograph                (0)  | Epoch:13 | Val Acc: 0.5513
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 4, 1, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (3) | Train Loss: 0.7754 | Train Acc: 0.8435
 Site-Clipart                   (3) | Train Loss: 0.6255 | Train Acc: 0.8882
 Site-Clipart                   (3) | Train Loss: 0.7926 | Train Acc: 0.8089
 Site-Clipart                   (3) | Train Loss: 0.7335 | Train Acc: 0.8070
 Site-Clipart                   (3) | Train Loss: 0.7455 | Train Acc: 0.8439
 Site-Real                      (1) | Train Loss: 0.6091 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.5415 | Train Acc: 0.9322
 Site-Real                      (1) | Train Loss: 0.5147 | Train Acc: 0.9153
 Site-Real                      (1) | Train Loss: 0.5853 | Train Acc: 0.9224
 Site-Painting                  (5) | Train Loss: 0.7007 | Train Acc: 0.8095
 Site-Painting                  (5) | Train Loss: 0.6957 | Train Acc: 0.8641
 Site-Painting                  (5) | Train Loss: 0.6836 | Train Acc: 0.8616
 Site-Sketch                    (0) | Train Loss: 0.7907 | Train Acc: 0.7958
 Site-Sketch                    (0) | Train Loss: 0.9275 | Train Acc: 0.7491
 Site-QuickDraw                 (2) | Train Loss: 1.5326 | Train Acc: 0.5933
 Site-Infograph                 (4) | Train Loss: 1.5131 | Train Acc: 0.5214
Average Train Accuracy: 0.8168
 Site-Clipart                   (3) | Val  Loss: 0.5484 | Val  Acc: 0.8684
 Site-Clipart                   (3) | Val  Loss: 0.6637 | Val  Acc: 0.8411
 Site-Clipart                   (3) | Val  Loss: 0.7196 | Val  Acc: 0.8467
 Site-Clipart                   (3) | Val  Loss: 0.6892 | Val  Acc: 0.8524
 Site-Clipart                   (3) | Val  Loss: 0.8092 | Val  Acc: 0.7966
 Site-Real                      (1) | Val  Loss: 0.5004 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.5271 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.5132 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.5024 | Val  Acc: 0.9307
 Site-Painting                  (5) | Val  Loss: 0.5880 | Val  Acc: 0.8980
 Site-Painting                  (5) | Val  Loss: 0.6123 | Val  Acc: 0.8832
 Site-Painting                  (5) | Val  Loss: 0.6936 | Val  Acc: 0.8542
 Site-Sketch                    (0) | Val  Loss: 0.7822 | Val  Acc: 0.8110
 Site-Sketch                    (0) | Val  Loss: 0.8591 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 1.5541 | Val  Acc: 0.5688
 Site-Infograph                 (4) | Val  Loss: 1.5085 | Val  Acc: 0.5064
Average Valid Accuracy: 0.8228
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.8684
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.8411
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.8467
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.8524
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.7966
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9212
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9307
 Best site-Painting                 (5)  | Epoch:14 | Val Acc: 0.8980
 Best site-Painting                 (5)  | Epoch:14 | Val Acc: 0.8832
 Best site-Painting                 (5)  | Epoch:14 | Val Acc: 0.8542
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.8110
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.7753
 Best site-QuickDraw                (2)  | Epoch:14 | Val Acc: 0.5688
 Best site-Infograph                (4)  | Epoch:14 | Val Acc: 0.5064
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 15 ============
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (0) | Train Loss: 0.7078 | Train Acc: 0.8348
 Site-Clipart                   (0) | Train Loss: 0.6371 | Train Acc: 0.8261
 Site-Clipart                   (0) | Train Loss: 0.7487 | Train Acc: 0.8489
 Site-Clipart                   (0) | Train Loss: 0.6922 | Train Acc: 0.8386
 Site-Clipart                   (0) | Train Loss: 0.7214 | Train Acc: 0.8484
 Site-Real                      (2) | Train Loss: 0.5805 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.5141 | Train Acc: 0.9209
 Site-Real                      (2) | Train Loss: 0.4812 | Train Acc: 0.9153
 Site-Real                      (2) | Train Loss: 0.5506 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.7406 | Train Acc: 0.8027
 Site-Painting                  (4) | Train Loss: 0.6921 | Train Acc: 0.8641
 Site-Painting                  (4) | Train Loss: 0.6673 | Train Acc: 0.8685
 Site-Sketch                    (5) | Train Loss: 0.7798 | Train Acc: 0.7958
 Site-Sketch                    (5) | Train Loss: 0.7548 | Train Acc: 0.7865
 Site-QuickDraw                 (1) | Train Loss: 1.5490 | Train Acc: 0.5994
 Site-Infograph                 (3) | Train Loss: 1.5384 | Train Acc: 0.4957
Average Train Accuracy: 0.8183
 Site-Clipart                   (0) | Val  Loss: 0.5365 | Val  Acc: 0.8289
 Site-Clipart                   (0) | Val  Loss: 0.6583 | Val  Acc: 0.8598
 Site-Clipart                   (0) | Val  Loss: 0.6366 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.6972 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.7472 | Val  Acc: 0.8068
 Site-Real                      (2) | Val  Loss: 0.4869 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.4960 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.4800 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.4731 | Val  Acc: 0.9437
 Site-Painting                  (4) | Val  Loss: 0.5547 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.6002 | Val  Acc: 0.8759
 Site-Painting                  (4) | Val  Loss: 0.6363 | Val  Acc: 0.8750
 Site-Sketch                    (5) | Val  Loss: 0.7678 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.8339 | Val  Acc: 0.7640
 Site-QuickDraw                 (1) | Val  Loss: 1.5192 | Val  Acc: 0.5734
 Site-Infograph                 (3) | Val  Loss: 1.4358 | Val  Acc: 0.5192
Average Valid Accuracy: 0.8303
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8289
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8598
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8733
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8333
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8068
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9273
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9437
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8759
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8750
 Best site-Sketch                   (5)  | Epoch:15 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:15 | Val Acc: 0.7640
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.5734
 Best site-Infograph                (3)  | Epoch:15 | Val Acc: 0.5192
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 16 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (0) | Train Loss: 0.7283 | Train Acc: 0.8087
 Site-Clipart                   (0) | Train Loss: 0.5877 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.7351 | Train Acc: 0.8489
 Site-Clipart                   (0) | Train Loss: 0.6600 | Train Acc: 0.8513
 Site-Clipart                   (0) | Train Loss: 0.6732 | Train Acc: 0.8529
 Site-Real                      (3) | Train Loss: 0.5639 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.4849 | Train Acc: 0.9153
 Site-Real                      (3) | Train Loss: 0.4594 | Train Acc: 0.9274
 Site-Real                      (3) | Train Loss: 0.5255 | Train Acc: 0.9397
 Site-Painting                  (1) | Train Loss: 0.6316 | Train Acc: 0.8163
 Site-Painting                  (1) | Train Loss: 0.7669 | Train Acc: 0.8301
 Site-Painting                  (1) | Train Loss: 0.6156 | Train Acc: 0.8893
 Site-Sketch                    (5) | Train Loss: 0.7616 | Train Acc: 0.8010
 Site-Sketch                    (5) | Train Loss: 0.7701 | Train Acc: 0.7940
 Site-QuickDraw                 (2) | Train Loss: 1.4514 | Train Acc: 0.5963
 Site-Infograph                 (4) | Train Loss: 1.4526 | Train Acc: 0.5342
Average Train Accuracy: 0.8235
 Site-Clipart                   (0) | Val  Loss: 0.4842 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.6357 | Val  Acc: 0.8318
 Site-Clipart                   (0) | Val  Loss: 0.6638 | Val  Acc: 0.8400
 Site-Clipart                   (0) | Val  Loss: 0.6373 | Val  Acc: 0.8476
 Site-Clipart                   (0) | Val  Loss: 0.7528 | Val  Acc: 0.8169
 Site-Real                      (3) | Val  Loss: 0.4468 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.4738 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.4562 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.4765 | Val  Acc: 0.9394
 Site-Painting                  (1) | Val  Loss: 0.5642 | Val  Acc: 0.8980
 Site-Painting                  (1) | Val  Loss: 0.5502 | Val  Acc: 0.8686
===2023-06-25 19:17:02===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-06-25 19:17:09===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:15 | Test Acc: 0.8650
 Test site-Real                      (2)| Epoch:15 | Test Acc: 0.9219
===2023-06-25 19:19:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 1, 2, 1, 1, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 2.0298 | Train Acc: 0.2348
 Site-Clipart                   (0) | Train Loss: 2.0084 | Train Acc: 0.2733
 Site-Clipart                   (1) | Train Loss: 2.1224 | Train Acc: 0.2178
 Site-Clipart                   (5) | Train Loss: 2.0348 | Train Acc: 0.2627
 Site-Clipart                   (0) | Train Loss: 2.0627 | Train Acc: 0.2398
 Site-Real                      (5) | Train Loss: 2.0378 | Train Acc: 0.2937
 Site-Real                      (5) | Train Loss: 2.0002 | Train Acc: 0.2373
 Site-Real                      (0) | Train Loss: 1.8926 | Train Acc: 0.3831
 Site-Real                      (5) | Train Loss: 2.0279 | Train Acc: 0.2414
 Site-Painting                  (0) | Train Loss: 1.9863 | Train Acc: 0.3061
 Site-Painting                  (3) | Train Loss: 2.0086 | Train Acc: 0.3155
 Site-Painting                  (2) | Train Loss: 1.9685 | Train Acc: 0.3010
 Site-Sketch                    (5) | Train Loss: 2.0176 | Train Acc: 0.2723
 Site-Sketch                    (4) | Train Loss: 2.0209 | Train Acc: 0.2884
 Site-QuickDraw                 (0) | Train Loss: 2.3687 | Train Acc: 0.0703
 Site-Infograph                 (2) | Train Loss: 2.0541 | Train Acc: 0.2521
Average Train Accuracy: 0.2618
 Site-Clipart                   (0) | Val  Loss: 1.9861 | Val  Acc: 0.3158
 Site-Clipart                   (0) | Val  Loss: 2.0896 | Val  Acc: 0.3084
 Site-Clipart                   (1) | Val  Loss: 2.0490 | Val  Acc: 0.2667
 Site-Clipart                   (5) | Val  Loss: 2.0141 | Val  Acc: 0.2667
 Site-Clipart                   (0) | Val  Loss: 2.1086 | Val  Acc: 0.2441
 Site-Real                      (5) | Val  Loss: 1.9809 | Val  Acc: 0.2500
 Site-Real                      (5) | Val  Loss: 1.9599 | Val  Acc: 0.3136
 Site-Real                      (0) | Val  Loss: 1.8735 | Val  Acc: 0.3152
 Site-Real                      (5) | Val  Loss: 1.9291 | Val  Acc: 0.3290
 Site-Painting                  (0) | Val  Loss: 1.9648 | Val  Acc: 0.2857
 Site-Painting                  (3) | Val  Loss: 1.9918 | Val  Acc: 0.2920
 Site-Painting                  (2) | Val  Loss: 1.9651 | Val  Acc: 0.3177
 Site-Sketch                    (5) | Val  Loss: 1.9882 | Val  Acc: 0.2992
 Site-Sketch                    (4) | Val  Loss: 2.0098 | Val  Acc: 0.2697
 Site-QuickDraw                 (0) | Val  Loss: 2.3405 | Val  Acc: 0.1101
 Site-Infograph                 (2) | Val  Loss: 2.0822 | Val  Acc: 0.2756
Average Valid Accuracy: 0.2787
============ Train epoch 2 ============
cnt=[2, 2, 3, 7, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.9475 | Train Acc: 0.3043
 Site-Clipart                   (1) | Train Loss: 1.8879 | Train Acc: 0.3727
 Site-Clipart                   (5) | Train Loss: 2.0089 | Train Acc: 0.3200
 Site-Clipart                   (0) | Train Loss: 1.9369 | Train Acc: 0.3639
 Site-Clipart                   (2) | Train Loss: 1.9602 | Train Acc: 0.3348
 Site-Real                      (4) | Train Loss: 1.8859 | Train Acc: 0.4048
 Site-Real                      (3) | Train Loss: 1.8827 | Train Acc: 0.4124
 Site-Real                      (2) | Train Loss: 1.7478 | Train Acc: 0.5161
 Site-Real                      (3) | Train Loss: 1.8501 | Train Acc: 0.3851
 Site-Painting                  (3) | Train Loss: 1.8662 | Train Acc: 0.4354
 Site-Painting                  (3) | Train Loss: 1.8621 | Train Acc: 0.4175
 Site-Painting                  (1) | Train Loss: 1.8615 | Train Acc: 0.4256
 Site-Sketch                    (3) | Train Loss: 1.8989 | Train Acc: 0.3874
 Site-Sketch                    (3) | Train Loss: 1.9103 | Train Acc: 0.3895
 Site-QuickDraw                 (2) | Train Loss: 2.3541 | Train Acc: 0.0642
 Site-Infograph                 (3) | Train Loss: 1.9874 | Train Acc: 0.3675
Average Train Accuracy: 0.3688
 Site-Clipart                   (0) | Val  Loss: 1.9005 | Val  Acc: 0.3816
 Site-Clipart                   (1) | Val  Loss: 1.9696 | Val  Acc: 0.3738
 Site-Clipart                   (5) | Val  Loss: 1.9473 | Val  Acc: 0.3933
 Site-Clipart                   (0) | Val  Loss: 1.9008 | Val  Acc: 0.4048
 Site-Clipart                   (2) | Val  Loss: 2.0002 | Val  Acc: 0.3424
 Site-Real                      (4) | Val  Loss: 1.8276 | Val  Acc: 0.4048
 Site-Real                      (3) | Val  Loss: 1.8103 | Val  Acc: 0.4492
 Site-Real                      (2) | Val  Loss: 1.7477 | Val  Acc: 0.4606
 Site-Real                      (3) | Val  Loss: 1.7614 | Val  Acc: 0.5195
 Site-Painting                  (3) | Val  Loss: 1.8290 | Val  Acc: 0.4286
 Site-Painting                  (3) | Val  Loss: 1.8447 | Val  Acc: 0.4526
 Site-Painting                  (1) | Val  Loss: 1.8551 | Val  Acc: 0.4740
 Site-Sketch                    (3) | Val  Loss: 1.8590 | Val  Acc: 0.4646
 Site-Sketch                    (3) | Val  Loss: 1.8775 | Val  Acc: 0.4101
 Site-QuickDraw                 (2) | Val  Loss: 2.3222 | Val  Acc: 0.1055
 Site-Infograph                 (3) | Val  Loss: 1.9533 | Val  Acc: 0.3910
Average Valid Accuracy: 0.4035
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.3816
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.3738
 Best site-Clipart                  (5)  | Epoch:2 | Val Acc: 0.3933
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.4048
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.3424
 Best site-Real                     (4)  | Epoch:2 | Val Acc: 0.4048
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.4492
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.4606
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.5195
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.4286
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.4526
 Best site-Painting                 (1)  | Epoch:2 | Val Acc: 0.4740
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.4646
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.4101
 Best site-QuickDraw                (2)  | Epoch:2 | Val Acc: 0.1055
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.3910
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 3 ============
===2023-06-25 19:40:47===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 1, 2, 1, 1, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 2.0141 | Train Acc: 0.2261
 Site-Clipart                   (0) | Train Loss: 1.9947 | Train Acc: 0.2298
 Site-Clipart                   (1) | Train Loss: 2.1101 | Train Acc: 0.2044
 Site-Clipart                   (5) | Train Loss: 2.0199 | Train Acc: 0.2405
 Site-Clipart                   (0) | Train Loss: 2.0581 | Train Acc: 0.1991
 Site-Real                      (5) | Train Loss: 2.0469 | Train Acc: 0.2460
 Site-Real                      (5) | Train Loss: 1.9923 | Train Acc: 0.1751
 Site-Real                      (0) | Train Loss: 1.8998 | Train Acc: 0.3105
 Site-Real                      (5) | Train Loss: 2.0298 | Train Acc: 0.1724
 Site-Painting                  (0) | Train Loss: 1.9868 | Train Acc: 0.2517
 Site-Painting                  (3) | Train Loss: 1.9997 | Train Acc: 0.2621
 Site-Painting                  (2) | Train Loss: 1.9650 | Train Acc: 0.2457
 Site-Sketch                    (5) | Train Loss: 1.9990 | Train Acc: 0.2408
 Site-Sketch                    (4) | Train Loss: 1.9998 | Train Acc: 0.2397
 Site-QuickDraw                 (0) | Train Loss: 2.3853 | Train Acc: 0.0673
 Site-Infograph                 (2) | Train Loss: 2.0410 | Train Acc: 0.2564
Average Train Accuracy: 0.2230
 Site-Clipart                   (0) | Val  Loss: 1.9783 | Val  Acc: 0.2500
 Site-Clipart                   (0) | Val  Loss: 2.0805 | Val  Acc: 0.2430
 Site-Clipart                   (1) | Val  Loss: 2.0296 | Val  Acc: 0.2800
 Site-Clipart                   (5) | Val  Loss: 1.9982 | Val  Acc: 0.2524
 Site-Clipart                   (0) | Val  Loss: 2.0987 | Val  Acc: 0.1966
 Site-Real                      (5) | Val  Loss: 1.9896 | Val  Acc: 0.2262
 Site-Real                      (5) | Val  Loss: 1.9568 | Val  Acc: 0.2373
 Site-Real                      (0) | Val  Loss: 1.8768 | Val  Acc: 0.2364
 Site-Real                      (5) | Val  Loss: 1.9365 | Val  Acc: 0.2511
 Site-Painting                  (0) | Val  Loss: 1.9517 | Val  Acc: 0.2449
 Site-Painting                  (3) | Val  Loss: 1.9928 | Val  Acc: 0.2555
 Site-Painting                  (2) | Val  Loss: 1.9523 | Val  Acc: 0.2969
 Site-Sketch                    (5) | Val  Loss: 1.9756 | Val  Acc: 0.2520
 Site-Sketch                    (4) | Val  Loss: 2.0007 | Val  Acc: 0.2416
 Site-QuickDraw                 (0) | Val  Loss: 2.3615 | Val  Acc: 0.1055
 Site-Infograph                 (2) | Val  Loss: 2.0617 | Val  Acc: 0.2692
Average Valid Accuracy: 0.2399
============ Train epoch 2 ============
