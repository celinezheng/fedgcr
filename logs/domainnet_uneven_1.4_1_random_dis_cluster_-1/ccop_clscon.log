===2023-06-25 16:25:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9713 | Train Acc: 0.3826
 Site-Clipart                   (0) | Train Loss: 1.8921 | Train Acc: 0.5280
 Site-Clipart                   (0) | Train Loss: 1.9593 | Train Acc: 0.4356
 Site-Clipart                   (0) | Train Loss: 1.9197 | Train Acc: 0.4747
 Site-Clipart                   (0) | Train Loss: 1.9253 | Train Acc: 0.4706
 Site-Real                      (1) | Train Loss: 1.8506 | Train Acc: 0.5397
 Site-Real                      (1) | Train Loss: 1.8393 | Train Acc: 0.5650
 Site-Real                      (1) | Train Loss: 1.7489 | Train Acc: 0.6694
 Site-Real                      (1) | Train Loss: 1.8380 | Train Acc: 0.5718
 Site-Painting                  (3) | Train Loss: 1.8676 | Train Acc: 0.5714
 Site-Painting                  (3) | Train Loss: 1.8978 | Train Acc: 0.4951
 Site-Painting                  (3) | Train Loss: 1.8278 | Train Acc: 0.5294
 Site-Sketch                    (5) | Train Loss: 1.9030 | Train Acc: 0.5183
 Site-Sketch                    (5) | Train Loss: 1.9004 | Train Acc: 0.4794
 Site-QuickDraw                 (2) | Train Loss: 2.2887 | Train Acc: 0.2110
 Site-Infograph                 (4) | Train Loss: 2.1232 | Train Acc: 0.3248
Average Train Accuracy: 0.4854
 Site-Clipart                   (0) | Val  Loss: 1.8428 | Val  Acc: 0.4605
 Site-Clipart                   (0) | Val  Loss: 1.9054 | Val  Acc: 0.4766
 Site-Clipart                   (0) | Val  Loss: 1.9243 | Val  Acc: 0.4867
 Site-Clipart                   (0) | Val  Loss: 1.9198 | Val  Acc: 0.4476
 Site-Clipart                   (0) | Val  Loss: 1.9588 | Val  Acc: 0.4169
 Site-Real                      (1) | Val  Loss: 1.7831 | Val  Acc: 0.5238
 Site-Real                      (1) | Val  Loss: 1.7804 | Val  Acc: 0.6186
 Site-Real                      (1) | Val  Loss: 1.7215 | Val  Acc: 0.7030
 Site-Real                      (1) | Val  Loss: 1.7623 | Val  Acc: 0.6320
 Site-Painting                  (3) | Val  Loss: 1.8176 | Val  Acc: 0.5000
 Site-Painting                  (3) | Val  Loss: 1.7870 | Val  Acc: 0.5036
 Site-Painting                  (3) | Val  Loss: 1.8782 | Val  Acc: 0.5104
 Site-Sketch                    (5) | Val  Loss: 1.8812 | Val  Acc: 0.5039
 Site-Sketch                    (5) | Val  Loss: 1.9038 | Val  Acc: 0.4775
 Site-QuickDraw                 (2) | Val  Loss: 2.2838 | Val  Acc: 0.1881
 Site-Infograph                 (4) | Val  Loss: 2.1075 | Val  Acc: 0.2821
Average Valid Accuracy: 0.4832
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4605
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4766
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4867
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4476
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4169
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.5238
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6186
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.7030
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6320
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5000
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5036
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5104
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5039
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4775
 Best site-QuickDraw                (2)  | Epoch:1 | Val Acc: 0.1881
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.7678 | Train Acc: 0.5826
 Site-Clipart                   (0) | Train Loss: 1.6916 | Train Acc: 0.6211
 Site-Clipart                   (0) | Train Loss: 1.7987 | Train Acc: 0.5378
 Site-Clipart                   (0) | Train Loss: 1.7295 | Train Acc: 0.5601
 Site-Clipart                   (0) | Train Loss: 1.7517 | Train Acc: 0.5792
 Site-Real                      (1) | Train Loss: 1.6031 | Train Acc: 0.6667
 Site-Real                      (1) | Train Loss: 1.5730 | Train Acc: 0.6949
 Site-Real                      (1) | Train Loss: 1.4972 | Train Acc: 0.7984
 Site-Real                      (1) | Train Loss: 1.6215 | Train Acc: 0.7069
 Site-Painting                  (3) | Train Loss: 1.6430 | Train Acc: 0.6259
 Site-Painting                  (3) | Train Loss: 1.7215 | Train Acc: 0.5583
 Site-Painting                  (3) | Train Loss: 1.6782 | Train Acc: 0.6194
 Site-Sketch                    (5) | Train Loss: 1.7145 | Train Acc: 0.6283
 Site-Sketch                    (5) | Train Loss: 1.7182 | Train Acc: 0.5805
 Site-QuickDraw                 (2) | Train Loss: 2.2169 | Train Acc: 0.2385
 Site-Infograph                 (4) | Train Loss: 2.1202 | Train Acc: 0.3248
Average Train Accuracy: 0.5827
 Site-Clipart                   (0) | Val  Loss: 1.6020 | Val  Acc: 0.6053
 Site-Clipart                   (0) | Val  Loss: 1.7219 | Val  Acc: 0.5794
 Site-Clipart                   (0) | Val  Loss: 1.7558 | Val  Acc: 0.6200
 Site-Clipart                   (0) | Val  Loss: 1.7045 | Val  Acc: 0.5810
 Site-Clipart                   (0) | Val  Loss: 1.7796 | Val  Acc: 0.5390
 Site-Real                      (1) | Val  Loss: 1.5140 | Val  Acc: 0.6905
 Site-Real                      (1) | Val  Loss: 1.5485 | Val  Acc: 0.7712
 Site-Real                      (1) | Val  Loss: 1.4959 | Val  Acc: 0.8000
 Site-Real                      (1) | Val  Loss: 1.5418 | Val  Acc: 0.7576
 Site-Painting                  (3) | Val  Loss: 1.5977 | Val  Acc: 0.6939
 Site-Painting                  (3) | Val  Loss: 1.5970 | Val  Acc: 0.5912
 Site-Painting                  (3) | Val  Loss: 1.6988 | Val  Acc: 0.5573
 Site-Sketch                    (5) | Val  Loss: 1.7181 | Val  Acc: 0.6142
 Site-Sketch                    (5) | Val  Loss: 1.7512 | Val  Acc: 0.5281
 Site-QuickDraw                 (2) | Val  Loss: 2.2259 | Val  Acc: 0.2431
 Site-Infograph                 (4) | Val  Loss: 2.0824 | Val  Acc: 0.3141
Average Valid Accuracy: 0.5929
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6053
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5794
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6200
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5810
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5390
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.6905
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7712
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.8000
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7576
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.6939
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.5912
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.5573
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.6142
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5281
 Best site-QuickDraw                (2)  | Epoch:2 | Val Acc: 0.2431
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.3141
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.6026 | Train Acc: 0.6348
 Site-Clipart                   (0) | Train Loss: 1.5139 | Train Acc: 0.6770
 Site-Clipart                   (0) | Train Loss: 1.6515 | Train Acc: 0.6311
 Site-Clipart                   (0) | Train Loss: 1.5504 | Train Acc: 0.7025
 Site-Clipart                   (0) | Train Loss: 1.5889 | Train Acc: 0.6516
 Site-Real                      (1) | Train Loss: 1.4403 | Train Acc: 0.8175
 Site-Real                      (1) | Train Loss: 1.3460 | Train Acc: 0.8531
 Site-Real                      (1) | Train Loss: 1.3191 | Train Acc: 0.8347
 Site-Real                      (1) | Train Loss: 1.4092 | Train Acc: 0.8362
 Site-Painting                  (3) | Train Loss: 1.4899 | Train Acc: 0.6803
 Site-Painting                  (3) | Train Loss: 1.5256 | Train Acc: 0.7087
 Site-Painting                  (3) | Train Loss: 1.5082 | Train Acc: 0.6782
 Site-Sketch                    (5) | Train Loss: 1.4975 | Train Acc: 0.7435
 Site-Sketch                    (5) | Train Loss: 1.6031 | Train Acc: 0.6554
 Site-QuickDraw                 (2) | Train Loss: 2.1396 | Train Acc: 0.2416
 Site-Infograph                 (4) | Train Loss: 2.0487 | Train Acc: 0.3632
Average Train Accuracy: 0.6693
 Site-Clipart                   (0) | Val  Loss: 1.4361 | Val  Acc: 0.6579
 Site-Clipart                   (0) | Val  Loss: 1.5221 | Val  Acc: 0.6822
 Site-Clipart                   (0) | Val  Loss: 1.5656 | Val  Acc: 0.6733
 Site-Clipart                   (0) | Val  Loss: 1.5147 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 1.6335 | Val  Acc: 0.6136
 Site-Real                      (1) | Val  Loss: 1.3281 | Val  Acc: 0.8452
 Site-Real                      (1) | Val  Loss: 1.3664 | Val  Acc: 0.8475
 Site-Real                      (1) | Val  Loss: 1.2903 | Val  Acc: 0.8424
 Site-Real                      (1) | Val  Loss: 1.3517 | Val  Acc: 0.8528
 Site-Painting                  (3) | Val  Loss: 1.4484 | Val  Acc: 0.7551
 Site-Painting                  (3) | Val  Loss: 1.4369 | Val  Acc: 0.6496
 Site-Painting                  (3) | Val  Loss: 1.5098 | Val  Acc: 0.6875
 Site-Sketch                    (5) | Val  Loss: 1.5652 | Val  Acc: 0.6457
 Site-Sketch                    (5) | Val  Loss: 1.5881 | Val  Acc: 0.6124
 Site-QuickDraw                 (2) | Val  Loss: 2.1706 | Val  Acc: 0.2569
 Site-Infograph                 (4) | Val  Loss: 1.9853 | Val  Acc: 0.3718
Average Valid Accuracy: 0.6663
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6579
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6822
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6733
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6136
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8452
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8475
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8424
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8528
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7551
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6496
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6875
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6457
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6124
 Best site-QuickDraw                (2)  | Epoch:3 | Val Acc: 0.2569
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.3718
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 3, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.4594 | Train Acc: 0.6870
 Site-Clipart                   (0) | Train Loss: 1.4670 | Train Acc: 0.6522
 Site-Clipart                   (0) | Train Loss: 1.5452 | Train Acc: 0.6533
 Site-Clipart                   (0) | Train Loss: 1.4688 | Train Acc: 0.6677
 Site-Clipart                   (0) | Train Loss: 1.5278 | Train Acc: 0.6448
 Site-Real                      (4) | Train Loss: 1.3223 | Train Acc: 0.8571
 Site-Real                      (4) | Train Loss: 1.2130 | Train Acc: 0.8588
 Site-Real                      (4) | Train Loss: 1.2011 | Train Acc: 0.8669
 Site-Real                      (4) | Train Loss: 1.3401 | Train Acc: 0.8276
 Site-Painting                  (1) | Train Loss: 1.3124 | Train Acc: 0.7347
 Site-Painting                  (1) | Train Loss: 1.3754 | Train Acc: 0.6748
 Site-Painting                  (1) | Train Loss: 1.3481 | Train Acc: 0.7301
 Site-Sketch                    (5) | Train Loss: 1.4513 | Train Acc: 0.6859
 Site-Sketch                    (5) | Train Loss: 1.5874 | Train Acc: 0.6629
 Site-QuickDraw                 (2) | Train Loss: 2.0900 | Train Acc: 0.2875
 Site-Infograph                 (3) | Train Loss: 2.0283 | Train Acc: 0.3419
Average Train Accuracy: 0.6771
 Site-Clipart                   (0) | Val  Loss: 1.3386 | Val  Acc: 0.6842
 Site-Clipart                   (0) | Val  Loss: 1.4237 | Val  Acc: 0.7196
 Site-Clipart                   (0) | Val  Loss: 1.4804 | Val  Acc: 0.6733
 Site-Clipart                   (0) | Val  Loss: 1.4343 | Val  Acc: 0.6810
 Site-Clipart                   (0) | Val  Loss: 1.5468 | Val  Acc: 0.6339
 Site-Real                      (4) | Val  Loss: 1.2431 | Val  Acc: 0.8690
 Site-Real                      (4) | Val  Loss: 1.2760 | Val  Acc: 0.7881
 Site-Real                      (4) | Val  Loss: 1.1871 | Val  Acc: 0.8909
 Site-Real                      (4) | Val  Loss: 1.2091 | Val  Acc: 0.8398
 Site-Painting                  (1) | Val  Loss: 1.2462 | Val  Acc: 0.8367
 Site-Painting                  (1) | Val  Loss: 1.3228 | Val  Acc: 0.7299
 Site-Painting                  (1) | Val  Loss: 1.3864 | Val  Acc: 0.7188
 Site-Sketch                    (5) | Val  Loss: 1.4178 | Val  Acc: 0.7323
 Site-Sketch                    (5) | Val  Loss: 1.5066 | Val  Acc: 0.6854
 Site-QuickDraw                 (2) | Val  Loss: 2.1305 | Val  Acc: 0.2844
 Site-Infograph                 (3) | Val  Loss: 1.9730 | Val  Acc: 0.3782
Average Valid Accuracy: 0.6966
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6842
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7196
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6733
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6810
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6339
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8690
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.7881
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8909
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8398
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.8367
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7299
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7188
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.7323
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6854
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.2844
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.3782
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 3, 1, 5, 1, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 1.4192 | Train Acc: 0.7130
 Site-Clipart                   (3) | Train Loss: 1.3495 | Train Acc: 0.6832
 Site-Clipart                   (3) | Train Loss: 1.4784 | Train Acc: 0.6844
 Site-Clipart                   (3) | Train Loss: 1.3897 | Train Acc: 0.7089
 Site-Clipart                   (3) | Train Loss: 1.4533 | Train Acc: 0.6810
 Site-Real                      (5) | Train Loss: 1.2519 | Train Acc: 0.8492
 Site-Real                      (5) | Train Loss: 1.1187 | Train Acc: 0.8531
 Site-Real                      (5) | Train Loss: 1.1228 | Train Acc: 0.8669
 Site-Real                      (5) | Train Loss: 1.2670 | Train Acc: 0.8448
 Site-Painting                  (1) | Train Loss: 1.4536 | Train Acc: 0.7075
 Site-Painting                  (1) | Train Loss: 1.3632 | Train Acc: 0.7379
 Site-Painting                  (1) | Train Loss: 1.3019 | Train Acc: 0.7509
 Site-Sketch                    (0) | Train Loss: 1.3341 | Train Acc: 0.7592
 Site-Sketch                    (0) | Train Loss: 1.4928 | Train Acc: 0.6779
 Site-QuickDraw                 (2) | Train Loss: 2.0663 | Train Acc: 0.2630
 Site-Infograph                 (4) | Train Loss: 1.9598 | Train Acc: 0.3675
Average Train Accuracy: 0.6968
 Site-Clipart                   (3) | Val  Loss: 1.2899 | Val  Acc: 0.7237
 Site-Clipart                   (3) | Val  Loss: 1.3636 | Val  Acc: 0.7383
 Site-Clipart                   (3) | Val  Loss: 1.3848 | Val  Acc: 0.7067
 Site-Clipart                   (3) | Val  Loss: 1.3550 | Val  Acc: 0.6714
 Site-Clipart                   (3) | Val  Loss: 1.4575 | Val  Acc: 0.6576
 Site-Real                      (5) | Val  Loss: 1.1594 | Val  Acc: 0.8571
 Site-Real                      (5) | Val  Loss: 1.2064 | Val  Acc: 0.8559
 Site-Real                      (5) | Val  Loss: 1.1098 | Val  Acc: 0.8485
 Site-Real                      (5) | Val  Loss: 1.1365 | Val  Acc: 0.8658
 Site-Painting                  (1) | Val  Loss: 1.1944 | Val  Acc: 0.8367
 Site-Painting                  (1) | Val  Loss: 1.2705 | Val  Acc: 0.7518
 Site-Painting                  (1) | Val  Loss: 1.2951 | Val  Acc: 0.7552
 Site-Sketch                    (0) | Val  Loss: 1.4326 | Val  Acc: 0.6535
 Site-Sketch                    (0) | Val  Loss: 1.4471 | Val  Acc: 0.6517
 Site-QuickDraw                 (2) | Val  Loss: 2.1047 | Val  Acc: 0.2844
 Site-Infograph                 (4) | Val  Loss: 1.9222 | Val  Acc: 0.3526
Average Valid Accuracy: 0.7007
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7237
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7383
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7067
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.6714
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.6576
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8571
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8559
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8485
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8658
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.8367
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.7518
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.7552
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.6535
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.6517
 Best site-QuickDraw                (2)  | Epoch:5 | Val Acc: 0.2844
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.3526
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 6 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (0) | Train Loss: 1.2979 | Train Acc: 0.7391
 Site-Clipart                   (0) | Train Loss: 1.2016 | Train Acc: 0.7516
 Site-Clipart                   (0) | Train Loss: 1.3080 | Train Acc: 0.7644
 Site-Clipart                   (0) | Train Loss: 1.2251 | Train Acc: 0.7785
 Site-Clipart                   (0) | Train Loss: 1.2861 | Train Acc: 0.7398
 Site-Real                      (3) | Train Loss: 1.0980 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 1.0000 | Train Acc: 0.8814
 Site-Real                      (3) | Train Loss: 0.9759 | Train Acc: 0.8952
 Site-Real                      (3) | Train Loss: 1.0843 | Train Acc: 0.8879
 Site-Painting                  (1) | Train Loss: 1.2439 | Train Acc: 0.7891
 Site-Painting                  (1) | Train Loss: 1.2061 | Train Acc: 0.7621
 Site-Painting                  (1) | Train Loss: 1.1624 | Train Acc: 0.7785
 Site-Sketch                    (5) | Train Loss: 1.2455 | Train Acc: 0.7592
===2023-06-25 17:13:25===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9677 | Train Acc: 0.4000
 Site-Clipart                   (0) | Train Loss: 1.8876 | Train Acc: 0.5652
 Site-Clipart                   (0) | Train Loss: 1.9552 | Train Acc: 0.4578
 Site-Clipart                   (0) | Train Loss: 1.9152 | Train Acc: 0.5032
 Site-Clipart                   (0) | Train Loss: 1.9241 | Train Acc: 0.4955
 Site-Real                      (1) | Train Loss: 1.8430 | Train Acc: 0.5635
 Site-Real                      (1) | Train Loss: 1.8285 | Train Acc: 0.6045
 Site-Real                      (1) | Train Loss: 1.7412 | Train Acc: 0.6774
 Site-Real                      (1) | Train Loss: 1.8387 | Train Acc: 0.5920
 Site-Painting                  (3) | Train Loss: 1.8635 | Train Acc: 0.5646
 Site-Painting                  (3) | Train Loss: 1.8940 | Train Acc: 0.4903
 Site-Painting                  (3) | Train Loss: 1.8257 | Train Acc: 0.5502
 Site-Sketch                    (5) | Train Loss: 1.8973 | Train Acc: 0.5236
 Site-Sketch                    (5) | Train Loss: 1.8964 | Train Acc: 0.4869
 Site-QuickDraw                 (2) | Train Loss: 2.2847 | Train Acc: 0.1774
 Site-Infograph                 (4) | Train Loss: 2.1139 | Train Acc: 0.3291
Average Train Accuracy: 0.4988
 Site-Clipart                   (0) | Val  Loss: 1.8421 | Val  Acc: 0.4868
 Site-Clipart                   (0) | Val  Loss: 1.8988 | Val  Acc: 0.4860
 Site-Clipart                   (0) | Val  Loss: 1.9235 | Val  Acc: 0.5133
 Site-Clipart                   (0) | Val  Loss: 1.9186 | Val  Acc: 0.4810
 Site-Clipart                   (0) | Val  Loss: 1.9547 | Val  Acc: 0.4373
 Site-Real                      (1) | Val  Loss: 1.7841 | Val  Acc: 0.5595
 Site-Real                      (1) | Val  Loss: 1.7761 | Val  Acc: 0.6780
 Site-Real                      (1) | Val  Loss: 1.7139 | Val  Acc: 0.6970
 Site-Real                      (1) | Val  Loss: 1.7579 | Val  Acc: 0.6667
 Site-Painting                  (3) | Val  Loss: 1.8183 | Val  Acc: 0.5408
 Site-Painting                  (3) | Val  Loss: 1.7872 | Val  Acc: 0.5036
 Site-Painting                  (3) | Val  Loss: 1.8778 | Val  Acc: 0.5156
 Site-Sketch                    (5) | Val  Loss: 1.8753 | Val  Acc: 0.5118
 Site-Sketch                    (5) | Val  Loss: 1.8963 | Val  Acc: 0.5000
 Site-QuickDraw                 (2) | Val  Loss: 2.2776 | Val  Acc: 0.1789
 Site-Infograph                 (4) | Val  Loss: 2.1095 | Val  Acc: 0.3141
Average Valid Accuracy: 0.5044
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4868
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4860
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5133
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4810
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4373
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.5595
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6780
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6970
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6667
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5408
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5036
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5156
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5118
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5000
 Best site-QuickDraw                (2)  | Epoch:1 | Val Acc: 0.1789
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.3141
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.7695 | Train Acc: 0.5739
 Site-Clipart                   (0) | Train Loss: 1.6824 | Train Acc: 0.6087
 Site-Clipart                   (0) | Train Loss: 1.7971 | Train Acc: 0.5511
 Site-Clipart                   (0) | Train Loss: 1.7245 | Train Acc: 0.5570
 Site-Clipart                   (0) | Train Loss: 1.7541 | Train Acc: 0.5860
 Site-Real                      (1) | Train Loss: 1.5871 | Train Acc: 0.7540
 Site-Real                      (1) | Train Loss: 1.5576 | Train Acc: 0.7175
 Site-Real                      (1) | Train Loss: 1.4853 | Train Acc: 0.8185
 Site-Real                      (1) | Train Loss: 1.6139 | Train Acc: 0.7241
 Site-Painting                  (3) | Train Loss: 1.6386 | Train Acc: 0.6122
 Site-Painting                  (3) | Train Loss: 1.7096 | Train Acc: 0.5777
 Site-Painting                  (3) | Train Loss: 1.6712 | Train Acc: 0.6090
 Site-Sketch                    (5) | Train Loss: 1.7113 | Train Acc: 0.6230
 Site-Sketch                    (5) | Train Loss: 1.7106 | Train Acc: 0.5805
 Site-QuickDraw                 (2) | Train Loss: 2.2111 | Train Acc: 0.2691
 Site-Infograph                 (4) | Train Loss: 2.1139 | Train Acc: 0.3333
Average Train Accuracy: 0.5935
 Site-Clipart                   (0) | Val  Loss: 1.6093 | Val  Acc: 0.5658
 Site-Clipart                   (0) | Val  Loss: 1.7227 | Val  Acc: 0.5701
 Site-Clipart                   (0) | Val  Loss: 1.7499 | Val  Acc: 0.6067
 Site-Clipart                   (0) | Val  Loss: 1.7015 | Val  Acc: 0.5762
 Site-Clipart                   (0) | Val  Loss: 1.7787 | Val  Acc: 0.5390
 Site-Real                      (1) | Val  Loss: 1.5162 | Val  Acc: 0.7262
 Site-Real                      (1) | Val  Loss: 1.5395 | Val  Acc: 0.7627
 Site-Real                      (1) | Val  Loss: 1.4840 | Val  Acc: 0.8061
 Site-Real                      (1) | Val  Loss: 1.5308 | Val  Acc: 0.7792
 Site-Painting                  (3) | Val  Loss: 1.5901 | Val  Acc: 0.7041
 Site-Painting                  (3) | Val  Loss: 1.5970 | Val  Acc: 0.5985
 Site-Painting                  (3) | Val  Loss: 1.6909 | Val  Acc: 0.5677
 Site-Sketch                    (5) | Val  Loss: 1.7058 | Val  Acc: 0.6378
 Site-Sketch                    (5) | Val  Loss: 1.7460 | Val  Acc: 0.5393
 Site-QuickDraw                 (2) | Val  Loss: 2.2207 | Val  Acc: 0.2477
 Site-Infograph                 (4) | Val  Loss: 2.0807 | Val  Acc: 0.3333
Average Valid Accuracy: 0.5975
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5658
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5701
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6067
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5762
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5390
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7262
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7627
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.8061
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7792
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.7041
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.5985
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.5677
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.6378
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5393
 Best site-QuickDraw                (2)  | Epoch:2 | Val Acc: 0.2477
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.6054 | Train Acc: 0.6348
 Site-Clipart                   (0) | Train Loss: 1.5013 | Train Acc: 0.6894
 Site-Clipart                   (0) | Train Loss: 1.6443 | Train Acc: 0.6267
 Site-Clipart                   (0) | Train Loss: 1.5455 | Train Acc: 0.6772
 Site-Clipart                   (0) | Train Loss: 1.5890 | Train Acc: 0.6448
 Site-Real                      (1) | Train Loss: 1.4223 | Train Acc: 0.8254
 Site-Real                      (1) | Train Loss: 1.3259 | Train Acc: 0.8475
 Site-Real                      (1) | Train Loss: 1.2980 | Train Acc: 0.8427
 Site-Real                      (1) | Train Loss: 1.3916 | Train Acc: 0.8333
 Site-Painting                  (3) | Train Loss: 1.4717 | Train Acc: 0.7143
 Site-Painting                  (3) | Train Loss: 1.5108 | Train Acc: 0.7087
 Site-Painting                  (3) | Train Loss: 1.4911 | Train Acc: 0.6817
 Site-Sketch                    (5) | Train Loss: 1.4929 | Train Acc: 0.7330
 Site-Sketch                    (5) | Train Loss: 1.5800 | Train Acc: 0.6704
 Site-QuickDraw                 (2) | Train Loss: 2.1309 | Train Acc: 0.2569
 Site-Infograph                 (4) | Train Loss: 2.0366 | Train Acc: 0.3632
Average Train Accuracy: 0.6719
 Site-Clipart                   (0) | Val  Loss: 1.4506 | Val  Acc: 0.6579
 Site-Clipart                   (0) | Val  Loss: 1.5176 | Val  Acc: 0.6542
 Site-Clipart                   (0) | Val  Loss: 1.5583 | Val  Acc: 0.6533
 Site-Clipart                   (0) | Val  Loss: 1.5069 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 1.6290 | Val  Acc: 0.6068
 Site-Real                      (1) | Val  Loss: 1.3176 | Val  Acc: 0.8095
 Site-Real                      (1) | Val  Loss: 1.3578 | Val  Acc: 0.8136
 Site-Real                      (1) | Val  Loss: 1.2733 | Val  Acc: 0.8606
 Site-Real                      (1) | Val  Loss: 1.3316 | Val  Acc: 0.8442
 Site-Painting                  (3) | Val  Loss: 1.4314 | Val  Acc: 0.7449
 Site-Painting                  (3) | Val  Loss: 1.4183 | Val  Acc: 0.6642
 Site-Painting                  (3) | Val  Loss: 1.4913 | Val  Acc: 0.6771
 Site-Sketch                    (5) | Val  Loss: 1.5483 | Val  Acc: 0.6614
 Site-Sketch                    (5) | Val  Loss: 1.5798 | Val  Acc: 0.6124
 Site-QuickDraw                 (2) | Val  Loss: 2.1654 | Val  Acc: 0.2615
 Site-Infograph                 (4) | Val  Loss: 1.9674 | Val  Acc: 0.3974
Average Valid Accuracy: 0.6616
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6579
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6542
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6533
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6068
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8095
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8136
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8606
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8442
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7449
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6642
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6771
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6614
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6124
 Best site-QuickDraw                (2)  | Epoch:3 | Val Acc: 0.2615
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.3974
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 3, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.3984 | Train Acc: 0.6957
 Site-Clipart                   (0) | Train Loss: 1.3759 | Train Acc: 0.7019
 Site-Clipart                   (0) | Train Loss: 1.4754 | Train Acc: 0.6756
 Site-Clipart                   (0) | Train Loss: 1.3833 | Train Acc: 0.7310
 Site-Clipart                   (0) | Train Loss: 1.4289 | Train Acc: 0.7240
 Site-Real                      (4) | Train Loss: 1.2606 | Train Acc: 0.8492
 Site-Real                      (4) | Train Loss: 1.1772 | Train Acc: 0.8475
 Site-Real                      (4) | Train Loss: 1.1257 | Train Acc: 0.8750
 Site-Real                      (4) | Train Loss: 1.2720 | Train Acc: 0.8218
 Site-Painting                  (1) | Train Loss: 1.2812 | Train Acc: 0.7211
 Site-Painting                  (1) | Train Loss: 1.3486 | Train Acc: 0.7039
 Site-Painting                  (1) | Train Loss: 1.3280 | Train Acc: 0.7197
 Site-Sketch                    (5) | Train Loss: 1.3753 | Train Acc: 0.6806
 Site-Sketch                    (5) | Train Loss: 1.4733 | Train Acc: 0.6667
 Site-QuickDraw                 (2) | Train Loss: 2.0489 | Train Acc: 0.2813
 Site-Infograph                 (3) | Train Loss: 1.9574 | Train Acc: 0.3761
Average Train Accuracy: 0.6919
 Site-Clipart                   (0) | Val  Loss: 1.2442 | Val  Acc: 0.7500
 Site-Clipart                   (0) | Val  Loss: 1.3502 | Val  Acc: 0.7570
 Site-Clipart                   (0) | Val  Loss: 1.3926 | Val  Acc: 0.7067
 Site-Clipart                   (0) | Val  Loss: 1.3472 | Val  Acc: 0.7000
 Site-Clipart                   (0) | Val  Loss: 1.4768 | Val  Acc: 0.6644
 Site-Real                      (4) | Val  Loss: 1.1572 | Val  Acc: 0.8571
 Site-Real                      (4) | Val  Loss: 1.1851 | Val  Acc: 0.8136
 Site-Real                      (4) | Val  Loss: 1.1165 | Val  Acc: 0.8727
 Site-Real                      (4) | Val  Loss: 1.1536 | Val  Acc: 0.8398
 Site-Painting                  (1) | Val  Loss: 1.2253 | Val  Acc: 0.8163
 Site-Painting                  (1) | Val  Loss: 1.2934 | Val  Acc: 0.7299
 Site-Painting                  (1) | Val  Loss: 1.3579 | Val  Acc: 0.7292
 Site-Sketch                    (5) | Val  Loss: 1.3199 | Val  Acc: 0.7874
 Site-Sketch                    (5) | Val  Loss: 1.4098 | Val  Acc: 0.6910
 Site-QuickDraw                 (2) | Val  Loss: 2.0961 | Val  Acc: 0.2890
 Site-Infograph                 (3) | Val  Loss: 1.9361 | Val  Acc: 0.4359
Average Valid Accuracy: 0.7150
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7570
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7067
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7000
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6644
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8571
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8136
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8727
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8398
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.8163
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7299
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7292
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.7874
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6910
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.2890
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 4, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 1.3116 | Train Acc: 0.7304
 Site-Clipart                   (3) | Train Loss: 1.2158 | Train Acc: 0.6957
 Site-Clipart                   (3) | Train Loss: 1.3715 | Train Acc: 0.6800
 Site-Clipart                   (3) | Train Loss: 1.2369 | Train Acc: 0.7373
 Site-Clipart                   (3) | Train Loss: 1.2906 | Train Acc: 0.7398
 Site-Real                      (2) | Train Loss: 1.1202 | Train Acc: 0.8651
 Site-Real                      (2) | Train Loss: 1.0160 | Train Acc: 0.8588
 Site-Real                      (2) | Train Loss: 0.9788 | Train Acc: 0.8871
 Site-Real                      (2) | Train Loss: 1.1168 | Train Acc: 0.8621
 Site-Painting                  (5) | Train Loss: 1.3274 | Train Acc: 0.7687
 Site-Painting                  (5) | Train Loss: 1.2407 | Train Acc: 0.7427
 Site-Painting                  (5) | Train Loss: 1.1867 | Train Acc: 0.7716
 Site-Sketch                    (0) | Train Loss: 1.2134 | Train Acc: 0.7487
 Site-Sketch                    (0) | Train Loss: 1.3370 | Train Acc: 0.6966
 Site-QuickDraw                 (1) | Train Loss: 2.0403 | Train Acc: 0.3058
 Site-Infograph                 (4) | Train Loss: 1.8839 | Train Acc: 0.3889
Average Train Accuracy: 0.7175
 Site-Clipart                   (3) | Val  Loss: 1.1418 | Val  Acc: 0.7500
 Site-Clipart                   (3) | Val  Loss: 1.2232 | Val  Acc: 0.8131
 Site-Clipart                   (3) | Val  Loss: 1.2361 | Val  Acc: 0.7733
 Site-Clipart                   (3) | Val  Loss: 1.2238 | Val  Acc: 0.7524
 Site-Clipart                   (3) | Val  Loss: 1.3287 | Val  Acc: 0.6847
 Site-Real                      (2) | Val  Loss: 1.0198 | Val  Acc: 0.8690
 Site-Real                      (2) | Val  Loss: 1.0455 | Val  Acc: 0.8559
 Site-Real                      (2) | Val  Loss: 0.9646 | Val  Acc: 0.8788
 Site-Real                      (2) | Val  Loss: 1.0127 | Val  Acc: 0.8918
 Site-Painting                  (5) | Val  Loss: 1.0755 | Val  Acc: 0.8469
 Site-Painting                  (5) | Val  Loss: 1.1299 | Val  Acc: 0.7737
 Site-Painting                  (5) | Val  Loss: 1.1821 | Val  Acc: 0.7760
 Site-Sketch                    (0) | Val  Loss: 1.2611 | Val  Acc: 0.7008
 Site-Sketch                    (0) | Val  Loss: 1.3064 | Val  Acc: 0.6517
 Site-QuickDraw                 (1) | Val  Loss: 2.0750 | Val  Acc: 0.3119
 Site-Infograph                 (4) | Val  Loss: 1.8335 | Val  Acc: 0.4038
Average Valid Accuracy: 0.7334
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7500
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.8131
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7733
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7524
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.6847
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8690
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8559
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8788
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8918
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8469
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7737
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7760
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.7008
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.6517
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.3119
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.4038
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 6 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (0) | Train Loss: 1.2156 | Train Acc: 0.7217
 Site-Clipart                   (0) | Train Loss: 1.1151 | Train Acc: 0.7391
 Site-Clipart                   (0) | Train Loss: 1.2801 | Train Acc: 0.7289
 Site-Clipart                   (0) | Train Loss: 1.1513 | Train Acc: 0.7310
 Site-Clipart                   (0) | Train Loss: 1.2289 | Train Acc: 0.7376
 Site-Real                      (3) | Train Loss: 1.0547 | Train Acc: 0.8730
 Site-Real                      (3) | Train Loss: 0.9389 | Train Acc: 0.8757
 Site-Real                      (3) | Train Loss: 0.9135 | Train Acc: 0.9113
 Site-Real                      (3) | Train Loss: 1.0553 | Train Acc: 0.8736
 Site-Painting                  (1) | Train Loss: 1.1632 | Train Acc: 0.7687
 Site-Painting                  (1) | Train Loss: 1.1237 | Train Acc: 0.7718
 Site-Painting                  (1) | Train Loss: 1.0702 | Train Acc: 0.7889
 Site-Sketch                    (5) | Train Loss: 1.1911 | Train Acc: 0.7277
 Site-Sketch                    (5) | Train Loss: 1.2250 | Train Acc: 0.7079
 Site-QuickDraw                 (2) | Train Loss: 1.9755 | Train Acc: 0.3517
 Site-Infograph                 (4) | Train Loss: 1.8498 | Train Acc: 0.4103
Average Train Accuracy: 0.7324
 Site-Clipart                   (0) | Val  Loss: 1.0709 | Val  Acc: 0.7763
 Site-Clipart                   (0) | Val  Loss: 1.1796 | Val  Acc: 0.7290
 Site-Clipart                   (0) | Val  Loss: 1.1319 | Val  Acc: 0.7733
 Site-Clipart                   (0) | Val  Loss: 1.1450 | Val  Acc: 0.7619
 Site-Clipart                   (0) | Val  Loss: 1.2840 | Val  Acc: 0.7153
 Site-Real                      (3) | Val  Loss: 0.9475 | Val  Acc: 0.9048
 Site-Real                      (3) | Val  Loss: 0.9658 | Val  Acc: 0.8475
 Site-Real                      (3) | Val  Loss: 0.9003 | Val  Acc: 0.8848
 Site-Real                      (3) | Val  Loss: 0.9446 | Val  Acc: 0.8874
 Site-Painting                  (1) | Val  Loss: 0.9863 | Val  Acc: 0.8469
 Site-Painting                  (1) | Val  Loss: 1.0624 | Val  Acc: 0.7445
 Site-Painting                  (1) | Val  Loss: 1.0966 | Val  Acc: 0.7917
 Site-Sketch                    (5) | Val  Loss: 1.1437 | Val  Acc: 0.7402
 Site-Sketch                    (5) | Val  Loss: 1.1912 | Val  Acc: 0.7360
 Site-QuickDraw                 (2) | Val  Loss: 2.0298 | Val  Acc: 0.3257
 Site-Infograph                 (4) | Val  Loss: 1.8011 | Val  Acc: 0.4167
Average Valid Accuracy: 0.7426
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7763
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7290
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7733
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7619
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7153
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.9048
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.8475
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.8848
 Best site-Real                     (3)  | Epoch:6 | Val Acc: 0.8874
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8469
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.7445
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.7917
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7402
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7360
 Best site-QuickDraw                (2)  | Epoch:6 | Val Acc: 0.3257
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.4167
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 5, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (1) | Train Loss: 1.1123 | Train Acc: 0.8087
 Site-Clipart                   (1) | Train Loss: 1.0449 | Train Acc: 0.7826
 Site-Clipart                   (1) | Train Loss: 1.1907 | Train Acc: 0.7333
 Site-Clipart                   (1) | Train Loss: 1.1002 | Train Acc: 0.7627
 Site-Clipart                   (1) | Train Loss: 1.1206 | Train Acc: 0.7715
 Site-Real                      (5) | Train Loss: 0.9847 | Train Acc: 0.8571
 Site-Real                      (5) | Train Loss: 0.8466 | Train Acc: 0.8983
 Site-Real                      (5) | Train Loss: 0.8447 | Train Acc: 0.9032
 Site-Real                      (5) | Train Loss: 0.9719 | Train Acc: 0.8879
 Site-Painting                  (0) | Train Loss: 1.0477 | Train Acc: 0.7483
 Site-Painting                  (0) | Train Loss: 1.1418 | Train Acc: 0.7816
 Site-Painting                  (0) | Train Loss: 1.0377 | Train Acc: 0.8201
 Site-Sketch                    (4) | Train Loss: 1.1263 | Train Acc: 0.7382
 Site-Sketch                    (4) | Train Loss: 1.1580 | Train Acc: 0.7079
 Site-QuickDraw                 (2) | Train Loss: 1.9306 | Train Acc: 0.3670
 Site-Infograph                 (3) | Train Loss: 1.7897 | Train Acc: 0.4017
Average Train Accuracy: 0.7481
 Site-Clipart                   (1) | Val  Loss: 0.9633 | Val  Acc: 0.8026
 Site-Clipart                   (1) | Val  Loss: 1.0686 | Val  Acc: 0.8037
 Site-Clipart                   (1) | Val  Loss: 1.0747 | Val  Acc: 0.8000
 Site-Clipart                   (1) | Val  Loss: 1.0804 | Val  Acc: 0.7381
 Site-Clipart                   (1) | Val  Loss: 1.1835 | Val  Acc: 0.7254
 Site-Real                      (5) | Val  Loss: 0.8992 | Val  Acc: 0.9167
 Site-Real                      (5) | Val  Loss: 0.8962 | Val  Acc: 0.9068
 Site-Real                      (5) | Val  Loss: 0.8240 | Val  Acc: 0.9212
 Site-Real                      (5) | Val  Loss: 0.8542 | Val  Acc: 0.8961
 Site-Painting                  (0) | Val  Loss: 0.9290 | Val  Acc: 0.8673
 Site-Painting                  (0) | Val  Loss: 1.0239 | Val  Acc: 0.7956
 Site-Painting                  (0) | Val  Loss: 1.0267 | Val  Acc: 0.8073
 Site-Sketch                    (4) | Val  Loss: 1.0295 | Val  Acc: 0.7717
 Site-Sketch                    (4) | Val  Loss: 1.1673 | Val  Acc: 0.6854
 Site-QuickDraw                 (2) | Val  Loss: 1.9090 | Val  Acc: 0.4358
 Site-Infograph                 (3) | Val  Loss: 1.7746 | Val  Acc: 0.4295
Average Valid Accuracy: 0.7690
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8026
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8037
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8000
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7381
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7254
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9167
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9068
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9212
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.8961
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.8673
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.7956
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.8073
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.7717
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.6854
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.4358
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.4295
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 4, 2, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 1.0400 | Train Acc: 0.7913
 Site-Clipart                   (0) | Train Loss: 0.9227 | Train Acc: 0.8075
 Site-Clipart                   (0) | Train Loss: 1.1005 | Train Acc: 0.7822
 Site-Clipart                   (0) | Train Loss: 0.9953 | Train Acc: 0.7690
 Site-Clipart                   (0) | Train Loss: 1.0076 | Train Acc: 0.8213
 Site-Real                      (1) | Train Loss: 0.8622 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.7849 | Train Acc: 0.9209
 Site-Real                      (1) | Train Loss: 0.7430 | Train Acc: 0.9234
 Site-Real                      (1) | Train Loss: 0.8708 | Train Acc: 0.9023
 Site-Painting                  (5) | Train Loss: 0.9472 | Train Acc: 0.8163
 Site-Painting                  (5) | Train Loss: 1.0257 | Train Acc: 0.7767
 Site-Painting                  (5) | Train Loss: 0.9675 | Train Acc: 0.7924
 Site-Sketch                    (2) | Train Loss: 1.0302 | Train Acc: 0.7696
 Site-Sketch                    (2) | Train Loss: 1.0407 | Train Acc: 0.7416
 Site-QuickDraw                 (3) | Train Loss: 1.8605 | Train Acc: 0.4220
 Site-Infograph                 (4) | Train Loss: 1.7492 | Train Acc: 0.4359
Average Train Accuracy: 0.7731
 Site-Clipart                   (0) | Val  Loss: 0.8791 | Val  Acc: 0.8158
 Site-Clipart                   (0) | Val  Loss: 0.9387 | Val  Acc: 0.8318
 Site-Clipart                   (0) | Val  Loss: 0.9785 | Val  Acc: 0.8067
 Site-Clipart                   (0) | Val  Loss: 0.9366 | Val  Acc: 0.7857
 Site-Clipart                   (0) | Val  Loss: 1.1195 | Val  Acc: 0.7186
 Site-Real                      (1) | Val  Loss: 0.7988 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.7584 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.7332 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.7611 | Val  Acc: 0.9264
 Site-Painting                  (5) | Val  Loss: 0.9006 | Val  Acc: 0.8061
 Site-Painting                  (5) | Val  Loss: 0.9443 | Val  Acc: 0.8248
 Site-Painting                  (5) | Val  Loss: 0.9433 | Val  Acc: 0.8177
 Site-Sketch                    (2) | Val  Loss: 0.9888 | Val  Acc: 0.7717
 Site-Sketch                    (2) | Val  Loss: 1.0885 | Val  Acc: 0.7022
 Site-QuickDraw                 (3) | Val  Loss: 1.8920 | Val  Acc: 0.3807
 Site-Infograph                 (4) | Val  Loss: 1.6935 | Val  Acc: 0.4551
Average Valid Accuracy: 0.7761
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8158
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8318
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8067
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.7857
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.7186
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9286
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9237
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9212
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9264
 Best site-Painting                 (5)  | Epoch:8 | Val Acc: 0.8061
 Best site-Painting                 (5)  | Epoch:8 | Val Acc: 0.8248
 Best site-Painting                 (5)  | Epoch:8 | Val Acc: 0.8177
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.7717
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.7022
 Best site-QuickDraw                (3)  | Epoch:8 | Val Acc: 0.3807
 Best site-Infograph                (4)  | Epoch:8 | Val Acc: 0.4551
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (2) | Train Loss: 0.9672 | Train Acc: 0.7913
 Site-Clipart                   (2) | Train Loss: 0.8629 | Train Acc: 0.8323
 Site-Clipart                   (2) | Train Loss: 1.0039 | Train Acc: 0.8222
 Site-Clipart                   (2) | Train Loss: 0.9263 | Train Acc: 0.7943
 Site-Clipart                   (2) | Train Loss: 0.9279 | Train Acc: 0.8190
 Site-Real                      (5) | Train Loss: 0.8157 | Train Acc: 0.8968
 Site-Real                      (5) | Train Loss: 0.7117 | Train Acc: 0.8927
 Site-Real                      (5) | Train Loss: 0.6722 | Train Acc: 0.9153
 Site-Real                      (5) | Train Loss: 0.7781 | Train Acc: 0.9195
 Site-Painting                  (1) | Train Loss: 0.9574 | Train Acc: 0.8027
 Site-Painting                  (1) | Train Loss: 0.9543 | Train Acc: 0.7961
 Site-Painting                  (1) | Train Loss: 0.8813 | Train Acc: 0.8339
 Site-Sketch                    (0) | Train Loss: 0.9555 | Train Acc: 0.7330
 Site-Sketch                    (0) | Train Loss: 0.9573 | Train Acc: 0.7603
 Site-QuickDraw                 (3) | Train Loss: 1.8766 | Train Acc: 0.4251
 Site-Infograph                 (4) | Train Loss: 1.6781 | Train Acc: 0.4744
Average Train Accuracy: 0.7818
 Site-Clipart                   (2) | Val  Loss: 0.7528 | Val  Acc: 0.8289
 Site-Clipart                   (2) | Val  Loss: 0.8830 | Val  Acc: 0.7944
 Site-Clipart                   (2) | Val  Loss: 0.9326 | Val  Acc: 0.8200
 Site-Clipart                   (2) | Val  Loss: 0.9064 | Val  Acc: 0.8000
 Site-Clipart                   (2) | Val  Loss: 1.0033 | Val  Acc: 0.7729
 Site-Real                      (5) | Val  Loss: 0.6887 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.7246 | Val  Acc: 0.9153
 Site-Real                      (5) | Val  Loss: 0.6769 | Val  Acc: 0.9030
 Site-Real                      (5) | Val  Loss: 0.6976 | Val  Acc: 0.9177
 Site-Painting                  (1) | Val  Loss: 0.8195 | Val  Acc: 0.8776
 Site-Painting                  (1) | Val  Loss: 0.8544 | Val  Acc: 0.7956
 Site-Painting                  (1) | Val  Loss: 0.9111 | Val  Acc: 0.8177
 Site-Sketch                    (0) | Val  Loss: 0.9395 | Val  Acc: 0.7953
 Site-Sketch                    (0) | Val  Loss: 1.0309 | Val  Acc: 0.6966
 Site-QuickDraw                 (3) | Val  Loss: 1.8448 | Val  Acc: 0.4679
 Site-Infograph                 (4) | Val  Loss: 1.5805 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7934
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8289
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.7944
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8200
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8000
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.7729
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9153
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9030
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9177
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8776
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.7956
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8177
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.7953
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.6966
 Best site-QuickDraw                (3)  | Epoch:9 | Val Acc: 0.4679
 Best site-Infograph                (4)  | Epoch:9 | Val Acc: 0.5385
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:9 | Test Acc: 0.8460
 Test site-Real                      (5)| Epoch:9 | Test Acc: 0.9071
 Test site-Painting                  (1)| Epoch:9 | Test Acc: 0.8465
 Test site-Sketch                    (0)| Epoch:9 | Test Acc: 0.8014
 Test site-QuickDraw                 (3)| Epoch:9 | Test Acc: 0.4810
 Test site-Infograph                 (4)| Epoch:9 | Test Acc: 0.4627
Clipart: 0.8460, Real: 0.9071, Painting: 0.8465, Sketch: 0.8014, QuickDraw: 0.4810, Infograph: 0.4627, 
Average Test Accuracy(group): 0.7241, Average Test Accuracy(individual): 0.8091,
domain std=0.1811, cluster std=0.1811, individual std=0.1316, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 10 ============
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (0) | Train Loss: 0.9414 | Train Acc: 0.7565
 Site-Clipart                   (0) | Train Loss: 0.8149 | Train Acc: 0.8323
 Site-Clipart                   (0) | Train Loss: 0.9701 | Train Acc: 0.8000
 Site-Clipart                   (0) | Train Loss: 0.8792 | Train Acc: 0.8165
 Site-Clipart                   (0) | Train Loss: 0.8870 | Train Acc: 0.8100
 Site-Real                      (1) | Train Loss: 0.7194 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.6605 | Train Acc: 0.8870
 Site-Real                      (1) | Train Loss: 0.6177 | Train Acc: 0.9234
 Site-Real                      (1) | Train Loss: 0.7247 | Train Acc: 0.9253
 Site-Painting                  (5) | Train Loss: 0.9626 | Train Acc: 0.8027
 Site-Painting                  (5) | Train Loss: 0.8560 | Train Acc: 0.8155
 Site-Painting                  (5) | Train Loss: 0.8016 | Train Acc: 0.8478
 Site-Sketch                    (4) | Train Loss: 0.9651 | Train Acc: 0.7801
 Site-Sketch                    (4) | Train Loss: 0.9473 | Train Acc: 0.7566
 Site-QuickDraw                 (2) | Train Loss: 1.6978 | Train Acc: 0.5229
 Site-Infograph                 (3) | Train Loss: 1.6255 | Train Acc: 0.4658
Average Train Accuracy: 0.7904
 Site-Clipart                   (0) | Val  Loss: 0.7011 | Val  Acc: 0.8289
 Site-Clipart                   (0) | Val  Loss: 0.8455 | Val  Acc: 0.8131
 Site-Clipart                   (0) | Val  Loss: 0.8398 | Val  Acc: 0.8267
 Site-Clipart                   (0) | Val  Loss: 0.8014 | Val  Acc: 0.8286
 Site-Clipart                   (0) | Val  Loss: 0.9752 | Val  Acc: 0.7661
 Site-Real                      (1) | Val  Loss: 0.6708 | Val  Acc: 0.8929
 Site-Real                      (1) | Val  Loss: 0.6634 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.6183 | Val  Acc: 0.9091
 Site-Real                      (1) | Val  Loss: 0.6345 | Val  Acc: 0.9307
 Site-Painting                  (5) | Val  Loss: 0.7677 | Val  Acc: 0.8469
 Site-Painting                  (5) | Val  Loss: 0.7748 | Val  Acc: 0.8467
 Site-Painting                  (5) | Val  Loss: 0.8567 | Val  Acc: 0.8177
 Site-Sketch                    (4) | Val  Loss: 0.8742 | Val  Acc: 0.7795
 Site-Sketch                    (4) | Val  Loss: 0.9580 | Val  Acc: 0.7416
 Site-QuickDraw                 (2) | Val  Loss: 1.7431 | Val  Acc: 0.5275
 Site-Infograph                 (3) | Val  Loss: 1.5597 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7993
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8289
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8131
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8267
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8286
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.7661
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.8929
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9091
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9307
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8469
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8467
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8177
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.7795
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.7416
 Best site-QuickDraw                (2)  | Epoch:10 | Val Acc: 0.5275
 Best site-Infograph                (3)  | Epoch:10 | Val Acc: 0.5256
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 11 ============
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (3) | Train Loss: 0.8796 | Train Acc: 0.8000
 Site-Clipart                   (3) | Train Loss: 0.7418 | Train Acc: 0.8323
 Site-Clipart                   (3) | Train Loss: 0.8918 | Train Acc: 0.8267
 Site-Clipart                   (3) | Train Loss: 0.8332 | Train Acc: 0.8038
 Site-Clipart                   (3) | Train Loss: 0.8607 | Train Acc: 0.8190
 Site-Real                      (4) | Train Loss: 0.6912 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.5899 | Train Acc: 0.9209
 Site-Real                      (4) | Train Loss: 0.6050 | Train Acc: 0.9194
 Site-Real                      (4) | Train Loss: 0.6676 | Train Acc: 0.9109
 Site-Painting                  (0) | Train Loss: 0.7877 | Train Acc: 0.8027
 Site-Painting                  (0) | Train Loss: 0.8301 | Train Acc: 0.8155
 Site-Painting                  (0) | Train Loss: 0.7789 | Train Acc: 0.8547
 Site-Sketch                    (2) | Train Loss: 0.8943 | Train Acc: 0.7539
 Site-Sketch                    (2) | Train Loss: 0.8735 | Train Acc: 0.7453
 Site-QuickDraw                 (1) | Train Loss: 1.6972 | Train Acc: 0.4924
 Site-Infograph                 (5) | Train Loss: 1.6074 | Train Acc: 0.4615
Average Train Accuracy: 0.7920
 Site-Clipart                   (3) | Val  Loss: 0.6870 | Val  Acc: 0.8421
 Site-Clipart                   (3) | Val  Loss: 0.7741 | Val  Acc: 0.8598
 Site-Clipart                   (3) | Val  Loss: 0.7706 | Val  Acc: 0.8400
 Site-Clipart                   (3) | Val  Loss: 0.8079 | Val  Acc: 0.8048
 Site-Clipart                   (3) | Val  Loss: 0.8935 | Val  Acc: 0.7966
 Site-Real                      (4) | Val  Loss: 0.6019 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.6246 | Val  Acc: 0.9153
 Site-Real                      (4) | Val  Loss: 0.5790 | Val  Acc: 0.9212
 Site-Real                      (4) | Val  Loss: 0.5959 | Val  Acc: 0.9307
 Site-Painting                  (0) | Val  Loss: 0.7421 | Val  Acc: 0.8673
 Site-Painting                  (0) | Val  Loss: 0.7377 | Val  Acc: 0.8467
 Site-Painting                  (0) | Val  Loss: 0.7862 | Val  Acc: 0.8333
 Site-Sketch                    (2) | Val  Loss: 0.8649 | Val  Acc: 0.8425
 Site-Sketch                    (2) | Val  Loss: 0.9342 | Val  Acc: 0.7360
 Site-QuickDraw                 (1) | Val  Loss: 1.6848 | Val  Acc: 0.5367
 Site-Infograph                 (5) | Val  Loss: 1.5681 | Val  Acc: 0.5192
Average Valid Accuracy: 0.8145
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8421
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8598
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8400
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8048
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.7966
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9153
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9212
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9307
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8673
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8467
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8333
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.8425
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.7360
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.5367
 Best site-Infograph                (5)  | Epoch:11 | Val Acc: 0.5192
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 12 ============
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (2) | Train Loss: 0.8409 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.6740 | Train Acc: 0.8634
 Site-Clipart                   (2) | Train Loss: 0.8960 | Train Acc: 0.8222
 Site-Clipart                   (2) | Train Loss: 0.7519 | Train Acc: 0.8323
 Site-Clipart                   (2) | Train Loss: 0.7991 | Train Acc: 0.8190
 Site-Real                      (0) | Train Loss: 0.6606 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.5748 | Train Acc: 0.9266
 Site-Real                      (0) | Train Loss: 0.5723 | Train Acc: 0.9073
 Site-Real                      (0) | Train Loss: 0.6538 | Train Acc: 0.9310
 Site-Painting                  (4) | Train Loss: 0.8062 | Train Acc: 0.7891
 Site-Painting                  (4) | Train Loss: 0.7213 | Train Acc: 0.8447
 Site-Painting                  (4) | Train Loss: 0.7274 | Train Acc: 0.8581
 Site-Sketch                    (5) | Train Loss: 0.8222 | Train Acc: 0.7749
 Site-Sketch                    (5) | Train Loss: 0.8958 | Train Acc: 0.7416
 Site-QuickDraw                 (1) | Train Loss: 1.5745 | Train Acc: 0.5199
 Site-Infograph                 (3) | Train Loss: 1.5969 | Train Acc: 0.5085
Average Train Accuracy: 0.8048
 Site-Clipart                   (2) | Val  Loss: 0.6285 | Val  Acc: 0.8553
 Site-Clipart                   (2) | Val  Loss: 0.7454 | Val  Acc: 0.8318
 Site-Clipart                   (2) | Val  Loss: 0.7948 | Val  Acc: 0.8267
 Site-Clipart                   (2) | Val  Loss: 0.7871 | Val  Acc: 0.7905
 Site-Clipart                   (2) | Val  Loss: 0.8691 | Val  Acc: 0.7932
 Site-Real                      (0) | Val  Loss: 0.5493 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.6034 | Val  Acc: 0.9153
 Site-Real                      (0) | Val  Loss: 0.5438 | Val  Acc: 0.9212
 Site-Real                      (0) | Val  Loss: 0.5564 | Val  Acc: 0.9264
 Site-Painting                  (4) | Val  Loss: 0.6580 | Val  Acc: 0.8776
 Site-Painting                  (4) | Val  Loss: 0.6631 | Val  Acc: 0.8686
 Site-Painting                  (4) | Val  Loss: 0.7680 | Val  Acc: 0.8229
 Site-Sketch                    (5) | Val  Loss: 0.8574 | Val  Acc: 0.7874
 Site-Sketch                    (5) | Val  Loss: 0.9506 | Val  Acc: 0.7191
 Site-QuickDraw                 (1) | Val  Loss: 1.6627 | Val  Acc: 0.5550
 Site-Infograph                 (3) | Val  Loss: 1.5146 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8111
============ Train epoch 13 ============
cnt=[1, 4, 2, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (4) | Train Loss: 0.8090 | Train Acc: 0.7913
 Site-Clipart                   (4) | Train Loss: 0.6515 | Train Acc: 0.8634
 Site-Clipart                   (4) | Train Loss: 0.8573 | Train Acc: 0.8311
 Site-Clipart                   (4) | Train Loss: 0.7186 | Train Acc: 0.8291
 Site-Clipart                   (4) | Train Loss: 0.7462 | Train Acc: 0.8484
 Site-Real                      (1) | Train Loss: 0.6280 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.5312 | Train Acc: 0.9379
 Site-Real                      (1) | Train Loss: 0.5200 | Train Acc: 0.9274
 Site-Real                      (1) | Train Loss: 0.6065 | Train Acc: 0.9167
 Site-Painting                  (5) | Train Loss: 0.7803 | Train Acc: 0.7823
 Site-Painting                  (5) | Train Loss: 0.7550 | Train Acc: 0.8252
 Site-Painting                  (5) | Train Loss: 0.6773 | Train Acc: 0.8754
 Site-Sketch                    (2) | Train Loss: 0.8222 | Train Acc: 0.7539
 Site-Sketch                    (2) | Train Loss: 0.8727 | Train Acc: 0.7715
 Site-QuickDraw                 (3) | Train Loss: 1.6055 | Train Acc: 0.5566
 Site-Infograph                 (0) | Train Loss: 1.5225 | Train Acc: 0.5171
Average Train Accuracy: 0.8083
 Site-Clipart                   (4) | Val  Loss: 0.5427 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.7096 | Val  Acc: 0.8131
 Site-Clipart                   (4) | Val  Loss: 0.7358 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.7295 | Val  Acc: 0.8095
 Site-Clipart                   (4) | Val  Loss: 0.8155 | Val  Acc: 0.7831
 Site-Real                      (1) | Val  Loss: 0.5214 | Val  Acc: 0.9167
 Site-Real                      (1) | Val  Loss: 0.5446 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.5330 | Val  Acc: 0.8970
 Site-Real                      (1) | Val  Loss: 0.5607 | Val  Acc: 0.9307
 Site-Painting                  (5) | Val  Loss: 0.6056 | Val  Acc: 0.8980
 Site-Painting                  (5) | Val  Loss: 0.7173 | Val  Acc: 0.8394
 Site-Painting                  (5) | Val  Loss: 0.7090 | Val  Acc: 0.8385
 Site-Sketch                    (2) | Val  Loss: 0.7587 | Val  Acc: 0.8189
 Site-Sketch                    (2) | Val  Loss: 0.8516 | Val  Acc: 0.7640
 Site-QuickDraw                 (3) | Val  Loss: 1.6006 | Val  Acc: 0.5459
 Site-Infograph                 (0) | Val  Loss: 1.4778 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8166
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8684
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8131
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8095
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.7831
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9167
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9237
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.8970
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9307
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.8980
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.8394
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.8385
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8189
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.7640
 Best site-QuickDraw                (3)  | Epoch:13 | Val Acc: 0.5459
 Best site-Infograph                (0)  | Epoch:13 | Val Acc: 0.5513
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 4, 1, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (3) | Train Loss: 0.7754 | Train Acc: 0.8435
 Site-Clipart                   (3) | Train Loss: 0.6255 | Train Acc: 0.8882
 Site-Clipart                   (3) | Train Loss: 0.7926 | Train Acc: 0.8089
 Site-Clipart                   (3) | Train Loss: 0.7335 | Train Acc: 0.8070
 Site-Clipart                   (3) | Train Loss: 0.7455 | Train Acc: 0.8439
 Site-Real                      (1) | Train Loss: 0.6091 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.5415 | Train Acc: 0.9322
 Site-Real                      (1) | Train Loss: 0.5147 | Train Acc: 0.9153
 Site-Real                      (1) | Train Loss: 0.5853 | Train Acc: 0.9224
 Site-Painting                  (5) | Train Loss: 0.7007 | Train Acc: 0.8095
 Site-Painting                  (5) | Train Loss: 0.6957 | Train Acc: 0.8641
 Site-Painting                  (5) | Train Loss: 0.6836 | Train Acc: 0.8616
 Site-Sketch                    (0) | Train Loss: 0.7907 | Train Acc: 0.7958
 Site-Sketch                    (0) | Train Loss: 0.9275 | Train Acc: 0.7491
 Site-QuickDraw                 (2) | Train Loss: 1.5326 | Train Acc: 0.5933
 Site-Infograph                 (4) | Train Loss: 1.5131 | Train Acc: 0.5214
Average Train Accuracy: 0.8168
 Site-Clipart                   (3) | Val  Loss: 0.5484 | Val  Acc: 0.8684
 Site-Clipart                   (3) | Val  Loss: 0.6637 | Val  Acc: 0.8411
 Site-Clipart                   (3) | Val  Loss: 0.7196 | Val  Acc: 0.8467
 Site-Clipart                   (3) | Val  Loss: 0.6892 | Val  Acc: 0.8524
 Site-Clipart                   (3) | Val  Loss: 0.8092 | Val  Acc: 0.7966
 Site-Real                      (1) | Val  Loss: 0.5004 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.5271 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.5132 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.5024 | Val  Acc: 0.9307
 Site-Painting                  (5) | Val  Loss: 0.5880 | Val  Acc: 0.8980
 Site-Painting                  (5) | Val  Loss: 0.6123 | Val  Acc: 0.8832
 Site-Painting                  (5) | Val  Loss: 0.6936 | Val  Acc: 0.8542
 Site-Sketch                    (0) | Val  Loss: 0.7822 | Val  Acc: 0.8110
 Site-Sketch                    (0) | Val  Loss: 0.8591 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 1.5541 | Val  Acc: 0.5688
 Site-Infograph                 (4) | Val  Loss: 1.5085 | Val  Acc: 0.5064
Average Valid Accuracy: 0.8228
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.8684
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.8411
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.8467
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.8524
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.7966
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9212
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9307
 Best site-Painting                 (5)  | Epoch:14 | Val Acc: 0.8980
 Best site-Painting                 (5)  | Epoch:14 | Val Acc: 0.8832
 Best site-Painting                 (5)  | Epoch:14 | Val Acc: 0.8542
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.8110
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.7753
 Best site-QuickDraw                (2)  | Epoch:14 | Val Acc: 0.5688
 Best site-Infograph                (4)  | Epoch:14 | Val Acc: 0.5064
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 15 ============
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (0) | Train Loss: 0.7078 | Train Acc: 0.8348
 Site-Clipart                   (0) | Train Loss: 0.6371 | Train Acc: 0.8261
 Site-Clipart                   (0) | Train Loss: 0.7487 | Train Acc: 0.8489
 Site-Clipart                   (0) | Train Loss: 0.6922 | Train Acc: 0.8386
 Site-Clipart                   (0) | Train Loss: 0.7214 | Train Acc: 0.8484
 Site-Real                      (2) | Train Loss: 0.5805 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.5141 | Train Acc: 0.9209
 Site-Real                      (2) | Train Loss: 0.4812 | Train Acc: 0.9153
 Site-Real                      (2) | Train Loss: 0.5506 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.7406 | Train Acc: 0.8027
 Site-Painting                  (4) | Train Loss: 0.6921 | Train Acc: 0.8641
 Site-Painting                  (4) | Train Loss: 0.6673 | Train Acc: 0.8685
 Site-Sketch                    (5) | Train Loss: 0.7798 | Train Acc: 0.7958
 Site-Sketch                    (5) | Train Loss: 0.7548 | Train Acc: 0.7865
 Site-QuickDraw                 (1) | Train Loss: 1.5490 | Train Acc: 0.5994
 Site-Infograph                 (3) | Train Loss: 1.5384 | Train Acc: 0.4957
Average Train Accuracy: 0.8183
 Site-Clipart                   (0) | Val  Loss: 0.5365 | Val  Acc: 0.8289
 Site-Clipart                   (0) | Val  Loss: 0.6583 | Val  Acc: 0.8598
 Site-Clipart                   (0) | Val  Loss: 0.6366 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.6972 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.7472 | Val  Acc: 0.8068
 Site-Real                      (2) | Val  Loss: 0.4869 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.4960 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.4800 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.4731 | Val  Acc: 0.9437
 Site-Painting                  (4) | Val  Loss: 0.5547 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.6002 | Val  Acc: 0.8759
 Site-Painting                  (4) | Val  Loss: 0.6363 | Val  Acc: 0.8750
 Site-Sketch                    (5) | Val  Loss: 0.7678 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.8339 | Val  Acc: 0.7640
 Site-QuickDraw                 (1) | Val  Loss: 1.5192 | Val  Acc: 0.5734
 Site-Infograph                 (3) | Val  Loss: 1.4358 | Val  Acc: 0.5192
Average Valid Accuracy: 0.8303
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8289
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8598
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8733
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8333
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8068
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9273
 Best site-Real                     (2)  | Epoch:15 | Val Acc: 0.9437
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8759
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8750
 Best site-Sketch                   (5)  | Epoch:15 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:15 | Val Acc: 0.7640
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.5734
 Best site-Infograph                (3)  | Epoch:15 | Val Acc: 0.5192
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 16 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (0) | Train Loss: 0.7283 | Train Acc: 0.8087
 Site-Clipart                   (0) | Train Loss: 0.5877 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.7351 | Train Acc: 0.8489
 Site-Clipart                   (0) | Train Loss: 0.6600 | Train Acc: 0.8513
 Site-Clipart                   (0) | Train Loss: 0.6732 | Train Acc: 0.8529
 Site-Real                      (3) | Train Loss: 0.5639 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.4849 | Train Acc: 0.9153
 Site-Real                      (3) | Train Loss: 0.4594 | Train Acc: 0.9274
 Site-Real                      (3) | Train Loss: 0.5255 | Train Acc: 0.9397
 Site-Painting                  (1) | Train Loss: 0.6316 | Train Acc: 0.8163
 Site-Painting                  (1) | Train Loss: 0.7669 | Train Acc: 0.8301
 Site-Painting                  (1) | Train Loss: 0.6156 | Train Acc: 0.8893
 Site-Sketch                    (5) | Train Loss: 0.7616 | Train Acc: 0.8010
 Site-Sketch                    (5) | Train Loss: 0.7701 | Train Acc: 0.7940
 Site-QuickDraw                 (2) | Train Loss: 1.4514 | Train Acc: 0.5963
 Site-Infograph                 (4) | Train Loss: 1.4526 | Train Acc: 0.5342
Average Train Accuracy: 0.8235
 Site-Clipart                   (0) | Val  Loss: 0.4842 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.6357 | Val  Acc: 0.8318
 Site-Clipart                   (0) | Val  Loss: 0.6638 | Val  Acc: 0.8400
 Site-Clipart                   (0) | Val  Loss: 0.6373 | Val  Acc: 0.8476
 Site-Clipart                   (0) | Val  Loss: 0.7528 | Val  Acc: 0.8169
 Site-Real                      (3) | Val  Loss: 0.4468 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.4738 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.4562 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.4765 | Val  Acc: 0.9394
 Site-Painting                  (1) | Val  Loss: 0.5642 | Val  Acc: 0.8980
 Site-Painting                  (1) | Val  Loss: 0.5502 | Val  Acc: 0.8686
===2023-06-25 19:17:02===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-06-25 19:17:09===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:15 | Test Acc: 0.8650
 Test site-Real                      (2)| Epoch:15 | Test Acc: 0.9219
===2023-06-25 19:19:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 1, 2, 1, 1, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 2.0298 | Train Acc: 0.2348
 Site-Clipart                   (0) | Train Loss: 2.0084 | Train Acc: 0.2733
 Site-Clipart                   (1) | Train Loss: 2.1224 | Train Acc: 0.2178
 Site-Clipart                   (5) | Train Loss: 2.0348 | Train Acc: 0.2627
 Site-Clipart                   (0) | Train Loss: 2.0627 | Train Acc: 0.2398
 Site-Real                      (5) | Train Loss: 2.0378 | Train Acc: 0.2937
 Site-Real                      (5) | Train Loss: 2.0002 | Train Acc: 0.2373
 Site-Real                      (0) | Train Loss: 1.8926 | Train Acc: 0.3831
 Site-Real                      (5) | Train Loss: 2.0279 | Train Acc: 0.2414
 Site-Painting                  (0) | Train Loss: 1.9863 | Train Acc: 0.3061
 Site-Painting                  (3) | Train Loss: 2.0086 | Train Acc: 0.3155
 Site-Painting                  (2) | Train Loss: 1.9685 | Train Acc: 0.3010
 Site-Sketch                    (5) | Train Loss: 2.0176 | Train Acc: 0.2723
 Site-Sketch                    (4) | Train Loss: 2.0209 | Train Acc: 0.2884
 Site-QuickDraw                 (0) | Train Loss: 2.3687 | Train Acc: 0.0703
 Site-Infograph                 (2) | Train Loss: 2.0541 | Train Acc: 0.2521
Average Train Accuracy: 0.2618
 Site-Clipart                   (0) | Val  Loss: 1.9861 | Val  Acc: 0.3158
 Site-Clipart                   (0) | Val  Loss: 2.0896 | Val  Acc: 0.3084
 Site-Clipart                   (1) | Val  Loss: 2.0490 | Val  Acc: 0.2667
 Site-Clipart                   (5) | Val  Loss: 2.0141 | Val  Acc: 0.2667
 Site-Clipart                   (0) | Val  Loss: 2.1086 | Val  Acc: 0.2441
 Site-Real                      (5) | Val  Loss: 1.9809 | Val  Acc: 0.2500
 Site-Real                      (5) | Val  Loss: 1.9599 | Val  Acc: 0.3136
 Site-Real                      (0) | Val  Loss: 1.8735 | Val  Acc: 0.3152
 Site-Real                      (5) | Val  Loss: 1.9291 | Val  Acc: 0.3290
 Site-Painting                  (0) | Val  Loss: 1.9648 | Val  Acc: 0.2857
 Site-Painting                  (3) | Val  Loss: 1.9918 | Val  Acc: 0.2920
 Site-Painting                  (2) | Val  Loss: 1.9651 | Val  Acc: 0.3177
 Site-Sketch                    (5) | Val  Loss: 1.9882 | Val  Acc: 0.2992
 Site-Sketch                    (4) | Val  Loss: 2.0098 | Val  Acc: 0.2697
 Site-QuickDraw                 (0) | Val  Loss: 2.3405 | Val  Acc: 0.1101
 Site-Infograph                 (2) | Val  Loss: 2.0822 | Val  Acc: 0.2756
Average Valid Accuracy: 0.2787
============ Train epoch 2 ============
cnt=[2, 2, 3, 7, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.9475 | Train Acc: 0.3043
 Site-Clipart                   (1) | Train Loss: 1.8879 | Train Acc: 0.3727
 Site-Clipart                   (5) | Train Loss: 2.0089 | Train Acc: 0.3200
 Site-Clipart                   (0) | Train Loss: 1.9369 | Train Acc: 0.3639
 Site-Clipart                   (2) | Train Loss: 1.9602 | Train Acc: 0.3348
 Site-Real                      (4) | Train Loss: 1.8859 | Train Acc: 0.4048
 Site-Real                      (3) | Train Loss: 1.8827 | Train Acc: 0.4124
 Site-Real                      (2) | Train Loss: 1.7478 | Train Acc: 0.5161
 Site-Real                      (3) | Train Loss: 1.8501 | Train Acc: 0.3851
 Site-Painting                  (3) | Train Loss: 1.8662 | Train Acc: 0.4354
 Site-Painting                  (3) | Train Loss: 1.8621 | Train Acc: 0.4175
 Site-Painting                  (1) | Train Loss: 1.8615 | Train Acc: 0.4256
 Site-Sketch                    (3) | Train Loss: 1.8989 | Train Acc: 0.3874
 Site-Sketch                    (3) | Train Loss: 1.9103 | Train Acc: 0.3895
 Site-QuickDraw                 (2) | Train Loss: 2.3541 | Train Acc: 0.0642
 Site-Infograph                 (3) | Train Loss: 1.9874 | Train Acc: 0.3675
Average Train Accuracy: 0.3688
 Site-Clipart                   (0) | Val  Loss: 1.9005 | Val  Acc: 0.3816
 Site-Clipart                   (1) | Val  Loss: 1.9696 | Val  Acc: 0.3738
 Site-Clipart                   (5) | Val  Loss: 1.9473 | Val  Acc: 0.3933
 Site-Clipart                   (0) | Val  Loss: 1.9008 | Val  Acc: 0.4048
 Site-Clipart                   (2) | Val  Loss: 2.0002 | Val  Acc: 0.3424
 Site-Real                      (4) | Val  Loss: 1.8276 | Val  Acc: 0.4048
 Site-Real                      (3) | Val  Loss: 1.8103 | Val  Acc: 0.4492
 Site-Real                      (2) | Val  Loss: 1.7477 | Val  Acc: 0.4606
 Site-Real                      (3) | Val  Loss: 1.7614 | Val  Acc: 0.5195
 Site-Painting                  (3) | Val  Loss: 1.8290 | Val  Acc: 0.4286
 Site-Painting                  (3) | Val  Loss: 1.8447 | Val  Acc: 0.4526
 Site-Painting                  (1) | Val  Loss: 1.8551 | Val  Acc: 0.4740
 Site-Sketch                    (3) | Val  Loss: 1.8590 | Val  Acc: 0.4646
 Site-Sketch                    (3) | Val  Loss: 1.8775 | Val  Acc: 0.4101
 Site-QuickDraw                 (2) | Val  Loss: 2.3222 | Val  Acc: 0.1055
 Site-Infograph                 (3) | Val  Loss: 1.9533 | Val  Acc: 0.3910
Average Valid Accuracy: 0.4035
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.3816
 Best site-Clipart                  (1)  | Epoch:2 | Val Acc: 0.3738
 Best site-Clipart                  (5)  | Epoch:2 | Val Acc: 0.3933
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.4048
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.3424
 Best site-Real                     (4)  | Epoch:2 | Val Acc: 0.4048
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.4492
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.4606
 Best site-Real                     (3)  | Epoch:2 | Val Acc: 0.5195
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.4286
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.4526
 Best site-Painting                 (1)  | Epoch:2 | Val Acc: 0.4740
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.4646
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.4101
 Best site-QuickDraw                (2)  | Epoch:2 | Val Acc: 0.1055
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.3910
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 3 ============
===2023-06-25 19:40:47===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 1, 2, 1, 1, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 2.0141 | Train Acc: 0.2261
 Site-Clipart                   (0) | Train Loss: 1.9947 | Train Acc: 0.2298
 Site-Clipart                   (1) | Train Loss: 2.1101 | Train Acc: 0.2044
 Site-Clipart                   (5) | Train Loss: 2.0199 | Train Acc: 0.2405
 Site-Clipart                   (0) | Train Loss: 2.0581 | Train Acc: 0.1991
 Site-Real                      (5) | Train Loss: 2.0469 | Train Acc: 0.2460
 Site-Real                      (5) | Train Loss: 1.9923 | Train Acc: 0.1751
 Site-Real                      (0) | Train Loss: 1.8998 | Train Acc: 0.3105
 Site-Real                      (5) | Train Loss: 2.0298 | Train Acc: 0.1724
 Site-Painting                  (0) | Train Loss: 1.9868 | Train Acc: 0.2517
 Site-Painting                  (3) | Train Loss: 1.9997 | Train Acc: 0.2621
 Site-Painting                  (2) | Train Loss: 1.9650 | Train Acc: 0.2457
 Site-Sketch                    (5) | Train Loss: 1.9990 | Train Acc: 0.2408
 Site-Sketch                    (4) | Train Loss: 1.9998 | Train Acc: 0.2397
 Site-QuickDraw                 (0) | Train Loss: 2.3853 | Train Acc: 0.0673
 Site-Infograph                 (2) | Train Loss: 2.0410 | Train Acc: 0.2564
Average Train Accuracy: 0.2230
 Site-Clipart                   (0) | Val  Loss: 1.9783 | Val  Acc: 0.2500
 Site-Clipart                   (0) | Val  Loss: 2.0805 | Val  Acc: 0.2430
 Site-Clipart                   (1) | Val  Loss: 2.0296 | Val  Acc: 0.2800
 Site-Clipart                   (5) | Val  Loss: 1.9982 | Val  Acc: 0.2524
 Site-Clipart                   (0) | Val  Loss: 2.0987 | Val  Acc: 0.1966
 Site-Real                      (5) | Val  Loss: 1.9896 | Val  Acc: 0.2262
 Site-Real                      (5) | Val  Loss: 1.9568 | Val  Acc: 0.2373
 Site-Real                      (0) | Val  Loss: 1.8768 | Val  Acc: 0.2364
 Site-Real                      (5) | Val  Loss: 1.9365 | Val  Acc: 0.2511
 Site-Painting                  (0) | Val  Loss: 1.9517 | Val  Acc: 0.2449
 Site-Painting                  (3) | Val  Loss: 1.9928 | Val  Acc: 0.2555
 Site-Painting                  (2) | Val  Loss: 1.9523 | Val  Acc: 0.2969
 Site-Sketch                    (5) | Val  Loss: 1.9756 | Val  Acc: 0.2520
 Site-Sketch                    (4) | Val  Loss: 2.0007 | Val  Acc: 0.2416
 Site-QuickDraw                 (0) | Val  Loss: 2.3615 | Val  Acc: 0.1055
 Site-Infograph                 (2) | Val  Loss: 2.0617 | Val  Acc: 0.2692
Average Valid Accuracy: 0.2399
============ Train epoch 2 ============
===2023-06-26 05:32:06===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1100 | Train Acc: 0.2522
 Site-Clipart                   (1) | Train Loss: 2.0453 | Train Acc: 0.3540
 Site-Clipart                   (1) | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-Clipart                   (1) | Train Loss: 2.0738 | Train Acc: 0.2911
 Site-Clipart                   (1) | Train Loss: 2.1005 | Train Acc: 0.2715
 Site-Real                      (0) | Train Loss: 2.0876 | Train Acc: 0.3571
 Site-Real                      (0) | Train Loss: 2.0787 | Train Acc: 0.3559
 Site-Real                      (0) | Train Loss: 2.0687 | Train Acc: 0.3589
 Site-Real                      (0) | Train Loss: 2.1167 | Train Acc: 0.2816
 Site-Painting                  (5) | Train Loss: 2.1118 | Train Acc: 0.3605
 Site-Painting                  (5) | Train Loss: 2.1080 | Train Acc: 0.3495
 Site-Painting                  (5) | Train Loss: 2.0811 | Train Acc: 0.3149
 Site-Sketch                    (4) | Train Loss: 2.0476 | Train Acc: 0.3508
 Site-Sketch                    (4) | Train Loss: 2.1048 | Train Acc: 0.3558
 Site-QuickDraw                 (2) | Train Loss: 2.3103 | Train Acc: 0.1713
 Site-Infograph                 (3) | Train Loss: 2.2553 | Train Acc: 0.1880
Average Train Accuracy: 0.3067
 Site-Clipart                   (1) | Val  Loss: 2.0400 | Val  Acc: 0.2500
 Site-Clipart                   (1) | Val  Loss: 2.1068 | Val  Acc: 0.2991
 Site-Clipart                   (1) | Val  Loss: 2.0650 | Val  Acc: 0.3333
 Site-Clipart                   (1) | Val  Loss: 2.0566 | Val  Acc: 0.3571
 Site-Clipart                   (1) | Val  Loss: 2.1134 | Val  Acc: 0.2678
 Site-Real                      (0) | Val  Loss: 2.0676 | Val  Acc: 0.3452
 Site-Real                      (0) | Val  Loss: 2.0913 | Val  Acc: 0.3220
 Site-Real                      (0) | Val  Loss: 2.0499 | Val  Acc: 0.4061
 Site-Real                      (0) | Val  Loss: 2.0611 | Val  Acc: 0.3766
 Site-Painting                  (5) | Val  Loss: 2.1028 | Val  Acc: 0.3776
 Site-Painting                  (5) | Val  Loss: 2.0467 | Val  Acc: 0.3650
 Site-Painting                  (5) | Val  Loss: 2.1136 | Val  Acc: 0.3385
 Site-Sketch                    (4) | Val  Loss: 2.0787 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0737 | Val  Acc: 0.3539
 Site-QuickDraw                 (2) | Val  Loss: 2.3222 | Val  Acc: 0.1881
 Site-Infograph                 (3) | Val  Loss: 2.2939 | Val  Acc: 0.1603
Average Valid Accuracy: 0.3189
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2991
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2678
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3452
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3220
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4061
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3766
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3776
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3650
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3385
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3539
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1881
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.1603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 4, 3, 1, 6, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (5) | Train Loss: 1.8842 | Train Acc: 0.5130
 Site-Clipart                   (5) | Train Loss: 1.8263 | Train Acc: 0.5652
 Site-Clipart                   (5) | Train Loss: 1.9126 | Train Acc: 0.4578
 Site-Clipart                   (0) | Train Loss: 1.8571 | Train Acc: 0.5538
 Site-Clipart                   (5) | Train Loss: 1.8855 | Train Acc: 0.5068
 Site-Real                      (2) | Train Loss: 1.8870 | Train Acc: 0.5635
 Site-Real                      (2) | Train Loss: 1.8220 | Train Acc: 0.6102
 Site-Real                      (2) | Train Loss: 1.7548 | Train Acc: 0.6895
 Site-Real                      (2) | Train Loss: 1.8404 | Train Acc: 0.5546
 Site-Painting                  (3) | Train Loss: 1.8251 | Train Acc: 0.5102
 Site-Painting                  (3) | Train Loss: 1.8837 | Train Acc: 0.4951
 Site-Painting                  (3) | Train Loss: 1.8179 | Train Acc: 0.5225
 Site-Sketch                    (5) | Train Loss: 1.8636 | Train Acc: 0.5602
 Site-Sketch                    (5) | Train Loss: 1.9010 | Train Acc: 0.4869
 Site-QuickDraw                 (1) | Train Loss: 2.2664 | Train Acc: 0.1804
 Site-Infograph                 (4) | Train Loss: 2.1371 | Train Acc: 0.2863
Average Train Accuracy: 0.5035
 Site-Clipart                   (5) | Val  Loss: 1.7433 | Val  Acc: 0.5526
 Site-Clipart                   (5) | Val  Loss: 1.8961 | Val  Acc: 0.5327
 Site-Clipart                   (5) | Val  Loss: 1.8536 | Val  Acc: 0.5933
 Site-Clipart                   (0) | Val  Loss: 1.8367 | Val  Acc: 0.5429
 Site-Clipart                   (5) | Val  Loss: 1.9229 | Val  Acc: 0.4475
 Site-Real                      (2) | Val  Loss: 1.7369 | Val  Acc: 0.5833
 Site-Real                      (2) | Val  Loss: 1.8047 | Val  Acc: 0.6102
 Site-Real                      (2) | Val  Loss: 1.7480 | Val  Acc: 0.6727
 Site-Real                      (2) | Val  Loss: 1.7803 | Val  Acc: 0.6407
 Site-Painting                  (3) | Val  Loss: 1.7997 | Val  Acc: 0.5918
 Site-Painting                  (3) | Val  Loss: 1.8115 | Val  Acc: 0.5036
 Site-Painting                  (3) | Val  Loss: 1.8601 | Val  Acc: 0.5208
 Site-Sketch                    (5) | Val  Loss: 1.8266 | Val  Acc: 0.5433
 Site-Sketch                    (5) | Val  Loss: 1.8995 | Val  Acc: 0.4719
 Site-QuickDraw                 (1) | Val  Loss: 2.2822 | Val  Acc: 0.1972
 Site-Infograph                 (4) | Val  Loss: 2.0818 | Val  Acc: 0.3205
Average Valid Accuracy: 0.5203
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5526
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5327
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5933
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5429
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4475
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5833
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6102
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6727
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6407
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5918
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5036
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5208
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5433
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4719
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.1972
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.3205
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[2, 1, 3, 5, 1, 4, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.6793 | Train Acc: 0.5739
 Site-Clipart                   (0) | Train Loss: 1.6082 | Train Acc: 0.6087
 Site-Clipart                   (0) | Train Loss: 1.7234 | Train Acc: 0.5467
 Site-Clipart                   (0) | Train Loss: 1.6539 | Train Acc: 0.5823
 Site-Clipart                   (0) | Train Loss: 1.6757 | Train Acc: 0.6109
 Site-Real                      (2) | Train Loss: 1.6080 | Train Acc: 0.6825
 Site-Real                      (2) | Train Loss: 1.5177 | Train Acc: 0.7345
 Site-Real                      (2) | Train Loss: 1.4924 | Train Acc: 0.7379
 Site-Real                      (2) | Train Loss: 1.6052 | Train Acc: 0.6868
 Site-Painting                  (4) | Train Loss: 1.6276 | Train Acc: 0.6327
 Site-Painting                  (4) | Train Loss: 1.6436 | Train Acc: 0.6117
 Site-Painting                  (4) | Train Loss: 1.6020 | Train Acc: 0.6713
 Site-Sketch                    (5) | Train Loss: 1.6425 | Train Acc: 0.6126
 Site-Sketch                    (5) | Train Loss: 1.6808 | Train Acc: 0.6180
 Site-QuickDraw                 (1) | Train Loss: 2.2056 | Train Acc: 0.1927
 Site-Infograph                 (3) | Train Loss: 2.0752 | Train Acc: 0.3034
Average Train Accuracy: 0.5879
 Site-Clipart                   (0) | Val  Loss: 1.5657 | Val  Acc: 0.6579
 Site-Clipart                   (0) | Val  Loss: 1.6322 | Val  Acc: 0.6636
 Site-Clipart                   (0) | Val  Loss: 1.6640 | Val  Acc: 0.6467
 Site-Clipart                   (0) | Val  Loss: 1.6475 | Val  Acc: 0.6143
 Site-Clipart                   (0) | Val  Loss: 1.7231 | Val  Acc: 0.5729
 Site-Real                      (2) | Val  Loss: 1.5538 | Val  Acc: 0.6429
 Site-Real                      (2) | Val  Loss: 1.5424 | Val  Acc: 0.7288
 Site-Real                      (2) | Val  Loss: 1.4454 | Val  Acc: 0.7576
 Site-Real                      (2) | Val  Loss: 1.5211 | Val  Acc: 0.7706
 Site-Painting                  (4) | Val  Loss: 1.5961 | Val  Acc: 0.6633
 Site-Painting                  (4) | Val  Loss: 1.5636 | Val  Acc: 0.5985
 Site-Painting                  (4) | Val  Loss: 1.6314 | Val  Acc: 0.6094
 Site-Sketch                    (5) | Val  Loss: 1.6448 | Val  Acc: 0.5827
 Site-Sketch                    (5) | Val  Loss: 1.7279 | Val  Acc: 0.5056
 Site-QuickDraw                 (1) | Val  Loss: 2.2162 | Val  Acc: 0.2248
 Site-Infograph                 (3) | Val  Loss: 2.0526 | Val  Acc: 0.3462
Average Valid Accuracy: 0.5991
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6579
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6636
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6467
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6143
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5729
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.6429
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7288
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7576
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7706
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6633
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.5985
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6094
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5827
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5056
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2248
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.3462
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 1, 4, 3, 1, 2, ]
cnt=[3, 5, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.5551 | Train Acc: 0.6000
 Site-Clipart                   (0) | Train Loss: 1.4462 | Train Acc: 0.7267
 Site-Clipart                   (0) | Train Loss: 1.5976 | Train Acc: 0.6533
 Site-Clipart                   (0) | Train Loss: 1.5134 | Train Acc: 0.6772
 Site-Clipart                   (0) | Train Loss: 1.5181 | Train Acc: 0.6833
 Site-Real                      (2) | Train Loss: 1.4024 | Train Acc: 0.7619
 Site-Real                      (2) | Train Loss: 1.3106 | Train Acc: 0.7627
 Site-Real                      (2) | Train Loss: 1.2795 | Train Acc: 0.7823
 Site-Real                      (2) | Train Loss: 1.3939 | Train Acc: 0.7500
 Site-Painting                  (3) | Train Loss: 1.4737 | Train Acc: 0.6735
 Site-Painting                  (3) | Train Loss: 1.4719 | Train Acc: 0.7087
 Site-Painting                  (3) | Train Loss: 1.4243 | Train Acc: 0.7197
 Site-Sketch                    (5) | Train Loss: 1.4752 | Train Acc: 0.6545
 Site-Sketch                    (5) | Train Loss: 1.5029 | Train Acc: 0.6255
 Site-QuickDraw                 (1) | Train Loss: 2.1274 | Train Acc: 0.2385
 Site-Infograph                 (4) | Train Loss: 1.9877 | Train Acc: 0.3803
Average Train Accuracy: 0.6499
 Site-Clipart                   (0) | Val  Loss: 1.3919 | Val  Acc: 0.7368
 Site-Clipart                   (0) | Val  Loss: 1.4940 | Val  Acc: 0.6822
 Site-Clipart                   (0) | Val  Loss: 1.4967 | Val  Acc: 0.7000
 Site-Clipart                   (0) | Val  Loss: 1.4678 | Val  Acc: 0.6762
 Site-Clipart                   (0) | Val  Loss: 1.5645 | Val  Acc: 0.6305
 Site-Real                      (2) | Val  Loss: 1.2677 | Val  Acc: 0.7738
 Site-Real                      (2) | Val  Loss: 1.3131 | Val  Acc: 0.7458
 Site-Real                      (2) | Val  Loss: 1.2446 | Val  Acc: 0.8121
 Site-Real                      (2) | Val  Loss: 1.2707 | Val  Acc: 0.8312
 Site-Painting                  (3) | Val  Loss: 1.3464 | Val  Acc: 0.7551
 Site-Painting                  (3) | Val  Loss: 1.4128 | Val  Acc: 0.7153
 Site-Painting                  (3) | Val  Loss: 1.4454 | Val  Acc: 0.6875
 Site-Sketch                    (5) | Val  Loss: 1.4520 | Val  Acc: 0.7087
 Site-Sketch                    (5) | Val  Loss: 1.5705 | Val  Acc: 0.6067
 Site-QuickDraw                 (1) | Val  Loss: 2.1376 | Val  Acc: 0.2477
 Site-Infograph                 (4) | Val  Loss: 1.9345 | Val  Acc: 0.3974
Average Valid Accuracy: 0.6692
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7368
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6822
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7000
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6762
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6305
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.7738
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.7458
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8121
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8312
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7551
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7153
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6875
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.7087
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6067
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.2477
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.3974
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 3, 1, 4, 1, 2, ]
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.3644 | Train Acc: 0.6870
 Site-Clipart                   (0) | Train Loss: 1.2667 | Train Acc: 0.7329
 Site-Clipart                   (0) | Train Loss: 1.4051 | Train Acc: 0.7289
 Site-Clipart                   (0) | Train Loss: 1.3103 | Train Acc: 0.7278
 Site-Clipart                   (0) | Train Loss: 1.3414 | Train Acc: 0.7285
 Site-Real                      (3) | Train Loss: 1.2112 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 1.0965 | Train Acc: 0.8418
 Site-Real                      (3) | Train Loss: 1.0490 | Train Acc: 0.8629
 Site-Real                      (3) | Train Loss: 1.1976 | Train Acc: 0.8362
 Site-Painting                  (1) | Train Loss: 1.2291 | Train Acc: 0.7619
 Site-Painting                  (1) | Train Loss: 1.1975 | Train Acc: 0.7427
 Site-Painting                  (1) | Train Loss: 1.1982 | Train Acc: 0.7751
 Site-Sketch                    (5) | Train Loss: 1.3063 | Train Acc: 0.7435
 Site-Sketch                    (5) | Train Loss: 1.3257 | Train Acc: 0.6929
 Site-QuickDraw                 (2) | Train Loss: 2.0871 | Train Acc: 0.2936
 Site-Infograph                 (4) | Train Loss: 1.8832 | Train Acc: 0.4231
Average Train Accuracy: 0.7133
 Site-Clipart                   (0) | Val  Loss: 1.2315 | Val  Acc: 0.7632
 Site-Clipart                   (0) | Val  Loss: 1.2935 | Val  Acc: 0.7757
 Site-Clipart                   (0) | Val  Loss: 1.3142 | Val  Acc: 0.7533
 Site-Clipart                   (0) | Val  Loss: 1.2743 | Val  Acc: 0.7190
 Site-Clipart                   (0) | Val  Loss: 1.3974 | Val  Acc: 0.6983
 Site-Real                      (3) | Val  Loss: 1.0977 | Val  Acc: 0.8571
 Site-Real                      (3) | Val  Loss: 1.0941 | Val  Acc: 0.8559
 Site-Real                      (3) | Val  Loss: 1.0164 | Val  Acc: 0.8606
 Site-Real                      (3) | Val  Loss: 1.0822 | Val  Acc: 0.8528
 Site-Painting                  (1) | Val  Loss: 1.1432 | Val  Acc: 0.7959
 Site-Painting                  (1) | Val  Loss: 1.2121 | Val  Acc: 0.7518
 Site-Painting                  (1) | Val  Loss: 1.2402 | Val  Acc: 0.7396
 Site-Sketch                    (5) | Val  Loss: 1.3271 | Val  Acc: 0.6693
 Site-Sketch                    (5) | Val  Loss: 1.3681 | Val  Acc: 0.6236
 Site-QuickDraw                 (2) | Val  Loss: 2.0774 | Val  Acc: 0.2936
 Site-Infograph                 (4) | Val  Loss: 1.8263 | Val  Acc: 0.4551
Average Valid Accuracy: 0.7166
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7632
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7757
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7533
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7190
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6983
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8571
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8559
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8606
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8528
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7959
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7518
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7396
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6693
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6236
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.2936
 Best site-Infograph                (4)  | Epoch:4 | Val Acc: 0.4551
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 5 ============
cnt=[5, 1, 3, 4, 1, 2, ]
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (0) | Train Loss: 1.2670 | Train Acc: 0.7565
 Site-Clipart                   (0) | Train Loss: 1.1105 | Train Acc: 0.7702
 Site-Clipart                   (0) | Train Loss: 1.2587 | Train Acc: 0.7333
 Site-Clipart                   (0) | Train Loss: 1.1662 | Train Acc: 0.7627
 Site-Clipart                   (0) | Train Loss: 1.2142 | Train Acc: 0.7602
 Site-Real                      (3) | Train Loss: 1.0286 | Train Acc: 0.8651
 Site-Real                      (3) | Train Loss: 0.9440 | Train Acc: 0.8644
 Site-Real                      (3) | Train Loss: 0.9035 | Train Acc: 0.8710
 Site-Real                      (3) | Train Loss: 1.0609 | Train Acc: 0.8621
 Site-Painting                  (2) | Train Loss: 1.0894 | Train Acc: 0.7823
 Site-Painting                  (2) | Train Loss: 1.1436 | Train Acc: 0.7816
 Site-Painting                  (2) | Train Loss: 1.0744 | Train Acc: 0.7958
 Site-Sketch                    (5) | Train Loss: 1.1888 | Train Acc: 0.6911
 Site-Sketch                    (5) | Train Loss: 1.1483 | Train Acc: 0.6779
 Site-QuickDraw                 (1) | Train Loss: 2.0064 | Train Acc: 0.3272
 Site-Infograph                 (4) | Train Loss: 1.8316 | Train Acc: 0.4017
Average Train Accuracy: 0.7314
 Site-Clipart                   (0) | Val  Loss: 1.0386 | Val  Acc: 0.8158
 Site-Clipart                   (0) | Val  Loss: 1.1413 | Val  Acc: 0.8131
 Site-Clipart                   (0) | Val  Loss: 1.1528 | Val  Acc: 0.7867
 Site-Clipart                   (0) | Val  Loss: 1.1394 | Val  Acc: 0.7714
 Site-Clipart                   (0) | Val  Loss: 1.2550 | Val  Acc: 0.7220
 Site-Real                      (3) | Val  Loss: 0.9566 | Val  Acc: 0.8452
 Site-Real                      (3) | Val  Loss: 0.9637 | Val  Acc: 0.8475
 Site-Real                      (3) | Val  Loss: 0.8849 | Val  Acc: 0.8970
 Site-Real                      (3) | Val  Loss: 0.9241 | Val  Acc: 0.8874
 Site-Painting                  (2) | Val  Loss: 1.0440 | Val  Acc: 0.8061
 Site-Painting                  (2) | Val  Loss: 1.0262 | Val  Acc: 0.8102
 Site-Painting                  (2) | Val  Loss: 1.0945 | Val  Acc: 0.7917
 Site-Sketch                    (5) | Val  Loss: 1.1562 | Val  Acc: 0.7323
 Site-Sketch                    (5) | Val  Loss: 1.2274 | Val  Acc: 0.6798
 Site-QuickDraw                 (1) | Val  Loss: 2.0081 | Val  Acc: 0.2936
 Site-Infograph                 (4) | Val  Loss: 1.7672 | Val  Acc: 0.4551
Average Valid Accuracy: 0.7472
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.8158
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.8131
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7867
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7714
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7220
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.8452
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.8475
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.8970
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.8874
 Best site-Painting                 (2)  | Epoch:5 | Val Acc: 0.8061
 Best site-Painting                 (2)  | Epoch:5 | Val Acc: 0.8102
 Best site-Painting                 (2)  | Epoch:5 | Val Acc: 0.7917
 Best site-Sketch                   (5)  | Epoch:5 | Val Acc: 0.7323
 Best site-Sketch                   (5)  | Epoch:5 | Val Acc: 0.6798
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.2936
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.4551
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[1, 3, 1, 5, 4, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (2) | Train Loss: 1.1404 | Train Acc: 0.7130
 Site-Clipart                   (4) | Train Loss: 0.9512 | Train Acc: 0.7826
 Site-Clipart                   (2) | Train Loss: 1.1281 | Train Acc: 0.7600
 Site-Clipart                   (2) | Train Loss: 1.0484 | Train Acc: 0.7943
 Site-Clipart                   (2) | Train Loss: 1.0661 | Train Acc: 0.7851
 Site-Real                      (0) | Train Loss: 0.9162 | Train Acc: 0.8889
 Site-Real                      (0) | Train Loss: 0.8141 | Train Acc: 0.8983
 Site-Real                      (0) | Train Loss: 0.7619 | Train Acc: 0.9153
 Site-Real                      (0) | Train Loss: 0.8914 | Train Acc: 0.8908
 Site-Painting                  (3) | Train Loss: 1.0358 | Train Acc: 0.7959
 Site-Painting                  (3) | Train Loss: 1.0266 | Train Acc: 0.7961
 Site-Painting                  (3) | Train Loss: 0.9710 | Train Acc: 0.7958
 Site-Sketch                    (4) | Train Loss: 1.0550 | Train Acc: 0.7382
 Site-Sketch                    (4) | Train Loss: 1.0329 | Train Acc: 0.7715
 Site-QuickDraw                 (1) | Train Loss: 1.8923 | Train Acc: 0.3547
 Site-Infograph                 (5) | Train Loss: 1.7214 | Train Acc: 0.4744
Average Train Accuracy: 0.7597
 Site-Clipart                   (2) | Val  Loss: 0.9245 | Val  Acc: 0.8026
 Site-Clipart                   (4) | Val  Loss: 1.0178 | Val  Acc: 0.7944
 Site-Clipart                   (2) | Val  Loss: 1.0554 | Val  Acc: 0.7933
 Site-Clipart                   (2) | Val  Loss: 0.9986 | Val  Acc: 0.7952
 Site-Clipart                   (2) | Val  Loss: 1.1233 | Val  Acc: 0.7458
 Site-Real                      (0) | Val  Loss: 0.8254 | Val  Acc: 0.8929
 Site-Real                      (0) | Val  Loss: 0.8164 | Val  Acc: 0.8644
 Site-Real                      (0) | Val  Loss: 0.7640 | Val  Acc: 0.8727
 Site-Real                      (0) | Val  Loss: 0.8013 | Val  Acc: 0.9221
 Site-Painting                  (3) | Val  Loss: 0.8931 | Val  Acc: 0.8469
 Site-Painting                  (3) | Val  Loss: 0.9578 | Val  Acc: 0.8248
 Site-Painting                  (3) | Val  Loss: 0.9331 | Val  Acc: 0.8177
 Site-Sketch                    (4) | Val  Loss: 1.0779 | Val  Acc: 0.7559
 Site-Sketch                    (4) | Val  Loss: 1.0832 | Val  Acc: 0.7191
 Site-QuickDraw                 (1) | Val  Loss: 1.9264 | Val  Acc: 0.3532
 Site-Infograph                 (5) | Val  Loss: 1.6845 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7688
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.8026
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7944
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7933
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7952
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7458
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8929
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8644
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8727
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.9221
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8469
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8248
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8177
 Best site-Sketch                   (4)  | Epoch:6 | Val Acc: 0.7559
 Best site-Sketch                   (4)  | Epoch:6 | Val Acc: 0.7191
 Best site-QuickDraw                (1)  | Epoch:6 | Val Acc: 0.3532
 Best site-Infograph                (5)  | Epoch:6 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 1, 4, 3, 4, 1, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (4) | Train Loss: 0.9203 | Train Acc: 0.8087
 Site-Clipart                   (0) | Train Loss: 0.8934 | Train Acc: 0.8323
 Site-Clipart                   (4) | Train Loss: 0.9800 | Train Acc: 0.8178
 Site-Clipart                   (4) | Train Loss: 0.9401 | Train Acc: 0.8228
 Site-Clipart                   (4) | Train Loss: 0.9740 | Train Acc: 0.7873
 Site-Real                      (2) | Train Loss: 0.7999 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.7196 | Train Acc: 0.9209
 Site-Real                      (2) | Train Loss: 0.6610 | Train Acc: 0.8952
 Site-Real                      (2) | Train Loss: 0.7893 | Train Acc: 0.9023
 Site-Painting                  (3) | Train Loss: 0.9154 | Train Acc: 0.8095
 Site-Painting                  (3) | Train Loss: 0.8718 | Train Acc: 0.8641
 Site-Painting                  (3) | Train Loss: 0.8408 | Train Acc: 0.8304
 Site-Sketch                    (0) | Train Loss: 0.9181 | Train Acc: 0.7644
 Site-Sketch                    (0) | Train Loss: 0.9410 | Train Acc: 0.7416
 Site-QuickDraw                 (1) | Train Loss: 1.8250 | Train Acc: 0.4067
 Site-Infograph                 (5) | Train Loss: 1.6290 | Train Acc: 0.4915
Average Train Accuracy: 0.7870
 Site-Clipart                   (4) | Val  Loss: 0.8155 | Val  Acc: 0.8421
 Site-Clipart                   (0) | Val  Loss: 0.9066 | Val  Acc: 0.8224
 Site-Clipart                   (4) | Val  Loss: 0.9768 | Val  Acc: 0.7933
 Site-Clipart                   (4) | Val  Loss: 0.9173 | Val  Acc: 0.7952
 Site-Clipart                   (4) | Val  Loss: 1.0160 | Val  Acc: 0.7831
 Site-Real                      (2) | Val  Loss: 0.7312 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.7098 | Val  Acc: 0.9068
 Site-Real                      (2) | Val  Loss: 0.6471 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.7130 | Val  Acc: 0.9004
 Site-Painting                  (3) | Val  Loss: 0.7961 | Val  Acc: 0.8367
 Site-Painting                  (3) | Val  Loss: 0.8492 | Val  Acc: 0.8321
 Site-Painting                  (3) | Val  Loss: 0.8551 | Val  Acc: 0.8125
 Site-Sketch                    (0) | Val  Loss: 0.9169 | Val  Acc: 0.8268
 Site-Sketch                    (0) | Val  Loss: 0.9942 | Val  Acc: 0.7135
 Site-QuickDraw                 (1) | Val  Loss: 1.8513 | Val  Acc: 0.4220
 Site-Infograph                 (5) | Val  Loss: 1.5720 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7903
 Best site-Clipart                  (4)  | Epoch:7 | Val Acc: 0.8421
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8224
 Best site-Clipart                  (4)  | Epoch:7 | Val Acc: 0.7933
 Best site-Clipart                  (4)  | Epoch:7 | Val Acc: 0.7952
 Best site-Clipart                  (4)  | Epoch:7 | Val Acc: 0.7831
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9048
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9068
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9273
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9004
 Best site-Painting                 (3)  | Epoch:7 | Val Acc: 0.8367
 Best site-Painting                 (3)  | Epoch:7 | Val Acc: 0.8321
 Best site-Painting                 (3)  | Epoch:7 | Val Acc: 0.8125
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.8268
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7135
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.4220
 Best site-Infograph                (5)  | Epoch:7 | Val Acc: 0.5256
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 1, 4, 3, 1, 2, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 0.8878 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.7671 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.9206 | Train Acc: 0.8356
 Site-Clipart                   (0) | Train Loss: 0.8297 | Train Acc: 0.8196
 Site-Clipart                   (0) | Train Loss: 0.8545 | Train Acc: 0.8235
 Site-Real                      (2) | Train Loss: 0.7202 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.6291 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.6085 | Train Acc: 0.9073
 Site-Real                      (2) | Train Loss: 0.7130 | Train Acc: 0.9224
 Site-Painting                  (3) | Train Loss: 0.8463 | Train Acc: 0.8163
 Site-Painting                  (3) | Train Loss: 0.8517 | Train Acc: 0.8155
 Site-Painting                  (3) | Train Loss: 0.7672 | Train Acc: 0.8443
 Site-Sketch                    (5) | Train Loss: 0.8205 | Train Acc: 0.8220
 Site-Sketch                    (5) | Train Loss: 0.9600 | Train Acc: 0.7903
 Site-QuickDraw                 (1) | Train Loss: 1.6710 | Train Acc: 0.4801
 Site-Infograph                 (4) | Train Loss: 1.5896 | Train Acc: 0.4701
Average Train Accuracy: 0.8060
 Site-Clipart                   (0) | Val  Loss: 0.7203 | Val  Acc: 0.8289
 Site-Clipart                   (0) | Val  Loss: 0.7991 | Val  Acc: 0.8318
 Site-Clipart                   (0) | Val  Loss: 0.8250 | Val  Acc: 0.8200
 Site-Clipart                   (0) | Val  Loss: 0.7997 | Val  Acc: 0.8190
 Site-Clipart                   (0) | Val  Loss: 0.9190 | Val  Acc: 0.8136
 Site-Real                      (2) | Val  Loss: 0.6004 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.6344 | Val  Acc: 0.9153
 Site-Real                      (2) | Val  Loss: 0.5919 | Val  Acc: 0.8970
 Site-Real                      (2) | Val  Loss: 0.6306 | Val  Acc: 0.9221
 Site-Painting                  (3) | Val  Loss: 0.6975 | Val  Acc: 0.8776
 Site-Painting                  (3) | Val  Loss: 0.7299 | Val  Acc: 0.8321
 Site-Painting                  (3) | Val  Loss: 0.8035 | Val  Acc: 0.8490
 Site-Sketch                    (5) | Val  Loss: 0.8683 | Val  Acc: 0.8031
 Site-Sketch                    (5) | Val  Loss: 0.9232 | Val  Acc: 0.7640
 Site-QuickDraw                 (1) | Val  Loss: 1.7289 | Val  Acc: 0.5092
 Site-Infograph                 (4) | Val  Loss: 1.5200 | Val  Acc: 0.5449
Average Valid Accuracy: 0.8105
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8289
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8318
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8200
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8190
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8136
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9405
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9153
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.8970
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9221
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8776
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8321
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8490
 Best site-Sketch                   (5)  | Epoch:8 | Val Acc: 0.8031
 Best site-Sketch                   (5)  | Epoch:8 | Val Acc: 0.7640
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.5092
 Best site-Infograph                (4)  | Epoch:8 | Val Acc: 0.5449
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 5, 4, 3, 2, 1, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (1) | Train Loss: 0.7660 | Train Acc: 0.8435
 Site-Clipart                   (1) | Train Loss: 0.7260 | Train Acc: 0.8323
 Site-Clipart                   (1) | Train Loss: 0.8520 | Train Acc: 0.8489
 Site-Clipart                   (1) | Train Loss: 0.7640 | Train Acc: 0.8006
 Site-Clipart                   (1) | Train Loss: 0.7925 | Train Acc: 0.8439
 Site-Real                      (2) | Train Loss: 0.6168 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.5140 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.5024 | Train Acc: 0.9355
 Site-Real                      (2) | Train Loss: 0.5987 | Train Acc: 0.9224
 Site-Painting                  (3) | Train Loss: 0.7245 | Train Acc: 0.8299
 Site-Painting                  (3) | Train Loss: 0.7567 | Train Acc: 0.8592
 Site-Painting                  (3) | Train Loss: 0.6917 | Train Acc: 0.8616
 Site-Sketch                    (4) | Train Loss: 0.7596 | Train Acc: 0.8168
 Site-Sketch                    (4) | Train Loss: 0.7723 | Train Acc: 0.7828
 Site-QuickDraw                 (0) | Train Loss: 1.5550 | Train Acc: 0.5474
 Site-Infograph                 (5) | Train Loss: 1.5532 | Train Acc: 0.4915
Average Train Accuracy: 0.8169
 Site-Clipart                   (1) | Val  Loss: 0.6312 | Val  Acc: 0.8289
 Site-Clipart                   (1) | Val  Loss: 0.7321 | Val  Acc: 0.8598
 Site-Clipart                   (1) | Val  Loss: 0.7763 | Val  Acc: 0.8400
 Site-Clipart                   (1) | Val  Loss: 0.6954 | Val  Acc: 0.8476
 Site-Clipart                   (1) | Val  Loss: 0.8480 | Val  Acc: 0.8136
 Site-Real                      (2) | Val  Loss: 0.5432 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.5176 | Val  Acc: 0.9492
 Site-Real                      (2) | Val  Loss: 0.5052 | Val  Acc: 0.9212
 Site-Real                      (2) | Val  Loss: 0.5469 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.6480 | Val  Acc: 0.8673
 Site-Painting                  (3) | Val  Loss: 0.6928 | Val  Acc: 0.8467
 Site-Painting                  (3) | Val  Loss: 0.7113 | Val  Acc: 0.8385
 Site-Sketch                    (4) | Val  Loss: 0.7930 | Val  Acc: 0.7638
 Site-Sketch                    (4) | Val  Loss: 0.8657 | Val  Acc: 0.7640
 Site-QuickDraw                 (0) | Val  Loss: 1.6101 | Val  Acc: 0.5780
 Site-Infograph                 (5) | Val  Loss: 1.4757 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8237
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8289
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8598
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8400
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8476
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8136
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9492
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9212
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9437
 Best site-Painting                 (3)  | Epoch:9 | Val Acc: 0.8673
 Best site-Painting                 (3)  | Epoch:9 | Val Acc: 0.8467
 Best site-Painting                 (3)  | Epoch:9 | Val Acc: 0.8385
 Best site-Sketch                   (4)  | Epoch:9 | Val Acc: 0.7638
 Best site-Sketch                   (4)  | Epoch:9 | Val Acc: 0.7640
 Best site-QuickDraw                (0)  | Epoch:9 | Val Acc: 0.5780
 Best site-Infograph                (5)  | Epoch:9 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (1)| Epoch:9 | Test Acc: 0.8498
 Test site-Real                      (2)| Epoch:9 | Test Acc: 0.9285
 Test site-Painting                  (3)| Epoch:9 | Test Acc: 0.8853
 Test site-Sketch                    (4)| Epoch:9 | Test Acc: 0.8357
 Test site-QuickDraw                 (0)| Epoch:9 | Test Acc: 0.5660
 Test site-Infograph                 (5)| Epoch:9 | Test Acc: 0.5114
Clipart: 0.8498, Real: 0.9285, Painting: 0.8853, Sketch: 0.8357, QuickDraw: 0.5660, Infograph: 0.5114, 
Average Test Accuracy(group): 0.7628, Average Test Accuracy(individual): 0.8355,
domain std=0.1619, cluster std=0.1619, individual std=0.1175, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 1, 6, 1, 2, 3, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (2) | Train Loss: 0.7161 | Train Acc: 0.8435
 Site-Clipart                   (2) | Train Loss: 0.6301 | Train Acc: 0.8634
 Site-Clipart                   (2) | Train Loss: 0.7835 | Train Acc: 0.8356
 Site-Clipart                   (2) | Train Loss: 0.7000 | Train Acc: 0.8386
 Site-Clipart                   (2) | Train Loss: 0.7520 | Train Acc: 0.8258
 Site-Real                      (5) | Train Loss: 0.5802 | Train Acc: 0.8810
 Site-Real                      (5) | Train Loss: 0.4976 | Train Acc: 0.9661
 Site-Real                      (5) | Train Loss: 0.4935 | Train Acc: 0.9274
 Site-Real                      (3) | Train Loss: 0.5473 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.6647 | Train Acc: 0.8571
 Site-Painting                  (0) | Train Loss: 0.7220 | Train Acc: 0.8398
 Site-Painting                  (0) | Train Loss: 0.6909 | Train Acc: 0.8512
 Site-Sketch                    (4) | Train Loss: 0.7340 | Train Acc: 0.8063
 Site-Sketch                    (4) | Train Loss: 0.7753 | Train Acc: 0.7715
 Site-QuickDraw                 (1) | Train Loss: 1.4400 | Train Acc: 0.5933
 Site-Infograph                 (2) | Train Loss: 1.5039 | Train Acc: 0.5214
Average Train Accuracy: 0.8226
 Site-Clipart                   (2) | Val  Loss: 0.5983 | Val  Acc: 0.8289
 Site-Clipart                   (2) | Val  Loss: 0.6913 | Val  Acc: 0.8692
 Site-Clipart                   (2) | Val  Loss: 0.6851 | Val  Acc: 0.8600
 Site-Clipart                   (2) | Val  Loss: 0.6947 | Val  Acc: 0.8095
 Site-Clipart                   (2) | Val  Loss: 0.7654 | Val  Acc: 0.8237
 Site-Real                      (5) | Val  Loss: 0.4898 | Val  Acc: 0.9405
 Site-Real                      (5) | Val  Loss: 0.5009 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.4471 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.5171 | Val  Acc: 0.9307
 Site-Painting                  (0) | Val  Loss: 0.5543 | Val  Acc: 0.8980
 Site-Painting                  (0) | Val  Loss: 0.6761 | Val  Acc: 0.8175
 Site-Painting                  (0) | Val  Loss: 0.6488 | Val  Acc: 0.8646
 Site-Sketch                    (4) | Val  Loss: 0.7274 | Val  Acc: 0.7953
 Site-Sketch                    (4) | Val  Loss: 0.7824 | Val  Acc: 0.7697
 Site-QuickDraw                 (1) | Val  Loss: 1.5465 | Val  Acc: 0.6101
 Site-Infograph                 (2) | Val  Loss: 1.4054 | Val  Acc: 0.5449
Average Valid Accuracy: 0.8288
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8289
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8692
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8600
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8095
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8237
 Best site-Real                     (5)  | Epoch:10 | Val Acc: 0.9405
 Best site-Real                     (5)  | Epoch:10 | Val Acc: 0.9407
 Best site-Real                     (5)  | Epoch:10 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9307
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8980
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8175
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8646
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.7953
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.7697
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.6101
 Best site-Infograph                (2)  | Epoch:10 | Val Acc: 0.5449
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 11 ============
cnt=[5, 1, 3, 4, 2, 1, ]
cnt=[1, 3, 2, 1, 4, 5, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.6854 | Train Acc: 0.8261
 Site-Clipart                   (0) | Train Loss: 0.5769 | Train Acc: 0.8634
 Site-Clipart                   (0) | Train Loss: 0.7264 | Train Acc: 0.8533
 Site-Clipart                   (0) | Train Loss: 0.6383 | Train Acc: 0.8481
 Site-Clipart                   (0) | Train Loss: 0.7077 | Train Acc: 0.8258
 Site-Real                      (3) | Train Loss: 0.5398 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.4577 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.4396 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.4912 | Train Acc: 0.9282
 Site-Painting                  (2) | Train Loss: 0.6313 | Train Acc: 0.8571
 Site-Painting                  (2) | Train Loss: 0.6300 | Train Acc: 0.8689
 Site-Painting                  (2) | Train Loss: 0.6390 | Train Acc: 0.8512
 Site-Sketch                    (4) | Train Loss: 0.6824 | Train Acc: 0.8272
 Site-Sketch                    (4) | Train Loss: 0.7071 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 1.5254 | Train Acc: 0.6024
 Site-Infograph                 (5) | Train Loss: 1.4223 | Train Acc: 0.5513
Average Train Accuracy: 0.8316
 Site-Clipart                   (0) | Val  Loss: 0.6198 | Val  Acc: 0.8158
 Site-Clipart                   (0) | Val  Loss: 0.6232 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.6555 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.6569 | Val  Acc: 0.8190
 Site-Clipart                   (0) | Val  Loss: 0.7210 | Val  Acc: 0.8271
 Site-Real                      (3) | Val  Loss: 0.4695 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.4498 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.4639 | Val  Acc: 0.9091
 Site-Real                      (3) | Val  Loss: 0.4840 | Val  Acc: 0.9177
 Site-Painting                  (2) | Val  Loss: 0.5818 | Val  Acc: 0.8367
 Site-Painting                  (2) | Val  Loss: 0.5969 | Val  Acc: 0.8613
 Site-Painting                  (2) | Val  Loss: 0.6401 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.6675 | Val  Acc: 0.8110
 Site-Sketch                    (4) | Val  Loss: 0.7795 | Val  Acc: 0.7640
 Site-QuickDraw                 (1) | Val  Loss: 1.4427 | Val  Acc: 0.6330
 Site-Infograph                 (5) | Val  Loss: 1.3648 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8263
============ Train epoch 12 ============
cnt=[5, 1, 3, 4, 2, 1, ]
cnt=[1, 5, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (0) | Train Loss: 0.6467 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.5411 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.6875 | Train Acc: 0.8489
 Site-Clipart                   (4) | Train Loss: 0.6137 | Train Acc: 0.8544
 Site-Clipart                   (4) | Train Loss: 0.6497 | Train Acc: 0.8416
 Site-Real                      (3) | Train Loss: 0.5267 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.4193 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.4274 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.4866 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.7488 | Train Acc: 0.8776
 Site-Painting                  (2) | Train Loss: 0.6447 | Train Acc: 0.8447
 Site-Painting                  (2) | Train Loss: 0.5946 | Train Acc: 0.8408
 Site-Sketch                    (0) | Train Loss: 0.6551 | Train Acc: 0.8325
 Site-Sketch                    (0) | Train Loss: 0.7095 | Train Acc: 0.7903
 Site-QuickDraw                 (1) | Train Loss: 1.2896 | Train Acc: 0.6208
 Site-Infograph                 (5) | Train Loss: 1.4330 | Train Acc: 0.5342
Average Train Accuracy: 0.8348
 Site-Clipart                   (0) | Val  Loss: 0.5384 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.6044 | Val  Acc: 0.8598
 Site-Clipart                   (0) | Val  Loss: 0.6264 | Val  Acc: 0.8467
 Site-Clipart                   (4) | Val  Loss: 0.5975 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.7069 | Val  Acc: 0.8373
 Site-Real                      (3) | Val  Loss: 0.4152 | Val  Acc: 0.9643
 Site-Real                      (3) | Val  Loss: 0.4074 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.3967 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.4380 | Val  Acc: 0.9307
 Site-Painting                  (2) | Val  Loss: 0.5316 | Val  Acc: 0.8776
 Site-Painting                  (2) | Val  Loss: 0.5718 | Val  Acc: 0.8540
 Site-Painting                  (2) | Val  Loss: 0.5985 | Val  Acc: 0.8646
 Site-Sketch                    (0) | Val  Loss: 0.6598 | Val  Acc: 0.8425
 Site-Sketch                    (0) | Val  Loss: 0.7422 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.4176 | Val  Acc: 0.6147
 Site-Infograph                 (5) | Val  Loss: 1.3639 | Val  Acc: 0.6026
Average Valid Accuracy: 0.8436
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8684
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8598
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8467
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8571
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8373
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9643
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9333
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9307
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.8776
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.8540
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.8646
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8425
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.7865
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.6147
 Best site-Infograph                (5)  | Epoch:12 | Val Acc: 0.6026
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 1, 4, 4, 1, 3, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (2) | Train Loss: 0.6240 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.5580 | Train Acc: 0.8758
 Site-Clipart                   (5) | Train Loss: 0.6525 | Train Acc: 0.8533
 Site-Clipart                   (2) | Train Loss: 0.5912 | Train Acc: 0.8418
 Site-Clipart                   (2) | Train Loss: 0.6472 | Train Acc: 0.8416
 Site-Real                      (3) | Train Loss: 0.4879 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.3862 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3820 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.4400 | Train Acc: 0.9339
 Site-Painting                  (0) | Train Loss: 0.6064 | Train Acc: 0.8776
 Site-Painting                  (0) | Train Loss: 0.5887 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.5715 | Train Acc: 0.8512
 Site-Sketch                    (5) | Train Loss: 0.6352 | Train Acc: 0.8168
 Site-Sketch                    (5) | Train Loss: 0.6658 | Train Acc: 0.8052
 Site-QuickDraw                 (1) | Train Loss: 1.3170 | Train Acc: 0.6330
 Site-Infograph                 (4) | Train Loss: 1.3544 | Train Acc: 0.5513
Average Train Accuracy: 0.8377
 Site-Clipart                   (2) | Val  Loss: 0.4706 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.5832 | Val  Acc: 0.8785
 Site-Clipart                   (5) | Val  Loss: 0.6321 | Val  Acc: 0.8733
 Site-Clipart                   (2) | Val  Loss: 0.5800 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.6478 | Val  Acc: 0.8475
 Site-Real                      (3) | Val  Loss: 0.3920 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.3758 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.4078 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.4334 | Val  Acc: 0.9307
 Site-Painting                  (0) | Val  Loss: 0.4675 | Val  Acc: 0.8980
 Site-Painting                  (0) | Val  Loss: 0.5071 | Val  Acc: 0.8540
 Site-Painting                  (0) | Val  Loss: 0.5398 | Val  Acc: 0.8646
 Site-Sketch                    (5) | Val  Loss: 0.6202 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.7104 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.3280 | Val  Acc: 0.6606
 Site-Infograph                 (4) | Val  Loss: 1.2678 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8472
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8816
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8785
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.8733
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8381
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8475
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9237
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9273
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9307
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8980
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8540
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8646
 Best site-Sketch                   (5)  | Epoch:13 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:13 | Val Acc: 0.7978
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.6606
 Best site-Infograph                (4)  | Epoch:13 | Val Acc: 0.6090
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 14 ============
cnt=[3, 1, 4, 3, 1, 4, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (0) | Train Loss: 0.5769 | Train Acc: 0.8522
 Site-Clipart                   (5) | Train Loss: 0.5014 | Train Acc: 0.8758
 Site-Clipart                   (5) | Train Loss: 0.6166 | Train Acc: 0.8533
 Site-Clipart                   (5) | Train Loss: 0.5759 | Train Acc: 0.8576
 Site-Clipart                   (5) | Train Loss: 0.5899 | Train Acc: 0.8665
 Site-Real                      (2) | Train Loss: 0.4470 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.3627 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.3607 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.4148 | Train Acc: 0.9339
 Site-Painting                  (3) | Train Loss: 0.5533 | Train Acc: 0.8435
 Site-Painting                  (3) | Train Loss: 0.6099 | Train Acc: 0.8495
 Site-Painting                  (3) | Train Loss: 0.5392 | Train Acc: 0.8651
 Site-Sketch                    (0) | Train Loss: 0.5826 | Train Acc: 0.8325
 Site-Sketch                    (0) | Train Loss: 0.7348 | Train Acc: 0.8090
 Site-QuickDraw                 (1) | Train Loss: 1.2223 | Train Acc: 0.6453
 Site-Infograph                 (4) | Train Loss: 1.3477 | Train Acc: 0.5470
Average Train Accuracy: 0.8402
 Site-Clipart                   (0) | Val  Loss: 0.4598 | Val  Acc: 0.8947
 Site-Clipart                   (5) | Val  Loss: 0.5514 | Val  Acc: 0.8785
 Site-Clipart                   (5) | Val  Loss: 0.5464 | Val  Acc: 0.8667
 Site-Clipart                   (5) | Val  Loss: 0.5606 | Val  Acc: 0.8524
 Site-Clipart                   (5) | Val  Loss: 0.6372 | Val  Acc: 0.8576
 Site-Real                      (2) | Val  Loss: 0.3859 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.3670 | Val  Acc: 0.9237
 Site-Real                      (2) | Val  Loss: 0.3966 | Val  Acc: 0.9091
 Site-Real                      (2) | Val  Loss: 0.3818 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.4475 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.5208 | Val  Acc: 0.8832
 Site-Painting                  (3) | Val  Loss: 0.5403 | Val  Acc: 0.8646
 Site-Sketch                    (0) | Val  Loss: 0.6196 | Val  Acc: 0.8189
 Site-Sketch                    (0) | Val  Loss: 0.7239 | Val  Acc: 0.7697
 Site-QuickDraw                 (1) | Val  Loss: 1.2505 | Val  Acc: 0.6972
 Site-Infograph                 (4) | Val  Loss: 1.2348 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8529
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8947
 Best site-Clipart                  (5)  | Epoch:14 | Val Acc: 0.8785
 Best site-Clipart                  (5)  | Epoch:14 | Val Acc: 0.8667
 Best site-Clipart                  (5)  | Epoch:14 | Val Acc: 0.8524
 Best site-Clipart                  (5)  | Epoch:14 | Val Acc: 0.8576
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9237
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9091
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9394
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.9286
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.8832
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.8646
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.8189
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.7697
 Best site-QuickDraw                (1)  | Epoch:14 | Val Acc: 0.6972
 Best site-Infograph                (4)  | Epoch:14 | Val Acc: 0.6090
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 1, 4, 4, 3, 3, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (2) | Train Loss: 0.6084 | Train Acc: 0.8261
 Site-Clipart                   (5) | Train Loss: 0.4596 | Train Acc: 0.9193
 Site-Clipart                   (5) | Train Loss: 0.6064 | Train Acc: 0.8489
 Site-Clipart                   (2) | Train Loss: 0.5277 | Train Acc: 0.8766
 Site-Clipart                   (2) | Train Loss: 0.5641 | Train Acc: 0.8665
 Site-Real                      (3) | Train Loss: 0.4644 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.3483 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.3579 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3853 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.5629 | Train Acc: 0.8163
 Site-Painting                  (4) | Train Loss: 0.5111 | Train Acc: 0.8447
 Site-Painting                  (4) | Train Loss: 0.5248 | Train Acc: 0.8754
 Site-Sketch                    (2) | Train Loss: 0.6255 | Train Acc: 0.8115
 Site-Sketch                    (5) | Train Loss: 0.6541 | Train Acc: 0.8315
 Site-QuickDraw                 (0) | Train Loss: 1.1053 | Train Acc: 0.6820
 Site-Infograph                 (1) | Train Loss: 1.2865 | Train Acc: 0.5726
Average Train Accuracy: 0.8444
 Site-Clipart                   (2) | Val  Loss: 0.4341 | Val  Acc: 0.8816
 Site-Clipart                   (5) | Val  Loss: 0.5078 | Val  Acc: 0.8879
 Site-Clipart                   (5) | Val  Loss: 0.5226 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.5266 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.6165 | Val  Acc: 0.8203
 Site-Real                      (3) | Val  Loss: 0.3647 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3715 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.3660 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3606 | Val  Acc: 0.9481
 Site-Painting                  (4) | Val  Loss: 0.4398 | Val  Acc: 0.8673
 Site-Painting                  (4) | Val  Loss: 0.4918 | Val  Acc: 0.8759
 Site-Painting                  (4) | Val  Loss: 0.5254 | Val  Acc: 0.8698
 Site-Sketch                    (2) | Val  Loss: 0.5969 | Val  Acc: 0.8268
 Site-Sketch                    (5) | Val  Loss: 0.6337 | Val  Acc: 0.8258
 Site-QuickDraw                 (0) | Val  Loss: 1.2558 | Val  Acc: 0.7064
 Site-Infograph                 (1) | Val  Loss: 1.1823 | Val  Acc: 0.6346
Average Valid Accuracy: 0.8561
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8816
 Best site-Clipart                  (5)  | Epoch:15 | Val Acc: 0.8879
 Best site-Clipart                  (5)  | Epoch:15 | Val Acc: 0.8800
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8667
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8203
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9481
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8673
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8759
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8698
 Best site-Sketch                   (2)  | Epoch:15 | Val Acc: 0.8268
 Best site-Sketch                   (5)  | Epoch:15 | Val Acc: 0.8258
 Best site-QuickDraw                (0)  | Epoch:15 | Val Acc: 0.7064
 Best site-Infograph                (1)  | Epoch:15 | Val Acc: 0.6346
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 1, 1, 4, 5, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (2) | Train Loss: 0.6185 | Train Acc: 0.8261
 Site-Clipart                   (3) | Train Loss: 0.4303 | Train Acc: 0.9130
 Site-Clipart                   (3) | Train Loss: 0.5987 | Train Acc: 0.8533
 Site-Clipart                   (3) | Train Loss: 0.5103 | Train Acc: 0.8892
 Site-Clipart                   (3) | Train Loss: 0.5261 | Train Acc: 0.8756
 Site-Real                      (4) | Train Loss: 0.4258 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.3355 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.3195 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.3702 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.5682 | Train Acc: 0.8571
 Site-Painting                  (0) | Train Loss: 0.5738 | Train Acc: 0.8544
 Site-Painting                  (0) | Train Loss: 0.5328 | Train Acc: 0.8685
 Site-Sketch                    (5) | Train Loss: 0.5855 | Train Acc: 0.8010
 Site-Sketch                    (5) | Train Loss: 0.6669 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 1.1191 | Train Acc: 0.7095
 Site-Infograph                 (4) | Train Loss: 1.3461 | Train Acc: 0.5641
Average Train Accuracy: 0.8491
 Site-Clipart                   (2) | Val  Loss: 0.4342 | Val  Acc: 0.8816
 Site-Clipart                   (3) | Val  Loss: 0.4754 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.5272 | Val  Acc: 0.8467
 Site-Clipart                   (3) | Val  Loss: 0.5132 | Val  Acc: 0.8667
 Site-Clipart                   (3) | Val  Loss: 0.6040 | Val  Acc: 0.8407
 Site-Real                      (4) | Val  Loss: 0.3264 | Val  Acc: 0.9167
 Site-Real                      (4) | Val  Loss: 0.3042 | Val  Acc: 0.9661
 Site-Real                      (4) | Val  Loss: 0.3455 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.3390 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.3857 | Val  Acc: 0.8673
 Site-Painting                  (0) | Val  Loss: 0.4636 | Val  Acc: 0.8832
 Site-Painting                  (0) | Val  Loss: 0.5186 | Val  Acc: 0.8542
 Site-Sketch                    (5) | Val  Loss: 0.5516 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.6533 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 1.1769 | Val  Acc: 0.6972
 Site-Infograph                 (4) | Val  Loss: 1.2130 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8535
============ Train epoch 17 ============
cnt=[3, 1, 5, 4, 2, 1, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (2) | Train Loss: 0.5044 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.4367 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.5791 | Train Acc: 0.8356
 Site-Clipart                   (2) | Train Loss: 0.4923 | Train Acc: 0.8797
 Site-Clipart                   (2) | Train Loss: 0.5400 | Train Acc: 0.8643
 Site-Real                      (3) | Train Loss: 0.4183 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.3150 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.3117 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3479 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.5207 | Train Acc: 0.8503
 Site-Painting                  (0) | Train Loss: 0.4705 | Train Acc: 0.8592
 Site-Painting                  (0) | Train Loss: 0.4615 | Train Acc: 0.8824
 Site-Sketch                    (4) | Train Loss: 0.5706 | Train Acc: 0.8325
 Site-Sketch                    (4) | Train Loss: 0.5586 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 1.0994 | Train Acc: 0.6881
 Site-Infograph                 (5) | Train Loss: 1.2674 | Train Acc: 0.5940
Average Train Accuracy: 0.8504
 Site-Clipart                   (2) | Val  Loss: 0.4099 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.4636 | Val  Acc: 0.8785
 Site-Clipart                   (2) | Val  Loss: 0.5007 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.5248 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.6224 | Val  Acc: 0.8169
 Site-Real                      (3) | Val  Loss: 0.3287 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3349 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.3048 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.3274 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.3762 | Val  Acc: 0.8980
 Site-Painting                  (0) | Val  Loss: 0.4590 | Val  Acc: 0.8613
 Site-Painting                  (0) | Val  Loss: 0.4742 | Val  Acc: 0.8854
 Site-Sketch                    (4) | Val  Loss: 0.5619 | Val  Acc: 0.8425
 Site-Sketch                    (4) | Val  Loss: 0.6400 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.1974 | Val  Acc: 0.6697
 Site-Infograph                 (5) | Val  Loss: 1.2265 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8541
============ Train epoch 18 ============
cnt=[3, 1, 2, 4, 5, 1, ]
cnt=[1, 3, 5, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (4) | Train Loss: 0.5216 | Train Acc: 0.8522
 Site-Clipart                   (4) | Train Loss: 0.4249 | Train Acc: 0.9006
 Site-Clipart                   (4) | Train Loss: 0.6000 | Train Acc: 0.8267
 Site-Clipart                   (4) | Train Loss: 0.4893 | Train Acc: 0.8639
 Site-Clipart                   (4) | Train Loss: 0.5323 | Train Acc: 0.8756
 Site-Real                      (3) | Train Loss: 0.4326 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.3070 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2966 | Train Acc: 0.9597
 Site-Real                      (3) | Train Loss: 0.3429 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4695 | Train Acc: 0.8912
 Site-Painting                  (0) | Train Loss: 0.4677 | Train Acc: 0.8786
 Site-Painting                  (0) | Train Loss: 0.4499 | Train Acc: 0.8685
 Site-Sketch                    (2) | Train Loss: 0.6171 | Train Acc: 0.8168
 Site-Sketch                    (2) | Train Loss: 0.5106 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 1.0510 | Train Acc: 0.6820
 Site-Infograph                 (5) | Train Loss: 1.2273 | Train Acc: 0.6154
Average Train Accuracy: 0.8544
 Site-Clipart                   (4) | Val  Loss: 0.4042 | Val  Acc: 0.8553
 Site-Clipart                   (4) | Val  Loss: 0.4794 | Val  Acc: 0.8972
 Site-Clipart                   (4) | Val  Loss: 0.5551 | Val  Acc: 0.8467
 Site-Clipart                   (4) | Val  Loss: 0.5221 | Val  Acc: 0.8429
 Site-Clipart                   (4) | Val  Loss: 0.5611 | Val  Acc: 0.8712
 Site-Real                      (3) | Val  Loss: 0.3214 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3109 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.3268 | Val  Acc: 0.9152
 Site-Real                      (3) | Val  Loss: 0.3265 | Val  Acc: 0.9437
 Site-Painting                  (0) | Val  Loss: 0.3869 | Val  Acc: 0.8878
 Site-Painting                  (0) | Val  Loss: 0.4659 | Val  Acc: 0.8686
 Site-Painting                  (0) | Val  Loss: 0.4623 | Val  Acc: 0.8958
 Site-Sketch                    (2) | Val  Loss: 0.4861 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.6264 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.1400 | Val  Acc: 0.7110
 Site-Infograph                 (5) | Val  Loss: 1.1670 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8568
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8553
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8972
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8467
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8429
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8712
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9152
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9437
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8878
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8686
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8958
 Best site-Sketch                   (2)  | Epoch:18 | Val Acc: 0.8740
 Best site-Sketch                   (2)  | Epoch:18 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:18 | Val Acc: 0.7110
 Best site-Infograph                (5)  | Epoch:18 | Val Acc: 0.6154
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 19 ============
cnt=[1, 1, 5, 3, 4, 2, ]
cnt=[2, 3, 1, 4, 5, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (2) | Train Loss: 0.5303 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.4099 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.5467 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.4859 | Train Acc: 0.8639
 Site-Clipart                   (2) | Train Loss: 0.4951 | Train Acc: 0.8869
 Site-Real                      (4) | Train Loss: 0.4173 | Train Acc: 0.8968
 Site-Real                      (4) | Train Loss: 0.2795 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.3040 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.3237 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.5967 | Train Acc: 0.8639
 Site-Painting                  (3) | Train Loss: 0.5280 | Train Acc: 0.8641
 Site-Painting                  (3) | Train Loss: 0.4496 | Train Acc: 0.8927
 Site-Sketch                    (5) | Train Loss: 0.5269 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.5788 | Train Acc: 0.8240
 Site-QuickDraw                 (1) | Train Loss: 1.0686 | Train Acc: 0.6972
 Site-Infograph                 (0) | Train Loss: 1.2169 | Train Acc: 0.6026
Average Train Accuracy: 0.8599
 Site-Clipart                   (2) | Val  Loss: 0.4093 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.4560 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.4859 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.4866 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.5652 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.2938 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.3463 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.3094 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.3058 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.3895 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.4426 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.4631 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.5648 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6520 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.1351 | Val  Acc: 0.6743
 Site-Infograph                 (0) | Val  Loss: 1.1682 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8649
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8947
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8879
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8933
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8810
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8542
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9237
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9273
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.9082
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.9051
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.9010
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:19 | Val Acc: 0.6743
 Best site-Infograph                (0)  | Epoch:19 | Val Acc: 0.6538
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:19 | Test Acc: 0.8764
 Test site-Real                      (4)| Epoch:19 | Test Acc: 0.9417
 Test site-Painting                  (3)| Epoch:19 | Test Acc: 0.9192
 Test site-Sketch                    (5)| Epoch:19 | Test Acc: 0.8682
 Test site-QuickDraw                 (1)| Epoch:19 | Test Acc: 0.6780
 Test site-Infograph                 (0)| Epoch:19 | Test Acc: 0.5556
Clipart: 0.8764, Real: 0.9417, Painting: 0.9192, Sketch: 0.8682, QuickDraw: 0.6780, Infograph: 0.5556, 
Average Test Accuracy(group): 0.8065, Average Test Accuracy(individual): 0.8673,
domain std=0.1409, cluster std=0.1409, individual std=0.1011, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (2) | Train Loss: 0.5017 | Train Acc: 0.8957
 Site-Clipart                   (4) | Train Loss: 0.4519 | Train Acc: 0.9068
 Site-Clipart                   (4) | Train Loss: 0.5291 | Train Acc: 0.8267
 Site-Clipart                   (2) | Train Loss: 0.4930 | Train Acc: 0.8576
 Site-Clipart                   (4) | Train Loss: 0.5095 | Train Acc: 0.8778
 Site-Real                      (0) | Train Loss: 0.3915 | Train Acc: 0.8889
 Site-Real                      (0) | Train Loss: 0.2726 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.3007 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.3377 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.5316 | Train Acc: 0.8776
 Site-Painting                  (3) | Train Loss: 0.4682 | Train Acc: 0.8689
 Site-Painting                  (3) | Train Loss: 0.4571 | Train Acc: 0.8789
 Site-Sketch                    (2) | Train Loss: 0.5368 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.6590 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 1.0861 | Train Acc: 0.7095
 Site-Infograph                 (5) | Train Loss: 1.1874 | Train Acc: 0.6282
Average Train Accuracy: 0.8581
 Site-Clipart                   (2) | Val  Loss: 0.3724 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.4787 | Val  Acc: 0.8692
 Site-Clipart                   (4) | Val  Loss: 0.5065 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.4590 | Val  Acc: 0.8762
 Site-Clipart                   (4) | Val  Loss: 0.5519 | Val  Acc: 0.8542
 Site-Real                      (0) | Val  Loss: 0.2951 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2955 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2986 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.3204 | Val  Acc: 0.9351
 Site-Painting                  (3) | Val  Loss: 0.3576 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.4276 | Val  Acc: 0.8978
 Site-Painting                  (3) | Val  Loss: 0.4653 | Val  Acc: 0.8802
 Site-Sketch                    (2) | Val  Loss: 0.5049 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.5775 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 1.0780 | Val  Acc: 0.7156
 Site-Infograph                 (5) | Val  Loss: 1.1162 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8669
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8684
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.8692
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.8867
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8762
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.8542
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9322
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9351
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.9082
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.8978
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.8802
 Best site-Sketch                   (2)  | Epoch:20 | Val Acc: 0.8740
 Best site-Sketch                   (2)  | Epoch:20 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.7156
 Best site-Infograph                (5)  | Epoch:20 | Val Acc: 0.6731
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 21 ============
cnt=[5, 1, 1, 3, 4, 2, ]
cnt=[2, 5, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.5079 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.4505 | Train Acc: 0.8944
 Site-Clipart                   (0) | Train Loss: 0.5754 | Train Acc: 0.8622
 Site-Clipart                   (0) | Train Loss: 0.4444 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.4873 | Train Acc: 0.8869
 Site-Real                      (4) | Train Loss: 0.3896 | Train Acc: 0.8889
 Site-Real                      (4) | Train Loss: 0.2740 | Train Acc: 0.9718
 Site-Real                      (4) | Train Loss: 0.2993 | Train Acc: 0.9355
 Site-Real                      (4) | Train Loss: 0.3324 | Train Acc: 0.9454
 Site-Painting                  (3) | Train Loss: 0.5438 | Train Acc: 0.8571
 Site-Painting                  (3) | Train Loss: 0.5038 | Train Acc: 0.8835
 Site-Painting                  (3) | Train Loss: 0.4398 | Train Acc: 0.8893
 Site-Sketch                    (5) | Train Loss: 0.5411 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.5814 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 1.0234 | Train Acc: 0.6881
 Site-Infograph                 (2) | Train Loss: 1.2273 | Train Acc: 0.5897
Average Train Accuracy: 0.8546
 Site-Clipart                   (0) | Val  Loss: 0.3869 | Val  Acc: 0.8421
 Site-Clipart                   (0) | Val  Loss: 0.4196 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.4625 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.4769 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.5378 | Val  Acc: 0.8475
 Site-Real                      (4) | Val  Loss: 0.2913 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2765 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2918 | Val  Acc: 0.9212
 Site-Real                      (4) | Val  Loss: 0.3093 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.3361 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.4300 | Val  Acc: 0.8759
 Site-Painting                  (3) | Val  Loss: 0.4278 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.5212 | Val  Acc: 0.8504
 Site-Sketch                    (5) | Val  Loss: 0.6050 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 1.1087 | Val  Acc: 0.6972
 Site-Infograph                 (2) | Val  Loss: 1.1287 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8659
============ Train epoch 22 ============
cnt=[5, 1, 3, 4, 2, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.5006 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.3892 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.5497 | Train Acc: 0.8444
 Site-Clipart                   (0) | Train Loss: 0.4570 | Train Acc: 0.8766
 Site-Clipart                   (0) | Train Loss: 0.4791 | Train Acc: 0.8937
 Site-Real                      (3) | Train Loss: 0.3843 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2651 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2953 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.3288 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.4748 | Train Acc: 0.8844
 Site-Painting                  (2) | Train Loss: 0.4764 | Train Acc: 0.8544
 Site-Painting                  (2) | Train Loss: 0.4198 | Train Acc: 0.8997
 Site-Sketch                    (4) | Train Loss: 0.4953 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.5145 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 1.0262 | Train Acc: 0.7156
 Site-Infograph                 (5) | Train Loss: 1.1626 | Train Acc: 0.6239
Average Train Accuracy: 0.8628
 Site-Clipart                   (0) | Val  Loss: 0.3448 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.4216 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.4160 | Val  Acc: 0.9200
 Site-Clipart                   (0) | Val  Loss: 0.4490 | Val  Acc: 0.8619
 Site-Clipart                   (0) | Val  Loss: 0.5424 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2903 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2836 | Val  Acc: 0.9661
 Site-Real                      (3) | Val  Loss: 0.2930 | Val  Acc: 0.9030
 Site-Real                      (3) | Val  Loss: 0.2857 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3302 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.3876 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.4577 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.5102 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.5668 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 1.0438 | Val  Acc: 0.7156
 Site-Infograph                 (5) | Val  Loss: 1.0766 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8723
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8972
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.9200
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8619
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8610
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9661
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9030
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9184
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9197
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.8698
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8504
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:22 | Val Acc: 0.7156
 Best site-Infograph                (5)  | Epoch:22 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 23 ============
cnt=[5, 1, 2, 4, 1, 3, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.4696 | Train Acc: 0.8609
 Site-Clipart                   (3) | Train Loss: 0.3772 | Train Acc: 0.9068
 Site-Clipart                   (3) | Train Loss: 0.5038 | Train Acc: 0.8533
 Site-Clipart                   (3) | Train Loss: 0.4484 | Train Acc: 0.8797
 Site-Clipart                   (3) | Train Loss: 0.4953 | Train Acc: 0.8665
 Site-Real                      (0) | Train Loss: 0.3670 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2538 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2667 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2833 | Train Acc: 0.9425
 Site-Painting                  (5) | Train Loss: 0.4843 | Train Acc: 0.8503
 Site-Painting                  (5) | Train Loss: 0.4169 | Train Acc: 0.8738
 Site-Painting                  (5) | Train Loss: 0.3899 | Train Acc: 0.9100
 Site-Sketch                    (4) | Train Loss: 0.5401 | Train Acc: 0.8272
 Site-Sketch                    (2) | Train Loss: 0.5869 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.9676 | Train Acc: 0.7064
 Site-Infograph                 (0) | Train Loss: 1.2074 | Train Acc: 0.6068
Average Train Accuracy: 0.8587
 Site-Clipart                   (2) | Val  Loss: 0.3158 | Val  Acc: 0.8947
 Site-Clipart                   (3) | Val  Loss: 0.3999 | Val  Acc: 0.9252
 Site-Clipart                   (3) | Val  Loss: 0.4183 | Val  Acc: 0.8933
 Site-Clipart                   (3) | Val  Loss: 0.4264 | Val  Acc: 0.8952
 Site-Clipart                   (3) | Val  Loss: 0.5282 | Val  Acc: 0.8373
 Site-Real                      (0) | Val  Loss: 0.2411 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2633 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2389 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2654 | Val  Acc: 0.9610
 Site-Painting                  (5) | Val  Loss: 0.3518 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.3886 | Val  Acc: 0.8978
 Site-Painting                  (5) | Val  Loss: 0.4338 | Val  Acc: 0.8802
 Site-Sketch                    (4) | Val  Loss: 0.4842 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.5165 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 1.0184 | Val  Acc: 0.7339
 Site-Infograph                 (0) | Val  Loss: 1.1425 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8778
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8947
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.9252
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.8933
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.8952
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.8373
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9492
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9394
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9610
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.9286
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.8978
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.8802
 Best site-Sketch                   (4)  | Epoch:23 | Val Acc: 0.8740
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8427
 Best site-QuickDraw                (1)  | Epoch:23 | Val Acc: 0.7339
 Best site-Infograph                (0)  | Epoch:23 | Val Acc: 0.6282
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 5, 2, 1, 3, 4, ]
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (5) | Train Loss: 0.5295 | Train Acc: 0.8696
 Site-Clipart                   (5) | Train Loss: 0.3520 | Train Acc: 0.8882
 Site-Clipart                   (5) | Train Loss: 0.5460 | Train Acc: 0.8533
 Site-Clipart                   (5) | Train Loss: 0.4425 | Train Acc: 0.8797
 Site-Clipart                   (3) | Train Loss: 0.4559 | Train Acc: 0.8869
 Site-Real                      (1) | Train Loss: 0.3671 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.2520 | Train Acc: 0.9661
 Site-Real                      (1) | Train Loss: 0.2398 | Train Acc: 0.9516
 Site-Real                      (1) | Train Loss: 0.2793 | Train Acc: 0.9425
 Site-Painting                  (4) | Train Loss: 0.4878 | Train Acc: 0.8844
 Site-Painting                  (4) | Train Loss: 0.4021 | Train Acc: 0.8932
 Site-Painting                  (4) | Train Loss: 0.3905 | Train Acc: 0.9066
 Site-Sketch                    (2) | Train Loss: 0.4991 | Train Acc: 0.8482
 Site-Sketch                    (2) | Train Loss: 0.4660 | Train Acc: 0.8577
 Site-QuickDraw                 (0) | Train Loss: 0.8900 | Train Acc: 0.7431
 Site-Infograph                 (1) | Train Loss: 1.1718 | Train Acc: 0.6026
Average Train Accuracy: 0.8669
 Site-Clipart                   (5) | Val  Loss: 0.3251 | Val  Acc: 0.9211
 Site-Clipart                   (5) | Val  Loss: 0.4115 | Val  Acc: 0.8785
 Site-Clipart                   (5) | Val  Loss: 0.4775 | Val  Acc: 0.8733
 Site-Clipart                   (5) | Val  Loss: 0.4613 | Val  Acc: 0.8524
 Site-Clipart                   (3) | Val  Loss: 0.5250 | Val  Acc: 0.8576
 Site-Real                      (1) | Val  Loss: 0.2689 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2444 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.2660 | Val  Acc: 0.9455
 Site-Real                      (1) | Val  Loss: 0.2778 | Val  Acc: 0.9610
 Site-Painting                  (4) | Val  Loss: 0.3008 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.3483 | Val  Acc: 0.9270
 Site-Painting                  (4) | Val  Loss: 0.4020 | Val  Acc: 0.8958
 Site-Sketch                    (2) | Val  Loss: 0.4804 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.5189 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 0.9719 | Val  Acc: 0.7706
 Site-Infograph                 (1) | Val  Loss: 1.0536 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8787
 Best site-Clipart                  (5)  | Epoch:24 | Val Acc: 0.9211
 Best site-Clipart                  (5)  | Epoch:24 | Val Acc: 0.8785
 Best site-Clipart                  (5)  | Epoch:24 | Val Acc: 0.8733
 Best site-Clipart                  (5)  | Epoch:24 | Val Acc: 0.8524
 Best site-Clipart                  (3)  | Epoch:24 | Val Acc: 0.8576
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9455
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9610
 Best site-Painting                 (4)  | Epoch:24 | Val Acc: 0.9388
 Best site-Painting                 (4)  | Epoch:24 | Val Acc: 0.9270
 Best site-Painting                 (4)  | Epoch:24 | Val Acc: 0.8958
 Best site-Sketch                   (2)  | Epoch:24 | Val Acc: 0.8583
 Best site-Sketch                   (2)  | Epoch:24 | Val Acc: 0.8202
 Best site-QuickDraw                (0)  | Epoch:24 | Val Acc: 0.7706
 Best site-Infograph                (1)  | Epoch:24 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 1, 1, 5, 3, 4, ]
cnt=[5, 3, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (3) | Train Loss: 0.4158 | Train Acc: 0.8870
 Site-Clipart                   (3) | Train Loss: 0.3201 | Train Acc: 0.9193
 Site-Clipart                   (3) | Train Loss: 0.5104 | Train Acc: 0.8844
 Site-Clipart                   (3) | Train Loss: 0.4380 | Train Acc: 0.8829
 Site-Clipart                   (3) | Train Loss: 0.4485 | Train Acc: 0.8982
 Site-Real                      (5) | Train Loss: 0.3904 | Train Acc: 0.9048
 Site-Real                      (5) | Train Loss: 0.2260 | Train Acc: 0.9605
 Site-Real                      (5) | Train Loss: 0.2736 | Train Acc: 0.9194
 Site-Real                      (5) | Train Loss: 0.2983 | Train Acc: 0.9483
 Site-Painting                  (4) | Train Loss: 0.4459 | Train Acc: 0.8844
 Site-Painting                  (4) | Train Loss: 0.5028 | Train Acc: 0.8883
 Site-Painting                  (4) | Train Loss: 0.3981 | Train Acc: 0.9100
 Site-Sketch                    (0) | Train Loss: 0.4772 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.5540 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.8978 | Train Acc: 0.7401
 Site-Infograph                 (2) | Train Loss: 1.1281 | Train Acc: 0.6154
Average Train Accuracy: 0.8732
 Site-Clipart                   (3) | Val  Loss: 0.3431 | Val  Acc: 0.8947
 Site-Clipart                   (3) | Val  Loss: 0.4087 | Val  Acc: 0.8972
 Site-Clipart                   (3) | Val  Loss: 0.4116 | Val  Acc: 0.9067
 Site-Clipart                   (3) | Val  Loss: 0.4270 | Val  Acc: 0.8762
 Site-Clipart                   (3) | Val  Loss: 0.5288 | Val  Acc: 0.8576
 Site-Real                      (5) | Val  Loss: 0.2654 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.2582 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.2595 | Val  Acc: 0.9273
 Site-Real                      (5) | Val  Loss: 0.2810 | Val  Acc: 0.9481
 Site-Painting                  (4) | Val  Loss: 0.3095 | Val  Acc: 0.9184
 Site-Painting                  (4) | Val  Loss: 0.3718 | Val  Acc: 0.9051
 Site-Painting                  (4) | Val  Loss: 0.3931 | Val  Acc: 0.9010
 Site-Sketch                    (0) | Val  Loss: 0.4614 | Val  Acc: 0.8504
 Site-Sketch                    (0) | Val  Loss: 0.5424 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.9966 | Val  Acc: 0.7294
 Site-Infograph                 (2) | Val  Loss: 1.0872 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8757
============ Train epoch 26 ============
cnt=[3, 1, 4, 4, 3, 1, ]
cnt=[3, 5, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (4) | Train Loss: 0.4925 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.3614 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.4501 | Train Acc: 0.8844
 Site-Clipart                   (2) | Train Loss: 0.4160 | Train Acc: 0.8797
 Site-Clipart                   (2) | Train Loss: 0.4469 | Train Acc: 0.8959
 Site-Real                      (3) | Train Loss: 0.3596 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2473 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2652 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3021 | Train Acc: 0.9511
 Site-Painting                  (0) | Train Loss: 0.4538 | Train Acc: 0.8844
 Site-Painting                  (0) | Train Loss: 0.4190 | Train Acc: 0.8592
 Site-Painting                  (0) | Train Loss: 0.4152 | Train Acc: 0.9100
 Site-Sketch                    (4) | Train Loss: 0.4904 | Train Acc: 0.8482
 Site-Sketch                    (4) | Train Loss: 0.4668 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.8524 | Train Acc: 0.7339
 Site-Infograph                 (5) | Train Loss: 1.1033 | Train Acc: 0.5983
Average Train Accuracy: 0.8665
 Site-Clipart                   (4) | Val  Loss: 0.3298 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.3918 | Val  Acc: 0.8785
 Site-Clipart                   (2) | Val  Loss: 0.4154 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.3920 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.4949 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2788 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2605 | Val  Acc: 0.9746
 Site-Real                      (3) | Val  Loss: 0.2584 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.2641 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3213 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.3531 | Val  Acc: 0.8978
 Site-Painting                  (0) | Val  Loss: 0.4249 | Val  Acc: 0.8854
 Site-Sketch                    (4) | Val  Loss: 0.4486 | Val  Acc: 0.8661
 Site-Sketch                    (4) | Val  Loss: 0.5726 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 0.9606 | Val  Acc: 0.7110
 Site-Infograph                 (5) | Val  Loss: 1.1029 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8701
============ Train epoch 27 ============
cnt=[4, 1, 2, 3, 5, 1, ]
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (4) | Train Loss: 0.4581 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.3621 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.4799 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.4171 | Train Acc: 0.8734
 Site-Clipart                   (4) | Train Loss: 0.4458 | Train Acc: 0.8891
 Site-Real                      (0) | Train Loss: 0.3432 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2400 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2484 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2905 | Train Acc: 0.9339
 Site-Painting                  (3) | Train Loss: 0.4960 | Train Acc: 0.8776
 Site-Painting                  (3) | Train Loss: 0.4412 | Train Acc: 0.8738
 Site-Painting                  (3) | Train Loss: 0.3459 | Train Acc: 0.9308
 Site-Sketch                    (2) | Train Loss: 0.4933 | Train Acc: 0.8586
 Site-Sketch                    (2) | Train Loss: 0.5328 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.8632 | Train Acc: 0.7339
 Site-Infograph                 (5) | Train Loss: 1.1079 | Train Acc: 0.6368
Average Train Accuracy: 0.8716
 Site-Clipart                   (4) | Val  Loss: 0.3106 | Val  Acc: 0.8947
 Site-Clipart                   (4) | Val  Loss: 0.3822 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.4217 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4473 | Val  Acc: 0.8952
 Site-Clipart                   (4) | Val  Loss: 0.5214 | Val  Acc: 0.8475
 Site-Real                      (0) | Val  Loss: 0.2487 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2907 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.2827 | Val  Acc: 0.9212
 Site-Real                      (0) | Val  Loss: 0.2704 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.3033 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.3400 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3765 | Val  Acc: 0.9010
 Site-Sketch                    (2) | Val  Loss: 0.5357 | Val  Acc: 0.8346
 Site-Sketch                    (2) | Val  Loss: 0.5914 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 0.9513 | Val  Acc: 0.7385
 Site-Infograph                 (5) | Val  Loss: 1.0877 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8708
============ Train epoch 28 ============
cnt=[5, 1, 3, 2, 4, 1, ]
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (0) | Train Loss: 0.4043 | Train Acc: 0.8957
 Site-Clipart                   (0) | Train Loss: 0.3487 | Train Acc: 0.9317
 Site-Clipart                   (0) | Train Loss: 0.4564 | Train Acc: 0.8978
 Site-Clipart                   (0) | Train Loss: 0.4234 | Train Acc: 0.8924
 Site-Clipart                   (0) | Train Loss: 0.4101 | Train Acc: 0.9095
 Site-Real                      (4) | Train Loss: 0.3763 | Train Acc: 0.8968
 Site-Real                      (4) | Train Loss: 0.2389 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2648 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2731 | Train Acc: 0.9540
 Site-Painting                  (2) | Train Loss: 0.4918 | Train Acc: 0.8639
 Site-Painting                  (2) | Train Loss: 0.4632 | Train Acc: 0.8738
 Site-Painting                  (2) | Train Loss: 0.3855 | Train Acc: 0.9204
 Site-Sketch                    (3) | Train Loss: 0.4678 | Train Acc: 0.8586
 Site-Sketch                    (3) | Train Loss: 0.4977 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.8137 | Train Acc: 0.7339
 Site-Infograph                 (5) | Train Loss: 1.0771 | Train Acc: 0.6197
Average Train Accuracy: 0.8739
 Site-Clipart                   (0) | Val  Loss: 0.2604 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.3887 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.4421 | Val  Acc: 0.8600
 Site-Clipart                   (0) | Val  Loss: 0.4339 | Val  Acc: 0.8810
 Site-Clipart                   (0) | Val  Loss: 0.4949 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2661 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2385 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2567 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.2582 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3043 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.3637 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.4316 | Val  Acc: 0.8958
 Site-Sketch                    (3) | Val  Loss: 0.4490 | Val  Acc: 0.8898
 Site-Sketch                    (3) | Val  Loss: 0.5609 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 0.9389 | Val  Acc: 0.7477
 Site-Infograph                 (5) | Val  Loss: 1.0869 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8824
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.9474
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8972
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8600
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8810
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8712
 Best site-Real                     (4)  | Epoch:28 | Val Acc: 0.9286
 Best site-Real                     (4)  | Epoch:28 | Val Acc: 0.9576
 Best site-Real                     (4)  | Epoch:28 | Val Acc: 0.9273
 Best site-Real                     (4)  | Epoch:28 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:28 | Val Acc: 0.9592
 Best site-Painting                 (2)  | Epoch:28 | Val Acc: 0.9197
 Best site-Painting                 (2)  | Epoch:28 | Val Acc: 0.8958
 Best site-Sketch                   (3)  | Epoch:28 | Val Acc: 0.8898
 Best site-Sketch                   (3)  | Epoch:28 | Val Acc: 0.7921
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.7477
 Best site-Infograph                (5)  | Epoch:28 | Val Acc: 0.6923
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 29 ============
cnt=[1, 1, 5, 3, 4, 2, ]
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (2) | Train Loss: 0.4464 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.3843 | Train Acc: 0.8944
 Site-Clipart                   (2) | Train Loss: 0.4747 | Train Acc: 0.8400
 Site-Clipart                   (2) | Train Loss: 0.4221 | Train Acc: 0.8861
 Site-Clipart                   (2) | Train Loss: 0.4138 | Train Acc: 0.9027
 Site-Real                      (4) | Train Loss: 0.3505 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2459 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2431 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2746 | Train Acc: 0.9483
 Site-Painting                  (3) | Train Loss: 0.3788 | Train Acc: 0.8639
 Site-Painting                  (3) | Train Loss: 0.4297 | Train Acc: 0.8641
 Site-Painting                  (3) | Train Loss: 0.3765 | Train Acc: 0.8997
 Site-Sketch                    (5) | Train Loss: 0.4968 | Train Acc: 0.8482
 Site-Sketch                    (5) | Train Loss: 0.4912 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.8086 | Train Acc: 0.7920
 Site-Infograph                 (0) | Train Loss: 1.0136 | Train Acc: 0.6752
Average Train Accuracy: 0.8717
 Site-Clipart                   (2) | Val  Loss: 0.2982 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3651 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.4215 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.4434 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.5091 | Val  Acc: 0.8508
 Site-Real                      (4) | Val  Loss: 0.2823 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2703 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.2577 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.2443 | Val  Acc: 0.9610
 Site-Painting                  (3) | Val  Loss: 0.3398 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.3075 | Val  Acc: 0.9343
 Site-Painting                  (3) | Val  Loss: 0.3774 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4826 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5445 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.9134 | Val  Acc: 0.7339
 Site-Infograph                 (0) | Val  Loss: 1.0542 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8739
 Test site-Clipart                   (2)| Epoch:28 | Test Acc: 0.8783
 Test site-Real                      (4)| Epoch:28 | Test Acc: 0.9441
 Test site-Painting                  (3)| Epoch:28 | Test Acc: 0.9305
 Test site-Sketch                    (5)| Epoch:28 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:28 | Test Acc: 0.7180
 Test site-Infograph                 (0)| Epoch:28 | Test Acc: 0.5616
Clipart: 0.8783, Real: 0.9441, Painting: 0.9305, Sketch: 0.8845, QuickDraw: 0.7180, Infograph: 0.5616, 
Average Test Accuracy(group): 0.8195, Average Test Accuracy(individual): 0.8755,
domain std=0.1368, cluster std=0.1368, individual std=0.0973, 
============ Train epoch 30 ============
cnt=[5, 1, 3, 4, 2, 1, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (0) | Train Loss: 0.4574 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.3275 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.4639 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3913 | Train Acc: 0.8924
 Site-Clipart                   (0) | Train Loss: 0.4178 | Train Acc: 0.8869
 Site-Real                      (3) | Train Loss: 0.3488 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2263 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2525 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2811 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.3624 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3793 | Train Acc: 0.8981
 Site-Painting                  (2) | Train Loss: 0.3734 | Train Acc: 0.9100
 Site-Sketch                    (4) | Train Loss: 0.4549 | Train Acc: 0.8586
 Site-Sketch                    (4) | Train Loss: 0.5681 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.8664 | Train Acc: 0.7676
 Site-Infograph                 (5) | Train Loss: 1.0637 | Train Acc: 0.6581
Average Train Accuracy: 0.8771
 Site-Clipart                   (0) | Val  Loss: 0.2756 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3484 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.4094 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.4103 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.5033 | Val  Acc: 0.8576
 Site-Real                      (3) | Val  Loss: 0.2593 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2315 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.2151 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2472 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3034 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3721 | Val  Acc: 0.8905
 Site-Painting                  (2) | Val  Loss: 0.3966 | Val  Acc: 0.8802
 Site-Sketch                    (4) | Val  Loss: 0.4842 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.5633 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.9030 | Val  Acc: 0.7477
 Site-Infograph                 (5) | Val  Loss: 1.0734 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8783
============ Train epoch 31 ============
cnt=[4, 1, 3, 4, 2, 2, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (2) | Train Loss: 0.4219 | Train Acc: 0.8609
 Site-Clipart                   (5) | Train Loss: 0.2959 | Train Acc: 0.9379
 Site-Clipart                   (5) | Train Loss: 0.5103 | Train Acc: 0.8622
 Site-Clipart                   (2) | Train Loss: 0.4301 | Train Acc: 0.8703
 Site-Clipart                   (2) | Train Loss: 0.4070 | Train Acc: 0.9072
 Site-Real                      (0) | Train Loss: 0.3604 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2338 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2250 | Train Acc: 0.9597
 Site-Real                      (0) | Train Loss: 0.2827 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.4326 | Train Acc: 0.8912
 Site-Painting                  (3) | Train Loss: 0.3406 | Train Acc: 0.9126
 Site-Painting                  (3) | Train Loss: 0.3637 | Train Acc: 0.9135
 Site-Sketch                    (4) | Train Loss: 0.4801 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.5201 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.7468 | Train Acc: 0.7768
 Site-Infograph                 (3) | Train Loss: 1.0927 | Train Acc: 0.6453
Average Train Accuracy: 0.8776
 Site-Clipart                   (2) | Val  Loss: 0.2960 | Val  Acc: 0.8816
 Site-Clipart                   (5) | Val  Loss: 0.3568 | Val  Acc: 0.9252
 Site-Clipart                   (5) | Val  Loss: 0.4021 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.3787 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.4929 | Val  Acc: 0.8475
 Site-Real                      (0) | Val  Loss: 0.2558 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2425 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2231 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2601 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.2670 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.3508 | Val  Acc: 0.9197
 Site-Painting                  (3) | Val  Loss: 0.3606 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.4371 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.5022 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.8828 | Val  Acc: 0.7477
 Site-Infograph                 (3) | Val  Loss: 1.0173 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8798
============ Train epoch 32 ============
cnt=[1, 4, 2, 5, 3, 1, ]
cnt=[1, 5, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (3) | Train Loss: 0.4751 | Train Acc: 0.8609
 Site-Clipart                   (3) | Train Loss: 0.3126 | Train Acc: 0.9503
 Site-Clipart                   (3) | Train Loss: 0.5000 | Train Acc: 0.8622
 Site-Clipart                   (3) | Train Loss: 0.4135 | Train Acc: 0.8797
 Site-Clipart                   (3) | Train Loss: 0.3892 | Train Acc: 0.9050
 Site-Real                      (1) | Train Loss: 0.3455 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.2344 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.2488 | Train Acc: 0.9476
 Site-Real                      (1) | Train Loss: 0.2804 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.3687 | Train Acc: 0.8844
 Site-Painting                  (4) | Train Loss: 0.4047 | Train Acc: 0.8932
 Site-Painting                  (4) | Train Loss: 0.3566 | Train Acc: 0.9100
 Site-Sketch                    (2) | Train Loss: 0.4444 | Train Acc: 0.8691
 Site-Sketch                    (2) | Train Loss: 0.5006 | Train Acc: 0.8427
 Site-QuickDraw                 (0) | Train Loss: 0.8470 | Train Acc: 0.7339
 Site-Infograph                 (5) | Train Loss: 0.9961 | Train Acc: 0.6709
Average Train Accuracy: 0.8761
 Site-Clipart                   (3) | Val  Loss: 0.2603 | Val  Acc: 0.9474
 Site-Clipart                   (3) | Val  Loss: 0.3658 | Val  Acc: 0.9159
 Site-Clipart                   (3) | Val  Loss: 0.3784 | Val  Acc: 0.8867
 Site-Clipart                   (3) | Val  Loss: 0.4105 | Val  Acc: 0.8762
 Site-Clipart                   (3) | Val  Loss: 0.4720 | Val  Acc: 0.8780
 Site-Real                      (1) | Val  Loss: 0.2424 | Val  Acc: 0.9643
 Site-Real                      (1) | Val  Loss: 0.2455 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.2569 | Val  Acc: 0.9152
 Site-Real                      (1) | Val  Loss: 0.2629 | Val  Acc: 0.9394
 Site-Painting                  (4) | Val  Loss: 0.2318 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.4100 | Val  Acc: 0.9124
 Site-Painting                  (4) | Val  Loss: 0.3746 | Val  Acc: 0.9062
 Site-Sketch                    (2) | Val  Loss: 0.4534 | Val  Acc: 0.8504
 Site-Sketch                    (2) | Val  Loss: 0.5459 | Val  Acc: 0.8034
 Site-QuickDraw                 (0) | Val  Loss: 0.8997 | Val  Acc: 0.7523
 Site-Infograph                 (5) | Val  Loss: 0.9993 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8832
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.9474
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.9159
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.8867
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.8762
 Best site-Clipart                  (3)  | Epoch:32 | Val Acc: 0.8780
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9643
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9492
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9152
 Best site-Real                     (1)  | Epoch:32 | Val Acc: 0.9394
 Best site-Painting                 (4)  | Epoch:32 | Val Acc: 0.9490
 Best site-Painting                 (4)  | Epoch:32 | Val Acc: 0.9124
 Best site-Painting                 (4)  | Epoch:32 | Val Acc: 0.9062
 Best site-Sketch                   (2)  | Epoch:32 | Val Acc: 0.8504
 Best site-Sketch                   (2)  | Epoch:32 | Val Acc: 0.8034
 Best site-QuickDraw                (0)  | Epoch:32 | Val Acc: 0.7523
 Best site-Infograph                (5)  | Epoch:32 | Val Acc: 0.6859
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 1, 4, 5, 3, 1, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (3) | Train Loss: 0.4262 | Train Acc: 0.8783
 Site-Clipart                   (3) | Train Loss: 0.2928 | Train Acc: 0.9379
 Site-Clipart                   (3) | Train Loss: 0.4195 | Train Acc: 0.8711
 Site-Clipart                   (3) | Train Loss: 0.3832 | Train Acc: 0.8829
 Site-Clipart                   (3) | Train Loss: 0.3811 | Train Acc: 0.9231
 Site-Real                      (2) | Train Loss: 0.3708 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.2184 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.2563 | Train Acc: 0.9315
 Site-Real                      (2) | Train Loss: 0.2767 | Train Acc: 0.9483
 Site-Painting                  (4) | Train Loss: 0.4496 | Train Acc: 0.8503
 Site-Painting                  (4) | Train Loss: 0.4113 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.3426 | Train Acc: 0.9170
 Site-Sketch                    (0) | Train Loss: 0.4845 | Train Acc: 0.8482
 Site-Sketch                    (0) | Train Loss: 0.4352 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.8550 | Train Acc: 0.7676
 Site-Infograph                 (5) | Train Loss: 1.0310 | Train Acc: 0.6581
Average Train Accuracy: 0.8761
 Site-Clipart                   (3) | Val  Loss: 0.3121 | Val  Acc: 0.9079
 Site-Clipart                   (3) | Val  Loss: 0.3439 | Val  Acc: 0.9065
 Site-Clipart                   (3) | Val  Loss: 0.3629 | Val  Acc: 0.8933
 Site-Clipart                   (3) | Val  Loss: 0.3820 | Val  Acc: 0.8810
 Site-Clipart                   (3) | Val  Loss: 0.4862 | Val  Acc: 0.8508
 Site-Real                      (2) | Val  Loss: 0.2359 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2203 | Val  Acc: 0.9492
 Site-Real                      (2) | Val  Loss: 0.2534 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.2371 | Val  Acc: 0.9481
 Site-Painting                  (4) | Val  Loss: 0.2411 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.3202 | Val  Acc: 0.8905
 Site-Painting                  (4) | Val  Loss: 0.3416 | Val  Acc: 0.9062
 Site-Sketch                    (0) | Val  Loss: 0.4586 | Val  Acc: 0.8740
 Site-Sketch                    (0) | Val  Loss: 0.5281 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8538 | Val  Acc: 0.7477
 Site-Infograph                 (5) | Val  Loss: 1.0766 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8815
============ Train epoch 34 ============
cnt=[1, 4, 5, 3, 2, 1, ]
cnt=[5, 4, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (2) | Train Loss: 0.3948 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.3110 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.4024 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.3768 | Train Acc: 0.8987
 Site-Clipart                   (2) | Train Loss: 0.4041 | Train Acc: 0.8982
 Site-Real                      (1) | Train Loss: 0.3675 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.2178 | Train Acc: 0.9605
 Site-Real                      (1) | Train Loss: 0.2124 | Train Acc: 0.9597
 Site-Real                      (1) | Train Loss: 0.3029 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.4826 | Train Acc: 0.8639
 Site-Painting                  (3) | Train Loss: 0.4638 | Train Acc: 0.8592
 Site-Painting                  (3) | Train Loss: 0.3555 | Train Acc: 0.9031
 Site-Sketch                    (4) | Train Loss: 0.5045 | Train Acc: 0.8377
 Site-Sketch                    (4) | Train Loss: 0.4832 | Train Acc: 0.8427
 Site-QuickDraw                 (0) | Train Loss: 0.8130 | Train Acc: 0.7859
 Site-Infograph                 (5) | Train Loss: 0.9777 | Train Acc: 0.6795
Average Train Accuracy: 0.8763
 Site-Clipart                   (2) | Val  Loss: 0.2716 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.3127 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.3571 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.3814 | Val  Acc: 0.8714
 Site-Clipart                   (2) | Val  Loss: 0.4685 | Val  Acc: 0.8610
 Site-Real                      (1) | Val  Loss: 0.2360 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2379 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.2425 | Val  Acc: 0.9394
 Site-Real                      (1) | Val  Loss: 0.2657 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.2764 | Val  Acc: 0.8980
 Site-Painting                  (3) | Val  Loss: 0.2899 | Val  Acc: 0.9197
 Site-Painting                  (3) | Val  Loss: 0.3588 | Val  Acc: 0.9010
 Site-Sketch                    (4) | Val  Loss: 0.4343 | Val  Acc: 0.8740
 Site-Sketch                    (4) | Val  Loss: 0.4994 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 0.8889 | Val  Acc: 0.7523
 Site-Infograph                 (5) | Val  Loss: 0.9768 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8776
============ Train epoch 35 ============
cnt=[4, 1, 2, 3, 5, 1, ]
cnt=[1, 5, 3, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (4) | Train Loss: 0.4115 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3018 | Train Acc: 0.9255
 Site-Clipart                   (4) | Train Loss: 0.4471 | Train Acc: 0.8756
 Site-Clipart                   (4) | Train Loss: 0.4143 | Train Acc: 0.8608
 Site-Clipart                   (4) | Train Loss: 0.3907 | Train Acc: 0.9095
 Site-Real                      (0) | Train Loss: 0.3327 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2324 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2297 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.2915 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.4215 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.3787 | Train Acc: 0.8786
 Site-Painting                  (3) | Train Loss: 0.3400 | Train Acc: 0.9377
 Site-Sketch                    (2) | Train Loss: 0.4629 | Train Acc: 0.8586
 Site-Sketch                    (2) | Train Loss: 0.4641 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.8684 | Train Acc: 0.7951
 Site-Infograph                 (5) | Train Loss: 0.9563 | Train Acc: 0.6880
Average Train Accuracy: 0.8806
 Site-Clipart                   (4) | Val  Loss: 0.2971 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.3723 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.3858 | Val  Acc: 0.9067
 Site-Clipart                   (4) | Val  Loss: 0.4153 | Val  Acc: 0.8810
 Site-Clipart                   (4) | Val  Loss: 0.4714 | Val  Acc: 0.8610
 Site-Real                      (0) | Val  Loss: 0.2403 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2484 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2375 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2525 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.2418 | Val  Acc: 0.9388
 Site-Painting                  (3) | Val  Loss: 0.3108 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.3757 | Val  Acc: 0.9219
 Site-Sketch                    (2) | Val  Loss: 0.3800 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.5044 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.8315 | Val  Acc: 0.7706
 Site-Infograph                 (5) | Val  Loss: 1.0004 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8875
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.9342
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.8879
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.9067
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.8810
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.8610
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:35 | Val Acc: 0.9388
 Best site-Painting                 (3)  | Epoch:35 | Val Acc: 0.9051
 Best site-Painting                 (3)  | Epoch:35 | Val Acc: 0.9219
 Best site-Sketch                   (2)  | Epoch:35 | Val Acc: 0.8819
 Best site-Sketch                   (2)  | Epoch:35 | Val Acc: 0.8427
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.7706
 Best site-Infograph                (5)  | Epoch:35 | Val Acc: 0.7051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 36 ============
cnt=[3, 1, 2, 5, 4, 1, ]
cnt=[3, 5, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (3) | Train Loss: 0.3948 | Train Acc: 0.8696
 Site-Clipart                   (3) | Train Loss: 0.3072 | Train Acc: 0.9255
 Site-Clipart                   (3) | Train Loss: 0.4753 | Train Acc: 0.8622
 Site-Clipart                   (3) | Train Loss: 0.3971 | Train Acc: 0.8797
 Site-Clipart                   (3) | Train Loss: 0.3777 | Train Acc: 0.9095
 Site-Real                      (4) | Train Loss: 0.3522 | Train Acc: 0.8968
 Site-Real                      (4) | Train Loss: 0.2420 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2241 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2586 | Train Acc: 0.9483
 Site-Painting                  (0) | Train Loss: 0.3985 | Train Acc: 0.8912
 Site-Painting                  (0) | Train Loss: 0.3905 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.3197 | Train Acc: 0.9135
 Site-Sketch                    (2) | Train Loss: 0.4560 | Train Acc: 0.8534
 Site-Sketch                    (2) | Train Loss: 0.5801 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.8067 | Train Acc: 0.7890
 Site-Infograph                 (5) | Train Loss: 0.9589 | Train Acc: 0.6838
Average Train Accuracy: 0.8793
 Site-Clipart                   (3) | Val  Loss: 0.2736 | Val  Acc: 0.9211
 Site-Clipart                   (3) | Val  Loss: 0.3302 | Val  Acc: 0.9252
 Site-Clipart                   (3) | Val  Loss: 0.3595 | Val  Acc: 0.8867
 Site-Clipart                   (3) | Val  Loss: 0.4067 | Val  Acc: 0.8667
 Site-Clipart                   (3) | Val  Loss: 0.4206 | Val  Acc: 0.8949
 Site-Real                      (4) | Val  Loss: 0.2487 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2396 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2613 | Val  Acc: 0.9212
 Site-Real                      (4) | Val  Loss: 0.2507 | Val  Acc: 0.9437
 Site-Painting                  (0) | Val  Loss: 0.2835 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.2949 | Val  Acc: 0.9051
 Site-Painting                  (0) | Val  Loss: 0.3630 | Val  Acc: 0.9271
 Site-Sketch                    (2) | Val  Loss: 0.4155 | Val  Acc: 0.8898
 Site-Sketch                    (2) | Val  Loss: 0.5188 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8576 | Val  Acc: 0.7936
 Site-Infograph                 (5) | Val  Loss: 0.9884 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8884
 Best site-Clipart                  (3)  | Epoch:36 | Val Acc: 0.9211
 Best site-Clipart                  (3)  | Epoch:36 | Val Acc: 0.9252
 Best site-Clipart                  (3)  | Epoch:36 | Val Acc: 0.8867
 Best site-Clipart                  (3)  | Epoch:36 | Val Acc: 0.8667
 Best site-Clipart                  (3)  | Epoch:36 | Val Acc: 0.8949
 Best site-Real                     (4)  | Epoch:36 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:36 | Val Acc: 0.9492
 Best site-Real                     (4)  | Epoch:36 | Val Acc: 0.9212
 Best site-Real                     (4)  | Epoch:36 | Val Acc: 0.9437
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9184
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9051
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9271
 Best site-Sketch                   (2)  | Epoch:36 | Val Acc: 0.8898
 Best site-Sketch                   (2)  | Epoch:36 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:36 | Val Acc: 0.7936
 Best site-Infograph                (5)  | Epoch:36 | Val Acc: 0.7115
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 1, 4, 3, 5, 1, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (4) | Train Loss: 0.4210 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3090 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.4038 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.3654 | Train Acc: 0.8956
 Site-Clipart                   (4) | Train Loss: 0.3869 | Train Acc: 0.8937
 Site-Real                      (2) | Train Loss: 0.3146 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.1978 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.2318 | Train Acc: 0.9315
 Site-Real                      (2) | Train Loss: 0.2794 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.4347 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.4162 | Train Acc: 0.8689
 Site-Painting                  (3) | Train Loss: 0.3334 | Train Acc: 0.9135
 Site-Sketch                    (0) | Train Loss: 0.4417 | Train Acc: 0.8743
 Site-Sketch                    (0) | Train Loss: 0.4169 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.7503 | Train Acc: 0.7890
 Site-Infograph                 (5) | Train Loss: 0.9522 | Train Acc: 0.7051
Average Train Accuracy: 0.8809
 Site-Clipart                   (4) | Val  Loss: 0.2917 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.3266 | Val  Acc: 0.9065
 Site-Clipart                   (4) | Val  Loss: 0.3888 | Val  Acc: 0.8533
 Site-Clipart                   (4) | Val  Loss: 0.3649 | Val  Acc: 0.8810
 Site-Clipart                   (4) | Val  Loss: 0.4275 | Val  Acc: 0.8814
 Site-Real                      (2) | Val  Loss: 0.2255 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2561 | Val  Acc: 0.9153
 Site-Real                      (2) | Val  Loss: 0.2730 | Val  Acc: 0.9212
 Site-Real                      (2) | Val  Loss: 0.2280 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.2539 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.2866 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3489 | Val  Acc: 0.9167
 Site-Sketch                    (0) | Val  Loss: 0.3832 | Val  Acc: 0.8898
 Site-Sketch                    (0) | Val  Loss: 0.5077 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.8086 | Val  Acc: 0.7890
 Site-Infograph                 (5) | Val  Loss: 1.0252 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8829
============ Train epoch 38 ============
cnt=[3, 1, 5, 2, 1, 4, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (2) | Train Loss: 0.3605 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.3114 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.4397 | Train Acc: 0.8844
 Site-Clipart                   (2) | Train Loss: 0.3893 | Train Acc: 0.8766
 Site-Clipart                   (2) | Train Loss: 0.3662 | Train Acc: 0.9140
 Site-Real                      (5) | Train Loss: 0.3581 | Train Acc: 0.9048
 Site-Real                      (5) | Train Loss: 0.2194 | Train Acc: 0.9605
 Site-Real                      (5) | Train Loss: 0.2192 | Train Acc: 0.9435
 Site-Real                      (5) | Train Loss: 0.2840 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4660 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.3285 | Train Acc: 0.8835
 Site-Painting                  (0) | Train Loss: 0.3311 | Train Acc: 0.9239
 Site-Sketch                    (3) | Train Loss: 0.4126 | Train Acc: 0.8848
 Site-Sketch                    (3) | Train Loss: 0.4472 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.7258 | Train Acc: 0.8073
 Site-Infograph                 (4) | Train Loss: 0.9497 | Train Acc: 0.7009
Average Train Accuracy: 0.8838
 Site-Clipart                   (2) | Val  Loss: 0.2711 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.3404 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.3248 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.3581 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.4540 | Val  Acc: 0.8576
 Site-Real                      (5) | Val  Loss: 0.2343 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.2270 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.2057 | Val  Acc: 0.9515
 Site-Real                      (5) | Val  Loss: 0.2294 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.2533 | Val  Acc: 0.9490
 Site-Painting                  (0) | Val  Loss: 0.3299 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3478 | Val  Acc: 0.9115
 Site-Sketch                    (3) | Val  Loss: 0.4226 | Val  Acc: 0.8425
 Site-Sketch                    (3) | Val  Loss: 0.5264 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.7860 | Val  Acc: 0.7890
 Site-Infograph                 (4) | Val  Loss: 1.0613 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8837
============ Train epoch 39 ============
cnt=[5, 1, 3, 4, 1, 2, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (0) | Train Loss: 0.3988 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.2826 | Train Acc: 0.9255
 Site-Clipart                   (0) | Train Loss: 0.4213 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3992 | Train Acc: 0.8797
 Site-Clipart                   (0) | Train Loss: 0.3517 | Train Acc: 0.9163
 Site-Real                      (3) | Train Loss: 0.3335 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2169 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2348 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.2825 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.4035 | Train Acc: 0.8912
 Site-Painting                  (2) | Train Loss: 0.3426 | Train Acc: 0.8835
 Site-Painting                  (2) | Train Loss: 0.3311 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.4329 | Train Acc: 0.8639
 Site-Sketch                    (5) | Train Loss: 0.5389 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.7728 | Train Acc: 0.8043
 Site-Infograph                 (4) | Train Loss: 0.9106 | Train Acc: 0.6966
Average Train Accuracy: 0.8841
 Site-Clipart                   (0) | Val  Loss: 0.2186 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3506 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.3484 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.3652 | Val  Acc: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.4165 | Val  Acc: 0.8847
 Site-Real                      (3) | Val  Loss: 0.2146 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2372 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2030 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2320 | Val  Acc: 0.9394
 Site-Painting                  (2) | Val  Loss: 0.2543 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.2855 | Val  Acc: 0.9343
 Site-Painting                  (2) | Val  Loss: 0.3338 | Val  Acc: 0.8750
 Site-Sketch                    (5) | Val  Loss: 0.3982 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4854 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.8614 | Val  Acc: 0.7890
 Site-Infograph                 (4) | Val  Loss: 0.9710 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8885
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.9342
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8972
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8867
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8905
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8847
 Best site-Real                     (3)  | Epoch:39 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:39 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:39 | Val Acc: 0.9394
 Best site-Real                     (3)  | Epoch:39 | Val Acc: 0.9394
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9490
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9343
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.8750
 Best site-Sketch                   (5)  | Epoch:39 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:39 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.7890
 Best site-Infograph                (4)  | Epoch:39 | Val Acc: 0.6987
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (0)| Epoch:39 | Test Acc: 0.8897
 Test site-Real                      (3)| Epoch:39 | Test Acc: 0.9458
 Test site-Painting                  (2)| Epoch:39 | Test Acc: 0.9321
 Test site-Sketch                    (5)| Epoch:39 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7340
 Test site-Infograph                 (4)| Epoch:39 | Test Acc: 0.5662
Clipart: 0.8897, Real: 0.9458, Painting: 0.9321, Sketch: 0.8863, QuickDraw: 0.7340, Infograph: 0.5662, 
Average Test Accuracy(group): 0.8257, Average Test Accuracy(individual): 0.8813,
domain std=0.1349, cluster std=0.1349, individual std=0.0954, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 1, 4, 1, 5, 3, ]
cnt=[2, 4, 5, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (4) | Train Loss: 0.3714 | Train Acc: 0.8957
 Site-Clipart                   (4) | Train Loss: 0.2771 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.4198 | Train Acc: 0.8844
 Site-Clipart                   (4) | Train Loss: 0.3723 | Train Acc: 0.8829
 Site-Clipart                   (4) | Train Loss: 0.3768 | Train Acc: 0.9095
 Site-Real                      (2) | Train Loss: 0.3240 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.2191 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.2347 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.2616 | Train Acc: 0.9483
 Site-Painting                  (5) | Train Loss: 0.4564 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.3806 | Train Acc: 0.8883
 Site-Painting                  (5) | Train Loss: 0.3384 | Train Acc: 0.9204
 Site-Sketch                    (0) | Train Loss: 0.4389 | Train Acc: 0.8482
 Site-Sketch                    (0) | Train Loss: 0.3908 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.7981 | Train Acc: 0.7829
 Site-Infograph                 (3) | Train Loss: 0.9148 | Train Acc: 0.7222
Average Train Accuracy: 0.8844
 Site-Clipart                   (4) | Val  Loss: 0.2564 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.3195 | Val  Acc: 0.9346
 Site-Clipart                   (4) | Val  Loss: 0.3409 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.3527 | Val  Acc: 0.8810
 Site-Clipart                   (4) | Val  Loss: 0.4025 | Val  Acc: 0.9085
 Site-Real                      (2) | Val  Loss: 0.2223 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.2328 | Val  Acc: 0.9237
 Site-Real                      (2) | Val  Loss: 0.2470 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.2217 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2403 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.3112 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.3347 | Val  Acc: 0.9115
 Site-Sketch                    (0) | Val  Loss: 0.4022 | Val  Acc: 0.8661
 Site-Sketch                    (0) | Val  Loss: 0.4636 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.8413 | Val  Acc: 0.7661
 Site-Infograph                 (3) | Val  Loss: 0.9465 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8850
 Test site-Clipart                   (4)| Epoch:39 | Test Acc: 0.8859
 Test site-Real                      (2)| Epoch:39 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:39 | Test Acc: 0.9305
 Test site-Sketch                    (0)| Epoch:39 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7370
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5632
Clipart: 0.8859, Real: 0.9449, Painting: 0.9305, Sketch: 0.8881, QuickDraw: 0.7370, Infograph: 0.5632, 
Average Test Accuracy(group): 0.8249, Average Test Accuracy(individual): 0.8798,
domain std=0.1351, cluster std=0.1351, individual std=0.0954, 
Average Test Accuracy: 0.8249
============ Train epoch 41 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (0) | Train Loss: 0.3989 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.2870 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.3626 | Train Acc: 0.8978
 Site-Clipart                   (0) | Train Loss: 0.3610 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.3488 | Train Acc: 0.9208
 Site-Real                      (2) | Train Loss: 0.3141 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.1915 | Train Acc: 0.9774
 Site-Real                      (2) | Train Loss: 0.2252 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2566 | Train Acc: 0.9540
 Site-Painting                  (4) | Train Loss: 0.2818 | Train Acc: 0.9388
 Site-Painting                  (4) | Train Loss: 0.4162 | Train Acc: 0.8544
 Site-Painting                  (4) | Train Loss: 0.3340 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4092 | Train Acc: 0.8796
 Site-Sketch                    (5) | Train Loss: 0.4152 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.7667 | Train Acc: 0.8257
 Site-Infograph                 (3) | Train Loss: 0.9186 | Train Acc: 0.7009
Average Train Accuracy: 0.8919
 Site-Clipart                   (0) | Val  Loss: 0.2762 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.2864 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.3514 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.3700 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4274 | Val  Acc: 0.8780
 Site-Real                      (2) | Val  Loss: 0.2258 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2460 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.2000 | Val  Acc: 0.9455
 Site-Real                      (2) | Val  Loss: 0.2293 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2338 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.3346 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.3238 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.3813 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.4750 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.8081 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 0.9875 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8911
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.9079
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.9346
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8933
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8857
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8780
 Best site-Real                     (2)  | Epoch:41 | Val Acc: 0.9405
 Best site-Real                     (2)  | Epoch:41 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:41 | Val Acc: 0.9455
 Best site-Real                     (2)  | Epoch:41 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:41 | Val Acc: 0.9490
 Best site-Painting                 (4)  | Epoch:41 | Val Acc: 0.8978
 Best site-Painting                 (4)  | Epoch:41 | Val Acc: 0.9219
 Best site-Sketch                   (5)  | Epoch:41 | Val Acc: 0.8976
 Best site-Sketch                   (5)  | Epoch:41 | Val Acc: 0.8596
 Best site-QuickDraw                (1)  | Epoch:41 | Val Acc: 0.7752
 Best site-Infograph                (3)  | Epoch:41 | Val Acc: 0.6859
 Test site-Clipart                   (0)| Epoch:41 | Test Acc: 0.8916
 Test site-Real                      (2)| Epoch:41 | Test Acc: 0.9458
 Test site-Painting                  (4)| Epoch:41 | Test Acc: 0.9289
 Test site-Sketch                    (5)| Epoch:41 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7360
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5632
Clipart: 0.8916, Real: 0.9458, Painting: 0.9289, Sketch: 0.8881, QuickDraw: 0.7360, Infograph: 0.5632, 
Average Test Accuracy(group): 0.8256, Average Test Accuracy(individual): 0.8815,
domain std=0.1356, cluster std=0.1356, individual std=0.0956, 
Average Test Accuracy: 0.8256
============ Train epoch 42 ============
cnt=[3, 1, 5, 1, 4, 2, ]
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (2) | Train Loss: 0.3705 | Train Acc: 0.9043
 Site-Clipart                   (2) | Train Loss: 0.3023 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.4378 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.3531 | Train Acc: 0.9082
 Site-Clipart                   (2) | Train Loss: 0.3560 | Train Acc: 0.9140
 Site-Real                      (4) | Train Loss: 0.3318 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.1866 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2328 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2488 | Train Acc: 0.9368
 Site-Painting                  (0) | Train Loss: 0.3578 | Train Acc: 0.8912
 Site-Painting                  (0) | Train Loss: 0.3670 | Train Acc: 0.8883
 Site-Painting                  (0) | Train Loss: 0.2923 | Train Acc: 0.9446
 Site-Sketch                    (5) | Train Loss: 0.4330 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.5285 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.6891 | Train Acc: 0.8073
 Site-Infograph                 (3) | Train Loss: 0.8994 | Train Acc: 0.7137
Average Train Accuracy: 0.8895
 Site-Clipart                   (2) | Val  Loss: 0.2351 | Val  Acc: 0.9474
 Site-Clipart                   (2) | Val  Loss: 0.2758 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.2932 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.3632 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.4464 | Val  Acc: 0.8610
 Site-Real                      (4) | Val  Loss: 0.2222 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2565 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2183 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2281 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.2620 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.2919 | Val  Acc: 0.9343
 Site-Painting                  (0) | Val  Loss: 0.3304 | Val  Acc: 0.9115
 Site-Sketch                    (5) | Val  Loss: 0.3975 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.4956 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.7955 | Val  Acc: 0.7477
 Site-Infograph                 (3) | Val  Loss: 1.0231 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8915
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9474
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9346
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9000
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.8905
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.8610
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9286
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9407
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9455
 Best site-Real                     (4)  | Epoch:42 | Val Acc: 0.9481
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9388
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9343
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9115
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8819
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:42 | Val Acc: 0.7477
 Best site-Infograph                (3)  | Epoch:42 | Val Acc: 0.7051
 Test site-Clipart                   (2)| Epoch:42 | Test Acc: 0.8954
 Test site-Real                      (4)| Epoch:42 | Test Acc: 0.9458
 Test site-Painting                  (0)| Epoch:42 | Test Acc: 0.9305
 Test site-Sketch                    (5)| Epoch:42 | Test Acc: 0.8809
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7540
 Test site-Infograph                 (3)| Epoch:42 | Test Acc: 0.5571
Clipart: 0.8954, Real: 0.9458, Painting: 0.9305, Sketch: 0.8809, QuickDraw: 0.7540, Infograph: 0.5571, 
Average Test Accuracy(group): 0.8273, Average Test Accuracy(individual): 0.8828,
domain std=0.1358, cluster std=0.1358, individual std=0.0956, 
Average Test Accuracy: 0.8273
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 43 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (4) | Train Loss: 0.3304 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.3014 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.3937 | Train Acc: 0.9022
 Site-Clipart                   (4) | Train Loss: 0.3563 | Train Acc: 0.8924
 Site-Clipart                   (4) | Train Loss: 0.3594 | Train Acc: 0.9231
 Site-Real                      (0) | Train Loss: 0.3161 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2067 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2132 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2432 | Train Acc: 0.9483
 Site-Painting                  (5) | Train Loss: 0.3816 | Train Acc: 0.9048
 Site-Painting                  (5) | Train Loss: 0.3371 | Train Acc: 0.8981
 Site-Painting                  (5) | Train Loss: 0.3254 | Train Acc: 0.9239
 Site-Sketch                    (2) | Train Loss: 0.4564 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.4470 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.8216 | Train Acc: 0.8012
 Site-Infograph                 (3) | Train Loss: 0.8709 | Train Acc: 0.7350
Average Train Accuracy: 0.8924
 Site-Clipart                   (4) | Val  Loss: 0.2504 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.2930 | Val  Acc: 0.9252
 Site-Clipart                   (4) | Val  Loss: 0.3392 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.3774 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.4091 | Val  Acc: 0.8881
 Site-Real                      (0) | Val  Loss: 0.2383 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2157 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2101 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2305 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2408 | Val  Acc: 0.9184
 Site-Painting                  (5) | Val  Loss: 0.3216 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.3224 | Val  Acc: 0.9115
 Site-Sketch                    (2) | Val  Loss: 0.3652 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.4628 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.8048 | Val  Acc: 0.7798
 Site-Infograph                 (3) | Val  Loss: 0.9889 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8891
 Test site-Clipart                   (4)| Epoch:42 | Test Acc: 0.8897
 Test site-Real                      (0)| Epoch:42 | Test Acc: 0.9474
 Test site-Painting                  (5)| Epoch:42 | Test Acc: 0.9289
 Test site-Sketch                    (2)| Epoch:42 | Test Acc: 0.8899
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7520
 Test site-Infograph                 (3)| Epoch:42 | Test Acc: 0.5586
Clipart: 0.8897, Real: 0.9474, Painting: 0.9289, Sketch: 0.8899, QuickDraw: 0.7520, Infograph: 0.5586, 
Average Test Accuracy(group): 0.8278, Average Test Accuracy(individual): 0.8822,
domain std=0.1357, cluster std=0.1357, individual std=0.0954, 
Average Test Accuracy: 0.8278
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 44 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (4) | Train Loss: 0.4068 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.2711 | Train Acc: 0.9255
 Site-Clipart                   (4) | Train Loss: 0.3857 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.3569 | Train Acc: 0.8861
 Site-Clipart                   (4) | Train Loss: 0.3383 | Train Acc: 0.9118
 Site-Real                      (0) | Train Loss: 0.3340 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2164 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2077 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.2488 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.2841 | Train Acc: 0.8776
 Site-Painting                  (5) | Train Loss: 0.3465 | Train Acc: 0.9078
 Site-Painting                  (5) | Train Loss: 0.3315 | Train Acc: 0.9239
 Site-Sketch                    (2) | Train Loss: 0.4195 | Train Acc: 0.8691
 Site-Sketch                    (2) | Train Loss: 0.4540 | Train Acc: 0.8764
 Site-QuickDraw                 (1) | Train Loss: 0.7201 | Train Acc: 0.8104
 Site-Infograph                 (3) | Train Loss: 0.8711 | Train Acc: 0.7393
Average Train Accuracy: 0.8894
 Site-Clipart                   (4) | Val  Loss: 0.2605 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.2884 | Val  Acc: 0.9346
 Site-Clipart                   (4) | Val  Loss: 0.3675 | Val  Acc: 0.8800
 Site-Clipart                   (4) | Val  Loss: 0.3486 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.4535 | Val  Acc: 0.8576
 Site-Real                      (0) | Val  Loss: 0.2335 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2467 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.2215 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2236 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2470 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.2805 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.2905 | Val  Acc: 0.9375
 Site-Sketch                    (2) | Val  Loss: 0.3837 | Val  Acc: 0.8504
 Site-Sketch                    (2) | Val  Loss: 0.4854 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7561 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 0.9061 | Val  Acc: 0.7372
Average Valid Accuracy: 0.8915
 Test site-Clipart                   (4)| Epoch:43 | Test Acc: 0.8840
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:43 | Test Acc: 0.9273
 Test site-Sketch                    (2)| Epoch:43 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7470
 Test site-Infograph                 (3)| Epoch:43 | Test Acc: 0.5571
Clipart: 0.8840, Real: 0.9449, Painting: 0.9273, Sketch: 0.8917, QuickDraw: 0.7470, Infograph: 0.5571, 
Average Test Accuracy(group): 0.8253, Average Test Accuracy(individual): 0.8793,
domain std=0.1358, cluster std=0.1358, individual std=0.0955, 
Average Test Accuracy: 0.8253
============ Train epoch 45 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[3, 1, 5, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (4) | Train Loss: 0.4166 | Train Acc: 0.8870
 Site-Clipart                   (4) | Train Loss: 0.2815 | Train Acc: 0.9006
 Site-Clipart                   (4) | Train Loss: 0.3990 | Train Acc: 0.8978
 Site-Clipart                   (4) | Train Loss: 0.3615 | Train Acc: 0.8924
 Site-Clipart                   (4) | Train Loss: 0.3305 | Train Acc: 0.9253
 Site-Real                      (0) | Train Loss: 0.3338 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2163 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2303 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2676 | Train Acc: 0.9511
 Site-Painting                  (5) | Train Loss: 0.3357 | Train Acc: 0.9116
 Site-Painting                  (5) | Train Loss: 0.3223 | Train Acc: 0.8883
 Site-Painting                  (5) | Train Loss: 0.3062 | Train Acc: 0.9377
 Site-Sketch                    (2) | Train Loss: 0.4229 | Train Acc: 0.8743
 Site-Sketch                    (2) | Train Loss: 0.4150 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.6837 | Train Acc: 0.8104
 Site-Infograph                 (3) | Train Loss: 0.8686 | Train Acc: 0.7222
Average Train Accuracy: 0.8926
 Site-Clipart                   (4) | Val  Loss: 0.2271 | Val  Acc: 0.9474
 Site-Clipart                   (4) | Val  Loss: 0.3000 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.3214 | Val  Acc: 0.9067
 Site-Clipart                   (4) | Val  Loss: 0.3522 | Val  Acc: 0.8952
 Site-Clipart                   (4) | Val  Loss: 0.4004 | Val  Acc: 0.8881
 Site-Real                      (0) | Val  Loss: 0.2285 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2660 | Val  Acc: 0.9153
 Site-Real                      (0) | Val  Loss: 0.2114 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2167 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2134 | Val  Acc: 0.9694
 Site-Painting                  (5) | Val  Loss: 0.2886 | Val  Acc: 0.9197
 Site-Painting                  (5) | Val  Loss: 0.3344 | Val  Acc: 0.9115
 Site-Sketch                    (2) | Val  Loss: 0.3893 | Val  Acc: 0.8740
 Site-Sketch                    (2) | Val  Loss: 0.4319 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.8063 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 0.9769 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8942
 Best site-Clipart                  (4)  | Epoch:45 | Val Acc: 0.9474
 Best site-Clipart                  (4)  | Epoch:45 | Val Acc: 0.9159
 Best site-Clipart                  (4)  | Epoch:45 | Val Acc: 0.9067
 Best site-Clipart                  (4)  | Epoch:45 | Val Acc: 0.8952
 Best site-Clipart                  (4)  | Epoch:45 | Val Acc: 0.8881
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9153
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9567
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9694
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9197
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9115
 Best site-Sketch                   (2)  | Epoch:45 | Val Acc: 0.8740
 Best site-Sketch                   (2)  | Epoch:45 | Val Acc: 0.8539
 Best site-QuickDraw                (1)  | Epoch:45 | Val Acc: 0.7752
 Best site-Infograph                (3)  | Epoch:45 | Val Acc: 0.6923
 Test site-Clipart                   (4)| Epoch:45 | Test Acc: 0.8935
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9305
 Test site-Sketch                    (2)| Epoch:45 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7420
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5632
Clipart: 0.8935, Real: 0.9449, Painting: 0.9305, Sketch: 0.8917, QuickDraw: 0.7420, Infograph: 0.5632, 
Average Test Accuracy(group): 0.8276, Average Test Accuracy(individual): 0.8830,
domain std=0.1354, cluster std=0.1354, individual std=0.0952, 
Average Test Accuracy: 0.8276
============ Train epoch 46 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[2, 5, 1, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (0) | Train Loss: 0.3872 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.3004 | Train Acc: 0.9006
 Site-Clipart                   (0) | Train Loss: 0.4330 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.3468 | Train Acc: 0.9051
 Site-Clipart                   (0) | Train Loss: 0.3373 | Train Acc: 0.9140
 Site-Real                      (4) | Train Loss: 0.3327 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.1843 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2120 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2421 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.3354 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3376 | Train Acc: 0.8738
 Site-Painting                  (2) | Train Loss: 0.2592 | Train Acc: 0.9343
 Site-Sketch                    (5) | Train Loss: 0.4271 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.4581 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.6623 | Train Acc: 0.8410
 Site-Infograph                 (3) | Train Loss: 0.8672 | Train Acc: 0.7393
Average Train Accuracy: 0.8927
 Site-Clipart                   (0) | Val  Loss: 0.2348 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.2878 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3397 | Val  Acc: 0.9133
 Site-Clipart                   (0) | Val  Loss: 0.3598 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.4222 | Val  Acc: 0.8746
 Site-Real                      (4) | Val  Loss: 0.2355 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2602 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2012 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2055 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2015 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.2657 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.3160 | Val  Acc: 0.9427
 Site-Sketch                    (5) | Val  Loss: 0.3616 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.4751 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.8140 | Val  Acc: 0.7661
 Site-Infograph                 (3) | Val  Loss: 0.9562 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8932
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.8954
 Test site-Real                      (4)| Epoch:45 | Test Acc: 0.9466
 Test site-Painting                  (2)| Epoch:45 | Test Acc: 0.9321
 Test site-Sketch                    (5)| Epoch:45 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7420
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5601
Clipart: 0.8954, Real: 0.9466, Painting: 0.9321, Sketch: 0.8935, QuickDraw: 0.7420, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8283, Average Test Accuracy(individual): 0.8843,
domain std=0.1372, cluster std=0.1372, individual std=0.0963, 
Average Test Accuracy: 0.8283
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 47 ============
cnt=[1, 5, 1, 4, 2, 3, ]
cnt=[3, 1, 2, 5, 1, 4, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (1) | Train Loss: 0.3798 | Train Acc: 0.8957
 Site-Clipart                   (1) | Train Loss: 0.3030 | Train Acc: 0.9068
 Site-Clipart                   (1) | Train Loss: 0.4207 | Train Acc: 0.8978
 Site-Clipart                   (1) | Train Loss: 0.3425 | Train Acc: 0.8956
 Site-Clipart                   (1) | Train Loss: 0.3280 | Train Acc: 0.9072
 Site-Real                      (3) | Train Loss: 0.3046 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2023 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2072 | Train Acc: 0.9637
 Site-Real                      (3) | Train Loss: 0.2397 | Train Acc: 0.9397
 Site-Painting                  (5) | Train Loss: 0.3810 | Train Acc: 0.8912
 Site-Painting                  (5) | Train Loss: 0.4008 | Train Acc: 0.8738
 Site-Painting                  (5) | Train Loss: 0.3339 | Train Acc: 0.9170
 Site-Sketch                    (4) | Train Loss: 0.4206 | Train Acc: 0.8691
 Site-Sketch                    (4) | Train Loss: 0.4002 | Train Acc: 0.8539
 Site-QuickDraw                 (2) | Train Loss: 0.7234 | Train Acc: 0.8196
 Site-Infograph                 (0) | Train Loss: 0.8610 | Train Acc: 0.7308
Average Train Accuracy: 0.8890
 Site-Clipart                   (1) | Val  Loss: 0.2080 | Val  Acc: 0.9474
 Site-Clipart                   (1) | Val  Loss: 0.2569 | Val  Acc: 0.9346
 Site-Clipart                   (1) | Val  Loss: 0.3399 | Val  Acc: 0.8933
 Site-Clipart                   (1) | Val  Loss: 0.3115 | Val  Acc: 0.9048
 Site-Clipart                   (1) | Val  Loss: 0.4114 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2375 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2511 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.1936 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2263 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2332 | Val  Acc: 0.9694
 Site-Painting                  (5) | Val  Loss: 0.2661 | Val  Acc: 0.9343
 Site-Painting                  (5) | Val  Loss: 0.3801 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.4065 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.4504 | Val  Acc: 0.8427
 Site-QuickDraw                 (2) | Val  Loss: 0.7538 | Val  Acc: 0.8028
 Site-Infograph                 (0) | Val  Loss: 0.9860 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8922
 Test site-Clipart                   (1)| Epoch:46 | Test Acc: 0.8973
 Test site-Real                      (3)| Epoch:46 | Test Acc: 0.9466
 Test site-Painting                  (5)| Epoch:46 | Test Acc: 0.9289
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8971
 Test site-QuickDraw                 (2)| Epoch:46 | Test Acc: 0.7340
 Test site-Infograph                 (0)| Epoch:46 | Test Acc: 0.5540
Clipart: 0.8973, Real: 0.9466, Painting: 0.9289, Sketch: 0.8971, QuickDraw: 0.7340, Infograph: 0.5540, 
Average Test Accuracy(group): 0.8263, Average Test Accuracy(individual): 0.8839,
domain std=0.1401, cluster std=0.1401, individual std=0.0982, 
Average Test Accuracy: 0.8263
============ Train epoch 48 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.4598 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.2629 | Train Acc: 0.9255
 Site-Clipart                   (0) | Train Loss: 0.4028 | Train Acc: 0.8756
 Site-Clipart                   (0) | Train Loss: 0.3698 | Train Acc: 0.8892
 Site-Clipart                   (0) | Train Loss: 0.3185 | Train Acc: 0.9208
 Site-Real                      (4) | Train Loss: 0.3126 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2280 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2218 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2479 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.3212 | Train Acc: 0.9116
 Site-Painting                  (2) | Train Loss: 0.3243 | Train Acc: 0.8835
 Site-Painting                  (2) | Train Loss: 0.3389 | Train Acc: 0.9135
 Site-Sketch                    (5) | Train Loss: 0.4030 | Train Acc: 0.8848
 Site-Sketch                    (5) | Train Loss: 0.4246 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.6935 | Train Acc: 0.8073
 Site-Infograph                 (3) | Train Loss: 0.8795 | Train Acc: 0.7051
Average Train Accuracy: 0.8848
 Site-Clipart                   (0) | Val  Loss: 0.2130 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.2812 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.3119 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.3446 | Val  Acc: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.4209 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2252 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2325 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.1953 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2060 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2658 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3121 | Val  Acc: 0.8978
 Site-Painting                  (2) | Val  Loss: 0.3504 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.3793 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.4475 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.7711 | Val  Acc: 0.8119
 Site-Infograph                 (3) | Val  Loss: 0.9910 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8899
 Test site-Clipart                   (0)| Epoch:46 | Test Acc: 0.8954
 Test site-Real                      (4)| Epoch:46 | Test Acc: 0.9482
 Test site-Painting                  (2)| Epoch:46 | Test Acc: 0.9257
 Test site-Sketch                    (5)| Epoch:46 | Test Acc: 0.9007
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7420
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5510
Clipart: 0.8954, Real: 0.9482, Painting: 0.9257, Sketch: 0.9007, QuickDraw: 0.7420, Infograph: 0.5510, 
Average Test Accuracy(group): 0.8272, Average Test Accuracy(individual): 0.8839,
domain std=0.1402, cluster std=0.1402, individual std=0.0981, 
Average Test Accuracy: 0.8272
============ Train epoch 49 ============
cnt=[4, 1, 1, 2, 3, 5, ]
cnt=[1, 5, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (5) | Train Loss: 0.3638 | Train Acc: 0.8870
 Site-Clipart                   (5) | Train Loss: 0.2908 | Train Acc: 0.9255
 Site-Clipart                   (5) | Train Loss: 0.3796 | Train Acc: 0.8844
 Site-Clipart                   (5) | Train Loss: 0.3432 | Train Acc: 0.9082
 Site-Clipart                   (5) | Train Loss: 0.3261 | Train Acc: 0.9140
 Site-Real                      (0) | Train Loss: 0.3147 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2097 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2185 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.2479 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.3717 | Train Acc: 0.8776
 Site-Painting                  (4) | Train Loss: 0.2695 | Train Acc: 0.9223
 Site-Painting                  (4) | Train Loss: 0.3153 | Train Acc: 0.9204
 Site-Sketch                    (3) | Train Loss: 0.4373 | Train Acc: 0.8482
 Site-Sketch                    (3) | Train Loss: 0.4908 | Train Acc: 0.8764
 Site-QuickDraw                 (1) | Train Loss: 0.6421 | Train Acc: 0.8226
 Site-Infograph                 (2) | Train Loss: 0.8285 | Train Acc: 0.7735
Average Train Accuracy: 0.8930
 Site-Clipart                   (5) | Val  Loss: 0.2478 | Val  Acc: 0.9474
 Site-Clipart                   (5) | Val  Loss: 0.2973 | Val  Acc: 0.9065
 Site-Clipart                   (5) | Val  Loss: 0.3595 | Val  Acc: 0.8867
 Site-Clipart                   (5) | Val  Loss: 0.3390 | Val  Acc: 0.9000
 Site-Clipart                   (5) | Val  Loss: 0.4217 | Val  Acc: 0.8814
 Site-Real                      (0) | Val  Loss: 0.2289 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2625 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.2147 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2169 | Val  Acc: 0.9481
 Site-Painting                  (4) | Val  Loss: 0.2180 | Val  Acc: 0.9592
 Site-Painting                  (4) | Val  Loss: 0.2910 | Val  Acc: 0.9197
 Site-Painting                  (4) | Val  Loss: 0.3045 | Val  Acc: 0.9167
 Site-Sketch                    (3) | Val  Loss: 0.4053 | Val  Acc: 0.8740
 Site-Sketch                    (3) | Val  Loss: 0.4599 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.7897 | Val  Acc: 0.8119
 Site-Infograph                 (2) | Val  Loss: 1.0291 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8930
 Test site-Clipart                   (5)| Epoch:46 | Test Acc: 0.8935
 Test site-Real                      (0)| Epoch:46 | Test Acc: 0.9499
 Test site-Painting                  (4)| Epoch:46 | Test Acc: 0.9354
 Test site-Sketch                    (3)| Epoch:46 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7440
 Test site-Infograph                 (2)| Epoch:46 | Test Acc: 0.5601
Clipart: 0.8935, Real: 0.9499, Painting: 0.9354, Sketch: 0.8917, QuickDraw: 0.7440, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8291, Average Test Accuracy(individual): 0.8851,
domain std=0.1376, cluster std=0.1376, individual std=0.0969, 
Average Test Accuracy: 0.8291
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (5)| Epoch:49 | Test Acc: 0.8935
 Test site-Real                      (0)| Epoch:49 | Test Acc: 0.9499
 Test site-Painting                  (4)| Epoch:49 | Test Acc: 0.9354
 Test site-Sketch                    (3)| Epoch:49 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7440
 Test site-Infograph                 (2)| Epoch:49 | Test Acc: 0.5601
Clipart: 0.8935, Real: 0.9499, Painting: 0.9354, Sketch: 0.8917, QuickDraw: 0.7440, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8291, Average Test Accuracy(individual): 0.8851,
domain std=0.1376, cluster std=0.1376, individual std=0.0969, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
===2023-06-26 09:23:38===
===2023-06-26 09:23:47===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (5)| Epoch:49 | Test Acc: 0.8935
 Test site-Real                      (0)| Epoch:49 | Test Acc: 0.9499
 Test site-Painting                  (4)| Epoch:49 | Test Acc: 0.9354
 Test site-Sketch                    (3)| Epoch:49 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7440
 Test site-Infograph                 (2)| Epoch:49 | Test Acc: 0.5601
Clipart: 0.8935, Real: 0.9499, Painting: 0.9354, Sketch: 0.8917, QuickDraw: 0.7440, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8291, Average Test Accuracy(individual): 0.8851,
domain std=0.1376, cluster std=0.1376, individual std=0.0969, 
===2023-06-26 10:17:18===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1100 | Train Acc: 0.2522
 Site-Clipart                   (1) | Train Loss: 2.0453 | Train Acc: 0.3540
 Site-Clipart                   (1) | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-Clipart                   (1) | Train Loss: 2.0738 | Train Acc: 0.2911
 Site-Clipart                   (1) | Train Loss: 2.1005 | Train Acc: 0.2715
 Site-Real                      (0) | Train Loss: 2.0876 | Train Acc: 0.3571
 Site-Real                      (0) | Train Loss: 2.0787 | Train Acc: 0.3559
 Site-Real                      (0) | Train Loss: 2.0687 | Train Acc: 0.3589
 Site-Real                      (0) | Train Loss: 2.1167 | Train Acc: 0.2816
 Site-Painting                  (5) | Train Loss: 2.1118 | Train Acc: 0.3605
 Site-Painting                  (5) | Train Loss: 2.1080 | Train Acc: 0.3495
 Site-Painting                  (5) | Train Loss: 2.0811 | Train Acc: 0.3149
 Site-Sketch                    (4) | Train Loss: 2.0476 | Train Acc: 0.3508
 Site-Sketch                    (4) | Train Loss: 2.1048 | Train Acc: 0.3558
 Site-QuickDraw                 (2) | Train Loss: 2.3103 | Train Acc: 0.1713
 Site-Infograph                 (3) | Train Loss: 2.2553 | Train Acc: 0.1880
Average Train Accuracy: 0.3067
 Site-Clipart                   (1) | Val  Loss: 2.0400 | Val  Acc: 0.2500
 Site-Clipart                   (1) | Val  Loss: 2.1068 | Val  Acc: 0.2991
 Site-Clipart                   (1) | Val  Loss: 2.0650 | Val  Acc: 0.3333
 Site-Clipart                   (1) | Val  Loss: 2.0566 | Val  Acc: 0.3571
 Site-Clipart                   (1) | Val  Loss: 2.1134 | Val  Acc: 0.2678
 Site-Real                      (0) | Val  Loss: 2.0676 | Val  Acc: 0.3452
 Site-Real                      (0) | Val  Loss: 2.0913 | Val  Acc: 0.3220
 Site-Real                      (0) | Val  Loss: 2.0499 | Val  Acc: 0.4061
 Site-Real                      (0) | Val  Loss: 2.0611 | Val  Acc: 0.3766
 Site-Painting                  (5) | Val  Loss: 2.1028 | Val  Acc: 0.3776
 Site-Painting                  (5) | Val  Loss: 2.0467 | Val  Acc: 0.3650
 Site-Painting                  (5) | Val  Loss: 2.1136 | Val  Acc: 0.3385
 Site-Sketch                    (4) | Val  Loss: 2.0787 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0737 | Val  Acc: 0.3539
 Site-QuickDraw                 (2) | Val  Loss: 2.3222 | Val  Acc: 0.1881
 Site-Infograph                 (3) | Val  Loss: 2.2939 | Val  Acc: 0.1603
Average Valid Accuracy: 0.3189
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2991
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2678
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3452
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3220
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4061
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3766
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3776
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3650
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3385
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3539
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1881
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.1603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 4, 3, 1, 6, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (5) | Train Loss: 1.8906 | Train Acc: 0.5217
 Site-Clipart                   (5) | Train Loss: 1.8368 | Train Acc: 0.5342
 Site-Clipart                   (5) | Train Loss: 1.9234 | Train Acc: 0.4400
 Site-Clipart                   (0) | Train Loss: 1.8668 | Train Acc: 0.5253
 Site-Clipart                   (5) | Train Loss: 1.8863 | Train Acc: 0.5226
 Site-Real                      (2) | Train Loss: 1.8942 | Train Acc: 0.5238
 Site-Real                      (2) | Train Loss: 1.8309 | Train Acc: 0.6158
 Site-Real                      (2) | Train Loss: 1.7609 | Train Acc: 0.6855
 Site-Real                      (2) | Train Loss: 1.8465 | Train Acc: 0.5546
 Site-Painting                  (3) | Train Loss: 1.8302 | Train Acc: 0.4898
 Site-Painting                  (3) | Train Loss: 1.8952 | Train Acc: 0.4903
 Site-Painting                  (3) | Train Loss: 1.8248 | Train Acc: 0.5225
 Site-Sketch                    (5) | Train Loss: 1.8684 | Train Acc: 0.5393
 Site-Sketch                    (5) | Train Loss: 1.9093 | Train Acc: 0.4831
 Site-QuickDraw                 (1) | Train Loss: 2.2737 | Train Acc: 0.1713
 Site-Infograph                 (4) | Train Loss: 2.1431 | Train Acc: 0.2863
Average Train Accuracy: 0.4941
 Site-Clipart                   (5) | Val  Loss: 1.7380 | Val  Acc: 0.5526
 Site-Clipart                   (5) | Val  Loss: 1.9050 | Val  Acc: 0.5047
 Site-Clipart                   (5) | Val  Loss: 1.8621 | Val  Acc: 0.5667
 Site-Clipart                   (0) | Val  Loss: 1.8484 | Val  Acc: 0.5286
 Site-Clipart                   (5) | Val  Loss: 1.9273 | Val  Acc: 0.4407
 Site-Real                      (2) | Val  Loss: 1.7456 | Val  Acc: 0.5714
 Site-Real                      (2) | Val  Loss: 1.8087 | Val  Acc: 0.6017
 Site-Real                      (2) | Val  Loss: 1.7505 | Val  Acc: 0.6909
 Site-Real                      (2) | Val  Loss: 1.7842 | Val  Acc: 0.6450
 Site-Painting                  (3) | Val  Loss: 1.8062 | Val  Acc: 0.6122
 Site-Painting                  (3) | Val  Loss: 1.8216 | Val  Acc: 0.5036
 Site-Painting                  (3) | Val  Loss: 1.8734 | Val  Acc: 0.5104
 Site-Sketch                    (5) | Val  Loss: 1.8364 | Val  Acc: 0.5669
 Site-Sketch                    (5) | Val  Loss: 1.9051 | Val  Acc: 0.4494
 Site-QuickDraw                 (1) | Val  Loss: 2.2885 | Val  Acc: 0.2018
 Site-Infograph                 (4) | Val  Loss: 2.0849 | Val  Acc: 0.3141
Average Valid Accuracy: 0.5163
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5526
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5047
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5667
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5286
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4407
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5714
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6017
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6909
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6450
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.6122
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5036
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5104
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5669
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4494
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.2018
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.3141
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[2, 1, 3, 5, 1, 4, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.7028 | Train Acc: 0.5652
 Site-Clipart                   (0) | Train Loss: 1.6293 | Train Acc: 0.6087
 Site-Clipart                   (0) | Train Loss: 1.7449 | Train Acc: 0.5511
 Site-Clipart                   (0) | Train Loss: 1.6739 | Train Acc: 0.6076
 Site-Clipart                   (0) | Train Loss: 1.6961 | Train Acc: 0.6176
 Site-Real                      (2) | Train Loss: 1.6264 | Train Acc: 0.7063
 Site-Real                      (2) | Train Loss: 1.5527 | Train Acc: 0.7627
 Site-Real                      (2) | Train Loss: 1.5337 | Train Acc: 0.7419
 Site-Real                      (2) | Train Loss: 1.6404 | Train Acc: 0.6925
 Site-Painting                  (4) | Train Loss: 1.6832 | Train Acc: 0.6190
 Site-Painting                  (4) | Train Loss: 1.6877 | Train Acc: 0.5922
 Site-Painting                  (4) | Train Loss: 1.6495 | Train Acc: 0.6263
 Site-Sketch                    (5) | Train Loss: 1.6629 | Train Acc: 0.6283
 Site-Sketch                    (5) | Train Loss: 1.7014 | Train Acc: 0.6030
 Site-QuickDraw                 (1) | Train Loss: 2.2064 | Train Acc: 0.1927
 Site-Infograph                 (3) | Train Loss: 2.0949 | Train Acc: 0.2863
Average Train Accuracy: 0.5876
 Site-Clipart                   (0) | Val  Loss: 1.5842 | Val  Acc: 0.6316
 Site-Clipart                   (0) | Val  Loss: 1.6491 | Val  Acc: 0.6729
 Site-Clipart                   (0) | Val  Loss: 1.6892 | Val  Acc: 0.6200
 Site-Clipart                   (0) | Val  Loss: 1.6651 | Val  Acc: 0.6190
 Site-Clipart                   (0) | Val  Loss: 1.7421 | Val  Acc: 0.5627
 Site-Real                      (2) | Val  Loss: 1.5908 | Val  Acc: 0.6310
 Site-Real                      (2) | Val  Loss: 1.5824 | Val  Acc: 0.6949
 Site-Real                      (2) | Val  Loss: 1.4903 | Val  Acc: 0.7455
 Site-Real                      (2) | Val  Loss: 1.5605 | Val  Acc: 0.7706
 Site-Painting                  (4) | Val  Loss: 1.6487 | Val  Acc: 0.6429
 Site-Painting                  (4) | Val  Loss: 1.5942 | Val  Acc: 0.6058
 Site-Painting                  (4) | Val  Loss: 1.6735 | Val  Acc: 0.5885
 Site-Sketch                    (5) | Val  Loss: 1.6700 | Val  Acc: 0.5906
 Site-Sketch                    (5) | Val  Loss: 1.7495 | Val  Acc: 0.5281
 Site-QuickDraw                 (1) | Val  Loss: 2.2164 | Val  Acc: 0.2156
 Site-Infograph                 (3) | Val  Loss: 2.0750 | Val  Acc: 0.3397
Average Valid Accuracy: 0.5912
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6316
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6729
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6200
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6190
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5627
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.6310
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.6949
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7455
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7706
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6429
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6058
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.5885
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5906
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5281
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2156
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.3397
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 1, 4, 3, 1, 2, ]
cnt=[3, 5, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.5710 | Train Acc: 0.6087
 Site-Clipart                   (0) | Train Loss: 1.4633 | Train Acc: 0.7081
 Site-Clipart                   (0) | Train Loss: 1.6195 | Train Acc: 0.6578
 Site-Clipart                   (0) | Train Loss: 1.5312 | Train Acc: 0.6551
 Site-Clipart                   (0) | Train Loss: 1.5384 | Train Acc: 0.6946
 Site-Real                      (2) | Train Loss: 1.4214 | Train Acc: 0.7698
 Site-Real                      (2) | Train Loss: 1.3317 | Train Acc: 0.7514
 Site-Real                      (2) | Train Loss: 1.3023 | Train Acc: 0.7944
 Site-Real                      (2) | Train Loss: 1.4193 | Train Acc: 0.7615
 Site-Painting                  (3) | Train Loss: 1.4980 | Train Acc: 0.6667
 Site-Painting                  (3) | Train Loss: 1.4974 | Train Acc: 0.6699
 Site-Painting                  (3) | Train Loss: 1.4498 | Train Acc: 0.6990
 Site-Sketch                    (5) | Train Loss: 1.4920 | Train Acc: 0.6545
 Site-Sketch                    (5) | Train Loss: 1.5176 | Train Acc: 0.6292
 Site-QuickDraw                 (1) | Train Loss: 2.1225 | Train Acc: 0.2446
 Site-Infograph                 (4) | Train Loss: 2.0054 | Train Acc: 0.3889
Average Train Accuracy: 0.6471
 Site-Clipart                   (0) | Val  Loss: 1.4214 | Val  Acc: 0.7237
 Site-Clipart                   (0) | Val  Loss: 1.5084 | Val  Acc: 0.6916
 Site-Clipart                   (0) | Val  Loss: 1.5159 | Val  Acc: 0.6933
 Site-Clipart                   (0) | Val  Loss: 1.4896 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 1.5825 | Val  Acc: 0.6271
 Site-Real                      (2) | Val  Loss: 1.3032 | Val  Acc: 0.7738
 Site-Real                      (2) | Val  Loss: 1.3380 | Val  Acc: 0.7458
 Site-Real                      (2) | Val  Loss: 1.2711 | Val  Acc: 0.8303
 Site-Real                      (2) | Val  Loss: 1.2927 | Val  Acc: 0.8268
 Site-Painting                  (3) | Val  Loss: 1.3791 | Val  Acc: 0.7755
 Site-Painting                  (3) | Val  Loss: 1.4399 | Val  Acc: 0.7226
 Site-Painting                  (3) | Val  Loss: 1.4746 | Val  Acc: 0.6875
 Site-Sketch                    (5) | Val  Loss: 1.4634 | Val  Acc: 0.7165
 Site-Sketch                    (5) | Val  Loss: 1.5848 | Val  Acc: 0.6011
 Site-QuickDraw                 (1) | Val  Loss: 2.1347 | Val  Acc: 0.2477
 Site-Infograph                 (4) | Val  Loss: 1.9513 | Val  Acc: 0.3974
Average Valid Accuracy: 0.6705
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7237
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6916
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6933
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6271
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.7738
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.7458
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8303
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8268
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7755
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7226
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6875
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.7165
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6011
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.2477
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.3974
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 3, 1, 4, 1, 2, ]
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.4152 | Train Acc: 0.6609
 Site-Clipart                   (0) | Train Loss: 1.2990 | Train Acc: 0.7205
 Site-Clipart                   (0) | Train Loss: 1.4437 | Train Acc: 0.6889
 Site-Clipart                   (0) | Train Loss: 1.3441 | Train Acc: 0.7184
 Site-Clipart                   (0) | Train Loss: 1.3792 | Train Acc: 0.7308
 Site-Real                      (3) | Train Loss: 1.2585 | Train Acc: 0.8175
 Site-Real                      (3) | Train Loss: 1.1587 | Train Acc: 0.8305
 Site-Real                      (3) | Train Loss: 1.1001 | Train Acc: 0.8468
 Site-Real                      (3) | Train Loss: 1.2470 | Train Acc: 0.8218
 Site-Painting                  (1) | Train Loss: 1.2919 | Train Acc: 0.7347
 Site-Painting                  (1) | Train Loss: 1.2544 | Train Acc: 0.7282
 Site-Painting                  (1) | Train Loss: 1.2512 | Train Acc: 0.7405
 Site-Sketch                    (5) | Train Loss: 1.3470 | Train Acc: 0.7120
 Site-Sketch                    (5) | Train Loss: 1.3598 | Train Acc: 0.6891
 Site-QuickDraw                 (2) | Train Loss: 2.0899 | Train Acc: 0.2997
 Site-Infograph                 (4) | Train Loss: 1.9079 | Train Acc: 0.4188
Average Train Accuracy: 0.6974
 Site-Clipart                   (0) | Val  Loss: 1.2728 | Val  Acc: 0.7632
 Site-Clipart                   (0) | Val  Loss: 1.3374 | Val  Acc: 0.7664
 Site-Clipart                   (0) | Val  Loss: 1.3462 | Val  Acc: 0.7400
 Site-Clipart                   (0) | Val  Loss: 1.3115 | Val  Acc: 0.7143
 Site-Clipart                   (0) | Val  Loss: 1.4370 | Val  Acc: 0.6881
 Site-Real                      (3) | Val  Loss: 1.1639 | Val  Acc: 0.8214
 Site-Real                      (3) | Val  Loss: 1.1612 | Val  Acc: 0.8220
 Site-Real                      (3) | Val  Loss: 1.0725 | Val  Acc: 0.8545
 Site-Real                      (3) | Val  Loss: 1.1259 | Val  Acc: 0.8442
 Site-Painting                  (1) | Val  Loss: 1.2005 | Val  Acc: 0.7755
 Site-Painting                  (1) | Val  Loss: 1.2522 | Val  Acc: 0.7445
 Site-Painting                  (1) | Val  Loss: 1.2961 | Val  Acc: 0.7292
 Site-Sketch                    (5) | Val  Loss: 1.3579 | Val  Acc: 0.6929
 Site-Sketch                    (5) | Val  Loss: 1.4058 | Val  Acc: 0.6124
 Site-QuickDraw                 (2) | Val  Loss: 2.0783 | Val  Acc: 0.3119
 Site-Infograph                 (4) | Val  Loss: 1.8377 | Val  Acc: 0.4423
Average Valid Accuracy: 0.7077
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7632
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7664
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7400
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7143
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6881
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8214
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8220
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8545
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8442
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7755
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7445
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7292
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6929
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6124
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.3119
 Best site-Infograph                (4)  | Epoch:4 | Val Acc: 0.4423
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 5 ============
cnt=[5, 1, 4, 3, 1, 2, ]
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (0) | Train Loss: 1.3131 | Train Acc: 0.7391
 Site-Clipart                   (0) | Train Loss: 1.1539 | Train Acc: 0.7516
 Site-Clipart                   (0) | Train Loss: 1.3031 | Train Acc: 0.7333
 Site-Clipart                   (0) | Train Loss: 1.2058 | Train Acc: 0.7532
 Site-Clipart                   (0) | Train Loss: 1.2548 | Train Acc: 0.7489
 Site-Real                      (2) | Train Loss: 1.0931 | Train Acc: 0.8571
 Site-Real                      (2) | Train Loss: 1.0111 | Train Acc: 0.8531
 Site-Real                      (2) | Train Loss: 0.9682 | Train Acc: 0.8629
 Site-Real                      (2) | Train Loss: 1.1271 | Train Acc: 0.8305
 Site-Painting                  (3) | Train Loss: 1.1582 | Train Acc: 0.7619
 Site-Painting                  (3) | Train Loss: 1.2034 | Train Acc: 0.7718
 Site-Painting                  (3) | Train Loss: 1.1415 | Train Acc: 0.7820
 Site-Sketch                    (5) | Train Loss: 1.2340 | Train Acc: 0.6911
 Site-Sketch                    (5) | Train Loss: 1.1910 | Train Acc: 0.6742
 Site-QuickDraw                 (1) | Train Loss: 2.0016 | Train Acc: 0.3456
 Site-Infograph                 (4) | Train Loss: 1.8606 | Train Acc: 0.3889
Average Train Accuracy: 0.7216
 Site-Clipart                   (0) | Val  Loss: 1.0898 | Val  Acc: 0.7763
 Site-Clipart                   (0) | Val  Loss: 1.1825 | Val  Acc: 0.7944
 Site-Clipart                   (0) | Val  Loss: 1.1900 | Val  Acc: 0.7867
 Site-Clipart                   (0) | Val  Loss: 1.1788 | Val  Acc: 0.7762
 Site-Clipart                   (0) | Val  Loss: 1.2963 | Val  Acc: 0.7051
 Site-Real                      (2) | Val  Loss: 1.0292 | Val  Acc: 0.8214
 Site-Real                      (2) | Val  Loss: 1.0322 | Val  Acc: 0.8051
 Site-Real                      (2) | Val  Loss: 0.9507 | Val  Acc: 0.8848
 Site-Real                      (2) | Val  Loss: 0.9822 | Val  Acc: 0.8658
 Site-Painting                  (3) | Val  Loss: 1.1070 | Val  Acc: 0.7857
 Site-Painting                  (3) | Val  Loss: 1.0790 | Val  Acc: 0.7956
 Site-Painting                  (3) | Val  Loss: 1.1524 | Val  Acc: 0.7917
 Site-Sketch                    (5) | Val  Loss: 1.1946 | Val  Acc: 0.7402
 Site-Sketch                    (5) | Val  Loss: 1.2665 | Val  Acc: 0.6854
 Site-QuickDraw                 (1) | Val  Loss: 2.0079 | Val  Acc: 0.3119
 Site-Infograph                 (4) | Val  Loss: 1.7979 | Val  Acc: 0.4423
Average Valid Accuracy: 0.7355
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7763
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7944
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7867
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7762
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7051
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8214
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8051
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8848
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8658
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.7857
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.7956
 Best site-Painting                 (3)  | Epoch:5 | Val Acc: 0.7917
 Best site-Sketch                   (5)  | Epoch:5 | Val Acc: 0.7402
 Best site-Sketch                   (5)  | Epoch:5 | Val Acc: 0.6854
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.3119
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.4423
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 1, 5, 3, 1, 2, ]
cnt=[1, 3, 1, 5, 4, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (2) | Train Loss: 1.2149 | Train Acc: 0.7217
 Site-Clipart                   (2) | Train Loss: 1.0061 | Train Acc: 0.7640
 Site-Clipart                   (2) | Train Loss: 1.1804 | Train Acc: 0.7378
 Site-Clipart                   (2) | Train Loss: 1.1066 | Train Acc: 0.7816
 Site-Clipart                   (2) | Train Loss: 1.1151 | Train Acc: 0.7828
 Site-Real                      (0) | Train Loss: 0.9912 | Train Acc: 0.8810
 Site-Real                      (0) | Train Loss: 0.8766 | Train Acc: 0.8757
 Site-Real                      (0) | Train Loss: 0.8170 | Train Acc: 0.8992
 Site-Real                      (0) | Train Loss: 0.9585 | Train Acc: 0.8678
 Site-Painting                  (3) | Train Loss: 1.1025 | Train Acc: 0.7823
 Site-Painting                  (3) | Train Loss: 1.0861 | Train Acc: 0.7913
 Site-Painting                  (3) | Train Loss: 1.0252 | Train Acc: 0.8028
 Site-Sketch                    (5) | Train Loss: 1.1199 | Train Acc: 0.7225
 Site-Sketch                    (5) | Train Loss: 1.0780 | Train Acc: 0.7491
 Site-QuickDraw                 (1) | Train Loss: 1.9282 | Train Acc: 0.3425
 Site-Infograph                 (4) | Train Loss: 1.7657 | Train Acc: 0.4744
Average Train Accuracy: 0.7485
 Site-Clipart                   (2) | Val  Loss: 0.9766 | Val  Acc: 0.8026
 Site-Clipart                   (2) | Val  Loss: 1.0786 | Val  Acc: 0.7850
 Site-Clipart                   (2) | Val  Loss: 1.0934 | Val  Acc: 0.7800
 Site-Clipart                   (2) | Val  Loss: 1.0549 | Val  Acc: 0.7762
 Site-Clipart                   (2) | Val  Loss: 1.1819 | Val  Acc: 0.7322
 Site-Real                      (0) | Val  Loss: 0.8874 | Val  Acc: 0.8690
 Site-Real                      (0) | Val  Loss: 0.8815 | Val  Acc: 0.8559
 Site-Real                      (0) | Val  Loss: 0.8229 | Val  Acc: 0.8788
 Site-Real                      (0) | Val  Loss: 0.8523 | Val  Acc: 0.9004
 Site-Painting                  (3) | Val  Loss: 0.9540 | Val  Acc: 0.8265
 Site-Painting                  (3) | Val  Loss: 1.0063 | Val  Acc: 0.8175
 Site-Painting                  (3) | Val  Loss: 0.9882 | Val  Acc: 0.8073
 Site-Sketch                    (5) | Val  Loss: 1.1304 | Val  Acc: 0.7244
 Site-Sketch                    (5) | Val  Loss: 1.1392 | Val  Acc: 0.7079
 Site-QuickDraw                 (1) | Val  Loss: 1.9558 | Val  Acc: 0.3073
 Site-Infograph                 (4) | Val  Loss: 1.7108 | Val  Acc: 0.4808
Average Valid Accuracy: 0.7532
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.8026
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7850
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7800
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7762
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7322
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8690
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8559
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8788
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.9004
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8265
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8175
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8073
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7244
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7079
 Best site-QuickDraw                (1)  | Epoch:6 | Val Acc: 0.3073
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.4808
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 1, 3, 4, 5, 1, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (4) | Train Loss: 1.0065 | Train Acc: 0.8000
 Site-Clipart                   (4) | Train Loss: 0.9483 | Train Acc: 0.8199
 Site-Clipart                   (4) | Train Loss: 1.0380 | Train Acc: 0.8000
 Site-Clipart                   (4) | Train Loss: 0.9932 | Train Acc: 0.8070
 Site-Clipart                   (4) | Train Loss: 1.0178 | Train Acc: 0.7941
 Site-Real                      (3) | Train Loss: 0.8756 | Train Acc: 0.8889
 Site-Real                      (3) | Train Loss: 0.7912 | Train Acc: 0.9096
 Site-Real                      (3) | Train Loss: 0.7178 | Train Acc: 0.8871
 Site-Real                      (3) | Train Loss: 0.8591 | Train Acc: 0.8851
 Site-Painting                  (2) | Train Loss: 0.9825 | Train Acc: 0.7755
 Site-Painting                  (2) | Train Loss: 0.9498 | Train Acc: 0.8301
 Site-Painting                  (2) | Train Loss: 0.8975 | Train Acc: 0.8235
 Site-Sketch                    (0) | Train Loss: 0.9954 | Train Acc: 0.7382
 Site-Sketch                    (0) | Train Loss: 1.0092 | Train Acc: 0.7341
 Site-QuickDraw                 (1) | Train Loss: 1.8679 | Train Acc: 0.3761
 Site-Infograph                 (5) | Train Loss: 1.6865 | Train Acc: 0.4658
Average Train Accuracy: 0.7709
 Site-Clipart                   (4) | Val  Loss: 0.8689 | Val  Acc: 0.8158
 Site-Clipart                   (4) | Val  Loss: 0.9530 | Val  Acc: 0.8224
 Site-Clipart                   (4) | Val  Loss: 1.0280 | Val  Acc: 0.8000
 Site-Clipart                   (4) | Val  Loss: 0.9761 | Val  Acc: 0.7857
 Site-Clipart                   (4) | Val  Loss: 1.0765 | Val  Acc: 0.7695
 Site-Real                      (3) | Val  Loss: 0.8048 | Val  Acc: 0.8929
 Site-Real                      (3) | Val  Loss: 0.7880 | Val  Acc: 0.8898
 Site-Real                      (3) | Val  Loss: 0.7062 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.7696 | Val  Acc: 0.8874
 Site-Painting                  (2) | Val  Loss: 0.8581 | Val  Acc: 0.8163
 Site-Painting                  (2) | Val  Loss: 0.8857 | Val  Acc: 0.8175
 Site-Painting                  (2) | Val  Loss: 0.9188 | Val  Acc: 0.8021
 Site-Sketch                    (0) | Val  Loss: 0.9672 | Val  Acc: 0.8110
 Site-Sketch                    (0) | Val  Loss: 1.0543 | Val  Acc: 0.7022
 Site-QuickDraw                 (1) | Val  Loss: 1.8830 | Val  Acc: 0.3807
 Site-Infograph                 (5) | Val  Loss: 1.6198 | Val  Acc: 0.5064
Average Valid Accuracy: 0.7763
 Best site-Clipart                  (4)  | Epoch:7 | Val Acc: 0.8158
 Best site-Clipart                  (4)  | Epoch:7 | Val Acc: 0.8224
 Best site-Clipart                  (4)  | Epoch:7 | Val Acc: 0.8000
 Best site-Clipart                  (4)  | Epoch:7 | Val Acc: 0.7857
 Best site-Clipart                  (4)  | Epoch:7 | Val Acc: 0.7695
 Best site-Real                     (3)  | Epoch:7 | Val Acc: 0.8929
 Best site-Real                     (3)  | Epoch:7 | Val Acc: 0.8898
 Best site-Real                     (3)  | Epoch:7 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:7 | Val Acc: 0.8874
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8163
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8175
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8021
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.8110
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7022
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.3807
 Best site-Infograph                (5)  | Epoch:7 | Val Acc: 0.5064
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 1, 4, 3, 1, 2, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 0.9620 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.8491 | Train Acc: 0.8385
 Site-Clipart                   (0) | Train Loss: 0.9923 | Train Acc: 0.8133
 Site-Clipart                   (0) | Train Loss: 0.9052 | Train Acc: 0.8165
 Site-Clipart                   (0) | Train Loss: 0.9201 | Train Acc: 0.8077
 Site-Real                      (2) | Train Loss: 0.8150 | Train Acc: 0.8889
 Site-Real                      (2) | Train Loss: 0.6858 | Train Acc: 0.9153
 Site-Real                      (2) | Train Loss: 0.6503 | Train Acc: 0.9153
 Site-Real                      (2) | Train Loss: 0.7885 | Train Acc: 0.8994
 Site-Painting                  (3) | Train Loss: 0.9113 | Train Acc: 0.8231
 Site-Painting                  (3) | Train Loss: 0.9149 | Train Acc: 0.8107
 Site-Painting                  (3) | Train Loss: 0.8070 | Train Acc: 0.8547
 Site-Sketch                    (5) | Train Loss: 0.9023 | Train Acc: 0.7801
 Site-Sketch                    (5) | Train Loss: 0.9717 | Train Acc: 0.7715
 Site-QuickDraw                 (1) | Train Loss: 1.7422 | Train Acc: 0.4404
 Site-Infograph                 (4) | Train Loss: 1.6202 | Train Acc: 0.4744
Average Train Accuracy: 0.7939
 Site-Clipart                   (0) | Val  Loss: 0.7747 | Val  Acc: 0.8289
 Site-Clipart                   (0) | Val  Loss: 0.8769 | Val  Acc: 0.8224
 Site-Clipart                   (0) | Val  Loss: 0.8893 | Val  Acc: 0.8133
 Site-Clipart                   (0) | Val  Loss: 0.8760 | Val  Acc: 0.8048
 Site-Clipart                   (0) | Val  Loss: 0.9974 | Val  Acc: 0.8000
 Site-Real                      (2) | Val  Loss: 0.6644 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.6996 | Val  Acc: 0.9068
 Site-Real                      (2) | Val  Loss: 0.6337 | Val  Acc: 0.9030
 Site-Real                      (2) | Val  Loss: 0.6679 | Val  Acc: 0.9091
 Site-Painting                  (3) | Val  Loss: 0.7505 | Val  Acc: 0.8878
 Site-Painting                  (3) | Val  Loss: 0.7792 | Val  Acc: 0.8248
 Site-Painting                  (3) | Val  Loss: 0.8338 | Val  Acc: 0.8333
 Site-Sketch                    (5) | Val  Loss: 0.8946 | Val  Acc: 0.8189
 Site-Sketch                    (5) | Val  Loss: 0.9732 | Val  Acc: 0.7416
 Site-QuickDraw                 (1) | Val  Loss: 1.7924 | Val  Acc: 0.4679
 Site-Infograph                 (4) | Val  Loss: 1.5460 | Val  Acc: 0.5513
Average Valid Accuracy: 0.8012
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8289
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8224
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8133
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8048
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8000
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9048
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9068
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9030
 Best site-Real                     (2)  | Epoch:8 | Val Acc: 0.9091
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8878
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8248
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8333
 Best site-Sketch                   (5)  | Epoch:8 | Val Acc: 0.8189
 Best site-Sketch                   (5)  | Epoch:8 | Val Acc: 0.7416
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.4679
 Best site-Infograph                (4)  | Epoch:8 | Val Acc: 0.5513
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 5, 4, 3, 2, 1, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (1) | Train Loss: 0.8449 | Train Acc: 0.8348
 Site-Clipart                   (1) | Train Loss: 0.7818 | Train Acc: 0.8261
 Site-Clipart                   (1) | Train Loss: 0.9119 | Train Acc: 0.8356
 Site-Clipart                   (1) | Train Loss: 0.8196 | Train Acc: 0.8165
 Site-Clipart                   (1) | Train Loss: 0.8414 | Train Acc: 0.8371
 Site-Real                      (2) | Train Loss: 0.7061 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.5959 | Train Acc: 0.9379
 Site-Real                      (2) | Train Loss: 0.5682 | Train Acc: 0.9234
 Site-Real                      (2) | Train Loss: 0.6870 | Train Acc: 0.9109
 Site-Painting                  (3) | Train Loss: 0.8022 | Train Acc: 0.8163
 Site-Painting                  (3) | Train Loss: 0.8387 | Train Acc: 0.8350
 Site-Painting                  (3) | Train Loss: 0.7605 | Train Acc: 0.8339
 Site-Sketch                    (4) | Train Loss: 0.8478 | Train Acc: 0.7801
 Site-Sketch                    (4) | Train Loss: 0.8559 | Train Acc: 0.7603
 Site-QuickDraw                 (0) | Train Loss: 1.6149 | Train Acc: 0.5015
 Site-Infograph                 (5) | Train Loss: 1.6092 | Train Acc: 0.4701
Average Train Accuracy: 0.8015
 Site-Clipart                   (1) | Val  Loss: 0.6969 | Val  Acc: 0.8289
 Site-Clipart                   (1) | Val  Loss: 0.7833 | Val  Acc: 0.8505
 Site-Clipart                   (1) | Val  Loss: 0.8189 | Val  Acc: 0.8400
 Site-Clipart                   (1) | Val  Loss: 0.7588 | Val  Acc: 0.8524
 Site-Clipart                   (1) | Val  Loss: 0.9051 | Val  Acc: 0.8034
 Site-Real                      (2) | Val  Loss: 0.6149 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.5986 | Val  Acc: 0.9492
 Site-Real                      (2) | Val  Loss: 0.5723 | Val  Acc: 0.9212
 Site-Real                      (2) | Val  Loss: 0.6104 | Val  Acc: 0.9221
 Site-Painting                  (3) | Val  Loss: 0.7319 | Val  Acc: 0.8673
 Site-Painting                  (3) | Val  Loss: 0.7489 | Val  Acc: 0.8248
 Site-Painting                  (3) | Val  Loss: 0.7861 | Val  Acc: 0.8438
 Site-Sketch                    (4) | Val  Loss: 0.8633 | Val  Acc: 0.7559
 Site-Sketch                    (4) | Val  Loss: 0.9379 | Val  Acc: 0.7416
 Site-QuickDraw                 (0) | Val  Loss: 1.6666 | Val  Acc: 0.5505
 Site-Infograph                 (5) | Val  Loss: 1.5447 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8151
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8289
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8505
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8400
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8524
 Best site-Clipart                  (1)  | Epoch:9 | Val Acc: 0.8034
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9492
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9212
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9221
 Best site-Painting                 (3)  | Epoch:9 | Val Acc: 0.8673
 Best site-Painting                 (3)  | Epoch:9 | Val Acc: 0.8248
 Best site-Painting                 (3)  | Epoch:9 | Val Acc: 0.8438
 Best site-Sketch                   (4)  | Epoch:9 | Val Acc: 0.7559
 Best site-Sketch                   (4)  | Epoch:9 | Val Acc: 0.7416
 Best site-QuickDraw                (0)  | Epoch:9 | Val Acc: 0.5505
 Best site-Infograph                (5)  | Epoch:9 | Val Acc: 0.5385
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (1)| Epoch:9 | Test Acc: 0.8555
 Test site-Real                      (2)| Epoch:9 | Test Acc: 0.9145
 Test site-Painting                  (3)| Epoch:9 | Test Acc: 0.8675
 Test site-Sketch                    (4)| Epoch:9 | Test Acc: 0.8195
 Test site-QuickDraw                 (0)| Epoch:9 | Test Acc: 0.5480
 Test site-Infograph                 (5)| Epoch:9 | Test Acc: 0.4779
Clipart: 0.8555, Real: 0.9145, Painting: 0.8675, Sketch: 0.8195, QuickDraw: 0.5480, Infograph: 0.4779, 
Average Test Accuracy(group): 0.7472, Average Test Accuracy(individual): 0.8252,
domain std=0.1691, cluster std=0.1691, individual std=0.1223, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 1, 5, 4, 2, 1, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (2) | Train Loss: 0.7843 | Train Acc: 0.8435
 Site-Clipart                   (2) | Train Loss: 0.6996 | Train Acc: 0.8447
 Site-Clipart                   (2) | Train Loss: 0.8583 | Train Acc: 0.8178
 Site-Clipart                   (2) | Train Loss: 0.7749 | Train Acc: 0.8291
 Site-Clipart                   (2) | Train Loss: 0.8362 | Train Acc: 0.7805
 Site-Real                      (3) | Train Loss: 0.6421 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.5462 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.5301 | Train Acc: 0.9234
 Site-Real                      (3) | Train Loss: 0.6150 | Train Acc: 0.9310
 Site-Painting                  (0) | Train Loss: 0.7030 | Train Acc: 0.8503
 Site-Painting                  (0) | Train Loss: 0.7522 | Train Acc: 0.8447
 Site-Painting                  (0) | Train Loss: 0.7172 | Train Acc: 0.8789
 Site-Sketch                    (4) | Train Loss: 0.8085 | Train Acc: 0.7749
 Site-Sketch                    (4) | Train Loss: 0.8063 | Train Acc: 0.7678
 Site-QuickDraw                 (1) | Train Loss: 1.5411 | Train Acc: 0.5566
 Site-Infograph                 (5) | Train Loss: 1.5093 | Train Acc: 0.5427
Average Train Accuracy: 0.8141
 Site-Clipart                   (2) | Val  Loss: 0.6560 | Val  Acc: 0.8158
 Site-Clipart                   (2) | Val  Loss: 0.7666 | Val  Acc: 0.8411
 Site-Clipart                   (2) | Val  Loss: 0.7624 | Val  Acc: 0.8333
 Site-Clipart                   (2) | Val  Loss: 0.7738 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.8425 | Val  Acc: 0.8034
 Site-Real                      (3) | Val  Loss: 0.5445 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.5564 | Val  Acc: 0.9153
 Site-Real                      (3) | Val  Loss: 0.4825 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.5538 | Val  Acc: 0.9394
 Site-Painting                  (0) | Val  Loss: 0.5887 | Val  Acc: 0.8878
 Site-Painting                  (0) | Val  Loss: 0.7242 | Val  Acc: 0.8540
 Site-Painting                  (0) | Val  Loss: 0.6574 | Val  Acc: 0.8906
 Site-Sketch                    (4) | Val  Loss: 0.7547 | Val  Acc: 0.8189
 Site-Sketch                    (4) | Val  Loss: 0.8210 | Val  Acc: 0.7640
 Site-QuickDraw                 (1) | Val  Loss: 1.6260 | Val  Acc: 0.5596
 Site-Infograph                 (5) | Val  Loss: 1.4303 | Val  Acc: 0.5321
Average Valid Accuracy: 0.8207
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8158
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8411
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8333
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8034
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9167
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9153
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9394
 Best site-Real                     (3)  | Epoch:10 | Val Acc: 0.9394
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8878
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8540
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8906
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.8189
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.7640
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.5596
 Best site-Infograph                (5)  | Epoch:10 | Val Acc: 0.5321
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 11 ============
cnt=[5, 1, 3, 4, 2, 1, ]
cnt=[1, 4, 2, 1, 3, 5, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.7248 | Train Acc: 0.8000
 Site-Clipart                   (0) | Train Loss: 0.6128 | Train Acc: 0.8758
 Site-Clipart                   (0) | Train Loss: 0.7603 | Train Acc: 0.8578
 Site-Clipart                   (0) | Train Loss: 0.6790 | Train Acc: 0.8481
 Site-Clipart                   (0) | Train Loss: 0.7323 | Train Acc: 0.8416
 Site-Real                      (3) | Train Loss: 0.5975 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.5084 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.4876 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.5563 | Train Acc: 0.9282
 Site-Painting                  (2) | Train Loss: 0.6807 | Train Acc: 0.8503
 Site-Painting                  (2) | Train Loss: 0.7047 | Train Acc: 0.8447
 Site-Painting                  (2) | Train Loss: 0.6918 | Train Acc: 0.8374
 Site-Sketch                    (4) | Train Loss: 0.7499 | Train Acc: 0.8115
 Site-Sketch                    (4) | Train Loss: 0.7627 | Train Acc: 0.8052
 Site-QuickDraw                 (1) | Train Loss: 1.5934 | Train Acc: 0.5566
 Site-Infograph                 (5) | Train Loss: 1.4819 | Train Acc: 0.5342
Average Train Accuracy: 0.8243
 Site-Clipart                   (0) | Val  Loss: 0.6435 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.6613 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.6892 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.7093 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.7624 | Val  Acc: 0.8237
 Site-Real                      (3) | Val  Loss: 0.5388 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.5055 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.5090 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.5285 | Val  Acc: 0.9221
 Site-Painting                  (2) | Val  Loss: 0.6473 | Val  Acc: 0.8571
 Site-Painting                  (2) | Val  Loss: 0.6453 | Val  Acc: 0.8394
 Site-Painting                  (2) | Val  Loss: 0.6936 | Val  Acc: 0.8646
 Site-Sketch                    (4) | Val  Loss: 0.7213 | Val  Acc: 0.8031
 Site-Sketch                    (4) | Val  Loss: 0.8361 | Val  Acc: 0.7753
 Site-QuickDraw                 (1) | Val  Loss: 1.5429 | Val  Acc: 0.5872
 Site-Infograph                 (5) | Val  Loss: 1.4150 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8287
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8553
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8692
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8800
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8333
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8237
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:11 | Val Acc: 0.9221
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8571
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8394
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8646
 Best site-Sketch                   (4)  | Epoch:11 | Val Acc: 0.8031
 Best site-Sketch                   (4)  | Epoch:11 | Val Acc: 0.7753
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.5872
 Best site-Infograph                (5)  | Epoch:11 | Val Acc: 0.5577
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 12 ============
cnt=[5, 1, 3, 4, 2, 1, ]
cnt=[1, 5, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (0) | Train Loss: 0.6906 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.5966 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.7346 | Train Acc: 0.8444
 Site-Clipart                   (4) | Train Loss: 0.6551 | Train Acc: 0.8513
 Site-Clipart                   (4) | Train Loss: 0.6859 | Train Acc: 0.8529
 Site-Real                      (3) | Train Loss: 0.5756 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.4539 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.4592 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.5306 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.7859 | Train Acc: 0.8435
 Site-Painting                  (2) | Train Loss: 0.6753 | Train Acc: 0.8252
 Site-Painting                  (2) | Train Loss: 0.6251 | Train Acc: 0.8512
 Site-Sketch                    (0) | Train Loss: 0.7060 | Train Acc: 0.8168
 Site-Sketch                    (0) | Train Loss: 0.7543 | Train Acc: 0.7865
 Site-QuickDraw                 (1) | Train Loss: 1.3867 | Train Acc: 0.5841
 Site-Infograph                 (5) | Train Loss: 1.4656 | Train Acc: 0.5385
Average Train Accuracy: 0.8288
 Site-Clipart                   (0) | Val  Loss: 0.5507 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.6407 | Val  Acc: 0.8598
 Site-Clipart                   (0) | Val  Loss: 0.6666 | Val  Acc: 0.8400
 Site-Clipart                   (4) | Val  Loss: 0.6441 | Val  Acc: 0.8286
 Site-Clipart                   (4) | Val  Loss: 0.7518 | Val  Acc: 0.8373
 Site-Real                      (3) | Val  Loss: 0.4689 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.4446 | Val  Acc: 0.9661
 Site-Real                      (3) | Val  Loss: 0.4219 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.4664 | Val  Acc: 0.9264
 Site-Painting                  (2) | Val  Loss: 0.5660 | Val  Acc: 0.9082
 Site-Painting                  (2) | Val  Loss: 0.5968 | Val  Acc: 0.8686
 Site-Painting                  (2) | Val  Loss: 0.6348 | Val  Acc: 0.8698
 Site-Sketch                    (0) | Val  Loss: 0.6726 | Val  Acc: 0.8504
 Site-Sketch                    (0) | Val  Loss: 0.7758 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.5007 | Val  Acc: 0.5826
 Site-Infograph                 (5) | Val  Loss: 1.4133 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8425
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8684
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8598
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8400
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8286
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8373
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9661
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9455
 Best site-Real                     (3)  | Epoch:12 | Val Acc: 0.9264
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.9082
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.8686
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.8698
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8504
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.7865
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.5826
 Best site-Infograph                (5)  | Epoch:12 | Val Acc: 0.5897
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 1, 4, 4, 1, 3, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (2) | Train Loss: 0.6654 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.6048 | Train Acc: 0.8696
 Site-Clipart                   (5) | Train Loss: 0.6820 | Train Acc: 0.8667
 Site-Clipart                   (2) | Train Loss: 0.6280 | Train Acc: 0.8608
 Site-Clipart                   (2) | Train Loss: 0.6831 | Train Acc: 0.8484
 Site-Real                      (3) | Train Loss: 0.5192 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.4163 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.4127 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.4850 | Train Acc: 0.9339
 Site-Painting                  (0) | Train Loss: 0.6650 | Train Acc: 0.8571
 Site-Painting                  (0) | Train Loss: 0.6425 | Train Acc: 0.8544
 Site-Painting                  (0) | Train Loss: 0.6057 | Train Acc: 0.8616
 Site-Sketch                    (5) | Train Loss: 0.6996 | Train Acc: 0.8010
 Site-Sketch                    (5) | Train Loss: 0.6932 | Train Acc: 0.8052
 Site-QuickDraw                 (1) | Train Loss: 1.3934 | Train Acc: 0.6024
 Site-Infograph                 (4) | Train Loss: 1.3970 | Train Acc: 0.5556
Average Train Accuracy: 0.8359
 Site-Clipart                   (2) | Val  Loss: 0.5204 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.6264 | Val  Acc: 0.8692
 Site-Clipart                   (5) | Val  Loss: 0.6696 | Val  Acc: 0.8533
 Site-Clipart                   (2) | Val  Loss: 0.6140 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.6792 | Val  Acc: 0.8373
 Site-Real                      (3) | Val  Loss: 0.4261 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.4134 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.4286 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.4625 | Val  Acc: 0.9307
 Site-Painting                  (0) | Val  Loss: 0.5187 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.5351 | Val  Acc: 0.8832
 Site-Painting                  (0) | Val  Loss: 0.5827 | Val  Acc: 0.8646
 Site-Sketch                    (5) | Val  Loss: 0.6606 | Val  Acc: 0.8268
 Site-Sketch                    (5) | Val  Loss: 0.7448 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 1.4243 | Val  Acc: 0.6147
 Site-Infograph                 (4) | Val  Loss: 1.3138 | Val  Acc: 0.5962
Average Valid Accuracy: 0.8407
============ Train epoch 14 ============
cnt=[4, 1, 3, 4, 1, 3, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (0) | Train Loss: 0.6012 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.5205 | Train Acc: 0.8758
 Site-Clipart                   (5) | Train Loss: 0.6516 | Train Acc: 0.8578
 Site-Clipart                   (5) | Train Loss: 0.5872 | Train Acc: 0.8608
 Site-Clipart                   (5) | Train Loss: 0.6216 | Train Acc: 0.8620
 Site-Real                      (3) | Train Loss: 0.4792 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.3934 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3916 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.4515 | Train Acc: 0.9253
 Site-Painting                  (2) | Train Loss: 0.5914 | Train Acc: 0.8231
 Site-Painting                  (2) | Train Loss: 0.6512 | Train Acc: 0.8447
 Site-Painting                  (2) | Train Loss: 0.5720 | Train Acc: 0.8651
 Site-Sketch                    (0) | Train Loss: 0.6152 | Train Acc: 0.8115
 Site-Sketch                    (0) | Train Loss: 0.7678 | Train Acc: 0.8015
 Site-QuickDraw                 (1) | Train Loss: 1.2895 | Train Acc: 0.6361
 Site-Infograph                 (4) | Train Loss: 1.3781 | Train Acc: 0.5385
Average Train Accuracy: 0.8335
 Site-Clipart                   (0) | Val  Loss: 0.4923 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.5702 | Val  Acc: 0.8598
 Site-Clipart                   (5) | Val  Loss: 0.5699 | Val  Acc: 0.8733
 Site-Clipart                   (5) | Val  Loss: 0.5770 | Val  Acc: 0.8857
 Site-Clipart                   (5) | Val  Loss: 0.6602 | Val  Acc: 0.8508
 Site-Real                      (3) | Val  Loss: 0.4297 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3965 | Val  Acc: 0.9153
 Site-Real                      (3) | Val  Loss: 0.4144 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.4108 | Val  Acc: 0.9351
 Site-Painting                  (2) | Val  Loss: 0.4817 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.5637 | Val  Acc: 0.8759
 Site-Painting                  (2) | Val  Loss: 0.5734 | Val  Acc: 0.8750
 Site-Sketch                    (0) | Val  Loss: 0.6499 | Val  Acc: 0.8110
 Site-Sketch                    (0) | Val  Loss: 0.7417 | Val  Acc: 0.7640
 Site-QuickDraw                 (1) | Val  Loss: 1.2992 | Val  Acc: 0.6376
 Site-Infograph                 (4) | Val  Loss: 1.2871 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8465
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8684
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8598
 Best site-Clipart                  (5)  | Epoch:14 | Val Acc: 0.8733
 Best site-Clipart                  (5)  | Epoch:14 | Val Acc: 0.8857
 Best site-Clipart                  (5)  | Epoch:14 | Val Acc: 0.8508
 Best site-Real                     (3)  | Epoch:14 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:14 | Val Acc: 0.9153
 Best site-Real                     (3)  | Epoch:14 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:14 | Val Acc: 0.9351
 Best site-Painting                 (2)  | Epoch:14 | Val Acc: 0.9286
 Best site-Painting                 (2)  | Epoch:14 | Val Acc: 0.8759
 Best site-Painting                 (2)  | Epoch:14 | Val Acc: 0.8750
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.8110
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.7640
 Best site-QuickDraw                (1)  | Epoch:14 | Val Acc: 0.6376
 Best site-Infograph                (4)  | Epoch:14 | Val Acc: 0.5897
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 1, 4, 4, 3, 3, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (2) | Train Loss: 0.6379 | Train Acc: 0.8261
 Site-Clipart                   (5) | Train Loss: 0.4980 | Train Acc: 0.9068
 Site-Clipart                   (5) | Train Loss: 0.6353 | Train Acc: 0.8622
 Site-Clipart                   (2) | Train Loss: 0.5559 | Train Acc: 0.8703
 Site-Clipart                   (2) | Train Loss: 0.5935 | Train Acc: 0.8733
 Site-Real                      (3) | Train Loss: 0.4914 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.3717 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.3800 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.4099 | Train Acc: 0.9397
 Site-Painting                  (4) | Train Loss: 0.5883 | Train Acc: 0.8299
 Site-Painting                  (4) | Train Loss: 0.5324 | Train Acc: 0.8447
 Site-Painting                  (4) | Train Loss: 0.5415 | Train Acc: 0.8754
 Site-Sketch                    (2) | Train Loss: 0.6649 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.6863 | Train Acc: 0.8240
 Site-QuickDraw                 (0) | Train Loss: 1.1690 | Train Acc: 0.6667
 Site-Infograph                 (1) | Train Loss: 1.3189 | Train Acc: 0.5513
Average Train Accuracy: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.4603 | Val  Acc: 0.8947
 Site-Clipart                   (5) | Val  Loss: 0.5374 | Val  Acc: 0.8785
 Site-Clipart                   (5) | Val  Loss: 0.5509 | Val  Acc: 0.8733
 Site-Clipart                   (2) | Val  Loss: 0.5540 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.6439 | Val  Acc: 0.8237
 Site-Real                      (3) | Val  Loss: 0.3973 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3868 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.3794 | Val  Acc: 0.9152
 Site-Real                      (3) | Val  Loss: 0.3794 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.4703 | Val  Acc: 0.8878
 Site-Painting                  (4) | Val  Loss: 0.5055 | Val  Acc: 0.8759
 Site-Painting                  (4) | Val  Loss: 0.5385 | Val  Acc: 0.8646
 Site-Sketch                    (2) | Val  Loss: 0.6073 | Val  Acc: 0.8268
 Site-Sketch                    (5) | Val  Loss: 0.6554 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 1.3184 | Val  Acc: 0.6881
 Site-Infograph                 (1) | Val  Loss: 1.2175 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8555
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8947
 Best site-Clipart                  (5)  | Epoch:15 | Val Acc: 0.8785
 Best site-Clipart                  (5)  | Epoch:15 | Val Acc: 0.8733
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8524
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8237
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9152
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8878
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8759
 Best site-Painting                 (4)  | Epoch:15 | Val Acc: 0.8646
 Best site-Sketch                   (2)  | Epoch:15 | Val Acc: 0.8268
 Best site-Sketch                   (5)  | Epoch:15 | Val Acc: 0.8202
 Best site-QuickDraw                (0)  | Epoch:15 | Val Acc: 0.6881
 Best site-Infograph                (1)  | Epoch:15 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 1, 1, 4, 5, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (2) | Train Loss: 0.6393 | Train Acc: 0.8261
 Site-Clipart                   (3) | Train Loss: 0.4561 | Train Acc: 0.9193
 Site-Clipart                   (3) | Train Loss: 0.6128 | Train Acc: 0.8578
 Site-Clipart                   (3) | Train Loss: 0.5179 | Train Acc: 0.8892
 Site-Clipart                   (3) | Train Loss: 0.5500 | Train Acc: 0.8778
 Site-Real                      (4) | Train Loss: 0.4487 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.3621 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.3441 | Train Acc: 0.9315
 Site-Real                      (4) | Train Loss: 0.3964 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.6044 | Train Acc: 0.8639
 Site-Painting                  (0) | Train Loss: 0.6087 | Train Acc: 0.8398
 Site-Painting                  (0) | Train Loss: 0.5639 | Train Acc: 0.8547
 Site-Sketch                    (5) | Train Loss: 0.6081 | Train Acc: 0.8220
 Site-Sketch                    (5) | Train Loss: 0.6749 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 1.1748 | Train Acc: 0.6942
 Site-Infograph                 (4) | Train Loss: 1.3697 | Train Acc: 0.5684
Average Train Accuracy: 0.8477
 Site-Clipart                   (2) | Val  Loss: 0.4548 | Val  Acc: 0.8684
 Site-Clipart                   (3) | Val  Loss: 0.4875 | Val  Acc: 0.8785
 Site-Clipart                   (3) | Val  Loss: 0.5451 | Val  Acc: 0.8533
 Site-Clipart                   (3) | Val  Loss: 0.5275 | Val  Acc: 0.8667
 Site-Clipart                   (3) | Val  Loss: 0.6160 | Val  Acc: 0.8475
 Site-Real                      (4) | Val  Loss: 0.3527 | Val  Acc: 0.9167
 Site-Real                      (4) | Val  Loss: 0.3247 | Val  Acc: 0.9661
 Site-Real                      (4) | Val  Loss: 0.3630 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.3650 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.4223 | Val  Acc: 0.8673
 Site-Painting                  (0) | Val  Loss: 0.5074 | Val  Acc: 0.8686
 Site-Painting                  (0) | Val  Loss: 0.5482 | Val  Acc: 0.8490
 Site-Sketch                    (5) | Val  Loss: 0.5666 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6812 | Val  Acc: 0.7809
 Site-QuickDraw                 (1) | Val  Loss: 1.2248 | Val  Acc: 0.7018
 Site-Infograph                 (4) | Val  Loss: 1.2440 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8507
============ Train epoch 17 ============
cnt=[3, 1, 5, 4, 2, 1, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (2) | Train Loss: 0.5267 | Train Acc: 0.8435
 Site-Clipart                   (2) | Train Loss: 0.4581 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.6025 | Train Acc: 0.8311
 Site-Clipart                   (2) | Train Loss: 0.5060 | Train Acc: 0.8829
 Site-Clipart                   (2) | Train Loss: 0.5606 | Train Acc: 0.8643
 Site-Real                      (3) | Train Loss: 0.4311 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.3360 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3278 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3675 | Train Acc: 0.9454
 Site-Painting                  (0) | Train Loss: 0.5520 | Train Acc: 0.8503
 Site-Painting                  (0) | Train Loss: 0.4880 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.4894 | Train Acc: 0.8824
 Site-Sketch                    (4) | Train Loss: 0.5912 | Train Acc: 0.8115
 Site-Sketch                    (4) | Train Loss: 0.5775 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 1.1404 | Train Acc: 0.6728
 Site-Infograph                 (5) | Train Loss: 1.2876 | Train Acc: 0.5855
Average Train Accuracy: 0.8475
 Site-Clipart                   (2) | Val  Loss: 0.4221 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.4843 | Val  Acc: 0.8785
 Site-Clipart                   (2) | Val  Loss: 0.5166 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.5338 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.6331 | Val  Acc: 0.8271
 Site-Real                      (3) | Val  Loss: 0.3463 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3436 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.3146 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.3410 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.4085 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.4811 | Val  Acc: 0.8540
 Site-Painting                  (0) | Val  Loss: 0.4944 | Val  Acc: 0.8802
 Site-Sketch                    (4) | Val  Loss: 0.5724 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.6567 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 1.2504 | Val  Acc: 0.6651
 Site-Infograph                 (5) | Val  Loss: 1.2551 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8536
============ Train epoch 18 ============
cnt=[3, 1, 5, 4, 1, 2, ]
cnt=[1, 4, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (2) | Train Loss: 0.5293 | Train Acc: 0.8435
 Site-Clipart                   (2) | Train Loss: 0.4467 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.6238 | Train Acc: 0.8356
 Site-Clipart                   (2) | Train Loss: 0.4927 | Train Acc: 0.8766
 Site-Clipart                   (2) | Train Loss: 0.5493 | Train Acc: 0.8756
 Site-Real                      (3) | Train Loss: 0.4453 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.3220 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.3091 | Train Acc: 0.9556
 Site-Real                      (3) | Train Loss: 0.3574 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4895 | Train Acc: 0.8912
 Site-Painting                  (0) | Train Loss: 0.4875 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.4724 | Train Acc: 0.8720
 Site-Sketch                    (5) | Train Loss: 0.6340 | Train Acc: 0.8010
 Site-Sketch                    (5) | Train Loss: 0.5214 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 1.1052 | Train Acc: 0.6820
 Site-Infograph                 (4) | Train Loss: 1.2545 | Train Acc: 0.6026
Average Train Accuracy: 0.8535
 Site-Clipart                   (2) | Val  Loss: 0.4176 | Val  Acc: 0.8684
 Site-Clipart                   (2) | Val  Loss: 0.4914 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.5568 | Val  Acc: 0.8467
 Site-Clipart                   (2) | Val  Loss: 0.5218 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.5738 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.3382 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3181 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.3307 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3434 | Val  Acc: 0.9394
 Site-Painting                  (0) | Val  Loss: 0.4119 | Val  Acc: 0.8878
 Site-Painting                  (0) | Val  Loss: 0.4720 | Val  Acc: 0.8832
 Site-Painting                  (0) | Val  Loss: 0.4833 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4885 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.6319 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 1.1860 | Val  Acc: 0.7018
 Site-Infograph                 (4) | Val  Loss: 1.2083 | Val  Acc: 0.6026
Average Valid Accuracy: 0.8585
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8684
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8467
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8524
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8644
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9394
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8878
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8832
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8854
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:18 | Val Acc: 0.7018
 Best site-Infograph                (4)  | Epoch:18 | Val Acc: 0.6026
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 19 ============
cnt=[1, 1, 5, 3, 4, 2, ]
cnt=[2, 3, 1, 4, 5, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (2) | Train Loss: 0.5382 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.4202 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.5664 | Train Acc: 0.8800
 Site-Clipart                   (2) | Train Loss: 0.4905 | Train Acc: 0.8703
 Site-Clipart                   (2) | Train Loss: 0.5130 | Train Acc: 0.8846
 Site-Real                      (4) | Train Loss: 0.4370 | Train Acc: 0.8810
 Site-Real                      (4) | Train Loss: 0.2949 | Train Acc: 0.9605
 Site-Real                      (4) | Train Loss: 0.3187 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.3385 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.6172 | Train Acc: 0.8571
 Site-Painting                  (3) | Train Loss: 0.5454 | Train Acc: 0.8592
 Site-Painting                  (3) | Train Loss: 0.4717 | Train Acc: 0.8754
 Site-Sketch                    (5) | Train Loss: 0.5506 | Train Acc: 0.8482
 Site-Sketch                    (5) | Train Loss: 0.5800 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 1.1097 | Train Acc: 0.6850
 Site-Infograph                 (0) | Train Loss: 1.2359 | Train Acc: 0.5983
Average Train Accuracy: 0.8552
 Site-Clipart                   (2) | Val  Loss: 0.4238 | Val  Acc: 0.8684
 Site-Clipart                   (2) | Val  Loss: 0.4645 | Val  Acc: 0.8692
 Site-Clipart                   (2) | Val  Loss: 0.4916 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.4952 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.5720 | Val  Acc: 0.8475
 Site-Real                      (4) | Val  Loss: 0.3083 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.3566 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.3240 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.3210 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.4204 | Val  Acc: 0.8980
 Site-Painting                  (3) | Val  Loss: 0.4574 | Val  Acc: 0.8905
 Site-Painting                  (3) | Val  Loss: 0.4851 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.5792 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.6627 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.1757 | Val  Acc: 0.6743
 Site-Infograph                 (0) | Val  Loss: 1.1823 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8607
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8684
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8692
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8867
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8857
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8475
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9237
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:19 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.8980
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.8905
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.9010
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:19 | Val Acc: 0.6743
 Best site-Infograph                (0)  | Epoch:19 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:19 | Test Acc: 0.8764
 Test site-Real                      (4)| Epoch:19 | Test Acc: 0.9441
 Test site-Painting                  (3)| Epoch:19 | Test Acc: 0.9144
 Test site-Sketch                    (5)| Epoch:19 | Test Acc: 0.8610
 Test site-QuickDraw                 (1)| Epoch:19 | Test Acc: 0.6830
 Test site-Infograph                 (0)| Epoch:19 | Test Acc: 0.5601
Clipart: 0.8764, Real: 0.9441, Painting: 0.9144, Sketch: 0.8610, QuickDraw: 0.6830, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8065, Average Test Accuracy(individual): 0.8667,
domain std=0.1381, cluster std=0.1381, individual std=0.0997, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 1, 4, 3, 3, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (2) | Train Loss: 0.5157 | Train Acc: 0.8957
 Site-Clipart                   (4) | Train Loss: 0.4650 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.5433 | Train Acc: 0.8267
 Site-Clipart                   (2) | Train Loss: 0.5008 | Train Acc: 0.8608
 Site-Clipart                   (4) | Train Loss: 0.5242 | Train Acc: 0.8801
 Site-Real                      (0) | Train Loss: 0.4086 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2902 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.3140 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.3494 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.5469 | Train Acc: 0.8639
 Site-Painting                  (3) | Train Loss: 0.4766 | Train Acc: 0.8738
 Site-Painting                  (3) | Train Loss: 0.4748 | Train Acc: 0.8754
 Site-Sketch                    (2) | Train Loss: 0.5643 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.6707 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 1.1316 | Train Acc: 0.6850
 Site-Infograph                 (5) | Train Loss: 1.2059 | Train Acc: 0.6239
Average Train Accuracy: 0.8565
 Site-Clipart                   (2) | Val  Loss: 0.3826 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.4866 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.5060 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.4727 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.5651 | Val  Acc: 0.8678
 Site-Real                      (0) | Val  Loss: 0.3076 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2980 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.3059 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.3331 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.3688 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.4290 | Val  Acc: 0.8905
 Site-Painting                  (3) | Val  Loss: 0.4709 | Val  Acc: 0.8802
 Site-Sketch                    (2) | Val  Loss: 0.5160 | Val  Acc: 0.8661
 Site-Sketch                    (2) | Val  Loss: 0.5840 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 1.1062 | Val  Acc: 0.7064
 Site-Infograph                 (5) | Val  Loss: 1.1361 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8691
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8816
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.8879
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.8800
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.8678
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9492
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9394
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.9184
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.8905
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.8802
 Best site-Sketch                   (2)  | Epoch:20 | Val Acc: 0.8661
 Best site-Sketch                   (2)  | Epoch:20 | Val Acc: 0.8371
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.7064
 Best site-Infograph                (5)  | Epoch:20 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 21 ============
cnt=[5, 1, 1, 3, 4, 2, ]
cnt=[2, 5, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.5246 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.4586 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.5795 | Train Acc: 0.8711
 Site-Clipart                   (0) | Train Loss: 0.4477 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.5009 | Train Acc: 0.8756
 Site-Real                      (4) | Train Loss: 0.4014 | Train Acc: 0.8810
 Site-Real                      (4) | Train Loss: 0.2951 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.3147 | Train Acc: 0.9315
 Site-Real                      (4) | Train Loss: 0.3441 | Train Acc: 0.9483
 Site-Painting                  (3) | Train Loss: 0.5623 | Train Acc: 0.8503
 Site-Painting                  (3) | Train Loss: 0.5212 | Train Acc: 0.8786
 Site-Painting                  (3) | Train Loss: 0.4664 | Train Acc: 0.8789
 Site-Sketch                    (5) | Train Loss: 0.5711 | Train Acc: 0.7958
 Site-Sketch                    (5) | Train Loss: 0.5928 | Train Acc: 0.8240
 Site-QuickDraw                 (1) | Train Loss: 1.0446 | Train Acc: 0.7003
 Site-Infograph                 (2) | Train Loss: 1.2444 | Train Acc: 0.5897
Average Train Accuracy: 0.8534
 Site-Clipart                   (0) | Val  Loss: 0.4014 | Val  Acc: 0.8421
 Site-Clipart                   (0) | Val  Loss: 0.4283 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.4684 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.4787 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.5420 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.3007 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2823 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.3013 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.3246 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.3646 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.4472 | Val  Acc: 0.8540
 Site-Painting                  (3) | Val  Loss: 0.4513 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.5333 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6198 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 1.1313 | Val  Acc: 0.6927
 Site-Infograph                 (2) | Val  Loss: 1.1461 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8618
============ Train epoch 22 ============
cnt=[5, 1, 3, 4, 2, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.5102 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.4027 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.5617 | Train Acc: 0.8444
 Site-Clipart                   (0) | Train Loss: 0.4604 | Train Acc: 0.8797
 Site-Clipart                   (0) | Train Loss: 0.4950 | Train Acc: 0.8869
 Site-Real                      (3) | Train Loss: 0.3947 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2816 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.3066 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.3373 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.4861 | Train Acc: 0.8776
 Site-Painting                  (2) | Train Loss: 0.4854 | Train Acc: 0.8592
 Site-Painting                  (2) | Train Loss: 0.4325 | Train Acc: 0.9066
 Site-Sketch                    (4) | Train Loss: 0.5174 | Train Acc: 0.8482
 Site-Sketch                    (4) | Train Loss: 0.5211 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 1.0520 | Train Acc: 0.6881
 Site-Infograph                 (5) | Train Loss: 1.1815 | Train Acc: 0.6068
Average Train Accuracy: 0.8593
 Site-Clipart                   (0) | Val  Loss: 0.3532 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.4296 | Val  Acc: 0.8879
 Site-Clipart                   (0) | Val  Loss: 0.4218 | Val  Acc: 0.9200
 Site-Clipart                   (0) | Val  Loss: 0.4520 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.5507 | Val  Acc: 0.8576
 Site-Real                      (3) | Val  Loss: 0.3013 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2895 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.2967 | Val  Acc: 0.9030
 Site-Real                      (3) | Val  Loss: 0.3006 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3488 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.3845 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.4600 | Val  Acc: 0.8854
 Site-Sketch                    (4) | Val  Loss: 0.5121 | Val  Acc: 0.8661
 Site-Sketch                    (4) | Val  Loss: 0.5778 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 1.0728 | Val  Acc: 0.7064
 Site-Infograph                 (5) | Val  Loss: 1.0991 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8719
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8879
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.9200
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8762
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8576
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9492
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9030
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9184
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9197
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.8854
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8661
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:22 | Val Acc: 0.7064
 Best site-Infograph                (5)  | Epoch:22 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 23 ============
cnt=[4, 1, 3, 4, 1, 3, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.4809 | Train Acc: 0.8522
 Site-Clipart                   (3) | Train Loss: 0.3900 | Train Acc: 0.9130
 Site-Clipart                   (3) | Train Loss: 0.5248 | Train Acc: 0.8533
 Site-Clipart                   (3) | Train Loss: 0.4574 | Train Acc: 0.8797
 Site-Clipart                   (3) | Train Loss: 0.5063 | Train Acc: 0.8665
 Site-Real                      (0) | Train Loss: 0.3932 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.2820 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2902 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.3057 | Train Acc: 0.9483
 Site-Painting                  (5) | Train Loss: 0.5146 | Train Acc: 0.8435
 Site-Painting                  (5) | Train Loss: 0.4405 | Train Acc: 0.8592
 Site-Painting                  (5) | Train Loss: 0.4182 | Train Acc: 0.8927
 Site-Sketch                    (2) | Train Loss: 0.5786 | Train Acc: 0.8115
 Site-Sketch                    (2) | Train Loss: 0.6088 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.9788 | Train Acc: 0.7064
 Site-Infograph                 (4) | Train Loss: 1.1939 | Train Acc: 0.6111
Average Train Accuracy: 0.8550
 Site-Clipart                   (2) | Val  Loss: 0.3303 | Val  Acc: 0.8816
 Site-Clipart                   (3) | Val  Loss: 0.4148 | Val  Acc: 0.8972
 Site-Clipart                   (3) | Val  Loss: 0.4296 | Val  Acc: 0.8933
 Site-Clipart                   (3) | Val  Loss: 0.4327 | Val  Acc: 0.8810
 Site-Clipart                   (3) | Val  Loss: 0.5407 | Val  Acc: 0.8542
 Site-Real                      (0) | Val  Loss: 0.2585 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2780 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2609 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2882 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.3758 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.4079 | Val  Acc: 0.8905
 Site-Painting                  (5) | Val  Loss: 0.4548 | Val  Acc: 0.8750
 Site-Sketch                    (2) | Val  Loss: 0.5114 | Val  Acc: 0.8661
 Site-Sketch                    (2) | Val  Loss: 0.5336 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 1.0427 | Val  Acc: 0.7385
 Site-Infograph                 (4) | Val  Loss: 1.1403 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8731
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8816
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.8972
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.8933
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.8810
 Best site-Clipart                  (3)  | Epoch:23 | Val Acc: 0.8542
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9394
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9567
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.9286
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.8905
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.8750
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8661
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:23 | Val Acc: 0.7385
 Best site-Infograph                (4)  | Epoch:23 | Val Acc: 0.6474
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 4, 2, 3, 5, 1, ]
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (4) | Train Loss: 0.5385 | Train Acc: 0.8522
 Site-Clipart                   (4) | Train Loss: 0.3705 | Train Acc: 0.8944
 Site-Clipart                   (4) | Train Loss: 0.5601 | Train Acc: 0.8533
 Site-Clipart                   (4) | Train Loss: 0.4538 | Train Acc: 0.8766
 Site-Clipart                   (4) | Train Loss: 0.4787 | Train Acc: 0.8778
 Site-Real                      (1) | Train Loss: 0.3963 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.2823 | Train Acc: 0.9548
 Site-Real                      (1) | Train Loss: 0.2694 | Train Acc: 0.9476
 Site-Real                      (1) | Train Loss: 0.3061 | Train Acc: 0.9425
 Site-Painting                  (3) | Train Loss: 0.5096 | Train Acc: 0.8571
 Site-Painting                  (3) | Train Loss: 0.4245 | Train Acc: 0.8883
 Site-Painting                  (3) | Train Loss: 0.4185 | Train Acc: 0.8997
 Site-Sketch                    (2) | Train Loss: 0.5326 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.4808 | Train Acc: 0.8539
 Site-QuickDraw                 (0) | Train Loss: 0.9279 | Train Acc: 0.7339
 Site-Infograph                 (5) | Train Loss: 1.1365 | Train Acc: 0.6239
Average Train Accuracy: 0.8616
 Site-Clipart                   (4) | Val  Loss: 0.3467 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.4327 | Val  Acc: 0.8598
 Site-Clipart                   (4) | Val  Loss: 0.4846 | Val  Acc: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.4672 | Val  Acc: 0.8524
 Site-Clipart                   (4) | Val  Loss: 0.5375 | Val  Acc: 0.8610
 Site-Real                      (1) | Val  Loss: 0.2912 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2662 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2914 | Val  Acc: 0.9394
 Site-Real                      (1) | Val  Loss: 0.3003 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.3289 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.3692 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.4179 | Val  Acc: 0.8906
 Site-Sketch                    (2) | Val  Loss: 0.5014 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.5374 | Val  Acc: 0.8090
 Site-QuickDraw                 (0) | Val  Loss: 1.0031 | Val  Acc: 0.7615
 Site-Infograph                 (5) | Val  Loss: 1.0364 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8742
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.9211
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8598
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8733
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8524
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8610
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9407
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9394
 Best site-Real                     (1)  | Epoch:24 | Val Acc: 0.9567
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.9286
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.9270
 Best site-Painting                 (3)  | Epoch:24 | Val Acc: 0.8906
 Best site-Sketch                   (2)  | Epoch:24 | Val Acc: 0.8583
 Best site-Sketch                   (2)  | Epoch:24 | Val Acc: 0.8090
 Best site-QuickDraw                (0)  | Epoch:24 | Val Acc: 0.7615
 Best site-Infograph                (5)  | Epoch:24 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 1, 3, 5, 4, 1, ]
cnt=[5, 3, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (3) | Train Loss: 0.4347 | Train Acc: 0.8870
 Site-Clipart                   (3) | Train Loss: 0.3292 | Train Acc: 0.9255
 Site-Clipart                   (3) | Train Loss: 0.5250 | Train Acc: 0.8756
 Site-Clipart                   (3) | Train Loss: 0.4436 | Train Acc: 0.8829
 Site-Clipart                   (3) | Train Loss: 0.4630 | Train Acc: 0.8846
 Site-Real                      (4) | Train Loss: 0.4032 | Train Acc: 0.8968
 Site-Real                      (4) | Train Loss: 0.2452 | Train Acc: 0.9605
 Site-Real                      (4) | Train Loss: 0.2891 | Train Acc: 0.9234
 Site-Real                      (4) | Train Loss: 0.3139 | Train Acc: 0.9483
 Site-Painting                  (2) | Train Loss: 0.4757 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.5278 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.4252 | Train Acc: 0.9100
 Site-Sketch                    (0) | Train Loss: 0.4935 | Train Acc: 0.8743
 Site-Sketch                    (0) | Train Loss: 0.5696 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.9194 | Train Acc: 0.7278
 Site-Infograph                 (5) | Train Loss: 1.1183 | Train Acc: 0.6154
Average Train Accuracy: 0.8699
 Site-Clipart                   (3) | Val  Loss: 0.3624 | Val  Acc: 0.8947
 Site-Clipart                   (3) | Val  Loss: 0.4141 | Val  Acc: 0.8972
 Site-Clipart                   (3) | Val  Loss: 0.4226 | Val  Acc: 0.9067
 Site-Clipart                   (3) | Val  Loss: 0.4289 | Val  Acc: 0.8905
 Site-Clipart                   (3) | Val  Loss: 0.5353 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.2818 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2663 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.2675 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2961 | Val  Acc: 0.9394
 Site-Painting                  (2) | Val  Loss: 0.3411 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.3880 | Val  Acc: 0.9051
 Site-Painting                  (2) | Val  Loss: 0.4166 | Val  Acc: 0.8854
 Site-Sketch                    (0) | Val  Loss: 0.4731 | Val  Acc: 0.8661
 Site-Sketch                    (0) | Val  Loss: 0.5548 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 1.0261 | Val  Acc: 0.7294
 Site-Infograph                 (5) | Val  Loss: 1.0948 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8748
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.8947
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.8972
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.9067
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.8905
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.8542
 Best site-Real                     (4)  | Epoch:25 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:25 | Val Acc: 0.9322
 Best site-Real                     (4)  | Epoch:25 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:25 | Val Acc: 0.9394
 Best site-Painting                 (2)  | Epoch:25 | Val Acc: 0.9184
 Best site-Painting                 (2)  | Epoch:25 | Val Acc: 0.9051
 Best site-Painting                 (2)  | Epoch:25 | Val Acc: 0.8854
 Best site-Sketch                   (0)  | Epoch:25 | Val Acc: 0.8661
 Best site-Sketch                   (0)  | Epoch:25 | Val Acc: 0.8258
 Best site-QuickDraw                (1)  | Epoch:25 | Val Acc: 0.7294
 Best site-Infograph                (5)  | Epoch:25 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 26 ============
cnt=[3, 1, 4, 4, 3, 1, ]
cnt=[3, 5, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (4) | Train Loss: 0.5044 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.3762 | Train Acc: 0.8944
 Site-Clipart                   (2) | Train Loss: 0.4589 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.4201 | Train Acc: 0.8861
 Site-Clipart                   (2) | Train Loss: 0.4673 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.3630 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2553 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2722 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.3064 | Train Acc: 0.9569
 Site-Painting                  (0) | Train Loss: 0.4807 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.4239 | Train Acc: 0.8738
 Site-Painting                  (0) | Train Loss: 0.4320 | Train Acc: 0.9066
 Site-Sketch                    (4) | Train Loss: 0.5050 | Train Acc: 0.8377
 Site-Sketch                    (4) | Train Loss: 0.4680 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.8708 | Train Acc: 0.7278
 Site-Infograph                 (5) | Train Loss: 1.1086 | Train Acc: 0.6154
Average Train Accuracy: 0.8631
 Site-Clipart                   (4) | Val  Loss: 0.3334 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.4022 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.4218 | Val  Acc: 0.8600
 Site-Clipart                   (2) | Val  Loss: 0.4012 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.5011 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2837 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2607 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2661 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.2763 | Val  Acc: 0.9394
 Site-Painting                  (0) | Val  Loss: 0.3330 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.3673 | Val  Acc: 0.9051
 Site-Painting                  (0) | Val  Loss: 0.4274 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.4585 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.5720 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 0.9870 | Val  Acc: 0.7110
 Site-Infograph                 (5) | Val  Loss: 1.1055 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8707
============ Train epoch 27 ============
cnt=[4, 1, 2, 3, 5, 1, ]
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (4) | Train Loss: 0.4590 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.3707 | Train Acc: 0.9255
 Site-Clipart                   (4) | Train Loss: 0.4834 | Train Acc: 0.8933
 Site-Clipart                   (4) | Train Loss: 0.4163 | Train Acc: 0.8766
 Site-Clipart                   (4) | Train Loss: 0.4543 | Train Acc: 0.8801
 Site-Real                      (0) | Train Loss: 0.3492 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2537 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2579 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.2974 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.5028 | Train Acc: 0.8707
 Site-Painting                  (3) | Train Loss: 0.4470 | Train Acc: 0.8738
 Site-Painting                  (3) | Train Loss: 0.3623 | Train Acc: 0.9273
 Site-Sketch                    (2) | Train Loss: 0.5095 | Train Acc: 0.8534
 Site-Sketch                    (2) | Train Loss: 0.5332 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.8893 | Train Acc: 0.7156
 Site-Infograph                 (5) | Train Loss: 1.1144 | Train Acc: 0.6239
Average Train Accuracy: 0.8677
 Site-Clipart                   (4) | Val  Loss: 0.3102 | Val  Acc: 0.8947
 Site-Clipart                   (4) | Val  Loss: 0.3883 | Val  Acc: 0.9252
 Site-Clipart                   (4) | Val  Loss: 0.4226 | Val  Acc: 0.8800
 Site-Clipart                   (4) | Val  Loss: 0.4554 | Val  Acc: 0.8857
 Site-Clipart                   (4) | Val  Loss: 0.5223 | Val  Acc: 0.8644
 Site-Real                      (0) | Val  Loss: 0.2526 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2864 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2839 | Val  Acc: 0.9273
 Site-Real                      (0) | Val  Loss: 0.2797 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.3135 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.3386 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.3921 | Val  Acc: 0.9062
 Site-Sketch                    (2) | Val  Loss: 0.5348 | Val  Acc: 0.8346
 Site-Sketch                    (2) | Val  Loss: 0.5986 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 0.9806 | Val  Acc: 0.7110
 Site-Infograph                 (5) | Val  Loss: 1.0978 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8720
============ Train epoch 28 ============
cnt=[5, 1, 3, 2, 4, 1, ]
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (0) | Train Loss: 0.4126 | Train Acc: 0.8957
 Site-Clipart                   (0) | Train Loss: 0.3628 | Train Acc: 0.9317
 Site-Clipart                   (0) | Train Loss: 0.4689 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.4265 | Train Acc: 0.8924
 Site-Clipart                   (0) | Train Loss: 0.4225 | Train Acc: 0.9118
 Site-Real                      (4) | Train Loss: 0.3813 | Train Acc: 0.8889
 Site-Real                      (4) | Train Loss: 0.2465 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2722 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2765 | Train Acc: 0.9569
 Site-Painting                  (2) | Train Loss: 0.4996 | Train Acc: 0.8571
 Site-Painting                  (2) | Train Loss: 0.4674 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.3976 | Train Acc: 0.9273
 Site-Sketch                    (3) | Train Loss: 0.4815 | Train Acc: 0.8743
 Site-Sketch                    (3) | Train Loss: 0.5035 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.8374 | Train Acc: 0.7370
 Site-Infograph                 (5) | Train Loss: 1.0760 | Train Acc: 0.6197
Average Train Accuracy: 0.8749
 Site-Clipart                   (0) | Val  Loss: 0.2647 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.3925 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.4393 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4344 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.5024 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2726 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2377 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2609 | Val  Acc: 0.9152
 Site-Real                      (4) | Val  Loss: 0.2643 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.3165 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.3586 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.4371 | Val  Acc: 0.8802
 Site-Sketch                    (3) | Val  Loss: 0.4448 | Val  Acc: 0.8898
 Site-Sketch                    (3) | Val  Loss: 0.5672 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 0.9673 | Val  Acc: 0.7339
 Site-Infograph                 (5) | Val  Loss: 1.0938 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8804
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.9474
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.9065
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8762
 Best site-Clipart                  (0)  | Epoch:28 | Val Acc: 0.8712
 Best site-Real                     (4)  | Epoch:28 | Val Acc: 0.9286
 Best site-Real                     (4)  | Epoch:28 | Val Acc: 0.9576
 Best site-Real                     (4)  | Epoch:28 | Val Acc: 0.9152
 Best site-Real                     (4)  | Epoch:28 | Val Acc: 0.9481
 Best site-Painting                 (2)  | Epoch:28 | Val Acc: 0.9490
 Best site-Painting                 (2)  | Epoch:28 | Val Acc: 0.9197
 Best site-Painting                 (2)  | Epoch:28 | Val Acc: 0.8802
 Best site-Sketch                   (3)  | Epoch:28 | Val Acc: 0.8898
 Best site-Sketch                   (3)  | Epoch:28 | Val Acc: 0.7978
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.7339
 Best site-Infograph                (5)  | Epoch:28 | Val Acc: 0.6987
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 29 ============
cnt=[1, 1, 5, 3, 4, 2, ]
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (2) | Train Loss: 0.4566 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.3918 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.4801 | Train Acc: 0.8356
 Site-Clipart                   (2) | Train Loss: 0.4218 | Train Acc: 0.8829
 Site-Clipart                   (2) | Train Loss: 0.4247 | Train Acc: 0.8982
 Site-Real                      (4) | Train Loss: 0.3530 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2573 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2533 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.2782 | Train Acc: 0.9483
 Site-Painting                  (3) | Train Loss: 0.3914 | Train Acc: 0.8571
 Site-Painting                  (3) | Train Loss: 0.4377 | Train Acc: 0.8689
 Site-Painting                  (3) | Train Loss: 0.3910 | Train Acc: 0.8997
 Site-Sketch                    (5) | Train Loss: 0.5041 | Train Acc: 0.8482
 Site-Sketch                    (5) | Train Loss: 0.4978 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.8317 | Train Acc: 0.7676
 Site-Infograph                 (0) | Train Loss: 1.0151 | Train Acc: 0.6795
Average Train Accuracy: 0.8698
 Site-Clipart                   (2) | Val  Loss: 0.3012 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3680 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.4246 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.4437 | Val  Acc: 0.8619
 Site-Clipart                   (2) | Val  Loss: 0.5064 | Val  Acc: 0.8407
 Site-Real                      (4) | Val  Loss: 0.2952 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2727 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.2603 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.2530 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.3559 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.3163 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.3918 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4875 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5544 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 0.9402 | Val  Acc: 0.7339
 Site-Infograph                 (0) | Val  Loss: 1.0592 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8713
 Test site-Clipart                   (2)| Epoch:28 | Test Acc: 0.8935
 Test site-Real                      (4)| Epoch:28 | Test Acc: 0.9458
 Test site-Painting                  (3)| Epoch:28 | Test Acc: 0.9273
 Test site-Sketch                    (5)| Epoch:28 | Test Acc: 0.8718
 Test site-QuickDraw                 (1)| Epoch:28 | Test Acc: 0.7060
 Test site-Infograph                 (0)| Epoch:28 | Test Acc: 0.5647
Clipart: 0.8935, Real: 0.9458, Painting: 0.9273, Sketch: 0.8718, QuickDraw: 0.7060, Infograph: 0.5647, 
Average Test Accuracy(group): 0.8182, Average Test Accuracy(individual): 0.8779,
domain std=0.1376, cluster std=0.1376, individual std=0.0983, 
============ Train epoch 30 ============
cnt=[5, 1, 3, 4, 1, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (0) | Train Loss: 0.4761 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.3412 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.4723 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3914 | Train Acc: 0.8956
 Site-Clipart                   (0) | Train Loss: 0.4294 | Train Acc: 0.8914
 Site-Real                      (3) | Train Loss: 0.3569 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2343 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2589 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2871 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.3742 | Train Acc: 0.9116
 Site-Painting                  (2) | Train Loss: 0.3915 | Train Acc: 0.8932
 Site-Painting                  (2) | Train Loss: 0.3821 | Train Acc: 0.9135
 Site-Sketch                    (5) | Train Loss: 0.4702 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.5747 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 0.9037 | Train Acc: 0.7645
 Site-Infograph                 (4) | Train Loss: 1.0626 | Train Acc: 0.6581
Average Train Accuracy: 0.8767
 Site-Clipart                   (0) | Val  Loss: 0.2763 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3486 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.4111 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.4112 | Val  Acc: 0.8619
 Site-Clipart                   (0) | Val  Loss: 0.5026 | Val  Acc: 0.8712
 Site-Real                      (3) | Val  Loss: 0.2658 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2323 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.2194 | Val  Acc: 0.9515
 Site-Real                      (3) | Val  Loss: 0.2543 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.3097 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3693 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.4012 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.4846 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5670 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.9313 | Val  Acc: 0.7523
 Site-Infograph                 (4) | Val  Loss: 1.0730 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8826
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.9342
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.9252
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.9000
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8619
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8712
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9492
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9515
 Best site-Real                     (3)  | Epoch:30 | Val Acc: 0.9481
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9286
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9124
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.8906
 Best site-Sketch                   (5)  | Epoch:30 | Val Acc: 0.8583
 Best site-Sketch                   (5)  | Epoch:30 | Val Acc: 0.8258
 Best site-QuickDraw                (1)  | Epoch:30 | Val Acc: 0.7523
 Best site-Infograph                (4)  | Epoch:30 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 31 ============
cnt=[4, 1, 5, 3, 2, 1, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (2) | Train Loss: 0.4320 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.3114 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.5195 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.4343 | Train Acc: 0.8734
 Site-Clipart                   (2) | Train Loss: 0.4215 | Train Acc: 0.8982
 Site-Real                      (0) | Train Loss: 0.3705 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.2546 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2421 | Train Acc: 0.9556
 Site-Real                      (0) | Train Loss: 0.2962 | Train Acc: 0.9339
 Site-Painting                  (3) | Train Loss: 0.4556 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.3686 | Train Acc: 0.9029
 Site-Painting                  (3) | Train Loss: 0.3899 | Train Acc: 0.9066
 Site-Sketch                    (4) | Train Loss: 0.5008 | Train Acc: 0.8429
 Site-Sketch                    (4) | Train Loss: 0.5356 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 0.7688 | Train Acc: 0.7737
 Site-Infograph                 (5) | Train Loss: 1.0756 | Train Acc: 0.6581
Average Train Accuracy: 0.8723
 Site-Clipart                   (2) | Val  Loss: 0.3155 | Val  Acc: 0.8684
 Site-Clipart                   (2) | Val  Loss: 0.3683 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.4069 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.3804 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.4956 | Val  Acc: 0.8576
 Site-Real                      (0) | Val  Loss: 0.2705 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2557 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.2364 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2784 | Val  Acc: 0.9351
 Site-Painting                  (3) | Val  Loss: 0.2993 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.3737 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3918 | Val  Acc: 0.8906
 Site-Sketch                    (4) | Val  Loss: 0.4500 | Val  Acc: 0.8425
 Site-Sketch                    (4) | Val  Loss: 0.5138 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.9060 | Val  Acc: 0.7477
 Site-Infograph                 (5) | Val  Loss: 1.0190 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8710
============ Train epoch 32 ============
cnt=[1, 4, 2, 5, 3, 1, ]
cnt=[1, 5, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (3) | Train Loss: 0.4824 | Train Acc: 0.8522
 Site-Clipart                   (3) | Train Loss: 0.3283 | Train Acc: 0.9379
 Site-Clipart                   (3) | Train Loss: 0.5058 | Train Acc: 0.8622
 Site-Clipart                   (3) | Train Loss: 0.4204 | Train Acc: 0.8892
 Site-Clipart                   (3) | Train Loss: 0.4049 | Train Acc: 0.9027
 Site-Real                      (1) | Train Loss: 0.3547 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.2471 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.2589 | Train Acc: 0.9556
 Site-Real                      (1) | Train Loss: 0.2910 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.3802 | Train Acc: 0.8912
 Site-Painting                  (4) | Train Loss: 0.4227 | Train Acc: 0.8932
 Site-Painting                  (4) | Train Loss: 0.3716 | Train Acc: 0.9100
 Site-Sketch                    (2) | Train Loss: 0.4646 | Train Acc: 0.8377
 Site-Sketch                    (2) | Train Loss: 0.5097 | Train Acc: 0.8315
 Site-QuickDraw                 (0) | Train Loss: 0.8900 | Train Acc: 0.7248
 Site-Infograph                 (5) | Train Loss: 0.9808 | Train Acc: 0.6838
Average Train Accuracy: 0.8733
 Site-Clipart                   (3) | Val  Loss: 0.2699 | Val  Acc: 0.9474
 Site-Clipart                   (3) | Val  Loss: 0.3659 | Val  Acc: 0.9159
 Site-Clipart                   (3) | Val  Loss: 0.3802 | Val  Acc: 0.9000
 Site-Clipart                   (3) | Val  Loss: 0.4143 | Val  Acc: 0.8714
 Site-Clipart                   (3) | Val  Loss: 0.4769 | Val  Acc: 0.8678
 Site-Real                      (1) | Val  Loss: 0.2531 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2485 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.2610 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.2747 | Val  Acc: 0.9394
 Site-Painting                  (4) | Val  Loss: 0.2444 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.4122 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.3845 | Val  Acc: 0.9010
 Site-Sketch                    (2) | Val  Loss: 0.4631 | Val  Acc: 0.8346
 Site-Sketch                    (2) | Val  Loss: 0.5517 | Val  Acc: 0.8146
 Site-QuickDraw                 (0) | Val  Loss: 0.9221 | Val  Acc: 0.7431
 Site-Infograph                 (5) | Val  Loss: 0.9986 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8799
============ Train epoch 33 ============
cnt=[2, 1, 4, 5, 3, 1, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (3) | Train Loss: 0.4391 | Train Acc: 0.8783
 Site-Clipart                   (3) | Train Loss: 0.3112 | Train Acc: 0.9255
 Site-Clipart                   (3) | Train Loss: 0.4213 | Train Acc: 0.8844
 Site-Clipart                   (3) | Train Loss: 0.3870 | Train Acc: 0.8861
 Site-Clipart                   (3) | Train Loss: 0.3949 | Train Acc: 0.9208
 Site-Real                      (2) | Train Loss: 0.3692 | Train Acc: 0.8968
 Site-Real                      (2) | Train Loss: 0.2247 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.2622 | Train Acc: 0.9274
 Site-Real                      (2) | Train Loss: 0.2794 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.4575 | Train Acc: 0.8571
 Site-Painting                  (4) | Train Loss: 0.4265 | Train Acc: 0.8738
 Site-Painting                  (4) | Train Loss: 0.3506 | Train Acc: 0.9204
 Site-Sketch                    (0) | Train Loss: 0.4956 | Train Acc: 0.8377
 Site-Sketch                    (0) | Train Loss: 0.4467 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.8873 | Train Acc: 0.7523
 Site-Infograph                 (5) | Train Loss: 1.0362 | Train Acc: 0.6752
Average Train Accuracy: 0.8758
 Site-Clipart                   (3) | Val  Loss: 0.3168 | Val  Acc: 0.8947
 Site-Clipart                   (3) | Val  Loss: 0.3487 | Val  Acc: 0.9065
 Site-Clipart                   (3) | Val  Loss: 0.3690 | Val  Acc: 0.9000
 Site-Clipart                   (3) | Val  Loss: 0.3824 | Val  Acc: 0.8952
 Site-Clipart                   (3) | Val  Loss: 0.4892 | Val  Acc: 0.8508
 Site-Real                      (2) | Val  Loss: 0.2453 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2150 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.2553 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.2444 | Val  Acc: 0.9437
 Site-Painting                  (4) | Val  Loss: 0.2529 | Val  Acc: 0.9592
 Site-Painting                  (4) | Val  Loss: 0.3306 | Val  Acc: 0.8905
 Site-Painting                  (4) | Val  Loss: 0.3557 | Val  Acc: 0.8958
 Site-Sketch                    (0) | Val  Loss: 0.4586 | Val  Acc: 0.8583
 Site-Sketch                    (0) | Val  Loss: 0.5343 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.8866 | Val  Acc: 0.7615
 Site-Infograph                 (5) | Val  Loss: 1.0800 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8804
============ Train epoch 34 ============
cnt=[1, 4, 5, 3, 1, 2, ]
cnt=[5, 4, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (2) | Train Loss: 0.4015 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.3222 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.4089 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.3757 | Train Acc: 0.9051
 Site-Clipart                   (2) | Train Loss: 0.4122 | Train Acc: 0.8846
 Site-Real                      (1) | Train Loss: 0.3713 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.2259 | Train Acc: 0.9605
 Site-Real                      (1) | Train Loss: 0.2176 | Train Acc: 0.9637
 Site-Real                      (1) | Train Loss: 0.3068 | Train Acc: 0.9454
 Site-Painting                  (3) | Train Loss: 0.5028 | Train Acc: 0.8571
 Site-Painting                  (3) | Train Loss: 0.4813 | Train Acc: 0.8689
 Site-Painting                  (3) | Train Loss: 0.3684 | Train Acc: 0.9031
 Site-Sketch                    (5) | Train Loss: 0.5058 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.4815 | Train Acc: 0.8427
 Site-QuickDraw                 (0) | Train Loss: 0.8308 | Train Acc: 0.7859
 Site-Infograph                 (4) | Train Loss: 0.9675 | Train Acc: 0.7009
Average Train Accuracy: 0.8793
 Site-Clipart                   (2) | Val  Loss: 0.2730 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.3193 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.3581 | Val  Acc: 0.9067
 Site-Clipart                   (2) | Val  Loss: 0.3806 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.4646 | Val  Acc: 0.8644
 Site-Real                      (1) | Val  Loss: 0.2421 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2377 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2468 | Val  Acc: 0.9273
 Site-Real                      (1) | Val  Loss: 0.2725 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.2976 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.2960 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.3740 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4411 | Val  Acc: 0.8740
 Site-Sketch                    (5) | Val  Loss: 0.5046 | Val  Acc: 0.8146
 Site-QuickDraw                 (0) | Val  Loss: 0.9130 | Val  Acc: 0.7431
 Site-Infograph                 (4) | Val  Loss: 0.9817 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8805
============ Train epoch 35 ============
cnt=[4, 1, 2, 5, 3, 1, ]
cnt=[1, 5, 3, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (3) | Train Loss: 0.4115 | Train Acc: 0.8783
 Site-Clipart                   (3) | Train Loss: 0.3148 | Train Acc: 0.9317
 Site-Clipart                   (3) | Train Loss: 0.4528 | Train Acc: 0.8711
 Site-Clipart                   (3) | Train Loss: 0.4155 | Train Acc: 0.8734
 Site-Clipart                   (3) | Train Loss: 0.4006 | Train Acc: 0.8982
 Site-Real                      (0) | Train Loss: 0.3391 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2399 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2352 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2923 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.4237 | Train Acc: 0.8844
 Site-Painting                  (4) | Train Loss: 0.3852 | Train Acc: 0.8738
 Site-Painting                  (4) | Train Loss: 0.3485 | Train Acc: 0.9377
 Site-Sketch                    (2) | Train Loss: 0.4797 | Train Acc: 0.8586
 Site-Sketch                    (2) | Train Loss: 0.4794 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.8966 | Train Acc: 0.7768
 Site-Infograph                 (5) | Train Loss: 0.9492 | Train Acc: 0.6923
Average Train Accuracy: 0.8803
 Site-Clipart                   (3) | Val  Loss: 0.3085 | Val  Acc: 0.9211
 Site-Clipart                   (3) | Val  Loss: 0.3799 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.3948 | Val  Acc: 0.9067
 Site-Clipart                   (3) | Val  Loss: 0.4191 | Val  Acc: 0.8952
 Site-Clipart                   (3) | Val  Loss: 0.4744 | Val  Acc: 0.8644
 Site-Real                      (0) | Val  Loss: 0.2441 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2465 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2360 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2600 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2468 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.3131 | Val  Acc: 0.9051
 Site-Painting                  (4) | Val  Loss: 0.3836 | Val  Acc: 0.9062
 Site-Sketch                    (2) | Val  Loss: 0.3916 | Val  Acc: 0.8661
 Site-Sketch                    (2) | Val  Loss: 0.5204 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.8739 | Val  Acc: 0.7661
 Site-Infograph                 (5) | Val  Loss: 1.0026 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8860
 Best site-Clipart                  (3)  | Epoch:35 | Val Acc: 0.9211
 Best site-Clipart                  (3)  | Epoch:35 | Val Acc: 0.8879
 Best site-Clipart                  (3)  | Epoch:35 | Val Acc: 0.9067
 Best site-Clipart                  (3)  | Epoch:35 | Val Acc: 0.8952
 Best site-Clipart                  (3)  | Epoch:35 | Val Acc: 0.8644
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9492
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9394
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:35 | Val Acc: 0.9388
 Best site-Painting                 (4)  | Epoch:35 | Val Acc: 0.9051
 Best site-Painting                 (4)  | Epoch:35 | Val Acc: 0.9062
 Best site-Sketch                   (2)  | Epoch:35 | Val Acc: 0.8661
 Best site-Sketch                   (2)  | Epoch:35 | Val Acc: 0.8258
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.7661
 Best site-Infograph                (5)  | Epoch:35 | Val Acc: 0.7115
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 36 ============
cnt=[3, 1, 2, 5, 4, 1, ]
cnt=[3, 5, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (3) | Train Loss: 0.3995 | Train Acc: 0.8696
 Site-Clipart                   (3) | Train Loss: 0.3173 | Train Acc: 0.9130
 Site-Clipart                   (3) | Train Loss: 0.4765 | Train Acc: 0.8667
 Site-Clipart                   (3) | Train Loss: 0.4010 | Train Acc: 0.8703
 Site-Clipart                   (3) | Train Loss: 0.3870 | Train Acc: 0.9095
 Site-Real                      (4) | Train Loss: 0.3554 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2545 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2312 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2639 | Train Acc: 0.9511
 Site-Painting                  (0) | Train Loss: 0.4129 | Train Acc: 0.8912
 Site-Painting                  (0) | Train Loss: 0.3994 | Train Acc: 0.8932
 Site-Painting                  (0) | Train Loss: 0.3392 | Train Acc: 0.9100
 Site-Sketch                    (2) | Train Loss: 0.4692 | Train Acc: 0.8743
 Site-Sketch                    (2) | Train Loss: 0.5800 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.8307 | Train Acc: 0.7554
 Site-Infograph                 (5) | Train Loss: 0.9497 | Train Acc: 0.6752
Average Train Accuracy: 0.8760
 Site-Clipart                   (3) | Val  Loss: 0.2854 | Val  Acc: 0.9079
 Site-Clipart                   (3) | Val  Loss: 0.3302 | Val  Acc: 0.9065
 Site-Clipart                   (3) | Val  Loss: 0.3672 | Val  Acc: 0.8933
 Site-Clipart                   (3) | Val  Loss: 0.4039 | Val  Acc: 0.8667
 Site-Clipart                   (3) | Val  Loss: 0.4202 | Val  Acc: 0.8983
 Site-Real                      (4) | Val  Loss: 0.2517 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2433 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2627 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.2629 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.3026 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.3010 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3764 | Val  Acc: 0.9219
 Site-Sketch                    (2) | Val  Loss: 0.4221 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.5305 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.8631 | Val  Acc: 0.7752
 Site-Infograph                 (5) | Val  Loss: 0.9999 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8832
============ Train epoch 37 ============
cnt=[2, 1, 4, 3, 5, 1, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (4) | Train Loss: 0.4271 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.3189 | Train Acc: 0.9068
 Site-Clipart                   (4) | Train Loss: 0.4038 | Train Acc: 0.8800
 Site-Clipart                   (4) | Train Loss: 0.3696 | Train Acc: 0.8892
 Site-Clipart                   (4) | Train Loss: 0.3947 | Train Acc: 0.8914
 Site-Real                      (2) | Train Loss: 0.3270 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.2056 | Train Acc: 0.9718
 Site-Real                      (2) | Train Loss: 0.2368 | Train Acc: 0.9315
 Site-Real                      (2) | Train Loss: 0.2849 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.4483 | Train Acc: 0.8912
 Site-Painting                  (3) | Train Loss: 0.4234 | Train Acc: 0.8786
 Site-Painting                  (3) | Train Loss: 0.3437 | Train Acc: 0.9100
 Site-Sketch                    (0) | Train Loss: 0.4619 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.4281 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.7785 | Train Acc: 0.7890
 Site-Infograph                 (5) | Train Loss: 0.9498 | Train Acc: 0.7051
Average Train Accuracy: 0.8788
 Site-Clipart                   (4) | Val  Loss: 0.3012 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.3282 | Val  Acc: 0.9065
 Site-Clipart                   (4) | Val  Loss: 0.3947 | Val  Acc: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.3659 | Val  Acc: 0.8714
 Site-Clipart                   (4) | Val  Loss: 0.4248 | Val  Acc: 0.8847
 Site-Real                      (2) | Val  Loss: 0.2292 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2524 | Val  Acc: 0.9153
 Site-Real                      (2) | Val  Loss: 0.2669 | Val  Acc: 0.9212
 Site-Real                      (2) | Val  Loss: 0.2349 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.2667 | Val  Acc: 0.9388
 Site-Painting                  (3) | Val  Loss: 0.2878 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3607 | Val  Acc: 0.9062
 Site-Sketch                    (0) | Val  Loss: 0.3925 | Val  Acc: 0.8898
 Site-Sketch                    (0) | Val  Loss: 0.5192 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.8367 | Val  Acc: 0.7890
 Site-Infograph                 (5) | Val  Loss: 1.0291 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8789
============ Train epoch 38 ============
cnt=[3, 1, 5, 2, 1, 4, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (2) | Train Loss: 0.3604 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.3220 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.4483 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.3890 | Train Acc: 0.8829
 Site-Clipart                   (2) | Train Loss: 0.3737 | Train Acc: 0.9140
 Site-Real                      (5) | Train Loss: 0.3642 | Train Acc: 0.8968
 Site-Real                      (5) | Train Loss: 0.2267 | Train Acc: 0.9548
 Site-Real                      (5) | Train Loss: 0.2273 | Train Acc: 0.9516
 Site-Real                      (5) | Train Loss: 0.2868 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.4900 | Train Acc: 0.8435
 Site-Painting                  (0) | Train Loss: 0.3368 | Train Acc: 0.8932
 Site-Painting                  (0) | Train Loss: 0.3459 | Train Acc: 0.9308
 Site-Sketch                    (3) | Train Loss: 0.4298 | Train Acc: 0.8743
 Site-Sketch                    (3) | Train Loss: 0.4505 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.7584 | Train Acc: 0.8165
 Site-Infograph                 (4) | Train Loss: 0.9413 | Train Acc: 0.6966
Average Train Accuracy: 0.8820
 Site-Clipart                   (2) | Val  Loss: 0.2739 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.3382 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.3304 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.3574 | Val  Acc: 0.8952
 Site-Clipart                   (2) | Val  Loss: 0.4560 | Val  Acc: 0.8678
 Site-Real                      (5) | Val  Loss: 0.2391 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.2200 | Val  Acc: 0.9492
 Site-Real                      (5) | Val  Loss: 0.2076 | Val  Acc: 0.9515
 Site-Real                      (5) | Val  Loss: 0.2363 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.2671 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.3294 | Val  Acc: 0.8978
 Site-Painting                  (0) | Val  Loss: 0.3554 | Val  Acc: 0.9115
 Site-Sketch                    (3) | Val  Loss: 0.4299 | Val  Acc: 0.8583
 Site-Sketch                    (3) | Val  Loss: 0.5376 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.8009 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 1.0591 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8818
============ Train epoch 39 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (0) | Train Loss: 0.4060 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.2888 | Train Acc: 0.9255
 Site-Clipart                   (0) | Train Loss: 0.4242 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.3987 | Train Acc: 0.8797
 Site-Clipart                   (0) | Train Loss: 0.3602 | Train Acc: 0.9118
 Site-Real                      (4) | Train Loss: 0.3357 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2262 | Train Acc: 0.9605
 Site-Real                      (4) | Train Loss: 0.2394 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2831 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.4132 | Train Acc: 0.8776
 Site-Painting                  (2) | Train Loss: 0.3591 | Train Acc: 0.8835
 Site-Painting                  (2) | Train Loss: 0.3454 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.4483 | Train Acc: 0.8639
 Site-Sketch                    (5) | Train Loss: 0.5477 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.8082 | Train Acc: 0.7859
 Site-Infograph                 (3) | Train Loss: 0.9122 | Train Acc: 0.7009
Average Train Accuracy: 0.8825
 Site-Clipart                   (0) | Val  Loss: 0.2220 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3455 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.3517 | Val  Acc: 0.9133
 Site-Clipart                   (0) | Val  Loss: 0.3636 | Val  Acc: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.4182 | Val  Acc: 0.8847
 Site-Real                      (4) | Val  Loss: 0.2177 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2352 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2050 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2356 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2678 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.2910 | Val  Acc: 0.9416
 Site-Painting                  (2) | Val  Loss: 0.3478 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.4043 | Val  Acc: 0.9055
 Site-Sketch                    (5) | Val  Loss: 0.4988 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.9006 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 0.9707 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8947
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.9342
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8972
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.9133
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8905
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8847
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9492
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9455
 Best site-Real                     (4)  | Epoch:39 | Val Acc: 0.9567
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9490
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9416
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.8958
 Best site-Sketch                   (5)  | Epoch:39 | Val Acc: 0.9055
 Best site-Sketch                   (5)  | Epoch:39 | Val Acc: 0.8315
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.7752
 Best site-Infograph                (3)  | Epoch:39 | Val Acc: 0.6923
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (0)| Epoch:39 | Test Acc: 0.8916
 Test site-Real                      (4)| Epoch:39 | Test Acc: 0.9458
 Test site-Painting                  (2)| Epoch:39 | Test Acc: 0.9338
 Test site-Sketch                    (5)| Epoch:39 | Test Acc: 0.8718
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7300
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5662
Clipart: 0.8916, Real: 0.9458, Painting: 0.9338, Sketch: 0.8718, QuickDraw: 0.7300, Infograph: 0.5662, 
Average Test Accuracy(group): 0.8232, Average Test Accuracy(individual): 0.8802,
domain std=0.1348, cluster std=0.1348, individual std=0.0961, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 1, 4, 1, 5, 3, ]
cnt=[2, 4, 5, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (4) | Train Loss: 0.3744 | Train Acc: 0.8957
 Site-Clipart                   (4) | Train Loss: 0.2872 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.4233 | Train Acc: 0.8800
 Site-Clipart                   (4) | Train Loss: 0.3740 | Train Acc: 0.8924
 Site-Clipart                   (4) | Train Loss: 0.3884 | Train Acc: 0.9027
 Site-Real                      (2) | Train Loss: 0.3306 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.2325 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2404 | Train Acc: 0.9355
 Site-Real                      (2) | Train Loss: 0.2653 | Train Acc: 0.9540
 Site-Painting                  (5) | Train Loss: 0.4697 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.3898 | Train Acc: 0.8835
 Site-Painting                  (5) | Train Loss: 0.3498 | Train Acc: 0.9031
 Site-Sketch                    (0) | Train Loss: 0.4564 | Train Acc: 0.8429
 Site-Sketch                    (0) | Train Loss: 0.3985 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.8187 | Train Acc: 0.7706
 Site-Infograph                 (3) | Train Loss: 0.9115 | Train Acc: 0.7350
Average Train Accuracy: 0.8824
 Site-Clipart                   (4) | Val  Loss: 0.2588 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.3281 | Val  Acc: 0.9346
 Site-Clipart                   (4) | Val  Loss: 0.3499 | Val  Acc: 0.8933
 Site-Clipart                   (4) | Val  Loss: 0.3543 | Val  Acc: 0.8857
 Site-Clipart                   (4) | Val  Loss: 0.4069 | Val  Acc: 0.9051
 Site-Real                      (2) | Val  Loss: 0.2276 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.2299 | Val  Acc: 0.9153
 Site-Real                      (2) | Val  Loss: 0.2497 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.2324 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2500 | Val  Acc: 0.9184
 Site-Painting                  (5) | Val  Loss: 0.3075 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.3449 | Val  Acc: 0.9115
 Site-Sketch                    (0) | Val  Loss: 0.4071 | Val  Acc: 0.8819
 Site-Sketch                    (0) | Val  Loss: 0.4632 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.8514 | Val  Acc: 0.7615
 Site-Infograph                 (3) | Val  Loss: 0.9573 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8844
 Test site-Clipart                   (4)| Epoch:39 | Test Acc: 0.8973
 Test site-Real                      (2)| Epoch:39 | Test Acc: 0.9466
 Test site-Painting                  (5)| Epoch:39 | Test Acc: 0.9305
 Test site-Sketch                    (0)| Epoch:39 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7270
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5601
Clipart: 0.8973, Real: 0.9466, Painting: 0.9305, Sketch: 0.8845, QuickDraw: 0.7270, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8243, Average Test Accuracy(individual): 0.8825,
domain std=0.1381, cluster std=0.1381, individual std=0.0976, 
Average Test Accuracy: 0.8243
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 41 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (0) | Train Loss: 0.4121 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.2975 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.3691 | Train Acc: 0.8978
 Site-Clipart                   (0) | Train Loss: 0.3671 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.3582 | Train Acc: 0.9186
 Site-Real                      (2) | Train Loss: 0.3156 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.2028 | Train Acc: 0.9718
 Site-Real                      (2) | Train Loss: 0.2321 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.2637 | Train Acc: 0.9483
 Site-Painting                  (4) | Train Loss: 0.2915 | Train Acc: 0.9320
 Site-Painting                  (4) | Train Loss: 0.4263 | Train Acc: 0.8350
 Site-Painting                  (4) | Train Loss: 0.3337 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4325 | Train Acc: 0.8796
 Site-Sketch                    (5) | Train Loss: 0.4342 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.8120 | Train Acc: 0.8226
 Site-Infograph                 (3) | Train Loss: 0.9192 | Train Acc: 0.6966
Average Train Accuracy: 0.8892
 Site-Clipart                   (0) | Val  Loss: 0.2835 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.2942 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.3571 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.3746 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.4308 | Val  Acc: 0.8746
 Site-Real                      (2) | Val  Loss: 0.2334 | Val  Acc: 0.9167
 Site-Real                      (2) | Val  Loss: 0.2443 | Val  Acc: 0.9237
 Site-Real                      (2) | Val  Loss: 0.2024 | Val  Acc: 0.9394
 Site-Real                      (2) | Val  Loss: 0.2319 | Val  Acc: 0.9481
 Site-Painting                  (4) | Val  Loss: 0.2428 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.3348 | Val  Acc: 0.8905
 Site-Painting                  (4) | Val  Loss: 0.3359 | Val  Acc: 0.9115
 Site-Sketch                    (5) | Val  Loss: 0.3875 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.4921 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.8437 | Val  Acc: 0.7890
 Site-Infograph                 (3) | Val  Loss: 0.9822 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8848
 Test site-Clipart                   (0)| Epoch:40 | Test Acc: 0.8973
 Test site-Real                      (2)| Epoch:40 | Test Acc: 0.9474
 Test site-Painting                  (4)| Epoch:40 | Test Acc: 0.9338
 Test site-Sketch                    (5)| Epoch:40 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:40 | Test Acc: 0.7370
 Test site-Infograph                 (3)| Epoch:40 | Test Acc: 0.5571
Clipart: 0.8973, Real: 0.9474, Painting: 0.9338, Sketch: 0.8791, QuickDraw: 0.7370, Infograph: 0.5571, 
Average Test Accuracy(group): 0.8253, Average Test Accuracy(individual): 0.8831,
domain std=0.1381, cluster std=0.1381, individual std=0.0978, 
Average Test Accuracy: 0.8253
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 42 ============
cnt=[3, 1, 5, 1, 4, 2, ]
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (2) | Train Loss: 0.3692 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.3082 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.4458 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.3536 | Train Acc: 0.9177
 Site-Clipart                   (2) | Train Loss: 0.3627 | Train Acc: 0.9072
 Site-Real                      (4) | Train Loss: 0.3357 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.1921 | Train Acc: 0.9718
 Site-Real                      (4) | Train Loss: 0.2370 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2508 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.3693 | Train Acc: 0.9048
 Site-Painting                  (0) | Train Loss: 0.3731 | Train Acc: 0.8883
 Site-Painting                  (0) | Train Loss: 0.3064 | Train Acc: 0.9481
 Site-Sketch                    (5) | Train Loss: 0.4440 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.5299 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.7099 | Train Acc: 0.8104
 Site-Infograph                 (3) | Train Loss: 0.9056 | Train Acc: 0.7051
Average Train Accuracy: 0.8907
 Site-Clipart                   (2) | Val  Loss: 0.2431 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.2760 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.2940 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.3647 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.4462 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.2176 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2549 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2201 | Val  Acc: 0.9515
 Site-Real                      (4) | Val  Loss: 0.2366 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.2699 | Val  Acc: 0.9490
 Site-Painting                  (0) | Val  Loss: 0.2918 | Val  Acc: 0.9197
 Site-Painting                  (0) | Val  Loss: 0.3424 | Val  Acc: 0.9167
 Site-Sketch                    (5) | Val  Loss: 0.3973 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.4988 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.8027 | Val  Acc: 0.7431
 Site-Infograph                 (3) | Val  Loss: 1.0270 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8877
 Test site-Clipart                   (2)| Epoch:41 | Test Acc: 0.8992
 Test site-Real                      (4)| Epoch:41 | Test Acc: 0.9482
 Test site-Painting                  (0)| Epoch:41 | Test Acc: 0.9289
 Test site-Sketch                    (5)| Epoch:41 | Test Acc: 0.8809
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7370
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5586
Clipart: 0.8992, Real: 0.9482, Painting: 0.9289, Sketch: 0.8809, QuickDraw: 0.7370, Infograph: 0.5586, 
Average Test Accuracy(group): 0.8255, Average Test Accuracy(individual): 0.8833,
domain std=0.1374, cluster std=0.1374, individual std=0.0972, 
Average Test Accuracy: 0.8255
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 43 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (4) | Train Loss: 0.3441 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.3114 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.3991 | Train Acc: 0.9022
 Site-Clipart                   (4) | Train Loss: 0.3564 | Train Acc: 0.9019
 Site-Clipart                   (4) | Train Loss: 0.3699 | Train Acc: 0.9005
 Site-Real                      (0) | Train Loss: 0.3151 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2162 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2161 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2463 | Train Acc: 0.9483
 Site-Painting                  (5) | Train Loss: 0.3959 | Train Acc: 0.8980
 Site-Painting                  (5) | Train Loss: 0.3434 | Train Acc: 0.9029
 Site-Painting                  (5) | Train Loss: 0.3407 | Train Acc: 0.9135
 Site-Sketch                    (2) | Train Loss: 0.4635 | Train Acc: 0.8429
 Site-Sketch                    (2) | Train Loss: 0.4560 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.8505 | Train Acc: 0.7982
 Site-Infograph                 (3) | Train Loss: 0.8720 | Train Acc: 0.7222
Average Train Accuracy: 0.8909
 Site-Clipart                   (4) | Val  Loss: 0.2490 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.2989 | Val  Acc: 0.9252
 Site-Clipart                   (4) | Val  Loss: 0.3474 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.3780 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4110 | Val  Acc: 0.8915
 Site-Real                      (0) | Val  Loss: 0.2407 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2105 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2098 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2363 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.2469 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.3120 | Val  Acc: 0.9197
 Site-Painting                  (5) | Val  Loss: 0.3341 | Val  Acc: 0.9115
 Site-Sketch                    (2) | Val  Loss: 0.3706 | Val  Acc: 0.8898
 Site-Sketch                    (2) | Val  Loss: 0.4768 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.8226 | Val  Acc: 0.7844
 Site-Infograph                 (3) | Val  Loss: 0.9909 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8908
 Test site-Clipart                   (4)| Epoch:42 | Test Acc: 0.8954
 Test site-Real                      (0)| Epoch:42 | Test Acc: 0.9482
 Test site-Painting                  (5)| Epoch:42 | Test Acc: 0.9305
 Test site-Sketch                    (2)| Epoch:42 | Test Acc: 0.8773
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7300
 Test site-Infograph                 (3)| Epoch:42 | Test Acc: 0.5601
Clipart: 0.8954, Real: 0.9482, Painting: 0.9305, Sketch: 0.8773, QuickDraw: 0.7300, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8236, Average Test Accuracy(individual): 0.8816,
domain std=0.1373, cluster std=0.1373, individual std=0.0976, 
Average Test Accuracy: 0.8236
============ Train epoch 44 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (4) | Train Loss: 0.4039 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.2821 | Train Acc: 0.9379
 Site-Clipart                   (4) | Train Loss: 0.3923 | Train Acc: 0.8933
 Site-Clipart                   (4) | Train Loss: 0.3541 | Train Acc: 0.8924
 Site-Clipart                   (4) | Train Loss: 0.3478 | Train Acc: 0.9072
 Site-Real                      (0) | Train Loss: 0.3339 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2244 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2116 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.2521 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.3025 | Train Acc: 0.8912
 Site-Painting                  (5) | Train Loss: 0.3488 | Train Acc: 0.8932
 Site-Painting                  (5) | Train Loss: 0.3412 | Train Acc: 0.9170
 Site-Sketch                    (2) | Train Loss: 0.4356 | Train Acc: 0.8743
 Site-Sketch                    (2) | Train Loss: 0.4568 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.7350 | Train Acc: 0.8104
 Site-Infograph                 (3) | Train Loss: 0.8806 | Train Acc: 0.7692
Average Train Accuracy: 0.8922
 Site-Clipart                   (4) | Val  Loss: 0.2731 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.2932 | Val  Acc: 0.9346
 Site-Clipart                   (4) | Val  Loss: 0.3750 | Val  Acc: 0.8800
 Site-Clipart                   (4) | Val  Loss: 0.3484 | Val  Acc: 0.8905
 Site-Clipart                   (4) | Val  Loss: 0.4517 | Val  Acc: 0.8576
 Site-Real                      (0) | Val  Loss: 0.2364 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2456 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2235 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2328 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2488 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.2894 | Val  Acc: 0.9197
 Site-Painting                  (5) | Val  Loss: 0.3008 | Val  Acc: 0.9323
 Site-Sketch                    (2) | Val  Loss: 0.3921 | Val  Acc: 0.8661
 Site-Sketch                    (2) | Val  Loss: 0.4957 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.7603 | Val  Acc: 0.7982
 Site-Infograph                 (3) | Val  Loss: 0.9162 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8891
 Test site-Clipart                   (4)| Epoch:42 | Test Acc: 0.8992
 Test site-Real                      (0)| Epoch:42 | Test Acc: 0.9466
 Test site-Painting                  (5)| Epoch:42 | Test Acc: 0.9305
 Test site-Sketch                    (2)| Epoch:42 | Test Acc: 0.8899
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7330
 Test site-Infograph                 (3)| Epoch:42 | Test Acc: 0.5571
Clipart: 0.8992, Real: 0.9466, Painting: 0.9305, Sketch: 0.8899, QuickDraw: 0.7330, Infograph: 0.5571, 
Average Test Accuracy(group): 0.8261, Average Test Accuracy(individual): 0.8840,
domain std=0.1390, cluster std=0.1390, individual std=0.0978, 
Average Test Accuracy: 0.8261
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 45 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[3, 1, 5, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (4) | Train Loss: 0.4333 | Train Acc: 0.8957
 Site-Clipart                   (4) | Train Loss: 0.2971 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.4044 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.3600 | Train Acc: 0.8956
 Site-Clipart                   (4) | Train Loss: 0.3436 | Train Acc: 0.9208
 Site-Real                      (0) | Train Loss: 0.3362 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2265 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2409 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2695 | Train Acc: 0.9540
 Site-Painting                  (5) | Train Loss: 0.3466 | Train Acc: 0.8844
 Site-Painting                  (5) | Train Loss: 0.3328 | Train Acc: 0.8835
 Site-Painting                  (5) | Train Loss: 0.3201 | Train Acc: 0.9343
 Site-Sketch                    (2) | Train Loss: 0.4479 | Train Acc: 0.8848
 Site-Sketch                    (2) | Train Loss: 0.4254 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.7126 | Train Acc: 0.8073
 Site-Infograph                 (3) | Train Loss: 0.8626 | Train Acc: 0.7308
Average Train Accuracy: 0.8910
 Site-Clipart                   (4) | Val  Loss: 0.2560 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.3046 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.3281 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.3520 | Val  Acc: 0.8952
 Site-Clipart                   (4) | Val  Loss: 0.3997 | Val  Acc: 0.8881
 Site-Real                      (0) | Val  Loss: 0.2384 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2673 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2221 | Val  Acc: 0.9273
 Site-Real                      (0) | Val  Loss: 0.2237 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2355 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2953 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.3476 | Val  Acc: 0.9167
 Site-Sketch                    (2) | Val  Loss: 0.3908 | Val  Acc: 0.8976
 Site-Sketch                    (2) | Val  Loss: 0.4444 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.8403 | Val  Acc: 0.7844
 Site-Infograph                 (3) | Val  Loss: 0.9718 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8948
 Best site-Clipart                  (4)  | Epoch:45 | Val Acc: 0.9342
 Best site-Clipart                  (4)  | Epoch:45 | Val Acc: 0.9159
 Best site-Clipart                  (4)  | Epoch:45 | Val Acc: 0.9000
 Best site-Clipart                  (4)  | Epoch:45 | Val Acc: 0.8952
 Best site-Clipart                  (4)  | Epoch:45 | Val Acc: 0.8881
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9322
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9273
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9524
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9490
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9124
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9167
 Best site-Sketch                   (2)  | Epoch:45 | Val Acc: 0.8976
 Best site-Sketch                   (2)  | Epoch:45 | Val Acc: 0.8596
 Best site-QuickDraw                (1)  | Epoch:45 | Val Acc: 0.7844
 Best site-Infograph                (3)  | Epoch:45 | Val Acc: 0.6987
 Test site-Clipart                   (4)| Epoch:45 | Test Acc: 0.8992
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9458
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9289
 Test site-Sketch                    (2)| Epoch:45 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7310
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5540
Clipart: 0.8992, Real: 0.9458, Painting: 0.9289, Sketch: 0.8791, QuickDraw: 0.7310, Infograph: 0.5540, 
Average Test Accuracy(group): 0.8230, Average Test Accuracy(individual): 0.8818,
domain std=0.1391, cluster std=0.1391, individual std=0.0983, 
Average Test Accuracy: 0.8230
============ Train epoch 46 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[2, 5, 1, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (0) | Train Loss: 0.3916 | Train Acc: 0.8783
 Site-Clipart                   (0) | Train Loss: 0.3088 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.4319 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.3466 | Train Acc: 0.9114
 Site-Clipart                   (0) | Train Loss: 0.3426 | Train Acc: 0.9186
 Site-Real                      (4) | Train Loss: 0.3389 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.1941 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2222 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2452 | Train Acc: 0.9511
 Site-Painting                  (2) | Train Loss: 0.3579 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.3449 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.2690 | Train Acc: 0.9343
 Site-Sketch                    (5) | Train Loss: 0.4479 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.4609 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.6798 | Train Acc: 0.8318
 Site-Infograph                 (3) | Train Loss: 0.8661 | Train Acc: 0.7479
Average Train Accuracy: 0.8925
 Site-Clipart                   (0) | Val  Loss: 0.2445 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.2934 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3446 | Val  Acc: 0.9133
 Site-Clipart                   (0) | Val  Loss: 0.3599 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.4193 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2415 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2576 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2075 | Val  Acc: 0.9515
 Site-Real                      (4) | Val  Loss: 0.2155 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2154 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.2700 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.3284 | Val  Acc: 0.9375
 Site-Sketch                    (5) | Val  Loss: 0.3707 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.4858 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.8353 | Val  Acc: 0.7523
 Site-Infograph                 (3) | Val  Loss: 0.9397 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8956
 Best site-Clipart                  (0)  | Epoch:46 | Val Acc: 0.9079
 Best site-Clipart                  (0)  | Epoch:46 | Val Acc: 0.9159
 Best site-Clipart                  (0)  | Epoch:46 | Val Acc: 0.9133
 Best site-Clipart                  (0)  | Epoch:46 | Val Acc: 0.8857
 Best site-Clipart                  (0)  | Epoch:46 | Val Acc: 0.8712
 Best site-Real                     (4)  | Epoch:46 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:46 | Val Acc: 0.9407
 Best site-Real                     (4)  | Epoch:46 | Val Acc: 0.9515
 Best site-Real                     (4)  | Epoch:46 | Val Acc: 0.9567
 Best site-Painting                 (2)  | Epoch:46 | Val Acc: 0.9592
 Best site-Painting                 (2)  | Epoch:46 | Val Acc: 0.9270
 Best site-Painting                 (2)  | Epoch:46 | Val Acc: 0.9375
 Best site-Sketch                   (5)  | Epoch:46 | Val Acc: 0.8976
 Best site-Sketch                   (5)  | Epoch:46 | Val Acc: 0.8427
 Best site-QuickDraw                (1)  | Epoch:46 | Val Acc: 0.7523
 Best site-Infograph                (3)  | Epoch:46 | Val Acc: 0.7179
 Test site-Clipart                   (0)| Epoch:46 | Test Acc: 0.9049
 Test site-Real                      (4)| Epoch:46 | Test Acc: 0.9458
 Test site-Painting                  (2)| Epoch:46 | Test Acc: 0.9338
 Test site-Sketch                    (5)| Epoch:46 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7280
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5586
Clipart: 0.9049, Real: 0.9458, Painting: 0.9338, Sketch: 0.8845, QuickDraw: 0.7280, Infograph: 0.5586, 
Average Test Accuracy(group): 0.8259, Average Test Accuracy(individual): 0.8853,
domain std=0.1395, cluster std=0.1395, individual std=0.0985, 
Average Test Accuracy: 0.8259
============ Train epoch 47 ============
cnt=[1, 5, 1, 4, 2, 3, ]
cnt=[3, 1, 2, 5, 1, 4, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (1) | Train Loss: 0.3904 | Train Acc: 0.8870
 Site-Clipart                   (1) | Train Loss: 0.3197 | Train Acc: 0.9006
 Site-Clipart                   (1) | Train Loss: 0.4268 | Train Acc: 0.9156
 Site-Clipart                   (1) | Train Loss: 0.3441 | Train Acc: 0.9051
 Site-Clipart                   (1) | Train Loss: 0.3411 | Train Acc: 0.9072
 Site-Real                      (3) | Train Loss: 0.3072 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2112 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2147 | Train Acc: 0.9597
 Site-Real                      (3) | Train Loss: 0.2481 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.3970 | Train Acc: 0.8912
 Site-Painting                  (5) | Train Loss: 0.4021 | Train Acc: 0.8835
 Site-Painting                  (5) | Train Loss: 0.3465 | Train Acc: 0.9135
 Site-Sketch                    (4) | Train Loss: 0.4232 | Train Acc: 0.8691
 Site-Sketch                    (4) | Train Loss: 0.4087 | Train Acc: 0.8614
 Site-QuickDraw                 (2) | Train Loss: 0.7958 | Train Acc: 0.8073
 Site-Infograph                 (0) | Train Loss: 0.8586 | Train Acc: 0.7308
Average Train Accuracy: 0.8903
 Site-Clipart                   (1) | Val  Loss: 0.2204 | Val  Acc: 0.9342
 Site-Clipart                   (1) | Val  Loss: 0.2691 | Val  Acc: 0.9346
 Site-Clipart                   (1) | Val  Loss: 0.3376 | Val  Acc: 0.9000
 Site-Clipart                   (1) | Val  Loss: 0.3161 | Val  Acc: 0.9048
 Site-Clipart                   (1) | Val  Loss: 0.4110 | Val  Acc: 0.8847
 Site-Real                      (3) | Val  Loss: 0.2472 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2440 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.1959 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2307 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.2462 | Val  Acc: 0.9694
 Site-Painting                  (5) | Val  Loss: 0.2767 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.3874 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.4157 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.4629 | Val  Acc: 0.8427
 Site-QuickDraw                 (2) | Val  Loss: 0.8105 | Val  Acc: 0.7936
 Site-Infograph                 (0) | Val  Loss: 0.9709 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8940
 Test site-Clipart                   (1)| Epoch:46 | Test Acc: 0.9068
 Test site-Real                      (3)| Epoch:46 | Test Acc: 0.9482
 Test site-Painting                  (5)| Epoch:46 | Test Acc: 0.9305
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8863
 Test site-QuickDraw                 (2)| Epoch:46 | Test Acc: 0.7240
 Test site-Infograph                 (0)| Epoch:46 | Test Acc: 0.5525
Clipart: 0.9068, Real: 0.9482, Painting: 0.9305, Sketch: 0.8863, QuickDraw: 0.7240, Infograph: 0.5525, 
Average Test Accuracy(group): 0.8247, Average Test Accuracy(individual): 0.8855,
domain std=0.1421, cluster std=0.1421, individual std=0.1003, 
Average Test Accuracy: 0.8247
============ Train epoch 48 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.4573 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.2745 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.4081 | Train Acc: 0.8756
 Site-Clipart                   (0) | Train Loss: 0.3692 | Train Acc: 0.8892
 Site-Clipart                   (0) | Train Loss: 0.3303 | Train Acc: 0.9276
 Site-Real                      (4) | Train Loss: 0.3115 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2414 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2309 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2495 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.3300 | Train Acc: 0.9116
 Site-Painting                  (2) | Train Loss: 0.3339 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.3456 | Train Acc: 0.9170
 Site-Sketch                    (5) | Train Loss: 0.4196 | Train Acc: 0.8796
 Site-Sketch                    (5) | Train Loss: 0.4343 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.7060 | Train Acc: 0.7951
 Site-Infograph                 (3) | Train Loss: 0.8826 | Train Acc: 0.7051
Average Train Accuracy: 0.8839
 Site-Clipart                   (0) | Val  Loss: 0.2235 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.2830 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.3143 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.3423 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.4208 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2293 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2313 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2021 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2166 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2786 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3170 | Val  Acc: 0.8978
 Site-Painting                  (2) | Val  Loss: 0.3623 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.3873 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.4536 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7824 | Val  Acc: 0.8028
 Site-Infograph                 (3) | Val  Loss: 0.9988 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8875
 Test site-Clipart                   (0)| Epoch:46 | Test Acc: 0.9011
 Test site-Real                      (4)| Epoch:46 | Test Acc: 0.9474
 Test site-Painting                  (2)| Epoch:46 | Test Acc: 0.9257
 Test site-Sketch                    (5)| Epoch:46 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7290
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5571
Clipart: 0.9011, Real: 0.9474, Painting: 0.9257, Sketch: 0.8917, QuickDraw: 0.7290, Infograph: 0.5571, 
Average Test Accuracy(group): 0.8253, Average Test Accuracy(individual): 0.8839,
domain std=0.1393, cluster std=0.1393, individual std=0.0980, 
Average Test Accuracy: 0.8253
============ Train epoch 49 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[1, 5, 1, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (4) | Train Loss: 0.3693 | Train Acc: 0.8957
 Site-Clipart                   (4) | Train Loss: 0.3019 | Train Acc: 0.9255
 Site-Clipart                   (4) | Train Loss: 0.3902 | Train Acc: 0.8933
 Site-Clipart                   (4) | Train Loss: 0.3475 | Train Acc: 0.8987
 Site-Clipart                   (4) | Train Loss: 0.3386 | Train Acc: 0.9140
 Site-Real                      (0) | Train Loss: 0.3161 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2236 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2236 | Train Acc: 0.9315
 Site-Real                      (0) | Train Loss: 0.2493 | Train Acc: 0.9397
 Site-Painting                  (5) | Train Loss: 0.3818 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.2741 | Train Acc: 0.9223
 Site-Painting                  (5) | Train Loss: 0.3236 | Train Acc: 0.9135
 Site-Sketch                    (2) | Train Loss: 0.4567 | Train Acc: 0.8534
 Site-Sketch                    (2) | Train Loss: 0.4962 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.6899 | Train Acc: 0.8104
 Site-Infograph                 (3) | Train Loss: 0.8303 | Train Acc: 0.7863
Average Train Accuracy: 0.8927
 Site-Clipart                   (4) | Val  Loss: 0.2535 | Val  Acc: 0.9605
 Site-Clipart                   (4) | Val  Loss: 0.3020 | Val  Acc: 0.9252
 Site-Clipart                   (4) | Val  Loss: 0.3592 | Val  Acc: 0.8800
 Site-Clipart                   (4) | Val  Loss: 0.3366 | Val  Acc: 0.9048
 Site-Clipart                   (4) | Val  Loss: 0.4231 | Val  Acc: 0.8814
 Site-Real                      (0) | Val  Loss: 0.2299 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2535 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.2189 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2255 | Val  Acc: 0.9481
 Site-Painting                  (5) | Val  Loss: 0.2284 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2974 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.3103 | Val  Acc: 0.9219
 Site-Sketch                    (2) | Val  Loss: 0.4117 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.4672 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.8255 | Val  Acc: 0.8028
 Site-Infograph                 (3) | Val  Loss: 1.0288 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8954
 Test site-Clipart                   (4)| Epoch:46 | Test Acc: 0.9011
 Test site-Real                      (0)| Epoch:46 | Test Acc: 0.9482
 Test site-Painting                  (5)| Epoch:46 | Test Acc: 0.9305
 Test site-Sketch                    (2)| Epoch:46 | Test Acc: 0.8809
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7330
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5586
Clipart: 0.9011, Real: 0.9482, Painting: 0.9305, Sketch: 0.8809, QuickDraw: 0.7330, Infograph: 0.5586, 
Average Test Accuracy(group): 0.8254, Average Test Accuracy(individual): 0.8840,
domain std=0.1382, cluster std=0.1382, individual std=0.0978, 
Average Test Accuracy: 0.8254
 Test site-Clipart                   (4)| Epoch:46 | Test Acc: 0.9011
 Test site-Real                      (0)| Epoch:46 | Test Acc: 0.9482
 Test site-Painting                  (5)| Epoch:46 | Test Acc: 0.9305
 Test site-Sketch                    (2)| Epoch:46 | Test Acc: 0.8809
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7330
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5586
Clipart: 0.9011, Real: 0.9482, Painting: 0.9305, Sketch: 0.8809, QuickDraw: 0.7330, Infograph: 0.5586, 
Average Test Accuracy(group): 0.8254, Average Test Accuracy(individual): 0.8840,
domain std=0.1382, cluster std=0.1382, individual std=0.0978, 
===2023-06-26 14:10:11===
===2023-06-26 14:10:19===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (4)| Epoch:44 | Test Acc: 0.8992
 Test site-Real                      (0)| Epoch:44 | Test Acc: 0.9466
 Test site-Painting                  (5)| Epoch:44 | Test Acc: 0.9305
 Test site-Sketch                    (2)| Epoch:44 | Test Acc: 0.8899
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.7330
 Test site-Infograph                 (3)| Epoch:44 | Test Acc: 0.5571
Clipart: 0.8992, Real: 0.9466, Painting: 0.9305, Sketch: 0.8899, QuickDraw: 0.7330, Infograph: 0.5571, 
Average Test Accuracy(group): 0.8261, Average Test Accuracy(individual): 0.8840,
domain std=0.1390, cluster std=0.1390, individual std=0.0978, 
===2023-06-26 15:07:58===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 5, 1, 1, 2, 3, ]
cnt=[5, 1, 4, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.1100 | Train Acc: 0.2522
 Site-Clipart                   (1) | Train Loss: 2.0453 | Train Acc: 0.3540
 Site-Clipart                   (1) | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-Clipart                   (1) | Train Loss: 2.0738 | Train Acc: 0.2911
 Site-Clipart                   (1) | Train Loss: 2.1005 | Train Acc: 0.2715
 Site-Real                      (0) | Train Loss: 2.0876 | Train Acc: 0.3571
 Site-Real                      (0) | Train Loss: 2.0787 | Train Acc: 0.3559
 Site-Real                      (0) | Train Loss: 2.0687 | Train Acc: 0.3589
 Site-Real                      (0) | Train Loss: 2.1167 | Train Acc: 0.2816
 Site-Painting                  (5) | Train Loss: 2.1118 | Train Acc: 0.3605
 Site-Painting                  (5) | Train Loss: 2.1080 | Train Acc: 0.3495
 Site-Painting                  (5) | Train Loss: 2.0811 | Train Acc: 0.3149
 Site-Sketch                    (4) | Train Loss: 2.0476 | Train Acc: 0.3508
 Site-Sketch                    (4) | Train Loss: 2.1048 | Train Acc: 0.3558
 Site-QuickDraw                 (2) | Train Loss: 2.3103 | Train Acc: 0.1713
 Site-Infograph                 (3) | Train Loss: 2.2553 | Train Acc: 0.1880
Average Train Accuracy: 0.3067
 Site-Clipart                   (1) | Val  Loss: 2.0400 | Val  Acc: 0.2500
 Site-Clipart                   (1) | Val  Loss: 2.1068 | Val  Acc: 0.2991
 Site-Clipart                   (1) | Val  Loss: 2.0650 | Val  Acc: 0.3333
 Site-Clipart                   (1) | Val  Loss: 2.0566 | Val  Acc: 0.3571
 Site-Clipart                   (1) | Val  Loss: 2.1134 | Val  Acc: 0.2678
 Site-Real                      (0) | Val  Loss: 2.0676 | Val  Acc: 0.3452
 Site-Real                      (0) | Val  Loss: 2.0913 | Val  Acc: 0.3220
 Site-Real                      (0) | Val  Loss: 2.0499 | Val  Acc: 0.4061
 Site-Real                      (0) | Val  Loss: 2.0611 | Val  Acc: 0.3766
 Site-Painting                  (5) | Val  Loss: 2.1028 | Val  Acc: 0.3776
 Site-Painting                  (5) | Val  Loss: 2.0467 | Val  Acc: 0.3650
 Site-Painting                  (5) | Val  Loss: 2.1136 | Val  Acc: 0.3385
 Site-Sketch                    (4) | Val  Loss: 2.0787 | Val  Acc: 0.3622
 Site-Sketch                    (4) | Val  Loss: 2.0737 | Val  Acc: 0.3539
 Site-QuickDraw                 (2) | Val  Loss: 2.3222 | Val  Acc: 0.1881
 Site-Infograph                 (3) | Val  Loss: 2.2939 | Val  Acc: 0.1603
Average Valid Accuracy: 0.3189
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2991
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2678
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3452
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3220
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4061
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3766
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3776
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3650
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3385
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3539
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1881
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.1603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 4, 3, 1, 6, ]
cnt=[5, 4, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (5) | Train Loss: 1.8869 | Train Acc: 0.5043
 Site-Clipart                   (5) | Train Loss: 1.8286 | Train Acc: 0.5155
 Site-Clipart                   (5) | Train Loss: 1.9376 | Train Acc: 0.4844
 Site-Clipart                   (0) | Train Loss: 1.8624 | Train Acc: 0.5222
 Site-Clipart                   (5) | Train Loss: 1.9010 | Train Acc: 0.4932
 Site-Real                      (2) | Train Loss: 1.8422 | Train Acc: 0.5476
 Site-Real                      (2) | Train Loss: 1.7809 | Train Acc: 0.6271
 Site-Real                      (2) | Train Loss: 1.7581 | Train Acc: 0.6452
 Site-Real                      (2) | Train Loss: 1.8398 | Train Acc: 0.5230
 Site-Painting                  (3) | Train Loss: 1.8436 | Train Acc: 0.4898
 Site-Painting                  (3) | Train Loss: 1.8538 | Train Acc: 0.5146
 Site-Painting                  (3) | Train Loss: 1.8387 | Train Acc: 0.5052
 Site-Sketch                    (5) | Train Loss: 1.8491 | Train Acc: 0.5759
 Site-Sketch                    (5) | Train Loss: 1.9012 | Train Acc: 0.4644
 Site-QuickDraw                 (1) | Train Loss: 2.2402 | Train Acc: 0.1560
 Site-Infograph                 (4) | Train Loss: 2.1860 | Train Acc: 0.2350
Average Train Accuracy: 0.4877
 Site-Clipart                   (5) | Val  Loss: 1.7727 | Val  Acc: 0.5000
 Site-Clipart                   (5) | Val  Loss: 1.8841 | Val  Acc: 0.4860
 Site-Clipart                   (5) | Val  Loss: 1.8591 | Val  Acc: 0.5400
 Site-Clipart                   (0) | Val  Loss: 1.8561 | Val  Acc: 0.5095
 Site-Clipart                   (5) | Val  Loss: 1.9269 | Val  Acc: 0.4169
 Site-Real                      (2) | Val  Loss: 1.7600 | Val  Acc: 0.5595
 Site-Real                      (2) | Val  Loss: 1.8026 | Val  Acc: 0.5593
 Site-Real                      (2) | Val  Loss: 1.7590 | Val  Acc: 0.6545
 Site-Real                      (2) | Val  Loss: 1.7776 | Val  Acc: 0.6147
 Site-Painting                  (3) | Val  Loss: 1.8359 | Val  Acc: 0.5612
 Site-Painting                  (3) | Val  Loss: 1.8052 | Val  Acc: 0.5036
 Site-Painting                  (3) | Val  Loss: 1.8596 | Val  Acc: 0.5052
 Site-Sketch                    (5) | Val  Loss: 1.8196 | Val  Acc: 0.5512
 Site-Sketch                    (5) | Val  Loss: 1.8988 | Val  Acc: 0.4663
 Site-QuickDraw                 (1) | Val  Loss: 2.2534 | Val  Acc: 0.1789
 Site-Infograph                 (4) | Val  Loss: 2.1490 | Val  Acc: 0.2179
Average Valid Accuracy: 0.4891
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4860
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.5400
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5095
 Best site-Clipart                  (5)  | Epoch:1 | Val Acc: 0.4169
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5595
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.5593
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6545
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.6147
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5612
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5036
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5052
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5512
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4663
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.1789
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.2179
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 1, 4, 1, 3, 2, ]
cnt=[2, 1, 4, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.6662 | Train Acc: 0.6000
 Site-Clipart                   (0) | Train Loss: 1.5946 | Train Acc: 0.5652
 Site-Clipart                   (0) | Train Loss: 1.7027 | Train Acc: 0.5644
 Site-Clipart                   (0) | Train Loss: 1.6448 | Train Acc: 0.6076
 Site-Clipart                   (0) | Train Loss: 1.6636 | Train Acc: 0.6086
 Site-Real                      (2) | Train Loss: 1.5697 | Train Acc: 0.6984
 Site-Real                      (2) | Train Loss: 1.4702 | Train Acc: 0.7514
 Site-Real                      (2) | Train Loss: 1.4438 | Train Acc: 0.7540
 Site-Real                      (2) | Train Loss: 1.5552 | Train Acc: 0.7270
 Site-Painting                  (4) | Train Loss: 1.5705 | Train Acc: 0.6667
 Site-Painting                  (4) | Train Loss: 1.6033 | Train Acc: 0.6505
 Site-Painting                  (4) | Train Loss: 1.5431 | Train Acc: 0.6990
 Site-Sketch                    (5) | Train Loss: 1.6406 | Train Acc: 0.5812
 Site-Sketch                    (5) | Train Loss: 1.6723 | Train Acc: 0.5918
 Site-QuickDraw                 (1) | Train Loss: 2.2193 | Train Acc: 0.1896
 Site-Infograph                 (3) | Train Loss: 2.0596 | Train Acc: 0.2991
Average Train Accuracy: 0.5972
 Site-Clipart                   (0) | Val  Loss: 1.5469 | Val  Acc: 0.6316
 Site-Clipart                   (0) | Val  Loss: 1.6305 | Val  Acc: 0.6729
 Site-Clipart                   (0) | Val  Loss: 1.6528 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 1.6453 | Val  Acc: 0.6381
 Site-Clipart                   (0) | Val  Loss: 1.7104 | Val  Acc: 0.5831
 Site-Real                      (2) | Val  Loss: 1.4939 | Val  Acc: 0.6548
 Site-Real                      (2) | Val  Loss: 1.4851 | Val  Acc: 0.7627
 Site-Real                      (2) | Val  Loss: 1.3948 | Val  Acc: 0.8061
 Site-Real                      (2) | Val  Loss: 1.4690 | Val  Acc: 0.7879
 Site-Painting                  (4) | Val  Loss: 1.5404 | Val  Acc: 0.7041
 Site-Painting                  (4) | Val  Loss: 1.5354 | Val  Acc: 0.6569
 Site-Painting                  (4) | Val  Loss: 1.5806 | Val  Acc: 0.6406
 Site-Sketch                    (5) | Val  Loss: 1.6457 | Val  Acc: 0.5827
 Site-Sketch                    (5) | Val  Loss: 1.7164 | Val  Acc: 0.5281
 Site-QuickDraw                 (1) | Val  Loss: 2.2310 | Val  Acc: 0.2110
 Site-Infograph                 (3) | Val  Loss: 2.0323 | Val  Acc: 0.3782
Average Valid Accuracy: 0.6191
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6316
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6729
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6381
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5831
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.6548
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7627
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.8061
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.7879
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.7041
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6569
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6406
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5827
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5281
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2110
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.3782
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 3 ============
cnt=[5, 1, 4, 3, 1, 2, ]
cnt=[3, 5, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.4846 | Train Acc: 0.6261
 Site-Clipart                   (0) | Train Loss: 1.3737 | Train Acc: 0.7329
 Site-Clipart                   (0) | Train Loss: 1.5388 | Train Acc: 0.6800
 Site-Clipart                   (0) | Train Loss: 1.4452 | Train Acc: 0.7089
 Site-Clipart                   (0) | Train Loss: 1.4628 | Train Acc: 0.7081
 Site-Real                      (2) | Train Loss: 1.3080 | Train Acc: 0.8254
 Site-Real                      (2) | Train Loss: 1.2199 | Train Acc: 0.8475
 Site-Real                      (2) | Train Loss: 1.2066 | Train Acc: 0.8145
 Site-Real                      (2) | Train Loss: 1.3176 | Train Acc: 0.8075
 Site-Painting                  (3) | Train Loss: 1.4093 | Train Acc: 0.7075
 Site-Painting                  (3) | Train Loss: 1.3960 | Train Acc: 0.7233
 Site-Painting                  (3) | Train Loss: 1.3678 | Train Acc: 0.7405
 Site-Sketch                    (5) | Train Loss: 1.3990 | Train Acc: 0.6911
 Site-Sketch                    (5) | Train Loss: 1.4315 | Train Acc: 0.6554
 Site-QuickDraw                 (1) | Train Loss: 2.1333 | Train Acc: 0.2263
 Site-Infograph                 (4) | Train Loss: 1.9592 | Train Acc: 0.3889
Average Train Accuracy: 0.6802
 Site-Clipart                   (0) | Val  Loss: 1.3600 | Val  Acc: 0.6974
 Site-Clipart                   (0) | Val  Loss: 1.4356 | Val  Acc: 0.7009
 Site-Clipart                   (0) | Val  Loss: 1.4246 | Val  Acc: 0.7133
 Site-Clipart                   (0) | Val  Loss: 1.4003 | Val  Acc: 0.7286
 Site-Clipart                   (0) | Val  Loss: 1.5007 | Val  Acc: 0.6712
 Site-Real                      (2) | Val  Loss: 1.1936 | Val  Acc: 0.7976
 Site-Real                      (2) | Val  Loss: 1.2272 | Val  Acc: 0.8136
 Site-Real                      (2) | Val  Loss: 1.1771 | Val  Acc: 0.8545
 Site-Real                      (2) | Val  Loss: 1.2142 | Val  Acc: 0.8571
 Site-Painting                  (3) | Val  Loss: 1.2823 | Val  Acc: 0.7857
 Site-Painting                  (3) | Val  Loss: 1.3551 | Val  Acc: 0.7299
 Site-Painting                  (3) | Val  Loss: 1.3629 | Val  Acc: 0.7396
 Site-Sketch                    (5) | Val  Loss: 1.3939 | Val  Acc: 0.7323
 Site-Sketch                    (5) | Val  Loss: 1.5212 | Val  Acc: 0.6124
 Site-QuickDraw                 (1) | Val  Loss: 2.1313 | Val  Acc: 0.2661
 Site-Infograph                 (4) | Val  Loss: 1.9062 | Val  Acc: 0.4295
Average Valid Accuracy: 0.6956
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6974
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7009
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7133
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7286
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6712
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.7976
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8136
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8545
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8571
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7857
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7299
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7396
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.7323
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6124
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.2661
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.4295
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 4, 3, 1, 1, 3, ]
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (5) | Train Loss: 1.3147 | Train Acc: 0.7217
 Site-Clipart                   (0) | Train Loss: 1.2224 | Train Acc: 0.7888
 Site-Clipart                   (0) | Train Loss: 1.3519 | Train Acc: 0.7511
 Site-Clipart                   (5) | Train Loss: 1.2539 | Train Acc: 0.7405
 Site-Clipart                   (5) | Train Loss: 1.2944 | Train Acc: 0.7398
 Site-Real                      (1) | Train Loss: 1.1066 | Train Acc: 0.8810
 Site-Real                      (1) | Train Loss: 1.0086 | Train Acc: 0.8644
 Site-Real                      (1) | Train Loss: 0.9738 | Train Acc: 0.8831
 Site-Real                      (1) | Train Loss: 1.1066 | Train Acc: 0.8534
 Site-Painting                  (2) | Train Loss: 1.1620 | Train Acc: 0.7823
 Site-Painting                  (2) | Train Loss: 1.1146 | Train Acc: 0.7670
 Site-Painting                  (2) | Train Loss: 1.1289 | Train Acc: 0.7958
 Site-Sketch                    (0) | Train Loss: 1.2218 | Train Acc: 0.7592
 Site-Sketch                    (0) | Train Loss: 1.2687 | Train Acc: 0.7191
 Site-QuickDraw                 (3) | Train Loss: 2.1041 | Train Acc: 0.2752
 Site-Infograph                 (4) | Train Loss: 1.8444 | Train Acc: 0.4316
Average Train Accuracy: 0.7346
 Site-Clipart                   (5) | Val  Loss: 1.1798 | Val  Acc: 0.7500
 Site-Clipart                   (0) | Val  Loss: 1.2468 | Val  Acc: 0.7850
 Site-Clipart                   (0) | Val  Loss: 1.2528 | Val  Acc: 0.7600
 Site-Clipart                   (5) | Val  Loss: 1.2106 | Val  Acc: 0.7476
 Site-Clipart                   (5) | Val  Loss: 1.3366 | Val  Acc: 0.7220
 Site-Real                      (1) | Val  Loss: 1.0023 | Val  Acc: 0.8452
 Site-Real                      (1) | Val  Loss: 0.9979 | Val  Acc: 0.8729
 Site-Real                      (1) | Val  Loss: 0.9448 | Val  Acc: 0.8727
 Site-Real                      (1) | Val  Loss: 1.0104 | Val  Acc: 0.8788
 Site-Painting                  (2) | Val  Loss: 1.0637 | Val  Acc: 0.8265
 Site-Painting                  (2) | Val  Loss: 1.1577 | Val  Acc: 0.7664
 Site-Painting                  (2) | Val  Loss: 1.1706 | Val  Acc: 0.7604
 Site-Sketch                    (0) | Val  Loss: 1.2834 | Val  Acc: 0.6614
 Site-Sketch                    (0) | Val  Loss: 1.3063 | Val  Acc: 0.6517
 Site-QuickDraw                 (3) | Val  Loss: 2.0800 | Val  Acc: 0.2706
 Site-Infograph                 (4) | Val  Loss: 1.7810 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7287
 Best site-Clipart                  (5)  | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7850
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7600
 Best site-Clipart                  (5)  | Epoch:4 | Val Acc: 0.7476
 Best site-Clipart                  (5)  | Epoch:4 | Val Acc: 0.7220
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8452
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8729
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8727
 Best site-Real                     (1)  | Epoch:4 | Val Acc: 0.8788
 Best site-Painting                 (2)  | Epoch:4 | Val Acc: 0.8265
 Best site-Painting                 (2)  | Epoch:4 | Val Acc: 0.7664
 Best site-Painting                 (2)  | Epoch:4 | Val Acc: 0.7604
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.6614
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.6517
 Best site-QuickDraw                (3)  | Epoch:4 | Val Acc: 0.2706
 Best site-Infograph                (4)  | Epoch:4 | Val Acc: 0.4872
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 4, 4, 2, 3, ]
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 1.1824 | Train Acc: 0.7391
 Site-Clipart                   (3) | Train Loss: 1.0341 | Train Acc: 0.7888
 Site-Clipart                   (3) | Train Loss: 1.1779 | Train Acc: 0.7467
 Site-Clipart                   (0) | Train Loss: 1.0894 | Train Acc: 0.7722
 Site-Clipart                   (3) | Train Loss: 1.1453 | Train Acc: 0.7805
 Site-Real                      (2) | Train Loss: 0.9172 | Train Acc: 0.8651
 Site-Real                      (2) | Train Loss: 0.8598 | Train Acc: 0.8757
 Site-Real                      (2) | Train Loss: 0.8317 | Train Acc: 0.8911
 Site-Real                      (2) | Train Loss: 0.9578 | Train Acc: 0.8678
 Site-Painting                  (5) | Train Loss: 0.9923 | Train Acc: 0.8095
 Site-Painting                  (5) | Train Loss: 1.0457 | Train Acc: 0.7913
 Site-Painting                  (5) | Train Loss: 0.9984 | Train Acc: 0.8097
 Site-Sketch                    (4) | Train Loss: 1.0857 | Train Acc: 0.7435
 Site-Sketch                    (4) | Train Loss: 1.0678 | Train Acc: 0.7154
 Site-QuickDraw                 (1) | Train Loss: 1.9759 | Train Acc: 0.3394
 Site-Infograph                 (0) | Train Loss: 1.7910 | Train Acc: 0.3889
Average Train Accuracy: 0.7453
 Site-Clipart                   (3) | Val  Loss: 0.9792 | Val  Acc: 0.8158
 Site-Clipart                   (3) | Val  Loss: 1.0747 | Val  Acc: 0.8037
 Site-Clipart                   (3) | Val  Loss: 1.0855 | Val  Acc: 0.7600
 Site-Clipart                   (0) | Val  Loss: 1.0585 | Val  Acc: 0.7952
 Site-Clipart                   (3) | Val  Loss: 1.1681 | Val  Acc: 0.7492
 Site-Real                      (2) | Val  Loss: 0.8745 | Val  Acc: 0.8690
 Site-Real                      (2) | Val  Loss: 0.8674 | Val  Acc: 0.8559
 Site-Real                      (2) | Val  Loss: 0.8128 | Val  Acc: 0.9030
 Site-Real                      (2) | Val  Loss: 0.8540 | Val  Acc: 0.9004
 Site-Painting                  (5) | Val  Loss: 0.9615 | Val  Acc: 0.8469
 Site-Painting                  (5) | Val  Loss: 0.9758 | Val  Acc: 0.8029
 Site-Painting                  (5) | Val  Loss: 1.0220 | Val  Acc: 0.7865
 Site-Sketch                    (4) | Val  Loss: 1.0982 | Val  Acc: 0.7480
 Site-Sketch                    (4) | Val  Loss: 1.1452 | Val  Acc: 0.7022
 Site-QuickDraw                 (1) | Val  Loss: 1.9922 | Val  Acc: 0.3440
 Site-Infograph                 (0) | Val  Loss: 1.7068 | Val  Acc: 0.5064
Average Valid Accuracy: 0.7618
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.8158
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.8037
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7600
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7952
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7492
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8690
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8559
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9030
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9004
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8469
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8029
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7865
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7480
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7022
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.3440
 Best site-Infograph                (0)  | Epoch:5 | Val Acc: 0.5064
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 4, 1, 3, 3, 1, ]
cnt=[1, 3, 1, 5, 4, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (4) | Train Loss: 1.0343 | Train Acc: 0.7739
 Site-Clipart                   (1) | Train Loss: 0.8670 | Train Acc: 0.8261
 Site-Clipart                   (1) | Train Loss: 1.0443 | Train Acc: 0.7600
 Site-Clipart                   (4) | Train Loss: 0.9451 | Train Acc: 0.8133
 Site-Clipart                   (4) | Train Loss: 0.9927 | Train Acc: 0.7941
 Site-Real                      (0) | Train Loss: 0.8066 | Train Acc: 0.8889
 Site-Real                      (0) | Train Loss: 0.7522 | Train Acc: 0.9040
 Site-Real                      (0) | Train Loss: 0.7178 | Train Acc: 0.9032
 Site-Real                      (0) | Train Loss: 0.8062 | Train Acc: 0.8994
 Site-Painting                  (3) | Train Loss: 0.9499 | Train Acc: 0.8163
 Site-Painting                  (3) | Train Loss: 0.9489 | Train Acc: 0.8301
 Site-Painting                  (3) | Train Loss: 0.9175 | Train Acc: 0.8097
 Site-Sketch                    (1) | Train Loss: 0.9527 | Train Acc: 0.7696
 Site-Sketch                    (1) | Train Loss: 0.9771 | Train Acc: 0.7678
 Site-QuickDraw                 (2) | Train Loss: 1.8500 | Train Acc: 0.3578
 Site-Infograph                 (5) | Train Loss: 1.6826 | Train Acc: 0.4744
Average Train Accuracy: 0.7743
 Site-Clipart                   (4) | Val  Loss: 0.8637 | Val  Acc: 0.8026
 Site-Clipart                   (1) | Val  Loss: 0.9325 | Val  Acc: 0.8037
 Site-Clipart                   (1) | Val  Loss: 0.9918 | Val  Acc: 0.8000
 Site-Clipart                   (4) | Val  Loss: 0.9122 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 1.0276 | Val  Acc: 0.7695
 Site-Real                      (0) | Val  Loss: 0.7511 | Val  Acc: 0.8810
 Site-Real                      (0) | Val  Loss: 0.7495 | Val  Acc: 0.8814
 Site-Real                      (0) | Val  Loss: 0.7260 | Val  Acc: 0.8727
 Site-Real                      (0) | Val  Loss: 0.7560 | Val  Acc: 0.9048
 Site-Painting                  (3) | Val  Loss: 0.8194 | Val  Acc: 0.8367
 Site-Painting                  (3) | Val  Loss: 0.8772 | Val  Acc: 0.8321
 Site-Painting                  (3) | Val  Loss: 0.8977 | Val  Acc: 0.8177
 Site-Sketch                    (1) | Val  Loss: 1.0006 | Val  Acc: 0.7480
 Site-Sketch                    (1) | Val  Loss: 1.0052 | Val  Acc: 0.7528
 Site-QuickDraw                 (2) | Val  Loss: 1.9001 | Val  Acc: 0.3670
 Site-Infograph                 (5) | Val  Loss: 1.6268 | Val  Acc: 0.4808
Average Valid Accuracy: 0.7740
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.8026
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.8037
 Best site-Clipart                  (1)  | Epoch:6 | Val Acc: 0.8000
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7695
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8810
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8814
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.8727
 Best site-Real                     (0)  | Epoch:6 | Val Acc: 0.9048
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8367
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8321
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8177
 Best site-Sketch                   (1)  | Epoch:6 | Val Acc: 0.7480
 Best site-Sketch                   (1)  | Epoch:6 | Val Acc: 0.7528
 Best site-QuickDraw                (2)  | Epoch:6 | Val Acc: 0.3670
 Best site-Infograph                (5)  | Epoch:6 | Val Acc: 0.4808
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 4, 1, 4, 1, 3, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (3) | Train Loss: 0.8400 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.8125 | Train Acc: 0.8385
 Site-Clipart                   (3) | Train Loss: 0.9128 | Train Acc: 0.8222
 Site-Clipart                   (3) | Train Loss: 0.8812 | Train Acc: 0.8101
 Site-Clipart                   (3) | Train Loss: 0.9244 | Train Acc: 0.7851
 Site-Real                      (1) | Train Loss: 0.7316 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.6570 | Train Acc: 0.9379
 Site-Real                      (1) | Train Loss: 0.6188 | Train Acc: 0.9032
 Site-Real                      (1) | Train Loss: 0.7241 | Train Acc: 0.9167
 Site-Painting                  (5) | Train Loss: 0.8744 | Train Acc: 0.7891
 Site-Painting                  (5) | Train Loss: 0.7995 | Train Acc: 0.8592
 Site-Painting                  (5) | Train Loss: 0.7927 | Train Acc: 0.8374
 Site-Sketch                    (0) | Train Loss: 0.8272 | Train Acc: 0.7906
 Site-Sketch                    (0) | Train Loss: 0.8535 | Train Acc: 0.7603
 Site-QuickDraw                 (2) | Train Loss: 1.7724 | Train Acc: 0.4526
 Site-Infograph                 (4) | Train Loss: 1.5936 | Train Acc: 0.4786
Average Train Accuracy: 0.7951
 Site-Clipart                   (3) | Val  Loss: 0.7843 | Val  Acc: 0.8289
 Site-Clipart                   (0) | Val  Loss: 0.8600 | Val  Acc: 0.8224
 Site-Clipart                   (3) | Val  Loss: 0.9115 | Val  Acc: 0.7933
 Site-Clipart                   (3) | Val  Loss: 0.8499 | Val  Acc: 0.7952
 Site-Clipart                   (3) | Val  Loss: 0.9440 | Val  Acc: 0.7831
 Site-Real                      (1) | Val  Loss: 0.6528 | Val  Acc: 0.9167
 Site-Real                      (1) | Val  Loss: 0.6362 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.6158 | Val  Acc: 0.9030
 Site-Real                      (1) | Val  Loss: 0.6661 | Val  Acc: 0.9048
 Site-Painting                  (5) | Val  Loss: 0.7267 | Val  Acc: 0.8571
 Site-Painting                  (5) | Val  Loss: 0.8072 | Val  Acc: 0.8248
 Site-Painting                  (5) | Val  Loss: 0.8087 | Val  Acc: 0.8229
 Site-Sketch                    (0) | Val  Loss: 0.8633 | Val  Acc: 0.7953
 Site-Sketch                    (0) | Val  Loss: 0.9276 | Val  Acc: 0.7303
 Site-QuickDraw                 (2) | Val  Loss: 1.7961 | Val  Acc: 0.4587
 Site-Infograph                 (4) | Val  Loss: 1.5047 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7929
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8289
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8224
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7933
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7952
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.7831
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9167
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9237
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9030
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9048
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8571
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8248
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8229
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7953
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7303
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.4587
 Best site-Infograph                (4)  | Epoch:7 | Val Acc: 0.5256
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 8 ============
cnt=[4, 4, 1, 3, 3, 1, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 0.8253 | Train Acc: 0.8609
 Site-Clipart                   (4) | Train Loss: 0.7266 | Train Acc: 0.8820
 Site-Clipart                   (0) | Train Loss: 0.8659 | Train Acc: 0.8267
 Site-Clipart                   (0) | Train Loss: 0.7894 | Train Acc: 0.8259
 Site-Clipart                   (0) | Train Loss: 0.8233 | Train Acc: 0.8167
 Site-Real                      (1) | Train Loss: 0.6536 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.5682 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.5643 | Train Acc: 0.9274
 Site-Real                      (1) | Train Loss: 0.6461 | Train Acc: 0.9224
 Site-Painting                  (3) | Train Loss: 0.7985 | Train Acc: 0.8231
 Site-Painting                  (3) | Train Loss: 0.7850 | Train Acc: 0.8350
 Site-Painting                  (3) | Train Loss: 0.7304 | Train Acc: 0.8235
 Site-Sketch                    (4) | Train Loss: 0.7774 | Train Acc: 0.8010
 Site-Sketch                    (4) | Train Loss: 0.8838 | Train Acc: 0.7828
 Site-QuickDraw                 (2) | Train Loss: 1.6107 | Train Acc: 0.5260
 Site-Infograph                 (5) | Train Loss: 1.5451 | Train Acc: 0.5043
Average Train Accuracy: 0.8124
 Site-Clipart                   (0) | Val  Loss: 0.6880 | Val  Acc: 0.8421
 Site-Clipart                   (4) | Val  Loss: 0.7472 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.7850 | Val  Acc: 0.8400
 Site-Clipart                   (0) | Val  Loss: 0.7591 | Val  Acc: 0.8190
 Site-Clipart                   (0) | Val  Loss: 0.8626 | Val  Acc: 0.8203
 Site-Real                      (1) | Val  Loss: 0.5499 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.5813 | Val  Acc: 0.9322
 Site-Real                      (1) | Val  Loss: 0.5672 | Val  Acc: 0.8970
 Site-Real                      (1) | Val  Loss: 0.5828 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.6396 | Val  Acc: 0.8571
 Site-Painting                  (3) | Val  Loss: 0.7056 | Val  Acc: 0.8321
 Site-Painting                  (3) | Val  Loss: 0.7663 | Val  Acc: 0.8438
 Site-Sketch                    (4) | Val  Loss: 0.8323 | Val  Acc: 0.8110
 Site-Sketch                    (4) | Val  Loss: 0.8545 | Val  Acc: 0.7865
 Site-QuickDraw                 (2) | Val  Loss: 1.6666 | Val  Acc: 0.5459
 Site-Infograph                 (5) | Val  Loss: 1.4560 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8213
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8421
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8692
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8400
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8190
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8203
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9322
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.8970
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9394
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8571
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8321
 Best site-Painting                 (3)  | Epoch:8 | Val Acc: 0.8438
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.8110
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.7865
 Best site-QuickDraw                (2)  | Epoch:8 | Val Acc: 0.5459
 Best site-Infograph                (5)  | Epoch:8 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 2, 4, 4, 3, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (2) | Train Loss: 0.7156 | Train Acc: 0.8435
 Site-Clipart                   (5) | Train Loss: 0.6906 | Train Acc: 0.8199
 Site-Clipart                   (2) | Train Loss: 0.8116 | Train Acc: 0.8311
 Site-Clipart                   (4) | Train Loss: 0.7262 | Train Acc: 0.8133
 Site-Clipart                   (2) | Train Loss: 0.7605 | Train Acc: 0.8416
 Site-Real                      (3) | Train Loss: 0.5653 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.4647 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.4668 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.5457 | Train Acc: 0.9310
 Site-Painting                  (4) | Train Loss: 0.6950 | Train Acc: 0.8435
 Site-Painting                  (4) | Train Loss: 0.7195 | Train Acc: 0.8641
 Site-Painting                  (1) | Train Loss: 0.6664 | Train Acc: 0.8408
 Site-Sketch                    (2) | Train Loss: 0.7119 | Train Acc: 0.8272
 Site-Sketch                    (5) | Train Loss: 0.7257 | Train Acc: 0.7903
 Site-QuickDraw                 (0) | Train Loss: 1.4885 | Train Acc: 0.5382
 Site-Infograph                 (1) | Train Loss: 1.5315 | Train Acc: 0.5171
Average Train Accuracy: 0.8186
 Site-Clipart                   (2) | Val  Loss: 0.5905 | Val  Acc: 0.8684
 Site-Clipart                   (5) | Val  Loss: 0.6881 | Val  Acc: 0.8598
 Site-Clipart                   (2) | Val  Loss: 0.7326 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 0.6579 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.8079 | Val  Acc: 0.8136
 Site-Real                      (3) | Val  Loss: 0.4993 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.4710 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.4825 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.5165 | Val  Acc: 0.9307
 Site-Painting                  (4) | Val  Loss: 0.6114 | Val  Acc: 0.8571
 Site-Painting                  (4) | Val  Loss: 0.6772 | Val  Acc: 0.8029
 Site-Painting                  (1) | Val  Loss: 0.6870 | Val  Acc: 0.8438
 Site-Sketch                    (2) | Val  Loss: 0.7552 | Val  Acc: 0.7874
 Site-Sketch                    (5) | Val  Loss: 0.8261 | Val  Acc: 0.7753
 Site-QuickDraw                 (0) | Val  Loss: 1.5578 | Val  Acc: 0.5642
 Site-Infograph                 (1) | Val  Loss: 1.4219 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8240
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8684
 Best site-Clipart                  (5)  | Epoch:9 | Val Acc: 0.8598
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8333
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8524
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8136
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9307
 Best site-Painting                 (4)  | Epoch:9 | Val Acc: 0.8571
 Best site-Painting                 (4)  | Epoch:9 | Val Acc: 0.8029
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8438
 Best site-Sketch                   (2)  | Epoch:9 | Val Acc: 0.7874
 Best site-Sketch                   (5)  | Epoch:9 | Val Acc: 0.7753
 Best site-QuickDraw                (0)  | Epoch:9 | Val Acc: 0.5642
 Best site-Infograph                (1)  | Epoch:9 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:9 | Test Acc: 0.8517
 Test site-Real                      (3)| Epoch:9 | Test Acc: 0.9449
 Test site-Painting                  (4)| Epoch:9 | Test Acc: 0.8772
 Test site-Sketch                    (2)| Epoch:9 | Test Acc: 0.8556
 Test site-QuickDraw                 (0)| Epoch:9 | Test Acc: 0.5910
 Test site-Infograph                 (1)| Epoch:9 | Test Acc: 0.5190
Clipart: 0.8517, Real: 0.9449, Painting: 0.8772, Sketch: 0.8556, QuickDraw: 0.5910, Infograph: 0.5190, 
Average Test Accuracy(group): 0.7733, Average Test Accuracy(individual): 0.8432,
domain std=0.1587, cluster std=0.1193, individual std=0.1157, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 1, 4, 3, 4, 1, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (4) | Train Loss: 0.6752 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.6173 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.7518 | Train Acc: 0.8444
 Site-Clipart                   (4) | Train Loss: 0.6818 | Train Acc: 0.8323
 Site-Clipart                   (3) | Train Loss: 0.7323 | Train Acc: 0.8190
 Site-Real                      (2) | Train Loss: 0.5477 | Train Acc: 0.8730
 Site-Real                      (2) | Train Loss: 0.4592 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.4631 | Train Acc: 0.9194
 Site-Real                      (2) | Train Loss: 0.5065 | Train Acc: 0.9310
 Site-Painting                  (0) | Train Loss: 0.6303 | Train Acc: 0.8435
 Site-Painting                  (0) | Train Loss: 0.6742 | Train Acc: 0.8495
 Site-Painting                  (0) | Train Loss: 0.6545 | Train Acc: 0.8512
 Site-Sketch                    (3) | Train Loss: 0.6963 | Train Acc: 0.8377
 Site-Sketch                    (3) | Train Loss: 0.7245 | Train Acc: 0.7978
 Site-QuickDraw                 (1) | Train Loss: 1.3893 | Train Acc: 0.5841
 Site-Infograph                 (5) | Train Loss: 1.4585 | Train Acc: 0.5513
Average Train Accuracy: 0.8272
 Site-Clipart                   (4) | Val  Loss: 0.5647 | Val  Acc: 0.8553
 Site-Clipart                   (4) | Val  Loss: 0.6804 | Val  Acc: 0.8505
 Site-Clipart                   (4) | Val  Loss: 0.6653 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.6805 | Val  Acc: 0.8000
 Site-Clipart                   (3) | Val  Loss: 0.7361 | Val  Acc: 0.8271
 Site-Real                      (2) | Val  Loss: 0.4556 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.4614 | Val  Acc: 0.9237
 Site-Real                      (2) | Val  Loss: 0.4178 | Val  Acc: 0.9576
 Site-Real                      (2) | Val  Loss: 0.4844 | Val  Acc: 0.9264
 Site-Painting                  (0) | Val  Loss: 0.5146 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.6423 | Val  Acc: 0.8394
 Site-Painting                  (0) | Val  Loss: 0.6221 | Val  Acc: 0.8594
 Site-Sketch                    (3) | Val  Loss: 0.6797 | Val  Acc: 0.8425
 Site-Sketch                    (3) | Val  Loss: 0.7278 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.5038 | Val  Acc: 0.5963
 Site-Infograph                 (5) | Val  Loss: 1.3553 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8347
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8553
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8505
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:10 | Val Acc: 0.8000
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8271
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9405
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9237
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9576
 Best site-Real                     (2)  | Epoch:10 | Val Acc: 0.9264
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.9082
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8394
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8594
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8425
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.7978
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.5963
 Best site-Infograph                (5)  | Epoch:10 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 1, 3, 4, 1, 5, ]
cnt=[1, 4, 7, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (5) | Train Loss: 0.6676 | Train Acc: 0.8348
 Site-Clipart                   (5) | Train Loss: 0.5477 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.6970 | Train Acc: 0.8267
 Site-Clipart                   (0) | Train Loss: 0.6179 | Train Acc: 0.8481
 Site-Clipart                   (0) | Train Loss: 0.6826 | Train Acc: 0.8235
 Site-Real                      (3) | Train Loss: 0.5146 | Train Acc: 0.8810
 Site-Real                      (3) | Train Loss: 0.4365 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.4241 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.4654 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.6198 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.6056 | Train Acc: 0.8592
 Site-Painting                  (2) | Train Loss: 0.6304 | Train Acc: 0.8547
 Site-Sketch                    (5) | Train Loss: 0.6466 | Train Acc: 0.8220
 Site-Sketch                    (5) | Train Loss: 0.6873 | Train Acc: 0.8165
 Site-QuickDraw                 (1) | Train Loss: 1.4864 | Train Acc: 0.6024
 Site-Infograph                 (4) | Train Loss: 1.3933 | Train Acc: 0.5342
Average Train Accuracy: 0.8280
 Site-Clipart                   (5) | Val  Loss: 0.5814 | Val  Acc: 0.8026
 Site-Clipart                   (5) | Val  Loss: 0.6036 | Val  Acc: 0.8692
 Site-Clipart                   (5) | Val  Loss: 0.6277 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.6285 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.6935 | Val  Acc: 0.8237
 Site-Real                      (3) | Val  Loss: 0.4425 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.4300 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.4450 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.4664 | Val  Acc: 0.9177
 Site-Painting                  (2) | Val  Loss: 0.5608 | Val  Acc: 0.8571
 Site-Painting                  (2) | Val  Loss: 0.5929 | Val  Acc: 0.8540
 Site-Painting                  (2) | Val  Loss: 0.6462 | Val  Acc: 0.8490
 Site-Sketch                    (5) | Val  Loss: 0.6331 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.7521 | Val  Acc: 0.7753
 Site-QuickDraw                 (1) | Val  Loss: 1.4316 | Val  Acc: 0.6147
 Site-Infograph                 (4) | Val  Loss: 1.3284 | Val  Acc: 0.5769
Average Valid Accuracy: 0.8290
============ Train epoch 12 ============
cnt=[2, 4, 1, 4, 3, 2, ]
cnt=[1, 5, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (4) | Train Loss: 0.6196 | Train Acc: 0.8435
 Site-Clipart                   (4) | Train Loss: 0.5129 | Train Acc: 0.9006
 Site-Clipart                   (4) | Train Loss: 0.6572 | Train Acc: 0.8444
 Site-Clipart                   (5) | Train Loss: 0.6058 | Train Acc: 0.8354
 Site-Clipart                   (5) | Train Loss: 0.6281 | Train Acc: 0.8439
 Site-Real                      (1) | Train Loss: 0.4923 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.3888 | Train Acc: 0.9548
 Site-Real                      (1) | Train Loss: 0.4067 | Train Acc: 0.9395
 Site-Real                      (1) | Train Loss: 0.4629 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.7301 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.6328 | Train Acc: 0.8495
 Site-Painting                  (3) | Train Loss: 0.5752 | Train Acc: 0.8547
 Site-Sketch                    (0) | Train Loss: 0.6059 | Train Acc: 0.8325
 Site-Sketch                    (0) | Train Loss: 0.6694 | Train Acc: 0.8090
 Site-QuickDraw                 (2) | Train Loss: 1.2183 | Train Acc: 0.6177
 Site-Infograph                 (3) | Train Loss: 1.4157 | Train Acc: 0.5470
Average Train Accuracy: 0.8374
 Site-Clipart                   (4) | Val  Loss: 0.5020 | Val  Acc: 0.8553
 Site-Clipart                   (4) | Val  Loss: 0.5800 | Val  Acc: 0.8692
 Site-Clipart                   (4) | Val  Loss: 0.6066 | Val  Acc: 0.8400
 Site-Clipart                   (5) | Val  Loss: 0.5832 | Val  Acc: 0.8476
 Site-Clipart                   (5) | Val  Loss: 0.6840 | Val  Acc: 0.8169
 Site-Real                      (1) | Val  Loss: 0.3809 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.3841 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.3785 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.4182 | Val  Acc: 0.9351
 Site-Painting                  (3) | Val  Loss: 0.5105 | Val  Acc: 0.8980
 Site-Painting                  (3) | Val  Loss: 0.5431 | Val  Acc: 0.8467
 Site-Painting                  (3) | Val  Loss: 0.5826 | Val  Acc: 0.8542
 Site-Sketch                    (0) | Val  Loss: 0.6396 | Val  Acc: 0.8425
 Site-Sketch                    (0) | Val  Loss: 0.7153 | Val  Acc: 0.7865
 Site-QuickDraw                 (2) | Val  Loss: 1.3368 | Val  Acc: 0.6330
 Site-Infograph                 (3) | Val  Loss: 1.3498 | Val  Acc: 0.6026
Average Valid Accuracy: 0.8414
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8553
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8692
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8400
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8476
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8169
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9492
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9333
 Best site-Real                     (1)  | Epoch:12 | Val Acc: 0.9351
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8980
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8467
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8542
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8425
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.7865
 Best site-QuickDraw                (2)  | Epoch:12 | Val Acc: 0.6330
 Best site-Infograph                (3)  | Epoch:12 | Val Acc: 0.6026
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 1, 4, 4, 3, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (4) | Train Loss: 0.6038 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.5468 | Train Acc: 0.8758
 Site-Clipart                   (2) | Train Loss: 0.6386 | Train Acc: 0.8267
 Site-Clipart                   (4) | Train Loss: 0.5957 | Train Acc: 0.8481
 Site-Clipart                   (4) | Train Loss: 0.6364 | Train Acc: 0.8439
 Site-Real                      (3) | Train Loss: 0.4692 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.3483 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3589 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.4208 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.5555 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.5456 | Train Acc: 0.8883
 Site-Painting                  (0) | Train Loss: 0.5416 | Train Acc: 0.8616
 Site-Sketch                    (2) | Train Loss: 0.5970 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.6301 | Train Acc: 0.8165
 Site-QuickDraw                 (1) | Train Loss: 1.3056 | Train Acc: 0.6422
 Site-Infograph                 (5) | Train Loss: 1.3464 | Train Acc: 0.5427
Average Train Accuracy: 0.8394
 Site-Clipart                   (4) | Val  Loss: 0.4383 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.5683 | Val  Acc: 0.8785
 Site-Clipart                   (2) | Val  Loss: 0.6243 | Val  Acc: 0.8400
 Site-Clipart                   (4) | Val  Loss: 0.5813 | Val  Acc: 0.8286
 Site-Clipart                   (4) | Val  Loss: 0.6445 | Val  Acc: 0.8339
 Site-Real                      (3) | Val  Loss: 0.3680 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3554 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.3859 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.4058 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.4200 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.4895 | Val  Acc: 0.8613
 Site-Painting                  (0) | Val  Loss: 0.5028 | Val  Acc: 0.8854
 Site-Sketch                    (2) | Val  Loss: 0.5820 | Val  Acc: 0.8268
 Site-Sketch                    (2) | Val  Loss: 0.6769 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.2906 | Val  Acc: 0.6284
 Site-Infograph                 (5) | Val  Loss: 1.2567 | Val  Acc: 0.5962
Average Valid Accuracy: 0.8466
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8816
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8785
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8400
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8286
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8339
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9237
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9333
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9437
 Best site-Painting                 (5)  | Epoch:13 | Val Acc: 0.9286
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8613
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8854
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8268
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.6284
 Best site-Infograph                (5)  | Epoch:13 | Val Acc: 0.5962
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 14 ============
cnt=[5, 1, 4, 3, 1, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (0) | Train Loss: 0.5575 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.4879 | Train Acc: 0.8758
 Site-Clipart                   (0) | Train Loss: 0.5879 | Train Acc: 0.8667
 Site-Clipart                   (0) | Train Loss: 0.5665 | Train Acc: 0.8544
 Site-Clipart                   (0) | Train Loss: 0.5693 | Train Acc: 0.8620
 Site-Real                      (2) | Train Loss: 0.4348 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.3447 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.3514 | Train Acc: 0.9516
 Site-Real                      (2) | Train Loss: 0.4129 | Train Acc: 0.9282
 Site-Painting                  (3) | Train Loss: 0.5382 | Train Acc: 0.8231
 Site-Painting                  (3) | Train Loss: 0.6020 | Train Acc: 0.8544
 Site-Painting                  (3) | Train Loss: 0.5330 | Train Acc: 0.8685
 Site-Sketch                    (5) | Train Loss: 0.5688 | Train Acc: 0.8429
 Site-Sketch                    (5) | Train Loss: 0.7207 | Train Acc: 0.8127
 Site-QuickDraw                 (1) | Train Loss: 1.1579 | Train Acc: 0.6453
 Site-Infograph                 (4) | Train Loss: 1.3334 | Train Acc: 0.5598
Average Train Accuracy: 0.8411
 Site-Clipart                   (0) | Val  Loss: 0.4401 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.5290 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.5282 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.5435 | Val  Acc: 0.8476
 Site-Clipart                   (0) | Val  Loss: 0.6212 | Val  Acc: 0.8373
 Site-Real                      (2) | Val  Loss: 0.3675 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.3639 | Val  Acc: 0.9068
 Site-Real                      (2) | Val  Loss: 0.3970 | Val  Acc: 0.9091
 Site-Real                      (2) | Val  Loss: 0.3723 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.4346 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.5244 | Val  Acc: 0.8613
 Site-Painting                  (3) | Val  Loss: 0.5379 | Val  Acc: 0.8594
 Site-Sketch                    (5) | Val  Loss: 0.5986 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.7250 | Val  Acc: 0.7753
 Site-QuickDraw                 (1) | Val  Loss: 1.1795 | Val  Acc: 0.7018
 Site-Infograph                 (4) | Val  Loss: 1.2217 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8524
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.9211
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8785
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8733
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8476
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8373
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9068
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9091
 Best site-Real                     (2)  | Epoch:14 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.9082
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.8613
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.8594
 Best site-Sketch                   (5)  | Epoch:14 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:14 | Val Acc: 0.7753
 Best site-QuickDraw                (1)  | Epoch:14 | Val Acc: 0.7018
 Best site-Infograph                (4)  | Epoch:14 | Val Acc: 0.6154
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 3, 4, 4, 2, 2, ]
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (1) | Train Loss: 0.5816 | Train Acc: 0.8522
 Site-Clipart                   (5) | Train Loss: 0.4401 | Train Acc: 0.9193
 Site-Clipart                   (5) | Train Loss: 0.5871 | Train Acc: 0.8533
 Site-Clipart                   (1) | Train Loss: 0.5136 | Train Acc: 0.8766
 Site-Clipart                   (1) | Train Loss: 0.5461 | Train Acc: 0.8688
 Site-Real                      (3) | Train Loss: 0.4317 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.3200 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.3315 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3657 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.5158 | Train Acc: 0.8503
 Site-Painting                  (2) | Train Loss: 0.4692 | Train Acc: 0.8447
 Site-Painting                  (2) | Train Loss: 0.4897 | Train Acc: 0.8824
 Site-Sketch                    (4) | Train Loss: 0.5829 | Train Acc: 0.8429
 Site-Sketch                    (4) | Train Loss: 0.6045 | Train Acc: 0.8577
 Site-QuickDraw                 (0) | Train Loss: 1.0623 | Train Acc: 0.6728
 Site-Infograph                 (2) | Train Loss: 1.2835 | Train Acc: 0.5769
Average Train Accuracy: 0.8525
 Site-Clipart                   (1) | Val  Loss: 0.4014 | Val  Acc: 0.9211
 Site-Clipart                   (5) | Val  Loss: 0.4901 | Val  Acc: 0.8692
 Site-Clipart                   (5) | Val  Loss: 0.5040 | Val  Acc: 0.8800
 Site-Clipart                   (1) | Val  Loss: 0.5161 | Val  Acc: 0.8619
 Site-Clipart                   (1) | Val  Loss: 0.6057 | Val  Acc: 0.8136
 Site-Real                      (3) | Val  Loss: 0.3304 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3500 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.3430 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3417 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.3985 | Val  Acc: 0.9082
 Site-Painting                  (2) | Val  Loss: 0.4647 | Val  Acc: 0.8686
 Site-Painting                  (2) | Val  Loss: 0.4934 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.5699 | Val  Acc: 0.8189
 Site-Sketch                    (4) | Val  Loss: 0.6006 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 1.2037 | Val  Acc: 0.6789
 Site-Infograph                 (2) | Val  Loss: 1.1746 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8578
 Best site-Clipart                  (1)  | Epoch:15 | Val Acc: 0.9211
 Best site-Clipart                  (5)  | Epoch:15 | Val Acc: 0.8692
 Best site-Clipart                  (5)  | Epoch:15 | Val Acc: 0.8800
 Best site-Clipart                  (1)  | Epoch:15 | Val Acc: 0.8619
 Best site-Clipart                  (1)  | Epoch:15 | Val Acc: 0.8136
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9481
 Best site-Painting                 (2)  | Epoch:15 | Val Acc: 0.9082
 Best site-Painting                 (2)  | Epoch:15 | Val Acc: 0.8686
 Best site-Painting                 (2)  | Epoch:15 | Val Acc: 0.8698
 Best site-Sketch                   (4)  | Epoch:15 | Val Acc: 0.8189
 Best site-Sketch                   (4)  | Epoch:15 | Val Acc: 0.8202
 Best site-QuickDraw                (0)  | Epoch:15 | Val Acc: 0.6789
 Best site-Infograph                (2)  | Epoch:15 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 1, 5, 4, 1, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (2) | Train Loss: 0.5868 | Train Acc: 0.8348
 Site-Clipart                   (2) | Train Loss: 0.4226 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.5953 | Train Acc: 0.8489
 Site-Clipart                   (2) | Train Loss: 0.5153 | Train Acc: 0.8703
 Site-Clipart                   (2) | Train Loss: 0.5161 | Train Acc: 0.8665
 Site-Real                      (3) | Train Loss: 0.4238 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.3225 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.3108 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3653 | Train Acc: 0.9339
 Site-Painting                  (0) | Train Loss: 0.5453 | Train Acc: 0.8639
 Site-Painting                  (0) | Train Loss: 0.5514 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.5124 | Train Acc: 0.8720
 Site-Sketch                    (5) | Train Loss: 0.5734 | Train Acc: 0.8272
 Site-Sketch                    (5) | Train Loss: 0.6601 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 1.0663 | Train Acc: 0.7217
 Site-Infograph                 (4) | Train Loss: 1.3128 | Train Acc: 0.5855
Average Train Accuracy: 0.8532
 Site-Clipart                   (2) | Val  Loss: 0.4296 | Val  Acc: 0.8684
 Site-Clipart                   (2) | Val  Loss: 0.4712 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.5158 | Val  Acc: 0.8733
 Site-Clipart                   (2) | Val  Loss: 0.5100 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.6001 | Val  Acc: 0.8407
 Site-Real                      (3) | Val  Loss: 0.3146 | Val  Acc: 0.9167
 Site-Real                      (3) | Val  Loss: 0.2966 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.3419 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.3282 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.3607 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.4372 | Val  Acc: 0.8905
 Site-Painting                  (0) | Val  Loss: 0.4928 | Val  Acc: 0.8698
 Site-Sketch                    (5) | Val  Loss: 0.5420 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6300 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.1232 | Val  Acc: 0.6881
 Site-Infograph                 (4) | Val  Loss: 1.1866 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8563
============ Train epoch 17 ============
cnt=[4, 1, 3, 4, 2, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (4) | Train Loss: 0.4895 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.4068 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.5481 | Train Acc: 0.8578
 Site-Clipart                   (4) | Train Loss: 0.4786 | Train Acc: 0.8797
 Site-Clipart                   (2) | Train Loss: 0.5187 | Train Acc: 0.8801
 Site-Real                      (3) | Train Loss: 0.4028 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2927 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2961 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3283 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4920 | Train Acc: 0.8639
 Site-Painting                  (0) | Train Loss: 0.4491 | Train Acc: 0.8641
 Site-Painting                  (0) | Train Loss: 0.4342 | Train Acc: 0.8997
 Site-Sketch                    (5) | Train Loss: 0.5415 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.5239 | Train Acc: 0.8240
 Site-QuickDraw                 (1) | Train Loss: 1.0335 | Train Acc: 0.7095
 Site-Infograph                 (0) | Train Loss: 1.2654 | Train Acc: 0.5812
Average Train Accuracy: 0.8577
 Site-Clipart                   (4) | Val  Loss: 0.3940 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.4438 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.4787 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.5153 | Val  Acc: 0.8429
 Site-Clipart                   (2) | Val  Loss: 0.6090 | Val  Acc: 0.8102
 Site-Real                      (3) | Val  Loss: 0.3056 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3252 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.2952 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.3170 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.3456 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.4390 | Val  Acc: 0.8467
 Site-Painting                  (0) | Val  Loss: 0.4512 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.5412 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.6184 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 1.1257 | Val  Acc: 0.6514
 Site-Infograph                 (0) | Val  Loss: 1.2122 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8559
============ Train epoch 18 ============
cnt=[4, 1, 1, 4, 5, 1, ]
cnt=[1, 4, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (4) | Train Loss: 0.5084 | Train Acc: 0.8522
 Site-Clipart                   (4) | Train Loss: 0.3917 | Train Acc: 0.9068
 Site-Clipart                   (4) | Train Loss: 0.5679 | Train Acc: 0.8311
 Site-Clipart                   (4) | Train Loss: 0.4725 | Train Acc: 0.8734
 Site-Clipart                   (5) | Train Loss: 0.4984 | Train Acc: 0.8756
 Site-Real                      (3) | Train Loss: 0.3964 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2813 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2731 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3189 | Train Acc: 0.9454
 Site-Painting                  (0) | Train Loss: 0.4447 | Train Acc: 0.9048
 Site-Painting                  (0) | Train Loss: 0.4333 | Train Acc: 0.8738
 Site-Painting                  (0) | Train Loss: 0.4189 | Train Acc: 0.8858
 Site-Sketch                    (4) | Train Loss: 0.5809 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.4805 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.9743 | Train Acc: 0.7156
 Site-Infograph                 (0) | Train Loss: 1.2399 | Train Acc: 0.5983
Average Train Accuracy: 0.8587
 Site-Clipart                   (4) | Val  Loss: 0.3765 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.4389 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.5227 | Val  Acc: 0.8400
 Site-Clipart                   (4) | Val  Loss: 0.5165 | Val  Acc: 0.8333
 Site-Clipart                   (5) | Val  Loss: 0.5370 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2916 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2869 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.3038 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.2977 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.3512 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.4504 | Val  Acc: 0.8905
 Site-Painting                  (0) | Val  Loss: 0.4366 | Val  Acc: 0.8854
 Site-Sketch                    (4) | Val  Loss: 0.4619 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.6003 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.0457 | Val  Acc: 0.7431
 Site-Infograph                 (0) | Val  Loss: 1.1725 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8610
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8684
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8879
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8400
 Best site-Clipart                  (4)  | Epoch:18 | Val Acc: 0.8333
 Best site-Clipart                  (5)  | Epoch:18 | Val Acc: 0.8610
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9212
 Best site-Real                     (3)  | Epoch:18 | Val Acc: 0.9481
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.9082
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8905
 Best site-Painting                 (0)  | Epoch:18 | Val Acc: 0.8854
 Best site-Sketch                   (4)  | Epoch:18 | Val Acc: 0.8819
 Best site-Sketch                   (2)  | Epoch:18 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:18 | Val Acc: 0.7431
 Best site-Infograph                (0)  | Epoch:18 | Val Acc: 0.6218
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 19 ============
cnt=[1, 1, 4, 5, 3, 2, ]
cnt=[2, 3, 1, 4, 5, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (2) | Train Loss: 0.5117 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.4051 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.5349 | Train Acc: 0.8578
 Site-Clipart                   (3) | Train Loss: 0.4856 | Train Acc: 0.8639
 Site-Clipart                   (2) | Train Loss: 0.4774 | Train Acc: 0.8869
 Site-Real                      (3) | Train Loss: 0.3962 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2533 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2839 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.3064 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.5536 | Train Acc: 0.8776
 Site-Painting                  (4) | Train Loss: 0.4904 | Train Acc: 0.8786
 Site-Painting                  (4) | Train Loss: 0.4148 | Train Acc: 0.9031
 Site-Sketch                    (5) | Train Loss: 0.5097 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.5477 | Train Acc: 0.8165
 Site-QuickDraw                 (1) | Train Loss: 0.9942 | Train Acc: 0.7370
 Site-Infograph                 (0) | Train Loss: 1.2171 | Train Acc: 0.6068
Average Train Accuracy: 0.8627
 Site-Clipart                   (2) | Val  Loss: 0.3909 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.4498 | Val  Acc: 0.8879
 Site-Clipart                   (2) | Val  Loss: 0.4766 | Val  Acc: 0.8800
 Site-Clipart                   (3) | Val  Loss: 0.4997 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.5678 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.2709 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3281 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2944 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.2791 | Val  Acc: 0.9567
 Site-Painting                  (4) | Val  Loss: 0.3431 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.4215 | Val  Acc: 0.9051
 Site-Painting                  (4) | Val  Loss: 0.4228 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.5534 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6326 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.0675 | Val  Acc: 0.7202
 Site-Infograph                 (0) | Val  Loss: 1.1547 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8693
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8947
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8879
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8800
 Best site-Clipart                  (3)  | Epoch:19 | Val Acc: 0.8667
 Best site-Clipart                  (2)  | Epoch:19 | Val Acc: 0.8542
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9273
 Best site-Real                     (3)  | Epoch:19 | Val Acc: 0.9567
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.9286
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.9051
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.9062
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:19 | Val Acc: 0.7202
 Best site-Infograph                (0)  | Epoch:19 | Val Acc: 0.6538
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:19 | Test Acc: 0.8612
 Test site-Real                      (3)| Epoch:19 | Test Acc: 0.9417
 Test site-Painting                  (4)| Epoch:19 | Test Acc: 0.9257
 Test site-Sketch                    (5)| Epoch:19 | Test Acc: 0.8646
 Test site-QuickDraw                 (1)| Epoch:19 | Test Acc: 0.6990
 Test site-Infograph                 (0)| Epoch:19 | Test Acc: 0.5586
Clipart: 0.8612, Real: 0.9417, Painting: 0.9257, Sketch: 0.8646, QuickDraw: 0.6990, Infograph: 0.5586, 
Average Test Accuracy(group): 0.8085, Average Test Accuracy(individual): 0.8648,
domain std=0.1365, cluster std=0.1340, individual std=0.0988, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 1, 4, 1, 3, 3, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (4) | Train Loss: 0.4911 | Train Acc: 0.8870
 Site-Clipart                   (4) | Train Loss: 0.4319 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.5149 | Train Acc: 0.8400
 Site-Clipart                   (4) | Train Loss: 0.4905 | Train Acc: 0.8544
 Site-Clipart                   (2) | Train Loss: 0.4962 | Train Acc: 0.8914
 Site-Real                      (0) | Train Loss: 0.3746 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2558 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2903 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.3313 | Train Acc: 0.9310
 Site-Painting                  (5) | Train Loss: 0.5066 | Train Acc: 0.8844
 Site-Painting                  (5) | Train Loss: 0.4522 | Train Acc: 0.8786
 Site-Painting                  (5) | Train Loss: 0.4318 | Train Acc: 0.8927
 Site-Sketch                    (2) | Train Loss: 0.5209 | Train Acc: 0.8429
 Site-Sketch                    (2) | Train Loss: 0.6322 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 1.0387 | Train Acc: 0.7554
 Site-Infograph                 (3) | Train Loss: 1.1800 | Train Acc: 0.6239
Average Train Accuracy: 0.8651
 Site-Clipart                   (4) | Val  Loss: 0.3678 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.4741 | Val  Acc: 0.8598
 Site-Clipart                   (2) | Val  Loss: 0.4940 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4498 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.5483 | Val  Acc: 0.8475
 Site-Real                      (0) | Val  Loss: 0.2786 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2983 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2984 | Val  Acc: 0.9212
 Site-Real                      (0) | Val  Loss: 0.3095 | Val  Acc: 0.9307
 Site-Painting                  (5) | Val  Loss: 0.3467 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.4323 | Val  Acc: 0.8978
 Site-Painting                  (5) | Val  Loss: 0.4462 | Val  Acc: 0.8854
 Site-Sketch                    (2) | Val  Loss: 0.4979 | Val  Acc: 0.8504
 Site-Sketch                    (2) | Val  Loss: 0.5700 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.0119 | Val  Acc: 0.7385
 Site-Infograph                 (3) | Val  Loss: 1.1076 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8655
============ Train epoch 21 ============
cnt=[6, 1, 3, 4, 1, 1, ]
cnt=[2, 5, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.4891 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.4283 | Train Acc: 0.8882
 Site-Clipart                   (0) | Train Loss: 0.5710 | Train Acc: 0.8533
 Site-Clipart                   (0) | Train Loss: 0.4400 | Train Acc: 0.8892
 Site-Clipart                   (0) | Train Loss: 0.4661 | Train Acc: 0.8846
 Site-Real                      (3) | Train Loss: 0.3788 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.2568 | Train Acc: 0.9718
 Site-Real                      (3) | Train Loss: 0.2937 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.3329 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.5342 | Train Acc: 0.8639
 Site-Painting                  (2) | Train Loss: 0.4960 | Train Acc: 0.8835
 Site-Painting                  (2) | Train Loss: 0.4203 | Train Acc: 0.8927
 Site-Sketch                    (4) | Train Loss: 0.5263 | Train Acc: 0.8168
 Site-Sketch                    (0) | Train Loss: 0.5889 | Train Acc: 0.8240
 Site-QuickDraw                 (1) | Train Loss: 0.9563 | Train Acc: 0.7064
 Site-Infograph                 (5) | Train Loss: 1.2283 | Train Acc: 0.5855
Average Train Accuracy: 0.8550
 Site-Clipart                   (0) | Val  Loss: 0.3715 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.4058 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.4491 | Val  Acc: 0.8600
 Site-Clipart                   (0) | Val  Loss: 0.4791 | Val  Acc: 0.8619
 Site-Clipart                   (0) | Val  Loss: 0.5306 | Val  Acc: 0.8508
 Site-Real                      (3) | Val  Loss: 0.2843 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2771 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2849 | Val  Acc: 0.9212
 Site-Real                      (3) | Val  Loss: 0.3027 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.3239 | Val  Acc: 0.9082
 Site-Painting                  (2) | Val  Loss: 0.4293 | Val  Acc: 0.8905
 Site-Painting                  (2) | Val  Loss: 0.4110 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.5104 | Val  Acc: 0.8583
 Site-Sketch                    (0) | Val  Loss: 0.5894 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 1.0320 | Val  Acc: 0.7294
 Site-Infograph                 (5) | Val  Loss: 1.1203 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8664
============ Train epoch 22 ============
cnt=[4, 1, 3, 4, 3, 1, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.4819 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.3739 | Train Acc: 0.8882
 Site-Clipart                   (4) | Train Loss: 0.5409 | Train Acc: 0.8400
 Site-Clipart                   (0) | Train Loss: 0.4616 | Train Acc: 0.8671
 Site-Clipart                   (0) | Train Loss: 0.4622 | Train Acc: 0.8846
 Site-Real                      (3) | Train Loss: 0.3660 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2480 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2848 | Train Acc: 0.9355
 Site-Real                      (3) | Train Loss: 0.3244 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.4520 | Train Acc: 0.8912
 Site-Painting                  (2) | Train Loss: 0.4595 | Train Acc: 0.8641
 Site-Painting                  (2) | Train Loss: 0.4024 | Train Acc: 0.9135
 Site-Sketch                    (4) | Train Loss: 0.4795 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.4966 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.9771 | Train Acc: 0.7248
 Site-Infograph                 (5) | Train Loss: 1.1564 | Train Acc: 0.6197
Average Train Accuracy: 0.8650
 Site-Clipart                   (0) | Val  Loss: 0.3221 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.4085 | Val  Acc: 0.8972
 Site-Clipart                   (4) | Val  Loss: 0.4079 | Val  Acc: 0.9200
 Site-Clipart                   (0) | Val  Loss: 0.4655 | Val  Acc: 0.8524
 Site-Clipart                   (0) | Val  Loss: 0.5347 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2737 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2753 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2826 | Val  Acc: 0.9091
 Site-Real                      (3) | Val  Loss: 0.2717 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.3028 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3833 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.4377 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.5015 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.5485 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.9788 | Val  Acc: 0.7064
 Site-Infograph                 (5) | Val  Loss: 1.0655 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8725
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8972
 Best site-Clipart                  (4)  | Epoch:22 | Val Acc: 0.9200
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8524
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8610
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9091
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9610
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9286
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9124
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.8698
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8504
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:22 | Val Acc: 0.7064
 Best site-Infograph                (5)  | Epoch:22 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 23 ============
cnt=[4, 1, 5, 3, 1, 2, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (5) | Train Loss: 0.4494 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.3703 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.4946 | Train Acc: 0.8622
 Site-Clipart                   (2) | Train Loss: 0.4431 | Train Acc: 0.8766
 Site-Clipart                   (2) | Train Loss: 0.4881 | Train Acc: 0.8643
 Site-Real                      (0) | Train Loss: 0.3664 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2404 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2634 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2891 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.4655 | Train Acc: 0.8639
 Site-Painting                  (3) | Train Loss: 0.4002 | Train Acc: 0.8786
 Site-Painting                  (3) | Train Loss: 0.3653 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.5249 | Train Acc: 0.8429
 Site-Sketch                    (2) | Train Loss: 0.5775 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.9067 | Train Acc: 0.7462
 Site-Infograph                 (4) | Train Loss: 1.1693 | Train Acc: 0.6154
Average Train Accuracy: 0.8679
 Site-Clipart                   (5) | Val  Loss: 0.3128 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.3892 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.4063 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.4288 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.5246 | Val  Acc: 0.8339
 Site-Real                      (0) | Val  Loss: 0.2305 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.2647 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2359 | Val  Acc: 0.9515
 Site-Real                      (0) | Val  Loss: 0.2576 | Val  Acc: 0.9654
 Site-Painting                  (3) | Val  Loss: 0.3286 | Val  Acc: 0.9388
 Site-Painting                  (3) | Val  Loss: 0.3852 | Val  Acc: 0.8978
 Site-Painting                  (3) | Val  Loss: 0.4099 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4738 | Val  Acc: 0.8661
 Site-Sketch                    (2) | Val  Loss: 0.5072 | Val  Acc: 0.8652
 Site-QuickDraw                 (1) | Val  Loss: 0.9601 | Val  Acc: 0.7569
 Site-Infograph                 (4) | Val  Loss: 1.1022 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8808
 Best site-Clipart                  (5)  | Epoch:23 | Val Acc: 0.8947
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8933
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8810
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8339
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9515
 Best site-Real                     (0)  | Epoch:23 | Val Acc: 0.9654
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.9388
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.8978
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.8854
 Best site-Sketch                   (5)  | Epoch:23 | Val Acc: 0.8661
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8652
 Best site-QuickDraw                (1)  | Epoch:23 | Val Acc: 0.7569
 Best site-Infograph                (4)  | Epoch:23 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 5, 3, 4, 1, 2, ]
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (1) | Train Loss: 0.4984 | Train Acc: 0.8522
 Site-Clipart                   (1) | Train Loss: 0.3395 | Train Acc: 0.9068
 Site-Clipart                   (1) | Train Loss: 0.5304 | Train Acc: 0.8711
 Site-Clipart                   (1) | Train Loss: 0.4387 | Train Acc: 0.8797
 Site-Clipart                   (1) | Train Loss: 0.4459 | Train Acc: 0.8824
 Site-Real                      (3) | Train Loss: 0.3675 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2539 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2468 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.2984 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.4854 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.4135 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.3837 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.4990 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.4658 | Train Acc: 0.8427
 Site-QuickDraw                 (0) | Train Loss: 0.8148 | Train Acc: 0.7584
 Site-Infograph                 (4) | Train Loss: 1.1105 | Train Acc: 0.6453
Average Train Accuracy: 0.8700
 Site-Clipart                   (1) | Val  Loss: 0.3381 | Val  Acc: 0.9079
 Site-Clipart                   (1) | Val  Loss: 0.4041 | Val  Acc: 0.8972
 Site-Clipart                   (1) | Val  Loss: 0.4649 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.4603 | Val  Acc: 0.8524
 Site-Clipart                   (1) | Val  Loss: 0.5198 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.2749 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2664 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2796 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2847 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.3005 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3584 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.3981 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.4829 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5137 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 0.9064 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 1.0394 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8777
============ Train epoch 25 ============
cnt=[2, 1, 3, 4, 5, 1, ]
cnt=[5, 3, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (4) | Train Loss: 0.4051 | Train Acc: 0.8870
 Site-Clipart                   (4) | Train Loss: 0.3106 | Train Acc: 0.9068
 Site-Clipart                   (4) | Train Loss: 0.5085 | Train Acc: 0.8711
 Site-Clipart                   (4) | Train Loss: 0.4301 | Train Acc: 0.8797
 Site-Clipart                   (4) | Train Loss: 0.4358 | Train Acc: 0.8937
 Site-Real                      (3) | Train Loss: 0.3854 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2168 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2733 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.3017 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.4264 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.4930 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.3871 | Train Acc: 0.9135
 Site-Sketch                    (0) | Train Loss: 0.4604 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.5337 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.8172 | Train Acc: 0.7584
 Site-Infograph                 (5) | Train Loss: 1.0933 | Train Acc: 0.6282
Average Train Accuracy: 0.8755
 Site-Clipart                   (4) | Val  Loss: 0.3290 | Val  Acc: 0.8816
 Site-Clipart                   (4) | Val  Loss: 0.4033 | Val  Acc: 0.8972
 Site-Clipart                   (4) | Val  Loss: 0.4046 | Val  Acc: 0.9067
 Site-Clipart                   (4) | Val  Loss: 0.4275 | Val  Acc: 0.8714
 Site-Clipart                   (4) | Val  Loss: 0.5168 | Val  Acc: 0.8678
 Site-Real                      (3) | Val  Loss: 0.2601 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2613 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2597 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2802 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2896 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3692 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.3798 | Val  Acc: 0.9062
 Site-Sketch                    (0) | Val  Loss: 0.4481 | Val  Acc: 0.8661
 Site-Sketch                    (0) | Val  Loss: 0.5325 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.9175 | Val  Acc: 0.7661
 Site-Infograph                 (5) | Val  Loss: 1.0669 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8792
============ Train epoch 26 ============
cnt=[3, 1, 5, 4, 1, 2, ]
cnt=[3, 5, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (2) | Train Loss: 0.4568 | Train Acc: 0.8522
 Site-Clipart                   (2) | Train Loss: 0.3455 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.4390 | Train Acc: 0.8844
 Site-Clipart                   (2) | Train Loss: 0.4091 | Train Acc: 0.8797
 Site-Clipart                   (2) | Train Loss: 0.4231 | Train Acc: 0.8891
 Site-Real                      (3) | Train Loss: 0.3508 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2303 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.2515 | Train Acc: 0.9395
 Site-Real                      (3) | Train Loss: 0.2957 | Train Acc: 0.9483
 Site-Painting                  (0) | Train Loss: 0.4124 | Train Acc: 0.8912
 Site-Painting                  (0) | Train Loss: 0.3996 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.3898 | Train Acc: 0.9100
 Site-Sketch                    (5) | Train Loss: 0.4626 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.4529 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.7848 | Train Acc: 0.7615
 Site-Infograph                 (4) | Train Loss: 1.0760 | Train Acc: 0.6282
Average Train Accuracy: 0.8710
 Site-Clipart                   (2) | Val  Loss: 0.2985 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.3766 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.4003 | Val  Acc: 0.8733
 Site-Clipart                   (2) | Val  Loss: 0.3874 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.4899 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2689 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2559 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2448 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2515 | Val  Acc: 0.9610
 Site-Painting                  (0) | Val  Loss: 0.2988 | Val  Acc: 0.8980
 Site-Painting                  (0) | Val  Loss: 0.3376 | Val  Acc: 0.9051
 Site-Painting                  (0) | Val  Loss: 0.4043 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.4236 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.5534 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 0.8869 | Val  Acc: 0.7339
 Site-Infograph                 (4) | Val  Loss: 1.0780 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8769
============ Train epoch 27 ============
cnt=[4, 1, 2, 3, 5, 1, ]
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (4) | Train Loss: 0.4449 | Train Acc: 0.8870
 Site-Clipart                   (4) | Train Loss: 0.3446 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.4718 | Train Acc: 0.8844
 Site-Clipart                   (4) | Train Loss: 0.4125 | Train Acc: 0.8703
 Site-Clipart                   (4) | Train Loss: 0.4321 | Train Acc: 0.8846
 Site-Real                      (0) | Train Loss: 0.3318 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2217 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2422 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2868 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.4648 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.4237 | Train Acc: 0.8981
 Site-Painting                  (3) | Train Loss: 0.3290 | Train Acc: 0.9343
 Site-Sketch                    (2) | Train Loss: 0.4576 | Train Acc: 0.8534
 Site-Sketch                    (2) | Train Loss: 0.4964 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.8050 | Train Acc: 0.7676
 Site-Infograph                 (5) | Train Loss: 1.0817 | Train Acc: 0.6368
Average Train Accuracy: 0.8771
 Site-Clipart                   (4) | Val  Loss: 0.2924 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.3665 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.4103 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4412 | Val  Acc: 0.8714
 Site-Clipart                   (4) | Val  Loss: 0.5071 | Val  Acc: 0.8441
 Site-Real                      (0) | Val  Loss: 0.2391 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2887 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.2867 | Val  Acc: 0.9091
 Site-Real                      (0) | Val  Loss: 0.2617 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.2897 | Val  Acc: 0.9388
 Site-Painting                  (3) | Val  Loss: 0.3350 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.3518 | Val  Acc: 0.9010
 Site-Sketch                    (2) | Val  Loss: 0.5114 | Val  Acc: 0.8425
 Site-Sketch                    (2) | Val  Loss: 0.5732 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 0.8924 | Val  Acc: 0.7431
 Site-Infograph                 (5) | Val  Loss: 1.0684 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8711
============ Train epoch 28 ============
cnt=[5, 1, 3, 2, 4, 1, ]
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (0) | Train Loss: 0.3862 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.3349 | Train Acc: 0.9441
 Site-Clipart                   (0) | Train Loss: 0.4545 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.4148 | Train Acc: 0.8829
 Site-Clipart                   (0) | Train Loss: 0.3977 | Train Acc: 0.9095
 Site-Real                      (4) | Train Loss: 0.3596 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2248 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2570 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2684 | Train Acc: 0.9540
 Site-Painting                  (2) | Train Loss: 0.4811 | Train Acc: 0.8639
 Site-Painting                  (2) | Train Loss: 0.4523 | Train Acc: 0.8689
 Site-Painting                  (2) | Train Loss: 0.3723 | Train Acc: 0.9308
 Site-Sketch                    (3) | Train Loss: 0.4598 | Train Acc: 0.8534
 Site-Sketch                    (3) | Train Loss: 0.4675 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.7566 | Train Acc: 0.7462
 Site-Infograph                 (5) | Train Loss: 1.0487 | Train Acc: 0.6496
Average Train Accuracy: 0.8766
 Site-Clipart                   (0) | Val  Loss: 0.2462 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.3656 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.4238 | Val  Acc: 0.8400
 Site-Clipart                   (0) | Val  Loss: 0.4271 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4856 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2546 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2274 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2494 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.2545 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2866 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3619 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.4147 | Val  Acc: 0.8906
 Site-Sketch                    (3) | Val  Loss: 0.4373 | Val  Acc: 0.8898
 Site-Sketch                    (3) | Val  Loss: 0.5569 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 0.8898 | Val  Acc: 0.7615
 Site-Infograph                 (5) | Val  Loss: 1.0575 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8798
============ Train epoch 29 ============
cnt=[1, 1, 7, 1, 4, 2, ]
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (2) | Train Loss: 0.4377 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.3686 | Train Acc: 0.8882
 Site-Clipart                   (2) | Train Loss: 0.4656 | Train Acc: 0.8711
 Site-Clipart                   (2) | Train Loss: 0.4154 | Train Acc: 0.8734
 Site-Clipart                   (2) | Train Loss: 0.3959 | Train Acc: 0.9072
 Site-Real                      (4) | Train Loss: 0.3379 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.2296 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2294 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2675 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.3590 | Train Acc: 0.8776
 Site-Painting                  (3) | Train Loss: 0.4192 | Train Acc: 0.8689
 Site-Painting                  (5) | Train Loss: 0.3582 | Train Acc: 0.9239
 Site-Sketch                    (2) | Train Loss: 0.4805 | Train Acc: 0.8586
 Site-Sketch                    (2) | Train Loss: 0.4694 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.7747 | Train Acc: 0.7798
 Site-Infograph                 (0) | Train Loss: 1.0005 | Train Acc: 0.6838
Average Train Accuracy: 0.8771
 Site-Clipart                   (2) | Val  Loss: 0.2911 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3514 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.4152 | Val  Acc: 0.8800
 Site-Clipart                   (2) | Val  Loss: 0.4400 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.4981 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.2606 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2660 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.2527 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2320 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.3153 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.2927 | Val  Acc: 0.9416
 Site-Painting                  (5) | Val  Loss: 0.3572 | Val  Acc: 0.8854
 Site-Sketch                    (2) | Val  Loss: 0.4752 | Val  Acc: 0.8661
 Site-Sketch                    (2) | Val  Loss: 0.5405 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.8600 | Val  Acc: 0.7615
 Site-Infograph                 (0) | Val  Loss: 1.0344 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8776
 Test site-Clipart                   (2)| Epoch:23 | Test Acc: 0.8783
 Test site-Real                      (4)| Epoch:23 | Test Acc: 0.9408
 Test site-Painting                  (5)| Epoch:23 | Test Acc: 0.9273
 Test site-Sketch                    (2)| Epoch:23 | Test Acc: 0.8755
 Test site-QuickDraw                 (1)| Epoch:23 | Test Acc: 0.7360
 Test site-Infograph                 (0)| Epoch:23 | Test Acc: 0.5738
Clipart: 0.8783, Real: 0.9408, Painting: 0.9273, Sketch: 0.8755, QuickDraw: 0.7360, Infograph: 0.5738, 
Average Test Accuracy(group): 0.8220, Average Test Accuracy(individual): 0.8749,
domain std=0.1292, cluster std=0.1341, individual std=0.0921, 
============ Train epoch 30 ============
cnt=[5, 1, 3, 4, 1, 2, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (0) | Train Loss: 0.4310 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.3043 | Train Acc: 0.9255
 Site-Clipart                   (0) | Train Loss: 0.4539 | Train Acc: 0.8711
 Site-Clipart                   (0) | Train Loss: 0.3874 | Train Acc: 0.8829
 Site-Clipart                   (0) | Train Loss: 0.4041 | Train Acc: 0.8937
 Site-Real                      (3) | Train Loss: 0.3362 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.2121 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2399 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2767 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.3380 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3584 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.3497 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.4447 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.5375 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 0.8322 | Train Acc: 0.7554
 Site-Infograph                 (4) | Train Loss: 1.0381 | Train Acc: 0.6496
Average Train Accuracy: 0.8782
 Site-Clipart                   (0) | Val  Loss: 0.2698 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.3386 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3909 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.4076 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.4880 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2504 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2255 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2042 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2397 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2758 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.3458 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.3791 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.4665 | Val  Acc: 0.8504
 Site-Sketch                    (5) | Val  Loss: 0.5465 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8708 | Val  Acc: 0.7431
 Site-Infograph                 (4) | Val  Loss: 1.0629 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8797
============ Train epoch 31 ============
cnt=[5, 1, 3, 3, 2, 2, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (2) | Train Loss: 0.4031 | Train Acc: 0.8783
 Site-Clipart                   (5) | Train Loss: 0.2831 | Train Acc: 0.9379
 Site-Clipart                   (5) | Train Loss: 0.5116 | Train Acc: 0.8533
 Site-Clipart                   (2) | Train Loss: 0.4260 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.3910 | Train Acc: 0.9050
 Site-Real                      (0) | Train Loss: 0.3423 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2159 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2154 | Train Acc: 0.9556
 Site-Real                      (0) | Train Loss: 0.2703 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.4135 | Train Acc: 0.9184
 Site-Painting                  (0) | Train Loss: 0.3169 | Train Acc: 0.9320
 Site-Painting                  (3) | Train Loss: 0.3456 | Train Acc: 0.9135
 Site-Sketch                    (4) | Train Loss: 0.4655 | Train Acc: 0.8691
 Site-Sketch                    (4) | Train Loss: 0.4961 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.7181 | Train Acc: 0.7890
 Site-Infograph                 (3) | Train Loss: 1.0696 | Train Acc: 0.6325
Average Train Accuracy: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.2828 | Val  Acc: 0.8816
 Site-Clipart                   (5) | Val  Loss: 0.3540 | Val  Acc: 0.9252
 Site-Clipart                   (5) | Val  Loss: 0.3915 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.3794 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.4800 | Val  Acc: 0.8508
 Site-Real                      (0) | Val  Loss: 0.2438 | Val  Acc: 0.9167
 Site-Real                      (0) | Val  Loss: 0.2287 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.2164 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2465 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.2493 | Val  Acc: 0.9490
 Site-Painting                  (0) | Val  Loss: 0.3328 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3386 | Val  Acc: 0.9115
 Site-Sketch                    (4) | Val  Loss: 0.4281 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.4940 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8365 | Val  Acc: 0.7706
 Site-Infograph                 (3) | Val  Loss: 0.9959 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8813
 Best site-Clipart                  (2)  | Epoch:31 | Val Acc: 0.8816
 Best site-Clipart                  (5)  | Epoch:31 | Val Acc: 0.9252
 Best site-Clipart                  (5)  | Epoch:31 | Val Acc: 0.8933
 Best site-Clipart                  (2)  | Epoch:31 | Val Acc: 0.8571
 Best site-Clipart                  (2)  | Epoch:31 | Val Acc: 0.8508
 Best site-Real                     (0)  | Epoch:31 | Val Acc: 0.9167
 Best site-Real                     (0)  | Epoch:31 | Val Acc: 0.9492
 Best site-Real                     (0)  | Epoch:31 | Val Acc: 0.9394
 Best site-Real                     (0)  | Epoch:31 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:31 | Val Acc: 0.9490
 Best site-Painting                 (0)  | Epoch:31 | Val Acc: 0.9124
 Best site-Painting                 (3)  | Epoch:31 | Val Acc: 0.9115
 Best site-Sketch                   (4)  | Epoch:31 | Val Acc: 0.8583
 Best site-Sketch                   (4)  | Epoch:31 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:31 | Val Acc: 0.7706
 Best site-Infograph                (3)  | Epoch:31 | Val Acc: 0.7179
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 32 ============
cnt=[1, 5, 3, 1, 4, 2, ]
cnt=[1, 5, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (1) | Train Loss: 0.4665 | Train Acc: 0.8696
 Site-Clipart                   (1) | Train Loss: 0.2973 | Train Acc: 0.9379
 Site-Clipart                   (1) | Train Loss: 0.5004 | Train Acc: 0.8756
 Site-Clipart                   (1) | Train Loss: 0.4034 | Train Acc: 0.8797
 Site-Clipart                   (1) | Train Loss: 0.3762 | Train Acc: 0.9072
 Site-Real                      (4) | Train Loss: 0.3312 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2177 | Train Acc: 0.9548
 Site-Real                      (4) | Train Loss: 0.2404 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2773 | Train Acc: 0.9483
 Site-Painting                  (2) | Train Loss: 0.3443 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.3837 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.3345 | Train Acc: 0.9170
 Site-Sketch                    (5) | Train Loss: 0.4228 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.4901 | Train Acc: 0.8464
 Site-QuickDraw                 (0) | Train Loss: 0.7771 | Train Acc: 0.7859
 Site-Infograph                 (3) | Train Loss: 0.9812 | Train Acc: 0.6880
Average Train Accuracy: 0.8826
 Site-Clipart                   (1) | Val  Loss: 0.2534 | Val  Acc: 0.9474
 Site-Clipart                   (1) | Val  Loss: 0.3587 | Val  Acc: 0.9159
 Site-Clipart                   (1) | Val  Loss: 0.3680 | Val  Acc: 0.8867
 Site-Clipart                   (1) | Val  Loss: 0.4108 | Val  Acc: 0.8619
 Site-Clipart                   (1) | Val  Loss: 0.4670 | Val  Acc: 0.8814
 Site-Real                      (4) | Val  Loss: 0.2326 | Val  Acc: 0.9643
 Site-Real                      (4) | Val  Loss: 0.2428 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2494 | Val  Acc: 0.9212
 Site-Real                      (4) | Val  Loss: 0.2510 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2156 | Val  Acc: 0.9694
 Site-Painting                  (2) | Val  Loss: 0.3978 | Val  Acc: 0.9051
 Site-Painting                  (2) | Val  Loss: 0.3546 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.4334 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.5338 | Val  Acc: 0.8090
 Site-QuickDraw                 (0) | Val  Loss: 0.8470 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 0.9895 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8867
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.9474
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.9159
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.8867
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.8619
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.8814
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9643
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9492
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9212
 Best site-Real                     (4)  | Epoch:32 | Val Acc: 0.9481
 Best site-Painting                 (2)  | Epoch:32 | Val Acc: 0.9694
 Best site-Painting                 (2)  | Epoch:32 | Val Acc: 0.9051
 Best site-Painting                 (2)  | Epoch:32 | Val Acc: 0.9062
 Best site-Sketch                   (5)  | Epoch:32 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:32 | Val Acc: 0.8090
 Best site-QuickDraw                (0)  | Epoch:32 | Val Acc: 0.7936
 Best site-Infograph                (3)  | Epoch:32 | Val Acc: 0.6859
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 1, 3, 5, 4, 1, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (3) | Train Loss: 0.4150 | Train Acc: 0.8870
 Site-Clipart                   (3) | Train Loss: 0.2836 | Train Acc: 0.9441
 Site-Clipart                   (3) | Train Loss: 0.4142 | Train Acc: 0.8711
 Site-Clipart                   (3) | Train Loss: 0.3775 | Train Acc: 0.8829
 Site-Clipart                   (3) | Train Loss: 0.3729 | Train Acc: 0.9072
 Site-Real                      (4) | Train Loss: 0.3620 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.2047 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2487 | Train Acc: 0.9274
 Site-Real                      (4) | Train Loss: 0.2762 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.4171 | Train Acc: 0.8503
 Site-Painting                  (2) | Train Loss: 0.3919 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.3240 | Train Acc: 0.9273
 Site-Sketch                    (0) | Train Loss: 0.4582 | Train Acc: 0.8534
 Site-Sketch                    (0) | Train Loss: 0.4170 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.7938 | Train Acc: 0.7798
 Site-Infograph                 (5) | Train Loss: 1.0093 | Train Acc: 0.6752
Average Train Accuracy: 0.8796
 Site-Clipart                   (3) | Val  Loss: 0.3136 | Val  Acc: 0.9079
 Site-Clipart                   (3) | Val  Loss: 0.3436 | Val  Acc: 0.8972
 Site-Clipart                   (3) | Val  Loss: 0.3571 | Val  Acc: 0.9067
 Site-Clipart                   (3) | Val  Loss: 0.3840 | Val  Acc: 0.8810
 Site-Clipart                   (3) | Val  Loss: 0.4886 | Val  Acc: 0.8610
 Site-Real                      (4) | Val  Loss: 0.2268 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2241 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2467 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2272 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2234 | Val  Acc: 0.9796
 Site-Painting                  (2) | Val  Loss: 0.3093 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.3294 | Val  Acc: 0.9010
 Site-Sketch                    (0) | Val  Loss: 0.4528 | Val  Acc: 0.8819
 Site-Sketch                    (0) | Val  Loss: 0.5238 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.7971 | Val  Acc: 0.7661
 Site-Infograph                 (5) | Val  Loss: 1.0540 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8868
 Best site-Clipart                  (3)  | Epoch:33 | Val Acc: 0.9079
 Best site-Clipart                  (3)  | Epoch:33 | Val Acc: 0.8972
 Best site-Clipart                  (3)  | Epoch:33 | Val Acc: 0.9067
 Best site-Clipart                  (3)  | Epoch:33 | Val Acc: 0.8810
 Best site-Clipart                  (3)  | Epoch:33 | Val Acc: 0.8610
 Best site-Real                     (4)  | Epoch:33 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:33 | Val Acc: 0.9407
 Best site-Real                     (4)  | Epoch:33 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:33 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:33 | Val Acc: 0.9796
 Best site-Painting                 (2)  | Epoch:33 | Val Acc: 0.9197
 Best site-Painting                 (2)  | Epoch:33 | Val Acc: 0.9010
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.8819
 Best site-Sketch                   (0)  | Epoch:33 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:33 | Val Acc: 0.7661
 Best site-Infograph                (5)  | Epoch:33 | Val Acc: 0.7051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 4, 5, 1, 3, 2, ]
cnt=[5, 4, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (2) | Train Loss: 0.3760 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.2977 | Train Acc: 0.9317
 Site-Clipart                   (2) | Train Loss: 0.3930 | Train Acc: 0.8933
 Site-Clipart                   (2) | Train Loss: 0.3697 | Train Acc: 0.9019
 Site-Clipart                   (2) | Train Loss: 0.3972 | Train Acc: 0.8914
 Site-Real                      (1) | Train Loss: 0.3498 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.2065 | Train Acc: 0.9605
 Site-Real                      (1) | Train Loss: 0.2068 | Train Acc: 0.9556
 Site-Real                      (1) | Train Loss: 0.3007 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.4479 | Train Acc: 0.8707
 Site-Painting                  (4) | Train Loss: 0.4423 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.3374 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.4923 | Train Acc: 0.8429
 Site-Sketch                    (5) | Train Loss: 0.4533 | Train Acc: 0.8464
 Site-QuickDraw                 (0) | Train Loss: 0.8083 | Train Acc: 0.7676
 Site-Infograph                 (3) | Train Loss: 0.9610 | Train Acc: 0.6752
Average Train Accuracy: 0.8790
 Site-Clipart                   (2) | Val  Loss: 0.2775 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.2968 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.3621 | Val  Acc: 0.8600
 Site-Clipart                   (2) | Val  Loss: 0.3852 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.4652 | Val  Acc: 0.8576
 Site-Real                      (1) | Val  Loss: 0.2329 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2380 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2367 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.2568 | Val  Acc: 0.9567
 Site-Painting                  (4) | Val  Loss: 0.2617 | Val  Acc: 0.9184
 Site-Painting                  (4) | Val  Loss: 0.2778 | Val  Acc: 0.9270
 Site-Painting                  (4) | Val  Loss: 0.3449 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.4030 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.4922 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 0.8325 | Val  Acc: 0.7569
 Site-Infograph                 (3) | Val  Loss: 0.9721 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8789
============ Train epoch 35 ============
cnt=[4, 1, 2, 3, 5, 1, ]
cnt=[1, 5, 3, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (4) | Train Loss: 0.3963 | Train Acc: 0.8957
 Site-Clipart                   (4) | Train Loss: 0.2805 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.4382 | Train Acc: 0.8800
 Site-Clipart                   (4) | Train Loss: 0.4095 | Train Acc: 0.8639
 Site-Clipart                   (4) | Train Loss: 0.3792 | Train Acc: 0.9072
 Site-Real                      (0) | Train Loss: 0.3133 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2128 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2174 | Train Acc: 0.9556
 Site-Real                      (0) | Train Loss: 0.2850 | Train Acc: 0.9224
 Site-Painting                  (3) | Train Loss: 0.3854 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.3609 | Train Acc: 0.8932
 Site-Painting                  (3) | Train Loss: 0.3238 | Train Acc: 0.9377
 Site-Sketch                    (2) | Train Loss: 0.4341 | Train Acc: 0.8691
 Site-Sketch                    (2) | Train Loss: 0.4451 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.8115 | Train Acc: 0.8135
 Site-Infograph                 (5) | Train Loss: 0.9334 | Train Acc: 0.6880
Average Train Accuracy: 0.8866
 Site-Clipart                   (4) | Val  Loss: 0.2859 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.3627 | Val  Acc: 0.9065
 Site-Clipart                   (4) | Val  Loss: 0.3562 | Val  Acc: 0.9067
 Site-Clipart                   (4) | Val  Loss: 0.4180 | Val  Acc: 0.8619
 Site-Clipart                   (4) | Val  Loss: 0.4629 | Val  Acc: 0.8610
 Site-Real                      (0) | Val  Loss: 0.2304 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2415 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2211 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2400 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.2187 | Val  Acc: 0.9388
 Site-Painting                  (3) | Val  Loss: 0.2878 | Val  Acc: 0.9124
 Site-Painting                  (3) | Val  Loss: 0.3503 | Val  Acc: 0.9219
 Site-Sketch                    (2) | Val  Loss: 0.3641 | Val  Acc: 0.8661
 Site-Sketch                    (2) | Val  Loss: 0.4879 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.7745 | Val  Acc: 0.7844
 Site-Infograph                 (5) | Val  Loss: 0.9808 | Val  Acc: 0.7372
Average Valid Accuracy: 0.8881
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.9211
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.9065
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.9067
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.8619
 Best site-Clipart                  (4)  | Epoch:35 | Val Acc: 0.8610
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9322
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:35 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:35 | Val Acc: 0.9388
 Best site-Painting                 (3)  | Epoch:35 | Val Acc: 0.9124
 Best site-Painting                 (3)  | Epoch:35 | Val Acc: 0.9219
 Best site-Sketch                   (2)  | Epoch:35 | Val Acc: 0.8661
 Best site-Sketch                   (2)  | Epoch:35 | Val Acc: 0.8371
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.7844
 Best site-Infograph                (5)  | Epoch:35 | Val Acc: 0.7372
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 36 ============
cnt=[3, 1, 2, 4, 5, 1, ]
cnt=[3, 5, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (4) | Train Loss: 0.3725 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.2884 | Train Acc: 0.9317
 Site-Clipart                   (4) | Train Loss: 0.4569 | Train Acc: 0.8756
 Site-Clipart                   (4) | Train Loss: 0.3897 | Train Acc: 0.8671
 Site-Clipart                   (4) | Train Loss: 0.3602 | Train Acc: 0.9163
 Site-Real                      (3) | Train Loss: 0.3305 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2250 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2067 | Train Acc: 0.9556
 Site-Real                      (3) | Train Loss: 0.2513 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.3700 | Train Acc: 0.9048
 Site-Painting                  (0) | Train Loss: 0.3757 | Train Acc: 0.9078
 Site-Painting                  (0) | Train Loss: 0.2992 | Train Acc: 0.9273
 Site-Sketch                    (2) | Train Loss: 0.4377 | Train Acc: 0.8691
 Site-Sketch                    (2) | Train Loss: 0.5467 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.7808 | Train Acc: 0.7829
 Site-Infograph                 (5) | Train Loss: 0.9407 | Train Acc: 0.7051
Average Train Accuracy: 0.8869
 Site-Clipart                   (4) | Val  Loss: 0.2588 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.3199 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.3517 | Val  Acc: 0.9133
 Site-Clipart                   (4) | Val  Loss: 0.4060 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.4104 | Val  Acc: 0.9017
 Site-Real                      (3) | Val  Loss: 0.2361 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2216 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.2502 | Val  Acc: 0.9152
 Site-Real                      (3) | Val  Loss: 0.2371 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.2495 | Val  Acc: 0.9592
 Site-Painting                  (0) | Val  Loss: 0.2781 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3402 | Val  Acc: 0.9271
 Site-Sketch                    (2) | Val  Loss: 0.3980 | Val  Acc: 0.8898
 Site-Sketch                    (2) | Val  Loss: 0.5177 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 0.8062 | Val  Acc: 0.7936
 Site-Infograph                 (5) | Val  Loss: 0.9761 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8928
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.9342
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.9159
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.9133
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.8571
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.9017
 Best site-Real                     (3)  | Epoch:36 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:36 | Val Acc: 0.9492
 Best site-Real                     (3)  | Epoch:36 | Val Acc: 0.9152
 Best site-Real                     (3)  | Epoch:36 | Val Acc: 0.9481
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9592
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9124
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9271
 Best site-Sketch                   (2)  | Epoch:36 | Val Acc: 0.8898
 Best site-Sketch                   (2)  | Epoch:36 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:36 | Val Acc: 0.7936
 Best site-Infograph                (5)  | Epoch:36 | Val Acc: 0.7179
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 1, 3, 4, 5, 1, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (4) | Train Loss: 0.4207 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.3028 | Train Acc: 0.9006
 Site-Clipart                   (4) | Train Loss: 0.4003 | Train Acc: 0.8844
 Site-Clipart                   (4) | Train Loss: 0.3631 | Train Acc: 0.8924
 Site-Clipart                   (4) | Train Loss: 0.3729 | Train Acc: 0.9072
 Site-Real                      (3) | Train Loss: 0.3012 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.1825 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2202 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2698 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.4083 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3887 | Train Acc: 0.8932
 Site-Painting                  (2) | Train Loss: 0.3039 | Train Acc: 0.9239
 Site-Sketch                    (0) | Train Loss: 0.4240 | Train Acc: 0.8691
 Site-Sketch                    (0) | Train Loss: 0.4002 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.7109 | Train Acc: 0.8226
 Site-Infograph                 (5) | Train Loss: 0.9285 | Train Acc: 0.6923
Average Train Accuracy: 0.8876
 Site-Clipart                   (4) | Val  Loss: 0.2729 | Val  Acc: 0.9079
 Site-Clipart                   (4) | Val  Loss: 0.3211 | Val  Acc: 0.9065
 Site-Clipart                   (4) | Val  Loss: 0.3781 | Val  Acc: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.3654 | Val  Acc: 0.8762
 Site-Clipart                   (4) | Val  Loss: 0.4246 | Val  Acc: 0.8780
 Site-Real                      (3) | Val  Loss: 0.2151 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2437 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.2663 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.2144 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.2163 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.2649 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.3282 | Val  Acc: 0.9219
 Site-Sketch                    (0) | Val  Loss: 0.3693 | Val  Acc: 0.8819
 Site-Sketch                    (0) | Val  Loss: 0.4976 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.7760 | Val  Acc: 0.7661
 Site-Infograph                 (5) | Val  Loss: 1.0058 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8863
============ Train epoch 38 ============
cnt=[3, 1, 2, 5, 4, 1, ]
cnt=[5, 1, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (3) | Train Loss: 0.3519 | Train Acc: 0.8870
 Site-Clipart                   (3) | Train Loss: 0.2978 | Train Acc: 0.9130
 Site-Clipart                   (3) | Train Loss: 0.4309 | Train Acc: 0.8756
 Site-Clipart                   (3) | Train Loss: 0.3832 | Train Acc: 0.8766
 Site-Clipart                   (3) | Train Loss: 0.3543 | Train Acc: 0.9299
 Site-Real                      (4) | Train Loss: 0.3413 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.2086 | Train Acc: 0.9605
 Site-Real                      (4) | Train Loss: 0.2111 | Train Acc: 0.9556
 Site-Real                      (4) | Train Loss: 0.2789 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4316 | Train Acc: 0.8639
 Site-Painting                  (0) | Train Loss: 0.3096 | Train Acc: 0.8786
 Site-Painting                  (0) | Train Loss: 0.3099 | Train Acc: 0.9377
 Site-Sketch                    (2) | Train Loss: 0.3894 | Train Acc: 0.8901
 Site-Sketch                    (2) | Train Loss: 0.4411 | Train Acc: 0.8764
 Site-QuickDraw                 (1) | Train Loss: 0.6980 | Train Acc: 0.8073
 Site-Infograph                 (5) | Train Loss: 0.9214 | Train Acc: 0.7222
Average Train Accuracy: 0.8892
 Site-Clipart                   (3) | Val  Loss: 0.2603 | Val  Acc: 0.9342
 Site-Clipart                   (3) | Val  Loss: 0.3375 | Val  Acc: 0.8972
 Site-Clipart                   (3) | Val  Loss: 0.3136 | Val  Acc: 0.9133
 Site-Clipart                   (3) | Val  Loss: 0.3592 | Val  Acc: 0.8714
 Site-Clipart                   (3) | Val  Loss: 0.4519 | Val  Acc: 0.8644
 Site-Real                      (4) | Val  Loss: 0.2247 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2143 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.1989 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.2196 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.2269 | Val  Acc: 0.9694
 Site-Painting                  (0) | Val  Loss: 0.3117 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3274 | Val  Acc: 0.9115
 Site-Sketch                    (2) | Val  Loss: 0.4243 | Val  Acc: 0.8504
 Site-Sketch                    (2) | Val  Loss: 0.5163 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.7526 | Val  Acc: 0.7936
 Site-Infograph                 (5) | Val  Loss: 1.0573 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8896
============ Train epoch 39 ============
cnt=[5, 1, 3, 4, 1, 2, ]
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (0) | Train Loss: 0.3751 | Train Acc: 0.8957
 Site-Clipart                   (0) | Train Loss: 0.2696 | Train Acc: 0.9317
 Site-Clipart                   (0) | Train Loss: 0.4098 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.3911 | Train Acc: 0.8734
 Site-Clipart                   (0) | Train Loss: 0.3426 | Train Acc: 0.9095
 Site-Real                      (3) | Train Loss: 0.3225 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2084 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2294 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.2810 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.3766 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.3192 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.3101 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.4051 | Train Acc: 0.8796
 Site-Sketch                    (5) | Train Loss: 0.5267 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.7325 | Train Acc: 0.8226
 Site-Infograph                 (4) | Train Loss: 0.8851 | Train Acc: 0.7222
Average Train Accuracy: 0.8895
 Site-Clipart                   (0) | Val  Loss: 0.2140 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.3429 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.3332 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.3620 | Val  Acc: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.4140 | Val  Acc: 0.9017
 Site-Real                      (3) | Val  Loss: 0.2060 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2289 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.1911 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.2269 | Val  Acc: 0.9394
 Site-Painting                  (2) | Val  Loss: 0.2339 | Val  Acc: 0.9694
 Site-Painting                  (2) | Val  Loss: 0.2666 | Val  Acc: 0.9489
 Site-Painting                  (2) | Val  Loss: 0.3113 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.3934 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4633 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7966 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 0.9608 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8945
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.9474
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.9065
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8933
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.8905
 Best site-Clipart                  (0)  | Epoch:39 | Val Acc: 0.9017
 Best site-Real                     (3)  | Epoch:39 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:39 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:39 | Val Acc: 0.9394
 Best site-Real                     (3)  | Epoch:39 | Val Acc: 0.9394
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9694
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.9489
 Best site-Painting                 (2)  | Epoch:39 | Val Acc: 0.8906
 Best site-Sketch                   (5)  | Epoch:39 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:39 | Val Acc: 0.8315
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.7798
 Best site-Infograph                (4)  | Epoch:39 | Val Acc: 0.6987
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (0)| Epoch:39 | Test Acc: 0.8897
 Test site-Real                      (3)| Epoch:39 | Test Acc: 0.9449
 Test site-Painting                  (2)| Epoch:39 | Test Acc: 0.9273
 Test site-Sketch                    (5)| Epoch:39 | Test Acc: 0.8827
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7480
 Test site-Infograph                 (4)| Epoch:39 | Test Acc: 0.5632
Clipart: 0.8897, Real: 0.9449, Painting: 0.9273, Sketch: 0.8827, QuickDraw: 0.7480, Infograph: 0.5632, 
Average Test Accuracy(group): 0.8260, Average Test Accuracy(individual): 0.8804,
domain std=0.1334, cluster std=0.1334, individual std=0.0942, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 1, 4, 1, 3, 5, ]
cnt=[2, 4, 5, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (5) | Train Loss: 0.3772 | Train Acc: 0.9043
 Site-Clipart                   (5) | Train Loss: 0.2670 | Train Acc: 0.9255
 Site-Clipart                   (5) | Train Loss: 0.4161 | Train Acc: 0.8622
 Site-Clipart                   (5) | Train Loss: 0.3678 | Train Acc: 0.8829
 Site-Clipart                   (5) | Train Loss: 0.3648 | Train Acc: 0.9186
 Site-Real                      (2) | Train Loss: 0.3080 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.1972 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.2209 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2523 | Train Acc: 0.9511
 Site-Painting                  (4) | Train Loss: 0.4193 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.3538 | Train Acc: 0.8981
 Site-Painting                  (4) | Train Loss: 0.3093 | Train Acc: 0.9170
 Site-Sketch                    (0) | Train Loss: 0.4203 | Train Acc: 0.8534
 Site-Sketch                    (0) | Train Loss: 0.3739 | Train Acc: 0.8839
 Site-QuickDraw                 (1) | Train Loss: 0.7388 | Train Acc: 0.7890
 Site-Infograph                 (3) | Train Loss: 0.8934 | Train Acc: 0.7265
Average Train Accuracy: 0.8890
 Site-Clipart                   (5) | Val  Loss: 0.2513 | Val  Acc: 0.8816
 Site-Clipart                   (5) | Val  Loss: 0.3123 | Val  Acc: 0.9252
 Site-Clipart                   (5) | Val  Loss: 0.3327 | Val  Acc: 0.9000
 Site-Clipart                   (5) | Val  Loss: 0.3553 | Val  Acc: 0.8857
 Site-Clipart                   (5) | Val  Loss: 0.3965 | Val  Acc: 0.8881
 Site-Real                      (2) | Val  Loss: 0.2127 | Val  Acc: 0.9643
 Site-Real                      (2) | Val  Loss: 0.2221 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.2362 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2079 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2087 | Val  Acc: 0.9490
 Site-Painting                  (4) | Val  Loss: 0.2914 | Val  Acc: 0.9197
 Site-Painting                  (4) | Val  Loss: 0.3035 | Val  Acc: 0.9219
 Site-Sketch                    (0) | Val  Loss: 0.3924 | Val  Acc: 0.8740
 Site-Sketch                    (0) | Val  Loss: 0.4676 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.7947 | Val  Acc: 0.7706
 Site-Infograph                 (3) | Val  Loss: 0.9387 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8889
 Test site-Clipart                   (5)| Epoch:39 | Test Acc: 0.8954
 Test site-Real                      (2)| Epoch:39 | Test Acc: 0.9491
 Test site-Painting                  (4)| Epoch:39 | Test Acc: 0.9321
 Test site-Sketch                    (0)| Epoch:39 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7520
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5723
Clipart: 0.8954, Real: 0.9491, Painting: 0.9321, Sketch: 0.8917, QuickDraw: 0.7520, Infograph: 0.5723, 
Average Test Accuracy(group): 0.8321, Average Test Accuracy(individual): 0.8861,
domain std=0.1324, cluster std=0.1324, individual std=0.0933, 
Average Test Accuracy: 0.8321
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 41 ============
cnt=[5, 1, 3, 2, 4, 1, ]
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (0) | Train Loss: 0.3714 | Train Acc: 0.8957
 Site-Clipart                   (0) | Train Loss: 0.2805 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.3597 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.3529 | Train Acc: 0.8892
 Site-Clipart                   (0) | Train Loss: 0.3371 | Train Acc: 0.9253
 Site-Real                      (4) | Train Loss: 0.3018 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.1757 | Train Acc: 0.9774
 Site-Real                      (4) | Train Loss: 0.2102 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2475 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.2555 | Train Acc: 0.9388
 Site-Painting                  (2) | Train Loss: 0.3939 | Train Acc: 0.8592
 Site-Painting                  (2) | Train Loss: 0.3125 | Train Acc: 0.9204
 Site-Sketch                    (3) | Train Loss: 0.3882 | Train Acc: 0.9005
 Site-Sketch                    (3) | Train Loss: 0.3963 | Train Acc: 0.8989
 Site-QuickDraw                 (1) | Train Loss: 0.7112 | Train Acc: 0.8287
 Site-Infograph                 (5) | Train Loss: 0.8994 | Train Acc: 0.7009
Average Train Accuracy: 0.8957
 Site-Clipart                   (0) | Val  Loss: 0.2693 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.2783 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.3392 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.3673 | Val  Acc: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.4270 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2109 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2288 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.1854 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2107 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2077 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.3003 | Val  Acc: 0.9051
 Site-Painting                  (2) | Val  Loss: 0.2967 | Val  Acc: 0.9427
 Site-Sketch                    (3) | Val  Loss: 0.3595 | Val  Acc: 0.9213
 Site-Sketch                    (3) | Val  Loss: 0.4580 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.7535 | Val  Acc: 0.7890
 Site-Infograph                 (5) | Val  Loss: 0.9709 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8958
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8684
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.9346
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.9000
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8905
 Best site-Clipart                  (0)  | Epoch:41 | Val Acc: 0.8712
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9407
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9394
 Best site-Real                     (4)  | Epoch:41 | Val Acc: 0.9567
 Best site-Painting                 (2)  | Epoch:41 | Val Acc: 0.9490
 Best site-Painting                 (2)  | Epoch:41 | Val Acc: 0.9051
 Best site-Painting                 (2)  | Epoch:41 | Val Acc: 0.9427
 Best site-Sketch                   (3)  | Epoch:41 | Val Acc: 0.9213
 Best site-Sketch                   (3)  | Epoch:41 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:41 | Val Acc: 0.7890
 Best site-Infograph                (5)  | Epoch:41 | Val Acc: 0.7244
 Test site-Clipart                   (0)| Epoch:41 | Test Acc: 0.8954
 Test site-Real                      (4)| Epoch:41 | Test Acc: 0.9474
 Test site-Painting                  (2)| Epoch:41 | Test Acc: 0.9338
 Test site-Sketch                    (3)| Epoch:41 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7580
 Test site-Infograph                 (5)| Epoch:41 | Test Acc: 0.5662
Clipart: 0.8954, Real: 0.9474, Painting: 0.9338, Sketch: 0.8917, QuickDraw: 0.7580, Infograph: 0.5662, 
Average Test Accuracy(group): 0.8321, Average Test Accuracy(individual): 0.8860,
domain std=0.1338, cluster std=0.1338, individual std=0.0939, 
Average Test Accuracy: 0.8321
============ Train epoch 42 ============
cnt=[3, 1, 5, 4, 1, 2, ]
cnt=[4, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (2) | Train Loss: 0.3597 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.2881 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.4271 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.3497 | Train Acc: 0.9051
 Site-Clipart                   (2) | Train Loss: 0.3464 | Train Acc: 0.9208
 Site-Real                      (3) | Train Loss: 0.3136 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.1710 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2218 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2430 | Train Acc: 0.9310
 Site-Painting                  (0) | Train Loss: 0.3230 | Train Acc: 0.9048
 Site-Painting                  (0) | Train Loss: 0.3383 | Train Acc: 0.9078
 Site-Painting                  (0) | Train Loss: 0.2702 | Train Acc: 0.9446
 Site-Sketch                    (5) | Train Loss: 0.4201 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.5023 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.6639 | Train Acc: 0.8012
 Site-Infograph                 (4) | Train Loss: 0.8777 | Train Acc: 0.6966
Average Train Accuracy: 0.8925
 Site-Clipart                   (2) | Val  Loss: 0.2226 | Val  Acc: 0.9605
 Site-Clipart                   (2) | Val  Loss: 0.2678 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.2913 | Val  Acc: 0.9067
 Site-Clipart                   (2) | Val  Loss: 0.3600 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.4414 | Val  Acc: 0.8576
 Site-Real                      (3) | Val  Loss: 0.2105 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2392 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2040 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2125 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.2346 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.2681 | Val  Acc: 0.9343
 Site-Painting                  (0) | Val  Loss: 0.3062 | Val  Acc: 0.9167
 Site-Sketch                    (5) | Val  Loss: 0.3799 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.4852 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.7521 | Val  Acc: 0.7982
 Site-Infograph                 (4) | Val  Loss: 1.0050 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8962
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9605
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9252
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.9067
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.8810
 Best site-Clipart                  (2)  | Epoch:42 | Val Acc: 0.8576
 Best site-Real                     (3)  | Epoch:42 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:42 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:42 | Val Acc: 0.9455
 Best site-Real                     (3)  | Epoch:42 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9388
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9343
 Best site-Painting                 (0)  | Epoch:42 | Val Acc: 0.9167
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8819
 Best site-Sketch                   (5)  | Epoch:42 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:42 | Val Acc: 0.7982
 Best site-Infograph                (4)  | Epoch:42 | Val Acc: 0.7115
 Test site-Clipart                   (2)| Epoch:42 | Test Acc: 0.9011
 Test site-Real                      (3)| Epoch:42 | Test Acc: 0.9466
 Test site-Painting                  (0)| Epoch:42 | Test Acc: 0.9354
 Test site-Sketch                    (5)| Epoch:42 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7670
 Test site-Infograph                 (4)| Epoch:42 | Test Acc: 0.5632
Clipart: 0.9011, Real: 0.9466, Painting: 0.9354, Sketch: 0.8935, QuickDraw: 0.7670, Infograph: 0.5632, 
Average Test Accuracy(group): 0.8345, Average Test Accuracy(individual): 0.8885,
domain std=0.1347, cluster std=0.1347, individual std=0.0941, 
Average Test Accuracy: 0.8345
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 43 ============
cnt=[4, 1, 5, 1, 3, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (2) | Train Loss: 0.3242 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.2957 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.3825 | Train Acc: 0.9200
 Site-Clipart                   (2) | Train Loss: 0.3494 | Train Acc: 0.8956
 Site-Clipart                   (2) | Train Loss: 0.3450 | Train Acc: 0.9208
 Site-Real                      (0) | Train Loss: 0.3067 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.1887 | Train Acc: 0.9718
 Site-Real                      (0) | Train Loss: 0.2078 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2426 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.3512 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.3298 | Train Acc: 0.9029
 Site-Painting                  (4) | Train Loss: 0.3060 | Train Acc: 0.9308
 Site-Sketch                    (5) | Train Loss: 0.4379 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.4302 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.7634 | Train Acc: 0.8135
 Site-Infograph                 (3) | Train Loss: 0.8415 | Train Acc: 0.7479
Average Train Accuracy: 0.8970
 Site-Clipart                   (2) | Val  Loss: 0.2532 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.2866 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.3127 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.3758 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.4025 | Val  Acc: 0.8949
 Site-Real                      (0) | Val  Loss: 0.2316 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2192 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2013 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2156 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2182 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.3103 | Val  Acc: 0.9343
 Site-Painting                  (4) | Val  Loss: 0.3031 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.3614 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4406 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.7388 | Val  Acc: 0.8165
 Site-Infograph                 (3) | Val  Loss: 0.9658 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8963
 Best site-Clipart                  (2)  | Epoch:43 | Val Acc: 0.9211
 Best site-Clipart                  (2)  | Epoch:43 | Val Acc: 0.9346
 Best site-Clipart                  (2)  | Epoch:43 | Val Acc: 0.8933
 Best site-Clipart                  (2)  | Epoch:43 | Val Acc: 0.8571
 Best site-Clipart                  (2)  | Epoch:43 | Val Acc: 0.8949
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9576
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9394
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:43 | Val Acc: 0.9286
 Best site-Painting                 (4)  | Epoch:43 | Val Acc: 0.9343
 Best site-Painting                 (4)  | Epoch:43 | Val Acc: 0.9219
 Best site-Sketch                   (5)  | Epoch:43 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:43 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:43 | Val Acc: 0.8165
 Best site-Infograph                (3)  | Epoch:43 | Val Acc: 0.6987
 Test site-Clipart                   (2)| Epoch:43 | Test Acc: 0.9030
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9458
 Test site-Painting                  (4)| Epoch:43 | Test Acc: 0.9321
 Test site-Sketch                    (5)| Epoch:43 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7660
 Test site-Infograph                 (3)| Epoch:43 | Test Acc: 0.5677
Clipart: 0.9030, Real: 0.9458, Painting: 0.9321, Sketch: 0.8935, QuickDraw: 0.7660, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8347, Average Test Accuracy(individual): 0.8885,
domain std=0.1329, cluster std=0.1329, individual std=0.0928, 
Average Test Accuracy: 0.8347
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 44 ============
cnt=[4, 1, 2, 1, 5, 3, ]
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (4) | Train Loss: 0.3846 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.2586 | Train Acc: 0.9255
 Site-Clipart                   (4) | Train Loss: 0.3808 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.3602 | Train Acc: 0.8829
 Site-Clipart                   (4) | Train Loss: 0.3201 | Train Acc: 0.9118
 Site-Real                      (0) | Train Loss: 0.3278 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.1967 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.1956 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2416 | Train Acc: 0.9397
 Site-Painting                  (5) | Train Loss: 0.2603 | Train Acc: 0.9116
 Site-Painting                  (5) | Train Loss: 0.3212 | Train Acc: 0.9126
 Site-Painting                  (5) | Train Loss: 0.3045 | Train Acc: 0.9377
 Site-Sketch                    (2) | Train Loss: 0.3939 | Train Acc: 0.8743
 Site-Sketch                    (2) | Train Loss: 0.4224 | Train Acc: 0.8876
 Site-QuickDraw                 (1) | Train Loss: 0.6600 | Train Acc: 0.8104
 Site-Infograph                 (3) | Train Loss: 0.8484 | Train Acc: 0.7479
Average Train Accuracy: 0.8959
 Site-Clipart                   (4) | Val  Loss: 0.2502 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.2843 | Val  Acc: 0.9252
 Site-Clipart                   (4) | Val  Loss: 0.3498 | Val  Acc: 0.8800
 Site-Clipart                   (4) | Val  Loss: 0.3418 | Val  Acc: 0.8952
 Site-Clipart                   (4) | Val  Loss: 0.4432 | Val  Acc: 0.8542
 Site-Real                      (0) | Val  Loss: 0.2247 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2398 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2100 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2130 | Val  Acc: 0.9481
 Site-Painting                  (5) | Val  Loss: 0.2170 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2565 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.2727 | Val  Acc: 0.9427
 Site-Sketch                    (2) | Val  Loss: 0.3759 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.4786 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7207 | Val  Acc: 0.7982
 Site-Infograph                 (3) | Val  Loss: 0.8850 | Val  Acc: 0.7628
Average Valid Accuracy: 0.8963
 Test site-Clipart                   (4)| Epoch:43 | Test Acc: 0.8992
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9458
 Test site-Painting                  (5)| Epoch:43 | Test Acc: 0.9321
 Test site-Sketch                    (2)| Epoch:43 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7730
 Test site-Infograph                 (3)| Epoch:43 | Test Acc: 0.5662
Clipart: 0.8992, Real: 0.9458, Painting: 0.9321, Sketch: 0.8917, QuickDraw: 0.7730, Infograph: 0.5662, 
Average Test Accuracy(group): 0.8347, Average Test Accuracy(individual): 0.8874,
domain std=0.1324, cluster std=0.1324, individual std=0.0924, 
Average Test Accuracy: 0.8347
============ Train epoch 45 ============
cnt=[4, 1, 2, 5, 1, 3, ]
cnt=[3, 1, 5, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (3) | Train Loss: 0.4062 | Train Acc: 0.8696
 Site-Clipart                   (3) | Train Loss: 0.2610 | Train Acc: 0.9255
 Site-Clipart                   (3) | Train Loss: 0.3906 | Train Acc: 0.9111
 Site-Clipart                   (3) | Train Loss: 0.3533 | Train Acc: 0.8956
 Site-Clipart                   (3) | Train Loss: 0.3186 | Train Acc: 0.9321
 Site-Real                      (0) | Train Loss: 0.3185 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2020 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2076 | Train Acc: 0.9556
 Site-Real                      (0) | Train Loss: 0.2568 | Train Acc: 0.9483
 Site-Painting                  (5) | Train Loss: 0.3126 | Train Acc: 0.9184
 Site-Painting                  (5) | Train Loss: 0.2995 | Train Acc: 0.9078
 Site-Painting                  (5) | Train Loss: 0.2837 | Train Acc: 0.9412
 Site-Sketch                    (2) | Train Loss: 0.3982 | Train Acc: 0.8691
 Site-Sketch                    (2) | Train Loss: 0.4007 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.6297 | Train Acc: 0.7920
 Site-Infograph                 (4) | Train Loss: 0.8603 | Train Acc: 0.7051
Average Train Accuracy: 0.8946
 Site-Clipart                   (3) | Val  Loss: 0.2166 | Val  Acc: 0.9474
 Site-Clipart                   (3) | Val  Loss: 0.2899 | Val  Acc: 0.9346
 Site-Clipart                   (3) | Val  Loss: 0.3084 | Val  Acc: 0.9000
 Site-Clipart                   (3) | Val  Loss: 0.3470 | Val  Acc: 0.8762
 Site-Clipart                   (3) | Val  Loss: 0.3980 | Val  Acc: 0.8915
 Site-Real                      (0) | Val  Loss: 0.2096 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2444 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.1932 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.2037 | Val  Acc: 0.9610
 Site-Painting                  (5) | Val  Loss: 0.1868 | Val  Acc: 0.9694
 Site-Painting                  (5) | Val  Loss: 0.2595 | Val  Acc: 0.9343
 Site-Painting                  (5) | Val  Loss: 0.3091 | Val  Acc: 0.9219
 Site-Sketch                    (2) | Val  Loss: 0.3842 | Val  Acc: 0.8819
 Site-Sketch                    (2) | Val  Loss: 0.4072 | Val  Acc: 0.8708
 Site-QuickDraw                 (1) | Val  Loss: 0.7434 | Val  Acc: 0.7982
 Site-Infograph                 (4) | Val  Loss: 0.9639 | Val  Acc: 0.6987
Average Valid Accuracy: 0.9006
 Best site-Clipart                  (3)  | Epoch:45 | Val Acc: 0.9474
 Best site-Clipart                  (3)  | Epoch:45 | Val Acc: 0.9346
 Best site-Clipart                  (3)  | Epoch:45 | Val Acc: 0.9000
 Best site-Clipart                  (3)  | Epoch:45 | Val Acc: 0.8762
 Best site-Clipart                  (3)  | Epoch:45 | Val Acc: 0.8915
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9322
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9394
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9610
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9694
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9343
 Best site-Painting                 (5)  | Epoch:45 | Val Acc: 0.9219
 Best site-Sketch                   (2)  | Epoch:45 | Val Acc: 0.8819
 Best site-Sketch                   (2)  | Epoch:45 | Val Acc: 0.8708
 Best site-QuickDraw                (1)  | Epoch:45 | Val Acc: 0.7982
 Best site-Infograph                (4)  | Epoch:45 | Val Acc: 0.6987
 Test site-Clipart                   (3)| Epoch:45 | Test Acc: 0.9030
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9458
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9289
 Test site-Sketch                    (2)| Epoch:45 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7670
 Test site-Infograph                 (4)| Epoch:45 | Test Acc: 0.5693
Clipart: 0.9030, Real: 0.9458, Painting: 0.9289, Sketch: 0.8935, QuickDraw: 0.7670, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8346, Average Test Accuracy(individual): 0.8880,
domain std=0.1319, cluster std=0.1319, individual std=0.0921, 
Average Test Accuracy: 0.8346
============ Train epoch 46 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[2, 5, 1, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (0) | Train Loss: 0.3704 | Train Acc: 0.9043
 Site-Clipart                   (0) | Train Loss: 0.2876 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.4280 | Train Acc: 0.8756
 Site-Clipart                   (0) | Train Loss: 0.3382 | Train Acc: 0.9082
 Site-Clipart                   (0) | Train Loss: 0.3177 | Train Acc: 0.9231
 Site-Real                      (4) | Train Loss: 0.3089 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.1671 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.1926 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2337 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.3022 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3168 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.2405 | Train Acc: 0.9412
 Site-Sketch                    (5) | Train Loss: 0.4051 | Train Acc: 0.8796
 Site-Sketch                    (5) | Train Loss: 0.4131 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.6165 | Train Acc: 0.8196
 Site-Infograph                 (3) | Train Loss: 0.8348 | Train Acc: 0.7521
Average Train Accuracy: 0.8973
 Site-Clipart                   (0) | Val  Loss: 0.2301 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.2804 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3259 | Val  Acc: 0.9133
 Site-Clipart                   (0) | Val  Loss: 0.3522 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.4152 | Val  Acc: 0.8847
 Site-Real                      (4) | Val  Loss: 0.2236 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2507 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.1792 | Val  Acc: 0.9515
 Site-Real                      (4) | Val  Loss: 0.1869 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.1749 | Val  Acc: 0.9796
 Site-Painting                  (2) | Val  Loss: 0.2443 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.2918 | Val  Acc: 0.9427
 Site-Sketch                    (5) | Val  Loss: 0.3421 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4600 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7618 | Val  Acc: 0.7752
 Site-Infograph                 (3) | Val  Loss: 0.9336 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8979
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.9049
 Test site-Real                      (4)| Epoch:45 | Test Acc: 0.9458
 Test site-Painting                  (2)| Epoch:45 | Test Acc: 0.9305
 Test site-Sketch                    (5)| Epoch:45 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7610
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5693
Clipart: 0.9049, Real: 0.9458, Painting: 0.9305, Sketch: 0.8935, QuickDraw: 0.7610, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8342, Average Test Accuracy(individual): 0.8885,
domain std=0.1328, cluster std=0.1328, individual std=0.0929, 
Average Test Accuracy: 0.8342
============ Train epoch 47 ============
cnt=[1, 1, 5, 4, 2, 3, ]
cnt=[3, 1, 2, 5, 1, 4, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (2) | Train Loss: 0.3573 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.2736 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.4169 | Train Acc: 0.9067
 Site-Clipart                   (2) | Train Loss: 0.3315 | Train Acc: 0.8924
 Site-Clipart                   (2) | Train Loss: 0.3110 | Train Acc: 0.9299
 Site-Real                      (3) | Train Loss: 0.2912 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.1794 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.1956 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.2307 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.3509 | Train Acc: 0.9116
 Site-Painting                  (5) | Train Loss: 0.3638 | Train Acc: 0.8932
 Site-Painting                  (5) | Train Loss: 0.2931 | Train Acc: 0.9377
 Site-Sketch                    (4) | Train Loss: 0.3961 | Train Acc: 0.8796
 Site-Sketch                    (4) | Train Loss: 0.3898 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.6664 | Train Acc: 0.8349
 Site-Infograph                 (0) | Train Loss: 0.8339 | Train Acc: 0.7350
Average Train Accuracy: 0.8994
 Site-Clipart                   (2) | Val  Loss: 0.2063 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.2569 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.3319 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.3115 | Val  Acc: 0.8905
 Site-Clipart                   (2) | Val  Loss: 0.4078 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2171 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2379 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.1772 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2075 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.1911 | Val  Acc: 0.9694
 Site-Painting                  (5) | Val  Loss: 0.2314 | Val  Acc: 0.9197
 Site-Painting                  (5) | Val  Loss: 0.3462 | Val  Acc: 0.8958
 Site-Sketch                    (4) | Val  Loss: 0.4003 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.4456 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7037 | Val  Acc: 0.8165
 Site-Infograph                 (0) | Val  Loss: 0.9532 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8961
 Test site-Clipart                   (2)| Epoch:45 | Test Acc: 0.9030
 Test site-Real                      (3)| Epoch:45 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9354
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7600
 Test site-Infograph                 (0)| Epoch:45 | Test Acc: 0.5677
Clipart: 0.9030, Real: 0.9449, Painting: 0.9354, Sketch: 0.8935, QuickDraw: 0.7600, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8341, Average Test Accuracy(individual): 0.8885,
domain std=0.1337, cluster std=0.1337, individual std=0.0935, 
Average Test Accuracy: 0.8341
============ Train epoch 48 ============
cnt=[5, 1, 3, 1, 4, 2, ]
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.4371 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.2466 | Train Acc: 0.9379
 Site-Clipart                   (0) | Train Loss: 0.3951 | Train Acc: 0.8711
 Site-Clipart                   (0) | Train Loss: 0.3581 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.2962 | Train Acc: 0.9389
 Site-Real                      (4) | Train Loss: 0.3093 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.2045 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2046 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2390 | Train Acc: 0.9310
 Site-Painting                  (2) | Train Loss: 0.2840 | Train Acc: 0.9320
 Site-Painting                  (2) | Train Loss: 0.3008 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.2999 | Train Acc: 0.9135
 Site-Sketch                    (5) | Train Loss: 0.3759 | Train Acc: 0.8901
 Site-Sketch                    (5) | Train Loss: 0.3993 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.6382 | Train Acc: 0.8043
 Site-Infograph                 (3) | Train Loss: 0.8458 | Train Acc: 0.7179
Average Train Accuracy: 0.8908
 Site-Clipart                   (0) | Val  Loss: 0.1972 | Val  Acc: 0.9605
 Site-Clipart                   (0) | Val  Loss: 0.2696 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.2924 | Val  Acc: 0.9200
 Site-Clipart                   (0) | Val  Loss: 0.3449 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.4038 | Val  Acc: 0.8881
 Site-Real                      (4) | Val  Loss: 0.2113 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2151 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.1778 | Val  Acc: 0.9515
 Site-Real                      (4) | Val  Loss: 0.1867 | Val  Acc: 0.9567
 Site-Painting                  (2) | Val  Loss: 0.2114 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.2736 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.3080 | Val  Acc: 0.9115
 Site-Sketch                    (5) | Val  Loss: 0.3602 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4574 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7261 | Val  Acc: 0.7982
 Site-Infograph                 (3) | Val  Loss: 0.9572 | Val  Acc: 0.7051
Average Valid Accuracy: 0.9004
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.9011
 Test site-Real                      (4)| Epoch:45 | Test Acc: 0.9474
 Test site-Painting                  (2)| Epoch:45 | Test Acc: 0.9338
 Test site-Sketch                    (5)| Epoch:45 | Test Acc: 0.8953
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7740
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5677
Clipart: 0.9011, Real: 0.9474, Painting: 0.9338, Sketch: 0.8953, QuickDraw: 0.7740, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8366, Average Test Accuracy(individual): 0.8893,
domain std=0.1326, cluster std=0.1326, individual std=0.0925, 
Average Test Accuracy: 0.8366
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
============ Train epoch 49 ============
cnt=[4, 1, 1, 2, 3, 5, ]
cnt=[1, 5, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (5) | Train Loss: 0.3522 | Train Acc: 0.8870
 Site-Clipart                   (5) | Train Loss: 0.2587 | Train Acc: 0.9255
 Site-Clipart                   (5) | Train Loss: 0.3532 | Train Acc: 0.9022
 Site-Clipart                   (5) | Train Loss: 0.3301 | Train Acc: 0.9114
 Site-Clipart                   (5) | Train Loss: 0.3030 | Train Acc: 0.9344
 Site-Real                      (0) | Train Loss: 0.2959 | Train Acc: 0.9286
 Site-Real                      (0) | Train Loss: 0.1866 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2015 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.2347 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.3404 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.2482 | Train Acc: 0.9272
 Site-Painting                  (4) | Train Loss: 0.2861 | Train Acc: 0.9273
 Site-Sketch                    (3) | Train Loss: 0.3916 | Train Acc: 0.8691
 Site-Sketch                    (3) | Train Loss: 0.4788 | Train Acc: 0.8801
 Site-QuickDraw                 (1) | Train Loss: 0.5942 | Train Acc: 0.8135
 Site-Infograph                 (2) | Train Loss: 0.7935 | Train Acc: 0.7949
Average Train Accuracy: 0.9026
 Site-Clipart                   (5) | Val  Loss: 0.2387 | Val  Acc: 0.9605
 Site-Clipart                   (5) | Val  Loss: 0.2884 | Val  Acc: 0.9159
 Site-Clipart                   (5) | Val  Loss: 0.3383 | Val  Acc: 0.9133
 Site-Clipart                   (5) | Val  Loss: 0.3321 | Val  Acc: 0.8905
 Site-Clipart                   (5) | Val  Loss: 0.4049 | Val  Acc: 0.8847
 Site-Real                      (0) | Val  Loss: 0.2120 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2303 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.1957 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.1947 | Val  Acc: 0.9654
 Site-Painting                  (4) | Val  Loss: 0.1864 | Val  Acc: 0.9592
 Site-Painting                  (4) | Val  Loss: 0.2684 | Val  Acc: 0.9343
 Site-Painting                  (4) | Val  Loss: 0.2813 | Val  Acc: 0.9271
 Site-Sketch                    (3) | Val  Loss: 0.3980 | Val  Acc: 0.8661
 Site-Sketch                    (3) | Val  Loss: 0.4446 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.7440 | Val  Acc: 0.8119
 Site-Infograph                 (2) | Val  Loss: 0.9965 | Val  Acc: 0.7308
Average Valid Accuracy: 0.9029
 Best site-Clipart                  (5)  | Epoch:49 | Val Acc: 0.9605
 Best site-Clipart                  (5)  | Epoch:49 | Val Acc: 0.9159
 Best site-Clipart                  (5)  | Epoch:49 | Val Acc: 0.9133
 Best site-Clipart                  (5)  | Epoch:49 | Val Acc: 0.8905
 Best site-Clipart                  (5)  | Epoch:49 | Val Acc: 0.8847
 Best site-Real                     (0)  | Epoch:49 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:49 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:49 | Val Acc: 0.9455
 Best site-Real                     (0)  | Epoch:49 | Val Acc: 0.9654
 Best site-Painting                 (4)  | Epoch:49 | Val Acc: 0.9592
 Best site-Painting                 (4)  | Epoch:49 | Val Acc: 0.9343
 Best site-Painting                 (4)  | Epoch:49 | Val Acc: 0.9271
 Best site-Sketch                   (3)  | Epoch:49 | Val Acc: 0.8661
 Best site-Sketch                   (3)  | Epoch:49 | Val Acc: 0.8596
 Best site-QuickDraw                (1)  | Epoch:49 | Val Acc: 0.8119
 Best site-Infograph                (2)  | Epoch:49 | Val Acc: 0.7308
 Test site-Clipart                   (5)| Epoch:49 | Test Acc: 0.9011
 Test site-Real                      (0)| Epoch:49 | Test Acc: 0.9499
 Test site-Painting                  (4)| Epoch:49 | Test Acc: 0.9338
 Test site-Sketch                    (3)| Epoch:49 | Test Acc: 0.8953
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7700
 Test site-Infograph                 (2)| Epoch:49 | Test Acc: 0.5708
Clipart: 0.9011, Real: 0.9499, Painting: 0.9338, Sketch: 0.8953, QuickDraw: 0.7700, Infograph: 0.5708, 
Average Test Accuracy(group): 0.8368, Average Test Accuracy(individual): 0.8899,
domain std=0.1323, cluster std=0.1323, individual std=0.0926, 
Average Test Accuracy: 0.8368
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1_gmap...
 Test site-Clipart                   (5)| Epoch:49 | Test Acc: 0.9011
 Test site-Real                      (0)| Epoch:49 | Test Acc: 0.9499
 Test site-Painting                  (4)| Epoch:49 | Test Acc: 0.9338
 Test site-Sketch                    (3)| Epoch:49 | Test Acc: 0.8953
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7700
 Test site-Infograph                 (2)| Epoch:49 | Test Acc: 0.5708
Clipart: 0.9011, Real: 0.9499, Painting: 0.9338, Sketch: 0.8953, QuickDraw: 0.7700, Infograph: 0.5708, 
Average Test Accuracy(group): 0.8368, Average Test Accuracy(individual): 0.8899,
domain std=0.1323, cluster std=0.1323, individual std=0.0926, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_clscon/ccop_q=1...
===2023-06-26 19:02:30===
===2023-06-26 19:02:38===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (5)| Epoch:49 | Test Acc: 0.9011
 Test site-Real                      (0)| Epoch:49 | Test Acc: 0.9499
 Test site-Painting                  (4)| Epoch:49 | Test Acc: 0.9338
 Test site-Sketch                    (3)| Epoch:49 | Test Acc: 0.8953
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7700
 Test site-Infograph                 (2)| Epoch:49 | Test Acc: 0.5708
Clipart: 0.9011, Real: 0.9499, Painting: 0.9338, Sketch: 0.8953, QuickDraw: 0.7700, Infograph: 0.5708, 
Average Test Accuracy(group): 0.8368, Average Test Accuracy(individual): 0.8899,
domain std=0.1323, cluster std=0.1323, individual std=0.0926, 
