===2023-08-04 13:45:54===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[89,134,200,300,449,56,98,170,64,128,112,
client_nums=[5,3,2,1,]
len_dataset=[1959,544,320,188,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-amazon                    (0) | Train Loss: 3.1916 | Train Acc: 0.1461
 Site-amazon                    (0) | Train Loss: 3.1209 | Train Acc: 0.2313
 Site-amazon                    (0) | Train Loss: 3.1304 | Train Acc: 0.2300
 Site-amazon                    (1) | Train Loss: 3.1311 | Train Acc: 0.2200
 Site-amazon                    (1) | Train Loss: 3.1577 | Train Acc: 0.2027
 Site-webcam                    (2) | Train Loss: 3.2692 | Train Acc: 0.1429
 Site-webcam                    (2) | Train Loss: 3.2454 | Train Acc: 0.1633
 Site-webcam                    (2) | Train Loss: 3.2944 | Train Acc: 0.1059
 Site-dslr                      (3) | Train Loss: 3.2714 | Train Acc: 0.1094
 Site-dslr                      (3) | Train Loss: 3.2636 | Train Acc: 0.1250
 Site-synthetic                 (0) | Train Loss: 3.3052 | Train Acc: 0.0804
Average Train Accuracy: 0.1597
 Site-amazon                    (0) | Val  Loss: 3.1432 | Val  Acc: 0.1186
 Site-amazon                    (0) | Val  Loss: 3.1292 | Val  Acc: 0.2022
 Site-amazon                    (0) | Val  Loss: 3.1487 | Val  Acc: 0.2406
 Site-amazon                    (1) | Val  Loss: 3.0965 | Val  Acc: 0.2550
 Site-amazon                    (1) | Val  Loss: 3.1522 | Val  Acc: 0.2207
 Site-webcam                    (2) | Val  Loss: 3.2756 | Val  Acc: 0.1081
 Site-webcam                    (2) | Val  Loss: 3.1747 | Val  Acc: 0.1385
 Site-webcam                    (2) | Val  Loss: 3.2879 | Val  Acc: 0.0796
 Site-dslr                      (3) | Val  Loss: 3.2609 | Val  Acc: 0.1905
 Site-dslr                      (3) | Val  Loss: 3.2488 | Val  Acc: 0.1294
 Site-synthetic                 (0) | Val  Loss: 3.3524 | Val  Acc: 0.0933
Average Valid Accuracy: 0.1615
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.1186
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.2022
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.2406
 Best site-amazon                   (1)  | Epoch:0 | Val Acc: 0.2550
 Best site-amazon                   (1)  | Epoch:0 | Val Acc: 0.2207
 Best site-webcam                   (2)  | Epoch:0 | Val Acc: 0.1081
 Best site-webcam                   (2)  | Epoch:0 | Val Acc: 0.1385
 Best site-webcam                   (2)  | Epoch:0 | Val Acc: 0.0796
 Best site-dslr                     (3)  | Epoch:0 | Val Acc: 0.1905
 Best site-dslr                     (3)  | Epoch:0 | Val Acc: 0.1294
 Best site-synthetic                (0)  | Epoch:0 | Val Acc: 0.0933
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 1 ============
cnt=[6, 3, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-amazon                    (0) | Train Loss: 2.7339 | Train Acc: 0.5281
 Site-amazon                    (0) | Train Loss: 2.7208 | Train Acc: 0.5522
 Site-amazon                    (0) | Train Loss: 2.7043 | Train Acc: 0.5850
 Site-amazon                    (0) | Train Loss: 2.6658 | Train Acc: 0.5433
 Site-amazon                    (0) | Train Loss: 2.8240 | Train Acc: 0.5033
 Site-webcam                    (1) | Train Loss: 2.9383 | Train Acc: 0.4107
 Site-webcam                    (1) | Train Loss: 2.8430 | Train Acc: 0.4592
 Site-webcam                    (1) | Train Loss: 2.8869 | Train Acc: 0.3824
 Site-dslr                      (2) | Train Loss: 2.8710 | Train Acc: 0.4375
 Site-dslr                      (2) | Train Loss: 2.8522 | Train Acc: 0.3984
 Site-synthetic                 (0) | Train Loss: 3.0788 | Train Acc: 0.2054
Average Train Accuracy: 0.4550
 Site-amazon                    (0) | Val  Loss: 2.6499 | Val  Acc: 0.5932
 Site-amazon                    (0) | Val  Loss: 2.7092 | Val  Acc: 0.5281
 Site-amazon                    (0) | Val  Loss: 2.6727 | Val  Acc: 0.5564
 Site-amazon                    (0) | Val  Loss: 2.5867 | Val  Acc: 0.5650
 Site-amazon                    (0) | Val  Loss: 2.6893 | Val  Acc: 0.5318
 Site-webcam                    (1) | Val  Loss: 2.9685 | Val  Acc: 0.3784
 Site-webcam                    (1) | Val  Loss: 2.8423 | Val  Acc: 0.3077
 Site-webcam                    (1) | Val  Loss: 2.8812 | Val  Acc: 0.3540
 Site-dslr                      (2) | Val  Loss: 2.7885 | Val  Acc: 0.4524
 Site-dslr                      (2) | Val  Loss: 2.8393 | Val  Acc: 0.3647
 Site-synthetic                 (0) | Val  Loss: 3.1459 | Val  Acc: 0.1467
Average Valid Accuracy: 0.4344
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.5932
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.5281
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.5564
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.5650
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.5318
 Best site-webcam                   (1)  | Epoch:1 | Val Acc: 0.3784
 Best site-webcam                   (1)  | Epoch:1 | Val Acc: 0.3077
 Best site-webcam                   (1)  | Epoch:1 | Val Acc: 0.3540
 Best site-dslr                     (2)  | Epoch:1 | Val Acc: 0.4524
 Best site-dslr                     (2)  | Epoch:1 | Val Acc: 0.3647
 Best site-synthetic                (0)  | Epoch:1 | Val Acc: 0.1467
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 2 ============
cnt=[6, 3, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-amazon                    (0) | Train Loss: 2.4046 | Train Acc: 0.6292
 Site-amazon                    (0) | Train Loss: 2.1526 | Train Acc: 0.7463
 Site-amazon                    (0) | Train Loss: 2.3543 | Train Acc: 0.7150
 Site-amazon                    (0) | Train Loss: 2.2278 | Train Acc: 0.7233
 Site-amazon                    (0) | Train Loss: 2.2842 | Train Acc: 0.6815
 Site-webcam                    (1) | Train Loss: 2.5595 | Train Acc: 0.5000
 Site-webcam                    (1) | Train Loss: 2.4675 | Train Acc: 0.6020
 Site-webcam                    (1) | Train Loss: 2.5405 | Train Acc: 0.5765
 Site-dslr                      (2) | Train Loss: 2.4587 | Train Acc: 0.6562
 Site-dslr                      (2) | Train Loss: 2.4694 | Train Acc: 0.5938
 Site-synthetic                 (0) | Train Loss: 2.8689 | Train Acc: 0.3036
Average Train Accuracy: 0.6116
 Site-amazon                    (0) | Val  Loss: 2.2444 | Val  Acc: 0.7797
 Site-amazon                    (0) | Val  Loss: 2.2388 | Val  Acc: 0.7079
 Site-amazon                    (0) | Val  Loss: 2.2243 | Val  Acc: 0.7519
 Site-amazon                    (0) | Val  Loss: 2.1481 | Val  Acc: 0.7450
 Site-amazon                    (0) | Val  Loss: 2.2735 | Val  Acc: 0.7023
 Site-webcam                    (1) | Val  Loss: 2.5059 | Val  Acc: 0.4865
 Site-webcam                    (1) | Val  Loss: 2.2720 | Val  Acc: 0.5077
 Site-webcam                    (1) | Val  Loss: 2.5094 | Val  Acc: 0.5664
 Site-dslr                      (2) | Val  Loss: 2.3800 | Val  Acc: 0.5238
 Site-dslr                      (2) | Val  Loss: 2.4032 | Val  Acc: 0.4941
 Site-synthetic                 (0) | Val  Loss: 2.9077 | Val  Acc: 0.2800
Average Valid Accuracy: 0.5950
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.7797
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.7079
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.7519
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.7450
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.7023
 Best site-webcam                   (1)  | Epoch:2 | Val Acc: 0.4865
 Best site-webcam                   (1)  | Epoch:2 | Val Acc: 0.5077
 Best site-webcam                   (1)  | Epoch:2 | Val Acc: 0.5664
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.5238
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.4941
 Best site-synthetic                (0)  | Epoch:2 | Val Acc: 0.2800
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 3 ============
cnt=[5, 3, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-amazon                    (0) | Train Loss: 2.1095 | Train Acc: 0.7528
 Site-amazon                    (0) | Train Loss: 1.8133 | Train Acc: 0.8060
 Site-amazon                    (0) | Train Loss: 1.8335 | Train Acc: 0.8050
 Site-amazon                    (0) | Train Loss: 1.8300 | Train Acc: 0.8300
 Site-amazon                    (0) | Train Loss: 1.9019 | Train Acc: 0.8174
 Site-webcam                    (1) | Train Loss: 2.2370 | Train Acc: 0.6429
 Site-webcam                    (1) | Train Loss: 2.1109 | Train Acc: 0.6939
 Site-webcam                    (1) | Train Loss: 2.2130 | Train Acc: 0.6765
 Site-dslr                      (2) | Train Loss: 2.1591 | Train Acc: 0.7188
 Site-dslr                      (2) | Train Loss: 2.1346 | Train Acc: 0.6328
 Site-synthetic                 (2) | Train Loss: 2.6747 | Train Acc: 0.3661
Average Train Accuracy: 0.7038
 Site-amazon                    (0) | Val  Loss: 1.8170 | Val  Acc: 0.8475
 Site-amazon                    (0) | Val  Loss: 1.8579 | Val  Acc: 0.7865
 Site-amazon                    (0) | Val  Loss: 1.9329 | Val  Acc: 0.8120
 Site-amazon                    (0) | Val  Loss: 1.7457 | Val  Acc: 0.8250
 Site-amazon                    (0) | Val  Loss: 1.8572 | Val  Acc: 0.8328
 Site-webcam                    (1) | Val  Loss: 2.1431 | Val  Acc: 0.5946
 Site-webcam                    (1) | Val  Loss: 2.0205 | Val  Acc: 0.5692
 Site-webcam                    (1) | Val  Loss: 2.1522 | Val  Acc: 0.6991
 Site-dslr                      (2) | Val  Loss: 2.0027 | Val  Acc: 0.6667
 Site-dslr                      (2) | Val  Loss: 2.1529 | Val  Acc: 0.5647
 Site-synthetic                 (2) | Val  Loss: 2.7431 | Val  Acc: 0.3200
Average Valid Accuracy: 0.6835
 Best site-amazon                   (0)  | Epoch:3 | Val Acc: 0.8475
 Best site-amazon                   (0)  | Epoch:3 | Val Acc: 0.7865
 Best site-amazon                   (0)  | Epoch:3 | Val Acc: 0.8120
 Best site-amazon                   (0)  | Epoch:3 | Val Acc: 0.8250
 Best site-amazon                   (0)  | Epoch:3 | Val Acc: 0.8328
 Best site-webcam                   (1)  | Epoch:3 | Val Acc: 0.5946
 Best site-webcam                   (1)  | Epoch:3 | Val Acc: 0.5692
 Best site-webcam                   (1)  | Epoch:3 | Val Acc: 0.6991
 Best site-dslr                     (2)  | Epoch:3 | Val Acc: 0.6667
 Best site-dslr                     (2)  | Epoch:3 | Val Acc: 0.5647
 Best site-synthetic                (2)  | Epoch:3 | Val Acc: 0.3200
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_finch_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_finch...
============ Train epoch 4 ============
