===2023-08-04 16:29:30===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[89,134,200,300,449,56,98,170,64,128,112,
client_nums=[5,3,2,1,]
len_dataset=[1959,544,320,188,]
domain number = 4
============ Train epoch 0 ============
 Site-amazon                        | Train Loss: 3.2618 | Train Acc: 0.3933
 Site-amazon                        | Train Loss: 3.2630 | Train Acc: 0.3955
 Site-amazon                        | Train Loss: 3.2769 | Train Acc: 0.3450
 Site-amazon                        | Train Loss: 3.2820 | Train Acc: 0.3933
 Site-amazon                        | Train Loss: 3.2788 | Train Acc: 0.3742
 Site-webcam                        | Train Loss: 3.3108 | Train Acc: 0.3036
 Site-webcam                        | Train Loss: 3.2956 | Train Acc: 0.3673
 Site-webcam                        | Train Loss: 3.3106 | Train Acc: 0.2706
 Site-dslr                          | Train Loss: 3.3272 | Train Acc: 0.2031
 Site-dslr                          | Train Loss: 3.2995 | Train Acc: 0.3047
 Site-synthetic                     | Train Loss: 3.3799 | Train Acc: 0.1518
Average Train Accuracy: 0.3184
 Site-amazon                        | Val  Loss: 3.2497 | Val  Acc: 0.5085
 Site-amazon                        | Val  Loss: 3.2766 | Val  Acc: 0.3820
 Site-amazon                        | Val  Loss: 3.3032 | Val  Acc: 0.3534
 Site-amazon                        | Val  Loss: 3.2801 | Val  Acc: 0.4200
 Site-amazon                        | Val  Loss: 3.2754 | Val  Acc: 0.3612
 Site-webcam                        | Val  Loss: 3.3192 | Val  Acc: 0.2703
 Site-webcam                        | Val  Loss: 3.2897 | Val  Acc: 0.2923
 Site-webcam                        | Val  Loss: 3.2885 | Val  Acc: 0.3717
 Site-dslr                          | Val  Loss: 3.2866 | Val  Acc: 0.3095
 Site-dslr                          | Val  Loss: 3.2921 | Val  Acc: 0.3176
 Site-synthetic                     | Val  Loss: 3.3469 | Val  Acc: 0.1333
Average Valid Accuracy: 0.3382
 Best site-amazon                    | Epoch:0 | Val Acc: 0.5085
 Best site-amazon                    | Epoch:0 | Val Acc: 0.3820
 Best site-amazon                    | Epoch:0 | Val Acc: 0.3534
 Best site-amazon                    | Epoch:0 | Val Acc: 0.4200
 Best site-amazon                    | Epoch:0 | Val Acc: 0.3612
 Best site-webcam                    | Epoch:0 | Val Acc: 0.2703
 Best site-webcam                    | Epoch:0 | Val Acc: 0.2923
 Best site-webcam                    | Epoch:0 | Val Acc: 0.3717
 Best site-dslr                      | Epoch:0 | Val Acc: 0.3095
 Best site-dslr                      | Epoch:0 | Val Acc: 0.3176
 Best site-synthetic                 | Epoch:0 | Val Acc: 0.1333
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 1 ============
 Site-amazon                        | Train Loss: 3.1169 | Train Acc: 0.7416
 Site-amazon                        | Train Loss: 3.0951 | Train Acc: 0.7761
 Site-amazon                        | Train Loss: 3.0947 | Train Acc: 0.7150
 Site-amazon                        | Train Loss: 3.1195 | Train Acc: 0.7033
 Site-amazon                        | Train Loss: 3.0875 | Train Acc: 0.7394
 Site-webcam                        | Train Loss: 3.1741 | Train Acc: 0.6250
 Site-webcam                        | Train Loss: 3.1330 | Train Acc: 0.6531
 Site-webcam                        | Train Loss: 3.1668 | Train Acc: 0.6000
 Site-dslr                          | Train Loss: 3.1717 | Train Acc: 0.6250
 Site-dslr                          | Train Loss: 3.1550 | Train Acc: 0.6641
 Site-synthetic                     | Train Loss: 3.2962 | Train Acc: 0.2411
Average Train Accuracy: 0.6440
 Site-amazon                        | Val  Loss: 3.0833 | Val  Acc: 0.7627
 Site-amazon                        | Val  Loss: 3.1165 | Val  Acc: 0.6854
 Site-amazon                        | Val  Loss: 3.1394 | Val  Acc: 0.6992
 Site-amazon                        | Val  Loss: 3.1210 | Val  Acc: 0.7750
 Site-amazon                        | Val  Loss: 3.1089 | Val  Acc: 0.7492
 Site-webcam                        | Val  Loss: 3.1796 | Val  Acc: 0.5676
 Site-webcam                        | Val  Loss: 3.1363 | Val  Acc: 0.6615
 Site-webcam                        | Val  Loss: 3.1472 | Val  Acc: 0.6637
 Site-dslr                          | Val  Loss: 3.1456 | Val  Acc: 0.6429
 Site-dslr                          | Val  Loss: 3.1492 | Val  Acc: 0.6235
 Site-synthetic                     | Val  Loss: 3.2882 | Val  Acc: 0.1867
Average Valid Accuracy: 0.6379
 Best site-amazon                    | Epoch:1 | Val Acc: 0.7627
 Best site-amazon                    | Epoch:1 | Val Acc: 0.6854
 Best site-amazon                    | Epoch:1 | Val Acc: 0.6992
 Best site-amazon                    | Epoch:1 | Val Acc: 0.7750
 Best site-amazon                    | Epoch:1 | Val Acc: 0.7492
 Best site-webcam                    | Epoch:1 | Val Acc: 0.5676
 Best site-webcam                    | Epoch:1 | Val Acc: 0.6615
 Best site-webcam                    | Epoch:1 | Val Acc: 0.6637
 Best site-dslr                      | Epoch:1 | Val Acc: 0.6429
 Best site-dslr                      | Epoch:1 | Val Acc: 0.6235
 Best site-synthetic                 | Epoch:1 | Val Acc: 0.1867
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 2 ============
 Site-amazon                        | Train Loss: 2.9678 | Train Acc: 0.8427
 Site-amazon                        | Train Loss: 2.9156 | Train Acc: 0.8582
 Site-amazon                        | Train Loss: 2.9464 | Train Acc: 0.8650
 Site-amazon                        | Train Loss: 2.9585 | Train Acc: 0.8467
 Site-amazon                        | Train Loss: 2.9626 | Train Acc: 0.8552
 Site-webcam                        | Train Loss: 3.0424 | Train Acc: 0.6786
 Site-webcam                        | Train Loss: 2.9999 | Train Acc: 0.7653
 Site-webcam                        | Train Loss: 3.0371 | Train Acc: 0.7588
 Site-dslr                          | Train Loss: 3.0604 | Train Acc: 0.7812
 Site-dslr                          | Train Loss: 3.0103 | Train Acc: 0.7891
 Site-synthetic                     | Train Loss: 3.2132 | Train Acc: 0.3393
Average Train Accuracy: 0.7618
 Site-amazon                        | Val  Loss: 2.9035 | Val  Acc: 0.8983
 Site-amazon                        | Val  Loss: 2.9523 | Val  Acc: 0.8427
 Site-amazon                        | Val  Loss: 2.9701 | Val  Acc: 0.8271
 Site-amazon                        | Val  Loss: 2.9624 | Val  Acc: 0.8550
 Site-amazon                        | Val  Loss: 2.9470 | Val  Acc: 0.8127
 Site-webcam                        | Val  Loss: 3.0393 | Val  Acc: 0.7568
 Site-webcam                        | Val  Loss: 2.9738 | Val  Acc: 0.8154
 Site-webcam                        | Val  Loss: 3.0067 | Val  Acc: 0.8584
 Site-dslr                          | Val  Loss: 2.9824 | Val  Acc: 0.7857
 Site-dslr                          | Val  Loss: 2.9946 | Val  Acc: 0.7647
 Site-synthetic                     | Val  Loss: 3.2069 | Val  Acc: 0.2800
Average Valid Accuracy: 0.7724
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8983
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8427
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8271
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8550
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8127
 Best site-webcam                    | Epoch:2 | Val Acc: 0.7568
 Best site-webcam                    | Epoch:2 | Val Acc: 0.8154
 Best site-webcam                    | Epoch:2 | Val Acc: 0.8584
 Best site-dslr                      | Epoch:2 | Val Acc: 0.7857
 Best site-dslr                      | Epoch:2 | Val Acc: 0.7647
 Best site-synthetic                 | Epoch:2 | Val Acc: 0.2800
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 3 ============
 Site-amazon                        | Train Loss: 2.8022 | Train Acc: 0.8989
 Site-amazon                        | Train Loss: 2.8018 | Train Acc: 0.8881
 Site-amazon                        | Train Loss: 2.7612 | Train Acc: 0.9050
 Site-amazon                        | Train Loss: 2.7951 | Train Acc: 0.8700
 Site-amazon                        | Train Loss: 2.7761 | Train Acc: 0.8909
 Site-webcam                        | Train Loss: 2.9251 | Train Acc: 0.7143
 Site-webcam                        | Train Loss: 2.8313 | Train Acc: 0.8367
 Site-webcam                        | Train Loss: 2.9104 | Train Acc: 0.8059
 Site-dslr                          | Train Loss: 2.9168 | Train Acc: 0.8594
 Site-dslr                          | Train Loss: 2.8641 | Train Acc: 0.8203
 Site-synthetic                     | Train Loss: 3.1572 | Train Acc: 0.3482
Average Train Accuracy: 0.8034
 Site-amazon                        | Val  Loss: 2.7162 | Val  Acc: 0.9322
 Site-amazon                        | Val  Loss: 2.8036 | Val  Acc: 0.8539
 Site-amazon                        | Val  Loss: 2.8626 | Val  Acc: 0.8571
 Site-amazon                        | Val  Loss: 2.8032 | Val  Acc: 0.9150
 Site-amazon                        | Val  Loss: 2.7816 | Val  Acc: 0.8829
 Site-webcam                        | Val  Loss: 2.8766 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 2.7874 | Val  Acc: 0.8462
 Site-webcam                        | Val  Loss: 2.8726 | Val  Acc: 0.8938
 Site-dslr                          | Val  Loss: 2.8520 | Val  Acc: 0.8333
 Site-dslr                          | Val  Loss: 2.8434 | Val  Acc: 0.8000
 Site-synthetic                     | Val  Loss: 3.1232 | Val  Acc: 0.2933
Average Valid Accuracy: 0.8132
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9322
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8539
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8571
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9150
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8829
 Best site-webcam                    | Epoch:3 | Val Acc: 0.8378
 Best site-webcam                    | Epoch:3 | Val Acc: 0.8462
 Best site-webcam                    | Epoch:3 | Val Acc: 0.8938
 Best site-dslr                      | Epoch:3 | Val Acc: 0.8333
 Best site-dslr                      | Epoch:3 | Val Acc: 0.8000
 Best site-synthetic                 | Epoch:3 | Val Acc: 0.2933
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 4 ============
 Site-amazon                        | Train Loss: 2.6411 | Train Acc: 0.9213
 Site-amazon                        | Train Loss: 2.5586 | Train Acc: 0.9104
 Site-amazon                        | Train Loss: 2.6437 | Train Acc: 0.9100
 Site-amazon                        | Train Loss: 2.6338 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 2.6479 | Train Acc: 0.8931
 Site-webcam                        | Train Loss: 2.7556 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 2.7002 | Train Acc: 0.8163
 Site-webcam                        | Train Loss: 2.7757 | Train Acc: 0.8294
 Site-dslr                          | Train Loss: 2.7908 | Train Acc: 0.8438
 Site-dslr                          | Train Loss: 2.7364 | Train Acc: 0.8281
 Site-synthetic                     | Train Loss: 3.0868 | Train Acc: 0.3929
Average Train Accuracy: 0.8275
 Site-amazon                        | Val  Loss: 2.5635 | Val  Acc: 0.9153
 Site-amazon                        | Val  Loss: 2.6512 | Val  Acc: 0.8989
 Site-amazon                        | Val  Loss: 2.7078 | Val  Acc: 0.8947
 Site-amazon                        | Val  Loss: 2.6466 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 2.6261 | Val  Acc: 0.8896
 Site-webcam                        | Val  Loss: 2.7509 | Val  Acc: 0.7838
 Site-webcam                        | Val  Loss: 2.6194 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 2.7195 | Val  Acc: 0.8584
 Site-dslr                          | Val  Loss: 2.7178 | Val  Acc: 0.7857
 Site-dslr                          | Val  Loss: 2.7292 | Val  Acc: 0.7765
 Site-synthetic                     | Val  Loss: 3.0853 | Val  Acc: 0.3067
Average Valid Accuracy: 0.8070
============ Train epoch 5 ============
 Site-amazon                        | Train Loss: 2.4770 | Train Acc: 0.9213
 Site-amazon                        | Train Loss: 2.4472 | Train Acc: 0.9254
 Site-amazon                        | Train Loss: 2.4735 | Train Acc: 0.9350
 Site-amazon                        | Train Loss: 2.4841 | Train Acc: 0.9133
 Site-amazon                        | Train Loss: 2.4093 | Train Acc: 0.9020
 Site-webcam                        | Train Loss: 2.6611 | Train Acc: 0.7679
 Site-webcam                        | Train Loss: 2.5760 | Train Acc: 0.8673
 Site-webcam                        | Train Loss: 2.6202 | Train Acc: 0.8706
 Site-dslr                          | Train Loss: 2.6617 | Train Acc: 0.8594
 Site-dslr                          | Train Loss: 2.5912 | Train Acc: 0.8438
 Site-synthetic                     | Train Loss: 3.0364 | Train Acc: 0.4286
Average Train Accuracy: 0.8395
 Site-amazon                        | Val  Loss: 2.4335 | Val  Acc: 0.8814
 Site-amazon                        | Val  Loss: 2.5017 | Val  Acc: 0.8876
 Site-amazon                        | Val  Loss: 2.5689 | Val  Acc: 0.8872
 Site-amazon                        | Val  Loss: 2.5012 | Val  Acc: 0.9200
 Site-amazon                        | Val  Loss: 2.4759 | Val  Acc: 0.8930
 Site-webcam                        | Val  Loss: 2.6203 | Val  Acc: 0.8108
 Site-webcam                        | Val  Loss: 2.4532 | Val  Acc: 0.8308
 Site-webcam                        | Val  Loss: 2.5904 | Val  Acc: 0.8938
 Site-dslr                          | Val  Loss: 2.5571 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 2.5829 | Val  Acc: 0.8235
 Site-synthetic                     | Val  Loss: 3.0086 | Val  Acc: 0.3200
Average Valid Accuracy: 0.8230
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8814
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8876
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8872
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9200
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8930
 Best site-webcam                    | Epoch:5 | Val Acc: 0.8108
 Best site-webcam                    | Epoch:5 | Val Acc: 0.8308
 Best site-webcam                    | Epoch:5 | Val Acc: 0.8938
 Best site-dslr                      | Epoch:5 | Val Acc: 0.9048
 Best site-dslr                      | Epoch:5 | Val Acc: 0.8235
 Best site-synthetic                 | Epoch:5 | Val Acc: 0.3200
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 6 ============
 Site-amazon                        | Train Loss: 2.3546 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 2.2728 | Train Acc: 0.9328
 Site-amazon                        | Train Loss: 2.3101 | Train Acc: 0.9450
 Site-amazon                        | Train Loss: 2.3319 | Train Acc: 0.9100
 Site-amazon                        | Train Loss: 2.4034 | Train Acc: 0.9020
 Site-webcam                        | Train Loss: 2.4906 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 2.4518 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 2.5283 | Train Acc: 0.8235
 Site-dslr                          | Train Loss: 2.5522 | Train Acc: 0.8906
 Site-dslr                          | Train Loss: 2.4937 | Train Acc: 0.8281
 Site-synthetic                     | Train Loss: 2.9383 | Train Acc: 0.4375
Average Train Accuracy: 0.8441
 Site-amazon                        | Val  Loss: 2.2578 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 2.3490 | Val  Acc: 0.8989
 Site-amazon                        | Val  Loss: 2.4428 | Val  Acc: 0.9098
 Site-amazon                        | Val  Loss: 2.3298 | Val  Acc: 0.9150
 Site-amazon                        | Val  Loss: 2.3161 | Val  Acc: 0.9164
 Site-webcam                        | Val  Loss: 2.4881 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 2.3151 | Val  Acc: 0.9077
 Site-webcam                        | Val  Loss: 2.4991 | Val  Acc: 0.8230
 Site-dslr                          | Val  Loss: 2.4224 | Val  Acc: 0.8095
 Site-dslr                          | Val  Loss: 2.4214 | Val  Acc: 0.8588
 Site-synthetic                     | Val  Loss: 2.9693 | Val  Acc: 0.2800
Average Valid Accuracy: 0.8303
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9492
 Best site-amazon                    | Epoch:6 | Val Acc: 0.8989
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9098
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9150
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9164
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8649
 Best site-webcam                    | Epoch:6 | Val Acc: 0.9077
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8230
 Best site-dslr                      | Epoch:6 | Val Acc: 0.8095
 Best site-dslr                      | Epoch:6 | Val Acc: 0.8588
 Best site-synthetic                 | Epoch:6 | Val Acc: 0.2800
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 7 ============
 Site-amazon                        | Train Loss: 2.1838 | Train Acc: 0.9326
 Site-amazon                        | Train Loss: 2.1678 | Train Acc: 0.9030
 Site-amazon                        | Train Loss: 2.2102 | Train Acc: 0.9150
 Site-amazon                        | Train Loss: 2.2026 | Train Acc: 0.9067
 Site-amazon                        | Train Loss: 2.2496 | Train Acc: 0.9087
 Site-webcam                        | Train Loss: 2.4006 | Train Acc: 0.7857
 Site-webcam                        | Train Loss: 2.2879 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 2.3998 | Train Acc: 0.9059
 Site-dslr                          | Train Loss: 2.4018 | Train Acc: 0.8750
 Site-dslr                          | Train Loss: 2.3874 | Train Acc: 0.8438
 Site-synthetic                     | Train Loss: 2.9142 | Train Acc: 0.4464
Average Train Accuracy: 0.8464
 Site-amazon                        | Val  Loss: 2.1241 | Val  Acc: 0.9153
 Site-amazon                        | Val  Loss: 2.2076 | Val  Acc: 0.8876
 Site-amazon                        | Val  Loss: 2.3163 | Val  Acc: 0.9173
 Site-amazon                        | Val  Loss: 2.1728 | Val  Acc: 0.9350
 Site-amazon                        | Val  Loss: 2.1849 | Val  Acc: 0.9030
 Site-webcam                        | Val  Loss: 2.3601 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 2.1771 | Val  Acc: 0.8615
 Site-webcam                        | Val  Loss: 2.3735 | Val  Acc: 0.8230
 Site-dslr                          | Val  Loss: 2.3244 | Val  Acc: 0.8095
 Site-dslr                          | Val  Loss: 2.2887 | Val  Acc: 0.8706
 Site-synthetic                     | Val  Loss: 2.9332 | Val  Acc: 0.2933
Average Valid Accuracy: 0.8280
============ Train epoch 8 ============
 Site-amazon                        | Train Loss: 2.0528 | Train Acc: 0.9213
 Site-amazon                        | Train Loss: 1.9725 | Train Acc: 0.9403
 Site-amazon                        | Train Loss: 2.0087 | Train Acc: 0.9300
 Site-amazon                        | Train Loss: 2.0602 | Train Acc: 0.9133
 Site-amazon                        | Train Loss: 2.0109 | Train Acc: 0.9243
 Site-webcam                        | Train Loss: 2.2806 | Train Acc: 0.7679
 Site-webcam                        | Train Loss: 2.1752 | Train Acc: 0.8776
 Site-webcam                        | Train Loss: 2.2571 | Train Acc: 0.8706
 Site-dslr                          | Train Loss: 2.3167 | Train Acc: 0.8750
 Site-dslr                          | Train Loss: 2.2349 | Train Acc: 0.8828
 Site-synthetic                     | Train Loss: 2.8329 | Train Acc: 0.4107
Average Train Accuracy: 0.8467
 Site-amazon                        | Val  Loss: 1.9791 | Val  Acc: 0.9322
 Site-amazon                        | Val  Loss: 2.0623 | Val  Acc: 0.8876
 Site-amazon                        | Val  Loss: 2.1815 | Val  Acc: 0.8947
 Site-amazon                        | Val  Loss: 2.0379 | Val  Acc: 0.9550
 Site-amazon                        | Val  Loss: 2.0599 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 2.1826 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 2.0302 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 2.2339 | Val  Acc: 0.8673
 Site-dslr                          | Val  Loss: 2.1806 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 2.2060 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.8998 | Val  Acc: 0.3467
Average Valid Accuracy: 0.8488
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9322
 Best site-amazon                    | Epoch:8 | Val Acc: 0.8876
 Best site-amazon                    | Epoch:8 | Val Acc: 0.8947
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9550
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9130
 Best site-webcam                    | Epoch:8 | Val Acc: 0.8378
 Best site-webcam                    | Epoch:8 | Val Acc: 0.8923
 Best site-webcam                    | Epoch:8 | Val Acc: 0.8673
 Best site-dslr                      | Epoch:8 | Val Acc: 0.9048
 Best site-dslr                      | Epoch:8 | Val Acc: 0.9059
 Best site-synthetic                 | Epoch:8 | Val Acc: 0.3467
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 9 ============
 Site-amazon                        | Train Loss: 1.9032 | Train Acc: 0.9438
 Site-amazon                        | Train Loss: 1.8105 | Train Acc: 0.9254
 Site-amazon                        | Train Loss: 1.9213 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.9116 | Train Acc: 0.9100
 Site-amazon                        | Train Loss: 1.9094 | Train Acc: 0.9265
 Site-webcam                        | Train Loss: 2.1713 | Train Acc: 0.7857
 Site-webcam                        | Train Loss: 2.0429 | Train Acc: 0.8980
 Site-webcam                        | Train Loss: 2.1329 | Train Acc: 0.8588
 Site-dslr                          | Train Loss: 2.1881 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 2.1090 | Train Acc: 0.8750
 Site-synthetic                     | Train Loss: 2.7315 | Train Acc: 0.4911
Average Train Accuracy: 0.8624
 Site-amazon                        | Val  Loss: 1.8098 | Val  Acc: 0.9322
 Site-amazon                        | Val  Loss: 1.9683 | Val  Acc: 0.8539
 Site-amazon                        | Val  Loss: 2.0231 | Val  Acc: 0.9098
 Site-amazon                        | Val  Loss: 1.9083 | Val  Acc: 0.9500
 Site-amazon                        | Val  Loss: 1.9040 | Val  Acc: 0.9164
 Site-webcam                        | Val  Loss: 2.0616 | Val  Acc: 0.8108
 Site-webcam                        | Val  Loss: 1.8827 | Val  Acc: 0.8615
 Site-webcam                        | Val  Loss: 2.1104 | Val  Acc: 0.8584
 Site-dslr                          | Val  Loss: 2.0276 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 2.0588 | Val  Acc: 0.8471
 Site-synthetic                     | Val  Loss: 2.8057 | Val  Acc: 0.3600
Average Valid Accuracy: 0.8325
============ Train epoch 10 ============
 Site-amazon                        | Train Loss: 1.7396 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 1.7454 | Train Acc: 0.9403
 Site-amazon                        | Train Loss: 1.7642 | Train Acc: 0.9450
 Site-amazon                        | Train Loss: 1.8245 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.7621 | Train Acc: 0.9287
 Site-webcam                        | Train Loss: 2.0722 | Train Acc: 0.8393
 Site-webcam                        | Train Loss: 1.9810 | Train Acc: 0.8980
 Site-webcam                        | Train Loss: 2.0295 | Train Acc: 0.8824
 Site-dslr                          | Train Loss: 2.1299 | Train Acc: 0.8594
 Site-dslr                          | Train Loss: 1.9768 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 2.7140 | Train Acc: 0.4375
Average Train Accuracy: 0.8639
 Site-amazon                        | Val  Loss: 1.6914 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 1.8640 | Val  Acc: 0.8315
 Site-amazon                        | Val  Loss: 2.0204 | Val  Acc: 0.8872
 Site-amazon                        | Val  Loss: 1.7947 | Val  Acc: 0.9300
 Site-amazon                        | Val  Loss: 1.7666 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.9990 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 1.7739 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 1.9607 | Val  Acc: 0.8850
 Site-dslr                          | Val  Loss: 1.8917 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 1.9346 | Val  Acc: 0.8588
 Site-synthetic                     | Val  Loss: 2.8256 | Val  Acc: 0.3067
Average Valid Accuracy: 0.8388
============ Train epoch 11 ============
 Site-amazon                        | Train Loss: 1.6631 | Train Acc: 0.9101
 Site-amazon                        | Train Loss: 1.5185 | Train Acc: 0.9179
 Site-amazon                        | Train Loss: 1.6860 | Train Acc: 0.9350
 Site-amazon                        | Train Loss: 1.6806 | Train Acc: 0.9200
 Site-amazon                        | Train Loss: 1.7718 | Train Acc: 0.9287
 Site-webcam                        | Train Loss: 1.9982 | Train Acc: 0.7500
 Site-webcam                        | Train Loss: 1.8303 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 1.9238 | Train Acc: 0.8647
 Site-dslr                          | Train Loss: 2.0067 | Train Acc: 0.8594
 Site-dslr                          | Train Loss: 1.8919 | Train Acc: 0.8594
 Site-synthetic                     | Train Loss: 2.6474 | Train Acc: 0.4554
Average Train Accuracy: 0.8444
 Site-amazon                        | Val  Loss: 1.5354 | Val  Acc: 0.9322
 Site-amazon                        | Val  Loss: 1.6928 | Val  Acc: 0.9101
 Site-amazon                        | Val  Loss: 1.8129 | Val  Acc: 0.9323
 Site-amazon                        | Val  Loss: 1.6786 | Val  Acc: 0.9400
 Site-amazon                        | Val  Loss: 1.6564 | Val  Acc: 0.9197
 Site-webcam                        | Val  Loss: 1.8721 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 1.6275 | Val  Acc: 0.8615
 Site-webcam                        | Val  Loss: 1.8731 | Val  Acc: 0.8761
 Site-dslr                          | Val  Loss: 1.8580 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 1.8153 | Val  Acc: 0.8706
 Site-synthetic                     | Val  Loss: 2.7297 | Val  Acc: 0.3733
Average Valid Accuracy: 0.8464
============ Train epoch 12 ============
 Site-amazon                        | Train Loss: 1.5140 | Train Acc: 0.9326
 Site-amazon                        | Train Loss: 1.5271 | Train Acc: 0.9478
 Site-amazon                        | Train Loss: 1.4931 | Train Acc: 0.9400
 Site-amazon                        | Train Loss: 1.5578 | Train Acc: 0.9233
 Site-amazon                        | Train Loss: 1.5729 | Train Acc: 0.9243
 Site-webcam                        | Train Loss: 1.9125 | Train Acc: 0.7857
 Site-webcam                        | Train Loss: 1.6454 | Train Acc: 0.9184
 Site-webcam                        | Train Loss: 1.8145 | Train Acc: 0.8882
 Site-dslr                          | Train Loss: 1.8832 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 1.7435 | Train Acc: 0.8828
 Site-synthetic                     | Train Loss: 2.6159 | Train Acc: 0.4375
Average Train Accuracy: 0.8624
 Site-amazon                        | Val  Loss: 1.4462 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 1.6291 | Val  Acc: 0.8764
 Site-amazon                        | Val  Loss: 1.7935 | Val  Acc: 0.8722
 Site-amazon                        | Val  Loss: 1.5630 | Val  Acc: 0.9350
 Site-amazon                        | Val  Loss: 1.5635 | Val  Acc: 0.9097
 Site-webcam                        | Val  Loss: 1.7631 | Val  Acc: 0.7838
 Site-webcam                        | Val  Loss: 1.5170 | Val  Acc: 0.8462
 Site-webcam                        | Val  Loss: 1.7597 | Val  Acc: 0.8761
 Site-dslr                          | Val  Loss: 1.6106 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 1.6870 | Val  Acc: 0.8824
 Site-synthetic                     | Val  Loss: 2.7248 | Val  Acc: 0.3600
Average Valid Accuracy: 0.8353
============ Train epoch 13 ============
 Site-amazon                        | Train Loss: 1.4587 | Train Acc: 0.9213
 Site-amazon                        | Train Loss: 1.3423 | Train Acc: 0.9478
 Site-amazon                        | Train Loss: 1.4537 | Train Acc: 0.9400
 Site-amazon                        | Train Loss: 1.4596 | Train Acc: 0.9333
 Site-amazon                        | Train Loss: 1.4395 | Train Acc: 0.9399
 Site-webcam                        | Train Loss: 1.7395 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.6282 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 1.7463 | Train Acc: 0.8941
 Site-dslr                          | Train Loss: 1.7934 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 1.6786 | Train Acc: 0.8828
 Site-synthetic                     | Train Loss: 2.5571 | Train Acc: 0.4643
Average Train Accuracy: 0.8739
 Site-amazon                        | Val  Loss: 1.3125 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 1.5622 | Val  Acc: 0.8652
 Site-amazon                        | Val  Loss: 1.5954 | Val  Acc: 0.9023
 Site-amazon                        | Val  Loss: 1.4723 | Val  Acc: 0.9350
 Site-amazon                        | Val  Loss: 1.4358 | Val  Acc: 0.9164
 Site-webcam                        | Val  Loss: 1.7231 | Val  Acc: 0.8108
 Site-webcam                        | Val  Loss: 1.3682 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 1.6611 | Val  Acc: 0.8761
 Site-dslr                          | Val  Loss: 1.5654 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 1.6357 | Val  Acc: 0.8353
 Site-synthetic                     | Val  Loss: 2.7405 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8398
============ Train epoch 14 ============
 Site-amazon                        | Train Loss: 1.3633 | Train Acc: 0.9326
 Site-amazon                        | Train Loss: 1.3004 | Train Acc: 0.9478
 Site-amazon                        | Train Loss: 1.3232 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.3782 | Train Acc: 0.9200
 Site-amazon                        | Train Loss: 1.2616 | Train Acc: 0.9310
 Site-webcam                        | Train Loss: 1.6501 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 1.5653 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 1.6534 | Train Acc: 0.8824
 Site-dslr                          | Train Loss: 1.7079 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 1.5904 | Train Acc: 0.8750
 Site-synthetic                     | Train Loss: 2.5078 | Train Acc: 0.4732
Average Train Accuracy: 0.8694
 Site-amazon                        | Val  Loss: 1.2624 | Val  Acc: 0.9322
 Site-amazon                        | Val  Loss: 1.3882 | Val  Acc: 0.9101
 Site-amazon                        | Val  Loss: 1.4334 | Val  Acc: 0.9398
 Site-amazon                        | Val  Loss: 1.3554 | Val  Acc: 0.9300
 Site-amazon                        | Val  Loss: 1.3427 | Val  Acc: 0.9164
 Site-webcam                        | Val  Loss: 1.5808 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 1.3318 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 1.6031 | Val  Acc: 0.8938
 Site-dslr                          | Val  Loss: 1.5527 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 1.4736 | Val  Acc: 0.8941
 Site-synthetic                     | Val  Loss: 2.5843 | Val  Acc: 0.3467
Average Valid Accuracy: 0.8544
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9322
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9101
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9398
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9300
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9164
 Best site-webcam                    | Epoch:14 | Val Acc: 0.8378
 Best site-webcam                    | Epoch:14 | Val Acc: 0.8923
 Best site-webcam                    | Epoch:14 | Val Acc: 0.8938
 Best site-dslr                      | Epoch:14 | Val Acc: 0.9048
 Best site-dslr                      | Epoch:14 | Val Acc: 0.8941
 Best site-synthetic                 | Epoch:14 | Val Acc: 0.3467
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 15 ============
 Site-amazon                        | Train Loss: 1.2828 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 1.1584 | Train Acc: 0.9552
 Site-amazon                        | Train Loss: 1.2661 | Train Acc: 0.9400
 Site-amazon                        | Train Loss: 1.2748 | Train Acc: 0.9033
 Site-amazon                        | Train Loss: 1.2105 | Train Acc: 0.9354
 Site-webcam                        | Train Loss: 1.6402 | Train Acc: 0.7857
 Site-webcam                        | Train Loss: 1.4038 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 1.5405 | Train Acc: 0.9235
 Site-dslr                          | Train Loss: 1.6079 | Train Acc: 0.8750
 Site-dslr                          | Train Loss: 1.5585 | Train Acc: 0.8516
 Site-synthetic                     | Train Loss: 2.4576 | Train Acc: 0.4554
Average Train Accuracy: 0.8626
 Site-amazon                        | Val  Loss: 1.0971 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 1.3337 | Val  Acc: 0.8876
 Site-amazon                        | Val  Loss: 1.3759 | Val  Acc: 0.9398
 Site-amazon                        | Val  Loss: 1.2434 | Val  Acc: 0.9350
 Site-amazon                        | Val  Loss: 1.2510 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.5064 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.2625 | Val  Acc: 0.8462
 Site-webcam                        | Val  Loss: 1.5357 | Val  Acc: 0.8496
 Site-dslr                          | Val  Loss: 1.3943 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 1.3811 | Val  Acc: 0.8706
 Site-synthetic                     | Val  Loss: 2.5366 | Val  Acc: 0.4533
Average Valid Accuracy: 0.8620
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9661
 Best site-amazon                    | Epoch:15 | Val Acc: 0.8876
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9398
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9350
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9130
 Best site-webcam                    | Epoch:15 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:15 | Val Acc: 0.8462
 Best site-webcam                    | Epoch:15 | Val Acc: 0.8496
 Best site-dslr                      | Epoch:15 | Val Acc: 0.9286
 Best site-dslr                      | Epoch:15 | Val Acc: 0.8706
 Best site-synthetic                 | Epoch:15 | Val Acc: 0.4533
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 16 ============
 Site-amazon                        | Train Loss: 1.1537 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 1.0807 | Train Acc: 0.9403
 Site-amazon                        | Train Loss: 1.0919 | Train Acc: 0.9450
 Site-amazon                        | Train Loss: 1.1881 | Train Acc: 0.9167
 Site-amazon                        | Train Loss: 1.0434 | Train Acc: 0.9265
 Site-webcam                        | Train Loss: 1.5375 | Train Acc: 0.7857
 Site-webcam                        | Train Loss: 1.3629 | Train Acc: 0.8469
 Site-webcam                        | Train Loss: 1.4394 | Train Acc: 0.8824
 Site-dslr                          | Train Loss: 1.5460 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 1.4023 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.4461 | Train Acc: 0.4911
Average Train Accuracy: 0.8660
 Site-amazon                        | Val  Loss: 1.0495 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 1.2498 | Val  Acc: 0.8989
 Site-amazon                        | Val  Loss: 1.3720 | Val  Acc: 0.9248
 Site-amazon                        | Val  Loss: 1.1739 | Val  Acc: 0.9450
 Site-amazon                        | Val  Loss: 1.1579 | Val  Acc: 0.9164
 Site-webcam                        | Val  Loss: 1.3939 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.0840 | Val  Acc: 0.8462
 Site-webcam                        | Val  Loss: 1.3871 | Val  Acc: 0.9292
 Site-dslr                          | Val  Loss: 1.3494 | Val  Acc: 0.8333
 Site-dslr                          | Val  Loss: 1.3589 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.5540 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8522
============ Train epoch 17 ============
 Site-amazon                        | Train Loss: 1.0606 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.9400 | Train Acc: 0.9179
 Site-amazon                        | Train Loss: 1.1388 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.0752 | Train Acc: 0.9300
 Site-amazon                        | Train Loss: 1.2625 | Train Acc: 0.9354
 Site-webcam                        | Train Loss: 1.4710 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 1.3506 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 1.3583 | Train Acc: 0.8765
 Site-dslr                          | Train Loss: 1.4560 | Train Acc: 0.8906
 Site-dslr                          | Train Loss: 1.3226 | Train Acc: 0.8906
 Site-synthetic                     | Train Loss: 2.3844 | Train Acc: 0.4464
Average Train Accuracy: 0.8656
 Site-amazon                        | Val  Loss: 1.0087 | Val  Acc: 0.9322
 Site-amazon                        | Val  Loss: 1.1736 | Val  Acc: 0.9213
 Site-amazon                        | Val  Loss: 1.3172 | Val  Acc: 0.9173
 Site-amazon                        | Val  Loss: 1.0833 | Val  Acc: 0.9500
 Site-amazon                        | Val  Loss: 1.0680 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 1.3799 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 0.9931 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 1.3736 | Val  Acc: 0.8761
 Site-dslr                          | Val  Loss: 1.2528 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 1.2252 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.4667 | Val  Acc: 0.3467
Average Valid Accuracy: 0.8575
============ Train epoch 18 ============
 Site-amazon                        | Train Loss: 0.9942 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.8337 | Train Acc: 0.9478
 Site-amazon                        | Train Loss: 0.9846 | Train Acc: 0.9400
 Site-amazon                        | Train Loss: 1.0088 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 0.9609 | Train Acc: 0.9310
 Site-webcam                        | Train Loss: 1.4368 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 1.2148 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 1.3375 | Train Acc: 0.8824
 Site-dslr                          | Train Loss: 1.4122 | Train Acc: 0.8750
 Site-dslr                          | Train Loss: 1.2611 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 2.3737 | Train Acc: 0.4464
Average Train Accuracy: 0.8635
 Site-amazon                        | Val  Loss: 0.8758 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 1.1172 | Val  Acc: 0.8876
 Site-amazon                        | Val  Loss: 1.2390 | Val  Acc: 0.9098
 Site-amazon                        | Val  Loss: 0.9615 | Val  Acc: 0.9300
 Site-amazon                        | Val  Loss: 1.0123 | Val  Acc: 0.9365
 Site-webcam                        | Val  Loss: 1.3396 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 0.9252 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 1.2398 | Val  Acc: 0.8761
 Site-dslr                          | Val  Loss: 1.1365 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 1.1976 | Val  Acc: 0.8824
 Site-synthetic                     | Val  Loss: 2.4505 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8533
============ Train epoch 19 ============
 Site-amazon                        | Train Loss: 0.9521 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.9237 | Train Acc: 0.9403
 Site-amazon                        | Train Loss: 0.9939 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.9218 | Train Acc: 0.9333
 Site-amazon                        | Train Loss: 0.8662 | Train Acc: 0.9465
 Site-webcam                        | Train Loss: 1.3523 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 1.1825 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 1.2530 | Train Acc: 0.9000
 Site-dslr                          | Train Loss: 1.3101 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 1.1806 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.2810 | Train Acc: 0.4911
Average Train Accuracy: 0.8872
 Site-amazon                        | Val  Loss: 0.8446 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 1.0091 | Val  Acc: 0.8989
 Site-amazon                        | Val  Loss: 1.0859 | Val  Acc: 0.9248
 Site-amazon                        | Val  Loss: 0.8996 | Val  Acc: 0.9400
 Site-amazon                        | Val  Loss: 0.9685 | Val  Acc: 0.9264
 Site-webcam                        | Val  Loss: 1.2285 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 0.8470 | Val  Acc: 0.9077
 Site-webcam                        | Val  Loss: 1.1780 | Val  Acc: 0.9027
 Site-dslr                          | Val  Loss: 1.1086 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 1.1666 | Val  Acc: 0.8824
 Site-synthetic                     | Val  Loss: 2.4859 | Val  Acc: 0.3600
Average Valid Accuracy: 0.8660
 Best site-amazon                    | Epoch:19 | Val Acc: 0.9661
 Best site-amazon                    | Epoch:19 | Val Acc: 0.8989
 Best site-amazon                    | Epoch:19 | Val Acc: 0.9248
 Best site-amazon                    | Epoch:19 | Val Acc: 0.9400
 Best site-amazon                    | Epoch:19 | Val Acc: 0.9264
 Best site-webcam                    | Epoch:19 | Val Acc: 0.8649
 Best site-webcam                    | Epoch:19 | Val Acc: 0.9077
 Best site-webcam                    | Epoch:19 | Val Acc: 0.9027
 Best site-dslr                      | Epoch:19 | Val Acc: 0.9524
 Best site-dslr                      | Epoch:19 | Val Acc: 0.8824
 Best site-synthetic                 | Epoch:19 | Val Acc: 0.3600
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 20 ============
 Site-amazon                        | Train Loss: 0.8230 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.8478 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.8873 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.8851 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.7861 | Train Acc: 0.9376
 Site-webcam                        | Train Loss: 1.2948 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 1.1028 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 1.2262 | Train Acc: 0.8941
 Site-dslr                          | Train Loss: 1.2682 | Train Acc: 0.8594
 Site-dslr                          | Train Loss: 1.1323 | Train Acc: 0.8984
 Site-synthetic                     | Train Loss: 2.2813 | Train Acc: 0.4732
Average Train Accuracy: 0.8732
 Site-amazon                        | Val  Loss: 0.7566 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.9664 | Val  Acc: 0.8764
 Site-amazon                        | Val  Loss: 1.0421 | Val  Acc: 0.9098
 Site-amazon                        | Val  Loss: 0.8552 | Val  Acc: 0.9300
 Site-amazon                        | Val  Loss: 0.8986 | Val  Acc: 0.9298
 Site-webcam                        | Val  Loss: 1.1261 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 0.8197 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 1.1357 | Val  Acc: 0.8761
 Site-dslr                          | Val  Loss: 1.0517 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 1.0784 | Val  Acc: 0.8588
 Site-synthetic                     | Val  Loss: 2.4920 | Val  Acc: 0.3467
Average Valid Accuracy: 0.8453
============ Train epoch 21 ============
 Site-amazon                        | Train Loss: 0.8320 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.9066 | Train Acc: 0.9328
 Site-amazon                        | Train Loss: 0.7964 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.8293 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 0.7398 | Train Acc: 0.9488
 Site-webcam                        | Train Loss: 1.2448 | Train Acc: 0.7857
 Site-webcam                        | Train Loss: 1.0243 | Train Acc: 0.8776
 Site-webcam                        | Train Loss: 1.1430 | Train Acc: 0.8941
 Site-dslr                          | Train Loss: 1.2044 | Train Acc: 0.8906
 Site-dslr                          | Train Loss: 1.1033 | Train Acc: 0.9297
 Site-synthetic                     | Train Loss: 2.2873 | Train Acc: 0.4464
Average Train Accuracy: 0.8689
 Site-amazon                        | Val  Loss: 0.7213 | Val  Acc: 0.9322
 Site-amazon                        | Val  Loss: 0.8976 | Val  Acc: 0.8876
 Site-amazon                        | Val  Loss: 1.0167 | Val  Acc: 0.9023
 Site-amazon                        | Val  Loss: 0.7900 | Val  Acc: 0.9500
 Site-amazon                        | Val  Loss: 0.8325 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 1.0915 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 0.7534 | Val  Acc: 0.8615
 Site-webcam                        | Val  Loss: 1.1270 | Val  Acc: 0.9027
 Site-dslr                          | Val  Loss: 0.9311 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 1.0077 | Val  Acc: 0.8941
 Site-synthetic                     | Val  Loss: 2.4092 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8508
============ Train epoch 22 ============
 Site-amazon                        | Train Loss: 0.6834 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.7219 | Train Acc: 0.9403
 Site-amazon                        | Train Loss: 0.8250 | Train Acc: 0.9300
 Site-amazon                        | Train Loss: 0.7859 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 0.7043 | Train Acc: 0.9532
 Site-webcam                        | Train Loss: 1.2287 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 1.0295 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 1.1327 | Train Acc: 0.8588
 Site-dslr                          | Train Loss: 1.1458 | Train Acc: 0.8906
 Site-dslr                          | Train Loss: 1.0667 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 2.2403 | Train Acc: 0.5179
Average Train Accuracy: 0.8730
 Site-amazon                        | Val  Loss: 0.6338 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.8023 | Val  Acc: 0.9101
 Site-amazon                        | Val  Loss: 1.0357 | Val  Acc: 0.9023
 Site-amazon                        | Val  Loss: 0.7800 | Val  Acc: 0.9350
 Site-amazon                        | Val  Loss: 0.7730 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.9710 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.7195 | Val  Acc: 0.8462
 Site-webcam                        | Val  Loss: 1.0120 | Val  Acc: 0.8850
 Site-dslr                          | Val  Loss: 1.0229 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.8864 | Val  Acc: 0.9294
 Site-synthetic                     | Val  Loss: 2.5053 | Val  Acc: 0.3467
Average Valid Accuracy: 0.8563
============ Train epoch 23 ============
 Site-amazon                        | Train Loss: 0.7241 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.7570 | Train Acc: 0.9552
 Site-amazon                        | Train Loss: 0.6521 | Train Acc: 0.9400
 Site-amazon                        | Train Loss: 0.7185 | Train Acc: 0.9400
 Site-amazon                        | Train Loss: 0.7252 | Train Acc: 0.9465
 Site-webcam                        | Train Loss: 1.1188 | Train Acc: 0.7857
 Site-webcam                        | Train Loss: 0.9330 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 0.9858 | Train Acc: 0.8882
 Site-dslr                          | Train Loss: 1.0393 | Train Acc: 0.8906
 Site-dslr                          | Train Loss: 1.0068 | Train Acc: 0.8906
 Site-synthetic                     | Train Loss: 2.2876 | Train Acc: 0.4643
Average Train Accuracy: 0.8687
 Site-amazon                        | Val  Loss: 0.6238 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.7842 | Val  Acc: 0.9101
 Site-amazon                        | Val  Loss: 0.8734 | Val  Acc: 0.9173
 Site-amazon                        | Val  Loss: 0.6889 | Val  Acc: 0.9400
 Site-amazon                        | Val  Loss: 0.7262 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.9652 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.6792 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 1.0423 | Val  Acc: 0.8584
 Site-dslr                          | Val  Loss: 0.9029 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.9002 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 2.4169 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8740
 Best site-amazon                    | Epoch:23 | Val Acc: 0.9661
 Best site-amazon                    | Epoch:23 | Val Acc: 0.9101
 Best site-amazon                    | Epoch:23 | Val Acc: 0.9173
 Best site-amazon                    | Epoch:23 | Val Acc: 0.9400
 Best site-amazon                    | Epoch:23 | Val Acc: 0.9231
 Best site-webcam                    | Epoch:23 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:23 | Val Acc: 0.9231
 Best site-webcam                    | Epoch:23 | Val Acc: 0.8584
 Best site-dslr                      | Epoch:23 | Val Acc: 0.9524
 Best site-dslr                      | Epoch:23 | Val Acc: 0.9176
 Best site-synthetic                 | Epoch:23 | Val Acc: 0.3867
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 24 ============
 Site-amazon                        | Train Loss: 0.6181 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.5348 | Train Acc: 0.9403
 Site-amazon                        | Train Loss: 0.6440 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.6747 | Train Acc: 0.9400
 Site-amazon                        | Train Loss: 0.7645 | Train Acc: 0.9555
 Site-webcam                        | Train Loss: 1.0280 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 0.9569 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 1.0110 | Train Acc: 0.9059
 Site-dslr                          | Train Loss: 0.9562 | Train Acc: 0.9688
 Site-dslr                          | Train Loss: 0.9223 | Train Acc: 0.8906
 Site-synthetic                     | Train Loss: 2.2372 | Train Acc: 0.4821
Average Train Accuracy: 0.8920
 Site-amazon                        | Val  Loss: 0.5475 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.8006 | Val  Acc: 0.8764
 Site-amazon                        | Val  Loss: 0.8021 | Val  Acc: 0.9098
 Site-amazon                        | Val  Loss: 0.6750 | Val  Acc: 0.9500
 Site-amazon                        | Val  Loss: 0.6796 | Val  Acc: 0.9398
 Site-webcam                        | Val  Loss: 0.9196 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 0.5853 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 0.9251 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.8958 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.8746 | Val  Acc: 0.8824
 Site-synthetic                     | Val  Loss: 2.3844 | Val  Acc: 0.3600
Average Valid Accuracy: 0.8606
============ Train epoch 25 ============
 Site-amazon                        | Train Loss: 0.6156 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.5120 | Train Acc: 0.9403
 Site-amazon                        | Train Loss: 0.5462 | Train Acc: 0.9450
 Site-amazon                        | Train Loss: 0.6934 | Train Acc: 0.9300
 Site-amazon                        | Train Loss: 0.5823 | Train Acc: 0.9510
 Site-webcam                        | Train Loss: 0.9764 | Train Acc: 0.8393
 Site-webcam                        | Train Loss: 0.8558 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 0.9651 | Train Acc: 0.8706
 Site-dslr                          | Train Loss: 0.9764 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.9051 | Train Acc: 0.8984
 Site-synthetic                     | Train Loss: 2.1714 | Train Acc: 0.4554
Average Train Accuracy: 0.8727
 Site-amazon                        | Val  Loss: 0.5797 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.7212 | Val  Acc: 0.9101
 Site-amazon                        | Val  Loss: 0.7934 | Val  Acc: 0.9474
 Site-amazon                        | Val  Loss: 0.6264 | Val  Acc: 0.9650
 Site-amazon                        | Val  Loss: 0.6528 | Val  Acc: 0.9431
 Site-webcam                        | Val  Loss: 0.9513 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 0.5519 | Val  Acc: 0.9077
 Site-webcam                        | Val  Loss: 0.8790 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.8552 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 0.7987 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.3760 | Val  Acc: 0.3467
Average Valid Accuracy: 0.8665
============ Train epoch 26 ============
 Site-amazon                        | Train Loss: 0.5839 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.4751 | Train Acc: 0.9552
 Site-amazon                        | Train Loss: 0.5257 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.6176 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 0.5729 | Train Acc: 0.9376
 Site-webcam                        | Train Loss: 1.0254 | Train Acc: 0.7857
 Site-webcam                        | Train Loss: 0.8106 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 0.8993 | Train Acc: 0.9118
 Site-dslr                          | Train Loss: 0.9315 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 0.9016 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 2.1292 | Train Acc: 0.4732
Average Train Accuracy: 0.8799
 Site-amazon                        | Val  Loss: 0.5381 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 0.6763 | Val  Acc: 0.9101
 Site-amazon                        | Val  Loss: 0.7275 | Val  Acc: 0.9398
 Site-amazon                        | Val  Loss: 0.5873 | Val  Acc: 0.9550
 Site-amazon                        | Val  Loss: 0.6252 | Val  Acc: 0.9431
 Site-webcam                        | Val  Loss: 0.7025 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.5310 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 0.8397 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.7921 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 0.7923 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 2.4682 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8808
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9492
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9101
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9398
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9550
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9431
 Best site-webcam                    | Epoch:26 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:26 | Val Acc: 0.8923
 Best site-webcam                    | Epoch:26 | Val Acc: 0.9204
 Best site-dslr                      | Epoch:26 | Val Acc: 0.9286
 Best site-dslr                      | Epoch:26 | Val Acc: 0.9176
 Best site-synthetic                 | Epoch:26 | Val Acc: 0.3867
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 27 ============
 Site-amazon                        | Train Loss: 0.5877 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.5823 | Train Acc: 0.9478
 Site-amazon                        | Train Loss: 0.5712 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.5703 | Train Acc: 0.9533
 Site-amazon                        | Train Loss: 0.5186 | Train Acc: 0.9354
 Site-webcam                        | Train Loss: 0.9586 | Train Acc: 0.8393
 Site-webcam                        | Train Loss: 0.8214 | Train Acc: 0.8776
 Site-webcam                        | Train Loss: 0.8526 | Train Acc: 0.8824
 Site-dslr                          | Train Loss: 0.9253 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.8642 | Train Acc: 0.8906
 Site-synthetic                     | Train Loss: 2.1048 | Train Acc: 0.5179
Average Train Accuracy: 0.8787
 Site-amazon                        | Val  Loss: 0.4425 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.6226 | Val  Acc: 0.9438
 Site-amazon                        | Val  Loss: 0.7761 | Val  Acc: 0.9098
 Site-amazon                        | Val  Loss: 0.5635 | Val  Acc: 0.9550
 Site-amazon                        | Val  Loss: 0.5866 | Val  Acc: 0.9365
 Site-webcam                        | Val  Loss: 0.8229 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 0.5069 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.7977 | Val  Acc: 0.9292
 Site-dslr                          | Val  Loss: 0.7621 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 0.7271 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.3578 | Val  Acc: 0.4133
Average Valid Accuracy: 0.8745
============ Train epoch 28 ============
 Site-amazon                        | Train Loss: 0.5093 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.5146 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.5677 | Train Acc: 0.9550
 Site-amazon                        | Train Loss: 0.5334 | Train Acc: 0.9467
 Site-amazon                        | Train Loss: 0.5598 | Train Acc: 0.9488
 Site-webcam                        | Train Loss: 0.8819 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 0.7292 | Train Acc: 0.8776
 Site-webcam                        | Train Loss: 0.8536 | Train Acc: 0.8765
 Site-dslr                          | Train Loss: 0.8652 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.7997 | Train Acc: 0.8984
 Site-synthetic                     | Train Loss: 2.1899 | Train Acc: 0.4554
Average Train Accuracy: 0.8806
 Site-amazon                        | Val  Loss: 0.4511 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 0.6589 | Val  Acc: 0.8764
 Site-amazon                        | Val  Loss: 0.7637 | Val  Acc: 0.9398
 Site-amazon                        | Val  Loss: 0.5463 | Val  Acc: 0.9650
 Site-amazon                        | Val  Loss: 0.5441 | Val  Acc: 0.9431
 Site-webcam                        | Val  Loss: 0.8392 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 0.4999 | Val  Acc: 0.8615
 Site-webcam                        | Val  Loss: 0.8202 | Val  Acc: 0.9115
 Site-dslr                          | Val  Loss: 0.7638 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 0.7403 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.3767 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8635
============ Train epoch 29 ============
 Site-amazon                        | Train Loss: 0.5407 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.5884 | Train Acc: 0.9478
 Site-amazon                        | Train Loss: 0.5345 | Train Acc: 0.9550
 Site-amazon                        | Train Loss: 0.5477 | Train Acc: 0.9433
 Site-amazon                        | Train Loss: 0.5484 | Train Acc: 0.9510
 Site-webcam                        | Train Loss: 0.9769 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 0.7124 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 0.7726 | Train Acc: 0.8824
 Site-dslr                          | Train Loss: 0.8197 | Train Acc: 0.8750
 Site-dslr                          | Train Loss: 0.7801 | Train Acc: 0.8984
 Site-synthetic                     | Train Loss: 2.1123 | Train Acc: 0.5179
Average Train Accuracy: 0.8772
 Site-amazon                        | Val  Loss: 0.4161 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.6166 | Val  Acc: 0.9101
 Site-amazon                        | Val  Loss: 0.7443 | Val  Acc: 0.9398
 Site-amazon                        | Val  Loss: 0.4478 | Val  Acc: 0.9650
 Site-amazon                        | Val  Loss: 0.5266 | Val  Acc: 0.9365
 Site-webcam                        | Val  Loss: 0.8157 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.5074 | Val  Acc: 0.8615
 Site-webcam                        | Val  Loss: 0.6963 | Val  Acc: 0.9381
 Site-dslr                          | Val  Loss: 0.6139 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.6859 | Val  Acc: 0.8706
 Site-synthetic                     | Val  Loss: 2.4139 | Val  Acc: 0.3733
Average Valid Accuracy: 0.8732
============ Train epoch 30 ============
 Site-amazon                        | Train Loss: 0.5994 | Train Acc: 0.9438
 Site-amazon                        | Train Loss: 0.4123 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.5176 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.5004 | Train Acc: 0.9467
 Site-amazon                        | Train Loss: 0.4407 | Train Acc: 0.9510
 Site-webcam                        | Train Loss: 0.8602 | Train Acc: 0.8393
 Site-webcam                        | Train Loss: 0.7341 | Train Acc: 0.8776
 Site-webcam                        | Train Loss: 0.8070 | Train Acc: 0.9059
 Site-dslr                          | Train Loss: 0.8118 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.7623 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.0978 | Train Acc: 0.4732
Average Train Accuracy: 0.8829
 Site-amazon                        | Val  Loss: 0.4406 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 0.5639 | Val  Acc: 0.8989
 Site-amazon                        | Val  Loss: 0.6147 | Val  Acc: 0.9248
 Site-amazon                        | Val  Loss: 0.4630 | Val  Acc: 0.9500
 Site-amazon                        | Val  Loss: 0.5078 | Val  Acc: 0.9298
 Site-webcam                        | Val  Loss: 0.7473 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.4550 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 0.7422 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.7099 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 0.6545 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 2.3193 | Val  Acc: 0.4133
Average Valid Accuracy: 0.8724
============ Train epoch 31 ============
 Site-amazon                        | Train Loss: 0.4482 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.4440 | Train Acc: 0.9552
 Site-amazon                        | Train Loss: 0.4368 | Train Acc: 0.9550
 Site-amazon                        | Train Loss: 0.5142 | Train Acc: 0.9433
 Site-amazon                        | Train Loss: 0.4059 | Train Acc: 0.9555
 Site-webcam                        | Train Loss: 0.8456 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 0.6911 | Train Acc: 0.8980
 Site-webcam                        | Train Loss: 0.7562 | Train Acc: 0.8706
 Site-dslr                          | Train Loss: 0.8271 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.7785 | Train Acc: 0.8906
 Site-synthetic                     | Train Loss: 2.0673 | Train Acc: 0.5268
Average Train Accuracy: 0.8792
 Site-amazon                        | Val  Loss: 0.3897 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 0.5014 | Val  Acc: 0.8989
 Site-amazon                        | Val  Loss: 0.5785 | Val  Acc: 0.9699
 Site-amazon                        | Val  Loss: 0.4486 | Val  Acc: 0.9550
 Site-amazon                        | Val  Loss: 0.4747 | Val  Acc: 0.9532
 Site-webcam                        | Val  Loss: 0.8395 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.4234 | Val  Acc: 0.9077
 Site-webcam                        | Val  Loss: 0.7836 | Val  Acc: 0.8938
 Site-dslr                          | Val  Loss: 0.7083 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 0.6617 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.2443 | Val  Acc: 0.4133
Average Valid Accuracy: 0.8745
============ Train epoch 32 ============
 Site-amazon                        | Train Loss: 0.4517 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.5065 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.4554 | Train Acc: 0.9300
 Site-amazon                        | Train Loss: 0.4541 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 0.4005 | Train Acc: 0.9421
 Site-webcam                        | Train Loss: 0.8711 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 0.6859 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 0.7099 | Train Acc: 0.9059
 Site-dslr                          | Train Loss: 0.8151 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 0.6356 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.0211 | Train Acc: 0.5268
Average Train Accuracy: 0.8824
 Site-amazon                        | Val  Loss: 0.3461 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 0.5062 | Val  Acc: 0.9101
 Site-amazon                        | Val  Loss: 0.6336 | Val  Acc: 0.9323
 Site-amazon                        | Val  Loss: 0.4662 | Val  Acc: 0.9600
 Site-amazon                        | Val  Loss: 0.4590 | Val  Acc: 0.9465
 Site-webcam                        | Val  Loss: 0.6874 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.4438 | Val  Acc: 0.8308
 Site-webcam                        | Val  Loss: 0.7196 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.7796 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.5592 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 2.2802 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8651
============ Train epoch 33 ============
 Site-amazon                        | Train Loss: 0.4524 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.3228 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.3811 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.4679 | Train Acc: 0.9200
 Site-amazon                        | Train Loss: 0.4582 | Train Acc: 0.9532
 Site-webcam                        | Train Loss: 0.8680 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 0.6008 | Train Acc: 0.9184
 Site-webcam                        | Train Loss: 0.7428 | Train Acc: 0.9000
 Site-dslr                          | Train Loss: 0.7588 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 0.6475 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.1388 | Train Acc: 0.4911
Average Train Accuracy: 0.8833
 Site-amazon                        | Val  Loss: 0.3145 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.4415 | Val  Acc: 0.9326
 Site-amazon                        | Val  Loss: 0.5596 | Val  Acc: 0.8947
 Site-amazon                        | Val  Loss: 0.3845 | Val  Acc: 0.9650
 Site-amazon                        | Val  Loss: 0.4617 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.6990 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 0.3868 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 0.7419 | Val  Acc: 0.9115
 Site-dslr                          | Val  Loss: 0.5475 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.6582 | Val  Acc: 0.8941
 Site-synthetic                     | Val  Loss: 2.3947 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8620
============ Train epoch 34 ============
 Site-amazon                        | Train Loss: 0.3966 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.4586 | Train Acc: 0.9701
 Site-amazon                        | Train Loss: 0.4107 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.4255 | Train Acc: 0.9567
 Site-amazon                        | Train Loss: 0.3975 | Train Acc: 0.9599
 Site-webcam                        | Train Loss: 0.8197 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.6097 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.6645 | Train Acc: 0.8941
 Site-dslr                          | Train Loss: 0.7096 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 0.6629 | Train Acc: 0.8828
 Site-synthetic                     | Train Loss: 2.1453 | Train Acc: 0.4732
Average Train Accuracy: 0.8928
 Site-amazon                        | Val  Loss: 0.2986 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.4889 | Val  Acc: 0.8989
 Site-amazon                        | Val  Loss: 0.5257 | Val  Acc: 0.9474
 Site-amazon                        | Val  Loss: 0.4112 | Val  Acc: 0.9600
 Site-amazon                        | Val  Loss: 0.4190 | Val  Acc: 0.9431
 Site-webcam                        | Val  Loss: 0.5926 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.4037 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.6928 | Val  Acc: 0.9292
 Site-dslr                          | Val  Loss: 0.5884 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.5734 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 2.3301 | Val  Acc: 0.4267
Average Valid Accuracy: 0.8901
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9661
 Best site-amazon                    | Epoch:34 | Val Acc: 0.8989
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9474
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9600
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9431
 Best site-webcam                    | Epoch:34 | Val Acc: 0.9730
 Best site-webcam                    | Epoch:34 | Val Acc: 0.8769
 Best site-webcam                    | Epoch:34 | Val Acc: 0.9292
 Best site-dslr                      | Epoch:34 | Val Acc: 0.9524
 Best site-dslr                      | Epoch:34 | Val Acc: 0.9176
 Best site-synthetic                 | Epoch:34 | Val Acc: 0.4267
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 35 ============
 Site-amazon                        | Train Loss: 0.3143 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.3766 | Train Acc: 0.9478
 Site-amazon                        | Train Loss: 0.4596 | Train Acc: 0.9550
 Site-amazon                        | Train Loss: 0.3944 | Train Acc: 0.9567
 Site-amazon                        | Train Loss: 0.3660 | Train Acc: 0.9443
 Site-webcam                        | Train Loss: 0.8545 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 0.5619 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 0.6516 | Train Acc: 0.8706
 Site-dslr                          | Train Loss: 0.6842 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.7353 | Train Acc: 0.8672
 Site-synthetic                     | Train Loss: 2.1472 | Train Acc: 0.4464
Average Train Accuracy: 0.8765
 Site-amazon                        | Val  Loss: 0.2692 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.4109 | Val  Acc: 0.9101
 Site-amazon                        | Val  Loss: 0.4721 | Val  Acc: 0.9699
 Site-amazon                        | Val  Loss: 0.3784 | Val  Acc: 0.9500
 Site-amazon                        | Val  Loss: 0.4049 | Val  Acc: 0.9498
 Site-webcam                        | Val  Loss: 0.6574 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 0.3414 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.6510 | Val  Acc: 0.9115
 Site-dslr                          | Val  Loss: 0.5743 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.4991 | Val  Acc: 0.9294
 Site-synthetic                     | Val  Loss: 2.2697 | Val  Acc: 0.4267
Average Valid Accuracy: 0.8815
============ Train epoch 36 ============
 Site-amazon                        | Train Loss: 0.3436 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.2786 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.3659 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.3924 | Train Acc: 0.9533
 Site-amazon                        | Train Loss: 0.3201 | Train Acc: 0.9510
 Site-webcam                        | Train Loss: 0.7946 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 0.6543 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 0.6181 | Train Acc: 0.9118
 Site-dslr                          | Train Loss: 0.7086 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.6444 | Train Acc: 0.8594
 Site-synthetic                     | Train Loss: 2.1103 | Train Acc: 0.4554
Average Train Accuracy: 0.8749
 Site-amazon                        | Val  Loss: 0.2881 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.4346 | Val  Acc: 0.9551
 Site-amazon                        | Val  Loss: 0.5517 | Val  Acc: 0.9248
 Site-amazon                        | Val  Loss: 0.3848 | Val  Acc: 0.9600
 Site-amazon                        | Val  Loss: 0.3838 | Val  Acc: 0.9532
 Site-webcam                        | Val  Loss: 0.5856 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.3376 | Val  Acc: 0.9077
 Site-webcam                        | Val  Loss: 0.6152 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.5721 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.5002 | Val  Acc: 0.8824
 Site-synthetic                     | Val  Loss: 2.4141 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8751
============ Train epoch 37 ============
 Site-amazon                        | Train Loss: 0.2782 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.2346 | Train Acc: 0.9701
 Site-amazon                        | Train Loss: 0.3008 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.3769 | Train Acc: 0.9533
 Site-amazon                        | Train Loss: 0.3422 | Train Acc: 0.9443
 Site-webcam                        | Train Loss: 0.7550 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.6189 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 0.6920 | Train Acc: 0.8529
 Site-dslr                          | Train Loss: 0.6956 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.6741 | Train Acc: 0.8750
 Site-synthetic                     | Train Loss: 2.0540 | Train Acc: 0.4911
Average Train Accuracy: 0.8800
 Site-amazon                        | Val  Loss: 0.2681 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.4179 | Val  Acc: 0.9326
 Site-amazon                        | Val  Loss: 0.4765 | Val  Acc: 0.9474
 Site-amazon                        | Val  Loss: 0.4086 | Val  Acc: 0.9600
 Site-amazon                        | Val  Loss: 0.3824 | Val  Acc: 0.9398
 Site-webcam                        | Val  Loss: 0.4847 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.3438 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.6064 | Val  Acc: 0.8938
 Site-dslr                          | Val  Loss: 0.4838 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.5246 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.2921 | Val  Acc: 0.4267
Average Valid Accuracy: 0.8837
============ Train epoch 38 ============
 Site-amazon                        | Train Loss: 0.3648 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.2748 | Train Acc: 0.9478
 Site-amazon                        | Train Loss: 0.3497 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.3855 | Train Acc: 0.9400
 Site-amazon                        | Train Loss: 0.3120 | Train Acc: 0.9599
 Site-webcam                        | Train Loss: 0.6622 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 0.5659 | Train Acc: 0.8980
 Site-webcam                        | Train Loss: 0.6581 | Train Acc: 0.9118
 Site-dslr                          | Train Loss: 0.6395 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.5554 | Train Acc: 0.9219
 Site-synthetic                     | Train Loss: 2.0923 | Train Acc: 0.4554
Average Train Accuracy: 0.8812
 Site-amazon                        | Val  Loss: 0.2871 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 0.3983 | Val  Acc: 0.9213
 Site-amazon                        | Val  Loss: 0.4218 | Val  Acc: 0.9699
 Site-amazon                        | Val  Loss: 0.3158 | Val  Acc: 0.9650
 Site-amazon                        | Val  Loss: 0.3576 | Val  Acc: 0.9431
 Site-webcam                        | Val  Loss: 0.6546 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.3256 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 0.5744 | Val  Acc: 0.9027
 Site-dslr                          | Val  Loss: 0.5364 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 0.5788 | Val  Acc: 0.8706
 Site-synthetic                     | Val  Loss: 2.2801 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8728
============ Train epoch 39 ============
 Site-amazon                        | Train Loss: 0.2446 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2650 | Train Acc: 0.9478
 Site-amazon                        | Train Loss: 0.2957 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.3610 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.4413 | Train Acc: 0.9510
 Site-webcam                        | Train Loss: 0.6878 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 0.5882 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 0.6343 | Train Acc: 0.8824
 Site-dslr                          | Train Loss: 0.6168 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.5888 | Train Acc: 0.8750
 Site-synthetic                     | Train Loss: 2.1096 | Train Acc: 0.4464
Average Train Accuracy: 0.8790
 Site-amazon                        | Val  Loss: 0.2911 | Val  Acc: 0.9322
 Site-amazon                        | Val  Loss: 0.3718 | Val  Acc: 0.9326
 Site-amazon                        | Val  Loss: 0.4888 | Val  Acc: 0.9549
 Site-amazon                        | Val  Loss: 0.3452 | Val  Acc: 0.9600
 Site-amazon                        | Val  Loss: 0.3669 | Val  Acc: 0.9498
 Site-webcam                        | Val  Loss: 0.6655 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 0.3435 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.5674 | Val  Acc: 0.9027
 Site-dslr                          | Val  Loss: 0.4599 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.4371 | Val  Acc: 0.9294
 Site-synthetic                     | Val  Loss: 2.4086 | Val  Acc: 0.4533
Average Valid Accuracy: 0.8783
============ Train epoch 40 ============
 Site-amazon                        | Train Loss: 0.3074 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.2773 | Train Acc: 0.9701
 Site-amazon                        | Train Loss: 0.3180 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.3528 | Train Acc: 0.9567
 Site-amazon                        | Train Loss: 0.2590 | Train Acc: 0.9688
 Site-webcam                        | Train Loss: 0.8260 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 0.4995 | Train Acc: 0.8980
 Site-webcam                        | Train Loss: 0.6260 | Train Acc: 0.8765
 Site-dslr                          | Train Loss: 0.5523 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.6061 | Train Acc: 0.8984
 Site-synthetic                     | Train Loss: 1.9645 | Train Acc: 0.5179
Average Train Accuracy: 0.8865
 Site-amazon                        | Val  Loss: 0.2569 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.3833 | Val  Acc: 0.9326
 Site-amazon                        | Val  Loss: 0.5036 | Val  Acc: 0.9323
 Site-amazon                        | Val  Loss: 0.3132 | Val  Acc: 0.9500
 Site-amazon                        | Val  Loss: 0.3355 | Val  Acc: 0.9532
 Site-webcam                        | Val  Loss: 0.4689 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.3111 | Val  Acc: 0.9077
 Site-webcam                        | Val  Loss: 0.5500 | Val  Acc: 0.9115
 Site-dslr                          | Val  Loss: 0.4800 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.4934 | Val  Acc: 0.9529
 Site-synthetic                     | Val  Loss: 2.4126 | Val  Acc: 0.4267
Average Valid Accuracy: 0.8826
============ Train epoch 41 ============
 Site-amazon                        | Train Loss: 0.3017 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.2811 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.2753 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.3420 | Train Acc: 0.9433
 Site-amazon                        | Train Loss: 0.4070 | Train Acc: 0.9465
 Site-webcam                        | Train Loss: 0.6293 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 0.4793 | Train Acc: 0.9184
 Site-webcam                        | Train Loss: 0.6087 | Train Acc: 0.9059
 Site-dslr                          | Train Loss: 0.6351 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.5551 | Train Acc: 0.8984
 Site-synthetic                     | Train Loss: 1.9684 | Train Acc: 0.4911
Average Train Accuracy: 0.8916
 Site-amazon                        | Val  Loss: 0.2091 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.3750 | Val  Acc: 0.9101
 Site-amazon                        | Val  Loss: 0.4021 | Val  Acc: 0.9624
 Site-amazon                        | Val  Loss: 0.2943 | Val  Acc: 0.9700
 Site-amazon                        | Val  Loss: 0.3259 | Val  Acc: 0.9431
 Site-webcam                        | Val  Loss: 0.6077 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.2817 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.5519 | Val  Acc: 0.8938
 Site-dslr                          | Val  Loss: 0.6280 | Val  Acc: 0.8333
 Site-dslr                          | Val  Loss: 0.4519 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.3305 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8730
============ Train epoch 42 ============
 Site-amazon                        | Train Loss: 0.2628 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.2331 | Train Acc: 0.9701
 Site-amazon                        | Train Loss: 0.3023 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.3093 | Train Acc: 0.9667
 Site-amazon                        | Train Loss: 0.2551 | Train Acc: 0.9666
 Site-webcam                        | Train Loss: 0.7016 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.5090 | Train Acc: 0.8980
 Site-webcam                        | Train Loss: 0.5449 | Train Acc: 0.8941
 Site-dslr                          | Train Loss: 0.6157 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.5374 | Train Acc: 0.8906
 Site-synthetic                     | Train Loss: 2.1298 | Train Acc: 0.4643
Average Train Accuracy: 0.8875
 Site-amazon                        | Val  Loss: 0.2647 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 0.3261 | Val  Acc: 0.9663
 Site-amazon                        | Val  Loss: 0.3966 | Val  Acc: 0.9549
 Site-amazon                        | Val  Loss: 0.2980 | Val  Acc: 0.9600
 Site-amazon                        | Val  Loss: 0.3383 | Val  Acc: 0.9532
 Site-webcam                        | Val  Loss: 0.5545 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.2917 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.5212 | Val  Acc: 0.8938
 Site-dslr                          | Val  Loss: 0.4800 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.4339 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.3613 | Val  Acc: 0.3467
Average Valid Accuracy: 0.8755
============ Train epoch 43 ============
 Site-amazon                        | Train Loss: 0.2697 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.2250 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.2921 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.3060 | Train Acc: 0.9533
 Site-amazon                        | Train Loss: 0.3048 | Train Acc: 0.9644
 Site-webcam                        | Train Loss: 0.7553 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 0.4412 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 0.5474 | Train Acc: 0.9059
 Site-dslr                          | Train Loss: 0.6161 | Train Acc: 0.8594
 Site-dslr                          | Train Loss: 0.5403 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 2.0101 | Train Acc: 0.5089
Average Train Accuracy: 0.8868
 Site-amazon                        | Val  Loss: 0.1986 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.3135 | Val  Acc: 0.9438
 Site-amazon                        | Val  Loss: 0.4347 | Val  Acc: 0.9398
 Site-amazon                        | Val  Loss: 0.3281 | Val  Acc: 0.9550
 Site-amazon                        | Val  Loss: 0.2849 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.4192 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.2930 | Val  Acc: 0.9077
 Site-webcam                        | Val  Loss: 0.5130 | Val  Acc: 0.9027
 Site-dslr                          | Val  Loss: 0.5235 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.4771 | Val  Acc: 0.8706
 Site-synthetic                     | Val  Loss: 2.4987 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8775
============ Train epoch 44 ============
 Site-amazon                        | Train Loss: 0.2612 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.2433 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.2601 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.2825 | Train Acc: 0.9767
 Site-amazon                        | Train Loss: 0.2509 | Train Acc: 0.9532
 Site-webcam                        | Train Loss: 0.6011 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.4667 | Train Acc: 0.9184
 Site-webcam                        | Train Loss: 0.5437 | Train Acc: 0.8941
 Site-dslr                          | Train Loss: 0.4780 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.5465 | Train Acc: 0.8984
 Site-synthetic                     | Train Loss: 2.0153 | Train Acc: 0.4821
Average Train Accuracy: 0.8909
 Site-amazon                        | Val  Loss: 0.1887 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.3317 | Val  Acc: 0.9213
 Site-amazon                        | Val  Loss: 0.3510 | Val  Acc: 0.9624
 Site-amazon                        | Val  Loss: 0.2552 | Val  Acc: 0.9700
 Site-amazon                        | Val  Loss: 0.2975 | Val  Acc: 0.9532
 Site-webcam                        | Val  Loss: 0.4966 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.2847 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.4967 | Val  Acc: 0.9115
 Site-dslr                          | Val  Loss: 0.3864 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.4444 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 2.4583 | Val  Acc: 0.4267
Average Valid Accuracy: 0.8904
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9831
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9213
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9624
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9700
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9532
 Best site-webcam                    | Epoch:44 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:44 | Val Acc: 0.8769
 Best site-webcam                    | Epoch:44 | Val Acc: 0.9115
 Best site-dslr                      | Epoch:44 | Val Acc: 0.9524
 Best site-dslr                      | Epoch:44 | Val Acc: 0.9176
 Best site-synthetic                 | Epoch:44 | Val Acc: 0.4267
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
============ Train epoch 45 ============
 Site-amazon                        | Train Loss: 0.2716 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.4792 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.2798 | Train Acc: 0.9700
 Site-amazon                        | Train Loss: 0.2958 | Train Acc: 0.9700
 Site-amazon                        | Train Loss: 0.2405 | Train Acc: 0.9510
 Site-webcam                        | Train Loss: 0.7305 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 0.4086 | Train Acc: 0.9490
 Site-webcam                        | Train Loss: 0.5446 | Train Acc: 0.9118
 Site-dslr                          | Train Loss: 0.5489 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.4690 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.1071 | Train Acc: 0.4643
Average Train Accuracy: 0.8947
 Site-amazon                        | Val  Loss: 0.1988 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.3605 | Val  Acc: 0.9213
 Site-amazon                        | Val  Loss: 0.3536 | Val  Acc: 0.9699
 Site-amazon                        | Val  Loss: 0.2552 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.2582 | Val  Acc: 0.9699
 Site-webcam                        | Val  Loss: 0.5531 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.3038 | Val  Acc: 0.9077
 Site-webcam                        | Val  Loss: 0.5637 | Val  Acc: 0.9115
 Site-dslr                          | Val  Loss: 0.3904 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.3443 | Val  Acc: 0.9412
 Site-synthetic                     | Val  Loss: 2.3189 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8903
============ Train epoch 46 ============
 Site-amazon                        | Train Loss: 0.2950 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.1956 | Train Acc: 0.9776
 Site-amazon                        | Train Loss: 0.2153 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.2895 | Train Acc: 0.9567
 Site-amazon                        | Train Loss: 0.2132 | Train Acc: 0.9644
 Site-webcam                        | Train Loss: 0.6294 | Train Acc: 0.8393
 Site-webcam                        | Train Loss: 0.4636 | Train Acc: 0.8776
 Site-webcam                        | Train Loss: 0.5549 | Train Acc: 0.8824
 Site-dslr                          | Train Loss: 0.5810 | Train Acc: 0.8750
 Site-dslr                          | Train Loss: 0.5006 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.1107 | Train Acc: 0.4554
Average Train Accuracy: 0.8779
 Site-amazon                        | Val  Loss: 0.1947 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.2853 | Val  Acc: 0.9326
 Site-amazon                        | Val  Loss: 0.3261 | Val  Acc: 0.9549
 Site-amazon                        | Val  Loss: 0.2647 | Val  Acc: 0.9700
 Site-amazon                        | Val  Loss: 0.2666 | Val  Acc: 0.9599
 Site-webcam                        | Val  Loss: 0.5412 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.2746 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 0.5114 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.3827 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.4353 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.4991 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8857
============ Train epoch 47 ============
 Site-amazon                        | Train Loss: 0.2010 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.2405 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.2491 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.2922 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.2692 | Train Acc: 0.9644
 Site-webcam                        | Train Loss: 0.7912 | Train Acc: 0.7857
 Site-webcam                        | Train Loss: 0.4745 | Train Acc: 0.8980
 Site-webcam                        | Train Loss: 0.4912 | Train Acc: 0.9059
 Site-dslr                          | Train Loss: 0.5166 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.4979 | Train Acc: 0.8984
 Site-synthetic                     | Train Loss: 2.0448 | Train Acc: 0.4464
Average Train Accuracy: 0.8782
 Site-amazon                        | Val  Loss: 0.1905 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.3038 | Val  Acc: 0.9326
 Site-amazon                        | Val  Loss: 0.4467 | Val  Acc: 0.9549
 Site-amazon                        | Val  Loss: 0.3251 | Val  Acc: 0.9600
 Site-amazon                        | Val  Loss: 0.2472 | Val  Acc: 0.9666
 Site-webcam                        | Val  Loss: 0.5174 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.3078 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.4672 | Val  Acc: 0.9027
 Site-dslr                          | Val  Loss: 0.4953 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 0.4327 | Val  Acc: 0.9294
 Site-synthetic                     | Val  Loss: 2.4057 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8808
============ Train epoch 48 ============
 Site-amazon                        | Train Loss: 0.2171 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.2202 | Train Acc: 0.9552
 Site-amazon                        | Train Loss: 0.2855 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.2998 | Train Acc: 0.9567
 Site-amazon                        | Train Loss: 0.2048 | Train Acc: 0.9621
 Site-webcam                        | Train Loss: 0.5992 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.4167 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 0.4844 | Train Acc: 0.9235
 Site-dslr                          | Train Loss: 0.5221 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.4943 | Train Acc: 0.9219
 Site-synthetic                     | Train Loss: 2.0128 | Train Acc: 0.5000
Average Train Accuracy: 0.8960
 Site-amazon                        | Val  Loss: 0.1724 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.2790 | Val  Acc: 0.9551
 Site-amazon                        | Val  Loss: 0.3666 | Val  Acc: 0.9398
 Site-amazon                        | Val  Loss: 0.2470 | Val  Acc: 0.9650
 Site-amazon                        | Val  Loss: 0.2777 | Val  Acc: 0.9532
 Site-webcam                        | Val  Loss: 0.4429 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.3076 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.5034 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.4232 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.4445 | Val  Acc: 0.8588
 Site-synthetic                     | Val  Loss: 2.5358 | Val  Acc: 0.3733
Average Valid Accuracy: 0.8732
============ Train epoch 49 ============
 Site-amazon                        | Train Loss: 0.2613 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.1643 | Train Acc: 0.9776
 Site-amazon                        | Train Loss: 0.1940 | Train Acc: 0.9750
 Site-amazon                        | Train Loss: 0.2463 | Train Acc: 0.9733
 Site-amazon                        | Train Loss: 0.2154 | Train Acc: 0.9599
 Site-webcam                        | Train Loss: 0.5645 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 0.4712 | Train Acc: 0.8980
 Site-webcam                        | Train Loss: 0.5216 | Train Acc: 0.9176
 Site-dslr                          | Train Loss: 0.4895 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.4491 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.0120 | Train Acc: 0.4643
Average Train Accuracy: 0.8875
 Site-amazon                        | Val  Loss: 0.1512 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.2631 | Val  Acc: 0.9438
 Site-amazon                        | Val  Loss: 0.3437 | Val  Acc: 0.9624
 Site-amazon                        | Val  Loss: 0.3089 | Val  Acc: 0.9550
 Site-amazon                        | Val  Loss: 0.2748 | Val  Acc: 0.9532
 Site-webcam                        | Val  Loss: 0.3860 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.2526 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 0.4929 | Val  Acc: 0.9027
 Site-dslr                          | Val  Loss: 0.3930 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.3651 | Val  Acc: 0.9412
 Site-synthetic                     | Val  Loss: 2.3013 | Val  Acc: 0.4133
Average Valid Accuracy: 0.8907
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9831
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9438
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9624
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9550
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9532
 Best site-webcam                    | Epoch:49 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:49 | Val Acc: 0.8923
 Best site-webcam                    | Epoch:49 | Val Acc: 0.9027
 Best site-dslr                      | Epoch:49 | Val Acc: 0.9048
 Best site-dslr                      | Epoch:49 | Val Acc: 0.9412
 Best site-synthetic                 | Epoch:49 | Val Acc: 0.4133
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/term...
===2023-08-04 17:29:14===
===2023-08-04 17:29:26===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[89,134,200,300,449,56,98,170,64,128,112,
client_nums=[5,3,2,1,]
len_dataset=[1959,544,320,188,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (1)| Epoch:49 | Test Acc: 0.9697
 Test site-webcam                    (3)| Epoch:49 | Test Acc: 0.9283
 Test site-dslr                      (0)| Epoch:49 | Test Acc: 0.8827
 Test site-synthetic                 (2)| Epoch:49 | Test Acc: 0.5925
amazon: 0.9697, webcam: 0.9283, dslr: 0.8827, synthetic: 0.5925, 
Average Test Accuracy(group): 0.8433, Average Test Accuracy(individual): 0.9083,
domain std=0.1480, cluster std=0.1480, individual std=0.1049, 
