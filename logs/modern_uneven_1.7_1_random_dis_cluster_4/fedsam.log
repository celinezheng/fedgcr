===2023-08-04 12:14:30===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[89,134,200,300,449,56,98,170,64,128,112,
client_nums=[5,3,2,1,]
len_dataset=[1959,544,320,188,]
domain number = 4
============ Train epoch 0 ============
 Site-amazon                        | Train Loss: 1.8583 | Train Acc: 0.9438
 Site-amazon                        | Train Loss: 1.8712 | Train Acc: 0.9403
 Site-amazon                        | Train Loss: 1.8876 | Train Acc: 0.9200
 Site-amazon                        | Train Loss: 1.9395 | Train Acc: 0.9067
 Site-amazon                        | Train Loss: 1.9744 | Train Acc: 0.9131
 Site-webcam                        | Train Loss: 2.1561 | Train Acc: 0.8393
 Site-webcam                        | Train Loss: 2.0486 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 2.1707 | Train Acc: 0.8647
 Site-dslr                          | Train Loss: 2.2250 | Train Acc: 0.8750
 Site-dslr                          | Train Loss: 2.1314 | Train Acc: 0.8281
 Site-synthetic                     | Train Loss: 2.8129 | Train Acc: 0.4107
Average Train Accuracy: 0.8500
 Site-amazon                        | Val  Loss: 1.8216 | Val  Acc: 0.9322
 Site-amazon                        | Val  Loss: 1.9487 | Val  Acc: 0.8876
 Site-amazon                        | Val  Loss: 2.1137 | Val  Acc: 0.9023
 Site-amazon                        | Val  Loss: 1.8974 | Val  Acc: 0.9600
 Site-amazon                        | Val  Loss: 1.9117 | Val  Acc: 0.9164
 Site-webcam                        | Val  Loss: 2.1340 | Val  Acc: 0.7838
 Site-webcam                        | Val  Loss: 1.7843 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 2.0951 | Val  Acc: 0.8761
 Site-dslr                          | Val  Loss: 1.9867 | Val  Acc: 0.8333
 Site-dslr                          | Val  Loss: 2.0200 | Val  Acc: 0.8706
 Site-synthetic                     | Val  Loss: 2.8221 | Val  Acc: 0.3067
Average Valid Accuracy: 0.8370
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9322
 Best site-amazon                    | Epoch:0 | Val Acc: 0.8876
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9023
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9600
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9164
 Best site-webcam                    | Epoch:0 | Val Acc: 0.7838
 Best site-webcam                    | Epoch:0 | Val Acc: 0.9385
 Best site-webcam                    | Epoch:0 | Val Acc: 0.8761
 Best site-dslr                      | Epoch:0 | Val Acc: 0.8333
 Best site-dslr                      | Epoch:0 | Val Acc: 0.8706
 Best site-synthetic                 | Epoch:0 | Val Acc: 0.3067
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 1 ============
 Site-amazon                        | Train Loss: 0.9895 | Train Acc: 0.9326
 Site-amazon                        | Train Loss: 0.8983 | Train Acc: 0.9254
 Site-amazon                        | Train Loss: 0.8672 | Train Acc: 0.9300
 Site-amazon                        | Train Loss: 0.9753 | Train Acc: 0.9300
 Site-amazon                        | Train Loss: 0.9137 | Train Acc: 0.9198
 Site-webcam                        | Train Loss: 1.3218 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 1.1840 | Train Acc: 0.8878
 Site-webcam                        | Train Loss: 1.2606 | Train Acc: 0.8824
 Site-dslr                          | Train Loss: 1.3048 | Train Acc: 0.8906
 Site-dslr                          | Train Loss: 1.2628 | Train Acc: 0.8594
 Site-synthetic                     | Train Loss: 2.3846 | Train Acc: 0.4018
Average Train Accuracy: 0.8561
 Site-amazon                        | Val  Loss: 0.8558 | Val  Acc: 0.9492
 Site-amazon                        | Val  Loss: 1.0663 | Val  Acc: 0.8652
 Site-amazon                        | Val  Loss: 1.1310 | Val  Acc: 0.9248
 Site-amazon                        | Val  Loss: 0.9522 | Val  Acc: 0.9300
 Site-amazon                        | Val  Loss: 0.9451 | Val  Acc: 0.9331
 Site-webcam                        | Val  Loss: 1.2659 | Val  Acc: 0.7838
 Site-webcam                        | Val  Loss: 0.8744 | Val  Acc: 0.8462
 Site-webcam                        | Val  Loss: 1.2102 | Val  Acc: 0.9115
 Site-dslr                          | Val  Loss: 1.0834 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 1.1374 | Val  Acc: 0.8941
 Site-synthetic                     | Val  Loss: 2.5805 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8481
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9492
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8652
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9248
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9300
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9331
 Best site-webcam                    | Epoch:1 | Val Acc: 0.7838
 Best site-webcam                    | Epoch:1 | Val Acc: 0.8462
 Best site-webcam                    | Epoch:1 | Val Acc: 0.9115
 Best site-dslr                      | Epoch:1 | Val Acc: 0.9048
 Best site-dslr                      | Epoch:1 | Val Acc: 0.8941
 Best site-synthetic                 | Epoch:1 | Val Acc: 0.3867
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 2 ============
 Site-amazon                        | Train Loss: 0.6177 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.4398 | Train Acc: 0.9328
 Site-amazon                        | Train Loss: 0.5110 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.5382 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 0.5618 | Train Acc: 0.9577
 Site-webcam                        | Train Loss: 0.9293 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 0.7628 | Train Acc: 0.8776
 Site-webcam                        | Train Loss: 0.7997 | Train Acc: 0.9059
 Site-dslr                          | Train Loss: 0.9148 | Train Acc: 0.8594
 Site-dslr                          | Train Loss: 0.7563 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.0481 | Train Acc: 0.5000
Average Train Accuracy: 0.8740
 Site-amazon                        | Val  Loss: 0.4068 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.6064 | Val  Acc: 0.8764
 Site-amazon                        | Val  Loss: 0.5473 | Val  Acc: 0.9173
 Site-amazon                        | Val  Loss: 0.4939 | Val  Acc: 0.9400
 Site-amazon                        | Val  Loss: 0.5198 | Val  Acc: 0.9431
 Site-webcam                        | Val  Loss: 0.8156 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 0.4064 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.7595 | Val  Acc: 0.8761
 Site-dslr                          | Val  Loss: 0.6384 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.6721 | Val  Acc: 0.8824
 Site-synthetic                     | Val  Loss: 2.3332 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8638
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9661
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8764
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9173
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9400
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9431
 Best site-webcam                    | Epoch:2 | Val Acc: 0.8378
 Best site-webcam                    | Epoch:2 | Val Acc: 0.9231
 Best site-webcam                    | Epoch:2 | Val Acc: 0.8761
 Best site-dslr                      | Epoch:2 | Val Acc: 0.9524
 Best site-dslr                      | Epoch:2 | Val Acc: 0.8824
 Best site-synthetic                 | Epoch:2 | Val Acc: 0.3867
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 3 ============
 Site-amazon                        | Train Loss: 0.3685 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.3869 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.2628 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.3497 | Train Acc: 0.9600
 Site-amazon                        | Train Loss: 0.2906 | Train Acc: 0.9688
 Site-webcam                        | Train Loss: 0.8160 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 0.4907 | Train Acc: 0.9184
 Site-webcam                        | Train Loss: 0.6920 | Train Acc: 0.8706
 Site-dslr                          | Train Loss: 0.5836 | Train Acc: 0.9688
 Site-dslr                          | Train Loss: 0.5601 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 2.0230 | Train Acc: 0.4911
Average Train Accuracy: 0.8882
 Site-amazon                        | Val  Loss: 0.2003 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.4053 | Val  Acc: 0.9326
 Site-amazon                        | Val  Loss: 0.4452 | Val  Acc: 0.9474
 Site-amazon                        | Val  Loss: 0.3566 | Val  Acc: 0.9700
 Site-amazon                        | Val  Loss: 0.3333 | Val  Acc: 0.9532
 Site-webcam                        | Val  Loss: 0.5755 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.3336 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.5756 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.5638 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 0.4629 | Val  Acc: 0.8824
 Site-synthetic                     | Val  Loss: 2.2675 | Val  Acc: 0.3733
Average Valid Accuracy: 0.8747
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9661
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9326
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9474
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9700
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9532
 Best site-webcam                    | Epoch:3 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:3 | Val Acc: 0.8769
 Best site-webcam                    | Epoch:3 | Val Acc: 0.9204
 Best site-dslr                      | Epoch:3 | Val Acc: 0.8810
 Best site-dslr                      | Epoch:3 | Val Acc: 0.8824
 Best site-synthetic                 | Epoch:3 | Val Acc: 0.3733
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 4 ============
 Site-amazon                        | Train Loss: 0.3391 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.1928 | Train Acc: 0.9627
 Site-amazon                        | Train Loss: 0.2373 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.2719 | Train Acc: 0.9633
 Site-amazon                        | Train Loss: 0.2378 | Train Acc: 0.9644
 Site-webcam                        | Train Loss: 0.5567 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.4100 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 0.5073 | Train Acc: 0.8765
 Site-dslr                          | Train Loss: 0.4818 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 0.4575 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 1.9907 | Train Acc: 0.4911
Average Train Accuracy: 0.8930
 Site-amazon                        | Val  Loss: 0.1395 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.2502 | Val  Acc: 0.9438
 Site-amazon                        | Val  Loss: 0.2903 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.3024 | Val  Acc: 0.9500
 Site-amazon                        | Val  Loss: 0.2908 | Val  Acc: 0.9465
 Site-webcam                        | Val  Loss: 0.5048 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.2812 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 0.5129 | Val  Acc: 0.9115
 Site-dslr                          | Val  Loss: 0.4003 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.4471 | Val  Acc: 0.8706
 Site-synthetic                     | Val  Loss: 2.3352 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8943
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9831
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9438
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9850
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9500
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9465
 Best site-webcam                    | Epoch:4 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:4 | Val Acc: 0.9385
 Best site-webcam                    | Epoch:4 | Val Acc: 0.9115
 Best site-dslr                      | Epoch:4 | Val Acc: 0.9762
 Best site-dslr                      | Epoch:4 | Val Acc: 0.8706
 Best site-synthetic                 | Epoch:4 | Val Acc: 0.3867
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 5 ============
 Site-amazon                        | Train Loss: 0.1919 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.2032 | Train Acc: 0.9776
 Site-amazon                        | Train Loss: 0.1544 | Train Acc: 0.9800
 Site-amazon                        | Train Loss: 0.2311 | Train Acc: 0.9533
 Site-amazon                        | Train Loss: 0.1831 | Train Acc: 0.9644
 Site-webcam                        | Train Loss: 0.6468 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 0.4057 | Train Acc: 0.9082
 Site-webcam                        | Train Loss: 0.3857 | Train Acc: 0.9176
 Site-dslr                          | Train Loss: 0.4307 | Train Acc: 0.8906
 Site-dslr                          | Train Loss: 0.4021 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 2.2087 | Train Acc: 0.4911
Average Train Accuracy: 0.8908
 Site-amazon                        | Val  Loss: 0.1746 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.2249 | Val  Acc: 0.9663
 Site-amazon                        | Val  Loss: 0.2587 | Val  Acc: 0.9774
 Site-amazon                        | Val  Loss: 0.2125 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.2346 | Val  Acc: 0.9565
 Site-webcam                        | Val  Loss: 0.3965 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.2249 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.4189 | Val  Acc: 0.8938
 Site-dslr                          | Val  Loss: 0.3634 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.4356 | Val  Acc: 0.8941
 Site-synthetic                     | Val  Loss: 2.3555 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8870
============ Train epoch 6 ============
 Site-amazon                        | Train Loss: 0.1625 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.1169 | Train Acc: 0.9776
 Site-amazon                        | Train Loss: 0.1355 | Train Acc: 0.9800
 Site-amazon                        | Train Loss: 0.1889 | Train Acc: 0.9767
 Site-amazon                        | Train Loss: 0.2765 | Train Acc: 0.9777
 Site-webcam                        | Train Loss: 0.4795 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.3235 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.4233 | Train Acc: 0.9000
 Site-dslr                          | Train Loss: 0.4032 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 0.4074 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 2.0359 | Train Acc: 0.5089
Average Train Accuracy: 0.9031
 Site-amazon                        | Val  Loss: 0.0740 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1438 | Val  Acc: 0.9438
 Site-amazon                        | Val  Loss: 0.1931 | Val  Acc: 0.9549
 Site-amazon                        | Val  Loss: 0.2194 | Val  Acc: 0.9650
 Site-amazon                        | Val  Loss: 0.1805 | Val  Acc: 0.9699
 Site-webcam                        | Val  Loss: 0.3983 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.1847 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 0.4650 | Val  Acc: 0.9292
 Site-dslr                          | Val  Loss: 0.2881 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.3172 | Val  Acc: 0.9412
 Site-synthetic                     | Val  Loss: 2.4367 | Val  Acc: 0.4133
Average Valid Accuracy: 0.8958
 Best site-amazon                    | Epoch:6 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9438
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9549
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9650
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9699
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8923
 Best site-webcam                    | Epoch:6 | Val Acc: 0.9292
 Best site-dslr                      | Epoch:6 | Val Acc: 0.9524
 Best site-dslr                      | Epoch:6 | Val Acc: 0.9412
 Best site-synthetic                 | Epoch:6 | Val Acc: 0.4133
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 7 ============
 Site-amazon                        | Train Loss: 0.2065 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.1445 | Train Acc: 0.9776
 Site-amazon                        | Train Loss: 0.1477 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.1647 | Train Acc: 0.9767
 Site-amazon                        | Train Loss: 0.1901 | Train Acc: 0.9755
 Site-webcam                        | Train Loss: 0.6000 | Train Acc: 0.8393
 Site-webcam                        | Train Loss: 0.2834 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 0.3969 | Train Acc: 0.9059
 Site-dslr                          | Train Loss: 0.2766 | Train Acc: 0.9688
 Site-dslr                          | Train Loss: 0.4176 | Train Acc: 0.8828
 Site-synthetic                     | Train Loss: 2.1112 | Train Acc: 0.4643
Average Train Accuracy: 0.8945
 Site-amazon                        | Val  Loss: 0.1245 | Val  Acc: 0.9661
 Site-amazon                        | Val  Loss: 0.1365 | Val  Acc: 0.9663
 Site-amazon                        | Val  Loss: 0.1490 | Val  Acc: 0.9774
 Site-amazon                        | Val  Loss: 0.1546 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.1787 | Val  Acc: 0.9732
 Site-webcam                        | Val  Loss: 0.2952 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.2289 | Val  Acc: 0.8769
 Site-webcam                        | Val  Loss: 0.3992 | Val  Acc: 0.8850
 Site-dslr                          | Val  Loss: 0.3672 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 0.2693 | Val  Acc: 0.9412
 Site-synthetic                     | Val  Loss: 2.6328 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8871
============ Train epoch 8 ============
 Site-amazon                        | Train Loss: 0.1481 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.1101 | Train Acc: 0.9701
 Site-amazon                        | Train Loss: 0.0920 | Train Acc: 0.9800
 Site-amazon                        | Train Loss: 0.1567 | Train Acc: 0.9700
 Site-amazon                        | Train Loss: 0.0890 | Train Acc: 0.9866
 Site-webcam                        | Train Loss: 0.6024 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 0.3163 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 0.3219 | Train Acc: 0.9294
 Site-dslr                          | Train Loss: 0.3284 | Train Acc: 0.8906
 Site-dslr                          | Train Loss: 0.3192 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.0507 | Train Acc: 0.4821
Average Train Accuracy: 0.8950
 Site-amazon                        | Val  Loss: 0.0818 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.0898 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1199 | Val  Acc: 0.9774
 Site-amazon                        | Val  Loss: 0.1106 | Val  Acc: 0.9800
 Site-amazon                        | Val  Loss: 0.1647 | Val  Acc: 0.9632
 Site-webcam                        | Val  Loss: 0.2333 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1805 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 0.3838 | Val  Acc: 0.9027
 Site-dslr                          | Val  Loss: 0.2386 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.3413 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 2.6030 | Val  Acc: 0.4133
Average Valid Accuracy: 0.9025
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9831
 Best site-amazon                    | Epoch:8 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9774
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9800
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9632
 Best site-webcam                    | Epoch:8 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:8 | Val Acc: 0.8923
 Best site-webcam                    | Epoch:8 | Val Acc: 0.9027
 Best site-dslr                      | Epoch:8 | Val Acc: 0.9524
 Best site-dslr                      | Epoch:8 | Val Acc: 0.9176
 Best site-synthetic                 | Epoch:8 | Val Acc: 0.4133
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 9 ============
 Site-amazon                        | Train Loss: 0.1245 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.0844 | Train Acc: 0.9776
 Site-amazon                        | Train Loss: 0.1351 | Train Acc: 0.9700
 Site-amazon                        | Train Loss: 0.1297 | Train Acc: 0.9767
 Site-amazon                        | Train Loss: 0.0959 | Train Acc: 0.9755
 Site-webcam                        | Train Loss: 0.4996 | Train Acc: 0.8393
 Site-webcam                        | Train Loss: 0.2839 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.3121 | Train Acc: 0.9235
 Site-dslr                          | Train Loss: 0.3399 | Train Acc: 0.8750
 Site-dslr                          | Train Loss: 0.2871 | Train Acc: 0.9297
 Site-synthetic                     | Train Loss: 2.0887 | Train Acc: 0.5268
Average Train Accuracy: 0.8999
 Site-amazon                        | Val  Loss: 0.0349 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1128 | Val  Acc: 0.9775
 Site-amazon                        | Val  Loss: 0.1065 | Val  Acc: 0.9699
 Site-amazon                        | Val  Loss: 0.1476 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.1371 | Val  Acc: 0.9699
 Site-webcam                        | Val  Loss: 0.2256 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.2114 | Val  Acc: 0.8462
 Site-webcam                        | Val  Loss: 0.3355 | Val  Acc: 0.8938
 Site-dslr                          | Val  Loss: 0.2424 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 0.2721 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 2.5899 | Val  Acc: 0.4400
Average Valid Accuracy: 0.8968
============ Train epoch 10 ============
 Site-amazon                        | Train Loss: 0.0696 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1016 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.1489 | Train Acc: 0.9700
 Site-amazon                        | Train Loss: 0.1470 | Train Acc: 0.9700
 Site-amazon                        | Train Loss: 0.0624 | Train Acc: 0.9889
 Site-webcam                        | Train Loss: 0.4633 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.2237 | Train Acc: 0.9592
 Site-webcam                        | Train Loss: 0.2825 | Train Acc: 0.9176
 Site-dslr                          | Train Loss: 0.3506 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.2580 | Train Acc: 0.9453
 Site-synthetic                     | Train Loss: 2.0990 | Train Acc: 0.5089
Average Train Accuracy: 0.9143
 Site-amazon                        | Val  Loss: 0.0292 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1300 | Val  Acc: 0.9438
 Site-amazon                        | Val  Loss: 0.1739 | Val  Acc: 0.9624
 Site-amazon                        | Val  Loss: 0.1188 | Val  Acc: 0.9900
 Site-amazon                        | Val  Loss: 0.1079 | Val  Acc: 0.9833
 Site-webcam                        | Val  Loss: 0.2441 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.1572 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 0.3034 | Val  Acc: 0.9469
 Site-dslr                          | Val  Loss: 0.2172 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.2349 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 2.7818 | Val  Acc: 0.4133
Average Valid Accuracy: 0.9061
 Best site-amazon                    | Epoch:10 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9438
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9624
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9900
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9833
 Best site-webcam                    | Epoch:10 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:10 | Val Acc: 0.9385
 Best site-webcam                    | Epoch:10 | Val Acc: 0.9469
 Best site-dslr                      | Epoch:10 | Val Acc: 0.9524
 Best site-dslr                      | Epoch:10 | Val Acc: 0.9176
 Best site-synthetic                 | Epoch:10 | Val Acc: 0.4133
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 11 ============
 Site-amazon                        | Train Loss: 0.1394 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.1093 | Train Acc: 0.9478
 Site-amazon                        | Train Loss: 0.1022 | Train Acc: 0.9700
 Site-amazon                        | Train Loss: 0.1214 | Train Acc: 0.9667
 Site-amazon                        | Train Loss: 0.0803 | Train Acc: 0.9844
 Site-webcam                        | Train Loss: 0.5952 | Train Acc: 0.8214
 Site-webcam                        | Train Loss: 0.2280 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.2804 | Train Acc: 0.9294
 Site-dslr                          | Train Loss: 0.3091 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.2824 | Train Acc: 0.9219
 Site-synthetic                     | Train Loss: 2.0295 | Train Acc: 0.4911
Average Train Accuracy: 0.8992
 Site-amazon                        | Val  Loss: 0.0310 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0662 | Val  Acc: 0.9888
 Site-amazon                        | Val  Loss: 0.0699 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0981 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.1157 | Val  Acc: 0.9799
 Site-webcam                        | Val  Loss: 0.3508 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1582 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.2513 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.2845 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.1831 | Val  Acc: 0.9529
 Site-synthetic                     | Val  Loss: 2.6775 | Val  Acc: 0.4133
Average Valid Accuracy: 0.9099
 Best site-amazon                    | Epoch:11 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9888
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9850
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9950
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9799
 Best site-webcam                    | Epoch:11 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:11 | Val Acc: 0.9231
 Best site-webcam                    | Epoch:11 | Val Acc: 0.9204
 Best site-dslr                      | Epoch:11 | Val Acc: 0.9048
 Best site-dslr                      | Epoch:11 | Val Acc: 0.9529
 Best site-synthetic                 | Epoch:11 | Val Acc: 0.4133
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 12 ============
 Site-amazon                        | Train Loss: 0.1749 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.0596 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0657 | Train Acc: 0.9750
 Site-amazon                        | Train Loss: 0.1021 | Train Acc: 0.9800
 Site-amazon                        | Train Loss: 0.0700 | Train Acc: 0.9866
 Site-webcam                        | Train Loss: 0.3797 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 0.1751 | Train Acc: 0.9592
 Site-webcam                        | Train Loss: 0.2880 | Train Acc: 0.9294
 Site-dslr                          | Train Loss: 0.2976 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.2487 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.0423 | Train Acc: 0.5089
Average Train Accuracy: 0.9133
 Site-amazon                        | Val  Loss: 0.0341 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1043 | Val  Acc: 0.9663
 Site-amazon                        | Val  Loss: 0.2205 | Val  Acc: 0.9549
 Site-amazon                        | Val  Loss: 0.1184 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.1007 | Val  Acc: 0.9833
 Site-webcam                        | Val  Loss: 0.3153 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.1745 | Val  Acc: 0.8923
 Site-webcam                        | Val  Loss: 0.2839 | Val  Acc: 0.9204
 Site-dslr                          | Val  Loss: 0.1722 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 0.3330 | Val  Acc: 0.9294
 Site-synthetic                     | Val  Loss: 3.1126 | Val  Acc: 0.4267
Average Valid Accuracy: 0.9005
============ Train epoch 13 ============
 Site-amazon                        | Train Loss: 0.1333 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.0427 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0895 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.1108 | Train Acc: 0.9833
 Site-amazon                        | Train Loss: 0.0459 | Train Acc: 0.9866
 Site-webcam                        | Train Loss: 0.3629 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 0.1763 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.2603 | Train Acc: 0.9412
 Site-dslr                          | Train Loss: 0.2190 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.2201 | Train Acc: 0.9297
 Site-synthetic                     | Train Loss: 2.0753 | Train Acc: 0.5357
Average Train Accuracy: 0.9193
 Site-amazon                        | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0877 | Val  Acc: 0.9551
 Site-amazon                        | Val  Loss: 0.0535 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1494 | Val  Acc: 0.9800
 Site-amazon                        | Val  Loss: 0.1158 | Val  Acc: 0.9732
 Site-webcam                        | Val  Loss: 0.2218 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1180 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 0.2350 | Val  Acc: 0.9381
 Site-dslr                          | Val  Loss: 0.1723 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.2282 | Val  Acc: 0.9294
 Site-synthetic                     | Val  Loss: 2.9030 | Val  Acc: 0.4000
Average Valid Accuracy: 0.9124
 Best site-amazon                    | Epoch:13 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:13 | Val Acc: 0.9551
 Best site-amazon                    | Epoch:13 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:13 | Val Acc: 0.9800
 Best site-amazon                    | Epoch:13 | Val Acc: 0.9732
 Best site-webcam                    | Epoch:13 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:13 | Val Acc: 0.9385
 Best site-webcam                    | Epoch:13 | Val Acc: 0.9381
 Best site-dslr                      | Epoch:13 | Val Acc: 0.9762
 Best site-dslr                      | Epoch:13 | Val Acc: 0.9294
 Best site-synthetic                 | Epoch:13 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 14 ============
 Site-amazon                        | Train Loss: 0.0881 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0739 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0796 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.1031 | Train Acc: 0.9767
 Site-amazon                        | Train Loss: 0.0571 | Train Acc: 0.9755
 Site-webcam                        | Train Loss: 0.3387 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 0.2149 | Train Acc: 0.9592
 Site-webcam                        | Train Loss: 0.2630 | Train Acc: 0.9412
 Site-dslr                          | Train Loss: 0.2260 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.2328 | Train Acc: 0.9219
 Site-synthetic                     | Train Loss: 2.1741 | Train Acc: 0.5446
Average Train Accuracy: 0.9189
 Site-amazon                        | Val  Loss: 0.0299 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0375 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0619 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0729 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0926 | Val  Acc: 0.9833
 Site-webcam                        | Val  Loss: 0.1665 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.1433 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.2357 | Val  Acc: 0.9292
 Site-dslr                          | Val  Loss: 0.3212 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 0.1826 | Val  Acc: 0.9412
 Site-synthetic                     | Val  Loss: 2.5167 | Val  Acc: 0.4667
Average Valid Accuracy: 0.9168
 Best site-amazon                    | Epoch:14 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:14 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9925
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9950
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9833
 Best site-webcam                    | Epoch:14 | Val Acc: 0.9730
 Best site-webcam                    | Epoch:14 | Val Acc: 0.9231
 Best site-webcam                    | Epoch:14 | Val Acc: 0.9292
 Best site-dslr                      | Epoch:14 | Val Acc: 0.8810
 Best site-dslr                      | Epoch:14 | Val Acc: 0.9412
 Best site-synthetic                 | Epoch:14 | Val Acc: 0.4667
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 15 ============
 Site-amazon                        | Train Loss: 0.1540 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0871 | Train Acc: 0.9701
 Site-amazon                        | Train Loss: 0.1893 | Train Acc: 0.9650
 Site-amazon                        | Train Loss: 0.1060 | Train Acc: 0.9767
 Site-amazon                        | Train Loss: 0.0353 | Train Acc: 0.9933
 Site-webcam                        | Train Loss: 0.4643 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.1604 | Train Acc: 0.9694
 Site-webcam                        | Train Loss: 0.2397 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 0.2819 | Train Acc: 0.8750
 Site-dslr                          | Train Loss: 0.3168 | Train Acc: 0.8750
 Site-synthetic                     | Train Loss: 2.0426 | Train Acc: 0.5625
Average Train Accuracy: 0.9073
 Site-amazon                        | Val  Loss: 0.0141 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0601 | Val  Acc: 0.9888
 Site-amazon                        | Val  Loss: 0.0539 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0682 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0932 | Val  Acc: 0.9699
 Site-webcam                        | Val  Loss: 0.2971 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.2046 | Val  Acc: 0.9077
 Site-webcam                        | Val  Loss: 0.2687 | Val  Acc: 0.9292
 Site-dslr                          | Val  Loss: 0.1543 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.1475 | Val  Acc: 0.9647
 Site-synthetic                     | Val  Loss: 2.5491 | Val  Acc: 0.4933
Average Valid Accuracy: 0.9223
 Best site-amazon                    | Epoch:15 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9888
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9850
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9850
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9699
 Best site-webcam                    | Epoch:15 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:15 | Val Acc: 0.9077
 Best site-webcam                    | Epoch:15 | Val Acc: 0.9292
 Best site-dslr                      | Epoch:15 | Val Acc: 0.9762
 Best site-dslr                      | Epoch:15 | Val Acc: 0.9647
 Best site-synthetic                 | Epoch:15 | Val Acc: 0.4933
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 16 ============
 Site-amazon                        | Train Loss: 0.0599 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.1008 | Train Acc: 0.9701
 Site-amazon                        | Train Loss: 0.0489 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0787 | Train Acc: 0.9800
 Site-amazon                        | Train Loss: 0.0358 | Train Acc: 0.9889
 Site-webcam                        | Train Loss: 0.4449 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.2211 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.2009 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 0.2292 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.2066 | Train Acc: 0.9453
 Site-synthetic                     | Train Loss: 2.1427 | Train Acc: 0.5268
Average Train Accuracy: 0.9180
 Site-amazon                        | Val  Loss: 0.0215 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0442 | Val  Acc: 0.9775
 Site-amazon                        | Val  Loss: 0.0996 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.1288 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0829 | Val  Acc: 0.9866
 Site-webcam                        | Val  Loss: 0.3410 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.1362 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.2128 | Val  Acc: 0.9646
 Site-dslr                          | Val  Loss: 0.2686 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.1635 | Val  Acc: 0.9294
 Site-synthetic                     | Val  Loss: 2.7330 | Val  Acc: 0.3867
Average Valid Accuracy: 0.9063
============ Train epoch 17 ============
 Site-amazon                        | Train Loss: 0.0893 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0586 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0594 | Train Acc: 0.9750
 Site-amazon                        | Train Loss: 0.0560 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0494 | Train Acc: 0.9911
 Site-webcam                        | Train Loss: 0.4398 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.3100 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.1898 | Train Acc: 0.9471
 Site-dslr                          | Train Loss: 0.2216 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.2015 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.1186 | Train Acc: 0.5179
Average Train Accuracy: 0.9155
 Site-amazon                        | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0433 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1413 | Val  Acc: 0.9774
 Site-amazon                        | Val  Loss: 0.0631 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0783 | Val  Acc: 0.9866
 Site-webcam                        | Val  Loss: 0.2105 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.1272 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.2888 | Val  Acc: 0.9292
 Site-dslr                          | Val  Loss: 0.1670 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.1197 | Val  Acc: 0.9529
 Site-synthetic                     | Val  Loss: 2.6033 | Val  Acc: 0.4267
Average Valid Accuracy: 0.9197
============ Train epoch 18 ============
 Site-amazon                        | Train Loss: 0.0495 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0580 | Train Acc: 0.9776
 Site-amazon                        | Train Loss: 0.0660 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0602 | Train Acc: 0.9967
 Site-amazon                        | Train Loss: 0.0327 | Train Acc: 0.9866
 Site-webcam                        | Train Loss: 0.5470 | Train Acc: 0.8393
 Site-webcam                        | Train Loss: 0.1736 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.2525 | Train Acc: 0.9294
 Site-dslr                          | Train Loss: 0.2744 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.1954 | Train Acc: 0.9531
 Site-synthetic                     | Train Loss: 2.1477 | Train Acc: 0.5179
Average Train Accuracy: 0.9109
 Site-amazon                        | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0576 | Val  Acc: 0.9775
 Site-amazon                        | Val  Loss: 0.0487 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0665 | Val  Acc: 0.9800
 Site-amazon                        | Val  Loss: 0.0644 | Val  Acc: 0.9866
 Site-webcam                        | Val  Loss: 0.2665 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.1243 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.1526 | Val  Acc: 0.9558
 Site-dslr                          | Val  Loss: 0.1499 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.2019 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 2.8428 | Val  Acc: 0.4267
Average Valid Accuracy: 0.9169
============ Train epoch 19 ============
 Site-amazon                        | Train Loss: 0.0702 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0555 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0496 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0485 | Train Acc: 0.9867
 Site-amazon                        | Train Loss: 0.0256 | Train Acc: 0.9911
 Site-webcam                        | Train Loss: 0.3996 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.1203 | Train Acc: 0.9898
 Site-webcam                        | Train Loss: 0.2095 | Train Acc: 0.9412
 Site-dslr                          | Train Loss: 0.1896 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.2261 | Train Acc: 0.9219
 Site-synthetic                     | Train Loss: 2.0084 | Train Acc: 0.5268
Average Train Accuracy: 0.9207
 Site-amazon                        | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0556 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0418 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0759 | Val  Acc: 0.9799
 Site-webcam                        | Val  Loss: 0.3683 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.1244 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 0.1664 | Val  Acc: 0.9558
 Site-dslr                          | Val  Loss: 0.1590 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.2458 | Val  Acc: 0.9294
 Site-synthetic                     | Val  Loss: 2.8763 | Val  Acc: 0.4267
Average Valid Accuracy: 0.9145
============ Train epoch 20 ============
 Site-amazon                        | Train Loss: 0.0511 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.0397 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0568 | Train Acc: 0.9800
 Site-amazon                        | Train Loss: 0.0440 | Train Acc: 0.9933
 Site-amazon                        | Train Loss: 0.0276 | Train Acc: 0.9933
 Site-webcam                        | Train Loss: 0.4974 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.1798 | Train Acc: 0.9490
 Site-webcam                        | Train Loss: 0.1845 | Train Acc: 0.9471
 Site-dslr                          | Train Loss: 0.2708 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 0.2379 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.1268 | Train Acc: 0.5536
Average Train Accuracy: 0.9162
 Site-amazon                        | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0363 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0876 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0711 | Val  Acc: 0.9900
 Site-amazon                        | Val  Loss: 0.0758 | Val  Acc: 0.9766
 Site-webcam                        | Val  Loss: 0.0951 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.1209 | Val  Acc: 0.9692
 Site-webcam                        | Val  Loss: 0.2032 | Val  Acc: 0.9469
 Site-dslr                          | Val  Loss: 0.1862 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.1932 | Val  Acc: 0.9176
 Site-synthetic                     | Val  Loss: 3.0304 | Val  Acc: 0.4667
Average Valid Accuracy: 0.9233
 Best site-amazon                    | Epoch:20 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:20 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:20 | Val Acc: 0.9850
 Best site-amazon                    | Epoch:20 | Val Acc: 0.9900
 Best site-amazon                    | Epoch:20 | Val Acc: 0.9766
 Best site-webcam                    | Epoch:20 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:20 | Val Acc: 0.9692
 Best site-webcam                    | Epoch:20 | Val Acc: 0.9469
 Best site-dslr                      | Epoch:20 | Val Acc: 0.9048
 Best site-dslr                      | Epoch:20 | Val Acc: 0.9176
 Best site-synthetic                 | Epoch:20 | Val Acc: 0.4667
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 21 ============
 Site-amazon                        | Train Loss: 0.1231 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.2007 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0428 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0579 | Train Acc: 0.9867
 Site-amazon                        | Train Loss: 0.0288 | Train Acc: 0.9889
 Site-webcam                        | Train Loss: 0.4025 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.1668 | Train Acc: 0.9490
 Site-webcam                        | Train Loss: 0.1732 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 0.1461 | Train Acc: 0.9844
 Site-dslr                          | Train Loss: 0.2081 | Train Acc: 0.9453
 Site-synthetic                     | Train Loss: 2.2164 | Train Acc: 0.5625
Average Train Accuracy: 0.9251
 Site-amazon                        | Val  Loss: 0.0308 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.0274 | Val  Acc: 0.9775
 Site-amazon                        | Val  Loss: 0.0432 | Val  Acc: 0.9774
 Site-amazon                        | Val  Loss: 0.0464 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0808 | Val  Acc: 0.9766
 Site-webcam                        | Val  Loss: 0.1220 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1527 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.2019 | Val  Acc: 0.9646
 Site-dslr                          | Val  Loss: 0.0808 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1950 | Val  Acc: 0.9412
 Site-synthetic                     | Val  Loss: 2.7870 | Val  Acc: 0.4267
Average Valid Accuracy: 0.9192
============ Train epoch 22 ============
 Site-amazon                        | Train Loss: 0.0616 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0606 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0729 | Train Acc: 0.9750
 Site-amazon                        | Train Loss: 0.0499 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0173 | Train Acc: 0.9955
 Site-webcam                        | Train Loss: 0.4268 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.1852 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.2954 | Train Acc: 0.9176
 Site-dslr                          | Train Loss: 0.1827 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.2143 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.2368 | Train Acc: 0.5536
Average Train Accuracy: 0.9183
 Site-amazon                        | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0192 | Val  Acc: 0.9888
 Site-amazon                        | Val  Loss: 0.0327 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0480 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0620 | Val  Acc: 0.9933
 Site-webcam                        | Val  Loss: 0.2059 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1451 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.1782 | Val  Acc: 0.9381
 Site-dslr                          | Val  Loss: 0.3507 | Val  Acc: 0.8810
 Site-dslr                          | Val  Loss: 0.0903 | Val  Acc: 0.9765
 Site-synthetic                     | Val  Loss: 2.8997 | Val  Acc: 0.4667
Average Valid Accuracy: 0.9180
============ Train epoch 23 ============
 Site-amazon                        | Train Loss: 0.1387 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.1214 | Train Acc: 0.9776
 Site-amazon                        | Train Loss: 0.0440 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0511 | Train Acc: 0.9833
 Site-amazon                        | Train Loss: 0.0120 | Train Acc: 0.9978
 Site-webcam                        | Train Loss: 0.3291 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.1683 | Train Acc: 0.9490
 Site-webcam                        | Train Loss: 0.1504 | Train Acc: 0.9529
 Site-dslr                          | Train Loss: 0.2249 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 0.2224 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.2548 | Train Acc: 0.5446
Average Train Accuracy: 0.9172
 Site-amazon                        | Val  Loss: 0.0075 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0229 | Val  Acc: 0.9888
 Site-amazon                        | Val  Loss: 0.0360 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0784 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.0609 | Val  Acc: 0.9799
 Site-webcam                        | Val  Loss: 0.3170 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1364 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.2179 | Val  Acc: 0.9381
 Site-dslr                          | Val  Loss: 0.1923 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 0.1198 | Val  Acc: 0.9529
 Site-synthetic                     | Val  Loss: 2.9434 | Val  Acc: 0.4400
Average Valid Accuracy: 0.9171
============ Train epoch 24 ============
 Site-amazon                        | Train Loss: 0.0223 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0465 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0265 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0409 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0165 | Train Acc: 0.9955
 Site-webcam                        | Train Loss: 0.3221 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 0.1994 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.1953 | Train Acc: 0.9529
 Site-dslr                          | Train Loss: 0.1569 | Train Acc: 0.9688
 Site-dslr                          | Train Loss: 0.1642 | Train Acc: 0.9453
 Site-synthetic                     | Train Loss: 2.1723 | Train Acc: 0.5625
Average Train Accuracy: 0.9334
 Site-amazon                        | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0401 | Val  Acc: 0.9775
 Site-amazon                        | Val  Loss: 0.0477 | Val  Acc: 0.9774
 Site-amazon                        | Val  Loss: 0.0572 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0669 | Val  Acc: 0.9732
 Site-webcam                        | Val  Loss: 0.0818 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.1147 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 0.1522 | Val  Acc: 0.9558
 Site-dslr                          | Val  Loss: 0.1184 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.1738 | Val  Acc: 0.8941
 Site-synthetic                     | Val  Loss: 2.7777 | Val  Acc: 0.4267
Average Valid Accuracy: 0.9153
============ Train epoch 25 ============
 Site-amazon                        | Train Loss: 0.0475 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0522 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0138 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0652 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0180 | Train Acc: 0.9955
 Site-webcam                        | Train Loss: 0.2468 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 0.1159 | Train Acc: 0.9898
 Site-webcam                        | Train Loss: 0.1591 | Train Acc: 0.9529
 Site-dslr                          | Train Loss: 0.1194 | Train Acc: 0.9844
 Site-dslr                          | Train Loss: 0.1918 | Train Acc: 0.9219
 Site-synthetic                     | Train Loss: 2.0886 | Train Acc: 0.5446
Average Train Accuracy: 0.9343
 Site-amazon                        | Val  Loss: 0.0137 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0138 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0353 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0329 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0567 | Val  Acc: 0.9866
 Site-webcam                        | Val  Loss: 0.2538 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.0869 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.1856 | Val  Acc: 0.9646
 Site-dslr                          | Val  Loss: 0.1588 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 0.1092 | Val  Acc: 0.9647
 Site-synthetic                     | Val  Loss: 2.7939 | Val  Acc: 0.4400
Average Valid Accuracy: 0.9245
 Best site-amazon                    | Epoch:25 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:25 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:25 | Val Acc: 0.9850
 Best site-amazon                    | Epoch:25 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:25 | Val Acc: 0.9866
 Best site-webcam                    | Epoch:25 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:25 | Val Acc: 0.9538
 Best site-webcam                    | Epoch:25 | Val Acc: 0.9646
 Best site-dslr                      | Epoch:25 | Val Acc: 0.9286
 Best site-dslr                      | Epoch:25 | Val Acc: 0.9647
 Best site-synthetic                 | Epoch:25 | Val Acc: 0.4400
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 26 ============
 Site-amazon                        | Train Loss: 0.0261 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0477 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0281 | Train Acc: 0.9950
 Site-amazon                        | Train Loss: 0.0480 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0147 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.3933 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 0.1193 | Train Acc: 0.9694
 Site-webcam                        | Train Loss: 0.1727 | Train Acc: 0.9529
 Site-dslr                          | Train Loss: 0.2164 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.2052 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.0452 | Train Acc: 0.5625
Average Train Accuracy: 0.9300
 Site-amazon                        | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0450 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0525 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0499 | Val  Acc: 0.9866
 Site-webcam                        | Val  Loss: 0.0821 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.0920 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 0.1866 | Val  Acc: 0.9292
 Site-dslr                          | Val  Loss: 0.1067 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.2103 | Val  Acc: 0.9412
 Site-synthetic                     | Val  Loss: 3.0685 | Val  Acc: 0.4133
Average Valid Accuracy: 0.9223
============ Train epoch 27 ============
 Site-amazon                        | Train Loss: 0.1023 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.0411 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0253 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0344 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0158 | Train Acc: 0.9955
 Site-webcam                        | Train Loss: 0.3152 | Train Acc: 0.8393
 Site-webcam                        | Train Loss: 0.1973 | Train Acc: 0.9592
 Site-webcam                        | Train Loss: 0.1563 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 0.1844 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 0.2328 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 1.9114 | Train Acc: 0.6161
Average Train Accuracy: 0.9245
 Site-amazon                        | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0498 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0780 | Val  Acc: 0.9900
 Site-amazon                        | Val  Loss: 0.0528 | Val  Acc: 0.9866
 Site-webcam                        | Val  Loss: 0.2507 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.0791 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.1478 | Val  Acc: 0.9646
 Site-dslr                          | Val  Loss: 0.1139 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.1068 | Val  Acc: 0.9294
 Site-synthetic                     | Val  Loss: 3.0371 | Val  Acc: 0.4667
Average Valid Accuracy: 0.9271
 Best site-amazon                    | Epoch:27 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:27 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:27 | Val Acc: 0.9850
 Best site-amazon                    | Epoch:27 | Val Acc: 0.9900
 Best site-amazon                    | Epoch:27 | Val Acc: 0.9866
 Best site-webcam                    | Epoch:27 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:27 | Val Acc: 0.9538
 Best site-webcam                    | Epoch:27 | Val Acc: 0.9646
 Best site-dslr                      | Epoch:27 | Val Acc: 0.9762
 Best site-dslr                      | Epoch:27 | Val Acc: 0.9294
 Best site-synthetic                 | Epoch:27 | Val Acc: 0.4667
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 28 ============
 Site-amazon                        | Train Loss: 0.0470 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0423 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0429 | Train Acc: 0.9950
 Site-amazon                        | Train Loss: 0.0541 | Train Acc: 0.9933
 Site-amazon                        | Train Loss: 0.0148 | Train Acc: 0.9955
 Site-webcam                        | Train Loss: 0.2903 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 0.1117 | Train Acc: 0.9592
 Site-webcam                        | Train Loss: 0.1562 | Train Acc: 0.9529
 Site-dslr                          | Train Loss: 0.1774 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.1931 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.3071 | Train Acc: 0.5536
Average Train Accuracy: 0.9318
 Site-amazon                        | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0390 | Val  Acc: 0.9775
 Site-amazon                        | Val  Loss: 0.0516 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0593 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0341 | Val  Acc: 0.9900
 Site-webcam                        | Val  Loss: 0.1843 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1405 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.2501 | Val  Acc: 0.9292
 Site-dslr                          | Val  Loss: 0.1169 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.1961 | Val  Acc: 0.9529
 Site-synthetic                     | Val  Loss: 2.7981 | Val  Acc: 0.4933
Average Valid Accuracy: 0.9279
 Best site-amazon                    | Epoch:28 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:28 | Val Acc: 0.9775
 Best site-amazon                    | Epoch:28 | Val Acc: 0.9925
 Best site-amazon                    | Epoch:28 | Val Acc: 0.9950
 Best site-amazon                    | Epoch:28 | Val Acc: 0.9900
 Best site-webcam                    | Epoch:28 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:28 | Val Acc: 0.9538
 Best site-webcam                    | Epoch:28 | Val Acc: 0.9292
 Best site-dslr                      | Epoch:28 | Val Acc: 0.9762
 Best site-dslr                      | Epoch:28 | Val Acc: 0.9529
 Best site-synthetic                 | Epoch:28 | Val Acc: 0.4933
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 29 ============
 Site-amazon                        | Train Loss: 0.1127 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0732 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0536 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0558 | Train Acc: 0.9833
 Site-amazon                        | Train Loss: 0.0158 | Train Acc: 0.9955
 Site-webcam                        | Train Loss: 0.3457 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.1493 | Train Acc: 0.9490
 Site-webcam                        | Train Loss: 0.1202 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.2498 | Train Acc: 0.9062
 Site-dslr                          | Train Loss: 0.2476 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.0376 | Train Acc: 0.5357
Average Train Accuracy: 0.9161
 Site-amazon                        | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0682 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0237 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0247 | Val  Acc: 0.9933
 Site-webcam                        | Val  Loss: 0.2745 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1319 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 0.1405 | Val  Acc: 0.9646
 Site-dslr                          | Val  Loss: 0.0511 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.0991 | Val  Acc: 0.9647
 Site-synthetic                     | Val  Loss: 3.2984 | Val  Acc: 0.4267
Average Valid Accuracy: 0.9268
============ Train epoch 30 ============
 Site-amazon                        | Train Loss: 0.1460 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0379 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0873 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0166 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0062 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.3603 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 0.1492 | Train Acc: 0.9490
 Site-webcam                        | Train Loss: 0.1204 | Train Acc: 0.9647
 Site-dslr                          | Train Loss: 0.1793 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.2009 | Train Acc: 0.9453
 Site-synthetic                     | Train Loss: 2.0908 | Train Acc: 0.5714
Average Train Accuracy: 0.9315
 Site-amazon                        | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0263 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0323 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0386 | Val  Acc: 0.9933
 Site-webcam                        | Val  Loss: 0.2395 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.0879 | Val  Acc: 0.9846
 Site-webcam                        | Val  Loss: 0.1686 | Val  Acc: 0.9735
 Site-dslr                          | Val  Loss: 0.1256 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.1794 | Val  Acc: 0.9529
 Site-synthetic                     | Val  Loss: 2.9052 | Val  Acc: 0.4533
Average Valid Accuracy: 0.9296
 Best site-amazon                    | Epoch:30 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:30 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:30 | Val Acc: 0.9850
 Best site-amazon                    | Epoch:30 | Val Acc: 0.9850
 Best site-amazon                    | Epoch:30 | Val Acc: 0.9933
 Best site-webcam                    | Epoch:30 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:30 | Val Acc: 0.9846
 Best site-webcam                    | Epoch:30 | Val Acc: 0.9735
 Best site-dslr                      | Epoch:30 | Val Acc: 0.9524
 Best site-dslr                      | Epoch:30 | Val Acc: 0.9529
 Best site-synthetic                 | Epoch:30 | Val Acc: 0.4533
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 31 ============
 Site-amazon                        | Train Loss: 0.0548 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0369 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0603 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0335 | Train Acc: 0.9867
 Site-amazon                        | Train Loss: 0.0174 | Train Acc: 0.9911
 Site-webcam                        | Train Loss: 0.3282 | Train Acc: 0.8571
 Site-webcam                        | Train Loss: 0.1514 | Train Acc: 0.9694
 Site-webcam                        | Train Loss: 0.1563 | Train Acc: 0.9529
 Site-dslr                          | Train Loss: 0.1303 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.2769 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.1894 | Train Acc: 0.5714
Average Train Accuracy: 0.9228
 Site-amazon                        | Val  Loss: 0.0075 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0215 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0325 | Val  Acc: 0.9900
 Site-amazon                        | Val  Loss: 0.0295 | Val  Acc: 0.9933
 Site-webcam                        | Val  Loss: 0.2917 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.0840 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.1959 | Val  Acc: 0.9735
 Site-dslr                          | Val  Loss: 0.1211 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.1032 | Val  Acc: 0.9412
 Site-synthetic                     | Val  Loss: 2.6907 | Val  Acc: 0.4533
Average Valid Accuracy: 0.9315
 Best site-amazon                    | Epoch:31 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:31 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:31 | Val Acc: 0.9925
 Best site-amazon                    | Epoch:31 | Val Acc: 0.9900
 Best site-amazon                    | Epoch:31 | Val Acc: 0.9933
 Best site-webcam                    | Epoch:31 | Val Acc: 0.9730
 Best site-webcam                    | Epoch:31 | Val Acc: 0.9538
 Best site-webcam                    | Epoch:31 | Val Acc: 0.9735
 Best site-dslr                      | Epoch:31 | Val Acc: 0.9762
 Best site-dslr                      | Epoch:31 | Val Acc: 0.9412
 Best site-synthetic                 | Epoch:31 | Val Acc: 0.4533
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 32 ============
 Site-amazon                        | Train Loss: 0.0581 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0658 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0364 | Train Acc: 0.9950
 Site-amazon                        | Train Loss: 0.0286 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0134 | Train Acc: 0.9933
 Site-webcam                        | Train Loss: 0.3842 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 0.1656 | Train Acc: 0.9388
 Site-webcam                        | Train Loss: 0.1319 | Train Acc: 0.9647
 Site-dslr                          | Train Loss: 0.1993 | Train Acc: 0.9219
 Site-dslr                          | Train Loss: 0.1090 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.0558 | Train Acc: 0.5804
Average Train Accuracy: 0.9316
 Site-amazon                        | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0471 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0499 | Val  Acc: 0.9900
 Site-amazon                        | Val  Loss: 0.0329 | Val  Acc: 0.9900
 Site-webcam                        | Val  Loss: 0.3247 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1793 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.2287 | Val  Acc: 0.9381
 Site-dslr                          | Val  Loss: 0.4965 | Val  Acc: 0.9048
 Site-dslr                          | Val  Loss: 0.1084 | Val  Acc: 0.9647
 Site-synthetic                     | Val  Loss: 2.9875 | Val  Acc: 0.4533
Average Valid Accuracy: 0.9177
============ Train epoch 33 ============
 Site-amazon                        | Train Loss: 0.1316 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0319 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0390 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0387 | Train Acc: 0.9933
 Site-amazon                        | Train Loss: 0.0087 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.3204 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.1295 | Train Acc: 0.9592
 Site-webcam                        | Train Loss: 0.1383 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 0.2793 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.1551 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.1412 | Train Acc: 0.5804
Average Train Accuracy: 0.9270
 Site-amazon                        | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0252 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0211 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0585 | Val  Acc: 0.9866
 Site-webcam                        | Val  Loss: 0.2386 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.1106 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.2077 | Val  Acc: 0.9469
 Site-dslr                          | Val  Loss: 0.0825 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.2959 | Val  Acc: 0.9529
 Site-synthetic                     | Val  Loss: 3.3671 | Val  Acc: 0.4400
Average Valid Accuracy: 0.9244
============ Train epoch 34 ============
 Site-amazon                        | Train Loss: 0.0725 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0439 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0431 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0331 | Train Acc: 0.9967
 Site-amazon                        | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.2613 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 0.1339 | Train Acc: 0.9796
 Site-webcam                        | Train Loss: 0.0943 | Train Acc: 0.9647
 Site-dslr                          | Train Loss: 0.1354 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.1804 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.1369 | Train Acc: 0.5536
Average Train Accuracy: 0.9336
 Site-amazon                        | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0285 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0647 | Val  Acc: 0.9900
 Site-amazon                        | Val  Loss: 0.0406 | Val  Acc: 0.9967
 Site-webcam                        | Val  Loss: 0.1237 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.0899 | Val  Acc: 0.9692
 Site-webcam                        | Val  Loss: 0.1098 | Val  Acc: 0.9823
 Site-dslr                          | Val  Loss: 0.1210 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.0821 | Val  Acc: 0.9765
 Site-synthetic                     | Val  Loss: 2.8089 | Val  Acc: 0.4933
Average Valid Accuracy: 0.9387
 Best site-amazon                    | Epoch:34 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:34 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9925
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9900
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9967
 Best site-webcam                    | Epoch:34 | Val Acc: 0.9730
 Best site-webcam                    | Epoch:34 | Val Acc: 0.9692
 Best site-webcam                    | Epoch:34 | Val Acc: 0.9823
 Best site-dslr                      | Epoch:34 | Val Acc: 0.9524
 Best site-dslr                      | Epoch:34 | Val Acc: 0.9765
 Best site-synthetic                 | Epoch:34 | Val Acc: 0.4933
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 35 ============
 Site-amazon                        | Train Loss: 0.0130 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0419 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0490 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0142 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0109 | Train Acc: 0.9978
 Site-webcam                        | Train Loss: 0.4239 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 0.0798 | Train Acc: 0.9796
 Site-webcam                        | Train Loss: 0.1196 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.1221 | Train Acc: 0.9844
 Site-dslr                          | Train Loss: 0.2469 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.2107 | Train Acc: 0.5536
Average Train Accuracy: 0.9351
 Site-amazon                        | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0269 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0236 | Val  Acc: 0.9900
 Site-webcam                        | Val  Loss: 0.1934 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.0888 | Val  Acc: 0.9846
 Site-webcam                        | Val  Loss: 0.0912 | Val  Acc: 0.9912
 Site-dslr                          | Val  Loss: 0.2313 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.1308 | Val  Acc: 0.9294
 Site-synthetic                     | Val  Loss: 2.6990 | Val  Acc: 0.4933
Average Valid Accuracy: 0.9372
============ Train epoch 36 ============
 Site-amazon                        | Train Loss: 0.0480 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0337 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0309 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0172 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0054 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.3424 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.1569 | Train Acc: 0.9490
 Site-webcam                        | Train Loss: 0.1515 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.1722 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.2019 | Train Acc: 0.9219
 Site-synthetic                     | Train Loss: 2.2577 | Train Acc: 0.5089
Average Train Accuracy: 0.9216
 Site-amazon                        | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0154 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0486 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0378 | Val  Acc: 0.9933
 Site-webcam                        | Val  Loss: 0.2019 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.0934 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.1076 | Val  Acc: 0.9646
 Site-dslr                          | Val  Loss: 0.1651 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 0.1017 | Val  Acc: 0.9647
 Site-synthetic                     | Val  Loss: 3.3837 | Val  Acc: 0.4533
Average Valid Accuracy: 0.9297
============ Train epoch 37 ============
 Site-amazon                        | Train Loss: 0.0605 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0155 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0176 | Train Acc: 0.9950
 Site-amazon                        | Train Loss: 0.0273 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0134 | Train Acc: 0.9955
 Site-webcam                        | Train Loss: 0.2184 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 0.1759 | Train Acc: 0.9490
 Site-webcam                        | Train Loss: 0.1633 | Train Acc: 0.9235
 Site-dslr                          | Train Loss: 0.1653 | Train Acc: 0.9688
 Site-dslr                          | Train Loss: 0.1884 | Train Acc: 0.9219
 Site-synthetic                     | Train Loss: 2.0872 | Train Acc: 0.5714
Average Train Accuracy: 0.9312
 Site-amazon                        | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0475 | Val  Acc: 0.9900
 Site-amazon                        | Val  Loss: 0.0493 | Val  Acc: 0.9833
 Site-webcam                        | Val  Loss: 0.0576 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.1108 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.1285 | Val  Acc: 0.9558
 Site-dslr                          | Val  Loss: 0.0794 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.1524 | Val  Acc: 0.9529
 Site-synthetic                     | Val  Loss: 2.9250 | Val  Acc: 0.4667
Average Valid Accuracy: 0.9292
============ Train epoch 38 ============
 Site-amazon                        | Train Loss: 0.1158 | Train Acc: 0.9663
 Site-amazon                        | Train Loss: 0.0363 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0253 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0331 | Train Acc: 0.9933
 Site-amazon                        | Train Loss: 0.0137 | Train Acc: 0.9933
 Site-webcam                        | Train Loss: 0.2673 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 0.0964 | Train Acc: 0.9898
 Site-webcam                        | Train Loss: 0.1532 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 0.1826 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.1296 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.2054 | Train Acc: 0.5179
Average Train Accuracy: 0.9267
 Site-amazon                        | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0165 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0388 | Val  Acc: 0.9866
 Site-webcam                        | Val  Loss: 0.2836 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.1207 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.0922 | Val  Acc: 0.9823
 Site-dslr                          | Val  Loss: 0.1066 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.1693 | Val  Acc: 0.9059
 Site-synthetic                     | Val  Loss: 2.9344 | Val  Acc: 0.4400
Average Valid Accuracy: 0.9260
============ Train epoch 39 ============
 Site-amazon                        | Train Loss: 0.0176 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0424 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0141 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0310 | Train Acc: 0.9967
 Site-amazon                        | Train Loss: 0.0202 | Train Acc: 0.9978
 Site-webcam                        | Train Loss: 0.2259 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 0.1268 | Train Acc: 0.9490
 Site-webcam                        | Train Loss: 0.1832 | Train Acc: 0.9529
 Site-dslr                          | Train Loss: 0.1325 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.1459 | Train Acc: 0.9531
 Site-synthetic                     | Train Loss: 2.1673 | Train Acc: 0.5357
Average Train Accuracy: 0.9273
 Site-amazon                        | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0141 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0154 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0338 | Val  Acc: 0.9900
 Site-webcam                        | Val  Loss: 0.3384 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1362 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.0740 | Val  Acc: 0.9823
 Site-dslr                          | Val  Loss: 0.0608 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0523 | Val  Acc: 0.9882
 Site-synthetic                     | Val  Loss: 3.3298 | Val  Acc: 0.4667
Average Valid Accuracy: 0.9388
 Best site-amazon                    | Epoch:39 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:39 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:39 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:39 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:39 | Val Acc: 0.9900
 Best site-webcam                    | Epoch:39 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:39 | Val Acc: 0.9538
 Best site-webcam                    | Epoch:39 | Val Acc: 0.9823
 Best site-dslr                      | Epoch:39 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:39 | Val Acc: 0.9882
 Best site-synthetic                 | Epoch:39 | Val Acc: 0.4667
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 40 ============
 Site-amazon                        | Train Loss: 0.0578 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0163 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0270 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0217 | Train Acc: 0.9967
 Site-amazon                        | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.4083 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 0.1798 | Train Acc: 0.9694
 Site-webcam                        | Train Loss: 0.1496 | Train Acc: 0.9529
 Site-dslr                          | Train Loss: 0.0625 | Train Acc: 0.9844
 Site-dslr                          | Train Loss: 0.1652 | Train Acc: 0.9453
 Site-synthetic                     | Train Loss: 1.9833 | Train Acc: 0.5804
Average Train Accuracy: 0.9366
 Site-amazon                        | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0354 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0190 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0306 | Val  Acc: 0.9933
 Site-webcam                        | Val  Loss: 0.1934 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1043 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.1712 | Val  Acc: 0.9735
 Site-dslr                          | Val  Loss: 0.1260 | Val  Acc: 0.9524
 Site-dslr                          | Val  Loss: 0.0750 | Val  Acc: 0.9882
 Site-synthetic                     | Val  Loss: 3.2203 | Val  Acc: 0.4800
Average Valid Accuracy: 0.9341
============ Train epoch 41 ============
 Site-amazon                        | Train Loss: 0.0838 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0133 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0236 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0310 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0054 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.2468 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 0.0645 | Train Acc: 0.9694
 Site-webcam                        | Train Loss: 0.1503 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 0.1291 | Train Acc: 0.9844
 Site-dslr                          | Train Loss: 0.1893 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 1.9941 | Train Acc: 0.5804
Average Train Accuracy: 0.9389
 Site-amazon                        | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0300 | Val  Acc: 0.9933
 Site-webcam                        | Val  Loss: 0.2754 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1187 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 0.1679 | Val  Acc: 0.9558
 Site-dslr                          | Val  Loss: 0.3134 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 0.1843 | Val  Acc: 0.9529
 Site-synthetic                     | Val  Loss: 2.9551 | Val  Acc: 0.4533
Average Valid Accuracy: 0.9244
============ Train epoch 42 ============
 Site-amazon                        | Train Loss: 0.0487 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0233 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0363 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0219 | Train Acc: 0.9967
 Site-amazon                        | Train Loss: 0.0078 | Train Acc: 0.9978
 Site-webcam                        | Train Loss: 0.2981 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 0.1337 | Train Acc: 0.9592
 Site-webcam                        | Train Loss: 0.1250 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.1260 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.1395 | Train Acc: 0.9531
 Site-synthetic                     | Train Loss: 2.3034 | Train Acc: 0.5357
Average Train Accuracy: 0.9298
 Site-amazon                        | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0087 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0283 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0212 | Val  Acc: 0.9967
 Site-webcam                        | Val  Loss: 0.1710 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.0846 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.1532 | Val  Acc: 0.9558
 Site-dslr                          | Val  Loss: 0.1610 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.0978 | Val  Acc: 0.9529
 Site-synthetic                     | Val  Loss: 3.6789 | Val  Acc: 0.4400
Average Valid Accuracy: 0.9285
============ Train epoch 43 ============
 Site-amazon                        | Train Loss: 0.0724 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0287 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0425 | Train Acc: 0.9800
 Site-amazon                        | Train Loss: 0.0202 | Train Acc: 0.9967
 Site-amazon                        | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.4433 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 0.0485 | Train Acc: 0.9898
 Site-webcam                        | Train Loss: 0.0844 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.2256 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.1876 | Train Acc: 0.9141
 Site-synthetic                     | Train Loss: 2.0514 | Train Acc: 0.5357
Average Train Accuracy: 0.9271
 Site-amazon                        | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0320 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0505 | Val  Acc: 0.9900
 Site-amazon                        | Val  Loss: 0.0186 | Val  Acc: 0.9967
 Site-webcam                        | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0474 | Val  Acc: 0.9692
 Site-webcam                        | Val  Loss: 0.1501 | Val  Acc: 0.9823
 Site-dslr                          | Val  Loss: 0.0881 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.1331 | Val  Acc: 0.9412
 Site-synthetic                     | Val  Loss: 3.4782 | Val  Acc: 0.4267
Average Valid Accuracy: 0.9334
============ Train epoch 44 ============
 Site-amazon                        | Train Loss: 0.0322 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0281 | Train Acc: 0.9851
 Site-amazon                        | Train Loss: 0.0137 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0108 | Train Acc: 0.9967
 Site-amazon                        | Train Loss: 0.0131 | Train Acc: 0.9978
 Site-webcam                        | Train Loss: 0.1732 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 0.1032 | Train Acc: 0.9694
 Site-webcam                        | Train Loss: 0.1197 | Train Acc: 0.9706
 Site-dslr                          | Train Loss: 0.0727 | Train Acc: 0.9844
 Site-dslr                          | Train Loss: 0.1937 | Train Acc: 0.9297
 Site-synthetic                     | Train Loss: 2.0616 | Train Acc: 0.6161
Average Train Accuracy: 0.9425
 Site-amazon                        | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0171 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0165 | Val  Acc: 0.9967
 Site-webcam                        | Val  Loss: 0.2495 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.0804 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 0.1036 | Val  Acc: 0.9735
 Site-dslr                          | Val  Loss: 0.0690 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1297 | Val  Acc: 0.9412
 Site-synthetic                     | Val  Loss: 3.1981 | Val  Acc: 0.4800
Average Valid Accuracy: 0.9362
============ Train epoch 45 ============
 Site-amazon                        | Train Loss: 0.0667 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.2839 | Train Acc: 0.9776
 Site-amazon                        | Train Loss: 0.0250 | Train Acc: 0.9850
 Site-amazon                        | Train Loss: 0.0218 | Train Acc: 0.9933
 Site-amazon                        | Train Loss: 0.0124 | Train Acc: 0.9978
 Site-webcam                        | Train Loss: 0.4127 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 0.0429 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.1264 | Train Acc: 0.9647
 Site-dslr                          | Train Loss: 0.1639 | Train Acc: 0.9531
 Site-dslr                          | Train Loss: 0.1048 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.4115 | Train Acc: 0.4821
Average Train Accuracy: 0.9293
 Site-amazon                        | Val  Loss: 0.0131 | Val  Acc: 0.9831
 Site-amazon                        | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0278 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0224 | Val  Acc: 0.9933
 Site-webcam                        | Val  Loss: 0.1965 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.1251 | Val  Acc: 0.9538
 Site-webcam                        | Val  Loss: 0.1996 | Val  Acc: 0.9646
 Site-dslr                          | Val  Loss: 0.0892 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.0609 | Val  Acc: 0.9882
 Site-synthetic                     | Val  Loss: 3.1058 | Val  Acc: 0.4667
Average Valid Accuracy: 0.9358
============ Train epoch 46 ============
 Site-amazon                        | Train Loss: 0.0826 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0115 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0167 | Train Acc: 0.9950
 Site-amazon                        | Train Loss: 0.0133 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0044 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.2603 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 0.0818 | Train Acc: 0.9592
 Site-webcam                        | Train Loss: 0.1478 | Train Acc: 0.9647
 Site-dslr                          | Train Loss: 0.2298 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.1142 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.2959 | Train Acc: 0.5357
Average Train Accuracy: 0.9317
 Site-amazon                        | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0149 | Val  Acc: 0.9925
 Site-amazon                        | Val  Loss: 0.0212 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0178 | Val  Acc: 0.9933
 Site-webcam                        | Val  Loss: 0.1523 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.0979 | Val  Acc: 0.9692
 Site-webcam                        | Val  Loss: 0.1480 | Val  Acc: 0.9823
 Site-dslr                          | Val  Loss: 0.0540 | Val  Acc: 0.9762
 Site-dslr                          | Val  Loss: 0.0517 | Val  Acc: 0.9882
 Site-synthetic                     | Val  Loss: 3.1189 | Val  Acc: 0.4800
Average Valid Accuracy: 0.9413
 Best site-amazon                    | Epoch:46 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:46 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:46 | Val Acc: 0.9925
 Best site-amazon                    | Epoch:46 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:46 | Val Acc: 0.9933
 Best site-webcam                    | Epoch:46 | Val Acc: 0.9730
 Best site-webcam                    | Epoch:46 | Val Acc: 0.9692
 Best site-webcam                    | Epoch:46 | Val Acc: 0.9823
 Best site-dslr                      | Epoch:46 | Val Acc: 0.9762
 Best site-dslr                      | Epoch:46 | Val Acc: 0.9882
 Best site-synthetic                 | Epoch:46 | Val Acc: 0.4800
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/fedsam...
============ Train epoch 47 ============
 Site-amazon                        | Train Loss: 0.0314 | Train Acc: 0.9775
 Site-amazon                        | Train Loss: 0.0276 | Train Acc: 0.9776
 Site-amazon                        | Train Loss: 0.0112 | Train Acc: 0.9950
 Site-amazon                        | Train Loss: 0.0311 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0081 | Train Acc: 0.9978
 Site-webcam                        | Train Loss: 0.4866 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.0469 | Train Acc: 0.9898
 Site-webcam                        | Train Loss: 0.1252 | Train Acc: 0.9647
 Site-dslr                          | Train Loss: 0.1852 | Train Acc: 0.9688
 Site-dslr                          | Train Loss: 0.1660 | Train Acc: 0.9297
 Site-synthetic                     | Train Loss: 2.0452 | Train Acc: 0.5804
Average Train Accuracy: 0.9315
 Site-amazon                        | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0160 | Val  Acc: 0.9888
 Site-amazon                        | Val  Loss: 0.0366 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.1312 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1481 | Val  Acc: 0.9385
 Site-webcam                        | Val  Loss: 0.1086 | Val  Acc: 0.9646
 Site-dslr                          | Val  Loss: 0.0773 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1291 | Val  Acc: 0.9765
 Site-synthetic                     | Val  Loss: 3.2563 | Val  Acc: 0.4933
Average Valid Accuracy: 0.9371
============ Train epoch 48 ============
 Site-amazon                        | Train Loss: 0.0292 | Train Acc: 0.9888
 Site-amazon                        | Train Loss: 0.0161 | Train Acc: 0.9925
 Site-amazon                        | Train Loss: 0.0431 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0197 | Train Acc: 0.9967
 Site-amazon                        | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.2091 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 0.0977 | Train Acc: 0.9796
 Site-webcam                        | Train Loss: 0.1168 | Train Acc: 0.9824
 Site-dslr                          | Train Loss: 0.1881 | Train Acc: 0.9375
 Site-dslr                          | Train Loss: 0.1554 | Train Acc: 0.9453
 Site-synthetic                     | Train Loss: 2.0077 | Train Acc: 0.5268
Average Train Accuracy: 0.9318
 Site-amazon                        | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0126 | Val  Acc: 0.9850
 Site-amazon                        | Val  Loss: 0.0178 | Val  Acc: 0.9950
 Site-amazon                        | Val  Loss: 0.0255 | Val  Acc: 0.9900
 Site-webcam                        | Val  Loss: 0.1344 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.1447 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.1116 | Val  Acc: 0.9823
 Site-dslr                          | Val  Loss: 0.3235 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 0.0901 | Val  Acc: 0.9647
 Site-synthetic                     | Val  Loss: 3.2286 | Val  Acc: 0.4800
Average Valid Accuracy: 0.9268
============ Train epoch 49 ============
 Site-amazon                        | Train Loss: 0.0863 | Train Acc: 0.9551
 Site-amazon                        | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0240 | Train Acc: 0.9900
 Site-amazon                        | Train Loss: 0.0143 | Train Acc: 0.9967
 Site-amazon                        | Train Loss: 0.0069 | Train Acc: 0.9978
 Site-webcam                        | Train Loss: 0.1289 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 0.0948 | Train Acc: 0.9592
 Site-webcam                        | Train Loss: 0.1675 | Train Acc: 0.9588
 Site-dslr                          | Train Loss: 0.1582 | Train Acc: 0.9688
 Site-dslr                          | Train Loss: 0.1336 | Train Acc: 0.9609
 Site-synthetic                     | Train Loss: 2.1265 | Train Acc: 0.6161
Average Train Accuracy: 0.9409
 Site-amazon                        | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0131 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.0390 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 0.0963 | Val  Acc: 0.9231
 Site-webcam                        | Val  Loss: 0.1433 | Val  Acc: 0.9646
 Site-dslr                          | Val  Loss: 0.1254 | Val  Acc: 0.9286
 Site-dslr                          | Val  Loss: 0.0798 | Val  Acc: 0.9647
 Site-synthetic                     | Val  Loss: 2.8515 | Val  Acc: 0.4400
Average Valid Accuracy: 0.9267
===2023-08-04 13:25:13===
===2023-08-04 13:25:25===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[89,134,200,300,449,56,98,170,64,128,112,
client_nums=[5,3,2,1,]
len_dataset=[1959,544,320,188,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (1)| Epoch:46 | Test Acc: 0.9744
 Test site-webcam                    (3)| Epoch:46 | Test Acc: 0.9442
 Test site-dslr                      (0)| Epoch:46 | Test Acc: 0.9136
 Test site-synthetic                 (2)| Epoch:46 | Test Acc: 0.6258
amazon: 0.9744, webcam: 0.9442, dslr: 0.9136, synthetic: 0.6258, 
Average Test Accuracy(group): 0.8645, Average Test Accuracy(individual): 0.9234,
domain std=0.1395, cluster std=0.1395, individual std=0.0968, 
