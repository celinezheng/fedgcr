===2023-08-03 20:29:23===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 3
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[64,96,143,215,321,60,134,300,24,120,85,
client_nums=[5,3,2,1,]
len_dataset=[1403,825,243,142,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-amazon                    (0) | Train Loss: 3.2775 | Train Acc: 0.1094
 Site-amazon                    (3) | Train Loss: 3.3313 | Train Acc: 0.0625
 Site-amazon                    (0) | Train Loss: 3.2143 | Train Acc: 0.1818
 Site-amazon                    (3) | Train Loss: 3.2374 | Train Acc: 0.1395
 Site-amazon                    (3) | Train Loss: 3.2861 | Train Acc: 0.1059
 Site-synthetic                 (1) | Train Loss: 3.3267 | Train Acc: 0.0500
 Site-synthetic                 (1) | Train Loss: 3.3661 | Train Acc: 0.1045
 Site-synthetic                 (1) | Train Loss: 3.3398 | Train Acc: 0.0867
 Site-dslr                      (2) | Train Loss: 3.3696 | Train Acc: 0.0417
 Site-dslr                      (2) | Train Loss: 3.3723 | Train Acc: 0.0833
 Site-webcam                    (2) | Train Loss: 3.3383 | Train Acc: 0.0353
Average Train Accuracy: 0.0910
 Site-amazon                    (0) | Val  Loss: 3.3133 | Val  Acc: 0.0238
 Site-amazon                    (3) | Val  Loss: 3.2730 | Val  Acc: 0.0781
 Site-amazon                    (0) | Val  Loss: 3.2567 | Val  Acc: 0.1684
 Site-amazon                    (3) | Val  Loss: 3.2476 | Val  Acc: 0.0979
 Site-amazon                    (3) | Val  Loss: 3.2686 | Val  Acc: 0.1168
 Site-synthetic                 (1) | Val  Loss: 3.3115 | Val  Acc: 0.1000
 Site-synthetic                 (1) | Val  Loss: 3.3447 | Val  Acc: 0.0899
 Site-synthetic                 (1) | Val  Loss: 3.3913 | Val  Acc: 0.1050
 Site-dslr                      (2) | Val  Loss: 3.2971 | Val  Acc: 0.1875
 Site-dslr                      (2) | Val  Loss: 3.2974 | Val  Acc: 0.1000
 Site-webcam                    (2) | Val  Loss: 3.3884 | Val  Acc: 0.0714
Average Valid Accuracy: 0.1035
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.0238
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.0781
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.1684
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.0979
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.1168
 Best site-synthetic                (1)  | Epoch:0 | Val Acc: 0.1000
 Best site-synthetic                (1)  | Epoch:0 | Val Acc: 0.0899
 Best site-synthetic                (1)  | Epoch:0 | Val Acc: 0.1050
 Best site-dslr                     (2)  | Epoch:0 | Val Acc: 0.1875
 Best site-dslr                     (2)  | Epoch:0 | Val Acc: 0.1000
 Best site-webcam                   (2)  | Epoch:0 | Val Acc: 0.0714
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-amazon                    (0) | Train Loss: 2.9599 | Train Acc: 0.3906
 Site-amazon                    (0) | Train Loss: 3.0217 | Train Acc: 0.3021
 Site-amazon                    (0) | Train Loss: 2.9611 | Train Acc: 0.3217
 Site-amazon                    (0) | Train Loss: 2.9351 | Train Acc: 0.3767
 Site-amazon                    (0) | Train Loss: 2.9934 | Train Acc: 0.3178
 Site-synthetic                 (2) | Train Loss: 3.1148 | Train Acc: 0.1333
 Site-synthetic                 (2) | Train Loss: 3.0539 | Train Acc: 0.2015
 Site-synthetic                 (2) | Train Loss: 3.1251 | Train Acc: 0.1833
 Site-dslr                      (1) | Train Loss: 3.1394 | Train Acc: 0.1667
 Site-dslr                      (1) | Train Loss: 3.0666 | Train Acc: 0.2417
 Site-webcam                    (3) | Train Loss: 3.0860 | Train Acc: 0.2353
Average Train Accuracy: 0.2610
 Site-amazon                    (0) | Val  Loss: 2.9824 | Val  Acc: 0.2381
 Site-amazon                    (0) | Val  Loss: 2.9484 | Val  Acc: 0.3281
 Site-amazon                    (0) | Val  Loss: 2.9733 | Val  Acc: 0.3789
 Site-amazon                    (0) | Val  Loss: 2.9235 | Val  Acc: 0.3497
 Site-amazon                    (0) | Val  Loss: 2.9361 | Val  Acc: 0.3832
 Site-synthetic                 (2) | Val  Loss: 3.0722 | Val  Acc: 0.2750
 Site-synthetic                 (2) | Val  Loss: 3.0808 | Val  Acc: 0.2472
 Site-synthetic                 (2) | Val  Loss: 3.1737 | Val  Acc: 0.1650
 Site-dslr                      (1) | Val  Loss: 3.1117 | Val  Acc: 0.2500
 Site-dslr                      (1) | Val  Loss: 3.0936 | Val  Acc: 0.2000
 Site-webcam                    (3) | Val  Loss: 3.1204 | Val  Acc: 0.2143
Average Valid Accuracy: 0.2754
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.2381
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.3281
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.3789
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.3497
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.3832
 Best site-synthetic                (2)  | Epoch:1 | Val Acc: 0.2750
 Best site-synthetic                (2)  | Epoch:1 | Val Acc: 0.2472
 Best site-synthetic                (2)  | Epoch:1 | Val Acc: 0.1650
 Best site-dslr                     (1)  | Epoch:1 | Val Acc: 0.2500
 Best site-dslr                     (1)  | Epoch:1 | Val Acc: 0.2000
 Best site-webcam                   (3)  | Epoch:1 | Val Acc: 0.2143
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[3, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-amazon                    (3) | Train Loss: 2.6775 | Train Acc: 0.5938
 Site-amazon                    (1) | Train Loss: 2.6580 | Train Acc: 0.5417
 Site-amazon                    (1) | Train Loss: 2.7382 | Train Acc: 0.5105
 Site-amazon                    (1) | Train Loss: 2.6175 | Train Acc: 0.5953
 Site-amazon                    (1) | Train Loss: 2.7324 | Train Acc: 0.5670
 Site-synthetic                 (0) | Train Loss: 2.9295 | Train Acc: 0.2667
 Site-synthetic                 (0) | Train Loss: 2.9154 | Train Acc: 0.2836
 Site-synthetic                 (0) | Train Loss: 2.9428 | Train Acc: 0.2933
 Site-dslr                      (2) | Train Loss: 2.8051 | Train Acc: 0.4583
 Site-dslr                      (2) | Train Loss: 2.7939 | Train Acc: 0.4167
 Site-webcam                    (3) | Train Loss: 2.7806 | Train Acc: 0.3647
Average Train Accuracy: 0.4447
 Site-amazon                    (3) | Val  Loss: 2.7132 | Val  Acc: 0.4524
 Site-amazon                    (1) | Val  Loss: 2.6115 | Val  Acc: 0.5469
 Site-amazon                    (1) | Val  Loss: 2.6958 | Val  Acc: 0.5263
 Site-amazon                    (1) | Val  Loss: 2.6187 | Val  Acc: 0.6294
 Site-amazon                    (1) | Val  Loss: 2.6293 | Val  Acc: 0.5467
 Site-synthetic                 (0) | Val  Loss: 2.9080 | Val  Acc: 0.3750
 Site-synthetic                 (0) | Val  Loss: 2.8855 | Val  Acc: 0.3933
 Site-synthetic                 (0) | Val  Loss: 2.9663 | Val  Acc: 0.3350
 Site-dslr                      (2) | Val  Loss: 2.8880 | Val  Acc: 0.3125
 Site-dslr                      (2) | Val  Loss: 2.8391 | Val  Acc: 0.3625
 Site-webcam                    (3) | Val  Loss: 2.8517 | Val  Acc: 0.4464
Average Valid Accuracy: 0.4479
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.4524
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.5469
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.5263
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.6294
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.5467
 Best site-synthetic                (0)  | Epoch:2 | Val Acc: 0.3750
 Best site-synthetic                (0)  | Epoch:2 | Val Acc: 0.3933
 Best site-synthetic                (0)  | Epoch:2 | Val Acc: 0.3350
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.3125
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.3625
 Best site-webcam                   (3)  | Epoch:2 | Val Acc: 0.4464
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
===2023-08-03 20:40:31===
===2023-08-03 20:40:44===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[64,96,143,215,321,60,134,300,24,120,85,
client_nums=[5,3,2,1,]
len_dataset=[1403,825,243,142,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (3)| Epoch:2 | Test Acc: 0.6025
 Test site-synthetic                 (0)| Epoch:2 | Test Acc: 0.3465
 Test site-dslr                      (2)| Epoch:2 | Test Acc: 0.4941
 Test site-webcam                    (3)| Epoch:2 | Test Acc: 0.4469
amazon: 0.6025, synthetic: 0.3465, dslr: 0.4941, webcam: 0.4469, 
Average Test Accuracy(group): 0.4725, Average Test Accuracy(individual): 0.4988,
domain std=0.0921, cluster std=0.0928, individual std=0.1071, 
===2023-08-03 21:54:19===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[64,96,143,215,321,60,134,300,24,120,85,
client_nums=[5,3,2,1,]
len_dataset=[1403,825,243,142,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-amazon                    (0) | Train Loss: 3.2775 | Train Acc: 0.1094
 Site-amazon                    (3) | Train Loss: 3.3313 | Train Acc: 0.0625
 Site-amazon                    (0) | Train Loss: 3.2143 | Train Acc: 0.1818
 Site-amazon                    (3) | Train Loss: 3.2374 | Train Acc: 0.1395
 Site-amazon                    (3) | Train Loss: 3.2861 | Train Acc: 0.1059
 Site-synthetic                 (1) | Train Loss: 3.3267 | Train Acc: 0.0500
 Site-synthetic                 (1) | Train Loss: 3.3661 | Train Acc: 0.1045
 Site-synthetic                 (1) | Train Loss: 3.3398 | Train Acc: 0.0867
 Site-dslr                      (2) | Train Loss: 3.3696 | Train Acc: 0.0417
 Site-dslr                      (2) | Train Loss: 3.3723 | Train Acc: 0.0833
 Site-webcam                    (2) | Train Loss: 3.3383 | Train Acc: 0.0353
Average Train Accuracy: 0.0910
 Site-amazon                    (0) | Val  Loss: 3.3133 | Val  Acc: 0.0238
 Site-amazon                    (3) | Val  Loss: 3.2730 | Val  Acc: 0.0781
 Site-amazon                    (0) | Val  Loss: 3.2567 | Val  Acc: 0.1684
 Site-amazon                    (3) | Val  Loss: 3.2476 | Val  Acc: 0.0979
 Site-amazon                    (3) | Val  Loss: 3.2686 | Val  Acc: 0.1168
 Site-synthetic                 (1) | Val  Loss: 3.3115 | Val  Acc: 0.1000
 Site-synthetic                 (1) | Val  Loss: 3.3447 | Val  Acc: 0.0899
 Site-synthetic                 (1) | Val  Loss: 3.3913 | Val  Acc: 0.1050
 Site-dslr                      (2) | Val  Loss: 3.2971 | Val  Acc: 0.1875
 Site-dslr                      (2) | Val  Loss: 3.2974 | Val  Acc: 0.1000
 Site-webcam                    (2) | Val  Loss: 3.3884 | Val  Acc: 0.0714
Average Valid Accuracy: 0.1035
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.0238
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.0781
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.1684
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.0979
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.1168
 Best site-synthetic                (1)  | Epoch:0 | Val Acc: 0.1000
 Best site-synthetic                (1)  | Epoch:0 | Val Acc: 0.0899
 Best site-synthetic                (1)  | Epoch:0 | Val Acc: 0.1050
 Best site-dslr                     (2)  | Epoch:0 | Val Acc: 0.1875
 Best site-dslr                     (2)  | Epoch:0 | Val Acc: 0.1000
 Best site-webcam                   (2)  | Epoch:0 | Val Acc: 0.0714
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-amazon                    (0) | Train Loss: 2.9599 | Train Acc: 0.3906
 Site-amazon                    (0) | Train Loss: 3.0217 | Train Acc: 0.3021
 Site-amazon                    (0) | Train Loss: 2.9611 | Train Acc: 0.3217
 Site-amazon                    (0) | Train Loss: 2.9351 | Train Acc: 0.3767
 Site-amazon                    (0) | Train Loss: 2.9935 | Train Acc: 0.3178
 Site-synthetic                 (2) | Train Loss: 3.1148 | Train Acc: 0.1333
 Site-synthetic                 (2) | Train Loss: 3.0539 | Train Acc: 0.2015
 Site-synthetic                 (2) | Train Loss: 3.1251 | Train Acc: 0.1833
 Site-dslr                      (1) | Train Loss: 3.1394 | Train Acc: 0.1667
 Site-dslr                      (1) | Train Loss: 3.0666 | Train Acc: 0.2417
 Site-webcam                    (3) | Train Loss: 3.0861 | Train Acc: 0.2353
Average Train Accuracy: 0.2610
 Site-amazon                    (0) | Val  Loss: 2.9824 | Val  Acc: 0.2381
 Site-amazon                    (0) | Val  Loss: 2.9484 | Val  Acc: 0.3281
 Site-amazon                    (0) | Val  Loss: 2.9734 | Val  Acc: 0.3789
 Site-amazon                    (0) | Val  Loss: 2.9235 | Val  Acc: 0.3497
 Site-amazon                    (0) | Val  Loss: 2.9361 | Val  Acc: 0.3832
 Site-synthetic                 (2) | Val  Loss: 3.0722 | Val  Acc: 0.2750
 Site-synthetic                 (2) | Val  Loss: 3.0808 | Val  Acc: 0.2472
 Site-synthetic                 (2) | Val  Loss: 3.1737 | Val  Acc: 0.1650
 Site-dslr                      (1) | Val  Loss: 3.1116 | Val  Acc: 0.2500
 Site-dslr                      (1) | Val  Loss: 3.0937 | Val  Acc: 0.2000
 Site-webcam                    (3) | Val  Loss: 3.1205 | Val  Acc: 0.2143
Average Valid Accuracy: 0.2754
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.2381
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.3281
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.3789
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.3497
 Best site-amazon                   (0)  | Epoch:1 | Val Acc: 0.3832
 Best site-synthetic                (2)  | Epoch:1 | Val Acc: 0.2750
 Best site-synthetic                (2)  | Epoch:1 | Val Acc: 0.2472
 Best site-synthetic                (2)  | Epoch:1 | Val Acc: 0.1650
 Best site-dslr                     (1)  | Epoch:1 | Val Acc: 0.2500
 Best site-dslr                     (1)  | Epoch:1 | Val Acc: 0.2000
 Best site-webcam                   (3)  | Epoch:1 | Val Acc: 0.2143
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[3, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-amazon                    (3) | Train Loss: 2.6775 | Train Acc: 0.5938
 Site-amazon                    (1) | Train Loss: 2.6580 | Train Acc: 0.5417
 Site-amazon                    (1) | Train Loss: 2.7382 | Train Acc: 0.5105
 Site-amazon                    (1) | Train Loss: 2.6176 | Train Acc: 0.5953
 Site-amazon                    (1) | Train Loss: 2.7325 | Train Acc: 0.5670
 Site-synthetic                 (0) | Train Loss: 2.9294 | Train Acc: 0.2667
 Site-synthetic                 (0) | Train Loss: 2.9154 | Train Acc: 0.2836
 Site-synthetic                 (0) | Train Loss: 2.9429 | Train Acc: 0.2933
 Site-dslr                      (2) | Train Loss: 2.8051 | Train Acc: 0.4583
 Site-dslr                      (2) | Train Loss: 2.7940 | Train Acc: 0.4167
 Site-webcam                    (3) | Train Loss: 2.7807 | Train Acc: 0.3647
Average Train Accuracy: 0.4447
 Site-amazon                    (3) | Val  Loss: 2.7132 | Val  Acc: 0.4524
 Site-amazon                    (1) | Val  Loss: 2.6115 | Val  Acc: 0.5469
 Site-amazon                    (1) | Val  Loss: 2.6959 | Val  Acc: 0.5263
 Site-amazon                    (1) | Val  Loss: 2.6188 | Val  Acc: 0.6294
 Site-amazon                    (1) | Val  Loss: 2.6294 | Val  Acc: 0.5467
 Site-synthetic                 (0) | Val  Loss: 2.9080 | Val  Acc: 0.3750
 Site-synthetic                 (0) | Val  Loss: 2.8855 | Val  Acc: 0.3933
 Site-synthetic                 (0) | Val  Loss: 2.9663 | Val  Acc: 0.3350
 Site-dslr                      (2) | Val  Loss: 2.8881 | Val  Acc: 0.3125
 Site-dslr                      (2) | Val  Loss: 2.8391 | Val  Acc: 0.3625
 Site-webcam                    (3) | Val  Loss: 2.8517 | Val  Acc: 0.4464
Average Valid Accuracy: 0.4479
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.4524
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.5469
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.5263
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.6294
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.5467
 Best site-synthetic                (0)  | Epoch:2 | Val Acc: 0.3750
 Best site-synthetic                (0)  | Epoch:2 | Val Acc: 0.3933
 Best site-synthetic                (0)  | Epoch:2 | Val Acc: 0.3350
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.3125
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.3625
 Best site-webcam                   (3)  | Epoch:2 | Val Acc: 0.4464
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[3, 3, 3, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-amazon                    (3) | Train Loss: 2.4327 | Train Acc: 0.6094
 Site-amazon                    (3) | Train Loss: 2.4283 | Train Acc: 0.7396
 Site-amazon                    (1) | Train Loss: 2.4073 | Train Acc: 0.6783
 Site-amazon                    (1) | Train Loss: 2.3170 | Train Acc: 0.7163
 Site-amazon                    (1) | Train Loss: 2.3957 | Train Acc: 0.7414
 Site-synthetic                 (0) | Train Loss: 2.6653 | Train Acc: 0.4500
 Site-synthetic                 (0) | Train Loss: 2.8150 | Train Acc: 0.3806
 Site-synthetic                 (0) | Train Loss: 2.6804 | Train Acc: 0.4600
 Site-dslr                      (2) | Train Loss: 2.6182 | Train Acc: 0.5417
 Site-dslr                      (2) | Train Loss: 2.5051 | Train Acc: 0.6000
 Site-webcam                    (2) | Train Loss: 2.5939 | Train Acc: 0.5412
Average Train Accuracy: 0.5871
 Site-amazon                    (3) | Val  Loss: 2.3840 | Val  Acc: 0.6667
 Site-amazon                    (3) | Val  Loss: 2.3229 | Val  Acc: 0.6562
 Site-amazon                    (1) | Val  Loss: 2.4179 | Val  Acc: 0.6737
 Site-amazon                    (1) | Val  Loss: 2.3710 | Val  Acc: 0.6713
 Site-amazon                    (1) | Val  Loss: 2.3314 | Val  Acc: 0.6822
 Site-synthetic                 (0) | Val  Loss: 2.6887 | Val  Acc: 0.5250
 Site-synthetic                 (0) | Val  Loss: 2.6409 | Val  Acc: 0.4045
 Site-synthetic                 (0) | Val  Loss: 2.7285 | Val  Acc: 0.4600
 Site-dslr                      (2) | Val  Loss: 2.4954 | Val  Acc: 0.5625
 Site-dslr                      (2) | Val  Loss: 2.5386 | Val  Acc: 0.6750
 Site-webcam                    (2) | Val  Loss: 2.5995 | Val  Acc: 0.5714
Average Valid Accuracy: 0.5953
 Best site-amazon                   (3)  | Epoch:3 | Val Acc: 0.6667
 Best site-amazon                   (3)  | Epoch:3 | Val Acc: 0.6562
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.6737
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.6713
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.6822
 Best site-synthetic                (0)  | Epoch:3 | Val Acc: 0.5250
 Best site-synthetic                (0)  | Epoch:3 | Val Acc: 0.4045
 Best site-synthetic                (0)  | Epoch:3 | Val Acc: 0.4600
 Best site-dslr                     (2)  | Epoch:3 | Val Acc: 0.5625
 Best site-dslr                     (2)  | Epoch:3 | Val Acc: 0.6750
 Best site-webcam                   (2)  | Epoch:3 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[3, 6, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-amazon                    (1) | Train Loss: 2.0920 | Train Acc: 0.7812
 Site-amazon                    (1) | Train Loss: 2.0673 | Train Acc: 0.8125
 Site-amazon                    (1) | Train Loss: 2.1661 | Train Acc: 0.7762
 Site-amazon                    (1) | Train Loss: 2.0533 | Train Acc: 0.7907
 Site-amazon                    (1) | Train Loss: 1.9983 | Train Acc: 0.8255
 Site-synthetic                 (0) | Train Loss: 2.4068 | Train Acc: 0.5500
 Site-synthetic                 (0) | Train Loss: 2.4203 | Train Acc: 0.4328
 Site-synthetic                 (0) | Train Loss: 2.4626 | Train Acc: 0.4833
 Site-dslr                      (3) | Train Loss: 2.3761 | Train Acc: 0.5833
 Site-dslr                      (2) | Train Loss: 2.1968 | Train Acc: 0.7167
 Site-webcam                    (1) | Train Loss: 2.3128 | Train Acc: 0.6941
Average Train Accuracy: 0.6770
 Site-amazon                    (1) | Val  Loss: 2.0802 | Val  Acc: 0.7619
 Site-amazon                    (1) | Val  Loss: 2.0635 | Val  Acc: 0.7969
 Site-amazon                    (1) | Val  Loss: 2.0995 | Val  Acc: 0.7684
 Site-amazon                    (1) | Val  Loss: 2.0794 | Val  Acc: 0.7273
 Site-amazon                    (1) | Val  Loss: 2.0383 | Val  Acc: 0.7430
 Site-synthetic                 (0) | Val  Loss: 2.4724 | Val  Acc: 0.5500
 Site-synthetic                 (0) | Val  Loss: 2.4123 | Val  Acc: 0.5169
 Site-synthetic                 (0) | Val  Loss: 2.5035 | Val  Acc: 0.5150
 Site-dslr                      (3) | Val  Loss: 2.2206 | Val  Acc: 0.6875
 Site-dslr                      (2) | Val  Loss: 2.2931 | Val  Acc: 0.6375
 Site-webcam                    (1) | Val  Loss: 2.3928 | Val  Acc: 0.6071
Average Valid Accuracy: 0.6647
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.7619
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.7969
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.7684
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.7273
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.7430
 Best site-synthetic                (0)  | Epoch:4 | Val Acc: 0.5500
 Best site-synthetic                (0)  | Epoch:4 | Val Acc: 0.5169
 Best site-synthetic                (0)  | Epoch:4 | Val Acc: 0.5150
 Best site-dslr                     (3)  | Epoch:4 | Val Acc: 0.6875
 Best site-dslr                     (2)  | Epoch:4 | Val Acc: 0.6375
 Best site-webcam                   (1)  | Epoch:4 | Val Acc: 0.6071
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-amazon                    (3) | Train Loss: 1.8586 | Train Acc: 0.7812
 Site-amazon                    (3) | Train Loss: 1.8216 | Train Acc: 0.8125
 Site-amazon                    (0) | Train Loss: 1.8933 | Train Acc: 0.7343
 Site-amazon                    (0) | Train Loss: 1.7728 | Train Acc: 0.8372
 Site-amazon                    (0) | Train Loss: 1.7536 | Train Acc: 0.8598
 Site-synthetic                 (1) | Train Loss: 2.2178 | Train Acc: 0.6000
 Site-synthetic                 (1) | Train Loss: 2.2262 | Train Acc: 0.5075
 Site-synthetic                 (1) | Train Loss: 2.2319 | Train Acc: 0.5567
 Site-dslr                      (2) | Train Loss: 2.0441 | Train Acc: 0.6667
 Site-dslr                      (2) | Train Loss: 1.9278 | Train Acc: 0.7583
 Site-webcam                    (3) | Train Loss: 2.0433 | Train Acc: 0.7294
Average Train Accuracy: 0.7131
 Site-amazon                    (3) | Val  Loss: 1.8453 | Val  Acc: 0.8810
 Site-amazon                    (3) | Val  Loss: 1.7863 | Val  Acc: 0.8281
 Site-amazon                    (0) | Val  Loss: 1.8457 | Val  Acc: 0.7684
 Site-amazon                    (0) | Val  Loss: 1.8321 | Val  Acc: 0.8392
 Site-amazon                    (0) | Val  Loss: 1.7407 | Val  Acc: 0.8131
 Site-synthetic                 (1) | Val  Loss: 2.1344 | Val  Acc: 0.6500
 Site-synthetic                 (1) | Val  Loss: 2.1771 | Val  Acc: 0.5843
 Site-synthetic                 (1) | Val  Loss: 2.3082 | Val  Acc: 0.5250
 Site-dslr                      (2) | Val  Loss: 1.9326 | Val  Acc: 0.8125
 Site-dslr                      (2) | Val  Loss: 2.0294 | Val  Acc: 0.7125
 Site-webcam                    (3) | Val  Loss: 2.1089 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7389
 Best site-amazon                   (3)  | Epoch:5 | Val Acc: 0.8810
 Best site-amazon                   (3)  | Epoch:5 | Val Acc: 0.8281
 Best site-amazon                   (0)  | Epoch:5 | Val Acc: 0.7684
 Best site-amazon                   (0)  | Epoch:5 | Val Acc: 0.8392
 Best site-amazon                   (0)  | Epoch:5 | Val Acc: 0.8131
 Best site-synthetic                (1)  | Epoch:5 | Val Acc: 0.6500
 Best site-synthetic                (1)  | Epoch:5 | Val Acc: 0.5843
 Best site-synthetic                (1)  | Epoch:5 | Val Acc: 0.5250
 Best site-dslr                     (2)  | Epoch:5 | Val Acc: 0.8125
 Best site-dslr                     (2)  | Epoch:5 | Val Acc: 0.7125
 Best site-webcam                   (3)  | Epoch:5 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-amazon                    (2) | Train Loss: 1.6132 | Train Acc: 0.8281
 Site-amazon                    (0) | Train Loss: 1.5647 | Train Acc: 0.8333
 Site-amazon                    (0) | Train Loss: 1.6774 | Train Acc: 0.8042
 Site-amazon                    (0) | Train Loss: 1.5450 | Train Acc: 0.8465
 Site-amazon                    (0) | Train Loss: 1.4192 | Train Acc: 0.8629
 Site-synthetic                 (1) | Train Loss: 2.0028 | Train Acc: 0.6333
 Site-synthetic                 (1) | Train Loss: 2.1410 | Train Acc: 0.5896
 Site-synthetic                 (1) | Train Loss: 2.0206 | Train Acc: 0.6133
 Site-dslr                      (3) | Train Loss: 1.8000 | Train Acc: 0.7500
 Site-dslr                      (1) | Train Loss: 1.7572 | Train Acc: 0.7333
 Site-webcam                    (2) | Train Loss: 1.8789 | Train Acc: 0.7882
Average Train Accuracy: 0.7530
 Site-amazon                    (2) | Val  Loss: 1.5470 | Val  Acc: 0.9048
 Site-amazon                    (0) | Val  Loss: 1.5327 | Val  Acc: 0.8438
 Site-amazon                    (0) | Val  Loss: 1.6468 | Val  Acc: 0.8105
 Site-amazon                    (0) | Val  Loss: 1.5688 | Val  Acc: 0.8252
 Site-amazon                    (0) | Val  Loss: 1.5324 | Val  Acc: 0.8411
 Site-synthetic                 (1) | Val  Loss: 2.0254 | Val  Acc: 0.5500
 Site-synthetic                 (1) | Val  Loss: 2.0516 | Val  Acc: 0.5506
 Site-synthetic                 (1) | Val  Loss: 2.0960 | Val  Acc: 0.5750
 Site-dslr                      (3) | Val  Loss: 1.7276 | Val  Acc: 0.8125
 Site-dslr                      (1) | Val  Loss: 1.8510 | Val  Acc: 0.7250
 Site-webcam                    (2) | Val  Loss: 1.8963 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7412
 Best site-amazon                   (2)  | Epoch:6 | Val Acc: 0.9048
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.8438
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.8105
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.8252
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.8411
 Best site-synthetic                (1)  | Epoch:6 | Val Acc: 0.5500
 Best site-synthetic                (1)  | Epoch:6 | Val Acc: 0.5506
 Best site-synthetic                (1)  | Epoch:6 | Val Acc: 0.5750
 Best site-dslr                     (3)  | Epoch:6 | Val Acc: 0.8125
 Best site-dslr                     (1)  | Epoch:6 | Val Acc: 0.7250
 Best site-webcam                   (2)  | Epoch:6 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-amazon                    (2) | Train Loss: 1.4343 | Train Acc: 0.8438
 Site-amazon                    (2) | Train Loss: 1.3323 | Train Acc: 0.8958
 Site-amazon                    (1) | Train Loss: 1.3647 | Train Acc: 0.8392
 Site-amazon                    (1) | Train Loss: 1.2959 | Train Acc: 0.8651
 Site-amazon                    (1) | Train Loss: 1.2801 | Train Acc: 0.9065
 Site-synthetic                 (0) | Train Loss: 1.8773 | Train Acc: 0.6500
 Site-synthetic                 (0) | Train Loss: 1.9036 | Train Acc: 0.6119
 Site-synthetic                 (0) | Train Loss: 1.8490 | Train Acc: 0.6133
 Site-dslr                      (0) | Train Loss: 1.6794 | Train Acc: 0.7917
 Site-dslr                      (0) | Train Loss: 1.5403 | Train Acc: 0.8167
 Site-webcam                    (3) | Train Loss: 1.6925 | Train Acc: 0.8235
Average Train Accuracy: 0.7870
 Site-amazon                    (2) | Val  Loss: 1.3312 | Val  Acc: 0.9524
 Site-amazon                    (2) | Val  Loss: 1.3529 | Val  Acc: 0.8750
 Site-amazon                    (1) | Val  Loss: 1.4504 | Val  Acc: 0.8211
 Site-amazon                    (1) | Val  Loss: 1.3818 | Val  Acc: 0.8811
 Site-amazon                    (1) | Val  Loss: 1.3178 | Val  Acc: 0.8645
 Site-synthetic                 (0) | Val  Loss: 1.8171 | Val  Acc: 0.6750
 Site-synthetic                 (0) | Val  Loss: 1.8025 | Val  Acc: 0.6854
 Site-synthetic                 (0) | Val  Loss: 1.9443 | Val  Acc: 0.6100
 Site-dslr                      (0) | Val  Loss: 1.6692 | Val  Acc: 0.6875
 Site-dslr                      (0) | Val  Loss: 1.6363 | Val  Acc: 0.8125
 Site-webcam                    (3) | Val  Loss: 1.7446 | Val  Acc: 0.7321
Average Valid Accuracy: 0.7815
 Best site-amazon                   (2)  | Epoch:7 | Val Acc: 0.9524
 Best site-amazon                   (2)  | Epoch:7 | Val Acc: 0.8750
 Best site-amazon                   (1)  | Epoch:7 | Val Acc: 0.8211
 Best site-amazon                   (1)  | Epoch:7 | Val Acc: 0.8811
 Best site-amazon                   (1)  | Epoch:7 | Val Acc: 0.8645
 Best site-synthetic                (0)  | Epoch:7 | Val Acc: 0.6750
 Best site-synthetic                (0)  | Epoch:7 | Val Acc: 0.6854
 Best site-synthetic                (0)  | Epoch:7 | Val Acc: 0.6100
 Best site-dslr                     (0)  | Epoch:7 | Val Acc: 0.6875
 Best site-dslr                     (0)  | Epoch:7 | Val Acc: 0.8125
 Best site-webcam                   (3)  | Epoch:7 | Val Acc: 0.7321
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-amazon                    (2) | Train Loss: 1.2783 | Train Acc: 0.8125
 Site-amazon                    (2) | Train Loss: 1.2766 | Train Acc: 0.8333
 Site-amazon                    (3) | Train Loss: 1.3898 | Train Acc: 0.8462
 Site-amazon                    (1) | Train Loss: 1.1175 | Train Acc: 0.9023
 Site-amazon                    (1) | Train Loss: 1.1407 | Train Acc: 0.9097
 Site-synthetic                 (0) | Train Loss: 1.6884 | Train Acc: 0.6667
 Site-synthetic                 (0) | Train Loss: 1.5931 | Train Acc: 0.6343
 Site-synthetic                 (0) | Train Loss: 1.6946 | Train Acc: 0.6567
 Site-dslr                      (0) | Train Loss: 1.5809 | Train Acc: 0.7917
 Site-dslr                      (0) | Train Loss: 1.3854 | Train Acc: 0.8167
 Site-webcam                    (2) | Train Loss: 1.5421 | Train Acc: 0.8235
Average Train Accuracy: 0.7903
 Site-amazon                    (2) | Val  Loss: 1.1938 | Val  Acc: 0.9048
 Site-amazon                    (2) | Val  Loss: 1.2224 | Val  Acc: 0.8906
 Site-amazon                    (3) | Val  Loss: 1.2971 | Val  Acc: 0.8421
 Site-amazon                    (1) | Val  Loss: 1.2328 | Val  Acc: 0.8881
 Site-amazon                    (1) | Val  Loss: 1.1847 | Val  Acc: 0.8692
 Site-synthetic                 (0) | Val  Loss: 1.7652 | Val  Acc: 0.7000
 Site-synthetic                 (0) | Val  Loss: 1.7418 | Val  Acc: 0.6629
 Site-synthetic                 (0) | Val  Loss: 1.7243 | Val  Acc: 0.6550
 Site-dslr                      (0) | Val  Loss: 1.4194 | Val  Acc: 0.8750
 Site-dslr                      (0) | Val  Loss: 1.4708 | Val  Acc: 0.7500
 Site-webcam                    (2) | Val  Loss: 1.6585 | Val  Acc: 0.7679
Average Valid Accuracy: 0.8005
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.9048
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.8906
 Best site-amazon                   (3)  | Epoch:8 | Val Acc: 0.8421
 Best site-amazon                   (1)  | Epoch:8 | Val Acc: 0.8881
 Best site-amazon                   (1)  | Epoch:8 | Val Acc: 0.8692
 Best site-synthetic                (0)  | Epoch:8 | Val Acc: 0.7000
 Best site-synthetic                (0)  | Epoch:8 | Val Acc: 0.6629
 Best site-synthetic                (0)  | Epoch:8 | Val Acc: 0.6550
 Best site-dslr                     (0)  | Epoch:8 | Val Acc: 0.8750
 Best site-dslr                     (0)  | Epoch:8 | Val Acc: 0.7500
 Best site-webcam                   (2)  | Epoch:8 | Val Acc: 0.7679
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[4, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-amazon                    (1) | Train Loss: 1.1373 | Train Acc: 0.8906
 Site-amazon                    (1) | Train Loss: 1.0834 | Train Acc: 0.8854
 Site-amazon                    (2) | Train Loss: 1.1731 | Train Acc: 0.8811
 Site-amazon                    (1) | Train Loss: 1.0334 | Train Acc: 0.9023
 Site-amazon                    (2) | Train Loss: 1.0200 | Train Acc: 0.9283
 Site-synthetic                 (0) | Train Loss: 1.5598 | Train Acc: 0.7000
 Site-synthetic                 (0) | Train Loss: 1.4542 | Train Acc: 0.6493
 Site-synthetic                 (0) | Train Loss: 1.5585 | Train Acc: 0.6833
 Site-dslr                      (3) | Train Loss: 1.3620 | Train Acc: 0.7500
 Site-dslr                      (0) | Train Loss: 1.2236 | Train Acc: 0.8750
 Site-webcam                    (1) | Train Loss: 1.3544 | Train Acc: 0.8471
Average Train Accuracy: 0.8175
 Site-amazon                    (1) | Val  Loss: 1.0615 | Val  Acc: 0.8571
 Site-amazon                    (1) | Val  Loss: 1.0516 | Val  Acc: 0.9062
 Site-amazon                    (2) | Val  Loss: 1.1525 | Val  Acc: 0.8737
 Site-amazon                    (1) | Val  Loss: 1.0873 | Val  Acc: 0.8671
 Site-amazon                    (2) | Val  Loss: 1.0181 | Val  Acc: 0.8738
 Site-synthetic                 (0) | Val  Loss: 1.5068 | Val  Acc: 0.7000
 Site-synthetic                 (0) | Val  Loss: 1.5697 | Val  Acc: 0.6966
 Site-synthetic                 (0) | Val  Loss: 1.6262 | Val  Acc: 0.6650
 Site-dslr                      (3) | Val  Loss: 1.2859 | Val  Acc: 0.8125
 Site-dslr                      (0) | Val  Loss: 1.3419 | Val  Acc: 0.8125
 Site-webcam                    (1) | Val  Loss: 1.4257 | Val  Acc: 0.8036
Average Valid Accuracy: 0.8062
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.8571
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.9062
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 0.8737
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.8671
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 0.8738
 Best site-synthetic                (0)  | Epoch:9 | Val Acc: 0.7000
 Best site-synthetic                (0)  | Epoch:9 | Val Acc: 0.6966
 Best site-synthetic                (0)  | Epoch:9 | Val Acc: 0.6650
 Best site-dslr                     (3)  | Epoch:9 | Val Acc: 0.8125
 Best site-dslr                     (0)  | Epoch:9 | Val Acc: 0.8125
 Best site-webcam                   (1)  | Epoch:9 | Val Acc: 0.8036
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-amazon                    (1) | Train Loss: 1.0107 | Train Acc: 0.9062
 Site-amazon                    (1) | Train Loss: 0.9975 | Train Acc: 0.8854
 Site-amazon                    (3) | Train Loss: 1.1353 | Train Acc: 0.8601
 Site-amazon                    (1) | Train Loss: 0.9832 | Train Acc: 0.9023
 Site-amazon                    (3) | Train Loss: 0.8765 | Train Acc: 0.9159
 Site-synthetic                 (0) | Train Loss: 1.5242 | Train Acc: 0.7167
 Site-synthetic                 (0) | Train Loss: 1.3006 | Train Acc: 0.6791
 Site-synthetic                 (0) | Train Loss: 1.4901 | Train Acc: 0.6700
 Site-dslr                      (2) | Train Loss: 1.3086 | Train Acc: 0.7083
 Site-dslr                      (2) | Train Loss: 1.1126 | Train Acc: 0.8917
 Site-webcam                    (0) | Train Loss: 1.2278 | Train Acc: 0.8235
Average Train Accuracy: 0.8145
 Site-amazon                    (1) | Val  Loss: 0.8531 | Val  Acc: 0.9286
 Site-amazon                    (1) | Val  Loss: 0.9586 | Val  Acc: 0.9062
 Site-amazon                    (3) | Val  Loss: 1.0263 | Val  Acc: 0.9158
 Site-amazon                    (1) | Val  Loss: 1.0109 | Val  Acc: 0.8741
 Site-amazon                    (3) | Val  Loss: 0.9378 | Val  Acc: 0.8832
 Site-synthetic                 (0) | Val  Loss: 1.4521 | Val  Acc: 0.7250
 Site-synthetic                 (0) | Val  Loss: 1.5321 | Val  Acc: 0.6629
 Site-synthetic                 (0) | Val  Loss: 1.4600 | Val  Acc: 0.7000
 Site-dslr                      (2) | Val  Loss: 1.2391 | Val  Acc: 0.8125
 Site-dslr                      (2) | Val  Loss: 1.1777 | Val  Acc: 0.8500
 Site-webcam                    (0) | Val  Loss: 1.2784 | Val  Acc: 0.8214
Average Valid Accuracy: 0.8254
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9286
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9062
 Best site-amazon                   (3)  | Epoch:10 | Val Acc: 0.9158
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.8741
 Best site-amazon                   (3)  | Epoch:10 | Val Acc: 0.8832
 Best site-synthetic                (0)  | Epoch:10 | Val Acc: 0.7250
 Best site-synthetic                (0)  | Epoch:10 | Val Acc: 0.6629
 Best site-synthetic                (0)  | Epoch:10 | Val Acc: 0.7000
 Best site-dslr                     (2)  | Epoch:10 | Val Acc: 0.8125
 Best site-dslr                     (2)  | Epoch:10 | Val Acc: 0.8500
 Best site-webcam                   (0)  | Epoch:10 | Val Acc: 0.8214
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-amazon                    (2) | Train Loss: 0.8880 | Train Acc: 0.9062
 Site-amazon                    (1) | Train Loss: 0.9082 | Train Acc: 0.8958
 Site-amazon                    (1) | Train Loss: 0.9469 | Train Acc: 0.8601
 Site-amazon                    (1) | Train Loss: 0.8793 | Train Acc: 0.8977
 Site-amazon                    (1) | Train Loss: 0.7317 | Train Acc: 0.9252
 Site-synthetic                 (3) | Train Loss: 1.4476 | Train Acc: 0.7167
 Site-synthetic                 (3) | Train Loss: 1.4673 | Train Acc: 0.6194
 Site-synthetic                 (3) | Train Loss: 1.3678 | Train Acc: 0.7300
 Site-dslr                      (0) | Train Loss: 1.2378 | Train Acc: 0.7500
 Site-dslr                      (0) | Train Loss: 1.0214 | Train Acc: 0.9000
 Site-webcam                    (2) | Train Loss: 1.1235 | Train Acc: 0.8235
Average Train Accuracy: 0.8204
 Site-amazon                    (2) | Val  Loss: 0.7567 | Val  Acc: 0.9762
 Site-amazon                    (1) | Val  Loss: 0.8609 | Val  Acc: 0.9219
 Site-amazon                    (1) | Val  Loss: 0.9664 | Val  Acc: 0.8737
 Site-amazon                    (1) | Val  Loss: 0.9226 | Val  Acc: 0.8811
 Site-amazon                    (1) | Val  Loss: 0.8295 | Val  Acc: 0.8972
 Site-synthetic                 (3) | Val  Loss: 1.3417 | Val  Acc: 0.7250
 Site-synthetic                 (3) | Val  Loss: 1.3009 | Val  Acc: 0.6966
 Site-synthetic                 (3) | Val  Loss: 1.3466 | Val  Acc: 0.7250
 Site-dslr                      (0) | Val  Loss: 1.0169 | Val  Acc: 0.9375
 Site-dslr                      (0) | Val  Loss: 1.1206 | Val  Acc: 0.8125
 Site-webcam                    (2) | Val  Loss: 1.2343 | Val  Acc: 0.8214
Average Valid Accuracy: 0.8426
 Best site-amazon                   (2)  | Epoch:11 | Val Acc: 0.9762
 Best site-amazon                   (1)  | Epoch:11 | Val Acc: 0.9219
 Best site-amazon                   (1)  | Epoch:11 | Val Acc: 0.8737
 Best site-amazon                   (1)  | Epoch:11 | Val Acc: 0.8811
 Best site-amazon                   (1)  | Epoch:11 | Val Acc: 0.8972
 Best site-synthetic                (3)  | Epoch:11 | Val Acc: 0.7250
 Best site-synthetic                (3)  | Epoch:11 | Val Acc: 0.6966
 Best site-synthetic                (3)  | Epoch:11 | Val Acc: 0.7250
 Best site-dslr                     (0)  | Epoch:11 | Val Acc: 0.9375
 Best site-dslr                     (0)  | Epoch:11 | Val Acc: 0.8125
 Best site-webcam                   (2)  | Epoch:11 | Val Acc: 0.8214
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 12 ============
cnt=[5, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-amazon                    (0) | Train Loss: 0.9171 | Train Acc: 0.8750
 Site-amazon                    (0) | Train Loss: 0.9013 | Train Acc: 0.8854
 Site-amazon                    (0) | Train Loss: 0.9297 | Train Acc: 0.8462
 Site-amazon                    (0) | Train Loss: 0.7958 | Train Acc: 0.9209
 Site-amazon                    (0) | Train Loss: 0.7040 | Train Acc: 0.9283
 Site-synthetic                 (3) | Train Loss: 1.3875 | Train Acc: 0.7167
 Site-synthetic                 (3) | Train Loss: 1.4957 | Train Acc: 0.6866
 Site-synthetic                 (3) | Train Loss: 1.2548 | Train Acc: 0.7533
 Site-dslr                      (1) | Train Loss: 1.1428 | Train Acc: 0.7917
 Site-dslr                      (2) | Train Loss: 1.0117 | Train Acc: 0.8583
 Site-webcam                    (1) | Train Loss: 1.0764 | Train Acc: 0.8353
Average Train Accuracy: 0.8271
 Site-amazon                    (0) | Val  Loss: 0.7357 | Val  Acc: 0.9286
 Site-amazon                    (0) | Val  Loss: 0.8388 | Val  Acc: 0.9219
 Site-amazon                    (0) | Val  Loss: 0.9265 | Val  Acc: 0.8421
 Site-amazon                    (0) | Val  Loss: 0.8924 | Val  Acc: 0.8741
 Site-amazon                    (0) | Val  Loss: 0.7560 | Val  Acc: 0.9206
 Site-synthetic                 (3) | Val  Loss: 1.2515 | Val  Acc: 0.7250
 Site-synthetic                 (3) | Val  Loss: 1.2441 | Val  Acc: 0.7640
 Site-synthetic                 (3) | Val  Loss: 1.2848 | Val  Acc: 0.7300
 Site-dslr                      (1) | Val  Loss: 0.9916 | Val  Acc: 0.8750
 Site-dslr                      (2) | Val  Loss: 1.1735 | Val  Acc: 0.8500
 Site-webcam                    (1) | Val  Loss: 1.1697 | Val  Acc: 0.8036
Average Valid Accuracy: 0.8395
============ Train epoch 13 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-amazon                    (2) | Train Loss: 0.8487 | Train Acc: 0.8750
 Site-amazon                    (2) | Train Loss: 0.7538 | Train Acc: 0.8854
 Site-amazon                    (3) | Train Loss: 0.8303 | Train Acc: 0.8601
 Site-amazon                    (0) | Train Loss: 0.7218 | Train Acc: 0.9023
 Site-amazon                    (0) | Train Loss: 0.6813 | Train Acc: 0.9377
 Site-synthetic                 (1) | Train Loss: 1.2820 | Train Acc: 0.7167
 Site-synthetic                 (1) | Train Loss: 1.2800 | Train Acc: 0.7090
 Site-synthetic                 (1) | Train Loss: 1.2038 | Train Acc: 0.7467
 Site-dslr                      (1) | Train Loss: 1.0202 | Train Acc: 0.8750
 Site-dslr                      (1) | Train Loss: 0.8744 | Train Acc: 0.9083
 Site-webcam                    (2) | Train Loss: 1.0574 | Train Acc: 0.8353
Average Train Accuracy: 0.8410
 Site-amazon                    (2) | Val  Loss: 0.6417 | Val  Acc: 0.9762
 Site-amazon                    (2) | Val  Loss: 0.8030 | Val  Acc: 0.9219
 Site-amazon                    (3) | Val  Loss: 0.8626 | Val  Acc: 0.8737
 Site-amazon                    (0) | Val  Loss: 0.8027 | Val  Acc: 0.8671
 Site-amazon                    (0) | Val  Loss: 0.7072 | Val  Acc: 0.9019
 Site-synthetic                 (1) | Val  Loss: 1.1592 | Val  Acc: 0.7250
 Site-synthetic                 (1) | Val  Loss: 1.2285 | Val  Acc: 0.7303
 Site-synthetic                 (1) | Val  Loss: 1.2224 | Val  Acc: 0.7350
 Site-dslr                      (1) | Val  Loss: 0.9461 | Val  Acc: 0.8125
 Site-dslr                      (1) | Val  Loss: 1.0294 | Val  Acc: 0.8250
 Site-webcam                    (2) | Val  Loss: 1.1163 | Val  Acc: 0.8393
Average Valid Accuracy: 0.8371
============ Train epoch 14 ============
cnt=[4, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-amazon                    (1) | Train Loss: 0.7663 | Train Acc: 0.8750
 Site-amazon                    (1) | Train Loss: 0.7154 | Train Acc: 0.8854
 Site-amazon                    (2) | Train Loss: 0.7307 | Train Acc: 0.9091
 Site-amazon                    (1) | Train Loss: 0.7077 | Train Acc: 0.8884
 Site-amazon                    (2) | Train Loss: 0.6135 | Train Acc: 0.9346
 Site-synthetic                 (0) | Train Loss: 1.2992 | Train Acc: 0.6667
 Site-synthetic                 (0) | Train Loss: 1.2253 | Train Acc: 0.6940
 Site-synthetic                 (0) | Train Loss: 1.1479 | Train Acc: 0.7700
 Site-dslr                      (3) | Train Loss: 0.9326 | Train Acc: 0.9167
 Site-dslr                      (0) | Train Loss: 0.8723 | Train Acc: 0.8667
 Site-webcam                    (3) | Train Loss: 0.9452 | Train Acc: 0.8824
Average Train Accuracy: 0.8444
 Site-amazon                    (1) | Val  Loss: 0.6294 | Val  Acc: 0.9286
 Site-amazon                    (1) | Val  Loss: 0.7286 | Val  Acc: 0.9062
 Site-amazon                    (2) | Val  Loss: 0.8292 | Val  Acc: 0.8842
 Site-amazon                    (1) | Val  Loss: 0.7221 | Val  Acc: 0.9091
 Site-amazon                    (2) | Val  Loss: 0.6788 | Val  Acc: 0.8832
 Site-synthetic                 (0) | Val  Loss: 1.1921 | Val  Acc: 0.7500
 Site-synthetic                 (0) | Val  Loss: 1.1241 | Val  Acc: 0.7640
 Site-synthetic                 (0) | Val  Loss: 1.1295 | Val  Acc: 0.7800
 Site-dslr                      (3) | Val  Loss: 0.7823 | Val  Acc: 0.8750
 Site-dslr                      (0) | Val  Loss: 0.9207 | Val  Acc: 0.8500
 Site-webcam                    (3) | Val  Loss: 1.0615 | Val  Acc: 0.8036
Average Valid Accuracy: 0.8485
 Best site-amazon                   (1)  | Epoch:14 | Val Acc: 0.9286
 Best site-amazon                   (1)  | Epoch:14 | Val Acc: 0.9062
 Best site-amazon                   (2)  | Epoch:14 | Val Acc: 0.8842
 Best site-amazon                   (1)  | Epoch:14 | Val Acc: 0.9091
 Best site-amazon                   (2)  | Epoch:14 | Val Acc: 0.8832
 Best site-synthetic                (0)  | Epoch:14 | Val Acc: 0.7500
 Best site-synthetic                (0)  | Epoch:14 | Val Acc: 0.7640
 Best site-synthetic                (0)  | Epoch:14 | Val Acc: 0.7800
 Best site-dslr                     (3)  | Epoch:14 | Val Acc: 0.8750
 Best site-dslr                     (0)  | Epoch:14 | Val Acc: 0.8500
 Best site-webcam                   (3)  | Epoch:14 | Val Acc: 0.8036
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 15 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-amazon                    (2) | Train Loss: 0.7586 | Train Acc: 0.9375
 Site-amazon                    (2) | Train Loss: 0.7037 | Train Acc: 0.9167
 Site-amazon                    (0) | Train Loss: 0.6767 | Train Acc: 0.8811
 Site-amazon                    (0) | Train Loss: 0.6749 | Train Acc: 0.8884
 Site-amazon                    (0) | Train Loss: 0.6420 | Train Acc: 0.9439
 Site-synthetic                 (1) | Train Loss: 1.1511 | Train Acc: 0.7667
 Site-synthetic                 (1) | Train Loss: 1.0683 | Train Acc: 0.7313
 Site-synthetic                 (1) | Train Loss: 1.0806 | Train Acc: 0.7833
 Site-dslr                      (1) | Train Loss: 0.8903 | Train Acc: 0.9167
 Site-dslr                      (1) | Train Loss: 0.7741 | Train Acc: 0.9083
 Site-webcam                    (3) | Train Loss: 0.8983 | Train Acc: 0.8588
Average Train Accuracy: 0.8666
 Site-amazon                    (2) | Val  Loss: 0.5681 | Val  Acc: 0.9762
 Site-amazon                    (2) | Val  Loss: 0.7055 | Val  Acc: 0.9062
 Site-amazon                    (0) | Val  Loss: 0.7673 | Val  Acc: 0.8842
 Site-amazon                    (0) | Val  Loss: 0.7094 | Val  Acc: 0.8881
 Site-amazon                    (0) | Val  Loss: 0.6491 | Val  Acc: 0.8879
 Site-synthetic                 (1) | Val  Loss: 1.0307 | Val  Acc: 0.7750
 Site-synthetic                 (1) | Val  Loss: 1.0545 | Val  Acc: 0.8202
 Site-synthetic                 (1) | Val  Loss: 1.0566 | Val  Acc: 0.7650
 Site-dslr                      (1) | Val  Loss: 0.7730 | Val  Acc: 0.8750
 Site-dslr                      (1) | Val  Loss: 0.9304 | Val  Acc: 0.8250
 Site-webcam                    (3) | Val  Loss: 0.9752 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8535
 Best site-amazon                   (2)  | Epoch:15 | Val Acc: 0.9762
 Best site-amazon                   (2)  | Epoch:15 | Val Acc: 0.9062
 Best site-amazon                   (0)  | Epoch:15 | Val Acc: 0.8842
 Best site-amazon                   (0)  | Epoch:15 | Val Acc: 0.8881
 Best site-amazon                   (0)  | Epoch:15 | Val Acc: 0.8879
 Best site-synthetic                (1)  | Epoch:15 | Val Acc: 0.7750
 Best site-synthetic                (1)  | Epoch:15 | Val Acc: 0.8202
 Best site-synthetic                (1)  | Epoch:15 | Val Acc: 0.7650
 Best site-dslr                     (1)  | Epoch:15 | Val Acc: 0.8750
 Best site-dslr                     (1)  | Epoch:15 | Val Acc: 0.8250
 Best site-webcam                   (3)  | Epoch:15 | Val Acc: 0.7857
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-amazon                    (0) | Train Loss: 0.6799 | Train Acc: 0.8750
 Site-amazon                    (2) | Train Loss: 0.6390 | Train Acc: 0.8854
 Site-amazon                    (3) | Train Loss: 0.6383 | Train Acc: 0.8811
 Site-amazon                    (0) | Train Loss: 0.6440 | Train Acc: 0.8930
 Site-amazon                    (0) | Train Loss: 0.5198 | Train Acc: 0.9533
 Site-synthetic                 (1) | Train Loss: 1.1503 | Train Acc: 0.7333
 Site-synthetic                 (1) | Train Loss: 1.1490 | Train Acc: 0.7463
 Site-synthetic                 (1) | Train Loss: 1.0179 | Train Acc: 0.7800
 Site-dslr                      (1) | Train Loss: 0.8843 | Train Acc: 0.8750
 Site-dslr                      (1) | Train Loss: 0.7492 | Train Acc: 0.8917
 Site-webcam                    (2) | Train Loss: 0.8237 | Train Acc: 0.9059
Average Train Accuracy: 0.8564
 Site-amazon                    (0) | Val  Loss: 0.4981 | Val  Acc: 0.9762
 Site-amazon                    (2) | Val  Loss: 0.6699 | Val  Acc: 0.9531
 Site-amazon                    (3) | Val  Loss: 0.7105 | Val  Acc: 0.9158
 Site-amazon                    (0) | Val  Loss: 0.6962 | Val  Acc: 0.8741
 Site-amazon                    (0) | Val  Loss: 0.5838 | Val  Acc: 0.9206
 Site-synthetic                 (1) | Val  Loss: 0.9860 | Val  Acc: 0.8750
 Site-synthetic                 (1) | Val  Loss: 0.9293 | Val  Acc: 0.7978
 Site-synthetic                 (1) | Val  Loss: 0.9958 | Val  Acc: 0.8000
 Site-dslr                      (1) | Val  Loss: 0.7429 | Val  Acc: 0.9375
 Site-dslr                      (1) | Val  Loss: 0.8765 | Val  Acc: 0.8500
 Site-webcam                    (2) | Val  Loss: 0.9991 | Val  Acc: 0.8214
Average Valid Accuracy: 0.8838
 Best site-amazon                   (0)  | Epoch:16 | Val Acc: 0.9762
 Best site-amazon                   (2)  | Epoch:16 | Val Acc: 0.9531
 Best site-amazon                   (3)  | Epoch:16 | Val Acc: 0.9158
 Best site-amazon                   (0)  | Epoch:16 | Val Acc: 0.8741
 Best site-amazon                   (0)  | Epoch:16 | Val Acc: 0.9206
 Best site-synthetic                (1)  | Epoch:16 | Val Acc: 0.8750
 Best site-synthetic                (1)  | Epoch:16 | Val Acc: 0.7978
 Best site-synthetic                (1)  | Epoch:16 | Val Acc: 0.8000
 Best site-dslr                     (1)  | Epoch:16 | Val Acc: 0.9375
 Best site-dslr                     (1)  | Epoch:16 | Val Acc: 0.8500
 Best site-webcam                   (2)  | Epoch:16 | Val Acc: 0.8214
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 17 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-amazon                    (2) | Train Loss: 0.6466 | Train Acc: 0.8750
 Site-amazon                    (0) | Train Loss: 0.6351 | Train Acc: 0.9271
 Site-amazon                    (3) | Train Loss: 0.5959 | Train Acc: 0.8671
 Site-amazon                    (0) | Train Loss: 0.5846 | Train Acc: 0.9349
 Site-amazon                    (0) | Train Loss: 0.5033 | Train Acc: 0.9470
 Site-synthetic                 (1) | Train Loss: 1.1896 | Train Acc: 0.6833
 Site-synthetic                 (1) | Train Loss: 1.0935 | Train Acc: 0.7463
 Site-synthetic                 (1) | Train Loss: 0.9963 | Train Acc: 0.7733
 Site-dslr                      (1) | Train Loss: 0.9574 | Train Acc: 0.8750
 Site-dslr                      (1) | Train Loss: 0.7616 | Train Acc: 0.8583
 Site-webcam                    (2) | Train Loss: 0.6936 | Train Acc: 0.8941
Average Train Accuracy: 0.8529
 Site-amazon                    (2) | Val  Loss: 0.5551 | Val  Acc: 0.9524
 Site-amazon                    (0) | Val  Loss: 0.5803 | Val  Acc: 0.9531
 Site-amazon                    (3) | Val  Loss: 0.6692 | Val  Acc: 0.8842
 Site-amazon                    (0) | Val  Loss: 0.6009 | Val  Acc: 0.9091
 Site-amazon                    (0) | Val  Loss: 0.5555 | Val  Acc: 0.9346
 Site-synthetic                 (1) | Val  Loss: 0.9473 | Val  Acc: 0.8000
 Site-synthetic                 (1) | Val  Loss: 0.9401 | Val  Acc: 0.8090
 Site-synthetic                 (1) | Val  Loss: 0.9786 | Val  Acc: 0.7800
 Site-dslr                      (1) | Val  Loss: 0.7798 | Val  Acc: 0.8750
 Site-dslr                      (1) | Val  Loss: 0.8210 | Val  Acc: 0.8625
 Site-webcam                    (2) | Val  Loss: 0.8996 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8743
============ Train epoch 18 ============
cnt=[3, 3, 3, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-amazon                    (0) | Train Loss: 0.6699 | Train Acc: 0.8906
 Site-amazon                    (0) | Train Loss: 0.5843 | Train Acc: 0.8854
 Site-amazon                    (2) | Train Loss: 0.6149 | Train Acc: 0.9021
 Site-amazon                    (2) | Train Loss: 0.5514 | Train Acc: 0.9070
 Site-amazon                    (2) | Train Loss: 0.7384 | Train Acc: 0.9502
 Site-synthetic                 (1) | Train Loss: 1.0613 | Train Acc: 0.7333
 Site-synthetic                 (1) | Train Loss: 0.7445 | Train Acc: 0.7910
 Site-synthetic                 (1) | Train Loss: 0.9609 | Train Acc: 0.7800
 Site-dslr                      (3) | Train Loss: 0.9394 | Train Acc: 0.8333
 Site-dslr                      (3) | Train Loss: 0.7181 | Train Acc: 0.8750
 Site-webcam                    (0) | Train Loss: 0.7840 | Train Acc: 0.8353
Average Train Accuracy: 0.8530
 Site-amazon                    (0) | Val  Loss: 0.5011 | Val  Acc: 0.9762
 Site-amazon                    (0) | Val  Loss: 0.5996 | Val  Acc: 0.9219
 Site-amazon                    (2) | Val  Loss: 0.6385 | Val  Acc: 0.8947
 Site-amazon                    (2) | Val  Loss: 0.6220 | Val  Acc: 0.9231
 Site-amazon                    (2) | Val  Loss: 0.5253 | Val  Acc: 0.9206
 Site-synthetic                 (1) | Val  Loss: 0.9429 | Val  Acc: 0.7500
 Site-synthetic                 (1) | Val  Loss: 0.8726 | Val  Acc: 0.8090
 Site-synthetic                 (1) | Val  Loss: 0.9218 | Val  Acc: 0.8200
 Site-dslr                      (3) | Val  Loss: 0.6298 | Val  Acc: 1.0000
 Site-dslr                      (3) | Val  Loss: 0.7317 | Val  Acc: 0.8750
 Site-webcam                    (0) | Val  Loss: 0.9059 | Val  Acc: 0.8214
Average Valid Accuracy: 0.8829
============ Train epoch 19 ============
cnt=[1, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-amazon                    (1) | Train Loss: 0.5916 | Train Acc: 0.9219
 Site-amazon                    (1) | Train Loss: 0.6275 | Train Acc: 0.9062
 Site-amazon                    (1) | Train Loss: 0.6529 | Train Acc: 0.8811
 Site-amazon                    (1) | Train Loss: 0.4811 | Train Acc: 0.9442
 Site-amazon                    (1) | Train Loss: 0.4171 | Train Acc: 0.9502
 Site-synthetic                 (2) | Train Loss: 1.0117 | Train Acc: 0.7500
 Site-synthetic                 (2) | Train Loss: 1.0701 | Train Acc: 0.7761
 Site-synthetic                 (2) | Train Loss: 0.9181 | Train Acc: 0.8100
 Site-dslr                      (3) | Train Loss: 0.8042 | Train Acc: 0.8750
 Site-dslr                      (2) | Train Loss: 0.6401 | Train Acc: 0.9333
 Site-webcam                    (0) | Train Loss: 0.7013 | Train Acc: 0.8941
Average Train Accuracy: 0.8766
 Site-amazon                    (1) | Val  Loss: 0.4063 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 0.5864 | Val  Acc: 0.9219
 Site-amazon                    (1) | Val  Loss: 0.5964 | Val  Acc: 0.9158
 Site-amazon                    (1) | Val  Loss: 0.6020 | Val  Acc: 0.9301
 Site-amazon                    (1) | Val  Loss: 0.5160 | Val  Acc: 0.9159
 Site-synthetic                 (2) | Val  Loss: 0.8495 | Val  Acc: 0.8250
 Site-synthetic                 (2) | Val  Loss: 0.8477 | Val  Acc: 0.8427
 Site-synthetic                 (2) | Val  Loss: 0.8671 | Val  Acc: 0.8400
 Site-dslr                      (3) | Val  Loss: 0.7074 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.7765 | Val  Acc: 0.8625
 Site-webcam                    (0) | Val  Loss: 0.7421 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8953
 Best site-amazon                   (1)  | Epoch:19 | Val Acc: 1.0000
 Best site-amazon                   (1)  | Epoch:19 | Val Acc: 0.9219
 Best site-amazon                   (1)  | Epoch:19 | Val Acc: 0.9158
 Best site-amazon                   (1)  | Epoch:19 | Val Acc: 0.9301
 Best site-amazon                   (1)  | Epoch:19 | Val Acc: 0.9159
 Best site-synthetic                (2)  | Epoch:19 | Val Acc: 0.8250
 Best site-synthetic                (2)  | Epoch:19 | Val Acc: 0.8427
 Best site-synthetic                (2)  | Epoch:19 | Val Acc: 0.8400
 Best site-dslr                     (3)  | Epoch:19 | Val Acc: 0.9375
 Best site-dslr                     (2)  | Epoch:19 | Val Acc: 0.8625
 Best site-webcam                   (0)  | Epoch:19 | Val Acc: 0.8571
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-amazon                    (1) | Train Loss: 0.5856 | Train Acc: 0.9219
 Site-amazon                    (1) | Train Loss: 0.5354 | Train Acc: 0.9062
 Site-amazon                    (1) | Train Loss: 0.5241 | Train Acc: 0.9231
 Site-amazon                    (1) | Train Loss: 0.5298 | Train Acc: 0.9209
 Site-amazon                    (1) | Train Loss: 0.4182 | Train Acc: 0.9502
 Site-synthetic                 (0) | Train Loss: 1.0056 | Train Acc: 0.7500
 Site-synthetic                 (0) | Train Loss: 0.8932 | Train Acc: 0.8134
 Site-synthetic                 (0) | Train Loss: 0.8883 | Train Acc: 0.8133
 Site-dslr                      (3) | Train Loss: 0.7731 | Train Acc: 0.8333
 Site-dslr                      (0) | Train Loss: 0.6326 | Train Acc: 0.9000
 Site-webcam                    (2) | Train Loss: 0.7164 | Train Acc: 0.8824
Average Train Accuracy: 0.8741
 Site-amazon                    (1) | Val  Loss: 0.4823 | Val  Acc: 0.9762
 Site-amazon                    (1) | Val  Loss: 0.5825 | Val  Acc: 0.8906
 Site-amazon                    (1) | Val  Loss: 0.6296 | Val  Acc: 0.8737
 Site-amazon                    (1) | Val  Loss: 0.5684 | Val  Acc: 0.9161
 Site-amazon                    (1) | Val  Loss: 0.4930 | Val  Acc: 0.9299
 Site-synthetic                 (0) | Val  Loss: 0.8992 | Val  Acc: 0.8500
 Site-synthetic                 (0) | Val  Loss: 0.8645 | Val  Acc: 0.8539
 Site-synthetic                 (0) | Val  Loss: 0.8589 | Val  Acc: 0.8300
 Site-dslr                      (3) | Val  Loss: 0.6777 | Val  Acc: 0.8750
 Site-dslr                      (0) | Val  Loss: 0.7058 | Val  Acc: 0.8875
 Site-webcam                    (2) | Val  Loss: 0.8341 | Val  Acc: 0.8214
Average Valid Accuracy: 0.8822
============ Train epoch 21 ============
cnt=[4, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-amazon                    (3) | Train Loss: 0.5633 | Train Acc: 0.8750
 Site-amazon                    (3) | Train Loss: 0.5907 | Train Acc: 0.8750
 Site-amazon                    (1) | Train Loss: 0.5563 | Train Acc: 0.8671
 Site-amazon                    (1) | Train Loss: 0.5065 | Train Acc: 0.9256
 Site-amazon                    (1) | Train Loss: 0.4236 | Train Acc: 0.9470
 Site-synthetic                 (0) | Train Loss: 0.9542 | Train Acc: 0.7833
 Site-synthetic                 (0) | Train Loss: 0.9147 | Train Acc: 0.7985
 Site-synthetic                 (0) | Train Loss: 0.8119 | Train Acc: 0.8433
 Site-dslr                      (2) | Train Loss: 0.7572 | Train Acc: 0.8333
 Site-dslr                      (0) | Train Loss: 0.6610 | Train Acc: 0.9000
 Site-webcam                    (3) | Train Loss: 0.7599 | Train Acc: 0.8941
Average Train Accuracy: 0.8675
 Site-amazon                    (3) | Val  Loss: 0.4769 | Val  Acc: 0.9286
 Site-amazon                    (3) | Val  Loss: 0.5140 | Val  Acc: 0.9375
 Site-amazon                    (1) | Val  Loss: 0.5593 | Val  Acc: 0.9158
 Site-amazon                    (1) | Val  Loss: 0.5842 | Val  Acc: 0.9301
 Site-amazon                    (1) | Val  Loss: 0.4892 | Val  Acc: 0.9299
 Site-synthetic                 (0) | Val  Loss: 0.7743 | Val  Acc: 0.8250
 Site-synthetic                 (0) | Val  Loss: 0.7646 | Val  Acc: 0.8764
 Site-synthetic                 (0) | Val  Loss: 0.7706 | Val  Acc: 0.8450
 Site-dslr                      (2) | Val  Loss: 0.6330 | Val  Acc: 0.9375
 Site-dslr                      (0) | Val  Loss: 0.7057 | Val  Acc: 0.8875
 Site-webcam                    (3) | Val  Loss: 0.7654 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8973
 Best site-amazon                   (3)  | Epoch:21 | Val Acc: 0.9286
 Best site-amazon                   (3)  | Epoch:21 | Val Acc: 0.9375
 Best site-amazon                   (1)  | Epoch:21 | Val Acc: 0.9158
 Best site-amazon                   (1)  | Epoch:21 | Val Acc: 0.9301
 Best site-amazon                   (1)  | Epoch:21 | Val Acc: 0.9299
 Best site-synthetic                (0)  | Epoch:21 | Val Acc: 0.8250
 Best site-synthetic                (0)  | Epoch:21 | Val Acc: 0.8764
 Best site-synthetic                (0)  | Epoch:21 | Val Acc: 0.8450
 Best site-dslr                     (2)  | Epoch:21 | Val Acc: 0.9375
 Best site-dslr                     (0)  | Epoch:21 | Val Acc: 0.8875
 Best site-webcam                   (3)  | Epoch:21 | Val Acc: 0.8571
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 4, 4, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-amazon                    (0) | Train Loss: 0.5668 | Train Acc: 0.9219
 Site-amazon                    (2) | Train Loss: 0.5650 | Train Acc: 0.8750
 Site-amazon                    (2) | Train Loss: 0.5256 | Train Acc: 0.9231
 Site-amazon                    (2) | Train Loss: 0.4699 | Train Acc: 0.9349
 Site-amazon                    (2) | Train Loss: 0.3927 | Train Acc: 0.9533
 Site-synthetic                 (1) | Train Loss: 0.9857 | Train Acc: 0.7500
 Site-synthetic                 (1) | Train Loss: 0.8120 | Train Acc: 0.8060
 Site-synthetic                 (1) | Train Loss: 0.7775 | Train Acc: 0.8500
 Site-dslr                      (3) | Train Loss: 0.7216 | Train Acc: 0.9167
 Site-dslr                      (1) | Train Loss: 0.5859 | Train Acc: 0.9000
 Site-webcam                    (0) | Train Loss: 0.7069 | Train Acc: 0.8588
Average Train Accuracy: 0.8809
 Site-amazon                    (0) | Val  Loss: 0.3887 | Val  Acc: 1.0000
 Site-amazon                    (2) | Val  Loss: 0.5036 | Val  Acc: 0.9219
 Site-amazon                    (2) | Val  Loss: 0.5563 | Val  Acc: 0.9053
 Site-amazon                    (2) | Val  Loss: 0.5310 | Val  Acc: 0.9371
 Site-amazon                    (2) | Val  Loss: 0.4925 | Val  Acc: 0.9206
 Site-synthetic                 (1) | Val  Loss: 0.7186 | Val  Acc: 0.8500
 Site-synthetic                 (1) | Val  Loss: 0.6903 | Val  Acc: 0.8764
 Site-synthetic                 (1) | Val  Loss: 0.7560 | Val  Acc: 0.8600
 Site-dslr                      (3) | Val  Loss: 0.5922 | Val  Acc: 1.0000
 Site-dslr                      (1) | Val  Loss: 0.7226 | Val  Acc: 0.8875
 Site-webcam                    (0) | Val  Loss: 0.7083 | Val  Acc: 0.8393
Average Valid Accuracy: 0.9089
 Best site-amazon                   (0)  | Epoch:22 | Val Acc: 1.0000
 Best site-amazon                   (2)  | Epoch:22 | Val Acc: 0.9219
 Best site-amazon                   (2)  | Epoch:22 | Val Acc: 0.9053
 Best site-amazon                   (2)  | Epoch:22 | Val Acc: 0.9371
 Best site-amazon                   (2)  | Epoch:22 | Val Acc: 0.9206
 Best site-synthetic                (1)  | Epoch:22 | Val Acc: 0.8500
 Best site-synthetic                (1)  | Epoch:22 | Val Acc: 0.8764
 Best site-synthetic                (1)  | Epoch:22 | Val Acc: 0.8600
 Best site-dslr                     (3)  | Epoch:22 | Val Acc: 1.0000
 Best site-dslr                     (1)  | Epoch:22 | Val Acc: 0.8875
 Best site-webcam                   (0)  | Epoch:22 | Val Acc: 0.8393
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 23 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-amazon                    (0) | Train Loss: 0.5594 | Train Acc: 0.9375
 Site-amazon                    (0) | Train Loss: 0.4498 | Train Acc: 0.9062
 Site-amazon                    (0) | Train Loss: 0.5912 | Train Acc: 0.9091
 Site-amazon                    (0) | Train Loss: 0.5053 | Train Acc: 0.9256
 Site-amazon                    (0) | Train Loss: 0.3732 | Train Acc: 0.9408
 Site-synthetic                 (1) | Train Loss: 0.9367 | Train Acc: 0.7500
 Site-synthetic                 (1) | Train Loss: 1.0669 | Train Acc: 0.7910
 Site-synthetic                 (1) | Train Loss: 0.7525 | Train Acc: 0.8733
 Site-dslr                      (2) | Train Loss: 0.7199 | Train Acc: 0.9167
 Site-dslr                      (2) | Train Loss: 0.5557 | Train Acc: 0.9250
 Site-webcam                    (3) | Train Loss: 0.6091 | Train Acc: 0.8824
Average Train Accuracy: 0.8871
 Site-amazon                    (0) | Val  Loss: 0.4688 | Val  Acc: 0.9762
 Site-amazon                    (0) | Val  Loss: 0.5135 | Val  Acc: 0.9219
 Site-amazon                    (0) | Val  Loss: 0.6164 | Val  Acc: 0.8947
 Site-amazon                    (0) | Val  Loss: 0.4914 | Val  Acc: 0.9021
 Site-amazon                    (0) | Val  Loss: 0.4624 | Val  Acc: 0.9112
 Site-synthetic                 (1) | Val  Loss: 0.8045 | Val  Acc: 0.9000
 Site-synthetic                 (1) | Val  Loss: 0.7002 | Val  Acc: 0.8539
 Site-synthetic                 (1) | Val  Loss: 0.7749 | Val  Acc: 0.8250
 Site-dslr                      (2) | Val  Loss: 0.6094 | Val  Acc: 0.8750
 Site-dslr                      (2) | Val  Loss: 0.7121 | Val  Acc: 0.8375
 Site-webcam                    (3) | Val  Loss: 0.7816 | Val  Acc: 0.8214
Average Valid Accuracy: 0.8835
============ Train epoch 24 ============
cnt=[3, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-amazon                    (2) | Train Loss: 0.5256 | Train Acc: 0.9062
 Site-amazon                    (1) | Train Loss: 0.4707 | Train Acc: 0.9167
 Site-amazon                    (1) | Train Loss: 0.4443 | Train Acc: 0.9161
 Site-amazon                    (1) | Train Loss: 0.4557 | Train Acc: 0.9302
 Site-amazon                    (1) | Train Loss: 0.5735 | Train Acc: 0.9595
 Site-synthetic                 (0) | Train Loss: 0.9141 | Train Acc: 0.7667
 Site-synthetic                 (0) | Train Loss: 0.9614 | Train Acc: 0.8134
 Site-synthetic                 (0) | Train Loss: 0.7204 | Train Acc: 0.8433
 Site-dslr                      (3) | Train Loss: 0.5723 | Train Acc: 0.9583
 Site-dslr                      (3) | Train Loss: 0.5032 | Train Acc: 0.9500
 Site-webcam                    (2) | Train Loss: 0.6172 | Train Acc: 0.8941
Average Train Accuracy: 0.8959
 Site-amazon                    (2) | Val  Loss: 0.4025 | Val  Acc: 0.9762
 Site-amazon                    (1) | Val  Loss: 0.4916 | Val  Acc: 0.9375
 Site-amazon                    (1) | Val  Loss: 0.5453 | Val  Acc: 0.9053
 Site-amazon                    (1) | Val  Loss: 0.4872 | Val  Acc: 0.9231
 Site-amazon                    (1) | Val  Loss: 0.4343 | Val  Acc: 0.8972
 Site-synthetic                 (0) | Val  Loss: 0.7304 | Val  Acc: 0.8750
 Site-synthetic                 (0) | Val  Loss: 0.7003 | Val  Acc: 0.8764
 Site-synthetic                 (0) | Val  Loss: 0.7773 | Val  Acc: 0.8800
 Site-dslr                      (3) | Val  Loss: 0.4947 | Val  Acc: 1.0000
 Site-dslr                      (3) | Val  Loss: 0.6351 | Val  Acc: 0.9000
 Site-webcam                    (2) | Val  Loss: 0.7420 | Val  Acc: 0.8393
Average Valid Accuracy: 0.9100
 Best site-amazon                   (2)  | Epoch:24 | Val Acc: 0.9762
 Best site-amazon                   (1)  | Epoch:24 | Val Acc: 0.9375
 Best site-amazon                   (1)  | Epoch:24 | Val Acc: 0.9053
 Best site-amazon                   (1)  | Epoch:24 | Val Acc: 0.9231
 Best site-amazon                   (1)  | Epoch:24 | Val Acc: 0.8972
 Best site-synthetic                (0)  | Epoch:24 | Val Acc: 0.8750
 Best site-synthetic                (0)  | Epoch:24 | Val Acc: 0.8764
 Best site-synthetic                (0)  | Epoch:24 | Val Acc: 0.8800
 Best site-dslr                     (3)  | Epoch:24 | Val Acc: 1.0000
 Best site-dslr                     (3)  | Epoch:24 | Val Acc: 0.9000
 Best site-webcam                   (2)  | Epoch:24 | Val Acc: 0.8393
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-amazon                    (3) | Train Loss: 0.4889 | Train Acc: 0.8906
 Site-amazon                    (1) | Train Loss: 0.4966 | Train Acc: 0.8854
 Site-amazon                    (1) | Train Loss: 0.5689 | Train Acc: 0.8741
 Site-amazon                    (1) | Train Loss: 0.3995 | Train Acc: 0.9628
 Site-amazon                    (1) | Train Loss: 0.3182 | Train Acc: 0.9564
 Site-synthetic                 (2) | Train Loss: 0.9674 | Train Acc: 0.7667
 Site-synthetic                 (2) | Train Loss: 0.8226 | Train Acc: 0.7910
 Site-synthetic                 (2) | Train Loss: 0.7275 | Train Acc: 0.8267
 Site-dslr                      (0) | Train Loss: 0.6272 | Train Acc: 0.9583
 Site-dslr                      (0) | Train Loss: 0.5445 | Train Acc: 0.9250
 Site-webcam                    (3) | Train Loss: 0.6811 | Train Acc: 0.8353
Average Train Accuracy: 0.8793
 Site-amazon                    (3) | Val  Loss: 0.3803 | Val  Acc: 0.9762
 Site-amazon                    (1) | Val  Loss: 0.4095 | Val  Acc: 0.9531
 Site-amazon                    (1) | Val  Loss: 0.5181 | Val  Acc: 0.8947
 Site-amazon                    (1) | Val  Loss: 0.4413 | Val  Acc: 0.9231
 Site-amazon                    (1) | Val  Loss: 0.4250 | Val  Acc: 0.9393
 Site-synthetic                 (2) | Val  Loss: 0.6743 | Val  Acc: 0.8500
 Site-synthetic                 (2) | Val  Loss: 0.6670 | Val  Acc: 0.8539
 Site-synthetic                 (2) | Val  Loss: 0.7146 | Val  Acc: 0.8550
 Site-dslr                      (0) | Val  Loss: 0.4345 | Val  Acc: 1.0000
 Site-dslr                      (0) | Val  Loss: 0.7290 | Val  Acc: 0.8500
 Site-webcam                    (3) | Val  Loss: 0.6988 | Val  Acc: 0.8214
Average Valid Accuracy: 0.9015
============ Train epoch 26 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-amazon                    (1) | Train Loss: 0.5371 | Train Acc: 0.8906
 Site-amazon                    (1) | Train Loss: 0.4515 | Train Acc: 0.9062
 Site-amazon                    (1) | Train Loss: 0.4926 | Train Acc: 0.9091
 Site-amazon                    (1) | Train Loss: 0.4395 | Train Acc: 0.9442
 Site-amazon                    (1) | Train Loss: 0.3422 | Train Acc: 0.9595
 Site-synthetic                 (0) | Train Loss: 0.9615 | Train Acc: 0.7333
 Site-synthetic                 (0) | Train Loss: 0.6093 | Train Acc: 0.7836
 Site-synthetic                 (0) | Train Loss: 0.6844 | Train Acc: 0.8567
 Site-dslr                      (2) | Train Loss: 0.6824 | Train Acc: 0.8750
 Site-dslr                      (2) | Train Loss: 0.5047 | Train Acc: 0.9167
 Site-webcam                    (3) | Train Loss: 0.6032 | Train Acc: 0.9294
Average Train Accuracy: 0.8822
 Site-amazon                    (1) | Val  Loss: 0.3095 | Val  Acc: 0.9762
 Site-amazon                    (1) | Val  Loss: 0.4504 | Val  Acc: 0.9375
 Site-amazon                    (1) | Val  Loss: 0.5490 | Val  Acc: 0.8842
 Site-amazon                    (1) | Val  Loss: 0.4615 | Val  Acc: 0.9301
 Site-amazon                    (1) | Val  Loss: 0.4164 | Val  Acc: 0.9252
 Site-synthetic                 (0) | Val  Loss: 0.7541 | Val  Acc: 0.8250
 Site-synthetic                 (0) | Val  Loss: 0.6388 | Val  Acc: 0.8539
 Site-synthetic                 (0) | Val  Loss: 0.7142 | Val  Acc: 0.8700
 Site-dslr                      (2) | Val  Loss: 0.4882 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.6943 | Val  Acc: 0.8375
 Site-webcam                    (3) | Val  Loss: 0.6780 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8940
============ Train epoch 27 ============
cnt=[4, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-amazon                    (1) | Train Loss: 0.4982 | Train Acc: 0.8906
 Site-amazon                    (1) | Train Loss: 0.4316 | Train Acc: 0.9167
 Site-amazon                    (2) | Train Loss: 0.4901 | Train Acc: 0.8741
 Site-amazon                    (2) | Train Loss: 0.4409 | Train Acc: 0.9209
 Site-amazon                    (2) | Train Loss: 0.7442 | Train Acc: 0.9502
 Site-synthetic                 (0) | Train Loss: 0.9800 | Train Acc: 0.7500
 Site-synthetic                 (0) | Train Loss: 1.0204 | Train Acc: 0.8209
 Site-synthetic                 (0) | Train Loss: 0.6355 | Train Acc: 0.8967
 Site-dslr                      (3) | Train Loss: 0.6097 | Train Acc: 0.8750
 Site-dslr                      (0) | Train Loss: 0.4912 | Train Acc: 0.9333
 Site-webcam                    (1) | Train Loss: 0.6655 | Train Acc: 0.8824
Average Train Accuracy: 0.8828
 Site-amazon                    (1) | Val  Loss: 0.3461 | Val  Acc: 0.9762
 Site-amazon                    (1) | Val  Loss: 0.4117 | Val  Acc: 0.9219
 Site-amazon                    (2) | Val  Loss: 0.5329 | Val  Acc: 0.8842
 Site-amazon                    (2) | Val  Loss: 0.4373 | Val  Acc: 0.9161
 Site-amazon                    (2) | Val  Loss: 0.4384 | Val  Acc: 0.9252
 Site-synthetic                 (0) | Val  Loss: 0.7629 | Val  Acc: 0.8250
 Site-synthetic                 (0) | Val  Loss: 0.6164 | Val  Acc: 0.8989
 Site-synthetic                 (0) | Val  Loss: 0.6717 | Val  Acc: 0.8450
 Site-dslr                      (3) | Val  Loss: 0.4681 | Val  Acc: 0.9375
 Site-dslr                      (0) | Val  Loss: 0.6401 | Val  Acc: 0.8875
 Site-webcam                    (1) | Val  Loss: 0.6937 | Val  Acc: 0.8393
Average Valid Accuracy: 0.8961
============ Train epoch 28 ============
cnt=[4, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-amazon                    (3) | Train Loss: 0.4685 | Train Acc: 0.9062
 Site-amazon                    (0) | Train Loss: 0.3880 | Train Acc: 0.9271
 Site-amazon                    (0) | Train Loss: 0.3772 | Train Acc: 0.9231
 Site-amazon                    (0) | Train Loss: 0.4062 | Train Acc: 0.9116
 Site-amazon                    (0) | Train Loss: 0.3090 | Train Acc: 0.9782
 Site-synthetic                 (2) | Train Loss: 0.9628 | Train Acc: 0.6833
 Site-synthetic                 (2) | Train Loss: 0.7076 | Train Acc: 0.8060
 Site-synthetic                 (2) | Train Loss: 0.6491 | Train Acc: 0.8833
 Site-dslr                      (1) | Train Loss: 0.7144 | Train Acc: 0.8750
 Site-dslr                      (1) | Train Loss: 0.4981 | Train Acc: 0.9333
 Site-webcam                    (3) | Train Loss: 0.5982 | Train Acc: 0.8706
Average Train Accuracy: 0.8816
 Site-amazon                    (3) | Val  Loss: 0.3393 | Val  Acc: 0.9762
 Site-amazon                    (0) | Val  Loss: 0.3853 | Val  Acc: 0.9219
 Site-amazon                    (0) | Val  Loss: 0.4840 | Val  Acc: 0.9053
 Site-amazon                    (0) | Val  Loss: 0.3910 | Val  Acc: 0.9301
 Site-amazon                    (0) | Val  Loss: 0.4023 | Val  Acc: 0.9299
 Site-synthetic                 (2) | Val  Loss: 0.6513 | Val  Acc: 0.9250
 Site-synthetic                 (2) | Val  Loss: 0.6323 | Val  Acc: 0.8764
 Site-synthetic                 (2) | Val  Loss: 0.7071 | Val  Acc: 0.8550
 Site-dslr                      (1) | Val  Loss: 0.3713 | Val  Acc: 0.9375
 Site-dslr                      (1) | Val  Loss: 0.6365 | Val  Acc: 0.9000
 Site-webcam                    (3) | Val  Loss: 0.6263 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9104
 Best site-amazon                   (3)  | Epoch:28 | Val Acc: 0.9762
 Best site-amazon                   (0)  | Epoch:28 | Val Acc: 0.9219
 Best site-amazon                   (0)  | Epoch:28 | Val Acc: 0.9053
 Best site-amazon                   (0)  | Epoch:28 | Val Acc: 0.9301
 Best site-amazon                   (0)  | Epoch:28 | Val Acc: 0.9299
 Best site-synthetic                (2)  | Epoch:28 | Val Acc: 0.9250
 Best site-synthetic                (2)  | Epoch:28 | Val Acc: 0.8764
 Best site-synthetic                (2)  | Epoch:28 | Val Acc: 0.8550
 Best site-dslr                     (1)  | Epoch:28 | Val Acc: 0.9375
 Best site-dslr                     (1)  | Epoch:28 | Val Acc: 0.9000
 Best site-webcam                   (3)  | Epoch:28 | Val Acc: 0.8571
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 29 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-amazon                    (1) | Train Loss: 0.4902 | Train Acc: 0.8906
 Site-amazon                    (1) | Train Loss: 0.4217 | Train Acc: 0.9167
 Site-amazon                    (3) | Train Loss: 0.5070 | Train Acc: 0.8811
 Site-amazon                    (3) | Train Loss: 0.4400 | Train Acc: 0.9163
 Site-amazon                    (3) | Train Loss: 0.3035 | Train Acc: 0.9626
 Site-synthetic                 (2) | Train Loss: 0.9038 | Train Acc: 0.7500
 Site-synthetic                 (2) | Train Loss: 0.7707 | Train Acc: 0.8134
 Site-synthetic                 (2) | Train Loss: 0.6660 | Train Acc: 0.8767
 Site-dslr                      (0) | Train Loss: 0.7287 | Train Acc: 0.8750
 Site-dslr                      (0) | Train Loss: 0.4608 | Train Acc: 0.9417
 Site-webcam                    (1) | Train Loss: 0.6256 | Train Acc: 0.8588
Average Train Accuracy: 0.8803
 Site-amazon                    (1) | Val  Loss: 0.2462 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 0.4099 | Val  Acc: 0.9219
 Site-amazon                    (3) | Val  Loss: 0.4309 | Val  Acc: 0.9263
 Site-amazon                    (3) | Val  Loss: 0.3763 | Val  Acc: 0.9510
 Site-amazon                    (3) | Val  Loss: 0.4235 | Val  Acc: 0.9112
 Site-synthetic                 (2) | Val  Loss: 0.6207 | Val  Acc: 0.8500
 Site-synthetic                 (2) | Val  Loss: 0.6037 | Val  Acc: 0.9101
 Site-synthetic                 (2) | Val  Loss: 0.6231 | Val  Acc: 0.8900
 Site-dslr                      (0) | Val  Loss: 0.3914 | Val  Acc: 1.0000
 Site-dslr                      (0) | Val  Loss: 0.6184 | Val  Acc: 0.8625
 Site-webcam                    (1) | Val  Loss: 0.6496 | Val  Acc: 0.8393
Average Valid Accuracy: 0.9148
 Best site-amazon                   (1)  | Epoch:29 | Val Acc: 1.0000
 Best site-amazon                   (1)  | Epoch:29 | Val Acc: 0.9219
 Best site-amazon                   (3)  | Epoch:29 | Val Acc: 0.9263
 Best site-amazon                   (3)  | Epoch:29 | Val Acc: 0.9510
 Best site-amazon                   (3)  | Epoch:29 | Val Acc: 0.9112
 Best site-synthetic                (2)  | Epoch:29 | Val Acc: 0.8500
 Best site-synthetic                (2)  | Epoch:29 | Val Acc: 0.9101
 Best site-synthetic                (2)  | Epoch:29 | Val Acc: 0.8900
 Best site-dslr                     (0)  | Epoch:29 | Val Acc: 1.0000
 Best site-dslr                     (0)  | Epoch:29 | Val Acc: 0.8625
 Best site-webcam                   (1)  | Epoch:29 | Val Acc: 0.8393
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 30 ============
cnt=[3, 3, 3, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-amazon                    (2) | Train Loss: 0.5291 | Train Acc: 0.8906
 Site-amazon                    (2) | Train Loss: 0.4571 | Train Acc: 0.9167
 Site-amazon                    (0) | Train Loss: 0.3977 | Train Acc: 0.9091
 Site-amazon                    (0) | Train Loss: 0.3697 | Train Acc: 0.9535
 Site-amazon                    (0) | Train Loss: 0.3065 | Train Acc: 0.9533
 Site-synthetic                 (1) | Train Loss: 0.9185 | Train Acc: 0.7167
 Site-synthetic                 (1) | Train Loss: 0.6102 | Train Acc: 0.8209
 Site-synthetic                 (1) | Train Loss: 0.6204 | Train Acc: 0.8767
 Site-dslr                      (3) | Train Loss: 0.6093 | Train Acc: 0.8333
 Site-dslr                      (3) | Train Loss: 0.4563 | Train Acc: 0.9333
 Site-webcam                    (2) | Train Loss: 0.6164 | Train Acc: 0.8588
Average Train Accuracy: 0.8784
 Site-amazon                    (2) | Val  Loss: 0.3294 | Val  Acc: 0.9524
 Site-amazon                    (2) | Val  Loss: 0.4553 | Val  Acc: 0.9375
 Site-amazon                    (0) | Val  Loss: 0.4697 | Val  Acc: 0.9263
 Site-amazon                    (0) | Val  Loss: 0.4505 | Val  Acc: 0.9231
 Site-amazon                    (0) | Val  Loss: 0.3565 | Val  Acc: 0.9439
 Site-synthetic                 (1) | Val  Loss: 0.5637 | Val  Acc: 0.8750
 Site-synthetic                 (1) | Val  Loss: 0.5529 | Val  Acc: 0.8989
 Site-synthetic                 (1) | Val  Loss: 0.5715 | Val  Acc: 0.8850
 Site-dslr                      (3) | Val  Loss: 0.4418 | Val  Acc: 0.9375
 Site-dslr                      (3) | Val  Loss: 0.6673 | Val  Acc: 0.8875
 Site-webcam                    (2) | Val  Loss: 0.6438 | Val  Acc: 0.8393
Average Valid Accuracy: 0.9097
============ Train epoch 31 ============
cnt=[3, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-amazon                    (2) | Train Loss: 0.4562 | Train Acc: 0.9375
 Site-amazon                    (1) | Train Loss: 0.4175 | Train Acc: 0.8854
 Site-amazon                    (2) | Train Loss: 0.4274 | Train Acc: 0.9161
 Site-amazon                    (2) | Train Loss: 0.3790 | Train Acc: 0.9442
 Site-amazon                    (2) | Train Loss: 0.4259 | Train Acc: 0.9439
 Site-synthetic                 (0) | Train Loss: 0.8821 | Train Acc: 0.7667
 Site-synthetic                 (0) | Train Loss: 0.7844 | Train Acc: 0.8358
 Site-synthetic                 (0) | Train Loss: 0.5936 | Train Acc: 0.8800
 Site-dslr                      (3) | Train Loss: 0.5710 | Train Acc: 0.9167
 Site-dslr                      (3) | Train Loss: 0.4656 | Train Acc: 0.9250
 Site-webcam                    (1) | Train Loss: 0.5442 | Train Acc: 0.8824
Average Train Accuracy: 0.8940
 Site-amazon                    (2) | Val  Loss: 0.3183 | Val  Acc: 0.9762
 Site-amazon                    (1) | Val  Loss: 0.3903 | Val  Acc: 0.9375
 Site-amazon                    (2) | Val  Loss: 0.4817 | Val  Acc: 0.9053
 Site-amazon                    (2) | Val  Loss: 0.4238 | Val  Acc: 0.9161
 Site-amazon                    (2) | Val  Loss: 0.3497 | Val  Acc: 0.9486
 Site-synthetic                 (0) | Val  Loss: 0.5822 | Val  Acc: 0.8750
 Site-synthetic                 (0) | Val  Loss: 0.5972 | Val  Acc: 0.9438
 Site-synthetic                 (0) | Val  Loss: 0.5943 | Val  Acc: 0.8700
 Site-dslr                      (3) | Val  Loss: 0.4931 | Val  Acc: 0.9375
 Site-dslr                      (3) | Val  Loss: 0.6011 | Val  Acc: 0.9000
 Site-webcam                    (1) | Val  Loss: 0.6888 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9152
 Best site-amazon                   (2)  | Epoch:31 | Val Acc: 0.9762
 Best site-amazon                   (1)  | Epoch:31 | Val Acc: 0.9375
 Best site-amazon                   (2)  | Epoch:31 | Val Acc: 0.9053
 Best site-amazon                   (2)  | Epoch:31 | Val Acc: 0.9161
 Best site-amazon                   (2)  | Epoch:31 | Val Acc: 0.9486
 Best site-synthetic                (0)  | Epoch:31 | Val Acc: 0.8750
 Best site-synthetic                (0)  | Epoch:31 | Val Acc: 0.9438
 Best site-synthetic                (0)  | Epoch:31 | Val Acc: 0.8700
 Best site-dslr                     (3)  | Epoch:31 | Val Acc: 0.9375
 Best site-dslr                     (3)  | Epoch:31 | Val Acc: 0.9000
 Best site-webcam                   (1)  | Epoch:31 | Val Acc: 0.8571
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 32 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-amazon                    (0) | Train Loss: 0.4798 | Train Acc: 0.9531
 Site-amazon                    (0) | Train Loss: 0.3961 | Train Acc: 0.9062
 Site-amazon                    (0) | Train Loss: 0.4383 | Train Acc: 0.9371
 Site-amazon                    (0) | Train Loss: 0.3630 | Train Acc: 0.9535
 Site-amazon                    (0) | Train Loss: 0.3026 | Train Acc: 0.9533
 Site-synthetic                 (1) | Train Loss: 0.8169 | Train Acc: 0.7667
 Site-synthetic                 (1) | Train Loss: 0.6418 | Train Acc: 0.8731
 Site-synthetic                 (1) | Train Loss: 0.5810 | Train Acc: 0.8800
 Site-dslr                      (2) | Train Loss: 0.6914 | Train Acc: 0.9167
 Site-dslr                      (2) | Train Loss: 0.4428 | Train Acc: 0.9167
 Site-webcam                    (3) | Train Loss: 0.5202 | Train Acc: 0.8706
Average Train Accuracy: 0.9024
 Site-amazon                    (0) | Val  Loss: 0.3409 | Val  Acc: 0.9762
 Site-amazon                    (0) | Val  Loss: 0.3355 | Val  Acc: 0.9688
 Site-amazon                    (0) | Val  Loss: 0.4414 | Val  Acc: 0.9263
 Site-amazon                    (0) | Val  Loss: 0.3741 | Val  Acc: 0.9371
 Site-amazon                    (0) | Val  Loss: 0.3760 | Val  Acc: 0.9579
 Site-synthetic                 (1) | Val  Loss: 0.5463 | Val  Acc: 0.9500
 Site-synthetic                 (1) | Val  Loss: 0.5425 | Val  Acc: 0.8989
 Site-synthetic                 (1) | Val  Loss: 0.5521 | Val  Acc: 0.8950
 Site-dslr                      (2) | Val  Loss: 0.4104 | Val  Acc: 1.0000
 Site-dslr                      (2) | Val  Loss: 0.6016 | Val  Acc: 0.8750
 Site-webcam                    (3) | Val  Loss: 0.5914 | Val  Acc: 0.8750
Average Valid Accuracy: 0.9327
 Best site-amazon                   (0)  | Epoch:32 | Val Acc: 0.9762
 Best site-amazon                   (0)  | Epoch:32 | Val Acc: 0.9688
 Best site-amazon                   (0)  | Epoch:32 | Val Acc: 0.9263
 Best site-amazon                   (0)  | Epoch:32 | Val Acc: 0.9371
 Best site-amazon                   (0)  | Epoch:32 | Val Acc: 0.9579
 Best site-synthetic                (1)  | Epoch:32 | Val Acc: 0.9500
 Best site-synthetic                (1)  | Epoch:32 | Val Acc: 0.8989
 Best site-synthetic                (1)  | Epoch:32 | Val Acc: 0.8950
 Best site-dslr                     (2)  | Epoch:32 | Val Acc: 1.0000
 Best site-dslr                     (2)  | Epoch:32 | Val Acc: 0.8750
 Best site-webcam                   (3)  | Epoch:32 | Val Acc: 0.8750
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 33 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-amazon                    (0) | Train Loss: 0.4103 | Train Acc: 0.9219
 Site-amazon                    (0) | Train Loss: 0.3356 | Train Acc: 0.9375
 Site-amazon                    (0) | Train Loss: 0.3584 | Train Acc: 0.9161
 Site-amazon                    (0) | Train Loss: 0.3572 | Train Acc: 0.9302
 Site-amazon                    (0) | Train Loss: 0.2718 | Train Acc: 0.9626
 Site-synthetic                 (1) | Train Loss: 0.8192 | Train Acc: 0.7500
 Site-synthetic                 (1) | Train Loss: 0.7818 | Train Acc: 0.8134
 Site-synthetic                 (1) | Train Loss: 0.5998 | Train Acc: 0.8933
 Site-dslr                      (2) | Train Loss: 0.5853 | Train Acc: 0.9167
 Site-dslr                      (2) | Train Loss: 0.4616 | Train Acc: 0.9250
 Site-webcam                    (3) | Train Loss: 0.6320 | Train Acc: 0.8941
Average Train Accuracy: 0.8964
 Site-amazon                    (0) | Val  Loss: 0.2579 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.4139 | Val  Acc: 0.9375
 Site-amazon                    (0) | Val  Loss: 0.4128 | Val  Acc: 0.9263
 Site-amazon                    (0) | Val  Loss: 0.3618 | Val  Acc: 0.9371
 Site-amazon                    (0) | Val  Loss: 0.3433 | Val  Acc: 0.9393
 Site-synthetic                 (1) | Val  Loss: 0.5511 | Val  Acc: 0.9000
 Site-synthetic                 (1) | Val  Loss: 0.5471 | Val  Acc: 0.9101
 Site-synthetic                 (1) | Val  Loss: 0.5400 | Val  Acc: 0.8950
 Site-dslr                      (2) | Val  Loss: 0.4097 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.5665 | Val  Acc: 0.8750
 Site-webcam                    (3) | Val  Loss: 0.5716 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9195
============ Train epoch 34 ============
cnt=[4, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-amazon                    (0) | Train Loss: 0.3646 | Train Acc: 0.9688
 Site-amazon                    (0) | Train Loss: 0.4193 | Train Acc: 0.9167
 Site-amazon                    (2) | Train Loss: 0.4286 | Train Acc: 0.9091
 Site-amazon                    (0) | Train Loss: 0.3132 | Train Acc: 0.9488
 Site-amazon                    (2) | Train Loss: 0.5127 | Train Acc: 0.9657
 Site-synthetic                 (1) | Train Loss: 0.8313 | Train Acc: 0.7667
 Site-synthetic                 (1) | Train Loss: 0.7383 | Train Acc: 0.8433
 Site-synthetic                 (1) | Train Loss: 0.5598 | Train Acc: 0.9133
 Site-dslr                      (3) | Train Loss: 0.5518 | Train Acc: 0.8750
 Site-dslr                      (3) | Train Loss: 0.4301 | Train Acc: 0.9500
 Site-webcam                    (0) | Train Loss: 0.4485 | Train Acc: 0.8941
Average Train Accuracy: 0.9047
 Site-amazon                    (0) | Val  Loss: 0.2966 | Val  Acc: 0.9762
 Site-amazon                    (0) | Val  Loss: 0.3832 | Val  Acc: 0.9375
 Site-amazon                    (2) | Val  Loss: 0.4166 | Val  Acc: 0.9474
 Site-amazon                    (0) | Val  Loss: 0.3965 | Val  Acc: 0.9161
 Site-amazon                    (2) | Val  Loss: 0.3577 | Val  Acc: 0.9346
 Site-synthetic                 (1) | Val  Loss: 0.5677 | Val  Acc: 0.8500
 Site-synthetic                 (1) | Val  Loss: 0.5622 | Val  Acc: 0.8652
 Site-synthetic                 (1) | Val  Loss: 0.5989 | Val  Acc: 0.8850
 Site-dslr                      (3) | Val  Loss: 0.5104 | Val  Acc: 0.9375
 Site-dslr                      (3) | Val  Loss: 0.5394 | Val  Acc: 0.9000
 Site-webcam                    (0) | Val  Loss: 0.5734 | Val  Acc: 0.8393
Average Valid Accuracy: 0.9081
============ Train epoch 35 ============
cnt=[3, 3, 3, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-amazon                    (1) | Train Loss: 0.3642 | Train Acc: 0.9531
 Site-amazon                    (1) | Train Loss: 0.3780 | Train Acc: 0.9271
 Site-amazon                    (3) | Train Loss: 0.3750 | Train Acc: 0.9161
 Site-amazon                    (1) | Train Loss: 0.3651 | Train Acc: 0.9535
 Site-amazon                    (3) | Train Loss: 0.2542 | Train Acc: 0.9595
 Site-synthetic                 (0) | Train Loss: 0.7709 | Train Acc: 0.7333
 Site-synthetic                 (0) | Train Loss: 0.7334 | Train Acc: 0.8284
 Site-synthetic                 (0) | Train Loss: 0.5505 | Train Acc: 0.8800
 Site-dslr                      (2) | Train Loss: 0.5891 | Train Acc: 0.9167
 Site-dslr                      (2) | Train Loss: 0.4526 | Train Acc: 0.9250
 Site-webcam                    (2) | Train Loss: 0.4751 | Train Acc: 0.8824
Average Train Accuracy: 0.8977
 Site-amazon                    (1) | Val  Loss: 0.2213 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 0.3876 | Val  Acc: 0.9219
 Site-amazon                    (3) | Val  Loss: 0.4135 | Val  Acc: 0.9053
 Site-amazon                    (1) | Val  Loss: 0.4411 | Val  Acc: 0.9091
 Site-amazon                    (3) | Val  Loss: 0.3648 | Val  Acc: 0.9299
 Site-synthetic                 (0) | Val  Loss: 0.5358 | Val  Acc: 0.9000
 Site-synthetic                 (0) | Val  Loss: 0.5417 | Val  Acc: 0.8989
 Site-synthetic                 (0) | Val  Loss: 0.5176 | Val  Acc: 0.9200
 Site-dslr                      (2) | Val  Loss: 0.3769 | Val  Acc: 1.0000
 Site-dslr                      (2) | Val  Loss: 0.5309 | Val  Acc: 0.9125
 Site-webcam                    (2) | Val  Loss: 0.6097 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9232
============ Train epoch 36 ============
cnt=[3, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-amazon                    (0) | Train Loss: 0.4274 | Train Acc: 0.9375
 Site-amazon                    (0) | Train Loss: 0.3442 | Train Acc: 0.9271
 Site-amazon                    (3) | Train Loss: 0.3817 | Train Acc: 0.9231
 Site-amazon                    (3) | Train Loss: 0.3860 | Train Acc: 0.9395
 Site-amazon                    (3) | Train Loss: 0.3542 | Train Acc: 0.9595
 Site-synthetic                 (1) | Train Loss: 0.7453 | Train Acc: 0.8000
 Site-synthetic                 (1) | Train Loss: 0.6243 | Train Acc: 0.8582
 Site-synthetic                 (1) | Train Loss: 0.5330 | Train Acc: 0.8933
 Site-dslr                      (2) | Train Loss: 0.4589 | Train Acc: 0.9583
 Site-dslr                      (2) | Train Loss: 0.4021 | Train Acc: 0.9500
 Site-webcam                    (0) | Train Loss: 0.5400 | Train Acc: 0.8941
Average Train Accuracy: 0.9128
 Site-amazon                    (0) | Val  Loss: 0.3045 | Val  Acc: 0.9524
 Site-amazon                    (0) | Val  Loss: 0.3242 | Val  Acc: 0.9375
 Site-amazon                    (3) | Val  Loss: 0.4677 | Val  Acc: 0.9053
 Site-amazon                    (3) | Val  Loss: 0.3631 | Val  Acc: 0.9231
 Site-amazon                    (3) | Val  Loss: 0.3178 | Val  Acc: 0.9252
 Site-synthetic                 (1) | Val  Loss: 0.5001 | Val  Acc: 0.8750
 Site-synthetic                 (1) | Val  Loss: 0.4938 | Val  Acc: 0.9101
 Site-synthetic                 (1) | Val  Loss: 0.5155 | Val  Acc: 0.9150
 Site-dslr                      (2) | Val  Loss: 0.4119 | Val  Acc: 1.0000
 Site-dslr                      (2) | Val  Loss: 0.6112 | Val  Acc: 0.9000
 Site-webcam                    (0) | Val  Loss: 0.5622 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9182
============ Train epoch 37 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-amazon                    (0) | Train Loss: 0.3327 | Train Acc: 0.9688
 Site-amazon                    (0) | Train Loss: 0.3808 | Train Acc: 0.9062
 Site-amazon                    (0) | Train Loss: 0.4370 | Train Acc: 0.9091
 Site-amazon                    (0) | Train Loss: 0.3742 | Train Acc: 0.9256
 Site-amazon                    (0) | Train Loss: 0.2460 | Train Acc: 0.9626
 Site-synthetic                 (1) | Train Loss: 0.7140 | Train Acc: 0.7833
 Site-synthetic                 (1) | Train Loss: 0.6208 | Train Acc: 0.8358
 Site-synthetic                 (1) | Train Loss: 0.5105 | Train Acc: 0.9100
 Site-dslr                      (2) | Train Loss: 0.5528 | Train Acc: 0.9167
 Site-dslr                      (2) | Train Loss: 0.4477 | Train Acc: 0.9167
 Site-webcam                    (3) | Train Loss: 0.4314 | Train Acc: 0.9059
Average Train Accuracy: 0.9037
 Site-amazon                    (0) | Val  Loss: 0.2794 | Val  Acc: 0.9762
 Site-amazon                    (0) | Val  Loss: 0.2806 | Val  Acc: 0.9531
 Site-amazon                    (0) | Val  Loss: 0.4082 | Val  Acc: 0.9263
 Site-amazon                    (0) | Val  Loss: 0.4075 | Val  Acc: 0.9231
 Site-amazon                    (0) | Val  Loss: 0.3064 | Val  Acc: 0.9439
 Site-synthetic                 (1) | Val  Loss: 0.5248 | Val  Acc: 0.9000
 Site-synthetic                 (1) | Val  Loss: 0.4428 | Val  Acc: 0.9551
 Site-synthetic                 (1) | Val  Loss: 0.4742 | Val  Acc: 0.9300
 Site-dslr                      (2) | Val  Loss: 0.4509 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.5048 | Val  Acc: 0.9000
 Site-webcam                    (3) | Val  Loss: 0.4744 | Val  Acc: 0.8929
Average Valid Accuracy: 0.9307
============ Train epoch 38 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-amazon                    (0) | Train Loss: 0.4148 | Train Acc: 0.9062
 Site-amazon                    (0) | Train Loss: 0.4347 | Train Acc: 0.9375
 Site-amazon                    (0) | Train Loss: 0.3943 | Train Acc: 0.9091
 Site-amazon                    (0) | Train Loss: 0.3413 | Train Acc: 0.9395
 Site-amazon                    (0) | Train Loss: 0.2359 | Train Acc: 0.9595
 Site-synthetic                 (1) | Train Loss: 0.7876 | Train Acc: 0.7667
 Site-synthetic                 (1) | Train Loss: 0.4873 | Train Acc: 0.8657
 Site-synthetic                 (1) | Train Loss: 0.5116 | Train Acc: 0.8967
 Site-dslr                      (2) | Train Loss: 0.4707 | Train Acc: 0.9583
 Site-dslr                      (2) | Train Loss: 0.4090 | Train Acc: 0.9333
 Site-webcam                    (3) | Train Loss: 0.4511 | Train Acc: 0.9412
Average Train Accuracy: 0.9103
 Site-amazon                    (0) | Val  Loss: 0.2588 | Val  Acc: 0.9762
 Site-amazon                    (0) | Val  Loss: 0.3475 | Val  Acc: 0.9375
 Site-amazon                    (0) | Val  Loss: 0.3487 | Val  Acc: 0.9474
 Site-amazon                    (0) | Val  Loss: 0.3625 | Val  Acc: 0.9371
 Site-amazon                    (0) | Val  Loss: 0.3126 | Val  Acc: 0.9486
 Site-synthetic                 (1) | Val  Loss: 0.5355 | Val  Acc: 0.8750
 Site-synthetic                 (1) | Val  Loss: 0.4677 | Val  Acc: 0.9438
 Site-synthetic                 (1) | Val  Loss: 0.4636 | Val  Acc: 0.9150
 Site-dslr                      (2) | Val  Loss: 0.4526 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.4612 | Val  Acc: 0.9625
 Site-webcam                    (3) | Val  Loss: 0.5689 | Val  Acc: 0.8036
Average Valid Accuracy: 0.9258
============ Train epoch 39 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-amazon                    (3) | Train Loss: 0.3885 | Train Acc: 0.9375
 Site-amazon                    (3) | Train Loss: 0.3216 | Train Acc: 0.9271
 Site-amazon                    (1) | Train Loss: 0.3842 | Train Acc: 0.9371
 Site-amazon                    (1) | Train Loss: 0.3161 | Train Acc: 0.9581
 Site-amazon                    (1) | Train Loss: 0.2960 | Train Acc: 0.9533
 Site-synthetic                 (2) | Train Loss: 0.8374 | Train Acc: 0.6833
 Site-synthetic                 (2) | Train Loss: 0.6180 | Train Acc: 0.9104
 Site-synthetic                 (2) | Train Loss: 0.4692 | Train Acc: 0.9000
 Site-dslr                      (0) | Train Loss: 0.4704 | Train Acc: 0.9167
 Site-dslr                      (0) | Train Loss: 0.3665 | Train Acc: 0.9583
 Site-webcam                    (3) | Train Loss: 0.4860 | Train Acc: 0.9176
Average Train Accuracy: 0.9090
 Site-amazon                    (3) | Val  Loss: 0.2544 | Val  Acc: 0.9762
 Site-amazon                    (3) | Val  Loss: 0.3394 | Val  Acc: 0.9688
 Site-amazon                    (1) | Val  Loss: 0.3886 | Val  Acc: 0.9263
 Site-amazon                    (1) | Val  Loss: 0.3367 | Val  Acc: 0.9441
 Site-amazon                    (1) | Val  Loss: 0.3051 | Val  Acc: 0.9393
 Site-synthetic                 (2) | Val  Loss: 0.5065 | Val  Acc: 0.9000
 Site-synthetic                 (2) | Val  Loss: 0.4944 | Val  Acc: 0.9213
 Site-synthetic                 (2) | Val  Loss: 0.4443 | Val  Acc: 0.9350
 Site-dslr                      (0) | Val  Loss: 0.3211 | Val  Acc: 1.0000
 Site-dslr                      (0) | Val  Loss: 0.4711 | Val  Acc: 0.9000
 Site-webcam                    (3) | Val  Loss: 0.5613 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9335
 Best site-amazon                   (3)  | Epoch:39 | Val Acc: 0.9762
 Best site-amazon                   (3)  | Epoch:39 | Val Acc: 0.9688
 Best site-amazon                   (1)  | Epoch:39 | Val Acc: 0.9263
 Best site-amazon                   (1)  | Epoch:39 | Val Acc: 0.9441
 Best site-amazon                   (1)  | Epoch:39 | Val Acc: 0.9393
 Best site-synthetic                (2)  | Epoch:39 | Val Acc: 0.9000
 Best site-synthetic                (2)  | Epoch:39 | Val Acc: 0.9213
 Best site-synthetic                (2)  | Epoch:39 | Val Acc: 0.9350
 Best site-dslr                     (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-dslr                     (0)  | Epoch:39 | Val Acc: 0.9000
 Best site-webcam                   (3)  | Epoch:39 | Val Acc: 0.8571
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-amazon                    (1) | Train Loss: 0.3322 | Train Acc: 0.9844
 Site-amazon                    (1) | Train Loss: 0.3409 | Train Acc: 0.9271
 Site-amazon                    (1) | Train Loss: 0.4162 | Train Acc: 0.9231
 Site-amazon                    (1) | Train Loss: 0.3534 | Train Acc: 0.9302
 Site-amazon                    (1) | Train Loss: 0.2431 | Train Acc: 0.9595
 Site-synthetic                 (2) | Train Loss: 0.7753 | Train Acc: 0.7333
 Site-synthetic                 (2) | Train Loss: 0.6170 | Train Acc: 0.8582
 Site-synthetic                 (2) | Train Loss: 0.4669 | Train Acc: 0.9167
 Site-dslr                      (0) | Train Loss: 0.5297 | Train Acc: 0.8750
 Site-dslr                      (0) | Train Loss: 0.3650 | Train Acc: 0.9333
 Site-webcam                    (3) | Train Loss: 0.3945 | Train Acc: 0.9412
Average Train Accuracy: 0.9075
 Site-amazon                    (1) | Val  Loss: 0.2421 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 0.3115 | Val  Acc: 0.9688
 Site-amazon                    (1) | Val  Loss: 0.3723 | Val  Acc: 0.9263
 Site-amazon                    (1) | Val  Loss: 0.2965 | Val  Acc: 0.9510
 Site-amazon                    (1) | Val  Loss: 0.2637 | Val  Acc: 0.9579
 Site-synthetic                 (2) | Val  Loss: 0.4875 | Val  Acc: 0.9250
 Site-synthetic                 (2) | Val  Loss: 0.4195 | Val  Acc: 0.9326
 Site-synthetic                 (2) | Val  Loss: 0.4419 | Val  Acc: 0.9000
 Site-dslr                      (0) | Val  Loss: 0.3861 | Val  Acc: 0.9375
 Site-dslr                      (0) | Val  Loss: 0.5093 | Val  Acc: 0.9000
 Site-webcam                    (3) | Val  Loss: 0.5864 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9324
 Test site-amazon                    (1)| Epoch:39 | Test Acc: 0.9314
 Test site-synthetic                 (2)| Epoch:39 | Test Acc: 0.7987
 Test site-dslr                      (0)| Epoch:39 | Test Acc: 0.9098
 Test site-webcam                    (3)| Epoch:39 | Test Acc: 0.9037
amazon: 0.9314, synthetic: 0.7987, dslr: 0.9098, webcam: 0.9037, 
Average Test Accuracy(group): 0.8859, Average Test Accuracy(individual): 0.8888,
domain std=0.0514, cluster std=0.0514, individual std=0.0560, 
Average Test Accuracy: 0.8859
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 41 ============
cnt=[3, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-amazon                    (3) | Train Loss: 0.4126 | Train Acc: 0.8906
 Site-amazon                    (1) | Train Loss: 0.3706 | Train Acc: 0.9271
 Site-amazon                    (3) | Train Loss: 0.3382 | Train Acc: 0.9021
 Site-amazon                    (3) | Train Loss: 0.2783 | Train Acc: 0.9535
 Site-amazon                    (3) | Train Loss: 0.2194 | Train Acc: 0.9688
 Site-synthetic                 (0) | Train Loss: 0.6917 | Train Acc: 0.7667
 Site-synthetic                 (0) | Train Loss: 0.5578 | Train Acc: 0.8582
 Site-synthetic                 (0) | Train Loss: 0.4683 | Train Acc: 0.9100
 Site-dslr                      (2) | Train Loss: 0.4760 | Train Acc: 0.9583
 Site-dslr                      (2) | Train Loss: 0.3899 | Train Acc: 0.9333
 Site-webcam                    (1) | Train Loss: 0.4603 | Train Acc: 0.9294
Average Train Accuracy: 0.9089
 Site-amazon                    (3) | Val  Loss: 0.2615 | Val  Acc: 0.9762
 Site-amazon                    (1) | Val  Loss: 0.3497 | Val  Acc: 0.9219
 Site-amazon                    (3) | Val  Loss: 0.4166 | Val  Acc: 0.9158
 Site-amazon                    (3) | Val  Loss: 0.2951 | Val  Acc: 0.9441
 Site-amazon                    (3) | Val  Loss: 0.2708 | Val  Acc: 0.9673
 Site-synthetic                 (0) | Val  Loss: 0.4511 | Val  Acc: 0.9000
 Site-synthetic                 (0) | Val  Loss: 0.4374 | Val  Acc: 0.9438
 Site-synthetic                 (0) | Val  Loss: 0.4855 | Val  Acc: 0.9200
 Site-dslr                      (2) | Val  Loss: 0.3222 | Val  Acc: 1.0000
 Site-dslr                      (2) | Val  Loss: 0.5005 | Val  Acc: 0.9625
 Site-webcam                    (1) | Val  Loss: 0.5672 | Val  Acc: 0.8929
Average Valid Accuracy: 0.9404
 Best site-amazon                   (3)  | Epoch:41 | Val Acc: 0.9762
 Best site-amazon                   (1)  | Epoch:41 | Val Acc: 0.9219
 Best site-amazon                   (3)  | Epoch:41 | Val Acc: 0.9158
 Best site-amazon                   (3)  | Epoch:41 | Val Acc: 0.9441
 Best site-amazon                   (3)  | Epoch:41 | Val Acc: 0.9673
 Best site-synthetic                (0)  | Epoch:41 | Val Acc: 0.9000
 Best site-synthetic                (0)  | Epoch:41 | Val Acc: 0.9438
 Best site-synthetic                (0)  | Epoch:41 | Val Acc: 0.9200
 Best site-dslr                     (2)  | Epoch:41 | Val Acc: 1.0000
 Best site-dslr                     (2)  | Epoch:41 | Val Acc: 0.9625
 Best site-webcam                   (1)  | Epoch:41 | Val Acc: 0.8929
 Test site-amazon                    (3)| Epoch:41 | Test Acc: 0.9335
 Test site-synthetic                 (0)| Epoch:41 | Test Acc: 0.8052
 Test site-dslr                      (2)| Epoch:41 | Test Acc: 0.9098
 Test site-webcam                    (1)| Epoch:41 | Test Acc: 0.9037
amazon: 0.9335, synthetic: 0.8052, dslr: 0.9098, webcam: 0.9037, 
Average Test Accuracy(group): 0.8880, Average Test Accuracy(individual): 0.8915,
domain std=0.0491, cluster std=0.0507, individual std=0.0539, 
Average Test Accuracy: 0.8880
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-amazon                    (3) | Train Loss: 0.3369 | Train Acc: 0.9062
 Site-amazon                    (1) | Train Loss: 0.3526 | Train Acc: 0.9375
 Site-amazon                    (1) | Train Loss: 0.3430 | Train Acc: 0.9301
 Site-amazon                    (1) | Train Loss: 0.3226 | Train Acc: 0.9442
 Site-amazon                    (1) | Train Loss: 0.2095 | Train Acc: 0.9595
 Site-synthetic                 (2) | Train Loss: 0.6717 | Train Acc: 0.8000
 Site-synthetic                 (2) | Train Loss: 0.6073 | Train Acc: 0.8806
 Site-synthetic                 (2) | Train Loss: 0.4821 | Train Acc: 0.8900
 Site-dslr                      (0) | Train Loss: 0.6321 | Train Acc: 0.8333
 Site-dslr                      (0) | Train Loss: 0.3353 | Train Acc: 0.9500
 Site-webcam                    (3) | Train Loss: 0.4827 | Train Acc: 0.9176
Average Train Accuracy: 0.9045
 Site-amazon                    (3) | Val  Loss: 0.2544 | Val  Acc: 0.9762
 Site-amazon                    (1) | Val  Loss: 0.3232 | Val  Acc: 0.9219
 Site-amazon                    (1) | Val  Loss: 0.4490 | Val  Acc: 0.9053
 Site-amazon                    (1) | Val  Loss: 0.3688 | Val  Acc: 0.9371
 Site-amazon                    (1) | Val  Loss: 0.2911 | Val  Acc: 0.9439
 Site-synthetic                 (2) | Val  Loss: 0.4590 | Val  Acc: 0.9250
 Site-synthetic                 (2) | Val  Loss: 0.4435 | Val  Acc: 0.9438
 Site-synthetic                 (2) | Val  Loss: 0.4527 | Val  Acc: 0.9050
 Site-dslr                      (0) | Val  Loss: 0.3650 | Val  Acc: 1.0000
 Site-dslr                      (0) | Val  Loss: 0.5036 | Val  Acc: 0.9000
 Site-webcam                    (3) | Val  Loss: 0.5303 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9287
 Test site-amazon                    (3)| Epoch:41 | Test Acc: 0.9314
 Test site-synthetic                 (2)| Epoch:41 | Test Acc: 0.8084
 Test site-dslr                      (0)| Epoch:41 | Test Acc: 0.9098
 Test site-webcam                    (3)| Epoch:41 | Test Acc: 0.9111
amazon: 0.9314, synthetic: 0.8084, dslr: 0.9098, webcam: 0.9111, 
Average Test Accuracy(group): 0.8902, Average Test Accuracy(individual): 0.8921,
domain std=0.0480, cluster std=0.0493, individual std=0.0520, 
Average Test Accuracy: 0.8902
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 43 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-amazon                    (1) | Train Loss: 0.4322 | Train Acc: 0.9062
 Site-amazon                    (1) | Train Loss: 0.2855 | Train Acc: 0.9375
 Site-amazon                    (1) | Train Loss: 0.3377 | Train Acc: 0.9161
 Site-amazon                    (1) | Train Loss: 0.2524 | Train Acc: 0.9674
 Site-amazon                    (1) | Train Loss: 0.2454 | Train Acc: 0.9688
 Site-synthetic                 (0) | Train Loss: 0.6617 | Train Acc: 0.7833
 Site-synthetic                 (0) | Train Loss: 0.4530 | Train Acc: 0.8358
 Site-synthetic                 (0) | Train Loss: 0.4130 | Train Acc: 0.9233
 Site-dslr                      (2) | Train Loss: 0.5201 | Train Acc: 0.9167
 Site-dslr                      (3) | Train Loss: 0.3646 | Train Acc: 0.9500
 Site-webcam                    (2) | Train Loss: 0.4981 | Train Acc: 0.9059
Average Train Accuracy: 0.9101
 Site-amazon                    (1) | Val  Loss: 0.1618 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 0.2359 | Val  Acc: 0.9375
 Site-amazon                    (1) | Val  Loss: 0.3792 | Val  Acc: 0.9263
 Site-amazon                    (1) | Val  Loss: 0.3354 | Val  Acc: 0.9301
 Site-amazon                    (1) | Val  Loss: 0.2993 | Val  Acc: 0.9346
 Site-synthetic                 (0) | Val  Loss: 0.4898 | Val  Acc: 0.9000
 Site-synthetic                 (0) | Val  Loss: 0.4883 | Val  Acc: 0.8876
 Site-synthetic                 (0) | Val  Loss: 0.4013 | Val  Acc: 0.9100
 Site-dslr                      (2) | Val  Loss: 0.2860 | Val  Acc: 1.0000
 Site-dslr                      (3) | Val  Loss: 0.5237 | Val  Acc: 0.9125
 Site-webcam                    (2) | Val  Loss: 0.5083 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9269
 Test site-amazon                    (1)| Epoch:42 | Test Acc: 0.9349
 Test site-synthetic                 (0)| Epoch:42 | Test Acc: 0.8045
 Test site-dslr                      (2)| Epoch:42 | Test Acc: 0.9059
 Test site-webcam                    (2)| Epoch:42 | Test Acc: 0.9086
amazon: 0.9349, synthetic: 0.8045, dslr: 0.9059, webcam: 0.9086, 
Average Test Accuracy(group): 0.8885, Average Test Accuracy(individual): 0.8917,
domain std=0.0498, cluster std=0.0497, individual std=0.0546, 
Average Test Accuracy: 0.8885
============ Train epoch 44 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-amazon                    (0) | Train Loss: 0.3328 | Train Acc: 0.9375
 Site-amazon                    (0) | Train Loss: 0.2767 | Train Acc: 0.9375
 Site-amazon                    (0) | Train Loss: 0.3376 | Train Acc: 0.9091
 Site-amazon                    (0) | Train Loss: 0.2777 | Train Acc: 0.9395
 Site-amazon                    (0) | Train Loss: 0.2264 | Train Acc: 0.9595
 Site-synthetic                 (1) | Train Loss: 0.6921 | Train Acc: 0.7833
 Site-synthetic                 (1) | Train Loss: 0.7300 | Train Acc: 0.8358
 Site-synthetic                 (1) | Train Loss: 0.4217 | Train Acc: 0.9333
 Site-dslr                      (2) | Train Loss: 0.5146 | Train Acc: 0.9167
 Site-dslr                      (2) | Train Loss: 0.3421 | Train Acc: 0.9417
 Site-webcam                    (3) | Train Loss: 0.4802 | Train Acc: 0.9294
Average Train Accuracy: 0.9112
 Site-amazon                    (0) | Val  Loss: 0.2442 | Val  Acc: 0.9762
 Site-amazon                    (0) | Val  Loss: 0.2263 | Val  Acc: 0.9844
 Site-amazon                    (0) | Val  Loss: 0.3938 | Val  Acc: 0.9263
 Site-amazon                    (0) | Val  Loss: 0.3872 | Val  Acc: 0.9301
 Site-amazon                    (0) | Val  Loss: 0.3114 | Val  Acc: 0.9346
 Site-synthetic                 (1) | Val  Loss: 0.3815 | Val  Acc: 0.9000
 Site-synthetic                 (1) | Val  Loss: 0.4378 | Val  Acc: 0.9213
 Site-synthetic                 (1) | Val  Loss: 0.3946 | Val  Acc: 0.9200
 Site-dslr                      (2) | Val  Loss: 0.3756 | Val  Acc: 1.0000
 Site-dslr                      (2) | Val  Loss: 0.5114 | Val  Acc: 0.9250
 Site-webcam                    (3) | Val  Loss: 0.4741 | Val  Acc: 0.9107
Average Valid Accuracy: 0.9390
 Test site-amazon                    (0)| Epoch:42 | Test Acc: 0.9349
 Test site-synthetic                 (1)| Epoch:42 | Test Acc: 0.8084
 Test site-dslr                      (2)| Epoch:42 | Test Acc: 0.9137
 Test site-webcam                    (3)| Epoch:42 | Test Acc: 0.9111
amazon: 0.9349, synthetic: 0.8084, dslr: 0.9137, webcam: 0.9111, 
Average Test Accuracy(group): 0.8920, Average Test Accuracy(individual): 0.8944,
domain std=0.0492, cluster std=0.0492, individual std=0.0535, 
Average Test Accuracy: 0.8920
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 45 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-amazon                    (0) | Train Loss: 0.3483 | Train Acc: 0.9375
 Site-amazon                    (0) | Train Loss: 0.3053 | Train Acc: 0.9271
 Site-amazon                    (0) | Train Loss: 0.3280 | Train Acc: 0.9231
 Site-amazon                    (0) | Train Loss: 0.3370 | Train Acc: 0.9302
 Site-amazon                    (0) | Train Loss: 0.2113 | Train Acc: 0.9657
 Site-synthetic                 (1) | Train Loss: 0.6336 | Train Acc: 0.8167
 Site-synthetic                 (1) | Train Loss: 0.6170 | Train Acc: 0.8582
 Site-synthetic                 (1) | Train Loss: 0.4045 | Train Acc: 0.9433
 Site-dslr                      (2) | Train Loss: 0.5405 | Train Acc: 0.9167
 Site-dslr                      (2) | Train Loss: 0.3566 | Train Acc: 0.9250
 Site-webcam                    (3) | Train Loss: 0.4249 | Train Acc: 0.9294
Average Train Accuracy: 0.9157
 Site-amazon                    (0) | Val  Loss: 0.2065 | Val  Acc: 0.9762
 Site-amazon                    (0) | Val  Loss: 0.2986 | Val  Acc: 0.9375
 Site-amazon                    (0) | Val  Loss: 0.3124 | Val  Acc: 0.9368
 Site-amazon                    (0) | Val  Loss: 0.2662 | Val  Acc: 0.9441
 Site-amazon                    (0) | Val  Loss: 0.2746 | Val  Acc: 0.9393
 Site-synthetic                 (1) | Val  Loss: 0.4981 | Val  Acc: 0.9000
 Site-synthetic                 (1) | Val  Loss: 0.4388 | Val  Acc: 0.8989
 Site-synthetic                 (1) | Val  Loss: 0.4202 | Val  Acc: 0.9250
 Site-dslr                      (2) | Val  Loss: 0.3101 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.4160 | Val  Acc: 0.9375
 Site-webcam                    (3) | Val  Loss: 0.5058 | Val  Acc: 0.8929
Average Valid Accuracy: 0.9296
 Test site-amazon                    (0)| Epoch:44 | Test Acc: 0.9356
 Test site-synthetic                 (1)| Epoch:44 | Test Acc: 0.8116
 Test site-dslr                      (2)| Epoch:44 | Test Acc: 0.9176
 Test site-webcam                    (3)| Epoch:44 | Test Acc: 0.9111
amazon: 0.9356, synthetic: 0.8116, dslr: 0.9176, webcam: 0.9111, 
Average Test Accuracy(group): 0.8940, Average Test Accuracy(individual): 0.8963,
domain std=0.0484, cluster std=0.0484, individual std=0.0526, 
Average Test Accuracy: 0.8940
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 46 ============
cnt=[3, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-amazon                    (0) | Train Loss: 0.3541 | Train Acc: 0.9219
 Site-amazon                    (0) | Train Loss: 0.3251 | Train Acc: 0.9271
 Site-amazon                    (3) | Train Loss: 0.3716 | Train Acc: 0.9091
 Site-amazon                    (3) | Train Loss: 0.2758 | Train Acc: 0.9581
 Site-amazon                    (3) | Train Loss: 0.2200 | Train Acc: 0.9782
 Site-synthetic                 (1) | Train Loss: 0.7159 | Train Acc: 0.8000
 Site-synthetic                 (1) | Train Loss: 0.5262 | Train Acc: 0.8881
 Site-synthetic                 (1) | Train Loss: 0.4064 | Train Acc: 0.9533
 Site-dslr                      (2) | Train Loss: 0.5233 | Train Acc: 0.9583
 Site-dslr                      (2) | Train Loss: 0.2925 | Train Acc: 0.9750
 Site-webcam                    (0) | Train Loss: 0.4190 | Train Acc: 0.8824
Average Train Accuracy: 0.9229
 Site-amazon                    (0) | Val  Loss: 0.2052 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.2729 | Val  Acc: 0.9531
 Site-amazon                    (3) | Val  Loss: 0.3576 | Val  Acc: 0.9368
 Site-amazon                    (3) | Val  Loss: 0.3127 | Val  Acc: 0.9371
 Site-amazon                    (3) | Val  Loss: 0.2654 | Val  Acc: 0.9579
 Site-synthetic                 (1) | Val  Loss: 0.3974 | Val  Acc: 0.9750
 Site-synthetic                 (1) | Val  Loss: 0.4588 | Val  Acc: 0.8989
 Site-synthetic                 (1) | Val  Loss: 0.4277 | Val  Acc: 0.9150
 Site-dslr                      (2) | Val  Loss: 0.2906 | Val  Acc: 1.0000
 Site-dslr                      (2) | Val  Loss: 0.4705 | Val  Acc: 0.9125
 Site-webcam                    (0) | Val  Loss: 0.4990 | Val  Acc: 0.9107
Average Valid Accuracy: 0.9452
 Best site-amazon                   (0)  | Epoch:46 | Val Acc: 1.0000
 Best site-amazon                   (0)  | Epoch:46 | Val Acc: 0.9531
 Best site-amazon                   (3)  | Epoch:46 | Val Acc: 0.9368
 Best site-amazon                   (3)  | Epoch:46 | Val Acc: 0.9371
 Best site-amazon                   (3)  | Epoch:46 | Val Acc: 0.9579
 Best site-synthetic                (1)  | Epoch:46 | Val Acc: 0.9750
 Best site-synthetic                (1)  | Epoch:46 | Val Acc: 0.8989
 Best site-synthetic                (1)  | Epoch:46 | Val Acc: 0.9150
 Best site-dslr                     (2)  | Epoch:46 | Val Acc: 1.0000
 Best site-dslr                     (2)  | Epoch:46 | Val Acc: 0.9125
 Best site-webcam                   (0)  | Epoch:46 | Val Acc: 0.9107
 Test site-amazon                    (0)| Epoch:46 | Test Acc: 0.9349
 Test site-synthetic                 (1)| Epoch:46 | Test Acc: 0.8135
 Test site-dslr                      (2)| Epoch:46 | Test Acc: 0.9137
 Test site-webcam                    (0)| Epoch:46 | Test Acc: 0.9111
amazon: 0.9349, synthetic: 0.8135, dslr: 0.9137, webcam: 0.9111, 
Average Test Accuracy(group): 0.8933, Average Test Accuracy(individual): 0.8958,
domain std=0.0470, cluster std=0.0489, individual std=0.0512, 
Average Test Accuracy: 0.8933
============ Train epoch 47 ============
cnt=[4, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-amazon                    (3) | Train Loss: 0.3720 | Train Acc: 0.9219
 Site-amazon                    (0) | Train Loss: 0.2758 | Train Acc: 0.9271
 Site-amazon                    (0) | Train Loss: 0.3099 | Train Acc: 0.9371
 Site-amazon                    (0) | Train Loss: 0.3163 | Train Acc: 0.9488
 Site-amazon                    (0) | Train Loss: 0.2409 | Train Acc: 0.9626
 Site-synthetic                 (1) | Train Loss: 0.7161 | Train Acc: 0.7667
 Site-synthetic                 (1) | Train Loss: 0.7518 | Train Acc: 0.8731
 Site-synthetic                 (1) | Train Loss: 0.4263 | Train Acc: 0.9367
 Site-dslr                      (2) | Train Loss: 0.4464 | Train Acc: 0.9583
 Site-dslr                      (2) | Train Loss: 0.3140 | Train Acc: 0.9333
 Site-webcam                    (2) | Train Loss: 0.3771 | Train Acc: 0.9059
Average Train Accuracy: 0.9156
 Site-amazon                    (3) | Val  Loss: 0.2505 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.2791 | Val  Acc: 0.9219
 Site-amazon                    (0) | Val  Loss: 0.3109 | Val  Acc: 0.9474
 Site-amazon                    (0) | Val  Loss: 0.2892 | Val  Acc: 0.9510
 Site-amazon                    (0) | Val  Loss: 0.2393 | Val  Acc: 0.9673
 Site-synthetic                 (1) | Val  Loss: 0.4289 | Val  Acc: 0.8750
 Site-synthetic                 (1) | Val  Loss: 0.4323 | Val  Acc: 0.9438
 Site-synthetic                 (1) | Val  Loss: 0.3752 | Val  Acc: 0.9300
 Site-dslr                      (2) | Val  Loss: 0.2784 | Val  Acc: 1.0000
 Site-dslr                      (2) | Val  Loss: 0.4220 | Val  Acc: 0.9125
 Site-webcam                    (2) | Val  Loss: 0.5585 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9369
 Test site-amazon                    (3)| Epoch:46 | Test Acc: 0.9335
 Test site-synthetic                 (1)| Epoch:46 | Test Acc: 0.8129
 Test site-dslr                      (2)| Epoch:46 | Test Acc: 0.9137
 Test site-webcam                    (2)| Epoch:46 | Test Acc: 0.9111
amazon: 0.9335, synthetic: 0.8129, dslr: 0.9137, webcam: 0.9111, 
Average Test Accuracy(group): 0.8928, Average Test Accuracy(individual): 0.8950,
domain std=0.0469, cluster std=0.0500, individual std=0.0510, 
Average Test Accuracy: 0.8928
============ Train epoch 48 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-amazon                    (1) | Train Loss: 0.3278 | Train Acc: 0.8906
 Site-amazon                    (1) | Train Loss: 0.3289 | Train Acc: 0.9375
 Site-amazon                    (1) | Train Loss: 0.2923 | Train Acc: 0.9231
 Site-amazon                    (1) | Train Loss: 0.2677 | Train Acc: 0.9535
 Site-amazon                    (1) | Train Loss: 0.2155 | Train Acc: 0.9688
 Site-synthetic                 (0) | Train Loss: 0.6584 | Train Acc: 0.8167
 Site-synthetic                 (0) | Train Loss: 0.5040 | Train Acc: 0.8731
 Site-synthetic                 (0) | Train Loss: 0.3760 | Train Acc: 0.9500
 Site-dslr                      (2) | Train Loss: 0.4091 | Train Acc: 1.0000
 Site-dslr                      (3) | Train Loss: 0.3228 | Train Acc: 0.9583
 Site-webcam                    (2) | Train Loss: 0.3643 | Train Acc: 0.9412
Average Train Accuracy: 0.9284
 Site-amazon                    (1) | Val  Loss: 0.2247 | Val  Acc: 0.9762
 Site-amazon                    (1) | Val  Loss: 0.2856 | Val  Acc: 0.9375
 Site-amazon                    (1) | Val  Loss: 0.3792 | Val  Acc: 0.9263
 Site-amazon                    (1) | Val  Loss: 0.3132 | Val  Acc: 0.9441
 Site-amazon                    (1) | Val  Loss: 0.2842 | Val  Acc: 0.9533
 Site-synthetic                 (0) | Val  Loss: 0.4272 | Val  Acc: 0.9250
 Site-synthetic                 (0) | Val  Loss: 0.4312 | Val  Acc: 0.9551
 Site-synthetic                 (0) | Val  Loss: 0.4197 | Val  Acc: 0.9050
 Site-dslr                      (2) | Val  Loss: 0.2570 | Val  Acc: 1.0000
 Site-dslr                      (3) | Val  Loss: 0.4712 | Val  Acc: 0.9375
 Site-webcam                    (2) | Val  Loss: 0.4752 | Val  Acc: 0.9107
Average Valid Accuracy: 0.9428
 Test site-amazon                    (1)| Epoch:46 | Test Acc: 0.9364
 Test site-synthetic                 (0)| Epoch:46 | Test Acc: 0.8168
 Test site-dslr                      (2)| Epoch:46 | Test Acc: 0.9098
 Test site-webcam                    (2)| Epoch:46 | Test Acc: 0.9111
amazon: 0.9364, synthetic: 0.8168, dslr: 0.9098, webcam: 0.9111, 
Average Test Accuracy(group): 0.8935, Average Test Accuracy(individual): 0.8966,
domain std=0.0455, cluster std=0.0455, individual std=0.0501, 
Average Test Accuracy: 0.8935
============ Train epoch 49 ============
cnt=[3, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-amazon                    (0) | Train Loss: 0.3562 | Train Acc: 0.9375
 Site-amazon                    (0) | Train Loss: 0.3050 | Train Acc: 0.9271
 Site-amazon                    (3) | Train Loss: 0.3664 | Train Acc: 0.9371
 Site-amazon                    (3) | Train Loss: 0.2798 | Train Acc: 0.9628
 Site-amazon                    (3) | Train Loss: 0.1993 | Train Acc: 0.9657
 Site-synthetic                 (1) | Train Loss: 0.7203 | Train Acc: 0.7833
 Site-synthetic                 (1) | Train Loss: 0.4562 | Train Acc: 0.8955
 Site-synthetic                 (1) | Train Loss: 0.4060 | Train Acc: 0.9233
 Site-dslr                      (2) | Train Loss: 0.4971 | Train Acc: 0.8750
 Site-dslr                      (2) | Train Loss: 0.3642 | Train Acc: 0.9333
 Site-webcam                    (0) | Train Loss: 0.3461 | Train Acc: 0.9294
Average Train Accuracy: 0.9155
 Site-amazon                    (0) | Val  Loss: 0.1631 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.2703 | Val  Acc: 0.9531
 Site-amazon                    (3) | Val  Loss: 0.3800 | Val  Acc: 0.9158
 Site-amazon                    (3) | Val  Loss: 0.3246 | Val  Acc: 0.9371
 Site-amazon                    (3) | Val  Loss: 0.2870 | Val  Acc: 0.9346
 Site-synthetic                 (1) | Val  Loss: 0.4184 | Val  Acc: 0.8500
 Site-synthetic                 (1) | Val  Loss: 0.3272 | Val  Acc: 0.9775
 Site-synthetic                 (1) | Val  Loss: 0.3719 | Val  Acc: 0.9450
 Site-dslr                      (2) | Val  Loss: 0.3264 | Val  Acc: 0.9375
 Site-dslr                      (2) | Val  Loss: 0.4739 | Val  Acc: 0.9125
 Site-webcam                    (0) | Val  Loss: 0.5031 | Val  Acc: 0.9107
Average Valid Accuracy: 0.9340
 Test site-amazon                    (0)| Epoch:46 | Test Acc: 0.9378
 Test site-synthetic                 (1)| Epoch:46 | Test Acc: 0.8161
 Test site-dslr                      (2)| Epoch:46 | Test Acc: 0.9176
 Test site-webcam                    (0)| Epoch:46 | Test Acc: 0.9136
amazon: 0.9378, synthetic: 0.8161, dslr: 0.9176, webcam: 0.9136, 
Average Test Accuracy(group): 0.8963, Average Test Accuracy(individual): 0.8987,
domain std=0.0472, cluster std=0.0491, individual std=0.0514, 
Average Test Accuracy: 0.8963
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
===2023-08-04 00:34:41===
===2023-08-04 00:34:57===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[64,96,143,215,321,60,134,300,24,120,85,
client_nums=[5,3,2,1,]
len_dataset=[1403,825,243,142,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (0)| Epoch:49 | Test Acc: 0.9378
 Test site-synthetic                 (1)| Epoch:49 | Test Acc: 0.8161
 Test site-dslr                      (2)| Epoch:49 | Test Acc: 0.9176
 Test site-webcam                    (0)| Epoch:49 | Test Acc: 0.9136
amazon: 0.9378, synthetic: 0.8161, dslr: 0.9176, webcam: 0.9136, 
Average Test Accuracy(group): 0.8963, Average Test Accuracy(individual): 0.8987,
domain std=0.0472, cluster std=0.0491, individual std=0.0514, 
===2023-08-04 02:07:16===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[89,134,200,300,449,56,98,170,64,128,112,
client_nums=[5,3,2,1,]
len_dataset=[1959,544,320,188,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-amazon                    (0) | Train Loss: 3.1916 | Train Acc: 0.1461
 Site-amazon                    (0) | Train Loss: 3.1209 | Train Acc: 0.2313
 Site-amazon                    (0) | Train Loss: 3.1304 | Train Acc: 0.2300
 Site-amazon                    (0) | Train Loss: 3.1311 | Train Acc: 0.2200
 Site-amazon                    (0) | Train Loss: 3.1577 | Train Acc: 0.2027
 Site-webcam                    (1) | Train Loss: 3.2692 | Train Acc: 0.1429
 Site-webcam                    (1) | Train Loss: 3.2454 | Train Acc: 0.1633
 Site-webcam                    (1) | Train Loss: 3.2944 | Train Acc: 0.1059
 Site-dslr                      (3) | Train Loss: 3.2714 | Train Acc: 0.1094
 Site-dslr                      (3) | Train Loss: 3.2636 | Train Acc: 0.1250
 Site-synthetic                 (2) | Train Loss: 3.3052 | Train Acc: 0.0804
Average Train Accuracy: 0.1597
 Site-amazon                    (0) | Val  Loss: 3.1432 | Val  Acc: 0.1186
 Site-amazon                    (0) | Val  Loss: 3.1292 | Val  Acc: 0.2022
 Site-amazon                    (0) | Val  Loss: 3.1487 | Val  Acc: 0.2406
 Site-amazon                    (0) | Val  Loss: 3.0965 | Val  Acc: 0.2550
 Site-amazon                    (0) | Val  Loss: 3.1522 | Val  Acc: 0.2207
 Site-webcam                    (1) | Val  Loss: 3.2756 | Val  Acc: 0.1081
 Site-webcam                    (1) | Val  Loss: 3.1747 | Val  Acc: 0.1385
 Site-webcam                    (1) | Val  Loss: 3.2879 | Val  Acc: 0.0796
 Site-dslr                      (3) | Val  Loss: 3.2609 | Val  Acc: 0.1905
 Site-dslr                      (3) | Val  Loss: 3.2488 | Val  Acc: 0.1294
 Site-synthetic                 (2) | Val  Loss: 3.3524 | Val  Acc: 0.0933
Average Valid Accuracy: 0.1615
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.1186
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.2022
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.2406
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.2550
 Best site-amazon                   (0)  | Epoch:0 | Val Acc: 0.2207
 Best site-webcam                   (1)  | Epoch:0 | Val Acc: 0.1081
 Best site-webcam                   (1)  | Epoch:0 | Val Acc: 0.1385
 Best site-webcam                   (1)  | Epoch:0 | Val Acc: 0.0796
 Best site-dslr                     (3)  | Epoch:0 | Val Acc: 0.1905
 Best site-dslr                     (3)  | Epoch:0 | Val Acc: 0.1294
 Best site-synthetic                (2)  | Epoch:0 | Val Acc: 0.0933
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-amazon                    (1) | Train Loss: 2.7340 | Train Acc: 0.5281
 Site-amazon                    (1) | Train Loss: 2.7208 | Train Acc: 0.5522
 Site-amazon                    (1) | Train Loss: 2.7043 | Train Acc: 0.5850
 Site-amazon                    (1) | Train Loss: 2.6658 | Train Acc: 0.5433
 Site-amazon                    (1) | Train Loss: 2.8243 | Train Acc: 0.5033
 Site-webcam                    (3) | Train Loss: 2.9383 | Train Acc: 0.4107
 Site-webcam                    (3) | Train Loss: 2.8430 | Train Acc: 0.4592
 Site-webcam                    (3) | Train Loss: 2.8868 | Train Acc: 0.3824
 Site-dslr                      (0) | Train Loss: 2.8710 | Train Acc: 0.4375
 Site-dslr                      (0) | Train Loss: 2.8520 | Train Acc: 0.3984
 Site-synthetic                 (2) | Train Loss: 3.0784 | Train Acc: 0.2054
Average Train Accuracy: 0.4550
 Site-amazon                    (1) | Val  Loss: 2.6500 | Val  Acc: 0.5932
 Site-amazon                    (1) | Val  Loss: 2.7092 | Val  Acc: 0.5281
 Site-amazon                    (1) | Val  Loss: 2.6731 | Val  Acc: 0.5564
 Site-amazon                    (1) | Val  Loss: 2.5867 | Val  Acc: 0.5650
 Site-amazon                    (1) | Val  Loss: 2.6893 | Val  Acc: 0.5318
 Site-webcam                    (3) | Val  Loss: 2.9684 | Val  Acc: 0.3784
 Site-webcam                    (3) | Val  Loss: 2.8423 | Val  Acc: 0.3077
 Site-webcam                    (3) | Val  Loss: 2.8811 | Val  Acc: 0.3540
 Site-dslr                      (0) | Val  Loss: 2.7882 | Val  Acc: 0.4524
 Site-dslr                      (0) | Val  Loss: 2.8391 | Val  Acc: 0.3647
 Site-synthetic                 (2) | Val  Loss: 3.1459 | Val  Acc: 0.1467
Average Valid Accuracy: 0.4344
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.5932
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.5281
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.5564
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.5650
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.5318
 Best site-webcam                   (3)  | Epoch:1 | Val Acc: 0.3784
 Best site-webcam                   (3)  | Epoch:1 | Val Acc: 0.3077
 Best site-webcam                   (3)  | Epoch:1 | Val Acc: 0.3540
 Best site-dslr                     (0)  | Epoch:1 | Val Acc: 0.4524
 Best site-dslr                     (0)  | Epoch:1 | Val Acc: 0.3647
 Best site-synthetic                (2)  | Epoch:1 | Val Acc: 0.1467
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[4, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-amazon                    (3) | Train Loss: 2.4044 | Train Acc: 0.6292
 Site-amazon                    (0) | Train Loss: 2.1521 | Train Acc: 0.7463
 Site-amazon                    (0) | Train Loss: 2.3538 | Train Acc: 0.7150
 Site-amazon                    (0) | Train Loss: 2.2274 | Train Acc: 0.7200
 Site-amazon                    (3) | Train Loss: 2.2842 | Train Acc: 0.6815
 Site-webcam                    (1) | Train Loss: 2.5593 | Train Acc: 0.5000
 Site-webcam                    (1) | Train Loss: 2.4670 | Train Acc: 0.6020
 Site-webcam                    (1) | Train Loss: 2.5402 | Train Acc: 0.5765
 Site-dslr                      (2) | Train Loss: 2.4587 | Train Acc: 0.6562
 Site-dslr                      (2) | Train Loss: 2.4691 | Train Acc: 0.5938
 Site-synthetic                 (0) | Train Loss: 2.8686 | Train Acc: 0.3036
Average Train Accuracy: 0.6113
 Site-amazon                    (3) | Val  Loss: 2.2438 | Val  Acc: 0.7797
 Site-amazon                    (0) | Val  Loss: 2.2385 | Val  Acc: 0.7079
 Site-amazon                    (0) | Val  Loss: 2.2242 | Val  Acc: 0.7519
 Site-amazon                    (0) | Val  Loss: 2.1476 | Val  Acc: 0.7450
 Site-amazon                    (3) | Val  Loss: 2.2731 | Val  Acc: 0.7023
 Site-webcam                    (1) | Val  Loss: 2.5056 | Val  Acc: 0.4865
 Site-webcam                    (1) | Val  Loss: 2.2718 | Val  Acc: 0.5077
 Site-webcam                    (1) | Val  Loss: 2.5092 | Val  Acc: 0.5664
 Site-dslr                      (2) | Val  Loss: 2.3795 | Val  Acc: 0.5238
 Site-dslr                      (2) | Val  Loss: 2.4026 | Val  Acc: 0.4941
 Site-synthetic                 (0) | Val  Loss: 2.9074 | Val  Acc: 0.2800
Average Valid Accuracy: 0.5950
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.7797
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.7079
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.7519
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.7450
 Best site-amazon                   (3)  | Epoch:2 | Val Acc: 0.7023
 Best site-webcam                   (1)  | Epoch:2 | Val Acc: 0.4865
 Best site-webcam                   (1)  | Epoch:2 | Val Acc: 0.5077
 Best site-webcam                   (1)  | Epoch:2 | Val Acc: 0.5664
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.5238
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.4941
 Best site-synthetic                (0)  | Epoch:2 | Val Acc: 0.2800
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 2, 5, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-amazon                    (2) | Train Loss: 2.1094 | Train Acc: 0.7528
 Site-amazon                    (2) | Train Loss: 1.8128 | Train Acc: 0.8060
 Site-amazon                    (2) | Train Loss: 1.8333 | Train Acc: 0.8050
 Site-amazon                    (2) | Train Loss: 1.8298 | Train Acc: 0.8300
 Site-amazon                    (2) | Train Loss: 1.9016 | Train Acc: 0.8151
 Site-webcam                    (3) | Train Loss: 2.2372 | Train Acc: 0.6429
 Site-webcam                    (3) | Train Loss: 2.1113 | Train Acc: 0.6939
 Site-webcam                    (3) | Train Loss: 2.2132 | Train Acc: 0.6706
 Site-dslr                      (1) | Train Loss: 2.1599 | Train Acc: 0.7188
 Site-dslr                      (1) | Train Loss: 2.1350 | Train Acc: 0.6328
 Site-synthetic                 (0) | Train Loss: 2.6739 | Train Acc: 0.3661
Average Train Accuracy: 0.7031
 Site-amazon                    (2) | Val  Loss: 1.8169 | Val  Acc: 0.8475
 Site-amazon                    (2) | Val  Loss: 1.8577 | Val  Acc: 0.7865
 Site-amazon                    (2) | Val  Loss: 1.9329 | Val  Acc: 0.8120
 Site-amazon                    (2) | Val  Loss: 1.7456 | Val  Acc: 0.8250
 Site-amazon                    (2) | Val  Loss: 1.8570 | Val  Acc: 0.8328
 Site-webcam                    (3) | Val  Loss: 2.1430 | Val  Acc: 0.5946
 Site-webcam                    (3) | Val  Loss: 2.0199 | Val  Acc: 0.5692
 Site-webcam                    (3) | Val  Loss: 2.1526 | Val  Acc: 0.6991
 Site-dslr                      (1) | Val  Loss: 2.0029 | Val  Acc: 0.6667
 Site-dslr                      (1) | Val  Loss: 2.1530 | Val  Acc: 0.5647
 Site-synthetic                 (0) | Val  Loss: 2.7427 | Val  Acc: 0.3200
Average Valid Accuracy: 0.6835
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.8475
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.7865
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.8120
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.8250
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.8328
 Best site-webcam                   (3)  | Epoch:3 | Val Acc: 0.5946
 Best site-webcam                   (3)  | Epoch:3 | Val Acc: 0.5692
 Best site-webcam                   (3)  | Epoch:3 | Val Acc: 0.6991
 Best site-dslr                     (1)  | Epoch:3 | Val Acc: 0.6667
 Best site-dslr                     (1)  | Epoch:3 | Val Acc: 0.5647
 Best site-synthetic                (0)  | Epoch:3 | Val Acc: 0.3200
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 4, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-amazon                    (3) | Train Loss: 1.6814 | Train Acc: 0.8202
 Site-amazon                    (3) | Train Loss: 1.4361 | Train Acc: 0.9104
 Site-amazon                    (3) | Train Loss: 1.5830 | Train Acc: 0.8400
 Site-amazon                    (1) | Train Loss: 1.4991 | Train Acc: 0.8900
 Site-amazon                    (1) | Train Loss: 1.4841 | Train Acc: 0.8486
 Site-webcam                    (2) | Train Loss: 1.8961 | Train Acc: 0.7500
 Site-webcam                    (2) | Train Loss: 1.8052 | Train Acc: 0.7449
 Site-webcam                    (2) | Train Loss: 1.9102 | Train Acc: 0.7118
 Site-dslr                      (0) | Train Loss: 1.8900 | Train Acc: 0.7344
 Site-dslr                      (0) | Train Loss: 1.8499 | Train Acc: 0.7109
 Site-synthetic                 (2) | Train Loss: 2.4667 | Train Acc: 0.4821
Average Train Accuracy: 0.7676
 Site-amazon                    (3) | Val  Loss: 1.4552 | Val  Acc: 0.8983
 Site-amazon                    (3) | Val  Loss: 1.6085 | Val  Acc: 0.7865
 Site-amazon                    (3) | Val  Loss: 1.6699 | Val  Acc: 0.8120
 Site-amazon                    (1) | Val  Loss: 1.4741 | Val  Acc: 0.8900
 Site-amazon                    (1) | Val  Loss: 1.5275 | Val  Acc: 0.8227
 Site-webcam                    (2) | Val  Loss: 1.8777 | Val  Acc: 0.6486
 Site-webcam                    (2) | Val  Loss: 1.6088 | Val  Acc: 0.6923
 Site-webcam                    (2) | Val  Loss: 1.9152 | Val  Acc: 0.7434
 Site-dslr                      (0) | Val  Loss: 1.7352 | Val  Acc: 0.6905
 Site-dslr                      (0) | Val  Loss: 1.8429 | Val  Acc: 0.7294
 Site-synthetic                 (2) | Val  Loss: 2.6247 | Val  Acc: 0.3200
Average Valid Accuracy: 0.7303
 Best site-amazon                   (3)  | Epoch:4 | Val Acc: 0.8983
 Best site-amazon                   (3)  | Epoch:4 | Val Acc: 0.7865
 Best site-amazon                   (3)  | Epoch:4 | Val Acc: 0.8120
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.8900
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.8227
 Best site-webcam                   (2)  | Epoch:4 | Val Acc: 0.6486
 Best site-webcam                   (2)  | Epoch:4 | Val Acc: 0.6923
 Best site-webcam                   (2)  | Epoch:4 | Val Acc: 0.7434
 Best site-dslr                     (0)  | Epoch:4 | Val Acc: 0.6905
 Best site-dslr                     (0)  | Epoch:4 | Val Acc: 0.7294
 Best site-synthetic                (2)  | Epoch:4 | Val Acc: 0.3200
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-amazon                    (0) | Train Loss: 1.4588 | Train Acc: 0.8427
 Site-amazon                    (3) | Train Loss: 1.3180 | Train Acc: 0.9104
 Site-amazon                    (3) | Train Loss: 1.3293 | Train Acc: 0.8750
 Site-amazon                    (0) | Train Loss: 1.2652 | Train Acc: 0.9000
 Site-amazon                    (3) | Train Loss: 1.1920 | Train Acc: 0.8619
 Site-webcam                    (1) | Train Loss: 1.6719 | Train Acc: 0.7321
 Site-webcam                    (1) | Train Loss: 1.6034 | Train Acc: 0.8061
 Site-webcam                    (1) | Train Loss: 1.6768 | Train Acc: 0.7765
 Site-dslr                      (2) | Train Loss: 1.6408 | Train Acc: 0.7656
 Site-dslr                      (2) | Train Loss: 1.6381 | Train Acc: 0.7656
 Site-synthetic                 (1) | Train Loss: 2.3634 | Train Acc: 0.4732
Average Train Accuracy: 0.7918
 Site-amazon                    (0) | Val  Loss: 1.2012 | Val  Acc: 0.9322
 Site-amazon                    (3) | Val  Loss: 1.3551 | Val  Acc: 0.8539
 Site-amazon                    (3) | Val  Loss: 1.4530 | Val  Acc: 0.8496
 Site-amazon                    (0) | Val  Loss: 1.1933 | Val  Acc: 0.9150
 Site-amazon                    (3) | Val  Loss: 1.2938 | Val  Acc: 0.8662
 Site-webcam                    (1) | Val  Loss: 1.6294 | Val  Acc: 0.7027
 Site-webcam                    (1) | Val  Loss: 1.2570 | Val  Acc: 0.7846
 Site-webcam                    (1) | Val  Loss: 1.6228 | Val  Acc: 0.7876
 Site-dslr                      (2) | Val  Loss: 1.5431 | Val  Acc: 0.7143
 Site-dslr                      (2) | Val  Loss: 1.6285 | Val  Acc: 0.7294
 Site-synthetic                 (1) | Val  Loss: 2.5010 | Val  Acc: 0.4400
Average Valid Accuracy: 0.7796
 Best site-amazon                   (0)  | Epoch:5 | Val Acc: 0.9322
 Best site-amazon                   (3)  | Epoch:5 | Val Acc: 0.8539
 Best site-amazon                   (3)  | Epoch:5 | Val Acc: 0.8496
 Best site-amazon                   (0)  | Epoch:5 | Val Acc: 0.9150
 Best site-amazon                   (3)  | Epoch:5 | Val Acc: 0.8662
 Best site-webcam                   (1)  | Epoch:5 | Val Acc: 0.7027
 Best site-webcam                   (1)  | Epoch:5 | Val Acc: 0.7846
 Best site-webcam                   (1)  | Epoch:5 | Val Acc: 0.7876
 Best site-dslr                     (2)  | Epoch:5 | Val Acc: 0.7143
 Best site-dslr                     (2)  | Epoch:5 | Val Acc: 0.7294
 Best site-synthetic                (1)  | Epoch:5 | Val Acc: 0.4400
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-amazon                    (0) | Train Loss: 1.2664 | Train Acc: 0.9101
 Site-amazon                    (2) | Train Loss: 0.9814 | Train Acc: 0.9104
 Site-amazon                    (0) | Train Loss: 1.1386 | Train Acc: 0.8700
 Site-amazon                    (0) | Train Loss: 1.0653 | Train Acc: 0.9067
 Site-amazon                    (0) | Train Loss: 1.1640 | Train Acc: 0.8886
 Site-webcam                    (2) | Train Loss: 1.5034 | Train Acc: 0.7679
 Site-webcam                    (2) | Train Loss: 1.3695 | Train Acc: 0.8469
 Site-webcam                    (2) | Train Loss: 1.4689 | Train Acc: 0.8000
 Site-dslr                      (1) | Train Loss: 1.3845 | Train Acc: 0.7969
 Site-dslr                      (1) | Train Loss: 1.4319 | Train Acc: 0.8047
 Site-synthetic                 (3) | Train Loss: 2.2248 | Train Acc: 0.4821
Average Train Accuracy: 0.8168
 Site-amazon                    (0) | Val  Loss: 0.9819 | Val  Acc: 0.9153
 Site-amazon                    (2) | Val  Loss: 1.1932 | Val  Acc: 0.8539
 Site-amazon                    (0) | Val  Loss: 1.2736 | Val  Acc: 0.8797
 Site-amazon                    (0) | Val  Loss: 1.0198 | Val  Acc: 0.9250
 Site-amazon                    (0) | Val  Loss: 1.1017 | Val  Acc: 0.8729
 Site-webcam                    (2) | Val  Loss: 1.3949 | Val  Acc: 0.6486
 Site-webcam                    (2) | Val  Loss: 1.0540 | Val  Acc: 0.7077
 Site-webcam                    (2) | Val  Loss: 1.4201 | Val  Acc: 0.8584
 Site-dslr                      (1) | Val  Loss: 1.3394 | Val  Acc: 0.7619
 Site-dslr                      (1) | Val  Loss: 1.4643 | Val  Acc: 0.7529
 Site-synthetic                 (3) | Val  Loss: 2.4162 | Val  Acc: 0.3867
Average Valid Accuracy: 0.7785
============ Train epoch 7 ============
cnt=[3, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-amazon                    (0) | Train Loss: 1.1904 | Train Acc: 0.8427
 Site-amazon                    (0) | Train Loss: 0.8007 | Train Acc: 0.9030
 Site-amazon                    (3) | Train Loss: 0.9204 | Train Acc: 0.8850
 Site-amazon                    (0) | Train Loss: 0.9201 | Train Acc: 0.9233
 Site-amazon                    (3) | Train Loss: 0.8846 | Train Acc: 0.9020
 Site-webcam                    (3) | Train Loss: 1.3705 | Train Acc: 0.7500
 Site-webcam                    (1) | Train Loss: 1.1664 | Train Acc: 0.8673
 Site-webcam                    (1) | Train Loss: 1.3134 | Train Acc: 0.8059
 Site-dslr                      (2) | Train Loss: 1.2348 | Train Acc: 0.8438
 Site-dslr                      (2) | Train Loss: 1.2733 | Train Acc: 0.8125
 Site-synthetic                 (1) | Train Loss: 2.1090 | Train Acc: 0.5714
Average Train Accuracy: 0.8279
 Site-amazon                    (0) | Val  Loss: 0.8662 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 1.0231 | Val  Acc: 0.8315
 Site-amazon                    (3) | Val  Loss: 1.0958 | Val  Acc: 0.8872
 Site-amazon                    (0) | Val  Loss: 0.8470 | Val  Acc: 0.9500
 Site-amazon                    (3) | Val  Loss: 0.9570 | Val  Acc: 0.8863
 Site-webcam                    (3) | Val  Loss: 1.3250 | Val  Acc: 0.7297
 Site-webcam                    (1) | Val  Loss: 0.9419 | Val  Acc: 0.7385
 Site-webcam                    (1) | Val  Loss: 1.2219 | Val  Acc: 0.8496
 Site-dslr                      (2) | Val  Loss: 1.1682 | Val  Acc: 0.8095
 Site-dslr                      (2) | Val  Loss: 1.2709 | Val  Acc: 0.7647
 Site-synthetic                 (1) | Val  Loss: 2.3348 | Val  Acc: 0.3867
Average Valid Accuracy: 0.8031
 Best site-amazon                   (0)  | Epoch:7 | Val Acc: 1.0000
 Best site-amazon                   (0)  | Epoch:7 | Val Acc: 0.8315
 Best site-amazon                   (3)  | Epoch:7 | Val Acc: 0.8872
 Best site-amazon                   (0)  | Epoch:7 | Val Acc: 0.9500
 Best site-amazon                   (3)  | Epoch:7 | Val Acc: 0.8863
 Best site-webcam                   (3)  | Epoch:7 | Val Acc: 0.7297
 Best site-webcam                   (1)  | Epoch:7 | Val Acc: 0.7385
 Best site-webcam                   (1)  | Epoch:7 | Val Acc: 0.8496
 Best site-dslr                     (2)  | Epoch:7 | Val Acc: 0.8095
 Best site-dslr                     (2)  | Epoch:7 | Val Acc: 0.7647
 Best site-synthetic                (1)  | Epoch:7 | Val Acc: 0.3867
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 4, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-amazon                    (3) | Train Loss: 0.9320 | Train Acc: 0.8989
 Site-amazon                    (0) | Train Loss: 0.8300 | Train Acc: 0.9104
 Site-amazon                    (0) | Train Loss: 0.8396 | Train Acc: 0.8900
 Site-amazon                    (3) | Train Loss: 0.8230 | Train Acc: 0.9233
 Site-amazon                    (3) | Train Loss: 0.7448 | Train Acc: 0.9065
 Site-webcam                    (2) | Train Loss: 1.1316 | Train Acc: 0.7857
 Site-webcam                    (2) | Train Loss: 1.0258 | Train Acc: 0.8469
 Site-webcam                    (2) | Train Loss: 1.1378 | Train Acc: 0.8235
 Site-dslr                      (1) | Train Loss: 1.1427 | Train Acc: 0.8438
 Site-dslr                      (1) | Train Loss: 1.1235 | Train Acc: 0.8359
 Site-synthetic                 (2) | Train Loss: 1.9818 | Train Acc: 0.5536
Average Train Accuracy: 0.8381
 Site-amazon                    (3) | Val  Loss: 0.7484 | Val  Acc: 0.9322
 Site-amazon                    (0) | Val  Loss: 0.8913 | Val  Acc: 0.8764
 Site-amazon                    (0) | Val  Loss: 0.9685 | Val  Acc: 0.8947
 Site-amazon                    (3) | Val  Loss: 0.7218 | Val  Acc: 0.9450
 Site-amazon                    (3) | Val  Loss: 0.8571 | Val  Acc: 0.8863
 Site-webcam                    (2) | Val  Loss: 1.0280 | Val  Acc: 0.8649
 Site-webcam                    (2) | Val  Loss: 0.8436 | Val  Acc: 0.8462
 Site-webcam                    (2) | Val  Loss: 1.1246 | Val  Acc: 0.8319
 Site-dslr                      (1) | Val  Loss: 1.0761 | Val  Acc: 0.8333
 Site-dslr                      (1) | Val  Loss: 1.1085 | Val  Acc: 0.8353
 Site-synthetic                 (2) | Val  Loss: 2.3511 | Val  Acc: 0.4533
Average Valid Accuracy: 0.8363
 Best site-amazon                   (3)  | Epoch:8 | Val Acc: 0.9322
 Best site-amazon                   (0)  | Epoch:8 | Val Acc: 0.8764
 Best site-amazon                   (0)  | Epoch:8 | Val Acc: 0.8947
 Best site-amazon                   (3)  | Epoch:8 | Val Acc: 0.9450
 Best site-amazon                   (3)  | Epoch:8 | Val Acc: 0.8863
 Best site-webcam                   (2)  | Epoch:8 | Val Acc: 0.8649
 Best site-webcam                   (2)  | Epoch:8 | Val Acc: 0.8462
 Best site-webcam                   (2)  | Epoch:8 | Val Acc: 0.8319
 Best site-dslr                     (1)  | Epoch:8 | Val Acc: 0.8333
 Best site-dslr                     (1)  | Epoch:8 | Val Acc: 0.8353
 Best site-synthetic                (2)  | Epoch:8 | Val Acc: 0.4533
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[4, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-amazon                    (0) | Train Loss: 0.8882 | Train Acc: 0.8989
 Site-amazon                    (0) | Train Loss: 0.6612 | Train Acc: 0.9104
 Site-amazon                    (3) | Train Loss: 0.8134 | Train Acc: 0.8950
 Site-amazon                    (0) | Train Loss: 0.6935 | Train Acc: 0.9433
 Site-amazon                    (0) | Train Loss: 0.7683 | Train Acc: 0.9020
 Site-webcam                    (1) | Train Loss: 1.1213 | Train Acc: 0.7679
 Site-webcam                    (1) | Train Loss: 0.9595 | Train Acc: 0.8673
 Site-webcam                    (1) | Train Loss: 0.9873 | Train Acc: 0.8824
 Site-dslr                      (2) | Train Loss: 0.9917 | Train Acc: 0.8906
 Site-dslr                      (2) | Train Loss: 1.0129 | Train Acc: 0.8438
 Site-synthetic                 (1) | Train Loss: 1.8257 | Train Acc: 0.5714
Average Train Accuracy: 0.8521
 Site-amazon                    (0) | Val  Loss: 0.6281 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.7754 | Val  Acc: 0.8989
 Site-amazon                    (3) | Val  Loss: 0.8666 | Val  Acc: 0.8872
 Site-amazon                    (0) | Val  Loss: 0.6391 | Val  Acc: 0.9550
 Site-amazon                    (0) | Val  Loss: 0.7652 | Val  Acc: 0.9030
 Site-webcam                    (1) | Val  Loss: 1.0320 | Val  Acc: 0.8919
 Site-webcam                    (1) | Val  Loss: 0.7816 | Val  Acc: 0.8615
 Site-webcam                    (1) | Val  Loss: 0.9552 | Val  Acc: 0.8761
 Site-dslr                      (2) | Val  Loss: 0.9410 | Val  Acc: 0.8095
 Site-dslr                      (2) | Val  Loss: 0.9241 | Val  Acc: 0.8235
 Site-synthetic                 (1) | Val  Loss: 2.1732 | Val  Acc: 0.4800
Average Valid Accuracy: 0.8533
 Best site-amazon                   (0)  | Epoch:9 | Val Acc: 1.0000
 Best site-amazon                   (0)  | Epoch:9 | Val Acc: 0.8989
 Best site-amazon                   (3)  | Epoch:9 | Val Acc: 0.8872
 Best site-amazon                   (0)  | Epoch:9 | Val Acc: 0.9550
 Best site-amazon                   (0)  | Epoch:9 | Val Acc: 0.9030
 Best site-webcam                   (1)  | Epoch:9 | Val Acc: 0.8919
 Best site-webcam                   (1)  | Epoch:9 | Val Acc: 0.8615
 Best site-webcam                   (1)  | Epoch:9 | Val Acc: 0.8761
 Best site-dslr                     (2)  | Epoch:9 | Val Acc: 0.8095
 Best site-dslr                     (2)  | Epoch:9 | Val Acc: 0.8235
 Best site-synthetic                (1)  | Epoch:9 | Val Acc: 0.4800
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-amazon                    (1) | Train Loss: 0.7593 | Train Acc: 0.8989
 Site-amazon                    (1) | Train Loss: 0.6801 | Train Acc: 0.9179
 Site-amazon                    (1) | Train Loss: 0.6598 | Train Acc: 0.9250
 Site-amazon                    (1) | Train Loss: 0.6471 | Train Acc: 0.9233
 Site-amazon                    (1) | Train Loss: 0.7351 | Train Acc: 0.9154
 Site-webcam                    (2) | Train Loss: 0.9478 | Train Acc: 0.8571
 Site-webcam                    (3) | Train Loss: 0.8576 | Train Acc: 0.9082
 Site-webcam                    (2) | Train Loss: 0.8812 | Train Acc: 0.8647
 Site-dslr                      (0) | Train Loss: 0.8962 | Train Acc: 0.8594
 Site-dslr                      (0) | Train Loss: 0.9426 | Train Acc: 0.8359
 Site-synthetic                 (3) | Train Loss: 1.7518 | Train Acc: 0.6161
Average Train Accuracy: 0.8656
 Site-amazon                    (1) | Val  Loss: 0.5667 | Val  Acc: 0.9831
 Site-amazon                    (1) | Val  Loss: 0.7269 | Val  Acc: 0.8876
 Site-amazon                    (1) | Val  Loss: 0.8008 | Val  Acc: 0.9023
 Site-amazon                    (1) | Val  Loss: 0.5816 | Val  Acc: 0.9550
 Site-amazon                    (1) | Val  Loss: 0.6848 | Val  Acc: 0.8997
 Site-webcam                    (2) | Val  Loss: 0.8945 | Val  Acc: 0.8919
 Site-webcam                    (3) | Val  Loss: 0.5963 | Val  Acc: 0.8615
 Site-webcam                    (2) | Val  Loss: 0.8843 | Val  Acc: 0.8938
 Site-dslr                      (0) | Val  Loss: 0.9310 | Val  Acc: 0.8333
 Site-dslr                      (0) | Val  Loss: 0.9277 | Val  Acc: 0.8588
 Site-synthetic                 (3) | Val  Loss: 2.0945 | Val  Acc: 0.5067
Average Valid Accuracy: 0.8612
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9831
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.8876
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9023
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.9550
 Best site-amazon                   (1)  | Epoch:10 | Val Acc: 0.8997
 Best site-webcam                   (2)  | Epoch:10 | Val Acc: 0.8919
 Best site-webcam                   (3)  | Epoch:10 | Val Acc: 0.8615
 Best site-webcam                   (2)  | Epoch:10 | Val Acc: 0.8938
 Best site-dslr                     (0)  | Epoch:10 | Val Acc: 0.8333
 Best site-dslr                     (0)  | Epoch:10 | Val Acc: 0.8588
 Best site-synthetic                (3)  | Epoch:10 | Val Acc: 0.5067
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 11 ============
cnt=[5, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-amazon                    (0) | Train Loss: 0.7833 | Train Acc: 0.8989
 Site-amazon                    (0) | Train Loss: 0.4726 | Train Acc: 0.9403
 Site-amazon                    (0) | Train Loss: 0.5554 | Train Acc: 0.9300
 Site-amazon                    (0) | Train Loss: 0.5942 | Train Acc: 0.9300
 Site-amazon                    (0) | Train Loss: 0.5662 | Train Acc: 0.9176
 Site-webcam                    (1) | Train Loss: 0.9723 | Train Acc: 0.7321
 Site-webcam                    (1) | Train Loss: 0.7479 | Train Acc: 0.9286
 Site-webcam                    (1) | Train Loss: 0.8407 | Train Acc: 0.8882
 Site-dslr                      (2) | Train Loss: 0.7941 | Train Acc: 0.8594
 Site-dslr                      (3) | Train Loss: 0.8349 | Train Acc: 0.8672
 Site-synthetic                 (1) | Train Loss: 1.6897 | Train Acc: 0.6250
Average Train Accuracy: 0.8652
 Site-amazon                    (0) | Val  Loss: 0.5553 | Val  Acc: 0.9831
 Site-amazon                    (0) | Val  Loss: 0.6677 | Val  Acc: 0.8764
 Site-amazon                    (0) | Val  Loss: 0.6494 | Val  Acc: 0.9098
 Site-amazon                    (0) | Val  Loss: 0.5703 | Val  Acc: 0.9750
 Site-amazon                    (0) | Val  Loss: 0.6025 | Val  Acc: 0.9264
 Site-webcam                    (1) | Val  Loss: 0.8713 | Val  Acc: 0.8378
 Site-webcam                    (1) | Val  Loss: 0.6325 | Val  Acc: 0.8154
 Site-webcam                    (1) | Val  Loss: 0.8144 | Val  Acc: 0.8761
 Site-dslr                      (2) | Val  Loss: 0.7693 | Val  Acc: 0.9048
 Site-dslr                      (3) | Val  Loss: 0.8705 | Val  Acc: 0.8235
 Site-synthetic                 (1) | Val  Loss: 2.1070 | Val  Acc: 0.5067
Average Valid Accuracy: 0.8577
============ Train epoch 12 ============
cnt=[3, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-amazon                    (0) | Train Loss: 0.7827 | Train Acc: 0.8876
 Site-amazon                    (0) | Train Loss: 0.6189 | Train Acc: 0.9478
 Site-amazon                    (3) | Train Loss: 0.5148 | Train Acc: 0.9450
 Site-amazon                    (3) | Train Loss: 0.5403 | Train Acc: 0.9333
 Site-amazon                    (0) | Train Loss: 0.6450 | Train Acc: 0.9243
 Site-webcam                    (2) | Train Loss: 0.8536 | Train Acc: 0.8393
 Site-webcam                    (2) | Train Loss: 0.7154 | Train Acc: 0.8878
 Site-webcam                    (2) | Train Loss: 0.7780 | Train Acc: 0.8529
 Site-dslr                      (1) | Train Loss: 0.7562 | Train Acc: 0.8750
 Site-dslr                      (1) | Train Loss: 0.7609 | Train Acc: 0.8828
 Site-synthetic                 (2) | Train Loss: 1.6327 | Train Acc: 0.5804
Average Train Accuracy: 0.8687
 Site-amazon                    (0) | Val  Loss: 0.5550 | Val  Acc: 0.9322
 Site-amazon                    (0) | Val  Loss: 0.6291 | Val  Acc: 0.8989
 Site-amazon                    (3) | Val  Loss: 0.6979 | Val  Acc: 0.8947
 Site-amazon                    (3) | Val  Loss: 0.4915 | Val  Acc: 0.9500
 Site-amazon                    (0) | Val  Loss: 0.5804 | Val  Acc: 0.9030
 Site-webcam                    (2) | Val  Loss: 0.7265 | Val  Acc: 0.8919
 Site-webcam                    (2) | Val  Loss: 0.5184 | Val  Acc: 0.8769
 Site-webcam                    (2) | Val  Loss: 0.6895 | Val  Acc: 0.9115
 Site-dslr                      (1) | Val  Loss: 0.7392 | Val  Acc: 0.8333
 Site-dslr                      (1) | Val  Loss: 0.8847 | Val  Acc: 0.8235
 Site-synthetic                 (2) | Val  Loss: 2.0557 | Val  Acc: 0.4933
Average Valid Accuracy: 0.8554
============ Train epoch 13 ============
cnt=[1, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-amazon                    (1) | Train Loss: 0.6817 | Train Acc: 0.8652
 Site-amazon                    (1) | Train Loss: 0.4646 | Train Acc: 0.9403
 Site-amazon                    (1) | Train Loss: 0.5409 | Train Acc: 0.9300
 Site-amazon                    (1) | Train Loss: 0.4856 | Train Acc: 0.9400
 Site-amazon                    (1) | Train Loss: 0.5387 | Train Acc: 0.9332
 Site-webcam                    (3) | Train Loss: 0.8390 | Train Acc: 0.8214
 Site-webcam                    (3) | Train Loss: 0.6791 | Train Acc: 0.9388
 Site-webcam                    (3) | Train Loss: 0.6427 | Train Acc: 0.9294
 Site-dslr                      (2) | Train Loss: 0.6603 | Train Acc: 0.8906
 Site-dslr                      (2) | Train Loss: 0.7463 | Train Acc: 0.8594
 Site-synthetic                 (0) | Train Loss: 1.5211 | Train Acc: 0.6429
Average Train Accuracy: 0.8810
 Site-amazon                    (1) | Val  Loss: 0.4970 | Val  Acc: 0.9492
 Site-amazon                    (1) | Val  Loss: 0.6076 | Val  Acc: 0.9213
 Site-amazon                    (1) | Val  Loss: 0.6396 | Val  Acc: 0.9173
 Site-amazon                    (1) | Val  Loss: 0.4916 | Val  Acc: 0.9500
 Site-amazon                    (1) | Val  Loss: 0.5292 | Val  Acc: 0.9231
 Site-webcam                    (3) | Val  Loss: 0.6911 | Val  Acc: 0.8378
 Site-webcam                    (3) | Val  Loss: 0.4760 | Val  Acc: 0.8615
 Site-webcam                    (3) | Val  Loss: 0.6539 | Val  Acc: 0.9115
 Site-dslr                      (2) | Val  Loss: 0.7175 | Val  Acc: 0.8333
 Site-dslr                      (2) | Val  Loss: 0.7746 | Val  Acc: 0.8706
 Site-synthetic                 (0) | Val  Loss: 1.9697 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8705
 Best site-amazon                   (1)  | Epoch:13 | Val Acc: 0.9492
 Best site-amazon                   (1)  | Epoch:13 | Val Acc: 0.9213
 Best site-amazon                   (1)  | Epoch:13 | Val Acc: 0.9173
 Best site-amazon                   (1)  | Epoch:13 | Val Acc: 0.9500
 Best site-amazon                   (1)  | Epoch:13 | Val Acc: 0.9231
 Best site-webcam                   (3)  | Epoch:13 | Val Acc: 0.8378
 Best site-webcam                   (3)  | Epoch:13 | Val Acc: 0.8615
 Best site-webcam                   (3)  | Epoch:13 | Val Acc: 0.9115
 Best site-dslr                     (2)  | Epoch:13 | Val Acc: 0.8333
 Best site-dslr                     (2)  | Epoch:13 | Val Acc: 0.8706
 Best site-synthetic                (0)  | Epoch:13 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 14 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-amazon                    (1) | Train Loss: 0.6092 | Train Acc: 0.8989
 Site-amazon                    (1) | Train Loss: 0.4859 | Train Acc: 0.9328
 Site-amazon                    (1) | Train Loss: 0.5932 | Train Acc: 0.9500
 Site-amazon                    (1) | Train Loss: 0.4958 | Train Acc: 0.9300
 Site-amazon                    (1) | Train Loss: 0.4515 | Train Acc: 0.9198
 Site-webcam                    (0) | Train Loss: 0.7680 | Train Acc: 0.8036
 Site-webcam                    (0) | Train Loss: 0.6436 | Train Acc: 0.8571
 Site-webcam                    (0) | Train Loss: 0.6453 | Train Acc: 0.9176
 Site-dslr                      (2) | Train Loss: 0.6453 | Train Acc: 0.8594
 Site-dslr                      (2) | Train Loss: 0.6754 | Train Acc: 0.8828
 Site-synthetic                 (3) | Train Loss: 1.4954 | Train Acc: 0.6518
Average Train Accuracy: 0.8731
 Site-amazon                    (1) | Val  Loss: 0.4111 | Val  Acc: 0.9661
 Site-amazon                    (1) | Val  Loss: 0.5662 | Val  Acc: 0.8764
 Site-amazon                    (1) | Val  Loss: 0.5275 | Val  Acc: 0.9023
 Site-amazon                    (1) | Val  Loss: 0.4615 | Val  Acc: 0.9500
 Site-amazon                    (1) | Val  Loss: 0.5263 | Val  Acc: 0.9097
 Site-webcam                    (0) | Val  Loss: 0.5043 | Val  Acc: 0.9459
 Site-webcam                    (0) | Val  Loss: 0.4780 | Val  Acc: 0.9077
 Site-webcam                    (0) | Val  Loss: 0.6276 | Val  Acc: 0.9115
 Site-dslr                      (2) | Val  Loss: 0.6615 | Val  Acc: 0.7857
 Site-dslr                      (2) | Val  Loss: 0.7361 | Val  Acc: 0.8353
 Site-synthetic                 (3) | Val  Loss: 2.0120 | Val  Acc: 0.5200
Average Valid Accuracy: 0.8646
============ Train epoch 15 ============
cnt=[2, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-amazon                    (1) | Train Loss: 0.6045 | Train Acc: 0.8989
 Site-amazon                    (1) | Train Loss: 0.4236 | Train Acc: 0.9403
 Site-amazon                    (1) | Train Loss: 0.5818 | Train Acc: 0.9400
 Site-amazon                    (3) | Train Loss: 0.4550 | Train Acc: 0.9400
 Site-amazon                    (3) | Train Loss: 0.6376 | Train Acc: 0.9265
 Site-webcam                    (1) | Train Loss: 0.7487 | Train Acc: 0.8036
 Site-webcam                    (2) | Train Loss: 0.6047 | Train Acc: 0.8878
 Site-webcam                    (2) | Train Loss: 0.6102 | Train Acc: 0.9118
 Site-dslr                      (0) | Train Loss: 0.5899 | Train Acc: 0.8906
 Site-dslr                      (0) | Train Loss: 0.6377 | Train Acc: 0.8828
 Site-synthetic                 (2) | Train Loss: 1.3967 | Train Acc: 0.6786
Average Train Accuracy: 0.8819
 Site-amazon                    (1) | Val  Loss: 0.4111 | Val  Acc: 0.9661
 Site-amazon                    (1) | Val  Loss: 0.5531 | Val  Acc: 0.9213
 Site-amazon                    (1) | Val  Loss: 0.5327 | Val  Acc: 0.9098
 Site-amazon                    (3) | Val  Loss: 0.4002 | Val  Acc: 0.9600
 Site-amazon                    (3) | Val  Loss: 0.5108 | Val  Acc: 0.9164
 Site-webcam                    (1) | Val  Loss: 0.5219 | Val  Acc: 0.8919
 Site-webcam                    (2) | Val  Loss: 0.4742 | Val  Acc: 0.8923
 Site-webcam                    (2) | Val  Loss: 0.5860 | Val  Acc: 0.9469
 Site-dslr                      (0) | Val  Loss: 0.5485 | Val  Acc: 0.8810
 Site-dslr                      (0) | Val  Loss: 0.7023 | Val  Acc: 0.8588
 Site-synthetic                 (2) | Val  Loss: 1.8346 | Val  Acc: 0.5467
Average Valid Accuracy: 0.8810
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.9661
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.9213
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.9098
 Best site-amazon                   (3)  | Epoch:15 | Val Acc: 0.9600
 Best site-amazon                   (3)  | Epoch:15 | Val Acc: 0.9164
 Best site-webcam                   (1)  | Epoch:15 | Val Acc: 0.8919
 Best site-webcam                   (2)  | Epoch:15 | Val Acc: 0.8923
 Best site-webcam                   (2)  | Epoch:15 | Val Acc: 0.9469
 Best site-dslr                     (0)  | Epoch:15 | Val Acc: 0.8810
 Best site-dslr                     (0)  | Epoch:15 | Val Acc: 0.8588
 Best site-synthetic                (2)  | Epoch:15 | Val Acc: 0.5467
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 16 ============
cnt=[4, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-amazon                    (0) | Train Loss: 0.5349 | Train Acc: 0.8764
 Site-amazon                    (3) | Train Loss: 0.5022 | Train Acc: 0.9254
 Site-amazon                    (0) | Train Loss: 0.4573 | Train Acc: 0.9200
 Site-amazon                    (0) | Train Loss: 0.4132 | Train Acc: 0.9500
 Site-amazon                    (0) | Train Loss: 0.4496 | Train Acc: 0.9265
 Site-webcam                    (3) | Train Loss: 0.7003 | Train Acc: 0.8393
 Site-webcam                    (2) | Train Loss: 0.5549 | Train Acc: 0.8980
 Site-webcam                    (2) | Train Loss: 0.5655 | Train Acc: 0.9059
 Site-dslr                      (1) | Train Loss: 0.5470 | Train Acc: 0.8750
 Site-dslr                      (1) | Train Loss: 0.6609 | Train Acc: 0.8672
 Site-synthetic                 (2) | Train Loss: 1.3817 | Train Acc: 0.6786
Average Train Accuracy: 0.8784
 Site-amazon                    (0) | Val  Loss: 0.3305 | Val  Acc: 0.9831
 Site-amazon                    (3) | Val  Loss: 0.4343 | Val  Acc: 0.9101
 Site-amazon                    (0) | Val  Loss: 0.4544 | Val  Acc: 0.9248
 Site-amazon                    (0) | Val  Loss: 0.3816 | Val  Acc: 0.9650
 Site-amazon                    (0) | Val  Loss: 0.4520 | Val  Acc: 0.9331
 Site-webcam                    (3) | Val  Loss: 0.5114 | Val  Acc: 0.9459
 Site-webcam                    (2) | Val  Loss: 0.3849 | Val  Acc: 0.9231
 Site-webcam                    (2) | Val  Loss: 0.6335 | Val  Acc: 0.8938
 Site-dslr                      (1) | Val  Loss: 0.5571 | Val  Acc: 0.9048
 Site-dslr                      (1) | Val  Loss: 0.7134 | Val  Acc: 0.8706
 Site-synthetic                 (2) | Val  Loss: 1.8148 | Val  Acc: 0.6133
Average Valid Accuracy: 0.8971
 Best site-amazon                   (0)  | Epoch:16 | Val Acc: 0.9831
 Best site-amazon                   (3)  | Epoch:16 | Val Acc: 0.9101
 Best site-amazon                   (0)  | Epoch:16 | Val Acc: 0.9248
 Best site-amazon                   (0)  | Epoch:16 | Val Acc: 0.9650
 Best site-amazon                   (0)  | Epoch:16 | Val Acc: 0.9331
 Best site-webcam                   (3)  | Epoch:16 | Val Acc: 0.9459
 Best site-webcam                   (2)  | Epoch:16 | Val Acc: 0.9231
 Best site-webcam                   (2)  | Epoch:16 | Val Acc: 0.8938
 Best site-dslr                     (1)  | Epoch:16 | Val Acc: 0.9048
 Best site-dslr                     (1)  | Epoch:16 | Val Acc: 0.8706
 Best site-synthetic                (2)  | Epoch:16 | Val Acc: 0.6133
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 17 ============
cnt=[4, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-amazon                    (3) | Train Loss: 0.5257 | Train Acc: 0.8652
 Site-amazon                    (0) | Train Loss: 0.3127 | Train Acc: 0.9254
 Site-amazon                    (0) | Train Loss: 0.4268 | Train Acc: 0.9450
 Site-amazon                    (0) | Train Loss: 0.3797 | Train Acc: 0.9667
 Site-amazon                    (0) | Train Loss: 0.4197 | Train Acc: 0.9421
 Site-webcam                    (1) | Train Loss: 0.6899 | Train Acc: 0.8571
 Site-webcam                    (1) | Train Loss: 0.5272 | Train Acc: 0.9082
 Site-webcam                    (1) | Train Loss: 0.5257 | Train Acc: 0.9118
 Site-dslr                      (2) | Train Loss: 0.5406 | Train Acc: 0.9062
 Site-dslr                      (2) | Train Loss: 0.5369 | Train Acc: 0.9141
 Site-synthetic                 (1) | Train Loss: 1.3444 | Train Acc: 0.6518
Average Train Accuracy: 0.8903
 Site-amazon                    (3) | Val  Loss: 0.3485 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.4559 | Val  Acc: 0.9326
 Site-amazon                    (0) | Val  Loss: 0.4764 | Val  Acc: 0.9173
 Site-amazon                    (0) | Val  Loss: 0.3499 | Val  Acc: 0.9600
 Site-amazon                    (0) | Val  Loss: 0.4227 | Val  Acc: 0.9365
 Site-webcam                    (1) | Val  Loss: 0.4826 | Val  Acc: 0.9459
 Site-webcam                    (1) | Val  Loss: 0.3694 | Val  Acc: 0.9846
 Site-webcam                    (1) | Val  Loss: 0.5589 | Val  Acc: 0.8938
 Site-dslr                      (2) | Val  Loss: 0.5162 | Val  Acc: 0.9048
 Site-dslr                      (2) | Val  Loss: 0.6514 | Val  Acc: 0.8588
 Site-synthetic                 (1) | Val  Loss: 1.9225 | Val  Acc: 0.5600
Average Valid Accuracy: 0.8995
 Best site-amazon                   (3)  | Epoch:17 | Val Acc: 1.0000
 Best site-amazon                   (0)  | Epoch:17 | Val Acc: 0.9326
 Best site-amazon                   (0)  | Epoch:17 | Val Acc: 0.9173
 Best site-amazon                   (0)  | Epoch:17 | Val Acc: 0.9600
 Best site-amazon                   (0)  | Epoch:17 | Val Acc: 0.9365
 Best site-webcam                   (1)  | Epoch:17 | Val Acc: 0.9459
 Best site-webcam                   (1)  | Epoch:17 | Val Acc: 0.9846
 Best site-webcam                   (1)  | Epoch:17 | Val Acc: 0.8938
 Best site-dslr                     (2)  | Epoch:17 | Val Acc: 0.9048
 Best site-dslr                     (2)  | Epoch:17 | Val Acc: 0.8588
 Best site-synthetic                (1)  | Epoch:17 | Val Acc: 0.5600
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-amazon                    (1) | Train Loss: 0.4701 | Train Acc: 0.9101
 Site-amazon                    (1) | Train Loss: 0.3460 | Train Acc: 0.9254
 Site-amazon                    (1) | Train Loss: 0.4221 | Train Acc: 0.9400
 Site-amazon                    (1) | Train Loss: 0.3822 | Train Acc: 0.9567
 Site-amazon                    (1) | Train Loss: 0.4367 | Train Acc: 0.9287
 Site-webcam                    (3) | Train Loss: 0.5968 | Train Acc: 0.8393
 Site-webcam                    (3) | Train Loss: 0.4656 | Train Acc: 0.9388
 Site-webcam                    (3) | Train Loss: 0.5425 | Train Acc: 0.8941
 Site-dslr                      (2) | Train Loss: 0.4993 | Train Acc: 0.8906
 Site-dslr                      (2) | Train Loss: 0.5888 | Train Acc: 0.9141
 Site-synthetic                 (0) | Train Loss: 1.2888 | Train Acc: 0.6964
Average Train Accuracy: 0.8940
 Site-amazon                    (1) | Val  Loss: 0.3561 | Val  Acc: 0.9492
 Site-amazon                    (1) | Val  Loss: 0.4348 | Val  Acc: 0.8989
 Site-amazon                    (1) | Val  Loss: 0.4667 | Val  Acc: 0.9323
 Site-amazon                    (1) | Val  Loss: 0.3513 | Val  Acc: 0.9750
 Site-amazon                    (1) | Val  Loss: 0.4040 | Val  Acc: 0.9398
 Site-webcam                    (3) | Val  Loss: 0.4801 | Val  Acc: 0.8919
 Site-webcam                    (3) | Val  Loss: 0.3405 | Val  Acc: 0.9077
 Site-webcam                    (3) | Val  Loss: 0.5756 | Val  Acc: 0.9027
 Site-dslr                      (2) | Val  Loss: 0.5087 | Val  Acc: 0.8810
 Site-dslr                      (2) | Val  Loss: 0.6305 | Val  Acc: 0.8706
 Site-synthetic                 (0) | Val  Loss: 1.7539 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8923
============ Train epoch 19 ============
cnt=[3, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-amazon                    (3) | Train Loss: 0.4914 | Train Acc: 0.8989
 Site-amazon                    (1) | Train Loss: 0.2833 | Train Acc: 0.9254
 Site-amazon                    (1) | Train Loss: 0.3297 | Train Acc: 0.9400
 Site-amazon                    (3) | Train Loss: 0.3911 | Train Acc: 0.9500
 Site-amazon                    (3) | Train Loss: 0.3698 | Train Acc: 0.9220
 Site-webcam                    (2) | Train Loss: 0.6390 | Train Acc: 0.8571
 Site-webcam                    (2) | Train Loss: 0.4750 | Train Acc: 0.9082
 Site-webcam                    (2) | Train Loss: 0.4919 | Train Acc: 0.9294
 Site-dslr                      (0) | Train Loss: 0.4848 | Train Acc: 0.9062
 Site-dslr                      (0) | Train Loss: 0.5186 | Train Acc: 0.9297
 Site-synthetic                 (0) | Train Loss: 1.1908 | Train Acc: 0.7232
Average Train Accuracy: 0.8991
 Site-amazon                    (3) | Val  Loss: 0.2879 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 0.4742 | Val  Acc: 0.8876
 Site-amazon                    (1) | Val  Loss: 0.4147 | Val  Acc: 0.9323
 Site-amazon                    (3) | Val  Loss: 0.3645 | Val  Acc: 0.9650
 Site-amazon                    (3) | Val  Loss: 0.4047 | Val  Acc: 0.9431
 Site-webcam                    (2) | Val  Loss: 0.5188 | Val  Acc: 0.9189
 Site-webcam                    (2) | Val  Loss: 0.3625 | Val  Acc: 0.9077
 Site-webcam                    (2) | Val  Loss: 0.4642 | Val  Acc: 0.9558
 Site-dslr                      (0) | Val  Loss: 0.5056 | Val  Acc: 0.9048
 Site-dslr                      (0) | Val  Loss: 0.6209 | Val  Acc: 0.8824
 Site-synthetic                 (0) | Val  Loss: 1.8700 | Val  Acc: 0.5867
Average Valid Accuracy: 0.8986
============ Train epoch 20 ============
cnt=[2, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-amazon                    (1) | Train Loss: 0.4740 | Train Acc: 0.9101
 Site-amazon                    (1) | Train Loss: 0.3326 | Train Acc: 0.9179
 Site-amazon                    (1) | Train Loss: 0.3833 | Train Acc: 0.9500
 Site-amazon                    (1) | Train Loss: 0.3633 | Train Acc: 0.9533
 Site-amazon                    (1) | Train Loss: 0.5254 | Train Acc: 0.9443
 Site-webcam                    (3) | Train Loss: 0.6778 | Train Acc: 0.8214
 Site-webcam                    (0) | Train Loss: 0.4952 | Train Acc: 0.9388
 Site-webcam                    (3) | Train Loss: 0.4442 | Train Acc: 0.9353
 Site-dslr                      (2) | Train Loss: 0.4433 | Train Acc: 0.8750
 Site-dslr                      (2) | Train Loss: 0.5509 | Train Acc: 0.8672
 Site-synthetic                 (0) | Train Loss: 1.1970 | Train Acc: 0.7411
Average Train Accuracy: 0.8959
 Site-amazon                    (1) | Val  Loss: 0.3021 | Val  Acc: 0.9831
 Site-amazon                    (1) | Val  Loss: 0.4442 | Val  Acc: 0.9101
 Site-amazon                    (1) | Val  Loss: 0.3809 | Val  Acc: 0.9248
 Site-amazon                    (1) | Val  Loss: 0.2963 | Val  Acc: 0.9600
 Site-amazon                    (1) | Val  Loss: 0.3881 | Val  Acc: 0.9398
 Site-webcam                    (3) | Val  Loss: 0.3895 | Val  Acc: 1.0000
 Site-webcam                    (0) | Val  Loss: 0.2543 | Val  Acc: 0.9538
 Site-webcam                    (3) | Val  Loss: 0.4614 | Val  Acc: 0.9292
 Site-dslr                      (2) | Val  Loss: 0.4959 | Val  Acc: 0.9286
 Site-dslr                      (2) | Val  Loss: 0.6134 | Val  Acc: 0.8941
 Site-synthetic                 (0) | Val  Loss: 1.7760 | Val  Acc: 0.6533
Average Valid Accuracy: 0.9161
 Best site-amazon                   (1)  | Epoch:20 | Val Acc: 0.9831
 Best site-amazon                   (1)  | Epoch:20 | Val Acc: 0.9101
 Best site-amazon                   (1)  | Epoch:20 | Val Acc: 0.9248
 Best site-amazon                   (1)  | Epoch:20 | Val Acc: 0.9600
 Best site-amazon                   (1)  | Epoch:20 | Val Acc: 0.9398
 Best site-webcam                   (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-webcam                   (0)  | Epoch:20 | Val Acc: 0.9538
 Best site-webcam                   (3)  | Epoch:20 | Val Acc: 0.9292
 Best site-dslr                     (2)  | Epoch:20 | Val Acc: 0.9286
 Best site-dslr                     (2)  | Epoch:20 | Val Acc: 0.8941
 Best site-synthetic                (0)  | Epoch:20 | Val Acc: 0.6533
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-amazon                    (0) | Train Loss: 0.4365 | Train Acc: 0.9101
 Site-amazon                    (3) | Train Loss: 0.3175 | Train Acc: 0.9254
 Site-amazon                    (3) | Train Loss: 0.3399 | Train Acc: 0.9200
 Site-amazon                    (3) | Train Loss: 0.3248 | Train Acc: 0.9467
 Site-amazon                    (0) | Train Loss: 0.3292 | Train Acc: 0.9443
 Site-webcam                    (1) | Train Loss: 0.5431 | Train Acc: 0.8571
 Site-webcam                    (1) | Train Loss: 0.4423 | Train Acc: 0.9184
 Site-webcam                    (1) | Train Loss: 0.4756 | Train Acc: 0.9294
 Site-dslr                      (2) | Train Loss: 0.4398 | Train Acc: 0.8906
 Site-dslr                      (2) | Train Loss: 0.5272 | Train Acc: 0.8984
 Site-synthetic                 (1) | Train Loss: 1.1848 | Train Acc: 0.7143
Average Train Accuracy: 0.8959
 Site-amazon                    (0) | Val  Loss: 0.3085 | Val  Acc: 0.9831
 Site-amazon                    (3) | Val  Loss: 0.4165 | Val  Acc: 0.9326
 Site-amazon                    (3) | Val  Loss: 0.3906 | Val  Acc: 0.9023
 Site-amazon                    (3) | Val  Loss: 0.3274 | Val  Acc: 0.9550
 Site-amazon                    (0) | Val  Loss: 0.3575 | Val  Acc: 0.9465
 Site-webcam                    (1) | Val  Loss: 0.5406 | Val  Acc: 0.8649
 Site-webcam                    (1) | Val  Loss: 0.3021 | Val  Acc: 0.9231
 Site-webcam                    (1) | Val  Loss: 0.5121 | Val  Acc: 0.9027
 Site-dslr                      (2) | Val  Loss: 0.4213 | Val  Acc: 0.9286
 Site-dslr                      (2) | Val  Loss: 0.6136 | Val  Acc: 0.8588
 Site-synthetic                 (1) | Val  Loss: 1.7107 | Val  Acc: 0.6800
Average Valid Accuracy: 0.8979
============ Train epoch 22 ============
cnt=[2, 4, 4, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-amazon                    (3) | Train Loss: 0.5224 | Train Acc: 0.9213
 Site-amazon                    (1) | Train Loss: 0.5340 | Train Acc: 0.9328
 Site-amazon                    (1) | Train Loss: 0.3592 | Train Acc: 0.9550
 Site-amazon                    (1) | Train Loss: 0.3167 | Train Acc: 0.9567
 Site-amazon                    (1) | Train Loss: 0.3078 | Train Acc: 0.9443
 Site-webcam                    (2) | Train Loss: 0.5321 | Train Acc: 0.8571
 Site-webcam                    (2) | Train Loss: 0.4243 | Train Acc: 0.9388
 Site-webcam                    (2) | Train Loss: 0.4122 | Train Acc: 0.9235
 Site-dslr                      (0) | Train Loss: 0.4285 | Train Acc: 0.9375
 Site-dslr                      (0) | Train Loss: 0.5213 | Train Acc: 0.8906
 Site-synthetic                 (2) | Train Loss: 1.1401 | Train Acc: 0.6964
Average Train Accuracy: 0.9049
 Site-amazon                    (3) | Val  Loss: 0.2506 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 0.3922 | Val  Acc: 0.9438
 Site-amazon                    (1) | Val  Loss: 0.3596 | Val  Acc: 0.9098
 Site-amazon                    (1) | Val  Loss: 0.2888 | Val  Acc: 0.9650
 Site-amazon                    (1) | Val  Loss: 0.3748 | Val  Acc: 0.9298
 Site-webcam                    (2) | Val  Loss: 0.3284 | Val  Acc: 0.9730
 Site-webcam                    (2) | Val  Loss: 0.2346 | Val  Acc: 0.9846
 Site-webcam                    (2) | Val  Loss: 0.4473 | Val  Acc: 0.9115
 Site-dslr                      (0) | Val  Loss: 0.4995 | Val  Acc: 0.8810
 Site-dslr                      (0) | Val  Loss: 0.5802 | Val  Acc: 0.9176
 Site-synthetic                 (2) | Val  Loss: 1.7101 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9166
 Best site-amazon                   (3)  | Epoch:22 | Val Acc: 1.0000
 Best site-amazon                   (1)  | Epoch:22 | Val Acc: 0.9438
 Best site-amazon                   (1)  | Epoch:22 | Val Acc: 0.9098
 Best site-amazon                   (1)  | Epoch:22 | Val Acc: 0.9650
 Best site-amazon                   (1)  | Epoch:22 | Val Acc: 0.9298
 Best site-webcam                   (2)  | Epoch:22 | Val Acc: 0.9730
 Best site-webcam                   (2)  | Epoch:22 | Val Acc: 0.9846
 Best site-webcam                   (2)  | Epoch:22 | Val Acc: 0.9115
 Best site-dslr                     (0)  | Epoch:22 | Val Acc: 0.8810
 Best site-dslr                     (0)  | Epoch:22 | Val Acc: 0.9176
 Best site-synthetic                (2)  | Epoch:22 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 23 ============
cnt=[3, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-amazon                    (1) | Train Loss: 0.4870 | Train Acc: 0.9213
 Site-amazon                    (1) | Train Loss: 0.4264 | Train Acc: 0.9552
 Site-amazon                    (1) | Train Loss: 0.4527 | Train Acc: 0.9350
 Site-amazon                    (1) | Train Loss: 0.3203 | Train Acc: 0.9500
 Site-amazon                    (1) | Train Loss: 0.3003 | Train Acc: 0.9421
 Site-webcam                    (0) | Train Loss: 0.5108 | Train Acc: 0.8750
 Site-webcam                    (0) | Train Loss: 0.3674 | Train Acc: 0.9490
 Site-webcam                    (0) | Train Loss: 0.4193 | Train Acc: 0.9353
 Site-dslr                      (3) | Train Loss: 0.4138 | Train Acc: 0.9219
 Site-dslr                      (3) | Train Loss: 0.4994 | Train Acc: 0.8672
 Site-synthetic                 (2) | Train Loss: 1.1357 | Train Acc: 0.7054
Average Train Accuracy: 0.9052
 Site-amazon                    (1) | Val  Loss: 0.2576 | Val  Acc: 0.9831
 Site-amazon                    (1) | Val  Loss: 0.3884 | Val  Acc: 0.9101
 Site-amazon                    (1) | Val  Loss: 0.3247 | Val  Acc: 0.9248
 Site-amazon                    (1) | Val  Loss: 0.3325 | Val  Acc: 0.9400
 Site-amazon                    (1) | Val  Loss: 0.3807 | Val  Acc: 0.9264
 Site-webcam                    (0) | Val  Loss: 0.3628 | Val  Acc: 0.9459
 Site-webcam                    (0) | Val  Loss: 0.2846 | Val  Acc: 0.9077
 Site-webcam                    (0) | Val  Loss: 0.4341 | Val  Acc: 0.9204
 Site-dslr                      (3) | Val  Loss: 0.4966 | Val  Acc: 0.9048
 Site-dslr                      (3) | Val  Loss: 0.5575 | Val  Acc: 0.9176
 Site-synthetic                 (2) | Val  Loss: 1.5952 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9043
============ Train epoch 24 ============
cnt=[4, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-amazon                    (3) | Train Loss: 0.4051 | Train Acc: 0.9101
 Site-amazon                    (0) | Train Loss: 0.3752 | Train Acc: 0.9478
 Site-amazon                    (0) | Train Loss: 0.4230 | Train Acc: 0.9300
 Site-amazon                    (0) | Train Loss: 0.2976 | Train Acc: 0.9667
 Site-amazon                    (0) | Train Loss: 0.2749 | Train Acc: 0.9488
 Site-webcam                    (2) | Train Loss: 0.4707 | Train Acc: 0.9107
 Site-webcam                    (2) | Train Loss: 0.3583 | Train Acc: 0.9286
 Site-webcam                    (2) | Train Loss: 0.3777 | Train Acc: 0.9353
 Site-dslr                      (1) | Train Loss: 0.3634 | Train Acc: 0.9375
 Site-dslr                      (1) | Train Loss: 0.4541 | Train Acc: 0.9062
 Site-synthetic                 (2) | Train Loss: 1.1174 | Train Acc: 0.7054
Average Train Accuracy: 0.9115
 Site-amazon                    (3) | Val  Loss: 0.2284 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.3836 | Val  Acc: 0.9213
 Site-amazon                    (0) | Val  Loss: 0.4303 | Val  Acc: 0.9248
 Site-amazon                    (0) | Val  Loss: 0.2805 | Val  Acc: 0.9650
 Site-amazon                    (0) | Val  Loss: 0.3333 | Val  Acc: 0.9298
 Site-webcam                    (2) | Val  Loss: 0.3400 | Val  Acc: 0.9459
 Site-webcam                    (2) | Val  Loss: 0.2612 | Val  Acc: 0.9692
 Site-webcam                    (2) | Val  Loss: 0.3928 | Val  Acc: 0.9558
 Site-dslr                      (1) | Val  Loss: 0.6100 | Val  Acc: 0.8810
 Site-dslr                      (1) | Val  Loss: 0.5625 | Val  Acc: 0.9059
 Site-synthetic                 (2) | Val  Loss: 1.7078 | Val  Acc: 0.6400
Average Valid Accuracy: 0.9126
============ Train epoch 25 ============
cnt=[4, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-amazon                    (3) | Train Loss: 0.4750 | Train Acc: 0.8876
 Site-amazon                    (3) | Train Loss: 0.3031 | Train Acc: 0.9403
 Site-amazon                    (0) | Train Loss: 0.3274 | Train Acc: 0.9650
 Site-amazon                    (0) | Train Loss: 0.2913 | Train Acc: 0.9567
 Site-amazon                    (3) | Train Loss: 0.2911 | Train Acc: 0.9399
 Site-webcam                    (2) | Train Loss: 0.5625 | Train Acc: 0.8214
 Site-webcam                    (0) | Train Loss: 0.4358 | Train Acc: 0.9184
 Site-webcam                    (0) | Train Loss: 0.3973 | Train Acc: 0.9412
 Site-dslr                      (2) | Train Loss: 0.3824 | Train Acc: 0.9219
 Site-dslr                      (1) | Train Loss: 0.4496 | Train Acc: 0.8828
 Site-synthetic                 (2) | Train Loss: 1.0684 | Train Acc: 0.7143
Average Train Accuracy: 0.8990
 Site-amazon                    (3) | Val  Loss: 0.2444 | Val  Acc: 1.0000
 Site-amazon                    (3) | Val  Loss: 0.3362 | Val  Acc: 0.9213
 Site-amazon                    (0) | Val  Loss: 0.5046 | Val  Acc: 0.9173
 Site-amazon                    (0) | Val  Loss: 0.2754 | Val  Acc: 0.9700
 Site-amazon                    (3) | Val  Loss: 0.3757 | Val  Acc: 0.9264
 Site-webcam                    (2) | Val  Loss: 0.3154 | Val  Acc: 0.9730
 Site-webcam                    (0) | Val  Loss: 0.2597 | Val  Acc: 0.9385
 Site-webcam                    (0) | Val  Loss: 0.4082 | Val  Acc: 0.9381
 Site-dslr                      (2) | Val  Loss: 0.4529 | Val  Acc: 0.8810
 Site-dslr                      (1) | Val  Loss: 0.5398 | Val  Acc: 0.8824
 Site-synthetic                 (2) | Val  Loss: 1.6687 | Val  Acc: 0.6267
Average Valid Accuracy: 0.9068
============ Train epoch 26 ============
cnt=[4, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-amazon                    (3) | Train Loss: 0.3862 | Train Acc: 0.9326
 Site-amazon                    (1) | Train Loss: 0.2636 | Train Acc: 0.9328
 Site-amazon                    (1) | Train Loss: 0.3066 | Train Acc: 0.9600
 Site-amazon                    (1) | Train Loss: 0.2870 | Train Acc: 0.9567
 Site-amazon                    (3) | Train Loss: 0.2647 | Train Acc: 0.9488
 Site-webcam                    (0) | Train Loss: 0.5272 | Train Acc: 0.8750
 Site-webcam                    (0) | Train Loss: 0.3351 | Train Acc: 0.9490
 Site-webcam                    (0) | Train Loss: 0.4047 | Train Acc: 0.9353
 Site-dslr                      (2) | Train Loss: 0.4203 | Train Acc: 0.9219
 Site-dslr                      (2) | Train Loss: 0.4316 | Train Acc: 0.9219
 Site-synthetic                 (0) | Train Loss: 1.0127 | Train Acc: 0.7321
Average Train Accuracy: 0.9151
 Site-amazon                    (3) | Val  Loss: 0.3326 | Val  Acc: 0.9322
 Site-amazon                    (1) | Val  Loss: 0.3730 | Val  Acc: 0.9213
 Site-amazon                    (1) | Val  Loss: 0.4377 | Val  Acc: 0.9323
 Site-amazon                    (1) | Val  Loss: 0.2464 | Val  Acc: 0.9800
 Site-amazon                    (3) | Val  Loss: 0.3456 | Val  Acc: 0.9331
 Site-webcam                    (0) | Val  Loss: 0.3487 | Val  Acc: 1.0000
 Site-webcam                    (0) | Val  Loss: 0.2631 | Val  Acc: 0.9538
 Site-webcam                    (0) | Val  Loss: 0.4004 | Val  Acc: 0.9204
 Site-dslr                      (2) | Val  Loss: 0.3102 | Val  Acc: 0.9524
 Site-dslr                      (2) | Val  Loss: 0.5211 | Val  Acc: 0.9059
 Site-synthetic                 (0) | Val  Loss: 1.6397 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9180
 Best site-amazon                   (3)  | Epoch:26 | Val Acc: 0.9322
 Best site-amazon                   (1)  | Epoch:26 | Val Acc: 0.9213
 Best site-amazon                   (1)  | Epoch:26 | Val Acc: 0.9323
 Best site-amazon                   (1)  | Epoch:26 | Val Acc: 0.9800
 Best site-amazon                   (3)  | Epoch:26 | Val Acc: 0.9331
 Best site-webcam                   (0)  | Epoch:26 | Val Acc: 1.0000
 Best site-webcam                   (0)  | Epoch:26 | Val Acc: 0.9538
 Best site-webcam                   (0)  | Epoch:26 | Val Acc: 0.9204
 Best site-dslr                     (2)  | Epoch:26 | Val Acc: 0.9524
 Best site-dslr                     (2)  | Epoch:26 | Val Acc: 0.9059
 Best site-synthetic                (0)  | Epoch:26 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 27 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-amazon                    (0) | Train Loss: 0.3520 | Train Acc: 0.9101
 Site-amazon                    (0) | Train Loss: 0.2771 | Train Acc: 0.9478
 Site-amazon                    (0) | Train Loss: 0.3060 | Train Acc: 0.9400
 Site-amazon                    (0) | Train Loss: 0.2799 | Train Acc: 0.9533
 Site-amazon                    (0) | Train Loss: 0.3130 | Train Acc: 0.9354
 Site-webcam                    (2) | Train Loss: 0.4477 | Train Acc: 0.8750
 Site-webcam                    (2) | Train Loss: 0.3607 | Train Acc: 0.9388
 Site-webcam                    (2) | Train Loss: 0.3890 | Train Acc: 0.9294
 Site-dslr                      (1) | Train Loss: 0.3882 | Train Acc: 0.9219
 Site-dslr                      (3) | Train Loss: 0.4327 | Train Acc: 0.9141
 Site-synthetic                 (1) | Train Loss: 0.9810 | Train Acc: 0.7589
Average Train Accuracy: 0.9113
 Site-amazon                    (0) | Val  Loss: 0.2350 | Val  Acc: 0.9831
 Site-amazon                    (0) | Val  Loss: 0.3207 | Val  Acc: 0.9326
 Site-amazon                    (0) | Val  Loss: 0.3187 | Val  Acc: 0.9398
 Site-amazon                    (0) | Val  Loss: 0.2918 | Val  Acc: 0.9350
 Site-amazon                    (0) | Val  Loss: 0.3390 | Val  Acc: 0.9431
 Site-webcam                    (2) | Val  Loss: 0.3375 | Val  Acc: 0.9189
 Site-webcam                    (2) | Val  Loss: 0.1965 | Val  Acc: 0.9231
 Site-webcam                    (2) | Val  Loss: 0.3592 | Val  Acc: 0.9292
 Site-dslr                      (1) | Val  Loss: 0.4655 | Val  Acc: 0.9286
 Site-dslr                      (3) | Val  Loss: 0.4862 | Val  Acc: 0.8941
 Site-synthetic                 (1) | Val  Loss: 1.7572 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9086
============ Train epoch 28 ============
cnt=[1, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-amazon                    (0) | Train Loss: 0.3653 | Train Acc: 0.9101
 Site-amazon                    (3) | Train Loss: 0.2392 | Train Acc: 0.9328
 Site-amazon                    (3) | Train Loss: 0.3037 | Train Acc: 0.9300
 Site-amazon                    (3) | Train Loss: 0.2376 | Train Acc: 0.9733
 Site-amazon                    (3) | Train Loss: 0.2674 | Train Acc: 0.9399
 Site-webcam                    (1) | Train Loss: 0.4166 | Train Acc: 0.9107
 Site-webcam                    (1) | Train Loss: 0.3450 | Train Acc: 0.9694
 Site-webcam                    (1) | Train Loss: 0.3323 | Train Acc: 0.9412
 Site-dslr                      (2) | Train Loss: 0.3285 | Train Acc: 0.9062
 Site-dslr                      (2) | Train Loss: 0.4085 | Train Acc: 0.9297
 Site-synthetic                 (1) | Train Loss: 1.0440 | Train Acc: 0.7411
Average Train Accuracy: 0.9168
 Site-amazon                    (0) | Val  Loss: 0.2635 | Val  Acc: 0.9661
 Site-amazon                    (3) | Val  Loss: 0.3120 | Val  Acc: 0.9326
 Site-amazon                    (3) | Val  Loss: 0.3855 | Val  Acc: 0.9173
 Site-amazon                    (3) | Val  Loss: 0.2453 | Val  Acc: 0.9650
 Site-amazon                    (3) | Val  Loss: 0.3107 | Val  Acc: 0.9365
 Site-webcam                    (1) | Val  Loss: 0.2761 | Val  Acc: 0.9459
 Site-webcam                    (1) | Val  Loss: 0.2349 | Val  Acc: 0.9231
 Site-webcam                    (1) | Val  Loss: 0.3499 | Val  Acc: 0.9558
 Site-dslr                      (2) | Val  Loss: 0.4063 | Val  Acc: 0.9524
 Site-dslr                      (2) | Val  Loss: 0.4085 | Val  Acc: 0.9294
 Site-synthetic                 (1) | Val  Loss: 1.6445 | Val  Acc: 0.6533
Average Valid Accuracy: 0.9161
============ Train epoch 29 ============
cnt=[3, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-amazon                    (2) | Train Loss: 0.3316 | Train Acc: 0.9101
 Site-amazon                    (0) | Train Loss: 0.4153 | Train Acc: 0.9403
 Site-amazon                    (0) | Train Loss: 0.2727 | Train Acc: 0.9450
 Site-amazon                    (2) | Train Loss: 0.2417 | Train Acc: 0.9567
 Site-amazon                    (2) | Train Loss: 0.2652 | Train Acc: 0.9510
 Site-webcam                    (0) | Train Loss: 0.5135 | Train Acc: 0.8393
 Site-webcam                    (1) | Train Loss: 0.2958 | Train Acc: 0.9694
 Site-webcam                    (1) | Train Loss: 0.3713 | Train Acc: 0.9471
 Site-dslr                      (1) | Train Loss: 0.3715 | Train Acc: 0.9375
 Site-dslr                      (3) | Train Loss: 0.4317 | Train Acc: 0.9375
 Site-synthetic                 (1) | Train Loss: 0.9720 | Train Acc: 0.7411
Average Train Accuracy: 0.9159
 Site-amazon                    (2) | Val  Loss: 0.2376 | Val  Acc: 0.9831
 Site-amazon                    (0) | Val  Loss: 0.3048 | Val  Acc: 0.9326
 Site-amazon                    (0) | Val  Loss: 0.3714 | Val  Acc: 0.9549
 Site-amazon                    (2) | Val  Loss: 0.2442 | Val  Acc: 0.9550
 Site-amazon                    (2) | Val  Loss: 0.3312 | Val  Acc: 0.9331
 Site-webcam                    (0) | Val  Loss: 0.2736 | Val  Acc: 0.9730
 Site-webcam                    (1) | Val  Loss: 0.2382 | Val  Acc: 0.9231
 Site-webcam                    (1) | Val  Loss: 0.3032 | Val  Acc: 0.9558
 Site-dslr                      (1) | Val  Loss: 0.3491 | Val  Acc: 0.9524
 Site-dslr                      (3) | Val  Loss: 0.4646 | Val  Acc: 0.9529
 Site-synthetic                 (1) | Val  Loss: 1.6055 | Val  Acc: 0.6400
Average Valid Accuracy: 0.9233
 Best site-amazon                   (2)  | Epoch:29 | Val Acc: 0.9831
 Best site-amazon                   (0)  | Epoch:29 | Val Acc: 0.9326
 Best site-amazon                   (0)  | Epoch:29 | Val Acc: 0.9549
 Best site-amazon                   (2)  | Epoch:29 | Val Acc: 0.9550
 Best site-amazon                   (2)  | Epoch:29 | Val Acc: 0.9331
 Best site-webcam                   (0)  | Epoch:29 | Val Acc: 0.9730
 Best site-webcam                   (1)  | Epoch:29 | Val Acc: 0.9231
 Best site-webcam                   (1)  | Epoch:29 | Val Acc: 0.9558
 Best site-dslr                     (1)  | Epoch:29 | Val Acc: 0.9524
 Best site-dslr                     (3)  | Epoch:29 | Val Acc: 0.9529
 Best site-synthetic                (1)  | Epoch:29 | Val Acc: 0.6400
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 30 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-amazon                    (1) | Train Loss: 0.3857 | Train Acc: 0.9326
 Site-amazon                    (1) | Train Loss: 0.2251 | Train Acc: 0.9552
 Site-amazon                    (1) | Train Loss: 0.2858 | Train Acc: 0.9450
 Site-amazon                    (1) | Train Loss: 0.2810 | Train Acc: 0.9500
 Site-amazon                    (1) | Train Loss: 0.3091 | Train Acc: 0.9443
 Site-webcam                    (2) | Train Loss: 0.4471 | Train Acc: 0.8929
 Site-webcam                    (2) | Train Loss: 0.3387 | Train Acc: 0.9286
 Site-webcam                    (2) | Train Loss: 0.3411 | Train Acc: 0.9471
 Site-dslr                      (0) | Train Loss: 0.3221 | Train Acc: 0.9219
 Site-dslr                      (0) | Train Loss: 0.3703 | Train Acc: 0.9375
 Site-synthetic                 (3) | Train Loss: 0.9124 | Train Acc: 0.7589
Average Train Accuracy: 0.9194
 Site-amazon                    (1) | Val  Loss: 0.2369 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 0.3174 | Val  Acc: 0.9438
 Site-amazon                    (1) | Val  Loss: 0.3413 | Val  Acc: 0.9398
 Site-amazon                    (1) | Val  Loss: 0.2578 | Val  Acc: 0.9550
 Site-amazon                    (1) | Val  Loss: 0.3127 | Val  Acc: 0.9465
 Site-webcam                    (2) | Val  Loss: 0.2634 | Val  Acc: 0.9730
 Site-webcam                    (2) | Val  Loss: 0.2240 | Val  Acc: 0.9385
 Site-webcam                    (2) | Val  Loss: 0.3286 | Val  Acc: 0.9381
 Site-dslr                      (0) | Val  Loss: 0.4192 | Val  Acc: 0.8571
 Site-dslr                      (0) | Val  Loss: 0.4701 | Val  Acc: 0.9412
 Site-synthetic                 (3) | Val  Loss: 1.3816 | Val  Acc: 0.6800
Average Valid Accuracy: 0.9194
============ Train epoch 31 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-amazon                    (1) | Train Loss: 0.3152 | Train Acc: 0.9551
 Site-amazon                    (1) | Train Loss: 0.2435 | Train Acc: 0.9478
 Site-amazon                    (1) | Train Loss: 0.3240 | Train Acc: 0.9400
 Site-amazon                    (1) | Train Loss: 0.2461 | Train Acc: 0.9733
 Site-amazon                    (1) | Train Loss: 0.2525 | Train Acc: 0.9599
 Site-webcam                    (2) | Train Loss: 0.4239 | Train Acc: 0.9107
 Site-webcam                    (2) | Train Loss: 0.3334 | Train Acc: 0.9286
 Site-webcam                    (2) | Train Loss: 0.3888 | Train Acc: 0.9176
 Site-dslr                      (3) | Train Loss: 0.3347 | Train Acc: 0.9219
 Site-dslr                      (3) | Train Loss: 0.3946 | Train Acc: 0.9375
 Site-synthetic                 (0) | Train Loss: 0.8707 | Train Acc: 0.7768
Average Train Accuracy: 0.9245
 Site-amazon                    (1) | Val  Loss: 0.2401 | Val  Acc: 0.9661
 Site-amazon                    (1) | Val  Loss: 0.3121 | Val  Acc: 0.9551
 Site-amazon                    (1) | Val  Loss: 0.3109 | Val  Acc: 0.9323
 Site-amazon                    (1) | Val  Loss: 0.2310 | Val  Acc: 0.9700
 Site-amazon                    (1) | Val  Loss: 0.3105 | Val  Acc: 0.9498
 Site-webcam                    (2) | Val  Loss: 0.3020 | Val  Acc: 0.9730
 Site-webcam                    (2) | Val  Loss: 0.2001 | Val  Acc: 0.9385
 Site-webcam                    (2) | Val  Loss: 0.3339 | Val  Acc: 0.9558
 Site-dslr                      (3) | Val  Loss: 0.4076 | Val  Acc: 0.9762
 Site-dslr                      (3) | Val  Loss: 0.4140 | Val  Acc: 0.9294
 Site-synthetic                 (0) | Val  Loss: 1.4711 | Val  Acc: 0.7200
Average Valid Accuracy: 0.9333
 Best site-amazon                   (1)  | Epoch:31 | Val Acc: 0.9661
 Best site-amazon                   (1)  | Epoch:31 | Val Acc: 0.9551
 Best site-amazon                   (1)  | Epoch:31 | Val Acc: 0.9323
 Best site-amazon                   (1)  | Epoch:31 | Val Acc: 0.9700
 Best site-amazon                   (1)  | Epoch:31 | Val Acc: 0.9498
 Best site-webcam                   (2)  | Epoch:31 | Val Acc: 0.9730
 Best site-webcam                   (2)  | Epoch:31 | Val Acc: 0.9385
 Best site-webcam                   (2)  | Epoch:31 | Val Acc: 0.9558
 Best site-dslr                     (3)  | Epoch:31 | Val Acc: 0.9762
 Best site-dslr                     (3)  | Epoch:31 | Val Acc: 0.9294
 Best site-synthetic                (0)  | Epoch:31 | Val Acc: 0.7200
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 32 ============
cnt=[4, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-amazon                    (2) | Train Loss: 0.3579 | Train Acc: 0.9213
 Site-amazon                    (0) | Train Loss: 0.2213 | Train Acc: 0.9328
 Site-amazon                    (0) | Train Loss: 0.2945 | Train Acc: 0.9500
 Site-amazon                    (0) | Train Loss: 0.2367 | Train Acc: 0.9500
 Site-amazon                    (0) | Train Loss: 0.4593 | Train Acc: 0.9465
 Site-webcam                    (3) | Train Loss: 0.4134 | Train Acc: 0.8750
 Site-webcam                    (3) | Train Loss: 0.3751 | Train Acc: 0.9184
 Site-webcam                    (3) | Train Loss: 0.3221 | Train Acc: 0.9412
 Site-dslr                      (1) | Train Loss: 0.3332 | Train Acc: 0.9219
 Site-dslr                      (1) | Train Loss: 0.3668 | Train Acc: 0.9297
 Site-synthetic                 (3) | Train Loss: 0.8580 | Train Acc: 0.7500
Average Train Accuracy: 0.9124
 Site-amazon                    (2) | Val  Loss: 0.1708 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.3047 | Val  Acc: 0.8989
 Site-amazon                    (0) | Val  Loss: 0.3643 | Val  Acc: 0.9323
 Site-amazon                    (0) | Val  Loss: 0.2542 | Val  Acc: 0.9750
 Site-amazon                    (0) | Val  Loss: 0.3086 | Val  Acc: 0.9465
 Site-webcam                    (3) | Val  Loss: 0.2218 | Val  Acc: 1.0000
 Site-webcam                    (3) | Val  Loss: 0.1961 | Val  Acc: 0.9077
 Site-webcam                    (3) | Val  Loss: 0.3182 | Val  Acc: 0.9381
 Site-dslr                      (1) | Val  Loss: 0.3807 | Val  Acc: 0.9048
 Site-dslr                      (1) | Val  Loss: 0.5041 | Val  Acc: 0.9412
 Site-synthetic                 (3) | Val  Loss: 1.4860 | Val  Acc: 0.6800
Average Valid Accuracy: 0.9204
============ Train epoch 33 ============
cnt=[4, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-amazon                    (0) | Train Loss: 0.3580 | Train Acc: 0.9213
 Site-amazon                    (0) | Train Loss: 0.2648 | Train Acc: 0.9403
 Site-amazon                    (3) | Train Loss: 0.2298 | Train Acc: 0.9650
 Site-amazon                    (0) | Train Loss: 0.2259 | Train Acc: 0.9767
 Site-amazon                    (0) | Train Loss: 0.2570 | Train Acc: 0.9399
 Site-webcam                    (3) | Train Loss: 0.4260 | Train Acc: 0.8750
 Site-webcam                    (1) | Train Loss: 0.2722 | Train Acc: 0.9388
 Site-webcam                    (1) | Train Loss: 0.3027 | Train Acc: 0.9529
 Site-dslr                      (2) | Train Loss: 0.3166 | Train Acc: 0.9375
 Site-dslr                      (2) | Train Loss: 0.3638 | Train Acc: 0.9609
 Site-synthetic                 (2) | Train Loss: 0.9174 | Train Acc: 0.7679
Average Train Accuracy: 0.9251
 Site-amazon                    (0) | Val  Loss: 0.1576 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.2906 | Val  Acc: 0.9326
 Site-amazon                    (3) | Val  Loss: 0.3152 | Val  Acc: 0.9248
 Site-amazon                    (0) | Val  Loss: 0.2226 | Val  Acc: 0.9750
 Site-amazon                    (0) | Val  Loss: 0.3139 | Val  Acc: 0.9465
 Site-webcam                    (3) | Val  Loss: 0.2541 | Val  Acc: 0.9459
 Site-webcam                    (1) | Val  Loss: 0.2175 | Val  Acc: 0.9538
 Site-webcam                    (1) | Val  Loss: 0.2907 | Val  Acc: 0.9469
 Site-dslr                      (2) | Val  Loss: 0.3026 | Val  Acc: 0.9524
 Site-dslr                      (2) | Val  Loss: 0.4643 | Val  Acc: 0.9294
 Site-synthetic                 (2) | Val  Loss: 1.5382 | Val  Acc: 0.7067
Average Valid Accuracy: 0.9285
============ Train epoch 34 ============
cnt=[3, 3, 3, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-amazon                    (3) | Train Loss: 0.3440 | Train Acc: 0.9213
 Site-amazon                    (0) | Train Loss: 0.3377 | Train Acc: 0.9478
 Site-amazon                    (0) | Train Loss: 0.2912 | Train Acc: 0.9300
 Site-amazon                    (0) | Train Loss: 0.2156 | Train Acc: 0.9767
 Site-amazon                    (3) | Train Loss: 0.2478 | Train Acc: 0.9488
 Site-webcam                    (2) | Train Loss: 0.3647 | Train Acc: 0.8929
 Site-webcam                    (2) | Train Loss: 0.2802 | Train Acc: 0.9796
 Site-webcam                    (2) | Train Loss: 0.3292 | Train Acc: 0.9647
 Site-dslr                      (1) | Train Loss: 0.3252 | Train Acc: 0.9375
 Site-dslr                      (1) | Train Loss: 0.3476 | Train Acc: 0.9141
 Site-synthetic                 (1) | Train Loss: 0.8262 | Train Acc: 0.8304
Average Train Accuracy: 0.9312
 Site-amazon                    (3) | Val  Loss: 0.2229 | Val  Acc: 0.9661
 Site-amazon                    (0) | Val  Loss: 0.2912 | Val  Acc: 0.9326
 Site-amazon                    (0) | Val  Loss: 0.3973 | Val  Acc: 0.9173
 Site-amazon                    (0) | Val  Loss: 0.2195 | Val  Acc: 0.9550
 Site-amazon                    (3) | Val  Loss: 0.3073 | Val  Acc: 0.9431
 Site-webcam                    (2) | Val  Loss: 0.2952 | Val  Acc: 0.8919
 Site-webcam                    (2) | Val  Loss: 0.1988 | Val  Acc: 0.9538
 Site-webcam                    (2) | Val  Loss: 0.3092 | Val  Acc: 0.9469
 Site-dslr                      (1) | Val  Loss: 0.2965 | Val  Acc: 0.9524
 Site-dslr                      (1) | Val  Loss: 0.4353 | Val  Acc: 0.9059
 Site-synthetic                 (1) | Val  Loss: 1.6521 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9120
============ Train epoch 35 ============
cnt=[6, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-amazon                    (0) | Train Loss: 0.3922 | Train Acc: 0.8989
 Site-amazon                    (0) | Train Loss: 0.1912 | Train Acc: 0.9403
 Site-amazon                    (0) | Train Loss: 0.2334 | Train Acc: 0.9500
 Site-amazon                    (0) | Train Loss: 0.2331 | Train Acc: 0.9633
 Site-amazon                    (0) | Train Loss: 0.2323 | Train Acc: 0.9421
 Site-webcam                    (0) | Train Loss: 0.4033 | Train Acc: 0.9286
 Site-webcam                    (2) | Train Loss: 0.2998 | Train Acc: 0.9286
 Site-webcam                    (2) | Train Loss: 0.2927 | Train Acc: 0.9588
 Site-dslr                      (1) | Train Loss: 0.2714 | Train Acc: 0.9688
 Site-dslr                      (1) | Train Loss: 0.3544 | Train Acc: 0.9375
 Site-synthetic                 (3) | Train Loss: 0.8264 | Train Acc: 0.7679
Average Train Accuracy: 0.9259
 Site-amazon                    (0) | Val  Loss: 0.2229 | Val  Acc: 0.9661
 Site-amazon                    (0) | Val  Loss: 0.3027 | Val  Acc: 0.9326
 Site-amazon                    (0) | Val  Loss: 0.2938 | Val  Acc: 0.9398
 Site-amazon                    (0) | Val  Loss: 0.2410 | Val  Acc: 0.9500
 Site-amazon                    (0) | Val  Loss: 0.2844 | Val  Acc: 0.9599
 Site-webcam                    (0) | Val  Loss: 0.2691 | Val  Acc: 0.9459
 Site-webcam                    (2) | Val  Loss: 0.1930 | Val  Acc: 0.9231
 Site-webcam                    (2) | Val  Loss: 0.2850 | Val  Acc: 0.9558
 Site-dslr                      (1) | Val  Loss: 0.3929 | Val  Acc: 0.9048
 Site-dslr                      (1) | Val  Loss: 0.3172 | Val  Acc: 0.9294
 Site-synthetic                 (3) | Val  Loss: 1.5559 | Val  Acc: 0.6800
Average Valid Accuracy: 0.9170
============ Train epoch 36 ============
cnt=[1, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-amazon                    (1) | Train Loss: 0.3783 | Train Acc: 0.9101
 Site-amazon                    (1) | Train Loss: 0.3394 | Train Acc: 0.9478
 Site-amazon                    (1) | Train Loss: 0.2984 | Train Acc: 0.9450
 Site-amazon                    (1) | Train Loss: 0.2276 | Train Acc: 0.9600
 Site-amazon                    (1) | Train Loss: 0.2315 | Train Acc: 0.9555
 Site-webcam                    (3) | Train Loss: 0.3100 | Train Acc: 0.9107
 Site-webcam                    (3) | Train Loss: 0.3071 | Train Acc: 0.9694
 Site-webcam                    (3) | Train Loss: 0.3181 | Train Acc: 0.9471
 Site-dslr                      (2) | Train Loss: 0.3368 | Train Acc: 0.9219
 Site-dslr                      (2) | Train Loss: 0.3944 | Train Acc: 0.8906
 Site-synthetic                 (0) | Train Loss: 0.7696 | Train Acc: 0.7768
Average Train Accuracy: 0.9213
 Site-amazon                    (1) | Val  Loss: 0.2193 | Val  Acc: 0.9661
 Site-amazon                    (1) | Val  Loss: 0.2675 | Val  Acc: 0.9213
 Site-amazon                    (1) | Val  Loss: 0.2520 | Val  Acc: 0.9474
 Site-amazon                    (1) | Val  Loss: 0.2044 | Val  Acc: 0.9650
 Site-amazon                    (1) | Val  Loss: 0.2761 | Val  Acc: 0.9465
 Site-webcam                    (3) | Val  Loss: 0.2525 | Val  Acc: 0.9459
 Site-webcam                    (3) | Val  Loss: 0.2296 | Val  Acc: 0.9231
 Site-webcam                    (3) | Val  Loss: 0.3627 | Val  Acc: 0.9204
 Site-dslr                      (2) | Val  Loss: 0.2821 | Val  Acc: 0.9524
 Site-dslr                      (2) | Val  Loss: 0.3801 | Val  Acc: 0.9294
 Site-synthetic                 (0) | Val  Loss: 1.4027 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9167
============ Train epoch 37 ============
cnt=[4, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-amazon                    (0) | Train Loss: 0.3989 | Train Acc: 0.8989
 Site-amazon                    (0) | Train Loss: 0.2109 | Train Acc: 0.9478
 Site-amazon                    (2) | Train Loss: 0.2887 | Train Acc: 0.9600
 Site-amazon                    (0) | Train Loss: 0.2213 | Train Acc: 0.9700
 Site-amazon                    (0) | Train Loss: 0.2118 | Train Acc: 0.9532
 Site-webcam                    (2) | Train Loss: 0.3778 | Train Acc: 0.9107
 Site-webcam                    (2) | Train Loss: 0.2820 | Train Acc: 0.9490
 Site-webcam                    (2) | Train Loss: 0.3104 | Train Acc: 0.9529
 Site-dslr                      (1) | Train Loss: 0.2741 | Train Acc: 0.9531
 Site-dslr                      (1) | Train Loss: 0.3846 | Train Acc: 0.9297
 Site-synthetic                 (3) | Train Loss: 0.7078 | Train Acc: 0.8036
Average Train Accuracy: 0.9299
 Site-amazon                    (0) | Val  Loss: 0.1737 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.2404 | Val  Acc: 0.9326
 Site-amazon                    (2) | Val  Loss: 0.3074 | Val  Acc: 0.9023
 Site-amazon                    (0) | Val  Loss: 0.2125 | Val  Acc: 0.9700
 Site-amazon                    (0) | Val  Loss: 0.2734 | Val  Acc: 0.9365
 Site-webcam                    (2) | Val  Loss: 0.2406 | Val  Acc: 0.9730
 Site-webcam                    (2) | Val  Loss: 0.1770 | Val  Acc: 0.9692
 Site-webcam                    (2) | Val  Loss: 0.2896 | Val  Acc: 0.9646
 Site-dslr                      (1) | Val  Loss: 0.3504 | Val  Acc: 0.9524
 Site-dslr                      (1) | Val  Loss: 0.4254 | Val  Acc: 0.9059
 Site-synthetic                 (3) | Val  Loss: 1.4366 | Val  Acc: 0.7333
Average Valid Accuracy: 0.9309
============ Train epoch 38 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-amazon                    (1) | Train Loss: 0.4278 | Train Acc: 0.9326
 Site-amazon                    (1) | Train Loss: 0.2809 | Train Acc: 0.9627
 Site-amazon                    (1) | Train Loss: 0.2560 | Train Acc: 0.9450
 Site-amazon                    (1) | Train Loss: 0.2415 | Train Acc: 0.9533
 Site-amazon                    (1) | Train Loss: 0.2884 | Train Acc: 0.9532
 Site-webcam                    (2) | Train Loss: 0.3924 | Train Acc: 0.9107
 Site-webcam                    (2) | Train Loss: 0.3033 | Train Acc: 0.9490
 Site-webcam                    (2) | Train Loss: 0.2932 | Train Acc: 0.9588
 Site-dslr                      (0) | Train Loss: 0.2523 | Train Acc: 0.9375
 Site-dslr                      (0) | Train Loss: 0.3310 | Train Acc: 0.9375
 Site-synthetic                 (3) | Train Loss: 0.7686 | Train Acc: 0.8393
Average Train Accuracy: 0.9345
 Site-amazon                    (1) | Val  Loss: 0.1834 | Val  Acc: 0.9831
 Site-amazon                    (1) | Val  Loss: 0.2498 | Val  Acc: 0.9663
 Site-amazon                    (1) | Val  Loss: 0.2253 | Val  Acc: 0.9624
 Site-amazon                    (1) | Val  Loss: 0.2273 | Val  Acc: 0.9600
 Site-amazon                    (1) | Val  Loss: 0.2914 | Val  Acc: 0.9465
 Site-webcam                    (2) | Val  Loss: 0.2798 | Val  Acc: 0.9730
 Site-webcam                    (2) | Val  Loss: 0.1884 | Val  Acc: 0.9385
 Site-webcam                    (2) | Val  Loss: 0.3159 | Val  Acc: 0.9469
 Site-dslr                      (0) | Val  Loss: 0.2994 | Val  Acc: 1.0000
 Site-dslr                      (0) | Val  Loss: 0.3814 | Val  Acc: 0.9412
 Site-synthetic                 (3) | Val  Loss: 1.3393 | Val  Acc: 0.7200
Average Valid Accuracy: 0.9398
 Best site-amazon                   (1)  | Epoch:38 | Val Acc: 0.9831
 Best site-amazon                   (1)  | Epoch:38 | Val Acc: 0.9663
 Best site-amazon                   (1)  | Epoch:38 | Val Acc: 0.9624
 Best site-amazon                   (1)  | Epoch:38 | Val Acc: 0.9600
 Best site-amazon                   (1)  | Epoch:38 | Val Acc: 0.9465
 Best site-webcam                   (2)  | Epoch:38 | Val Acc: 0.9730
 Best site-webcam                   (2)  | Epoch:38 | Val Acc: 0.9385
 Best site-webcam                   (2)  | Epoch:38 | Val Acc: 0.9469
 Best site-dslr                     (0)  | Epoch:38 | Val Acc: 1.0000
 Best site-dslr                     (0)  | Epoch:38 | Val Acc: 0.9412
 Best site-synthetic                (3)  | Epoch:38 | Val Acc: 0.7200
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 39 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-amazon                    (0) | Train Loss: 0.4066 | Train Acc: 0.9101
 Site-amazon                    (0) | Train Loss: 0.2768 | Train Acc: 0.9328
 Site-amazon                    (0) | Train Loss: 0.2337 | Train Acc: 0.9450
 Site-amazon                    (0) | Train Loss: 0.2127 | Train Acc: 0.9567
 Site-amazon                    (0) | Train Loss: 0.2016 | Train Acc: 0.9644
 Site-webcam                    (1) | Train Loss: 0.4056 | Train Acc: 0.8929
 Site-webcam                    (1) | Train Loss: 0.2338 | Train Acc: 0.9694
 Site-webcam                    (1) | Train Loss: 0.3121 | Train Acc: 0.9412
 Site-dslr                      (2) | Train Loss: 0.2748 | Train Acc: 0.9219
 Site-dslr                      (2) | Train Loss: 0.3106 | Train Acc: 0.9453
 Site-synthetic                 (3) | Train Loss: 0.7253 | Train Acc: 0.8393
Average Train Accuracy: 0.9290
 Site-amazon                    (0) | Val  Loss: 0.1757 | Val  Acc: 0.9831
 Site-amazon                    (0) | Val  Loss: 0.2932 | Val  Acc: 0.8876
 Site-amazon                    (0) | Val  Loss: 0.2730 | Val  Acc: 0.9474
 Site-amazon                    (0) | Val  Loss: 0.1725 | Val  Acc: 0.9550
 Site-amazon                    (0) | Val  Loss: 0.2653 | Val  Acc: 0.9498
 Site-webcam                    (1) | Val  Loss: 0.2047 | Val  Acc: 0.9730
 Site-webcam                    (1) | Val  Loss: 0.2080 | Val  Acc: 0.9385
 Site-webcam                    (1) | Val  Loss: 0.2598 | Val  Acc: 0.9558
 Site-dslr                      (2) | Val  Loss: 0.3457 | Val  Acc: 0.9762
 Site-dslr                      (2) | Val  Loss: 0.4264 | Val  Acc: 0.8941
 Site-synthetic                 (3) | Val  Loss: 1.4718 | Val  Acc: 0.6800
Average Valid Accuracy: 0.9219
============ Train epoch 40 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-amazon                    (1) | Train Loss: 0.2959 | Train Acc: 0.9551
 Site-amazon                    (1) | Train Loss: 0.2104 | Train Acc: 0.9478
 Site-amazon                    (1) | Train Loss: 0.3591 | Train Acc: 0.9500
 Site-amazon                    (1) | Train Loss: 0.2141 | Train Acc: 0.9700
 Site-amazon                    (1) | Train Loss: 0.2937 | Train Acc: 0.9465
 Site-webcam                    (0) | Train Loss: 0.3747 | Train Acc: 0.9286
 Site-webcam                    (0) | Train Loss: 0.2867 | Train Acc: 0.9592
 Site-webcam                    (0) | Train Loss: 0.2785 | Train Acc: 0.9706
 Site-dslr                      (2) | Train Loss: 0.3107 | Train Acc: 0.9375
 Site-dslr                      (2) | Train Loss: 0.4269 | Train Acc: 0.9141
 Site-synthetic                 (3) | Train Loss: 0.6988 | Train Acc: 0.8125
Average Train Accuracy: 0.9356
 Site-amazon                    (1) | Val  Loss: 0.1405 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 0.2610 | Val  Acc: 0.9438
 Site-amazon                    (1) | Val  Loss: 0.2174 | Val  Acc: 0.9474
 Site-amazon                    (1) | Val  Loss: 0.1922 | Val  Acc: 0.9700
 Site-amazon                    (1) | Val  Loss: 0.2842 | Val  Acc: 0.9331
 Site-webcam                    (0) | Val  Loss: 0.2298 | Val  Acc: 0.9730
 Site-webcam                    (0) | Val  Loss: 0.1936 | Val  Acc: 0.9538
 Site-webcam                    (0) | Val  Loss: 0.2787 | Val  Acc: 0.9823
 Site-dslr                      (2) | Val  Loss: 0.2346 | Val  Acc: 0.9762
 Site-dslr                      (2) | Val  Loss: 0.3439 | Val  Acc: 0.9647
 Site-synthetic                 (3) | Val  Loss: 1.3612 | Val  Acc: 0.7467
Average Valid Accuracy: 0.9446
 Best site-amazon                   (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-amazon                   (1)  | Epoch:40 | Val Acc: 0.9438
 Best site-amazon                   (1)  | Epoch:40 | Val Acc: 0.9474
 Best site-amazon                   (1)  | Epoch:40 | Val Acc: 0.9700
 Best site-amazon                   (1)  | Epoch:40 | Val Acc: 0.9331
 Best site-webcam                   (0)  | Epoch:40 | Val Acc: 0.9730
 Best site-webcam                   (0)  | Epoch:40 | Val Acc: 0.9538
 Best site-webcam                   (0)  | Epoch:40 | Val Acc: 0.9823
 Best site-dslr                     (2)  | Epoch:40 | Val Acc: 0.9762
 Best site-dslr                     (2)  | Epoch:40 | Val Acc: 0.9647
 Best site-synthetic                (3)  | Epoch:40 | Val Acc: 0.7467
 Test site-amazon                    (1)| Epoch:40 | Test Acc: 0.9464
 Test site-webcam                    (0)| Epoch:40 | Test Acc: 0.9323
 Test site-dslr                      (2)| Epoch:40 | Test Acc: 0.9259
 Test site-synthetic                 (3)| Epoch:40 | Test Acc: 0.6559
amazon: 0.9464, webcam: 0.9323, dslr: 0.9259, synthetic: 0.6559, 
Average Test Accuracy(group): 0.8651, Average Test Accuracy(individual): 0.9124,
domain std=0.1210, cluster std=0.1210, individual std=0.0815, 
Average Test Accuracy: 0.8651
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 41 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-amazon                    (0) | Train Loss: 0.4434 | Train Acc: 0.8989
 Site-amazon                    (0) | Train Loss: 0.1677 | Train Acc: 0.9627
 Site-amazon                    (0) | Train Loss: 0.2325 | Train Acc: 0.9400
 Site-amazon                    (0) | Train Loss: 0.1973 | Train Acc: 0.9700
 Site-amazon                    (0) | Train Loss: 0.1867 | Train Acc: 0.9688
 Site-webcam                    (2) | Train Loss: 0.3744 | Train Acc: 0.8750
 Site-webcam                    (2) | Train Loss: 0.2789 | Train Acc: 0.9796
 Site-webcam                    (2) | Train Loss: 0.2800 | Train Acc: 0.9529
 Site-dslr                      (1) | Train Loss: 0.2782 | Train Acc: 0.9219
 Site-dslr                      (1) | Train Loss: 0.3595 | Train Acc: 0.9141
 Site-synthetic                 (3) | Train Loss: 0.6850 | Train Acc: 0.8571
Average Train Accuracy: 0.9310
 Site-amazon                    (0) | Val  Loss: 0.1657 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.2847 | Val  Acc: 0.9326
 Site-amazon                    (0) | Val  Loss: 0.1956 | Val  Acc: 0.9474
 Site-amazon                    (0) | Val  Loss: 0.1878 | Val  Acc: 0.9700
 Site-amazon                    (0) | Val  Loss: 0.2520 | Val  Acc: 0.9465
 Site-webcam                    (2) | Val  Loss: 0.2420 | Val  Acc: 0.9730
 Site-webcam                    (2) | Val  Loss: 0.1765 | Val  Acc: 0.9538
 Site-webcam                    (2) | Val  Loss: 0.2586 | Val  Acc: 0.9558
 Site-dslr                      (1) | Val  Loss: 0.3291 | Val  Acc: 0.9524
 Site-dslr                      (1) | Val  Loss: 0.3644 | Val  Acc: 0.9294
 Site-synthetic                 (3) | Val  Loss: 1.4340 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9298
 Test site-amazon                    (0)| Epoch:40 | Test Acc: 0.9487
 Test site-webcam                    (2)| Epoch:40 | Test Acc: 0.9323
 Test site-dslr                      (1)| Epoch:40 | Test Acc: 0.9321
 Test site-synthetic                 (3)| Epoch:40 | Test Acc: 0.6516
amazon: 0.9487, webcam: 0.9323, dslr: 0.9321, synthetic: 0.6516, 
Average Test Accuracy(group): 0.8662, Average Test Accuracy(individual): 0.9142,
domain std=0.1241, cluster std=0.1241, individual std=0.0834, 
Average Test Accuracy: 0.8662
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 42 ============
cnt=[6, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-amazon                    (0) | Train Loss: 0.2814 | Train Acc: 0.9213
 Site-amazon                    (0) | Train Loss: 0.1904 | Train Acc: 0.9627
 Site-amazon                    (0) | Train Loss: 0.2870 | Train Acc: 0.9400
 Site-amazon                    (0) | Train Loss: 0.1903 | Train Acc: 0.9800
 Site-amazon                    (0) | Train Loss: 0.2173 | Train Acc: 0.9555
 Site-webcam                    (0) | Train Loss: 0.3489 | Train Acc: 0.9107
 Site-webcam                    (1) | Train Loss: 0.2913 | Train Acc: 0.9592
 Site-webcam                    (1) | Train Loss: 0.2439 | Train Acc: 0.9588
 Site-dslr                      (3) | Train Loss: 0.2463 | Train Acc: 0.9844
 Site-dslr                      (3) | Train Loss: 0.3091 | Train Acc: 0.9609
 Site-synthetic                 (2) | Train Loss: 0.6113 | Train Acc: 0.8929
Average Train Accuracy: 0.9479
 Site-amazon                    (0) | Val  Loss: 0.1587 | Val  Acc: 0.9661
 Site-amazon                    (0) | Val  Loss: 0.2562 | Val  Acc: 0.9551
 Site-amazon                    (0) | Val  Loss: 0.2628 | Val  Acc: 0.9474
 Site-amazon                    (0) | Val  Loss: 0.1656 | Val  Acc: 0.9850
 Site-amazon                    (0) | Val  Loss: 0.2475 | Val  Acc: 0.9632
 Site-webcam                    (0) | Val  Loss: 0.2829 | Val  Acc: 0.9189
 Site-webcam                    (1) | Val  Loss: 0.1658 | Val  Acc: 0.9385
 Site-webcam                    (1) | Val  Loss: 0.2693 | Val  Acc: 0.9646
 Site-dslr                      (3) | Val  Loss: 0.3361 | Val  Acc: 0.9524
 Site-dslr                      (3) | Val  Loss: 0.3662 | Val  Acc: 0.9176
 Site-synthetic                 (2) | Val  Loss: 1.4583 | Val  Acc: 0.7067
Average Valid Accuracy: 0.9287
 Test site-amazon                    (0)| Epoch:41 | Test Acc: 0.9452
 Test site-webcam                    (0)| Epoch:41 | Test Acc: 0.9323
 Test site-dslr                      (3)| Epoch:41 | Test Acc: 0.9383
 Test site-synthetic                 (2)| Epoch:41 | Test Acc: 0.6570
amazon: 0.9452, webcam: 0.9323, dslr: 0.9383, synthetic: 0.6570, 
Average Test Accuracy(group): 0.8682, Average Test Accuracy(individual): 0.9142,
domain std=0.1220, cluster std=0.1217, individual std=0.0815, 
Average Test Accuracy: 0.8682
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 43 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-amazon                    (0) | Train Loss: 0.2786 | Train Acc: 0.9213
 Site-amazon                    (0) | Train Loss: 0.3147 | Train Acc: 0.9627
 Site-amazon                    (0) | Train Loss: 0.2171 | Train Acc: 0.9650
 Site-amazon                    (0) | Train Loss: 0.1904 | Train Acc: 0.9667
 Site-amazon                    (0) | Train Loss: 0.1860 | Train Acc: 0.9644
 Site-webcam                    (2) | Train Loss: 0.3566 | Train Acc: 0.9107
 Site-webcam                    (2) | Train Loss: 0.2630 | Train Acc: 0.9694
 Site-webcam                    (2) | Train Loss: 0.2569 | Train Acc: 0.9765
 Site-dslr                      (1) | Train Loss: 0.2618 | Train Acc: 0.9531
 Site-dslr                      (1) | Train Loss: 0.3262 | Train Acc: 0.9453
 Site-synthetic                 (3) | Train Loss: 0.6514 | Train Acc: 0.8214
Average Train Accuracy: 0.9415
 Site-amazon                    (0) | Val  Loss: 0.1577 | Val  Acc: 0.9661
 Site-amazon                    (0) | Val  Loss: 0.2470 | Val  Acc: 0.9213
 Site-amazon                    (0) | Val  Loss: 0.2664 | Val  Acc: 0.9474
 Site-amazon                    (0) | Val  Loss: 0.1940 | Val  Acc: 0.9750
 Site-amazon                    (0) | Val  Loss: 0.2584 | Val  Acc: 0.9498
 Site-webcam                    (2) | Val  Loss: 0.2557 | Val  Acc: 0.9730
 Site-webcam                    (2) | Val  Loss: 0.1424 | Val  Acc: 1.0000
 Site-webcam                    (2) | Val  Loss: 0.2866 | Val  Acc: 0.9381
 Site-dslr                      (1) | Val  Loss: 0.2683 | Val  Acc: 0.9762
 Site-dslr                      (1) | Val  Loss: 0.3974 | Val  Acc: 0.9412
 Site-synthetic                 (3) | Val  Loss: 1.4724 | Val  Acc: 0.7200
Average Valid Accuracy: 0.9371
 Test site-amazon                    (0)| Epoch:42 | Test Acc: 0.9441
 Test site-webcam                    (2)| Epoch:42 | Test Acc: 0.9323
 Test site-dslr                      (1)| Epoch:42 | Test Acc: 0.9383
 Test site-synthetic                 (3)| Epoch:42 | Test Acc: 0.6581
amazon: 0.9441, webcam: 0.9323, dslr: 0.9383, synthetic: 0.6581, 
Average Test Accuracy(group): 0.8682, Average Test Accuracy(individual): 0.9138,
domain std=0.1214, cluster std=0.1214, individual std=0.0810, 
Average Test Accuracy: 0.8682
============ Train epoch 44 ============
cnt=[3, 3, 3, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-amazon                    (1) | Train Loss: 0.3039 | Train Acc: 0.9438
 Site-amazon                    (1) | Train Loss: 0.1697 | Train Acc: 0.9701
 Site-amazon                    (1) | Train Loss: 0.2208 | Train Acc: 0.9450
 Site-amazon                    (3) | Train Loss: 0.1998 | Train Acc: 0.9667
 Site-amazon                    (3) | Train Loss: 0.1797 | Train Acc: 0.9688
 Site-webcam                    (0) | Train Loss: 0.3625 | Train Acc: 0.9286
 Site-webcam                    (0) | Train Loss: 0.2540 | Train Acc: 0.9490
 Site-webcam                    (0) | Train Loss: 0.2624 | Train Acc: 0.9529
 Site-dslr                      (2) | Train Loss: 0.2452 | Train Acc: 0.9531
 Site-dslr                      (2) | Train Loss: 0.3053 | Train Acc: 0.9609
 Site-synthetic                 (2) | Train Loss: 0.7059 | Train Acc: 0.8125
Average Train Accuracy: 0.9410
 Site-amazon                    (1) | Val  Loss: 0.1666 | Val  Acc: 0.9831
 Site-amazon                    (1) | Val  Loss: 0.2147 | Val  Acc: 0.9663
 Site-amazon                    (1) | Val  Loss: 0.2273 | Val  Acc: 0.9624
 Site-amazon                    (3) | Val  Loss: 0.1553 | Val  Acc: 0.9750
 Site-amazon                    (3) | Val  Loss: 0.2506 | Val  Acc: 0.9465
 Site-webcam                    (0) | Val  Loss: 0.2260 | Val  Acc: 0.9459
 Site-webcam                    (0) | Val  Loss: 0.1561 | Val  Acc: 0.9692
 Site-webcam                    (0) | Val  Loss: 0.2526 | Val  Acc: 0.9646
 Site-dslr                      (2) | Val  Loss: 0.3154 | Val  Acc: 0.9762
 Site-dslr                      (2) | Val  Loss: 0.3463 | Val  Acc: 0.9176
 Site-synthetic                 (2) | Val  Loss: 1.2516 | Val  Acc: 0.7067
Average Valid Accuracy: 0.9376
 Test site-amazon                    (1)| Epoch:42 | Test Acc: 0.9452
 Test site-webcam                    (0)| Epoch:42 | Test Acc: 0.9323
 Test site-dslr                      (2)| Epoch:42 | Test Acc: 0.9383
 Test site-synthetic                 (2)| Epoch:42 | Test Acc: 0.6570
amazon: 0.9452, webcam: 0.9323, dslr: 0.9383, synthetic: 0.6570, 
Average Test Accuracy(group): 0.8682, Average Test Accuracy(individual): 0.9142,
domain std=0.1220, cluster std=0.0421, individual std=0.0815, 
Average Test Accuracy: 0.8682
============ Train epoch 45 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-amazon                    (0) | Train Loss: 0.2360 | Train Acc: 0.9551
 Site-amazon                    (0) | Train Loss: 0.2375 | Train Acc: 0.9104
 Site-amazon                    (0) | Train Loss: 0.3171 | Train Acc: 0.9500
 Site-amazon                    (0) | Train Loss: 0.1911 | Train Acc: 0.9733
 Site-amazon                    (0) | Train Loss: 0.1837 | Train Acc: 0.9555
 Site-webcam                    (2) | Train Loss: 0.3056 | Train Acc: 0.9464
 Site-webcam                    (2) | Train Loss: 0.2426 | Train Acc: 0.9796
 Site-webcam                    (2) | Train Loss: 0.2319 | Train Acc: 0.9765
 Site-dslr                      (1) | Train Loss: 0.2350 | Train Acc: 0.9375
 Site-dslr                      (1) | Train Loss: 0.3310 | Train Acc: 0.9297
 Site-synthetic                 (3) | Train Loss: 0.5687 | Train Acc: 0.8571
Average Train Accuracy: 0.9428
 Site-amazon                    (0) | Val  Loss: 0.1270 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.2587 | Val  Acc: 0.9101
 Site-amazon                    (0) | Val  Loss: 0.2071 | Val  Acc: 0.9474
 Site-amazon                    (0) | Val  Loss: 0.1726 | Val  Acc: 0.9750
 Site-amazon                    (0) | Val  Loss: 0.2199 | Val  Acc: 0.9666
 Site-webcam                    (2) | Val  Loss: 0.2017 | Val  Acc: 0.9730
 Site-webcam                    (2) | Val  Loss: 0.1272 | Val  Acc: 1.0000
 Site-webcam                    (2) | Val  Loss: 0.2239 | Val  Acc: 0.9735
 Site-dslr                      (1) | Val  Loss: 0.3114 | Val  Acc: 0.9762
 Site-dslr                      (1) | Val  Loss: 0.2951 | Val  Acc: 0.9412
 Site-synthetic                 (3) | Val  Loss: 1.3176 | Val  Acc: 0.7067
Average Valid Accuracy: 0.9427
 Test site-amazon                    (0)| Epoch:42 | Test Acc: 0.9452
 Test site-webcam                    (2)| Epoch:42 | Test Acc: 0.9363
 Test site-dslr                      (1)| Epoch:42 | Test Acc: 0.9383
 Test site-synthetic                 (3)| Epoch:42 | Test Acc: 0.6677
amazon: 0.9452, webcam: 0.9363, dslr: 0.9383, synthetic: 0.6677, 
Average Test Accuracy(group): 0.8719, Average Test Accuracy(individual): 0.9163,
domain std=0.1179, cluster std=0.1179, individual std=0.0787, 
Average Test Accuracy: 0.8719
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 46 ============
cnt=[5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-amazon                    (0) | Train Loss: 0.2616 | Train Acc: 0.9551
 Site-amazon                    (0) | Train Loss: 0.2105 | Train Acc: 0.9552
 Site-amazon                    (0) | Train Loss: 0.2504 | Train Acc: 0.9500
 Site-amazon                    (0) | Train Loss: 0.1649 | Train Acc: 0.9767
 Site-amazon                    (0) | Train Loss: 0.1744 | Train Acc: 0.9666
 Site-webcam                    (1) | Train Loss: 0.3793 | Train Acc: 0.8929
 Site-webcam                    (1) | Train Loss: 0.2662 | Train Acc: 0.9694
 Site-webcam                    (1) | Train Loss: 0.2731 | Train Acc: 0.9588
 Site-dslr                      (3) | Train Loss: 0.2394 | Train Acc: 0.9375
 Site-dslr                      (3) | Train Loss: 0.2844 | Train Acc: 0.9531
 Site-synthetic                 (2) | Train Loss: 0.6099 | Train Acc: 0.8929
Average Train Accuracy: 0.9462
 Site-amazon                    (0) | Val  Loss: 0.1372 | Val  Acc: 0.9831
 Site-amazon                    (0) | Val  Loss: 0.2540 | Val  Acc: 0.9101
 Site-amazon                    (0) | Val  Loss: 0.2450 | Val  Acc: 0.9398
 Site-amazon                    (0) | Val  Loss: 0.1639 | Val  Acc: 0.9750
 Site-amazon                    (0) | Val  Loss: 0.2480 | Val  Acc: 0.9565
 Site-webcam                    (1) | Val  Loss: 0.2222 | Val  Acc: 0.9730
 Site-webcam                    (1) | Val  Loss: 0.1654 | Val  Acc: 0.9692
 Site-webcam                    (1) | Val  Loss: 0.2163 | Val  Acc: 0.9912
 Site-dslr                      (3) | Val  Loss: 0.2361 | Val  Acc: 1.0000
 Site-dslr                      (3) | Val  Loss: 0.3651 | Val  Acc: 0.9176
 Site-synthetic                 (2) | Val  Loss: 1.3353 | Val  Acc: 0.7467
Average Valid Accuracy: 0.9420
 Test site-amazon                    (0)| Epoch:45 | Test Acc: 0.9464
 Test site-webcam                    (1)| Epoch:45 | Test Acc: 0.9363
 Test site-dslr                      (3)| Epoch:45 | Test Acc: 0.9383
 Test site-synthetic                 (2)| Epoch:45 | Test Acc: 0.6677
amazon: 0.9464, webcam: 0.9363, dslr: 0.9383, synthetic: 0.6677, 
Average Test Accuracy(group): 0.8722, Average Test Accuracy(individual): 0.9168,
domain std=0.1181, cluster std=0.1181, individual std=0.0789, 
Average Test Accuracy: 0.8722
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 47 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-amazon                    (0) | Train Loss: 0.3005 | Train Acc: 0.9551
 Site-amazon                    (0) | Train Loss: 0.1861 | Train Acc: 0.9403
 Site-amazon                    (0) | Train Loss: 0.2536 | Train Acc: 0.9600
 Site-amazon                    (0) | Train Loss: 0.1647 | Train Acc: 0.9800
 Site-amazon                    (0) | Train Loss: 0.1890 | Train Acc: 0.9644
 Site-webcam                    (2) | Train Loss: 0.3479 | Train Acc: 0.9286
 Site-webcam                    (2) | Train Loss: 0.2353 | Train Acc: 0.9694
 Site-webcam                    (2) | Train Loss: 0.2319 | Train Acc: 0.9647
 Site-dslr                      (1) | Train Loss: 0.2539 | Train Acc: 0.9375
 Site-dslr                      (1) | Train Loss: 0.3118 | Train Acc: 0.9609
 Site-synthetic                 (3) | Train Loss: 0.6015 | Train Acc: 0.8661
Average Train Accuracy: 0.9479
 Site-amazon                    (0) | Val  Loss: 0.1334 | Val  Acc: 1.0000
 Site-amazon                    (0) | Val  Loss: 0.2171 | Val  Acc: 0.9551
 Site-amazon                    (0) | Val  Loss: 0.3379 | Val  Acc: 0.9098
 Site-amazon                    (0) | Val  Loss: 0.1400 | Val  Acc: 0.9700
 Site-amazon                    (0) | Val  Loss: 0.2593 | Val  Acc: 0.9498
 Site-webcam                    (2) | Val  Loss: 0.2104 | Val  Acc: 1.0000
 Site-webcam                    (2) | Val  Loss: 0.1303 | Val  Acc: 0.9692
 Site-webcam                    (2) | Val  Loss: 0.2265 | Val  Acc: 0.9558
 Site-dslr                      (1) | Val  Loss: 0.3008 | Val  Acc: 0.9286
 Site-dslr                      (1) | Val  Loss: 0.3362 | Val  Acc: 0.9529
 Site-synthetic                 (3) | Val  Loss: 1.3179 | Val  Acc: 0.7200
Average Valid Accuracy: 0.9374
 Test site-amazon                    (0)| Epoch:46 | Test Acc: 0.9452
 Test site-webcam                    (2)| Epoch:46 | Test Acc: 0.9363
 Test site-dslr                      (1)| Epoch:46 | Test Acc: 0.9383
 Test site-synthetic                 (3)| Epoch:46 | Test Acc: 0.6667
amazon: 0.9452, webcam: 0.9363, dslr: 0.9383, synthetic: 0.6667, 
Average Test Accuracy(group): 0.8716, Average Test Accuracy(individual): 0.9162,
domain std=0.1184, cluster std=0.1184, individual std=0.0790, 
Average Test Accuracy: 0.8716
============ Train epoch 48 ============
cnt=[2, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-amazon                    (1) | Train Loss: 0.2990 | Train Acc: 0.9326
 Site-amazon                    (1) | Train Loss: 0.2538 | Train Acc: 0.9701
 Site-amazon                    (1) | Train Loss: 0.2174 | Train Acc: 0.9450
 Site-amazon                    (1) | Train Loss: 0.1825 | Train Acc: 0.9700
 Site-amazon                    (1) | Train Loss: 0.1845 | Train Acc: 0.9577
 Site-webcam                    (3) | Train Loss: 0.3837 | Train Acc: 0.8929
 Site-webcam                    (3) | Train Loss: 0.2522 | Train Acc: 0.9694
 Site-webcam                    (3) | Train Loss: 0.2213 | Train Acc: 0.9588
 Site-dslr                      (0) | Train Loss: 0.2843 | Train Acc: 0.9375
 Site-dslr                      (0) | Train Loss: 0.3003 | Train Acc: 0.9453
 Site-synthetic                 (2) | Train Loss: 0.5656 | Train Acc: 0.8661
Average Train Accuracy: 0.9405
 Site-amazon                    (1) | Val  Loss: 0.1568 | Val  Acc: 0.9831
 Site-amazon                    (1) | Val  Loss: 0.2568 | Val  Acc: 0.9326
 Site-amazon                    (1) | Val  Loss: 0.2898 | Val  Acc: 0.9248
 Site-amazon                    (1) | Val  Loss: 0.1356 | Val  Acc: 0.9850
 Site-amazon                    (1) | Val  Loss: 0.2501 | Val  Acc: 0.9465
 Site-webcam                    (3) | Val  Loss: 0.1689 | Val  Acc: 0.9730
 Site-webcam                    (3) | Val  Loss: 0.1209 | Val  Acc: 0.9846
 Site-webcam                    (3) | Val  Loss: 0.2637 | Val  Acc: 0.9735
 Site-dslr                      (0) | Val  Loss: 0.2800 | Val  Acc: 0.9762
 Site-dslr                      (0) | Val  Loss: 0.2843 | Val  Acc: 0.9412
 Site-synthetic                 (2) | Val  Loss: 1.1902 | Val  Acc: 0.7467
Average Valid Accuracy: 0.9425
 Test site-amazon                    (1)| Epoch:46 | Test Acc: 0.9476
 Test site-webcam                    (3)| Epoch:46 | Test Acc: 0.9363
 Test site-dslr                      (0)| Epoch:46 | Test Acc: 0.9383
 Test site-synthetic                 (2)| Epoch:46 | Test Acc: 0.6688
amazon: 0.9476, webcam: 0.9363, dslr: 0.9383, synthetic: 0.6688, 
Average Test Accuracy(group): 0.8727, Average Test Accuracy(individual): 0.9174,
domain std=0.1178, cluster std=0.1178, individual std=0.0788, 
Average Test Accuracy: 0.8727
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-amazon                    (1) | Train Loss: 0.3161 | Train Acc: 0.9326
 Site-amazon                    (1) | Train Loss: 0.1494 | Train Acc: 0.9478
 Site-amazon                    (1) | Train Loss: 0.1798 | Train Acc: 0.9550
 Site-amazon                    (1) | Train Loss: 0.1656 | Train Acc: 0.9733
 Site-amazon                    (1) | Train Loss: 0.1668 | Train Acc: 0.9755
 Site-webcam                    (3) | Train Loss: 0.3542 | Train Acc: 0.8750
 Site-webcam                    (3) | Train Loss: 0.2172 | Train Acc: 0.9796
 Site-webcam                    (3) | Train Loss: 0.2436 | Train Acc: 0.9647
 Site-dslr                      (0) | Train Loss: 0.2051 | Train Acc: 0.9531
 Site-dslr                      (0) | Train Loss: 0.3490 | Train Acc: 0.9062
 Site-synthetic                 (2) | Train Loss: 0.5527 | Train Acc: 0.8929
Average Train Accuracy: 0.9414
 Site-amazon                    (1) | Val  Loss: 0.1474 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 0.2369 | Val  Acc: 0.9326
 Site-amazon                    (1) | Val  Loss: 0.1931 | Val  Acc: 0.9549
 Site-amazon                    (1) | Val  Loss: 0.1518 | Val  Acc: 0.9850
 Site-amazon                    (1) | Val  Loss: 0.2268 | Val  Acc: 0.9465
 Site-webcam                    (3) | Val  Loss: 0.2284 | Val  Acc: 0.9730
 Site-webcam                    (3) | Val  Loss: 0.1101 | Val  Acc: 1.0000
 Site-webcam                    (3) | Val  Loss: 0.2195 | Val  Acc: 0.9735
 Site-dslr                      (0) | Val  Loss: 0.2321 | Val  Acc: 0.9762
 Site-dslr                      (0) | Val  Loss: 0.3182 | Val  Acc: 0.9294
 Site-synthetic                 (2) | Val  Loss: 1.1932 | Val  Acc: 0.7733
Average Valid Accuracy: 0.9495
 Best site-amazon                   (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-amazon                   (1)  | Epoch:49 | Val Acc: 0.9326
 Best site-amazon                   (1)  | Epoch:49 | Val Acc: 0.9549
 Best site-amazon                   (1)  | Epoch:49 | Val Acc: 0.9850
 Best site-amazon                   (1)  | Epoch:49 | Val Acc: 0.9465
 Best site-webcam                   (3)  | Epoch:49 | Val Acc: 0.9730
 Best site-webcam                   (3)  | Epoch:49 | Val Acc: 1.0000
 Best site-webcam                   (3)  | Epoch:49 | Val Acc: 0.9735
 Best site-dslr                     (0)  | Epoch:49 | Val Acc: 0.9762
 Best site-dslr                     (0)  | Epoch:49 | Val Acc: 0.9294
 Best site-synthetic                (2)  | Epoch:49 | Val Acc: 0.7733
 Test site-amazon                    (1)| Epoch:49 | Test Acc: 0.9476
 Test site-webcam                    (3)| Epoch:49 | Test Acc: 0.9323
 Test site-dslr                      (0)| Epoch:49 | Test Acc: 0.9383
 Test site-synthetic                 (2)| Epoch:49 | Test Acc: 0.6742
amazon: 0.9476, webcam: 0.9323, dslr: 0.9383, synthetic: 0.6742, 
Average Test Accuracy(group): 0.8731, Average Test Accuracy(individual): 0.9168,
domain std=0.1150, cluster std=0.1150, individual std=0.0770, 
Average Test Accuracy: 0.8731
 Saving the gmap checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_1.7_1/ccop_q=1...
===2023-08-04 04:23:28===
===2023-08-04 04:23:33===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[89,134,200,300,449,56,98,170,64,128,112,
client_nums=[5,3,2,1,]
len_dataset=[1959,544,320,188,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (1)| Epoch:49 | Test Acc: 0.9476
 Test site-webcam                    (3)| Epoch:49 | Test Acc: 0.9323
 Test site-dslr                      (0)| Epoch:49 | Test Acc: 0.9383
 Test site-synthetic                 (2)| Epoch:49 | Test Acc: 0.6742
amazon: 0.9476, webcam: 0.9323, dslr: 0.9383, synthetic: 0.6742, 
Average Test Accuracy(group): 0.8731, Average Test Accuracy(individual): 0.9168,
domain std=0.1150, cluster std=0.1150, individual std=0.0770, 
