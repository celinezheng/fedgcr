===2023-07-01 23:51:37===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1459,912,570,356,222,138,
client_nums=[1,1,1,1,1,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
============ Train epoch 0 ============
 Site-Real                          | Train Loss: 1.7667 | Train Acc: 0.8944
 Site-Clipart                       | Train Loss: 1.9415 | Train Acc: 0.7083
 Site-Painting                      | Train Loss: 1.8646 | Train Acc: 0.7789
 Site-Sketch                        | Train Loss: 1.9407 | Train Acc: 0.6629
 Site-Infograph                     | Train Loss: 2.1599 | Train Acc: 0.3739
 Site-QuickDraw                     | Train Loss: 2.2687 | Train Acc: 0.1739
Average Train Accuracy: 0.5987
 Site-Real                          | Val  Loss: 1.7591 | Val  Acc: 0.8889
 Site-Clipart                       | Val  Loss: 1.9469 | Val  Acc: 0.6875
 Site-Painting                      | Val  Loss: 1.8595 | Val  Acc: 0.7447
 Site-Sketch                        | Val  Loss: 1.9391 | Val  Acc: 0.7173
 Site-Infograph                     | Val  Loss: 2.1420 | Val  Acc: 0.4054
 Site-QuickDraw                     | Val  Loss: 2.2755 | Val  Acc: 0.1413
Average Valid Accuracy: 0.5975
 Best site-Real                      | Epoch:0 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.6875
 Best site-Painting                  | Epoch:0 | Val Acc: 0.7447
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7173
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.4054
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.1413
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 1 ============
 Site-Real                          | Train Loss: 1.3449 | Train Acc: 0.9424
 Site-Clipart                       | Train Loss: 1.6423 | Train Acc: 0.7917
 Site-Painting                      | Train Loss: 1.5139 | Train Acc: 0.8263
 Site-Sketch                        | Train Loss: 1.6478 | Train Acc: 0.6854
 Site-Infograph                     | Train Loss: 2.0466 | Train Acc: 0.3784
 Site-QuickDraw                     | Train Loss: 2.1940 | Train Acc: 0.2899
Average Train Accuracy: 0.6523
 Site-Real                          | Val  Loss: 1.3326 | Val  Acc: 0.9403
 Site-Clipart                       | Val  Loss: 1.6619 | Val  Acc: 0.7697
 Site-Painting                      | Val  Loss: 1.4981 | Val  Acc: 0.8289
 Site-Sketch                        | Val  Loss: 1.6390 | Val  Acc: 0.7468
 Site-Infograph                     | Val  Loss: 2.0285 | Val  Acc: 0.4527
 Site-QuickDraw                     | Val  Loss: 2.2553 | Val  Acc: 0.1848
Average Valid Accuracy: 0.6539
 Best site-Real                      | Epoch:1 | Val Acc: 0.9403
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.7697
 Best site-Painting                  | Epoch:1 | Val Acc: 0.8289
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.7468
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4527
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.1848
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 2 ============
 Site-Real                          | Train Loss: 1.0219 | Train Acc: 0.9520
 Site-Clipart                       | Train Loss: 1.4028 | Train Acc: 0.7982
 Site-Painting                      | Train Loss: 1.2710 | Train Acc: 0.8281
 Site-Sketch                        | Train Loss: 1.4550 | Train Acc: 0.6826
 Site-Infograph                     | Train Loss: 1.9811 | Train Acc: 0.3964
 Site-QuickDraw                     | Train Loss: 2.1491 | Train Acc: 0.3043
Average Train Accuracy: 0.6603
 Site-Real                          | Val  Loss: 1.0074 | Val  Acc: 0.9486
 Site-Clipart                       | Val  Loss: 1.4379 | Val  Acc: 0.8010
 Site-Painting                      | Val  Loss: 1.2372 | Val  Acc: 0.8263
 Site-Sketch                        | Val  Loss: 1.3694 | Val  Acc: 0.7848
 Site-Infograph                     | Val  Loss: 1.8880 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.2094 | Val  Acc: 0.2391
Average Valid Accuracy: 0.6788
 Best site-Real                      | Epoch:2 | Val Acc: 0.9486
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8010
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8263
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7848
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4730
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.2391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 3 ============
 Site-Real                          | Train Loss: 0.7912 | Train Acc: 0.9589
 Site-Clipart                       | Train Loss: 1.2270 | Train Acc: 0.7917
 Site-Painting                      | Train Loss: 1.0602 | Train Acc: 0.8281
 Site-Sketch                        | Train Loss: 1.2336 | Train Acc: 0.7163
 Site-Infograph                     | Train Loss: 1.8841 | Train Acc: 0.3964
 Site-QuickDraw                     | Train Loss: 2.1246 | Train Acc: 0.2754
Average Train Accuracy: 0.6611
 Site-Real                          | Val  Loss: 0.7760 | Val  Acc: 0.9588
 Site-Clipart                       | Val  Loss: 1.2498 | Val  Acc: 0.7763
 Site-Painting                      | Val  Loss: 1.0593 | Val  Acc: 0.8316
 Site-Sketch                        | Val  Loss: 1.2253 | Val  Acc: 0.7806
 Site-Infograph                     | Val  Loss: 1.7885 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.1751 | Val  Acc: 0.2717
Average Valid Accuracy: 0.6843
 Best site-Real                      | Epoch:3 | Val Acc: 0.9588
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7763
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8316
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7806
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.4865
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.2717
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 4 ============
 Site-Real                          | Train Loss: 0.6147 | Train Acc: 0.9637
 Site-Clipart                       | Train Loss: 1.0850 | Train Acc: 0.8125
 Site-Painting                      | Train Loss: 0.9030 | Train Acc: 0.8526
 Site-Sketch                        | Train Loss: 1.1076 | Train Acc: 0.7303
 Site-Infograph                     | Train Loss: 1.8343 | Train Acc: 0.3964
 Site-QuickDraw                     | Train Loss: 2.0653 | Train Acc: 0.2826
Average Train Accuracy: 0.6730
 Site-Real                          | Val  Loss: 0.6158 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 1.1176 | Val  Acc: 0.8059
 Site-Painting                      | Val  Loss: 0.9165 | Val  Acc: 0.8263
 Site-Sketch                        | Val  Loss: 1.1372 | Val  Acc: 0.7426
 Site-Infograph                     | Val  Loss: 1.7275 | Val  Acc: 0.4595
 Site-QuickDraw                     | Val  Loss: 2.1732 | Val  Acc: 0.2717
Average Valid Accuracy: 0.6780
============ Train epoch 5 ============
 Site-Real                          | Train Loss: 0.5084 | Train Acc: 0.9602
 Site-Clipart                       | Train Loss: 0.9566 | Train Acc: 0.8235
 Site-Painting                      | Train Loss: 0.8227 | Train Acc: 0.8193
 Site-Sketch                        | Train Loss: 1.0590 | Train Acc: 0.7388
 Site-Infograph                     | Train Loss: 1.7708 | Train Acc: 0.4234
 Site-QuickDraw                     | Train Loss: 1.9939 | Train Acc: 0.3188
Average Train Accuracy: 0.6807
 Site-Real                          | Val  Loss: 0.4932 | Val  Acc: 0.9650
 Site-Clipart                       | Val  Loss: 0.9903 | Val  Acc: 0.8174
 Site-Painting                      | Val  Loss: 0.8100 | Val  Acc: 0.8342
 Site-Sketch                        | Val  Loss: 0.9898 | Val  Acc: 0.7806
 Site-Infograph                     | Val  Loss: 1.6870 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.1873 | Val  Acc: 0.2717
Average Valid Accuracy: 0.6915
 Best site-Real                      | Epoch:5 | Val Acc: 0.9650
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8174
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8342
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7806
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.4797
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.2717
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 6 ============
 Site-Real                          | Train Loss: 0.4256 | Train Acc: 0.9644
 Site-Clipart                       | Train Loss: 0.8835 | Train Acc: 0.8289
 Site-Painting                      | Train Loss: 0.7509 | Train Acc: 0.8228
 Site-Sketch                        | Train Loss: 1.0121 | Train Acc: 0.7163
 Site-Infograph                     | Train Loss: 1.7379 | Train Acc: 0.4009
 Site-QuickDraw                     | Train Loss: 1.9921 | Train Acc: 0.3333
Average Train Accuracy: 0.6778
 Site-Real                          | Val  Loss: 0.4197 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.9309 | Val  Acc: 0.7961
 Site-Painting                      | Val  Loss: 0.7363 | Val  Acc: 0.8395
 Site-Sketch                        | Val  Loss: 0.9168 | Val  Acc: 0.7637
 Site-Infograph                     | Val  Loss: 1.6462 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.1590 | Val  Acc: 0.2717
Average Valid Accuracy: 0.6866
============ Train epoch 7 ============
 Site-Real                          | Train Loss: 0.3547 | Train Acc: 0.9719
 Site-Clipart                       | Train Loss: 0.8136 | Train Acc: 0.8355
 Site-Painting                      | Train Loss: 0.6835 | Train Acc: 0.8509
 Site-Sketch                        | Train Loss: 0.9047 | Train Acc: 0.7331
 Site-Infograph                     | Train Loss: 1.7186 | Train Acc: 0.4144
 Site-QuickDraw                     | Train Loss: 1.9577 | Train Acc: 0.3623
Average Train Accuracy: 0.6947
 Site-Real                          | Val  Loss: 0.3639 | Val  Acc: 0.9640
 Site-Clipart                       | Val  Loss: 0.8596 | Val  Acc: 0.8273
 Site-Painting                      | Val  Loss: 0.6835 | Val  Acc: 0.8316
 Site-Sketch                        | Val  Loss: 0.8736 | Val  Acc: 0.7806
 Site-Infograph                     | Val  Loss: 1.6218 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.1565 | Val  Acc: 0.2609
Average Valid Accuracy: 0.6918
 Best site-Real                      | Epoch:7 | Val Acc: 0.9640
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8273
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8316
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.7806
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.4865
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 8 ============
 Site-Real                          | Train Loss: 0.3188 | Train Acc: 0.9685
 Site-Clipart                       | Train Loss: 0.7527 | Train Acc: 0.8443
 Site-Painting                      | Train Loss: 0.6575 | Train Acc: 0.8333
 Site-Sketch                        | Train Loss: 0.8540 | Train Acc: 0.7528
 Site-Infograph                     | Train Loss: 1.6624 | Train Acc: 0.4099
 Site-QuickDraw                     | Train Loss: 1.9698 | Train Acc: 0.3116
Average Train Accuracy: 0.6867
 Site-Real                          | Val  Loss: 0.3128 | Val  Acc: 0.9702
 Site-Clipart                       | Val  Loss: 0.8306 | Val  Acc: 0.8010
 Site-Painting                      | Val  Loss: 0.6246 | Val  Acc: 0.8447
 Site-Sketch                        | Val  Loss: 0.8463 | Val  Acc: 0.7426
 Site-Infograph                     | Val  Loss: 1.5913 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 2.1427 | Val  Acc: 0.2609
Average Valid Accuracy: 0.6877
============ Train epoch 9 ============
 Site-Real                          | Train Loss: 0.2813 | Train Acc: 0.9657
 Site-Clipart                       | Train Loss: 0.7119 | Train Acc: 0.8443
 Site-Painting                      | Train Loss: 0.6220 | Train Acc: 0.8456
 Site-Sketch                        | Train Loss: 0.8876 | Train Acc: 0.7331
 Site-Infograph                     | Train Loss: 1.7060 | Train Acc: 0.4054
 Site-QuickDraw                     | Train Loss: 2.0187 | Train Acc: 0.3333
Average Train Accuracy: 0.6879
 Site-Real                          | Val  Loss: 0.2903 | Val  Acc: 0.9681
 Site-Clipart                       | Val  Loss: 0.7641 | Val  Acc: 0.8355
 Site-Painting                      | Val  Loss: 0.6103 | Val  Acc: 0.8368
 Site-Sketch                        | Val  Loss: 0.7833 | Val  Acc: 0.7975
 Site-Infograph                     | Val  Loss: 1.5837 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.0811 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7062
 Best site-Real                      | Epoch:9 | Val Acc: 0.9681
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8355
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8368
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.7975
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.4730
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.3261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 10 ============
 Site-Real                          | Train Loss: 0.2621 | Train Acc: 0.9671
 Site-Clipart                       | Train Loss: 0.6959 | Train Acc: 0.8531
 Site-Painting                      | Train Loss: 0.6008 | Train Acc: 0.8368
 Site-Sketch                        | Train Loss: 0.8458 | Train Acc: 0.7388
 Site-Infograph                     | Train Loss: 1.6341 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 1.9606 | Train Acc: 0.3188
Average Train Accuracy: 0.6927
 Site-Real                          | Val  Loss: 0.2610 | Val  Acc: 0.9722
 Site-Clipart                       | Val  Loss: 0.7332 | Val  Acc: 0.8240
 Site-Painting                      | Val  Loss: 0.5966 | Val  Acc: 0.8474
 Site-Sketch                        | Val  Loss: 0.7662 | Val  Acc: 0.7848
 Site-Infograph                     | Val  Loss: 1.6066 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.1180 | Val  Acc: 0.2609
Average Valid Accuracy: 0.6926
============ Train epoch 11 ============
 Site-Real                          | Train Loss: 0.2325 | Train Acc: 0.9740
 Site-Clipart                       | Train Loss: 0.6744 | Train Acc: 0.8509
 Site-Painting                      | Train Loss: 0.5992 | Train Acc: 0.8368
 Site-Sketch                        | Train Loss: 0.8150 | Train Acc: 0.7360
 Site-Infograph                     | Train Loss: 1.5730 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 1.8786 | Train Acc: 0.3261
Average Train Accuracy: 0.6979
 Site-Real                          | Val  Loss: 0.2431 | Val  Acc: 0.9671
 Site-Clipart                       | Val  Loss: 0.7224 | Val  Acc: 0.8273
 Site-Painting                      | Val  Loss: 0.5761 | Val  Acc: 0.8342
 Site-Sketch                        | Val  Loss: 0.7877 | Val  Acc: 0.7722
 Site-Infograph                     | Val  Loss: 1.5805 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.1098 | Val  Acc: 0.2826
Average Valid Accuracy: 0.6961
============ Train epoch 12 ============
 Site-Real                          | Train Loss: 0.2180 | Train Acc: 0.9692
 Site-Clipart                       | Train Loss: 0.6296 | Train Acc: 0.8629
 Site-Painting                      | Train Loss: 0.5490 | Train Acc: 0.8561
 Site-Sketch                        | Train Loss: 0.8042 | Train Acc: 0.7528
 Site-Infograph                     | Train Loss: 1.6681 | Train Acc: 0.4189
 Site-QuickDraw                     | Train Loss: 1.8057 | Train Acc: 0.3551
Average Train Accuracy: 0.7025
 Site-Real                          | Val  Loss: 0.2294 | Val  Acc: 0.9660
 Site-Clipart                       | Val  Loss: 0.6606 | Val  Acc: 0.8487
 Site-Painting                      | Val  Loss: 0.5610 | Val  Acc: 0.8184
 Site-Sketch                        | Val  Loss: 0.7247 | Val  Acc: 0.8017
 Site-Infograph                     | Val  Loss: 1.5483 | Val  Acc: 0.5270
 Site-QuickDraw                     | Val  Loss: 2.1429 | Val  Acc: 0.2826
Average Valid Accuracy: 0.7074
 Best site-Real                      | Epoch:12 | Val Acc: 0.9660
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8487
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8184
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8017
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.5270
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.2826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 13 ============
 Site-Real                          | Train Loss: 0.1955 | Train Acc: 0.9740
 Site-Clipart                       | Train Loss: 0.6068 | Train Acc: 0.8596
 Site-Painting                      | Train Loss: 0.5153 | Train Acc: 0.8596
 Site-Sketch                        | Train Loss: 0.7486 | Train Acc: 0.7612
 Site-Infograph                     | Train Loss: 1.6595 | Train Acc: 0.4369
 Site-QuickDraw                     | Train Loss: 1.9308 | Train Acc: 0.3696
Average Train Accuracy: 0.7102
 Site-Real                          | Val  Loss: 0.2107 | Val  Acc: 0.9691
 Site-Clipart                       | Val  Loss: 0.6283 | Val  Acc: 0.8536
 Site-Painting                      | Val  Loss: 0.5434 | Val  Acc: 0.8474
 Site-Sketch                        | Val  Loss: 0.6896 | Val  Acc: 0.7932
 Site-Infograph                     | Val  Loss: 1.5734 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.0765 | Val  Acc: 0.2826
Average Valid Accuracy: 0.7065
============ Train epoch 14 ============
 Site-Real                          | Train Loss: 0.1813 | Train Acc: 0.9753
 Site-Clipart                       | Train Loss: 0.6155 | Train Acc: 0.8596
 Site-Painting                      | Train Loss: 0.5488 | Train Acc: 0.8386
 Site-Sketch                        | Train Loss: 0.8057 | Train Acc: 0.7528
 Site-Infograph                     | Train Loss: 1.6011 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 1.9053 | Train Acc: 0.3478
Average Train Accuracy: 0.7064
 Site-Real                          | Val  Loss: 0.1931 | Val  Acc: 0.9743
 Site-Clipart                       | Val  Loss: 0.6263 | Val  Acc: 0.8487
 Site-Painting                      | Val  Loss: 0.5260 | Val  Acc: 0.8500
 Site-Sketch                        | Val  Loss: 0.6889 | Val  Acc: 0.8059
 Site-Infograph                     | Val  Loss: 1.5423 | Val  Acc: 0.5203
 Site-QuickDraw                     | Val  Loss: 2.0973 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7172
 Best site-Real                      | Epoch:14 | Val Acc: 0.9743
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8487
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8500
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8059
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.5203
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 15 ============
 Site-Real                          | Train Loss: 0.1760 | Train Acc: 0.9740
 Site-Clipart                       | Train Loss: 0.5578 | Train Acc: 0.8783
 Site-Painting                      | Train Loss: 0.5316 | Train Acc: 0.8386
 Site-Sketch                        | Train Loss: 0.7113 | Train Acc: 0.7753
 Site-Infograph                     | Train Loss: 1.5778 | Train Acc: 0.4730
 Site-QuickDraw                     | Train Loss: 1.8549 | Train Acc: 0.3043
Average Train Accuracy: 0.7072
 Site-Real                          | Val  Loss: 0.1914 | Val  Acc: 0.9753
 Site-Clipart                       | Val  Loss: 0.6064 | Val  Acc: 0.8717
 Site-Painting                      | Val  Loss: 0.4986 | Val  Acc: 0.8526
 Site-Sketch                        | Val  Loss: 0.6312 | Val  Acc: 0.8270
 Site-Infograph                     | Val  Loss: 1.5844 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.0857 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7228
 Best site-Real                      | Epoch:15 | Val Acc: 0.9753
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8717
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8526
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8270
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.4730
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.3370
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 16 ============
 Site-Real                          | Train Loss: 0.1660 | Train Acc: 0.9760
 Site-Clipart                       | Train Loss: 0.5520 | Train Acc: 0.8783
 Site-Painting                      | Train Loss: 0.5039 | Train Acc: 0.8544
 Site-Sketch                        | Train Loss: 0.7198 | Train Acc: 0.7725
 Site-Infograph                     | Train Loss: 1.6136 | Train Acc: 0.4730
 Site-QuickDraw                     | Train Loss: 1.9413 | Train Acc: 0.3913
Average Train Accuracy: 0.7242
 Site-Real                          | Val  Loss: 0.1877 | Val  Acc: 0.9712
 Site-Clipart                       | Val  Loss: 0.5842 | Val  Acc: 0.8668
 Site-Painting                      | Val  Loss: 0.5084 | Val  Acc: 0.8421
 Site-Sketch                        | Val  Loss: 0.7325 | Val  Acc: 0.7679
 Site-Infograph                     | Val  Loss: 1.5321 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 1.9955 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7130
============ Train epoch 17 ============
 Site-Real                          | Train Loss: 0.1577 | Train Acc: 0.9740
 Site-Clipart                       | Train Loss: 0.5179 | Train Acc: 0.8772
 Site-Painting                      | Train Loss: 0.4906 | Train Acc: 0.8632
 Site-Sketch                        | Train Loss: 0.6754 | Train Acc: 0.7781
 Site-Infograph                     | Train Loss: 1.6070 | Train Acc: 0.4775
 Site-QuickDraw                     | Train Loss: 1.7219 | Train Acc: 0.3913
Average Train Accuracy: 0.7269
 Site-Real                          | Val  Loss: 0.1736 | Val  Acc: 0.9702
 Site-Clipart                       | Val  Loss: 0.5646 | Val  Acc: 0.8717
 Site-Painting                      | Val  Loss: 0.5023 | Val  Acc: 0.8474
 Site-Sketch                        | Val  Loss: 0.6242 | Val  Acc: 0.8101
 Site-Infograph                     | Val  Loss: 1.5237 | Val  Acc: 0.5135
 Site-QuickDraw                     | Val  Loss: 2.0581 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7195
============ Train epoch 18 ============
 Site-Real                          | Train Loss: 0.1478 | Train Acc: 0.9760
 Site-Clipart                       | Train Loss: 0.5286 | Train Acc: 0.8739
 Site-Painting                      | Train Loss: 0.5260 | Train Acc: 0.8246
 Site-Sketch                        | Train Loss: 0.6904 | Train Acc: 0.7949
 Site-Infograph                     | Train Loss: 1.6016 | Train Acc: 0.4279
 Site-QuickDraw                     | Train Loss: 1.8559 | Train Acc: 0.3696
Average Train Accuracy: 0.7112
 Site-Real                          | Val  Loss: 0.1733 | Val  Acc: 0.9722
 Site-Clipart                       | Val  Loss: 0.5645 | Val  Acc: 0.8503
 Site-Painting                      | Val  Loss: 0.5135 | Val  Acc: 0.8316
 Site-Sketch                        | Val  Loss: 0.6678 | Val  Acc: 0.7932
 Site-Infograph                     | Val  Loss: 1.5801 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.0279 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7059
============ Train epoch 19 ============
 Site-Real                          | Train Loss: 0.1377 | Train Acc: 0.9767
 Site-Clipart                       | Train Loss: 0.5192 | Train Acc: 0.8772
 Site-Painting                      | Train Loss: 0.4987 | Train Acc: 0.8368
 Site-Sketch                        | Train Loss: 0.7463 | Train Acc: 0.7697
 Site-Infograph                     | Train Loss: 1.6624 | Train Acc: 0.4324
 Site-QuickDraw                     | Train Loss: 1.8282 | Train Acc: 0.3551
Average Train Accuracy: 0.7080
 Site-Real                          | Val  Loss: 0.1679 | Val  Acc: 0.9763
 Site-Clipart                       | Val  Loss: 0.5690 | Val  Acc: 0.8454
 Site-Painting                      | Val  Loss: 0.5089 | Val  Acc: 0.8263
 Site-Sketch                        | Val  Loss: 0.6403 | Val  Acc: 0.7975
 Site-Infograph                     | Val  Loss: 1.5415 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.0325 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7115
============ Train epoch 20 ============
 Site-Real                          | Train Loss: 0.1257 | Train Acc: 0.9801
 Site-Clipart                       | Train Loss: 0.4959 | Train Acc: 0.8914
 Site-Painting                      | Train Loss: 0.4782 | Train Acc: 0.8579
 Site-Sketch                        | Train Loss: 0.6853 | Train Acc: 0.7697
 Site-Infograph                     | Train Loss: 1.5474 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 1.8664 | Train Acc: 0.3696
Average Train Accuracy: 0.7221
 Site-Real                          | Val  Loss: 0.1577 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.5570 | Val  Acc: 0.8635
 Site-Painting                      | Val  Loss: 0.4845 | Val  Acc: 0.8579
 Site-Sketch                        | Val  Loss: 0.6166 | Val  Acc: 0.8101
 Site-Infograph                     | Val  Loss: 1.5727 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 2.0068 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7240
 Best site-Real                      | Epoch:20 | Val Acc: 0.9794
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8635
 Best site-Painting                  | Epoch:20 | Val Acc: 0.8579
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.8101
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.5068
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.3261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 21 ============
 Site-Real                          | Train Loss: 0.1301 | Train Acc: 0.9767
 Site-Clipart                       | Train Loss: 0.5003 | Train Acc: 0.8827
 Site-Painting                      | Train Loss: 0.4252 | Train Acc: 0.8649
 Site-Sketch                        | Train Loss: 0.6535 | Train Acc: 0.7921
 Site-Infograph                     | Train Loss: 1.5919 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 1.8616 | Train Acc: 0.3696
Average Train Accuracy: 0.7250
 Site-Real                          | Val  Loss: 0.1606 | Val  Acc: 0.9784
 Site-Clipart                       | Val  Loss: 0.5439 | Val  Acc: 0.8684
 Site-Painting                      | Val  Loss: 0.4691 | Val  Acc: 0.8579
 Site-Sketch                        | Val  Loss: 0.6213 | Val  Acc: 0.8143
 Site-Infograph                     | Val  Loss: 1.4944 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 1.9793 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7183
============ Train epoch 22 ============
 Site-Real                          | Train Loss: 0.1238 | Train Acc: 0.9815
 Site-Clipart                       | Train Loss: 0.4758 | Train Acc: 0.8805
 Site-Painting                      | Train Loss: 0.4578 | Train Acc: 0.8614
 Site-Sketch                        | Train Loss: 0.6783 | Train Acc: 0.7528
 Site-Infograph                     | Train Loss: 1.5899 | Train Acc: 0.4324
 Site-QuickDraw                     | Train Loss: 1.8233 | Train Acc: 0.4130
Average Train Accuracy: 0.7203
 Site-Real                          | Val  Loss: 0.1521 | Val  Acc: 0.9702
 Site-Clipart                       | Val  Loss: 0.5312 | Val  Acc: 0.8717
 Site-Painting                      | Val  Loss: 0.4661 | Val  Acc: 0.8605
 Site-Sketch                        | Val  Loss: 0.6135 | Val  Acc: 0.8101
 Site-Infograph                     | Val  Loss: 1.5299 | Val  Acc: 0.5135
 Site-QuickDraw                     | Val  Loss: 1.9832 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7254
 Best site-Real                      | Epoch:22 | Val Acc: 0.9702
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.8717
 Best site-Painting                  | Epoch:22 | Val Acc: 0.8605
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.8101
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.5135
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.3261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 23 ============
 Site-Real                          | Train Loss: 0.1156 | Train Acc: 0.9781
 Site-Clipart                       | Train Loss: 0.4793 | Train Acc: 0.8772
 Site-Painting                      | Train Loss: 0.4781 | Train Acc: 0.8474
 Site-Sketch                        | Train Loss: 0.6743 | Train Acc: 0.7781
 Site-Infograph                     | Train Loss: 1.5519 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 1.7177 | Train Acc: 0.4203
Average Train Accuracy: 0.7275
 Site-Real                          | Val  Loss: 0.1499 | Val  Acc: 0.9733
 Site-Clipart                       | Val  Loss: 0.5102 | Val  Acc: 0.8816
 Site-Painting                      | Val  Loss: 0.4823 | Val  Acc: 0.8395
 Site-Sketch                        | Val  Loss: 0.5724 | Val  Acc: 0.8186
 Site-Infograph                     | Val  Loss: 1.4966 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 1.9759 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7261
 Best site-Real                      | Epoch:23 | Val Acc: 0.9733
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8816
 Best site-Painting                  | Epoch:23 | Val Acc: 0.8395
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8186
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.5068
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.3370
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 24 ============
 Site-Real                          | Train Loss: 0.1156 | Train Acc: 0.9767
 Site-Clipart                       | Train Loss: 0.4634 | Train Acc: 0.8925
 Site-Painting                      | Train Loss: 0.4581 | Train Acc: 0.8702
 Site-Sketch                        | Train Loss: 0.6555 | Train Acc: 0.7893
 Site-Infograph                     | Train Loss: 1.6196 | Train Acc: 0.4459
 Site-QuickDraw                     | Train Loss: 1.7131 | Train Acc: 0.3623
Average Train Accuracy: 0.7228
 Site-Real                          | Val  Loss: 0.1474 | Val  Acc: 0.9753
 Site-Clipart                       | Val  Loss: 0.5076 | Val  Acc: 0.8799
 Site-Painting                      | Val  Loss: 0.4541 | Val  Acc: 0.8500
 Site-Sketch                        | Val  Loss: 0.5681 | Val  Acc: 0.8017
 Site-Infograph                     | Val  Loss: 1.5315 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 1.9267 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7199
============ Train epoch 25 ============
 Site-Real                          | Train Loss: 0.1075 | Train Acc: 0.9849
 Site-Clipart                       | Train Loss: 0.4634 | Train Acc: 0.8816
 Site-Painting                      | Train Loss: 0.4395 | Train Acc: 0.8684
 Site-Sketch                        | Train Loss: 0.6648 | Train Acc: 0.7753
 Site-Infograph                     | Train Loss: 1.5915 | Train Acc: 0.4730
 Site-QuickDraw                     | Train Loss: 1.7469 | Train Acc: 0.3913
Average Train Accuracy: 0.7291
 Site-Real                          | Val  Loss: 0.1383 | Val  Acc: 0.9774
 Site-Clipart                       | Val  Loss: 0.4831 | Val  Acc: 0.8865
 Site-Painting                      | Val  Loss: 0.4380 | Val  Acc: 0.8658
 Site-Sketch                        | Val  Loss: 0.5819 | Val  Acc: 0.8228
 Site-Infograph                     | Val  Loss: 1.5176 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 1.9496 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7253
============ Train epoch 26 ============
 Site-Real                          | Train Loss: 0.1092 | Train Acc: 0.9753
 Site-Clipart                       | Train Loss: 0.4452 | Train Acc: 0.8882
 Site-Painting                      | Train Loss: 0.4369 | Train Acc: 0.8544
 Site-Sketch                        | Train Loss: 0.6248 | Train Acc: 0.8090
 Site-Infograph                     | Train Loss: 1.5190 | Train Acc: 0.4820
 Site-QuickDraw                     | Train Loss: 1.6937 | Train Acc: 0.3768
Average Train Accuracy: 0.7309
 Site-Real                          | Val  Loss: 0.1367 | Val  Acc: 0.9743
 Site-Clipart                       | Val  Loss: 0.4922 | Val  Acc: 0.8766
 Site-Painting                      | Val  Loss: 0.4444 | Val  Acc: 0.8658
 Site-Sketch                        | Val  Loss: 0.6342 | Val  Acc: 0.7806
 Site-Infograph                     | Val  Loss: 1.5396 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 1.9111 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7292
 Best site-Real                      | Epoch:26 | Val Acc: 0.9743
 Best site-Clipart                   | Epoch:26 | Val Acc: 0.8766
 Best site-Painting                  | Epoch:26 | Val Acc: 0.8658
 Best site-Sketch                    | Epoch:26 | Val Acc: 0.7806
 Best site-Infograph                 | Epoch:26 | Val Acc: 0.4865
 Best site-QuickDraw                 | Epoch:26 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 27 ============
 Site-Real                          | Train Loss: 0.1037 | Train Acc: 0.9829
 Site-Clipart                       | Train Loss: 0.4491 | Train Acc: 0.8914
 Site-Painting                      | Train Loss: 0.4127 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.6542 | Train Acc: 0.7837
 Site-Infograph                     | Train Loss: 1.5431 | Train Acc: 0.4234
 Site-QuickDraw                     | Train Loss: 1.6987 | Train Acc: 0.4130
Average Train Accuracy: 0.7283
 Site-Real                          | Val  Loss: 0.1384 | Val  Acc: 0.9763
 Site-Clipart                       | Val  Loss: 0.4865 | Val  Acc: 0.8750
 Site-Painting                      | Val  Loss: 0.4474 | Val  Acc: 0.8605
 Site-Sketch                        | Val  Loss: 0.5514 | Val  Acc: 0.8228
 Site-Infograph                     | Val  Loss: 1.4564 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 1.9235 | Val  Acc: 0.3587
Average Valid Accuracy: 0.7334
 Best site-Real                      | Epoch:27 | Val Acc: 0.9763
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.8750
 Best site-Painting                  | Epoch:27 | Val Acc: 0.8605
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.8228
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.5068
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.3587
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 28 ============
 Site-Real                          | Train Loss: 0.1056 | Train Acc: 0.9815
 Site-Clipart                       | Train Loss: 0.4164 | Train Acc: 0.8893
 Site-Painting                      | Train Loss: 0.4400 | Train Acc: 0.8649
 Site-Sketch                        | Train Loss: 0.6485 | Train Acc: 0.7893
 Site-Infograph                     | Train Loss: 1.4662 | Train Acc: 0.4910
 Site-QuickDraw                     | Train Loss: 1.5164 | Train Acc: 0.4493
Average Train Accuracy: 0.7442
 Site-Real                          | Val  Loss: 0.1289 | Val  Acc: 0.9784
 Site-Clipart                       | Val  Loss: 0.4709 | Val  Acc: 0.8832
 Site-Painting                      | Val  Loss: 0.4224 | Val  Acc: 0.8553
 Site-Sketch                        | Val  Loss: 0.5520 | Val  Acc: 0.8354
 Site-Infograph                     | Val  Loss: 1.5284 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 1.9326 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7268
============ Train epoch 29 ============
 Site-Real                          | Train Loss: 0.0954 | Train Acc: 0.9801
 Site-Clipart                       | Train Loss: 0.4205 | Train Acc: 0.9013
 Site-Painting                      | Train Loss: 0.4725 | Train Acc: 0.8526
 Site-Sketch                        | Train Loss: 0.6089 | Train Acc: 0.8006
 Site-Infograph                     | Train Loss: 1.5035 | Train Acc: 0.4910
 Site-QuickDraw                     | Train Loss: 1.6825 | Train Acc: 0.4493
Average Train Accuracy: 0.7458
 Site-Real                          | Val  Loss: 0.1300 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.4729 | Val  Acc: 0.8799
 Site-Painting                      | Val  Loss: 0.4361 | Val  Acc: 0.8553
 Site-Sketch                        | Val  Loss: 0.5547 | Val  Acc: 0.8143
 Site-Infograph                     | Val  Loss: 1.5295 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 1.9198 | Val  Acc: 0.3587
Average Valid Accuracy: 0.7303
============ Train epoch 30 ============
 Site-Real                          | Train Loss: 0.0916 | Train Acc: 0.9863
 Site-Clipart                       | Train Loss: 0.4235 | Train Acc: 0.9057
 Site-Painting                      | Train Loss: 0.4090 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.5998 | Train Acc: 0.7949
 Site-Infograph                     | Train Loss: 1.5043 | Train Acc: 0.4865
 Site-QuickDraw                     | Train Loss: 1.5543 | Train Acc: 0.4420
Average Train Accuracy: 0.7485
 Site-Real                          | Val  Loss: 0.1217 | Val  Acc: 0.9774
 Site-Clipart                       | Val  Loss: 0.4791 | Val  Acc: 0.8618
 Site-Painting                      | Val  Loss: 0.4402 | Val  Acc: 0.8632
 Site-Sketch                        | Val  Loss: 0.5565 | Val  Acc: 0.8228
 Site-Infograph                     | Val  Loss: 1.4994 | Val  Acc: 0.5203
 Site-QuickDraw                     | Val  Loss: 2.0001 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7268
============ Train epoch 31 ============
 Site-Real                          | Train Loss: 0.0854 | Train Acc: 0.9856
 Site-Clipart                       | Train Loss: 0.4042 | Train Acc: 0.8991
 Site-Painting                      | Train Loss: 0.4422 | Train Acc: 0.8667
 Site-Sketch                        | Train Loss: 0.6505 | Train Acc: 0.7837
 Site-Infograph                     | Train Loss: 1.5183 | Train Acc: 0.4820
 Site-QuickDraw                     | Train Loss: 1.8095 | Train Acc: 0.4565
Average Train Accuracy: 0.7456
 Site-Real                          | Val  Loss: 0.1338 | Val  Acc: 0.9743
 Site-Clipart                       | Val  Loss: 0.4699 | Val  Acc: 0.8816
 Site-Painting                      | Val  Loss: 0.4441 | Val  Acc: 0.8474
 Site-Sketch                        | Val  Loss: 0.5376 | Val  Acc: 0.8017
 Site-Infograph                     | Val  Loss: 1.5326 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 1.8321 | Val  Acc: 0.4130
Average Valid Accuracy: 0.7375
 Best site-Real                      | Epoch:31 | Val Acc: 0.9743
 Best site-Clipart                   | Epoch:31 | Val Acc: 0.8816
 Best site-Painting                  | Epoch:31 | Val Acc: 0.8474
 Best site-Sketch                    | Epoch:31 | Val Acc: 0.8017
 Best site-Infograph                 | Epoch:31 | Val Acc: 0.5068
 Best site-QuickDraw                 | Epoch:31 | Val Acc: 0.4130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 32 ============
 Site-Real                          | Train Loss: 0.0901 | Train Acc: 0.9842
 Site-Clipart                       | Train Loss: 0.4058 | Train Acc: 0.9101
 Site-Painting                      | Train Loss: 0.4059 | Train Acc: 0.8825
 Site-Sketch                        | Train Loss: 0.6158 | Train Acc: 0.7921
 Site-Infograph                     | Train Loss: 1.5460 | Train Acc: 0.4550
 Site-QuickDraw                     | Train Loss: 1.5857 | Train Acc: 0.4275
Average Train Accuracy: 0.7419
 Site-Real                          | Val  Loss: 0.1267 | Val  Acc: 0.9774
 Site-Clipart                       | Val  Loss: 0.4469 | Val  Acc: 0.8799
 Site-Painting                      | Val  Loss: 0.4327 | Val  Acc: 0.8526
 Site-Sketch                        | Val  Loss: 0.5857 | Val  Acc: 0.8101
 Site-Infograph                     | Val  Loss: 1.5652 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 1.9595 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7239
============ Train epoch 33 ============
 Site-Real                          | Train Loss: 0.0837 | Train Acc: 0.9877
 Site-Clipart                       | Train Loss: 0.3796 | Train Acc: 0.9068
 Site-Painting                      | Train Loss: 0.3958 | Train Acc: 0.8737
 Site-Sketch                        | Train Loss: 0.5733 | Train Acc: 0.7949
 Site-Infograph                     | Train Loss: 1.5087 | Train Acc: 0.4595
 Site-QuickDraw                     | Train Loss: 1.6151 | Train Acc: 0.3768
Average Train Accuracy: 0.7332
 Site-Real                          | Val  Loss: 0.1288 | Val  Acc: 0.9774
 Site-Clipart                       | Val  Loss: 0.4422 | Val  Acc: 0.9013
 Site-Painting                      | Val  Loss: 0.4369 | Val  Acc: 0.8579
 Site-Sketch                        | Val  Loss: 0.5697 | Val  Acc: 0.8143
 Site-Infograph                     | Val  Loss: 1.4998 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 1.9736 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7302
============ Train epoch 34 ============
 Site-Real                          | Train Loss: 0.0850 | Train Acc: 0.9863
 Site-Clipart                       | Train Loss: 0.3699 | Train Acc: 0.9134
 Site-Painting                      | Train Loss: 0.4120 | Train Acc: 0.8702
 Site-Sketch                        | Train Loss: 0.6477 | Train Acc: 0.7753
 Site-Infograph                     | Train Loss: 1.5275 | Train Acc: 0.4685
 Site-QuickDraw                     | Train Loss: 1.7660 | Train Acc: 0.4130
Average Train Accuracy: 0.7378
 Site-Real                          | Val  Loss: 0.1161 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.4278 | Val  Acc: 0.8964
 Site-Painting                      | Val  Loss: 0.4018 | Val  Acc: 0.8632
 Site-Sketch                        | Val  Loss: 0.5598 | Val  Acc: 0.8312
 Site-Infograph                     | Val  Loss: 1.4756 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 1.8719 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7413
 Best site-Real                      | Epoch:34 | Val Acc: 0.9805
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.8964
 Best site-Painting                  | Epoch:34 | Val Acc: 0.8632
 Best site-Sketch                    | Epoch:34 | Val Acc: 0.8312
 Best site-Infograph                 | Epoch:34 | Val Acc: 0.5068
 Best site-QuickDraw                 | Epoch:34 | Val Acc: 0.3696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 35 ============
 Site-Real                          | Train Loss: 0.0836 | Train Acc: 0.9856
 Site-Clipart                       | Train Loss: 0.3716 | Train Acc: 0.8936
 Site-Painting                      | Train Loss: 0.4121 | Train Acc: 0.8702
 Site-Sketch                        | Train Loss: 0.6354 | Train Acc: 0.7949
 Site-Infograph                     | Train Loss: 1.5624 | Train Acc: 0.4595
 Site-QuickDraw                     | Train Loss: 1.6915 | Train Acc: 0.3913
Average Train Accuracy: 0.7325
 Site-Real                          | Val  Loss: 0.1176 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.4244 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 0.4153 | Val  Acc: 0.8605
 Site-Sketch                        | Val  Loss: 0.5187 | Val  Acc: 0.8354
 Site-Infograph                     | Val  Loss: 1.5058 | Val  Acc: 0.5135
 Site-QuickDraw                     | Val  Loss: 1.8862 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7377
============ Train epoch 36 ============
 Site-Real                          | Train Loss: 0.0765 | Train Acc: 0.9863
 Site-Clipart                       | Train Loss: 0.3630 | Train Acc: 0.9079
 Site-Painting                      | Train Loss: 0.4191 | Train Acc: 0.8579
 Site-Sketch                        | Train Loss: 0.5623 | Train Acc: 0.8118
 Site-Infograph                     | Train Loss: 1.5094 | Train Acc: 0.4820
 Site-QuickDraw                     | Train Loss: 1.5121 | Train Acc: 0.4565
Average Train Accuracy: 0.7504
 Site-Real                          | Val  Loss: 0.1248 | Val  Acc: 0.9763
 Site-Clipart                       | Val  Loss: 0.4440 | Val  Acc: 0.8783
 Site-Painting                      | Val  Loss: 0.4267 | Val  Acc: 0.8632
 Site-Sketch                        | Val  Loss: 0.5280 | Val  Acc: 0.8397
 Site-Infograph                     | Val  Loss: 1.5071 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 1.8795 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7426
 Best site-Real                      | Epoch:36 | Val Acc: 0.9763
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.8783
 Best site-Painting                  | Epoch:36 | Val Acc: 0.8632
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8397
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.5068
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 37 ============
 Site-Real                          | Train Loss: 0.0760 | Train Acc: 0.9842
 Site-Clipart                       | Train Loss: 0.3803 | Train Acc: 0.9013
 Site-Painting                      | Train Loss: 0.4070 | Train Acc: 0.8544
 Site-Sketch                        | Train Loss: 0.6121 | Train Acc: 0.7837
 Site-Infograph                     | Train Loss: 1.5945 | Train Acc: 0.4459
 Site-QuickDraw                     | Train Loss: 1.8452 | Train Acc: 0.4203
Average Train Accuracy: 0.7316
 Site-Real                          | Val  Loss: 0.1193 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.4267 | Val  Acc: 0.8964
 Site-Painting                      | Val  Loss: 0.3973 | Val  Acc: 0.8763
 Site-Sketch                        | Val  Loss: 0.5745 | Val  Acc: 0.8186
 Site-Infograph                     | Val  Loss: 1.5100 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 1.9016 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7355
============ Train epoch 38 ============
 Site-Real                          | Train Loss: 0.0757 | Train Acc: 0.9877
 Site-Clipart                       | Train Loss: 0.3790 | Train Acc: 0.8925
 Site-Painting                      | Train Loss: 0.4038 | Train Acc: 0.8667
 Site-Sketch                        | Train Loss: 0.5289 | Train Acc: 0.8146
 Site-Infograph                     | Train Loss: 1.5689 | Train Acc: 0.4595
 Site-QuickDraw                     | Train Loss: 1.5487 | Train Acc: 0.4420
Average Train Accuracy: 0.7438
 Site-Real                          | Val  Loss: 0.1156 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.4174 | Val  Acc: 0.9013
 Site-Painting                      | Val  Loss: 0.4039 | Val  Acc: 0.8684
 Site-Sketch                        | Val  Loss: 0.5691 | Val  Acc: 0.8186
 Site-Infograph                     | Val  Loss: 1.5097 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 1.7913 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7420
============ Train epoch 39 ============
 Site-Real                          | Train Loss: 0.0724 | Train Acc: 0.9877
 Site-Clipart                       | Train Loss: 0.3522 | Train Acc: 0.9101
 Site-Painting                      | Train Loss: 0.4133 | Train Acc: 0.8544
 Site-Sketch                        | Train Loss: 0.5685 | Train Acc: 0.8146
 Site-Infograph                     | Train Loss: 1.5343 | Train Acc: 0.4505
 Site-QuickDraw                     | Train Loss: 1.5826 | Train Acc: 0.4130
Average Train Accuracy: 0.7384
 Site-Real                          | Val  Loss: 0.1167 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.4186 | Val  Acc: 0.8898
 Site-Painting                      | Val  Loss: 0.4210 | Val  Acc: 0.8711
 Site-Sketch                        | Val  Loss: 0.4963 | Val  Acc: 0.8397
 Site-Infograph                     | Val  Loss: 1.4927 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 1.8484 | Val  Acc: 0.3804
Average Valid Accuracy: 0.7415
============ Train epoch 40 ============
 Site-Real                          | Train Loss: 0.0689 | Train Acc: 0.9897
 Site-Clipart                       | Train Loss: 0.3450 | Train Acc: 0.9145
 Site-Painting                      | Train Loss: 0.4040 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.5412 | Train Acc: 0.8062
 Site-Infograph                     | Train Loss: 1.5545 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 1.5671 | Train Acc: 0.4420
Average Train Accuracy: 0.7486
 Site-Real                          | Val  Loss: 0.1170 | Val  Acc: 0.9753
 Site-Clipart                       | Val  Loss: 0.4167 | Val  Acc: 0.8947
 Site-Painting                      | Val  Loss: 0.4227 | Val  Acc: 0.8553
 Site-Sketch                        | Val  Loss: 0.5274 | Val  Acc: 0.8186
 Site-Infograph                     | Val  Loss: 1.5341 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 1.8912 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7297
============ Train epoch 41 ============
 Site-Real                          | Train Loss: 0.0689 | Train Acc: 0.9897
 Site-Clipart                       | Train Loss: 0.3472 | Train Acc: 0.9112
 Site-Painting                      | Train Loss: 0.3668 | Train Acc: 0.8702
 Site-Sketch                        | Train Loss: 0.5913 | Train Acc: 0.7893
 Site-Infograph                     | Train Loss: 1.5245 | Train Acc: 0.4685
 Site-QuickDraw                     | Train Loss: 1.7352 | Train Acc: 0.4493
Average Train Accuracy: 0.7464
 Site-Real                          | Val  Loss: 0.1141 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.4078 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 0.3919 | Val  Acc: 0.8632
 Site-Sketch                        | Val  Loss: 0.5337 | Val  Acc: 0.8312
 Site-Infograph                     | Val  Loss: 1.5099 | Val  Acc: 0.5000
 Site-QuickDraw                     | Val  Loss: 1.8040 | Val  Acc: 0.3804
Average Valid Accuracy: 0.7422
============ Train epoch 42 ============
 Site-Real                          | Train Loss: 0.0625 | Train Acc: 0.9918
 Site-Clipart                       | Train Loss: 0.3456 | Train Acc: 0.9156
 Site-Painting                      | Train Loss: 0.3865 | Train Acc: 0.8789
 Site-Sketch                        | Train Loss: 0.5862 | Train Acc: 0.8090
 Site-Infograph                     | Train Loss: 1.5376 | Train Acc: 0.4730
 Site-QuickDraw                     | Train Loss: 1.6892 | Train Acc: 0.4710
Average Train Accuracy: 0.7565
 Site-Real                          | Val  Loss: 0.1172 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.4026 | Val  Acc: 0.8849
 Site-Painting                      | Val  Loss: 0.4063 | Val  Acc: 0.8447
 Site-Sketch                        | Val  Loss: 0.5955 | Val  Acc: 0.8017
 Site-Infograph                     | Val  Loss: 1.4818 | Val  Acc: 0.5135
 Site-QuickDraw                     | Val  Loss: 1.8844 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7323
============ Train epoch 43 ============
 Site-Real                          | Train Loss: 0.0677 | Train Acc: 0.9883
 Site-Clipart                       | Train Loss: 0.3392 | Train Acc: 0.9112
 Site-Painting                      | Train Loss: 0.3806 | Train Acc: 0.8737
 Site-Sketch                        | Train Loss: 0.5804 | Train Acc: 0.8006
 Site-Infograph                     | Train Loss: 1.5306 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 1.6879 | Train Acc: 0.4130
Average Train Accuracy: 0.7380
 Site-Real                          | Val  Loss: 0.1100 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.4151 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 0.3896 | Val  Acc: 0.8605
 Site-Sketch                        | Val  Loss: 0.5007 | Val  Acc: 0.8481
 Site-Infograph                     | Val  Loss: 1.4959 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 1.8734 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7480
 Best site-Real                      | Epoch:43 | Val Acc: 0.9835
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.8980
 Best site-Painting                  | Epoch:43 | Val Acc: 0.8605
 Best site-Sketch                    | Epoch:43 | Val Acc: 0.8481
 Best site-Infograph                 | Epoch:43 | Val Acc: 0.5068
 Best site-QuickDraw                 | Epoch:43 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 44 ============
 Site-Real                          | Train Loss: 0.0608 | Train Acc: 0.9918
 Site-Clipart                       | Train Loss: 0.3538 | Train Acc: 0.9057
 Site-Painting                      | Train Loss: 0.3839 | Train Acc: 0.8719
 Site-Sketch                        | Train Loss: 0.5722 | Train Acc: 0.8202
 Site-Infograph                     | Train Loss: 1.5137 | Train Acc: 0.4595
 Site-QuickDraw                     | Train Loss: 1.6834 | Train Acc: 0.4348
Average Train Accuracy: 0.7473
 Site-Real                          | Val  Loss: 0.1034 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.4215 | Val  Acc: 0.8931
 Site-Painting                      | Val  Loss: 0.4188 | Val  Acc: 0.8658
 Site-Sketch                        | Val  Loss: 0.5312 | Val  Acc: 0.8228
 Site-Infograph                     | Val  Loss: 1.5126 | Val  Acc: 0.5000
 Site-QuickDraw                     | Val  Loss: 1.8701 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7352
============ Train epoch 45 ============
 Site-Real                          | Train Loss: 0.0608 | Train Acc: 0.9918
 Site-Clipart                       | Train Loss: 0.3476 | Train Acc: 0.9178
 Site-Painting                      | Train Loss: 0.3757 | Train Acc: 0.8842
 Site-Sketch                        | Train Loss: 0.5880 | Train Acc: 0.8062
 Site-Infograph                     | Train Loss: 1.5610 | Train Acc: 0.4550
 Site-QuickDraw                     | Train Loss: 1.6725 | Train Acc: 0.4203
Average Train Accuracy: 0.7459
 Site-Real                          | Val  Loss: 0.1113 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.4001 | Val  Acc: 0.8849
 Site-Painting                      | Val  Loss: 0.4211 | Val  Acc: 0.8632
 Site-Sketch                        | Val  Loss: 0.5079 | Val  Acc: 0.8565
 Site-Infograph                     | Val  Loss: 1.5360 | Val  Acc: 0.5338
 Site-QuickDraw                     | Val  Loss: 1.8294 | Val  Acc: 0.3804
Average Valid Accuracy: 0.7500
 Best site-Real                      | Epoch:45 | Val Acc: 0.9815
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.8849
 Best site-Painting                  | Epoch:45 | Val Acc: 0.8632
 Best site-Sketch                    | Epoch:45 | Val Acc: 0.8565
 Best site-Infograph                 | Epoch:45 | Val Acc: 0.5338
 Best site-QuickDraw                 | Epoch:45 | Val Acc: 0.3804
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 46 ============
 Site-Real                          | Train Loss: 0.0588 | Train Acc: 0.9897
 Site-Clipart                       | Train Loss: 0.3558 | Train Acc: 0.9112
 Site-Painting                      | Train Loss: 0.3758 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.5793 | Train Acc: 0.7978
 Site-Infograph                     | Train Loss: 1.5583 | Train Acc: 0.4685
 Site-QuickDraw                     | Train Loss: 1.5841 | Train Acc: 0.4493
Average Train Accuracy: 0.7486
 Site-Real                          | Val  Loss: 0.1167 | Val  Acc: 0.9774
 Site-Clipart                       | Val  Loss: 0.3966 | Val  Acc: 0.8914
 Site-Painting                      | Val  Loss: 0.3905 | Val  Acc: 0.8632
 Site-Sketch                        | Val  Loss: 0.5174 | Val  Acc: 0.8270
 Site-Infograph                     | Val  Loss: 1.4748 | Val  Acc: 0.5203
 Site-QuickDraw                     | Val  Loss: 1.8625 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7415
============ Train epoch 47 ============
 Site-Real                          | Train Loss: 0.0544 | Train Acc: 0.9945
 Site-Clipart                       | Train Loss: 0.3323 | Train Acc: 0.9145
 Site-Painting                      | Train Loss: 0.3888 | Train Acc: 0.8789
 Site-Sketch                        | Train Loss: 0.5489 | Train Acc: 0.7949
 Site-Infograph                     | Train Loss: 1.5201 | Train Acc: 0.4505
 Site-QuickDraw                     | Train Loss: 1.5476 | Train Acc: 0.4203
Average Train Accuracy: 0.7423
 Site-Real                          | Val  Loss: 0.1135 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.3720 | Val  Acc: 0.9062
 Site-Painting                      | Val  Loss: 0.4452 | Val  Acc: 0.8395
 Site-Sketch                        | Val  Loss: 0.5445 | Val  Acc: 0.8186
 Site-Infograph                     | Val  Loss: 1.5491 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 1.9493 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7275
============ Train epoch 48 ============
 Site-Real                          | Train Loss: 0.0620 | Train Acc: 0.9904
 Site-Clipart                       | Train Loss: 0.3274 | Train Acc: 0.9211
 Site-Painting                      | Train Loss: 0.3758 | Train Acc: 0.8684
 Site-Sketch                        | Train Loss: 0.5363 | Train Acc: 0.8258
 Site-Infograph                     | Train Loss: 1.4499 | Train Acc: 0.4955
 Site-QuickDraw                     | Train Loss: 1.6782 | Train Acc: 0.4420
Average Train Accuracy: 0.7572
 Site-Real                          | Val  Loss: 0.0989 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.3999 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 0.4119 | Val  Acc: 0.8658
 Site-Sketch                        | Val  Loss: 0.4846 | Val  Acc: 0.8481
 Site-Infograph                     | Val  Loss: 1.4975 | Val  Acc: 0.5608
 Site-QuickDraw                     | Val  Loss: 1.8874 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7536
 Best site-Real                      | Epoch:48 | Val Acc: 0.9794
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.8980
 Best site-Painting                  | Epoch:48 | Val Acc: 0.8658
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.8481
 Best site-Infograph                 | Epoch:48 | Val Acc: 0.5608
 Best site-QuickDraw                 | Epoch:48 | Val Acc: 0.3696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
============ Train epoch 49 ============
 Site-Real                          | Train Loss: 0.0582 | Train Acc: 0.9918
 Site-Clipart                       | Train Loss: 0.3250 | Train Acc: 0.9145
 Site-Painting                      | Train Loss: 0.3831 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.5336 | Train Acc: 0.8202
 Site-Infograph                     | Train Loss: 1.5363 | Train Acc: 0.4595
 Site-QuickDraw                     | Train Loss: 1.6534 | Train Acc: 0.3841
Average Train Accuracy: 0.7409
 Site-Real                          | Val  Loss: 0.1011 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.3851 | Val  Acc: 0.8997
 Site-Painting                      | Val  Loss: 0.4025 | Val  Acc: 0.8632
 Site-Sketch                        | Val  Loss: 0.4731 | Val  Acc: 0.8650
 Site-Infograph                     | Val  Loss: 1.4214 | Val  Acc: 0.5338
 Site-QuickDraw                     | Val  Loss: 1.8520 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7561
 Best site-Real                      | Epoch:49 | Val Acc: 0.9835
 Best site-Clipart                   | Epoch:49 | Val Acc: 0.8997
 Best site-Painting                  | Epoch:49 | Val Acc: 0.8632
 Best site-Sketch                    | Epoch:49 | Val Acc: 0.8650
 Best site-Infograph                 | Epoch:49 | Val Acc: 0.5338
 Best site-QuickDraw                 | Epoch:49 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/afl...
===2023-07-02 01:23:25===
===2023-07-02 01:23:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1459,912,570,356,222,138,
client_nums=[1,1,1,1,1,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
Loading snapshots...
 Test site-Real                      | Epoch:49 | Test Acc: 0.9737
 Test site-Clipart                   | Epoch:49 | Test Acc: 0.9316
 Test site-Painting                  | Epoch:49 | Test Acc: 0.9015
 Test site-Sketch                    | Epoch:49 | Test Acc: 0.8610
 Test site-Infograph                 | Epoch:49 | Test Acc: 0.4947
 Test site-QuickDraw                 | Epoch:49 | Test Acc: 0.5920
Real: 0.9737, Clipart: 0.9316, Painting: 0.9015, Sketch: 0.8610, Infograph: 0.4947, QuickDraw: 0.5920, 
Average Test Accuracy(group): 0.7924, Average Test Accuracy(individual): 0.7924,
domain std=0.1815, cluster std=-1.0000, individual std=0.1815, 
