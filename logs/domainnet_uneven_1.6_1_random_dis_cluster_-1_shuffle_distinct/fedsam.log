===2023-07-02 09:54:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1459,912,570,356,222,138,
client_nums=[1,1,1,1,1,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
============ Train epoch 0 ============
 Site-Real                          | Train Loss: 0.2748 | Train Acc: 0.9726
 Site-Clipart                       | Train Loss: 0.8519 | Train Acc: 0.7303
 Site-Painting                      | Train Loss: 0.6148 | Train Acc: 0.8316
 Site-Sketch                        | Train Loss: 0.9136 | Train Acc: 0.7219
 Site-Infograph                     | Train Loss: 1.6967 | Train Acc: 0.3829
 Site-QuickDraw                     | Train Loss: 2.2004 | Train Acc: 0.2391
Average Train Accuracy: 0.6464
 Site-Real                          | Val  Loss: 0.2851 | Val  Acc: 0.9660
 Site-Clipart                       | Val  Loss: 0.8609 | Val  Acc: 0.7286
 Site-Painting                      | Val  Loss: 0.6539 | Val  Acc: 0.7947
 Site-Sketch                        | Val  Loss: 0.8737 | Val  Acc: 0.7342
 Site-Infograph                     | Val  Loss: 1.6338 | Val  Acc: 0.4392
 Site-QuickDraw                     | Val  Loss: 2.3445 | Val  Acc: 0.2391
Average Valid Accuracy: 0.6503
 Best site-Real                      | Epoch:0 | Val Acc: 0.9660
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7286
 Best site-Painting                  | Epoch:0 | Val Acc: 0.7947
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7342
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.4392
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.2391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 1 ============
 Site-Real                          | Train Loss: 0.1400 | Train Acc: 0.9794
 Site-Clipart                       | Train Loss: 0.5657 | Train Acc: 0.8465
 Site-Painting                      | Train Loss: 0.4537 | Train Acc: 0.8649
 Site-Sketch                        | Train Loss: 0.7530 | Train Acc: 0.7472
 Site-Infograph                     | Train Loss: 1.6258 | Train Acc: 0.4234
 Site-QuickDraw                     | Train Loss: 1.9857 | Train Acc: 0.3043
Average Train Accuracy: 0.6943
 Site-Real                          | Val  Loss: 0.1670 | Val  Acc: 0.9722
 Site-Clipart                       | Val  Loss: 0.6134 | Val  Acc: 0.8158
 Site-Painting                      | Val  Loss: 0.4778 | Val  Acc: 0.8605
 Site-Sketch                        | Val  Loss: 0.6568 | Val  Acc: 0.7679
 Site-Infograph                     | Val  Loss: 1.5896 | Val  Acc: 0.5000
 Site-QuickDraw                     | Val  Loss: 2.3713 | Val  Acc: 0.2174
Average Valid Accuracy: 0.6890
 Best site-Real                      | Epoch:1 | Val Acc: 0.9722
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8158
 Best site-Painting                  | Epoch:1 | Val Acc: 0.8605
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.7679
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.5000
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 2 ============
 Site-Real                          | Train Loss: 0.0957 | Train Acc: 0.9808
 Site-Clipart                       | Train Loss: 0.4547 | Train Acc: 0.8849
 Site-Painting                      | Train Loss: 0.4349 | Train Acc: 0.8544
 Site-Sketch                        | Train Loss: 0.6818 | Train Acc: 0.7669
 Site-Infograph                     | Train Loss: 1.6731 | Train Acc: 0.4324
 Site-QuickDraw                     | Train Loss: 1.9341 | Train Acc: 0.3841
Average Train Accuracy: 0.7172
 Site-Real                          | Val  Loss: 0.1339 | Val  Acc: 0.9774
 Site-Clipart                       | Val  Loss: 0.5084 | Val  Acc: 0.8602
 Site-Painting                      | Val  Loss: 0.4476 | Val  Acc: 0.8500
 Site-Sketch                        | Val  Loss: 0.5507 | Val  Acc: 0.8143
 Site-Infograph                     | Val  Loss: 1.4812 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.2077 | Val  Acc: 0.2500
Average Valid Accuracy: 0.7075
 Best site-Real                      | Epoch:2 | Val Acc: 0.9774
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8602
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8500
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.8143
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4932
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 3 ============
 Site-Real                          | Train Loss: 0.0701 | Train Acc: 0.9925
 Site-Clipart                       | Train Loss: 0.4179 | Train Acc: 0.8761
 Site-Painting                      | Train Loss: 0.3908 | Train Acc: 0.8702
 Site-Sketch                        | Train Loss: 0.6031 | Train Acc: 0.7809
 Site-Infograph                     | Train Loss: 1.7008 | Train Acc: 0.3964
 Site-QuickDraw                     | Train Loss: 2.0132 | Train Acc: 0.3478
Average Train Accuracy: 0.7106
 Site-Real                          | Val  Loss: 0.1075 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.4660 | Val  Acc: 0.8635
 Site-Painting                      | Val  Loss: 0.4412 | Val  Acc: 0.8553
 Site-Sketch                        | Val  Loss: 0.5617 | Val  Acc: 0.8228
 Site-Infograph                     | Val  Loss: 1.5701 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.2034 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7182
 Best site-Real                      | Epoch:3 | Val Acc: 0.9794
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8635
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8553
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.8228
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.4730
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.3152
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 4 ============
 Site-Real                          | Train Loss: 0.0609 | Train Acc: 0.9904
 Site-Clipart                       | Train Loss: 0.3589 | Train Acc: 0.9013
 Site-Painting                      | Train Loss: 0.3112 | Train Acc: 0.8930
 Site-Sketch                        | Train Loss: 0.5464 | Train Acc: 0.8287
 Site-Infograph                     | Train Loss: 1.7064 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 1.7902 | Train Acc: 0.3406
Average Train Accuracy: 0.7326
 Site-Real                          | Val  Loss: 0.1153 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.3994 | Val  Acc: 0.8865
 Site-Painting                      | Val  Loss: 0.3859 | Val  Acc: 0.8711
 Site-Sketch                        | Val  Loss: 0.5358 | Val  Acc: 0.8270
 Site-Infograph                     | Val  Loss: 1.6013 | Val  Acc: 0.4324
 Site-QuickDraw                     | Val  Loss: 2.0932 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7188
 Best site-Real                      | Epoch:4 | Val Acc: 0.9805
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8865
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8711
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8270
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.4324
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.3152
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 5 ============
 Site-Real                          | Train Loss: 0.0503 | Train Acc: 0.9911
 Site-Clipart                       | Train Loss: 0.3142 | Train Acc: 0.9145
 Site-Painting                      | Train Loss: 0.3471 | Train Acc: 0.8789
 Site-Sketch                        | Train Loss: 0.5982 | Train Acc: 0.8090
 Site-Infograph                     | Train Loss: 1.7154 | Train Acc: 0.4234
 Site-QuickDraw                     | Train Loss: 1.8712 | Train Acc: 0.3188
Average Train Accuracy: 0.7226
 Site-Real                          | Val  Loss: 0.0983 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.3615 | Val  Acc: 0.8980
 Site-Painting                      | Val  Loss: 0.3799 | Val  Acc: 0.8684
 Site-Sketch                        | Val  Loss: 0.4848 | Val  Acc: 0.8523
 Site-Infograph                     | Val  Loss: 1.6306 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.2999 | Val  Acc: 0.2500
Average Valid Accuracy: 0.7228
 Best site-Real                      | Epoch:5 | Val Acc: 0.9815
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8980
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8684
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8523
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.4865
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 6 ============
 Site-Real                          | Train Loss: 0.0415 | Train Acc: 0.9952
 Site-Clipart                       | Train Loss: 0.2885 | Train Acc: 0.9101
 Site-Painting                      | Train Loss: 0.3466 | Train Acc: 0.8825
 Site-Sketch                        | Train Loss: 0.5864 | Train Acc: 0.7978
 Site-Infograph                     | Train Loss: 1.7886 | Train Acc: 0.3919
 Site-QuickDraw                     | Train Loss: 1.9139 | Train Acc: 0.3696
Average Train Accuracy: 0.7245
 Site-Real                          | Val  Loss: 0.1048 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.3637 | Val  Acc: 0.8964
 Site-Painting                      | Val  Loss: 0.3576 | Val  Acc: 0.8789
 Site-Sketch                        | Val  Loss: 0.4753 | Val  Acc: 0.8354
 Site-Infograph                     | Val  Loss: 1.5087 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.2746 | Val  Acc: 0.2935
Average Valid Accuracy: 0.7300
 Best site-Real                      | Epoch:6 | Val Acc: 0.9825
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8964
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8789
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8354
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.4932
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.2935
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 7 ============
 Site-Real                          | Train Loss: 0.0297 | Train Acc: 0.9952
 Site-Clipart                       | Train Loss: 0.3063 | Train Acc: 0.9057
 Site-Painting                      | Train Loss: 0.2902 | Train Acc: 0.8982
 Site-Sketch                        | Train Loss: 0.5203 | Train Acc: 0.7978
 Site-Infograph                     | Train Loss: 1.8472 | Train Acc: 0.3874
 Site-QuickDraw                     | Train Loss: 1.9883 | Train Acc: 0.2826
Average Train Accuracy: 0.7111
 Site-Real                          | Val  Loss: 0.1065 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.3732 | Val  Acc: 0.8799
 Site-Painting                      | Val  Loss: 0.3509 | Val  Acc: 0.8711
 Site-Sketch                        | Val  Loss: 0.4813 | Val  Acc: 0.8312
 Site-Infograph                     | Val  Loss: 1.7138 | Val  Acc: 0.4527
 Site-QuickDraw                     | Val  Loss: 2.3239 | Val  Acc: 0.2609
Average Valid Accuracy: 0.7134
============ Train epoch 8 ============
 Site-Real                          | Train Loss: 0.0291 | Train Acc: 0.9959
 Site-Clipart                       | Train Loss: 0.2556 | Train Acc: 0.9211
 Site-Painting                      | Train Loss: 0.3101 | Train Acc: 0.8895
 Site-Sketch                        | Train Loss: 0.5411 | Train Acc: 0.8062
 Site-Infograph                     | Train Loss: 1.7676 | Train Acc: 0.3919
 Site-QuickDraw                     | Train Loss: 1.9571 | Train Acc: 0.3043
Average Train Accuracy: 0.7181
 Site-Real                          | Val  Loss: 0.0960 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.3664 | Val  Acc: 0.8816
 Site-Painting                      | Val  Loss: 0.3096 | Val  Acc: 0.8842
 Site-Sketch                        | Val  Loss: 0.4923 | Val  Acc: 0.8354
 Site-Infograph                     | Val  Loss: 1.6382 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.4130 | Val  Acc: 0.2935
Average Valid Accuracy: 0.7273
============ Train epoch 9 ============
 Site-Real                          | Train Loss: 0.0304 | Train Acc: 0.9938
 Site-Clipart                       | Train Loss: 0.2634 | Train Acc: 0.9156
 Site-Painting                      | Train Loss: 0.3098 | Train Acc: 0.8947
 Site-Sketch                        | Train Loss: 0.5298 | Train Acc: 0.8287
 Site-Infograph                     | Train Loss: 1.7921 | Train Acc: 0.3964
 Site-QuickDraw                     | Train Loss: 1.9741 | Train Acc: 0.3696
Average Train Accuracy: 0.7331
 Site-Real                          | Val  Loss: 0.0996 | Val  Acc: 0.9774
 Site-Clipart                       | Val  Loss: 0.3818 | Val  Acc: 0.8849
 Site-Painting                      | Val  Loss: 0.3285 | Val  Acc: 0.8947
 Site-Sketch                        | Val  Loss: 0.4310 | Val  Acc: 0.8692
 Site-Infograph                     | Val  Loss: 1.6502 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 1.9186 | Val  Acc: 0.3587
Average Valid Accuracy: 0.7452
 Best site-Real                      | Epoch:9 | Val Acc: 0.9774
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8849
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8947
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8692
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.4865
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.3587
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 10 ============
 Site-Real                          | Train Loss: 0.0244 | Train Acc: 0.9952
 Site-Clipart                       | Train Loss: 0.2516 | Train Acc: 0.9178
 Site-Painting                      | Train Loss: 0.2778 | Train Acc: 0.9158
 Site-Sketch                        | Train Loss: 0.5835 | Train Acc: 0.8174
 Site-Infograph                     | Train Loss: 1.7285 | Train Acc: 0.4505
 Site-QuickDraw                     | Train Loss: 2.1327 | Train Acc: 0.2609
Average Train Accuracy: 0.7262
 Site-Real                          | Val  Loss: 0.0934 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.3291 | Val  Acc: 0.8914
 Site-Painting                      | Val  Loss: 0.3376 | Val  Acc: 0.8816
 Site-Sketch                        | Val  Loss: 0.4617 | Val  Acc: 0.8523
 Site-Infograph                     | Val  Loss: 1.7608 | Val  Acc: 0.4459
 Site-QuickDraw                     | Val  Loss: 2.3333 | Val  Acc: 0.2500
Average Valid Accuracy: 0.7170
============ Train epoch 11 ============
 Site-Real                          | Train Loss: 0.0208 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.2922 | Train Acc: 0.9112
 Site-Painting                      | Train Loss: 0.2990 | Train Acc: 0.8965
 Site-Sketch                        | Train Loss: 0.5082 | Train Acc: 0.8315
 Site-Infograph                     | Train Loss: 1.6429 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 1.8915 | Train Acc: 0.3333
Average Train Accuracy: 0.7352
 Site-Real                          | Val  Loss: 0.0977 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.3745 | Val  Acc: 0.8783
 Site-Painting                      | Val  Loss: 0.3234 | Val  Acc: 0.8921
 Site-Sketch                        | Val  Loss: 0.4884 | Val  Acc: 0.8312
 Site-Infograph                     | Val  Loss: 1.6978 | Val  Acc: 0.4527
 Site-QuickDraw                     | Val  Loss: 2.1393 | Val  Acc: 0.2717
Average Valid Accuracy: 0.7181
============ Train epoch 12 ============
 Site-Real                          | Train Loss: 0.0177 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.2770 | Train Acc: 0.9112
 Site-Painting                      | Train Loss: 0.2755 | Train Acc: 0.8965
 Site-Sketch                        | Train Loss: 0.5033 | Train Acc: 0.8287
 Site-Infograph                     | Train Loss: 1.8584 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 1.7642 | Train Acc: 0.3551
Average Train Accuracy: 0.7385
 Site-Real                          | Val  Loss: 0.0930 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.3302 | Val  Acc: 0.8947
 Site-Painting                      | Val  Loss: 0.3891 | Val  Acc: 0.8632
 Site-Sketch                        | Val  Loss: 0.4722 | Val  Acc: 0.8439
 Site-Infograph                     | Val  Loss: 1.8693 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.2910 | Val  Acc: 0.2717
Average Valid Accuracy: 0.7228
============ Train epoch 13 ============
 Site-Real                          | Train Loss: 0.0164 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.2314 | Train Acc: 0.9232
 Site-Painting                      | Train Loss: 0.2440 | Train Acc: 0.9193
 Site-Sketch                        | Train Loss: 0.4420 | Train Acc: 0.8511
 Site-Infograph                     | Train Loss: 1.8704 | Train Acc: 0.4279
 Site-QuickDraw                     | Train Loss: 1.7328 | Train Acc: 0.3623
Average Train Accuracy: 0.7470
 Site-Real                          | Val  Loss: 0.0890 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.2880 | Val  Acc: 0.9112
 Site-Painting                      | Val  Loss: 0.3174 | Val  Acc: 0.8921
 Site-Sketch                        | Val  Loss: 0.3972 | Val  Acc: 0.8987
 Site-Infograph                     | Val  Loss: 1.7894 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.2042 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7499
 Best site-Real                      | Epoch:13 | Val Acc: 0.9805
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9112
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8921
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8987
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.4797
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.3370
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 14 ============
 Site-Real                          | Train Loss: 0.0151 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.2331 | Train Acc: 0.9254
 Site-Painting                      | Train Loss: 0.2684 | Train Acc: 0.9035
 Site-Sketch                        | Train Loss: 0.5314 | Train Acc: 0.8258
 Site-Infograph                     | Train Loss: 1.9070 | Train Acc: 0.4144
 Site-QuickDraw                     | Train Loss: 1.8739 | Train Acc: 0.3841
Average Train Accuracy: 0.7419
 Site-Real                          | Val  Loss: 0.0805 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.2925 | Val  Acc: 0.9095
 Site-Painting                      | Val  Loss: 0.3338 | Val  Acc: 0.9000
 Site-Sketch                        | Val  Loss: 0.4627 | Val  Acc: 0.8608
 Site-Infograph                     | Val  Loss: 1.9202 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.2566 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7411
============ Train epoch 15 ============
 Site-Real                          | Train Loss: 0.0148 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.2092 | Train Acc: 0.9342
 Site-Painting                      | Train Loss: 0.2742 | Train Acc: 0.9000
 Site-Sketch                        | Train Loss: 0.4643 | Train Acc: 0.8455
 Site-Infograph                     | Train Loss: 1.8987 | Train Acc: 0.4234
 Site-QuickDraw                     | Train Loss: 1.8782 | Train Acc: 0.2971
Average Train Accuracy: 0.7330
 Site-Real                          | Val  Loss: 0.0968 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.3041 | Val  Acc: 0.9161
 Site-Painting                      | Val  Loss: 0.3150 | Val  Acc: 0.9158
 Site-Sketch                        | Val  Loss: 0.3981 | Val  Acc: 0.8903
 Site-Infograph                     | Val  Loss: 2.0256 | Val  Acc: 0.4527
 Site-QuickDraw                     | Val  Loss: 2.2523 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7436
============ Train epoch 16 ============
 Site-Real                          | Train Loss: 0.0159 | Train Acc: 0.9959
 Site-Clipart                       | Train Loss: 0.1885 | Train Acc: 0.9474
 Site-Painting                      | Train Loss: 0.2458 | Train Acc: 0.9263
 Site-Sketch                        | Train Loss: 0.4754 | Train Acc: 0.8511
 Site-Infograph                     | Train Loss: 1.8478 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 2.2683 | Train Acc: 0.3261
Average Train Accuracy: 0.7480
 Site-Real                          | Val  Loss: 0.1049 | Val  Acc: 0.9784
 Site-Clipart                       | Val  Loss: 0.2914 | Val  Acc: 0.9112
 Site-Painting                      | Val  Loss: 0.3241 | Val  Acc: 0.8868
 Site-Sketch                        | Val  Loss: 0.5256 | Val  Acc: 0.8312
 Site-Infograph                     | Val  Loss: 1.9119 | Val  Acc: 0.4527
 Site-QuickDraw                     | Val  Loss: 2.2550 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7274
============ Train epoch 17 ============
 Site-Real                          | Train Loss: 0.0125 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1874 | Train Acc: 0.9353
 Site-Painting                      | Train Loss: 0.2577 | Train Acc: 0.9158
 Site-Sketch                        | Train Loss: 0.3820 | Train Acc: 0.8652
 Site-Infograph                     | Train Loss: 2.0099 | Train Acc: 0.3919
 Site-QuickDraw                     | Train Loss: 1.8694 | Train Acc: 0.3116
Average Train Accuracy: 0.7364
 Site-Real                          | Val  Loss: 0.0944 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.2823 | Val  Acc: 0.9178
 Site-Painting                      | Val  Loss: 0.3284 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.3542 | Val  Acc: 0.8819
 Site-Infograph                     | Val  Loss: 1.8330 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.4477 | Val  Acc: 0.2609
Average Valid Accuracy: 0.7373
============ Train epoch 18 ============
 Site-Real                          | Train Loss: 0.0145 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1865 | Train Acc: 0.9485
 Site-Painting                      | Train Loss: 0.2600 | Train Acc: 0.9035
 Site-Sketch                        | Train Loss: 0.4545 | Train Acc: 0.8680
 Site-Infograph                     | Train Loss: 1.9363 | Train Acc: 0.4279
 Site-QuickDraw                     | Train Loss: 1.9830 | Train Acc: 0.3406
Average Train Accuracy: 0.7476
 Site-Real                          | Val  Loss: 0.0970 | Val  Acc: 0.9856
 Site-Clipart                       | Val  Loss: 0.2887 | Val  Acc: 0.9145
 Site-Painting                      | Val  Loss: 0.3493 | Val  Acc: 0.8895
 Site-Sketch                        | Val  Loss: 0.4301 | Val  Acc: 0.8861
 Site-Infograph                     | Val  Loss: 1.9710 | Val  Acc: 0.4392
 Site-QuickDraw                     | Val  Loss: 2.3185 | Val  Acc: 0.2826
Average Valid Accuracy: 0.7329
============ Train epoch 19 ============
 Site-Real                          | Train Loss: 0.0101 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.2124 | Train Acc: 0.9232
 Site-Painting                      | Train Loss: 0.2566 | Train Acc: 0.9123
 Site-Sketch                        | Train Loss: 0.5016 | Train Acc: 0.8399
 Site-Infograph                     | Train Loss: 2.0987 | Train Acc: 0.4009
 Site-QuickDraw                     | Train Loss: 2.0462 | Train Acc: 0.3188
Average Train Accuracy: 0.7322
 Site-Real                          | Val  Loss: 0.1024 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.3193 | Val  Acc: 0.9030
 Site-Painting                      | Val  Loss: 0.3752 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.3860 | Val  Acc: 0.8776
 Site-Infograph                     | Val  Loss: 2.0720 | Val  Acc: 0.4324
 Site-QuickDraw                     | Val  Loss: 2.3069 | Val  Acc: 0.2609
Average Valid Accuracy: 0.7258
============ Train epoch 20 ============
 Site-Real                          | Train Loss: 0.0094 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1794 | Train Acc: 0.9539
 Site-Painting                      | Train Loss: 0.2259 | Train Acc: 0.9298
 Site-Sketch                        | Train Loss: 0.4319 | Train Acc: 0.8399
 Site-Infograph                     | Train Loss: 1.8673 | Train Acc: 0.4595
 Site-QuickDraw                     | Train Loss: 2.0797 | Train Acc: 0.2971
Average Train Accuracy: 0.7464
 Site-Real                          | Val  Loss: 0.0966 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.3094 | Val  Acc: 0.9194
 Site-Painting                      | Val  Loss: 0.3208 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.4413 | Val  Acc: 0.8650
 Site-Infograph                     | Val  Loss: 1.9123 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.2914 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7468
============ Train epoch 21 ============
 Site-Real                          | Train Loss: 0.0122 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1677 | Train Acc: 0.9539
 Site-Painting                      | Train Loss: 0.1736 | Train Acc: 0.9368
 Site-Sketch                        | Train Loss: 0.4044 | Train Acc: 0.8652
 Site-Infograph                     | Train Loss: 2.0092 | Train Acc: 0.4324
 Site-QuickDraw                     | Train Loss: 1.9993 | Train Acc: 0.3986
Average Train Accuracy: 0.7641
 Site-Real                          | Val  Loss: 0.1111 | Val  Acc: 0.9856
 Site-Clipart                       | Val  Loss: 0.2900 | Val  Acc: 0.9128
 Site-Painting                      | Val  Loss: 0.3276 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.3793 | Val  Acc: 0.8776
 Site-Infograph                     | Val  Loss: 1.7845 | Val  Acc: 0.5000
 Site-QuickDraw                     | Val  Loss: 2.2153 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7535
 Best site-Real                      | Epoch:21 | Val Acc: 0.9856
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9128
 Best site-Painting                  | Epoch:21 | Val Acc: 0.9079
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.8776
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.5000
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.3370
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 22 ============
 Site-Real                          | Train Loss: 0.0088 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1879 | Train Acc: 0.9419
 Site-Painting                      | Train Loss: 0.2211 | Train Acc: 0.9263
 Site-Sketch                        | Train Loss: 0.5118 | Train Acc: 0.8371
 Site-Infograph                     | Train Loss: 1.9785 | Train Acc: 0.4324
 Site-QuickDraw                     | Train Loss: 2.2389 | Train Acc: 0.3696
Average Train Accuracy: 0.7510
 Site-Real                          | Val  Loss: 0.1086 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.3095 | Val  Acc: 0.9161
 Site-Painting                      | Val  Loss: 0.3014 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.4133 | Val  Acc: 0.8692
 Site-Infograph                     | Val  Loss: 2.0816 | Val  Acc: 0.4324
 Site-QuickDraw                     | Val  Loss: 2.2452 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7375
============ Train epoch 23 ============
 Site-Real                          | Train Loss: 0.0084 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1805 | Train Acc: 0.9441
 Site-Painting                      | Train Loss: 0.2488 | Train Acc: 0.9246
 Site-Sketch                        | Train Loss: 0.4832 | Train Acc: 0.8371
 Site-Infograph                     | Train Loss: 1.9445 | Train Acc: 0.4324
 Site-QuickDraw                     | Train Loss: 1.9607 | Train Acc: 0.3551
Average Train Accuracy: 0.7486
 Site-Real                          | Val  Loss: 0.1016 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.2652 | Val  Acc: 0.9293
 Site-Painting                      | Val  Loss: 0.3203 | Val  Acc: 0.8947
 Site-Sketch                        | Val  Loss: 0.4691 | Val  Acc: 0.8565
 Site-Infograph                     | Val  Loss: 1.9347 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.2260 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7420
============ Train epoch 24 ============
 Site-Real                          | Train Loss: 0.0090 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1775 | Train Acc: 0.9474
 Site-Painting                      | Train Loss: 0.2415 | Train Acc: 0.9228
 Site-Sketch                        | Train Loss: 0.4754 | Train Acc: 0.8624
 Site-Infograph                     | Train Loss: 2.0537 | Train Acc: 0.4054
 Site-QuickDraw                     | Train Loss: 2.1108 | Train Acc: 0.3116
Average Train Accuracy: 0.7414
 Site-Real                          | Val  Loss: 0.1074 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.3063 | Val  Acc: 0.9227
 Site-Painting                      | Val  Loss: 0.3400 | Val  Acc: 0.9053
 Site-Sketch                        | Val  Loss: 0.3903 | Val  Acc: 0.8861
 Site-Infograph                     | Val  Loss: 2.0348 | Val  Acc: 0.4392
 Site-QuickDraw                     | Val  Loss: 2.3612 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7453
============ Train epoch 25 ============
 Site-Real                          | Train Loss: 0.0087 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1654 | Train Acc: 0.9572
 Site-Painting                      | Train Loss: 0.1988 | Train Acc: 0.9246
 Site-Sketch                        | Train Loss: 0.4684 | Train Acc: 0.8511
 Site-Infograph                     | Train Loss: 2.0213 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 1.7478 | Train Acc: 0.3551
Average Train Accuracy: 0.7547
 Site-Real                          | Val  Loss: 0.0963 | Val  Acc: 0.9784
 Site-Clipart                       | Val  Loss: 0.2324 | Val  Acc: 0.9359
 Site-Painting                      | Val  Loss: 0.2672 | Val  Acc: 0.9158
 Site-Sketch                        | Val  Loss: 0.3978 | Val  Acc: 0.8903
 Site-Infograph                     | Val  Loss: 2.0178 | Val  Acc: 0.4392
 Site-QuickDraw                     | Val  Loss: 2.2178 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7494
============ Train epoch 26 ============
 Site-Real                          | Train Loss: 0.0089 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1837 | Train Acc: 0.9419
 Site-Painting                      | Train Loss: 0.1937 | Train Acc: 0.9368
 Site-Sketch                        | Train Loss: 0.4052 | Train Acc: 0.8736
 Site-Infograph                     | Train Loss: 1.9022 | Train Acc: 0.4459
 Site-QuickDraw                     | Train Loss: 2.0305 | Train Acc: 0.3478
Average Train Accuracy: 0.7572
 Site-Real                          | Val  Loss: 0.0870 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.2628 | Val  Acc: 0.9194
 Site-Painting                      | Val  Loss: 0.2952 | Val  Acc: 0.9184
 Site-Sketch                        | Val  Loss: 0.4839 | Val  Acc: 0.8776
 Site-Infograph                     | Val  Loss: 1.9083 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.1589 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7502
============ Train epoch 27 ============
 Site-Real                          | Train Loss: 0.0084 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1613 | Train Acc: 0.9583
 Site-Painting                      | Train Loss: 0.1785 | Train Acc: 0.9421
 Site-Sketch                        | Train Loss: 0.4413 | Train Acc: 0.8539
 Site-Infograph                     | Train Loss: 1.9731 | Train Acc: 0.4234
 Site-QuickDraw                     | Train Loss: 1.8463 | Train Acc: 0.3623
Average Train Accuracy: 0.7563
 Site-Real                          | Val  Loss: 0.1005 | Val  Acc: 0.9877
 Site-Clipart                       | Val  Loss: 0.2488 | Val  Acc: 0.9276
 Site-Painting                      | Val  Loss: 0.3008 | Val  Acc: 0.9211
 Site-Sketch                        | Val  Loss: 0.4190 | Val  Acc: 0.8776
 Site-Infograph                     | Val  Loss: 1.9541 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 2.2356 | Val  Acc: 0.2935
Average Valid Accuracy: 0.7524
============ Train epoch 28 ============
 Site-Real                          | Train Loss: 0.0081 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1621 | Train Acc: 0.9518
 Site-Painting                      | Train Loss: 0.2091 | Train Acc: 0.9281
 Site-Sketch                        | Train Loss: 0.4923 | Train Acc: 0.8596
 Site-Infograph                     | Train Loss: 1.9300 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 1.6052 | Train Acc: 0.4130
Average Train Accuracy: 0.7691
 Site-Real                          | Val  Loss: 0.0817 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2802 | Val  Acc: 0.9161
 Site-Painting                      | Val  Loss: 0.3060 | Val  Acc: 0.8947
 Site-Sketch                        | Val  Loss: 0.4414 | Val  Acc: 0.8481
 Site-Infograph                     | Val  Loss: 2.1103 | Val  Acc: 0.4527
 Site-QuickDraw                     | Val  Loss: 2.2883 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7371
============ Train epoch 29 ============
 Site-Real                          | Train Loss: 0.0079 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1463 | Train Acc: 0.9496
 Site-Painting                      | Train Loss: 0.2330 | Train Acc: 0.9246
 Site-Sketch                        | Train Loss: 0.4386 | Train Acc: 0.8680
 Site-Infograph                     | Train Loss: 2.0104 | Train Acc: 0.4459
 Site-QuickDraw                     | Train Loss: 1.9878 | Train Acc: 0.3406
Average Train Accuracy: 0.7543
 Site-Real                          | Val  Loss: 0.1055 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.2531 | Val  Acc: 0.9276
 Site-Painting                      | Val  Loss: 0.3209 | Val  Acc: 0.9184
 Site-Sketch                        | Val  Loss: 0.4038 | Val  Acc: 0.8861
 Site-Infograph                     | Val  Loss: 2.1183 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.2654 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7488
============ Train epoch 30 ============
 Site-Real                          | Train Loss: 0.0070 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1587 | Train Acc: 0.9463
 Site-Painting                      | Train Loss: 0.1745 | Train Acc: 0.9368
 Site-Sketch                        | Train Loss: 0.4502 | Train Acc: 0.8624
 Site-Infograph                     | Train Loss: 2.0585 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 1.6189 | Train Acc: 0.3841
Average Train Accuracy: 0.7616
 Site-Real                          | Val  Loss: 0.0904 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.3124 | Val  Acc: 0.9046
 Site-Painting                      | Val  Loss: 0.3491 | Val  Acc: 0.9105
 Site-Sketch                        | Val  Loss: 0.3915 | Val  Acc: 0.8734
 Site-Infograph                     | Val  Loss: 2.1699 | Val  Acc: 0.4459
 Site-QuickDraw                     | Val  Loss: 2.4623 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7390
============ Train epoch 31 ============
 Site-Real                          | Train Loss: 0.0078 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1413 | Train Acc: 0.9507
 Site-Painting                      | Train Loss: 0.2081 | Train Acc: 0.9368
 Site-Sketch                        | Train Loss: 0.4948 | Train Acc: 0.8567
 Site-Infograph                     | Train Loss: 2.0276 | Train Acc: 0.3784
 Site-QuickDraw                     | Train Loss: 2.1691 | Train Acc: 0.4710
Average Train Accuracy: 0.7654
 Site-Real                          | Val  Loss: 0.1058 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2749 | Val  Acc: 0.9243
 Site-Painting                      | Val  Loss: 0.3001 | Val  Acc: 0.9211
 Site-Sketch                        | Val  Loss: 0.3611 | Val  Acc: 0.9030
 Site-Infograph                     | Val  Loss: 2.2194 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.4090 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7626
 Best site-Real                      | Epoch:31 | Val Acc: 0.9846
 Best site-Clipart                   | Epoch:31 | Val Acc: 0.9243
 Best site-Painting                  | Epoch:31 | Val Acc: 0.9211
 Best site-Sketch                    | Epoch:31 | Val Acc: 0.9030
 Best site-Infograph                 | Epoch:31 | Val Acc: 0.4730
 Best site-QuickDraw                 | Epoch:31 | Val Acc: 0.3696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 32 ============
 Site-Real                          | Train Loss: 0.0076 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1557 | Train Acc: 0.9529
 Site-Painting                      | Train Loss: 0.1802 | Train Acc: 0.9456
 Site-Sketch                        | Train Loss: 0.4235 | Train Acc: 0.8511
 Site-Infograph                     | Train Loss: 2.1392 | Train Acc: 0.4234
 Site-QuickDraw                     | Train Loss: 1.7883 | Train Acc: 0.4130
Average Train Accuracy: 0.7641
 Site-Real                          | Val  Loss: 0.0968 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.2745 | Val  Acc: 0.9211
 Site-Painting                      | Val  Loss: 0.3150 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.4352 | Val  Acc: 0.8776
 Site-Infograph                     | Val  Loss: 2.2686 | Val  Acc: 0.4122
 Site-QuickDraw                     | Val  Loss: 2.4168 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7488
============ Train epoch 33 ============
 Site-Real                          | Train Loss: 0.0079 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1527 | Train Acc: 0.9496
 Site-Painting                      | Train Loss: 0.1753 | Train Acc: 0.9526
 Site-Sketch                        | Train Loss: 0.3636 | Train Acc: 0.8680
 Site-Infograph                     | Train Loss: 2.0921 | Train Acc: 0.4279
 Site-QuickDraw                     | Train Loss: 2.0225 | Train Acc: 0.3986
Average Train Accuracy: 0.7658
 Site-Real                          | Val  Loss: 0.1094 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2730 | Val  Acc: 0.9391
 Site-Painting                      | Val  Loss: 0.3051 | Val  Acc: 0.9184
 Site-Sketch                        | Val  Loss: 0.4057 | Val  Acc: 0.8776
 Site-Infograph                     | Val  Loss: 2.2531 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.4797 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7593
============ Train epoch 34 ============
 Site-Real                          | Train Loss: 0.0074 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1305 | Train Acc: 0.9649
 Site-Painting                      | Train Loss: 0.1797 | Train Acc: 0.9456
 Site-Sketch                        | Train Loss: 0.4456 | Train Acc: 0.8736
 Site-Infograph                     | Train Loss: 2.0826 | Train Acc: 0.4505
 Site-QuickDraw                     | Train Loss: 2.3493 | Train Acc: 0.3768
Average Train Accuracy: 0.7683
 Site-Real                          | Val  Loss: 0.0946 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.2741 | Val  Acc: 0.9260
 Site-Painting                      | Val  Loss: 0.2232 | Val  Acc: 0.9368
 Site-Sketch                        | Val  Loss: 0.4132 | Val  Acc: 0.8523
 Site-Infograph                     | Val  Loss: 2.2526 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.6890 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7512
============ Train epoch 35 ============
 Site-Real                          | Train Loss: 0.0074 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1268 | Train Acc: 0.9627
 Site-Painting                      | Train Loss: 0.1574 | Train Acc: 0.9526
 Site-Sketch                        | Train Loss: 0.5025 | Train Acc: 0.8427
 Site-Infograph                     | Train Loss: 2.1491 | Train Acc: 0.4820
 Site-QuickDraw                     | Train Loss: 2.0326 | Train Acc: 0.3623
Average Train Accuracy: 0.7668
 Site-Real                          | Val  Loss: 0.1036 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.2535 | Val  Acc: 0.9243
 Site-Painting                      | Val  Loss: 0.3050 | Val  Acc: 0.9132
 Site-Sketch                        | Val  Loss: 0.3723 | Val  Acc: 0.8945
 Site-Infograph                     | Val  Loss: 2.2399 | Val  Acc: 0.4595
 Site-QuickDraw                     | Val  Loss: 2.6022 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7502
============ Train epoch 36 ============
 Site-Real                          | Train Loss: 0.0086 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1202 | Train Acc: 0.9627
 Site-Painting                      | Train Loss: 0.1966 | Train Acc: 0.9281
 Site-Sketch                        | Train Loss: 0.3632 | Train Acc: 0.8708
 Site-Infograph                     | Train Loss: 2.1230 | Train Acc: 0.4550
 Site-QuickDraw                     | Train Loss: 1.7064 | Train Acc: 0.3986
Average Train Accuracy: 0.7687
 Site-Real                          | Val  Loss: 0.1072 | Val  Acc: 0.9856
 Site-Clipart                       | Val  Loss: 0.2952 | Val  Acc: 0.9178
 Site-Painting                      | Val  Loss: 0.2882 | Val  Acc: 0.9289
 Site-Sketch                        | Val  Loss: 0.3980 | Val  Acc: 0.8734
 Site-Infograph                     | Val  Loss: 2.2511 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.4675 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7580
============ Train epoch 37 ============
 Site-Real                          | Train Loss: 0.0066 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1507 | Train Acc: 0.9583
 Site-Painting                      | Train Loss: 0.1739 | Train Acc: 0.9386
 Site-Sketch                        | Train Loss: 0.4801 | Train Acc: 0.8567
 Site-Infograph                     | Train Loss: 2.3078 | Train Acc: 0.4099
 Site-QuickDraw                     | Train Loss: 2.5056 | Train Acc: 0.3478
Average Train Accuracy: 0.7516
 Site-Real                          | Val  Loss: 0.1128 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.2629 | Val  Acc: 0.9293
 Site-Painting                      | Val  Loss: 0.2591 | Val  Acc: 0.9211
 Site-Sketch                        | Val  Loss: 0.4838 | Val  Acc: 0.8692
 Site-Infograph                     | Val  Loss: 2.1629 | Val  Acc: 0.5135
 Site-QuickDraw                     | Val  Loss: 2.5426 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7551
============ Train epoch 38 ============
 Site-Real                          | Train Loss: 0.0069 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1184 | Train Acc: 0.9594
 Site-Painting                      | Train Loss: 0.1746 | Train Acc: 0.9474
 Site-Sketch                        | Train Loss: 0.3319 | Train Acc: 0.8764
 Site-Infograph                     | Train Loss: 2.1208 | Train Acc: 0.4595
 Site-QuickDraw                     | Train Loss: 1.8036 | Train Acc: 0.4275
Average Train Accuracy: 0.7781
 Site-Real                          | Val  Loss: 0.1020 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2398 | Val  Acc: 0.9276
 Site-Painting                      | Val  Loss: 0.2984 | Val  Acc: 0.9026
 Site-Sketch                        | Val  Loss: 0.4705 | Val  Acc: 0.8776
 Site-Infograph                     | Val  Loss: 2.1487 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.2294 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7515
============ Train epoch 39 ============
 Site-Real                          | Train Loss: 0.0050 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1228 | Train Acc: 0.9572
 Site-Painting                      | Train Loss: 0.1729 | Train Acc: 0.9404
 Site-Sketch                        | Train Loss: 0.4713 | Train Acc: 0.8567
 Site-Infograph                     | Train Loss: 2.0629 | Train Acc: 0.4369
 Site-QuickDraw                     | Train Loss: 2.1465 | Train Acc: 0.4203
Average Train Accuracy: 0.7684
 Site-Real                          | Val  Loss: 0.1087 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.2680 | Val  Acc: 0.9260
 Site-Painting                      | Val  Loss: 0.2910 | Val  Acc: 0.9184
 Site-Sketch                        | Val  Loss: 0.3763 | Val  Acc: 0.8903
 Site-Infograph                     | Val  Loss: 2.1789 | Val  Acc: 0.4459
 Site-QuickDraw                     | Val  Loss: 2.3897 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7520
============ Train epoch 40 ============
 Site-Real                          | Train Loss: 0.0063 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1251 | Train Acc: 0.9594
 Site-Painting                      | Train Loss: 0.1961 | Train Acc: 0.9298
 Site-Sketch                        | Train Loss: 0.3646 | Train Acc: 0.8820
 Site-Infograph                     | Train Loss: 2.2574 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 2.2274 | Train Acc: 0.3913
Average Train Accuracy: 0.7670
 Site-Real                          | Val  Loss: 0.1112 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.2664 | Val  Acc: 0.9375
 Site-Painting                      | Val  Loss: 0.3035 | Val  Acc: 0.9105
 Site-Sketch                        | Val  Loss: 0.3924 | Val  Acc: 0.8650
 Site-Infograph                     | Val  Loss: 2.3733 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.5675 | Val  Acc: 0.2826
Average Valid Accuracy: 0.7418
============ Train epoch 41 ============
 Site-Real                          | Train Loss: 0.0057 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1154 | Train Acc: 0.9627
 Site-Painting                      | Train Loss: 0.1151 | Train Acc: 0.9614
 Site-Sketch                        | Train Loss: 0.3973 | Train Acc: 0.8652
 Site-Infograph                     | Train Loss: 2.0045 | Train Acc: 0.4595
 Site-QuickDraw                     | Train Loss: 2.3369 | Train Acc: 0.3913
Average Train Accuracy: 0.7731
 Site-Real                          | Val  Loss: 0.1200 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2789 | Val  Acc: 0.9178
 Site-Painting                      | Val  Loss: 0.2549 | Val  Acc: 0.9184
 Site-Sketch                        | Val  Loss: 0.4425 | Val  Acc: 0.8650
 Site-Infograph                     | Val  Loss: 2.1493 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.3786 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7558
============ Train epoch 42 ============
 Site-Real                          | Train Loss: 0.0057 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1158 | Train Acc: 0.9649
 Site-Painting                      | Train Loss: 0.1670 | Train Acc: 0.9474
 Site-Sketch                        | Train Loss: 0.4562 | Train Acc: 0.8567
 Site-Infograph                     | Train Loss: 2.1493 | Train Acc: 0.4459
 Site-QuickDraw                     | Train Loss: 2.2531 | Train Acc: 0.4275
Average Train Accuracy: 0.7735
 Site-Real                          | Val  Loss: 0.1156 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2569 | Val  Acc: 0.9309
 Site-Painting                      | Val  Loss: 0.3152 | Val  Acc: 0.9132
 Site-Sketch                        | Val  Loss: 0.4965 | Val  Acc: 0.8523
 Site-Infograph                     | Val  Loss: 2.2382 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.4733 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7507
============ Train epoch 43 ============
 Site-Real                          | Train Loss: 0.0059 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1395 | Train Acc: 0.9485
 Site-Painting                      | Train Loss: 0.1606 | Train Acc: 0.9474
 Site-Sketch                        | Train Loss: 0.4029 | Train Acc: 0.8539
 Site-Infograph                     | Train Loss: 2.2022 | Train Acc: 0.3919
 Site-QuickDraw                     | Train Loss: 2.0240 | Train Acc: 0.3623
Average Train Accuracy: 0.7503
 Site-Real                          | Val  Loss: 0.1141 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.3013 | Val  Acc: 0.9112
 Site-Painting                      | Val  Loss: 0.2985 | Val  Acc: 0.9026
 Site-Sketch                        | Val  Loss: 0.3832 | Val  Acc: 0.8734
 Site-Infograph                     | Val  Loss: 2.3394 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.3208 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7458
============ Train epoch 44 ============
 Site-Real                          | Train Loss: 0.0058 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1396 | Train Acc: 0.9572
 Site-Painting                      | Train Loss: 0.1701 | Train Acc: 0.9386
 Site-Sketch                        | Train Loss: 0.4826 | Train Acc: 0.8567
 Site-Infograph                     | Train Loss: 2.1496 | Train Acc: 0.4189
 Site-QuickDraw                     | Train Loss: 2.3616 | Train Acc: 0.3986
Average Train Accuracy: 0.7613
 Site-Real                          | Val  Loss: 0.1060 | Val  Acc: 0.9856
 Site-Clipart                       | Val  Loss: 0.3143 | Val  Acc: 0.9095
 Site-Painting                      | Val  Loss: 0.3151 | Val  Acc: 0.9053
 Site-Sketch                        | Val  Loss: 0.4195 | Val  Acc: 0.8565
 Site-Infograph                     | Val  Loss: 2.3003 | Val  Acc: 0.4527
 Site-QuickDraw                     | Val  Loss: 2.3707 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7375
============ Train epoch 45 ============
 Site-Real                          | Train Loss: 0.0054 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1234 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.1312 | Train Acc: 0.9596
 Site-Sketch                        | Train Loss: 0.4049 | Train Acc: 0.8792
 Site-Infograph                     | Train Loss: 2.2696 | Train Acc: 0.4369
 Site-QuickDraw                     | Train Loss: 2.1464 | Train Acc: 0.3986
Average Train Accuracy: 0.7734
 Site-Real                          | Val  Loss: 0.1179 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2420 | Val  Acc: 0.9424
 Site-Painting                      | Val  Loss: 0.3380 | Val  Acc: 0.9184
 Site-Sketch                        | Val  Loss: 0.4534 | Val  Acc: 0.8987
 Site-Infograph                     | Val  Loss: 2.2445 | Val  Acc: 0.5135
 Site-QuickDraw                     | Val  Loss: 2.3026 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7676
 Best site-Real                      | Epoch:45 | Val Acc: 0.9846
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.9424
 Best site-Painting                  | Epoch:45 | Val Acc: 0.9184
 Best site-Sketch                    | Epoch:45 | Val Acc: 0.8987
 Best site-Infograph                 | Epoch:45 | Val Acc: 0.5135
 Best site-QuickDraw                 | Epoch:45 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/fedsam...
============ Train epoch 46 ============
 Site-Real                          | Train Loss: 0.0051 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1177 | Train Acc: 0.9627
 Site-Painting                      | Train Loss: 0.1499 | Train Acc: 0.9596
 Site-Sketch                        | Train Loss: 0.4377 | Train Acc: 0.8624
 Site-Infograph                     | Train Loss: 2.0447 | Train Acc: 0.4685
 Site-QuickDraw                     | Train Loss: 1.7824 | Train Acc: 0.4710
Average Train Accuracy: 0.7871
 Site-Real                          | Val  Loss: 0.1206 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.2382 | Val  Acc: 0.9293
 Site-Painting                      | Val  Loss: 0.2566 | Val  Acc: 0.9289
 Site-Sketch                        | Val  Loss: 0.4152 | Val  Acc: 0.8650
 Site-Infograph                     | Val  Loss: 2.0010 | Val  Acc: 0.5338
 Site-QuickDraw                     | Val  Loss: 2.3554 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7622
============ Train epoch 47 ============
 Site-Real                          | Train Loss: 0.0051 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1252 | Train Acc: 0.9583
 Site-Painting                      | Train Loss: 0.1449 | Train Acc: 0.9561
 Site-Sketch                        | Train Loss: 0.3540 | Train Acc: 0.8792
 Site-Infograph                     | Train Loss: 2.0671 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 1.9892 | Train Acc: 0.4130
Average Train Accuracy: 0.7745
 Site-Real                          | Val  Loss: 0.1229 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2439 | Val  Acc: 0.9326
 Site-Painting                      | Val  Loss: 0.3390 | Val  Acc: 0.9132
 Site-Sketch                        | Val  Loss: 0.4558 | Val  Acc: 0.8650
 Site-Infograph                     | Val  Loss: 2.3128 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.5709 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7549
============ Train epoch 48 ============
 Site-Real                          | Train Loss: 0.0051 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1216 | Train Acc: 0.9616
 Site-Painting                      | Train Loss: 0.1429 | Train Acc: 0.9596
 Site-Sketch                        | Train Loss: 0.3918 | Train Acc: 0.8848
 Site-Infograph                     | Train Loss: 1.9589 | Train Acc: 0.4775
 Site-QuickDraw                     | Train Loss: 2.1961 | Train Acc: 0.3768
Average Train Accuracy: 0.7765
 Site-Real                          | Val  Loss: 0.1066 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.3154 | Val  Acc: 0.9161
 Site-Painting                      | Val  Loss: 0.3532 | Val  Acc: 0.9289
 Site-Sketch                        | Val  Loss: 0.4123 | Val  Acc: 0.8861
 Site-Infograph                     | Val  Loss: 2.3212 | Val  Acc: 0.5000
 Site-QuickDraw                     | Val  Loss: 2.4262 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7602
============ Train epoch 49 ============
 Site-Real                          | Train Loss: 0.0064 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1137 | Train Acc: 0.9638
 Site-Painting                      | Train Loss: 0.1483 | Train Acc: 0.9509
 Site-Sketch                        | Train Loss: 0.3714 | Train Acc: 0.8567
 Site-Infograph                     | Train Loss: 2.2097 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 2.0224 | Train Acc: 0.4058
Average Train Accuracy: 0.7732
 Site-Real                          | Val  Loss: 0.0924 | Val  Acc: 0.9856
 Site-Clipart                       | Val  Loss: 0.2663 | Val  Acc: 0.9309
 Site-Painting                      | Val  Loss: 0.2582 | Val  Acc: 0.9184
 Site-Sketch                        | Val  Loss: 0.3319 | Val  Acc: 0.9030
 Site-Infograph                     | Val  Loss: 2.1298 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.4790 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7613
===2023-07-02 12:49:10===
===2023-07-02 12:49:12===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1459,912,570,356,222,138,
client_nums=[1,1,1,1,1,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
Loading snapshots...
 Test site-Real                      | Epoch:45 | Test Acc: 0.9729
 Test site-Clipart                   | Epoch:45 | Test Acc: 0.9221
 Test site-Painting                  | Epoch:45 | Test Acc: 0.9225
 Test site-Sketch                    | Epoch:45 | Test Acc: 0.8538
 Test site-Infograph                 | Epoch:45 | Test Acc: 0.4855
 Test site-QuickDraw                 | Epoch:45 | Test Acc: 0.5350
Real: 0.9729, Clipart: 0.9221, Painting: 0.9225, Sketch: 0.8538, Infograph: 0.4855, QuickDraw: 0.5350, 
Average Test Accuracy(group): 0.7820, Average Test Accuracy(individual): 0.7820,
domain std=0.1957, cluster std=-1.0000, individual std=0.1957, 
