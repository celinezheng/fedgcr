===2023-07-02 05:03:11===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1459,912,570,356,222,138,
client_nums=[1,1,1,1,1,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
============ Train epoch 0 ============
 Site-Real                          | Train Loss: 0.2911 | Train Acc: 0.9664
 Site-Clipart                       | Train Loss: 0.8934 | Train Acc: 0.7248
 Site-Painting                      | Train Loss: 0.6491 | Train Acc: 0.8246
 Site-Sketch                        | Train Loss: 0.9055 | Train Acc: 0.7135
 Site-Infograph                     | Train Loss: 1.7776 | Train Acc: 0.3559
 Site-QuickDraw                     | Train Loss: 2.1933 | Train Acc: 0.2609
Average Train Accuracy: 0.6410
 Site-Real                          | Val  Loss: 0.3032 | Val  Acc: 0.9630
 Site-Clipart                       | Val  Loss: 0.8699 | Val  Acc: 0.7336
 Site-Painting                      | Val  Loss: 0.6765 | Val  Acc: 0.8000
 Site-Sketch                        | Val  Loss: 0.8685 | Val  Acc: 0.7384
 Site-Infograph                     | Val  Loss: 1.7172 | Val  Acc: 0.4122
 Site-QuickDraw                     | Val  Loss: 2.3217 | Val  Acc: 0.2283
Average Valid Accuracy: 0.6459
 Best site-Real                      | Epoch:0 | Val Acc: 0.9630
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7336
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8000
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7384
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.4122
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.2283
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 1 ============
 Site-Real                          | Train Loss: 0.1547 | Train Acc: 0.9733
 Site-Clipart                       | Train Loss: 0.5703 | Train Acc: 0.8333
 Site-Painting                      | Train Loss: 0.4692 | Train Acc: 0.8596
 Site-Sketch                        | Train Loss: 0.7152 | Train Acc: 0.7640
 Site-Infograph                     | Train Loss: 1.7055 | Train Acc: 0.3964
 Site-QuickDraw                     | Train Loss: 2.0533 | Train Acc: 0.2971
Average Train Accuracy: 0.6873
 Site-Real                          | Val  Loss: 0.1797 | Val  Acc: 0.9712
 Site-Clipart                       | Val  Loss: 0.6215 | Val  Acc: 0.8174
 Site-Painting                      | Val  Loss: 0.4842 | Val  Acc: 0.8526
 Site-Sketch                        | Val  Loss: 0.6240 | Val  Acc: 0.8143
 Site-Infograph                     | Val  Loss: 1.6801 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.3961 | Val  Acc: 0.2174
Average Valid Accuracy: 0.6899
 Best site-Real                      | Epoch:1 | Val Acc: 0.9712
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8174
 Best site-Painting                  | Epoch:1 | Val Acc: 0.8526
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.8143
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4662
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 2 ============
 Site-Real                          | Train Loss: 0.1077 | Train Acc: 0.9788
 Site-Clipart                       | Train Loss: 0.4723 | Train Acc: 0.8761
 Site-Painting                      | Train Loss: 0.4512 | Train Acc: 0.8649
 Site-Sketch                        | Train Loss: 0.6727 | Train Acc: 0.7612
 Site-Infograph                     | Train Loss: 1.7253 | Train Acc: 0.3829
 Site-QuickDraw                     | Train Loss: 1.9408 | Train Acc: 0.3623
Average Train Accuracy: 0.7044
 Site-Real                          | Val  Loss: 0.1415 | Val  Acc: 0.9753
 Site-Clipart                       | Val  Loss: 0.5069 | Val  Acc: 0.8520
 Site-Painting                      | Val  Loss: 0.4354 | Val  Acc: 0.8553
 Site-Sketch                        | Val  Loss: 0.5615 | Val  Acc: 0.7975
 Site-Infograph                     | Val  Loss: 1.5545 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.2239 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7136
 Best site-Real                      | Epoch:2 | Val Acc: 0.9753
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8520
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8553
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7975
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4865
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.3152
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 3 ============
 Site-Real                          | Train Loss: 0.0842 | Train Acc: 0.9883
 Site-Clipart                       | Train Loss: 0.4402 | Train Acc: 0.8772
 Site-Painting                      | Train Loss: 0.3946 | Train Acc: 0.8772
 Site-Sketch                        | Train Loss: 0.5783 | Train Acc: 0.8034
 Site-Infograph                     | Train Loss: 1.7302 | Train Acc: 0.4099
 Site-QuickDraw                     | Train Loss: 2.0102 | Train Acc: 0.3696
Average Train Accuracy: 0.7209
 Site-Real                          | Val  Loss: 0.1095 | Val  Acc: 0.9753
 Site-Clipart                       | Val  Loss: 0.4744 | Val  Acc: 0.8651
 Site-Painting                      | Val  Loss: 0.4361 | Val  Acc: 0.8605
 Site-Sketch                        | Val  Loss: 0.5081 | Val  Acc: 0.8228
 Site-Infograph                     | Val  Loss: 1.5936 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.2163 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7180
 Best site-Real                      | Epoch:3 | Val Acc: 0.9753
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8651
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8605
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.8228
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.4797
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 4 ============
 Site-Real                          | Train Loss: 0.0718 | Train Acc: 0.9883
 Site-Clipart                       | Train Loss: 0.3727 | Train Acc: 0.9035
 Site-Painting                      | Train Loss: 0.3339 | Train Acc: 0.8930
 Site-Sketch                        | Train Loss: 0.5474 | Train Acc: 0.8258
 Site-Infograph                     | Train Loss: 1.7118 | Train Acc: 0.4550
 Site-QuickDraw                     | Train Loss: 1.7781 | Train Acc: 0.3768
Average Train Accuracy: 0.7404
 Site-Real                          | Val  Loss: 0.1254 | Val  Acc: 0.9763
 Site-Clipart                       | Val  Loss: 0.4134 | Val  Acc: 0.8914
 Site-Painting                      | Val  Loss: 0.3818 | Val  Acc: 0.8789
 Site-Sketch                        | Val  Loss: 0.5382 | Val  Acc: 0.8186
 Site-Infograph                     | Val  Loss: 1.5984 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.0738 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7346
 Best site-Real                      | Epoch:4 | Val Acc: 0.9763
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8914
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8789
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8186
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.4730
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.3696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 5 ============
 Site-Real                          | Train Loss: 0.0565 | Train Acc: 0.9911
 Site-Clipart                       | Train Loss: 0.3353 | Train Acc: 0.9079
 Site-Painting                      | Train Loss: 0.3639 | Train Acc: 0.8789
 Site-Sketch                        | Train Loss: 0.5779 | Train Acc: 0.8062
 Site-Infograph                     | Train Loss: 1.7642 | Train Acc: 0.4234
 Site-QuickDraw                     | Train Loss: 1.8791 | Train Acc: 0.3551
Average Train Accuracy: 0.7271
 Site-Real                          | Val  Loss: 0.1032 | Val  Acc: 0.9774
 Site-Clipart                       | Val  Loss: 0.3653 | Val  Acc: 0.9046
 Site-Painting                      | Val  Loss: 0.3875 | Val  Acc: 0.8789
 Site-Sketch                        | Val  Loss: 0.4979 | Val  Acc: 0.8481
 Site-Infograph                     | Val  Loss: 1.7171 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.2549 | Val  Acc: 0.2826
Average Valid Accuracy: 0.7308
============ Train epoch 6 ============
 Site-Real                          | Train Loss: 0.0497 | Train Acc: 0.9938
 Site-Clipart                       | Train Loss: 0.3059 | Train Acc: 0.9134
 Site-Painting                      | Train Loss: 0.3493 | Train Acc: 0.8895
 Site-Sketch                        | Train Loss: 0.5496 | Train Acc: 0.8202
 Site-Infograph                     | Train Loss: 1.7594 | Train Acc: 0.3874
 Site-QuickDraw                     | Train Loss: 1.9385 | Train Acc: 0.3623
Average Train Accuracy: 0.7278
 Site-Real                          | Val  Loss: 0.1104 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.3876 | Val  Acc: 0.8914
 Site-Painting                      | Val  Loss: 0.3637 | Val  Acc: 0.8895
 Site-Sketch                        | Val  Loss: 0.4759 | Val  Acc: 0.8354
 Site-Infograph                     | Val  Loss: 1.5561 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.2417 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7303
============ Train epoch 7 ============
 Site-Real                          | Train Loss: 0.0396 | Train Acc: 0.9952
 Site-Clipart                       | Train Loss: 0.3055 | Train Acc: 0.9145
 Site-Painting                      | Train Loss: 0.3152 | Train Acc: 0.8877
 Site-Sketch                        | Train Loss: 0.5008 | Train Acc: 0.8062
 Site-Infograph                     | Train Loss: 1.8381 | Train Acc: 0.4054
 Site-QuickDraw                     | Train Loss: 1.9116 | Train Acc: 0.3333
Average Train Accuracy: 0.7237
 Site-Real                          | Val  Loss: 0.1154 | Val  Acc: 0.9784
 Site-Clipart                       | Val  Loss: 0.3758 | Val  Acc: 0.8799
 Site-Painting                      | Val  Loss: 0.3577 | Val  Acc: 0.8658
 Site-Sketch                        | Val  Loss: 0.4663 | Val  Acc: 0.8608
 Site-Infograph                     | Val  Loss: 1.7772 | Val  Acc: 0.4527
 Site-QuickDraw                     | Val  Loss: 2.2793 | Val  Acc: 0.3587
Average Valid Accuracy: 0.7327
============ Train epoch 8 ============
 Site-Real                          | Train Loss: 0.0380 | Train Acc: 0.9959
 Site-Clipart                       | Train Loss: 0.2752 | Train Acc: 0.9276
 Site-Painting                      | Train Loss: 0.3412 | Train Acc: 0.8842
 Site-Sketch                        | Train Loss: 0.5218 | Train Acc: 0.8287
 Site-Infograph                     | Train Loss: 1.7167 | Train Acc: 0.4279
 Site-QuickDraw                     | Train Loss: 2.0016 | Train Acc: 0.3333
Average Train Accuracy: 0.7329
 Site-Real                          | Val  Loss: 0.0960 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.3827 | Val  Acc: 0.8816
 Site-Painting                      | Val  Loss: 0.3367 | Val  Acc: 0.8895
 Site-Sketch                        | Val  Loss: 0.4636 | Val  Acc: 0.8481
 Site-Infograph                     | Val  Loss: 1.6988 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.3971 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7332
============ Train epoch 9 ============
 Site-Real                          | Train Loss: 0.0378 | Train Acc: 0.9945
 Site-Clipart                       | Train Loss: 0.2603 | Train Acc: 0.9265
 Site-Painting                      | Train Loss: 0.3204 | Train Acc: 0.9035
 Site-Sketch                        | Train Loss: 0.4894 | Train Acc: 0.8399
 Site-Infograph                     | Train Loss: 1.7288 | Train Acc: 0.4099
 Site-QuickDraw                     | Train Loss: 1.9881 | Train Acc: 0.3696
Average Train Accuracy: 0.7407
 Site-Real                          | Val  Loss: 0.0897 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.3528 | Val  Acc: 0.9046
 Site-Painting                      | Val  Loss: 0.3412 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.4419 | Val  Acc: 0.8397
 Site-Infograph                     | Val  Loss: 1.6523 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.0004 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7437
 Best site-Real                      | Epoch:9 | Val Acc: 0.9794
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9046
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8974
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8397
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.4932
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 10 ============
 Site-Real                          | Train Loss: 0.0329 | Train Acc: 0.9959
 Site-Clipart                       | Train Loss: 0.2542 | Train Acc: 0.9331
 Site-Painting                      | Train Loss: 0.2990 | Train Acc: 0.9088
 Site-Sketch                        | Train Loss: 0.5591 | Train Acc: 0.8090
 Site-Infograph                     | Train Loss: 1.6335 | Train Acc: 0.4595
 Site-QuickDraw                     | Train Loss: 2.0362 | Train Acc: 0.3333
Average Train Accuracy: 0.7399
 Site-Real                          | Val  Loss: 0.0968 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.3123 | Val  Acc: 0.9112
 Site-Painting                      | Val  Loss: 0.3551 | Val  Acc: 0.8868
 Site-Sketch                        | Val  Loss: 0.4534 | Val  Acc: 0.8692
 Site-Infograph                     | Val  Loss: 1.7145 | Val  Acc: 0.4595
 Site-QuickDraw                     | Val  Loss: 2.3146 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7392
============ Train epoch 11 ============
 Site-Real                          | Train Loss: 0.0276 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.3032 | Train Acc: 0.9178
 Site-Painting                      | Train Loss: 0.3395 | Train Acc: 0.8965
 Site-Sketch                        | Train Loss: 0.5073 | Train Acc: 0.8287
 Site-Infograph                     | Train Loss: 1.5935 | Train Acc: 0.4550
 Site-QuickDraw                     | Train Loss: 1.8663 | Train Acc: 0.3551
Average Train Accuracy: 0.7417
 Site-Real                          | Val  Loss: 0.0953 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.3472 | Val  Acc: 0.8964
 Site-Painting                      | Val  Loss: 0.3317 | Val  Acc: 0.8947
 Site-Sketch                        | Val  Loss: 0.5220 | Val  Acc: 0.8397
 Site-Infograph                     | Val  Loss: 1.6713 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.2246 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7341
============ Train epoch 12 ============
 Site-Real                          | Train Loss: 0.0277 | Train Acc: 0.9959
 Site-Clipart                       | Train Loss: 0.2715 | Train Acc: 0.9331
 Site-Painting                      | Train Loss: 0.3097 | Train Acc: 0.9070
 Site-Sketch                        | Train Loss: 0.5043 | Train Acc: 0.8399
 Site-Infograph                     | Train Loss: 1.7686 | Train Acc: 0.4234
 Site-QuickDraw                     | Train Loss: 1.7327 | Train Acc: 0.3623
Average Train Accuracy: 0.7436
 Site-Real                          | Val  Loss: 0.1022 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.3116 | Val  Acc: 0.9062
 Site-Painting                      | Val  Loss: 0.3689 | Val  Acc: 0.8684
 Site-Sketch                        | Val  Loss: 0.4585 | Val  Acc: 0.8608
 Site-Infograph                     | Val  Loss: 1.7559 | Val  Acc: 0.4527
 Site-QuickDraw                     | Val  Loss: 2.2154 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7344
============ Train epoch 13 ============
 Site-Real                          | Train Loss: 0.0222 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.2470 | Train Acc: 0.9298
 Site-Painting                      | Train Loss: 0.2841 | Train Acc: 0.9018
 Site-Sketch                        | Train Loss: 0.4625 | Train Acc: 0.8399
 Site-Infograph                     | Train Loss: 1.7659 | Train Acc: 0.4279
 Site-QuickDraw                     | Train Loss: 1.6645 | Train Acc: 0.3551
Average Train Accuracy: 0.7420
 Site-Real                          | Val  Loss: 0.0856 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.2837 | Val  Acc: 0.9276
 Site-Painting                      | Val  Loss: 0.3473 | Val  Acc: 0.8947
 Site-Sketch                        | Val  Loss: 0.4360 | Val  Acc: 0.8608
 Site-Infograph                     | Val  Loss: 1.7651 | Val  Acc: 0.4392
 Site-QuickDraw                     | Val  Loss: 2.1367 | Val  Acc: 0.4022
Average Valid Accuracy: 0.7510
 Best site-Real                      | Epoch:13 | Val Acc: 0.9815
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9276
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8947
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8608
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.4392
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.4022
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 14 ============
 Site-Real                          | Train Loss: 0.0237 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.2487 | Train Acc: 0.9331
 Site-Painting                      | Train Loss: 0.3059 | Train Acc: 0.8947
 Site-Sketch                        | Train Loss: 0.4970 | Train Acc: 0.8230
 Site-Infograph                     | Train Loss: 1.7259 | Train Acc: 0.4279
 Site-QuickDraw                     | Train Loss: 1.8726 | Train Acc: 0.3333
Average Train Accuracy: 0.7350
 Site-Real                          | Val  Loss: 0.0768 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.2966 | Val  Acc: 0.9128
 Site-Painting                      | Val  Loss: 0.3283 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.4223 | Val  Acc: 0.8650
 Site-Infograph                     | Val  Loss: 1.7231 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.1059 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7538
 Best site-Real                      | Epoch:14 | Val Acc: 0.9835
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9128
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8974
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8650
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.4730
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 15 ============
 Site-Real                          | Train Loss: 0.0242 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.2377 | Train Acc: 0.9353
 Site-Painting                      | Train Loss: 0.3036 | Train Acc: 0.9088
 Site-Sketch                        | Train Loss: 0.4489 | Train Acc: 0.8455
 Site-Infograph                     | Train Loss: 1.7431 | Train Acc: 0.4144
 Site-QuickDraw                     | Train Loss: 1.7256 | Train Acc: 0.3551
Average Train Accuracy: 0.7427
 Site-Real                          | Val  Loss: 0.0942 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.3187 | Val  Acc: 0.9062
 Site-Painting                      | Val  Loss: 0.3300 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.3927 | Val  Acc: 0.8987
 Site-Infograph                     | Val  Loss: 1.8407 | Val  Acc: 0.4459
 Site-QuickDraw                     | Val  Loss: 2.1208 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7459
============ Train epoch 16 ============
 Site-Real                          | Train Loss: 0.0232 | Train Acc: 0.9952
 Site-Clipart                       | Train Loss: 0.2193 | Train Acc: 0.9452
 Site-Painting                      | Train Loss: 0.2770 | Train Acc: 0.9053
 Site-Sketch                        | Train Loss: 0.4567 | Train Acc: 0.8511
 Site-Infograph                     | Train Loss: 1.7241 | Train Acc: 0.4144
 Site-QuickDraw                     | Train Loss: 1.9869 | Train Acc: 0.4058
Average Train Accuracy: 0.7528
 Site-Real                          | Val  Loss: 0.1007 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.3064 | Val  Acc: 0.9079
 Site-Painting                      | Val  Loss: 0.3206 | Val  Acc: 0.8921
 Site-Sketch                        | Val  Loss: 0.5377 | Val  Acc: 0.8439
 Site-Infograph                     | Val  Loss: 1.8011 | Val  Acc: 0.4324
 Site-QuickDraw                     | Val  Loss: 2.1055 | Val  Acc: 0.3587
Average Valid Accuracy: 0.7357
============ Train epoch 17 ============
 Site-Real                          | Train Loss: 0.0214 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.2203 | Train Acc: 0.9331
 Site-Painting                      | Train Loss: 0.2858 | Train Acc: 0.9088
 Site-Sketch                        | Train Loss: 0.4235 | Train Acc: 0.8539
 Site-Infograph                     | Train Loss: 1.8086 | Train Acc: 0.4144
 Site-QuickDraw                     | Train Loss: 1.7558 | Train Acc: 0.3696
Average Train Accuracy: 0.7462
 Site-Real                          | Val  Loss: 0.0826 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.2934 | Val  Acc: 0.9112
 Site-Painting                      | Val  Loss: 0.3219 | Val  Acc: 0.8895
 Site-Sketch                        | Val  Loss: 0.4029 | Val  Acc: 0.8819
 Site-Infograph                     | Val  Loss: 1.6128 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.1466 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7558
 Best site-Real                      | Epoch:17 | Val Acc: 0.9815
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9112
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8895
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8819
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.4797
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 18 ============
 Site-Real                          | Train Loss: 0.0245 | Train Acc: 0.9966
 Site-Clipart                       | Train Loss: 0.2273 | Train Acc: 0.9375
 Site-Painting                      | Train Loss: 0.3010 | Train Acc: 0.8912
 Site-Sketch                        | Train Loss: 0.4564 | Train Acc: 0.8652
 Site-Infograph                     | Train Loss: 1.7495 | Train Acc: 0.4054
 Site-QuickDraw                     | Train Loss: 1.7143 | Train Acc: 0.3768
Average Train Accuracy: 0.7454
 Site-Real                          | Val  Loss: 0.0859 | Val  Acc: 0.9856
 Site-Clipart                       | Val  Loss: 0.3001 | Val  Acc: 0.9112
 Site-Painting                      | Val  Loss: 0.3517 | Val  Acc: 0.8816
 Site-Sketch                        | Val  Loss: 0.4553 | Val  Acc: 0.8354
 Site-Infograph                     | Val  Loss: 1.7935 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.1499 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7325
============ Train epoch 19 ============
 Site-Real                          | Train Loss: 0.0191 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.2262 | Train Acc: 0.9353
 Site-Painting                      | Train Loss: 0.2922 | Train Acc: 0.9105
 Site-Sketch                        | Train Loss: 0.5106 | Train Acc: 0.8539
 Site-Infograph                     | Train Loss: 1.7728 | Train Acc: 0.4144
 Site-QuickDraw                     | Train Loss: 1.8581 | Train Acc: 0.4130
Average Train Accuracy: 0.7543
 Site-Real                          | Val  Loss: 0.0838 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.3005 | Val  Acc: 0.9161
 Site-Painting                      | Val  Loss: 0.3685 | Val  Acc: 0.8842
 Site-Sketch                        | Val  Loss: 0.4758 | Val  Acc: 0.8523
 Site-Infograph                     | Val  Loss: 1.7376 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.1051 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7401
============ Train epoch 20 ============
 Site-Real                          | Train Loss: 0.0180 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.2114 | Train Acc: 0.9452
 Site-Painting                      | Train Loss: 0.2770 | Train Acc: 0.9018
 Site-Sketch                        | Train Loss: 0.4922 | Train Acc: 0.8343
 Site-Infograph                     | Train Loss: 1.7339 | Train Acc: 0.4144
 Site-QuickDraw                     | Train Loss: 2.1148 | Train Acc: 0.3551
Average Train Accuracy: 0.7414
 Site-Real                          | Val  Loss: 0.0922 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.3244 | Val  Acc: 0.9112
 Site-Painting                      | Val  Loss: 0.3221 | Val  Acc: 0.8947
 Site-Sketch                        | Val  Loss: 0.4758 | Val  Acc: 0.8397
 Site-Infograph                     | Val  Loss: 1.7575 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 2.2555 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7469
============ Train epoch 21 ============
 Site-Real                          | Train Loss: 0.0218 | Train Acc: 0.9959
 Site-Clipart                       | Train Loss: 0.2003 | Train Acc: 0.9529
 Site-Painting                      | Train Loss: 0.2229 | Train Acc: 0.9351
 Site-Sketch                        | Train Loss: 0.4251 | Train Acc: 0.8511
 Site-Infograph                     | Train Loss: 1.7516 | Train Acc: 0.4369
 Site-QuickDraw                     | Train Loss: 1.9052 | Train Acc: 0.3986
Average Train Accuracy: 0.7617
 Site-Real                          | Val  Loss: 0.1142 | Val  Acc: 0.9856
 Site-Clipart                       | Val  Loss: 0.3148 | Val  Acc: 0.9095
 Site-Painting                      | Val  Loss: 0.3199 | Val  Acc: 0.9105
 Site-Sketch                        | Val  Loss: 0.4421 | Val  Acc: 0.8903
 Site-Infograph                     | Val  Loss: 1.6541 | Val  Acc: 0.5203
 Site-QuickDraw                     | Val  Loss: 2.1233 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7607
 Best site-Real                      | Epoch:21 | Val Acc: 0.9856
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9095
 Best site-Painting                  | Epoch:21 | Val Acc: 0.9105
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.8903
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.5203
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 22 ============
 Site-Real                          | Train Loss: 0.0170 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.2234 | Train Acc: 0.9408
 Site-Painting                      | Train Loss: 0.2670 | Train Acc: 0.9140
 Site-Sketch                        | Train Loss: 0.5164 | Train Acc: 0.8174
 Site-Infograph                     | Train Loss: 1.7121 | Train Acc: 0.4685
 Site-QuickDraw                     | Train Loss: 2.1023 | Train Acc: 0.3623
Average Train Accuracy: 0.7503
 Site-Real                          | Val  Loss: 0.0888 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.3060 | Val  Acc: 0.9161
 Site-Painting                      | Val  Loss: 0.3169 | Val  Acc: 0.8947
 Site-Sketch                        | Val  Loss: 0.4217 | Val  Acc: 0.8439
 Site-Infograph                     | Val  Loss: 1.7450 | Val  Acc: 0.4527
 Site-QuickDraw                     | Val  Loss: 2.1399 | Val  Acc: 0.3804
Average Valid Accuracy: 0.7447
============ Train epoch 23 ============
 Site-Real                          | Train Loss: 0.0189 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.2028 | Train Acc: 0.9463
 Site-Painting                      | Train Loss: 0.2899 | Train Acc: 0.9123
 Site-Sketch                        | Train Loss: 0.4860 | Train Acc: 0.8258
 Site-Infograph                     | Train Loss: 1.7196 | Train Acc: 0.4459
 Site-QuickDraw                     | Train Loss: 1.7785 | Train Acc: 0.4058
Average Train Accuracy: 0.7557
 Site-Real                          | Val  Loss: 0.0882 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2696 | Val  Acc: 0.9293
 Site-Painting                      | Val  Loss: 0.3412 | Val  Acc: 0.8868
 Site-Sketch                        | Val  Loss: 0.4233 | Val  Acc: 0.8481
 Site-Infograph                     | Val  Loss: 1.6917 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.0794 | Val  Acc: 0.3804
Average Valid Accuracy: 0.7504
============ Train epoch 24 ============
 Site-Real                          | Train Loss: 0.0196 | Train Acc: 0.9966
 Site-Clipart                       | Train Loss: 0.1955 | Train Acc: 0.9452
 Site-Painting                      | Train Loss: 0.2652 | Train Acc: 0.9175
 Site-Sketch                        | Train Loss: 0.4596 | Train Acc: 0.8483
 Site-Infograph                     | Train Loss: 1.7717 | Train Acc: 0.4234
 Site-QuickDraw                     | Train Loss: 1.8766 | Train Acc: 0.3696
Average Train Accuracy: 0.7501
 Site-Real                          | Val  Loss: 0.1148 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.3208 | Val  Acc: 0.9227
 Site-Painting                      | Val  Loss: 0.3326 | Val  Acc: 0.9000
 Site-Sketch                        | Val  Loss: 0.3938 | Val  Acc: 0.8565
 Site-Infograph                     | Val  Loss: 1.6993 | Val  Acc: 0.5068
 Site-QuickDraw                     | Val  Loss: 2.0708 | Val  Acc: 0.3587
Average Valid Accuracy: 0.7544
============ Train epoch 25 ============
 Site-Real                          | Train Loss: 0.0173 | Train Acc: 0.9966
 Site-Clipart                       | Train Loss: 0.2081 | Train Acc: 0.9529
 Site-Painting                      | Train Loss: 0.2427 | Train Acc: 0.9211
 Site-Sketch                        | Train Loss: 0.4978 | Train Acc: 0.8399
 Site-Infograph                     | Train Loss: 1.8351 | Train Acc: 0.4550
 Site-QuickDraw                     | Train Loss: 1.6398 | Train Acc: 0.4348
Average Train Accuracy: 0.7667
 Site-Real                          | Val  Loss: 0.0914 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.2565 | Val  Acc: 0.9260
 Site-Painting                      | Val  Loss: 0.3099 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.4061 | Val  Acc: 0.8861
 Site-Infograph                     | Val  Loss: 1.6941 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.1065 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7550
============ Train epoch 26 ============
 Site-Real                          | Train Loss: 0.0170 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.2211 | Train Acc: 0.9408
 Site-Painting                      | Train Loss: 0.2538 | Train Acc: 0.9211
 Site-Sketch                        | Train Loss: 0.4043 | Train Acc: 0.8652
 Site-Infograph                     | Train Loss: 1.7066 | Train Acc: 0.4144
 Site-QuickDraw                     | Train Loss: 1.9251 | Train Acc: 0.3478
Average Train Accuracy: 0.7478
 Site-Real                          | Val  Loss: 0.0833 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.2891 | Val  Acc: 0.9243
 Site-Painting                      | Val  Loss: 0.3334 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.4585 | Val  Acc: 0.8734
 Site-Infograph                     | Val  Loss: 1.6669 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.1078 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7466
============ Train epoch 27 ============
 Site-Real                          | Train Loss: 0.0187 | Train Acc: 0.9959
 Site-Clipart                       | Train Loss: 0.2104 | Train Acc: 0.9507
 Site-Painting                      | Train Loss: 0.2261 | Train Acc: 0.9263
 Site-Sketch                        | Train Loss: 0.4566 | Train Acc: 0.8567
 Site-Infograph                     | Train Loss: 1.7188 | Train Acc: 0.3964
 Site-QuickDraw                     | Train Loss: 1.8115 | Train Acc: 0.3623
Average Train Accuracy: 0.7481
 Site-Real                          | Val  Loss: 0.1081 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2818 | Val  Acc: 0.9260
 Site-Painting                      | Val  Loss: 0.3161 | Val  Acc: 0.9053
 Site-Sketch                        | Val  Loss: 0.4275 | Val  Acc: 0.8439
 Site-Infograph                     | Val  Loss: 1.6457 | Val  Acc: 0.4595
 Site-QuickDraw                     | Val  Loss: 2.0606 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7373
============ Train epoch 28 ============
 Site-Real                          | Train Loss: 0.0171 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1848 | Train Acc: 0.9550
 Site-Painting                      | Train Loss: 0.2585 | Train Acc: 0.9140
 Site-Sketch                        | Train Loss: 0.5073 | Train Acc: 0.8371
 Site-Infograph                     | Train Loss: 1.6149 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 1.6150 | Train Acc: 0.4130
Average Train Accuracy: 0.7634
 Site-Real                          | Val  Loss: 0.0732 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.2801 | Val  Acc: 0.9211
 Site-Painting                      | Val  Loss: 0.2883 | Val  Acc: 0.8921
 Site-Sketch                        | Val  Loss: 0.4648 | Val  Acc: 0.8270
 Site-Infograph                     | Val  Loss: 1.7491 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 1.9898 | Val  Acc: 0.3587
Average Valid Accuracy: 0.7411
============ Train epoch 29 ============
 Site-Real                          | Train Loss: 0.0149 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1853 | Train Acc: 0.9572
 Site-Painting                      | Train Loss: 0.2790 | Train Acc: 0.9053
 Site-Sketch                        | Train Loss: 0.4778 | Train Acc: 0.8399
 Site-Infograph                     | Train Loss: 1.7540 | Train Acc: 0.4369
 Site-QuickDraw                     | Train Loss: 1.8679 | Train Acc: 0.4203
Average Train Accuracy: 0.7596
 Site-Real                          | Val  Loss: 0.1041 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.2882 | Val  Acc: 0.9243
 Site-Painting                      | Val  Loss: 0.3288 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.4355 | Val  Acc: 0.8692
 Site-Infograph                     | Val  Loss: 1.6682 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.0421 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7479
============ Train epoch 30 ============
 Site-Real                          | Train Loss: 0.0151 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1925 | Train Acc: 0.9474
 Site-Painting                      | Train Loss: 0.2422 | Train Acc: 0.9333
 Site-Sketch                        | Train Loss: 0.4525 | Train Acc: 0.8455
 Site-Infograph                     | Train Loss: 1.7017 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 1.6522 | Train Acc: 0.3986
Average Train Accuracy: 0.7646
 Site-Real                          | Val  Loss: 0.0727 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.2856 | Val  Acc: 0.9227
 Site-Painting                      | Val  Loss: 0.3457 | Val  Acc: 0.9000
 Site-Sketch                        | Val  Loss: 0.4381 | Val  Acc: 0.8608
 Site-Infograph                     | Val  Loss: 1.6967 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.2581 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7412
============ Train epoch 31 ============
 Site-Real                          | Train Loss: 0.0150 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1970 | Train Acc: 0.9397
 Site-Painting                      | Train Loss: 0.2651 | Train Acc: 0.9158
 Site-Sketch                        | Train Loss: 0.4773 | Train Acc: 0.8371
 Site-Infograph                     | Train Loss: 1.6623 | Train Acc: 0.4144
 Site-QuickDraw                     | Train Loss: 1.9395 | Train Acc: 0.4638
Average Train Accuracy: 0.7614
 Site-Real                          | Val  Loss: 0.1069 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.3118 | Val  Acc: 0.9095
 Site-Painting                      | Val  Loss: 0.3234 | Val  Acc: 0.8921
 Site-Sketch                        | Val  Loss: 0.4219 | Val  Acc: 0.8734
 Site-Infograph                     | Val  Loss: 1.8481 | Val  Acc: 0.4459
 Site-QuickDraw                     | Val  Loss: 2.1149 | Val  Acc: 0.3804
Average Valid Accuracy: 0.7470
============ Train epoch 32 ============
 Site-Real                          | Train Loss: 0.0181 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.2025 | Train Acc: 0.9485
 Site-Painting                      | Train Loss: 0.2239 | Train Acc: 0.9298
 Site-Sketch                        | Train Loss: 0.4267 | Train Acc: 0.8596
 Site-Infograph                     | Train Loss: 1.7407 | Train Acc: 0.4144
 Site-QuickDraw                     | Train Loss: 1.7100 | Train Acc: 0.4203
Average Train Accuracy: 0.7616
 Site-Real                          | Val  Loss: 0.0806 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.2743 | Val  Acc: 0.9178
 Site-Painting                      | Val  Loss: 0.3106 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.4756 | Val  Acc: 0.8481
 Site-Infograph                     | Val  Loss: 1.7220 | Val  Acc: 0.4459
 Site-QuickDraw                     | Val  Loss: 2.2215 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7361
============ Train epoch 33 ============
 Site-Real                          | Train Loss: 0.0151 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1981 | Train Acc: 0.9397
 Site-Painting                      | Train Loss: 0.2554 | Train Acc: 0.9211
 Site-Sketch                        | Train Loss: 0.3880 | Train Acc: 0.8680
 Site-Infograph                     | Train Loss: 1.7601 | Train Acc: 0.4324
 Site-QuickDraw                     | Train Loss: 1.8237 | Train Acc: 0.3986
Average Train Accuracy: 0.7597
 Site-Real                          | Val  Loss: 0.0896 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.2790 | Val  Acc: 0.9260
 Site-Painting                      | Val  Loss: 0.3421 | Val  Acc: 0.8974
 Site-Sketch                        | Val  Loss: 0.4292 | Val  Acc: 0.8692
 Site-Infograph                     | Val  Loss: 1.7967 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.3089 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7479
============ Train epoch 34 ============
 Site-Real                          | Train Loss: 0.0159 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1871 | Train Acc: 0.9616
 Site-Painting                      | Train Loss: 0.2428 | Train Acc: 0.9228
 Site-Sketch                        | Train Loss: 0.4736 | Train Acc: 0.8596
 Site-Infograph                     | Train Loss: 1.7281 | Train Acc: 0.4550
 Site-QuickDraw                     | Train Loss: 2.0604 | Train Acc: 0.3406
Average Train Accuracy: 0.7561
 Site-Real                          | Val  Loss: 0.0744 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2705 | Val  Acc: 0.9161
 Site-Painting                      | Val  Loss: 0.2674 | Val  Acc: 0.9184
 Site-Sketch                        | Val  Loss: 0.4224 | Val  Acc: 0.8439
 Site-Infograph                     | Val  Loss: 1.7824 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.3780 | Val  Acc: 0.2935
Average Valid Accuracy: 0.7416
============ Train epoch 35 ============
 Site-Real                          | Train Loss: 0.0157 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1708 | Train Acc: 0.9529
 Site-Painting                      | Train Loss: 0.2454 | Train Acc: 0.9298
 Site-Sketch                        | Train Loss: 0.4592 | Train Acc: 0.8511
 Site-Infograph                     | Train Loss: 1.7373 | Train Acc: 0.4279
 Site-QuickDraw                     | Train Loss: 1.9335 | Train Acc: 0.3768
Average Train Accuracy: 0.7560
 Site-Real                          | Val  Loss: 0.0997 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.2674 | Val  Acc: 0.9161
 Site-Painting                      | Val  Loss: 0.3218 | Val  Acc: 0.9053
 Site-Sketch                        | Val  Loss: 0.3864 | Val  Acc: 0.8819
 Site-Infograph                     | Val  Loss: 1.7236 | Val  Acc: 0.4730
 Site-QuickDraw                     | Val  Loss: 2.2562 | Val  Acc: 0.3152
Average Valid Accuracy: 0.7455
============ Train epoch 36 ============
 Site-Real                          | Train Loss: 0.0150 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1716 | Train Acc: 0.9605
 Site-Painting                      | Train Loss: 0.2766 | Train Acc: 0.8947
 Site-Sketch                        | Train Loss: 0.3997 | Train Acc: 0.8483
 Site-Infograph                     | Train Loss: 1.6440 | Train Acc: 0.4459
 Site-QuickDraw                     | Train Loss: 1.5657 | Train Acc: 0.4203
Average Train Accuracy: 0.7613
 Site-Real                          | Val  Loss: 0.1004 | Val  Acc: 0.9866
 Site-Clipart                       | Val  Loss: 0.2669 | Val  Acc: 0.9178
 Site-Painting                      | Val  Loss: 0.3430 | Val  Acc: 0.9000
 Site-Sketch                        | Val  Loss: 0.4275 | Val  Acc: 0.8650
 Site-Infograph                     | Val  Loss: 1.6761 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.1653 | Val  Acc: 0.3370
Average Valid Accuracy: 0.7477
============ Train epoch 37 ============
 Site-Real                          | Train Loss: 0.0161 | Train Acc: 0.9959
 Site-Clipart                       | Train Loss: 0.1987 | Train Acc: 0.9572
 Site-Painting                      | Train Loss: 0.2380 | Train Acc: 0.9333
 Site-Sketch                        | Train Loss: 0.4482 | Train Acc: 0.8483
 Site-Infograph                     | Train Loss: 1.7927 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 2.0906 | Train Acc: 0.3986
Average Train Accuracy: 0.7625
 Site-Real                          | Val  Loss: 0.1144 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.2767 | Val  Acc: 0.9260
 Site-Painting                      | Val  Loss: 0.2755 | Val  Acc: 0.9132
 Site-Sketch                        | Val  Loss: 0.4724 | Val  Acc: 0.8565
 Site-Infograph                     | Val  Loss: 1.6386 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.1231 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7470
============ Train epoch 38 ============
 Site-Real                          | Train Loss: 0.0172 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1712 | Train Acc: 0.9539
 Site-Painting                      | Train Loss: 0.2384 | Train Acc: 0.9263
 Site-Sketch                        | Train Loss: 0.3642 | Train Acc: 0.8848
 Site-Infograph                     | Train Loss: 1.7831 | Train Acc: 0.4505
 Site-QuickDraw                     | Train Loss: 1.6359 | Train Acc: 0.4638
Average Train Accuracy: 0.7794
 Site-Real                          | Val  Loss: 0.0934 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.2637 | Val  Acc: 0.9309
 Site-Painting                      | Val  Loss: 0.3283 | Val  Acc: 0.9026
 Site-Sketch                        | Val  Loss: 0.4263 | Val  Acc: 0.8565
 Site-Infograph                     | Val  Loss: 1.7194 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.0212 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7582
============ Train epoch 39 ============
 Site-Real                          | Train Loss: 0.0143 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1696 | Train Acc: 0.9583
 Site-Painting                      | Train Loss: 0.2490 | Train Acc: 0.9211
 Site-Sketch                        | Train Loss: 0.4637 | Train Acc: 0.8511
 Site-Infograph                     | Train Loss: 1.6996 | Train Acc: 0.4550
 Site-QuickDraw                     | Train Loss: 1.6767 | Train Acc: 0.4420
Average Train Accuracy: 0.7710
 Site-Real                          | Val  Loss: 0.0954 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.2731 | Val  Acc: 0.9178
 Site-Painting                      | Val  Loss: 0.3137 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.4023 | Val  Acc: 0.8523
 Site-Infograph                     | Val  Loss: 1.6595 | Val  Acc: 0.5000
 Site-QuickDraw                     | Val  Loss: 2.0468 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7443
============ Train epoch 40 ============
 Site-Real                          | Train Loss: 0.0166 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1820 | Train Acc: 0.9518
 Site-Painting                      | Train Loss: 0.2515 | Train Acc: 0.9175
 Site-Sketch                        | Train Loss: 0.3879 | Train Acc: 0.8680
 Site-Infograph                     | Train Loss: 1.7096 | Train Acc: 0.4505
 Site-QuickDraw                     | Train Loss: 1.7830 | Train Acc: 0.4275
Average Train Accuracy: 0.7688
 Site-Real                          | Val  Loss: 0.0902 | Val  Acc: 0.9794
 Site-Clipart                       | Val  Loss: 0.2689 | Val  Acc: 0.9211
 Site-Painting                      | Val  Loss: 0.3071 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.4053 | Val  Acc: 0.8565
 Site-Infograph                     | Val  Loss: 1.7708 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.2338 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7546
============ Train epoch 41 ============
 Site-Real                          | Train Loss: 0.0154 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1801 | Train Acc: 0.9507
 Site-Painting                      | Train Loss: 0.1869 | Train Acc: 0.9509
 Site-Sketch                        | Train Loss: 0.4437 | Train Acc: 0.8539
 Site-Infograph                     | Train Loss: 1.6154 | Train Acc: 0.4730
 Site-QuickDraw                     | Train Loss: 1.9327 | Train Acc: 0.4275
Average Train Accuracy: 0.7757
 Site-Real                          | Val  Loss: 0.1118 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.2796 | Val  Acc: 0.9260
 Site-Painting                      | Val  Loss: 0.2918 | Val  Acc: 0.9026
 Site-Sketch                        | Val  Loss: 0.4553 | Val  Acc: 0.8523
 Site-Infograph                     | Val  Loss: 1.6756 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.0579 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7464
============ Train epoch 42 ============
 Site-Real                          | Train Loss: 0.0149 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1772 | Train Acc: 0.9550
 Site-Painting                      | Train Loss: 0.2355 | Train Acc: 0.9281
 Site-Sketch                        | Train Loss: 0.4433 | Train Acc: 0.8539
 Site-Infograph                     | Train Loss: 1.6789 | Train Acc: 0.4640
 Site-QuickDraw                     | Train Loss: 1.9518 | Train Acc: 0.4493
Average Train Accuracy: 0.7746
 Site-Real                          | Val  Loss: 0.1058 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.2637 | Val  Acc: 0.9211
 Site-Painting                      | Val  Loss: 0.3169 | Val  Acc: 0.9000
 Site-Sketch                        | Val  Loss: 0.4705 | Val  Acc: 0.8481
 Site-Infograph                     | Val  Loss: 1.6283 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.0350 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7515
============ Train epoch 43 ============
 Site-Real                          | Train Loss: 0.0147 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1822 | Train Acc: 0.9397
 Site-Painting                      | Train Loss: 0.2406 | Train Acc: 0.9316
 Site-Sketch                        | Train Loss: 0.3967 | Train Acc: 0.8764
 Site-Infograph                     | Train Loss: 1.7253 | Train Acc: 0.4550
 Site-QuickDraw                     | Train Loss: 1.6658 | Train Acc: 0.4855
Average Train Accuracy: 0.7809
 Site-Real                          | Val  Loss: 0.1193 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.2875 | Val  Acc: 0.9194
 Site-Painting                      | Val  Loss: 0.3179 | Val  Acc: 0.9053
 Site-Sketch                        | Val  Loss: 0.3641 | Val  Acc: 0.8692
 Site-Infograph                     | Val  Loss: 1.7918 | Val  Acc: 0.4932
 Site-QuickDraw                     | Val  Loss: 2.0547 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7600
============ Train epoch 44 ============
 Site-Real                          | Train Loss: 0.0130 | Train Acc: 0.9979
 Site-Clipart                       | Train Loss: 0.1883 | Train Acc: 0.9474
 Site-Painting                      | Train Loss: 0.2313 | Train Acc: 0.9263
 Site-Sketch                        | Train Loss: 0.4261 | Train Acc: 0.8539
 Site-Infograph                     | Train Loss: 1.7322 | Train Acc: 0.4414
 Site-QuickDraw                     | Train Loss: 2.0041 | Train Acc: 0.4058
Average Train Accuracy: 0.7621
 Site-Real                          | Val  Loss: 0.0923 | Val  Acc: 0.9835
 Site-Clipart                       | Val  Loss: 0.2840 | Val  Acc: 0.9079
 Site-Painting                      | Val  Loss: 0.3103 | Val  Acc: 0.9184
 Site-Sketch                        | Val  Loss: 0.4298 | Val  Acc: 0.8692
 Site-Infograph                     | Val  Loss: 1.7785 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 1.9561 | Val  Acc: 0.3913
Average Valid Accuracy: 0.7595
============ Train epoch 45 ============
 Site-Real                          | Train Loss: 0.0137 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1874 | Train Acc: 0.9583
 Site-Painting                      | Train Loss: 0.2235 | Train Acc: 0.9386
 Site-Sketch                        | Train Loss: 0.4726 | Train Acc: 0.8511
 Site-Infograph                     | Train Loss: 1.7695 | Train Acc: 0.4279
 Site-QuickDraw                     | Train Loss: 1.9669 | Train Acc: 0.4203
Average Train Accuracy: 0.7656
 Site-Real                          | Val  Loss: 0.0914 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2720 | Val  Acc: 0.9326
 Site-Painting                      | Val  Loss: 0.3168 | Val  Acc: 0.9026
 Site-Sketch                        | Val  Loss: 0.4253 | Val  Acc: 0.8692
 Site-Infograph                     | Val  Loss: 1.7548 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 1.9357 | Val  Acc: 0.4130
Average Valid Accuracy: 0.7614
 Best site-Real                      | Epoch:45 | Val Acc: 0.9846
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.9326
 Best site-Painting                  | Epoch:45 | Val Acc: 0.9026
 Best site-Sketch                    | Epoch:45 | Val Acc: 0.8692
 Best site-Infograph                 | Epoch:45 | Val Acc: 0.4662
 Best site-QuickDraw                 | Epoch:45 | Val Acc: 0.4130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_distinct/harmo-fl...
============ Train epoch 46 ============
 Site-Real                          | Train Loss: 0.0139 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1946 | Train Acc: 0.9452
 Site-Painting                      | Train Loss: 0.2325 | Train Acc: 0.9333
 Site-Sketch                        | Train Loss: 0.4560 | Train Acc: 0.8315
 Site-Infograph                     | Train Loss: 1.7328 | Train Acc: 0.4459
 Site-QuickDraw                     | Train Loss: 1.7727 | Train Acc: 0.4493
Average Train Accuracy: 0.7673
 Site-Real                          | Val  Loss: 0.0878 | Val  Acc: 0.9805
 Site-Clipart                       | Val  Loss: 0.2603 | Val  Acc: 0.9326
 Site-Painting                      | Val  Loss: 0.2956 | Val  Acc: 0.9000
 Site-Sketch                        | Val  Loss: 0.4380 | Val  Acc: 0.8523
 Site-Infograph                     | Val  Loss: 1.7021 | Val  Acc: 0.4662
 Site-QuickDraw                     | Val  Loss: 2.0637 | Val  Acc: 0.3478
Average Valid Accuracy: 0.7466
============ Train epoch 47 ============
 Site-Real                          | Train Loss: 0.0138 | Train Acc: 0.9973
 Site-Clipart                       | Train Loss: 0.1886 | Train Acc: 0.9518
 Site-Painting                      | Train Loss: 0.2396 | Train Acc: 0.9316
 Site-Sketch                        | Train Loss: 0.3960 | Train Acc: 0.8652
 Site-Infograph                     | Train Loss: 1.6568 | Train Acc: 0.4505
 Site-QuickDraw                     | Train Loss: 1.6986 | Train Acc: 0.4348
Average Train Accuracy: 0.7718
 Site-Real                          | Val  Loss: 0.1106 | Val  Acc: 0.9846
 Site-Clipart                       | Val  Loss: 0.2526 | Val  Acc: 0.9293
 Site-Painting                      | Val  Loss: 0.3417 | Val  Acc: 0.9053
 Site-Sketch                        | Val  Loss: 0.4251 | Val  Acc: 0.8565
 Site-Infograph                     | Val  Loss: 1.7273 | Val  Acc: 0.4865
 Site-QuickDraw                     | Val  Loss: 2.0844 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7480
============ Train epoch 48 ============
 Site-Real                          | Train Loss: 0.0148 | Train Acc: 0.9986
 Site-Clipart                       | Train Loss: 0.1879 | Train Acc: 0.9529
 Site-Painting                      | Train Loss: 0.2153 | Train Acc: 0.9316
 Site-Sketch                        | Train Loss: 0.4192 | Train Acc: 0.8708
 Site-Infograph                     | Train Loss: 1.5792 | Train Acc: 0.4820
 Site-QuickDraw                     | Train Loss: 1.8862 | Train Acc: 0.4130
Average Train Accuracy: 0.7748
 Site-Real                          | Val  Loss: 0.0932 | Val  Acc: 0.9825
 Site-Clipart                       | Val  Loss: 0.2997 | Val  Acc: 0.9211
 Site-Painting                      | Val  Loss: 0.3460 | Val  Acc: 0.9105
 Site-Sketch                        | Val  Loss: 0.4123 | Val  Acc: 0.8819
 Site-Infograph                     | Val  Loss: 1.6805 | Val  Acc: 0.4797
 Site-QuickDraw                     | Val  Loss: 2.0141 | Val  Acc: 0.3696
Average Valid Accuracy: 0.7575
============ Train epoch 49 ============
 Site-Real                          | Train Loss: 0.0212 | Train Acc: 0.9952
 Site-Clipart                       | Train Loss: 0.1820 | Train Acc: 0.9463
 Site-Painting                      | Train Loss: 0.2389 | Train Acc: 0.9228
 Site-Sketch                        | Train Loss: 0.4152 | Train Acc: 0.8596
 Site-Infograph                     | Train Loss: 1.7113 | Train Acc: 0.4369
 Site-QuickDraw                     | Train Loss: 1.7323 | Train Acc: 0.3841
Average Train Accuracy: 0.7575
 Site-Real                          | Val  Loss: 0.0680 | Val  Acc: 0.9815
 Site-Clipart                       | Val  Loss: 0.2751 | Val  Acc: 0.9227
 Site-Painting                      | Val  Loss: 0.2891 | Val  Acc: 0.9026
 Site-Sketch                        | Val  Loss: 0.3642 | Val  Acc: 0.8861
 Site-Infograph                     | Val  Loss: 1.5935 | Val  Acc: 0.5000
 Site-QuickDraw                     | Val  Loss: 2.0404 | Val  Acc: 0.3261
Average Valid Accuracy: 0.7532
===2023-07-02 09:51:12===
===2023-07-02 09:51:14===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1459,912,570,356,222,138,
client_nums=[1,1,1,1,1,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
Loading snapshots...
 Test site-Real                      | Epoch:45 | Test Acc: 0.9729
 Test site-Clipart                   | Epoch:45 | Test Acc: 0.9316
 Test site-Painting                  | Epoch:45 | Test Acc: 0.9176
 Test site-Sketch                    | Epoch:45 | Test Acc: 0.8538
 Test site-Infograph                 | Epoch:45 | Test Acc: 0.4901
 Test site-QuickDraw                 | Epoch:45 | Test Acc: 0.5100
Real: 0.9729, Clipart: 0.9316, Painting: 0.9176, Sketch: 0.8538, Infograph: 0.4901, QuickDraw: 0.5100, 
Average Test Accuracy(group): 0.7793, Average Test Accuracy(individual): 0.7793,
domain std=0.2006, cluster std=-1.0000, individual std=0.2006, 
