===2023-07-02 02:51:37===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1459,912,570,356,222,138,
client_nums=[1,1,1,1,1,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Real                      (1) | Train Loss: 1.0233 | Train Acc: 0.8958
 Site-Clipart                   (4) | Train Loss: 1.5507 | Train Acc: 0.5746
 Site-Painting                  (1) | Train Loss: 1.3609 | Train Acc: 0.6667
 Site-Sketch                    (3) | Train Loss: 1.5913 | Train Acc: 0.5309
 Site-Infograph                 (2) | Train Loss: 2.1525 | Train Acc: 0.2658
 Site-QuickDraw                 (0) | Train Loss: 2.3501 | Train Acc: 0.1812
Average Train Accuracy: 0.5191
 Site-Real                      (1) | Val  Loss: 1.0112 | Val  Acc: 0.9043
 Site-Clipart                   (4) | Val  Loss: 1.5948 | Val  Acc: 0.5576
 Site-Painting                  (1) | Val  Loss: 1.3620 | Val  Acc: 0.6605
 Site-Sketch                    (3) | Val  Loss: 1.6024 | Val  Acc: 0.5570
 Site-Infograph                 (2) | Val  Loss: 2.0833 | Val  Acc: 0.2635
 Site-QuickDraw                 (0) | Val  Loss: 2.3447 | Val  Acc: 0.1522
Average Valid Accuracy: 0.5158
 Best site-Real                     (1)  | Epoch:0 | Val Acc: 0.9043
 Best site-Clipart                  (4)  | Epoch:0 | Val Acc: 0.5576
 Best site-Painting                 (1)  | Epoch:0 | Val Acc: 0.6605
 Best site-Sketch                   (3)  | Epoch:0 | Val Acc: 0.5570
 Best site-Infograph                (2)  | Epoch:0 | Val Acc: 0.2635
 Best site-QuickDraw                (0)  | Epoch:0 | Val Acc: 0.1522
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Real                      (2) | Train Loss: 0.5940 | Train Acc: 0.9349
 Site-Clipart                   (4) | Train Loss: 1.0402 | Train Acc: 0.7719
 Site-Painting                  (2) | Train Loss: 0.8739 | Train Acc: 0.8088
 Site-Sketch                    (3) | Train Loss: 1.0240 | Train Acc: 0.7388
 Site-Infograph                 (0) | Train Loss: 1.8144 | Train Acc: 0.4054
 Site-QuickDraw                 (1) | Train Loss: 2.1458 | Train Acc: 0.2319
Average Train Accuracy: 0.6486
 Site-Real                      (2) | Val  Loss: 0.5996 | Val  Acc: 0.9331
 Site-Clipart                   (4) | Val  Loss: 1.0887 | Val  Acc: 0.7615
 Site-Painting                  (2) | Val  Loss: 0.8523 | Val  Acc: 0.8263
 Site-Sketch                    (3) | Val  Loss: 1.1222 | Val  Acc: 0.7004
 Site-Infograph                 (0) | Val  Loss: 1.7831 | Val  Acc: 0.3919
 Site-QuickDraw                 (1) | Val  Loss: 2.3963 | Val  Acc: 0.1630
Average Valid Accuracy: 0.6294
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.9331
 Best site-Clipart                  (4)  | Epoch:1 | Val Acc: 0.7615
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.8263
 Best site-Sketch                   (3)  | Epoch:1 | Val Acc: 0.7004
 Best site-Infograph                (0)  | Epoch:1 | Val Acc: 0.3919
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.1630
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Real                      (1) | Train Loss: 0.4312 | Train Acc: 0.9404
 Site-Clipart                   (3) | Train Loss: 0.8350 | Train Acc: 0.7895
 Site-Painting                  (3) | Train Loss: 0.6465 | Train Acc: 0.8632
 Site-Sketch                    (2) | Train Loss: 0.8699 | Train Acc: 0.7781
 Site-Infograph                 (4) | Train Loss: 1.5891 | Train Acc: 0.4595
 Site-QuickDraw                 (0) | Train Loss: 2.0520 | Train Acc: 0.2681
Average Train Accuracy: 0.6831
 Site-Real                      (1) | Val  Loss: 0.4288 | Val  Acc: 0.9434
 Site-Clipart                   (3) | Val  Loss: 0.8923 | Val  Acc: 0.7681
 Site-Painting                  (3) | Val  Loss: 0.6061 | Val  Acc: 0.8737
 Site-Sketch                    (2) | Val  Loss: 0.9219 | Val  Acc: 0.7511
 Site-Infograph                 (4) | Val  Loss: 1.5423 | Val  Acc: 0.5405
 Site-QuickDraw                 (0) | Val  Loss: 2.3688 | Val  Acc: 0.1957
Average Valid Accuracy: 0.6787
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.9434
 Best site-Clipart                  (3)  | Epoch:2 | Val Acc: 0.7681
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.8737
 Best site-Sketch                   (2)  | Epoch:2 | Val Acc: 0.7511
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.5405
 Best site-QuickDraw                (0)  | Epoch:2 | Val Acc: 0.1957
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Real                      (4) | Train Loss: 0.3543 | Train Acc: 0.9452
 Site-Clipart                   (3) | Train Loss: 0.7124 | Train Acc: 0.8257
 Site-Painting                  (1) | Train Loss: 0.5821 | Train Acc: 0.8667
 Site-Sketch                    (2) | Train Loss: 0.7058 | Train Acc: 0.7949
 Site-Infograph                 (1) | Train Loss: 1.5463 | Train Acc: 0.4775
 Site-QuickDraw                 (0) | Train Loss: 2.1297 | Train Acc: 0.2391
Average Train Accuracy: 0.6915
 Site-Real                      (4) | Val  Loss: 0.3598 | Val  Acc: 0.9403
 Site-Clipart                   (3) | Val  Loss: 0.7806 | Val  Acc: 0.7977
 Site-Painting                  (1) | Val  Loss: 0.5403 | Val  Acc: 0.8711
 Site-Sketch                    (2) | Val  Loss: 0.8498 | Val  Acc: 0.7468
 Site-Infograph                 (1) | Val  Loss: 1.4366 | Val  Acc: 0.5405
 Site-QuickDraw                 (0) | Val  Loss: 2.2965 | Val  Acc: 0.2065
Average Valid Accuracy: 0.6838
 Best site-Real                     (4)  | Epoch:3 | Val Acc: 0.9403
 Best site-Clipart                  (3)  | Epoch:3 | Val Acc: 0.7977
 Best site-Painting                 (1)  | Epoch:3 | Val Acc: 0.8711
 Best site-Sketch                   (2)  | Epoch:3 | Val Acc: 0.7468
 Best site-Infograph                (1)  | Epoch:3 | Val Acc: 0.5405
 Best site-QuickDraw                (0)  | Epoch:3 | Val Acc: 0.2065
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Real                      (0) | Train Loss: 0.3157 | Train Acc: 0.9500
 Site-Clipart                   (1) | Train Loss: 0.6162 | Train Acc: 0.8454
 Site-Painting                  (4) | Train Loss: 0.5221 | Train Acc: 0.8737
 Site-Sketch                    (2) | Train Loss: 0.6608 | Train Acc: 0.8090
 Site-Infograph                 (1) | Train Loss: 1.5445 | Train Acc: 0.5045
 Site-QuickDraw                 (3) | Train Loss: 2.1027 | Train Acc: 0.2899
Average Train Accuracy: 0.7121
 Site-Real                      (0) | Val  Loss: 0.3167 | Val  Acc: 0.9568
 Site-Clipart                   (1) | Val  Loss: 0.6998 | Val  Acc: 0.8109
 Site-Painting                  (4) | Val  Loss: 0.4901 | Val  Acc: 0.8895
 Site-Sketch                    (2) | Val  Loss: 0.7613 | Val  Acc: 0.7384
 Site-Infograph                 (1) | Val  Loss: 1.4234 | Val  Acc: 0.5541
 Site-QuickDraw                 (3) | Val  Loss: 2.1959 | Val  Acc: 0.2609
Average Valid Accuracy: 0.7017
 Best site-Real                     (0)  | Epoch:4 | Val Acc: 0.9568
 Best site-Clipart                  (1)  | Epoch:4 | Val Acc: 0.8109
 Best site-Painting                 (4)  | Epoch:4 | Val Acc: 0.8895
 Best site-Sketch                   (2)  | Epoch:4 | Val Acc: 0.7384
 Best site-Infograph                (1)  | Epoch:4 | Val Acc: 0.5541
 Best site-QuickDraw                (3)  | Epoch:4 | Val Acc: 0.2609
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Real                      (0) | Train Loss: 0.3000 | Train Acc: 0.9459
 Site-Clipart                   (2) | Train Loss: 0.5916 | Train Acc: 0.8388
 Site-Painting                  (4) | Train Loss: 0.5046 | Train Acc: 0.8596
 Site-Sketch                    (1) | Train Loss: 0.6185 | Train Acc: 0.8258
 Site-Infograph                 (2) | Train Loss: 1.4353 | Train Acc: 0.5225
 Site-QuickDraw                 (3) | Train Loss: 1.9817 | Train Acc: 0.3623
Average Train Accuracy: 0.7258
 Site-Real                      (0) | Val  Loss: 0.3148 | Val  Acc: 0.9475
 Site-Clipart                   (2) | Val  Loss: 0.6473 | Val  Acc: 0.8240
 Site-Painting                  (4) | Val  Loss: 0.4537 | Val  Acc: 0.8868
 Site-Sketch                    (1) | Val  Loss: 0.7149 | Val  Acc: 0.7890
 Site-Infograph                 (2) | Val  Loss: 1.3879 | Val  Acc: 0.5743
 Site-QuickDraw                 (3) | Val  Loss: 2.2050 | Val  Acc: 0.2609
Average Valid Accuracy: 0.7138
 Best site-Real                     (0)  | Epoch:5 | Val Acc: 0.9475
 Best site-Clipart                  (2)  | Epoch:5 | Val Acc: 0.8240
 Best site-Painting                 (4)  | Epoch:5 | Val Acc: 0.8868
 Best site-Sketch                   (1)  | Epoch:5 | Val Acc: 0.7890
 Best site-Infograph                (2)  | Epoch:5 | Val Acc: 0.5743
 Best site-QuickDraw                (3)  | Epoch:5 | Val Acc: 0.2609
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Real                      (1) | Train Loss: 0.2829 | Train Acc: 0.9507
 Site-Clipart                   (0) | Train Loss: 0.5314 | Train Acc: 0.8651
 Site-Painting                  (4) | Train Loss: 0.4944 | Train Acc: 0.8684
 Site-Sketch                    (2) | Train Loss: 0.6516 | Train Acc: 0.8258
 Site-Infograph                 (0) | Train Loss: 1.4086 | Train Acc: 0.5405
 Site-QuickDraw                 (3) | Train Loss: 1.6572 | Train Acc: 0.3841
Average Train Accuracy: 0.7391
 Site-Real                      (1) | Val  Loss: 0.3006 | Val  Acc: 0.9424
 Site-Clipart                   (0) | Val  Loss: 0.5818 | Val  Acc: 0.8602
 Site-Painting                  (4) | Val  Loss: 0.4437 | Val  Acc: 0.8842
 Site-Sketch                    (2) | Val  Loss: 0.6820 | Val  Acc: 0.7764
 Site-Infograph                 (0) | Val  Loss: 1.3699 | Val  Acc: 0.5405
 Site-QuickDraw                 (3) | Val  Loss: 2.0387 | Val  Acc: 0.2826
Average Valid Accuracy: 0.7144
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9424
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8602
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.8842
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.7764
 Best site-Infograph                (0)  | Epoch:6 | Val Acc: 0.5405
 Best site-QuickDraw                (3)  | Epoch:6 | Val Acc: 0.2826
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Real                      (1) | Train Loss: 0.2579 | Train Acc: 0.9534
 Site-Clipart                   (0) | Train Loss: 0.5040 | Train Acc: 0.8629
 Site-Painting                  (4) | Train Loss: 0.4357 | Train Acc: 0.8877
 Site-Sketch                    (3) | Train Loss: 0.6093 | Train Acc: 0.8090
 Site-Infograph                 (0) | Train Loss: 1.3765 | Train Acc: 0.5450
 Site-QuickDraw                 (2) | Train Loss: 1.7299 | Train Acc: 0.4275
Average Train Accuracy: 0.7476
 Site-Real                      (1) | Val  Loss: 0.2720 | Val  Acc: 0.9465
 Site-Clipart                   (0) | Val  Loss: 0.5512 | Val  Acc: 0.8487
 Site-Painting                  (4) | Val  Loss: 0.4248 | Val  Acc: 0.8947
 Site-Sketch                    (3) | Val  Loss: 0.6556 | Val  Acc: 0.7890
 Site-Infograph                 (0) | Val  Loss: 1.3492 | Val  Acc: 0.5608
 Site-QuickDraw                 (2) | Val  Loss: 1.9837 | Val  Acc: 0.3587
Average Valid Accuracy: 0.7331
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9465
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8487
 Best site-Painting                 (4)  | Epoch:7 | Val Acc: 0.8947
 Best site-Sketch                   (3)  | Epoch:7 | Val Acc: 0.7890
 Best site-Infograph                (0)  | Epoch:7 | Val Acc: 0.5608
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.3587
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Real                      (1) | Train Loss: 0.2446 | Train Acc: 0.9507
 Site-Clipart                   (0) | Train Loss: 0.4635 | Train Acc: 0.8673
 Site-Painting                  (2) | Train Loss: 0.4533 | Train Acc: 0.8737
 Site-Sketch                    (4) | Train Loss: 0.5789 | Train Acc: 0.8202
 Site-Infograph                 (0) | Train Loss: 1.3376 | Train Acc: 0.5405
 Site-QuickDraw                 (3) | Train Loss: 1.6738 | Train Acc: 0.4348
Average Train Accuracy: 0.7479
 Site-Real                      (1) | Val  Loss: 0.2575 | Val  Acc: 0.9434
 Site-Clipart                   (0) | Val  Loss: 0.5354 | Val  Acc: 0.8454
 Site-Painting                  (2) | Val  Loss: 0.4088 | Val  Acc: 0.8921
 Site-Sketch                    (4) | Val  Loss: 0.6386 | Val  Acc: 0.7975
 Site-Infograph                 (0) | Val  Loss: 1.2565 | Val  Acc: 0.6081
 Site-QuickDraw                 (3) | Val  Loss: 1.8261 | Val  Acc: 0.4130
Average Valid Accuracy: 0.7499
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9434
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8454
 Best site-Painting                 (2)  | Epoch:8 | Val Acc: 0.8921
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.7975
 Best site-Infograph                (0)  | Epoch:8 | Val Acc: 0.6081
 Best site-QuickDraw                (3)  | Epoch:8 | Val Acc: 0.4130
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Real                      (0) | Train Loss: 0.2369 | Train Acc: 0.9513
 Site-Clipart                   (1) | Train Loss: 0.4373 | Train Acc: 0.8838
 Site-Painting                  (3) | Train Loss: 0.4214 | Train Acc: 0.8860
 Site-Sketch                    (4) | Train Loss: 0.5813 | Train Acc: 0.8230
 Site-Infograph                 (1) | Train Loss: 1.3289 | Train Acc: 0.5315
 Site-QuickDraw                 (2) | Train Loss: 1.4796 | Train Acc: 0.5000
Average Train Accuracy: 0.7626
 Site-Real                      (0) | Val  Loss: 0.2472 | Val  Acc: 0.9414
 Site-Clipart                   (1) | Val  Loss: 0.5109 | Val  Acc: 0.8553
 Site-Painting                  (3) | Val  Loss: 0.3796 | Val  Acc: 0.8974
 Site-Sketch                    (4) | Val  Loss: 0.6185 | Val  Acc: 0.7890
 Site-Infograph                 (1) | Val  Loss: 1.3075 | Val  Acc: 0.5608
 Site-QuickDraw                 (2) | Val  Loss: 1.8854 | Val  Acc: 0.4022
Average Valid Accuracy: 0.7410
============ Train epoch 10 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Real                      (1) | Train Loss: 0.2312 | Train Acc: 0.9486
 Site-Clipart                   (2) | Train Loss: 0.4395 | Train Acc: 0.8783
 Site-Painting                  (4) | Train Loss: 0.4013 | Train Acc: 0.8877
 Site-Sketch                    (3) | Train Loss: 0.5116 | Train Acc: 0.8399
 Site-Infograph                 (2) | Train Loss: 1.3756 | Train Acc: 0.5360
 Site-QuickDraw                 (0) | Train Loss: 1.4756 | Train Acc: 0.5507
Average Train Accuracy: 0.7735
 Site-Real                      (1) | Val  Loss: 0.2434 | Val  Acc: 0.9414
 Site-Clipart                   (2) | Val  Loss: 0.4823 | Val  Acc: 0.8832
 Site-Painting                  (4) | Val  Loss: 0.3742 | Val  Acc: 0.9079
 Site-Sketch                    (3) | Val  Loss: 0.5924 | Val  Acc: 0.8228
 Site-Infograph                 (2) | Val  Loss: 1.2890 | Val  Acc: 0.6014
 Site-QuickDraw                 (0) | Val  Loss: 1.7373 | Val  Acc: 0.4022
Average Valid Accuracy: 0.7598
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9414
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8832
 Best site-Painting                 (4)  | Epoch:10 | Val Acc: 0.9079
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8228
 Best site-Infograph                (2)  | Epoch:10 | Val Acc: 0.6014
 Best site-QuickDraw                (0)  | Epoch:10 | Val Acc: 0.4022
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Real                      (0) | Train Loss: 0.2198 | Train Acc: 0.9520
 Site-Clipart                   (2) | Train Loss: 0.4116 | Train Acc: 0.8991
 Site-Painting                  (4) | Train Loss: 0.3690 | Train Acc: 0.9053
 Site-Sketch                    (3) | Train Loss: 0.5289 | Train Acc: 0.8343
 Site-Infograph                 (2) | Train Loss: 1.3143 | Train Acc: 0.5495
 Site-QuickDraw                 (1) | Train Loss: 1.5419 | Train Acc: 0.5507
Average Train Accuracy: 0.7818
 Site-Real                      (0) | Val  Loss: 0.2383 | Val  Acc: 0.9434
 Site-Clipart                   (2) | Val  Loss: 0.4694 | Val  Acc: 0.8734
 Site-Painting                  (4) | Val  Loss: 0.3658 | Val  Acc: 0.8974
 Site-Sketch                    (3) | Val  Loss: 0.5725 | Val  Acc: 0.8228
 Site-Infograph                 (2) | Val  Loss: 1.1753 | Val  Acc: 0.6216
 Site-QuickDraw                 (1) | Val  Loss: 1.8180 | Val  Acc: 0.4022
Average Valid Accuracy: 0.7601
 Best site-Real                     (0)  | Epoch:11 | Val Acc: 0.9434
 Best site-Clipart                  (2)  | Epoch:11 | Val Acc: 0.8734
 Best site-Painting                 (4)  | Epoch:11 | Val Acc: 0.8974
 Best site-Sketch                   (3)  | Epoch:11 | Val Acc: 0.8228
 Best site-Infograph                (2)  | Epoch:11 | Val Acc: 0.6216
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.4022
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Real                      (2) | Train Loss: 0.2193 | Train Acc: 0.9520
 Site-Clipart                   (0) | Train Loss: 0.3876 | Train Acc: 0.8925
 Site-Painting                  (4) | Train Loss: 0.3598 | Train Acc: 0.9193
 Site-Sketch                    (3) | Train Loss: 0.5240 | Train Acc: 0.8483
 Site-Infograph                 (0) | Train Loss: 1.2286 | Train Acc: 0.5856
 Site-QuickDraw                 (1) | Train Loss: 1.3798 | Train Acc: 0.5725
Average Train Accuracy: 0.7950
 Site-Real                      (2) | Val  Loss: 0.2287 | Val  Acc: 0.9506
 Site-Clipart                   (0) | Val  Loss: 0.4459 | Val  Acc: 0.8684
 Site-Painting                  (4) | Val  Loss: 0.3700 | Val  Acc: 0.8947
 Site-Sketch                    (3) | Val  Loss: 0.5500 | Val  Acc: 0.8143
 Site-Infograph                 (0) | Val  Loss: 1.2307 | Val  Acc: 0.5946
 Site-QuickDraw                 (1) | Val  Loss: 1.6471 | Val  Acc: 0.4674
Average Valid Accuracy: 0.7650
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9506
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8684
 Best site-Painting                 (4)  | Epoch:12 | Val Acc: 0.8947
 Best site-Sketch                   (3)  | Epoch:12 | Val Acc: 0.8143
 Best site-Infograph                (0)  | Epoch:12 | Val Acc: 0.5946
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.4674
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 1, 1, 1, 2, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Real                      (3) | Train Loss: 0.2064 | Train Acc: 0.9561
 Site-Clipart                   (4) | Train Loss: 0.3842 | Train Acc: 0.8871
 Site-Painting                  (0) | Train Loss: 0.3704 | Train Acc: 0.8860
 Site-Sketch                    (2) | Train Loss: 0.4734 | Train Acc: 0.8511
 Site-Infograph                 (4) | Train Loss: 1.2634 | Train Acc: 0.5586
 Site-QuickDraw                 (1) | Train Loss: 1.2993 | Train Acc: 0.6087
Average Train Accuracy: 0.7913
 Site-Real                      (3) | Val  Loss: 0.2190 | Val  Acc: 0.9506
 Site-Clipart                   (4) | Val  Loss: 0.4161 | Val  Acc: 0.8898
 Site-Painting                  (0) | Val  Loss: 0.3572 | Val  Acc: 0.8895
 Site-Sketch                    (2) | Val  Loss: 0.5633 | Val  Acc: 0.8228
 Site-Infograph                 (4) | Val  Loss: 1.1642 | Val  Acc: 0.6351
 Site-QuickDraw                 (1) | Val  Loss: 1.6099 | Val  Acc: 0.5109
Average Valid Accuracy: 0.7831
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9506
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8898
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8895
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8228
 Best site-Infograph                (4)  | Epoch:13 | Val Acc: 0.6351
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.5109
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Real                      (2) | Train Loss: 0.2095 | Train Acc: 0.9534
 Site-Clipart                   (0) | Train Loss: 0.3965 | Train Acc: 0.9046
 Site-Painting                  (2) | Train Loss: 0.3703 | Train Acc: 0.8930
 Site-Sketch                    (3) | Train Loss: 0.5190 | Train Acc: 0.8371
 Site-Infograph                 (4) | Train Loss: 1.1975 | Train Acc: 0.5991
 Site-QuickDraw                 (1) | Train Loss: 1.2303 | Train Acc: 0.6014
Average Train Accuracy: 0.7981
 Site-Real                      (2) | Val  Loss: 0.2203 | Val  Acc: 0.9424
 Site-Clipart                   (0) | Val  Loss: 0.4301 | Val  Acc: 0.8799
 Site-Painting                  (2) | Val  Loss: 0.3407 | Val  Acc: 0.9026
 Site-Sketch                    (3) | Val  Loss: 0.5770 | Val  Acc: 0.8059
 Site-Infograph                 (4) | Val  Loss: 1.2305 | Val  Acc: 0.6014
 Site-QuickDraw                 (1) | Val  Loss: 1.5385 | Val  Acc: 0.5217
Average Valid Accuracy: 0.7757
============ Train epoch 15 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Real                      (4) | Train Loss: 0.1993 | Train Acc: 0.9568
 Site-Clipart                   (3) | Train Loss: 0.3530 | Train Acc: 0.9145
 Site-Painting                  (1) | Train Loss: 0.3444 | Train Acc: 0.9070
 Site-Sketch                    (0) | Train Loss: 0.4918 | Train Acc: 0.8652
 Site-Infograph                 (3) | Train Loss: 1.2929 | Train Acc: 0.5856
 Site-QuickDraw                 (2) | Train Loss: 1.2547 | Train Acc: 0.5797
Average Train Accuracy: 0.8015
 Site-Real                      (4) | Val  Loss: 0.2140 | Val  Acc: 0.9496
 Site-Clipart                   (3) | Val  Loss: 0.4374 | Val  Acc: 0.8734
 Site-Painting                  (1) | Val  Loss: 0.3500 | Val  Acc: 0.9053
 Site-Sketch                    (0) | Val  Loss: 0.4896 | Val  Acc: 0.8439
 Site-Infograph                 (3) | Val  Loss: 1.1483 | Val  Acc: 0.6149
 Site-QuickDraw                 (2) | Val  Loss: 1.6270 | Val  Acc: 0.4674
Average Valid Accuracy: 0.7757
============ Train epoch 16 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Real                      (0) | Train Loss: 0.1914 | Train Acc: 0.9575
 Site-Clipart                   (4) | Train Loss: 0.3438 | Train Acc: 0.9057
 Site-Painting                  (0) | Train Loss: 0.3374 | Train Acc: 0.8947
 Site-Sketch                    (3) | Train Loss: 0.4826 | Train Acc: 0.8483
 Site-Infograph                 (2) | Train Loss: 1.2022 | Train Acc: 0.6306
 Site-QuickDraw                 (1) | Train Loss: 1.2734 | Train Acc: 0.6377
Average Train Accuracy: 0.8124
 Site-Real                      (0) | Val  Loss: 0.1997 | Val  Acc: 0.9527
 Site-Clipart                   (4) | Val  Loss: 0.4160 | Val  Acc: 0.8816
 Site-Painting                  (0) | Val  Loss: 0.3097 | Val  Acc: 0.9211
 Site-Sketch                    (3) | Val  Loss: 0.5266 | Val  Acc: 0.8143
 Site-Infograph                 (2) | Val  Loss: 1.1357 | Val  Acc: 0.6351
 Site-QuickDraw                 (1) | Val  Loss: 1.5234 | Val  Acc: 0.5217
Average Valid Accuracy: 0.7878
 Best site-Real                     (0)  | Epoch:16 | Val Acc: 0.9527
 Best site-Clipart                  (4)  | Epoch:16 | Val Acc: 0.8816
 Best site-Painting                 (0)  | Epoch:16 | Val Acc: 0.9211
 Best site-Sketch                   (3)  | Epoch:16 | Val Acc: 0.8143
 Best site-Infograph                (2)  | Epoch:16 | Val Acc: 0.6351
 Best site-QuickDraw                (1)  | Epoch:16 | Val Acc: 0.5217
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 17 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Real                      (3) | Train Loss: 0.1862 | Train Acc: 0.9575
 Site-Clipart                   (1) | Train Loss: 0.3542 | Train Acc: 0.9035
 Site-Painting                  (4) | Train Loss: 0.3423 | Train Acc: 0.8982
 Site-Sketch                    (0) | Train Loss: 0.4740 | Train Acc: 0.8343
 Site-Infograph                 (1) | Train Loss: 1.2081 | Train Acc: 0.5946
 Site-QuickDraw                 (2) | Train Loss: 1.0934 | Train Acc: 0.6232
Average Train Accuracy: 0.8019
 Site-Real                      (3) | Val  Loss: 0.2130 | Val  Acc: 0.9465
 Site-Clipart                   (1) | Val  Loss: 0.4162 | Val  Acc: 0.8849
 Site-Painting                  (4) | Val  Loss: 0.2826 | Val  Acc: 0.9342
 Site-Sketch                    (0) | Val  Loss: 0.5191 | Val  Acc: 0.8354
 Site-Infograph                 (1) | Val  Loss: 1.1885 | Val  Acc: 0.6284
 Site-QuickDraw                 (2) | Val  Loss: 1.4337 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7991
 Best site-Real                     (3)  | Epoch:17 | Val Acc: 0.9465
 Best site-Clipart                  (1)  | Epoch:17 | Val Acc: 0.8849
 Best site-Painting                 (4)  | Epoch:17 | Val Acc: 0.9342
 Best site-Sketch                   (0)  | Epoch:17 | Val Acc: 0.8354
 Best site-Infograph                (1)  | Epoch:17 | Val Acc: 0.6284
 Best site-QuickDraw                (2)  | Epoch:17 | Val Acc: 0.5652
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Real                      (4) | Train Loss: 0.1939 | Train Acc: 0.9479
 Site-Clipart                   (0) | Train Loss: 0.3393 | Train Acc: 0.9079
 Site-Painting                  (2) | Train Loss: 0.3198 | Train Acc: 0.9105
 Site-Sketch                    (0) | Train Loss: 0.4617 | Train Acc: 0.8680
 Site-Infograph                 (3) | Train Loss: 1.1496 | Train Acc: 0.6306
 Site-QuickDraw                 (1) | Train Loss: 1.1688 | Train Acc: 0.6449
Average Train Accuracy: 0.8183
 Site-Real                      (4) | Val  Loss: 0.2114 | Val  Acc: 0.9486
 Site-Clipart                   (0) | Val  Loss: 0.4132 | Val  Acc: 0.8898
 Site-Painting                  (2) | Val  Loss: 0.2978 | Val  Acc: 0.9316
 Site-Sketch                    (0) | Val  Loss: 0.5153 | Val  Acc: 0.8059
 Site-Infograph                 (3) | Val  Loss: 1.1740 | Val  Acc: 0.6216
 Site-QuickDraw                 (1) | Val  Loss: 1.5368 | Val  Acc: 0.5543
Average Valid Accuracy: 0.7920
============ Train epoch 19 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Real                      (2) | Train Loss: 0.1979 | Train Acc: 0.9507
 Site-Clipart                   (0) | Train Loss: 0.3253 | Train Acc: 0.9156
 Site-Painting                  (3) | Train Loss: 0.3219 | Train Acc: 0.9211
 Site-Sketch                    (0) | Train Loss: 0.4884 | Train Acc: 0.8596
 Site-Infograph                 (4) | Train Loss: 1.0792 | Train Acc: 0.6261
 Site-QuickDraw                 (1) | Train Loss: 1.1743 | Train Acc: 0.6304
Average Train Accuracy: 0.8172
 Site-Real                      (2) | Val  Loss: 0.2069 | Val  Acc: 0.9465
 Site-Clipart                   (0) | Val  Loss: 0.3768 | Val  Acc: 0.9030
 Site-Painting                  (3) | Val  Loss: 0.2941 | Val  Acc: 0.9316
 Site-Sketch                    (0) | Val  Loss: 0.5005 | Val  Acc: 0.8312
 Site-Infograph                 (4) | Val  Loss: 1.0524 | Val  Acc: 0.6757
 Site-QuickDraw                 (1) | Val  Loss: 1.5041 | Val  Acc: 0.5761
Average Valid Accuracy: 0.8107
 Best site-Real                     (2)  | Epoch:19 | Val Acc: 0.9465
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.9030
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.9316
 Best site-Sketch                   (0)  | Epoch:19 | Val Acc: 0.8312
 Best site-Infograph                (4)  | Epoch:19 | Val Acc: 0.6757
 Best site-QuickDraw                (1)  | Epoch:19 | Val Acc: 0.5761
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 20 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Real                      (2) | Train Loss: 0.1781 | Train Acc: 0.9554
 Site-Clipart                   (1) | Train Loss: 0.3231 | Train Acc: 0.9112
 Site-Painting                  (4) | Train Loss: 0.3054 | Train Acc: 0.9140
 Site-Sketch                    (3) | Train Loss: 0.4248 | Train Acc: 0.8708
 Site-Infograph                 (1) | Train Loss: 1.1061 | Train Acc: 0.6351
 Site-QuickDraw                 (0) | Train Loss: 1.1612 | Train Acc: 0.6377
Average Train Accuracy: 0.8207
 Site-Real                      (2) | Val  Loss: 0.1889 | Val  Acc: 0.9537
 Site-Clipart                   (1) | Val  Loss: 0.3733 | Val  Acc: 0.9013
 Site-Painting                  (4) | Val  Loss: 0.3162 | Val  Acc: 0.9158
 Site-Sketch                    (3) | Val  Loss: 0.4697 | Val  Acc: 0.8354
 Site-Infograph                 (1) | Val  Loss: 1.1057 | Val  Acc: 0.6419
 Site-QuickDraw                 (0) | Val  Loss: 1.3738 | Val  Acc: 0.5978
Average Valid Accuracy: 0.8077
============ Train epoch 21 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Real                      (3) | Train Loss: 0.1697 | Train Acc: 0.9609
 Site-Clipart                   (2) | Train Loss: 0.2908 | Train Acc: 0.9221
 Site-Painting                  (1) | Train Loss: 0.3116 | Train Acc: 0.9123
 Site-Sketch                    (2) | Train Loss: 0.4476 | Train Acc: 0.8511
 Site-Infograph                 (4) | Train Loss: 1.0807 | Train Acc: 0.6532
 Site-QuickDraw                 (0) | Train Loss: 0.9920 | Train Acc: 0.6812
Average Train Accuracy: 0.8301
 Site-Real                      (3) | Val  Loss: 0.1936 | Val  Acc: 0.9537
 Site-Clipart                   (2) | Val  Loss: 0.3967 | Val  Acc: 0.8816
 Site-Painting                  (1) | Val  Loss: 0.3218 | Val  Acc: 0.9053
 Site-Sketch                    (2) | Val  Loss: 0.4721 | Val  Acc: 0.8439
 Site-Infograph                 (4) | Val  Loss: 1.0760 | Val  Acc: 0.6486
 Site-QuickDraw                 (0) | Val  Loss: 1.3159 | Val  Acc: 0.6087
Average Valid Accuracy: 0.8070
============ Train epoch 22 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Real                      (2) | Train Loss: 0.1724 | Train Acc: 0.9575
 Site-Clipart                   (0) | Train Loss: 0.3140 | Train Acc: 0.9167
 Site-Painting                  (2) | Train Loss: 0.3066 | Train Acc: 0.9105
 Site-Sketch                    (4) | Train Loss: 0.4339 | Train Acc: 0.8427
 Site-Infograph                 (3) | Train Loss: 1.0173 | Train Acc: 0.6712
 Site-QuickDraw                 (1) | Train Loss: 0.9830 | Train Acc: 0.6812
Average Train Accuracy: 0.8300
 Site-Real                      (2) | Val  Loss: 0.1905 | Val  Acc: 0.9558
 Site-Clipart                   (0) | Val  Loss: 0.3890 | Val  Acc: 0.8980
 Site-Painting                  (2) | Val  Loss: 0.2828 | Val  Acc: 0.9237
 Site-Sketch                    (4) | Val  Loss: 0.4982 | Val  Acc: 0.8397
 Site-Infograph                 (3) | Val  Loss: 0.9894 | Val  Acc: 0.7027
 Site-QuickDraw                 (1) | Val  Loss: 1.3880 | Val  Acc: 0.5543
Average Valid Accuracy: 0.8124
 Best site-Real                     (2)  | Epoch:22 | Val Acc: 0.9558
 Best site-Clipart                  (0)  | Epoch:22 | Val Acc: 0.8980
 Best site-Painting                 (2)  | Epoch:22 | Val Acc: 0.9237
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8397
 Best site-Infograph                (3)  | Epoch:22 | Val Acc: 0.7027
 Best site-QuickDraw                (1)  | Epoch:22 | Val Acc: 0.5543
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 23 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Real                      (2) | Train Loss: 0.1732 | Train Acc: 0.9596
 Site-Clipart                   (1) | Train Loss: 0.3088 | Train Acc: 0.9145
 Site-Painting                  (3) | Train Loss: 0.2890 | Train Acc: 0.9228
 Site-Sketch                    (1) | Train Loss: 0.4214 | Train Acc: 0.8483
 Site-Infograph                 (4) | Train Loss: 1.0149 | Train Acc: 0.6441
 Site-QuickDraw                 (0) | Train Loss: 0.9504 | Train Acc: 0.6667
Average Train Accuracy: 0.8260
 Site-Real                      (2) | Val  Loss: 0.1863 | Val  Acc: 0.9516
 Site-Clipart                   (1) | Val  Loss: 0.3959 | Val  Acc: 0.8914
 Site-Painting                  (3) | Val  Loss: 0.2840 | Val  Acc: 0.9211
 Site-Sketch                    (1) | Val  Loss: 0.4890 | Val  Acc: 0.8228
 Site-Infograph                 (4) | Val  Loss: 1.0602 | Val  Acc: 0.6959
 Site-QuickDraw                 (0) | Val  Loss: 1.3874 | Val  Acc: 0.5978
Average Valid Accuracy: 0.8135
 Best site-Real                     (2)  | Epoch:23 | Val Acc: 0.9516
 Best site-Clipart                  (1)  | Epoch:23 | Val Acc: 0.8914
 Best site-Painting                 (3)  | Epoch:23 | Val Acc: 0.9211
 Best site-Sketch                   (1)  | Epoch:23 | Val Acc: 0.8228
 Best site-Infograph                (4)  | Epoch:23 | Val Acc: 0.6959
 Best site-QuickDraw                (0)  | Epoch:23 | Val Acc: 0.5978
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Real                      (4) | Train Loss: 0.1781 | Train Acc: 0.9527
 Site-Clipart                   (2) | Train Loss: 0.3062 | Train Acc: 0.9167
 Site-Painting                  (1) | Train Loss: 0.3031 | Train Acc: 0.9246
 Site-Sketch                    (2) | Train Loss: 0.4583 | Train Acc: 0.8371
 Site-Infograph                 (3) | Train Loss: 1.0092 | Train Acc: 0.6532
 Site-QuickDraw                 (0) | Train Loss: 0.9833 | Train Acc: 0.6884
Average Train Accuracy: 0.8288
 Site-Real                      (4) | Val  Loss: 0.1927 | Val  Acc: 0.9475
 Site-Clipart                   (2) | Val  Loss: 0.3908 | Val  Acc: 0.8882
 Site-Painting                  (1) | Val  Loss: 0.2644 | Val  Acc: 0.9342
 Site-Sketch                    (2) | Val  Loss: 0.4742 | Val  Acc: 0.8523
 Site-Infograph                 (3) | Val  Loss: 1.1105 | Val  Acc: 0.6757
 Site-QuickDraw                 (0) | Val  Loss: 1.3943 | Val  Acc: 0.5761
Average Valid Accuracy: 0.8123
============ Train epoch 25 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Real                      (2) | Train Loss: 0.1584 | Train Acc: 0.9609
 Site-Clipart                   (4) | Train Loss: 0.3028 | Train Acc: 0.9134
 Site-Painting                  (2) | Train Loss: 0.2875 | Train Acc: 0.9193
 Site-Sketch                    (0) | Train Loss: 0.4081 | Train Acc: 0.8427
 Site-Infograph                 (3) | Train Loss: 0.9745 | Train Acc: 0.6757
 Site-QuickDraw                 (1) | Train Loss: 1.0587 | Train Acc: 0.6522
Average Train Accuracy: 0.8274
 Site-Real                      (2) | Val  Loss: 0.1810 | Val  Acc: 0.9568
 Site-Clipart                   (4) | Val  Loss: 0.3709 | Val  Acc: 0.8964
 Site-Painting                  (2) | Val  Loss: 0.2824 | Val  Acc: 0.9237
 Site-Sketch                    (0) | Val  Loss: 0.4882 | Val  Acc: 0.8439
 Site-Infograph                 (3) | Val  Loss: 1.0149 | Val  Acc: 0.6689
 Site-QuickDraw                 (1) | Val  Loss: 1.3601 | Val  Acc: 0.6087
Average Valid Accuracy: 0.8164
 Best site-Real                     (2)  | Epoch:25 | Val Acc: 0.9568
 Best site-Clipart                  (4)  | Epoch:25 | Val Acc: 0.8964
 Best site-Painting                 (2)  | Epoch:25 | Val Acc: 0.9237
 Best site-Sketch                   (0)  | Epoch:25 | Val Acc: 0.8439
 Best site-Infograph                (3)  | Epoch:25 | Val Acc: 0.6689
 Best site-QuickDraw                (1)  | Epoch:25 | Val Acc: 0.6087
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 26 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Real                      (2) | Train Loss: 0.1528 | Train Acc: 0.9630
 Site-Clipart                   (1) | Train Loss: 0.2875 | Train Acc: 0.9189
 Site-Painting                  (2) | Train Loss: 0.2887 | Train Acc: 0.9158
 Site-Sketch                    (4) | Train Loss: 0.3938 | Train Acc: 0.8736
 Site-Infograph                 (3) | Train Loss: 0.9701 | Train Acc: 0.6712
 Site-QuickDraw                 (0) | Train Loss: 0.9485 | Train Acc: 0.7029
Average Train Accuracy: 0.8409
 Site-Real                      (2) | Val  Loss: 0.1761 | Val  Acc: 0.9537
 Site-Clipart                   (1) | Val  Loss: 0.3675 | Val  Acc: 0.8849
 Site-Painting                  (2) | Val  Loss: 0.2618 | Val  Acc: 0.9211
 Site-Sketch                    (4) | Val  Loss: 0.4514 | Val  Acc: 0.8565
 Site-Infograph                 (3) | Val  Loss: 1.1093 | Val  Acc: 0.6757
 Site-QuickDraw                 (0) | Val  Loss: 1.2968 | Val  Acc: 0.5870
Average Valid Accuracy: 0.8131
============ Train epoch 27 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Real                      (2) | Train Loss: 0.1558 | Train Acc: 0.9582
 Site-Clipart                   (4) | Train Loss: 0.2712 | Train Acc: 0.9320
 Site-Painting                  (2) | Train Loss: 0.2878 | Train Acc: 0.9193
 Site-Sketch                    (0) | Train Loss: 0.4155 | Train Acc: 0.8736
 Site-Infograph                 (3) | Train Loss: 0.9880 | Train Acc: 0.6892
 Site-QuickDraw                 (1) | Train Loss: 0.9115 | Train Acc: 0.7029
Average Train Accuracy: 0.8459
 Site-Real                      (2) | Val  Loss: 0.1750 | Val  Acc: 0.9547
 Site-Clipart                   (4) | Val  Loss: 0.3602 | Val  Acc: 0.8997
 Site-Painting                  (2) | Val  Loss: 0.2621 | Val  Acc: 0.9421
 Site-Sketch                    (0) | Val  Loss: 0.4299 | Val  Acc: 0.8523
 Site-Infograph                 (3) | Val  Loss: 0.9956 | Val  Acc: 0.7095
 Site-QuickDraw                 (1) | Val  Loss: 1.2606 | Val  Acc: 0.5978
Average Valid Accuracy: 0.8260
 Best site-Real                     (2)  | Epoch:27 | Val Acc: 0.9547
 Best site-Clipart                  (4)  | Epoch:27 | Val Acc: 0.8997
 Best site-Painting                 (2)  | Epoch:27 | Val Acc: 0.9421
 Best site-Sketch                   (0)  | Epoch:27 | Val Acc: 0.8523
 Best site-Infograph                (3)  | Epoch:27 | Val Acc: 0.7095
 Best site-QuickDraw                (1)  | Epoch:27 | Val Acc: 0.5978
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 28 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Real                      (4) | Train Loss: 0.1591 | Train Acc: 0.9596
 Site-Clipart                   (2) | Train Loss: 0.2857 | Train Acc: 0.9265
 Site-Painting                  (3) | Train Loss: 0.2618 | Train Acc: 0.9316
 Site-Sketch                    (2) | Train Loss: 0.4303 | Train Acc: 0.8624
 Site-Infograph                 (0) | Train Loss: 0.9620 | Train Acc: 0.7207
 Site-QuickDraw                 (1) | Train Loss: 0.9127 | Train Acc: 0.7174
Average Train Accuracy: 0.8530
 Site-Real                      (4) | Val  Loss: 0.1652 | Val  Acc: 0.9588
 Site-Clipart                   (2) | Val  Loss: 0.3623 | Val  Acc: 0.8947
 Site-Painting                  (3) | Val  Loss: 0.2552 | Val  Acc: 0.9395
 Site-Sketch                    (2) | Val  Loss: 0.4050 | Val  Acc: 0.8608
 Site-Infograph                 (0) | Val  Loss: 0.9773 | Val  Acc: 0.6959
 Site-QuickDraw                 (1) | Val  Loss: 1.2654 | Val  Acc: 0.6196
Average Valid Accuracy: 0.8282
 Best site-Real                     (4)  | Epoch:28 | Val Acc: 0.9588
 Best site-Clipart                  (2)  | Epoch:28 | Val Acc: 0.8947
 Best site-Painting                 (3)  | Epoch:28 | Val Acc: 0.9395
 Best site-Sketch                   (2)  | Epoch:28 | Val Acc: 0.8608
 Best site-Infograph                (0)  | Epoch:28 | Val Acc: 0.6959
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.6196
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 29 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Real                      (3) | Train Loss: 0.1503 | Train Acc: 0.9664
 Site-Clipart                   (2) | Train Loss: 0.2765 | Train Acc: 0.9276
 Site-Painting                  (3) | Train Loss: 0.2645 | Train Acc: 0.9333
 Site-Sketch                    (4) | Train Loss: 0.3793 | Train Acc: 0.8848
 Site-Infograph                 (0) | Train Loss: 0.9176 | Train Acc: 0.7162
 Site-QuickDraw                 (1) | Train Loss: 0.8613 | Train Acc: 0.7029
Average Train Accuracy: 0.8552
 Site-Real                      (3) | Val  Loss: 0.1774 | Val  Acc: 0.9527
 Site-Clipart                   (2) | Val  Loss: 0.3476 | Val  Acc: 0.9062
 Site-Painting                  (3) | Val  Loss: 0.2693 | Val  Acc: 0.9342
 Site-Sketch                    (4) | Val  Loss: 0.3828 | Val  Acc: 0.8692
 Site-Infograph                 (0) | Val  Loss: 0.9381 | Val  Acc: 0.7365
 Site-QuickDraw                 (1) | Val  Loss: 1.2366 | Val  Acc: 0.6304
Average Valid Accuracy: 0.8382
 Best site-Real                     (3)  | Epoch:29 | Val Acc: 0.9527
 Best site-Clipart                  (2)  | Epoch:29 | Val Acc: 0.9062
 Best site-Painting                 (3)  | Epoch:29 | Val Acc: 0.9342
 Best site-Sketch                   (4)  | Epoch:29 | Val Acc: 0.8692
 Best site-Infograph                (0)  | Epoch:29 | Val Acc: 0.7365
 Best site-QuickDraw                (1)  | Epoch:29 | Val Acc: 0.6304
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 30 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Real                      (3) | Train Loss: 0.1528 | Train Acc: 0.9589
 Site-Clipart                   (0) | Train Loss: 0.2827 | Train Acc: 0.9254
 Site-Painting                  (3) | Train Loss: 0.2656 | Train Acc: 0.9246
 Site-Sketch                    (4) | Train Loss: 0.3757 | Train Acc: 0.8680
 Site-Infograph                 (2) | Train Loss: 0.8775 | Train Acc: 0.7207
 Site-QuickDraw                 (1) | Train Loss: 1.0264 | Train Acc: 0.7391
Average Train Accuracy: 0.8561
 Site-Real                      (3) | Val  Loss: 0.1733 | Val  Acc: 0.9599
 Site-Clipart                   (0) | Val  Loss: 0.3404 | Val  Acc: 0.9112
 Site-Painting                  (3) | Val  Loss: 0.2569 | Val  Acc: 0.9342
 Site-Sketch                    (4) | Val  Loss: 0.4203 | Val  Acc: 0.8734
 Site-Infograph                 (2) | Val  Loss: 1.0297 | Val  Acc: 0.7095
 Site-QuickDraw                 (1) | Val  Loss: 1.2170 | Val  Acc: 0.5978
Average Valid Accuracy: 0.8310
============ Train epoch 31 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Real                      (3) | Train Loss: 0.1483 | Train Acc: 0.9596
 Site-Clipart                   (1) | Train Loss: 0.2675 | Train Acc: 0.9309
 Site-Painting                  (4) | Train Loss: 0.2598 | Train Acc: 0.9316
 Site-Sketch                    (1) | Train Loss: 0.4229 | Train Acc: 0.8539
 Site-Infograph                 (2) | Train Loss: 0.8929 | Train Acc: 0.7072
 Site-QuickDraw                 (0) | Train Loss: 0.8976 | Train Acc: 0.7029
Average Train Accuracy: 0.8477
 Site-Real                      (3) | Val  Loss: 0.1682 | Val  Acc: 0.9547
 Site-Clipart                   (1) | Val  Loss: 0.3370 | Val  Acc: 0.9095
 Site-Painting                  (4) | Val  Loss: 0.2454 | Val  Acc: 0.9368
 Site-Sketch                    (1) | Val  Loss: 0.4109 | Val  Acc: 0.8481
 Site-Infograph                 (2) | Val  Loss: 1.0140 | Val  Acc: 0.6824
 Site-QuickDraw                 (0) | Val  Loss: 1.1130 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8306
============ Train epoch 32 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Real                      (4) | Train Loss: 0.1563 | Train Acc: 0.9575
 Site-Clipart                   (1) | Train Loss: 0.2571 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.2604 | Train Acc: 0.9298
 Site-Sketch                    (1) | Train Loss: 0.4231 | Train Acc: 0.8455
 Site-Infograph                 (2) | Train Loss: 0.8826 | Train Acc: 0.7523
 Site-QuickDraw                 (0) | Train Loss: 0.8793 | Train Acc: 0.7319
Average Train Accuracy: 0.8594
 Site-Real                      (4) | Val  Loss: 0.1646 | Val  Acc: 0.9568
 Site-Clipart                   (1) | Val  Loss: 0.3397 | Val  Acc: 0.8997
 Site-Painting                  (3) | Val  Loss: 0.2312 | Val  Acc: 0.9447
 Site-Sketch                    (1) | Val  Loss: 0.4104 | Val  Acc: 0.8776
 Site-Infograph                 (2) | Val  Loss: 1.0211 | Val  Acc: 0.7027
 Site-QuickDraw                 (0) | Val  Loss: 1.1900 | Val  Acc: 0.5978
Average Valid Accuracy: 0.8299
============ Train epoch 33 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Real                      (3) | Train Loss: 0.1481 | Train Acc: 0.9609
 Site-Clipart                   (0) | Train Loss: 0.2601 | Train Acc: 0.9298
 Site-Painting                  (3) | Train Loss: 0.2602 | Train Acc: 0.9281
 Site-Sketch                    (4) | Train Loss: 0.3909 | Train Acc: 0.8567
 Site-Infograph                 (2) | Train Loss: 0.8439 | Train Acc: 0.7613
 Site-QuickDraw                 (1) | Train Loss: 0.9912 | Train Acc: 0.7246
Average Train Accuracy: 0.8602
 Site-Real                      (3) | Val  Loss: 0.1631 | Val  Acc: 0.9516
 Site-Clipart                   (0) | Val  Loss: 0.3357 | Val  Acc: 0.9095
 Site-Painting                  (3) | Val  Loss: 0.2556 | Val  Acc: 0.9368
 Site-Sketch                    (4) | Val  Loss: 0.3811 | Val  Acc: 0.8819
 Site-Infograph                 (2) | Val  Loss: 0.9283 | Val  Acc: 0.7027
 Site-QuickDraw                 (1) | Val  Loss: 1.1182 | Val  Acc: 0.6196
Average Valid Accuracy: 0.8337
============ Train epoch 34 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Real                      (4) | Train Loss: 0.1404 | Train Acc: 0.9596
 Site-Clipart                   (3) | Train Loss: 0.2361 | Train Acc: 0.9419
 Site-Painting                  (0) | Train Loss: 0.2531 | Train Acc: 0.9228
 Site-Sketch                    (3) | Train Loss: 0.4077 | Train Acc: 0.8736
 Site-Infograph                 (2) | Train Loss: 0.8092 | Train Acc: 0.7342
 Site-QuickDraw                 (1) | Train Loss: 0.7905 | Train Acc: 0.7101
Average Train Accuracy: 0.8570
 Site-Real                      (4) | Val  Loss: 0.1634 | Val  Acc: 0.9547
 Site-Clipart                   (3) | Val  Loss: 0.3165 | Val  Acc: 0.9145
 Site-Painting                  (0) | Val  Loss: 0.2390 | Val  Acc: 0.9526
 Site-Sketch                    (3) | Val  Loss: 0.4104 | Val  Acc: 0.8692
 Site-Infograph                 (2) | Val  Loss: 1.0011 | Val  Acc: 0.7365
 Site-QuickDraw                 (1) | Val  Loss: 1.2060 | Val  Acc: 0.5978
Average Valid Accuracy: 0.8376
============ Train epoch 35 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Real                      (3) | Train Loss: 0.1374 | Train Acc: 0.9616
 Site-Clipart                   (0) | Train Loss: 0.2463 | Train Acc: 0.9408
 Site-Painting                  (3) | Train Loss: 0.2582 | Train Acc: 0.9298
 Site-Sketch                    (4) | Train Loss: 0.3268 | Train Acc: 0.8933
 Site-Infograph                 (2) | Train Loss: 0.7856 | Train Acc: 0.7613
 Site-QuickDraw                 (1) | Train Loss: 0.9770 | Train Acc: 0.7101
Average Train Accuracy: 0.8661
 Site-Real                      (3) | Val  Loss: 0.1560 | Val  Acc: 0.9547
 Site-Clipart                   (0) | Val  Loss: 0.3545 | Val  Acc: 0.8914
 Site-Painting                  (3) | Val  Loss: 0.2473 | Val  Acc: 0.9289
 Site-Sketch                    (4) | Val  Loss: 0.3917 | Val  Acc: 0.8776
 Site-Infograph                 (2) | Val  Loss: 0.9666 | Val  Acc: 0.7095
 Site-QuickDraw                 (1) | Val  Loss: 1.1622 | Val  Acc: 0.6304
Average Valid Accuracy: 0.8321
============ Train epoch 36 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Real                      (1) | Train Loss: 0.1358 | Train Acc: 0.9616
 Site-Clipart                   (4) | Train Loss: 0.2515 | Train Acc: 0.9298
 Site-Painting                  (1) | Train Loss: 0.2548 | Train Acc: 0.9316
 Site-Sketch                    (3) | Train Loss: 0.3809 | Train Acc: 0.8848
 Site-Infograph                 (2) | Train Loss: 0.8254 | Train Acc: 0.7568
 Site-QuickDraw                 (0) | Train Loss: 0.8685 | Train Acc: 0.7029
Average Train Accuracy: 0.8613
 Site-Real                      (1) | Val  Loss: 0.1478 | Val  Acc: 0.9619
 Site-Clipart                   (4) | Val  Loss: 0.3165 | Val  Acc: 0.9062
 Site-Painting                  (1) | Val  Loss: 0.2356 | Val  Acc: 0.9395
 Site-Sketch                    (3) | Val  Loss: 0.3853 | Val  Acc: 0.8608
 Site-Infograph                 (2) | Val  Loss: 0.9847 | Val  Acc: 0.7162
 Site-QuickDraw                 (0) | Val  Loss: 1.1119 | Val  Acc: 0.6630
Average Valid Accuracy: 0.8413
 Best site-Real                     (1)  | Epoch:36 | Val Acc: 0.9619
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.9062
 Best site-Painting                 (1)  | Epoch:36 | Val Acc: 0.9395
 Best site-Sketch                   (3)  | Epoch:36 | Val Acc: 0.8608
 Best site-Infograph                (2)  | Epoch:36 | Val Acc: 0.7162
 Best site-QuickDraw                (0)  | Epoch:36 | Val Acc: 0.6630
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Real                      (0) | Train Loss: 0.1400 | Train Acc: 0.9650
 Site-Clipart                   (3) | Train Loss: 0.2652 | Train Acc: 0.9265
 Site-Painting                  (0) | Train Loss: 0.2363 | Train Acc: 0.9439
 Site-Sketch                    (4) | Train Loss: 0.3858 | Train Acc: 0.8596
 Site-Infograph                 (2) | Train Loss: 0.8325 | Train Acc: 0.7477
 Site-QuickDraw                 (1) | Train Loss: 0.9210 | Train Acc: 0.7029
Average Train Accuracy: 0.8576
 Site-Real                      (0) | Val  Loss: 0.1610 | Val  Acc: 0.9496
 Site-Clipart                   (3) | Val  Loss: 0.3533 | Val  Acc: 0.8914
 Site-Painting                  (0) | Val  Loss: 0.2390 | Val  Acc: 0.9421
 Site-Sketch                    (4) | Val  Loss: 0.3825 | Val  Acc: 0.8861
 Site-Infograph                 (2) | Val  Loss: 0.9585 | Val  Acc: 0.7027
 Site-QuickDraw                 (1) | Val  Loss: 1.1898 | Val  Acc: 0.6196
Average Valid Accuracy: 0.8319
============ Train epoch 38 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Real                      (3) | Train Loss: 0.1401 | Train Acc: 0.9596
 Site-Clipart                   (2) | Train Loss: 0.2443 | Train Acc: 0.9430
 Site-Painting                  (4) | Train Loss: 0.2555 | Train Acc: 0.9281
 Site-Sketch                    (2) | Train Loss: 0.3698 | Train Acc: 0.8764
 Site-Infograph                 (0) | Train Loss: 0.7988 | Train Acc: 0.7342
 Site-QuickDraw                 (1) | Train Loss: 0.8056 | Train Acc: 0.7391
Average Train Accuracy: 0.8634
 Site-Real                      (3) | Val  Loss: 0.1461 | Val  Acc: 0.9568
 Site-Clipart                   (2) | Val  Loss: 0.3119 | Val  Acc: 0.9112
 Site-Painting                  (4) | Val  Loss: 0.2306 | Val  Acc: 0.9421
 Site-Sketch                    (2) | Val  Loss: 0.3872 | Val  Acc: 0.8734
 Site-Infograph                 (0) | Val  Loss: 0.9428 | Val  Acc: 0.7230
 Site-QuickDraw                 (1) | Val  Loss: 1.2035 | Val  Acc: 0.6304
Average Valid Accuracy: 0.8395
============ Train epoch 39 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Real                      (3) | Train Loss: 0.1337 | Train Acc: 0.9637
 Site-Clipart                   (4) | Train Loss: 0.2370 | Train Acc: 0.9474
 Site-Painting                  (3) | Train Loss: 0.2325 | Train Acc: 0.9386
 Site-Sketch                    (0) | Train Loss: 0.3876 | Train Acc: 0.8708
 Site-Infograph                 (2) | Train Loss: 0.8078 | Train Acc: 0.7568
 Site-QuickDraw                 (1) | Train Loss: 0.8953 | Train Acc: 0.7681
Average Train Accuracy: 0.8742
 Site-Real                      (3) | Val  Loss: 0.1603 | Val  Acc: 0.9599
 Site-Clipart                   (4) | Val  Loss: 0.3160 | Val  Acc: 0.9046
 Site-Painting                  (3) | Val  Loss: 0.2503 | Val  Acc: 0.9263
 Site-Sketch                    (0) | Val  Loss: 0.3662 | Val  Acc: 0.8861
 Site-Infograph                 (2) | Val  Loss: 0.9786 | Val  Acc: 0.7095
 Site-QuickDraw                 (1) | Val  Loss: 1.2239 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8379
============ Train epoch 40 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Real                      (3) | Train Loss: 0.1303 | Train Acc: 0.9671
 Site-Clipart                   (2) | Train Loss: 0.2473 | Train Acc: 0.9320
 Site-Painting                  (3) | Train Loss: 0.2348 | Train Acc: 0.9298
 Site-Sketch                    (4) | Train Loss: 0.3338 | Train Acc: 0.8933
 Site-Infograph                 (0) | Train Loss: 0.7265 | Train Acc: 0.8108
 Site-QuickDraw                 (1) | Train Loss: 0.8028 | Train Acc: 0.7681
Average Train Accuracy: 0.8835
 Site-Real                      (3) | Val  Loss: 0.1509 | Val  Acc: 0.9619
 Site-Clipart                   (2) | Val  Loss: 0.3081 | Val  Acc: 0.9243
 Site-Painting                  (3) | Val  Loss: 0.2360 | Val  Acc: 0.9421
 Site-Sketch                    (4) | Val  Loss: 0.4029 | Val  Acc: 0.8608
 Site-Infograph                 (0) | Val  Loss: 0.9487 | Val  Acc: 0.7297
 Site-QuickDraw                 (1) | Val  Loss: 1.0494 | Val  Acc: 0.6630
Average Valid Accuracy: 0.8470
 Best site-Real                     (3)  | Epoch:40 | Val Acc: 0.9619
 Best site-Clipart                  (2)  | Epoch:40 | Val Acc: 0.9243
 Best site-Painting                 (3)  | Epoch:40 | Val Acc: 0.9421
 Best site-Sketch                   (4)  | Epoch:40 | Val Acc: 0.8608
 Best site-Infograph                (0)  | Epoch:40 | Val Acc: 0.7297
 Best site-QuickDraw                (1)  | Epoch:40 | Val Acc: 0.6630
 Test site-Real                      (3)| Epoch:40 | Test Acc: 0.9565
 Test site-Clipart                   (2)| Epoch:40 | Test Acc: 0.9011
 Test site-Painting                  (3)| Epoch:40 | Test Acc: 0.9386
 Test site-Sketch                    (4)| Epoch:40 | Test Acc: 0.8863
 Test site-Infograph                 (0)| Epoch:40 | Test Acc: 0.5769
 Test site-QuickDraw                 (1)| Epoch:40 | Test Acc: 0.6840
Real: 0.9565, Clipart: 0.9011, Painting: 0.9386, Sketch: 0.8863, Infograph: 0.5769, QuickDraw: 0.6840, 
Average Test Accuracy(group): 0.8239, Average Test Accuracy(individual): 0.8239,
domain std=0.1421, cluster std=0.1433, individual std=0.1421, 
Average Test Accuracy: 0.8239
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Real                      (0) | Train Loss: 0.1314 | Train Acc: 0.9644
 Site-Clipart                   (3) | Train Loss: 0.2321 | Train Acc: 0.9364
 Site-Painting                  (0) | Train Loss: 0.2438 | Train Acc: 0.9298
 Site-Sketch                    (4) | Train Loss: 0.3396 | Train Acc: 0.8904
 Site-Infograph                 (2) | Train Loss: 0.7717 | Train Acc: 0.7477
 Site-QuickDraw                 (1) | Train Loss: 0.7705 | Train Acc: 0.7826
Average Train Accuracy: 0.8752
 Site-Real                      (0) | Val  Loss: 0.1616 | Val  Acc: 0.9599
 Site-Clipart                   (3) | Val  Loss: 0.3152 | Val  Acc: 0.9013
 Site-Painting                  (0) | Val  Loss: 0.2429 | Val  Acc: 0.9316
 Site-Sketch                    (4) | Val  Loss: 0.3929 | Val  Acc: 0.8565
 Site-Infograph                 (2) | Val  Loss: 0.9938 | Val  Acc: 0.7027
 Site-QuickDraw                 (1) | Val  Loss: 1.0749 | Val  Acc: 0.6848
Average Valid Accuracy: 0.8395
 Test site-Real                      (0)| Epoch:40 | Test Acc: 0.9573
 Test site-Clipart                   (3)| Epoch:40 | Test Acc: 0.9011
 Test site-Painting                  (0)| Epoch:40 | Test Acc: 0.9354
 Test site-Sketch                    (4)| Epoch:40 | Test Acc: 0.8917
 Test site-Infograph                 (2)| Epoch:40 | Test Acc: 0.5845
 Test site-QuickDraw                 (1)| Epoch:40 | Test Acc: 0.6760
Real: 0.9573, Clipart: 0.9011, Painting: 0.9354, Sketch: 0.8917, Infograph: 0.5845, QuickDraw: 0.6760, 
Average Test Accuracy(group): 0.8243, Average Test Accuracy(individual): 0.8243,
domain std=0.1414, cluster std=0.1427, individual std=0.1414, 
Average Test Accuracy: 0.8243
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Real                      (0) | Train Loss: 0.1277 | Train Acc: 0.9623
 Site-Clipart                   (3) | Train Loss: 0.2322 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.2334 | Train Acc: 0.9333
 Site-Sketch                    (4) | Train Loss: 0.3501 | Train Acc: 0.8820
 Site-Infograph                 (2) | Train Loss: 0.7541 | Train Acc: 0.7613
 Site-QuickDraw                 (1) | Train Loss: 0.7985 | Train Acc: 0.7609
Average Train Accuracy: 0.8732
 Site-Real                      (0) | Val  Loss: 0.1377 | Val  Acc: 0.9599
 Site-Clipart                   (3) | Val  Loss: 0.3203 | Val  Acc: 0.9128
 Site-Painting                  (0) | Val  Loss: 0.2398 | Val  Acc: 0.9342
 Site-Sketch                    (4) | Val  Loss: 0.3657 | Val  Acc: 0.8565
 Site-Infograph                 (2) | Val  Loss: 0.9656 | Val  Acc: 0.6892
 Site-QuickDraw                 (1) | Val  Loss: 1.0373 | Val  Acc: 0.6739
Average Valid Accuracy: 0.8378
 Test site-Real                      (0)| Epoch:41 | Test Acc: 0.9565
 Test site-Clipart                   (3)| Epoch:41 | Test Acc: 0.9011
 Test site-Painting                  (0)| Epoch:41 | Test Acc: 0.9402
 Test site-Sketch                    (4)| Epoch:41 | Test Acc: 0.8917
 Test site-Infograph                 (2)| Epoch:41 | Test Acc: 0.5799
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.6740
Real: 0.9565, Clipart: 0.9011, Painting: 0.9402, Sketch: 0.8917, Infograph: 0.5799, QuickDraw: 0.6740, 
Average Test Accuracy(group): 0.8239, Average Test Accuracy(individual): 0.8239,
domain std=0.1436, cluster std=0.1449, individual std=0.1436, 
Average Test Accuracy: 0.8239
============ Train epoch 43 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Real                      (0) | Train Loss: 0.1261 | Train Acc: 0.9630
 Site-Clipart                   (4) | Train Loss: 0.2264 | Train Acc: 0.9474
 Site-Painting                  (0) | Train Loss: 0.2471 | Train Acc: 0.9316
 Site-Sketch                    (3) | Train Loss: 0.3067 | Train Acc: 0.9017
 Site-Infograph                 (2) | Train Loss: 0.7389 | Train Acc: 0.7883
 Site-QuickDraw                 (1) | Train Loss: 0.6921 | Train Acc: 0.7174
Average Train Accuracy: 0.8749
 Site-Real                      (0) | Val  Loss: 0.1515 | Val  Acc: 0.9609
 Site-Clipart                   (4) | Val  Loss: 0.3119 | Val  Acc: 0.9145
 Site-Painting                  (0) | Val  Loss: 0.2331 | Val  Acc: 0.9342
 Site-Sketch                    (3) | Val  Loss: 0.3803 | Val  Acc: 0.8692
 Site-Infograph                 (2) | Val  Loss: 0.9685 | Val  Acc: 0.7635
 Site-QuickDraw                 (1) | Val  Loss: 1.1519 | Val  Acc: 0.6848
Average Valid Accuracy: 0.8545
 Best site-Real                     (0)  | Epoch:43 | Val Acc: 0.9609
 Best site-Clipart                  (4)  | Epoch:43 | Val Acc: 0.9145
 Best site-Painting                 (0)  | Epoch:43 | Val Acc: 0.9342
 Best site-Sketch                   (3)  | Epoch:43 | Val Acc: 0.8692
 Best site-Infograph                (2)  | Epoch:43 | Val Acc: 0.7635
 Best site-QuickDraw                (1)  | Epoch:43 | Val Acc: 0.6848
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9581
 Test site-Clipart                   (4)| Epoch:43 | Test Acc: 0.9011
 Test site-Painting                  (0)| Epoch:43 | Test Acc: 0.9354
 Test site-Sketch                    (3)| Epoch:43 | Test Acc: 0.8917
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.5799
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.6720
Real: 0.9581, Clipart: 0.9011, Painting: 0.9354, Sketch: 0.8917, Infograph: 0.5799, QuickDraw: 0.6720, 
Average Test Accuracy(group): 0.8230, Average Test Accuracy(individual): 0.8230,
domain std=0.1435, cluster std=0.1449, individual std=0.1435, 
Average Test Accuracy: 0.8230
============ Train epoch 44 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Real                      (3) | Train Loss: 0.1255 | Train Acc: 0.9616
 Site-Clipart                   (0) | Train Loss: 0.2241 | Train Acc: 0.9364
 Site-Painting                  (3) | Train Loss: 0.2393 | Train Acc: 0.9351
 Site-Sketch                    (4) | Train Loss: 0.3064 | Train Acc: 0.8848
 Site-Infograph                 (2) | Train Loss: 0.7230 | Train Acc: 0.7928
 Site-QuickDraw                 (1) | Train Loss: 0.8527 | Train Acc: 0.7826
Average Train Accuracy: 0.8822
 Site-Real                      (3) | Val  Loss: 0.1437 | Val  Acc: 0.9650
 Site-Clipart                   (0) | Val  Loss: 0.3041 | Val  Acc: 0.9227
 Site-Painting                  (3) | Val  Loss: 0.2417 | Val  Acc: 0.9342
 Site-Sketch                    (4) | Val  Loss: 0.3659 | Val  Acc: 0.8903
 Site-Infograph                 (2) | Val  Loss: 0.9716 | Val  Acc: 0.7095
 Site-QuickDraw                 (1) | Val  Loss: 1.0948 | Val  Acc: 0.6630
Average Valid Accuracy: 0.8475
 Test site-Real                      (3)| Epoch:43 | Test Acc: 0.9573
 Test site-Clipart                   (0)| Epoch:43 | Test Acc: 0.9030
 Test site-Painting                  (3)| Epoch:43 | Test Acc: 0.9402
 Test site-Sketch                    (4)| Epoch:43 | Test Acc: 0.8953
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.5769
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.6710
Real: 0.9573, Clipart: 0.9030, Painting: 0.9402, Sketch: 0.8953, Infograph: 0.5769, QuickDraw: 0.6710, 
Average Test Accuracy(group): 0.8240, Average Test Accuracy(individual): 0.8240,
domain std=0.1455, cluster std=0.1471, individual std=0.1455, 
Average Test Accuracy: 0.8240
============ Train epoch 45 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Real                      (2) | Train Loss: 0.1184 | Train Acc: 0.9712
 Site-Clipart                   (4) | Train Loss: 0.2357 | Train Acc: 0.9375
 Site-Painting                  (2) | Train Loss: 0.2411 | Train Acc: 0.9228
 Site-Sketch                    (3) | Train Loss: 0.3269 | Train Acc: 0.9045
 Site-Infograph                 (0) | Train Loss: 0.7060 | Train Acc: 0.7928
 Site-QuickDraw                 (1) | Train Loss: 0.6711 | Train Acc: 0.7826
Average Train Accuracy: 0.8852
 Site-Real                      (2) | Val  Loss: 0.1388 | Val  Acc: 0.9630
 Site-Clipart                   (4) | Val  Loss: 0.2930 | Val  Acc: 0.9145
 Site-Painting                  (2) | Val  Loss: 0.2513 | Val  Acc: 0.9211
 Site-Sketch                    (3) | Val  Loss: 0.3990 | Val  Acc: 0.8861
 Site-Infograph                 (0) | Val  Loss: 1.0275 | Val  Acc: 0.7365
 Site-QuickDraw                 (1) | Val  Loss: 1.0891 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8528
 Test site-Real                      (2)| Epoch:43 | Test Acc: 0.9565
 Test site-Clipart                   (4)| Epoch:43 | Test Acc: 0.9030
 Test site-Painting                  (2)| Epoch:43 | Test Acc: 0.9386
 Test site-Sketch                    (3)| Epoch:43 | Test Acc: 0.8917
 Test site-Infograph                 (0)| Epoch:43 | Test Acc: 0.5799
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.6750
Real: 0.9565, Clipart: 0.9030, Painting: 0.9386, Sketch: 0.8917, Infograph: 0.5799, QuickDraw: 0.6750, 
Average Test Accuracy(group): 0.8241, Average Test Accuracy(individual): 0.8241,
domain std=0.1433, cluster std=0.1448, individual std=0.1433, 
Average Test Accuracy: 0.8241
============ Train epoch 46 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Real                      (3) | Train Loss: 0.1160 | Train Acc: 0.9671
 Site-Clipart                   (4) | Train Loss: 0.2120 | Train Acc: 0.9375
 Site-Painting                  (3) | Train Loss: 0.2268 | Train Acc: 0.9368
 Site-Sketch                    (1) | Train Loss: 0.3710 | Train Acc: 0.8792
 Site-Infograph                 (2) | Train Loss: 0.6720 | Train Acc: 0.8378
 Site-QuickDraw                 (0) | Train Loss: 0.7202 | Train Acc: 0.7826
Average Train Accuracy: 0.8902
 Site-Real                      (3) | Val  Loss: 0.1429 | Val  Acc: 0.9588
 Site-Clipart                   (4) | Val  Loss: 0.2876 | Val  Acc: 0.9309
 Site-Painting                  (3) | Val  Loss: 0.2091 | Val  Acc: 0.9447
 Site-Sketch                    (1) | Val  Loss: 0.3348 | Val  Acc: 0.8861
 Site-Infograph                 (2) | Val  Loss: 0.9816 | Val  Acc: 0.7162
 Site-QuickDraw                 (0) | Val  Loss: 1.0583 | Val  Acc: 0.6739
Average Valid Accuracy: 0.8518
 Test site-Real                      (3)| Epoch:43 | Test Acc: 0.9581
 Test site-Clipart                   (4)| Epoch:43 | Test Acc: 0.9030
 Test site-Painting                  (3)| Epoch:43 | Test Acc: 0.9386
 Test site-Sketch                    (1)| Epoch:43 | Test Acc: 0.8953
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.5860
 Test site-QuickDraw                 (0)| Epoch:43 | Test Acc: 0.6770
Real: 0.9581, Clipart: 0.9030, Painting: 0.9386, Sketch: 0.8953, Infograph: 0.5860, QuickDraw: 0.6770, 
Average Test Accuracy(group): 0.8263, Average Test Accuracy(individual): 0.8263,
domain std=0.1418, cluster std=0.1433, individual std=0.1418, 
Average Test Accuracy: 0.8263
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
============ Train epoch 47 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Real                      (3) | Train Loss: 0.1231 | Train Acc: 0.9644
 Site-Clipart                   (0) | Train Loss: 0.2309 | Train Acc: 0.9408
 Site-Painting                  (3) | Train Loss: 0.2291 | Train Acc: 0.9333
 Site-Sketch                    (4) | Train Loss: 0.3102 | Train Acc: 0.9017
 Site-Infograph                 (2) | Train Loss: 0.7124 | Train Acc: 0.7883
 Site-QuickDraw                 (1) | Train Loss: 0.8689 | Train Acc: 0.7536
Average Train Accuracy: 0.8803
 Site-Real                      (3) | Val  Loss: 0.1529 | Val  Acc: 0.9558
 Site-Clipart                   (0) | Val  Loss: 0.3143 | Val  Acc: 0.9013
 Site-Painting                  (3) | Val  Loss: 0.2528 | Val  Acc: 0.9184
 Site-Sketch                    (4) | Val  Loss: 0.3549 | Val  Acc: 0.8692
 Site-Infograph                 (2) | Val  Loss: 0.9598 | Val  Acc: 0.7500
 Site-QuickDraw                 (1) | Val  Loss: 1.0683 | Val  Acc: 0.6739
Average Valid Accuracy: 0.8448
 Test site-Real                      (3)| Epoch:46 | Test Acc: 0.9573
 Test site-Clipart                   (0)| Epoch:46 | Test Acc: 0.9030
 Test site-Painting                  (3)| Epoch:46 | Test Acc: 0.9321
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8899
 Test site-Infograph                 (2)| Epoch:46 | Test Acc: 0.5814
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.6760
Real: 0.9573, Clipart: 0.9030, Painting: 0.9321, Sketch: 0.8899, Infograph: 0.5814, QuickDraw: 0.6760, 
Average Test Accuracy(group): 0.8233, Average Test Accuracy(individual): 0.8233,
domain std=0.1419, cluster std=0.1434, individual std=0.1419, 
Average Test Accuracy: 0.8233
============ Train epoch 48 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Real                      (3) | Train Loss: 0.1253 | Train Acc: 0.9637
 Site-Clipart                   (2) | Train Loss: 0.2253 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.2293 | Train Acc: 0.9263
 Site-Sketch                    (4) | Train Loss: 0.3121 | Train Acc: 0.8961
 Site-Infograph                 (0) | Train Loss: 0.6903 | Train Acc: 0.8243
 Site-QuickDraw                 (1) | Train Loss: 0.7900 | Train Acc: 0.8188
Average Train Accuracy: 0.8948
 Site-Real                      (3) | Val  Loss: 0.1463 | Val  Acc: 0.9619
 Site-Clipart                   (2) | Val  Loss: 0.2978 | Val  Acc: 0.9178
 Site-Painting                  (3) | Val  Loss: 0.2283 | Val  Acc: 0.9316
 Site-Sketch                    (4) | Val  Loss: 0.3776 | Val  Acc: 0.8734
 Site-Infograph                 (0) | Val  Loss: 1.0041 | Val  Acc: 0.7095
 Site-QuickDraw                 (1) | Val  Loss: 1.0174 | Val  Acc: 0.6848
Average Valid Accuracy: 0.8465
 Test site-Real                      (3)| Epoch:46 | Test Acc: 0.9581
 Test site-Clipart                   (2)| Epoch:46 | Test Acc: 0.9068
 Test site-Painting                  (3)| Epoch:46 | Test Acc: 0.9402
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8917
 Test site-Infograph                 (0)| Epoch:46 | Test Acc: 0.5799
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.6750
Real: 0.9581, Clipart: 0.9068, Painting: 0.9402, Sketch: 0.8917, Infograph: 0.5799, QuickDraw: 0.6750, 
Average Test Accuracy(group): 0.8253, Average Test Accuracy(individual): 0.8253,
domain std=0.1442, cluster std=0.1457, individual std=0.1442, 
Average Test Accuracy: 0.8253
============ Train epoch 49 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Real                      (1) | Train Loss: 0.1212 | Train Acc: 0.9644
 Site-Clipart                   (4) | Train Loss: 0.2151 | Train Acc: 0.9441
 Site-Painting                  (1) | Train Loss: 0.2224 | Train Acc: 0.9386
 Site-Sketch                    (3) | Train Loss: 0.3510 | Train Acc: 0.8961
 Site-Infograph                 (2) | Train Loss: 0.7271 | Train Acc: 0.8153
 Site-QuickDraw                 (0) | Train Loss: 0.7951 | Train Acc: 0.7536
Average Train Accuracy: 0.8853
 Site-Real                      (1) | Val  Loss: 0.1432 | Val  Acc: 0.9640
 Site-Clipart                   (4) | Val  Loss: 0.2865 | Val  Acc: 0.9293
 Site-Painting                  (1) | Val  Loss: 0.2503 | Val  Acc: 0.9263
 Site-Sketch                    (3) | Val  Loss: 0.3359 | Val  Acc: 0.8776
 Site-Infograph                 (2) | Val  Loss: 0.9503 | Val  Acc: 0.7162
 Site-QuickDraw                 (0) | Val  Loss: 1.0600 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8443
 Test site-Real                      (1)| Epoch:46 | Test Acc: 0.9581
 Test site-Clipart                   (4)| Epoch:46 | Test Acc: 0.9068
 Test site-Painting                  (1)| Epoch:46 | Test Acc: 0.9402
 Test site-Sketch                    (3)| Epoch:46 | Test Acc: 0.8935
 Test site-Infograph                 (2)| Epoch:46 | Test Acc: 0.5921
 Test site-QuickDraw                 (0)| Epoch:46 | Test Acc: 0.6800
Real: 0.9581, Clipart: 0.9068, Painting: 0.9402, Sketch: 0.8935, Infograph: 0.5921, QuickDraw: 0.6800, 
Average Test Accuracy(group): 0.8285, Average Test Accuracy(individual): 0.8285,
domain std=0.1400, cluster std=0.1414, individual std=0.1400, 
Average Test Accuracy: 0.8285
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_1_shuffle_clscon_distinct/ccop_q=1...
===2023-07-02 05:50:47===
===2023-07-02 05:50:49===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1459,912,570,356,222,138,
client_nums=[1,1,1,1,1,1,]
len_dataset=[4864,3040,1900,1187,741,463,]
domain number = 6
Loading snapshots...
 Test site-Real                      (1)| Epoch:49 | Test Acc: 0.9581
 Test site-Clipart                   (4)| Epoch:49 | Test Acc: 0.9068
 Test site-Painting                  (1)| Epoch:49 | Test Acc: 0.9402
 Test site-Sketch                    (3)| Epoch:49 | Test Acc: 0.8935
 Test site-Infograph                 (2)| Epoch:49 | Test Acc: 0.5921
 Test site-QuickDraw                 (0)| Epoch:49 | Test Acc: 0.6800
Real: 0.9581, Clipart: 0.9068, Painting: 0.9402, Sketch: 0.8935, Infograph: 0.5921, QuickDraw: 0.6800, 
Average Test Accuracy(group): 0.8285, Average Test Accuracy(individual): 0.8285,
domain std=0.1400, cluster std=0.1414, individual std=0.1400, 
