===2023-04-19 17:24:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 2.2193 | Train Acc: 0.1739
 Site-MNIST     | Train Loss: 2.2639 | Train Acc: 0.0426
 Site-MNIST     | Train Loss: 2.2600 | Train Acc: 0.1268
 Site-MNIST     | Train Loss: 2.2184 | Train Acc: 0.1702
 Site-MNIST     | Train Loss: 2.2484 | Train Acc: 0.1356
 Site-SVHN      | Train Loss: 2.4001 | Train Acc: 0.1000
 Site-USPS      | Train Loss: 2.3624 | Train Acc: 0.0682
 Site-SynthDigits| Train Loss: 2.3136 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.2631 | Train Acc: 0.1689
 Site-MNIST-M   | Train Loss: 2.4066 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.2742 | Val  Acc: 0.1333
 Site-MNIST     | Val  Loss: 2.2262 | Val  Acc: 0.2581
 Site-MNIST     | Val  Loss: 2.2257 | Val  Acc: 0.1702
 Site-MNIST     | Val  Loss: 2.2178 | Val  Acc: 0.2222
 Site-MNIST     | Val  Loss: 2.2541 | Val  Acc: 0.1392
 Site-SVHN      | Val  Loss: 2.3248 | Val  Acc: 0.1212
 Site-USPS      | Val  Loss: 2.3540 | Val  Acc: 0.1034
 Site-SynthDigits| Val  Loss: 2.3301 | Val  Acc: 0.1020
 Site-SynthDigits| Val  Loss: 2.2743 | Val  Acc: 0.1429
 Site-MNIST-M   | Val  Loss: 2.3841 | Val  Acc: 0.1818
Average Valid Accuracy: 0.1574
Aggregated Acc | Val Acc: 0.1427
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1333
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2581
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1702
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2222
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1392
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1212
 Best site-USPS       | Epoch:0 | Val Acc: 0.1034
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1020
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1429
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 1 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 2.0975 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.1027 | Train Acc: 0.2128
 Site-MNIST     | Train Loss: 2.1059 | Train Acc: 0.2958
 Site-MNIST     | Train Loss: 2.0778 | Train Acc: 0.3085
 Site-MNIST     | Train Loss: 2.0677 | Train Acc: 0.3136
 Site-SVHN      | Train Loss: 2.2487 | Train Acc: 0.1200
 Site-USPS      | Train Loss: 2.2465 | Train Acc: 0.1818
 Site-SynthDigits| Train Loss: 2.2508 | Train Acc: 0.1486
 Site-SynthDigits| Train Loss: 2.2108 | Train Acc: 0.2297
 Site-MNIST-M   | Train Loss: 2.4637 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.1007 | Val  Acc: 0.2000
 Site-MNIST     | Val  Loss: 2.0683 | Val  Acc: 0.2903
 Site-MNIST     | Val  Loss: 2.0954 | Val  Acc: 0.3191
 Site-MNIST     | Val  Loss: 2.0853 | Val  Acc: 0.3492
 Site-MNIST     | Val  Loss: 2.1086 | Val  Acc: 0.2785
 Site-SVHN      | Val  Loss: 2.3065 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 2.2626 | Val  Acc: 0.1724
 Site-SynthDigits| Val  Loss: 2.2599 | Val  Acc: 0.1429
 Site-SynthDigits| Val  Loss: 2.2290 | Val  Acc: 0.2041
 Site-MNIST-M   | Val  Loss: 2.3431 | Val  Acc: 0.1364
Average Valid Accuracy: 0.2244
Aggregated Acc | Val Acc: 0.1842
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2903
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3191
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3492
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2785
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1515
 Best site-USPS       | Epoch:1 | Val Acc: 0.1724
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1429
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2041
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 2 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 2.0837 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9701 | Train Acc: 0.3617
 Site-MNIST     | Train Loss: 1.9784 | Train Acc: 0.3944
 Site-MNIST     | Train Loss: 1.9505 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.9331 | Train Acc: 0.4576
 Site-SVHN      | Train Loss: 2.3447 | Train Acc: 0.2000
 Site-USPS      | Train Loss: 2.1563 | Train Acc: 0.2955
 Site-SynthDigits| Train Loss: 2.2001 | Train Acc: 0.2297
 Site-SynthDigits| Train Loss: 2.1755 | Train Acc: 0.2838
 Site-MNIST-M   | Train Loss: 2.3677 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.9312 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.9302 | Val  Acc: 0.6129
 Site-MNIST     | Val  Loss: 1.9754 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 1.9675 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 1.9791 | Val  Acc: 0.4304
 Site-SVHN      | Val  Loss: 2.2604 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 2.1874 | Val  Acc: 0.3793
 Site-SynthDigits| Val  Loss: 2.1797 | Val  Acc: 0.2041
 Site-SynthDigits| Val  Loss: 2.1534 | Val  Acc: 0.2551
 Site-MNIST-M   | Val  Loss: 2.3098 | Val  Acc: 0.1364
Average Valid Accuracy: 0.3833
Aggregated Acc | Val Acc: 0.2973
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6129
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5106
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4921
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4304
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2121
 Best site-USPS       | Epoch:2 | Val Acc: 0.3793
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2041
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2551
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 3 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.9477 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.8377 | Train Acc: 0.5745
 Site-MNIST     | Train Loss: 1.8682 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 1.8330 | Train Acc: 0.6064
 Site-MNIST     | Train Loss: 1.8039 | Train Acc: 0.6017
 Site-SVHN      | Train Loss: 2.2035 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.0509 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 2.1323 | Train Acc: 0.2297
 Site-SynthDigits| Train Loss: 2.1007 | Train Acc: 0.3378
 Site-MNIST-M   | Train Loss: 2.5569 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.7983 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8017 | Val  Acc: 0.7097
 Site-MNIST     | Val  Loss: 1.8551 | Val  Acc: 0.5957
 Site-MNIST     | Val  Loss: 1.8448 | Val  Acc: 0.6032
 Site-MNIST     | Val  Loss: 1.8567 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2284 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.1184 | Val  Acc: 0.3793
 Site-SynthDigits| Val  Loss: 2.1431 | Val  Acc: 0.2245
 Site-SynthDigits| Val  Loss: 2.1109 | Val  Acc: 0.2755
 Site-MNIST-M   | Val  Loss: 2.2862 | Val  Acc: 0.1364
Average Valid Accuracy: 0.4426
Aggregated Acc | Val Acc: 0.3380
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7097
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5957
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6032
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5316
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3030
 Best site-USPS       | Epoch:3 | Val Acc: 0.3793
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2245
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2755
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 4 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.8600 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.7298 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.7516 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.7324 | Train Acc: 0.6277
 Site-MNIST     | Train Loss: 1.6970 | Train Acc: 0.6441
 Site-SVHN      | Train Loss: 2.1311 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 1.9566 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 2.0893 | Train Acc: 0.2432
 Site-SynthDigits| Train Loss: 2.0181 | Train Acc: 0.3378
 Site-MNIST-M   | Train Loss: 2.3641 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.6901 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.6984 | Val  Acc: 0.7419
 Site-MNIST     | Val  Loss: 1.7604 | Val  Acc: 0.5957
 Site-MNIST     | Val  Loss: 1.7510 | Val  Acc: 0.6032
 Site-MNIST     | Val  Loss: 1.7443 | Val  Acc: 0.6076
 Site-SVHN      | Val  Loss: 2.1984 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 2.0340 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.1003 | Val  Acc: 0.3265
 Site-SynthDigits| Val  Loss: 2.0506 | Val  Acc: 0.3469
 Site-MNIST-M   | Val  Loss: 2.2674 | Val  Acc: 0.0909
Average Valid Accuracy: 0.4929
Aggregated Acc | Val Acc: 0.3827
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7419
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5957
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6032
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6076
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3333
 Best site-USPS       | Epoch:4 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3265
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3469
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 5 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-1
client-6 is in G-0
client-7 is in G-3
client-8 is in G-3
client-9 is in G-4
cnt=[1, 1, 5, 2, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.8025 | Train Acc: 0.4783
 Site-MNIST     | Train Loss: 1.6275 | Train Acc: 0.6170
 Site-MNIST     | Train Loss: 1.6598 | Train Acc: 0.6338
 Site-MNIST     | Train Loss: 1.6395 | Train Acc: 0.6489
 Site-MNIST     | Train Loss: 1.5762 | Train Acc: 0.6780
 Site-SVHN      | Train Loss: 2.1279 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.8479 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.0353 | Train Acc: 0.2838
 Site-SynthDigits| Train Loss: 1.9601 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.5068 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.5856 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.5977 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.6722 | Val  Acc: 0.6383
 Site-MNIST     | Val  Loss: 1.6607 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.6380 | Val  Acc: 0.6456
 Site-SVHN      | Val  Loss: 2.1657 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.9471 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.0561 | Val  Acc: 0.3673
 Site-SynthDigits| Val  Loss: 2.0010 | Val  Acc: 0.3673
 Site-MNIST-M   | Val  Loss: 2.2418 | Val  Acc: 0.0909
Average Valid Accuracy: 0.5155
Aggregated Acc | Val Acc: 0.3961
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6383
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6456
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3030
 Best site-USPS       | Epoch:5 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3673
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3673
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 6 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 1.7586 | Train Acc: 0.5217
 Site-MNIST     | Train Loss: 1.5407 | Train Acc: 0.6809
 Site-MNIST     | Train Loss: 1.5739 | Train Acc: 0.6761
 Site-MNIST     | Train Loss: 1.5628 | Train Acc: 0.6702
 Site-MNIST     | Train Loss: 1.4726 | Train Acc: 0.7288
 Site-SVHN      | Train Loss: 2.1333 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.7799 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.9845 | Train Acc: 0.3378
 Site-SynthDigits| Train Loss: 1.9537 | Train Acc: 0.3919
 Site-MNIST-M   | Train Loss: 2.2990 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.5026 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.5136 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.5930 | Val  Acc: 0.6809
 Site-MNIST     | Val  Loss: 1.5781 | Val  Acc: 0.6508
 Site-MNIST     | Val  Loss: 1.5458 | Val  Acc: 0.6835
 Site-SVHN      | Val  Loss: 2.1543 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.8769 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.0181 | Val  Acc: 0.3878
 Site-SynthDigits| Val  Loss: 1.9507 | Val  Acc: 0.4286
 Site-MNIST-M   | Val  Loss: 2.2209 | Val  Acc: 0.0909
Average Valid Accuracy: 0.5319
Aggregated Acc | Val Acc: 0.4027
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6809
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6508
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6835
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2727
 Best site-USPS       | Epoch:6 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3878
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4286
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 7 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 1.6121 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.4520 | Train Acc: 0.7447
 Site-MNIST     | Train Loss: 1.5118 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.4826 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.4178 | Train Acc: 0.7966
 Site-SVHN      | Train Loss: 2.0359 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.7017 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.9473 | Train Acc: 0.4189
 Site-SynthDigits| Train Loss: 1.8840 | Train Acc: 0.4257
 Site-MNIST-M   | Train Loss: 2.2107 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.4355 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.4413 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.5165 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.5044 | Val  Acc: 0.6984
 Site-MNIST     | Val  Loss: 1.4668 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.1270 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.8164 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 1.9656 | Val  Acc: 0.4082
 Site-SynthDigits| Val  Loss: 1.8975 | Val  Acc: 0.4592
 Site-MNIST-M   | Val  Loss: 2.2070 | Val  Acc: 0.0909
Average Valid Accuracy: 0.5561
Aggregated Acc | Val Acc: 0.4203
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7234
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6984
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3030
 Best site-USPS       | Epoch:7 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4082
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4592
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 8 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.5535 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.3627 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.3828 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.4012 | Train Acc: 0.7447
 Site-MNIST     | Train Loss: 1.3326 | Train Acc: 0.8305
 Site-SVHN      | Train Loss: 2.0884 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.6391 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.9008 | Train Acc: 0.3649
 Site-SynthDigits| Train Loss: 1.8397 | Train Acc: 0.4392
 Site-MNIST-M   | Train Loss: 2.4656 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.3521 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.3582 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.4403 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.4298 | Val  Acc: 0.6984
 Site-MNIST     | Val  Loss: 1.3913 | Val  Acc: 0.7342
 Site-SVHN      | Val  Loss: 2.0977 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.7622 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 1.9316 | Val  Acc: 0.4082
 Site-SynthDigits| Val  Loss: 1.8535 | Val  Acc: 0.4694
 Site-MNIST-M   | Val  Loss: 2.1891 | Val  Acc: 0.0909
Average Valid Accuracy: 0.5725
Aggregated Acc | Val Acc: 0.4274
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6984
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7342
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3030
 Best site-USPS       | Epoch:8 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4082
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4694
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 9 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-3
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 1.5043 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.2875 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.3562 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 1.3380 | Train Acc: 0.7553
 Site-MNIST     | Train Loss: 1.2747 | Train Acc: 0.8305
 Site-SVHN      | Train Loss: 2.0556 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.6124 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.8631 | Train Acc: 0.4054
 Site-SynthDigits| Train Loss: 1.8042 | Train Acc: 0.4662
 Site-MNIST-M   | Train Loss: 2.3923 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.2777 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.2852 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.3689 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.3619 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.3274 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 2.0857 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.7162 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 1.9055 | Val  Acc: 0.4286
 Site-SynthDigits| Val  Loss: 1.8121 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.1787 | Val  Acc: 0.1364
Average Valid Accuracy: 0.5832
Aggregated Acc | Val Acc: 0.4372
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7595
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2727
 Best site-USPS       | Epoch:9 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4286
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.6586
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2589
 Test site-USPS      | Epoch:9 | Test Acc: 0.6075
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.3870
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.2293
Average Test Accuracy: 0.4283
============ Train epoch 10 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.5197 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.2209 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.2840 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.2716 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.2200 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.1790 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.5238 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.8088 | Train Acc: 0.4595
 Site-SynthDigits| Train Loss: 1.7615 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.1573 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.2096 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.2193 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.3051 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.3039 | Val  Acc: 0.7302
 Site-MNIST     | Val  Loss: 1.2675 | Val  Acc: 0.7722
 Site-SVHN      | Val  Loss: 2.0765 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.6660 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 1.8670 | Val  Acc: 0.4898
 Site-SynthDigits| Val  Loss: 1.7700 | Val  Acc: 0.5204
 Site-MNIST-M   | Val  Loss: 2.1641 | Val  Acc: 0.1364
Average Valid Accuracy: 0.6038
Aggregated Acc | Val Acc: 0.4655
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7302
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7722
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3333
 Best site-USPS       | Epoch:10 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.4898
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.5204
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 11 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 1.4975 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.1597 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.2058 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.2172 | Train Acc: 0.7553
 Site-MNIST     | Train Loss: 1.1473 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.0289 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.5139 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.7490 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.7333 | Train Acc: 0.5270
 Site-MNIST-M   | Train Loss: 2.3411 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.1432 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.1559 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.2513 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.2481 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.2084 | Val  Acc: 0.7722
 Site-SVHN      | Val  Loss: 2.0412 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.6150 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.8301 | Val  Acc: 0.4694
 Site-SynthDigits| Val  Loss: 1.7246 | Val  Acc: 0.5510
 Site-MNIST-M   | Val  Loss: 2.1507 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6177
Aggregated Acc | Val Acc: 0.4949
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7722
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3636
 Best site-USPS       | Epoch:11 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.4694
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.5510
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 12 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-4
client-8 is in G-4
client-9 is in G-3
cnt=[1, 5, 1, 1, 2, ]
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 1.3615 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.1195 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.2205 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.1746 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.0602 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.1478 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 1.4158 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.7145 | Train Acc: 0.5405
 Site-SynthDigits| Train Loss: 1.6372 | Train Acc: 0.5473
 Site-MNIST-M   | Train Loss: 2.2524 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.0993 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.1085 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.2073 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 1.2027 | Val  Acc: 0.7460
 Site-MNIST     | Val  Loss: 1.1574 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 2.0120 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.5600 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.7869 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.6848 | Val  Acc: 0.5612
 Site-MNIST-M   | Val  Loss: 2.1393 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6422
Aggregated Acc | Val Acc: 0.5145
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7460
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7595
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3636
 Best site-USPS       | Epoch:12 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5612
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 13 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 1.4003 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.0653 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.1221 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.1352 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.0517 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 1.9663 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 1.3956 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.6873 | Train Acc: 0.5811
 Site-SynthDigits| Train Loss: 1.6243 | Train Acc: 0.5338
 Site-MNIST-M   | Train Loss: 2.2048 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 1.0530 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.0585 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.1636 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 1.1627 | Val  Acc: 0.7460
 Site-MNIST     | Val  Loss: 1.1104 | Val  Acc: 0.7722
 Site-SVHN      | Val  Loss: 1.9779 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.5147 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.7200 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.6379 | Val  Acc: 0.5612
 Site-MNIST-M   | Val  Loss: 2.1150 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6465
Aggregated Acc | Val Acc: 0.5210
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7460
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7722
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3939
 Best site-USPS       | Epoch:13 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.5612
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 14 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[1, 5, 2, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.2677 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 1.0183 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.0906 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 1.0850 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 0.9757 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 2.0248 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.3507 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.6489 | Train Acc: 0.5541
 Site-SynthDigits| Train Loss: 1.5760 | Train Acc: 0.5405
 Site-MNIST-M   | Train Loss: 2.3595 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 0.9925 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.0002 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.1134 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.1189 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.0663 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 1.9601 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.4769 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.6725 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.5953 | Val  Acc: 0.5612
 Site-MNIST-M   | Val  Loss: 2.0990 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6592
Aggregated Acc | Val Acc: 0.5365
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:14 | Val Acc: 0.4242
 Best site-USPS       | Epoch:14 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.5612
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 15 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 1.2248 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.9733 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 1.0565 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 1.0511 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.9659 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.9733 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 1.3178 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.6126 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 1.5151 | Train Acc: 0.5541
 Site-MNIST-M   | Train Loss: 2.3445 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 0.9503 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.9591 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.0710 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.0806 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 1.0278 | Val  Acc: 0.8101
 Site-SVHN      | Val  Loss: 1.9513 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.4440 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.6436 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.5626 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 2.0949 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6600
Aggregated Acc | Val Acc: 0.5326
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8101
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3939
 Best site-USPS       | Epoch:15 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.5714
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 16 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.1705 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.9240 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 1.0400 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.0120 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.9332 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.8631 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 1.2831 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.5643 | Train Acc: 0.5811
 Site-SynthDigits| Train Loss: 1.5034 | Train Acc: 0.5541
 Site-MNIST-M   | Train Loss: 2.2029 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 0.9059 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.9161 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.0305 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.0426 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.9893 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.9399 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.4083 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.6122 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.5286 | Val  Acc: 0.5510
 Site-MNIST-M   | Val  Loss: 2.0880 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6669
Aggregated Acc | Val Acc: 0.5341
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:16 | Val Acc: 0.3939
 Best site-USPS       | Epoch:16 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.5510
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 17 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 1.1292 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.8984 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.9711 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 0.9723 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.9089 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 2.1412 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.2520 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.5069 | Train Acc: 0.5811
 Site-SynthDigits| Train Loss: 1.4633 | Train Acc: 0.5608
 Site-MNIST-M   | Train Loss: 2.1558 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 0.8673 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8808 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9943 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.0053 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.9532 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.9144 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.3843 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.5643 | Val  Acc: 0.5510
 Site-SynthDigits| Val  Loss: 1.4903 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 2.0762 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6740
Aggregated Acc | Val Acc: 0.5443
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:17 | Val Acc: 0.4242
 Best site-USPS       | Epoch:17 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.5510
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.5714
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 18 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.1210 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.8545 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.9807 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 0.9418 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.8642 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.8026 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 1.2000 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.4875 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.4839 | Train Acc: 0.5676
 Site-MNIST-M   | Train Loss: 2.1529 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 0.8355 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8502 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9624 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.9741 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.9220 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.9034 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.3594 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.5250 | Val  Acc: 0.5510
 Site-SynthDigits| Val  Loss: 1.4552 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 2.0672 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6747
Aggregated Acc | Val Acc: 0.5397
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3939
 Best site-USPS       | Epoch:18 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.5510
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.5714
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 19 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.0875 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.8272 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.9202 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.9099 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.8001 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 2.0731 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.1808 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.4775 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 1.4348 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 2.2424 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 0.8107 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8249 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9313 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.9438 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.8933 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 1.8932 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.3393 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.4822 | Val  Acc: 0.5918
 Site-SynthDigits| Val  Loss: 1.4182 | Val  Acc: 0.6122
 Site-MNIST-M   | Val  Loss: 2.0595 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6907
Aggregated Acc | Val Acc: 0.5510
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:19 | Val Acc: 0.3939
 Best site-USPS       | Epoch:19 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.5918
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.6122
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.7536
 Test site-SVHN      | Epoch:19 | Test Acc: 0.2821
 Test site-USPS      | Epoch:19 | Test Acc: 0.7258
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.4866
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.2807
Average Test Accuracy: 0.5058
============ Train epoch 20 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 1.0834 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.7968 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.9317 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.8733 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.8272 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8953 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.1411 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.4173 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 1.4037 | Train Acc: 0.6216
 Site-MNIST-M   | Train Loss: 2.3799 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 0.7724 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7909 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9022 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.9127 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.8669 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.8731 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.3106 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.4384 | Val  Acc: 0.6327
 Site-SynthDigits| Val  Loss: 1.3776 | Val  Acc: 0.6224
 Site-MNIST-M   | Val  Loss: 2.0472 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7001
Aggregated Acc | Val Acc: 0.5627
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:20 | Val Acc: 0.4242
 Best site-USPS       | Epoch:20 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.6327
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.6224
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 21 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.0518 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7766 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.8831 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.8546 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.7863 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 2.0604 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.1429 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.3921 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.3679 | Train Acc: 0.6284
 Site-MNIST-M   | Train Loss: 2.2464 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 0.7561 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7696 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8793 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8926 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.8441 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 1.8519 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 1.2895 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3895 | Val  Acc: 0.6531
 Site-SynthDigits| Val  Loss: 1.3459 | Val  Acc: 0.6633
 Site-MNIST-M   | Val  Loss: 2.0355 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7066
Aggregated Acc | Val Acc: 0.5683
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:21 | Val Acc: 0.4545
 Best site-USPS       | Epoch:21 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.6531
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.6633
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 22 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 1.0305 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7545 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.8808 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.8344 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.7401 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8035 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 1.1106 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.3668 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.3323 | Train Acc: 0.6622
 Site-MNIST-M   | Train Loss: 2.1246 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.7424 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7509 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8573 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8740 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.8219 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 1.8198 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.2575 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3534 | Val  Acc: 0.6735
 Site-SynthDigits| Val  Loss: 1.3148 | Val  Acc: 0.6837
 Site-MNIST-M   | Val  Loss: 2.0226 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7093
Aggregated Acc | Val Acc: 0.5669
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:22 | Val Acc: 0.4242
 Best site-USPS       | Epoch:22 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.6735
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.6837
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 23 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-3
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.0621 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7271 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.8207 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.8101 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.7170 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9021 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.0811 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.3105 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.3095 | Train Acc: 0.6486
 Site-MNIST-M   | Train Loss: 2.1215 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.7269 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7303 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8310 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8506 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.7981 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.7915 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.2264 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3113 | Val  Acc: 0.6735
 Site-SynthDigits| Val  Loss: 1.2819 | Val  Acc: 0.7041
 Site-MNIST-M   | Val  Loss: 2.0112 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7110
Aggregated Acc | Val Acc: 0.5688
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:23 | Val Acc: 0.4242
 Best site-USPS       | Epoch:23 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.6735
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7041
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 24 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 1.0987 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.7066 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.8251 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7919 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.7143 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9107 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.0521 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.3199 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.3177 | Train Acc: 0.6892
 Site-MNIST-M   | Train Loss: 2.0309 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.7083 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7117 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8055 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8287 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.7776 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.7913 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.2054 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.2891 | Val  Acc: 0.6735
 Site-SynthDigits| Val  Loss: 1.2590 | Val  Acc: 0.7041
 Site-MNIST-M   | Val  Loss: 2.0090 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7092
Aggregated Acc | Val Acc: 0.5633
============ Train epoch 25 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 1.0432 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.6824 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.8080 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.7645 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6930 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.7336 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 1.0320 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.2844 | Train Acc: 0.6351
 Site-SynthDigits| Train Loss: 1.2713 | Train Acc: 0.6824
 Site-MNIST-M   | Train Loss: 2.0169 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.6849 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6908 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7848 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8075 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7595 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.7894 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.1915 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.2574 | Val  Acc: 0.6735
 Site-SynthDigits| Val  Loss: 1.2311 | Val  Acc: 0.7041
 Site-MNIST-M   | Val  Loss: 2.0057 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7108
Aggregated Acc | Val Acc: 0.5639
============ Train epoch 26 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
cnt=[1, 5, 1, 2, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.8687 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.6629 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7942 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.7455 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6882 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.8690 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.0074 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.2467 | Train Acc: 0.6622
 Site-SynthDigits| Train Loss: 1.2634 | Train Acc: 0.7027
 Site-MNIST-M   | Train Loss: 2.2083 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.6565 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6659 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7634 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7852 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.7403 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.7627 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 1.1675 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.2354 | Val  Acc: 0.6939
 Site-SynthDigits| Val  Loss: 1.2052 | Val  Acc: 0.7245
 Site-MNIST-M   | Val  Loss: 1.9900 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7338
Aggregated Acc | Val Acc: 0.5998
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:26 | Val Acc: 0.4545
 Best site-USPS       | Epoch:26 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.6939
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.7245
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 27 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.9598 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.6493 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7661 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.7308 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.6772 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.7319 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 0.9945 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.2505 | Train Acc: 0.6351
 Site-SynthDigits| Train Loss: 1.1671 | Train Acc: 0.7162
 Site-MNIST-M   | Train Loss: 2.0754 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.6631 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6624 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7490 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7732 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.7228 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.7524 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.1531 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.2032 | Val  Acc: 0.7347
 Site-SynthDigits| Val  Loss: 1.1794 | Val  Acc: 0.7449
 Site-MNIST-M   | Val  Loss: 1.9898 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7403
Aggregated Acc | Val Acc: 0.6068
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:27 | Val Acc: 0.4242
 Best site-USPS       | Epoch:27 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.7347
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.7449
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 28 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.9786 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.6255 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7168 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.7156 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.6466 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.8594 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.9615 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.2304 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 1.2019 | Train Acc: 0.7297
 Site-MNIST-M   | Train Loss: 2.0424 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.6387 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6400 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7291 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.7522 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.7066 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.7304 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.1351 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.1870 | Val  Acc: 0.7347
 Site-SynthDigits| Val  Loss: 1.1586 | Val  Acc: 0.7347
 Site-MNIST-M   | Val  Loss: 1.9753 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7414
Aggregated Acc | Val Acc: 0.6066
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:28 | Val Acc: 0.4242
 Best site-USPS       | Epoch:28 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7347
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7347
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 29 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-1
cnt=[2, 1, 5, 1, 1, ]
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 0.8584 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.6124 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7447 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6978 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.6521 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.6050 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 0.9396 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.1973 | Train Acc: 0.6622
 Site-SynthDigits| Train Loss: 1.1104 | Train Acc: 0.7230
 Site-MNIST-M   | Train Loss: 2.0408 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.6296 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6315 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7159 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.7355 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.6919 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.7257 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.1316 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.1575 | Val  Acc: 0.7347
 Site-SynthDigits| Val  Loss: 1.1316 | Val  Acc: 0.7449
 Site-MNIST-M   | Val  Loss: 1.9719 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7424
Aggregated Acc | Val Acc: 0.6076
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:29 | Val Acc: 0.4242
 Best site-USPS       | Epoch:29 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.7347
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.7449
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.7950
 Test site-SVHN      | Epoch:29 | Test Acc: 0.3159
 Test site-USPS      | Epoch:29 | Test Acc: 0.7527
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.5694
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.3179
Average Test Accuracy: 0.5502
============ Train epoch 30 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-0
cnt=[1, 5, 1, 2, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.9281 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.5925 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6909 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6795 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6232 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.6937 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 0.9470 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.1777 | Train Acc: 0.6622
 Site-SynthDigits| Train Loss: 1.1086 | Train Acc: 0.7432
 Site-MNIST-M   | Train Loss: 1.9979 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 0.5996 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6083 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7016 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.7145 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.6752 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.7098 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.1078 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1549 | Val  Acc: 0.7143
 Site-SynthDigits| Val  Loss: 1.1129 | Val  Acc: 0.7653
 Site-MNIST-M   | Val  Loss: 1.9565 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7472
Aggregated Acc | Val Acc: 0.6150
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:30 | Val Acc: 0.4242
 Best site-USPS       | Epoch:30 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.7143
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.7653
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 31 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.8414 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5700 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6986 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6624 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.5949 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.6262 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 0.9655 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.1447 | Train Acc: 0.6892
 Site-SynthDigits| Train Loss: 1.1360 | Train Acc: 0.7297
 Site-MNIST-M   | Train Loss: 2.2044 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.5714 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5856 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6830 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6958 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.6661 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.7060 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 1.1102 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.1431 | Val  Acc: 0.7551
 Site-SynthDigits| Val  Loss: 1.0864 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.9365 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7517
Aggregated Acc | Val Acc: 0.6210
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:31 | Val Acc: 0.4545
 Best site-USPS       | Epoch:31 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.7551
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.7755
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 32 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.8812 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5656 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7168 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6513 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.5764 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.8886 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.9311 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.1177 | Train Acc: 0.6892
 Site-SynthDigits| Train Loss: 1.1156 | Train Acc: 0.7365
 Site-MNIST-M   | Train Loss: 2.1572 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.5753 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5864 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6731 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6865 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6512 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.7182 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.0953 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.1206 | Val  Acc: 0.7347
 Site-SynthDigits| Val  Loss: 1.0637 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 1.9513 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7494
Aggregated Acc | Val Acc: 0.6128
============ Train epoch 33 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
cnt=[5, 1, 2, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.8288 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5552 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6497 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6423 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5742 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.6271 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.9066 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0939 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 1.0742 | Train Acc: 0.7770
 Site-MNIST-M   | Train Loss: 1.9618 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.5681 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5776 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6617 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6772 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6410 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.7054 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.0807 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0839 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.0381 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 1.9441 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7569
Aggregated Acc | Val Acc: 0.6238
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:33 | Val Acc: 0.4242
 Best site-USPS       | Epoch:33 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.7857
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 34 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[4, 3, 1, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.8475 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5443 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6801 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6274 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5782 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.6727 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.9020 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0859 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 1.0126 | Train Acc: 0.7703
 Site-MNIST-M   | Train Loss: 2.1189 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.5551 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5646 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6492 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6692 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6342 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.6992 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.0744 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0652 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.0178 | Val  Acc: 0.7959
 Site-MNIST-M   | Val  Loss: 1.9358 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7549
Aggregated Acc | Val Acc: 0.6952
============ Train epoch 35 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[1, 2, 5, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.7937 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5290 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6560 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6191 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5701 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.6244 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.9212 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.0438 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 1.0217 | Train Acc: 0.7635
 Site-MNIST-M   | Train Loss: 2.2694 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.5420 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5513 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6352 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.6555 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.6203 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.6857 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.0603 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0411 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 0.9976 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.9309 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7703
Aggregated Acc | Val Acc: 0.6395
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:35 | Val Acc: 0.4242
 Best site-USPS       | Epoch:35 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.7959
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.8163
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 36 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.8184 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5101 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6764 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6036 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5529 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.5710 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.9176 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0350 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 1.0249 | Train Acc: 0.7905
 Site-MNIST-M   | Train Loss: 1.8741 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.5217 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5361 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6213 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.6415 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.6088 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.6821 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.0473 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.0367 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 0.9830 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.9303 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7653
Aggregated Acc | Val Acc: 0.6296
============ Train epoch 37 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.7604 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5027 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6669 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5941 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5505 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.5383 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.8607 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0363 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 0.9883 | Train Acc: 0.7905
 Site-MNIST-M   | Train Loss: 1.7076 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.5130 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5276 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6126 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.6304 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5940 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.6607 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.0444 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.0191 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 0.9659 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.9302 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7622
Aggregated Acc | Val Acc: 0.6259
============ Train epoch 38 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 0.8405 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4801 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6343 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5728 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.5156 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.6383 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.9010 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.0373 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 0.9617 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 1.7062 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.4869 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5061 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.5897 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.6095 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5825 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.6566 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.0502 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 0.9906 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.9394 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.9255 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7729
Aggregated Acc | Val Acc: 0.6387
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:38 | Val Acc: 0.4242
 Best site-USPS       | Epoch:38 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8367
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 39 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-1
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[1, 1, 2, 1, 5, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.6663 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4627 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6021 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5562 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4976 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.4306 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.8818 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9822 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.9938 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 1.6999 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.4658 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4869 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5756 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5952 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5694 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.6405 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.0460 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 0.9720 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.9212 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.9169 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7811
Aggregated Acc | Val Acc: 0.6371
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:39 | Val Acc: 0.3939
 Best site-USPS       | Epoch:39 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8367
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8136
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3401
 Test site-USPS      | Epoch:39 | Test Acc: 0.7258
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.6192
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.3250
Average Test Accuracy: 0.5647
============ Train epoch 40 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.7649 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4560 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6387 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5442 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4904 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.4115 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.8532 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9829 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.9271 | Train Acc: 0.7905
 Site-MNIST-M   | Train Loss: 1.8719 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.4453 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4702 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5616 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.5775 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5565 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.6406 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.0434 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.9490 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.9026 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.9065 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8020
Aggregated Acc | Val Acc: 0.6704
 Best site-MNIST      | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:40 | Val Acc: 0.4242
 Best site-USPS       | Epoch:40 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8163
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.4091
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8171
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3416
 Test site-USPS      | Epoch:40 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6265
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3236
Average Test Accuracy: 0.5680
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 41 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
cnt=[5, 1, 1, 2, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.6986 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4355 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5978 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5227 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4649 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.4371 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.8141 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9391 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.8883 | Train Acc: 0.8176
 Site-MNIST-M   | Train Loss: 1.9673 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.4215 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4526 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5462 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5571 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5405 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.6284 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.0158 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 0.9499 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.8907 | Val  Acc: 0.8061
 Site-MNIST-M   | Val  Loss: 1.8846 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7903
Aggregated Acc | Val Acc: 0.6535
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8193
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3476
 Test site-USPS      | Epoch:40 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6396
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3286
Average Test Accuracy: 0.5733
============ Train epoch 42 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.6969 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4251 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5830 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5110 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4616 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.4373 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.7965 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9264 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.9005 | Train Acc: 0.8176
 Site-MNIST-M   | Train Loss: 1.7392 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.4137 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4453 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5356 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.5450 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5296 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.6070 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.9909 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.9440 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.8747 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.8729 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7939
Aggregated Acc | Val Acc: 0.6562
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8236
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3476
 Test site-USPS      | Epoch:40 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6404
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3286
Average Test Accuracy: 0.5743
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.6914 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4186 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5834 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5016 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.4490 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.4333 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.7515 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8981 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.8636 | Train Acc: 0.8176
 Site-MNIST-M   | Train Loss: 2.2534 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.3991 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4327 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5257 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.5335 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5201 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.6024 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.9813 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.9224 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.8531 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.8597 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7939
Aggregated Acc | Val Acc: 0.6562
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8214
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3496
 Test site-USPS      | Epoch:40 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6440
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3329
Average Test Accuracy: 0.5758
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.7620 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4112 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5264 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4924 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4422 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.3459 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.7615 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8872 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.8632 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 1.5990 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.3840 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4227 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5201 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5210 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5102 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5922 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.9667 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 0.9375 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.8479 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.8349 | Val  Acc: 0.4545
Average Valid Accuracy: 0.7938
Aggregated Acc | Val Acc: 0.6628
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8193
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3617
 Test site-USPS      | Epoch:40 | Test Acc: 0.7258
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6482
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3450
Average Test Accuracy: 0.5800
============ Train epoch 45 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
cnt=[1, 5, 1, 2, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.7823 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3978 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5873 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4854 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4240 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.4162 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.7629 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8857 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.9062 | Train Acc: 0.8311
 Site-MNIST-M   | Train Loss: 1.9526 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.3744 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4109 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5093 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5132 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.4997 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5817 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.9547 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.9041 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.8173 | Val  Acc: 0.8265
 Site-MNIST-M   | Val  Loss: 1.8224 | Val  Acc: 0.4545
Average Valid Accuracy: 0.7966
Aggregated Acc | Val Acc: 0.6701
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8236
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3597
 Test site-USPS      | Epoch:40 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6499
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3500
Average Test Accuracy: 0.5829
============ Train epoch 46 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.6693 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4081 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5488 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4851 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4117 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.3893 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.7353 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8626 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.7827 | Train Acc: 0.8243
 Site-MNIST-M   | Train Loss: 2.0313 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.3877 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4180 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5065 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5144 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.4945 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5652 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.9604 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.9092 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.8118 | Val  Acc: 0.8265
 Site-MNIST-M   | Val  Loss: 1.8124 | Val  Acc: 0.4545
Average Valid Accuracy: 0.7987
Aggregated Acc | Val Acc: 0.6721
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8250
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3602
 Test site-USPS      | Epoch:40 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6514
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3486
Average Test Accuracy: 0.5833
============ Train epoch 47 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.6480 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3935 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5412 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4709 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.4256 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.5826 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.7451 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8312 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.7951 | Train Acc: 0.8176
 Site-MNIST-M   | Train Loss: 1.4086 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.3764 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4062 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.4917 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5007 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.4861 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5549 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.9459 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 0.8922 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7979 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.7833 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7945
Aggregated Acc | Val Acc: 0.6680
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8264
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3602
 Test site-USPS      | Epoch:40 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6548
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3543
Average Test Accuracy: 0.5854
============ Train epoch 48 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.7761 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3776 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5634 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4540 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3996 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.5455 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7386 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8260 | Train Acc: 0.7973
 Site-SynthDigits| Train Loss: 0.7954 | Train Acc: 0.8311
 Site-MNIST-M   | Train Loss: 1.6328 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.3551 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3906 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4774 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.4845 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.4758 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5449 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.9415 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 0.8928 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7860 | Val  Acc: 0.8469
 Site-MNIST-M   | Val  Loss: 1.7742 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8018
Aggregated Acc | Val Acc: 0.6763
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8293
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3683
 Test site-USPS      | Epoch:40 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6596
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3571
Average Test Accuracy: 0.5891
============ Train epoch 49 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[1, 5, 2, 1, 1, ]
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.6704 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3665 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5991 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4454 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.4128 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.4943 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.7674 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8353 | Train Acc: 0.7973
 Site-SynthDigits| Train Loss: 0.7539 | Train Acc: 0.8311
 Site-MNIST-M   | Train Loss: 1.4414 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.3443 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3833 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4704 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.4764 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.4701 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5269 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.9601 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 0.8841 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7725 | Val  Acc: 0.8571
 Site-MNIST-M   | Val  Loss: 1.7663 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8028
Aggregated Acc | Val Acc: 0.6774
 Best site-MNIST      | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:49 | Val Acc: 0.3939
 Best site-USPS       | Epoch:49 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.8571
 Best site-MNIST-M    | Epoch:49 | Val Acc: 0.5000
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8307
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3688
 Test site-USPS      | Epoch:49 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.6639
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.3621
Average Test Accuracy: 0.5913
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8307
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3688
 Test site-USPS      | Epoch:49 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.6639
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.3621
Average Test Accuracy: 0.5913
===2023-04-19 19:05:52===
===2023-04-19 19:05:53===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8329
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3678
 Test site-USPS      | Epoch:49 | Test Acc: 0.7366
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.6673
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.3593
Average Test Accuracy: 0.5928
===2023-04-19 23:02:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
powerI: 0.9, powerC: 0.09999999999999998sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 2.2193 | Train Acc: 0.1739
 Site-MNIST     | Train Loss: 2.2639 | Train Acc: 0.0426
 Site-MNIST     | Train Loss: 2.2600 | Train Acc: 0.1268
 Site-MNIST     | Train Loss: 2.2184 | Train Acc: 0.1702
 Site-MNIST     | Train Loss: 2.2484 | Train Acc: 0.1356
 Site-SVHN      | Train Loss: 2.4001 | Train Acc: 0.1000
 Site-USPS      | Train Loss: 2.3624 | Train Acc: 0.0682
 Site-SynthDigits| Train Loss: 2.3136 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.2631 | Train Acc: 0.1689
 Site-MNIST-M   | Train Loss: 2.4066 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.2742 | Val  Acc: 0.1333
 Site-MNIST     | Val  Loss: 2.2262 | Val  Acc: 0.2581
 Site-MNIST     | Val  Loss: 2.2257 | Val  Acc: 0.1702
 Site-MNIST     | Val  Loss: 2.2178 | Val  Acc: 0.2222
 Site-MNIST     | Val  Loss: 2.2541 | Val  Acc: 0.1392
 Site-SVHN      | Val  Loss: 2.3248 | Val  Acc: 0.1212
 Site-USPS      | Val  Loss: 2.3540 | Val  Acc: 0.1034
 Site-SynthDigits| Val  Loss: 2.3301 | Val  Acc: 0.1020
 Site-SynthDigits| Val  Loss: 2.2743 | Val  Acc: 0.1429
 Site-MNIST-M   | Val  Loss: 2.3841 | Val  Acc: 0.1818
Average Valid Accuracy: 0.1574
Aggregated Acc | Val Acc: 0.1427
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1333
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2581
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1702
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2222
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1392
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1212
 Best site-USPS       | Epoch:0 | Val Acc: 0.1034
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1020
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1429
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 1 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.8200000000000001, powerC: 0.17999999999999994sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 2.0975 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.1027 | Train Acc: 0.2128
 Site-MNIST     | Train Loss: 2.1059 | Train Acc: 0.2958
 Site-MNIST     | Train Loss: 2.0778 | Train Acc: 0.3085
 Site-MNIST     | Train Loss: 2.0677 | Train Acc: 0.3136
 Site-SVHN      | Train Loss: 2.2487 | Train Acc: 0.1200
 Site-USPS      | Train Loss: 2.2465 | Train Acc: 0.1818
 Site-SynthDigits| Train Loss: 2.2508 | Train Acc: 0.1486
 Site-SynthDigits| Train Loss: 2.2108 | Train Acc: 0.2297
 Site-MNIST-M   | Train Loss: 2.4637 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.1007 | Val  Acc: 0.2000
 Site-MNIST     | Val  Loss: 2.0683 | Val  Acc: 0.2903
 Site-MNIST     | Val  Loss: 2.0954 | Val  Acc: 0.3191
 Site-MNIST     | Val  Loss: 2.0853 | Val  Acc: 0.3492
 Site-MNIST     | Val  Loss: 2.1086 | Val  Acc: 0.2785
 Site-SVHN      | Val  Loss: 2.3065 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 2.2626 | Val  Acc: 0.1724
 Site-SynthDigits| Val  Loss: 2.2599 | Val  Acc: 0.1429
 Site-SynthDigits| Val  Loss: 2.2290 | Val  Acc: 0.2041
 Site-MNIST-M   | Val  Loss: 2.3431 | Val  Acc: 0.1364
Average Valid Accuracy: 0.2244
Aggregated Acc | Val Acc: 0.1842
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2903
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3191
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3492
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2785
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1515
 Best site-USPS       | Epoch:1 | Val Acc: 0.1724
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1429
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2041
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 2 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
powerI: 0.756, powerC: 0.244sum of wi : 1.0
 Site-MNIST     | Train Loss: 2.0837 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9701 | Train Acc: 0.3617
 Site-MNIST     | Train Loss: 1.9784 | Train Acc: 0.3944
 Site-MNIST     | Train Loss: 1.9505 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.9331 | Train Acc: 0.4576
 Site-SVHN      | Train Loss: 2.3447 | Train Acc: 0.2000
 Site-USPS      | Train Loss: 2.1563 | Train Acc: 0.2955
 Site-SynthDigits| Train Loss: 2.2001 | Train Acc: 0.2297
===2023-04-19 23:05:02===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 2 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
powerI: 0.7560, powerC: 0.2440
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.9984 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9694 | Train Acc: 0.3617
 Site-MNIST     | Train Loss: 1.9804 | Train Acc: 0.3803
 Site-MNIST     | Train Loss: 1.9416 | Train Acc: 0.4574
 Site-MNIST     | Train Loss: 1.9252 | Train Acc: 0.4322
 Site-SVHN      | Train Loss: 2.3006 | Train Acc: 0.1800
 Site-USPS      | Train Loss: 2.1299 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.1857 | Train Acc: 0.2297
 Site-SynthDigits| Train Loss: 2.1492 | Train Acc: 0.3041
 Site-MNIST-M   | Train Loss: 2.3635 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.9408 | Val  Acc: 0.4000
 Site-MNIST     | Val  Loss: 1.9268 | Val  Acc: 0.4516
 Site-MNIST     | Val  Loss: 1.9662 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 1.9547 | Val  Acc: 0.4603
 Site-MNIST     | Val  Loss: 1.9607 | Val  Acc: 0.4051
 Site-SVHN      | Val  Loss: 2.2219 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.1578 | Val  Acc: 0.3793
 Site-SynthDigits| Val  Loss: 2.1899 | Val  Acc: 0.2449
 Site-SynthDigits| Val  Loss: 2.1381 | Val  Acc: 0.2755
 Site-MNIST-M   | Val  Loss: 2.3102 | Val  Acc: 0.1364
Average Valid Accuracy: 0.3451
Aggregated Acc | Val Acc: 0.2954
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4000
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4516
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4603
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2727
 Best site-USPS       | Epoch:2 | Val Acc: 0.3793
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2449
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2755
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 3 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
cnt=[5, 1, 2, 1, 1, ]
powerI: 0.7048, powerC: 0.2952
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.8924 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.8327 | Train Acc: 0.5319
 Site-MNIST     | Train Loss: 1.8509 | Train Acc: 0.5634
 Site-MNIST     | Train Loss: 1.8186 | Train Acc: 0.5745
 Site-MNIST     | Train Loss: 1.7892 | Train Acc: 0.6186
 Site-SVHN      | Train Loss: 2.1798 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 2.0266 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 2.1298 | Train Acc: 0.2297
 Site-SynthDigits| Train Loss: 2.0842 | Train Acc: 0.3311
 Site-MNIST-M   | Train Loss: 2.4416 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.8048 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.7978 | Val  Acc: 0.6452
 Site-MNIST     | Val  Loss: 1.8507 | Val  Acc: 0.5957
 Site-MNIST     | Val  Loss: 1.8367 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.8286 | Val  Acc: 0.5696
 Site-SVHN      | Val  Loss: 2.2064 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.0847 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.1389 | Val  Acc: 0.2857
 Site-SynthDigits| Val  Loss: 2.0819 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.2860 | Val  Acc: 0.1364
Average Valid Accuracy: 0.4415
Aggregated Acc | Val Acc: 0.3493
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6452
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5957
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5696
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2727
 Best site-USPS       | Epoch:3 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2857
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3061
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 4 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
powerI: 0.6638, powerC: 0.3362
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.8953 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.7114 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.7188 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.7138 | Train Acc: 0.6170
 Site-MNIST     | Train Loss: 1.6646 | Train Acc: 0.6864
 Site-SVHN      | Train Loss: 2.3059 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 1.9287 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 2.0746 | Train Acc: 0.2568
 Site-SynthDigits| Train Loss: 2.0471 | Train Acc: 0.3446
 Site-MNIST-M   | Train Loss: 2.3135 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.6812 | Val  Acc: 0.7333
 Site-MNIST     | Val  Loss: 1.6767 | Val  Acc: 0.7742
 Site-MNIST     | Val  Loss: 1.7475 | Val  Acc: 0.6170
 Site-MNIST     | Val  Loss: 1.7340 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7149 | Val  Acc: 0.6203
 Site-SVHN      | Val  Loss: 2.1733 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 2.0056 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.0858 | Val  Acc: 0.3469
 Site-SynthDigits| Val  Loss: 2.0270 | Val  Acc: 0.3469
 Site-MNIST-M   | Val  Loss: 2.2585 | Val  Acc: 0.0909
Average Valid Accuracy: 0.4947
Aggregated Acc | Val Acc: 0.3895
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7333
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7742
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6170
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6203
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3636
 Best site-USPS       | Epoch:4 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3469
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3469
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 5 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.6311, powerC: 0.3689
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.7596 | Train Acc: 0.5217
 Site-MNIST     | Train Loss: 1.5980 | Train Acc: 0.6809
 Site-MNIST     | Train Loss: 1.6249 | Train Acc: 0.6479
 Site-MNIST     | Train Loss: 1.6134 | Train Acc: 0.6809
 Site-MNIST     | Train Loss: 1.5524 | Train Acc: 0.7119
 Site-SVHN      | Train Loss: 2.1706 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 1.8280 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 2.0014 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 1.9827 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.5155 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.5662 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.5681 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.6477 | Val  Acc: 0.6809
 Site-MNIST     | Val  Loss: 1.6321 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.6090 | Val  Acc: 0.6709
 Site-SVHN      | Val  Loss: 2.1384 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.9276 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.0509 | Val  Acc: 0.3469
 Site-SynthDigits| Val  Loss: 1.9760 | Val  Acc: 0.3469
 Site-MNIST-M   | Val  Loss: 2.2314 | Val  Acc: 0.0909
Average Valid Accuracy: 0.5182
Aggregated Acc | Val Acc: 0.3947
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6809
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6709
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3030
 Best site-USPS       | Epoch:5 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3469
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3469
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 6 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.6049, powerC: 0.3951
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.6763 | Train Acc: 0.5217
 Site-MNIST     | Train Loss: 1.4945 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.5211 | Train Acc: 0.7042
 Site-MNIST     | Train Loss: 1.5200 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.4626 | Train Acc: 0.7542
 Site-SVHN      | Train Loss: 2.0840 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 1.7533 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.9627 | Train Acc: 0.3243
 Site-SynthDigits| Train Loss: 1.8985 | Train Acc: 0.3784
 Site-MNIST-M   | Train Loss: 2.3390 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.4670 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.4711 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.5526 | Val  Acc: 0.7021
 Site-MNIST     | Val  Loss: 1.5416 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.5126 | Val  Acc: 0.6962
 Site-SVHN      | Val  Loss: 2.1127 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.8567 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.0178 | Val  Acc: 0.3673
 Site-SynthDigits| Val  Loss: 1.9243 | Val  Acc: 0.3980
 Site-MNIST-M   | Val  Loss: 2.2131 | Val  Acc: 0.1364
Average Valid Accuracy: 0.5363
Aggregated Acc | Val Acc: 0.4087
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:6 | Val Acc: 0.7021
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6962
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2727
 Best site-USPS       | Epoch:6 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3673
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3980
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 7 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[1, 2, 5, 1, 1, ]
powerI: 0.5839, powerC: 0.4161
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 1.6091 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.3981 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.4443 | Train Acc: 0.6761
 Site-MNIST     | Train Loss: 1.4349 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.3543 | Train Acc: 0.7881
 Site-SVHN      | Train Loss: 2.0796 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 1.6532 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.9080 | Train Acc: 0.3649
 Site-SynthDigits| Train Loss: 1.8311 | Train Acc: 0.4122
 Site-MNIST-M   | Train Loss: 2.4368 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.3667 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.3771 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.4671 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.4560 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.4169 | Val  Acc: 0.6962
 Site-SVHN      | Val  Loss: 2.0740 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.7801 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 1.9798 | Val  Acc: 0.3878
 Site-SynthDigits| Val  Loss: 1.8776 | Val  Acc: 0.4286
 Site-MNIST-M   | Val  Loss: 2.1854 | Val  Acc: 0.1364
Average Valid Accuracy: 0.5679
Aggregated Acc | Val Acc: 0.4389
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6962
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3636
 Best site-USPS       | Epoch:7 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3878
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4286
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 8 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5671, powerC: 0.4329
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 1.5901 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.3114 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.3626 | Train Acc: 0.7183
 Site-MNIST     | Train Loss: 1.3586 | Train Acc: 0.7340
 Site-MNIST     | Train Loss: 1.2549 | Train Acc: 0.7881
 Site-SVHN      | Train Loss: 2.0890 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 1.5905 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.8485 | Train Acc: 0.4054
 Site-SynthDigits| Train Loss: 1.8251 | Train Acc: 0.4257
 Site-MNIST-M   | Train Loss: 2.2722 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.2776 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.2953 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.3898 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.3760 | Val  Acc: 0.6984
 Site-MNIST     | Val  Loss: 1.3293 | Val  Acc: 0.7089
 Site-SVHN      | Val  Loss: 2.0542 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.7169 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 1.9326 | Val  Acc: 0.4082
 Site-SynthDigits| Val  Loss: 1.8271 | Val  Acc: 0.4592
 Site-MNIST-M   | Val  Loss: 2.1616 | Val  Acc: 0.1364
Average Valid Accuracy: 0.5839
Aggregated Acc | Val Acc: 0.4587
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6984
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7089
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3939
 Best site-USPS       | Epoch:8 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4082
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4592
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 9 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
powerI: 0.5537, powerC: 0.4463
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 1.4082 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.2337 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.3054 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.2894 | Train Acc: 0.7553
 Site-MNIST     | Train Loss: 1.2190 | Train Acc: 0.8305
 Site-SVHN      | Train Loss: 1.9572 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 1.5159 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.8020 | Train Acc: 0.4730
 Site-SynthDigits| Train Loss: 1.7599 | Train Acc: 0.4865
 Site-MNIST-M   | Train Loss: 2.2199 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.2054 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.2264 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.3209 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.3105 | Val  Acc: 0.6984
 Site-MNIST     | Val  Loss: 1.2569 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.0300 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.6513 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.8577 | Val  Acc: 0.5102
 Site-SynthDigits| Val  Loss: 1.7719 | Val  Acc: 0.4898
 Site-MNIST-M   | Val  Loss: 2.1396 | Val  Acc: 0.1364
Average Valid Accuracy: 0.6173
Aggregated Acc | Val Acc: 0.4911
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6984
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3939
 Best site-USPS       | Epoch:9 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5102
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4898
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.6500
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2655
 Test site-USPS      | Epoch:9 | Test Acc: 0.6398
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.3942
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.2400
Average Test Accuracy: 0.4379
============ Train epoch 10 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5429, powerC: 0.4571
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.3776 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.1609 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.2478 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.2244 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.1489 | Train Acc: 0.8305
 Site-SVHN      | Train Loss: 2.0663 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.4504 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.7654 | Train Acc: 0.4595
 Site-SynthDigits| Train Loss: 1.7143 | Train Acc: 0.4932
 Site-MNIST-M   | Train Loss: 2.3811 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 1.1188 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.1496 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.2577 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 1.2500 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.1940 | Val  Acc: 0.7342
 Site-SVHN      | Val  Loss: 2.0194 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.6033 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.8045 | Val  Acc: 0.5102
 Site-SynthDigits| Val  Loss: 1.7188 | Val  Acc: 0.5102
 Site-MNIST-M   | Val  Loss: 2.1196 | Val  Acc: 0.1364
Average Valid Accuracy: 0.6291
Aggregated Acc | Val Acc: 0.4970
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7342
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3939
 Best site-USPS       | Epoch:10 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.5102
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.5102
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 11 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-3
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
cnt=[2, 5, 1, 1, 1, ]
powerI: 0.5344, powerC: 0.4656
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 1.3706 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.1008 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.1715 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.1642 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.0839 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 1.9813 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.3979 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.6856 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 1.6352 | Train Acc: 0.5068
 Site-MNIST-M   | Train Loss: 2.2768 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.0489 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.0852 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.1985 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.1907 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 1.1364 | Val  Acc: 0.7342
 Site-SVHN      | Val  Loss: 1.9991 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.5590 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.7785 | Val  Acc: 0.5102
 Site-SynthDigits| Val  Loss: 1.6797 | Val  Acc: 0.5102
 Site-MNIST-M   | Val  Loss: 2.1085 | Val  Acc: 0.1364
Average Valid Accuracy: 0.6393
Aggregated Acc | Val Acc: 0.5115
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7342
 Best site-SVHN       | Epoch:11 | Val Acc: 0.4242
 Best site-USPS       | Epoch:11 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.5102
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.5102
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 12 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5275, powerC: 0.4725
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 1.3601 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.0447 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.1025 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.1050 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 1.0466 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.1196 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.3738 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.6576 | Train Acc: 0.5270
 Site-SynthDigits| Train Loss: 1.6189 | Train Acc: 0.5135
 Site-MNIST-M   | Train Loss: 2.1015 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 0.9911 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.0294 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.1417 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.1379 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 1.0830 | Val  Acc: 0.7342
 Site-SVHN      | Val  Loss: 1.9846 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.5192 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.7200 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.6353 | Val  Acc: 0.5102
 Site-MNIST-M   | Val  Loss: 2.0942 | Val  Acc: 0.1364
Average Valid Accuracy: 0.6418
Aggregated Acc | Val Acc: 0.5144
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7342
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3939
 Best site-USPS       | Epoch:12 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5102
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 13 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
powerI: 0.5220, powerC: 0.4780
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.3507 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 0.9881 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.0332 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.0604 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 0.9811 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 1.9532 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.3562 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.5942 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 1.5945 | Train Acc: 0.5270
 Site-MNIST-M   | Train Loss: 2.2923 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 0.9382 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.9774 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.0958 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.0919 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 1.0359 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 1.9614 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.4615 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.6755 | Val  Acc: 0.5510
 Site-SynthDigits| Val  Loss: 1.5894 | Val  Acc: 0.5408
 Site-MNIST-M   | Val  Loss: 2.0778 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6540
Aggregated Acc | Val Acc: 0.5296
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7595
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3939
 Best site-USPS       | Epoch:13 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.5510
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.5408
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 14 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
cnt=[1, 5, 1, 2, 1, ]
powerI: 0.5176, powerC: 0.4824
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 1.1994 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.9550 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.0602 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.0253 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.9108 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 2.1327 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.2595 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.5702 | Train Acc: 0.5811
 Site-SynthDigits| Train Loss: 1.5071 | Train Acc: 0.5608
 Site-MNIST-M   | Train Loss: 2.1948 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 0.9070 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.9407 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.0539 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.0562 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 0.9995 | Val  Acc: 0.7722
 Site-SVHN      | Val  Loss: 1.9438 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.4111 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.6192 | Val  Acc: 0.5510
 Site-SynthDigits| Val  Loss: 1.5426 | Val  Acc: 0.5510
 Site-MNIST-M   | Val  Loss: 2.0628 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6578
Aggregated Acc | Val Acc: 0.5317
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7722
 Best site-SVHN       | Epoch:14 | Val Acc: 0.3939
 Best site-USPS       | Epoch:14 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.5510
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.5510
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 15 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
powerI: 0.5141, powerC: 0.4859
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.2462 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.9122 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 0.9754 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 0.9925 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 0.9118 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 1.9132 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 1.2320 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.5404 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 1.4928 | Train Acc: 0.5743
 Site-MNIST-M   | Train Loss: 2.1747 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 0.8775 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.9034 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.0148 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.0228 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 0.9624 | Val  Acc: 0.7722
 Site-SVHN      | Val  Loss: 1.9145 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.3677 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.5586 | Val  Acc: 0.5918
 Site-SynthDigits| Val  Loss: 1.4967 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 2.0454 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6691
Aggregated Acc | Val Acc: 0.5448
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7722
 Best site-SVHN       | Epoch:15 | Val Acc: 0.4242
 Best site-USPS       | Epoch:15 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.5918
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.5714
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 16 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[1, 5, 2, 1, 1, ]
powerI: 0.5113, powerC: 0.4887
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.1376 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.8730 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.9594 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 0.9524 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.8493 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.9871 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 1.2081 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.5017 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 1.4467 | Train Acc: 0.6081
 Site-MNIST-M   | Train Loss: 2.2784 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 0.8320 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8589 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9715 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.9848 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.9302 | Val  Acc: 0.8228
 Site-SVHN      | Val  Loss: 1.9073 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.3424 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.5272 | Val  Acc: 0.6122
 Site-SynthDigits| Val  Loss: 1.4574 | Val  Acc: 0.6122
 Site-MNIST-M   | Val  Loss: 2.0413 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6836
Aggregated Acc | Val Acc: 0.5494
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8228
 Best site-SVHN       | Epoch:16 | Val Acc: 0.3939
 Best site-USPS       | Epoch:16 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.6122
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.6122
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 17 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
powerI: 0.5090, powerC: 0.4910
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.0852 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.8332 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.9260 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 0.9211 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.8416 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 1.9397 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 1.1852 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.4669 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.3871 | Train Acc: 0.6014
 Site-MNIST-M   | Train Loss: 2.2950 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 0.7953 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8237 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9361 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.9497 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.8975 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.9034 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.3199 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.5027 | Val  Acc: 0.6122
 Site-SynthDigits| Val  Loss: 1.4215 | Val  Acc: 0.6327
 Site-MNIST-M   | Val  Loss: 2.0369 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6872
Aggregated Acc | Val Acc: 0.5465
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:17 | Val Acc: 0.3939
 Best site-USPS       | Epoch:17 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.6122
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.6327
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 18 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
powerI: 0.5072, powerC: 0.4928
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.0392 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7933 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.9167 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 0.8890 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.8108 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 1.7789 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.1558 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.4348 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 1.3812 | Train Acc: 0.6149
 Site-MNIST-M   | Train Loss: 2.1560 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 0.7601 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7895 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9052 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.9200 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.8710 | Val  Acc: 0.8481
 Site-SVHN      | Val  Loss: 1.8948 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.2919 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.4703 | Val  Acc: 0.6122
 Site-SynthDigits| Val  Loss: 1.3927 | Val  Acc: 0.6429
 Site-MNIST-M   | Val  Loss: 2.0211 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6960
Aggregated Acc | Val Acc: 0.5610
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8481
 Best site-SVHN       | Epoch:18 | Val Acc: 0.4242
 Best site-USPS       | Epoch:18 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.6122
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.6429
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 19 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
powerI: 0.5058, powerC: 0.4942
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.0178 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7739 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.8606 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 0.8586 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.7987 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 2.1103 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.1357 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.3733 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.3392 | Train Acc: 0.6419
 Site-MNIST-M   | Train Loss: 2.1253 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 0.7358 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7658 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8773 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8914 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.8418 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.8944 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.2778 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.4337 | Val  Acc: 0.6122
 Site-SynthDigits| Val  Loss: 1.3508 | Val  Acc: 0.6735
 Site-MNIST-M   | Val  Loss: 2.0232 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6964
Aggregated Acc | Val Acc: 0.5575
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:19 | Val Acc: 0.4242
 Best site-USPS       | Epoch:19 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.6122
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.6735
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.7564
 Test site-SVHN      | Epoch:19 | Test Acc: 0.2877
 Test site-USPS      | Epoch:19 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.5081
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.2950
Average Test Accuracy: 0.5157
============ Train epoch 20 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5046, powerC: 0.4954
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.9883 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.7459 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.8738 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 0.8367 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.7659 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9310 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 1.0995 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.3684 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 1.3538 | Train Acc: 0.6757
 Site-MNIST-M   | Train Loss: 2.0426 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.7211 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7493 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8552 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8699 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.8217 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 1.8795 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.2589 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3920 | Val  Acc: 0.6531
 Site-SynthDigits| Val  Loss: 1.3161 | Val  Acc: 0.6837
 Site-MNIST-M   | Val  Loss: 2.0128 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7057
Aggregated Acc | Val Acc: 0.5643
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:20 | Val Acc: 0.4242
 Best site-USPS       | Epoch:20 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.6531
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.6837
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 21 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
powerI: 0.5037, powerC: 0.4963
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 1.0335 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.7186 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.8462 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.8148 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.7363 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.7649 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.0780 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.3429 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.2985 | Train Acc: 0.7027
 Site-MNIST-M   | Train Loss: 2.1095 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 0.6933 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7232 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8301 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8437 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7998 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.8715 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.2380 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.3504 | Val  Acc: 0.6531
 Site-SynthDigits| Val  Loss: 1.2772 | Val  Acc: 0.6837
 Site-MNIST-M   | Val  Loss: 1.9975 | Val  Acc: 0.2273
Average Valid Accuracy: 0.7165
Aggregated Acc | Val Acc: 0.5814
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:21 | Val Acc: 0.4242
 Best site-USPS       | Epoch:21 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.6531
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.6837
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 22 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5030, powerC: 0.4970
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.9798 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.6839 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.8334 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7796 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.7352 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8627 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.0580 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.2798 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.2767 | Train Acc: 0.7027
 Site-MNIST-M   | Train Loss: 2.3783 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 0.6593 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6924 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7993 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.8170 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.7809 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 1.8579 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.2272 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.3289 | Val  Acc: 0.6735
 Site-SynthDigits| Val  Loss: 1.2463 | Val  Acc: 0.7143
 Site-MNIST-M   | Val  Loss: 1.9893 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7224
Aggregated Acc | Val Acc: 0.5892
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:22 | Val Acc: 0.3939
 Best site-USPS       | Epoch:22 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.6735
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.7143
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 23 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
powerI: 0.5024, powerC: 0.4976
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.9578 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.6694 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.8010 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7673 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.7011 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 2.0545 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.0559 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.2504 | Train Acc: 0.6622
 Site-SynthDigits| Train Loss: 1.2497 | Train Acc: 0.7095
 Site-MNIST-M   | Train Loss: 2.1133 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 0.6560 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6815 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7820 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.8039 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7607 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.8684 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.2124 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.2949 | Val  Acc: 0.6735
 Site-SynthDigits| Val  Loss: 1.2219 | Val  Acc: 0.7143
 Site-MNIST-M   | Val  Loss: 1.9929 | Val  Acc: 0.2273
Average Valid Accuracy: 0.7177
Aggregated Acc | Val Acc: 0.5752
============ Train epoch 24 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5019, powerC: 0.4981
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.9269 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.6442 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7910 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7431 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.6512 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.7021 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.0261 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.2363 | Train Acc: 0.6757
 Site-SynthDigits| Train Loss: 1.2137 | Train Acc: 0.7432
 Site-MNIST-M   | Train Loss: 2.0942 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.6277 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6553 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7602 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7813 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7417 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.8260 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.1800 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.2780 | Val  Acc: 0.6939
 Site-SynthDigits| Val  Loss: 1.1952 | Val  Acc: 0.7245
 Site-MNIST-M   | Val  Loss: 1.9688 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7296
Aggregated Acc | Val Acc: 0.5939
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:24 | Val Acc: 0.3939
 Best site-USPS       | Epoch:24 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.6939
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.7245
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 25 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
powerI: 0.5015, powerC: 0.4985
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.9656 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.6274 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7424 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.7229 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.6333 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.8366 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.0087 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.1783 | Train Acc: 0.6622
 Site-SynthDigits| Train Loss: 1.1832 | Train Acc: 0.7365
 Site-MNIST-M   | Train Loss: 2.0867 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.6135 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6395 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7419 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7598 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7232 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.8123 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.1572 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.2456 | Val  Acc: 0.7347
 Site-SynthDigits| Val  Loss: 1.1671 | Val  Acc: 0.7245
 Site-MNIST-M   | Val  Loss: 1.9602 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7367
Aggregated Acc | Val Acc: 0.6041
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:25 | Val Acc: 0.4242
 Best site-USPS       | Epoch:25 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.7347
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.7245
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 26 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5012, powerC: 0.4988
sum of wi : 1.0
 Site-MNIST     | Train Loss: 1.0050 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.6106 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7556 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.7082 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6300 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.8474 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 0.9984 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.1898 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 1.1899 | Train Acc: 0.7365
 Site-MNIST-M   | Train Loss: 1.9922 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.6011 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6256 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7215 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7410 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.7058 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.7932 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.1435 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.2404 | Val  Acc: 0.7551
 Site-SynthDigits| Val  Loss: 1.1505 | Val  Acc: 0.7449
 Site-MNIST-M   | Val  Loss: 1.9684 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7428
Aggregated Acc | Val Acc: 0.6096
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:26 | Val Acc: 0.3939
 Best site-USPS       | Epoch:26 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.7551
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.7449
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 27 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5010, powerC: 0.4990
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.9639 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5920 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7427 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6880 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.6108 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.6866 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.9908 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.1428 | Train Acc: 0.7162
 Site-SynthDigits| Train Loss: 1.1485 | Train Acc: 0.7432
 Site-MNIST-M   | Train Loss: 1.9730 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.5794 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6067 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7088 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7244 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.6881 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.7775 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.1414 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.2070 | Val  Acc: 0.7347
 Site-SynthDigits| Val  Loss: 1.1180 | Val  Acc: 0.7347
 Site-MNIST-M   | Val  Loss: 1.9632 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7410
Aggregated Acc | Val Acc: 0.6071
============ Train epoch 28 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
cnt=[1, 5, 1, 2, 1, ]
powerI: 0.5008, powerC: 0.4992
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.7882 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5744 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7276 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6705 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6083 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.8135 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.9490 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.0962 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 1.1315 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 2.1365 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 0.5602 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5880 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6899 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7028 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.6703 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.7404 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.1277 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1966 | Val  Acc: 0.7551
 Site-SynthDigits| Val  Loss: 1.0985 | Val  Acc: 0.7959
 Site-MNIST-M   | Val  Loss: 1.9474 | Val  Acc: 0.2727
Average Valid Accuracy: 0.7431
Aggregated Acc | Val Acc: 0.6031
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:28 | Val Acc: 0.3333
 Best site-USPS       | Epoch:28 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7551
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7959
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 29 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
powerI: 0.5006, powerC: 0.4994
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 0.8772 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5616 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.7016 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6568 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5996 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.6893 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.9406 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.1129 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 1.0448 | Train Acc: 0.7770
 Site-MNIST-M   | Train Loss: 1.9612 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.5583 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5799 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6749 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.6884 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.6527 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.7007 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.1053 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1673 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 1.0738 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.9262 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7497
Aggregated Acc | Val Acc: 0.6143
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:29 | Val Acc: 0.3333
 Best site-USPS       | Epoch:29 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.7959
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.7755
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.7957
 Test site-SVHN      | Epoch:29 | Test Acc: 0.3345
 Test site-USPS      | Epoch:29 | Test Acc: 0.7473
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.6108
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.3386
Average Test Accuracy: 0.5654
============ Train epoch 30 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
powerI: 0.5005, powerC: 0.4995
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.8901 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5436 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6550 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6382 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.5499 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.5694 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.9079 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.0585 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 1.0230 | Train Acc: 0.7905
 Site-MNIST-M   | Train Loss: 1.9452 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.5365 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5599 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.6520 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6649 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6355 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.6754 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.0841 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1387 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.0448 | Val  Acc: 0.7959
 Site-MNIST-M   | Val  Loss: 1.9133 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7678
Aggregated Acc | Val Acc: 0.6288
 Best site-MNIST      | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:30 | Val Acc: 0.3333
 Best site-USPS       | Epoch:30 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.7959
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 31 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-1
cnt=[2, 1, 5, 1, 1, ]
powerI: 0.5004, powerC: 0.4996
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.8394 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5207 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6586 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6146 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.5465 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.6914 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.8874 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.0584 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.9950 | Train Acc: 0.7905
 Site-MNIST-M   | Train Loss: 1.8631 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.5081 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5388 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.6358 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6471 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6188 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.6379 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.0725 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1586 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.0263 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 1.9146 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7653
Aggregated Acc | Val Acc: 0.6247
============ Train epoch 32 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-0
cnt=[1, 5, 1, 2, 1, ]
powerI: 0.5003, powerC: 0.4997
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 0.8391 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5040 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6256 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5988 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.5364 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.6749 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.8794 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.0115 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 0.9592 | Train Acc: 0.7703
 Site-MNIST-M   | Train Loss: 1.8734 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.4848 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5181 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.6175 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6263 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6009 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.6238 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.0528 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1145 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 0.9891 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 1.8885 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7769
Aggregated Acc | Val Acc: 0.6440
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:32 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:32 | Val Acc: 0.3939
 Best site-USPS       | Epoch:32 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8163
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.7857
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 33 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5003, powerC: 0.4997
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.7772 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4855 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6329 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5791 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5110 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.5815 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.8636 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.9775 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 0.9814 | Train Acc: 0.8041
 Site-MNIST-M   | Train Loss: 2.1191 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.4644 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4992 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5974 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.6077 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5862 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.6287 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.0298 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0891 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 0.9610 | Val  Acc: 0.7959
 Site-MNIST-M   | Val  Loss: 1.8821 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7846
Aggregated Acc | Val Acc: 0.6476
 Best site-MNIST      | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:33 | Val Acc: 0.3939
 Best site-USPS       | Epoch:33 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.8163
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.7959
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 34 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 1, 1, 5, 1, ]
powerI: 0.5002, powerC: 0.4998
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.8170 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4792 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6460 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5644 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4857 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.8508 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.8499 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.9660 | Train Acc: 0.7973
 Site-SynthDigits| Train Loss: 0.9606 | Train Acc: 0.8041
 Site-MNIST-M   | Train Loss: 1.9889 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.4476 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4850 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5872 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5930 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5742 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5949 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.0184 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0934 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 0.9460 | Val  Acc: 0.7959
 Site-MNIST-M   | Val  Loss: 1.8621 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7846
Aggregated Acc | Val Acc: 0.6476
============ Train epoch 35 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
cnt=[5, 1, 2, 1, 1, ]
powerI: 0.5002, powerC: 0.4998
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 0.7427 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4588 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5851 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5538 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4913 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.6321 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.8159 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9393 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.9386 | Train Acc: 0.7973
 Site-MNIST-M   | Train Loss: 1.7804 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.4354 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4750 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5769 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5801 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5614 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5650 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.0029 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0814 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.9282 | Val  Acc: 0.7959
 Site-MNIST-M   | Val  Loss: 1.8471 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7912
Aggregated Acc | Val Acc: 0.6588
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:35 | Val Acc: 0.3939
 Best site-USPS       | Epoch:35 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.7959
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 36 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[4, 3, 1, 1, 1, ]
powerI: 0.5001, powerC: 0.4999
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.7897 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4549 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6039 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5388 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4931 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.6413 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7989 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 0.9240 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 0.8773 | Train Acc: 0.8041
 Site-MNIST-M   | Train Loss: 1.8642 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.4366 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4715 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5669 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5722 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5519 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5623 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.9841 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0471 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.9043 | Val  Acc: 0.8265
 Site-MNIST-M   | Val  Loss: 1.8344 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7979
Aggregated Acc | Val Acc: 0.7487
 Best site-MNIST      | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:36 | Val Acc: 0.3939
 Best site-USPS       | Epoch:36 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8265
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 37 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[1, 2, 5, 1, 1, ]
powerI: 0.5001, powerC: 0.4999
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 0.7351 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4412 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5882 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5340 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.4822 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.5590 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.8080 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.8766 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 0.8680 | Train Acc: 0.8176
 Site-MNIST-M   | Train Loss: 2.1911 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.4235 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4577 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5538 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5586 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5377 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5327 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.9704 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0248 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.8843 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.8293 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7932
Aggregated Acc | Val Acc: 0.6608
============ Train epoch 38 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
powerI: 0.5001, powerC: 0.4999
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 0.7413 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4290 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6067 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5123 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4594 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.5450 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.8037 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.8624 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.8788 | Train Acc: 0.8243
 Site-MNIST-M   | Train Loss: 1.7192 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.4117 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4472 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5412 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5436 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5241 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.5138 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.9546 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0250 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.8744 | Val  Acc: 0.8469
 Site-MNIST-M   | Val  Loss: 1.8181 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8033
Aggregated Acc | Val Acc: 0.6734
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:38 | Val Acc: 0.3939
 Best site-USPS       | Epoch:38 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8469
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 39 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
powerI: 0.5001, powerC: 0.4999
sum of wi : 0.9999999999999999
 Site-MNIST     | Train Loss: 0.6727 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4197 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5916 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5080 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4676 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.4459 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7467 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 0.8828 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.8516 | Train Acc: 0.8311
 Site-MNIST-M   | Train Loss: 1.5720 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.4051 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4405 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5330 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5344 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5092 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.4906 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 0.9456 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0095 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.8571 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.8133 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8054
Aggregated Acc | Val Acc: 0.6785
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:39 | Val Acc: 0.4242
 Best site-USPS       | Epoch:39 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8367
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8229
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3804
 Test site-USPS      | Epoch:39 | Test Acc: 0.7366
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.6677
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.3643
Average Test Accuracy: 0.5943
============ Train epoch 40 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5001, powerC: 0.4999
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.7171 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3997 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5607 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4930 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4166 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.3641 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7728 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 0.8482 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.8134 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 2.0175 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.3806 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4212 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5164 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5195 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5026 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.4649 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 0.9382 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0001 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.8353 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.8116 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8072
Aggregated Acc | Val Acc: 0.6847
 Best site-MNIST      | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:40 | Val Acc: 0.4242
 Best site-USPS       | Epoch:40 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8367
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.4091
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8271
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3788
 Test site-USPS      | Epoch:40 | Test Acc: 0.7419
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6768
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3643
Average Test Accuracy: 0.5978
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 41 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-1
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[1, 1, 2, 1, 5, ]
powerI: 0.5000, powerC: 0.5000
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.6833 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3984 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5644 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4800 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4237 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.4248 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7644 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.8412 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.8066 | Train Acc: 0.8514
 Site-MNIST-M   | Train Loss: 1.7142 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.3784 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4140 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5048 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5076 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4888 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.4518 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 0.9208 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9791 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.8208 | Val  Acc: 0.8469
 Site-MNIST-M   | Val  Loss: 1.7937 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8098
Aggregated Acc | Val Acc: 0.6864
 Best site-MNIST      | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:41 | Val Acc: 0.4242
 Best site-USPS       | Epoch:41 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.8469
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.4091
 Test site-MNIST     | Epoch:41 | Test Acc: 0.8286
 Test site-SVHN      | Epoch:41 | Test Acc: 0.3849
 Test site-USPS      | Epoch:41 | Test Acc: 0.7419
 Test site-SynthDigits| Epoch:41 | Test Acc: 0.6817
 Test site-MNIST-M   | Epoch:41 | Test Acc: 0.3700
Average Test Accuracy: 0.6014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 42 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
powerI: 0.5000, powerC: 0.5000
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.6375 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3809 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5250 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4661 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4261 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.4937 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7525 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.7909 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.7652 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 2.0271 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.3595 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3985 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4899 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.4949 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4808 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.4509 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 0.9228 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9803 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.8057 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.8007 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8088
Aggregated Acc | Val Acc: 0.6854
 Test site-MNIST     | Epoch:41 | Test Acc: 0.8286
 Test site-SVHN      | Epoch:41 | Test Acc: 0.3804
 Test site-USPS      | Epoch:41 | Test Acc: 0.7366
 Test site-SynthDigits| Epoch:41 | Test Acc: 0.6877
 Test site-MNIST-M   | Epoch:41 | Test Acc: 0.3679
Average Test Accuracy: 0.6002
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
cnt=[5, 1, 1, 2, 1, ]
powerI: 0.5000, powerC: 0.5000
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.6666 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3739 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5222 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4568 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4146 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.3523 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7396 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.8034 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.7636 | Train Acc: 0.8446
 Site-MNIST-M   | Train Loss: 1.6126 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.3548 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3905 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4790 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.4867 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4730 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.4469 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 0.9178 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.9724 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7936 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.7904 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8107
Aggregated Acc | Val Acc: 0.6892
 Best site-MNIST      | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:43 | Val Acc: 0.4545
 Best site-USPS       | Epoch:43 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:43 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:43 | Val Acc: 0.8367
 Best site-MNIST-M    | Epoch:43 | Val Acc: 0.3636
 Test site-MNIST     | Epoch:43 | Test Acc: 0.8286
 Test site-SVHN      | Epoch:43 | Test Acc: 0.3824
 Test site-USPS      | Epoch:43 | Test Acc: 0.7366
 Test site-SynthDigits| Epoch:43 | Test Acc: 0.6904
 Test site-MNIST-M   | Epoch:43 | Test Acc: 0.3736
Average Test Accuracy: 0.6023
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5000, powerC: 0.5000
sum of wi : 1.0000000000000002
 Site-MNIST     | Train Loss: 0.6616 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3697 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5200 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4484 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.3930 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.5352 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.7155 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.7707 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.7626 | Train Acc: 0.8514
 Site-MNIST-M   | Train Loss: 1.9800 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.3429 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3802 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4707 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.4765 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.4633 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.4177 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 0.9107 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9474 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7755 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.7803 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8134
Aggregated Acc | Val Acc: 0.6921
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:44 | Val Acc: 0.4545
 Best site-USPS       | Epoch:44 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.8367
 Best site-MNIST-M    | Epoch:44 | Val Acc: 0.4091
 Test site-MNIST     | Epoch:44 | Test Acc: 0.8279
 Test site-SVHN      | Epoch:44 | Test Acc: 0.3839
 Test site-USPS      | Epoch:44 | Test Acc: 0.7312
 Test site-SynthDigits| Epoch:44 | Test Acc: 0.6907
 Test site-MNIST-M   | Epoch:44 | Test Acc: 0.3786
Average Test Accuracy: 0.6024
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 45 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
powerI: 0.5000, powerC: 0.5000
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.6458 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3773 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5027 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4440 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.3975 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.3586 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7146 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.7563 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.7359 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 1.4328 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.3430 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3776 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4657 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.4698 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.4539 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.3901 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 0.8879 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9387 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7645 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.7672 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8180
Aggregated Acc | Val Acc: 0.7012
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:45 | Val Acc: 0.4545
 Best site-USPS       | Epoch:45 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.8367
 Best site-MNIST-M    | Epoch:45 | Val Acc: 0.4545
 Test site-MNIST     | Epoch:45 | Test Acc: 0.8293
 Test site-SVHN      | Epoch:45 | Test Acc: 0.3945
 Test site-USPS      | Epoch:45 | Test Acc: 0.7366
 Test site-SynthDigits| Epoch:45 | Test Acc: 0.6903
 Test site-MNIST-M   | Epoch:45 | Test Acc: 0.3764
Average Test Accuracy: 0.6054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 46 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
powerI: 0.5000, powerC: 0.5000
sum of wi : 0.9999999999999998
 Site-MNIST     | Train Loss: 0.6964 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3535 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4982 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4264 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.3858 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.4505 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7263 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.7694 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.7937 | Train Acc: 0.8514
 Site-MNIST-M   | Train Loss: 1.4489 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.3255 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3640 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4522 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.4558 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4464 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.3842 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 0.8846 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9414 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7531 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.7580 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8164
Aggregated Acc | Val Acc: 0.7005
 Test site-MNIST     | Epoch:45 | Test Acc: 0.8336
 Test site-SVHN      | Epoch:45 | Test Acc: 0.3904
 Test site-USPS      | Epoch:45 | Test Acc: 0.7258
 Test site-SynthDigits| Epoch:45 | Test Acc: 0.6973
 Test site-MNIST-M   | Epoch:45 | Test Acc: 0.3771
Average Test Accuracy: 0.6049
============ Train epoch 47 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
cnt=[1, 5, 1, 2, 1, ]
powerI: 0.5000, powerC: 0.5000
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.5984 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3412 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4851 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4210 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.3677 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.2178 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7031 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.7180 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.7483 | Train Acc: 0.8446
 Site-MNIST-M   | Train Loss: 1.7858 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.3258 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3611 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4438 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.4503 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.4398 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.3913 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 0.8901 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9198 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7329 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.7564 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8180
Aggregated Acc | Val Acc: 0.7012
 Test site-MNIST     | Epoch:45 | Test Acc: 0.8293
 Test site-SVHN      | Epoch:45 | Test Acc: 0.3849
 Test site-USPS      | Epoch:45 | Test Acc: 0.7366
 Test site-SynthDigits| Epoch:45 | Test Acc: 0.7076
 Test site-MNIST-M   | Epoch:45 | Test Acc: 0.3800
Average Test Accuracy: 0.6077
============ Train epoch 48 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
powerI: 0.5000, powerC: 0.5000
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.6151 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3352 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5123 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4143 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.3826 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.3683 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.6846 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.7457 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.7362 | Train Acc: 0.8514
 Site-MNIST-M   | Train Loss: 1.5584 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.3194 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3543 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4375 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.4428 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.4331 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.3754 | Val  Acc: 0.4848
 Site-USPS      | Val  Loss: 0.8807 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9064 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.7186 | Val  Acc: 0.8469
 Site-MNIST-M   | Val  Loss: 1.7415 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8286
Aggregated Acc | Val Acc: 0.7194
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:48 | Val Acc: 0.4848
 Best site-USPS       | Epoch:48 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.8469
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.5000
 Test site-MNIST     | Epoch:48 | Test Acc: 0.8307
 Test site-SVHN      | Epoch:48 | Test Acc: 0.3909
 Test site-USPS      | Epoch:48 | Test Acc: 0.7366
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.7109
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.3893
Average Test Accuracy: 0.6117
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/ccop...
============ Train epoch 49 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
powerI: 0.5000, powerC: 0.5000
sum of wi : 1.0
 Site-MNIST     | Train Loss: 0.6328 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3355 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4730 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4048 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.3566 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.5998 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.6914 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.7190 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.6894 | Train Acc: 0.8446
 Site-MNIST-M   | Train Loss: 1.4819 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.3183 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3507 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4293 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.4336 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.4262 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.3350 | Val  Acc: 0.4848
 Site-USPS      | Val  Loss: 0.8614 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8847 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.7119 | Val  Acc: 0.8265
 Site-MNIST-M   | Val  Loss: 1.7442 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8230
Aggregated Acc | Val Acc: 0.7069
 Test site-MNIST     | Epoch:48 | Test Acc: 0.8329
 Test site-SVHN      | Epoch:48 | Test Acc: 0.4045
 Test site-USPS      | Epoch:48 | Test Acc: 0.7473
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.7042
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.3893
Average Test Accuracy: 0.6156
===2023-04-20 00:40:38===
===2023-04-20 00:40:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:48 | Test Acc: 0.8343
 Test site-SVHN      | Epoch:48 | Test Acc: 0.3940
 Test site-USPS      | Epoch:48 | Test Acc: 0.7473
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.7147
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.3864
Average Test Accuracy: 0.6153
