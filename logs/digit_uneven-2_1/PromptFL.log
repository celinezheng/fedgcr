===2023-04-06 15:39:57===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 2.2299 | Train Acc: 0.2614
 Site-MNIST     | Train Loss: 2.2091 | Train Acc: 0.4205
 Site-MNIST     | Train Loss: 2.2357 | Train Acc: 0.1818
 Site-MNIST     | Train Loss: 2.2218 | Train Acc: 0.3182
 Site-MNIST     | Train Loss: 2.2306 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.2784 | Train Acc: 0.1364
 Site-SVHN      | Train Loss: 2.2795 | Train Acc: 0.1136
 Site-USPS      | Train Loss: 2.2308 | Train Acc: 0.3750
 Site-SynthDigits| Train Loss: 2.2917 | Train Acc: 0.1705
 Site-MNIST-M   | Train Loss: 2.2873 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 2.2205 | Val  Acc: 0.3390
 Site-MNIST     | Val  Loss: 2.2251 | Val  Acc: 0.3220
 Site-MNIST     | Val  Loss: 2.2400 | Val  Acc: 0.1017
 Site-MNIST     | Val  Loss: 2.2254 | Val  Acc: 0.3729
 Site-MNIST     | Val  Loss: 2.1952 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 2.2892 | Val  Acc: 0.0678
 Site-SVHN      | Val  Loss: 2.2711 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 2.2468 | Val  Acc: 0.3051
 Site-SynthDigits| Val  Loss: 2.2966 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 2.2953 | Val  Acc: 0.1525
Average Valid Accuracy: 0.2458
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3390
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1017
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3729
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0678
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.3051
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 2.1572 | Train Acc: 0.3636
 Site-MNIST     | Train Loss: 2.1279 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 2.1619 | Train Acc: 0.3864
 Site-MNIST     | Train Loss: 2.1395 | Train Acc: 0.4432
 Site-MNIST     | Train Loss: 2.1733 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 2.2677 | Train Acc: 0.1591
 Site-SVHN      | Train Loss: 2.2677 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 2.1682 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 2.2841 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.2715 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 2.1355 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 2.1406 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 2.1745 | Val  Acc: 0.3390
 Site-MNIST     | Val  Loss: 2.1494 | Val  Acc: 0.4237
 Site-MNIST     | Val  Loss: 2.1139 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 2.2698 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.2622 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 2.1862 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 2.2922 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 2.2835 | Val  Acc: 0.2034
Average Valid Accuracy: 0.3373
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4237
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-USPS       | Epoch:1 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 2.0953 | Train Acc: 0.4091
 Site-MNIST     | Train Loss: 2.0516 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 2.0927 | Train Acc: 0.4432
 Site-MNIST     | Train Loss: 2.0639 | Train Acc: 0.4659
 Site-MNIST     | Train Loss: 2.1149 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 2.2480 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2540 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 2.1097 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 2.2689 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.2592 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 2.0548 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 2.0613 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 2.1096 | Val  Acc: 0.4237
 Site-MNIST     | Val  Loss: 2.0765 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 2.0353 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 2.2529 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.2549 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.1302 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 2.2850 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2720 | Val  Acc: 0.2203
Average Valid Accuracy: 0.3678
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4237
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2542
 Best site-USPS       | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 2.0252 | Train Acc: 0.3977
 Site-MNIST     | Train Loss: 1.9699 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 2.0241 | Train Acc: 0.4545
 Site-MNIST     | Train Loss: 1.9793 | Train Acc: 0.4659
 Site-MNIST     | Train Loss: 2.0447 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 2.2374 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2428 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 2.0313 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2577 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2508 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 1.9767 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.9875 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 2.0478 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 2.0069 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.9575 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 2.2384 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2497 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.0781 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 2.2747 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2616 | Val  Acc: 0.2373
Average Valid Accuracy: 0.3780
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2542
 Best site-USPS       | Epoch:3 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 1.9763 | Train Acc: 0.4205
 Site-MNIST     | Train Loss: 1.9135 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.9603 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.9148 | Train Acc: 0.4886
 Site-MNIST     | Train Loss: 1.9806 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 2.2257 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2376 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.9844 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2389 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2371 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 1.9058 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.9176 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 1.9891 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.9426 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.8863 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 2.2263 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2437 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.0273 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 2.2638 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2521 | Val  Acc: 0.2373
Average Valid Accuracy: 0.3949
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-USPS       | Epoch:4 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 1.8871 | Train Acc: 0.4659
 Site-MNIST     | Train Loss: 1.8100 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.8915 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.8580 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.9158 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 2.2239 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.2151 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.9481 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2364 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2319 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.8389 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.8534 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.9329 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.8833 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.8200 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 2.2151 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2376 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.9801 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 2.2512 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.2423 | Val  Acc: 0.3220
Average Valid Accuracy: 0.4254
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-USPS       | Epoch:5 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 1.8675 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.7701 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.8408 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.7907 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.8707 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 2.2116 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.2161 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.9223 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 2.2117 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2168 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 1.7752 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.7927 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.8789 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.8283 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7605 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 2.2047 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2315 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.9372 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.2384 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.2335 | Val  Acc: 0.3390
Average Valid Accuracy: 0.4492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2712
 Best site-USPS       | Epoch:6 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 1.8184 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.7361 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.8114 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.7297 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.8083 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 2.2091 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.2065 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.8399 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 2.1933 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2127 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.7167 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.7372 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.8298 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.7773 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7046 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.1947 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2253 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.8942 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.2263 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.2234 | Val  Acc: 0.3220
Average Valid Accuracy: 0.4712
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2881
 Best site-USPS       | Epoch:7 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 1.7349 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.6768 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.7385 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.6974 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.8013 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 2.1912 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1899 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.8234 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1868 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1964 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.6598 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6819 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.7811 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.7259 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.6503 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.1857 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2193 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.8559 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.2129 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.2138 | Val  Acc: 0.3390
Average Valid Accuracy: 0.4932
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3051
 Best site-USPS       | Epoch:8 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 1.7004 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6285 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.7057 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.6242 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.7450 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 2.1851 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1782 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.7831 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1626 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1837 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 1.6063 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.6301 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.7323 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.6768 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.5981 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1774 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2140 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.8180 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.1999 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.2040 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5051
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3051
 Best site-USPS       | Epoch:9 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-MNIST     | Train Loss: 1.6508 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.5774 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.6417 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.5760 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.6915 | Train Acc: 0.6136
 Site-SVHN      | Train Loss: 2.1688 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1885 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.7417 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 2.1619 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1723 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 1.5553 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.5819 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.6861 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.6312 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.5514 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.1698 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2084 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.7754 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.1868 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1953 | Val  Acc: 0.3729
Average Valid Accuracy: 0.5203
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:10 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:10 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:10 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3051
 Best site-USPS       | Epoch:10 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-MNIST     | Train Loss: 1.5927 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.5325 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.6001 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.5335 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.6532 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.1592 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1694 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.7072 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 2.1439 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.1675 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.5077 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.5363 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.6427 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.5910 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.5081 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.1626 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2025 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.7332 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.1743 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1864 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5407
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:11 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:11 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3051
 Best site-USPS       | Epoch:11 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-MNIST     | Train Loss: 1.5588 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.4909 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.5395 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.4957 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.6287 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 2.1534 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1659 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.6357 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 2.1474 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.1503 | Train Acc: 0.3409
 Site-MNIST     | Val  Loss: 1.4645 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.4942 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.6021 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.5535 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.4694 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1556 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1972 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.6851 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 2.1632 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.1783 | Val  Acc: 0.3898
Average Valid Accuracy: 0.5508
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:12 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:12 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3051
 Best site-USPS       | Epoch:12 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-MNIST     | Train Loss: 1.5010 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.4513 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.5330 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.4680 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.5393 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 2.1531 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1641 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.6164 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 2.1179 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1499 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.4230 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.4554 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.5635 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.5162 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.4284 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1487 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1917 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.6559 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 2.1487 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1708 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5661
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:13 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:13 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3051
 Best site-USPS       | Epoch:13 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-MNIST     | Train Loss: 1.4923 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.4305 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.4868 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.4212 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.5326 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 2.1390 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1440 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.5675 | Train Acc: 0.6705
 Site-SynthDigits| Train Loss: 2.0953 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1414 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.3840 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.4186 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.5282 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.4817 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.3918 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1412 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.1872 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.6232 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 2.1349 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1635 | Val  Acc: 0.4068
Average Valid Accuracy: 0.5678
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:14 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:14 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:14 | Val Acc: 0.3051
 Best site-USPS       | Epoch:14 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-MNIST     | Train Loss: 1.4486 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.4053 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.4425 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.3602 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.4903 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 2.1224 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.1407 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.5208 | Train Acc: 0.6705
 Site-SynthDigits| Train Loss: 2.0824 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1231 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.3469 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.3834 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.4914 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.4493 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.3563 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1344 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.1813 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.5945 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 2.1216 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1537 | Val  Acc: 0.4068
Average Valid Accuracy: 0.5712
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:15 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:15 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3051
 Best site-USPS       | Epoch:15 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-MNIST     | Train Loss: 1.4302 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.3720 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.4372 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.3359 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.4549 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.1282 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1426 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.5395 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 2.0823 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1162 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.3099 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.3471 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.4560 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.4154 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.3229 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1286 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.1762 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.5588 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.1122 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1471 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5780
 Best site-MNIST      | Epoch:16 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:16 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:16 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:16 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:16 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:16 | Val Acc: 0.3051
 Best site-USPS       | Epoch:16 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-MNIST     | Train Loss: 1.3726 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.3403 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.3759 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.3041 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.4297 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.1174 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.1112 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.5015 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 2.0563 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1000 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.2781 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.3160 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.4242 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.3874 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2923 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1230 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1695 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.5285 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.1001 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1394 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5898
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:17 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:17 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:17 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:17 | Val Acc: 0.3051
 Best site-USPS       | Epoch:17 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-MNIST     | Train Loss: 1.3566 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.2679 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.3685 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.2769 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.3924 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.1044 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.1226 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4474 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 2.0412 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.0907 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 1.2459 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.2832 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.3932 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.3595 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2647 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1173 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1639 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.5050 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.0900 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1308 | Val  Acc: 0.4407
Average Valid Accuracy: 0.5915
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:18 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:18 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:18 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:18 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3051
 Best site-USPS       | Epoch:18 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-MNIST     | Train Loss: 1.3074 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.2684 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.3276 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.2368 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.3602 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.0958 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.1303 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4337 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 2.0379 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.0866 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 1.2135 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.2503 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.3618 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.3292 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2342 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1133 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1592 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.4881 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 2.0807 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1222 | Val  Acc: 0.4576
Average Valid Accuracy: 0.5949
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:19 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:19 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:19 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:19 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:19 | Val Acc: 0.3051
 Best site-USPS       | Epoch:19 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.6914
 Test site-SVHN      | Epoch:19 | Test Acc: 0.2111
 Test site-USPS      | Epoch:19 | Test Acc: 0.7527
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.3044
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.2600
Average Test Accuracy: 0.4439
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-MNIST     | Train Loss: 1.2960 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.2235 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.2971 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.2445 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 1.3455 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 2.1013 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1146 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4019 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 2.0448 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.0780 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 1.1870 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.2252 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 1.3359 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.3038 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2062 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1070 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1537 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.4486 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 2.0650 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1151 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6068
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:20 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:20 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:20 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:20 | Val Acc: 0.3220
 Best site-USPS       | Epoch:20 | Val Acc: 0.6610
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-MNIST     | Train Loss: 1.2328 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.2017 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.2739 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.1766 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 1.3088 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 2.0991 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1116 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.3663 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 2.0070 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.0771 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 1.1586 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.1972 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 1.3060 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.2768 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.1800 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1014 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1480 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.4206 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 2.0557 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1067 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6085
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:21 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:21 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:21 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:21 | Val Acc: 0.3220
 Best site-USPS       | Epoch:21 | Val Acc: 0.6610
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-MNIST     | Train Loss: 1.2411 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.1974 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.2327 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.1317 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 1.3115 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 2.0783 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1045 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.3535 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 2.0205 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.0681 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 1.1333 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.1723 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 1.2794 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.2530 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.1569 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0955 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1411 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.3882 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 2.0446 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0984 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6085
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-MNIST     | Train Loss: 1.1661 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.1572 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.2097 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.1379 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 1.2779 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 2.0786 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0987 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.3252 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 2.0066 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.0523 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 1.1041 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.1399 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.2505 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.2251 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.1303 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0928 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1383 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.3671 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 2.0397 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0985 | Val  Acc: 0.4576
Average Valid Accuracy: 0.6153
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:23 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:23 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:23 | Val Acc: 0.3220
 Best site-USPS       | Epoch:23 | Val Acc: 0.6610
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-MNIST     | Train Loss: 1.1886 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.1264 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.1852 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.1013 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 1.2308 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 2.0639 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0812 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.2724 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.9769 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.0419 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 1.0807 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 1.1171 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 1.2260 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.2041 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.1079 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0889 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1288 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 1.3514 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 2.0265 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0809 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6203
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:24 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:24 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:24 | Val Acc: 0.3559
 Best site-USPS       | Epoch:24 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-MNIST     | Train Loss: 1.1522 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.1207 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.1625 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0921 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 1.2078 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 2.0869 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0936 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.3171 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.9661 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 2.0381 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 1.0575 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 1.0939 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 1.2024 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.1809 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.0864 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0828 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1233 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 1.3161 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 2.0160 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0842 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6220
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:25 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:25 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:25 | Val Acc: 0.3390
 Best site-USPS       | Epoch:25 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-MNIST     | Train Loss: 1.1406 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.1033 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.1391 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0675 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 1.2199 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 2.0567 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0960 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.2241 | Train Acc: 0.7386
 Site-SynthDigits| Train Loss: 1.9574 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 2.0307 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 1.0372 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.0736 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 1.1801 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.1609 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.0673 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0769 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1161 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 1.2820 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 2.0065 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0793 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6271
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:26 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:26 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:26 | Val Acc: 0.3559
 Best site-USPS       | Epoch:26 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-MNIST     | Train Loss: 1.1019 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0562 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.1570 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0761 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 1.1834 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 2.0548 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 2.0664 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.2376 | Train Acc: 0.7386
 Site-SynthDigits| Train Loss: 1.9582 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.0232 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 1.0158 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 1.0524 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 1.1595 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.1415 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.0476 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0717 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1076 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 1.2667 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.9947 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0610 | Val  Acc: 0.4576
Average Valid Accuracy: 0.6305
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:27 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:27 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:27 | Val Acc: 0.3729
 Best site-USPS       | Epoch:27 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-MNIST     | Train Loss: 1.0833 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0492 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.1069 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 1.0108 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 1.1432 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 2.0612 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0698 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1815 | Train Acc: 0.7386
 Site-SynthDigits| Train Loss: 1.9525 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.0121 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 0.9960 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.0300 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 1.1397 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.1224 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.0294 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0650 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1021 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 1.2382 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.9888 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0610 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6339
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:28 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:28 | Val Acc: 0.3390
 Best site-USPS       | Epoch:28 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-MNIST     | Train Loss: 1.0607 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0302 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.0950 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.9988 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 1.1211 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 2.0428 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 2.0594 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1933 | Train Acc: 0.7386
 Site-SynthDigits| Train Loss: 1.9342 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.9984 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 0.9739 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.0069 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 1.1185 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.1025 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.0107 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0613 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0964 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 1.2220 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.9786 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0406 | Val  Acc: 0.4746
Average Valid Accuracy: 0.6390
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:29 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:29 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:29 | Val Acc: 0.3559
 Best site-USPS       | Epoch:29 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-MNIST     | Train Loss: 1.0158 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0052 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0640 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 1.0051 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 1.1353 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0391 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 2.0582 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1814 | Train Acc: 0.7386
 Site-SynthDigits| Train Loss: 1.9200 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.0015 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 0.9534 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9868 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 1.0992 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.0849 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.9933 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0543 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0916 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 1.2042 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.9683 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0357 | Val  Acc: 0.4915
Average Valid Accuracy: 0.6475
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:30 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:30 | Val Acc: 0.3559
 Best site-USPS       | Epoch:30 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-MNIST     | Train Loss: 1.0046 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 1.0229 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0466 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.9766 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 1.1011 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.0322 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.0584 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1706 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.9086 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 1.9613 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.9355 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9672 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 1.0807 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.0699 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.9764 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0471 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0835 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 1.1850 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.9589 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0342 | Val  Acc: 0.4915
Average Valid Accuracy: 0.6492
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:31 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:31 | Val Acc: 0.3559
 Best site-USPS       | Epoch:31 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-MNIST     | Train Loss: 0.9962 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9591 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0137 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.9553 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 1.0823 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0284 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.0418 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.1587 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.9224 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 1.9678 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.9181 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9462 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 1.0611 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.0485 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.9557 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0445 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0850 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1634 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9545 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0294 | Val  Acc: 0.4746
Average Valid Accuracy: 0.6492
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-MNIST     | Train Loss: 0.9557 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9728 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.0308 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.9257 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 1.0512 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.0038 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.0549 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.1255 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.9116 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 1.9561 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.9094 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9332 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 1.0488 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.0378 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.9382 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0398 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0808 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1434 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9494 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0265 | Val  Acc: 0.5085
Average Valid Accuracy: 0.6542
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:33 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:33 | Val Acc: 0.3220
 Best site-USPS       | Epoch:33 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-MNIST     | Train Loss: 0.9621 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9660 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9997 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.9054 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 1.0676 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.0092 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.0341 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.1061 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.8998 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.9589 | Train Acc: 0.4773
 Site-MNIST     | Val  Loss: 0.8863 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9113 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 1.0287 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.0131 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.9227 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0349 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0760 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1278 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9356 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0095 | Val  Acc: 0.4746
Average Valid Accuracy: 0.6508
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-MNIST     | Train Loss: 0.9506 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9341 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.9782 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.9089 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 1.0051 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.0017 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.0287 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.1016 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.8921 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.9374 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 0.8764 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.8975 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 1.0150 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.0048 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.9099 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0294 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0683 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.1088 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.9330 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0071 | Val  Acc: 0.5085
Average Valid Accuracy: 0.6559
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:35 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:35 | Val Acc: 0.3051
 Best site-USPS       | Epoch:35 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-MNIST     | Train Loss: 0.9331 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9154 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9647 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.8586 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 1.0322 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.0000 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.0396 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.0849 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.8607 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.9205 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.8617 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.8798 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.9995 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9862 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8930 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0257 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0634 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.0996 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.9282 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.9997 | Val  Acc: 0.5085
Average Valid Accuracy: 0.6593
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:36 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:36 | Val Acc: 0.3051
 Best site-USPS       | Epoch:36 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-MNIST     | Train Loss: 0.9030 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.9045 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.9479 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.8875 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 1.0276 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9807 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.0094 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.0278 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.8513 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9209 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 0.8550 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.8731 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.9904 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.9805 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.8825 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0137 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0620 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 1.0714 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.9163 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.9956 | Val  Acc: 0.5085
Average Valid Accuracy: 0.6644
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:37 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:37 | Val Acc: 0.3390
 Best site-USPS       | Epoch:37 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-MNIST     | Train Loss: 0.9148 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.8948 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.9263 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.8635 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.9645 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9885 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.0130 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.0415 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8350 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.9164 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 0.8301 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.8491 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.9713 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9563 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8646 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 2.0141 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.0535 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 1.0675 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.9049 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 1.9890 | Val  Acc: 0.5254
Average Valid Accuracy: 0.6695
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:38 | Val Acc: 0.3390
 Best site-USPS       | Epoch:38 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-MNIST     | Train Loss: 0.8847 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.8612 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.9077 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.8301 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.9672 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9848 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.0157 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.0515 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8472 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9074 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.8185 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.8362 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.9580 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9402 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8482 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 2.0144 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0506 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 1.0582 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.9002 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.9902 | Val  Acc: 0.5424
Average Valid Accuracy: 0.6729
 Best site-MNIST      | Epoch:39 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:39 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:39 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:39 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:39 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:39 | Val Acc: 0.3390
 Best site-USPS       | Epoch:39 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/PromptFL...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.7550
 Test site-SVHN      | Epoch:39 | Test Acc: 0.2227
 Test site-USPS      | Epoch:39 | Test Acc: 0.8226
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.3700
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.2793
Average Test Accuracy: 0.4899
===2023-04-06 16:42:13===
===2023-04-06 16:42:14===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.7550
 Test site-SVHN      | Epoch:39 | Test Acc: 0.2227
 Test site-USPS      | Epoch:39 | Test Acc: 0.8226
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.3700
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.2793
Average Test Accuracy: 0.4899
