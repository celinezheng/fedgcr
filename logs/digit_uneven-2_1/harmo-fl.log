===2023-04-22 23:50:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.8902 | Train Acc: 0.4348
 Site-MNIST     | Train Loss: 1.8390 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 1.7865 | Train Acc: 0.5634
 Site-MNIST     | Train Loss: 1.8097 | Train Acc: 0.5851
 Site-MNIST     | Train Loss: 1.7116 | Train Acc: 0.6695
 Site-SVHN      | Train Loss: 2.2046 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.8068 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.1115 | Train Acc: 0.3108
 Site-SynthDigits| Train Loss: 2.0809 | Train Acc: 0.3176
 Site-MNIST-M   | Train Loss: 2.2805 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 1.7274 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.8090 | Val  Acc: 0.6774
 Site-MNIST     | Val  Loss: 1.8738 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.8172 | Val  Acc: 0.5873
 Site-MNIST     | Val  Loss: 1.7453 | Val  Acc: 0.5823
 Site-SVHN      | Val  Loss: 2.1837 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.8329 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.1210 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.0769 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.2479 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4849
 Best site-MNIST      | Epoch:0 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6774
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5745
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5873
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5823
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2424
 Best site-USPS       | Epoch:0 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2653
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3061
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 1.4970 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.3753 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.4137 | Train Acc: 0.6901
 Site-MNIST     | Train Loss: 1.4210 | Train Acc: 0.7128
 Site-MNIST     | Train Loss: 1.2830 | Train Acc: 0.8051
 Site-SVHN      | Train Loss: 2.0956 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.4401 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.8679 | Train Acc: 0.4459
 Site-SynthDigits| Train Loss: 1.8443 | Train Acc: 0.4527
 Site-MNIST-M   | Train Loss: 2.1406 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 1.2707 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.3752 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.4745 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.4352 | Val  Acc: 0.6825
 Site-MNIST     | Val  Loss: 1.3154 | Val  Acc: 0.6835
 Site-SVHN      | Val  Loss: 2.0630 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.5855 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 1.9859 | Val  Acc: 0.4286
 Site-SynthDigits| Val  Loss: 1.8706 | Val  Acc: 0.4796
 Site-MNIST-M   | Val  Loss: 2.2019 | Val  Acc: 0.2727
Average Valid Accuracy: 0.5697
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7234
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6825
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6835
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3030
 Best site-USPS       | Epoch:1 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4286
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4796
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 1.2234 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 1.0200 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.0864 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.1385 | Train Acc: 0.7340
 Site-MNIST     | Train Loss: 0.9404 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 2.0334 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.2170 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.6998 | Train Acc: 0.5270
 Site-SynthDigits| Train Loss: 1.6587 | Train Acc: 0.5135
 Site-MNIST-M   | Train Loss: 2.1418 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.9574 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.0669 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.2057 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.1640 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 0.9812 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 2.0117 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.3660 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.7573 | Val  Acc: 0.5102
 Site-SynthDigits| Val  Loss: 1.6664 | Val  Acc: 0.5510
 Site-MNIST-M   | Val  Loss: 2.1402 | Val  Acc: 0.2727
Average Valid Accuracy: 0.6168
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7234
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2727
 Best site-USPS       | Epoch:2 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5102
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5510
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 1.1615 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.8073 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.8655 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.9486 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 0.7587 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 2.0096 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 1.0685 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.5314 | Train Acc: 0.5541
 Site-SynthDigits| Train Loss: 1.4384 | Train Acc: 0.6081
 Site-MNIST-M   | Train Loss: 2.0667 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 0.7876 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.8709 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.9966 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 0.9696 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.7915 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.9582 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.2087 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.5764 | Val  Acc: 0.6939
 Site-SynthDigits| Val  Loss: 1.4809 | Val  Acc: 0.6429
 Site-MNIST-M   | Val  Loss: 2.0960 | Val  Acc: 0.3182
Average Valid Accuracy: 0.6789
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3939
 Best site-USPS       | Epoch:3 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6939
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6429
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 0.7914 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5818 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.6985 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.7746 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.6272 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.9934 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 0.9464 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.4160 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 1.3668 | Train Acc: 0.6622
 Site-MNIST-M   | Train Loss: 1.9971 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.5874 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6765 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.7938 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.8028 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.6683 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.9385 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.0932 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.5509 | Val  Acc: 0.6735
 Site-SynthDigits| Val  Loss: 1.3869 | Val  Acc: 0.6735
 Site-MNIST-M   | Val  Loss: 2.0661 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7133
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3636
 Best site-USPS       | Epoch:4 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6735
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6735
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 0.6901 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.4755 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5819 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6401 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.4782 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.9592 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 0.8734 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.3355 | Train Acc: 0.6351
 Site-SynthDigits| Train Loss: 1.2550 | Train Acc: 0.6959
 Site-MNIST-M   | Train Loss: 1.7630 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.4478 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5457 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6750 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.6736 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.5554 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.8191 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.0001 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.4648 | Val  Acc: 0.7551
 Site-SynthDigits| Val  Loss: 1.2924 | Val  Acc: 0.7143
 Site-MNIST-M   | Val  Loss: 2.0330 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7390
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2727
 Best site-USPS       | Epoch:5 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7551
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7143
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 0.6680 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.4260 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.5215 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5691 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.4075 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.7531 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 0.7983 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.2517 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 1.1255 | Train Acc: 0.7230
 Site-MNIST-M   | Train Loss: 1.7809 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.3809 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4779 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.6356 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.5886 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.4679 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.7611 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.9102 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.3375 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.1740 | Val  Acc: 0.7551
 Site-MNIST-M   | Val  Loss: 1.9460 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7604
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2727
 Best site-USPS       | Epoch:6 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7551
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 0.6004 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.3724 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5287 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4782 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3404 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.9029 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 0.7718 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.2051 | Train Acc: 0.6892
 Site-SynthDigits| Train Loss: 1.0912 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.7577 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.3099 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3923 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5280 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5113 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.4251 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7682 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.8824 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.2119 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 1.1162 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.9741 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7624
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2424
 Best site-USPS       | Epoch:7 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7755
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 0.4763 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3111 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4463 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4153 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3003 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8238 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 0.8394 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.1070 | Train Acc: 0.6622
 Site-SynthDigits| Train Loss: 1.0057 | Train Acc: 0.7703
 Site-MNIST-M   | Train Loss: 1.8299 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.2280 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3096 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4635 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.4491 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.3882 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.7166 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.8319 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0311 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.9759 | Val  Acc: 0.8061
 Site-MNIST-M   | Val  Loss: 1.8729 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7793
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2424
 Best site-USPS       | Epoch:8 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8061
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 0.4480 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.2926 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4520 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3931 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.2556 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.7049 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.7093 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.0659 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 0.9572 | Train Acc: 0.7905
 Site-MNIST-M   | Train Loss: 1.5602 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.1658 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2888 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4591 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.4080 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.3461 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7392 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.7797 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0138 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.9344 | Val  Acc: 0.8265
 Site-MNIST-M   | Val  Loss: 1.8876 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7839
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2424
 Best site-USPS       | Epoch:9 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8265
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 0.5157 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2559 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3638 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3410 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.2278 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8086 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.7697 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0277 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 0.8643 | Train Acc: 0.7770
 Site-MNIST-M   | Train Loss: 1.6973 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.1549 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2427 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3926 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3564 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.3294 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7380 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.7587 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0092 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.8779 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.8531 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7830
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 0.4088 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.2394 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.4028 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3263 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1950 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.7147 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.6541 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0186 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 0.8266 | Train Acc: 0.8311
 Site-MNIST-M   | Train Loss: 1.6371 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.1806 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2454 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3854 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.3455 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2984 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.7408 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.7308 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.8879 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 0.8195 | Val  Acc: 0.8673
 Site-MNIST-M   | Val  Loss: 1.8467 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7947
 Best site-MNIST      | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2121
 Best site-USPS       | Epoch:11 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.8980
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.8673
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 0.3263 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2116 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.3390 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2969 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1989 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.6605 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.6721 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9051 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.7761 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 1.7159 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.1450 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2242 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3658 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.3030 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2764 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7459 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.7163 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7899 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 0.7173 | Val  Acc: 0.8673
 Site-MNIST-M   | Val  Loss: 1.8502 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8017
 Best site-MNIST      | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2424
 Best site-USPS       | Epoch:12 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.8980
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.8673
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 0.3281 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.2175 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3222 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2600 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1559 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.4323 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.6049 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.8920 | Train Acc: 0.7162
 Site-SynthDigits| Train Loss: 0.7062 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 1.6985 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.1151 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1841 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3022 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2718 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2575 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 1.7743 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6772 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7408 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 0.6817 | Val  Acc: 0.8469
 Site-MNIST-M   | Val  Loss: 1.8086 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8032
 Best site-MNIST      | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:13 | Val Acc: 0.2121
 Best site-USPS       | Epoch:13 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.8980
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.8469
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.3268 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1954 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2992 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2529 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1400 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.6509 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5798 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.8942 | Train Acc: 0.7162
 Site-SynthDigits| Train Loss: 0.6419 | Train Acc: 0.8243
 Site-MNIST-M   | Train Loss: 1.8884 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.1133 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1920 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3053 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2577 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2429 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 1.7172 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.6850 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7416 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 0.6624 | Val  Acc: 0.8571
 Site-MNIST-M   | Val  Loss: 1.8083 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8148
 Best site-MNIST      | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:14 | Val Acc: 0.2727
 Best site-USPS       | Epoch:14 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.8980
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.8571
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 0.3494 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1983 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2772 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2326 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1380 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.5572 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 0.5944 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.8500 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.5483 | Train Acc: 0.8649
 Site-MNIST-M   | Train Loss: 1.6214 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.1128 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1788 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2840 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2333 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2302 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.6832 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6417 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.6559 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.5787 | Val  Acc: 0.8776
 Site-MNIST-M   | Val  Loss: 1.7246 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8137
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 0.2897 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1798 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2583 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2085 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1128 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.7892 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5700 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8124 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.5897 | Train Acc: 0.8986
 Site-MNIST-M   | Train Loss: 1.3272 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0951 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1652 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2671 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2103 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2169 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.7231 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6357 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6602 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.5610 | Val  Acc: 0.9082
 Site-MNIST-M   | Val  Loss: 1.7396 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8172
 Best site-MNIST      | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:16 | Val Acc: 0.2121
 Best site-USPS       | Epoch:16 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.9184
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.9082
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 0.3469 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1727 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2426 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1958 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0992 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.5660 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.5635 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.7849 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.5087 | Train Acc: 0.9122
 Site-MNIST-M   | Train Loss: 1.3941 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1430 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2445 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2003 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2076 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.7604 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6138 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6183 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.5210 | Val  Acc: 0.9184
 Site-MNIST-M   | Val  Loss: 1.7447 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8198
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:17 | Val Acc: 0.2121
 Best site-USPS       | Epoch:17 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.9184
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.9184
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 0.2685 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.1462 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2780 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1743 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0952 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.3867 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5577 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.7578 | Train Acc: 0.7973
 Site-SynthDigits| Train Loss: 0.4701 | Train Acc: 0.9189
 Site-MNIST-M   | Train Loss: 1.9503 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.0762 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1319 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2255 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1854 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2076 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 1.7467 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.6574 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6372 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.5031 | Val  Acc: 0.9286
 Site-MNIST-M   | Val  Loss: 1.7498 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8271
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3333
 Best site-USPS       | Epoch:18 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.9184
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.9286
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.3416 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1487 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2947 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1817 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0806 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.6824 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.5331 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.7295 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.4484 | Train Acc: 0.9324
 Site-MNIST-M   | Train Loss: 1.1488 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0721 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1305 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2369 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1781 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1972 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.7467 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6466 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.4766 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.4212 | Val  Acc: 0.9490
 Site-MNIST-M   | Val  Loss: 1.6977 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8255
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 0.2590 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1580 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.2896 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1893 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.0812 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5707 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.5707 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.7328 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.4127 | Train Acc: 0.9527
 Site-MNIST-M   | Train Loss: 1.6190 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0778 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1431 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2456 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1889 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1821 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.7460 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6137 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.4430 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 0.3927 | Val  Acc: 0.9694
 Site-MNIST-M   | Val  Loss: 1.7394 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8284
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9620
 Best site-SVHN       | Epoch:20 | Val Acc: 0.2121
 Best site-USPS       | Epoch:20 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.9592
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.9694
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 0.3296 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1438 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2676 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1674 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.0759 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.5366 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.5579 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.7317 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.3673 | Train Acc: 0.9595
 Site-MNIST-M   | Train Loss: 1.3359 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.0469 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1104 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2196 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1697 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1866 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.7477 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6506 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3994 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 0.3689 | Val  Acc: 0.9694
 Site-MNIST-M   | Val  Loss: 1.6689 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8246
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 0.2354 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1411 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.3131 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1505 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0658 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.5243 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.5805 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.6285 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.3452 | Train Acc: 0.9865
 Site-MNIST-M   | Train Loss: 1.4019 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0572 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1042 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1963 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1542 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1872 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.7560 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6421 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3529 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.3385 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7061 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8406
 Best site-MNIST      | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:22 | Val Acc: 0.2424
 Best site-USPS       | Epoch:22 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.9796
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.9898
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 0.2637 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1402 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2337 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1467 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0562 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6360 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.5472 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.6245 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.3446 | Train Acc: 0.9459
 Site-MNIST-M   | Train Loss: 1.3694 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0564 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1058 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1872 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1528 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1739 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.7639 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6329 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3550 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 0.3340 | Val  Acc: 0.9694
 Site-MNIST-M   | Val  Loss: 1.7390 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8336
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2186 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1247 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2622 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1487 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0654 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3588 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.5314 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.5951 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.2994 | Train Acc: 0.9797
 Site-MNIST-M   | Train Loss: 1.8431 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0512 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1068 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1897 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1501 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1654 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8254 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6354 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3118 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2986 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7338 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8264
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 0.3204 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1306 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2858 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1277 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0473 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3432 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.5045 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5536 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.3401 | Train Acc: 0.9730
 Site-MNIST-M   | Train Loss: 2.2189 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0311 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0774 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1636 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1341 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1693 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8369 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5699 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3049 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2866 | Val  Acc: 0.9796
 Site-MNIST-M   | Val  Loss: 1.7502 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8346
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 0.2840 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1164 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2035 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1127 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0412 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4478 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4763 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5607 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.2996 | Train Acc: 0.9797
 Site-MNIST-M   | Train Loss: 1.6165 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0304 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0713 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1439 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1218 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1645 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.8300 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5933 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.2887 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2713 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7507 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8343
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 0.2845 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1202 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1983 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1283 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0441 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5915 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.4596 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5580 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.2616 | Train Acc: 0.9865
 Site-MNIST-M   | Train Loss: 1.0558 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0350 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0785 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1637 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1287 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1518 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.8291 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5828 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.2461 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2381 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7328 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8343
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 0.2267 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1055 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2058 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1130 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0384 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5006 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.4638 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.5187 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.2519 | Train Acc: 0.9797
 Site-MNIST-M   | Train Loss: 1.3651 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0268 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0687 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1494 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1149 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1445 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9083 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6317 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.2594 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2298 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7478 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8438
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2121
 Best site-USPS       | Epoch:28 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9796
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9898
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2033 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1219 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1893 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1123 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3376 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.4654 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5093 | Train Acc: 0.8514
 Site-SynthDigits| Train Loss: 0.2192 | Train Acc: 0.9797
 Site-MNIST-M   | Train Loss: 1.5210 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0634 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1404 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1123 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1533 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.7872 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6391 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.2026 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2072 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7714 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8380
============ Train epoch 30 ============
 Site-MNIST     | Train Loss: 0.2389 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1003 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1801 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.0990 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0307 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4217 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4709 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5229 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.2451 | Train Acc: 0.9865
 Site-MNIST-M   | Train Loss: 1.3130 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0627 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1224 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1042 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1462 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.8592 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6269 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1835 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.1979 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7471 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8373
============ Train epoch 31 ============
 Site-MNIST     | Train Loss: 0.2406 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1018 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1803 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0923 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0338 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4291 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.4224 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4795 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.1942 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.2944 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0294 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0579 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1194 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0995 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1439 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8995 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 0.6098 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1756 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1800 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7956 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8363
============ Train epoch 32 ============
 Site-MNIST     | Train Loss: 0.1704 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1083 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.1792 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1001 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0296 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5372 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4475 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4986 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.2040 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.2381 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0638 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1292 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1039 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1330 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8566 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5816 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1621 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1706 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7941 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8423
============ Train epoch 33 ============
 Site-MNIST     | Train Loss: 0.2605 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1031 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1606 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0879 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0239 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5291 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4198 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4843 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.1829 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.7447 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0244 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0602 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1172 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0879 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1391 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8735 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.5993 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1383 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1552 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7487 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8393
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1786 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0978 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1613 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0901 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0208 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4418 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4357 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4478 | Train Acc: 0.9054
 Site-SynthDigits| Train Loss: 0.1554 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.0764 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0184 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0546 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1171 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0898 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1322 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8771 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 0.6304 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1475 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1466 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7603 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8363
============ Train epoch 35 ============
 Site-MNIST     | Train Loss: 0.1968 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0842 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1796 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0778 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0238 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4427 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4611 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4723 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.1479 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.1429 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0170 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0458 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1022 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0821 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1389 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8865 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6233 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1583 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1406 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7803 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8454
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:35 | Val Acc: 0.2424
 Best site-USPS       | Epoch:35 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:35 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 36 ============
 Site-MNIST     | Train Loss: 0.2977 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0841 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1626 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0769 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0192 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3197 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.4197 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.4468 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.1667 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.4198 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0560 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1044 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0757 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1343 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8742 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5811 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.1188 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1349 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7452 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8389
============ Train epoch 37 ============
 Site-MNIST     | Train Loss: 0.1751 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0818 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1517 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0820 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0206 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2862 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.4372 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4264 | Train Acc: 0.9054
 Site-SynthDigits| Train Loss: 0.1326 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.4171 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0509 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1031 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0845 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1254 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9322 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.5837 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1398 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1288 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8067 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8408
============ Train epoch 38 ============
 Site-MNIST     | Train Loss: 0.2066 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0908 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1889 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0907 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0195 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2811 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.4336 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4261 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.1311 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.2777 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.0175 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0424 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1099 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0953 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1246 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9217 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5817 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1252 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1160 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7989 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8469
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2121
 Best site-USPS       | Epoch:38 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:38 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1953 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0717 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1524 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0673 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0161 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2373 | Train Acc: 0.6800
 Site-USPS      | Train Loss: 0.4927 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4136 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.1137 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.5565 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0134 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0845 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0725 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1325 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0133 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6642 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1302 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1124 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7634 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8469
============ Train epoch 40 ============
 Site-MNIST     | Train Loss: 0.2318 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0951 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1663 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0610 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0948 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4259 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4003 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.1167 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.3112 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.0104 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0333 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0774 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0633 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1340 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9589 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5711 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1092 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1087 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8114 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8423
============ Train epoch 41 ============
 Site-MNIST     | Train Loss: 0.2272 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0909 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1643 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0566 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0144 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1638 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4282 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.4294 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.1015 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.0854 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0714 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0583 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1272 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0089 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5909 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0978 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0967 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7779 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8469
============ Train epoch 42 ============
 Site-MNIST     | Train Loss: 0.2707 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0792 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1690 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0733 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0145 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1213 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.3977 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3806 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.1007 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.1127 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0448 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0944 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0722 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1165 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9719 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.5979 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1085 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0953 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8916 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8454
============ Train epoch 43 ============
 Site-MNIST     | Train Loss: 0.2274 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0919 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1495 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0710 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3220 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4054 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3832 | Train Acc: 0.9595
 Site-SynthDigits| Train Loss: 0.0980 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.3906 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0388 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0909 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0719 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1141 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9707 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5387 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0992 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0952 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8991 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8378
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.2007 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0819 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1996 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0587 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0115 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1513 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.3765 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3561 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.0905 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.2219 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.0075 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0727 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0608 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1172 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9953 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6041 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1014 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0918 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8660 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8393
============ Train epoch 45 ============
 Site-MNIST     | Train Loss: 0.3004 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0778 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1359 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0555 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0123 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3048 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.3936 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3429 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.0832 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.0161 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0281 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0731 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0577 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1145 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0190 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5655 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1000 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0851 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8497 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8423
============ Train epoch 46 ============
 Site-MNIST     | Train Loss: 0.2023 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0846 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1850 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0577 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0127 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2489 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.3764 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3355 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.0836 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.2930 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0331 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0595 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1037 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0484 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5976 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0872 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0780 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8314 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8423
============ Train epoch 47 ============
 Site-MNIST     | Train Loss: 0.2234 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0708 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1299 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0569 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0132 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2892 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.3992 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3394 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.0768 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.7651 | Train Acc: 0.6970
 Site-MNIST     | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0305 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0570 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1052 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0384 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6592 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0739 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0705 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8358 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8423
============ Train epoch 48 ============
 Site-MNIST     | Train Loss: 0.2672 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0747 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1629 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0587 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0127 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2382 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 0.4049 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3264 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.0798 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.0844 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.0084 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0352 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0764 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0597 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1047 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0171 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.6651 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0762 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0701 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8381 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8484
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:48 | Val Acc: 0.2727
 Best site-USPS       | Epoch:48 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:48 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.2340 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0668 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1144 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0500 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0111 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3988 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.4050 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3378 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.0690 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.9842 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.0083 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0317 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0677 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1017 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0097 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6320 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0662 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0657 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8027 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8348
===2023-04-23 00:41:05===
===2023-04-23 00:41:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:48 | Test Acc: 0.8793
 Test site-SVHN      | Epoch:48 | Test Acc: 0.2690
 Test site-USPS      | Epoch:48 | Test Acc: 0.7527
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.6193
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.2914
Average Test Accuracy: 0.5623
===2023-04-28 12:57:25===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.8944 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.8092 | Train Acc: 0.5106
 Site-MNIST     | Train Loss: 1.7308 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.8083 | Train Acc: 0.5532
 Site-MNIST     | Train Loss: 1.7082 | Train Acc: 0.5932
 Site-SVHN      | Train Loss: 2.2756 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 1.7902 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 2.0833 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.0685 | Train Acc: 0.3649
 Site-MNIST-M   | Train Loss: 2.2988 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 1.7062 | Val  Acc: 0.4667
 Site-MNIST     | Val  Loss: 1.8180 | Val  Acc: 0.4516
 Site-MNIST     | Val  Loss: 1.8783 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 1.8274 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.7285 | Val  Acc: 0.6076
 Site-SVHN      | Val  Loss: 2.3235 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 1.7909 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.0539 | Val  Acc: 0.3878
 Site-SynthDigits| Val  Loss: 2.0375 | Val  Acc: 0.3776
 Site-MNIST-M   | Val  Loss: 2.2050 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4193
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4516
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5106
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6076
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0909
 Best site-USPS       | Epoch:0 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3878
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3776
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 1.5379 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 1.2642 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.3111 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.3493 | Train Acc: 0.7340
 Site-MNIST     | Train Loss: 1.2165 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.1818 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 1.3682 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.8169 | Train Acc: 0.5270
 Site-SynthDigits| Train Loss: 1.7665 | Train Acc: 0.5743
 Site-MNIST-M   | Train Loss: 2.1670 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 1.1850 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.2989 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.4099 | Val  Acc: 0.7021
 Site-MNIST     | Val  Loss: 1.3708 | Val  Acc: 0.7460
 Site-MNIST     | Val  Loss: 1.2219 | Val  Acc: 0.7722
 Site-SVHN      | Val  Loss: 2.1689 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.4153 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.9130 | Val  Acc: 0.5714
 Site-SynthDigits| Val  Loss: 1.7775 | Val  Acc: 0.5918
 Site-MNIST-M   | Val  Loss: 2.1045 | Val  Acc: 0.3182
Average Valid Accuracy: 0.6471
 Best site-MNIST      | Epoch:1 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7021
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7460
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7722
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2727
 Best site-USPS       | Epoch:1 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5714
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5918
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 1.2264 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.9768 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 1.0206 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.0875 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 0.8898 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 2.0815 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.1430 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.6292 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.6012 | Train Acc: 0.5743
 Site-MNIST-M   | Train Loss: 2.0127 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 0.8638 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.0273 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.1695 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.1162 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.9554 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 2.1114 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.2227 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.6389 | Val  Acc: 0.6531
 Site-SynthDigits| Val  Loss: 1.5809 | Val  Acc: 0.6224
 Site-MNIST-M   | Val  Loss: 2.0527 | Val  Acc: 0.3182
Average Valid Accuracy: 0.6844
 Best site-MNIST      | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3030
 Best site-USPS       | Epoch:2 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.6531
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.6224
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 1.0633 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7075 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.8400 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.9206 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 0.7709 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 1.8566 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 1.0297 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.4382 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.3622 | Train Acc: 0.6284
 Site-MNIST-M   | Train Loss: 2.0519 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 0.8089 | Val  Acc: 0.7333
 Site-MNIST     | Val  Loss: 0.8679 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 0.9441 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 0.9531 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 0.7827 | Val  Acc: 0.8481
 Site-SVHN      | Val  Loss: 2.1429 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 1.0248 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.7042 | Val  Acc: 0.6327
 Site-SynthDigits| Val  Loss: 1.4495 | Val  Acc: 0.6429
 Site-MNIST-M   | Val  Loss: 1.9473 | Val  Acc: 0.3182
Average Valid Accuracy: 0.6536
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 0.9485 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5586 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.6661 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7084 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.5698 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.7882 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 0.9059 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.3540 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 1.2601 | Train Acc: 0.6554
 Site-MNIST-M   | Train Loss: 2.3106 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.4730 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.6284 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.7710 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 0.7444 | Val  Acc: 0.8254
 Site-MNIST     | Val  Loss: 0.6280 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 2.0845 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.9742 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.4792 | Val  Acc: 0.6531
 Site-SynthDigits| Val  Loss: 1.3142 | Val  Acc: 0.6837
 Site-MNIST-M   | Val  Loss: 1.8444 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7045
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8254
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2424
 Best site-USPS       | Epoch:4 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6531
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6837
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 0.8024 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5168 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5955 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6413 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.5222 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.7541 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 0.7698 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.3068 | Train Acc: 0.5811
 Site-SynthDigits| Train Loss: 1.1533 | Train Acc: 0.7095
 Site-MNIST-M   | Train Loss: 1.8237 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.4843 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.5651 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.6629 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.6865 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.5647 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.0522 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.8165 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.3676 | Val  Acc: 0.7143
 Site-SynthDigits| Val  Loss: 1.2089 | Val  Acc: 0.7143
 Site-MNIST-M   | Val  Loss: 1.7905 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7135
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2727
 Best site-USPS       | Epoch:5 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7143
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7143
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 0.7150 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.4000 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5004 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.5387 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.4049 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.8591 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 0.7890 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.2125 | Train Acc: 0.5541
 Site-SynthDigits| Train Loss: 1.0289 | Train Acc: 0.7365
 Site-MNIST-M   | Train Loss: 1.6237 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 0.3391 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4543 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5884 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.5743 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.4781 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.0321 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.8523 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.2404 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.0662 | Val  Acc: 0.7449
 Site-MNIST-M   | Val  Loss: 1.7644 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2727
 Best site-USPS       | Epoch:6 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7449
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 0.5439 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3610 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4659 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.4946 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.3523 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8521 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 0.7578 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.1367 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 0.9107 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.7061 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.3077 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4227 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5748 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.5150 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4320 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.0049 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.8168 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0986 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 0.9639 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.7724 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7579
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2727
 Best site-USPS       | Epoch:7 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7755
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 0.4673 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3299 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4629 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4284 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.3118 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.6755 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 0.7505 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.0553 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 0.8672 | Train Acc: 0.7703
 Site-MNIST-M   | Train Loss: 1.8459 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.2655 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3686 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.4935 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.4591 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4055 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.9697 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.7898 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0722 | Val  Acc: 0.7551
 Site-SynthDigits| Val  Loss: 0.9144 | Val  Acc: 0.7653
 Site-MNIST-M   | Val  Loss: 1.7349 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7505
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 0.5471 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.2952 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4638 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3756 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2663 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.7723 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 0.6117 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.0694 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 0.9171 | Train Acc: 0.7770
 Site-MNIST-M   | Train Loss: 1.6790 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 0.2194 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3241 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4476 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.3996 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.3720 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 1.9527 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.7277 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.1296 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 0.8848 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 1.7445 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7826
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3333
 Best site-USPS       | Epoch:9 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7857
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8243
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2821
 Test site-USPS      | Epoch:9 | Test Acc: 0.8226
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5609
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3136
Average Test Accuracy: 0.5607
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 0.5498 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2778 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4065 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3489 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2332 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.7093 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 0.7064 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9439 | Train Acc: 0.6757
 Site-SynthDigits| Train Loss: 0.8181 | Train Acc: 0.7973
 Site-MNIST-M   | Train Loss: 1.9885 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.1925 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3041 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4422 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3699 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.3424 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 1.9605 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.7921 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9419 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 0.7962 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.7449 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7772
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 0.4031 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2435 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3771 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.3073 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.2290 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.8894 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 0.6147 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.9495 | Train Acc: 0.6757
 Site-SynthDigits| Train Loss: 0.7521 | Train Acc: 0.8311
 Site-MNIST-M   | Train Loss: 2.0399 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.1546 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2664 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3938 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.3282 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3154 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9730 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7501 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.9292 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 0.7444 | Val  Acc: 0.8469
 Site-MNIST-M   | Val  Loss: 1.6977 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7879
 Best site-MNIST      | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2727
 Best site-USPS       | Epoch:11 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.8163
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.8469
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 0.4380 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2105 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3874 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2962 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1726 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.6831 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 0.6670 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9190 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 0.6606 | Train Acc: 0.8851
 Site-MNIST-M   | Train Loss: 2.3739 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.1734 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2654 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3802 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.3211 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3049 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.9637 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7538 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.8884 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.6885 | Val  Acc: 0.8878
 Site-MNIST-M   | Val  Loss: 1.6672 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7941
 Best site-MNIST      | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2727
 Best site-USPS       | Epoch:12 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.8878
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 0.4078 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1904 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.3441 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2682 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2128 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.4133 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.6790 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.8525 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 0.6082 | Train Acc: 0.8986
 Site-MNIST-M   | Train Loss: 1.8617 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.1200 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2537 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3681 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2807 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2900 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.9219 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7996 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.8342 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.6379 | Val  Acc: 0.8980
 Site-MNIST-M   | Val  Loss: 1.6635 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7881
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.3294 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2036 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3417 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.2419 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1410 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.5686 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 0.6331 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8403 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 0.5516 | Train Acc: 0.8784
 Site-MNIST-M   | Train Loss: 1.7052 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.1063 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2225 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3416 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.2610 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2664 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.8883 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.7088 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.8359 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.6283 | Val  Acc: 0.8673
 Site-MNIST-M   | Val  Loss: 1.6516 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8007
 Best site-MNIST      | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9620
 Best site-SVHN       | Epoch:14 | Val Acc: 0.3636
 Best site-USPS       | Epoch:14 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.8673
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 0.3302 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2044 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3174 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.2326 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1330 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.3779 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 0.5296 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.7746 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.5163 | Train Acc: 0.9054
 Site-MNIST-M   | Train Loss: 2.2524 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.1348 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2206 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3225 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2478 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2532 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9173 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.6590 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7759 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.5757 | Val  Acc: 0.9082
 Site-MNIST-M   | Val  Loss: 1.6811 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8127
 Best site-MNIST      | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3030
 Best site-USPS       | Epoch:15 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.9082
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 0.4229 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1677 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2887 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.2106 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1277 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.6468 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 0.5778 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.7368 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.5032 | Train Acc: 0.8986
 Site-MNIST-M   | Train Loss: 1.7831 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.0964 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2108 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3014 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2199 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2443 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9106 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.7497 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.8374 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.5701 | Val  Acc: 0.9082
 Site-MNIST-M   | Val  Loss: 1.6577 | Val  Acc: 0.3182
Average Valid Accuracy: 0.8008
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 0.3463 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1767 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2943 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.2219 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1144 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.4280 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.5257 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.7527 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 0.4391 | Train Acc: 0.8851
 Site-MNIST-M   | Train Loss: 1.4370 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0822 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1864 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3077 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2382 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2341 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8382 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.6695 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.7310 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.5171 | Val  Acc: 0.8878
 Site-MNIST-M   | Val  Loss: 1.6200 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8015
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 0.2882 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1470 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2717 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1940 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1118 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.6119 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.6182 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.6965 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.4187 | Train Acc: 0.8986
 Site-MNIST-M   | Train Loss: 1.4453 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.0857 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1958 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2888 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2052 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2212 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8756 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.7503 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.6530 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.4657 | Val  Acc: 0.9082
 Site-MNIST-M   | Val  Loss: 1.6575 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8054
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.3219 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1535 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2795 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1787 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0883 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.4678 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.5533 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.6717 | Train Acc: 0.7973
 Site-SynthDigits| Train Loss: 0.4542 | Train Acc: 0.9122
 Site-MNIST-M   | Train Loss: 1.8976 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.0820 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1586 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2595 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1955 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2101 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8605 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.6992 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.6447 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.4543 | Val  Acc: 0.9082
 Site-MNIST-M   | Val  Loss: 1.6935 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8123
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 0.2338 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1518 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2750 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1806 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0910 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.5217 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.5522 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.6684 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 0.3720 | Train Acc: 0.9189
 Site-MNIST-M   | Train Loss: 1.6800 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0771 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1599 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2579 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1901 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1958 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8839 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.6849 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.6121 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 0.4262 | Val  Acc: 0.9184
 Site-MNIST-M   | Val  Loss: 1.6572 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8176
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:20 | Val Acc: 0.3030
 Best site-USPS       | Epoch:20 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8980
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.9184
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 0.2582 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1491 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2281 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1704 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0759 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4281 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.5073 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.6246 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.3862 | Train Acc: 0.9392
 Site-MNIST-M   | Train Loss: 1.5608 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0876 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1506 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2455 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1771 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1837 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8785 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.6779 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.5685 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.3870 | Val  Acc: 0.9286
 Site-MNIST-M   | Val  Loss: 1.7084 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8207
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:21 | Val Acc: 0.3030
 Best site-USPS       | Epoch:21 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.9184
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 0.2639 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1358 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2197 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1507 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0654 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2583 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.5003 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.6127 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.3175 | Train Acc: 0.9459
 Site-MNIST-M   | Train Loss: 1.9898 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0625 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1291 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2161 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1610 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1817 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8765 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.6850 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.5298 | Val  Acc: 0.9388
 Site-SynthDigits| Val  Loss: 0.3678 | Val  Acc: 0.9388
 Site-MNIST-M   | Val  Loss: 1.6567 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8238
 Best site-MNIST      | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:22 | Val Acc: 0.3030
 Best site-USPS       | Epoch:22 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.9388
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.9388
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 0.2751 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1210 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2091 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1315 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0623 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3319 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 0.5792 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.6127 | Train Acc: 0.8514
 Site-SynthDigits| Train Loss: 0.3366 | Train Acc: 0.9527
 Site-MNIST-M   | Train Loss: 2.2896 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.0604 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1098 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1876 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1438 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1720 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9000 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7039 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.4848 | Val  Acc: 0.9388
 Site-SynthDigits| Val  Loss: 0.3497 | Val  Acc: 0.9490
 Site-MNIST-M   | Val  Loss: 1.6833 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8218
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2326 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1350 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.1964 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1360 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.0574 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3751 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.4897 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.6226 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.2759 | Train Acc: 0.9730
 Site-MNIST-M   | Train Loss: 1.3069 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0630 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1124 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1939 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1510 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1582 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8353 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6386 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3966 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 0.3066 | Val  Acc: 0.9694
 Site-MNIST-M   | Val  Loss: 1.6795 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8247
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:24 | Val Acc: 0.2424
 Best site-USPS       | Epoch:24 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.9592
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.9694
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 0.2759 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1101 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1930 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1224 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0597 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.2656 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 0.4996 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.5740 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.2679 | Train Acc: 0.9662
 Site-MNIST-M   | Train Loss: 1.5016 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0688 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1102 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.1851 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1286 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1572 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8393 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6825 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.3270 | Val  Acc: 0.9388
 Site-SynthDigits| Val  Loss: 0.2742 | Val  Acc: 0.9592
 Site-MNIST-M   | Val  Loss: 1.6822 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8109
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 0.2148 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1098 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2135 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1166 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0465 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1670 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.5098 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.5824 | Train Acc: 0.9054
 Site-SynthDigits| Train Loss: 0.2393 | Train Acc: 0.9662
 Site-MNIST-M   | Train Loss: 1.9268 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0558 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0933 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1710 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1282 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1553 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8602 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.6812 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3333 | Val  Acc: 0.9388
 Site-SynthDigits| Val  Loss: 0.2620 | Val  Acc: 0.9592
 Site-MNIST-M   | Val  Loss: 1.7150 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8308
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:26 | Val Acc: 0.2727
 Best site-USPS       | Epoch:26 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.9388
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.9592
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 0.3396 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1126 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1777 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1311 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.0526 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4324 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.5230 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.5456 | Train Acc: 0.8784
 Site-SynthDigits| Train Loss: 0.2286 | Train Acc: 0.9662
 Site-MNIST-M   | Train Loss: 1.2827 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0694 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0997 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1933 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1344 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1429 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9097 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7251 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.3268 | Val  Acc: 0.9388
 Site-SynthDigits| Val  Loss: 0.2470 | Val  Acc: 0.9592
 Site-MNIST-M   | Val  Loss: 1.7537 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8202
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 0.3651 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1123 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1780 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1089 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0394 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2148 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.4704 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.5474 | Train Acc: 0.8784
 Site-SynthDigits| Train Loss: 0.1989 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.3022 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0379 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0763 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1569 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1208 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1428 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8937 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7090 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.2304 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2087 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7088 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8379
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2727
 Best site-USPS       | Epoch:28 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9796
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9898
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2599 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.0876 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1749 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1009 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0377 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1980 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.5629 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.5039 | Train Acc: 0.8784
 Site-SynthDigits| Train Loss: 0.1953 | Train Acc: 0.9797
 Site-MNIST-M   | Train Loss: 2.3329 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0404 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0733 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1523 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1124 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1420 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8717 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.7335 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.2500 | Val  Acc: 0.9388
 Site-SynthDigits| Val  Loss: 0.2057 | Val  Acc: 0.9694
 Site-MNIST-M   | Val  Loss: 1.7425 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8314
============ Train epoch 30 ============
 Site-MNIST     | Train Loss: 0.2373 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0943 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2419 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0962 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0333 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1899 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4913 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.5186 | Train Acc: 0.9054
 Site-SynthDigits| Train Loss: 0.1928 | Train Acc: 0.9865
 Site-MNIST-M   | Train Loss: 1.2429 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0687 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1449 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1079 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1323 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8946 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.6997 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.2020 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 0.1808 | Val  Acc: 0.9796
 Site-MNIST-M   | Val  Loss: 1.6954 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8409
 Best site-MNIST      | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:30 | Val Acc: 0.3333
 Best site-USPS       | Epoch:30 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.9592
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.9796
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 31 ============
 Site-MNIST     | Train Loss: 0.2838 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1032 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1932 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0993 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0296 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0288 | Train Acc: 0.6800
 Site-USPS      | Train Loss: 0.4648 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.4815 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.1824 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.5257 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0372 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0623 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1441 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1097 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1287 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8788 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.6849 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1733 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.1675 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7081 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8440
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:31 | Val Acc: 0.3333
 Best site-USPS       | Epoch:31 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.9796
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.9898
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 32 ============
 Site-MNIST     | Train Loss: 0.2613 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0909 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1694 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0964 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0237 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0302 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.4316 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4825 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.1527 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.7500 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0218 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0465 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1356 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1096 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1380 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8431 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.6576 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1604 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1523 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7279 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8470
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:32 | Val Acc: 0.3333
 Best site-USPS       | Epoch:32 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:32 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 33 ============
 Site-MNIST     | Train Loss: 0.2357 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0822 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1534 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0811 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0273 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2512 | Train Acc: 0.6800
 Site-USPS      | Train Loss: 0.5411 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.4470 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.1507 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.6662 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0270 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0471 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1250 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.0927 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1297 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8606 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7153 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1650 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1458 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7590 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8410
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2294 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1008 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1450 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0766 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0239 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4445 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 0.4544 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4166 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.1491 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 2.3981 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0406 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1159 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0894 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1240 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8826 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6595 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1334 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1392 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7720 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8417
============ Train epoch 35 ============
 Site-MNIST     | Train Loss: 0.3400 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.0850 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1550 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0683 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0233 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3130 | Train Acc: 0.7400
 Site-USPS      | Train Loss: 0.4442 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4082 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.1413 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.2530 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0433 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1026 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0772 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1190 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8638 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.7049 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.1435 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1324 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7834 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8443
============ Train epoch 36 ============
 Site-MNIST     | Train Loss: 0.3624 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.0851 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2020 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0707 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0202 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0506 | Train Acc: 0.6800
 Site-USPS      | Train Loss: 0.4207 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4316 | Train Acc: 0.9054
 Site-SynthDigits| Train Loss: 0.1264 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.2196 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0406 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1003 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0779 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1147 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8774 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.6641 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1453 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1248 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7731 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8492
 Best site-MNIST      | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:36 | Val Acc: 0.2727
 Best site-USPS       | Epoch:36 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:36 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 37 ============
 Site-MNIST     | Train Loss: 0.2728 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.0895 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1370 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0614 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0205 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9340 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 0.4488 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3853 | Train Acc: 0.9595
 Site-SynthDigits| Train Loss: 0.1210 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.3061 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0239 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0888 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0678 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1171 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9036 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.7358 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.1488 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1258 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8224 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8434
============ Train epoch 38 ============
 Site-MNIST     | Train Loss: 0.2494 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.0856 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1450 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0632 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0168 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9800 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 0.4075 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.4077 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.1100 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.3957 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0230 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0367 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0913 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0660 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1099 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8906 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.7231 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.1341 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1159 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8243 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8519
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:38 | Val Acc: 0.3333
 Best site-USPS       | Epoch:38 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:38 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2940 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0854 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1741 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0582 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0161 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0399 | Train Acc: 0.7200
 Site-USPS      | Train Loss: 0.4482 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3968 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.1150 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 2.4308 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0228 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0354 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0850 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0627 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1082 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8970 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7036 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.1129 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1024 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8253 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8458
============ Train epoch 40 ============
 Site-MNIST     | Train Loss: 0.2369 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.0924 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1259 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0610 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0175 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1742 | Train Acc: 0.7800
 Site-USPS      | Train Loss: 0.4063 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4124 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.1065 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.2257 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0267 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0386 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0884 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0612 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1032 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9064 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.7112 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.1272 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1056 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8210 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8473
============ Train epoch 41 ============
 Site-MNIST     | Train Loss: 0.2935 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0860 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1272 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0552 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0150 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0798 | Train Acc: 0.7400
 Site-USPS      | Train Loss: 0.3722 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3849 | Train Acc: 0.9054
 Site-SynthDigits| Train Loss: 0.0919 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.1288 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0143 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0262 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0818 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0622 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1010 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8685 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.6988 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.1247 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0978 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8115 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8443
============ Train epoch 42 ============
 Site-MNIST     | Train Loss: 0.2075 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0734 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1148 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0576 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0140 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2673 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 0.4027 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.4114 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.0909 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.4465 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0178 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0897 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0671 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.0923 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8978 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.7306 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1522 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1071 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8463 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8477
============ Train epoch 43 ============
 Site-MNIST     | Train Loss: 0.2875 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0874 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1453 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0517 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0119 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0660 | Train Acc: 0.7400
 Site-USPS      | Train Loss: 0.3863 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3565 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.0891 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.3189 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0264 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0769 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0577 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0892 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8926 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7165 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.1209 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0949 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8740 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8450
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.2077 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.0774 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1185 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0479 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0142 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9077 | Train Acc: 0.7400
 Site-USPS      | Train Loss: 0.3891 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.3249 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.0861 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.5285 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0138 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0748 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0536 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.0973 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8848 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.7556 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.0866 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0841 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8584 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8408
============ Train epoch 45 ============
 Site-MNIST     | Train Loss: 0.2572 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0766 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1725 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0493 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0113 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.8938 | Train Acc: 0.7600
 Site-USPS      | Train Loss: 0.3654 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.3281 | Train Acc: 0.9595
 Site-SynthDigits| Train Loss: 0.0883 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.8505 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0230 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0710 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0518 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0958 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8842 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.7239 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.0890 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0814 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.9073 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8434
============ Train epoch 46 ============
 Site-MNIST     | Train Loss: 0.3930 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.0715 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1200 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0423 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0101 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0453 | Train Acc: 0.7200
 Site-USPS      | Train Loss: 0.3686 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3245 | Train Acc: 0.9595
 Site-SynthDigits| Train Loss: 0.0845 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 2.3742 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0205 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0637 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0454 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0970 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9151 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7545 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.0862 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0808 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.9152 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8335
============ Train epoch 47 ============
 Site-MNIST     | Train Loss: 0.2134 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0659 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1201 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0449 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0110 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1045 | Train Acc: 0.7600
 Site-USPS      | Train Loss: 0.3962 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3386 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.0759 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.7626 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0208 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0662 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0470 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1067 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8838 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.7718 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.0783 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0741 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8786 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8400
============ Train epoch 48 ============
 Site-MNIST     | Train Loss: 0.2690 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0712 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1083 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0462 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9944 | Train Acc: 0.7600
 Site-USPS      | Train Loss: 0.3450 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3385 | Train Acc: 0.9595
 Site-SynthDigits| Train Loss: 0.0770 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.0604 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0200 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0597 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0510 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0847 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9439 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.7121 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.0876 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0770 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8826 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8465
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.2444 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0679 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1093 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0477 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0101 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3568 | Train Acc: 0.8200
 Site-USPS      | Train Loss: 0.3383 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3317 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.0792 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.0708 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0131 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0186 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0716 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0532 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0841 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8792 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.7282 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.0845 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0714 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.9150 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8396
===2023-04-28 13:53:33===
===2023-04-28 13:53:35===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:38 | Test Acc: 0.8750
 Test site-SVHN      | Epoch:38 | Test Acc: 0.2917
 Test site-USPS      | Epoch:38 | Test Acc: 0.8118
 Test site-SynthDigits| Epoch:38 | Test Acc: 0.6276
 Test site-MNIST-M   | Epoch:38 | Test Acc: 0.3229
Average Test Accuracy: 0.5858
===2023-04-29 19:39:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,44,74,148,44,44,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.6961 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.6112 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.5141 | Train Acc: 0.6901
 Site-MNIST     | Train Loss: 1.6210 | Train Acc: 0.6489
 Site-MNIST     | Train Loss: 1.4908 | Train Acc: 0.7627
 Site-SVHN      | Train Loss: 2.2286 | Train Acc: 0.1591
 Site-USPS      | Train Loss: 1.4558 | Train Acc: 0.7432
 Site-USPS      | Train Loss: 1.4245 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 2.1076 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.2163 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 1.4433 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.5923 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.7205 | Val  Acc: 0.6809
 Site-MNIST     | Val  Loss: 1.6419 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.5061 | Val  Acc: 0.7089
 Site-SVHN      | Val  Loss: 2.2652 | Val  Acc: 0.2414
 Site-USPS      | Val  Loss: 1.4389 | Val  Acc: 0.7551
 Site-USPS      | Val  Loss: 1.3933 | Val  Acc: 0.7245
 Site-SynthDigits| Val  Loss: 2.2057 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 2.2323 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5950
 Best site-MNIST      | Epoch:0 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:0 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6809
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7089
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2414
 Best site-USPS       | Epoch:0 | Val Acc: 0.7551
 Best site-USPS       | Epoch:0 | Val Acc: 0.7245
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2414
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 1.4270 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 1.1629 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.1833 | Train Acc: 0.6761
 Site-MNIST     | Train Loss: 1.2358 | Train Acc: 0.6489
 Site-MNIST     | Train Loss: 1.0484 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.1803 | Train Acc: 0.1364
 Site-USPS      | Train Loss: 1.0513 | Train Acc: 0.7568
 Site-USPS      | Train Loss: 1.0033 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 1.9428 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.1891 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 0.9321 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.1010 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.3537 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.2649 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.0826 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.2765 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 1.0070 | Val  Acc: 0.7551
 Site-USPS      | Val  Loss: 0.9845 | Val  Acc: 0.7449
 Site-SynthDigits| Val  Loss: 2.1480 | Val  Acc: 0.3103
 Site-MNIST-M   | Val  Loss: 2.1885 | Val  Acc: 0.1724
Average Valid Accuracy: 0.6059
 Best site-MNIST      | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6596
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1724
 Best site-USPS       | Epoch:1 | Val Acc: 0.7551
 Best site-USPS       | Epoch:1 | Val Acc: 0.7449
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3103
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 1.1002 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 0.9070 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 0.8839 | Train Acc: 0.7183
 Site-MNIST     | Train Loss: 1.0213 | Train Acc: 0.6809
 Site-MNIST     | Train Loss: 0.7620 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.1216 | Train Acc: 0.2045
 Site-USPS      | Train Loss: 0.7409 | Train Acc: 0.8243
 Site-USPS      | Train Loss: 0.7340 | Train Acc: 0.8446
 Site-SynthDigits| Train Loss: 1.9270 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 2.1879 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 0.6082 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8382 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.1531 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.0437 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.8139 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 2.2854 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.7125 | Val  Acc: 0.8367
 Site-USPS      | Val  Loss: 0.6910 | Val  Acc: 0.8367
===2023-04-29 21:26:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,44,74,148,44,44,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.6961 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.6112 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.5141 | Train Acc: 0.6901
 Site-MNIST     | Train Loss: 1.6210 | Train Acc: 0.6489
 Site-MNIST     | Train Loss: 1.4908 | Train Acc: 0.7627
 Site-SVHN      | Train Loss: 2.2286 | Train Acc: 0.1591
 Site-USPS      | Train Loss: 1.4558 | Train Acc: 0.7432
 Site-USPS      | Train Loss: 1.4245 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 2.1076 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.2163 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 1.4433 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.5923 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.7205 | Val  Acc: 0.6809
 Site-MNIST     | Val  Loss: 1.6419 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.5061 | Val  Acc: 0.7089
 Site-SVHN      | Val  Loss: 2.2652 | Val  Acc: 0.2414
 Site-USPS      | Val  Loss: 1.4389 | Val  Acc: 0.7551
 Site-USPS      | Val  Loss: 1.3933 | Val  Acc: 0.7245
 Site-SynthDigits| Val  Loss: 2.2057 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 2.2323 | Val  Acc: 0.2069
Average Valid Accuracy: 0.5950
 Best site-MNIST      | Epoch:0 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:0 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6809
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7089
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2414
 Best site-USPS       | Epoch:0 | Val Acc: 0.7551
 Best site-USPS       | Epoch:0 | Val Acc: 0.7245
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2414
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 1.4270 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 1.1629 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.1833 | Train Acc: 0.6761
 Site-MNIST     | Train Loss: 1.2358 | Train Acc: 0.6489
 Site-MNIST     | Train Loss: 1.0484 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.1803 | Train Acc: 0.1364
 Site-USPS      | Train Loss: 1.0513 | Train Acc: 0.7568
 Site-USPS      | Train Loss: 1.0033 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 1.9428 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.1891 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 0.9321 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.1010 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.3537 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.2649 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.0826 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.2765 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 1.0070 | Val  Acc: 0.7551
 Site-USPS      | Val  Loss: 0.9845 | Val  Acc: 0.7449
 Site-SynthDigits| Val  Loss: 2.1480 | Val  Acc: 0.3103
 Site-MNIST-M   | Val  Loss: 2.1885 | Val  Acc: 0.1724
Average Valid Accuracy: 0.6059
 Best site-MNIST      | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6596
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1724
 Best site-USPS       | Epoch:1 | Val Acc: 0.7551
 Best site-USPS       | Epoch:1 | Val Acc: 0.7449
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3103
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 1.1002 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 0.9070 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 0.8839 | Train Acc: 0.7183
 Site-MNIST     | Train Loss: 1.0213 | Train Acc: 0.6809
 Site-MNIST     | Train Loss: 0.7620 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.1216 | Train Acc: 0.2045
 Site-USPS      | Train Loss: 0.7409 | Train Acc: 0.8243
 Site-USPS      | Train Loss: 0.7340 | Train Acc: 0.8446
 Site-SynthDigits| Train Loss: 1.9270 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 2.1879 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 0.6082 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8382 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.1531 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.0437 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.8139 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 2.2854 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.7125 | Val  Acc: 0.8367
 Site-USPS      | Val  Loss: 0.6910 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 2.1681 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 2.1630 | Val  Acc: 0.2414
Average Valid Accuracy: 0.6186
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6596
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7595
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1724
 Best site-USPS       | Epoch:2 | Val Acc: 0.8367
 Best site-USPS       | Epoch:2 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2414
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 0.8715 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.6121 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.7604 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 0.7794 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 0.6219 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 2.1130 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 0.6109 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.5747 | Train Acc: 0.8851
 Site-SynthDigits| Train Loss: 1.9500 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.0299 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 0.4843 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.6083 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.8380 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 0.8185 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 0.6495 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 2.3221 | Val  Acc: 0.0690
 Site-USPS      | Val  Loss: 0.5142 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.5399 | Val  Acc: 0.8673
 Site-SynthDigits| Val  Loss: 2.1947 | Val  Acc: 0.2069
 Site-MNIST-M   | Val  Loss: 2.0699 | Val  Acc: 0.3448
Average Valid Accuracy: 0.6585
 Best site-MNIST      | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:3 | Val Acc: 0.0690
 Best site-USPS       | Epoch:3 | Val Acc: 0.8571
 Best site-USPS       | Epoch:3 | Val Acc: 0.8673
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2069
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 0.8542 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4525 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.5796 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6230 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.4808 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 2.0665 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 0.5407 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.5199 | Train Acc: 0.9054
 Site-SynthDigits| Train Loss: 1.8658 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9579 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 0.2998 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4486 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.7143 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.6414 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.5073 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.2793 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.4559 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.4675 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 2.1239 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 1.9666 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7122
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1379
 Best site-USPS       | Epoch:4 | Val Acc: 0.8571
 Best site-USPS       | Epoch:4 | Val Acc: 0.8980
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2759
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 0.6901 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.4030 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.5362 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.5688 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.4227 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 2.0283 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 0.4690 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.3839 | Train Acc: 0.9392
 Site-SynthDigits| Train Loss: 1.7481 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9437 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 0.2623 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3925 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.6364 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.5806 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.4430 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.3387 | Val  Acc: 0.1034
 Site-USPS      | Val  Loss: 0.3360 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.3564 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 2.1261 | Val  Acc: 0.2069
 Site-MNIST-M   | Val  Loss: 1.9523 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7053
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 0.6139 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3754 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4391 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4730 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.3203 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 2.0210 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.4325 | Train Acc: 0.8784
 Site-USPS      | Train Loss: 0.3580 | Train Acc: 0.9257
 Site-SynthDigits| Train Loss: 1.7969 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.8999 | Train Acc: 0.3409
 Site-MNIST     | Val  Loss: 0.2282 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3176 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5380 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.5019 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.3801 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.3838 | Val  Acc: 0.0690
 Site-USPS      | Val  Loss: 0.3092 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.3338 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 2.2310 | Val  Acc: 0.2069
 Site-MNIST-M   | Val  Loss: 1.9830 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7110
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 0.4612 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.3100 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4164 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.4287 | Train Acc: 0.8617
 Site-MNIST     | Train Loss: 0.2777 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.9308 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 0.3669 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.2750 | Train Acc: 0.9662
 Site-SynthDigits| Train Loss: 1.7755 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 1.8759 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 0.1352 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2538 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4896 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4520 | Val  Acc: 0.8254
 Site-MNIST     | Val  Loss: 0.3655 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.3379 | Val  Acc: 0.1034
 Site-USPS      | Val  Loss: 0.2395 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.2695 | Val  Acc: 0.9490
 Site-SynthDigits| Val  Loss: 2.2046 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 2.0048 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7138
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8254
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1034
 Best site-USPS       | Epoch:7 | Val Acc: 0.9388
 Best site-USPS       | Epoch:7 | Val Acc: 0.9490
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.2759
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 0.3805 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2279 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.4020 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3707 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.2699 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.9730 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.3413 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2805 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 1.7829 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.8474 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.1356 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2205 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4268 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3863 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.3193 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.4187 | Val  Acc: 0.1034
 Site-USPS      | Val  Loss: 0.2467 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.2642 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 2.1670 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 2.0047 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7248
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1034
 Best site-USPS       | Epoch:8 | Val Acc: 0.9184
 Best site-USPS       | Epoch:8 | Val Acc: 0.9184
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.2414
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4138
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 0.5289 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2114 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.4414 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.3540 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.2268 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.9139 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 0.3067 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.2703 | Train Acc: 0.9527
 Site-SynthDigits| Train Loss: 1.8342 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.7859 | Train Acc: 0.3409
 Site-MNIST     | Val  Loss: 0.1083 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2113 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4242 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3787 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.3187 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.4291 | Val  Acc: 0.1034
 Site-USPS      | Val  Loss: 0.2190 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.2320 | Val  Acc: 0.9388
 Site-SynthDigits| Val  Loss: 2.3164 | Val  Acc: 0.2069
 Site-MNIST-M   | Val  Loss: 1.9520 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7162
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 0.5446 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2317 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.4125 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3748 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.1849 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.8774 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 0.2944 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.2039 | Train Acc: 0.9662
 Site-SynthDigits| Train Loss: 1.6915 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.6836 | Train Acc: 0.4773
 Site-MNIST     | Val  Loss: 0.1092 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2176 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4640 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.3928 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.2845 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.3778 | Val  Acc: 0.1034
 Site-USPS      | Val  Loss: 0.1878 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.1972 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 2.2377 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 1.8561 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7294
 Best site-MNIST      | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:10 | Val Acc: 0.1034
 Best site-USPS       | Epoch:10 | Val Acc: 0.9388
 Best site-USPS       | Epoch:10 | Val Acc: 0.9592
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.2414
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.4483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 0.3484 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1694 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.3390 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.2979 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.1735 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.9297 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 0.2750 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2185 | Train Acc: 0.9662
 Site-SynthDigits| Train Loss: 1.7458 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.7079 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 0.0670 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1432 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3624 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3193 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.2698 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.4722 | Val  Acc: 0.1034
 Site-USPS      | Val  Loss: 0.1872 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.1901 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 2.3585 | Val  Acc: 0.2069
 Site-MNIST-M   | Val  Loss: 1.9664 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7246
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 0.3109 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1445 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.3547 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2703 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.1477 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8602 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 0.2572 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.1550 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 1.7102 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.6333 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 0.0641 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1395 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3356 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2919 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.2458 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.4790 | Val  Acc: 0.1034
 Site-USPS      | Val  Loss: 0.1580 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.1583 | Val  Acc: 0.9694
 Site-SynthDigits| Val  Loss: 2.2787 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 1.9315 | Val  Acc: 0.4483
Average Valid Accuracy: 0.7459
 Best site-MNIST      | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:12 | Val Acc: 0.1034
 Best site-USPS       | Epoch:12 | Val Acc: 0.9592
 Best site-USPS       | Epoch:12 | Val Acc: 0.9694
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.2759
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.4483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 0.4404 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1254 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2862 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2507 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1271 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.8553 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 0.2361 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.1496 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 1.6243 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.6139 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.0776 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1376 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3033 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2705 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2242 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.4396 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.1495 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.1505 | Val  Acc: 0.9694
 Site-SynthDigits| Val  Loss: 2.2209 | Val  Acc: 0.3103
 Site-MNIST-M   | Val  Loss: 1.9591 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7562
 Best site-MNIST      | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:13 | Val Acc: 0.1379
 Best site-USPS       | Epoch:13 | Val Acc: 0.9592
 Best site-USPS       | Epoch:13 | Val Acc: 0.9694
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.3103
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.3793
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.4502 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1120 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2699 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2369 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.1111 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.8540 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.1953 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.1490 | Train Acc: 0.9662
 Site-SynthDigits| Train Loss: 1.7019 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.5923 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.0616 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1019 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2892 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2542 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2237 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.4308 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.1448 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.1395 | Val  Acc: 0.9490
 Site-SynthDigits| Val  Loss: 2.2766 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 1.9676 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7517
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 0.3213 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1054 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2530 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2113 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.1000 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.7979 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 0.1980 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.1216 | Train Acc: 0.9797
 Site-SynthDigits| Train Loss: 1.6708 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.5112 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.0601 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0986 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2525 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2311 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2087 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.4030 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.1149 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.1193 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 2.2994 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 1.9491 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7549
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 0.3199 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0909 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2518 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.1773 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1014 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.7566 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.1824 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.1266 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 1.6111 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.4701 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.0441 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0817 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2252 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1992 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2047 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.4594 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.1061 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.1127 | Val  Acc: 0.9694
 Site-SynthDigits| Val  Loss: 2.3276 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 1.9642 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7560
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 0.2548 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1040 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2271 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1788 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.0905 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.7275 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.1727 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.1095 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 1.6350 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.4838 | Train Acc: 0.4773
 Site-MNIST     | Val  Loss: 0.0497 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0793 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2083 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1989 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.1985 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.4286 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.1010 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0997 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 2.3213 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 2.0308 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7583
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:17 | Val Acc: 0.1724
 Best site-USPS       | Epoch:17 | Val Acc: 0.9796
 Best site-USPS       | Epoch:17 | Val Acc: 0.9796
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.2759
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.3448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 0.2396 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0739 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2328 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1687 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.0697 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.7060 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.1596 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.1248 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 1.5500 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.4405 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0682 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2066 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1881 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.1899 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3987 | Val  Acc: 0.2069
 Site-USPS      | Val  Loss: 0.1006 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0959 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 2.2814 | Val  Acc: 0.3103
 Site-MNIST-M   | Val  Loss: 1.9881 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7662
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:18 | Val Acc: 0.2069
 Best site-USPS       | Epoch:18 | Val Acc: 0.9796
 Best site-USPS       | Epoch:18 | Val Acc: 0.9796
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.3103
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.3793
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.2996 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0698 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2197 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1412 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.0622 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.7010 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.1606 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.1002 | Train Acc: 0.9662
 Site-SynthDigits| Train Loss: 1.5555 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.4026 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.0251 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0573 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1779 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1613 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1902 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.4264 | Val  Acc: 0.2069
 Site-USPS      | Val  Loss: 0.0979 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.0954 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 2.3282 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 2.0017 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7607
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 0.3962 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0652 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2223 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1488 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.0631 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.7066 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.1545 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.0987 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 1.5582 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.4353 | Train Acc: 0.4773
 Site-MNIST     | Val  Loss: 0.0337 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0574 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1668 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1574 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1694 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.4147 | Val  Acc: 0.2069
 Site-USPS      | Val  Loss: 0.0937 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0898 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 2.3316 | Val  Acc: 0.2069
 Site-MNIST-M   | Val  Loss: 2.0033 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7599
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 0.2237 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0640 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2183 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1407 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.0583 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.6658 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.1419 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.0777 | Train Acc: 0.9797
 Site-SynthDigits| Train Loss: 1.4485 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.3701 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 0.0336 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0688 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1796 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1540 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.1613 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.3553 | Val  Acc: 0.2414
 Site-USPS      | Val  Loss: 0.0739 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0736 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 2.3283 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 1.9854 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7734
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:21 | Val Acc: 0.2414
 Best site-USPS       | Epoch:21 | Val Acc: 0.9796
 Best site-USPS       | Epoch:21 | Val Acc: 0.9796
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.3793
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 0.4091 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0615 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1887 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1288 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.0501 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.6431 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.1404 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.0676 | Train Acc: 0.9865
 Site-SynthDigits| Train Loss: 1.4671 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.3608 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.0328 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0539 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1546 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1483 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.1477 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3838 | Val  Acc: 0.2069
 Site-USPS      | Val  Loss: 0.0664 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0652 | Val  Acc: 0.9898
 Site-SynthDigits| Val  Loss: 2.3235 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 2.0265 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7695
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 0.2159 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0586 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2229 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1304 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.0506 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.6289 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.1199 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.0687 | Train Acc: 0.9865
 Site-SynthDigits| Train Loss: 1.4244 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.2723 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.0284 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0539 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1676 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1445 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.1507 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.3761 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0654 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0613 | Val  Acc: 0.9898
 Site-SynthDigits| Val  Loss: 2.2962 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 2.0079 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7708
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4674 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0553 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1894 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1161 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.0441 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5975 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.1393 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.0616 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.4357 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.2390 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.0240 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0460 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1399 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1331 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.1513 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.4169 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0568 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0613 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3245 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 1.9977 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7693
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 0.1994 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0459 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1880 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1300 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.0431 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.5733 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.1091 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0506 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.4462 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.2361 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0436 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1570 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1473 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.1404 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3831 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0514 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0508 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2532 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.0052 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7758
 Best site-MNIST      | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:25 | Val Acc: 0.1724
 Best site-USPS       | Epoch:25 | Val Acc: 1.0000
 Best site-USPS       | Epoch:25 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.4138
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 0.4030 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0494 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1676 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1031 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0335 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5883 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.1270 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.0596 | Train Acc: 0.9932
 Site-SynthDigits| Train Loss: 1.4377 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.2389 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.0234 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0374 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1259 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1183 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1349 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3682 | Val  Acc: 0.2069
 Site-USPS      | Val  Loss: 0.0583 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0564 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2901 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 1.9929 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7774
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:26 | Val Acc: 0.2069
 Best site-USPS       | Epoch:26 | Val Acc: 1.0000
 Best site-USPS       | Epoch:26 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.2759
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.3793
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 0.2085 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0399 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1802 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.0912 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0282 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5058 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.1151 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.0633 | Train Acc: 0.9865
 Site-SynthDigits| Train Loss: 1.3501 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.2720 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.0212 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1125 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1042 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1354 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.3398 | Val  Acc: 0.2069
 Site-USPS      | Val  Loss: 0.0552 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0544 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2824 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.0271 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7831
 Best site-MNIST      | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:27 | Val Acc: 0.2069
 Best site-USPS       | Epoch:27 | Val Acc: 1.0000
 Best site-USPS       | Epoch:27 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.3793
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 0.1954 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0388 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1792 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1044 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0322 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5150 | Train Acc: 0.5682
 Site-USPS      | Train Loss: 0.1026 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0542 | Train Acc: 0.9865
 Site-SynthDigits| Train Loss: 1.3368 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.2153 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 0.0245 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1351 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1143 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1306 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3520 | Val  Acc: 0.2069
 Site-USPS      | Val  Loss: 0.0485 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0447 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2546 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.0378 | Val  Acc: 0.4138
Average Valid Accuracy: 0.7856
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2069
 Best site-USPS       | Epoch:28 | Val Acc: 1.0000
 Best site-USPS       | Epoch:28 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.4138
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1965 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0358 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1681 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.0990 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.0339 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5181 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.0953 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.0445 | Train Acc: 0.9932
 Site-SynthDigits| Train Loss: 1.4219 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.1791 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0292 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1224 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1163 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1390 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.4186 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0472 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0428 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2691 | Val  Acc: 0.3103
 Site-MNIST-M   | Val  Loss: 2.0740 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7687
============ Train epoch 30 ============
 Site-MNIST     | Train Loss: 0.2323 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0368 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1657 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1294 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.0333 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.4944 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.0833 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0399 | Train Acc: 0.9932
 Site-SynthDigits| Train Loss: 1.2816 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.1349 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0375 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1660 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1426 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.1247 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.3364 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0466 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0390 | Val  Acc: 0.9898
 Site-SynthDigits| Val  Loss: 2.2588 | Val  Acc: 0.4138
 Site-MNIST-M   | Val  Loss: 2.0874 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7735
============ Train epoch 31 ============
 Site-MNIST     | Train Loss: 0.2078 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0400 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1495 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1096 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.0299 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4775 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.0763 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0300 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2778 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.1197 | Train Acc: 0.6591
 Site-MNIST     | Val  Loss: 0.0153 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1420 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1268 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.1234 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.3857 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0297 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3508 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.0815 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7744
============ Train epoch 32 ============
 Site-MNIST     | Train Loss: 0.2098 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0300 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1674 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.0969 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.0264 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.4518 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.0739 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0325 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.3124 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.1128 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.0139 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0314 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1262 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1158 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.1240 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.4004 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0354 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0321 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3555 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.0860 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7740
============ Train epoch 33 ============
 Site-MNIST     | Train Loss: 0.3692 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0370 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2204 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0823 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0243 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4527 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.0781 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0316 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2829 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.0908 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0261 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1101 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.0941 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1132 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.4084 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0327 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3061 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.0981 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7813
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2067 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0282 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2136 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.0794 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0211 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4598 | Train Acc: 0.5682
 Site-USPS      | Train Loss: 0.0770 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0323 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.3013 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.0951 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0291 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1077 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.0912 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1161 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.4151 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0343 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0318 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3241 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 2.0776 | Val  Acc: 0.3793
Average Valid Accuracy: 0.7681
============ Train epoch 35 ============
 Site-MNIST     | Train Loss: 0.1932 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0353 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1831 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.0815 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0222 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4520 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.0756 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0284 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2825 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.0739 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.0161 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1046 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0872 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1134 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.4218 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0294 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2959 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.1211 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7768
============ Train epoch 36 ============
 Site-MNIST     | Train Loss: 0.1993 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0339 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1471 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0850 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0213 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4425 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.0715 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0227 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2287 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.0906 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0305 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0966 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0974 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.0895 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.4185 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0278 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0242 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3280 | Val  Acc: 0.3793
 Site-MNIST-M   | Val  Loss: 2.1455 | Val  Acc: 0.3103
Average Valid Accuracy: 0.7765
============ Train epoch 37 ============
 Site-MNIST     | Train Loss: 0.4240 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0254 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1441 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.0694 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0181 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4016 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.0774 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0273 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2546 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.0602 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.0202 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0303 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0909 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0746 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1109 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3639 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0316 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0284 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2412 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.1664 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7740
============ Train epoch 38 ============
 Site-MNIST     | Train Loss: 0.3946 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0336 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1164 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0820 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0179 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3859 | Train Acc: 0.5682
 Site-USPS      | Train Loss: 0.0620 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0210 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2632 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.0664 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0174 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0247 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0879 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0933 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.0917 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.3824 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0226 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0194 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3475 | Val  Acc: 0.3103
 Site-MNIST-M   | Val  Loss: 2.1388 | Val  Acc: 0.3103
Average Valid Accuracy: 0.7702
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.3720 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0244 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1142 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0750 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0165 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4320 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 0.0767 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0253 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2261 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.0287 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0238 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0970 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0752 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0942 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.4066 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0245 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0221 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2933 | Val  Acc: 0.3793
 Site-MNIST-M   | Val  Loss: 2.1448 | Val  Acc: 0.3103
Average Valid Accuracy: 0.7781
============ Train epoch 40 ============
 Site-MNIST     | Train Loss: 0.3989 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0302 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1389 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0688 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0144 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3923 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 0.0627 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0228 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2694 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.0244 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.0083 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0144 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0908 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0777 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.0986 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.4280 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0233 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3095 | Val  Acc: 0.3103
 Site-MNIST-M   | Val  Loss: 2.1508 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7715
============ Train epoch 41 ============
 Site-MNIST     | Train Loss: 0.3797 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0250 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1353 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.0676 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0131 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3848 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.0681 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0241 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2750 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.0207 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0207 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0832 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0786 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.0908 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.4625 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0179 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0171 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3678 | Val  Acc: 0.3103
 Site-MNIST-M   | Val  Loss: 2.1223 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7752
============ Train epoch 42 ============
 Site-MNIST     | Train Loss: 0.3668 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0250 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1266 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0686 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0146 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3600 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.0869 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0248 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2810 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.0346 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.0193 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0871 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0783 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0808 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.4211 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0228 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0195 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3241 | Val  Acc: 0.3103
 Site-MNIST-M   | Val  Loss: 2.1465 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7768
============ Train epoch 43 ============
 Site-MNIST     | Train Loss: 0.1892 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0192 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1348 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0718 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0154 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3511 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.0691 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0208 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2206 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 0.9833 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.0190 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0216 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0859 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0825 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.0820 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.3783 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0180 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2728 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.1171 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7749
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4212 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0255 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0990 | Train Acc: 0.9859
 Site-MNIST     | Train Loss: 0.0647 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.0122 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3492 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.0641 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0180 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2480 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.0142 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0158 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0204 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0718 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.0786 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.0841 | Val  Acc: 0.9873
 Site-SVHN      | Val  Loss: 2.3919 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0153 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0144 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3022 | Val  Acc: 0.3793
 Site-MNIST-M   | Val  Loss: 2.1691 | Val  Acc: 0.2759
Average Valid Accuracy: 0.7712
============ Train epoch 45 ============
 Site-MNIST     | Train Loss: 0.2049 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0239 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0881 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0721 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0146 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3530 | Train Acc: 0.5682
 Site-USPS      | Train Loss: 0.0652 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0194 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2149 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.0046 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0236 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0736 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0879 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.0732 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.4139 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0176 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.3095 | Val  Acc: 0.3793
 Site-MNIST-M   | Val  Loss: 2.1364 | Val  Acc: 0.3103
Average Valid Accuracy: 0.7786
============ Train epoch 46 ============
 Site-MNIST     | Train Loss: 0.2301 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0198 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0791 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0815 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.0141 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3088 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.0732 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0150 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.1821 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 0.9458 | Train Acc: 0.7500
 Site-MNIST     | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0916 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1008 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.0715 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.3849 | Val  Acc: 0.1379
 Site-USPS      | Val  Loss: 0.0158 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2598 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.1205 | Val  Acc: 0.3103
Average Valid Accuracy: 0.7678
============ Train epoch 47 ============
 Site-MNIST     | Train Loss: 0.2332 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0234 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1046 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0545 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0151 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3167 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.0595 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0143 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.1670 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 0.9577 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0568 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0628 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.0927 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.3825 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0128 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2820 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.1773 | Val  Acc: 0.3448
Average Valid Accuracy: 0.7808
============ Train epoch 48 ============
 Site-MNIST     | Train Loss: 0.2057 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0249 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0998 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0562 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0119 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3171 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.0589 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0175 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.1585 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 0.9359 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0182 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0187 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0661 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0652 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0855 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.3749 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0150 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2828 | Val  Acc: 0.3793
 Site-MNIST-M   | Val  Loss: 2.1423 | Val  Acc: 0.3103
Average Valid Accuracy: 0.7824
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3913 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0236 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0959 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0573 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0138 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3344 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.0607 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.0195 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.2187 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 0.9289 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0172 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0722 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0660 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0827 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.3780 | Val  Acc: 0.1724
 Site-USPS      | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0134 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 2.2651 | Val  Acc: 0.3793
 Site-MNIST-M   | Val  Loss: 2.2050 | Val  Acc: 0.3103
Average Valid Accuracy: 0.7824
===2023-04-29 22:18:46===
===2023-04-29 22:18:48===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,44,74,148,44,44,]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:28 | Test Acc: 0.8900
 Test site-SVHN      | Epoch:28 | Test Acc: 0.1924
 Test site-USPS      | Epoch:28 | Test Acc: 0.9247
 Test site-SynthDigits| Epoch:28 | Test Acc: 0.3535
 Test site-MNIST-M   | Epoch:28 | Test Acc: 0.3414
Average Test Accuracy: 0.5404
