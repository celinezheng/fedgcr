===2023-04-22 23:50:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.8902 | Train Acc: 0.4348
 Site-MNIST     | Train Loss: 1.8390 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 1.7865 | Train Acc: 0.5634
 Site-MNIST     | Train Loss: 1.8097 | Train Acc: 0.5851
 Site-MNIST     | Train Loss: 1.7116 | Train Acc: 0.6695
 Site-SVHN      | Train Loss: 2.2046 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.8068 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.1115 | Train Acc: 0.3108
 Site-SynthDigits| Train Loss: 2.0809 | Train Acc: 0.3176
 Site-MNIST-M   | Train Loss: 2.2805 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 1.7274 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.8090 | Val  Acc: 0.6774
 Site-MNIST     | Val  Loss: 1.8738 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.8172 | Val  Acc: 0.5873
 Site-MNIST     | Val  Loss: 1.7453 | Val  Acc: 0.5823
 Site-SVHN      | Val  Loss: 2.1837 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.8329 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.1210 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.0769 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.2479 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4849
 Best site-MNIST      | Epoch:0 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6774
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5745
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5873
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5823
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2424
 Best site-USPS       | Epoch:0 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2653
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3061
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 1.4970 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.3753 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.4137 | Train Acc: 0.6901
 Site-MNIST     | Train Loss: 1.4210 | Train Acc: 0.7128
 Site-MNIST     | Train Loss: 1.2830 | Train Acc: 0.8051
 Site-SVHN      | Train Loss: 2.0956 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.4401 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.8679 | Train Acc: 0.4459
 Site-SynthDigits| Train Loss: 1.8443 | Train Acc: 0.4527
 Site-MNIST-M   | Train Loss: 2.1406 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 1.2707 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.3752 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.4745 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.4352 | Val  Acc: 0.6825
 Site-MNIST     | Val  Loss: 1.3154 | Val  Acc: 0.6835
 Site-SVHN      | Val  Loss: 2.0630 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.5855 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 1.9859 | Val  Acc: 0.4286
 Site-SynthDigits| Val  Loss: 1.8706 | Val  Acc: 0.4796
 Site-MNIST-M   | Val  Loss: 2.2019 | Val  Acc: 0.2727
Average Valid Accuracy: 0.5697
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7234
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6825
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6835
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3030
 Best site-USPS       | Epoch:1 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4286
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4796
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 1.2234 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 1.0200 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.0864 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.1385 | Train Acc: 0.7340
 Site-MNIST     | Train Loss: 0.9404 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 2.0334 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.2170 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.6998 | Train Acc: 0.5270
 Site-SynthDigits| Train Loss: 1.6587 | Train Acc: 0.5135
 Site-MNIST-M   | Train Loss: 2.1418 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.9574 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.0669 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.2057 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.1640 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 0.9812 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 2.0117 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.3660 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.7573 | Val  Acc: 0.5102
 Site-SynthDigits| Val  Loss: 1.6664 | Val  Acc: 0.5510
 Site-MNIST-M   | Val  Loss: 2.1402 | Val  Acc: 0.2727
Average Valid Accuracy: 0.6168
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7234
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2727
 Best site-USPS       | Epoch:2 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5102
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5510
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 1.1615 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.8073 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.8655 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.9486 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 0.7587 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 2.0096 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 1.0685 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.5314 | Train Acc: 0.5541
 Site-SynthDigits| Train Loss: 1.4384 | Train Acc: 0.6081
 Site-MNIST-M   | Train Loss: 2.0667 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 0.7876 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.8709 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.9966 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 0.9696 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.7915 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.9582 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.2087 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.5764 | Val  Acc: 0.6939
 Site-SynthDigits| Val  Loss: 1.4809 | Val  Acc: 0.6429
 Site-MNIST-M   | Val  Loss: 2.0960 | Val  Acc: 0.3182
Average Valid Accuracy: 0.6789
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3939
 Best site-USPS       | Epoch:3 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6939
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6429
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 0.7914 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5818 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.6985 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.7746 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.6272 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.9934 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 0.9464 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.4160 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 1.3668 | Train Acc: 0.6622
 Site-MNIST-M   | Train Loss: 1.9971 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.5874 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6765 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.7938 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.8028 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.6683 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.9385 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.0932 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.5509 | Val  Acc: 0.6735
 Site-SynthDigits| Val  Loss: 1.3869 | Val  Acc: 0.6735
 Site-MNIST-M   | Val  Loss: 2.0661 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7133
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3636
 Best site-USPS       | Epoch:4 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6735
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6735
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 0.6901 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.4755 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5819 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.6401 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.4782 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.9592 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 0.8734 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.3355 | Train Acc: 0.6351
 Site-SynthDigits| Train Loss: 1.2550 | Train Acc: 0.6959
 Site-MNIST-M   | Train Loss: 1.7630 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.4478 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5457 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6750 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.6736 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.5554 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.8191 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.0001 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.4648 | Val  Acc: 0.7551
 Site-SynthDigits| Val  Loss: 1.2924 | Val  Acc: 0.7143
 Site-MNIST-M   | Val  Loss: 2.0330 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7390
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2727
 Best site-USPS       | Epoch:5 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7551
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7143
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 0.6680 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.4260 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.5215 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5691 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.4075 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.7531 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 0.7983 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.2517 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 1.1255 | Train Acc: 0.7230
 Site-MNIST-M   | Train Loss: 1.7809 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.3809 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4779 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.6356 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.5886 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.4679 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.7611 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.9102 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.3375 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.1740 | Val  Acc: 0.7551
 Site-MNIST-M   | Val  Loss: 1.9460 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7604
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2727
 Best site-USPS       | Epoch:6 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7551
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 0.6004 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.3724 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5287 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4782 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3404 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.9029 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 0.7718 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.2051 | Train Acc: 0.6892
 Site-SynthDigits| Train Loss: 1.0912 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.7577 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.3099 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3923 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5280 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5113 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.4251 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7682 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.8824 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.2119 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 1.1162 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.9741 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7624
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2424
 Best site-USPS       | Epoch:7 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7755
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 0.4763 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3111 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4463 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4153 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3003 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8238 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 0.8394 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.1070 | Train Acc: 0.6622
 Site-SynthDigits| Train Loss: 1.0057 | Train Acc: 0.7703
 Site-MNIST-M   | Train Loss: 1.8299 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.2280 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3096 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4635 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.4491 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.3882 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.7166 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.8319 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0311 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.9759 | Val  Acc: 0.8061
 Site-MNIST-M   | Val  Loss: 1.8729 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7793
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2424
 Best site-USPS       | Epoch:8 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8061
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 0.4480 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.2926 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4520 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3931 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.2556 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.7049 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.7093 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.0659 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 0.9572 | Train Acc: 0.7905
 Site-MNIST-M   | Train Loss: 1.5602 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.1658 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2888 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4591 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.4080 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.3461 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7392 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.7797 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0138 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.9344 | Val  Acc: 0.8265
 Site-MNIST-M   | Val  Loss: 1.8876 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7839
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2424
 Best site-USPS       | Epoch:9 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8265
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 0.5157 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2559 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3638 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3410 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.2278 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8086 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.7697 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0277 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 0.8643 | Train Acc: 0.7770
 Site-MNIST-M   | Train Loss: 1.6973 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.1549 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2427 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3926 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3564 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.3294 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7380 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.7587 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0092 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.8779 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.8531 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7830
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 0.4088 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.2394 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.4028 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3263 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1950 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.7147 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.6541 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0186 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 0.8266 | Train Acc: 0.8311
 Site-MNIST-M   | Train Loss: 1.6371 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.1806 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2454 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.3854 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.3455 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2984 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.7408 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.7308 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.8879 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 0.8195 | Val  Acc: 0.8673
 Site-MNIST-M   | Val  Loss: 1.8467 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7947
 Best site-MNIST      | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2121
 Best site-USPS       | Epoch:11 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.8980
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.8673
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 0.3263 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2116 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.3390 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2969 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1989 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.6605 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.6721 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9051 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.7761 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 1.7159 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.1450 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2242 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3658 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.3030 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2764 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7459 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.7163 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7899 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 0.7173 | Val  Acc: 0.8673
 Site-MNIST-M   | Val  Loss: 1.8502 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8017
 Best site-MNIST      | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2424
 Best site-USPS       | Epoch:12 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.8980
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.8673
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 0.3281 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.2175 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3222 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2600 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1559 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.4323 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.6049 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.8920 | Train Acc: 0.7162
 Site-SynthDigits| Train Loss: 0.7062 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 1.6985 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.1151 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1841 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3022 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2718 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2575 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 1.7743 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6772 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7408 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 0.6817 | Val  Acc: 0.8469
 Site-MNIST-M   | Val  Loss: 1.8086 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8032
 Best site-MNIST      | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:13 | Val Acc: 0.2121
 Best site-USPS       | Epoch:13 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.8980
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.8469
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.3268 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1954 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2992 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2529 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1400 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.6509 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5798 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.8942 | Train Acc: 0.7162
 Site-SynthDigits| Train Loss: 0.6419 | Train Acc: 0.8243
 Site-MNIST-M   | Train Loss: 1.8884 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.1133 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1920 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3053 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2577 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2429 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 1.7172 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.6850 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7416 | Val  Acc: 0.8980
 Site-SynthDigits| Val  Loss: 0.6624 | Val  Acc: 0.8571
 Site-MNIST-M   | Val  Loss: 1.8083 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8148
 Best site-MNIST      | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:14 | Val Acc: 0.2727
 Best site-USPS       | Epoch:14 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.8980
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.8571
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 0.3494 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1983 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2772 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2326 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1380 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.5572 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 0.5944 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.8500 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.5483 | Train Acc: 0.8649
 Site-MNIST-M   | Train Loss: 1.6214 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.1128 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1788 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2840 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2333 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2302 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.6832 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6417 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.6559 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.5787 | Val  Acc: 0.8776
 Site-MNIST-M   | Val  Loss: 1.7246 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8137
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 0.2897 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1798 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2583 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2085 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1128 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.7892 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5700 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8124 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.5897 | Train Acc: 0.8986
 Site-MNIST-M   | Train Loss: 1.3272 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0951 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1652 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2671 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2103 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2169 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.7231 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6357 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6602 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.5610 | Val  Acc: 0.9082
 Site-MNIST-M   | Val  Loss: 1.7396 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8172
 Best site-MNIST      | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:16 | Val Acc: 0.2121
 Best site-USPS       | Epoch:16 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.9184
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.9082
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 0.3469 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1727 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2426 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1958 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0992 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.5660 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.5635 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.7849 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.5087 | Train Acc: 0.9122
 Site-MNIST-M   | Train Loss: 1.3941 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1430 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2445 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2003 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2076 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.7604 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6138 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6183 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.5210 | Val  Acc: 0.9184
 Site-MNIST-M   | Val  Loss: 1.7447 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8198
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:17 | Val Acc: 0.2121
 Best site-USPS       | Epoch:17 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.9184
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.9184
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 0.2685 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.1462 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2780 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1743 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0952 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.3867 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5577 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.7578 | Train Acc: 0.7973
 Site-SynthDigits| Train Loss: 0.4701 | Train Acc: 0.9189
 Site-MNIST-M   | Train Loss: 1.9503 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.0762 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1319 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2255 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1854 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2076 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 1.7467 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.6574 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6372 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.5031 | Val  Acc: 0.9286
 Site-MNIST-M   | Val  Loss: 1.7498 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8271
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3333
 Best site-USPS       | Epoch:18 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.9184
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.9286
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.3416 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1487 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2947 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1817 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0806 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.6824 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.5331 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.7295 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.4484 | Train Acc: 0.9324
 Site-MNIST-M   | Train Loss: 1.1488 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0721 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1305 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2369 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1781 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1972 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.7467 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6466 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.4766 | Val  Acc: 0.9184
 Site-SynthDigits| Val  Loss: 0.4212 | Val  Acc: 0.9490
 Site-MNIST-M   | Val  Loss: 1.6977 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8255
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 0.2590 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1580 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.2896 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1893 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.0812 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5707 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.5707 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.7328 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.4127 | Train Acc: 0.9527
 Site-MNIST-M   | Train Loss: 1.6190 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0778 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1431 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2456 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1889 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1821 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.7460 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6137 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.4430 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 0.3927 | Val  Acc: 0.9694
 Site-MNIST-M   | Val  Loss: 1.7394 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8284
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9620
 Best site-SVHN       | Epoch:20 | Val Acc: 0.2121
 Best site-USPS       | Epoch:20 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.9592
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.9694
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 0.3296 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1438 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2676 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1674 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.0759 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.5366 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.5579 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.7317 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.3673 | Train Acc: 0.9595
 Site-MNIST-M   | Train Loss: 1.3359 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.0469 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1104 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2196 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1697 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1866 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.7477 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6506 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3994 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 0.3689 | Val  Acc: 0.9694
 Site-MNIST-M   | Val  Loss: 1.6689 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8246
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 0.2354 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1411 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.3131 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1505 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0658 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.5243 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.5805 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.6285 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.3452 | Train Acc: 0.9865
 Site-MNIST-M   | Train Loss: 1.4019 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0572 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1042 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1963 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1542 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1872 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.7560 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6421 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3529 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.3385 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7061 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8406
 Best site-MNIST      | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:22 | Val Acc: 0.2424
 Best site-USPS       | Epoch:22 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.9796
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.9898
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 0.2637 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1402 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2337 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1467 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0562 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6360 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.5472 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.6245 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.3446 | Train Acc: 0.9459
 Site-MNIST-M   | Train Loss: 1.3694 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0564 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1058 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1872 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1528 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1739 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.7639 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6329 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3550 | Val  Acc: 0.9592
 Site-SynthDigits| Val  Loss: 0.3340 | Val  Acc: 0.9694
 Site-MNIST-M   | Val  Loss: 1.7390 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8336
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2186 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1247 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2622 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1487 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.0654 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3588 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.5314 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.5951 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.2994 | Train Acc: 0.9797
 Site-MNIST-M   | Train Loss: 1.8431 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0512 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1068 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1897 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1501 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1654 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8254 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6354 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3118 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2986 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7338 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8264
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 0.3204 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1306 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2858 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1277 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0473 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3432 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.5045 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5536 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.3401 | Train Acc: 0.9730
 Site-MNIST-M   | Train Loss: 2.2189 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.0311 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0774 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1636 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1341 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1693 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8369 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5699 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.3049 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2866 | Val  Acc: 0.9796
 Site-MNIST-M   | Val  Loss: 1.7502 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8346
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 0.2840 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1164 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2035 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1127 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0412 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4478 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4763 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5607 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.2996 | Train Acc: 0.9797
 Site-MNIST-M   | Train Loss: 1.6165 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0304 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0713 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1439 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1218 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1645 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.8300 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5933 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.2887 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2713 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7507 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8343
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 0.2845 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1202 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1983 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1283 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0441 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5915 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.4596 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5580 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.2616 | Train Acc: 0.9865
 Site-MNIST-M   | Train Loss: 1.0558 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0350 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0785 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1637 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1287 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1518 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.8291 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5828 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.2461 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2381 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7328 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8343
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 0.2267 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1055 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2058 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1130 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0384 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5006 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.4638 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.5187 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.2519 | Train Acc: 0.9797
 Site-MNIST-M   | Train Loss: 1.3651 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0268 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0687 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1494 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1149 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1445 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9083 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6317 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.2594 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2298 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7478 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8438
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2121
 Best site-USPS       | Epoch:28 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9796
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9898
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2033 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1219 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1893 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1123 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3376 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.4654 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5093 | Train Acc: 0.8514
 Site-SynthDigits| Train Loss: 0.2192 | Train Acc: 0.9797
 Site-MNIST-M   | Train Loss: 1.5210 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0634 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1404 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1123 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1533 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.7872 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6391 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.2026 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.2072 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7714 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8380
============ Train epoch 30 ============
 Site-MNIST     | Train Loss: 0.2389 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1003 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1801 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.0990 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.0307 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4217 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4709 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.5229 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.2451 | Train Acc: 0.9865
 Site-MNIST-M   | Train Loss: 1.3130 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0627 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1224 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1042 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1462 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 1.8592 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6269 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1835 | Val  Acc: 0.9796
 Site-SynthDigits| Val  Loss: 0.1979 | Val  Acc: 0.9898
 Site-MNIST-M   | Val  Loss: 1.7471 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8373
============ Train epoch 31 ============
 Site-MNIST     | Train Loss: 0.2406 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1018 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1803 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0923 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0338 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4291 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.4224 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4795 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.1942 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.2944 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.0294 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0579 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1194 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0995 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1439 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8995 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 0.6098 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1756 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1800 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7956 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8363
============ Train epoch 32 ============
 Site-MNIST     | Train Loss: 0.1704 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1083 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.1792 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.1001 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0296 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5372 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4475 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4986 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.2040 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.2381 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0638 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1292 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1039 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1330 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8566 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5816 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1621 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1706 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7941 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8423
============ Train epoch 33 ============
 Site-MNIST     | Train Loss: 0.2605 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1031 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1606 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0879 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0239 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5291 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4198 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4843 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.1829 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.7447 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0244 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0602 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1172 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0879 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1391 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8735 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.5993 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1383 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1552 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7487 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8393
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1786 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0978 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1613 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0901 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0208 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4418 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4357 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4478 | Train Acc: 0.9054
 Site-SynthDigits| Train Loss: 0.1554 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.0764 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0184 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0546 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1171 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0898 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1322 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8771 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 0.6304 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1475 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1466 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7603 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8363
============ Train epoch 35 ============
 Site-MNIST     | Train Loss: 0.1968 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0842 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1796 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0778 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0238 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4427 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4611 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4723 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.1479 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.1429 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0170 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0458 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1022 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0821 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1389 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8865 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.6233 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1583 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1406 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7803 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8454
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:35 | Val Acc: 0.2424
 Best site-USPS       | Epoch:35 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:35 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 36 ============
 Site-MNIST     | Train Loss: 0.2977 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0841 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1626 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0769 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0192 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3197 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.4197 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.4468 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.1667 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.4198 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0560 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1044 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0757 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1343 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.8742 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5811 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.1188 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1349 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7452 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8389
============ Train epoch 37 ============
 Site-MNIST     | Train Loss: 0.1751 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0818 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1517 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0820 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0206 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2862 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.4372 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4264 | Train Acc: 0.9054
 Site-SynthDigits| Train Loss: 0.1326 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.4171 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0509 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1031 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0845 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1254 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9322 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.5837 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1398 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1288 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8067 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8408
============ Train epoch 38 ============
 Site-MNIST     | Train Loss: 0.2066 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0908 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1889 | Train Acc: 0.9577
 Site-MNIST     | Train Loss: 0.0907 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0195 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2811 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.4336 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4261 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.1311 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.2777 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.0175 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0424 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1099 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0953 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1246 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9217 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5817 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1252 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1160 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7989 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8469
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2121
 Best site-USPS       | Epoch:38 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:38 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1953 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0717 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1524 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0673 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0161 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2373 | Train Acc: 0.6800
 Site-USPS      | Train Loss: 0.4927 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4136 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.1137 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.5565 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0134 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0845 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0725 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1325 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0133 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6642 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1302 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1124 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7634 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8469
============ Train epoch 40 ============
 Site-MNIST     | Train Loss: 0.2318 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0951 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1663 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0610 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.0948 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4259 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.4003 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.1167 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.3112 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.0104 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0333 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0774 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0633 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1340 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9589 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5711 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1092 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.1087 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8114 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8423
============ Train epoch 41 ============
 Site-MNIST     | Train Loss: 0.2272 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0909 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1643 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0566 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0144 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1638 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4282 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.4294 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.1015 | Train Acc: 0.9932
 Site-MNIST-M   | Train Loss: 1.0854 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0714 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0583 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1272 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0089 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5909 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0978 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0967 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.7779 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8469
============ Train epoch 42 ============
 Site-MNIST     | Train Loss: 0.2707 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0792 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1690 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0733 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0145 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1213 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.3977 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3806 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.1007 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.1127 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0448 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0944 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0722 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1165 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9719 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.5979 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1085 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0953 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8916 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8454
============ Train epoch 43 ============
 Site-MNIST     | Train Loss: 0.2274 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0919 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1495 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0710 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3220 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.4054 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3832 | Train Acc: 0.9595
 Site-SynthDigits| Train Loss: 0.0980 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.3906 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0388 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0909 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0719 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1141 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9707 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5387 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0992 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0952 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8991 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8378
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.2007 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0819 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1996 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0587 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0115 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1513 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.3765 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3561 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.0905 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.2219 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.0075 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0727 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0608 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1172 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 1.9953 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6041 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1014 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0918 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8660 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8393
============ Train epoch 45 ============
 Site-MNIST     | Train Loss: 0.3004 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0778 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1359 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0555 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0123 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3048 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.3936 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3429 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.0832 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.0161 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0281 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0731 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0577 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1145 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0190 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5655 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.1000 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0851 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8497 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8423
============ Train epoch 46 ============
 Site-MNIST     | Train Loss: 0.2023 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0846 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1850 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0577 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0127 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2489 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.3764 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3355 | Train Acc: 0.9324
 Site-SynthDigits| Train Loss: 0.0836 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.2930 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0331 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0595 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1037 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0484 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.5976 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0872 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0780 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8314 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8423
============ Train epoch 47 ============
 Site-MNIST     | Train Loss: 0.2234 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0708 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1299 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0569 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0132 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2892 | Train Acc: 0.6600
 Site-USPS      | Train Loss: 0.3992 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3394 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.0768 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.7651 | Train Acc: 0.6970
 Site-MNIST     | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0305 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0570 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1052 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0384 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 0.6592 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0739 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0705 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8358 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8423
============ Train epoch 48 ============
 Site-MNIST     | Train Loss: 0.2672 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.0747 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1629 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0587 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0127 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2382 | Train Acc: 0.7000
 Site-USPS      | Train Loss: 0.4049 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3264 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.0798 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 1.0844 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.0084 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0352 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0764 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0597 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1047 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0171 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.6651 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0762 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0701 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8381 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8484
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9747
 Best site-SVHN       | Epoch:48 | Val Acc: 0.2727
 Best site-USPS       | Epoch:48 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:48 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/harmo-fl...
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.2340 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.0668 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1144 | Train Acc: 0.9718
 Site-MNIST     | Train Loss: 0.0500 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0111 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.3988 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.4050 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3378 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.0690 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.9842 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.0083 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0317 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0677 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1017 | Val  Acc: 0.9747
 Site-SVHN      | Val  Loss: 2.0097 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6320 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.0662 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.0657 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 1.8027 | Val  Acc: 0.3636
Average Valid Accuracy: 0.8348
===2023-04-23 00:41:05===
===2023-04-23 00:41:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:48 | Test Acc: 0.8793
 Test site-SVHN      | Epoch:48 | Test Acc: 0.2690
 Test site-USPS      | Epoch:48 | Test Acc: 0.7527
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.6193
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.2914
Average Test Accuracy: 0.5623
