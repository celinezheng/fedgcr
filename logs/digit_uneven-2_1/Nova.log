===2023-04-08 11:28:15===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,111,222,104,96,89,]
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
client-0 is in G-2
client-1 is in G-3
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-4
cnt=[2, 3, 2, 2, 1, ]
 Site-MNIST     | Train Loss: 2.1818 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.0853 | Train Acc: 0.3617
 Site-MNIST     | Train Loss: 2.0327 | Train Acc: 0.4085
 Site-MNIST     | Train Loss: 2.0344 | Train Acc: 0.3723
 Site-MNIST     | Train Loss: 1.9647 | Train Acc: 0.4153
 Site-SVHN      | Train Loss: 2.2443 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.2013 | Train Acc: 0.2477
 Site-USPS      | Train Loss: 2.0327 | Train Acc: 0.2981
 Site-SynthDigits| Train Loss: 2.2430 | Train Acc: 0.1354
 Site-MNIST-M   | Train Loss: 2.2982 | Train Acc: 0.1573
============ Train epoch 2 ============
============ Train epoch 3 ============
client-0 is in G-0
client-1 is in G-4
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
cnt=[2, 1, 2, 3, 2, ]
 Site-MNIST     | Train Loss: 1.9453 | Train Acc: 0.3043
 Site-MNIST     | Train Loss: 1.8650 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.7834 | Train Acc: 0.5070
 Site-MNIST     | Train Loss: 1.8322 | Train Acc: 0.4468
 Site-MNIST     | Train Loss: 1.7541 | Train Acc: 0.4915
 Site-SVHN      | Train Loss: 2.1916 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.0952 | Train Acc: 0.3288
 Site-USPS      | Train Loss: 1.8179 | Train Acc: 0.4038
 Site-SynthDigits| Train Loss: 2.1425 | Train Acc: 0.2292
 Site-MNIST-M   | Train Loss: 2.2704 | Train Acc: 0.1685
 Site-MNIST     | Val  Loss: 1.8457 | Val  Acc: 0.4000
 Site-MNIST     | Val  Loss: 1.8272 | Val  Acc: 0.4516
 Site-MNIST     | Val  Loss: 1.8569 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 1.8715 | Val  Acc: 0.4286
 Site-MNIST     | Val  Loss: 1.7777 | Val  Acc: 0.5443
 Site-SVHN      | Val  Loss: 2.0342 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 2.1154 | Val  Acc: 0.2770
 Site-USPS      | Val  Loss: 1.7670 | Val  Acc: 0.5217
 Site-SynthDigits| Val  Loss: 2.1892 | Val  Acc: 0.1562
 Site-MNIST-M   | Val  Loss: 2.2735 | Val  Acc: 0.1864
Average Valid Accuracy: 0.3853
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4516
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4681
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4286
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5443
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2770
 Best site-USPS       | Epoch:1 | Val Acc: 0.5217
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1562
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
client-0 is in G-4
client-1 is in G-4
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-1
client-9 is in G-4
cnt=[1, 1, 1, 3, 4, ]
 Site-MNIST     | Train Loss: 1.9194 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.6670 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.6049 | Train Acc: 0.6197
 Site-MNIST     | Train Loss: 1.6619 | Train Acc: 0.5213
 Site-MNIST     | Train Loss: 1.5492 | Train Acc: 0.5847
 Site-SVHN      | Train Loss: 2.1551 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.0354 | Train Acc: 0.3468
 Site-USPS      | Train Loss: 1.6472 | Train Acc: 0.5481
 Site-SynthDigits| Train Loss: 2.0460 | Train Acc: 0.2812
 Site-MNIST-M   | Train Loss: 2.2134 | Train Acc: 0.1910
============ Train epoch 6 ============
============ Train epoch 7 ============
client-0 is in G-4
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-3
client-9 is in G-4
cnt=[1, 1, 3, 1, 4, ]
 Site-MNIST     | Train Loss: 1.7177 | Train Acc: 0.4783
 Site-MNIST     | Train Loss: 1.4943 | Train Acc: 0.6170
 Site-MNIST     | Train Loss: 1.4521 | Train Acc: 0.6901
 Site-MNIST     | Train Loss: 1.5158 | Train Acc: 0.6383
 Site-MNIST     | Train Loss: 1.4118 | Train Acc: 0.7458
 Site-SVHN      | Train Loss: 2.1268 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 1.9802 | Train Acc: 0.3829
 Site-USPS      | Train Loss: 1.5026 | Train Acc: 0.6538
 Site-SynthDigits| Train Loss: 1.9681 | Train Acc: 0.2812
 Site-MNIST-M   | Train Loss: 2.1706 | Train Acc: 0.1910
 Site-MNIST     | Val  Loss: 1.4849 | Val  Acc: 0.7333
 Site-MNIST     | Val  Loss: 1.4701 | Val  Acc: 0.7419
 Site-MNIST     | Val  Loss: 1.5305 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.5585 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.4352 | Val  Acc: 0.6835
 Site-SVHN      | Val  Loss: 1.8985 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.9926 | Val  Acc: 0.3446
 Site-USPS      | Val  Loss: 1.4472 | Val  Acc: 0.6957
 Site-SynthDigits| Val  Loss: 2.0357 | Val  Acc: 0.2969
 Site-MNIST-M   | Val  Loss: 2.1855 | Val  Acc: 0.2203
Average Valid Accuracy: 0.5484
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7333
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7419
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7234
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6835
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3446
 Best site-USPS       | Epoch:3 | Val Acc: 0.6957
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2969
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-3
client-8 is in G-4
client-9 is in G-4
cnt=[1, 2, 3, 1, 3, ]
 Site-MNIST     | Train Loss: 1.6986 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.3724 | Train Acc: 0.6383
 Site-MNIST     | Train Loss: 1.3110 | Train Acc: 0.7042
 Site-MNIST     | Train Loss: 1.3709 | Train Acc: 0.6809
 Site-MNIST     | Train Loss: 1.2722 | Train Acc: 0.7542
 Site-SVHN      | Train Loss: 2.0905 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.9336 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 1.3752 | Train Acc: 0.6827
 Site-SynthDigits| Train Loss: 1.9053 | Train Acc: 0.3438
 Site-MNIST-M   | Train Loss: 2.1158 | Train Acc: 0.2472
============ Train epoch 10 ============
============ Train epoch 11 ============
client-0 is in G-4
client-1 is in G-3
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-3
client-9 is in G-4
cnt=[1, 3, 1, 3, 2, ]
 Site-MNIST     | Train Loss: 1.3987 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.2350 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.2311 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.2559 | Train Acc: 0.7340
 Site-MNIST     | Train Loss: 1.1256 | Train Acc: 0.8220
 Site-SVHN      | Train Loss: 2.0675 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 1.8791 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 1.2490 | Train Acc: 0.7596
 Site-SynthDigits| Train Loss: 1.8431 | Train Acc: 0.3854
 Site-MNIST-M   | Train Loss: 2.0841 | Train Acc: 0.2584
 Site-MNIST     | Val  Loss: 1.2172 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.1967 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.2731 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.3059 | Val  Acc: 0.6349
 Site-MNIST     | Val  Loss: 1.1832 | Val  Acc: 0.7468
 Site-SVHN      | Val  Loss: 1.7862 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.8871 | Val  Acc: 0.4054
 Site-USPS      | Val  Loss: 1.2316 | Val  Acc: 0.7391
 Site-SynthDigits| Val  Loss: 1.9292 | Val  Acc: 0.3438
 Site-MNIST-M   | Val  Loss: 2.1119 | Val  Acc: 0.2373
Average Valid Accuracy: 0.6066
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6349
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7468
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4054
 Best site-USPS       | Epoch:5 | Val Acc: 0.7391
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3438
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-2
client-9 is in G-4
cnt=[1, 3, 2, 3, 1, ]
 Site-MNIST     | Train Loss: 1.5255 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.1269 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.0805 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.1493 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.0810 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.0348 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.8293 | Train Acc: 0.4640
 Site-USPS      | Train Loss: 1.1580 | Train Acc: 0.7692
 Site-SynthDigits| Train Loss: 1.7862 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 2.0643 | Train Acc: 0.2584
============ Train epoch 14 ============
============ Train epoch 15 ============
client-0 is in G-4
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-1
cnt=[2, 1, 3, 1, 3, ]
 Site-MNIST     | Train Loss: 1.3024 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 1.0283 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.0035 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.0510 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 0.9528 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 2.0066 | Train Acc: 0.2613
 Site-SVHN      | Train Loss: 1.7934 | Train Acc: 0.4730
 Site-USPS      | Train Loss: 1.0676 | Train Acc: 0.8077
 Site-SynthDigits| Train Loss: 1.7326 | Train Acc: 0.4271
 Site-MNIST-M   | Train Loss: 2.0166 | Train Acc: 0.2584
 Site-MNIST     | Val  Loss: 1.0124 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.9893 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.0660 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.1086 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 0.9935 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.6973 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.7944 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 1.0580 | Val  Acc: 0.7826
 Site-SynthDigits| Val  Loss: 1.8445 | Val  Acc: 0.3906
 Site-MNIST-M   | Val  Loss: 2.0321 | Val  Acc: 0.2712
Average Valid Accuracy: 0.6505
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4459
 Best site-USPS       | Epoch:7 | Val Acc: 0.7826
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3906
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-3
cnt=[3, 3, 1, 1, 2, ]
 Site-MNIST     | Train Loss: 1.2917 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.9390 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 0.9518 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.9667 | Train Acc: 0.8404
 Site-MNIST     | Train Loss: 0.8871 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.9900 | Train Acc: 0.2523
 Site-SVHN      | Train Loss: 1.7494 | Train Acc: 0.4775
 Site-USPS      | Train Loss: 0.9990 | Train Acc: 0.8173
 Site-SynthDigits| Train Loss: 1.6907 | Train Acc: 0.4479
 Site-MNIST-M   | Train Loss: 1.9647 | Train Acc: 0.2809
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
cnt=[2, 3, 1, 2, 2, ]
 Site-MNIST     | Train Loss: 1.1247 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.8704 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 0.8785 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.8952 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.8180 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.9611 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.7054 | Train Acc: 0.5090
 Site-USPS      | Train Loss: 0.9322 | Train Acc: 0.8173
 Site-SynthDigits| Train Loss: 1.6410 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.9399 | Train Acc: 0.2921
 Site-MNIST     | Val  Loss: 0.8464 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.8257 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.9041 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.9572 | Val  Acc: 0.8254
 Site-MNIST     | Val  Loss: 0.8510 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 1.6097 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.7002 | Val  Acc: 0.4865
 Site-USPS      | Val  Loss: 0.9319 | Val  Acc: 0.8116
 Site-SynthDigits| Val  Loss: 1.7760 | Val  Acc: 0.4219
 Site-MNIST-M   | Val  Loss: 1.9687 | Val  Acc: 0.3051
Average Valid Accuracy: 0.6769
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8254
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4865
 Best site-USPS       | Epoch:9 | Val Acc: 0.8116
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4219
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.7379
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2846
 Test site-USPS      | Epoch:9 | Test Acc: 0.8387
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4008
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3100
Average Test Accuracy: 0.5144
============ Train epoch 20 ============
============ Train epoch 21 ============
client-0 is in G-4
client-1 is in G-3
client-2 is in G-4
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
cnt=[1, 1, 2, 3, 3, ]
 Site-MNIST     | Train Loss: 1.0829 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.7955 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.8074 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.8309 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.7328 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9422 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.6735 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.8995 | Train Acc: 0.8462
 Site-SynthDigits| Train Loss: 1.6099 | Train Acc: 0.5104
 Site-MNIST-M   | Train Loss: 1.9320 | Train Acc: 0.2697
============ Train epoch 22 ============
============ Train epoch 23 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-1
client-3 is in G-4
client-4 is in G-4
client-5 is in G-0
client-6 is in G-0
client-7 is in G-3
client-8 is in G-2
client-9 is in G-2
cnt=[2, 2, 3, 1, 2, ]
 Site-MNIST     | Train Loss: 0.9777 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 0.7437 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.7356 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.7753 | Train Acc: 0.8617
 Site-MNIST     | Train Loss: 0.6798 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9211 | Train Acc: 0.2793
 Site-SVHN      | Train Loss: 1.6428 | Train Acc: 0.5270
 Site-USPS      | Train Loss: 0.8417 | Train Acc: 0.8462
 Site-SynthDigits| Train Loss: 1.5726 | Train Acc: 0.5208
 Site-MNIST-M   | Train Loss: 1.9003 | Train Acc: 0.2921
 Site-MNIST     | Val  Loss: 0.7374 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.7164 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.7901 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.8353 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.7421 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.5396 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.6290 | Val  Acc: 0.5068
 Site-USPS      | Val  Loss: 0.8399 | Val  Acc: 0.8261
 Site-SynthDigits| Val  Loss: 1.7283 | Val  Acc: 0.4219
 Site-MNIST-M   | Val  Loss: 1.9210 | Val  Acc: 0.3220
Average Valid Accuracy: 0.6974
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:11 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:11 | Val Acc: 0.5068
 Best site-USPS       | Epoch:11 | Val Acc: 0.8261
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.4219
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 24 ============
============ Train epoch 25 ============
client-0 is in G-1
client-1 is in G-3
client-2 is in G-1
client-3 is in G-3
client-4 is in G-4
client-5 is in G-1
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-3
cnt=[2, 3, 1, 3, 1, ]
 Site-MNIST     | Train Loss: 1.0524 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.6962 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.7283 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.7265 | Train Acc: 0.8617
 Site-MNIST     | Train Loss: 0.6569 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9026 | Train Acc: 0.2793
 Site-SVHN      | Train Loss: 1.6029 | Train Acc: 0.5270
 Site-USPS      | Train Loss: 0.8048 | Train Acc: 0.8558
 Site-SynthDigits| Train Loss: 1.5331 | Train Acc: 0.5417
 Site-MNIST-M   | Train Loss: 1.8687 | Train Acc: 0.2921
============ Train epoch 26 ============
============ Train epoch 27 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.9020 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6492 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6933 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.6895 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.6047 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8864 | Train Acc: 0.2883
 Site-SVHN      | Train Loss: 1.5672 | Train Acc: 0.5360
 Site-USPS      | Train Loss: 0.7681 | Train Acc: 0.8654
 Site-SynthDigits| Train Loss: 1.5011 | Train Acc: 0.5729
 Site-MNIST-M   | Train Loss: 1.8475 | Train Acc: 0.2921
 Site-MNIST     | Val  Loss: 0.6583 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.6294 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7018 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7444 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.6554 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.4713 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 1.5579 | Val  Acc: 0.5203
 Site-USPS      | Val  Loss: 0.7682 | Val  Acc: 0.8406
 Site-SynthDigits| Val  Loss: 1.6871 | Val  Acc: 0.4219
 Site-MNIST-M   | Val  Loss: 1.8853 | Val  Acc: 0.3559
Average Valid Accuracy: 0.7172
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5203
 Best site-USPS       | Epoch:13 | Val Acc: 0.8406
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.4219
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-3
client-8 is in G-4
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.8376 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6013 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6588 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6522 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.5707 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.8608 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.5445 | Train Acc: 0.5450
 Site-USPS      | Train Loss: 0.7245 | Train Acc: 0.8654
 Site-SynthDigits| Train Loss: 1.4587 | Train Acc: 0.5833
 Site-MNIST-M   | Train Loss: 1.7935 | Train Acc: 0.3371
============ Train epoch 30 ============
============ Train epoch 31 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.7974 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5583 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6578 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6149 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.5420 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.8428 | Train Acc: 0.3153
 Site-SVHN      | Train Loss: 1.5114 | Train Acc: 0.5586
 Site-USPS      | Train Loss: 0.7111 | Train Acc: 0.8654
 Site-SynthDigits| Train Loss: 1.4231 | Train Acc: 0.5729
 Site-MNIST-M   | Train Loss: 1.7714 | Train Acc: 0.3258
 Site-MNIST     | Val  Loss: 0.5824 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5509 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6212 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6611 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.5840 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.4136 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 1.4960 | Val  Acc: 0.5541
 Site-USPS      | Val  Loss: 0.7009 | Val  Acc: 0.8551
 Site-SynthDigits| Val  Loss: 1.6331 | Val  Acc: 0.4375
 Site-MNIST-M   | Val  Loss: 1.8396 | Val  Acc: 0.3559
Average Valid Accuracy: 0.7362
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:15 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:15 | Val Acc: 0.5541
 Best site-USPS       | Epoch:15 | Val Acc: 0.8551
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.4375
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 32 ============
============ Train epoch 33 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.7565 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.5266 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6205 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.5711 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4996 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.8186 | Train Acc: 0.3423
 Site-SVHN      | Train Loss: 1.4799 | Train Acc: 0.5586
 Site-USPS      | Train Loss: 0.6379 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.3931 | Train Acc: 0.5938
 Site-MNIST-M   | Train Loss: 1.7386 | Train Acc: 0.3483
============ Train epoch 34 ============
============ Train epoch 35 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.7829 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.4922 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5669 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5451 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.4675 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.7899 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.4540 | Train Acc: 0.5721
 Site-USPS      | Train Loss: 0.6043 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.3485 | Train Acc: 0.5625
 Site-MNIST-M   | Train Loss: 1.7031 | Train Acc: 0.4157
 Site-MNIST     | Val  Loss: 0.5078 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4831 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5541 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5910 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.5219 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.3641 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 1.4389 | Val  Acc: 0.5541
 Site-USPS      | Val  Loss: 0.6459 | Val  Acc: 0.8696
 Site-SynthDigits| Val  Loss: 1.5954 | Val  Acc: 0.4688
 Site-MNIST-M   | Val  Loss: 1.8069 | Val  Acc: 0.3729
Average Valid Accuracy: 0.7550
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:17 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:17 | Val Acc: 0.5541
 Best site-USPS       | Epoch:17 | Val Acc: 0.8696
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.4688
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 36 ============
============ Train epoch 37 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.7620 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.4525 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5630 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5114 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.4426 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.7554 | Train Acc: 0.3694
 Site-SVHN      | Train Loss: 1.4343 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.5873 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.3244 | Train Acc: 0.5625
 Site-MNIST-M   | Train Loss: 1.6793 | Train Acc: 0.4382
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-1
client-1 is in G-3
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-3
client-9 is in G-4
cnt=[2, 4, 1, 2, 1, ]
 Site-MNIST     | Train Loss: 0.7627 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.4188 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5060 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4650 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.4103 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.7170 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.4123 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 0.5795 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.3367 | Train Acc: 0.5104
 Site-MNIST-M   | Train Loss: 1.6134 | Train Acc: 0.4831
 Site-MNIST     | Val  Loss: 0.4360 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4187 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.4868 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5140 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.4563 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.3151 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 1.3943 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 0.5901 | Val  Acc: 0.8696
 Site-SynthDigits| Val  Loss: 1.5596 | Val  Acc: 0.4844
 Site-MNIST-M   | Val  Loss: 1.7540 | Val  Acc: 0.3729
Average Valid Accuracy: 0.7551
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:19 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:19 | Val Acc: 0.5676
 Best site-USPS       | Epoch:19 | Val Acc: 0.8696
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.4844
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.8143
 Test site-SVHN      | Epoch:19 | Test Acc: 0.3496
 Test site-USPS      | Epoch:19 | Test Acc: 0.8763
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.4772
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.3993
Average Test Accuracy: 0.5834
============ Train epoch 40 ============
============ Train epoch 41 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.6228 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.3947 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4948 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4485 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.3704 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.7114 | Train Acc: 0.3694
 Site-SVHN      | Train Loss: 1.3661 | Train Acc: 0.5856
 Site-USPS      | Train Loss: 0.5098 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.2987 | Train Acc: 0.5729
 Site-MNIST-M   | Train Loss: 1.5844 | Train Acc: 0.4944
============ Train epoch 42 ============
============ Train epoch 43 ============
client-0 is in G-1
client-1 is in G-4
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
cnt=[2, 4, 1, 1, 2, ]
 Site-MNIST     | Train Loss: 0.6517 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3616 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4344 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4230 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.3397 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.6659 | Train Acc: 0.3694
 Site-SVHN      | Train Loss: 1.3310 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 0.5339 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.2732 | Train Acc: 0.5729
 Site-MNIST-M   | Train Loss: 1.5458 | Train Acc: 0.4831
 Site-MNIST     | Val  Loss: 0.3748 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3671 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.4386 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.4552 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.4004 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.2371 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 1.3119 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 0.5455 | Val  Acc: 0.8551
 Site-SynthDigits| Val  Loss: 1.5034 | Val  Acc: 0.5156
 Site-MNIST-M   | Val  Loss: 1.7203 | Val  Acc: 0.4407
Average Valid Accuracy: 0.7724
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:21 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:21 | Val Acc: 0.5676
 Best site-USPS       | Epoch:21 | Val Acc: 0.8551
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.5156
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.6224 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3440 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4959 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4017 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.3121 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.6289 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.2817 | Train Acc: 0.6081
 Site-USPS      | Train Loss: 0.4760 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.2504 | Train Acc: 0.5625
 Site-MNIST-M   | Train Loss: 1.5144 | Train Acc: 0.4944
============ Train epoch 46 ============
============ Train epoch 47 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-3
client-8 is in G-4
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.5230 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3214 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4250 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3814 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3173 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.6055 | Train Acc: 0.3874
 Site-SVHN      | Train Loss: 1.2458 | Train Acc: 0.6036
 Site-USPS      | Train Loss: 0.4352 | Train Acc: 0.8942
 Site-SynthDigits| Train Loss: 1.2141 | Train Acc: 0.5729
 Site-MNIST-M   | Train Loss: 1.4877 | Train Acc: 0.4831
 Site-MNIST     | Val  Loss: 0.3310 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3347 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.4039 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.4085 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3524 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.1545 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 1.2230 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 0.5023 | Val  Acc: 0.8551
 Site-SynthDigits| Val  Loss: 1.4502 | Val  Acc: 0.5312
 Site-MNIST-M   | Val  Loss: 1.6986 | Val  Acc: 0.4237
Average Valid Accuracy: 0.7814
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:23 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:23 | Val Acc: 0.5946
 Best site-USPS       | Epoch:23 | Val Acc: 0.8551
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.5312
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-4
client-8 is in G-3
client-9 is in G-2
cnt=[1, 5, 2, 1, 1, ]
 Site-MNIST     | Train Loss: 0.5464 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3022 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3876 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3670 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2957 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.5724 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 1.2110 | Train Acc: 0.6306
 Site-USPS      | Train Loss: 0.4443 | Train Acc: 0.9038
 Site-SynthDigits| Train Loss: 1.1819 | Train Acc: 0.5938
 Site-MNIST-M   | Train Loss: 1.4404 | Train Acc: 0.5281
============ Train epoch 50 ============
============ Train epoch 51 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-4
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.4698 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2871 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3503 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3487 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2661 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.5345 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 1.1696 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 0.4407 | Train Acc: 0.9038
 Site-SynthDigits| Train Loss: 1.1503 | Train Acc: 0.6146
 Site-MNIST-M   | Train Loss: 1.4468 | Train Acc: 0.5056
 Site-MNIST     | Val  Loss: 0.2937 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3024 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3689 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.3694 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.3138 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.0827 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 1.1548 | Val  Acc: 0.6419
 Site-USPS      | Val  Loss: 0.4741 | Val  Acc: 0.8841
 Site-SynthDigits| Val  Loss: 1.3781 | Val  Acc: 0.5625
 Site-MNIST-M   | Val  Loss: 1.6704 | Val  Acc: 0.4237
Average Valid Accuracy: 0.7906
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:25 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:25 | Val Acc: 0.6419
 Best site-USPS       | Epoch:25 | Val Acc: 0.8841
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.5625
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 52 ============
============ Train epoch 53 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-4
client-8 is in G-2
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.5498 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2660 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3462 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3364 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2427 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.5011 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 1.1345 | Train Acc: 0.6622
 Site-USPS      | Train Loss: 0.3888 | Train Acc: 0.9135
 Site-SynthDigits| Train Loss: 1.1180 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.4251 | Train Acc: 0.5281
============ Train epoch 54 ============
============ Train epoch 55 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-3
client-8 is in G-4
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.3875 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2535 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3450 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3148 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2370 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.4719 | Train Acc: 0.4775
 Site-SVHN      | Train Loss: 1.0976 | Train Acc: 0.6712
 Site-USPS      | Train Loss: 0.3762 | Train Acc: 0.9135
 Site-SynthDigits| Train Loss: 1.0904 | Train Acc: 0.6354
 Site-MNIST-M   | Train Loss: 1.4050 | Train Acc: 0.5281
 Site-MNIST     | Val  Loss: 0.2625 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.2762 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3390 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.3301 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2823 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.0075 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 1.0889 | Val  Acc: 0.6554
 Site-USPS      | Val  Loss: 0.4489 | Val  Acc: 0.8841
 Site-SynthDigits| Val  Loss: 1.3090 | Val  Acc: 0.5781
 Site-MNIST-M   | Val  Loss: 1.6449 | Val  Acc: 0.4068
Average Valid Accuracy: 0.7947
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:27 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:27 | Val Acc: 0.6554
 Best site-USPS       | Epoch:27 | Val Acc: 0.8841
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.5781
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
============ Train epoch 56 ============
============ Train epoch 57 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-3
client-8 is in G-4
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.3994 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2464 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3147 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3061 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2194 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.4459 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.0684 | Train Acc: 0.6712
 Site-USPS      | Train Loss: 0.3718 | Train Acc: 0.9135
 Site-SynthDigits| Train Loss: 1.0425 | Train Acc: 0.6875
 Site-MNIST-M   | Train Loss: 1.3999 | Train Acc: 0.5618
============ Train epoch 58 ============
============ Train epoch 59 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-4
client-8 is in G-2
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
 Site-MNIST     | Train Loss: 0.4324 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2381 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3151 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2887 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2139 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.4183 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 1.0409 | Train Acc: 0.6847
 Site-USPS      | Train Loss: 0.3620 | Train Acc: 0.9038
 Site-SynthDigits| Train Loss: 1.0240 | Train Acc: 0.6562
 Site-MNIST-M   | Train Loss: 1.3395 | Train Acc: 0.5955
 Site-MNIST     | Val  Loss: 0.2405 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.2567 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3172 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.3050 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2531 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 0.9499 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 1.0369 | Val  Acc: 0.6689
 Site-USPS      | Val  Loss: 0.4298 | Val  Acc: 0.8841
 Site-SynthDigits| Val  Loss: 1.2520 | Val  Acc: 0.5938
 Site-MNIST-M   | Val  Loss: 1.6158 | Val  Acc: 0.4068
Average Valid Accuracy: 0.8042
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9620
 Best site-SVHN       | Epoch:29 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:29 | Val Acc: 0.6689
 Best site-USPS       | Epoch:29 | Val Acc: 0.8841
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.5938
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/Nova...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.8693
 Test site-SVHN      | Epoch:29 | Test Acc: 0.4383
 Test site-USPS      | Epoch:29 | Test Acc: 0.8441
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.5934
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.4436
Average Test Accuracy: 0.6377
===2023-04-08 12:28:41===
===2023-04-08 12:28:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
    beta=0.7, beta_c=0.9
data_number=[23,47,71,94,118,111,222,104,96,89,]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.8671
 Test site-SVHN      | Epoch:29 | Test Acc: 0.4428
 Test site-USPS      | Epoch:29 | Test Acc: 0.8441
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.5925
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.4421
Average Test Accuracy: 0.6377
