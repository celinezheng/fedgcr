===2023-04-19 05:23:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 2.2213 | Train Acc: 0.1739
 Site-MNIST     | Train Loss: 2.2694 | Train Acc: 0.0426
 Site-MNIST     | Train Loss: 2.2627 | Train Acc: 0.1268
 Site-MNIST     | Train Loss: 2.2221 | Train Acc: 0.1702
 Site-MNIST     | Train Loss: 2.2524 | Train Acc: 0.1271
 Site-SVHN      | Train Loss: 2.3981 | Train Acc: 0.1000
 Site-USPS      | Train Loss: 2.3633 | Train Acc: 0.0682
 Site-SynthDigits| Train Loss: 2.3115 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.2596 | Train Acc: 0.1622
 Site-MNIST-M   | Train Loss: 2.4051 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.2764 | Val  Acc: 0.1333
 Site-MNIST     | Val  Loss: 2.2305 | Val  Acc: 0.2581
 Site-MNIST     | Val  Loss: 2.2323 | Val  Acc: 0.1702
 Site-MNIST     | Val  Loss: 2.2232 | Val  Acc: 0.1746
 Site-MNIST     | Val  Loss: 2.2572 | Val  Acc: 0.1392
 Site-SVHN      | Val  Loss: 2.3247 | Val  Acc: 0.1212
 Site-USPS      | Val  Loss: 2.3540 | Val  Acc: 0.1034
 Site-SynthDigits| Val  Loss: 2.3158 | Val  Acc: 0.1020
 Site-SynthDigits| Val  Loss: 2.2723 | Val  Acc: 0.1327
 Site-MNIST-M   | Val  Loss: 2.3873 | Val  Acc: 0.2273
Average Valid Accuracy: 0.1562
Aggregated Acc | Val Acc: 0.1489
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1333
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2581
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1702
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1746
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1392
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1212
 Best site-USPS       | Epoch:0 | Val Acc: 0.1034
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1020
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1327
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 1 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 2.1062 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.1292 | Train Acc: 0.1702
 Site-MNIST     | Train Loss: 2.1145 | Train Acc: 0.2394
 Site-MNIST     | Train Loss: 2.0905 | Train Acc: 0.2979
 Site-MNIST     | Train Loss: 2.0785 | Train Acc: 0.2881
 Site-SVHN      | Train Loss: 2.2618 | Train Acc: 0.1400
 Site-USPS      | Train Loss: 2.2516 | Train Acc: 0.1818
 Site-SynthDigits| Train Loss: 2.2564 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.1993 | Train Acc: 0.2027
 Site-MNIST-M   | Train Loss: 2.4561 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.1166 | Val  Acc: 0.2667
 Site-MNIST     | Val  Loss: 2.0717 | Val  Acc: 0.2903
 Site-MNIST     | Val  Loss: 2.1150 | Val  Acc: 0.2979
 Site-MNIST     | Val  Loss: 2.1058 | Val  Acc: 0.3333
 Site-MNIST     | Val  Loss: 2.1069 | Val  Acc: 0.2911
 Site-SVHN      | Val  Loss: 2.3148 | Val  Acc: 0.1212
 Site-USPS      | Val  Loss: 2.2454 | Val  Acc: 0.1379
 Site-SynthDigits| Val  Loss: 2.2984 | Val  Acc: 0.1429
 Site-SynthDigits| Val  Loss: 2.2408 | Val  Acc: 0.2449
 Site-MNIST-M   | Val  Loss: 2.3805 | Val  Acc: 0.1818
Average Valid Accuracy: 0.2308
Aggregated Acc | Val Acc: 0.1861
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2903
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2979
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3333
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2911
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1212
 Best site-USPS       | Epoch:1 | Val Acc: 0.1379
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1429
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2449
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 2 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 2.1107 | Train Acc: 0.3043
 Site-MNIST     | Train Loss: 1.9939 | Train Acc: 0.2553
 Site-MNIST     | Train Loss: 1.9954 | Train Acc: 0.3380
 Site-MNIST     | Train Loss: 1.9738 | Train Acc: 0.4149
 Site-MNIST     | Train Loss: 1.9487 | Train Acc: 0.3644
 Site-SVHN      | Train Loss: 2.3341 | Train Acc: 0.2000
 Site-USPS      | Train Loss: 2.1592 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.1921 | Train Acc: 0.2432
 Site-SynthDigits| Train Loss: 2.1625 | Train Acc: 0.2635
 Site-MNIST-M   | Train Loss: 2.3636 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.9613 | Val  Acc: 0.3333
 Site-MNIST     | Val  Loss: 1.9541 | Val  Acc: 0.2903
 Site-MNIST     | Val  Loss: 2.0097 | Val  Acc: 0.2979
 Site-MNIST     | Val  Loss: 1.9849 | Val  Acc: 0.4444
 Site-MNIST     | Val  Loss: 1.9886 | Val  Acc: 0.3797
 Site-SVHN      | Val  Loss: 2.2568 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 2.1955 | Val  Acc: 0.3793
 Site-SynthDigits| Val  Loss: 2.1720 | Val  Acc: 0.2041
 Site-SynthDigits| Val  Loss: 2.1350 | Val  Acc: 0.2755
 Site-MNIST-M   | Val  Loss: 2.3187 | Val  Acc: 0.1364
Average Valid Accuracy: 0.2983
Aggregated Acc | Val Acc: 0.2694
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.2903
 Best site-MNIST      | Epoch:2 | Val Acc: 0.2979
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4444
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3797
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2424
 Best site-USPS       | Epoch:2 | Val Acc: 0.3793
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2041
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2755
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 3 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.9735 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.8723 | Train Acc: 0.4468
 Site-MNIST     | Train Loss: 1.8888 | Train Acc: 0.4648
 Site-MNIST     | Train Loss: 1.8563 | Train Acc: 0.5319
 Site-MNIST     | Train Loss: 1.8179 | Train Acc: 0.5593
 Site-SVHN      | Train Loss: 2.1959 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 2.0523 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 2.1241 | Train Acc: 0.2162
 Site-SynthDigits| Train Loss: 2.0846 | Train Acc: 0.3446
 Site-MNIST-M   | Train Loss: 2.5649 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.8254 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.8273 | Val  Acc: 0.6129
 Site-MNIST     | Val  Loss: 1.8914 | Val  Acc: 0.5319
 Site-MNIST     | Val  Loss: 1.8685 | Val  Acc: 0.5079
 Site-MNIST     | Val  Loss: 1.8723 | Val  Acc: 0.4937
 Site-SVHN      | Val  Loss: 2.2137 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.1255 | Val  Acc: 0.3793
 Site-SynthDigits| Val  Loss: 2.1245 | Val  Acc: 0.2449
 Site-SynthDigits| Val  Loss: 2.0773 | Val  Acc: 0.2857
 Site-MNIST-M   | Val  Loss: 2.2879 | Val  Acc: 0.1364
Average Valid Accuracy: 0.4096
Aggregated Acc | Val Acc: 0.3267
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6129
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5319
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5079
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4937
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3030
 Best site-USPS       | Epoch:3 | Val Acc: 0.3793
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2449
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2857
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 4 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.8928 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.7641 | Train Acc: 0.6170
 Site-MNIST     | Train Loss: 1.7798 | Train Acc: 0.5915
 Site-MNIST     | Train Loss: 1.7627 | Train Acc: 0.6170
 Site-MNIST     | Train Loss: 1.7221 | Train Acc: 0.6271
 Site-SVHN      | Train Loss: 2.1139 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.9660 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 2.0759 | Train Acc: 0.2568
 Site-SynthDigits| Train Loss: 1.9976 | Train Acc: 0.3446
 Site-MNIST-M   | Train Loss: 2.3470 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.7211 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.7237 | Val  Acc: 0.7742
 Site-MNIST     | Val  Loss: 1.7935 | Val  Acc: 0.6170
 Site-MNIST     | Val  Loss: 1.7765 | Val  Acc: 0.6032
 Site-MNIST     | Val  Loss: 1.7707 | Val  Acc: 0.6203
 Site-SVHN      | Val  Loss: 2.1840 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 2.0507 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.0776 | Val  Acc: 0.2857
 Site-SynthDigits| Val  Loss: 2.0182 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.2687 | Val  Acc: 0.0909
Average Valid Accuracy: 0.4913
Aggregated Acc | Val Acc: 0.3772
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7742
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6170
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6032
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6203
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3333
 Best site-USPS       | Epoch:4 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2857
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3061
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 5 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-3
client-8 is in G-3
client-9 is in G-1
cnt=[1, 1, 5, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.8363 | Train Acc: 0.4348
 Site-MNIST     | Train Loss: 1.6585 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.6985 | Train Acc: 0.6197
 Site-MNIST     | Train Loss: 1.6677 | Train Acc: 0.6170
 Site-MNIST     | Train Loss: 1.6117 | Train Acc: 0.6610
 Site-SVHN      | Train Loss: 2.1199 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.8631 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.0285 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 1.9433 | Train Acc: 0.3919
 Site-MNIST-M   | Train Loss: 2.4796 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.6185 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.6264 | Val  Acc: 0.7742
 Site-MNIST     | Val  Loss: 1.7002 | Val  Acc: 0.6170
 Site-MNIST     | Val  Loss: 1.6873 | Val  Acc: 0.6032
 Site-MNIST     | Val  Loss: 1.6711 | Val  Acc: 0.6456
 Site-SVHN      | Val  Loss: 2.1496 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.9688 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.0424 | Val  Acc: 0.3469
 Site-SynthDigits| Val  Loss: 1.9756 | Val  Acc: 0.3980
 Site-MNIST-M   | Val  Loss: 2.2422 | Val  Acc: 0.0909
Average Valid Accuracy: 0.5066
Aggregated Acc | Val Acc: 0.3883
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7742
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6170
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6032
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6456
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2727
 Best site-USPS       | Epoch:5 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3469
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3980
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 6 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.7995 | Train Acc: 0.5217
 Site-MNIST     | Train Loss: 1.5717 | Train Acc: 0.6383
 Site-MNIST     | Train Loss: 1.6107 | Train Acc: 0.7042
 Site-MNIST     | Train Loss: 1.5912 | Train Acc: 0.6596
 Site-MNIST     | Train Loss: 1.5072 | Train Acc: 0.7119
 Site-SVHN      | Train Loss: 2.1047 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.7948 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.9765 | Train Acc: 0.3649
 Site-SynthDigits| Train Loss: 1.9350 | Train Acc: 0.4324
 Site-MNIST-M   | Train Loss: 2.2730 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.5341 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.5440 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.6213 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.6063 | Val  Acc: 0.6349
 Site-MNIST     | Val  Loss: 1.5823 | Val  Acc: 0.7089
 Site-SVHN      | Val  Loss: 2.1371 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9043 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.0042 | Val  Acc: 0.4082
 Site-SynthDigits| Val  Loss: 1.9304 | Val  Acc: 0.4388
 Site-MNIST-M   | Val  Loss: 2.2266 | Val  Acc: 0.0909
Average Valid Accuracy: 0.5307
Aggregated Acc | Val Acc: 0.3992
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6596
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6349
 Best site-MNIST      | Epoch:6 | Val Acc: 0.7089
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2424
 Best site-USPS       | Epoch:6 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4082
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4388
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 7 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.6461 | Train Acc: 0.5217
 Site-MNIST     | Train Loss: 1.4864 | Train Acc: 0.6383
 Site-MNIST     | Train Loss: 1.5415 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.5171 | Train Acc: 0.6915
 Site-MNIST     | Train Loss: 1.4512 | Train Acc: 0.7542
 Site-SVHN      | Train Loss: 1.9996 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.7186 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.9367 | Train Acc: 0.4189
 Site-SynthDigits| Train Loss: 1.8685 | Train Acc: 0.4662
 Site-MNIST-M   | Train Loss: 2.2003 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.4676 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.4738 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.5510 | Val  Acc: 0.6809
 Site-MNIST     | Val  Loss: 1.5378 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.5031 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.1103 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.8429 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 1.9436 | Val  Acc: 0.4694
 Site-SynthDigits| Val  Loss: 1.8791 | Val  Acc: 0.4796
 Site-MNIST-M   | Val  Loss: 2.2147 | Val  Acc: 0.1364
Average Valid Accuracy: 0.5585
Aggregated Acc | Val Acc: 0.4341
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6809
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2727
 Best site-USPS       | Epoch:7 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4694
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4796
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 8 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.6022 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.4059 | Train Acc: 0.6809
 Site-MNIST     | Train Loss: 1.4248 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.4415 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.3703 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.0656 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.6505 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.8903 | Train Acc: 0.4189
 Site-SynthDigits| Train Loss: 1.8169 | Train Acc: 0.4865
 Site-MNIST-M   | Train Loss: 2.4348 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 1.3859 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.3950 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.4805 | Val  Acc: 0.7021
 Site-MNIST     | Val  Loss: 1.4682 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.4284 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.0798 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.7871 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.9091 | Val  Acc: 0.4898
 Site-SynthDigits| Val  Loss: 1.8360 | Val  Acc: 0.5204
 Site-MNIST-M   | Val  Loss: 2.1972 | Val  Acc: 0.1364
Average Valid Accuracy: 0.5864
Aggregated Acc | Val Acc: 0.4593
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7021
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3030
 Best site-USPS       | Epoch:8 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4898
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5204
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 9 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-3
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.5535 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.3443 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.3964 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.3860 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.3152 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 1.9956 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 1.6255 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.8451 | Train Acc: 0.4324
 Site-SynthDigits| Train Loss: 1.7735 | Train Acc: 0.5068
 Site-MNIST-M   | Train Loss: 2.4075 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.3204 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.3341 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.4192 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.4099 | Val  Acc: 0.6825
 Site-MNIST     | Val  Loss: 1.3657 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.0529 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.7467 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.8781 | Val  Acc: 0.5102
 Site-SynthDigits| Val  Loss: 1.7876 | Val  Acc: 0.5204
 Site-MNIST-M   | Val  Loss: 2.1848 | Val  Acc: 0.1364
Average Valid Accuracy: 0.5973
Aggregated Acc | Val Acc: 0.4697
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6825
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3333
 Best site-USPS       | Epoch:9 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5102
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5204
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.6357
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2569
 Test site-USPS      | Epoch:9 | Test Acc: 0.6344
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.3967
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.2236
Average Test Accuracy: 0.4295
============ Train epoch 10 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.5891 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.2814 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.3311 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.3221 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.2655 | Train Acc: 0.8220
 Site-SVHN      | Train Loss: 2.1066 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 1.5453 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.7889 | Train Acc: 0.4730
 Site-SynthDigits| Train Loss: 1.7278 | Train Acc: 0.5338
 Site-MNIST-M   | Train Loss: 2.1132 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.2622 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.2782 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.3599 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.3558 | Val  Acc: 0.6825
 Site-MNIST     | Val  Loss: 1.3076 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.0378 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.7032 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.8356 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.7415 | Val  Acc: 0.5306
 Site-MNIST-M   | Val  Loss: 2.1718 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6049
Aggregated Acc | Val Acc: 0.4818
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:10 | Val Acc: 0.6825
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3333
 Best site-USPS       | Epoch:10 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.5306
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 11 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.5788 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.2276 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.2534 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.2698 | Train Acc: 0.7128
 Site-MNIST     | Train Loss: 1.1955 | Train Acc: 0.8220
 Site-SVHN      | Train Loss: 1.9699 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 1.5255 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.7298 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 1.6959 | Train Acc: 0.5473
 Site-MNIST-M   | Train Loss: 2.3053 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 1.2049 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.2217 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.3114 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.3023 | Val  Acc: 0.6984
 Site-MNIST     | Val  Loss: 1.2497 | Val  Acc: 0.7468
 Site-SVHN      | Val  Loss: 2.0027 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.6530 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.7870 | Val  Acc: 0.5102
 Site-SynthDigits| Val  Loss: 1.6896 | Val  Acc: 0.5612
 Site-MNIST-M   | Val  Loss: 2.1557 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6144
Aggregated Acc | Val Acc: 0.4966
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7234
 Best site-MNIST      | Epoch:11 | Val Acc: 0.6984
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7468
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3636
 Best site-USPS       | Epoch:11 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.5102
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.5612
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 12 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
cnt=[1, 5, 1, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.4458 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.1867 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.2591 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.2263 | Train Acc: 0.7128
 Site-MNIST     | Train Loss: 1.1046 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 2.1089 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 1.4377 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.6976 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 1.6001 | Train Acc: 0.5608
 Site-MNIST-M   | Train Loss: 2.2031 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.1572 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.1727 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.2651 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.2563 | Val  Acc: 0.6984
 Site-MNIST     | Val  Loss: 1.2006 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 1.9728 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.6093 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.7352 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.6443 | Val  Acc: 0.5510
 Site-MNIST-M   | Val  Loss: 2.1386 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6199
Aggregated Acc | Val Acc: 0.4994
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7234
 Best site-MNIST      | Epoch:12 | Val Acc: 0.6984
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7595
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3636
 Best site-USPS       | Epoch:12 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5510
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 13 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.4731 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.1367 | Train Acc: 0.7447
 Site-MNIST     | Train Loss: 1.1726 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.1883 | Train Acc: 0.7128
 Site-MNIST     | Train Loss: 1.0947 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 1.9460 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.4210 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.6697 | Train Acc: 0.5541
 Site-SynthDigits| Train Loss: 1.5896 | Train Acc: 0.5743
 Site-MNIST-M   | Train Loss: 2.1489 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.1083 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.1221 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.2220 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.2155 | Val  Acc: 0.6984
 Site-MNIST     | Val  Loss: 1.1557 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 1.9467 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.5726 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.6776 | Val  Acc: 0.5102
 Site-SynthDigits| Val  Loss: 1.5992 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 2.1171 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6199
Aggregated Acc | Val Acc: 0.4994
============ Train epoch 14 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[1, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.3504 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.0920 | Train Acc: 0.7447
 Site-MNIST     | Train Loss: 1.1431 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.1385 | Train Acc: 0.7553
 Site-MNIST     | Train Loss: 1.0232 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 2.0027 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.3851 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.6347 | Train Acc: 0.5405
 Site-SynthDigits| Train Loss: 1.5366 | Train Acc: 0.5878
 Site-MNIST-M   | Train Loss: 2.2928 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 1.0459 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.0639 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.1723 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.1717 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.1143 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 1.9423 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.5412 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.6392 | Val  Acc: 0.5714
 Site-SynthDigits| Val  Loss: 1.5556 | Val  Acc: 0.6020
 Site-MNIST-M   | Val  Loss: 2.1042 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6450
Aggregated Acc | Val Acc: 0.5205
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7595
 Best site-SVHN       | Epoch:14 | Val Acc: 0.3636
 Best site-USPS       | Epoch:14 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.5714
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.6020
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 15 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.3219 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.0500 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.1096 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.1051 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.0139 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 1.9228 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 1.3505 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.6034 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 1.4779 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 2.2885 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 0.9984 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.0203 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.1328 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.1341 | Val  Acc: 0.7460
 Site-MNIST     | Val  Loss: 1.0748 | Val  Acc: 0.7722
 Site-SVHN      | Val  Loss: 1.9409 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.5016 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.6032 | Val  Acc: 0.5918
 Site-SynthDigits| Val  Loss: 1.5160 | Val  Acc: 0.5918
 Site-MNIST-M   | Val  Loss: 2.0953 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6513
Aggregated Acc | Val Acc: 0.5181
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7460
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7722
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3636
 Best site-USPS       | Epoch:15 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.5918
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.5918
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 16 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.2535 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 0.9950 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.0899 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.0655 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.9757 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 1.7821 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 1.3049 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.5645 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.4638 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 2.1351 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 0.9508 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.9758 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.0900 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.0937 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 1.0407 | Val  Acc: 0.7848
 Site-SVHN      | Val  Loss: 1.9416 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.4601 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.5825 | Val  Acc: 0.5714
 Site-SynthDigits| Val  Loss: 1.4865 | Val  Acc: 0.5816
 Site-MNIST-M   | Val  Loss: 2.0831 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6564
Aggregated Acc | Val Acc: 0.5183
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:16 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:16 | Val Acc: 0.7848
 Best site-SVHN       | Epoch:16 | Val Acc: 0.3636
 Best site-USPS       | Epoch:16 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.5714
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.5816
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 17 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.2103 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 0.9630 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.0258 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.0260 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.9544 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 2.1039 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.2925 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.4984 | Train Acc: 0.6081
 Site-SynthDigits| Train Loss: 1.4226 | Train Acc: 0.6081
 Site-MNIST-M   | Train Loss: 2.0958 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 0.9014 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.9317 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.0525 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.0580 | Val  Acc: 0.8254
 Site-MNIST     | Val  Loss: 1.0070 | Val  Acc: 0.8101
 Site-SVHN      | Val  Loss: 1.9207 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.4475 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.5469 | Val  Acc: 0.5918
 Site-SynthDigits| Val  Loss: 1.4483 | Val  Acc: 0.6122
 Site-MNIST-M   | Val  Loss: 2.0645 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6707
Aggregated Acc | Val Acc: 0.5326
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8254
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8101
 Best site-SVHN       | Epoch:17 | Val Acc: 0.3636
 Best site-USPS       | Epoch:17 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.5918
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.6122
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 18 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.2197 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.9273 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 1.0288 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 0.9929 | Train Acc: 0.8404
 Site-MNIST     | Train Loss: 0.9059 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.7634 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 1.2535 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.4834 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.4390 | Train Acc: 0.6284
 Site-MNIST-M   | Train Loss: 2.1380 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.8594 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8945 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.0192 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.0257 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.9729 | Val  Acc: 0.8228
 Site-SVHN      | Val  Loss: 1.9152 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.4292 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.5188 | Val  Acc: 0.5918
 Site-SynthDigits| Val  Loss: 1.4186 | Val  Acc: 0.6122
 Site-MNIST-M   | Val  Loss: 2.0538 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6712
Aggregated Acc | Val Acc: 0.5377
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8228
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3939
 Best site-USPS       | Epoch:18 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.5918
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.6122
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 19 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.1829 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.8916 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.9699 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 0.9608 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.8299 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 2.0007 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.2294 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.4679 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.3812 | Train Acc: 0.6689
 Site-MNIST-M   | Train Loss: 2.1488 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.8192 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8550 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9821 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.9914 | Val  Acc: 0.8254
 Site-MNIST     | Val  Loss: 0.9384 | Val  Acc: 0.8228
 Site-SVHN      | Val  Loss: 1.8987 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.4006 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.4736 | Val  Acc: 0.5918
 Site-SynthDigits| Val  Loss: 1.3793 | Val  Acc: 0.6531
 Site-MNIST-M   | Val  Loss: 2.0426 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6821
Aggregated Acc | Val Acc: 0.5493
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8254
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8228
 Best site-SVHN       | Epoch:19 | Val Acc: 0.4242
 Best site-USPS       | Epoch:19 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.5918
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.6531
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.7264
 Test site-SVHN      | Epoch:19 | Test Acc: 0.2962
 Test site-USPS      | Epoch:19 | Test Acc: 0.7151
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.5204
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.2821
Average Test Accuracy: 0.5080
============ Train epoch 20 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.1660 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.8626 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.9732 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 0.9219 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.8552 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.8309 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 1.1731 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.4108 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.3515 | Train Acc: 0.6824
 Site-MNIST-M   | Train Loss: 2.3134 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.7918 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8274 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9524 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.9624 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.9097 | Val  Acc: 0.8228
 Site-SVHN      | Val  Loss: 1.8979 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.3658 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.4254 | Val  Acc: 0.6122
 Site-SynthDigits| Val  Loss: 1.3388 | Val  Acc: 0.6837
 Site-MNIST-M   | Val  Loss: 2.0385 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6876
Aggregated Acc | Val Acc: 0.5442
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8228
 Best site-SVHN       | Epoch:20 | Val Acc: 0.3939
 Best site-USPS       | Epoch:20 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.6122
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.6837
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 21 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.1217 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.8320 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.9227 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 0.8965 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.8095 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 2.0165 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.1669 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.3799 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 1.3101 | Train Acc: 0.6892
 Site-MNIST-M   | Train Loss: 2.0952 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.7672 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7966 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9200 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.9361 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.8772 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.8864 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.3462 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.3786 | Val  Acc: 0.6531
 Site-SynthDigits| Val  Loss: 1.3070 | Val  Acc: 0.6837
 Site-MNIST-M   | Val  Loss: 2.0183 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6935
Aggregated Acc | Val Acc: 0.5490
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:21 | Val Acc: 0.3939
 Best site-USPS       | Epoch:21 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.6531
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.6837
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 22 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.0923 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7990 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.9120 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 0.8695 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.7554 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.7505 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 1.1168 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.3472 | Train Acc: 0.6351
 Site-SynthDigits| Train Loss: 1.2629 | Train Acc: 0.7297
 Site-MNIST-M   | Train Loss: 1.9993 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.7378 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7654 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8923 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.9120 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.8511 | Val  Acc: 0.8481
 Site-SVHN      | Val  Loss: 1.8567 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.3039 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.3383 | Val  Acc: 0.6939
 Site-SynthDigits| Val  Loss: 1.2681 | Val  Acc: 0.7245
 Site-MNIST-M   | Val  Loss: 1.9945 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7075
Aggregated Acc | Val Acc: 0.5644
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8481
 Best site-SVHN       | Epoch:22 | Val Acc: 0.4242
 Best site-USPS       | Epoch:22 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.6939
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.7245
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 23 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-3
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.1216 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7780 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.8586 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 0.8455 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.7300 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.8158 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.0989 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.2845 | Train Acc: 0.6351
 Site-SynthDigits| Train Loss: 1.2273 | Train Acc: 0.7365
 Site-MNIST-M   | Train Loss: 1.9883 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.7221 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7468 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8692 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8876 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.8264 | Val  Acc: 0.8481
 Site-SVHN      | Val  Loss: 1.8344 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.2634 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.2957 | Val  Acc: 0.6939
 Site-SynthDigits| Val  Loss: 1.2308 | Val  Acc: 0.7347
 Site-MNIST-M   | Val  Loss: 1.9800 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7085
Aggregated Acc | Val Acc: 0.5654
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8481
 Best site-SVHN       | Epoch:23 | Val Acc: 0.4242
 Best site-USPS       | Epoch:23 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.6939
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7347
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 24 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.1579 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7442 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.8651 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.8153 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.7166 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8212 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 1.0744 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.2942 | Train Acc: 0.6757
 Site-SynthDigits| Train Loss: 1.2266 | Train Acc: 0.7635
 Site-MNIST-M   | Train Loss: 1.8206 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.6841 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7130 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8345 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8521 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.8017 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 1.8234 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.2308 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.2754 | Val  Acc: 0.7347
 Site-SynthDigits| Val  Loss: 1.2017 | Val  Acc: 0.7551
 Site-MNIST-M   | Val  Loss: 1.9662 | Val  Acc: 0.2273
Average Valid Accuracy: 0.7290
Aggregated Acc | Val Acc: 0.5956
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:24 | Val Acc: 0.4242
 Best site-USPS       | Epoch:24 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.7347
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.7551
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 25 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.1014 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.7278 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.8500 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.7944 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6978 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.6590 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 1.0495 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.2505 | Train Acc: 0.6757
 Site-SynthDigits| Train Loss: 1.1748 | Train Acc: 0.7703
 Site-MNIST-M   | Train Loss: 1.8329 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.6619 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6920 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8186 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8347 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7840 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.8172 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.2168 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.2335 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.1597 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.9613 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7299
Aggregated Acc | Val Acc: 0.5868
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:25 | Val Acc: 0.4242
 Best site-USPS       | Epoch:25 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.7755
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 26 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
cnt=[1, 5, 1, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.9244 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.7030 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.8323 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.7739 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6942 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.7659 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 1.0062 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.2082 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 1.1552 | Train Acc: 0.7973
 Site-MNIST-M   | Train Loss: 2.0594 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 0.6408 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6722 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7960 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.8132 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7616 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.7978 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.1912 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.2164 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.1295 | Val  Acc: 0.7959
 Site-MNIST-M   | Val  Loss: 1.9530 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7354
Aggregated Acc | Val Acc: 0.5958
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:26 | Val Acc: 0.4242
 Best site-USPS       | Epoch:26 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.7959
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 27 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.0110 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.6842 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.7938 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7559 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6808 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.6186 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.9935 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.2246 | Train Acc: 0.7162
 Site-SynthDigits| Train Loss: 1.0720 | Train Acc: 0.7838
 Site-MNIST-M   | Train Loss: 1.9346 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.6349 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6609 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7757 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.7939 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7401 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.7735 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.1555 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.1961 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 1.1104 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 1.9497 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7364
Aggregated Acc | Val Acc: 0.5968
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:27 | Val Acc: 0.4242
 Best site-USPS       | Epoch:27 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.7959
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.7857
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 28 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 1.0145 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.6765 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.7375 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.7422 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6501 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.7432 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.9490 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.1927 | Train Acc: 0.7162
 Site-SynthDigits| Train Loss: 1.1086 | Train Acc: 0.7973
 Site-MNIST-M   | Train Loss: 1.8244 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.6344 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6543 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7573 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7763 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7240 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.7660 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 1.1214 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.1658 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 1.0870 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 1.9557 | Val  Acc: 0.1818
Average Valid Accuracy: 0.7416
Aggregated Acc | Val Acc: 0.6037
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:28 | Val Acc: 0.4545
 Best site-USPS       | Epoch:28 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7959
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7857
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 29 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-1
cnt=[2, 1, 5, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.9031 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.6511 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.7623 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7157 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6586 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.5414 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.9250 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.1588 | Train Acc: 0.7162
 Site-SynthDigits| Train Loss: 1.0116 | Train Acc: 0.7973
 Site-MNIST-M   | Train Loss: 1.8218 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.6062 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6338 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7380 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7525 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.7057 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.7422 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 1.1077 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1501 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 1.0593 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 1.9501 | Val  Acc: 0.2273
Average Valid Accuracy: 0.7512
Aggregated Acc | Val Acc: 0.6203
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:29 | Val Acc: 0.4545
 Best site-USPS       | Epoch:29 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.7959
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.7857
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.7721
 Test site-SVHN      | Epoch:29 | Test Acc: 0.3300
 Test site-USPS      | Epoch:29 | Test Acc: 0.7419
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.6004
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.3057
Average Test Accuracy: 0.5500
============ Train epoch 30 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-0
cnt=[1, 5, 1, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.9474 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.6260 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.7124 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.6954 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6193 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.6332 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.9281 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.1350 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 1.0031 | Train Acc: 0.8041
 Site-MNIST-M   | Train Loss: 1.9306 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 0.5743 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6093 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.7176 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.7267 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6881 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.7129 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.0900 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1431 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 1.0341 | Val  Acc: 0.7959
 Site-MNIST-M   | Val  Loss: 1.9356 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7640
Aggregated Acc | Val Acc: 0.6370
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:30 | Val Acc: 0.4242
 Best site-USPS       | Epoch:30 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8163
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.7959
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 31 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.8924 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6011 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.7228 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.6765 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.5913 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.5511 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.9304 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0923 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 1.0197 | Train Acc: 0.8041
 Site-MNIST-M   | Train Loss: 2.1067 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.5477 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5867 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6950 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.7057 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6743 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.6965 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.0822 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.1390 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 1.0114 | Val  Acc: 0.8061
 Site-MNIST-M   | Val  Loss: 1.9223 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7661
Aggregated Acc | Val Acc: 0.6402
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:31 | Val Acc: 0.4242
 Best site-USPS       | Epoch:31 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.8163
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.8061
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 32 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.9144 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.5972 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.7361 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.6600 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.5711 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.7729 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.9022 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0766 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.9899 | Train Acc: 0.8176
 Site-MNIST-M   | Train Loss: 2.0209 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.5413 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5781 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6831 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6920 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6624 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.6694 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.0671 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.1109 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.9839 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.8988 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7712
Aggregated Acc | Val Acc: 0.6453
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:32 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:32 | Val Acc: 0.4242
 Best site-USPS       | Epoch:32 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8367
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 33 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
cnt=[5, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.8411 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.5780 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6700 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.6472 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.5777 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.5633 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.8581 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0487 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.9740 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 1.7206 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.5308 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5685 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6680 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6777 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6492 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.6453 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.0481 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.0908 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.9660 | Val  Acc: 0.8163
 Site-MNIST-M   | Val  Loss: 1.8803 | Val  Acc: 0.4545
Average Valid Accuracy: 0.7783
Aggregated Acc | Val Acc: 0.6614
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:33 | Val Acc: 0.4242
 Best site-USPS       | Epoch:33 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.8163
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 34 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-0
client-3 is in G-4
client-4 is in G-4
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[1, 2, 2, 1, 4, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.8879 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.5673 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6991 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.6287 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.5735 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.6739 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.8438 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.0450 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.9048 | Train Acc: 0.8176
 Site-MNIST-M   | Train Loss: 1.9756 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.5233 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5595 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6548 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6668 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6381 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.6396 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.0311 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0542 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.9388 | Val  Acc: 0.7959
 Site-MNIST-M   | Val  Loss: 1.8732 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7764
Aggregated Acc | Val Acc: 0.7574
============ Train epoch 35 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[1, 2, 5, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.8346 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5591 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6736 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6287 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5687 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.5798 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.8495 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9964 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 0.9088 | Train Acc: 0.8176
 Site-MNIST-M   | Train Loss: 2.1303 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.5226 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5554 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6476 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6576 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.6270 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.6083 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 1.0107 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0321 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.9215 | Val  Acc: 0.8061
 Site-MNIST-M   | Val  Loss: 1.8596 | Val  Acc: 0.4545
Average Valid Accuracy: 0.7850
Aggregated Acc | Val Acc: 0.6739
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:35 | Val Acc: 0.4545
 Best site-USPS       | Epoch:35 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.8061
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 36 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.8570 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5460 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.7007 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6120 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5482 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.5002 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.8433 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9844 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.9127 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 1.6384 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.5108 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5455 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6353 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6440 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.6141 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.5968 | Val  Acc: 0.4848
 Site-USPS      | Val  Loss: 0.9923 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0257 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.9051 | Val  Acc: 0.8061
 Site-MNIST-M   | Val  Loss: 1.8608 | Val  Acc: 0.4545
Average Valid Accuracy: 0.7931
Aggregated Acc | Val Acc: 0.6875
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:36 | Val Acc: 0.4848
 Best site-USPS       | Epoch:36 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8061
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 37 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.7946 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5409 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6884 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6082 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5597 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.4066 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.7909 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9943 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 0.8881 | Train Acc: 0.8176
 Site-MNIST-M   | Train Loss: 1.5234 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.5132 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5470 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.6315 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6380 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.6019 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.5842 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 0.9843 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0061 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.8856 | Val  Acc: 0.8265
 Site-MNIST-M   | Val  Loss: 1.8738 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7816
Aggregated Acc | Val Acc: 0.6604
============ Train epoch 38 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.8697 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5133 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6608 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.5857 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5182 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.5174 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 0.8098 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9962 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.8471 | Train Acc: 0.8243
 Site-MNIST-M   | Train Loss: 1.5108 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.4824 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5241 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.6093 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6161 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5915 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.5795 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 0.9781 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9833 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.8609 | Val  Acc: 0.8265
 Site-MNIST-M   | Val  Loss: 1.8785 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7929
Aggregated Acc | Val Acc: 0.6692
============ Train epoch 39 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-1
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[1, 1, 2, 1, 5, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.7250 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5003 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6284 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.5668 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5060 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.3258 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.8099 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9440 | Train Acc: 0.7973
 Site-SynthDigits| Train Loss: 0.8867 | Train Acc: 0.8243
 Site-MNIST-M   | Train Loss: 1.5859 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.4606 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5048 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5922 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5991 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5806 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.5425 | Val  Acc: 0.4848
 Site-USPS      | Val  Loss: 0.9805 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.9672 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.8397 | Val  Acc: 0.8265
 Site-MNIST-M   | Val  Loss: 1.8463 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7970
Aggregated Acc | Val Acc: 0.6775
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:39 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:39 | Val Acc: 0.4848
 Best site-USPS       | Epoch:39 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8265
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8036
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3516
 Test site-USPS      | Epoch:39 | Test Acc: 0.7581
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.6596
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.3293
Average Test Accuracy: 0.5804
============ Train epoch 40 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.8021 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4939 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6620 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5551 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4938 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.3075 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7844 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9499 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.8187 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 1.6446 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.4474 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4936 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5791 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5851 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5711 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.5190 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 0.9766 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9449 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.8183 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.8336 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8059
Aggregated Acc | Val Acc: 0.6835
 Best site-MNIST      | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:40 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:40 | Val Acc: 0.4545
 Best site-USPS       | Epoch:40 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8367
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.4091
 Test site-MNIST     | Epoch:40 | Test Acc: 0.8050
 Test site-SVHN      | Epoch:40 | Test Acc: 0.3537
 Test site-USPS      | Epoch:40 | Test Acc: 0.7527
 Test site-SynthDigits| Epoch:40 | Test Acc: 0.6669
 Test site-MNIST-M   | Epoch:40 | Test Acc: 0.3314
Average Test Accuracy: 0.5819
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 41 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
cnt=[5, 1, 1, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.7488 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4840 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.6291 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5466 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4823 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.2556 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.7579 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.9083 | Train Acc: 0.7973
 Site-SynthDigits| Train Loss: 0.7833 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 1.6970 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.4415 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4871 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5727 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5767 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5612 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.4992 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 0.9592 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9376 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.8028 | Val  Acc: 0.8571
 Site-MNIST-M   | Val  Loss: 1.8379 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8099
Aggregated Acc | Val Acc: 0.6876
 Best site-MNIST      | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:41 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:41 | Val Acc: 0.4545
 Best site-USPS       | Epoch:41 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.8571
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.4091
 Test site-MNIST     | Epoch:41 | Test Acc: 0.8086
 Test site-SVHN      | Epoch:41 | Test Acc: 0.3516
 Test site-USPS      | Epoch:41 | Test Acc: 0.7473
 Test site-SynthDigits| Epoch:41 | Test Acc: 0.6686
 Test site-MNIST-M   | Epoch:41 | Test Acc: 0.3407
Average Test Accuracy: 0.5834
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 42 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.7537 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4742 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6172 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.5359 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4736 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.2809 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7596 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.8972 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.8027 | Train Acc: 0.8514
 Site-MNIST-M   | Train Loss: 1.5685 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.4350 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4807 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5613 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5639 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5526 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.4981 | Val  Acc: 0.4848
 Site-USPS      | Val  Loss: 0.9383 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9361 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.7906 | Val  Acc: 0.8673
 Site-MNIST-M   | Val  Loss: 1.8263 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8132
Aggregated Acc | Val Acc: 0.7016
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:42 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:42 | Val Acc: 0.4848
 Best site-USPS       | Epoch:42 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.8673
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.4545
 Test site-MNIST     | Epoch:42 | Test Acc: 0.8114
 Test site-SVHN      | Epoch:42 | Test Acc: 0.3552
 Test site-USPS      | Epoch:42 | Test Acc: 0.7527
 Test site-SynthDigits| Epoch:42 | Test Acc: 0.6733
 Test site-MNIST-M   | Epoch:42 | Test Acc: 0.3414
Average Test Accuracy: 0.5868
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.7289 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4723 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6145 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5206 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4693 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.2956 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.7117 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.8667 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.7754 | Train Acc: 0.8514
 Site-MNIST-M   | Train Loss: 2.0896 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.4286 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4702 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5465 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5521 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5453 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.4812 | Val  Acc: 0.4545
 Site-USPS      | Val  Loss: 0.9330 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9095 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.7738 | Val  Acc: 0.8673
 Site-MNIST-M   | Val  Loss: 1.7992 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8056
Aggregated Acc | Val Acc: 0.6865
 Test site-MNIST     | Epoch:42 | Test Acc: 0.8100
 Test site-SVHN      | Epoch:42 | Test Acc: 0.3597
 Test site-USPS      | Epoch:42 | Test Acc: 0.7527
 Test site-SynthDigits| Epoch:42 | Test Acc: 0.6778
 Test site-MNIST-M   | Epoch:42 | Test Acc: 0.3336
Average Test Accuracy: 0.5867
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
cnt=[5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.8375 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4728 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5581 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5169 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.4670 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.2452 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7153 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.8637 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.7625 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 1.4534 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.4289 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4710 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5462 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.5472 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5362 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.4637 | Val  Acc: 0.4848
 Site-USPS      | Val  Loss: 0.9097 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9117 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7698 | Val  Acc: 0.8469
 Site-MNIST-M   | Val  Loss: 1.8090 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8054
Aggregated Acc | Val Acc: 0.6961
 Test site-MNIST     | Epoch:42 | Test Acc: 0.8129
 Test site-SVHN      | Epoch:42 | Test Acc: 0.3758
 Test site-USPS      | Epoch:42 | Test Acc: 0.7581
 Test site-SynthDigits| Epoch:42 | Test Acc: 0.6751
 Test site-MNIST-M   | Epoch:42 | Test Acc: 0.3471
Average Test Accuracy: 0.5938
============ Train epoch 45 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.8504 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4504 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6257 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5123 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.4437 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.3149 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.7220 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.8821 | Train Acc: 0.7973
 Site-SynthDigits| Train Loss: 0.8153 | Train Acc: 0.8311
 Site-MNIST-M   | Train Loss: 1.7983 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.4122 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4564 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5357 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5369 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5277 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.4720 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 0.9042 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.8959 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7575 | Val  Acc: 0.8367
 Site-MNIST-M   | Val  Loss: 1.8406 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7971
Aggregated Acc | Val Acc: 0.6752
 Test site-MNIST     | Epoch:42 | Test Acc: 0.8171
 Test site-SVHN      | Epoch:42 | Test Acc: 0.3783
 Test site-USPS      | Epoch:42 | Test Acc: 0.7581
 Test site-SynthDigits| Epoch:42 | Test Acc: 0.6714
 Test site-MNIST-M   | Epoch:42 | Test Acc: 0.3514
Average Test Accuracy: 0.5953
============ Train epoch 46 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[5, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.7105 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4580 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5846 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5093 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.4293 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.3347 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.6881 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.8576 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.7000 | Train Acc: 0.8446
 Site-MNIST-M   | Train Loss: 1.8740 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.4145 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4550 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5302 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.5322 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5195 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.4499 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 0.8928 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.8906 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 0.7455 | Val  Acc: 0.8571
 Site-MNIST-M   | Val  Loss: 1.8245 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8016
Aggregated Acc | Val Acc: 0.6855
 Test site-MNIST     | Epoch:42 | Test Acc: 0.8129
 Test site-SVHN      | Epoch:42 | Test Acc: 0.3869
 Test site-USPS      | Epoch:42 | Test Acc: 0.7581
 Test site-SynthDigits| Epoch:42 | Test Acc: 0.6771
 Test site-MNIST-M   | Epoch:42 | Test Acc: 0.3529
Average Test Accuracy: 0.5975
============ Train epoch 47 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
cnt=[2, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.7002 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4479 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5791 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.4925 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.4538 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.4704 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.7047 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.8142 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.7231 | Train Acc: 0.8514
 Site-MNIST-M   | Train Loss: 1.2325 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.4100 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4460 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5187 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.5239 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5128 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.4288 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 0.8817 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.8760 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.7327 | Val  Acc: 0.8673
 Site-MNIST-M   | Val  Loss: 1.7756 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8068
Aggregated Acc | Val Acc: 0.6949
 Test site-MNIST     | Epoch:42 | Test Acc: 0.8171
 Test site-SVHN      | Epoch:42 | Test Acc: 0.3945
 Test site-USPS      | Epoch:42 | Test Acc: 0.7527
 Test site-SynthDigits| Epoch:42 | Test Acc: 0.6832
 Test site-MNIST-M   | Epoch:42 | Test Acc: 0.3586
Average Test Accuracy: 0.6012
============ Train epoch 48 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
cnt=[1, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.8253 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4260 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6022 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.4772 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4195 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.3836 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.7086 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.7997 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.7123 | Train Acc: 0.8716
 Site-MNIST-M   | Train Loss: 1.4192 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.3860 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4288 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.5049 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.5077 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5050 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.4304 | Val  Acc: 0.5152
 Site-USPS      | Val  Loss: 0.8910 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 0.8738 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.7177 | Val  Acc: 0.8673
 Site-MNIST-M   | Val  Loss: 1.7445 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8149
Aggregated Acc | Val Acc: 0.7089
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:48 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:48 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:48 | Val Acc: 0.5152
 Best site-USPS       | Epoch:48 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.8673
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.5000
 Test site-MNIST     | Epoch:48 | Test Acc: 0.8186
 Test site-SVHN      | Epoch:48 | Test Acc: 0.3904
 Test site-USPS      | Epoch:48 | Test Acc: 0.7581
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.6956
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.3586
Average Test Accuracy: 0.6042
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
============ Train epoch 49 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
cnt=[1, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-MNIST     | Train Loss: 0.7171 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4285 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6424 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.4691 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4298 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.3606 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.7146 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.8118 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.6726 | Train Acc: 0.8716
 Site-MNIST-M   | Train Loss: 1.2902 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.3775 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4227 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.4981 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.4997 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.4986 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.4022 | Val  Acc: 0.5152
 Site-USPS      | Val  Loss: 0.8921 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.8487 | Val  Acc: 0.8776
 Site-SynthDigits| Val  Loss: 0.6980 | Val  Acc: 0.8776
 Site-MNIST-M   | Val  Loss: 1.7411 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8193
Aggregated Acc | Val Acc: 0.7168
 Best site-MNIST      | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:49 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:49 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:49 | Val Acc: 0.5152
 Best site-USPS       | Epoch:49 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.8776
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.8776
 Best site-MNIST-M    | Epoch:49 | Val Acc: 0.5000
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8193
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3889
 Test site-USPS      | Epoch:49 | Test Acc: 0.7581
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.6978
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.3586
Average Test Accuracy: 0.6045
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/nova...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8193
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3889
 Test site-USPS      | Epoch:49 | Test Acc: 0.7581
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.6978
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.3586
Average Test Accuracy: 0.6045
===2023-04-19 07:05:02===
===2023-04-19 07:05:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8200
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3904
 Test site-USPS      | Epoch:49 | Test Acc: 0.7366
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.7038
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.3657
Average Test Accuracy: 0.6033
