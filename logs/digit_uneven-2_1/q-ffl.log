===2023-04-18 16:29:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
===2023-04-18 16:29:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
=================================
 ==== model type: prompt ====
=================================
============ Train epoch 0 ============
===2023-04-18 16:30:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
=================================
 ==== model type: prompt ====
=================================
Loading snapshots...
===2023-04-18 18:30:53===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
=================================
 ==== model type: CoCoOP ====
=================================
============ Train epoch 0 ============
denominator: 57887.74609375
 Site-MNIST     | Train Loss: 2.2299 | Train Acc: 0.0870
 Site-MNIST     | Train Loss: 2.2990 | Train Acc: 0.0213
 Site-MNIST     | Train Loss: 2.3141 | Train Acc: 0.0986
 Site-MNIST     | Train Loss: 2.2997 | Train Acc: 0.0957
 Site-MNIST     | Train Loss: 2.2920 | Train Acc: 0.0678
 Site-SVHN      | Train Loss: 2.3155 | Train Acc: 0.0800
 Site-USPS      | Train Loss: 2.4296 | Train Acc: 0.0227
 Site-SynthDigits| Train Loss: 2.3528 | Train Acc: 0.0946
 Site-SynthDigits| Train Loss: 2.2730 | Train Acc: 0.1284
 Site-MNIST-M   | Train Loss: 2.2877 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.3471 | Val  Acc: 0.1333
 Site-MNIST     | Val  Loss: 2.3062 | Val  Acc: 0.0968
 Site-MNIST     | Val  Loss: 2.2819 | Val  Acc: 0.0851
 Site-MNIST     | Val  Loss: 2.3045 | Val  Acc: 0.1270
 Site-MNIST     | Val  Loss: 2.3322 | Val  Acc: 0.0886
 Site-SVHN      | Val  Loss: 2.3513 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.3943 | Val  Acc: 0.0690
 Site-SynthDigits| Val  Loss: 2.3063 | Val  Acc: 0.1020
 Site-SynthDigits| Val  Loss: 2.2794 | Val  Acc: 0.1122
 Site-MNIST-M   | Val  Loss: 2.4005 | Val  Acc: 0.1364
Average Valid Accuracy: 0.1041
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1333
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0968
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0851
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1270
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0886
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0909
 Best site-USPS       | Epoch:0 | Val Acc: 0.0690
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1020
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1122
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 1 ============
denominator: 52100.41796875
 Site-MNIST     | Train Loss: 2.1754 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.1871 | Train Acc: 0.0638
 Site-MNIST     | Train Loss: 2.1757 | Train Acc: 0.1831
 Site-MNIST     | Train Loss: 2.1790 | Train Acc: 0.2766
 Site-MNIST     | Train Loss: 2.1965 | Train Acc: 0.1864
 Site-SVHN      | Train Loss: 2.2891 | Train Acc: 0.1000
 Site-USPS      | Train Loss: 2.3129 | Train Acc: 0.0682
 Site-SynthDigits| Train Loss: 2.2801 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.2430 | Train Acc: 0.1554
 Site-MNIST-M   | Train Loss: 2.3387 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.2176 | Val  Acc: 0.2667
 Site-MNIST     | Val  Loss: 2.1886 | Val  Acc: 0.2581
 Site-MNIST     | Val  Loss: 2.1793 | Val  Acc: 0.2340
 Site-MNIST     | Val  Loss: 2.1844 | Val  Acc: 0.2381
 Site-MNIST     | Val  Loss: 2.2004 | Val  Acc: 0.1899
 Site-SVHN      | Val  Loss: 2.3002 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 2.3158 | Val  Acc: 0.1034
 Site-SynthDigits| Val  Loss: 2.2722 | Val  Acc: 0.0816
 Site-SynthDigits| Val  Loss: 2.2520 | Val  Acc: 0.1327
 Site-MNIST-M   | Val  Loss: 2.3606 | Val  Acc: 0.1818
Average Valid Accuracy: 0.1838
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2581
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2340
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2381
 Best site-MNIST      | Epoch:1 | Val Acc: 0.1899
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1515
 Best site-USPS       | Epoch:1 | Val Acc: 0.1034
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.0816
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1327
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 2 ============
denominator: 48996.6640625
 Site-MNIST     | Train Loss: 2.0860 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0764 | Train Acc: 0.2766
 Site-MNIST     | Train Loss: 2.1110 | Train Acc: 0.2817
 Site-MNIST     | Train Loss: 2.0676 | Train Acc: 0.3298
 Site-MNIST     | Train Loss: 2.0737 | Train Acc: 0.3220
 Site-SVHN      | Train Loss: 2.2749 | Train Acc: 0.1600
 Site-USPS      | Train Loss: 2.2047 | Train Acc: 0.2045
 Site-SynthDigits| Train Loss: 2.2559 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.2272 | Train Acc: 0.2027
 Site-MNIST-M   | Train Loss: 2.3359 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.0954 | Val  Acc: 0.3333
 Site-MNIST     | Val  Loss: 2.0727 | Val  Acc: 0.2903
 Site-MNIST     | Val  Loss: 2.0765 | Val  Acc: 0.3404
 Site-MNIST     | Val  Loss: 2.0756 | Val  Acc: 0.3492
 Site-MNIST     | Val  Loss: 2.0852 | Val  Acc: 0.2911
 Site-SVHN      | Val  Loss: 2.2498 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 2.2358 | Val  Acc: 0.2759
 Site-SynthDigits| Val  Loss: 2.2406 | Val  Acc: 0.1224
 Site-SynthDigits| Val  Loss: 2.2207 | Val  Acc: 0.1939
 Site-MNIST-M   | Val  Loss: 2.3310 | Val  Acc: 0.1364
Average Valid Accuracy: 0.2545
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.2903
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3404
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3492
 Best site-MNIST      | Epoch:2 | Val Acc: 0.2911
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2121
 Best site-USPS       | Epoch:2 | Val Acc: 0.2759
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1224
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1939
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 3 ============
denominator: 47522.55859375
 Site-MNIST     | Train Loss: 1.9957 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9694 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.9896 | Train Acc: 0.4085
 Site-MNIST     | Train Loss: 1.9545 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.9587 | Train Acc: 0.4237
 Site-SVHN      | Train Loss: 2.2212 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.1179 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 2.2006 | Train Acc: 0.1892
 Site-SynthDigits| Train Loss: 2.1714 | Train Acc: 0.2635
 Site-MNIST-M   | Train Loss: 2.5406 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.9767 | Val  Acc: 0.4667
 Site-MNIST     | Val  Loss: 1.9611 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 1.9766 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 1.9732 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.9776 | Val  Acc: 0.4304
 Site-SVHN      | Val  Loss: 2.2097 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 2.1696 | Val  Acc: 0.3793
 Site-SynthDigits| Val  Loss: 2.2229 | Val  Acc: 0.2245
 Site-SynthDigits| Val  Loss: 2.1892 | Val  Acc: 0.2245
 Site-MNIST-M   | Val  Loss: 2.3072 | Val  Acc: 0.1364
Average Valid Accuracy: 0.3511
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4667
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4468
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4762
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4304
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2424
 Best site-USPS       | Epoch:3 | Val Acc: 0.3793
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2245
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2245
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 4 ============
denominator: 45659.59375
 Site-MNIST     | Train Loss: 1.9518 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.8645 | Train Acc: 0.5319
 Site-MNIST     | Train Loss: 1.8908 | Train Acc: 0.5634
 Site-MNIST     | Train Loss: 1.8716 | Train Acc: 0.5319
 Site-MNIST     | Train Loss: 1.8640 | Train Acc: 0.5593
 Site-SVHN      | Train Loss: 2.1678 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 2.0332 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.1534 | Train Acc: 0.2297
 Site-SynthDigits| Train Loss: 2.1547 | Train Acc: 0.3041
 Site-MNIST-M   | Train Loss: 2.5070 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.8724 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8648 | Val  Acc: 0.6774
 Site-MNIST     | Val  Loss: 1.8881 | Val  Acc: 0.5532
 Site-MNIST     | Val  Loss: 1.8795 | Val  Acc: 0.5079
 Site-MNIST     | Val  Loss: 1.8752 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.1753 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 2.1011 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2061 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.1570 | Val  Acc: 0.2755
 Site-MNIST-M   | Val  Loss: 2.2740 | Val  Acc: 0.1364
Average Valid Accuracy: 0.4274
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6774
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5532
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5079
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5316
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2121
 Best site-USPS       | Epoch:4 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2653
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2755
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 5 ============
denominator: 44639.921875
 Site-MNIST     | Train Loss: 1.8312 | Train Acc: 0.4348
 Site-MNIST     | Train Loss: 1.7457 | Train Acc: 0.6170
 Site-MNIST     | Train Loss: 1.7705 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.7640 | Train Acc: 0.6064
 Site-MNIST     | Train Loss: 1.7425 | Train Acc: 0.6271
 Site-SVHN      | Train Loss: 2.0903 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 1.9432 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.1060 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.0927 | Train Acc: 0.3041
 Site-MNIST-M   | Train Loss: 2.2981 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.7474 | Val  Acc: 0.7333
 Site-MNIST     | Val  Loss: 1.7476 | Val  Acc: 0.7419
 Site-MNIST     | Val  Loss: 1.7836 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.7783 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7670 | Val  Acc: 0.5949
 Site-SVHN      | Val  Loss: 2.1370 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 2.0286 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.1842 | Val  Acc: 0.2449
 Site-SynthDigits| Val  Loss: 2.1176 | Val  Acc: 0.2959
 Site-MNIST-M   | Val  Loss: 2.2499 | Val  Acc: 0.1364
Average Valid Accuracy: 0.4708
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7333
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7419
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6596
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5949
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2121
 Best site-USPS       | Epoch:5 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2449
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2959
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 6 ============
denominator: 43026.359375
 Site-MNIST     | Train Loss: 1.7374 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.6360 | Train Acc: 0.6596
 Site-MNIST     | Train Loss: 1.6405 | Train Acc: 0.7042
 Site-MNIST     | Train Loss: 1.6748 | Train Acc: 0.6489
 Site-MNIST     | Train Loss: 1.6235 | Train Acc: 0.6864
 Site-SVHN      | Train Loss: 2.0362 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.8776 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.0657 | Train Acc: 0.2973
 Site-SynthDigits| Train Loss: 2.0526 | Train Acc: 0.3378
 Site-MNIST-M   | Train Loss: 2.4578 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.6469 | Val  Acc: 0.7333
 Site-MNIST     | Val  Loss: 1.6517 | Val  Acc: 0.7742
 Site-MNIST     | Val  Loss: 1.6952 | Val  Acc: 0.6809
 Site-MNIST     | Val  Loss: 1.6879 | Val  Acc: 0.6032
 Site-MNIST     | Val  Loss: 1.6676 | Val  Acc: 0.6835
 Site-SVHN      | Val  Loss: 2.1135 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 1.9613 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.1555 | Val  Acc: 0.2449
 Site-SynthDigits| Val  Loss: 2.0788 | Val  Acc: 0.2857
 Site-MNIST-M   | Val  Loss: 2.2317 | Val  Acc: 0.0909
Average Valid Accuracy: 0.4826
 Best site-MNIST      | Epoch:6 | Val Acc: 0.7333
 Best site-MNIST      | Epoch:6 | Val Acc: 0.7742
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6809
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6032
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6835
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2121
 Best site-USPS       | Epoch:6 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.2449
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.2857
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 7 ============
denominator: 41500.9765625
 Site-MNIST     | Train Loss: 1.6037 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.5286 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.5878 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.5792 | Train Acc: 0.6702
 Site-MNIST     | Train Loss: 1.5539 | Train Acc: 0.7288
 Site-SVHN      | Train Loss: 2.0945 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.7916 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.0198 | Train Acc: 0.2838
 Site-SynthDigits| Train Loss: 2.0437 | Train Acc: 0.3108
 Site-MNIST-M   | Train Loss: 2.3689 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.5365 | Val  Acc: 0.7333
 Site-MNIST     | Val  Loss: 1.5491 | Val  Acc: 0.7742
 Site-MNIST     | Val  Loss: 1.6029 | Val  Acc: 0.7021
 Site-MNIST     | Val  Loss: 1.5960 | Val  Acc: 0.6032
 Site-MNIST     | Val  Loss: 1.5757 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.1079 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 1.9028 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 2.1238 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.0396 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.2133 | Val  Acc: 0.0909
Average Valid Accuracy: 0.4961
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7333
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7742
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7021
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6032
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2121
 Best site-USPS       | Epoch:7 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.2653
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3061
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 8 ============
denominator: 41171.36328125
 Site-MNIST     | Train Loss: 1.6256 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.4155 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.5006 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.4892 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.4167 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 1.9932 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 1.7049 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.9761 | Train Acc: 0.3243
 Site-SynthDigits| Train Loss: 1.9867 | Train Acc: 0.3311
 Site-MNIST-M   | Train Loss: 2.3730 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 1.4251 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.4408 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.4997 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.5031 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.4767 | Val  Acc: 0.7342
 Site-SVHN      | Val  Loss: 2.1058 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.8470 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.0814 | Val  Acc: 0.2857
 Site-SynthDigits| Val  Loss: 1.9992 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.1885 | Val  Acc: 0.1364
Average Valid Accuracy: 0.5339
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7342
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2727
 Best site-USPS       | Epoch:8 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.2857
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3061
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 9 ============
denominator: 39076.421875
 Site-MNIST     | Train Loss: 1.4777 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.3382 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.3867 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.4084 | Train Acc: 0.7128
 Site-MNIST     | Train Loss: 1.3424 | Train Acc: 0.8051
 Site-SVHN      | Train Loss: 2.0126 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 1.6315 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.9318 | Train Acc: 0.3108
 Site-SynthDigits| Train Loss: 1.9339 | Train Acc: 0.3784
 Site-MNIST-M   | Train Loss: 2.1541 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 1.3385 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.3535 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.4207 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.4314 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.3830 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.0930 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.7809 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.0403 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 1.9676 | Val  Acc: 0.3571
 Site-MNIST-M   | Val  Loss: 2.1663 | Val  Acc: 0.1364
Average Valid Accuracy: 0.5581
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3030
 Best site-USPS       | Epoch:9 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3061
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3571
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.6350
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2413
 Test site-USPS      | Epoch:9 | Test Acc: 0.6075
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.3382
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.2271
Average Test Accuracy: 0.4098
============ Train epoch 10 ============
denominator: 38274.83984375
 Site-MNIST     | Train Loss: 1.4310 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.2565 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.3427 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.3247 | Train Acc: 0.7447
 Site-MNIST     | Train Loss: 1.2768 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.0943 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 1.5751 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.9048 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 1.9014 | Train Acc: 0.3851
 Site-MNIST-M   | Train Loss: 2.2765 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 1.2437 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.2638 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.3418 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 1.3512 | Val  Acc: 0.6984
 Site-MNIST     | Val  Loss: 1.2948 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 2.0686 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.7266 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.0294 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 1.9373 | Val  Acc: 0.3571
 Site-MNIST-M   | Val  Loss: 2.1497 | Val  Acc: 0.1364
Average Valid Accuracy: 0.5801
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:10 | Val Acc: 0.6984
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7595
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3333
 Best site-USPS       | Epoch:10 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.3061
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.3571
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 11 ============
denominator: 37626.84375
 Site-MNIST     | Train Loss: 1.3816 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.1761 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.2467 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 1.2554 | Train Acc: 0.7766
 Site-MNIST     | Train Loss: 1.1706 | Train Acc: 0.8305
 Site-SVHN      | Train Loss: 1.9947 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 1.4817 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.8450 | Train Acc: 0.4054
 Site-SynthDigits| Train Loss: 1.8374 | Train Acc: 0.4257
 Site-MNIST-M   | Train Loss: 2.2348 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.1673 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.1852 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.2681 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.2809 | Val  Acc: 0.7460
 Site-MNIST     | Val  Loss: 1.2132 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 2.0500 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.6582 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.9999 | Val  Acc: 0.3469
 Site-SynthDigits| Val  Loss: 1.9000 | Val  Acc: 0.3980
 Site-MNIST-M   | Val  Loss: 2.1238 | Val  Acc: 0.2273
Average Valid Accuracy: 0.6145
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7460
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3636
 Best site-USPS       | Epoch:11 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.3469
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.3980
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 12 ============
denominator: 36263.35546875
 Site-MNIST     | Train Loss: 1.2525 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 1.0840 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.1631 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 1.1715 | Train Acc: 0.7979
 Site-MNIST     | Train Loss: 1.0905 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.0533 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.4474 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.8219 | Train Acc: 0.4054
 Site-SynthDigits| Train Loss: 1.8315 | Train Acc: 0.4189
 Site-MNIST-M   | Train Loss: 2.1916 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 1.0764 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.0985 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.1846 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.2007 | Val  Acc: 0.7302
 Site-MNIST     | Val  Loss: 1.1444 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 2.0420 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.6086 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.9700 | Val  Acc: 0.3265
 Site-SynthDigits| Val  Loss: 1.8622 | Val  Acc: 0.4388
 Site-MNIST-M   | Val  Loss: 2.1048 | Val  Acc: 0.2273
Average Valid Accuracy: 0.6150
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7302
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3636
 Best site-USPS       | Epoch:12 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.3265
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.4388
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 13 ============
denominator: 35988.6875
 Site-MNIST     | Train Loss: 1.2337 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 1.0160 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 1.0737 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 1.0995 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.0101 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 1.9836 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.3509 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.7896 | Train Acc: 0.4459
 Site-SynthDigits| Train Loss: 1.7566 | Train Acc: 0.4730
 Site-MNIST-M   | Train Loss: 2.1902 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.9956 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.0202 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.1151 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.1312 | Val  Acc: 0.7778
 Site-MNIST     | Val  Loss: 1.0770 | Val  Acc: 0.8101
 Site-SVHN      | Val  Loss: 2.0291 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.5479 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.9413 | Val  Acc: 0.3673
 Site-SynthDigits| Val  Loss: 1.8219 | Val  Acc: 0.4694
 Site-MNIST-M   | Val  Loss: 2.0843 | Val  Acc: 0.2727
Average Valid Accuracy: 0.6378
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:13 | Val Acc: 0.7778
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8101
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3939
 Best site-USPS       | Epoch:13 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.3673
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.4694
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 14 ============
denominator: 34329.421875
 Site-MNIST     | Train Loss: 1.2080 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.9616 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 1.0238 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 1.0423 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.9857 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 2.0350 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.3140 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.7191 | Train Acc: 0.4730
 Site-SynthDigits| Train Loss: 1.7497 | Train Acc: 0.4865
 Site-MNIST-M   | Train Loss: 2.2118 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.9318 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.9537 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.0590 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.0787 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.0157 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.0039 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.4806 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.8703 | Val  Acc: 0.4490
 Site-SynthDigits| Val  Loss: 1.7746 | Val  Acc: 0.4796
 Site-MNIST-M   | Val  Loss: 2.0814 | Val  Acc: 0.2273
Average Valid Accuracy: 0.6606
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:14 | Val Acc: 0.4242
 Best site-USPS       | Epoch:14 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.4490
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.4796
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 15 ============
denominator: 33698.18359375
 Site-MNIST     | Train Loss: 1.1767 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.8984 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.9858 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.9838 | Train Acc: 0.8404
 Site-MNIST     | Train Loss: 0.8821 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.9754 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.2458 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.6810 | Train Acc: 0.4595
 Site-SynthDigits| Train Loss: 1.7001 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.2017 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 0.8700 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8917 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9997 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.0219 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.9569 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.9870 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.4253 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.8421 | Val  Acc: 0.4286
 Site-SynthDigits| Val  Loss: 1.7424 | Val  Acc: 0.4898
 Site-MNIST-M   | Val  Loss: 2.0759 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6563
============ Train epoch 16 ============
denominator: 33442.19140625
 Site-MNIST     | Train Loss: 1.0508 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.8346 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.9025 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.9225 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.8641 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9223 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 1.1976 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.6595 | Train Acc: 0.4459
 Site-SynthDigits| Train Loss: 1.6594 | Train Acc: 0.5135
 Site-MNIST-M   | Train Loss: 2.0410 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 0.8141 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.8315 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.9392 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.9634 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.8985 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.9808 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.3709 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.8132 | Val  Acc: 0.4286
 Site-SynthDigits| Val  Loss: 1.7044 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.0627 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6682
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:16 | Val Acc: 0.4242
 Best site-USPS       | Epoch:16 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.4286
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 17 ============
denominator: 31888.44921875
 Site-MNIST     | Train Loss: 1.0051 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.7771 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.8890 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.8814 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.7794 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9696 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 1.1592 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.6331 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 1.6243 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.1714 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.7603 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7800 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.8919 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.9171 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.8526 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.9833 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.3325 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.7725 | Val  Acc: 0.4286
 Site-SynthDigits| Val  Loss: 1.6651 | Val  Acc: 0.5102
 Site-MNIST-M   | Val  Loss: 2.0364 | Val  Acc: 0.1818
Average Valid Accuracy: 0.6693
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:17 | Val Acc: 0.4242
 Best site-USPS       | Epoch:17 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.4286
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.5102
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 18 ============
denominator: 31270.21875
 Site-MNIST     | Train Loss: 0.9658 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.7301 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.8512 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.8207 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.7432 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 1.7947 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.1021 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.5928 | Train Acc: 0.4730
 Site-SynthDigits| Train Loss: 1.5697 | Train Acc: 0.5068
 Site-MNIST-M   | Train Loss: 2.1763 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.7061 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.7299 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.8384 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.8642 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.8089 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.9788 | Val  Acc: 0.4242
 Site-USPS      | Val  Loss: 1.2893 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.7442 | Val  Acc: 0.4286
 Site-SynthDigits| Val  Loss: 1.6351 | Val  Acc: 0.5102
 Site-MNIST-M   | Val  Loss: 2.0299 | Val  Acc: 0.2273
Average Valid Accuracy: 0.6792
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:18 | Val Acc: 0.4242
 Best site-USPS       | Epoch:18 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.4286
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.5102
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 19 ============
denominator: 30547.9609375
 Site-MNIST     | Train Loss: 0.9493 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.6899 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.8189 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.7831 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.7069 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9000 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.0741 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.5341 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 1.5682 | Train Acc: 0.5338
 Site-MNIST-M   | Train Loss: 1.7415 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 0.6667 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6866 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.7968 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.8227 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.7677 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.9674 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 1.2390 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.7170 | Val  Acc: 0.4694
 Site-SynthDigits| Val  Loss: 1.6046 | Val  Acc: 0.5306
 Site-MNIST-M   | Val  Loss: 2.0106 | Val  Acc: 0.2727
Average Valid Accuracy: 0.6868
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:19 | Val Acc: 0.3939
 Best site-USPS       | Epoch:19 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.4694
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.5306
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.7736
 Test site-SVHN      | Epoch:19 | Test Acc: 0.2841
 Test site-USPS      | Epoch:19 | Test Acc: 0.7688
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.4663
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.3071
Average Test Accuracy: 0.5200
============ Train epoch 20 ============
denominator: 29715.9921875
 Site-MNIST     | Train Loss: 0.9488 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.6494 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.8071 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.7391 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.6791 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8403 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 1.0305 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.5021 | Train Acc: 0.5270
 Site-SynthDigits| Train Loss: 1.5450 | Train Acc: 0.5473
 Site-MNIST-M   | Train Loss: 2.0225 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.6270 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6457 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.7555 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.7819 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.7305 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.9493 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.1877 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.6893 | Val  Acc: 0.4490
 Site-SynthDigits| Val  Loss: 1.5723 | Val  Acc: 0.5306
 Site-MNIST-M   | Val  Loss: 1.9950 | Val  Acc: 0.3182
Average Valid Accuracy: 0.6832
============ Train epoch 21 ============
denominator: 30172.49609375
 Site-MNIST     | Train Loss: 0.8277 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.6098 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.7532 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.7072 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.6352 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9024 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 0.9638 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.4847 | Train Acc: 0.5270
 Site-SynthDigits| Train Loss: 1.5030 | Train Acc: 0.5608
 Site-MNIST-M   | Train Loss: 1.8487 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.5847 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.6046 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.7211 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.7443 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.6938 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.9272 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.1294 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.6398 | Val  Acc: 0.4694
 Site-SynthDigits| Val  Loss: 1.5272 | Val  Acc: 0.5510
 Site-MNIST-M   | Val  Loss: 1.9629 | Val  Acc: 0.3182
Average Valid Accuracy: 0.6884
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:21 | Val Acc: 0.2727
 Best site-USPS       | Epoch:21 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.4694
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.5510
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 22 ============
denominator: 28480.35546875
 Site-MNIST     | Train Loss: 0.7621 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.5827 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.7531 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6742 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.6401 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.8230 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 0.9637 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.4397 | Train Acc: 0.5541
 Site-SynthDigits| Train Loss: 1.4584 | Train Acc: 0.5811
 Site-MNIST-M   | Train Loss: 1.7434 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.5611 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5792 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.6936 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.7163 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.6620 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.9001 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.0914 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.5812 | Val  Acc: 0.5102
 Site-SynthDigits| Val  Loss: 1.4839 | Val  Acc: 0.5510
 Site-MNIST-M   | Val  Loss: 1.9415 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7057
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:22 | Val Acc: 0.3636
 Best site-USPS       | Epoch:22 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.5102
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.5510
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 23 ============
denominator: 27897.587890625
 Site-MNIST     | Train Loss: 0.8329 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5476 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6782 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6460 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5755 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.8087 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 0.8978 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.4194 | Train Acc: 0.5811
 Site-SynthDigits| Train Loss: 1.4415 | Train Acc: 0.5878
 Site-MNIST-M   | Train Loss: 1.7670 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 0.5314 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5489 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.6583 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6798 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.6286 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.8672 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.0603 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.5468 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.4570 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 1.9279 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7146
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:23 | Val Acc: 0.3636
 Best site-USPS       | Epoch:23 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.5714
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 24 ============
denominator: 27887.1953125
 Site-MNIST     | Train Loss: 0.7950 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.5086 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6266 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.6061 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.5267 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.6896 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.8587 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.3861 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.4034 | Train Acc: 0.6284
 Site-MNIST-M   | Train Loss: 1.7607 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.4945 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.5124 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.6217 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6427 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5947 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.8464 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 1.0184 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.5291 | Val  Acc: 0.5918
 Site-SynthDigits| Val  Loss: 1.4252 | Val  Acc: 0.5816
 Site-MNIST-M   | Val  Loss: 1.9211 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7382
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:24 | Val Acc: 0.3636
 Best site-USPS       | Epoch:24 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.5918
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.5816
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 25 ============
denominator: 27281.50390625
 Site-MNIST     | Train Loss: 0.7140 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4942 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.6313 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.5871 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.5225 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.7744 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.8241 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.3656 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.3886 | Train Acc: 0.6284
 Site-MNIST-M   | Train Loss: 1.9382 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.4796 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4986 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.6006 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.6236 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5734 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.8584 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.9828 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 1.4982 | Val  Acc: 0.6122
 Site-SynthDigits| Val  Loss: 1.3959 | Val  Acc: 0.6020
 Site-MNIST-M   | Val  Loss: 1.9125 | Val  Acc: 0.3182
Average Valid Accuracy: 0.7466
 Best site-MNIST      | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:25 | Val Acc: 0.3030
 Best site-USPS       | Epoch:25 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.6122
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.6020
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 26 ============
denominator: 26610.611328125
 Site-MNIST     | Train Loss: 0.6578 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.4638 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.6019 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.5572 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4946 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.9605 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.7863 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.3161 | Train Acc: 0.6622
 Site-SynthDigits| Train Loss: 1.3600 | Train Acc: 0.6284
 Site-MNIST-M   | Train Loss: 1.9563 | Train Acc: 0.4848
 Site-MNIST     | Val  Loss: 0.4540 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4715 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5709 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.5935 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5409 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.8099 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.9538 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.4466 | Val  Acc: 0.6122
 Site-SynthDigits| Val  Loss: 1.3570 | Val  Acc: 0.6224
 Site-MNIST-M   | Val  Loss: 1.8901 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7599
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:26 | Val Acc: 0.3939
 Best site-USPS       | Epoch:26 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.6122
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.6224
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 27 ============
denominator: 26364.67578125
 Site-MNIST     | Train Loss: 0.5951 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.4349 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.5580 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5365 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4842 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.8182 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 0.7672 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.2600 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 1.2739 | Train Acc: 0.6486
 Site-MNIST-M   | Train Loss: 1.7432 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.4266 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4479 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5522 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5726 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5233 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 1.7686 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.9374 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.4094 | Val  Acc: 0.6327
 Site-SynthDigits| Val  Loss: 1.3237 | Val  Acc: 0.6429
 Site-MNIST-M   | Val  Loss: 1.8737 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7631
 Best site-MNIST      | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:27 | Val Acc: 0.3636
 Best site-USPS       | Epoch:27 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.6327
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.6429
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 28 ============
denominator: 25022.64453125
 Site-MNIST     | Train Loss: 0.6800 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.4206 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.5485 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.5083 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4657 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.6845 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.7710 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.2423 | Train Acc: 0.6622
 Site-SynthDigits| Train Loss: 1.2447 | Train Acc: 0.6622
 Site-MNIST-M   | Train Loss: 1.6697 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.4070 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4269 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5267 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5412 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4968 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 1.7772 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.9096 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.3912 | Val  Acc: 0.6327
 Site-SynthDigits| Val  Loss: 1.2957 | Val  Acc: 0.6327
 Site-MNIST-M   | Val  Loss: 1.8694 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7637
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:28 | Val Acc: 0.3333
 Best site-USPS       | Epoch:28 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.6327
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.6327
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 29 ============
denominator: 26207.23828125
 Site-MNIST     | Train Loss: 0.7141 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.4030 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.5390 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4909 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4258 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.7069 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 0.7260 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.2257 | Train Acc: 0.6757
 Site-SynthDigits| Train Loss: 1.2849 | Train Acc: 0.6824
 Site-MNIST-M   | Train Loss: 1.6848 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.4013 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4152 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.5130 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.5280 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4778 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7519 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.8940 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.3259 | Val  Acc: 0.6735
 Site-SynthDigits| Val  Loss: 1.2534 | Val  Acc: 0.6633
 Site-MNIST-M   | Val  Loss: 1.8617 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7830
 Best site-MNIST      | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:29 | Val Acc: 0.3636
 Best site-USPS       | Epoch:29 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.6735
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.6633
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.8229
 Test site-SVHN      | Epoch:29 | Test Acc: 0.3134
 Test site-USPS      | Epoch:29 | Test Acc: 0.8226
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.5730
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.3521
Average Test Accuracy: 0.5768
============ Train epoch 30 ============
denominator: 24530.611328125
 Site-MNIST     | Train Loss: 0.5889 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3806 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.5395 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4727 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.4141 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.6356 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 0.7036 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.1948 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 1.2286 | Train Acc: 0.6824
 Site-MNIST-M   | Train Loss: 1.7539 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.3679 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3909 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.4941 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.5089 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4645 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7243 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.8841 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.2910 | Val  Acc: 0.6939
 Site-SynthDigits| Val  Loss: 1.2226 | Val  Acc: 0.6735
 Site-MNIST-M   | Val  Loss: 1.8553 | Val  Acc: 0.3636
Average Valid Accuracy: 0.7737
============ Train epoch 31 ============
denominator: 24167.02734375
 Site-MNIST     | Train Loss: 0.5243 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3474 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.5411 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4493 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.3857 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.6526 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.7027 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.1648 | Train Acc: 0.6892
 Site-SynthDigits| Train Loss: 1.1707 | Train Acc: 0.7095
 Site-MNIST-M   | Train Loss: 1.7027 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.3434 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3651 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4649 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.4786 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4429 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7396 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.8554 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 1.2721 | Val  Acc: 0.7347
 Site-SynthDigits| Val  Loss: 1.1997 | Val  Acc: 0.7143
 Site-MNIST-M   | Val  Loss: 1.8508 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7892
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:31 | Val Acc: 0.3030
 Best site-USPS       | Epoch:31 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.7347
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.7143
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 32 ============
denominator: 23892.529296875
 Site-MNIST     | Train Loss: 0.5875 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3404 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.4836 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4363 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.3940 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.7835 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.6688 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.1317 | Train Acc: 0.7162
 Site-SynthDigits| Train Loss: 1.1544 | Train Acc: 0.7297
 Site-MNIST-M   | Train Loss: 1.6821 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.3390 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3574 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4534 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.4679 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4279 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.7007 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.8380 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 1.2260 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.1677 | Val  Acc: 0.7245
 Site-MNIST-M   | Val  Loss: 1.8242 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8024
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:32 | Val Acc: 0.3636
 Best site-USPS       | Epoch:32 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.7245
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 33 ============
denominator: 22895.52734375
 Site-MNIST     | Train Loss: 0.6252 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3347 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4692 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.4240 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.3662 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.5227 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 0.6388 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.1255 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 1.1372 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.7732 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.3343 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3513 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4454 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.4564 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4148 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.6608 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.8250 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.1914 | Val  Acc: 0.7755
 Site-SynthDigits| Val  Loss: 1.1399 | Val  Acc: 0.7449
 Site-MNIST-M   | Val  Loss: 1.7930 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8086
 Best site-MNIST      | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:33 | Val Acc: 0.3939
 Best site-USPS       | Epoch:33 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.7755
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.7449
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 34 ============
denominator: 22747.748046875
 Site-MNIST     | Train Loss: 0.5714 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3230 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4623 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.4089 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3596 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.5259 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.6195 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.0836 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 1.1055 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.8534 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.3199 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3358 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4283 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.4329 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3974 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.6632 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.8135 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.1755 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 1.1209 | Val  Acc: 0.7551
 Site-MNIST-M   | Val  Loss: 1.7900 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8162
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:34 | Val Acc: 0.3939
 Best site-USPS       | Epoch:34 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.7959
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.7551
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 35 ============
denominator: 23265.0625
 Site-MNIST     | Train Loss: 0.5107 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2999 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4405 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3883 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.3380 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.6139 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.6172 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.0899 | Train Acc: 0.7703
 Site-SynthDigits| Train Loss: 1.0766 | Train Acc: 0.7365
 Site-MNIST-M   | Train Loss: 1.5605 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 0.2999 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3227 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4143 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.4171 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3882 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 1.6611 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.7974 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.1758 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 1.1016 | Val  Acc: 0.7551
 Site-MNIST-M   | Val  Loss: 1.7985 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8052
============ Train epoch 36 ============
denominator: 22767.30859375
 Site-MNIST     | Train Loss: 0.5259 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2846 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4581 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3770 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.3324 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.6969 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.6353 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.0351 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 1.0656 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.7114 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.2852 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3070 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.4003 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.4019 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3765 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.6620 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.7894 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.1713 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 1.0830 | Val  Acc: 0.7551
 Site-MNIST-M   | Val  Loss: 1.8035 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8128
============ Train epoch 37 ============
denominator: 22956.716796875
 Site-MNIST     | Train Loss: 0.4880 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2867 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.4521 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3545 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.3011 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.7856 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.6128 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.0397 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 1.0131 | Train Acc: 0.7635
 Site-MNIST-M   | Train Loss: 1.4193 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.2862 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2993 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3878 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.3896 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3583 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 1.6437 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.7754 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 1.1221 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 1.0529 | Val  Acc: 0.7653
 Site-MNIST-M   | Val  Loss: 1.7750 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8153
============ Train epoch 38 ============
denominator: 22469.98046875
 Site-MNIST     | Train Loss: 0.4590 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2672 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.4055 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3504 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2993 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.5841 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.6040 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.0136 | Train Acc: 0.7432
 Site-SynthDigits| Train Loss: 1.0603 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.7777 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.2719 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2902 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3727 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.3713 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3454 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.6345 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.7661 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.1069 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 1.0311 | Val  Acc: 0.7551
 Site-MNIST-M   | Val  Loss: 1.7489 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8193
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:38 | Val Acc: 0.3636
 Best site-USPS       | Epoch:38 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8163
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.7551
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 39 ============
denominator: 21822.5078125
 Site-MNIST     | Train Loss: 0.4025 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2650 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3608 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3373 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.3059 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.6504 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.5676 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.9671 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 1.0093 | Train Acc: 0.7635
 Site-MNIST-M   | Train Loss: 1.5226 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.2594 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2763 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3622 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.3619 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3339 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.6132 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.7559 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.0658 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 1.0052 | Val  Acc: 0.7551
 Site-MNIST-M   | Val  Loss: 1.7323 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8193
============ Train epoch 40 ============
denominator: 21741.46875
 Site-MNIST     | Train Loss: 0.3858 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2434 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3547 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3325 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2849 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.5171 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.5441 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.9642 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 1.0223 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.7226 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.2458 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2643 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3518 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.3453 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.3215 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.6414 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7396 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.0721 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 0.9903 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 1.7439 | Val  Acc: 0.4091
Average Valid Accuracy: 0.8024
============ Train epoch 41 ============
denominator: 21230.876953125
 Site-MNIST     | Train Loss: 0.4869 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2372 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3563 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3123 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.2784 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.5435 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.5370 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.9387 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.9592 | Train Acc: 0.7703
 Site-MNIST-M   | Train Loss: 1.5084 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.2423 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2638 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3426 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.3378 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.3155 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.6170 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.7219 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.0893 | Val  Acc: 0.7959
 Site-SynthDigits| Val  Loss: 0.9862 | Val  Acc: 0.7551
 Site-MNIST-M   | Val  Loss: 1.7517 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8079
============ Train epoch 42 ============
denominator: 20828.130859375
 Site-MNIST     | Train Loss: 0.4021 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2353 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3566 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3111 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2632 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.3650 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.5197 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.9289 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.9424 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.4087 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.2320 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2544 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3347 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.3296 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.3083 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.6289 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 0.7107 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.0741 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 0.9717 | Val  Acc: 0.7653
 Site-MNIST-M   | Val  Loss: 1.7564 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8053
============ Train epoch 43 ============
denominator: 20869.33203125
 Site-MNIST     | Train Loss: 0.3689 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2224 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4080 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3020 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2645 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.6886 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4990 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.8707 | Train Acc: 0.7973
 Site-SynthDigits| Train Loss: 0.9103 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.6564 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.2278 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2436 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3256 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.3189 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2984 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.6185 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 0.7064 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.0433 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 0.9512 | Val  Acc: 0.7857
 Site-MNIST-M   | Val  Loss: 1.7476 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8115
============ Train epoch 44 ============
denominator: 20071.134765625
 Site-MNIST     | Train Loss: 0.3697 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2265 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3319 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2859 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2447 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.4581 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 0.5269 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.8661 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.9160 | Train Acc: 0.7635
 Site-MNIST-M   | Train Loss: 1.4630 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.2209 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2363 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3153 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.3066 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2874 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.6148 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.7072 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.0313 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 0.9373 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.7398 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8075
============ Train epoch 45 ============
denominator: 20061.236328125
 Site-MNIST     | Train Loss: 0.4286 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2206 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3289 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2818 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.2365 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.4553 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 0.5065 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.8513 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.9294 | Train Acc: 0.7703
 Site-MNIST-M   | Train Loss: 1.6046 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.2117 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2251 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3049 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2989 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2804 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.5762 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.6964 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.0020 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 0.9184 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.7087 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8200
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:45 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:45 | Val Acc: 0.3636
 Best site-USPS       | Epoch:45 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.8163
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.7755
 Best site-MNIST-M    | Epoch:45 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 46 ============
denominator: 20474.65234375
 Site-MNIST     | Train Loss: 0.3855 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2054 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.3147 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2805 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.2388 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.5277 | Train Acc: 0.6200
 Site-USPS      | Train Loss: 0.5103 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.8619 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.9093 | Train Acc: 0.7770
 Site-MNIST-M   | Train Loss: 1.1851 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.1998 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2226 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2982 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2964 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2805 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.5587 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.6918 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 1.0033 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.9036 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.6929 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8301
 Best site-MNIST      | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:46 | Val Acc: 0.3636
 Best site-USPS       | Epoch:46 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.7755
 Best site-MNIST-M    | Epoch:46 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 47 ============
denominator: 20475.087890625
 Site-MNIST     | Train Loss: 0.3147 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2019 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3243 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2585 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.2183 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.3232 | Train Acc: 0.6000
 Site-USPS      | Train Loss: 0.5034 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.8339 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.9580 | Train Acc: 0.7635
 Site-MNIST-M   | Train Loss: 1.2695 | Train Acc: 0.6061
 Site-MNIST     | Val  Loss: 0.1918 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2133 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2941 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2802 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2691 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.5692 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.6853 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.9878 | Val  Acc: 0.8163
 Site-SynthDigits| Val  Loss: 0.8827 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.6883 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8246
============ Train epoch 48 ============
denominator: 19909.58203125
 Site-MNIST     | Train Loss: 0.3767 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2064 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3260 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2563 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.2160 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.3788 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4714 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.7930 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.8830 | Train Acc: 0.7905
 Site-MNIST-M   | Train Loss: 1.5301 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.1937 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2080 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2883 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2700 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2558 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.5600 | Val  Acc: 0.3636
 Site-USPS      | Val  Loss: 0.6739 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.9790 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.8727 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.6670 | Val  Acc: 0.5455
Average Valid Accuracy: 0.8311
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:48 | Val Acc: 0.3636
 Best site-USPS       | Epoch:48 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.7755
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.5455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 49 ============
denominator: 19587.443359375
 Site-MNIST     | Train Loss: 0.3970 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1989 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2905 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2531 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.1953 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.5944 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 0.4524 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.7814 | Train Acc: 0.8243
 Site-SynthDigits| Train Loss: 0.8768 | Train Acc: 0.7838
 Site-MNIST-M   | Train Loss: 1.6701 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.1953 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2048 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2819 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.2672 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2510 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 1.5278 | Val  Acc: 0.3939
 Site-USPS      | Val  Loss: 0.6697 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.9557 | Val  Acc: 0.8367
 Site-SynthDigits| Val  Loss: 0.8604 | Val  Acc: 0.7755
 Site-MNIST-M   | Val  Loss: 1.6450 | Val  Acc: 0.5455
Average Valid Accuracy: 0.8342
 Best site-MNIST      | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9787
 Best site-MNIST      | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:49 | Val Acc: 0.3939
 Best site-USPS       | Epoch:49 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.8367
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.7755
 Best site-MNIST-M    | Epoch:49 | Val Acc: 0.5455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8693
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3516
 Test site-USPS      | Epoch:49 | Test Acc: 0.8226
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.6697
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.4050
Average Test Accuracy: 0.6236
===2023-04-18 19:26:51===
===2023-04-18 19:26:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
=================================
 ==== model type: CoCoOP ====
=================================
Loading snapshots...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8607
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3456
 Test site-USPS      | Epoch:49 | Test Acc: 0.8226
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.6713
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.4157
Average Test Accuracy: 0.6232
