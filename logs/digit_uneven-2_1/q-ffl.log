===2023-04-20 22:02:55===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
denominator: 22895.189814772835
 Site-MNIST     | Train Loss: 2.2741 | Train Acc: 0.2174
 Site-MNIST     | Train Loss: 2.2853 | Train Acc: 0.1064
 Site-MNIST     | Train Loss: 2.2858 | Train Acc: 0.1408
 Site-MNIST     | Train Loss: 2.2804 | Train Acc: 0.1170
 Site-MNIST     | Train Loss: 2.2902 | Train Acc: 0.0932
 Site-SVHN      | Train Loss: 2.2563 | Train Acc: 0.1600
 Site-USPS      | Train Loss: 2.2832 | Train Acc: 0.0909
 Site-SynthDigits| Train Loss: 2.2893 | Train Acc: 0.0811
 Site-SynthDigits| Train Loss: 2.3115 | Train Acc: 0.0946
 Site-MNIST-M   | Train Loss: 2.2824 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.3044 | Val  Acc: 0.0000
 Site-MNIST     | Val  Loss: 2.2992 | Val  Acc: 0.0645
 Site-MNIST     | Val  Loss: 2.2805 | Val  Acc: 0.1489
 Site-MNIST     | Val  Loss: 2.2805 | Val  Acc: 0.0952
 Site-MNIST     | Val  Loss: 2.2806 | Val  Acc: 0.1266
 Site-SVHN      | Val  Loss: 2.3143 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.2929 | Val  Acc: 0.1034
 Site-SynthDigits| Val  Loss: 2.3547 | Val  Acc: 0.0204
 Site-SynthDigits| Val  Loss: 2.3093 | Val  Acc: 0.0816
 Site-MNIST-M   | Val  Loss: 2.3185 | Val  Acc: 0.1364
Average Valid Accuracy: 0.0868
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0645
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1489
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0952
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1266
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0909
 Best site-USPS       | Epoch:0 | Val Acc: 0.1034
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0204
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0816
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 1 ============
denominator: 22829.38517432077
 Site-MNIST     | Train Loss: 2.2763 | Train Acc: 0.3043
 Site-MNIST     | Train Loss: 2.2698 | Train Acc: 0.1489
 Site-MNIST     | Train Loss: 2.2676 | Train Acc: 0.1690
 Site-MNIST     | Train Loss: 2.2630 | Train Acc: 0.1596
 Site-MNIST     | Train Loss: 2.2612 | Train Acc: 0.1017
 Site-SVHN      | Train Loss: 2.2579 | Train Acc: 0.1600
 Site-USPS      | Train Loss: 2.2684 | Train Acc: 0.1591
 Site-SynthDigits| Train Loss: 2.2873 | Train Acc: 0.0946
 Site-SynthDigits| Train Loss: 2.3075 | Train Acc: 0.0946
 Site-MNIST-M   | Train Loss: 2.2730 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.2812 | Val  Acc: 0.0000
 Site-MNIST     | Val  Loss: 2.2810 | Val  Acc: 0.0968
 Site-MNIST     | Val  Loss: 2.2679 | Val  Acc: 0.1702
 Site-MNIST     | Val  Loss: 2.2632 | Val  Acc: 0.1587
 Site-MNIST     | Val  Loss: 2.2597 | Val  Acc: 0.1646
 Site-SVHN      | Val  Loss: 2.3079 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.2740 | Val  Acc: 0.1034
 Site-SynthDigits| Val  Loss: 2.3470 | Val  Acc: 0.0408
 Site-SynthDigits| Val  Loss: 2.3038 | Val  Acc: 0.0918
 Site-MNIST-M   | Val  Loss: 2.3132 | Val  Acc: 0.1364
Average Valid Accuracy: 0.1054
 Best site-MNIST      | Epoch:1 | Val Acc: 0.0000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.0968
 Best site-MNIST      | Epoch:1 | Val Acc: 0.1702
 Best site-MNIST      | Epoch:1 | Val Acc: 0.1587
 Best site-MNIST      | Epoch:1 | Val Acc: 0.1646
 Best site-SVHN       | Epoch:1 | Val Acc: 0.0909
 Best site-USPS       | Epoch:1 | Val Acc: 0.1034
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.0408
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.0918
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 2 ============
denominator: 22647.05462158385
 Site-MNIST     | Train Loss: 2.2555 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.2526 | Train Acc: 0.1915
 Site-MNIST     | Train Loss: 2.2383 | Train Acc: 0.1972
 Site-MNIST     | Train Loss: 2.2462 | Train Acc: 0.2021
 Site-MNIST     | Train Loss: 2.2400 | Train Acc: 0.1949
 Site-SVHN      | Train Loss: 2.2775 | Train Acc: 0.1800
 Site-USPS      | Train Loss: 2.2489 | Train Acc: 0.2045
 Site-SynthDigits| Train Loss: 2.2856 | Train Acc: 0.0946
 Site-SynthDigits| Train Loss: 2.2956 | Train Acc: 0.1014
 Site-MNIST-M   | Train Loss: 2.3524 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.2580 | Val  Acc: 0.1333
 Site-MNIST     | Val  Loss: 2.2631 | Val  Acc: 0.1290
 Site-MNIST     | Val  Loss: 2.2558 | Val  Acc: 0.2128
 Site-MNIST     | Val  Loss: 2.2442 | Val  Acc: 0.2222
 Site-MNIST     | Val  Loss: 2.2384 | Val  Acc: 0.1899
 Site-SVHN      | Val  Loss: 2.3025 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.2559 | Val  Acc: 0.1379
 Site-SynthDigits| Val  Loss: 2.3442 | Val  Acc: 0.0408
 Site-SynthDigits| Val  Loss: 2.3003 | Val  Acc: 0.1020
 Site-MNIST-M   | Val  Loss: 2.3102 | Val  Acc: 0.1364
Average Valid Accuracy: 0.1395
 Best site-MNIST      | Epoch:2 | Val Acc: 0.1333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.1290
 Best site-MNIST      | Epoch:2 | Val Acc: 0.2128
 Best site-MNIST      | Epoch:2 | Val Acc: 0.2222
 Best site-MNIST      | Epoch:2 | Val Acc: 0.1899
 Best site-SVHN       | Epoch:2 | Val Acc: 0.0909
 Best site-USPS       | Epoch:2 | Val Acc: 0.1379
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.0408
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1020
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 3 ============
denominator: 22509.754011041554
 Site-MNIST     | Train Loss: 2.2410 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.2383 | Train Acc: 0.2340
 Site-MNIST     | Train Loss: 2.2266 | Train Acc: 0.2676
 Site-MNIST     | Train Loss: 2.2281 | Train Acc: 0.2447
 Site-MNIST     | Train Loss: 2.2214 | Train Acc: 0.2712
 Site-SVHN      | Train Loss: 2.2477 | Train Acc: 0.1800
 Site-USPS      | Train Loss: 2.2279 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.2823 | Train Acc: 0.0811
 Site-SynthDigits| Train Loss: 2.2904 | Train Acc: 0.1216
 Site-MNIST-M   | Train Loss: 2.3524 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.2368 | Val  Acc: 0.2000
 Site-MNIST     | Val  Loss: 2.2456 | Val  Acc: 0.1613
 Site-MNIST     | Val  Loss: 2.2435 | Val  Acc: 0.2553
 Site-MNIST     | Val  Loss: 2.2254 | Val  Acc: 0.2698
 Site-MNIST     | Val  Loss: 2.2174 | Val  Acc: 0.2911
 Site-SVHN      | Val  Loss: 2.2977 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.2378 | Val  Acc: 0.2414
 Site-SynthDigits| Val  Loss: 2.3392 | Val  Acc: 0.0816
 Site-SynthDigits| Val  Loss: 2.2964 | Val  Acc: 0.1224
 Site-MNIST-M   | Val  Loss: 2.3072 | Val  Acc: 0.1364
Average Valid Accuracy: 0.1850
 Best site-MNIST      | Epoch:3 | Val Acc: 0.2000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.1613
 Best site-MNIST      | Epoch:3 | Val Acc: 0.2553
 Best site-MNIST      | Epoch:3 | Val Acc: 0.2698
 Best site-MNIST      | Epoch:3 | Val Acc: 0.2911
 Best site-SVHN       | Epoch:3 | Val Acc: 0.0909
 Best site-USPS       | Epoch:3 | Val Acc: 0.2414
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.0816
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.1224
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 4 ============
denominator: 22425.858268148335
 Site-MNIST     | Train Loss: 2.2378 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 2.2235 | Train Acc: 0.2979
 Site-MNIST     | Train Loss: 2.2035 | Train Acc: 0.3380
 Site-MNIST     | Train Loss: 2.2108 | Train Acc: 0.3511
 Site-MNIST     | Train Loss: 2.1989 | Train Acc: 0.3475
 Site-SVHN      | Train Loss: 2.2715 | Train Acc: 0.1800
 Site-USPS      | Train Loss: 2.2128 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 2.2776 | Train Acc: 0.0946
 Site-SynthDigits| Train Loss: 2.2929 | Train Acc: 0.1216
 Site-MNIST-M   | Train Loss: 2.3171 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.2161 | Val  Acc: 0.3333
 Site-MNIST     | Val  Loss: 2.2280 | Val  Acc: 0.3226
 Site-MNIST     | Val  Loss: 2.2299 | Val  Acc: 0.3830
 Site-MNIST     | Val  Loss: 2.2079 | Val  Acc: 0.3492
 Site-MNIST     | Val  Loss: 2.1959 | Val  Acc: 0.3544
 Site-SVHN      | Val  Loss: 2.2945 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.2191 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.3343 | Val  Acc: 0.0816
 Site-SynthDigits| Val  Loss: 2.2923 | Val  Acc: 0.1224
 Site-MNIST-M   | Val  Loss: 2.3022 | Val  Acc: 0.1818
Average Valid Accuracy: 0.2633
 Best site-MNIST      | Epoch:4 | Val Acc: 0.3333
 Best site-MNIST      | Epoch:4 | Val Acc: 0.3226
 Best site-MNIST      | Epoch:4 | Val Acc: 0.3830
 Best site-MNIST      | Epoch:4 | Val Acc: 0.3492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.3544
 Best site-SVHN       | Epoch:4 | Val Acc: 0.0909
 Best site-USPS       | Epoch:4 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.0816
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.1224
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 5 ============
denominator: 22362.210272755852
 Site-MNIST     | Train Loss: 2.2131 | Train Acc: 0.4348
 Site-MNIST     | Train Loss: 2.2089 | Train Acc: 0.3617
 Site-MNIST     | Train Loss: 2.1833 | Train Acc: 0.4225
 Site-MNIST     | Train Loss: 2.1938 | Train Acc: 0.4149
 Site-MNIST     | Train Loss: 2.1783 | Train Acc: 0.4407
 Site-SVHN      | Train Loss: 2.2473 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.1931 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2700 | Train Acc: 0.1216
 Site-SynthDigits| Train Loss: 2.2914 | Train Acc: 0.1149
 Site-MNIST-M   | Train Loss: 2.2821 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.1947 | Val  Acc: 0.4000
 Site-MNIST     | Val  Loss: 2.2099 | Val  Acc: 0.3226
 Site-MNIST     | Val  Loss: 2.2146 | Val  Acc: 0.3830
 Site-MNIST     | Val  Loss: 2.1904 | Val  Acc: 0.4603
 Site-MNIST     | Val  Loss: 2.1749 | Val  Acc: 0.4557
 Site-SVHN      | Val  Loss: 2.2916 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.1994 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.3292 | Val  Acc: 0.0612
 Site-SynthDigits| Val  Loss: 2.2881 | Val  Acc: 0.1020
 Site-MNIST-M   | Val  Loss: 2.2970 | Val  Acc: 0.1818
Average Valid Accuracy: 0.2906
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.3226
 Best site-MNIST      | Epoch:5 | Val Acc: 0.3830
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4603
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4557
 Best site-SVHN       | Epoch:5 | Val Acc: 0.0909
 Best site-USPS       | Epoch:5 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.0612
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.1020
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 6 ============
denominator: 22207.347845044365
 Site-MNIST     | Train Loss: 2.2107 | Train Acc: 0.3043
 Site-MNIST     | Train Loss: 2.1928 | Train Acc: 0.3617
 Site-MNIST     | Train Loss: 2.1643 | Train Acc: 0.4930
 Site-MNIST     | Train Loss: 2.1739 | Train Acc: 0.4574
 Site-MNIST     | Train Loss: 2.1583 | Train Acc: 0.4407
 Site-SVHN      | Train Loss: 2.2371 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.1708 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2706 | Train Acc: 0.1216
 Site-SynthDigits| Train Loss: 2.2809 | Train Acc: 0.1216
 Site-MNIST-M   | Train Loss: 2.3159 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.1697 | Val  Acc: 0.3333
 Site-MNIST     | Val  Loss: 2.1893 | Val  Acc: 0.3226
 Site-MNIST     | Val  Loss: 2.1994 | Val  Acc: 0.3830
 Site-MNIST     | Val  Loss: 2.1718 | Val  Acc: 0.4603
 Site-MNIST     | Val  Loss: 2.1549 | Val  Acc: 0.5443
 Site-SVHN      | Val  Loss: 2.2887 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.1802 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.3218 | Val  Acc: 0.0816
 Site-SynthDigits| Val  Loss: 2.2831 | Val  Acc: 0.1224
 Site-MNIST-M   | Val  Loss: 2.2940 | Val  Acc: 0.1818
Average Valid Accuracy: 0.2969
 Best site-MNIST      | Epoch:6 | Val Acc: 0.3333
 Best site-MNIST      | Epoch:6 | Val Acc: 0.3226
 Best site-MNIST      | Epoch:6 | Val Acc: 0.3830
 Best site-MNIST      | Epoch:6 | Val Acc: 0.4603
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5443
 Best site-SVHN       | Epoch:6 | Val Acc: 0.0909
 Best site-USPS       | Epoch:6 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.0816
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.1224
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 7 ============
denominator: 22097.699239856633
 Site-MNIST     | Train Loss: 2.1794 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.1786 | Train Acc: 0.3404
 Site-MNIST     | Train Loss: 2.1483 | Train Acc: 0.5634
 Site-MNIST     | Train Loss: 2.1564 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 2.1406 | Train Acc: 0.4831
 Site-SVHN      | Train Loss: 2.2288 | Train Acc: 0.2200
 Site-USPS      | Train Loss: 2.1606 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.2625 | Train Acc: 0.1216
 Site-SynthDigits| Train Loss: 2.2757 | Train Acc: 0.1284
 Site-MNIST-M   | Train Loss: 2.2732 | Train Acc: 0.0303
 Site-MNIST     | Val  Loss: 2.1491 | Val  Acc: 0.4000
 Site-MNIST     | Val  Loss: 2.1705 | Val  Acc: 0.3871
 Site-MNIST     | Val  Loss: 2.1834 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.1543 | Val  Acc: 0.4603
 Site-MNIST     | Val  Loss: 2.1332 | Val  Acc: 0.5949
 Site-SVHN      | Val  Loss: 2.2864 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.1622 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.3174 | Val  Acc: 0.0816
 Site-SynthDigits| Val  Loss: 2.2784 | Val  Acc: 0.1224
 Site-MNIST-M   | Val  Loss: 2.2889 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3137
 Best site-MNIST      | Epoch:7 | Val Acc: 0.4000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.3871
 Best site-MNIST      | Epoch:7 | Val Acc: 0.4043
 Best site-MNIST      | Epoch:7 | Val Acc: 0.4603
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5949
 Best site-SVHN       | Epoch:7 | Val Acc: 0.0909
 Best site-USPS       | Epoch:7 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.0816
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.1224
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 8 ============
denominator: 21924.068950619927
 Site-MNIST     | Train Loss: 2.1973 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.1583 | Train Acc: 0.3404
 Site-MNIST     | Train Loss: 2.1162 | Train Acc: 0.5070
 Site-MNIST     | Train Loss: 2.1369 | Train Acc: 0.4149
 Site-MNIST     | Train Loss: 2.1159 | Train Acc: 0.4746
 Site-SVHN      | Train Loss: 2.2491 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 2.1422 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2596 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.2703 | Train Acc: 0.1284
 Site-MNIST-M   | Train Loss: 2.3263 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 2.1248 | Val  Acc: 0.4667
 Site-MNIST     | Val  Loss: 2.1499 | Val  Acc: 0.3871
 Site-MNIST     | Val  Loss: 2.1696 | Val  Acc: 0.3617
 Site-MNIST     | Val  Loss: 2.1345 | Val  Acc: 0.4286
 Site-MNIST     | Val  Loss: 2.1112 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2816 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.1461 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.3096 | Val  Acc: 0.0816
 Site-SynthDigits| Val  Loss: 2.2720 | Val  Acc: 0.1224
 Site-MNIST-M   | Val  Loss: 2.2844 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3101
============ Train epoch 9 ============
denominator: 21842.724183208375
 Site-MNIST     | Train Loss: 2.1532 | Train Acc: 0.3043
 Site-MNIST     | Train Loss: 2.1412 | Train Acc: 0.3617
 Site-MNIST     | Train Loss: 2.0879 | Train Acc: 0.5493
 Site-MNIST     | Train Loss: 2.1198 | Train Acc: 0.4362
 Site-MNIST     | Train Loss: 2.1037 | Train Acc: 0.4915
 Site-SVHN      | Train Loss: 2.2406 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 2.1175 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.2498 | Train Acc: 0.1622
 Site-SynthDigits| Train Loss: 2.2692 | Train Acc: 0.1284
 Site-MNIST-M   | Train Loss: 2.2972 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 2.1026 | Val  Acc: 0.4667
 Site-MNIST     | Val  Loss: 2.1299 | Val  Acc: 0.4516
 Site-MNIST     | Val  Loss: 2.1528 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.1157 | Val  Acc: 0.4444
 Site-MNIST     | Val  Loss: 2.0882 | Val  Acc: 0.5443
 Site-SVHN      | Val  Loss: 2.2790 | Val  Acc: 0.1212
 Site-USPS      | Val  Loss: 2.1282 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.3051 | Val  Acc: 0.1020
 Site-SynthDigits| Val  Loss: 2.2669 | Val  Acc: 0.1327
 Site-MNIST-M   | Val  Loss: 2.2792 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3319
 Best site-MNIST      | Epoch:9 | Val Acc: 0.4667
 Best site-MNIST      | Epoch:9 | Val Acc: 0.4516
 Best site-MNIST      | Epoch:9 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:9 | Val Acc: 0.4444
 Best site-MNIST      | Epoch:9 | Val Acc: 0.5443
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1212
 Best site-USPS       | Epoch:9 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.1020
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.1327
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.3900
 Test site-SVHN      | Epoch:9 | Test Acc: 0.1078
 Test site-USPS      | Epoch:9 | Test Acc: 0.5484
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.1421
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.1443
Average Test Accuracy: 0.2665
============ Train epoch 10 ============
denominator: 21687.905169533326
 Site-MNIST     | Train Loss: 2.1582 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.1258 | Train Acc: 0.3404
 Site-MNIST     | Train Loss: 2.0814 | Train Acc: 0.5493
 Site-MNIST     | Train Loss: 2.1032 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 2.0780 | Train Acc: 0.4915
 Site-SVHN      | Train Loss: 2.2391 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 2.1002 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.2463 | Train Acc: 0.1622
 Site-SynthDigits| Train Loss: 2.2704 | Train Acc: 0.1486
 Site-MNIST-M   | Train Loss: 2.3153 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 2.0851 | Val  Acc: 0.4667
 Site-MNIST     | Val  Loss: 2.1121 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.1378 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.0995 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 2.0690 | Val  Acc: 0.5443
 Site-SVHN      | Val  Loss: 2.2761 | Val  Acc: 0.1212
 Site-USPS      | Val  Loss: 2.1058 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.3003 | Val  Acc: 0.1224
 Site-SynthDigits| Val  Loss: 2.2616 | Val  Acc: 0.1429
 Site-MNIST-M   | Val  Loss: 2.2708 | Val  Acc: 0.1818
Average Valid Accuracy: 0.3448
 Best site-MNIST      | Epoch:10 | Val Acc: 0.4667
 Best site-MNIST      | Epoch:10 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:10 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:10 | Val Acc: 0.4762
 Best site-MNIST      | Epoch:10 | Val Acc: 0.5443
 Best site-SVHN       | Epoch:10 | Val Acc: 0.1212
 Best site-USPS       | Epoch:10 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.1224
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.1429
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 11 ============
denominator: 21631.385886675747
 Site-MNIST     | Train Loss: 2.1626 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.1042 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.0694 | Train Acc: 0.5070
 Site-MNIST     | Train Loss: 2.0856 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 2.0596 | Train Acc: 0.4661
 Site-SVHN      | Train Loss: 2.2508 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 2.0748 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 2.2382 | Train Acc: 0.1622
 Site-SynthDigits| Train Loss: 2.2569 | Train Acc: 0.1689
 Site-MNIST-M   | Train Loss: 2.2732 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 2.0701 | Val  Acc: 0.4667
 Site-MNIST     | Val  Loss: 2.0959 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.1256 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 2.0822 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 2.0515 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2753 | Val  Acc: 0.1212
 Site-USPS      | Val  Loss: 2.0912 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2958 | Val  Acc: 0.1429
 Site-SynthDigits| Val  Loss: 2.2545 | Val  Acc: 0.1735
 Site-MNIST-M   | Val  Loss: 2.2678 | Val  Acc: 0.2273
Average Valid Accuracy: 0.3534
 Best site-MNIST      | Epoch:11 | Val Acc: 0.4667
 Best site-MNIST      | Epoch:11 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:11 | Val Acc: 0.4468
 Best site-MNIST      | Epoch:11 | Val Acc: 0.4921
 Best site-MNIST      | Epoch:11 | Val Acc: 0.5316
 Best site-SVHN       | Epoch:11 | Val Acc: 0.1212
 Best site-USPS       | Epoch:11 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.1429
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.1735
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 12 ============
denominator: 21384.370214747025
 Site-MNIST     | Train Loss: 2.1221 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.0877 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.0376 | Train Acc: 0.5070
 Site-MNIST     | Train Loss: 2.0675 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 2.0454 | Train Acc: 0.5085
 Site-SVHN      | Train Loss: 2.2403 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 2.0565 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 2.2348 | Train Acc: 0.1622
 Site-SynthDigits| Train Loss: 2.2415 | Train Acc: 0.1959
 Site-MNIST-M   | Train Loss: 2.3191 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 2.0488 | Val  Acc: 0.4667
 Site-MNIST     | Val  Loss: 2.0752 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.1082 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 2.0631 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 2.0269 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2721 | Val  Acc: 0.1212
 Site-USPS      | Val  Loss: 2.0693 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2919 | Val  Acc: 0.1837
 Site-SynthDigits| Val  Loss: 2.2486 | Val  Acc: 0.2041
 Site-MNIST-M   | Val  Loss: 2.2629 | Val  Acc: 0.2273
Average Valid Accuracy: 0.3640
 Best site-MNIST      | Epoch:12 | Val Acc: 0.4667
 Best site-MNIST      | Epoch:12 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:12 | Val Acc: 0.4468
 Best site-MNIST      | Epoch:12 | Val Acc: 0.4921
 Best site-MNIST      | Epoch:12 | Val Acc: 0.5316
 Best site-SVHN       | Epoch:12 | Val Acc: 0.1212
 Best site-USPS       | Epoch:12 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.1837
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.2041
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 13 ============
denominator: 21287.804891672367
 Site-MNIST     | Train Loss: 2.0981 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.0663 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.0158 | Train Acc: 0.5352
 Site-MNIST     | Train Loss: 2.0441 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 2.0267 | Train Acc: 0.5085
 Site-SVHN      | Train Loss: 2.2177 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 2.0344 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 2.2280 | Train Acc: 0.1622
 Site-SynthDigits| Train Loss: 2.2392 | Train Acc: 0.2027
 Site-MNIST-M   | Train Loss: 2.3413 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 2.0217 | Val  Acc: 0.4667
 Site-MNIST     | Val  Loss: 2.0506 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.0884 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 2.0423 | Val  Acc: 0.5079
 Site-MNIST     | Val  Loss: 2.0007 | Val  Acc: 0.5570
 Site-SVHN      | Val  Loss: 2.2701 | Val  Acc: 0.1212
 Site-USPS      | Val  Loss: 2.0497 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.2876 | Val  Acc: 0.1837
 Site-SynthDigits| Val  Loss: 2.2415 | Val  Acc: 0.2143
 Site-MNIST-M   | Val  Loss: 2.2568 | Val  Acc: 0.2273
Average Valid Accuracy: 0.3747
 Best site-MNIST      | Epoch:13 | Val Acc: 0.4667
 Best site-MNIST      | Epoch:13 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:13 | Val Acc: 0.4681
 Best site-MNIST      | Epoch:13 | Val Acc: 0.5079
 Best site-MNIST      | Epoch:13 | Val Acc: 0.5570
 Best site-SVHN       | Epoch:13 | Val Acc: 0.1212
 Best site-USPS       | Epoch:13 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.1837
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.2143
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 14 ============
denominator: 21083.464313553406
 Site-MNIST     | Train Loss: 2.0688 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0443 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 1.9979 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 2.0234 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 1.9862 | Train Acc: 0.5254
 Site-SVHN      | Train Loss: 2.2160 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 2.0130 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 2.2195 | Train Acc: 0.1486
 Site-SynthDigits| Train Loss: 2.2406 | Train Acc: 0.2162
 Site-MNIST-M   | Train Loss: 2.3031 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 2.0000 | Val  Acc: 0.4667
 Site-MNIST     | Val  Loss: 2.0284 | Val  Acc: 0.5161
 Site-MNIST     | Val  Loss: 2.0683 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 2.0211 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 1.9745 | Val  Acc: 0.5949
 Site-SVHN      | Val  Loss: 2.2686 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.0271 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 2.2833 | Val  Acc: 0.1837
 Site-SynthDigits| Val  Loss: 2.2344 | Val  Acc: 0.2143
 Site-MNIST-M   | Val  Loss: 2.2520 | Val  Acc: 0.2273
Average Valid Accuracy: 0.3771
 Best site-MNIST      | Epoch:14 | Val Acc: 0.4667
 Best site-MNIST      | Epoch:14 | Val Acc: 0.5161
 Best site-MNIST      | Epoch:14 | Val Acc: 0.4681
 Best site-MNIST      | Epoch:14 | Val Acc: 0.4921
 Best site-MNIST      | Epoch:14 | Val Acc: 0.5949
 Best site-SVHN       | Epoch:14 | Val Acc: 0.0909
 Best site-USPS       | Epoch:14 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.1837
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.2143
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 15 ============
denominator: 20939.060746636624
 Site-MNIST     | Train Loss: 2.0512 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0226 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 1.9669 | Train Acc: 0.5915
 Site-MNIST     | Train Loss: 2.0015 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 1.9674 | Train Acc: 0.5254
 Site-SVHN      | Train Loss: 2.2084 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.9906 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 2.2114 | Train Acc: 0.1892
 Site-SynthDigits| Train Loss: 2.2342 | Train Acc: 0.2230
 Site-MNIST-M   | Train Loss: 2.2789 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 1.9749 | Val  Acc: 0.4667
 Site-MNIST     | Val  Loss: 2.0053 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.0497 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 2.0006 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 1.9503 | Val  Acc: 0.6076
 Site-SVHN      | Val  Loss: 2.2674 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.0066 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 2.2776 | Val  Acc: 0.1837
 Site-SynthDigits| Val  Loss: 2.2260 | Val  Acc: 0.2245
 Site-MNIST-M   | Val  Loss: 2.2452 | Val  Acc: 0.2273
Average Valid Accuracy: 0.3775
 Best site-MNIST      | Epoch:15 | Val Acc: 0.4667
 Best site-MNIST      | Epoch:15 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:15 | Val Acc: 0.4468
 Best site-MNIST      | Epoch:15 | Val Acc: 0.4921
 Best site-MNIST      | Epoch:15 | Val Acc: 0.6076
 Best site-SVHN       | Epoch:15 | Val Acc: 0.0909
 Best site-USPS       | Epoch:15 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.1837
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.2245
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 16 ============
denominator: 20801.19651357992
 Site-MNIST     | Train Loss: 2.0230 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0004 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.9190 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.9790 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.9393 | Train Acc: 0.5424
 Site-SVHN      | Train Loss: 2.2450 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.9719 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 2.2014 | Train Acc: 0.2162
 Site-SynthDigits| Train Loss: 2.2257 | Train Acc: 0.2297
 Site-MNIST-M   | Train Loss: 2.1912 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 1.9492 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 1.9817 | Val  Acc: 0.5484
 Site-MNIST     | Val  Loss: 2.0296 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 1.9778 | Val  Acc: 0.5238
 Site-MNIST     | Val  Loss: 1.9239 | Val  Acc: 0.6203
 Site-SVHN      | Val  Loss: 2.2640 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 1.9838 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 2.2698 | Val  Acc: 0.2041
 Site-SynthDigits| Val  Loss: 2.2173 | Val  Acc: 0.2347
 Site-MNIST-M   | Val  Loss: 2.2393 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4048
 Best site-MNIST      | Epoch:16 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:16 | Val Acc: 0.5484
 Best site-MNIST      | Epoch:16 | Val Acc: 0.4681
 Best site-MNIST      | Epoch:16 | Val Acc: 0.5238
 Best site-MNIST      | Epoch:16 | Val Acc: 0.6203
 Best site-SVHN       | Epoch:16 | Val Acc: 0.0909
 Best site-USPS       | Epoch:16 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.2041
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.2347
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 17 ============
denominator: 20605.66783051355
 Site-MNIST     | Train Loss: 2.0380 | Train Acc: 0.4348
 Site-MNIST     | Train Loss: 1.9758 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.9148 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.9584 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.9325 | Train Acc: 0.5678
 Site-SVHN      | Train Loss: 2.1975 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 1.9404 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 2.1947 | Train Acc: 0.2297
 Site-SynthDigits| Train Loss: 2.2152 | Train Acc: 0.2297
 Site-MNIST-M   | Train Loss: 2.3122 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.9234 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.9589 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 2.0094 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 1.9544 | Val  Acc: 0.5238
 Site-MNIST     | Val  Loss: 1.8965 | Val  Acc: 0.6203
 Site-SVHN      | Val  Loss: 2.2622 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 1.9646 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 2.2645 | Val  Acc: 0.2041
 Site-SynthDigits| Val  Loss: 2.2091 | Val  Acc: 0.2245
 Site-MNIST-M   | Val  Loss: 2.2353 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4228
 Best site-MNIST      | Epoch:17 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:17 | Val Acc: 0.5806
 Best site-MNIST      | Epoch:17 | Val Acc: 0.4681
 Best site-MNIST      | Epoch:17 | Val Acc: 0.5238
 Best site-MNIST      | Epoch:17 | Val Acc: 0.6203
 Best site-SVHN       | Epoch:17 | Val Acc: 0.1818
 Best site-USPS       | Epoch:17 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.2041
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.2245
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 18 ============
denominator: 20479.722078647847
 Site-MNIST     | Train Loss: 2.0227 | Train Acc: 0.4783
 Site-MNIST     | Train Loss: 1.9502 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.8942 | Train Acc: 0.6620
 Site-MNIST     | Train Loss: 1.9344 | Train Acc: 0.5638
 Site-MNIST     | Train Loss: 1.8865 | Train Acc: 0.5847
 Site-SVHN      | Train Loss: 2.1929 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.9181 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 2.1851 | Train Acc: 0.2297
 Site-SynthDigits| Train Loss: 2.1882 | Train Acc: 0.2432
 Site-MNIST-M   | Train Loss: 2.2413 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8974 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.9333 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 1.9862 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.9316 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.8693 | Val  Acc: 0.6582
 Site-SVHN      | Val  Loss: 2.2601 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 1.9424 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.2594 | Val  Acc: 0.2041
 Site-SynthDigits| Val  Loss: 2.2011 | Val  Acc: 0.2347
 Site-MNIST-M   | Val  Loss: 2.2304 | Val  Acc: 0.2727
Average Valid Accuracy: 0.4418
 Best site-MNIST      | Epoch:18 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:18 | Val Acc: 0.5806
 Best site-MNIST      | Epoch:18 | Val Acc: 0.5745
 Best site-MNIST      | Epoch:18 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:18 | Val Acc: 0.6582
 Best site-SVHN       | Epoch:18 | Val Acc: 0.1515
 Best site-USPS       | Epoch:18 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.2041
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.2347
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 19 ============
denominator: 20369.90494629406
 Site-MNIST     | Train Loss: 1.9901 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.9268 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.8426 | Train Acc: 0.6620
 Site-MNIST     | Train Loss: 1.9127 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.8524 | Train Acc: 0.6102
 Site-SVHN      | Train Loss: 2.2042 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.9010 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 2.1746 | Train Acc: 0.2432
 Site-SynthDigits| Train Loss: 2.1937 | Train Acc: 0.2568
 Site-MNIST-M   | Train Loss: 2.2037 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8725 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.9107 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 1.9665 | Val  Acc: 0.6170
 Site-MNIST     | Val  Loss: 1.9092 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.8416 | Val  Acc: 0.6582
 Site-SVHN      | Val  Loss: 2.2573 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 1.9212 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.2499 | Val  Acc: 0.2041
 Site-SynthDigits| Val  Loss: 2.1899 | Val  Acc: 0.2449
 Site-MNIST-M   | Val  Loss: 2.2252 | Val  Acc: 0.3182
Average Valid Accuracy: 0.4563
 Best site-MNIST      | Epoch:19 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:19 | Val Acc: 0.5806
 Best site-MNIST      | Epoch:19 | Val Acc: 0.6170
 Best site-MNIST      | Epoch:19 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:19 | Val Acc: 0.6582
 Best site-SVHN       | Epoch:19 | Val Acc: 0.1818
 Best site-USPS       | Epoch:19 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.2041
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.2449
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.4643
 Test site-SVHN      | Epoch:19 | Test Acc: 0.1421
 Test site-USPS      | Epoch:19 | Test Acc: 0.6989
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.2363
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.1921
Average Test Accuracy: 0.3467
============ Train epoch 20 ============
denominator: 20129.320179429287
 Site-MNIST     | Train Loss: 2.0162 | Train Acc: 0.5217
 Site-MNIST     | Train Loss: 1.9062 | Train Acc: 0.5106
 Site-MNIST     | Train Loss: 1.8315 | Train Acc: 0.6338
 Site-MNIST     | Train Loss: 1.8925 | Train Acc: 0.6064
 Site-MNIST     | Train Loss: 1.8450 | Train Acc: 0.6102
 Site-SVHN      | Train Loss: 2.1956 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.8600 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 2.1695 | Train Acc: 0.2568
 Site-SynthDigits| Train Loss: 2.1847 | Train Acc: 0.2635
 Site-MNIST-M   | Train Loss: 2.2016 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.8541 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.8910 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 1.9483 | Val  Acc: 0.6170
 Site-MNIST     | Val  Loss: 1.8880 | Val  Acc: 0.5873
 Site-MNIST     | Val  Loss: 1.8170 | Val  Acc: 0.6456
 Site-SVHN      | Val  Loss: 2.2549 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 1.8964 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.2428 | Val  Acc: 0.2245
 Site-SynthDigits| Val  Loss: 2.1799 | Val  Acc: 0.2551
 Site-MNIST-M   | Val  Loss: 2.2165 | Val  Acc: 0.3182
Average Valid Accuracy: 0.4596
 Best site-MNIST      | Epoch:20 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:20 | Val Acc: 0.5806
 Best site-MNIST      | Epoch:20 | Val Acc: 0.6170
 Best site-MNIST      | Epoch:20 | Val Acc: 0.5873
 Best site-MNIST      | Epoch:20 | Val Acc: 0.6456
 Best site-SVHN       | Epoch:20 | Val Acc: 0.1818
 Best site-USPS       | Epoch:20 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.2245
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.2551
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 21 ============
denominator: 19995.48348189059
 Site-MNIST     | Train Loss: 1.9674 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.8866 | Train Acc: 0.5106
 Site-MNIST     | Train Loss: 1.8035 | Train Acc: 0.6197
 Site-MNIST     | Train Loss: 1.8685 | Train Acc: 0.5851
 Site-MNIST     | Train Loss: 1.8162 | Train Acc: 0.6102
 Site-SVHN      | Train Loss: 2.1824 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.8490 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 2.1584 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.1625 | Train Acc: 0.2838
 Site-MNIST-M   | Train Loss: 2.2694 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8347 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.8694 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 1.9283 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.8674 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7947 | Val  Acc: 0.6456
 Site-SVHN      | Val  Loss: 2.2476 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 1.8722 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.2338 | Val  Acc: 0.2245
 Site-SynthDigits| Val  Loss: 2.1688 | Val  Acc: 0.2857
 Site-MNIST-M   | Val  Loss: 2.2087 | Val  Acc: 0.3182
Average Valid Accuracy: 0.4599
 Best site-MNIST      | Epoch:21 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:21 | Val Acc: 0.5806
 Best site-MNIST      | Epoch:21 | Val Acc: 0.5745
 Best site-MNIST      | Epoch:21 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:21 | Val Acc: 0.6456
 Best site-SVHN       | Epoch:21 | Val Acc: 0.2121
 Best site-USPS       | Epoch:21 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.2245
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.2857
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 22 ============
denominator: 19725.633452342583
 Site-MNIST     | Train Loss: 1.9654 | Train Acc: 0.5652
 Site-MNIST     | Train Loss: 1.8631 | Train Acc: 0.5319
 Site-MNIST     | Train Loss: 1.7972 | Train Acc: 0.6338
 Site-MNIST     | Train Loss: 1.8416 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.7943 | Train Acc: 0.6186
 Site-SVHN      | Train Loss: 2.1672 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 1.8093 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 2.1403 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.1600 | Train Acc: 0.2770
 Site-MNIST-M   | Train Loss: 2.1823 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.8067 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.8427 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 1.9046 | Val  Acc: 0.5957
 Site-MNIST     | Val  Loss: 1.8425 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7675 | Val  Acc: 0.6456
 Site-SVHN      | Val  Loss: 2.2440 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 1.8455 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.2223 | Val  Acc: 0.2449
 Site-SynthDigits| Val  Loss: 2.1567 | Val  Acc: 0.2755
 Site-MNIST-M   | Val  Loss: 2.2013 | Val  Acc: 0.3182
Average Valid Accuracy: 0.4600
 Best site-MNIST      | Epoch:22 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:22 | Val Acc: 0.5806
 Best site-MNIST      | Epoch:22 | Val Acc: 0.5957
 Best site-MNIST      | Epoch:22 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:22 | Val Acc: 0.6456
 Best site-SVHN       | Epoch:22 | Val Acc: 0.1818
 Best site-USPS       | Epoch:22 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.2449
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.2755
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 23 ============
denominator: 19585.349088913834
 Site-MNIST     | Train Loss: 1.9281 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.8338 | Train Acc: 0.5745
 Site-MNIST     | Train Loss: 1.7866 | Train Acc: 0.6901
 Site-MNIST     | Train Loss: 1.8172 | Train Acc: 0.6064
 Site-MNIST     | Train Loss: 1.7592 | Train Acc: 0.6525
 Site-SVHN      | Train Loss: 2.1729 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.7851 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 2.1337 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.1318 | Train Acc: 0.3243
 Site-MNIST-M   | Train Loss: 2.1723 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.7776 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8140 | Val  Acc: 0.6452
 Site-MNIST     | Val  Loss: 1.8801 | Val  Acc: 0.6170
 Site-MNIST     | Val  Loss: 1.8178 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7387 | Val  Acc: 0.6962
 Site-SVHN      | Val  Loss: 2.2381 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 1.8203 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 2.2153 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.1451 | Val  Acc: 0.3265
 Site-MNIST-M   | Val  Loss: 2.1938 | Val  Acc: 0.3182
Average Valid Accuracy: 0.4915
 Best site-MNIST      | Epoch:23 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:23 | Val Acc: 0.6452
 Best site-MNIST      | Epoch:23 | Val Acc: 0.6170
 Best site-MNIST      | Epoch:23 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:23 | Val Acc: 0.6962
 Best site-SVHN       | Epoch:23 | Val Acc: 0.1818
 Best site-USPS       | Epoch:23 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.3061
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.3265
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 24 ============
denominator: 19262.517239656678
 Site-MNIST     | Train Loss: 1.9235 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.8165 | Train Acc: 0.5532
 Site-MNIST     | Train Loss: 1.7565 | Train Acc: 0.7042
 Site-MNIST     | Train Loss: 1.7966 | Train Acc: 0.6064
 Site-MNIST     | Train Loss: 1.7313 | Train Acc: 0.6356
 Site-SVHN      | Train Loss: 2.2032 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.7588 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 2.1143 | Train Acc: 0.3108
 Site-SynthDigits| Train Loss: 2.1158 | Train Acc: 0.3378
 Site-MNIST-M   | Train Loss: 2.1657 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.7595 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.7919 | Val  Acc: 0.6129
 Site-MNIST     | Val  Loss: 1.8579 | Val  Acc: 0.6170
 Site-MNIST     | Val  Loss: 1.7967 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7142 | Val  Acc: 0.6835
 Site-SVHN      | Val  Loss: 2.2247 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 1.7917 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 2.1986 | Val  Acc: 0.3469
 Site-SynthDigits| Val  Loss: 2.1300 | Val  Acc: 0.3469
 Site-MNIST-M   | Val  Loss: 2.1815 | Val  Acc: 0.3182
Average Valid Accuracy: 0.4930
 Best site-MNIST      | Epoch:24 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:24 | Val Acc: 0.6129
 Best site-MNIST      | Epoch:24 | Val Acc: 0.6170
 Best site-MNIST      | Epoch:24 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:24 | Val Acc: 0.6835
 Best site-SVHN       | Epoch:24 | Val Acc: 0.2121
 Best site-USPS       | Epoch:24 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.3469
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.3469
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 25 ============
denominator: 18969.640654332074
 Site-MNIST     | Train Loss: 1.8688 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.7904 | Train Acc: 0.5532
 Site-MNIST     | Train Loss: 1.7161 | Train Acc: 0.6901
 Site-MNIST     | Train Loss: 1.7693 | Train Acc: 0.6064
 Site-MNIST     | Train Loss: 1.6998 | Train Acc: 0.6441
 Site-SVHN      | Train Loss: 2.1777 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.7382 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 2.1067 | Train Acc: 0.2838
 Site-SynthDigits| Train Loss: 2.1254 | Train Acc: 0.3311
 Site-MNIST-M   | Train Loss: 2.1452 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.7347 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.7660 | Val  Acc: 0.6129
 Site-MNIST     | Val  Loss: 1.8307 | Val  Acc: 0.6170
 Site-MNIST     | Val  Loss: 1.7681 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.6838 | Val  Acc: 0.6709
 Site-SVHN      | Val  Loss: 2.2187 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 1.7644 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 2.1883 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.1185 | Val  Acc: 0.3265
 Site-MNIST-M   | Val  Loss: 2.1709 | Val  Acc: 0.3182
Average Valid Accuracy: 0.4856
============ Train epoch 26 ============
denominator: 19005.621167030564
 Site-MNIST     | Train Loss: 1.8825 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.7657 | Train Acc: 0.5745
 Site-MNIST     | Train Loss: 1.7099 | Train Acc: 0.7042
 Site-MNIST     | Train Loss: 1.7417 | Train Acc: 0.6170
 Site-MNIST     | Train Loss: 1.6775 | Train Acc: 0.6864
 Site-SVHN      | Train Loss: 2.1645 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.7252 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 2.0946 | Train Acc: 0.3243
 Site-SynthDigits| Train Loss: 2.0930 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.1887 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.7043 | Val  Acc: 0.7333
 Site-MNIST     | Val  Loss: 1.7346 | Val  Acc: 0.6774
 Site-MNIST     | Val  Loss: 1.8044 | Val  Acc: 0.5957
 Site-MNIST     | Val  Loss: 1.7418 | Val  Acc: 0.6032
 Site-MNIST     | Val  Loss: 1.6528 | Val  Acc: 0.7089
 Site-SVHN      | Val  Loss: 2.1998 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 1.7369 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 2.1754 | Val  Acc: 0.3469
 Site-SynthDigits| Val  Loss: 2.1044 | Val  Acc: 0.3469
 Site-MNIST-M   | Val  Loss: 2.1608 | Val  Acc: 0.3182
Average Valid Accuracy: 0.5198
 Best site-MNIST      | Epoch:26 | Val Acc: 0.7333
 Best site-MNIST      | Epoch:26 | Val Acc: 0.6774
 Best site-MNIST      | Epoch:26 | Val Acc: 0.5957
 Best site-MNIST      | Epoch:26 | Val Acc: 0.6032
 Best site-MNIST      | Epoch:26 | Val Acc: 0.7089
 Best site-SVHN       | Epoch:26 | Val Acc: 0.2121
 Best site-USPS       | Epoch:26 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.3469
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.3469
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 27 ============
denominator: 18764.193337168923
 Site-MNIST     | Train Loss: 1.8157 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.7510 | Train Acc: 0.5745
 Site-MNIST     | Train Loss: 1.6469 | Train Acc: 0.7042
 Site-MNIST     | Train Loss: 1.7253 | Train Acc: 0.6277
 Site-MNIST     | Train Loss: 1.6628 | Train Acc: 0.6610
 Site-SVHN      | Train Loss: 2.1679 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.6806 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 2.0749 | Train Acc: 0.3243
 Site-SynthDigits| Train Loss: 2.0855 | Train Acc: 0.3851
 Site-MNIST-M   | Train Loss: 2.1873 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.6969 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.7190 | Val  Acc: 0.6452
 Site-MNIST     | Val  Loss: 1.7890 | Val  Acc: 0.6170
 Site-MNIST     | Val  Loss: 1.7312 | Val  Acc: 0.6032
 Site-MNIST     | Val  Loss: 1.6399 | Val  Acc: 0.7089
 Site-SVHN      | Val  Loss: 2.1722 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 1.7085 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 2.1604 | Val  Acc: 0.3673
 Site-SynthDigits| Val  Loss: 2.0881 | Val  Acc: 0.3776
 Site-MNIST-M   | Val  Loss: 2.1506 | Val  Acc: 0.3182
Average Valid Accuracy: 0.5171
============ Train epoch 28 ============
denominator: 18540.67273836
 Site-MNIST     | Train Loss: 1.8492 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.7171 | Train Acc: 0.5745
 Site-MNIST     | Train Loss: 1.6176 | Train Acc: 0.7042
 Site-MNIST     | Train Loss: 1.6931 | Train Acc: 0.6596
 Site-MNIST     | Train Loss: 1.6383 | Train Acc: 0.7034
 Site-SVHN      | Train Loss: 2.1468 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 1.6521 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 2.0538 | Train Acc: 0.3378
 Site-SynthDigits| Train Loss: 2.0710 | Train Acc: 0.4189
 Site-MNIST-M   | Train Loss: 2.1375 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.6627 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.6873 | Val  Acc: 0.7097
 Site-MNIST     | Val  Loss: 1.7585 | Val  Acc: 0.5957
 Site-MNIST     | Val  Loss: 1.6975 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.6040 | Val  Acc: 0.7089
 Site-SVHN      | Val  Loss: 2.1357 | Val  Acc: 0.2121
 Site-USPS      | Val  Loss: 1.6749 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 2.1424 | Val  Acc: 0.3878
 Site-SynthDigits| Val  Loss: 2.0687 | Val  Acc: 0.4082
 Site-MNIST-M   | Val  Loss: 2.1395 | Val  Acc: 0.3182
Average Valid Accuracy: 0.5497
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:28 | Val Acc: 0.7097
 Best site-MNIST      | Epoch:28 | Val Acc: 0.5957
 Best site-MNIST      | Epoch:28 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:28 | Val Acc: 0.7089
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2121
 Best site-USPS       | Epoch:28 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.3878
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.4082
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.3182
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 29 ============
denominator: 18263.06729814076
 Site-MNIST     | Train Loss: 1.7537 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.6914 | Train Acc: 0.5745
 Site-MNIST     | Train Loss: 1.5784 | Train Acc: 0.7183
 Site-MNIST     | Train Loss: 1.6651 | Train Acc: 0.6809
 Site-MNIST     | Train Loss: 1.5645 | Train Acc: 0.7288
 Site-SVHN      | Train Loss: 2.1383 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.6057 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 2.0483 | Train Acc: 0.3514
 Site-SynthDigits| Train Loss: 2.0433 | Train Acc: 0.4122
 Site-MNIST-M   | Train Loss: 2.1273 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.6276 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.6523 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.7294 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.6675 | Val  Acc: 0.6508
 Site-MNIST     | Val  Loss: 1.5710 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.1060 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.6461 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 2.1208 | Val  Acc: 0.3878
 Site-SynthDigits| Val  Loss: 2.0474 | Val  Acc: 0.3980
 Site-MNIST-M   | Val  Loss: 2.1240 | Val  Acc: 0.3636
Average Valid Accuracy: 0.5720
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:29 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:29 | Val Acc: 0.6596
 Best site-MNIST      | Epoch:29 | Val Acc: 0.6508
 Best site-MNIST      | Epoch:29 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:29 | Val Acc: 0.2424
 Best site-USPS       | Epoch:29 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.3878
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.3980
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.5636
 Test site-SVHN      | Epoch:29 | Test Acc: 0.1844
 Test site-USPS      | Epoch:29 | Test Acc: 0.7634
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.3442
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.2593
Average Test Accuracy: 0.4230
============ Train epoch 30 ============
denominator: 17921.55494392577
 Site-MNIST     | Train Loss: 1.7129 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.6548 | Train Acc: 0.6383
 Site-MNIST     | Train Loss: 1.5261 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.6327 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.5473 | Train Acc: 0.7373
 Site-SVHN      | Train Loss: 2.1201 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.5723 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 2.0188 | Train Acc: 0.3514
 Site-SynthDigits| Train Loss: 2.0141 | Train Acc: 0.4189
 Site-MNIST-M   | Train Loss: 2.0999 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.5889 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.6152 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.6963 | Val  Acc: 0.6596
 Site-MNIST     | Val  Loss: 1.6341 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.5367 | Val  Acc: 0.7468
 Site-SVHN      | Val  Loss: 2.0785 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.6201 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 2.0977 | Val  Acc: 0.3878
 Site-SynthDigits| Val  Loss: 2.0266 | Val  Acc: 0.3980
 Site-MNIST-M   | Val  Loss: 2.1145 | Val  Acc: 0.3636
Average Valid Accuracy: 0.5809
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:30 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:30 | Val Acc: 0.6596
 Best site-MNIST      | Epoch:30 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:30 | Val Acc: 0.7468
 Best site-SVHN       | Epoch:30 | Val Acc: 0.2424
 Best site-USPS       | Epoch:30 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.3878
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.3980
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 31 ============
denominator: 17767.362692958744
 Site-MNIST     | Train Loss: 1.6832 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.6156 | Train Acc: 0.6383
 Site-MNIST     | Train Loss: 1.5376 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.5991 | Train Acc: 0.7447
 Site-MNIST     | Train Loss: 1.5407 | Train Acc: 0.7712
 Site-SVHN      | Train Loss: 2.1522 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.5453 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.9964 | Train Acc: 0.3919
 Site-SynthDigits| Train Loss: 1.9974 | Train Acc: 0.4324
 Site-MNIST-M   | Train Loss: 2.1977 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.5569 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.5852 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.6667 | Val  Acc: 0.6809
 Site-MNIST     | Val  Loss: 1.6025 | Val  Acc: 0.7302
 Site-MNIST     | Val  Loss: 1.5033 | Val  Acc: 0.7468
 Site-SVHN      | Val  Loss: 2.0524 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.5902 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 2.0819 | Val  Acc: 0.4082
 Site-SynthDigits| Val  Loss: 2.0077 | Val  Acc: 0.4082
 Site-MNIST-M   | Val  Loss: 2.1058 | Val  Acc: 0.4091
Average Valid Accuracy: 0.5922
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:31 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:31 | Val Acc: 0.6809
 Best site-MNIST      | Epoch:31 | Val Acc: 0.7302
 Best site-MNIST      | Epoch:31 | Val Acc: 0.7468
 Best site-SVHN       | Epoch:31 | Val Acc: 0.2424
 Best site-USPS       | Epoch:31 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.4082
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.4082
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 32 ============
denominator: 17476.943660782406
 Site-MNIST     | Train Loss: 1.6782 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 1.5834 | Train Acc: 0.7447
 Site-MNIST     | Train Loss: 1.4880 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.5626 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.4976 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.1064 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.5159 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.9924 | Train Acc: 0.4324
 Site-SynthDigits| Train Loss: 1.9880 | Train Acc: 0.4527
 Site-MNIST-M   | Train Loss: 2.1436 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 1.5189 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.5497 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.6338 | Val  Acc: 0.7234
 Site-MNIST     | Val  Loss: 1.5684 | Val  Acc: 0.7460
 Site-MNIST     | Val  Loss: 1.4687 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 2.0319 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.5649 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 2.0603 | Val  Acc: 0.4082
 Site-SynthDigits| Val  Loss: 1.9850 | Val  Acc: 0.4184
 Site-MNIST-M   | Val  Loss: 2.0954 | Val  Acc: 0.4091
Average Valid Accuracy: 0.6035
 Best site-MNIST      | Epoch:32 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:32 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:32 | Val Acc: 0.7234
 Best site-MNIST      | Epoch:32 | Val Acc: 0.7460
 Best site-MNIST      | Epoch:32 | Val Acc: 0.7595
 Best site-SVHN       | Epoch:32 | Val Acc: 0.2424
 Best site-USPS       | Epoch:32 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.4082
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.4184
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 33 ============
denominator: 17172.17401366098
 Site-MNIST     | Train Loss: 1.6338 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 1.5559 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.4664 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.5365 | Train Acc: 0.7553
 Site-MNIST     | Train Loss: 1.4318 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.0986 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.4864 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.9641 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 1.9319 | Train Acc: 0.4662
 Site-MNIST-M   | Train Loss: 2.1110 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 1.4903 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.5188 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.6036 | Val  Acc: 0.7021
 Site-MNIST     | Val  Loss: 1.5385 | Val  Acc: 0.7302
 Site-MNIST     | Val  Loss: 1.4386 | Val  Acc: 0.7468
 Site-SVHN      | Val  Loss: 2.0077 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.5360 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 2.0236 | Val  Acc: 0.4286
 Site-SynthDigits| Val  Loss: 1.9574 | Val  Acc: 0.4388
 Site-MNIST-M   | Val  Loss: 2.0858 | Val  Acc: 0.4091
Average Valid Accuracy: 0.6061
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:33 | Val Acc: 0.7021
 Best site-MNIST      | Epoch:33 | Val Acc: 0.7302
 Best site-MNIST      | Epoch:33 | Val Acc: 0.7468
 Best site-SVHN       | Epoch:33 | Val Acc: 0.2424
 Best site-USPS       | Epoch:33 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.4286
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.4388
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 34 ============
denominator: 17068.835565454396
 Site-MNIST     | Train Loss: 1.6058 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 1.5220 | Train Acc: 0.7447
 Site-MNIST     | Train Loss: 1.4451 | Train Acc: 0.7324
 Site-MNIST     | Train Loss: 1.5094 | Train Acc: 0.7979
 Site-MNIST     | Train Loss: 1.4270 | Train Acc: 0.8305
 Site-SVHN      | Train Loss: 2.0896 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.4630 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.9318 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 1.9351 | Train Acc: 0.5068
 Site-MNIST-M   | Train Loss: 2.1145 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 1.4638 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.4924 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.5781 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.5127 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 1.4099 | Val  Acc: 0.7595
 Site-SVHN      | Val  Loss: 1.9660 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.5059 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.9877 | Val  Acc: 0.4898
 Site-SynthDigits| Val  Loss: 1.9298 | Val  Acc: 0.4898
 Site-MNIST-M   | Val  Loss: 2.0666 | Val  Acc: 0.4091
Average Valid Accuracy: 0.6326
 Best site-MNIST      | Epoch:34 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:34 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:34 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:34 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:34 | Val Acc: 0.7595
 Best site-SVHN       | Epoch:34 | Val Acc: 0.2424
 Best site-USPS       | Epoch:34 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.4898
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.4898
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 35 ============
denominator: 16790.524910893673
 Site-MNIST     | Train Loss: 1.5209 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 1.4967 | Train Acc: 0.7447
 Site-MNIST     | Train Loss: 1.4392 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.4719 | Train Acc: 0.7979
 Site-MNIST     | Train Loss: 1.3961 | Train Acc: 0.8305
 Site-SVHN      | Train Loss: 2.0630 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.4360 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8980 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 1.9116 | Train Acc: 0.5203
 Site-MNIST-M   | Train Loss: 2.0370 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 1.4194 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.4461 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.5430 | Val  Acc: 0.7447
 Site-MNIST     | Val  Loss: 1.4805 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 1.3745 | Val  Acc: 0.7722
 Site-SVHN      | Val  Loss: 1.9304 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.4756 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.9515 | Val  Acc: 0.5102
 Site-SynthDigits| Val  Loss: 1.8995 | Val  Acc: 0.5102
 Site-MNIST-M   | Val  Loss: 2.0484 | Val  Acc: 0.4545
Average Valid Accuracy: 0.6460
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:35 | Val Acc: 0.7447
 Best site-MNIST      | Epoch:35 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:35 | Val Acc: 0.7722
 Best site-SVHN       | Epoch:35 | Val Acc: 0.2424
 Best site-USPS       | Epoch:35 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.5102
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.5102
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 36 ============
denominator: 16403.554516043896
 Site-MNIST     | Train Loss: 1.5120 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 1.4624 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.3714 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.4438 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 1.3583 | Train Acc: 0.8305
 Site-SVHN      | Train Loss: 2.0846 | Train Acc: 0.4400
 Site-USPS      | Train Loss: 1.3988 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8881 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 1.8586 | Train Acc: 0.5338
 Site-MNIST-M   | Train Loss: 2.0247 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 1.3804 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.4104 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.5114 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 1.4481 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.3393 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 1.9128 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.4409 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.9238 | Val  Acc: 0.5306
 Site-SynthDigits| Val  Loss: 1.8726 | Val  Acc: 0.5204
 Site-MNIST-M   | Val  Loss: 2.0350 | Val  Acc: 0.4091
Average Valid Accuracy: 0.6559
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:36 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:36 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:36 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:36 | Val Acc: 0.2727
 Best site-USPS       | Epoch:36 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.5306
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.5204
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 37 ============
denominator: 15887.415914740795
 Site-MNIST     | Train Loss: 1.4740 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 1.4195 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.3736 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 1.4115 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 1.3149 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.1083 | Train Acc: 0.4200
 Site-USPS      | Train Loss: 1.4055 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8666 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.8665 | Train Acc: 0.5338
 Site-MNIST-M   | Train Loss: 1.9914 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.3460 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.3775 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.4770 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 1.4133 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.3072 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 1.8968 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.4219 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.9109 | Val  Acc: 0.5510
 Site-SynthDigits| Val  Loss: 1.8558 | Val  Acc: 0.5306
 Site-MNIST-M   | Val  Loss: 2.0227 | Val  Acc: 0.4545
Average Valid Accuracy: 0.6704
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:37 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:37 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:37 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:37 | Val Acc: 0.2424
 Best site-USPS       | Epoch:37 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.5510
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.5306
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 38 ============
denominator: 15848.679600165917
 Site-MNIST     | Train Loss: 1.4529 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 1.3863 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.3294 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 1.3773 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 1.3055 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.0823 | Train Acc: 0.4000
 Site-USPS      | Train Loss: 1.3617 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8275 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.8144 | Train Acc: 0.5405
 Site-MNIST-M   | Train Loss: 2.0363 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.3104 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 1.3376 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 1.4459 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 1.3857 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.2776 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 1.8735 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.3929 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.8716 | Val  Acc: 0.5714
 Site-SynthDigits| Val  Loss: 1.8269 | Val  Acc: 0.5408
 Site-MNIST-M   | Val  Loss: 2.0077 | Val  Acc: 0.4091
Average Valid Accuracy: 0.6719
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:38 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:38 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2727
 Best site-USPS       | Epoch:38 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.5714
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.5408
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 39 ============
denominator: 15729.642780628437
 Site-MNIST     | Train Loss: 1.3524 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 1.3476 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.2834 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 1.3377 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 1.2326 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 2.0295 | Train Acc: 0.4600
 Site-USPS      | Train Loss: 1.3408 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8041 | Train Acc: 0.5270
 Site-SynthDigits| Train Loss: 1.8146 | Train Acc: 0.5541
 Site-MNIST-M   | Train Loss: 2.0465 | Train Acc: 0.3939
 Site-MNIST     | Val  Loss: 1.2697 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.2997 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 1.4063 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.3464 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.2408 | Val  Acc: 0.8101
 Site-SVHN      | Val  Loss: 1.8559 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.3616 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.8169 | Val  Acc: 0.5918
 Site-SynthDigits| Val  Loss: 1.7881 | Val  Acc: 0.5612
 Site-MNIST-M   | Val  Loss: 1.9909 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7160
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:39 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:39 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:39 | Val Acc: 0.8101
 Best site-SVHN       | Epoch:39 | Val Acc: 0.3030
 Best site-USPS       | Epoch:39 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.5918
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.5612
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.7186
 Test site-SVHN      | Epoch:39 | Test Acc: 0.2327
 Test site-USPS      | Epoch:39 | Test Acc: 0.8333
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.4734
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.3479
Average Test Accuracy: 0.5212
============ Train epoch 40 ============
denominator: 15338.826941457028
 Site-MNIST     | Train Loss: 1.4252 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 1.3236 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 1.2679 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.3110 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 1.2287 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.0180 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 1.2958 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.7662 | Train Acc: 0.5405
 Site-SynthDigits| Train Loss: 1.7611 | Train Acc: 0.5743
 Site-MNIST-M   | Train Loss: 1.7669 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 1.2448 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 1.2713 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 1.3797 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.3233 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.2176 | Val  Acc: 0.8228
 Site-SVHN      | Val  Loss: 1.8347 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.3304 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.7794 | Val  Acc: 0.5918
 Site-SynthDigits| Val  Loss: 1.7564 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 1.9719 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7049
============ Train epoch 41 ============
denominator: 15063.095863666767
 Site-MNIST     | Train Loss: 1.4379 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 1.2846 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.1733 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 1.2773 | Train Acc: 0.8617
 Site-MNIST     | Train Loss: 1.1799 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 2.0142 | Train Acc: 0.5200
 Site-USPS      | Train Loss: 1.2645 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.7336 | Train Acc: 0.5541
 Site-SynthDigits| Train Loss: 1.7235 | Train Acc: 0.5676
 Site-MNIST-M   | Train Loss: 1.9803 | Train Acc: 0.4242
 Site-MNIST     | Val  Loss: 1.2074 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.2307 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 1.3418 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 1.2889 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.1811 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.8158 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.2946 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.7317 | Val  Acc: 0.5714
 Site-SynthDigits| Val  Loss: 1.7197 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 1.9554 | Val  Acc: 0.4091
Average Valid Accuracy: 0.7198
 Best site-MNIST      | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:41 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:41 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:41 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:41 | Val Acc: 0.2727
 Best site-USPS       | Epoch:41 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.5714
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.5714
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.4091
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 42 ============
denominator: 14760.477949188782
 Site-MNIST     | Train Loss: 1.3332 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 1.2576 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 1.1793 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.2480 | Train Acc: 0.8617
 Site-MNIST     | Train Loss: 1.1435 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 2.0478 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 1.2442 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.6928 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 1.7004 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 1.7927 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 1.1634 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.1901 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 1.3097 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 1.2588 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.1521 | Val  Acc: 0.8228
 Site-SVHN      | Val  Loss: 1.8042 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 1.2706 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.6930 | Val  Acc: 0.5714
 Site-SynthDigits| Val  Loss: 1.6873 | Val  Acc: 0.5816
 Site-MNIST-M   | Val  Loss: 1.9346 | Val  Acc: 0.4545
Average Valid Accuracy: 0.7271
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:42 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:42 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:42 | Val Acc: 0.8228
 Best site-SVHN       | Epoch:42 | Val Acc: 0.3030
 Best site-USPS       | Epoch:42 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.5714
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.5816
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 43 ============
denominator: 14474.858100222182
 Site-MNIST     | Train Loss: 1.2344 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 1.2186 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 1.1616 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.2135 | Train Acc: 0.8617
 Site-MNIST     | Train Loss: 1.0995 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 2.0258 | Train Acc: 0.4800
 Site-USPS      | Train Loss: 1.2106 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.6787 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 1.6625 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 1.9302 | Train Acc: 0.5152
 Site-MNIST     | Val  Loss: 1.1371 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.1586 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 1.2755 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 1.2255 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.1222 | Val  Acc: 0.8228
 Site-SVHN      | Val  Loss: 1.7925 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.2408 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.6803 | Val  Acc: 0.5918
 Site-SynthDigits| Val  Loss: 1.6685 | Val  Acc: 0.5816
 Site-MNIST-M   | Val  Loss: 1.9233 | Val  Acc: 0.4545
Average Valid Accuracy: 0.7262
============ Train epoch 44 ============
denominator: 14240.055133905644
 Site-MNIST     | Train Loss: 1.2926 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 1.1910 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 1.0722 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 1.1800 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 1.0451 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 1.9997 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 1.1957 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.6301 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.6549 | Train Acc: 0.6216
 Site-MNIST-M   | Train Loss: 1.8347 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 1.0794 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.1063 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 1.2365 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 1.1926 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.0861 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.7522 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.2070 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.6165 | Val  Acc: 0.6122
 Site-SynthDigits| Val  Loss: 1.6165 | Val  Acc: 0.6020
 Site-MNIST-M   | Val  Loss: 1.8928 | Val  Acc: 0.5455
Average Valid Accuracy: 0.7488
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:44 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:44 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:44 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:44 | Val Acc: 0.3333
 Best site-USPS       | Epoch:44 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.6122
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.6020
 Best site-MNIST-M    | Epoch:44 | Val Acc: 0.5455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 45 ============
denominator: 13965.575610107813
 Site-MNIST     | Train Loss: 1.2497 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 1.1452 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 1.1008 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 1.1410 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 1.0407 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 2.0049 | Train Acc: 0.5400
 Site-USPS      | Train Loss: 1.1530 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.6151 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.6197 | Train Acc: 0.6216
 Site-MNIST-M   | Train Loss: 1.9140 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 1.0531 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.0769 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 1.1993 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 1.1532 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.0535 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 1.7480 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.1687 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.6047 | Val  Acc: 0.6122
 Site-SynthDigits| Val  Loss: 1.5921 | Val  Acc: 0.6020
 Site-MNIST-M   | Val  Loss: 1.8827 | Val  Acc: 0.5455
Average Valid Accuracy: 0.7427
============ Train epoch 46 ============
denominator: 13677.05173046056
 Site-MNIST     | Train Loss: 1.1529 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 1.1131 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 1.0697 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 1.1082 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.9863 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9796 | Train Acc: 0.5800
 Site-USPS      | Train Loss: 1.1366 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.5743 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.5919 | Train Acc: 0.6486
 Site-MNIST-M   | Train Loss: 1.9854 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 1.0037 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.0310 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 1.1650 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 1.1207 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 1.0198 | Val  Acc: 0.8481
 Site-SVHN      | Val  Loss: 1.7427 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.1524 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.5492 | Val  Acc: 0.6531
 Site-SynthDigits| Val  Loss: 1.5518 | Val  Acc: 0.6429
 Site-MNIST-M   | Val  Loss: 1.8582 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7476
============ Train epoch 47 ============
denominator: 13196.218759821488
 Site-MNIST     | Train Loss: 1.1478 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 1.0883 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 1.0193 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 1.0820 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.9988 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9256 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 1.0932 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.5541 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 1.5701 | Train Acc: 0.6554
 Site-MNIST-M   | Train Loss: 1.8006 | Train Acc: 0.5758
 Site-MNIST     | Val  Loss: 0.9827 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 1.0009 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 1.1337 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 1.1007 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 1.0013 | Val  Acc: 0.8481
 Site-SVHN      | Val  Loss: 1.7061 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.1069 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.5099 | Val  Acc: 0.6531
 Site-SynthDigits| Val  Loss: 1.5154 | Val  Acc: 0.6429
 Site-MNIST-M   | Val  Loss: 1.8425 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7451
============ Train epoch 48 ============
denominator: 13014.726897584034
 Site-MNIST     | Train Loss: 1.0720 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 1.0213 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.9893 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 1.0262 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.9086 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.9361 | Train Acc: 0.5600
 Site-USPS      | Train Loss: 1.0717 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.5132 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 1.5177 | Train Acc: 0.6689
 Site-MNIST-M   | Train Loss: 1.7390 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.9150 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.9540 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 1.0896 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 1.0363 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.9411 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 1.7029 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.0750 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.4849 | Val  Acc: 0.6531
 Site-SynthDigits| Val  Loss: 1.4802 | Val  Acc: 0.6531
 Site-MNIST-M   | Val  Loss: 1.8276 | Val  Acc: 0.5455
Average Valid Accuracy: 0.7592
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:48 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:48 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:48 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:48 | Val Acc: 0.2424
 Best site-USPS       | Epoch:48 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.6531
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.6531
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.5455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 49 ============
denominator: 12561.601795262726
 Site-MNIST     | Train Loss: 1.0727 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 1.0147 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 1.0044 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 1.0083 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.8936 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9197 | Train Acc: 0.6400
 Site-USPS      | Train Loss: 1.0627 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.4636 | Train Acc: 0.6622
 Site-SynthDigits| Train Loss: 1.4948 | Train Acc: 0.6959
 Site-MNIST-M   | Train Loss: 1.5739 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.8991 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.9356 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 1.0789 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 1.0261 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.9303 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 1.6790 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 1.0425 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 1.4390 | Val  Acc: 0.7143
 Site-SynthDigits| Val  Loss: 1.4375 | Val  Acc: 0.6837
 Site-MNIST-M   | Val  Loss: 1.8113 | Val  Acc: 0.5455
Average Valid Accuracy: 0.7731
 Best site-MNIST      | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:49 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:49 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:49 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:49 | Val Acc: 0.3333
 Best site-USPS       | Epoch:49 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.7143
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.6837
 Best site-MNIST-M    | Epoch:49 | Val Acc: 0.5455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.7836
 Test site-SVHN      | Epoch:49 | Test Acc: 0.2917
 Test site-USPS      | Epoch:49 | Test Acc: 0.8710
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.5841
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.4621
Average Test Accuracy: 0.5985
===2023-04-20 22:38:45===
===2023-04-20 22:38:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.7836
 Test site-SVHN      | Epoch:49 | Test Acc: 0.2917
 Test site-USPS      | Epoch:49 | Test Acc: 0.8710
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.5841
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.4621
Average Test Accuracy: 0.5985
===2023-04-21 22:13:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
denominator: 23151.451171875
 Site-MNIST     | Train Loss: 2.2978 | Train Acc: 0.0435
 Site-MNIST     | Train Loss: 2.3074 | Train Acc: 0.1277
 Site-MNIST     | Train Loss: 2.3023 | Train Acc: 0.0986
 Site-MNIST     | Train Loss: 2.2923 | Train Acc: 0.1596
 Site-MNIST     | Train Loss: 2.2942 | Train Acc: 0.1441
 Site-SVHN      | Train Loss: 2.2925 | Train Acc: 0.0800
 Site-USPS      | Train Loss: 2.3164 | Train Acc: 0.0909
 Site-SynthDigits| Train Loss: 2.3202 | Train Acc: 0.0946
 Site-SynthDigits| Train Loss: 2.3155 | Train Acc: 0.0811
 Site-MNIST-M   | Train Loss: 2.3181 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.2865 | Val  Acc: 0.2667
 Site-MNIST     | Val  Loss: 2.2997 | Val  Acc: 0.1290
 Site-MNIST     | Val  Loss: 2.3005 | Val  Acc: 0.1064
 Site-MNIST     | Val  Loss: 2.2892 | Val  Acc: 0.1905
 Site-MNIST     | Val  Loss: 2.3009 | Val  Acc: 0.1266
 Site-SVHN      | Val  Loss: 2.2972 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 2.3200 | Val  Acc: 0.1034
 Site-SynthDigits| Val  Loss: 2.3328 | Val  Acc: 0.0408
 Site-SynthDigits| Val  Loss: 2.3164 | Val  Acc: 0.0714
 Site-MNIST-M   | Val  Loss: 2.3287 | Val  Acc: 0.0455
Average Valid Accuracy: 0.1262
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1290
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1064
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1905
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1266
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1818
 Best site-USPS       | Epoch:0 | Val Acc: 0.1034
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0408
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0714
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 1 ============
denominator: 23057.775390625
 Site-MNIST     | Train Loss: 2.2845 | Train Acc: 0.0870
 Site-MNIST     | Train Loss: 2.2964 | Train Acc: 0.1277
 Site-MNIST     | Train Loss: 2.2957 | Train Acc: 0.1268
 Site-MNIST     | Train Loss: 2.2808 | Train Acc: 0.1809
 Site-MNIST     | Train Loss: 2.2778 | Train Acc: 0.1780
 Site-SVHN      | Train Loss: 2.2885 | Train Acc: 0.1000
 Site-USPS      | Train Loss: 2.3075 | Train Acc: 0.1591
 Site-SynthDigits| Train Loss: 2.3148 | Train Acc: 0.0946
 Site-SynthDigits| Train Loss: 2.3079 | Train Acc: 0.1081
 Site-MNIST-M   | Train Loss: 2.2567 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.2726 | Val  Acc: 0.2667
 Site-MNIST     | Val  Loss: 2.2884 | Val  Acc: 0.1613
 Site-MNIST     | Val  Loss: 2.2925 | Val  Acc: 0.1489
 Site-MNIST     | Val  Loss: 2.2780 | Val  Acc: 0.2063
 Site-MNIST     | Val  Loss: 2.2868 | Val  Acc: 0.1266
 Site-SVHN      | Val  Loss: 2.2951 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 2.3084 | Val  Acc: 0.1379
 Site-SynthDigits| Val  Loss: 2.3300 | Val  Acc: 0.1020
 Site-SynthDigits| Val  Loss: 2.3136 | Val  Acc: 0.1122
 Site-MNIST-M   | Val  Loss: 2.3259 | Val  Acc: 0.0455
Average Valid Accuracy: 0.1489
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.1613
 Best site-MNIST      | Epoch:1 | Val Acc: 0.1489
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2063
 Best site-MNIST      | Epoch:1 | Val Acc: 0.1266
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1818
 Best site-USPS       | Epoch:1 | Val Acc: 0.1379
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1020
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1122
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 2 ============
denominator: 22993.4453125
 Site-MNIST     | Train Loss: 2.2803 | Train Acc: 0.0435
 Site-MNIST     | Train Loss: 2.2867 | Train Acc: 0.1702
 Site-MNIST     | Train Loss: 2.2765 | Train Acc: 0.1831
 Site-MNIST     | Train Loss: 2.2709 | Train Acc: 0.2234
 Site-MNIST     | Train Loss: 2.2726 | Train Acc: 0.1949
 Site-SVHN      | Train Loss: 2.3239 | Train Acc: 0.1000
 Site-USPS      | Train Loss: 2.2938 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 2.3123 | Train Acc: 0.0946
 Site-SynthDigits| Train Loss: 2.3135 | Train Acc: 0.1149
 Site-MNIST-M   | Train Loss: 2.2794 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.2601 | Val  Acc: 0.3333
 Site-MNIST     | Val  Loss: 2.2775 | Val  Acc: 0.2581
 Site-MNIST     | Val  Loss: 2.2845 | Val  Acc: 0.2128
 Site-MNIST     | Val  Loss: 2.2670 | Val  Acc: 0.2381
 Site-MNIST     | Val  Loss: 2.2720 | Val  Acc: 0.1772
 Site-SVHN      | Val  Loss: 2.2919 | Val  Acc: 0.1515
 Site-USPS      | Val  Loss: 2.2946 | Val  Acc: 0.1724
 Site-SynthDigits| Val  Loss: 2.3271 | Val  Acc: 0.1224
 Site-SynthDigits| Val  Loss: 2.3111 | Val  Acc: 0.1224
 Site-MNIST-M   | Val  Loss: 2.3228 | Val  Acc: 0.0455
Average Valid Accuracy: 0.1834
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.2581
 Best site-MNIST      | Epoch:2 | Val Acc: 0.2128
 Best site-MNIST      | Epoch:2 | Val Acc: 0.2381
 Best site-MNIST      | Epoch:2 | Val Acc: 0.1772
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1515
 Best site-USPS       | Epoch:2 | Val Acc: 0.1724
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1224
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1224
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 3 ============
denominator: 22877.326171875
 Site-MNIST     | Train Loss: 2.2886 | Train Acc: 0.0870
 Site-MNIST     | Train Loss: 2.2760 | Train Acc: 0.1915
 Site-MNIST     | Train Loss: 2.2699 | Train Acc: 0.2817
 Site-MNIST     | Train Loss: 2.2592 | Train Acc: 0.3085
 Site-MNIST     | Train Loss: 2.2525 | Train Acc: 0.2542
 Site-SVHN      | Train Loss: 2.2941 | Train Acc: 0.1200
 Site-USPS      | Train Loss: 2.2825 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.3090 | Train Acc: 0.0946
 Site-SynthDigits| Train Loss: 2.3027 | Train Acc: 0.1081
 Site-MNIST-M   | Train Loss: 2.2536 | Train Acc: 0.0606
 Site-MNIST     | Val  Loss: 2.2446 | Val  Acc: 0.4000
 Site-MNIST     | Val  Loss: 2.2652 | Val  Acc: 0.2903
 Site-MNIST     | Val  Loss: 2.2752 | Val  Acc: 0.2766
 Site-MNIST     | Val  Loss: 2.2561 | Val  Acc: 0.3333
 Site-MNIST     | Val  Loss: 2.2590 | Val  Acc: 0.2785
 Site-SVHN      | Val  Loss: 2.2902 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 2.2840 | Val  Acc: 0.1724
 Site-SynthDigits| Val  Loss: 2.3240 | Val  Acc: 0.1224
 Site-SynthDigits| Val  Loss: 2.3084 | Val  Acc: 0.1020
 Site-MNIST-M   | Val  Loss: 2.3205 | Val  Acc: 0.0455
Average Valid Accuracy: 0.2203
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.2903
 Best site-MNIST      | Epoch:3 | Val Acc: 0.2766
 Best site-MNIST      | Epoch:3 | Val Acc: 0.3333
 Best site-MNIST      | Epoch:3 | Val Acc: 0.2785
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1818
 Best site-USPS       | Epoch:3 | Val Acc: 0.1724
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.1224
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.1020
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 4 ============
denominator: 22762.7421875
 Site-MNIST     | Train Loss: 2.2729 | Train Acc: 0.1739
 Site-MNIST     | Train Loss: 2.2656 | Train Acc: 0.2553
 Site-MNIST     | Train Loss: 2.2483 | Train Acc: 0.3662
 Site-MNIST     | Train Loss: 2.2497 | Train Acc: 0.3404
 Site-MNIST     | Train Loss: 2.2384 | Train Acc: 0.3644
 Site-SVHN      | Train Loss: 2.2914 | Train Acc: 0.1400
 Site-USPS      | Train Loss: 2.2705 | Train Acc: 0.3409
 Site-SynthDigits| Train Loss: 2.3060 | Train Acc: 0.1216
 Site-SynthDigits| Train Loss: 2.3004 | Train Acc: 0.1419
 Site-MNIST-M   | Train Loss: 2.2837 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 2.2312 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.2545 | Val  Acc: 0.3871
 Site-MNIST     | Val  Loss: 2.2670 | Val  Acc: 0.2979
 Site-MNIST     | Val  Loss: 2.2449 | Val  Acc: 0.3651
 Site-MNIST     | Val  Loss: 2.2448 | Val  Acc: 0.3544
 Site-SVHN      | Val  Loss: 2.2872 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 2.2714 | Val  Acc: 0.2069
 Site-SynthDigits| Val  Loss: 2.3208 | Val  Acc: 0.1224
 Site-SynthDigits| Val  Loss: 2.3059 | Val  Acc: 0.1224
 Site-MNIST-M   | Val  Loss: 2.3179 | Val  Acc: 0.0455
Average Valid Accuracy: 0.2677
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:4 | Val Acc: 0.3871
 Best site-MNIST      | Epoch:4 | Val Acc: 0.2979
 Best site-MNIST      | Epoch:4 | Val Acc: 0.3651
 Best site-MNIST      | Epoch:4 | Val Acc: 0.3544
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2424
 Best site-USPS       | Epoch:4 | Val Acc: 0.2069
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.1224
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.1224
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 5 ============
denominator: 22741.05859375
 Site-MNIST     | Train Loss: 2.2707 | Train Acc: 0.2174
 Site-MNIST     | Train Loss: 2.2555 | Train Acc: 0.3191
 Site-MNIST     | Train Loss: 2.2298 | Train Acc: 0.4366
 Site-MNIST     | Train Loss: 2.2385 | Train Acc: 0.3723
 Site-MNIST     | Train Loss: 2.2294 | Train Acc: 0.4407
 Site-SVHN      | Train Loss: 2.3004 | Train Acc: 0.2000
 Site-USPS      | Train Loss: 2.2535 | Train Acc: 0.3636
 Site-SynthDigits| Train Loss: 2.3015 | Train Acc: 0.1216
 Site-SynthDigits| Train Loss: 2.2938 | Train Acc: 0.1486
 Site-MNIST-M   | Train Loss: 2.2807 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 2.2187 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.2437 | Val  Acc: 0.3871
 Site-MNIST     | Val  Loss: 2.2590 | Val  Acc: 0.3191
 Site-MNIST     | Val  Loss: 2.2349 | Val  Acc: 0.4127
 Site-MNIST     | Val  Loss: 2.2315 | Val  Acc: 0.4304
 Site-SVHN      | Val  Loss: 2.2850 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.2594 | Val  Acc: 0.3103
 Site-SynthDigits| Val  Loss: 2.3164 | Val  Acc: 0.1429
 Site-SynthDigits| Val  Loss: 2.3027 | Val  Acc: 0.1327
 Site-MNIST-M   | Val  Loss: 2.3152 | Val  Acc: 0.0455
Average Valid Accuracy: 0.3017
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:5 | Val Acc: 0.3871
 Best site-MNIST      | Epoch:5 | Val Acc: 0.3191
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4127
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4304
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3030
 Best site-USPS       | Epoch:5 | Val Acc: 0.3103
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.1429
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.1327
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 6 ============
denominator: 22646.482421875
 Site-MNIST     | Train Loss: 2.2655 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.2446 | Train Acc: 0.3617
 Site-MNIST     | Train Loss: 2.2191 | Train Acc: 0.4789
 Site-MNIST     | Train Loss: 2.2294 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 2.2123 | Train Acc: 0.4492
 Site-SVHN      | Train Loss: 2.2728 | Train Acc: 0.2000
 Site-USPS      | Train Loss: 2.2426 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 2.3022 | Train Acc: 0.1216
 Site-SynthDigits| Train Loss: 2.2964 | Train Acc: 0.1486
 Site-MNIST-M   | Train Loss: 2.2772 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 2.2056 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.2324 | Val  Acc: 0.4516
 Site-MNIST     | Val  Loss: 2.2505 | Val  Acc: 0.3830
 Site-MNIST     | Val  Loss: 2.2241 | Val  Acc: 0.4444
 Site-MNIST     | Val  Loss: 2.2181 | Val  Acc: 0.4684
 Site-SVHN      | Val  Loss: 2.2840 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.2477 | Val  Acc: 0.2759
 Site-SynthDigits| Val  Loss: 2.3151 | Val  Acc: 0.1429
 Site-SynthDigits| Val  Loss: 2.2997 | Val  Acc: 0.1327
 Site-MNIST-M   | Val  Loss: 2.3128 | Val  Acc: 0.0455
Average Valid Accuracy: 0.3150
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:6 | Val Acc: 0.4516
 Best site-MNIST      | Epoch:6 | Val Acc: 0.3830
 Best site-MNIST      | Epoch:6 | Val Acc: 0.4444
 Best site-MNIST      | Epoch:6 | Val Acc: 0.4684
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2727
 Best site-USPS       | Epoch:6 | Val Acc: 0.2759
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.1429
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.1327
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 7 ============
denominator: 22600.736328125
 Site-MNIST     | Train Loss: 2.2557 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.2349 | Train Acc: 0.3404
 Site-MNIST     | Train Loss: 2.2107 | Train Acc: 0.4930
 Site-MNIST     | Train Loss: 2.2181 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 2.2035 | Train Acc: 0.4661
 Site-SVHN      | Train Loss: 2.2952 | Train Acc: 0.2000
 Site-USPS      | Train Loss: 2.2306 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2971 | Train Acc: 0.1216
 Site-SynthDigits| Train Loss: 2.2938 | Train Acc: 0.1419
 Site-MNIST-M   | Train Loss: 2.2720 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 2.1923 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 2.2213 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.2426 | Val  Acc: 0.3830
 Site-MNIST     | Val  Loss: 2.2137 | Val  Acc: 0.4444
 Site-MNIST     | Val  Loss: 2.2043 | Val  Acc: 0.4937
 Site-SVHN      | Val  Loss: 2.2805 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.2349 | Val  Acc: 0.3103
 Site-SynthDigits| Val  Loss: 2.3126 | Val  Acc: 0.1429
 Site-SynthDigits| Val  Loss: 2.2970 | Val  Acc: 0.1224
 Site-MNIST-M   | Val  Loss: 2.3089 | Val  Acc: 0.0455
Average Valid Accuracy: 0.3299
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:7 | Val Acc: 0.3830
 Best site-MNIST      | Epoch:7 | Val Acc: 0.4444
 Best site-MNIST      | Epoch:7 | Val Acc: 0.4937
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2727
 Best site-USPS       | Epoch:7 | Val Acc: 0.3103
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.1429
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.1224
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.0455
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 8 ============
denominator: 22476.767578125
 Site-MNIST     | Train Loss: 2.2395 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.2226 | Train Acc: 0.3404
 Site-MNIST     | Train Loss: 2.2000 | Train Acc: 0.4930
 Site-MNIST     | Train Loss: 2.2078 | Train Acc: 0.4362
 Site-MNIST     | Train Loss: 2.1905 | Train Acc: 0.4746
 Site-SVHN      | Train Loss: 2.2695 | Train Acc: 0.2400
 Site-USPS      | Train Loss: 2.2183 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2932 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.2861 | Train Acc: 0.1419
 Site-MNIST-M   | Train Loss: 2.3025 | Train Acc: 0.1212
 Site-MNIST     | Val  Loss: 2.1794 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 2.2103 | Val  Acc: 0.5161
 Site-MNIST     | Val  Loss: 2.2344 | Val  Acc: 0.3830
 Site-MNIST     | Val  Loss: 2.2034 | Val  Acc: 0.4444
 Site-MNIST     | Val  Loss: 2.1910 | Val  Acc: 0.4937
 Site-SVHN      | Val  Loss: 2.2788 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.2243 | Val  Acc: 0.3448
 Site-SynthDigits| Val  Loss: 2.3099 | Val  Acc: 0.1429
 Site-SynthDigits| Val  Loss: 2.2940 | Val  Acc: 0.1224
 Site-MNIST-M   | Val  Loss: 2.3065 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3441
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5161
 Best site-MNIST      | Epoch:8 | Val Acc: 0.3830
 Best site-MNIST      | Epoch:8 | Val Acc: 0.4444
 Best site-MNIST      | Epoch:8 | Val Acc: 0.4937
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3030
 Best site-USPS       | Epoch:8 | Val Acc: 0.3448
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.1429
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.1224
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 9 ============
denominator: 22476.19921875
 Site-MNIST     | Train Loss: 2.2406 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.2125 | Train Acc: 0.3617
 Site-MNIST     | Train Loss: 2.1818 | Train Acc: 0.4789
 Site-MNIST     | Train Loss: 2.1986 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 2.1692 | Train Acc: 0.4746
 Site-SVHN      | Train Loss: 2.2725 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 2.2070 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2898 | Train Acc: 0.1486
 Site-SynthDigits| Train Loss: 2.2913 | Train Acc: 0.1622
 Site-MNIST-M   | Train Loss: 2.2230 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 2.1664 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 2.1994 | Val  Acc: 0.5161
 Site-MNIST     | Val  Loss: 2.2266 | Val  Acc: 0.3830
 Site-MNIST     | Val  Loss: 2.1929 | Val  Acc: 0.4286
 Site-MNIST     | Val  Loss: 2.1774 | Val  Acc: 0.4810
 Site-SVHN      | Val  Loss: 2.2771 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.2126 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.3061 | Val  Acc: 0.1633
 Site-SynthDigits| Val  Loss: 2.2905 | Val  Acc: 0.1531
 Site-MNIST-M   | Val  Loss: 2.3042 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3533
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.5161
 Best site-MNIST      | Epoch:9 | Val Acc: 0.3830
 Best site-MNIST      | Epoch:9 | Val Acc: 0.4286
 Best site-MNIST      | Epoch:9 | Val Acc: 0.4810
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3030
 Best site-USPS       | Epoch:9 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.1633
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.1531
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.3279
 Test site-SVHN      | Epoch:9 | Test Acc: 0.1471
 Test site-USPS      | Epoch:9 | Test Acc: 0.4140
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.1463
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.1207
Average Test Accuracy: 0.2312
============ Train epoch 10 ============
denominator: 22391.201171875
 Site-MNIST     | Train Loss: 2.2236 | Train Acc: 0.3043
 Site-MNIST     | Train Loss: 2.2008 | Train Acc: 0.3830
 Site-MNIST     | Train Loss: 2.1847 | Train Acc: 0.4930
 Site-MNIST     | Train Loss: 2.1859 | Train Acc: 0.4362
 Site-MNIST     | Train Loss: 2.1741 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2569 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 2.2029 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2860 | Train Acc: 0.1486
 Site-SynthDigits| Train Loss: 2.2880 | Train Acc: 0.1419
 Site-MNIST-M   | Train Loss: 2.2215 | Train Acc: 0.1515
 Site-MNIST     | Val  Loss: 2.1521 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 2.1876 | Val  Acc: 0.5161
 Site-MNIST     | Val  Loss: 2.2173 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.1817 | Val  Acc: 0.4286
 Site-MNIST     | Val  Loss: 2.1643 | Val  Acc: 0.4937
 Site-SVHN      | Val  Loss: 2.2751 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.2026 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.3037 | Val  Acc: 0.1224
 Site-SynthDigits| Val  Loss: 2.2877 | Val  Acc: 0.1429
 Site-MNIST-M   | Val  Loss: 2.3018 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3516
============ Train epoch 11 ============
denominator: 22342.048828125
 Site-MNIST     | Train Loss: 2.2277 | Train Acc: 0.3043
 Site-MNIST     | Train Loss: 2.1904 | Train Acc: 0.3830
 Site-MNIST     | Train Loss: 2.1562 | Train Acc: 0.4930
 Site-MNIST     | Train Loss: 2.1769 | Train Acc: 0.4362
 Site-MNIST     | Train Loss: 2.1610 | Train Acc: 0.4831
 Site-SVHN      | Train Loss: 2.2745 | Train Acc: 0.2600
 Site-USPS      | Train Loss: 2.1839 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2873 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.2806 | Train Acc: 0.1622
 Site-MNIST-M   | Train Loss: 2.2347 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 2.1391 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.1767 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.2091 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.1709 | Val  Acc: 0.4286
 Site-MNIST     | Val  Loss: 2.1509 | Val  Acc: 0.4937
 Site-SVHN      | Val  Loss: 2.2733 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.1923 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.3012 | Val  Acc: 0.1633
 Site-SynthDigits| Val  Loss: 2.2851 | Val  Acc: 0.1633
 Site-MNIST-M   | Val  Loss: 2.3003 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3547
 Best site-MNIST      | Epoch:11 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:11 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:11 | Val Acc: 0.4043
 Best site-MNIST      | Epoch:11 | Val Acc: 0.4286
 Best site-MNIST      | Epoch:11 | Val Acc: 0.4937
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3030
 Best site-USPS       | Epoch:11 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.1633
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.1633
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 12 ============
denominator: 22265.439453125
 Site-MNIST     | Train Loss: 2.1969 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.1781 | Train Acc: 0.3617
 Site-MNIST     | Train Loss: 2.1397 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.1654 | Train Acc: 0.4362
 Site-MNIST     | Train Loss: 2.1338 | Train Acc: 0.5085
 Site-SVHN      | Train Loss: 2.2834 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 2.1753 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.2839 | Train Acc: 0.1486
 Site-SynthDigits| Train Loss: 2.2800 | Train Acc: 0.1757
 Site-MNIST-M   | Train Loss: 2.2733 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 2.1253 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.1649 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.1999 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.1600 | Val  Acc: 0.4286
 Site-MNIST     | Val  Loss: 2.1378 | Val  Acc: 0.5190
 Site-SVHN      | Val  Loss: 2.2712 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.1815 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2983 | Val  Acc: 0.1633
 Site-SynthDigits| Val  Loss: 2.2825 | Val  Acc: 0.1633
 Site-MNIST-M   | Val  Loss: 2.2987 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3572
 Best site-MNIST      | Epoch:12 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:12 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:12 | Val Acc: 0.4043
 Best site-MNIST      | Epoch:12 | Val Acc: 0.4286
 Best site-MNIST      | Epoch:12 | Val Acc: 0.5190
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3030
 Best site-USPS       | Epoch:12 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.1633
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.1633
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 13 ============
denominator: 22154.154296875
 Site-MNIST     | Train Loss: 2.1928 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.1674 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.1345 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.1540 | Train Acc: 0.4574
 Site-MNIST     | Train Loss: 2.1227 | Train Acc: 0.5085
 Site-SVHN      | Train Loss: 2.2512 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 2.1642 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2770 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.2803 | Train Acc: 0.1892
 Site-MNIST-M   | Train Loss: 2.2705 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 2.1115 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.1526 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.1899 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.1492 | Val  Acc: 0.4603
 Site-MNIST     | Val  Loss: 2.1253 | Val  Acc: 0.5190
 Site-SVHN      | Val  Loss: 2.2704 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 2.1711 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2962 | Val  Acc: 0.1633
 Site-SynthDigits| Val  Loss: 2.2794 | Val  Acc: 0.1735
 Site-MNIST-M   | Val  Loss: 2.2976 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3645
 Best site-MNIST      | Epoch:13 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:13 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:13 | Val Acc: 0.4043
 Best site-MNIST      | Epoch:13 | Val Acc: 0.4603
 Best site-MNIST      | Epoch:13 | Val Acc: 0.5190
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3333
 Best site-USPS       | Epoch:13 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.1633
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.1735
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 14 ============
denominator: 22054.01953125
 Site-MNIST     | Train Loss: 2.1932 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.1541 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.1281 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.1437 | Train Acc: 0.4574
 Site-MNIST     | Train Loss: 2.1109 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2568 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 2.1504 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2771 | Train Acc: 0.1622
 Site-SynthDigits| Train Loss: 2.2759 | Train Acc: 0.1892
 Site-MNIST-M   | Train Loss: 2.2260 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 2.0976 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.1404 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.1803 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.1382 | Val  Acc: 0.4603
 Site-MNIST     | Val  Loss: 2.1126 | Val  Acc: 0.5190
 Site-SVHN      | Val  Loss: 2.2677 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.1603 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2934 | Val  Acc: 0.1633
 Site-SynthDigits| Val  Loss: 2.2763 | Val  Acc: 0.1735
 Site-MNIST-M   | Val  Loss: 2.2960 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3584
============ Train epoch 15 ============
denominator: 22011.416015625
 Site-MNIST     | Train Loss: 2.1620 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.1434 | Train Acc: 0.3830
 Site-MNIST     | Train Loss: 2.1242 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.1331 | Train Acc: 0.4574
 Site-MNIST     | Train Loss: 2.1034 | Train Acc: 0.4915
 Site-SVHN      | Train Loss: 2.2420 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 2.1442 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2710 | Train Acc: 0.2027
 Site-SynthDigits| Train Loss: 2.2702 | Train Acc: 0.2095
 Site-MNIST-M   | Train Loss: 2.2531 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 2.0857 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.1298 | Val  Acc: 0.4839
 Site-MNIST     | Val  Loss: 2.1724 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.1276 | Val  Acc: 0.4603
 Site-MNIST     | Val  Loss: 2.0986 | Val  Acc: 0.5190
 Site-SVHN      | Val  Loss: 2.2660 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.1488 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.2923 | Val  Acc: 0.2245
 Site-SynthDigits| Val  Loss: 2.2741 | Val  Acc: 0.2041
 Site-MNIST-M   | Val  Loss: 2.2945 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3676
 Best site-MNIST      | Epoch:15 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:15 | Val Acc: 0.4839
 Best site-MNIST      | Epoch:15 | Val Acc: 0.4043
 Best site-MNIST      | Epoch:15 | Val Acc: 0.4603
 Best site-MNIST      | Epoch:15 | Val Acc: 0.5190
 Best site-SVHN       | Epoch:15 | Val Acc: 0.2727
 Best site-USPS       | Epoch:15 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.2245
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.2041
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 16 ============
denominator: 21966.939453125
 Site-MNIST     | Train Loss: 2.1890 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.1306 | Train Acc: 0.3830
 Site-MNIST     | Train Loss: 2.0921 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.1250 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 2.0827 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2454 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 2.1327 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2694 | Train Acc: 0.2027
 Site-SynthDigits| Train Loss: 2.2675 | Train Acc: 0.2095
 Site-MNIST-M   | Train Loss: 2.2873 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 2.0740 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.1193 | Val  Acc: 0.5161
 Site-MNIST     | Val  Loss: 2.1640 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.1177 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 2.0856 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2656 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.1383 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2912 | Val  Acc: 0.2245
 Site-SynthDigits| Val  Loss: 2.2715 | Val  Acc: 0.2041
 Site-MNIST-M   | Val  Loss: 2.2932 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3702
 Best site-MNIST      | Epoch:16 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:16 | Val Acc: 0.5161
 Best site-MNIST      | Epoch:16 | Val Acc: 0.4043
 Best site-MNIST      | Epoch:16 | Val Acc: 0.4762
 Best site-MNIST      | Epoch:16 | Val Acc: 0.5316
 Best site-SVHN       | Epoch:16 | Val Acc: 0.2727
 Best site-USPS       | Epoch:16 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.2245
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.2041
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 17 ============
denominator: 21791.974609375
 Site-MNIST     | Train Loss: 2.1421 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.1189 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.0912 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.1114 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 2.0870 | Train Acc: 0.5085
 Site-SVHN      | Train Loss: 2.2450 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 2.1114 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2670 | Train Acc: 0.2027
 Site-SynthDigits| Train Loss: 2.2676 | Train Acc: 0.2027
 Site-MNIST-M   | Train Loss: 2.2490 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 2.0600 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.1075 | Val  Acc: 0.5161
 Site-MNIST     | Val  Loss: 2.1547 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.1061 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 2.0730 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2638 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.1294 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2885 | Val  Acc: 0.2041
 Site-SynthDigits| Val  Loss: 2.2680 | Val  Acc: 0.1939
 Site-MNIST-M   | Val  Loss: 2.2914 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3687
============ Train epoch 18 ============
denominator: 21791.830078125
 Site-MNIST     | Train Loss: 2.1502 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.1074 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.0518 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.1014 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 2.0619 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2495 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 2.1041 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2624 | Train Acc: 0.2027
 Site-SynthDigits| Train Loss: 2.2653 | Train Acc: 0.2230
 Site-MNIST-M   | Train Loss: 2.2378 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 2.0483 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.0975 | Val  Acc: 0.5161
 Site-MNIST     | Val  Loss: 2.1461 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.0955 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 2.0596 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2624 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.1188 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2876 | Val  Acc: 0.2245
 Site-SynthDigits| Val  Loss: 2.2661 | Val  Acc: 0.2143
 Site-MNIST-M   | Val  Loss: 2.2899 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3694
============ Train epoch 19 ============
denominator: 21747.07421875
 Site-MNIST     | Train Loss: 2.1443 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0983 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.0670 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0901 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 2.0653 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2520 | Train Acc: 0.3000
 Site-USPS      | Train Loss: 2.0967 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2568 | Train Acc: 0.1892
 Site-SynthDigits| Train Loss: 2.2636 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2580 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 2.0358 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.0866 | Val  Acc: 0.5161
 Site-MNIST     | Val  Loss: 2.1378 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.0845 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 2.0467 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2607 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.1090 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2844 | Val  Acc: 0.2449
 Site-SynthDigits| Val  Loss: 2.2623 | Val  Acc: 0.2347
 Site-MNIST-M   | Val  Loss: 2.2891 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3799
 Best site-MNIST      | Epoch:19 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:19 | Val Acc: 0.5161
 Best site-MNIST      | Epoch:19 | Val Acc: 0.4043
 Best site-MNIST      | Epoch:19 | Val Acc: 0.4921
 Best site-MNIST      | Epoch:19 | Val Acc: 0.5316
 Best site-SVHN       | Epoch:19 | Val Acc: 0.3030
 Best site-USPS       | Epoch:19 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.2449
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.2347
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.3686
 Test site-SVHN      | Epoch:19 | Test Acc: 0.1824
 Test site-USPS      | Epoch:19 | Test Acc: 0.4516
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.2124
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.1414
Average Test Accuracy: 0.2713
============ Train epoch 20 ============
denominator: 21667.490234375
 Site-MNIST     | Train Loss: 2.1204 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0866 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.0483 | Train Acc: 0.5070
 Site-MNIST     | Train Loss: 2.0822 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 2.0377 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2562 | Train Acc: 0.2800
 Site-USPS      | Train Loss: 2.0811 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2551 | Train Acc: 0.2162
 Site-SynthDigits| Train Loss: 2.2512 | Train Acc: 0.2568
 Site-MNIST-M   | Train Loss: 2.2439 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 2.0237 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.0769 | Val  Acc: 0.5484
 Site-MNIST     | Val  Loss: 2.1305 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.0750 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 2.0345 | Val  Acc: 0.5190
 Site-SVHN      | Val  Loss: 2.2591 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.0992 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2808 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.2583 | Val  Acc: 0.2551
 Site-MNIST-M   | Val  Loss: 2.2879 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3844
 Best site-MNIST      | Epoch:20 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:20 | Val Acc: 0.5484
 Best site-MNIST      | Epoch:20 | Val Acc: 0.4043
 Best site-MNIST      | Epoch:20 | Val Acc: 0.4762
 Best site-MNIST      | Epoch:20 | Val Acc: 0.5190
 Best site-SVHN       | Epoch:20 | Val Acc: 0.3030
 Best site-USPS       | Epoch:20 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.2653
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.2551
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 21 ============
denominator: 21706.765625
 Site-MNIST     | Train Loss: 2.1304 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0760 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 2.0364 | Train Acc: 0.5352
 Site-MNIST     | Train Loss: 2.0715 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 2.0358 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2229 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 2.0666 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.2537 | Train Acc: 0.2027
 Site-SynthDigits| Train Loss: 2.2468 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2134 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 2.0140 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 2.0673 | Val  Acc: 0.5161
 Site-MNIST     | Val  Loss: 2.1218 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.0659 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 2.0223 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2583 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.0890 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2812 | Val  Acc: 0.2449
 Site-SynthDigits| Val  Loss: 2.2584 | Val  Acc: 0.2347
 Site-MNIST-M   | Val  Loss: 2.2856 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3749
============ Train epoch 22 ============
denominator: 21529.142578125
 Site-MNIST     | Train Loss: 2.0948 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0653 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.0303 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0649 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 2.0250 | Train Acc: 0.5085
 Site-SVHN      | Train Loss: 2.2396 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 2.0607 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2445 | Train Acc: 0.2027
 Site-SynthDigits| Train Loss: 2.2505 | Train Acc: 0.2635
 Site-MNIST-M   | Train Loss: 2.2348 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 2.0012 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 2.0562 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 2.1135 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.0556 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 2.0097 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2550 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.0775 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2789 | Val  Acc: 0.2449
 Site-SynthDigits| Val  Loss: 2.2542 | Val  Acc: 0.2551
 Site-MNIST-M   | Val  Loss: 2.2837 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3942
 Best site-MNIST      | Epoch:22 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:22 | Val Acc: 0.5806
 Best site-MNIST      | Epoch:22 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:22 | Val Acc: 0.4921
 Best site-MNIST      | Epoch:22 | Val Acc: 0.5316
 Best site-SVHN       | Epoch:22 | Val Acc: 0.2727
 Best site-USPS       | Epoch:22 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.2449
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.2551
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 23 ============
denominator: 21434.470703125
 Site-MNIST     | Train Loss: 2.0956 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0543 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 2.0040 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0526 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 2.0092 | Train Acc: 0.5085
 Site-SVHN      | Train Loss: 2.2481 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 2.0500 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2463 | Train Acc: 0.2027
 Site-SynthDigits| Train Loss: 2.2480 | Train Acc: 0.2635
 Site-MNIST-M   | Train Loss: 2.2609 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.9900 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 2.0461 | Val  Acc: 0.5484
 Site-MNIST     | Val  Loss: 2.1045 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 2.0450 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 1.9971 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2531 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.0669 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2780 | Val  Acc: 0.2245
 Site-SynthDigits| Val  Loss: 2.2512 | Val  Acc: 0.2551
 Site-MNIST-M   | Val  Loss: 2.2828 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3868
============ Train epoch 24 ============
denominator: 21296.8671875
 Site-MNIST     | Train Loss: 2.0824 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0420 | Train Acc: 0.3830
 Site-MNIST     | Train Loss: 1.9986 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0422 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.9863 | Train Acc: 0.5085
 Site-SVHN      | Train Loss: 2.2445 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 2.0418 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2429 | Train Acc: 0.2162
 Site-SynthDigits| Train Loss: 2.2491 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.2993 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.9758 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 2.0339 | Val  Acc: 0.5484
 Site-MNIST     | Val  Loss: 2.0953 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.0344 | Val  Acc: 0.5079
 Site-MNIST     | Val  Loss: 1.9839 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2520 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.0572 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 2.2760 | Val  Acc: 0.2449
 Site-SynthDigits| Val  Loss: 2.2481 | Val  Acc: 0.2653
 Site-MNIST-M   | Val  Loss: 2.2807 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3936
============ Train epoch 25 ============
denominator: 21350.94921875
 Site-MNIST     | Train Loss: 2.1257 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0329 | Train Acc: 0.3830
 Site-MNIST     | Train Loss: 2.0041 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0308 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 1.9963 | Train Acc: 0.5085
 Site-SVHN      | Train Loss: 2.2254 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 2.0408 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2338 | Train Acc: 0.2432
 Site-SynthDigits| Train Loss: 2.2395 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.2517 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.9653 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 2.0248 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 2.0874 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.0261 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.9730 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2509 | Val  Acc: 0.3030
 Site-USPS      | Val  Loss: 2.0473 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2735 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.2435 | Val  Acc: 0.2755
 Site-MNIST-M   | Val  Loss: 2.2794 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3963
 Best site-MNIST      | Epoch:25 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:25 | Val Acc: 0.5806
 Best site-MNIST      | Epoch:25 | Val Acc: 0.4255
 Best site-MNIST      | Epoch:25 | Val Acc: 0.4762
 Best site-MNIST      | Epoch:25 | Val Acc: 0.5316
 Best site-SVHN       | Epoch:25 | Val Acc: 0.3030
 Best site-USPS       | Epoch:25 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.2653
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.2755
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 26 ============
denominator: 21244.828125
 Site-MNIST     | Train Loss: 2.1114 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0229 | Train Acc: 0.3830
 Site-MNIST     | Train Loss: 1.9617 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0233 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 1.9937 | Train Acc: 0.5169
 Site-SVHN      | Train Loss: 2.2160 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 2.0213 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2317 | Train Acc: 0.2568
 Site-SynthDigits| Train Loss: 2.2341 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.1893 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.9553 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 2.0164 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 2.0795 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.0170 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.9611 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2492 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.0370 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2694 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.2392 | Val  Acc: 0.2755
 Site-MNIST-M   | Val  Loss: 2.2772 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3932
============ Train epoch 27 ============
denominator: 21169.552734375
 Site-MNIST     | Train Loss: 2.0589 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 2.0113 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 1.9698 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0124 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 1.9430 | Train Acc: 0.5169
 Site-SVHN      | Train Loss: 2.2311 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 2.0185 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2257 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.2318 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.2249 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 1.9428 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 2.0056 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 2.0695 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 2.0055 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.9481 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2482 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.0261 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2687 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.2363 | Val  Acc: 0.2755
 Site-MNIST-M   | Val  Loss: 2.2767 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3932
============ Train epoch 28 ============
denominator: 21035.865234375
 Site-MNIST     | Train Loss: 2.0884 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9986 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 1.9584 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 2.0014 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 1.9518 | Train Acc: 0.5169
 Site-SVHN      | Train Loss: 2.2091 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.9924 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2267 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.2307 | Train Acc: 0.2770
 Site-MNIST-M   | Train Loss: 2.2077 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 1.9314 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.9963 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 2.0612 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 1.9961 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.9368 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2469 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.0173 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2655 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.2328 | Val  Acc: 0.2857
 Site-MNIST-M   | Val  Loss: 2.2748 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3942
============ Train epoch 29 ============
denominator: 21027.94921875
 Site-MNIST     | Train Loss: 2.0731 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9862 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 1.9498 | Train Acc: 0.5352
 Site-MNIST     | Train Loss: 1.9921 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.9424 | Train Acc: 0.5254
 Site-SVHN      | Train Loss: 2.2349 | Train Acc: 0.3800
 Site-USPS      | Train Loss: 1.9935 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.2252 | Train Acc: 0.2838
 Site-SynthDigits| Train Loss: 2.2264 | Train Acc: 0.2770
 Site-MNIST-M   | Train Loss: 2.2092 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 1.9176 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.9847 | Val  Acc: 0.5484
 Site-MNIST     | Val  Loss: 2.0512 | Val  Acc: 0.4043
 Site-MNIST     | Val  Loss: 1.9845 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.9238 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2459 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 2.0087 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2635 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.2302 | Val  Acc: 0.2755
 Site-MNIST-M   | Val  Loss: 2.2744 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3879
============ Train epoch 30 ============
denominator: 20846.046875
 Site-MNIST     | Train Loss: 2.0526 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9766 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 1.9584 | Train Acc: 0.5211
 Site-MNIST     | Train Loss: 1.9832 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.9228 | Train Acc: 0.5339
 Site-SVHN      | Train Loss: 2.2097 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.9714 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2175 | Train Acc: 0.3108
 Site-SynthDigits| Train Loss: 2.2178 | Train Acc: 0.2770
 Site-MNIST-M   | Train Loss: 2.2017 | Train Acc: 0.2121
 Site-MNIST     | Val  Loss: 1.9098 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.9776 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 2.0441 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 1.9760 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.9118 | Val  Acc: 0.5316
 Site-SVHN      | Val  Loss: 2.2415 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.9975 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2604 | Val  Acc: 0.2653
 Site-SynthDigits| Val  Loss: 2.2271 | Val  Acc: 0.2857
 Site-MNIST-M   | Val  Loss: 2.2723 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3942
============ Train epoch 31 ============
denominator: 20804.52734375
 Site-MNIST     | Train Loss: 2.0336 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9663 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 1.9282 | Train Acc: 0.5493
 Site-MNIST     | Train Loss: 1.9704 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 1.8973 | Train Acc: 0.5254
 Site-SVHN      | Train Loss: 2.2235 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.9733 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.2172 | Train Acc: 0.2973
 Site-SynthDigits| Train Loss: 2.2268 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.2926 | Train Acc: 0.2424
 Site-MNIST     | Val  Loss: 1.8967 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.9666 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 2.0343 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 1.9648 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 1.8988 | Val  Acc: 0.5443
 Site-SVHN      | Val  Loss: 2.2401 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.9876 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2598 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.2260 | Val  Acc: 0.2959
 Site-MNIST-M   | Val  Loss: 2.2718 | Val  Acc: 0.1364
Average Valid Accuracy: 0.4089
 Best site-MNIST      | Epoch:31 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:31 | Val Acc: 0.5806
 Best site-MNIST      | Epoch:31 | Val Acc: 0.4468
 Best site-MNIST      | Epoch:31 | Val Acc: 0.4921
 Best site-MNIST      | Epoch:31 | Val Acc: 0.5443
 Best site-SVHN       | Epoch:31 | Val Acc: 0.2727
 Best site-USPS       | Epoch:31 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.3061
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.2959
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 32 ============
denominator: 20722.001953125
 Site-MNIST     | Train Loss: 2.0482 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9574 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 1.9194 | Train Acc: 0.5352
 Site-MNIST     | Train Loss: 1.9668 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.9020 | Train Acc: 0.5254
 Site-SVHN      | Train Loss: 2.2017 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.9528 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2118 | Train Acc: 0.3108
 Site-SynthDigits| Train Loss: 2.2178 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.2031 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8926 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.9614 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 2.0275 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 1.9583 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.8882 | Val  Acc: 0.5443
 Site-SVHN      | Val  Loss: 2.2388 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9776 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2558 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.2206 | Val  Acc: 0.2959
 Site-MNIST-M   | Val  Loss: 2.2695 | Val  Acc: 0.0909
Average Valid Accuracy: 0.3976
============ Train epoch 33 ============
denominator: 20639.68359375
 Site-MNIST     | Train Loss: 2.0312 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9467 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 1.9072 | Train Acc: 0.5493
 Site-MNIST     | Train Loss: 1.9563 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.9031 | Train Acc: 0.5254
 Site-SVHN      | Train Loss: 2.2241 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.9467 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 2.2063 | Train Acc: 0.3108
 Site-SynthDigits| Train Loss: 2.2215 | Train Acc: 0.3176
 Site-MNIST-M   | Train Loss: 2.1918 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8850 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.9535 | Val  Acc: 0.5806
 Site-MNIST     | Val  Loss: 2.0192 | Val  Acc: 0.4255
 Site-MNIST     | Val  Loss: 1.9492 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.8758 | Val  Acc: 0.5570
 Site-SVHN      | Val  Loss: 2.2375 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9667 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2527 | Val  Acc: 0.3673
 Site-SynthDigits| Val  Loss: 2.2170 | Val  Acc: 0.3265
 Site-MNIST-M   | Val  Loss: 2.2673 | Val  Acc: 0.0909
Average Valid Accuracy: 0.4080
============ Train epoch 34 ============
denominator: 20619.916015625
 Site-MNIST     | Train Loss: 2.0126 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9359 | Train Acc: 0.4043
 Site-MNIST     | Train Loss: 1.9036 | Train Acc: 0.5493
 Site-MNIST     | Train Loss: 1.9469 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 1.8918 | Train Acc: 0.5424
 Site-SVHN      | Train Loss: 2.2289 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.9378 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.1952 | Train Acc: 0.3378
 Site-SynthDigits| Train Loss: 2.2103 | Train Acc: 0.3041
 Site-MNIST-M   | Train Loss: 2.1847 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8783 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.9466 | Val  Acc: 0.6129
 Site-MNIST     | Val  Loss: 2.0113 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 1.9417 | Val  Acc: 0.4921
 Site-MNIST     | Val  Loss: 1.8651 | Val  Acc: 0.5570
 Site-SVHN      | Val  Loss: 2.2369 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9570 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2517 | Val  Acc: 0.3265
 Site-SynthDigits| Val  Loss: 2.2135 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.2647 | Val  Acc: 0.0909
Average Valid Accuracy: 0.4155
 Best site-MNIST      | Epoch:34 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:34 | Val Acc: 0.6129
 Best site-MNIST      | Epoch:34 | Val Acc: 0.4468
 Best site-MNIST      | Epoch:34 | Val Acc: 0.4921
 Best site-MNIST      | Epoch:34 | Val Acc: 0.5570
 Best site-SVHN       | Epoch:34 | Val Acc: 0.2424
 Best site-USPS       | Epoch:34 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.3265
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.3061
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.0909
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 35 ============
denominator: 20570.615234375
 Site-MNIST     | Train Loss: 1.9740 | Train Acc: 0.4348
 Site-MNIST     | Train Loss: 1.9232 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 1.8544 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.9369 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.8656 | Train Acc: 0.5424
 Site-SVHN      | Train Loss: 2.2246 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.9213 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1940 | Train Acc: 0.2973
 Site-SynthDigits| Train Loss: 2.2039 | Train Acc: 0.3176
 Site-MNIST-M   | Train Loss: 2.2131 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8596 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.9337 | Val  Acc: 0.6129
 Site-MNIST     | Val  Loss: 1.9991 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 1.9263 | Val  Acc: 0.5079
 Site-MNIST     | Val  Loss: 1.8518 | Val  Acc: 0.5696
 Site-SVHN      | Val  Loss: 2.2358 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9489 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2506 | Val  Acc: 0.3469
 Site-SynthDigits| Val  Loss: 2.2121 | Val  Acc: 0.3163
 Site-MNIST-M   | Val  Loss: 2.2656 | Val  Acc: 0.1364
Average Valid Accuracy: 0.4260
 Best site-MNIST      | Epoch:35 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:35 | Val Acc: 0.6129
 Best site-MNIST      | Epoch:35 | Val Acc: 0.4468
 Best site-MNIST      | Epoch:35 | Val Acc: 0.5079
 Best site-MNIST      | Epoch:35 | Val Acc: 0.5696
 Best site-SVHN       | Epoch:35 | Val Acc: 0.2424
 Best site-USPS       | Epoch:35 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.3469
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.3163
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 36 ============
denominator: 20429.154296875
 Site-MNIST     | Train Loss: 1.9977 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9149 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 1.8564 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.9280 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.8463 | Train Acc: 0.5424
 Site-SVHN      | Train Loss: 2.1880 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.9230 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.1888 | Train Acc: 0.3514
 Site-SynthDigits| Train Loss: 2.1999 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.2648 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8544 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.9267 | Val  Acc: 0.6129
 Site-MNIST     | Val  Loss: 1.9930 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 1.9205 | Val  Acc: 0.5238
 Site-MNIST     | Val  Loss: 1.8416 | Val  Acc: 0.5696
 Site-SVHN      | Val  Loss: 2.2349 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9383 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2474 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.2059 | Val  Acc: 0.2959
 Site-MNIST-M   | Val  Loss: 2.2626 | Val  Acc: 0.0909
Average Valid Accuracy: 0.4190
============ Train epoch 37 ============
denominator: 20402.1796875
 Site-MNIST     | Train Loss: 2.0164 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.9078 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 1.8410 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.9198 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.8647 | Train Acc: 0.5424
 Site-SVHN      | Train Loss: 2.1889 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.9058 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1773 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.2030 | Train Acc: 0.3108
 Site-MNIST-M   | Train Loss: 2.2231 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8434 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.9172 | Val  Acc: 0.6129
 Site-MNIST     | Val  Loss: 1.9849 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 1.9111 | Val  Acc: 0.5238
 Site-MNIST     | Val  Loss: 1.8301 | Val  Acc: 0.5696
 Site-SVHN      | Val  Loss: 2.2349 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9274 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2469 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.2019 | Val  Acc: 0.3163
 Site-MNIST-M   | Val  Loss: 2.2613 | Val  Acc: 0.1364
Average Valid Accuracy: 0.4256
============ Train epoch 38 ============
denominator: 20428.6875
 Site-MNIST     | Train Loss: 1.9911 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.8938 | Train Acc: 0.4255
 Site-MNIST     | Train Loss: 1.8695 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.9086 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.8131 | Train Acc: 0.5508
 Site-SVHN      | Train Loss: 2.2001 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.8891 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.1799 | Train Acc: 0.3243
 Site-SynthDigits| Train Loss: 2.1932 | Train Acc: 0.3108
 Site-MNIST-M   | Train Loss: 2.2487 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8298 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.9064 | Val  Acc: 0.6129
 Site-MNIST     | Val  Loss: 1.9746 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 1.8990 | Val  Acc: 0.5238
 Site-MNIST     | Val  Loss: 1.8180 | Val  Acc: 0.5696
 Site-SVHN      | Val  Loss: 2.2333 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9194 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2429 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.1988 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.2613 | Val  Acc: 0.1364
Average Valid Accuracy: 0.4246
============ Train epoch 39 ============
denominator: 20233.505859375
 Site-MNIST     | Train Loss: 1.9323 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.8861 | Train Acc: 0.4468
 Site-MNIST     | Train Loss: 1.8421 | Train Acc: 0.5915
 Site-MNIST     | Train Loss: 1.8958 | Train Acc: 0.5106
 Site-MNIST     | Train Loss: 1.8340 | Train Acc: 0.5508
 Site-SVHN      | Train Loss: 2.1913 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.8805 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1808 | Train Acc: 0.3649
 Site-SynthDigits| Train Loss: 2.1927 | Train Acc: 0.3176
 Site-MNIST-M   | Train Loss: 2.1743 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8189 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8967 | Val  Acc: 0.6129
 Site-MNIST     | Val  Loss: 1.9659 | Val  Acc: 0.4681
 Site-MNIST     | Val  Loss: 1.8900 | Val  Acc: 0.5397
 Site-MNIST     | Val  Loss: 1.8072 | Val  Acc: 0.5823
 Site-SVHN      | Val  Loss: 2.2325 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.9083 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2410 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.1950 | Val  Acc: 0.3163
 Site-MNIST-M   | Val  Loss: 2.2599 | Val  Acc: 0.1818
Average Valid Accuracy: 0.4330
 Best site-MNIST      | Epoch:39 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:39 | Val Acc: 0.6129
 Best site-MNIST      | Epoch:39 | Val Acc: 0.4681
 Best site-MNIST      | Epoch:39 | Val Acc: 0.5397
 Best site-MNIST      | Epoch:39 | Val Acc: 0.5823
 Best site-SVHN       | Epoch:39 | Val Acc: 0.2424
 Best site-USPS       | Epoch:39 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.3061
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.3163
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.4143
 Test site-SVHN      | Epoch:39 | Test Acc: 0.2010
 Test site-USPS      | Epoch:39 | Test Acc: 0.5538
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.2868
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.1900
Average Test Accuracy: 0.3292
============ Train epoch 40 ============
denominator: 20181.41015625
 Site-MNIST     | Train Loss: 1.9648 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.8757 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.8179 | Train Acc: 0.5915
 Site-MNIST     | Train Loss: 1.8922 | Train Acc: 0.5319
 Site-MNIST     | Train Loss: 1.8111 | Train Acc: 0.5593
 Site-SVHN      | Train Loss: 2.2176 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.8700 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1708 | Train Acc: 0.3649
 Site-SynthDigits| Train Loss: 2.1866 | Train Acc: 0.3311
 Site-MNIST-M   | Train Loss: 2.1786 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.8076 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8869 | Val  Acc: 0.6452
 Site-MNIST     | Val  Loss: 1.9582 | Val  Acc: 0.4894
 Site-MNIST     | Val  Loss: 1.8828 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.7982 | Val  Acc: 0.5823
 Site-SVHN      | Val  Loss: 2.2334 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.8973 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2421 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.1906 | Val  Acc: 0.3367
 Site-MNIST-M   | Val  Loss: 2.2577 | Val  Acc: 0.1364
Average Valid Accuracy: 0.4374
 Best site-MNIST      | Epoch:40 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:40 | Val Acc: 0.6452
 Best site-MNIST      | Epoch:40 | Val Acc: 0.4894
 Best site-MNIST      | Epoch:40 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:40 | Val Acc: 0.5823
 Best site-SVHN       | Epoch:40 | Val Acc: 0.2424
 Best site-USPS       | Epoch:40 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.3061
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.3367
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.1364
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 41 ============
denominator: 20100.5546875
 Site-MNIST     | Train Loss: 1.9942 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.8608 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.8085 | Train Acc: 0.5915
 Site-MNIST     | Train Loss: 1.8809 | Train Acc: 0.5426
 Site-MNIST     | Train Loss: 1.8211 | Train Acc: 0.5678
 Site-SVHN      | Train Loss: 2.1991 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.8677 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1574 | Train Acc: 0.3649
 Site-SynthDigits| Train Loss: 2.1739 | Train Acc: 0.3311
 Site-MNIST-M   | Train Loss: 2.2242 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 1.7961 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8767 | Val  Acc: 0.6452
 Site-MNIST     | Val  Loss: 1.9486 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 1.8718 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.7861 | Val  Acc: 0.5823
 Site-SVHN      | Val  Loss: 2.2325 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.8874 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2405 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.1880 | Val  Acc: 0.3367
 Site-MNIST-M   | Val  Loss: 2.2576 | Val  Acc: 0.1818
Average Valid Accuracy: 0.4441
 Best site-MNIST      | Epoch:41 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:41 | Val Acc: 0.6452
 Best site-MNIST      | Epoch:41 | Val Acc: 0.5106
 Best site-MNIST      | Epoch:41 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:41 | Val Acc: 0.5823
 Best site-SVHN       | Epoch:41 | Val Acc: 0.2424
 Best site-USPS       | Epoch:41 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.3061
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.3367
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 42 ============
denominator: 20087.244140625
 Site-MNIST     | Train Loss: 1.9098 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.8504 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.7941 | Train Acc: 0.5915
 Site-MNIST     | Train Loss: 1.8688 | Train Acc: 0.5319
 Site-MNIST     | Train Loss: 1.7884 | Train Acc: 0.5678
 Site-SVHN      | Train Loss: 2.1799 | Train Acc: 0.3600
 Site-USPS      | Train Loss: 1.8597 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1704 | Train Acc: 0.3649
 Site-SynthDigits| Train Loss: 2.1700 | Train Acc: 0.3378
 Site-MNIST-M   | Train Loss: 2.2037 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 1.7894 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8674 | Val  Acc: 0.6774
 Site-MNIST     | Val  Loss: 1.9400 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 1.8626 | Val  Acc: 0.5397
 Site-MNIST     | Val  Loss: 1.7733 | Val  Acc: 0.5823
 Site-SVHN      | Val  Loss: 2.2296 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.8812 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2399 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.1864 | Val  Acc: 0.3469
 Site-MNIST-M   | Val  Loss: 2.2566 | Val  Acc: 0.1818
Average Valid Accuracy: 0.4468
 Best site-MNIST      | Epoch:42 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:42 | Val Acc: 0.6774
 Best site-MNIST      | Epoch:42 | Val Acc: 0.5106
 Best site-MNIST      | Epoch:42 | Val Acc: 0.5397
 Best site-MNIST      | Epoch:42 | Val Acc: 0.5823
 Best site-SVHN       | Epoch:42 | Val Acc: 0.2424
 Best site-USPS       | Epoch:42 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.3061
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.3469
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 43 ============
denominator: 19950.9609375
 Site-MNIST     | Train Loss: 1.8998 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.8389 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.8086 | Train Acc: 0.5915
 Site-MNIST     | Train Loss: 1.8640 | Train Acc: 0.5426
 Site-MNIST     | Train Loss: 1.7956 | Train Acc: 0.5763
 Site-SVHN      | Train Loss: 2.1737 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 1.8355 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1570 | Train Acc: 0.3649
 Site-SynthDigits| Train Loss: 2.1680 | Train Acc: 0.3378
 Site-MNIST-M   | Train Loss: 2.2788 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 1.7765 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8574 | Val  Acc: 0.6774
 Site-MNIST     | Val  Loss: 1.9315 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 1.8536 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.7636 | Val  Acc: 0.5823
 Site-SVHN      | Val  Loss: 2.2290 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.8713 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2384 | Val  Acc: 0.3061
 Site-SynthDigits| Val  Loss: 2.1821 | Val  Acc: 0.3469
 Site-MNIST-M   | Val  Loss: 2.2548 | Val  Acc: 0.1818
Average Valid Accuracy: 0.4484
 Best site-MNIST      | Epoch:43 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:43 | Val Acc: 0.6774
 Best site-MNIST      | Epoch:43 | Val Acc: 0.5106
 Best site-MNIST      | Epoch:43 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:43 | Val Acc: 0.5823
 Best site-SVHN       | Epoch:43 | Val Acc: 0.2424
 Best site-USPS       | Epoch:43 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:43 | Val Acc: 0.3061
 Best site-SynthDigits | Epoch:43 | Val Acc: 0.3469
 Best site-MNIST-M    | Epoch:43 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 44 ============
denominator: 19913.916015625
 Site-MNIST     | Train Loss: 1.8850 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.8290 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.7958 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.8547 | Train Acc: 0.5426
 Site-MNIST     | Train Loss: 1.7761 | Train Acc: 0.5678
 Site-SVHN      | Train Loss: 2.1797 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 1.8472 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1509 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.1656 | Train Acc: 0.3581
 Site-MNIST-M   | Train Loss: 2.1629 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.7703 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8496 | Val  Acc: 0.6774
 Site-MNIST     | Val  Loss: 1.9251 | Val  Acc: 0.5106
 Site-MNIST     | Val  Loss: 1.8467 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.7525 | Val  Acc: 0.5949
 Site-SVHN      | Val  Loss: 2.2287 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.8626 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2354 | Val  Acc: 0.3673
 Site-SynthDigits| Val  Loss: 2.1778 | Val  Acc: 0.3776
 Site-MNIST-M   | Val  Loss: 2.2518 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4634
 Best site-MNIST      | Epoch:44 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:44 | Val Acc: 0.6774
 Best site-MNIST      | Epoch:44 | Val Acc: 0.5106
 Best site-MNIST      | Epoch:44 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:44 | Val Acc: 0.5949
 Best site-SVHN       | Epoch:44 | Val Acc: 0.2424
 Best site-USPS       | Epoch:44 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.3673
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.3776
 Best site-MNIST-M    | Epoch:44 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 45 ============
denominator: 19874.12109375
 Site-MNIST     | Train Loss: 1.9293 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.8159 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.7662 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.8400 | Train Acc: 0.5638
 Site-MNIST     | Train Loss: 1.7502 | Train Acc: 0.5847
 Site-SVHN      | Train Loss: 2.1985 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.8111 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1491 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.1700 | Train Acc: 0.3446
 Site-MNIST-M   | Train Loss: 2.1842 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.7561 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8390 | Val  Acc: 0.7097
 Site-MNIST     | Val  Loss: 1.9147 | Val  Acc: 0.5319
 Site-MNIST     | Val  Loss: 1.8346 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.7409 | Val  Acc: 0.6076
 Site-SVHN      | Val  Loss: 2.2285 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.8529 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2342 | Val  Acc: 0.3265
 Site-SynthDigits| Val  Loss: 2.1747 | Val  Acc: 0.3571
 Site-MNIST-M   | Val  Loss: 2.2514 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4669
 Best site-MNIST      | Epoch:45 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:45 | Val Acc: 0.7097
 Best site-MNIST      | Epoch:45 | Val Acc: 0.5319
 Best site-MNIST      | Epoch:45 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:45 | Val Acc: 0.6076
 Best site-SVHN       | Epoch:45 | Val Acc: 0.2727
 Best site-USPS       | Epoch:45 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.3265
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.3571
 Best site-MNIST-M    | Epoch:45 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 46 ============
denominator: 19723.9375
 Site-MNIST     | Train Loss: 1.8578 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.8082 | Train Acc: 0.4681
 Site-MNIST     | Train Loss: 1.7338 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.8303 | Train Acc: 0.5638
 Site-MNIST     | Train Loss: 1.7675 | Train Acc: 0.5847
 Site-SVHN      | Train Loss: 2.1814 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 1.7935 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1459 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.1617 | Train Acc: 0.3311
 Site-MNIST-M   | Train Loss: 2.1524 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 1.7427 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8291 | Val  Acc: 0.6774
 Site-MNIST     | Val  Loss: 1.9046 | Val  Acc: 0.5319
 Site-MNIST     | Val  Loss: 1.8233 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.7305 | Val  Acc: 0.6076
 Site-SVHN      | Val  Loss: 2.2280 | Val  Acc: 0.2424
 Site-USPS      | Val  Loss: 1.8438 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2323 | Val  Acc: 0.2857
 Site-SynthDigits| Val  Loss: 2.1717 | Val  Acc: 0.3367
 Site-MNIST-M   | Val  Loss: 2.2518 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4545
============ Train epoch 47 ============
denominator: 19688.302734375
 Site-MNIST     | Train Loss: 1.8986 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.7962 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.7082 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.8260 | Train Acc: 0.5745
 Site-MNIST     | Train Loss: 1.7335 | Train Acc: 0.5932
 Site-SVHN      | Train Loss: 2.1752 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.7809 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1363 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.1399 | Train Acc: 0.3446
 Site-MNIST-M   | Train Loss: 2.1723 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.7354 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8197 | Val  Acc: 0.7097
 Site-MNIST     | Val  Loss: 1.8969 | Val  Acc: 0.5532
 Site-MNIST     | Val  Loss: 1.8163 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.7199 | Val  Acc: 0.6076
 Site-SVHN      | Val  Loss: 2.2270 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.8359 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2295 | Val  Acc: 0.3265
 Site-SynthDigits| Val  Loss: 2.1674 | Val  Acc: 0.3571
 Site-MNIST-M   | Val  Loss: 2.2501 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4690
 Best site-MNIST      | Epoch:47 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:47 | Val Acc: 0.7097
 Best site-MNIST      | Epoch:47 | Val Acc: 0.5532
 Best site-MNIST      | Epoch:47 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:47 | Val Acc: 0.6076
 Best site-SVHN       | Epoch:47 | Val Acc: 0.2727
 Best site-USPS       | Epoch:47 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:47 | Val Acc: 0.3265
 Best site-SynthDigits | Epoch:47 | Val Acc: 0.3571
 Best site-MNIST-M    | Epoch:47 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 48 ============
denominator: 19605.72265625
 Site-MNIST     | Train Loss: 1.9064 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.7816 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.7061 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.8176 | Train Acc: 0.5851
 Site-MNIST     | Train Loss: 1.7199 | Train Acc: 0.5932
 Site-SVHN      | Train Loss: 2.1798 | Train Acc: 0.3200
 Site-USPS      | Train Loss: 1.8039 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1353 | Train Acc: 0.3919
 Site-SynthDigits| Train Loss: 2.1569 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.2225 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.7259 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8099 | Val  Acc: 0.7097
 Site-MNIST     | Val  Loss: 1.8885 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.8079 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.7094 | Val  Acc: 0.6076
 Site-SVHN      | Val  Loss: 2.2259 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.8289 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2288 | Val  Acc: 0.3265
 Site-SynthDigits| Val  Loss: 2.1644 | Val  Acc: 0.3673
 Site-MNIST-M   | Val  Loss: 2.2490 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4722
 Best site-MNIST      | Epoch:48 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:48 | Val Acc: 0.7097
 Best site-MNIST      | Epoch:48 | Val Acc: 0.5745
 Best site-MNIST      | Epoch:48 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:48 | Val Acc: 0.6076
 Best site-SVHN       | Epoch:48 | Val Acc: 0.2727
 Best site-USPS       | Epoch:48 | Val Acc: 0.4138
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.3265
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.3673
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.2273
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/q-ffl...
============ Train epoch 49 ============
denominator: 19557.0
 Site-MNIST     | Train Loss: 1.9064 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.7754 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.7431 | Train Acc: 0.6056
 Site-MNIST     | Train Loss: 1.8070 | Train Acc: 0.5851
 Site-MNIST     | Train Loss: 1.7169 | Train Acc: 0.6017
 Site-SVHN      | Train Loss: 2.1912 | Train Acc: 0.3400
 Site-USPS      | Train Loss: 1.7894 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1310 | Train Acc: 0.3919
 Site-SynthDigits| Train Loss: 2.1509 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.1963 | Train Acc: 0.3030
 Site-MNIST     | Val  Loss: 1.7164 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8008 | Val  Acc: 0.7097
 Site-MNIST     | Val  Loss: 1.8802 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.7989 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.6989 | Val  Acc: 0.6076
 Site-SVHN      | Val  Loss: 2.2252 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 1.8193 | Val  Acc: 0.4138
 Site-SynthDigits| Val  Loss: 2.2265 | Val  Acc: 0.3265
 Site-SynthDigits| Val  Loss: 2.1609 | Val  Acc: 0.3673
 Site-MNIST-M   | Val  Loss: 2.2491 | Val  Acc: 0.2273
Average Valid Accuracy: 0.4722
===2023-04-21 22:38:04===
===2023-04-21 22:38:05===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,50,44,74,148,33,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:48 | Test Acc: 0.4393
 Test site-SVHN      | Epoch:48 | Test Acc: 0.1985
 Test site-USPS      | Epoch:48 | Test Acc: 0.5860
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.3080
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.2121
Average Test Accuracy: 0.3488
