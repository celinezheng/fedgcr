===2023-04-06 04:17:18===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7419 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.6236 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.6321 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.5911 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6869 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 2.2406 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1826 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.7323 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1134 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2136 | Train Acc: 0.1705
 Site-MNIST     | Val  Loss: 1.5771 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.6023 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.6528 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.6845 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.6301 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.1961 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.2268 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.7409 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 2.1181 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.1981 | Val  Acc: 0.1525
Average Valid Accuracy: 0.4576
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3110 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.2726 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.2708 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.1639 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.2755 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.1623 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1078 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.3746 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.9600 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.1016 | Train Acc: 0.1932
 Site-MNIST     | Val  Loss: 1.1571 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.2104 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.2673 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.3046 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.2124 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.1173 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1462 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.3997 | Val  Acc: 0.6610
 Site-SynthDigits| Val  Loss: 1.9395 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0875 | Val  Acc: 0.1864
Average Valid Accuracy: 0.5458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.6610
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0323 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.9910 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.0411 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.9210 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.9956 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.1137 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0799 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.1540 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.8627 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.0159 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 0.8958 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.9568 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.0164 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.0586 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.9498 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.0743 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0891 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.1768 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.8171 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.0102 | Val  Acc: 0.2034
Average Valid Accuracy: 0.6034
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1864
 Best site-USPS       | Epoch:2 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8228 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.7919 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.8133 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.7095 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.8295 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 2.0935 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9978 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.0392 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7373 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.9139 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 0.7028 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.7516 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.8161 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.8593 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7483 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 2.0342 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0412 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.0204 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.7256 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.9395 | Val  Acc: 0.2373
Average Valid Accuracy: 0.6475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-USPS       | Epoch:3 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.6851 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.6964 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.6862 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.6005 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.6989 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 2.0140 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9688 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.8574 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.6838 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.8488 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 0.5709 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.6252 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6805 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.7255 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6280 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.9947 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0016 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.9152 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.6546 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.8844 | Val  Acc: 0.3051
Average Valid Accuracy: 0.6763
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-USPS       | Epoch:4 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.5954 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.5659 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.6197 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4981 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.5874 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 2.0074 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9330 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.8309 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.5885 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.7679 | Train Acc: 0.3523
 Site-MNIST     | Val  Loss: 0.4785 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5200 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.5816 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6133 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5375 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.9574 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9629 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.8205 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.5853 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8245 | Val  Acc: 0.3390
Average Valid Accuracy: 0.6949
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-USPS       | Epoch:5 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5047 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.5086 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.5189 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4436 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.5024 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.9533 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8929 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.7559 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.5734 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.7117 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.4213 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4617 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5086 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.5358 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4761 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.9246 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9233 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.7561 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.5436 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7738 | Val  Acc: 0.3898
Average Valid Accuracy: 0.7102
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2881
 Best site-USPS       | Epoch:6 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4546 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.4536 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.4753 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3549 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.4413 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.9226 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8490 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 0.6870 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.4973 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.6505 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.3675 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3971 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4544 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4796 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.4301 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.8932 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8941 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.7048 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.4796 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7307 | Val  Acc: 0.4068
Average Valid Accuracy: 0.7220
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3220
 Best site-USPS       | Epoch:7 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4038 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3857 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.4211 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3322 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.4230 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.8877 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8048 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 0.6168 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.4638 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.6090 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.3198 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3589 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4028 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4173 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3761 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.8641 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8642 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.6478 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.4411 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6817 | Val  Acc: 0.4576
Average Valid Accuracy: 0.7305
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3220
 Best site-USPS       | Epoch:8 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3727 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3621 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3845 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2733 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.3783 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.9389 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7971 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.6004 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.3266 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.5762 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.2971 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3215 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3617 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3843 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3546 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.8351 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.8348 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.6343 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.3890 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6478 | Val  Acc: 0.4915
Average Valid Accuracy: 0.7373
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3220
 Best site-USPS       | Epoch:9 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-MNIST     | Train Loss: 0.3387 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3360 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.3614 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2623 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.3302 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.8579 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7736 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 0.5459 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.2957 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.5120 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.2691 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3120 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3476 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3605 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3069 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.8051 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.8163 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.5738 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.3542 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.6089 | Val  Acc: 0.5254
Average Valid Accuracy: 0.7576
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:10 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3220
 Best site-USPS       | Epoch:10 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-MNIST     | Train Loss: 0.3151 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.3428 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3570 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2454 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2998 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.8598 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7415 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 0.5440 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.1475 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.4424 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.2601 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2879 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3222 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3364 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2901 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.7921 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7842 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.5504 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.3132 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5729 | Val  Acc: 0.5254
Average Valid Accuracy: 0.7508
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-MNIST     | Train Loss: 0.2848 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2770 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2784 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1927 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2785 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8484 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.6959 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.5087 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.2050 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 1.4598 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.2147 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2461 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2640 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2624 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2573 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.7618 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.7954 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.5308 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.3078 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.5463 | Val  Acc: 0.5254
Average Valid Accuracy: 0.7678
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:12 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3559
 Best site-USPS       | Epoch:12 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-MNIST     | Train Loss: 0.2738 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2975 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3473 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2209 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2716 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.7977 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.6810 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.4960 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.0680 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.3741 | Train Acc: 0.5795
 Site-MNIST     | Val  Loss: 0.2393 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2714 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3152 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3228 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2572 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.7796 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7443 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.4827 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2397 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.4930 | Val  Acc: 0.5254
Average Valid Accuracy: 0.7661
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-MNIST     | Train Loss: 0.2585 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2124 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2608 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1578 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2358 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8322 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.6446 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.4998 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.1387 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.3652 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.1858 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2107 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2421 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2213 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2234 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.7034 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.7443 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.5012 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.2632 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.4745 | Val  Acc: 0.5424
Average Valid Accuracy: 0.7695
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:14 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:14 | Val Acc: 0.3559
 Best site-USPS       | Epoch:14 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-MNIST     | Train Loss: 0.2542 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2512 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2720 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1800 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2351 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.7801 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.6795 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.4359 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.9531 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 1.2701 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.1868 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2323 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2604 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2744 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2300 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.7542 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7405 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.4613 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2197 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.4335 | Val  Acc: 0.5424
Average Valid Accuracy: 0.7712
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:15 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3898
 Best site-USPS       | Epoch:15 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-MNIST     | Train Loss: 0.2104 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1881 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2356 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1400 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2075 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.7608 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.6479 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.4065 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.9045 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.2174 | Train Acc: 0.6705
 Site-MNIST     | Val  Loss: 0.1579 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1942 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2051 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1973 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1904 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.6833 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.7232 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.4368 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.1941 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.3535 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7814
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:16 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:16 | Val Acc: 0.4068
 Best site-USPS       | Epoch:16 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-MNIST     | Train Loss: 0.2157 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2181 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2382 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1416 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1926 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.7839 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.6158 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.4042 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.8511 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.1302 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.1568 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1994 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2197 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2313 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1981 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.7095 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.7210 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.4305 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.1391 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.3026 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7780
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-MNIST     | Train Loss: 0.2073 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1694 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1835 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1137 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1834 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.7446 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.5989 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.3750 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.9112 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.0164 | Train Acc: 0.7386
 Site-MNIST     | Val  Loss: 0.1312 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1545 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1667 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1539 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1783 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.6514 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.6999 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.4161 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.1745 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.2427 | Val  Acc: 0.6271
Average Valid Accuracy: 0.7932
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:18 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3729
 Best site-USPS       | Epoch:18 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-MNIST     | Train Loss: 0.1923 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2289 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2470 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1431 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1792 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.7967 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.6550 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.4677 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.7232 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 1.1280 | Train Acc: 0.6705
 Site-MNIST     | Val  Loss: 0.1581 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2058 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2364 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2421 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1849 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.7147 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.6907 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.4531 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.1318 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.3055 | Val  Acc: 0.5593
Average Valid Accuracy: 0.7729
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-MNIST     | Train Loss: 0.1811 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1643 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1563 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1120 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1496 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.6825 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.5531 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.3517 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.8251 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 0.9123 | Train Acc: 0.7727
 Site-MNIST     | Val  Loss: 0.1144 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1442 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1388 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1376 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1593 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.6068 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.6768 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.4008 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.1164 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.1533 | Val  Acc: 0.6441
Average Valid Accuracy: 0.8017
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:20 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:20 | Val Acc: 0.4237
 Best site-USPS       | Epoch:20 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-MNIST     | Train Loss: 0.1578 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1471 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.2176 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.0904 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1553 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.7156 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.5724 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.4214 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.6985 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.0892 | Train Acc: 0.6705
 Site-MNIST     | Val  Loss: 0.1137 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1491 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1742 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1512 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1565 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.6343 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.6525 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.4391 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.1010 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.2666 | Val  Acc: 0.5593
Average Valid Accuracy: 0.7847
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-MNIST     | Train Loss: 0.1828 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1227 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1517 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0762 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1367 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.7440 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.4632 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.3625 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.6552 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.7994 | Train Acc: 0.7841
 Site-MNIST     | Val  Loss: 0.0862 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1394 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1311 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1089 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1626 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.5432 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.6141 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.3897 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0222 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.0738 | Val  Acc: 0.6610
Average Valid Accuracy: 0.8102
 Best site-MNIST      | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:22 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:22 | Val Acc: 0.4576
 Best site-USPS       | Epoch:22 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.6610
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-MNIST     | Train Loss: 0.1496 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1506 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1531 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0841 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1381 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.6349 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.5289 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.3533 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.7083 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.8908 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.0935 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1147 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1523 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1365 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1442 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.5629 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.5875 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.3888 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0904 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.1837 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7966
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-MNIST     | Train Loss: 0.1575 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1254 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1593 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0855 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1327 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.6389 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.4588 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.3328 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.5642 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.6776 | Train Acc: 0.8295
 Site-MNIST     | Val  Loss: 0.0881 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1305 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1272 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1133 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1384 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.5361 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.5751 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.3813 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0023 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.9986 | Val  Acc: 0.7119
Average Valid Accuracy: 0.8271
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:24 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:24 | Val Acc: 0.4576
 Best site-USPS       | Epoch:24 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.7119
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-MNIST     | Train Loss: 0.1200 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1090 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1473 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0659 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1215 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.5792 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.4953 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.4025 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.7069 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.9395 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.0872 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0984 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1343 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0945 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1224 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.6086 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.5993 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.4336 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.0839 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.1824 | Val  Acc: 0.5932
Average Valid Accuracy: 0.7949
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-MNIST     | Train Loss: 0.1458 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1755 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1853 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.0869 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1437 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.6321 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.4290 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.2936 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.5082 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.6106 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.1034 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1391 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1622 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1593 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1423 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.4508 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.5681 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.3412 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.9615 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.9722 | Val  Acc: 0.7627
Average Valid Accuracy: 0.8271
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-MNIST     | Train Loss: 0.1231 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0986 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1494 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0673 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1008 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.6168 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.5403 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.2966 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.5535 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.5707 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.0733 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1113 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1389 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0905 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1154 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.5423 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.5855 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.3188 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.9661 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 0.9958 | Val  Acc: 0.7119
Average Valid Accuracy: 0.8136
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-MNIST     | Train Loss: 0.1131 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1099 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1266 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0594 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1433 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.5986 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.4201 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.3179 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4714 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.6400 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.0768 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1004 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1034 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1096 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1265 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.4367 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.4901 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.3515 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.0025 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.9751 | Val  Acc: 0.7288
Average Valid Accuracy: 0.8288
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:28 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:28 | Val Acc: 0.4407
 Best site-USPS       | Epoch:28 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.7288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-MNIST     | Train Loss: 0.1097 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0920 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1263 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0509 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1096 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.6814 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.3914 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.2495 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4869 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.4848 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.0632 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0911 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1187 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0781 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1169 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.4975 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.5743 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.3064 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.9358 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 0.9435 | Val  Acc: 0.7119
Average Valid Accuracy: 0.8203
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-MNIST     | Train Loss: 0.1144 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1085 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1102 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0522 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1246 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.5365 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.3554 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.3006 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.3717 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.5008 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.0640 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0759 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1062 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0884 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1159 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.4300 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.4628 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.3413 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.9413 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.9346 | Val  Acc: 0.7458
Average Valid Accuracy: 0.8271
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-MNIST     | Train Loss: 0.1089 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0963 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1124 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.0528 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1116 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.6015 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.4090 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.2679 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.4029 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.3980 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.0683 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0771 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1197 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.0893 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1091 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.4056 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.5119 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.3159 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.8992 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.8749 | Val  Acc: 0.8305
Average Valid Accuracy: 0.8339
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:31 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:31 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:31 | Val Acc: 0.4237
 Best site-USPS       | Epoch:31 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.8305
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-MNIST     | Train Loss: 0.1082 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0810 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1101 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0493 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0886 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.5341 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.3607 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.1973 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3739 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.4394 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.0566 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0805 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1054 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0757 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1047 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.3943 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.4685 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.2891 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.9417 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.8749 | Val  Acc: 0.8136
Average Valid Accuracy: 0.8356
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:32 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:32 | Val Acc: 0.4237
 Best site-USPS       | Epoch:32 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.8136
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-MNIST     | Train Loss: 0.0926 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0877 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0895 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0387 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0797 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.3282 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.3585 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.2394 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3950 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.3744 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.0479 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0563 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0961 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0679 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1054 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.3727 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.4143 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.3596 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.9033 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.8622 | Val  Acc: 0.7966
Average Valid Accuracy: 0.8373
 Best site-MNIST      | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:33 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:33 | Val Acc: 0.4576
 Best site-USPS       | Epoch:33 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.7966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-MNIST     | Train Loss: 0.0884 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0815 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0974 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0410 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0878 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.5770 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.2894 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.1905 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.2924 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.3156 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.0569 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0666 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1040 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0728 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0939 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.3274 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.4860 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.3011 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.8559 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.8085 | Val  Acc: 0.8305
Average Valid Accuracy: 0.8424
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:34 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:34 | Val Acc: 0.4407
 Best site-USPS       | Epoch:34 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.8305
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-MNIST     | Train Loss: 0.0937 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0896 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1077 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0499 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0747 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.4309 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.2556 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.2049 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3966 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.3500 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.0542 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0668 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1217 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0799 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1015 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.3005 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.3807 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.3562 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.9116 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 0.8427 | Val  Acc: 0.7966
Average Valid Accuracy: 0.8441
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:35 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:35 | Val Acc: 0.4915
 Best site-USPS       | Epoch:35 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.7966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-MNIST     | Train Loss: 0.0875 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0868 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1153 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0419 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0884 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.4432 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.4020 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.1591 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3229 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.2493 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0507 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0719 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1065 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0838 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0944 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.4607 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.4606 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.2461 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.8930 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.7691 | Val  Acc: 0.8136
Average Valid Accuracy: 0.8441
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-MNIST     | Train Loss: 0.1060 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0705 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0578 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0287 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0808 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.3576 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.1842 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.2256 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.3729 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.3838 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.0446 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0424 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0566 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0418 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0989 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.2561 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.2983 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.3013 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.9398 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 0.8980 | Val  Acc: 0.7627
Average Valid Accuracy: 0.8390
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-MNIST     | Train Loss: 0.0820 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0960 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0938 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0428 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0767 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.3639 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.2700 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.1206 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3059 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.2246 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0483 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0621 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1079 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0981 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0926 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.2573 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.3488 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.2489 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.8792 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 0.7615 | Val  Acc: 0.8136
Average Valid Accuracy: 0.8458
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:38 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:38 | Val Acc: 0.4915
 Best site-USPS       | Epoch:38 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.8136
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2_1/DoPrompt...
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-MNIST     | Train Loss: 0.1090 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0504 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0770 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0283 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0818 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.2535 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.2728 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.2306 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.2719 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.3768 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.0381 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0566 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0696 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0380 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1068 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.2811 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.3260 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.3088 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.8862 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.8951 | Val  Acc: 0.7288
Average Valid Accuracy: 0.8339
===2023-04-06 06:33:18===
===2023-04-06 06:33:19===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:38 | Test Acc: 0.8829
 Test site-SVHN      | Epoch:38 | Test Acc: 0.2897
 Test site-USPS      | Epoch:38 | Test Acc: 0.8441
 Test site-SynthDigits| Epoch:38 | Test Acc: 0.5682
 Test site-MNIST-M   | Epoch:38 | Test Acc: 0.4743
Average Test Accuracy: 0.6118
