===2023-03-28 12:12:05===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.2945 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.1062 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.1698 | Train Acc: 0.1000
 Site-Clipart   | Train Loss: 2.2362 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.0659 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.3274 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.2926 | Train Acc: 0.1000
 Site-Infograph | Train Loss: 2.3185 | Train Acc: 0.0000
 Site-Infograph | Train Loss: 2.0732 | Train Acc: 0.3000
 Site-Painting  | Train Loss: 2.2124 | Train Acc: 0.1000
 Site-QuickDraw | Train Loss: 2.4377 | Train Acc: 0.0000
 Site-Real      | Train Loss: 2.1209 | Train Acc: 0.1000
 Site-Sketch    | Train Loss: 2.0320 | Train Acc: 0.1000
 Site-Clipart   | Val  Loss: 2.2842 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 2.1233 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2539 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 1.9798 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0640 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.3568 | Val  Acc: 0.0000
 Site-Infograph | Val  Loss: 2.1153 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.2035 | Val  Acc: 0.0000
 Site-Infograph | Val  Loss: 2.2476 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 2.4116 | Val  Acc: 0.0000
 Site-QuickDraw | Val  Loss: 2.3543 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.0821 | Val  Acc: 0.3333
 Site-Sketch    | Val  Loss: 1.9442 | Val  Acc: 0.5000
Average Valid Accuracy: 0.2179
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1667
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-Real       | Epoch:0 | Val Acc: 0.3333
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.2155 | Train Acc: 0.0000
 Site-Clipart   | Train Loss: 1.9129 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.0157 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.0306 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 1.7519 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.9839 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.2234 | Train Acc: 0.1000
 Site-Infograph | Train Loss: 2.1229 | Train Acc: 0.3000
 Site-Infograph | Train Loss: 1.8997 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.2169 | Train Acc: 0.2000
 Site-QuickDraw | Train Loss: 2.4105 | Train Acc: 0.0000
 Site-Real      | Train Loss: 1.9911 | Train Acc: 0.3000
 Site-Sketch    | Train Loss: 1.8119 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.0447 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.8756 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 1.9615 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 2.0437 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 1.7548 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0847 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.9770 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1838 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.1103 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 2.3319 | Val  Acc: 0.0000
 Site-QuickDraw | Val  Loss: 2.2530 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.8836 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.8049 | Val  Acc: 0.5000
Average Valid Accuracy: 0.2564
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Painting   | Epoch:1 | Val Acc: 0.0000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1667
 Best site-Real       | Epoch:1 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.9783 | Train Acc: 0.0000
 Site-Clipart   | Train Loss: 1.7611 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8864 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 1.8302 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.7173 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8534 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.0135 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 1.9555 | Train Acc: 0.3000
 Site-Infograph | Train Loss: 1.8932 | Train Acc: 0.3000
 Site-Painting  | Train Loss: 2.0792 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.1357 | Train Acc: 0.3000
 Site-Real      | Train Loss: 1.7756 | Train Acc: 0.5000
 Site-Sketch    | Train Loss: 1.5787 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.9446 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.8342 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 1.8932 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6960 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.4809 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 2.2394 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.9550 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1248 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.9758 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 2.2497 | Val  Acc: 0.0000
 Site-QuickDraw | Val  Loss: 2.1206 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.7644 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.7918 | Val  Acc: 0.1667
Average Valid Accuracy: 0.3333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1667
 Best site-Painting   | Epoch:2 | Val Acc: 0.0000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5000
 Best site-Real       | Epoch:2 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:2 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.9370 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 1.5482 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6036 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6905 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.4985 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8092 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.0239 | Train Acc: 0.3000
 Site-Infograph | Train Loss: 1.8897 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 1.8233 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.9323 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.0307 | Train Acc: 0.4000
 Site-Real      | Train Loss: 1.6916 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.4037 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.6458 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6241 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.7109 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.4618 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.3997 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.9908 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 1.7875 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 1.8561 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 1.7843 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 2.0135 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.8699 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.5559 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.6078 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5385
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-Real       | Epoch:3 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.6920 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.5244 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.4688 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.5257 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.3456 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.5876 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 1.8133 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 1.8643 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.6213 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.9051 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.9973 | Train Acc: 0.3000
 Site-Real      | Train Loss: 1.4421 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.1860 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.4687 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4914 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.4976 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4468 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1333 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.8027 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6133 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9407 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5455 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.8951 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.0577 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.4953 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.5062 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6154
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Painting   | Epoch:4 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3333
 Best site-Real       | Epoch:4 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:4 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.6861 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.2304 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.2918 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.3455 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1306 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.3281 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 1.7025 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.7054 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.6783 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 1.6892 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 1.7649 | Train Acc: 0.5000
 Site-Real      | Train Loss: 1.2358 | Train Acc: 0.9000
 Site-Sketch    | Train Loss: 0.9977 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.1928 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.2931 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.4705 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.4497 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8847 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.6960 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6892 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8193 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.4217 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.9262 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.7416 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.1667 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.3278 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6795
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5000
 Best site-Painting   | Epoch:5 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5000
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.3762 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1121 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0508 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 1.0853 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 1.0694 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.2953 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 1.6246 | Train Acc: 0.3000
 Site-Infograph | Train Loss: 1.5615 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 1.3837 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.4841 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 1.7107 | Train Acc: 0.6000
 Site-Real      | Train Loss: 1.2008 | Train Acc: 0.9000
 Site-Sketch    | Train Loss: 0.8757 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.0250 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.1581 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.2115 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.2116 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7359 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.5814 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3235 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.6113 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4162 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.8214 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.5812 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.1144 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.2612 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7692
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.8333
 Best site-Painting   | Epoch:6 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5000
 Best site-Real       | Epoch:6 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:6 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.2558 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9731 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9374 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 1.0363 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.9506 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0230 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 1.5130 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 1.4915 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 1.3521 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.3813 | Train Acc: 0.7000
 Site-QuickDraw | Train Loss: 1.5839 | Train Acc: 0.7000
 Site-Real      | Train Loss: 0.8885 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7648 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8687 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.1390 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9040 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.0454 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6556 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.3349 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3379 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.3977 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2504 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.6003 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.4920 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 1.0089 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.0874 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7949
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Painting   | Epoch:7 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.6667
 Best site-Real       | Epoch:7 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.0621 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 1.0422 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8470 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.7985 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.7782 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.8917 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.3532 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 1.2396 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 1.2150 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.3823 | Train Acc: 0.6000
 Site-QuickDraw | Train Loss: 1.4816 | Train Acc: 0.6000
 Site-Real      | Train Loss: 0.7236 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6835 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6123 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.0791 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8707 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.1197 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5142 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.2069 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.3266 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4253 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.1593 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.5029 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.5301 | Val  Acc: 0.8333
 Site-Real      | Val  Loss: 0.7192 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.0414 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8333
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8333
 Best site-Painting   | Epoch:8 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.8333
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.9225 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.7464 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6266 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.6985 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.7444 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.8762 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.1461 | Train Acc: 0.8000
 Site-Infograph | Train Loss: 1.3451 | Train Acc: 0.7000
 Site-Infograph | Train Loss: 1.0934 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.0310 | Train Acc: 0.8000
 Site-QuickDraw | Train Loss: 1.2784 | Train Acc: 0.8000
 Site-Real      | Train Loss: 0.7680 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4832 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5610 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8008 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6752 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8535 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4502 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.1642 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3853 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2043 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3135 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.2862 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.2299 | Val  Acc: 0.8333
 Site-Real      | Val  Loss: 0.6374 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.1739 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8077
===2023-03-28 12:17:47===
===2023-03-28 12:17:48===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.4962
 Test site-Infograph | Epoch:8 | Test Acc: 0.3059
 Test site-Painting  | Epoch:8 | Test Acc: 0.4782
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.2830
 Test site-Real      | Epoch:8 | Test Acc: 0.5316
 Test site-Sketch    | Epoch:8 | Test Acc: 0.4585
Average Test Accuracy: 0.4256
===2023-03-28 14:51:08===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 14:51:12===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
===2023-03-28 16:58:30===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
===2023-03-28 17:00:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0086 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9542 | Train Acc: 0.4127
 Site-Clipart   | Train Loss: 1.9030 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.9706 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 2.0847 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 2.0827 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.2138 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.2089 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.1178 | Train Acc: 0.3016
 Site-Painting  | Train Loss: 2.0533 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 2.2939 | Train Acc: 0.0952
 Site-Real      | Train Loss: 1.9927 | Train Acc: 0.3810
 Site-Sketch    | Train Loss: 1.9301 | Train Acc: 0.5079
 Site-Clipart   | Val  Loss: 2.1191 | Val  Acc: 0.3095
 Site-Clipart   | Val  Loss: 1.9790 | Val  Acc: 0.3810
 Site-Clipart   | Val  Loss: 1.8779 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.9160 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.9835 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 2.0149 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1460 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1596 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.2151 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 2.1564 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2787 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 2.0657 | Val  Acc: 0.3810
 Site-Sketch    | Val  Loss: 2.0642 | Val  Acc: 0.3095
Average Valid Accuracy: 0.3480
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3095
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1667
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.3810
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7180 | Train Acc: 0.5079
 Site-Clipart   | Train Loss: 1.6922 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.6007 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.6242 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.8517 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.7817 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 2.1075 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.0001 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.9377 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.7570 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 2.2539 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.6740 | Train Acc: 0.6349
 Site-Sketch    | Train Loss: 1.6165 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.8444 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.6247 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.5517 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5389 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.7064 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.7446 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.9674 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9851 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.0902 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.9305 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.2172 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.7143 | Val  Acc: 0.6190
 Site-Sketch    | Val  Loss: 1.7837 | Val  Acc: 0.6429
Average Valid Accuracy: 0.5201
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.6190
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.4617 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.3712 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.2767 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.3371 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.5531 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.5739 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.9409 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.8729 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.7398 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.5067 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 2.1887 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.3220 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.3592 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.5202 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.3092 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.2530 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2453 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.3773 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3862 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.8113 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.8667 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.9810 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.6281 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.1758 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.4251 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.6026 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5971
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3571
 Best site-Painting   | Epoch:2 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3333
 Best site-Real       | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1745 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1528 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.0873 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.0818 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.3603 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.2917 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.9124 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7781 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.6070 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.2526 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.1177 | Train Acc: 0.2540
 Site-Real      | Train Loss: 1.0856 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.2001 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.2998 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.1533 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.0186 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9894 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.2005 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2589 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6134 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7457 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9036 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.4253 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.1047 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1389 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.4434 | Val  Acc: 0.6905
Average Valid Accuracy: 0.6520
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.0435 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0293 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9294 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8865 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.1665 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.1643 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.8860 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6946 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4727 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.0959 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 2.0349 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.9604 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.0187 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.1628 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.9047 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9024 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8671 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 1.0282 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0666 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.5742 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6342 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8533 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 1.2723 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0536 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.0215 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.2665 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6960
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4048
 Best site-Painting   | Epoch:4 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3095
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.9203 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.8682 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.8094 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.8452 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.0480 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.9885 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.8446 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5899 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4174 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 0.9893 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 2.0301 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.9012 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.9132 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.0303 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.7821 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.8374 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7179 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9319 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.9149 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.5430 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5507 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7711 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.1025 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 2.0315 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8617 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1613 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7070
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3810
 Best site-Painting   | Epoch:5 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3333
 Best site-Real       | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.8458 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 0.8324 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7418 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6903 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9043 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9491 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.7567 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5090 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.4010 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.8939 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.9759 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.7327 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8073 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.9048 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6459 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6599 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6920 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7763 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9005 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4118 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4884 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7700 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.0917 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.9785 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7874 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.1341 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7161
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3571
 Best site-Painting   | Epoch:6 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2857
 Best site-Real       | Epoch:6 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.7554 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7270 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6300 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.6094 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.8103 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8120 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.6952 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.4767 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3042 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.7852 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8830 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.6553 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.7560 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.8076 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6131 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5613 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6238 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7789 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7333 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3850 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4739 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6372 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.0210 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.8948 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6728 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9470 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7381
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4286
 Best site-Painting   | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3571
 Best site-Real       | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.6824 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6490 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6396 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4765 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.7221 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.8058 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.6686 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.3930 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.1768 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.7127 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.8619 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.6327 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6801 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7626 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5722 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5724 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5542 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7189 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7087 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3401 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.3682 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.6128 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.9550 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.9370 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6343 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9822 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7326
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.6228 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6033 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5338 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4875 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.7198 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7698 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.6051 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.3796 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.1452 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.6704 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8576 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.5880 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6526 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.6938 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4425 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4817 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5234 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6483 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.6310 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2753 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.3394 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5572 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.8781 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.8687 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.5404 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8809 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7802
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4524
 Best site-Painting   | Epoch:9 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3095
 Best site-Real       | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/CoCoOP...
===2023-03-28 17:34:48===
===2023-03-28 17:34:49===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8631
 Test site-Infograph | Epoch:9 | Test Acc: 0.4962
 Test site-Painting  | Epoch:9 | Test Acc: 0.8514
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.3870
 Test site-Real      | Epoch:9 | Test Acc: 0.9080
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8195
Average Test Accuracy: 0.7209
