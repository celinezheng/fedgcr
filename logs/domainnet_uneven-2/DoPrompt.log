===2023-03-28 12:46:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.2436 | Train Acc: 0.1000
 Site-Clipart   | Train Loss: 2.2014 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.2244 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.3566 | Train Acc: 0.1000
 Site-Clipart   | Train Loss: 2.1784 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.2955 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.3875 | Train Acc: 0.0000
 Site-Infograph | Train Loss: 2.2231 | Train Acc: 0.0000
 Site-Infograph | Train Loss: 2.1107 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 2.2180 | Train Acc: 0.2000
 Site-QuickDraw | Train Loss: 2.4131 | Train Acc: 0.0000
 Site-Real      | Train Loss: 2.1927 | Train Acc: 0.1000
 Site-Sketch    | Train Loss: 2.1944 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.2854 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.2904 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2628 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 2.1356 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.2743 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 2.2118 | Val  Acc: 0.0000
 Site-Infograph | Val  Loss: 2.1682 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1585 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.2958 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.3685 | Val  Acc: 0.0000
 Site-QuickDraw | Val  Loss: 2.3975 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.3015 | Val  Acc: 0.0000
 Site-Sketch    | Val  Loss: 2.2176 | Val  Acc: 0.1667
Average Valid Accuracy: 0.1282
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0000
 Best site-Real       | Epoch:0 | Val Acc: 0.0000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.1640 | Train Acc: 0.0000
 Site-Clipart   | Train Loss: 2.1275 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1625 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.3144 | Train Acc: 0.1000
 Site-Clipart   | Train Loss: 2.0171 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 2.1472 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.3024 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.1430 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.0460 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.2403 | Train Acc: 0.1000
 Site-QuickDraw | Train Loss: 2.3195 | Train Acc: 0.0000
 Site-Real      | Train Loss: 2.0876 | Train Acc: 0.2000
 Site-Sketch    | Train Loss: 2.0782 | Train Acc: 0.1000
 Site-Clipart   | Val  Loss: 2.2217 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.2902 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.1369 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.0668 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.0128 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1853 | Val  Acc: 0.0000
 Site-Infograph | Val  Loss: 2.0754 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.2272 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.2569 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 2.2963 | Val  Acc: 0.0000
 Site-QuickDraw | Val  Loss: 2.3127 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.2605 | Val  Acc: 0.0000
 Site-Sketch    | Val  Loss: 2.1322 | Val  Acc: 0.1667
Average Valid Accuracy: 0.1795
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Painting   | Epoch:1 | Val Acc: 0.0000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0000
 Best site-Real       | Epoch:1 | Val Acc: 0.0000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 2.2098 | Train Acc: 0.1000
 Site-Clipart   | Train Loss: 2.0132 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.0556 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.1476 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 1.9969 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.1464 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.2760 | Train Acc: 0.1000
 Site-Infograph | Train Loss: 2.1179 | Train Acc: 0.1000
 Site-Infograph | Train Loss: 1.9592 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.1704 | Train Acc: 0.2000
 Site-QuickDraw | Train Loss: 2.3304 | Train Acc: 0.0000
 Site-Real      | Train Loss: 2.0380 | Train Acc: 0.3000
 Site-Sketch    | Train Loss: 1.9467 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.1034 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 2.1668 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 2.1411 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 2.0728 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.9154 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.2380 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.9904 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1699 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.1516 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 2.2667 | Val  Acc: 0.0000
 Site-QuickDraw | Val  Loss: 2.2323 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.1088 | Val  Acc: 0.0000
 Site-Sketch    | Val  Loss: 2.0180 | Val  Acc: 0.1667
Average Valid Accuracy: 0.1923
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1667
 Best site-Painting   | Epoch:2 | Val Acc: 0.0000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1667
 Best site-Real       | Epoch:2 | Val Acc: 0.0000
 Best site-Sketch     | Epoch:2 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 2.1015 | Train Acc: 0.1000
 Site-Clipart   | Train Loss: 1.9687 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1301 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.0994 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 1.8168 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 2.0385 | Train Acc: 0.3000
 Site-Infograph | Train Loss: 2.2200 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.0859 | Train Acc: 0.0000
 Site-Infograph | Train Loss: 1.8860 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.1119 | Train Acc: 0.2000
 Site-QuickDraw | Train Loss: 2.1713 | Train Acc: 0.1000
 Site-Real      | Train Loss: 1.9322 | Train Acc: 0.5000
 Site-Sketch    | Train Loss: 1.8927 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 1.9742 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.0949 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 1.9275 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 1.9906 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.8093 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.2530 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.8982 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.2014 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.1475 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 2.2656 | Val  Acc: 0.0000
 Site-QuickDraw | Val  Loss: 2.0801 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 1.9885 | Val  Acc: 0.0000
 Site-Sketch    | Val  Loss: 1.9208 | Val  Acc: 0.3333
Average Valid Accuracy: 0.2179
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:3 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:3 | Val Acc: 0.1667
 Best site-Painting   | Epoch:3 | Val Acc: 0.0000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.0000
 Best site-Real       | Epoch:3 | Val Acc: 0.0000
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.9759 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 1.8679 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 1.8284 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.0455 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 1.7942 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 2.0143 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.1351 | Train Acc: 0.3000
 Site-Infograph | Train Loss: 2.0981 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 1.8794 | Train Acc: 0.3000
 Site-Painting  | Train Loss: 2.0825 | Train Acc: 0.3000
 Site-QuickDraw | Train Loss: 2.0907 | Train Acc: 0.0000
 Site-Real      | Train Loss: 1.8314 | Train Acc: 0.3000
 Site-Sketch    | Train Loss: 1.7234 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.9343 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.1328 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 1.8947 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 2.0459 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.5530 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1699 | Val  Acc: 0.0000
 Site-Infograph | Val  Loss: 1.8836 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.0555 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 1.9667 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 2.1514 | Val  Acc: 0.1667
 Site-QuickDraw | Val  Loss: 2.1468 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 1.9144 | Val  Acc: 0.3333
 Site-Sketch    | Val  Loss: 1.9105 | Val  Acc: 0.3333
Average Valid Accuracy: 0.2692
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:4 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.0000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:4 | Val Acc: 0.1667
 Best site-Painting   | Epoch:4 | Val Acc: 0.1667
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.0000
 Best site-Real       | Epoch:4 | Val Acc: 0.3333
 Best site-Sketch     | Epoch:4 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 2.0215 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 1.7019 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8521 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9059 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 1.8071 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.9031 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.1528 | Train Acc: 0.3000
 Site-Infograph | Train Loss: 1.9918 | Train Acc: 0.1000
 Site-Infograph | Train Loss: 2.0095 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 1.9214 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.0882 | Train Acc: 0.2000
 Site-Real      | Train Loss: 1.7769 | Train Acc: 0.4000
 Site-Sketch    | Train Loss: 1.8942 | Train Acc: 0.3000
 Site-Clipart   | Val  Loss: 1.8749 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 1.9515 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.8953 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 1.9177 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.4730 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 2.1837 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.9140 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.0181 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.0196 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 2.1963 | Val  Acc: 0.1667
 Site-QuickDraw | Val  Loss: 2.0746 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.8793 | Val  Acc: 0.3333
 Site-Sketch    | Val  Loss: 1.8671 | Val  Acc: 0.3333
Average Valid Accuracy: 0.3077
 Best site-Clipart    | Epoch:5 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:5 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3333
 Best site-Painting   | Epoch:5 | Val Acc: 0.1667
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.1667
 Best site-Real       | Epoch:5 | Val Acc: 0.3333
 Best site-Sketch     | Epoch:5 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.9298 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.6707 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8343 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8406 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 1.6283 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.8635 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.0366 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.0409 | Train Acc: 0.1000
 Site-Infograph | Train Loss: 1.7812 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.8673 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.0926 | Train Acc: 0.3000
 Site-Real      | Train Loss: 1.6277 | Train Acc: 0.6000
 Site-Sketch    | Train Loss: 1.5991 | Train Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6589 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.8965 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 1.7893 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.8373 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.3257 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 2.1746 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.9775 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1216 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.9186 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 2.0741 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.9813 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.7483 | Val  Acc: 0.1667
 Site-Sketch    | Val  Loss: 1.8353 | Val  Acc: 0.3333
Average Valid Accuracy: 0.3462
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:6 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:6 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5000
 Best site-Painting   | Epoch:6 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.1667
 Best site-Real       | Epoch:6 | Val Acc: 0.1667
 Best site-Sketch     | Epoch:6 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.8446 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.5361 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7204 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.7913 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 1.6288 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.7599 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.0163 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.9675 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 1.8818 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.9124 | Train Acc: 0.3000
 Site-QuickDraw | Train Loss: 2.0367 | Train Acc: 0.5000
 Site-Real      | Train Loss: 1.6339 | Train Acc: 0.5000
 Site-Sketch    | Train Loss: 1.5256 | Train Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.7362 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.8995 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.6621 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.7855 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.2985 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 2.0056 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.8562 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 1.9571 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.8003 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.9597 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.0260 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.7793 | Val  Acc: 0.3333
 Site-Sketch    | Val  Loss: 1.7411 | Val  Acc: 0.3333
Average Valid Accuracy: 0.3974
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Painting   | Epoch:7 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1667
 Best site-Real       | Epoch:7 | Val Acc: 0.3333
 Best site-Sketch     | Epoch:7 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.7771 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.4968 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.6970 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.7296 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.6125 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.7704 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.9814 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 1.9618 | Train Acc: 0.3000
 Site-Infograph | Train Loss: 1.7882 | Train Acc: 0.3000
 Site-Painting  | Train Loss: 1.7296 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 1.9416 | Train Acc: 0.3000
 Site-Real      | Train Loss: 1.5540 | Train Acc: 0.7000
 Site-Sketch    | Train Loss: 1.3938 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.5302 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.8679 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6700 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.6579 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.2800 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.8900 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8201 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9185 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 1.8093 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.8987 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.9024 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.6743 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.7613 | Val  Acc: 0.3333
Average Valid Accuracy: 0.4872
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:8 | Val Acc: 0.3333
 Best site-Painting   | Epoch:8 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3333
 Best site-Real       | Epoch:8 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:8 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 1.6097 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.3161 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.5001 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6192 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.5546 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.5860 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 2.0411 | Train Acc: 0.3000
 Site-Infograph | Train Loss: 1.8279 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.7454 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.6799 | Train Acc: 0.4000
 Site-QuickDraw | Train Loss: 2.0099 | Train Acc: 0.3000
 Site-Real      | Train Loss: 1.4465 | Train Acc: 0.9000
 Site-Sketch    | Train Loss: 1.3402 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.5039 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.8517 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.6463 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6092 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.1898 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.7830 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.7934 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9496 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 1.7758 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.9045 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.8741 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.5957 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.6120 | Val  Acc: 0.3333
Average Valid Accuracy: 0.4744
===2023-03-28 12:52:51===
===2023-03-28 12:52:52===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.4011
 Test site-Infograph | Epoch:8 | Test Acc: 0.2770
 Test site-Painting  | Epoch:8 | Test Acc: 0.4604
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.2030
 Test site-Real      | Epoch:8 | Test Acc: 0.4692
 Test site-Sketch    | Epoch:8 | Test Acc: 0.4025
Average Test Accuracy: 0.3689
===2023-03-28 18:44:37===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0690 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9910 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9522 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 1.9616 | Train Acc: 0.4127
 Site-Clipart   | Train Loss: 2.1099 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 2.0881 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.2262 | Train Acc: 0.1429
 Site-Infograph | Train Loss: 2.1956 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.1039 | Train Acc: 0.2698
 Site-Painting  | Train Loss: 2.0493 | Train Acc: 0.3492
 Site-QuickDraw | Train Loss: 2.2574 | Train Acc: 0.0794
 Site-Real      | Train Loss: 2.0140 | Train Acc: 0.3651
 Site-Sketch    | Train Loss: 1.9569 | Train Acc: 0.5397
 Site-Clipart   | Val  Loss: 2.0850 | Val  Acc: 0.3571
 Site-Clipart   | Val  Loss: 1.9462 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.8964 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9524 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9622 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.9959 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1256 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.1505 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1662 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 2.1908 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.2583 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.1289 | Val  Acc: 0.3810
 Site-Sketch    | Val  Loss: 2.1138 | Val  Acc: 0.2381
Average Valid Accuracy: 0.3315
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-Real       | Epoch:0 | Val Acc: 0.3810
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7482 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.6906 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.5838 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.6767 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.8716 | Train Acc: 0.4444
 Site-Clipart   | Train Loss: 1.8229 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 2.1201 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.0496 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.9339 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.7682 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 2.2649 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.7104 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.6637 | Train Acc: 0.6032
 Site-Clipart   | Val  Loss: 1.7957 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.6556 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5343 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.5790 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.6227 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.7560 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 2.0123 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0354 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1215 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 1.9543 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.2413 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.8023 | Val  Acc: 0.6190
 Site-Sketch    | Val  Loss: 1.7860 | Val  Acc: 0.6905
Average Valid Accuracy: 0.5183
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1905
 Best site-Painting   | Epoch:1 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2619
 Best site-Real       | Epoch:1 | Val Acc: 0.6190
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.5069 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.4293 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.3747 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.3335 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.6013 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5994 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 2.0162 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 1.8824 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.7512 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.5400 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1740 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.4022 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.3473 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.5828 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.3680 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.2955 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.3053 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.4043 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.4921 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8151 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.8635 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9959 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.6621 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.1893 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.5145 | Val  Acc: 0.6905
 Site-Sketch    | Val  Loss: 1.6054 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5714
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2857
 Best site-Real       | Epoch:2 | Val Acc: 0.6905
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.2495 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.2729 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.1544 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.1825 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.3821 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.3973 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.9480 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.8337 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6700 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.3474 | Train Acc: 0.7302
 Site-QuickDraw | Train Loss: 2.1557 | Train Acc: 0.2857
 Site-Real      | Train Loss: 1.1359 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.2309 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.3878 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.1513 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0619 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0907 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.2960 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.2684 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6967 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8001 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 1.9443 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.5425 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 2.1039 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.2217 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.4412 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6227
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3095
 Best site-Real       | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.2153 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.0983 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9869 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.0005 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.2272 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.2511 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8863 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7453 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.6154 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.1862 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 2.0776 | Train Acc: 0.3175
 Site-Real      | Train Loss: 1.0126 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0716 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1889 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0363 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9999 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.9679 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1397 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.1136 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.5905 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6540 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8870 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.4329 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.0464 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.1108 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.2208 | Val  Acc: 0.8571
Average Valid Accuracy: 0.6722
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3571
 Best site-Painting   | Epoch:4 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3095
 Best site-Real       | Epoch:4 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.0480 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.0114 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.9336 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.8492 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 1.1154 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.1962 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8736 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6278 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.4731 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.0833 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 2.0347 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.8835 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0474 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0537 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9345 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8027 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8261 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.9731 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.0788 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5334 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6316 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.7995 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.2410 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.9946 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.0218 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.2499 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6941
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3333
 Best site-Real       | Epoch:5 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.9271 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.9525 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8596 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8642 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.0485 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.0742 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 1.7924 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5932 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4722 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 0.9925 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9715 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.8144 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.9760 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.9635 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7804 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7618 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7715 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9380 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.0158 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4097 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.5547 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7843 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 1.2028 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 2.0517 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8927 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1786 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7106
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4762
 Best site-Painting   | Epoch:6 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3333
 Best site-Real       | Epoch:6 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.8918 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.8728 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7927 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7359 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9470 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0645 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.7726 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5635 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.3217 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.9178 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.9095 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.7138 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8364 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.9036 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6896 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6474 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6741 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8630 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.9262 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.4865 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.4468 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7821 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 1.0992 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.9826 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7871 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0786 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7253
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4048
 Best site-Painting   | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3333
 Best site-Real       | Epoch:7 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.7938 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8276 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.7339 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6111 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.8794 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.9707 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.6813 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.5107 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3417 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.7838 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.8282 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.6848 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.8230 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8328 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6326 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6447 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6060 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7731 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8307 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.4632 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4571 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.6169 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.0595 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.8773 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6952 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.9644 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7363
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4524
 Best site-Painting   | Epoch:8 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3571
 Best site-Real       | Epoch:8 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.8081 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6825 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6541 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6235 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.8261 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.9001 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.6903 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.4052 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.2476 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.7618 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.8098 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.6606 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7464 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7512 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5608 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5807 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5604 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7178 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7085 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3945 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3177 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.5705 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.9959 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.8224 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6697 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9279 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7619
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Painting   | Epoch:9 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3571
 Best site-Real       | Epoch:9 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/DoPrompt...
===2023-03-28 19:19:38===
===2023-03-28 19:19:39===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8536
 Test site-Infograph | Epoch:9 | Test Acc: 0.4581
 Test site-Painting  | Epoch:9 | Test Acc: 0.8271
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4010
 Test site-Real      | Epoch:9 | Test Acc: 0.9030
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7906
Average Test Accuracy: 0.7056
