===2023-03-25 22:19:28===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0096 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 1.9543 | Train Acc: 0.4127
 Site-Clipart   | Train Loss: 1.8676 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.9229 | Train Acc: 0.4286
 Site-Clipart   | Train Loss: 2.1075 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9962 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 2.2354 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1282 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0561 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 1.9842 | Train Acc: 0.4762
 Site-QuickDraw | Train Loss: 2.2772 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.8493 | Train Acc: 0.5397
 Site-Sketch    | Train Loss: 1.8956 | Train Acc: 0.5238
 Site-Clipart   | Val  Loss: 2.0853 | Val  Acc: 0.2619
 Site-Clipart   | Val  Loss: 1.8821 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.8193 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.8228 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.9208 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.9869 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1519 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1823 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.2221 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 2.1044 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.2573 | Val  Acc: 0.0714
 Site-Real      | Val  Loss: 1.9209 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.0237 | Val  Acc: 0.5000
Average Valid Accuracy: 0.3681
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2619
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0714
 Best site-Real       | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6374 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.6831 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.5198 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.5176 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.8084 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.6609 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.1474 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.0164 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.9097 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.6195 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 2.1639 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.4767 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.5202 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.8196 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.4785 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.4640 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4394 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.6187 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.6840 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9846 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.0444 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.2079 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 1.7930 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.1661 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.5630 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.6991 | Val  Acc: 0.5952
Average Valid Accuracy: 0.5275
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1429
 Best site-Painting   | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2410 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.2923 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.1617 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 1.1631 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.3711 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.3546 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 1.9433 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.7903 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6659 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.2541 | Train Acc: 0.7302
 Site-QuickDraw | Train Loss: 2.1899 | Train Acc: 0.2698
 Site-Real      | Train Loss: 1.1106 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.2031 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.3121 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.1258 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.0560 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 1.1188 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.2416 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.2643 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6711 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6734 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.9352 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.4675 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 2.1763 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.1314 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.4611 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3810
 Best site-Painting   | Epoch:2 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2619
 Best site-Real       | Epoch:2 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1353 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.1538 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.9209 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.8476 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.1381 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.2223 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 1.9148 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 1.6869 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.5260 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.0884 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9910 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.8200 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.9316 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.0799 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9079 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8211 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8789 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.1479 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.0403 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6850 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.6267 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9432 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.2934 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.8940 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.8412 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.2422 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6685
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2619
 Best site-Painting   | Epoch:3 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3810
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8382 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9235 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 0.6902 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6359 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.8855 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.9910 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.8421 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.5476 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4428 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 0.8638 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8162 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.6172 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.8838 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8033 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6815 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6319 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6961 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9891 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9643 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.5384 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.5416 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8508 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.1364 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.8748 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.6317 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0782 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6905
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3333
 Best site-Painting   | Epoch:4 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3095
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6469 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7508 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.4946 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4169 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6944 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.7753 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.6439 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.3864 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.3642 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 0.6589 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.9372 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.4414 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6085 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6823 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5153 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4311 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4236 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.7543 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.7199 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.2491 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.3232 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.6574 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.9095 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.9657 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.4790 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8946 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7527
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3810
 Best site-Painting   | Epoch:5 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4048
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.6159 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.6673 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.3884 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3901 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5738 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7252 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.6352 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.3698 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1360 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.5770 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.7019 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.3249 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.5135 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.5488 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3384 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3480 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3436 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5960 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5526 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1942 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3306 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.5428 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.8223 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.8471 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.3398 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.7199 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7802
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4524
 Best site-Painting   | Epoch:6 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3333
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4446 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5355 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.3151 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2972 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4855 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5906 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.5007 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.2748 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0073 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.4244 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.8452 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.2949 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4490 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.4743 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2502 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2732 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2508 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4539 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4276 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8916 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1686 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3794 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.6334 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 2.0640 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.3259 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6593 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8242
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Painting   | Epoch:7 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3810
 Best site-Real       | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3384 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5188 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.2738 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2724 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4462 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5011 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4891 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1695 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9029 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.4577 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7314 | Train Acc: 0.4921
 Site-Real      | Train Loss: 0.2930 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4174 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4337 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2140 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2848 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2206 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6012 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4756 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.8596 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.1808 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4006 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.5998 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 2.0638 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.2802 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.7650 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8132
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.3542 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5000 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.2483 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2619 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4864 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.4867 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.4279 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.1408 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9161 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4040 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.7880 | Train Acc: 0.4921
 Site-Real      | Train Loss: 0.2120 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4161 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.4453 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2063 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1694 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1991 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4753 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4689 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.0230 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.0356 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4725 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.6761 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.8364 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.2615 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.7387 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8059
===2023-03-25 22:55:58===
===2023-03-25 22:56:00===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:7 | Test Acc: 0.8498
 Test site-Infograph | Epoch:7 | Test Acc: 0.5084
 Test site-Painting  | Epoch:7 | Test Acc: 0.8191
 Test site-QuickDraw | Epoch:7 | Test Acc: 0.3770
 Test site-Real      | Epoch:7 | Test Acc: 0.9244
 Test site-Sketch    | Epoch:7 | Test Acc: 0.7996
Average Test Accuracy: 0.7130
===2023-03-28 11:07:25===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.9929 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.9592 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.8529 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 1.8978 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 2.0989 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9785 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 2.2304 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1492 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 2.0897 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 1.9974 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 2.2885 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.8474 | Train Acc: 0.5556
 Site-Sketch    | Train Loss: 1.8554 | Train Acc: 0.5556
 Site-Clipart   | Val  Loss: 2.0594 | Val  Acc: 0.2857
 Site-Clipart   | Val  Loss: 1.8700 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.7682 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.8270 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.9245 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.9838 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1564 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1955 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.2714 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 2.1196 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.2890 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.9101 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.9832 | Val  Acc: 0.4762
Average Valid Accuracy: 0.3864
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2857
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.5593 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.6265 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.4575 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.4198 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.7035 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.5913 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.1102 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 1.9600 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.8399 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.5457 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 2.1773 | Train Acc: 0.3016
 Site-Real      | Train Loss: 1.3866 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.4417 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.7043 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.3879 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.3774 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.3993 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.5428 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.6637 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.9421 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9665 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1546 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 1.7066 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.1817 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.4418 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.6306 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5531
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1429
 Best site-Painting   | Epoch:1 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2381
 Best site-Real       | Epoch:1 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.1971 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.3017 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.1191 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1248 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.3377 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.3253 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 1.9865 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.8793 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.7379 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.2819 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.0414 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.9663 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 1.1028 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.2876 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1387 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9806 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0925 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.2592 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3085 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.7824 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 1.7059 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.1079 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 1.4493 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 2.1014 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 0.9697 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.3102 | Val  Acc: 0.6905
Average Valid Accuracy: 0.6117
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1667
 Best site-Painting   | Epoch:2 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2619
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.9920 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9637 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8341 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7720 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.9829 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.1227 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.7992 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.5128 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.3800 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 1.0133 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 2.1243 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.7983 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9178 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9405 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7680 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7360 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8182 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.9357 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8982 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.5507 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.4358 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.7859 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.1873 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 2.0331 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8335 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.2546 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7326
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3810
 Best site-Painting   | Epoch:3 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3333
 Best site-Real       | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.6927 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8723 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 0.6497 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.5521 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7812 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8875 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.9033 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.6031 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.4787 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 0.8347 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.7978 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.4770 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.7311 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.7826 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.6116 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5266 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6398 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9161 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9375 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.5645 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.6290 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9321 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.1232 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.8955 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.5096 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.9473 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6740
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.4876 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.6450 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.4539 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3408 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.5419 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7386 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.5951 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.2219 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.2977 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.5862 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8340 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.3533 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5564 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.6311 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4188 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3621 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3979 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.6408 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5805 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2233 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.1619 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4530 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.8057 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.8972 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.4505 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9220 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7637
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4762
 Best site-Painting   | Epoch:5 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3571
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.4279 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5519 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3331 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3350 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4757 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6076 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.6143 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.2242 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0796 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.5410 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.6536 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.2471 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3959 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.5098 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2953 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2855 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2784 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5057 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4608 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2123 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.2124 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.4928 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.7531 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.7426 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.2844 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6553 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7821
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4286
 Best site-Painting   | Epoch:6 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3810
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.2914 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4407 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2488 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2208 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3411 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5252 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4787 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.0758 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9787 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.3478 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.4659 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.2103 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3651 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3699 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2071 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2105 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2022 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3545 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3815 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9900 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9845 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2192 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.5975 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.7506 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.2711 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6471 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8260
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5476
 Best site-Painting   | Epoch:7 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4286
 Best site-Real       | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2261 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3711 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.1781 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1919 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3623 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4518 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4514 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 0.9834 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8428 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.3832 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.4801 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.1916 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3030 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3648 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1576 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1889 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1430 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4498 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3577 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8103 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.8309 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3231 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.5710 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.8790 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3072 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6272 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8333
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4762
 Best site-Painting   | Epoch:8 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4524
 Best site-Real       | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.1756 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2787 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.1353 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1482 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2700 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3469 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.2202 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.8766 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7527 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2447 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.5519 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.2074 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2864 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2136 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0786 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0915 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1073 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2909 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2555 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9234 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.8465 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9336 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.5227 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.6351 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.2341 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6983 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8462
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6905
 Best site-Painting   | Epoch:9 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4048
 Best site-Real       | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2/FedPrompt...
===2023-03-28 11:42:26===
===2023-03-28 11:42:27===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8783
 Test site-Infograph | Epoch:9 | Test Acc: 0.5038
 Test site-Painting  | Epoch:9 | Test Acc: 0.8352
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4470
 Test site-Real      | Epoch:9 | Test Acc: 0.9252
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8195
Average Test Accuracy: 0.7348
