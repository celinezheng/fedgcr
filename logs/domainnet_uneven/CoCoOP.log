===2023-03-24 15:31:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
===2023-03-24 15:31:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
===2023-03-24 16:08:41===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.9888 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9206 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 1.8806 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.9125 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 2.1445 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1327 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.0367 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 1.9071 | Train Acc: 0.4444
 Site-Painting  | Train Loss: 1.9196 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 2.3540 | Train Acc: 0.0317
 Site-Real      | Train Loss: 1.9294 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 1.8634 | Train Acc: 0.5397
 Site-Clipart   | Val  Loss: 1.8053 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.8287 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9018 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.9715 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0511 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1528 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1556 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.8946 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.9970 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.2163 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.0479 | Val  Acc: 0.4762
 Site-Sketch    | Val  Loss: 2.0695 | Val  Acc: 0.3095
Average Valid Accuracy: 0.3829
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.4762
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.5434 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.4803 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.3917 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.4675 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 2.0497 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.8494 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.7788 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.4376 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 1.4358 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.2156 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.3934 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 1.4477 | Train Acc: 0.6825
 Site-Clipart   | Val  Loss: 1.3184 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3247 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.5230 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.5935 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7683 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.8761 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.9523 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.3138 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 1.6184 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 2.1085 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.5972 | Val  Acc: 0.5714
 Site-Sketch    | Val  Loss: 1.7748 | Val  Acc: 0.4762
Average Valid Accuracy: 0.5496
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.7143
 Best site-Painting   | Epoch:1 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2857
 Best site-Real       | Epoch:1 | Val Acc: 0.5714
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2093 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.2742 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.1202 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.1225 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8139 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.6921 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.5066 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 1.0697 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 1.0903 | Train Acc: 0.7619
 Site-QuickDraw | Train Loss: 2.1782 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.9963 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.1558 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.0420 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0450 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.1654 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.2824 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.5384 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6815 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.8115 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.9379 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.2297 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.1535 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.1586 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.4449 | Val  Acc: 0.5952
Average Valid Accuracy: 0.6230
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3571
 Best site-Painting   | Epoch:2 | Val Acc: 0.8333
 Best site-Painting   | Epoch:2 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2381
 Best site-Real       | Epoch:2 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.9590 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9992 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.8686 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8516 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.6667 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.5332 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3643 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.9130 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.8286 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 2.1764 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.7414 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.8993 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 0.7861 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7917 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.9760 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9791 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3041 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.4761 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7643 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.7172 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.9941 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 2.0300 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.8767 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.2498 | Val  Acc: 0.6429
Average Valid Accuracy: 0.7103
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4048
 Best site-Painting   | Epoch:3 | Val Acc: 0.9286
 Best site-Painting   | Epoch:3 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3095
 Best site-Real       | Epoch:3 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.7886 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.7497 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.6386 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6619 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4771 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3640 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.2286 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.7160 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.6906 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 2.1131 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.6277 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.7560 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 0.6147 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5465 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.7482 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7753 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1760 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2414 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4730 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5053 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.8459 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.9738 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.7378 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.2161 | Val  Acc: 0.6429
Average Valid Accuracy: 0.7361
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Painting   | Epoch:4 | Val Acc: 0.9286
 Best site-Painting   | Epoch:4 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4048
 Best site-Real       | Epoch:4 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:4 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.5303 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.6599 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.5129 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4762 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.4238 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1714 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.1776 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.5866 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.5518 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.9758 | Train Acc: 0.3492
 Site-Real      | Train Loss: 0.4211 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.6469 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.4788 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5120 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6627 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6623 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.0510 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1453 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3465 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.3946 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.6078 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 2.0804 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.5680 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.9922 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7877
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6190
 Best site-Painting   | Epoch:5 | Val Acc: 0.9762
 Best site-Painting   | Epoch:5 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3095
 Best site-Real       | Epoch:5 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.3981 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.5099 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3443 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3282 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.3067 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.1010 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.9540 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.4466 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.4226 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 2.0429 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.3467 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.5037 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.3681 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3353 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5446 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.5067 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9013 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0008 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2670 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.3943 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.5511 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 2.0225 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.4956 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0250 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7897
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:6 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5476
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-Painting   | Epoch:6 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4048
 Best site-Real       | Epoch:6 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:6 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.3186 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4317 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3508 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2767 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.1988 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9495 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.8536 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.3852 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.3469 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.9415 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.3102 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4503 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.2975 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2853 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4223 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4434 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.9047 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9051 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2915 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.3245 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4143 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 2.0080 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.4009 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8829 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8155
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5476
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4286
 Best site-Real       | Epoch:7 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3152 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4002 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2518 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2157 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.0431 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.8350 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.7594 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.3993 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.3064 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.7511 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.2496 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3423 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2194 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2139 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3836 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4122 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7148 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.7651 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9562 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.2035 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.4211 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.8640 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3682 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9119 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8433
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6905
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-Painting   | Epoch:8 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4524
 Best site-Real       | Epoch:8 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2227 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3670 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2258 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1671 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.0727 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.7984 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.7213 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.3036 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3374 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.6779 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.2074 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2950 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1730 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1724 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3369 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3119 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7220 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.6428 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1027 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.2694 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.3337 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.8444 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3867 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6370 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8472
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5952
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4286
 Best site-Real       | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven/CoCoOP...
===2023-03-24 16:40:41===
===2023-03-24 16:40:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8308
 Test site-Infograph | Epoch:9 | Test Acc: 0.4916
 Test site-Painting  | Epoch:9 | Test Acc: 0.8368
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.3970
 Test site-Real      | Epoch:9 | Test Acc: 0.9170
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7744
Average Test Accuracy: 0.7079
