===2023-08-03 16:59:51===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[3, 2, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (2) | Train Loss: 2.1100 | Train Acc: 0.2522
 Site-Clipart                   (2) | Train Loss: 2.0453 | Train Acc: 0.3540
 Site-Clipart                   (2) | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-Clipart                   (2) | Train Loss: 2.0738 | Train Acc: 0.2911
 Site-Clipart                   (2) | Train Loss: 2.1005 | Train Acc: 0.2715
 Site-Real                      (5) | Train Loss: 2.0876 | Train Acc: 0.3571
 Site-Real                      (5) | Train Loss: 2.0787 | Train Acc: 0.3559
 Site-Real                      (5) | Train Loss: 2.0687 | Train Acc: 0.3589
 Site-Real                      (5) | Train Loss: 2.1167 | Train Acc: 0.2816
 Site-Painting                  (0) | Train Loss: 2.1118 | Train Acc: 0.3605
 Site-Painting                  (0) | Train Loss: 2.1080 | Train Acc: 0.3495
 Site-Painting                  (0) | Train Loss: 2.0811 | Train Acc: 0.3149
 Site-Sketch                    (1) | Train Loss: 2.0476 | Train Acc: 0.3508
 Site-Sketch                    (1) | Train Loss: 2.1048 | Train Acc: 0.3558
 Site-QuickDraw                 (3) | Train Loss: 2.3103 | Train Acc: 0.1713
 Site-Infograph                 (4) | Train Loss: 2.2553 | Train Acc: 0.1880
Average Train Accuracy: 0.3067
 Site-Clipart                   (2) | Val  Loss: 2.0400 | Val  Acc: 0.2500
 Site-Clipart                   (2) | Val  Loss: 2.1068 | Val  Acc: 0.2991
 Site-Clipart                   (2) | Val  Loss: 2.0650 | Val  Acc: 0.3333
 Site-Clipart                   (2) | Val  Loss: 2.0566 | Val  Acc: 0.3571
 Site-Clipart                   (2) | Val  Loss: 2.1134 | Val  Acc: 0.2678
 Site-Real                      (5) | Val  Loss: 2.0676 | Val  Acc: 0.3452
 Site-Real                      (5) | Val  Loss: 2.0913 | Val  Acc: 0.3220
 Site-Real                      (5) | Val  Loss: 2.0499 | Val  Acc: 0.4061
 Site-Real                      (5) | Val  Loss: 2.0611 | Val  Acc: 0.3766
 Site-Painting                  (0) | Val  Loss: 2.1028 | Val  Acc: 0.3776
 Site-Painting                  (0) | Val  Loss: 2.0467 | Val  Acc: 0.3650
 Site-Painting                  (0) | Val  Loss: 2.1136 | Val  Acc: 0.3385
 Site-Sketch                    (1) | Val  Loss: 2.0787 | Val  Acc: 0.3622
 Site-Sketch                    (1) | Val  Loss: 2.0737 | Val  Acc: 0.3539
 Site-QuickDraw                 (3) | Val  Loss: 2.3222 | Val  Acc: 0.1881
 Site-Infograph                 (4) | Val  Loss: 2.2939 | Val  Acc: 0.1603
Average Valid Accuracy: 0.3189
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.2991
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.2678
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.3452
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.3220
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.4061
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.3766
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.3776
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.3650
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.3385
 Best site-Sketch                   (1)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (1)  | Epoch:0 | Val Acc: 0.3539
 Best site-QuickDraw                (3)  | Epoch:0 | Val Acc: 0.1881
 Best site-Infograph                (4)  | Epoch:0 | Val Acc: 0.1603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 1 ============
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.8869 | Train Acc: 0.5043
 Site-Clipart                   (0) | Train Loss: 1.8286 | Train Acc: 0.5155
 Site-Clipart                   (0) | Train Loss: 1.9375 | Train Acc: 0.4844
 Site-Clipart                   (0) | Train Loss: 1.8624 | Train Acc: 0.5222
 Site-Clipart                   (0) | Train Loss: 1.9010 | Train Acc: 0.4932
 Site-Real                      (1) | Train Loss: 1.8421 | Train Acc: 0.5476
 Site-Real                      (1) | Train Loss: 1.7809 | Train Acc: 0.6271
 Site-Real                      (1) | Train Loss: 1.7581 | Train Acc: 0.6452
 Site-Real                      (1) | Train Loss: 1.8397 | Train Acc: 0.5230
 Site-Painting                  (2) | Train Loss: 1.8436 | Train Acc: 0.4898
 Site-Painting                  (2) | Train Loss: 1.8538 | Train Acc: 0.5146
 Site-Painting                  (2) | Train Loss: 1.8387 | Train Acc: 0.5052
 Site-Sketch                    (5) | Train Loss: 1.8491 | Train Acc: 0.5759
 Site-Sketch                    (5) | Train Loss: 1.9012 | Train Acc: 0.4644
 Site-QuickDraw                 (3) | Train Loss: 2.2402 | Train Acc: 0.1560
 Site-Infograph                 (4) | Train Loss: 2.1860 | Train Acc: 0.2350
Average Train Accuracy: 0.4877
 Site-Clipart                   (0) | Val  Loss: 1.7727 | Val  Acc: 0.5000
 Site-Clipart                   (0) | Val  Loss: 1.8841 | Val  Acc: 0.4860
 Site-Clipart                   (0) | Val  Loss: 1.8591 | Val  Acc: 0.5400
 Site-Clipart                   (0) | Val  Loss: 1.8561 | Val  Acc: 0.5095
 Site-Clipart                   (0) | Val  Loss: 1.9269 | Val  Acc: 0.4169
 Site-Real                      (1) | Val  Loss: 1.7600 | Val  Acc: 0.5595
 Site-Real                      (1) | Val  Loss: 1.8026 | Val  Acc: 0.5593
 Site-Real                      (1) | Val  Loss: 1.7590 | Val  Acc: 0.6545
 Site-Real                      (1) | Val  Loss: 1.7776 | Val  Acc: 0.6147
 Site-Painting                  (2) | Val  Loss: 1.8359 | Val  Acc: 0.5612
 Site-Painting                  (2) | Val  Loss: 1.8051 | Val  Acc: 0.5036
 Site-Painting                  (2) | Val  Loss: 1.8596 | Val  Acc: 0.5052
 Site-Sketch                    (5) | Val  Loss: 1.8196 | Val  Acc: 0.5512
 Site-Sketch                    (5) | Val  Loss: 1.8988 | Val  Acc: 0.4663
 Site-QuickDraw                 (3) | Val  Loss: 2.2534 | Val  Acc: 0.1789
 Site-Infograph                 (4) | Val  Loss: 2.1490 | Val  Acc: 0.2179
Average Valid Accuracy: 0.4891
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4860
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5400
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5095
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4169
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.5595
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.5593
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6545
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6147
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.5612
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.5036
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.5052
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5512
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4663
 Best site-QuickDraw                (3)  | Epoch:1 | Val Acc: 0.1789
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.2179
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 2 ============
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.6662 | Train Acc: 0.6000
 Site-Clipart                   (0) | Train Loss: 1.5946 | Train Acc: 0.5652
 Site-Clipart                   (0) | Train Loss: 1.7027 | Train Acc: 0.5644
 Site-Clipart                   (0) | Train Loss: 1.6448 | Train Acc: 0.6076
 Site-Clipart                   (0) | Train Loss: 1.6636 | Train Acc: 0.6086
 Site-Real                      (1) | Train Loss: 1.5697 | Train Acc: 0.6984
 Site-Real                      (1) | Train Loss: 1.4702 | Train Acc: 0.7514
 Site-Real                      (1) | Train Loss: 1.4439 | Train Acc: 0.7540
 Site-Real                      (1) | Train Loss: 1.5553 | Train Acc: 0.7270
 Site-Painting                  (2) | Train Loss: 1.5705 | Train Acc: 0.6667
 Site-Painting                  (2) | Train Loss: 1.6033 | Train Acc: 0.6505
 Site-Painting                  (2) | Train Loss: 1.5432 | Train Acc: 0.6990
 Site-Sketch                    (5) | Train Loss: 1.6407 | Train Acc: 0.5812
 Site-Sketch                    (5) | Train Loss: 1.6724 | Train Acc: 0.5918
 Site-QuickDraw                 (3) | Train Loss: 2.2194 | Train Acc: 0.1896
 Site-Infograph                 (4) | Train Loss: 2.0596 | Train Acc: 0.2991
Average Train Accuracy: 0.5972
 Site-Clipart                   (0) | Val  Loss: 1.5469 | Val  Acc: 0.6316
 Site-Clipart                   (0) | Val  Loss: 1.6304 | Val  Acc: 0.6729
 Site-Clipart                   (0) | Val  Loss: 1.6528 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 1.6453 | Val  Acc: 0.6381
 Site-Clipart                   (0) | Val  Loss: 1.7104 | Val  Acc: 0.5831
 Site-Real                      (1) | Val  Loss: 1.4939 | Val  Acc: 0.6548
 Site-Real                      (1) | Val  Loss: 1.4851 | Val  Acc: 0.7627
 Site-Real                      (1) | Val  Loss: 1.3948 | Val  Acc: 0.8061
 Site-Real                      (1) | Val  Loss: 1.4690 | Val  Acc: 0.7879
 Site-Painting                  (2) | Val  Loss: 1.5405 | Val  Acc: 0.7041
 Site-Painting                  (2) | Val  Loss: 1.5354 | Val  Acc: 0.6569
 Site-Painting                  (2) | Val  Loss: 1.5806 | Val  Acc: 0.6406
 Site-Sketch                    (5) | Val  Loss: 1.6457 | Val  Acc: 0.5827
 Site-Sketch                    (5) | Val  Loss: 1.7164 | Val  Acc: 0.5281
 Site-QuickDraw                 (3) | Val  Loss: 2.2310 | Val  Acc: 0.2110
 Site-Infograph                 (4) | Val  Loss: 2.0324 | Val  Acc: 0.3782
Average Valid Accuracy: 0.6191
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6316
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6729
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6381
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5831
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.6548
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7627
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.8061
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7879
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.7041
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.6569
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.6406
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5827
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5281
 Best site-QuickDraw                (3)  | Epoch:2 | Val Acc: 0.2110
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.3782
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 3 ============
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.4846 | Train Acc: 0.6261
 Site-Clipart                   (0) | Train Loss: 1.3737 | Train Acc: 0.7329
 Site-Clipart                   (0) | Train Loss: 1.5388 | Train Acc: 0.6800
 Site-Clipart                   (0) | Train Loss: 1.4452 | Train Acc: 0.7089
 Site-Clipart                   (0) | Train Loss: 1.4628 | Train Acc: 0.7081
 Site-Real                      (1) | Train Loss: 1.3080 | Train Acc: 0.8254
 Site-Real                      (1) | Train Loss: 1.2199 | Train Acc: 0.8531
 Site-Real                      (1) | Train Loss: 1.2067 | Train Acc: 0.8145
 Site-Real                      (1) | Train Loss: 1.3176 | Train Acc: 0.8075
 Site-Painting                  (2) | Train Loss: 1.4093 | Train Acc: 0.7075
 Site-Painting                  (2) | Train Loss: 1.3960 | Train Acc: 0.7233
 Site-Painting                  (2) | Train Loss: 1.3679 | Train Acc: 0.7405
 Site-Sketch                    (5) | Train Loss: 1.3991 | Train Acc: 0.6911
 Site-Sketch                    (5) | Train Loss: 1.4316 | Train Acc: 0.6554
 Site-QuickDraw                 (3) | Train Loss: 2.1333 | Train Acc: 0.2263
 Site-Infograph                 (4) | Train Loss: 1.9592 | Train Acc: 0.3889
Average Train Accuracy: 0.6806
 Site-Clipart                   (0) | Val  Loss: 1.3600 | Val  Acc: 0.6974
 Site-Clipart                   (0) | Val  Loss: 1.4356 | Val  Acc: 0.7009
 Site-Clipart                   (0) | Val  Loss: 1.4245 | Val  Acc: 0.7133
 Site-Clipart                   (0) | Val  Loss: 1.4003 | Val  Acc: 0.7286
 Site-Clipart                   (0) | Val  Loss: 1.5006 | Val  Acc: 0.6712
 Site-Real                      (1) | Val  Loss: 1.1937 | Val  Acc: 0.7976
 Site-Real                      (1) | Val  Loss: 1.2272 | Val  Acc: 0.8136
 Site-Real                      (1) | Val  Loss: 1.1771 | Val  Acc: 0.8545
 Site-Real                      (1) | Val  Loss: 1.2142 | Val  Acc: 0.8571
 Site-Painting                  (2) | Val  Loss: 1.2824 | Val  Acc: 0.7857
 Site-Painting                  (2) | Val  Loss: 1.3552 | Val  Acc: 0.7299
 Site-Painting                  (2) | Val  Loss: 1.3630 | Val  Acc: 0.7396
 Site-Sketch                    (5) | Val  Loss: 1.3939 | Val  Acc: 0.7323
 Site-Sketch                    (5) | Val  Loss: 1.5212 | Val  Acc: 0.6124
 Site-QuickDraw                 (3) | Val  Loss: 2.1313 | Val  Acc: 0.2661
 Site-Infograph                 (4) | Val  Loss: 1.9062 | Val  Acc: 0.4295
Average Valid Accuracy: 0.6956
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6974
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7009
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7133
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7286
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6712
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.7976
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8136
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8545
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8571
 Best site-Painting                 (2)  | Epoch:3 | Val Acc: 0.7857
 Best site-Painting                 (2)  | Epoch:3 | Val Acc: 0.7299
 Best site-Painting                 (2)  | Epoch:3 | Val Acc: 0.7396
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.7323
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6124
 Best site-QuickDraw                (3)  | Epoch:3 | Val Acc: 0.2661
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.4295
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 4 ============
===2023-08-03 21:11:04===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[3, 2, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (2) | Train Loss: 2.1100 | Train Acc: 0.2522
 Site-Clipart                   (2) | Train Loss: 2.0453 | Train Acc: 0.3540
 Site-Clipart                   (2) | Train Loss: 2.1419 | Train Acc: 0.2933
 Site-Clipart                   (2) | Train Loss: 2.0738 | Train Acc: 0.2911
 Site-Clipart                   (2) | Train Loss: 2.1005 | Train Acc: 0.2715
 Site-Real                      (5) | Train Loss: 2.0876 | Train Acc: 0.3571
 Site-Real                      (5) | Train Loss: 2.0787 | Train Acc: 0.3559
 Site-Real                      (5) | Train Loss: 2.0687 | Train Acc: 0.3589
 Site-Real                      (5) | Train Loss: 2.1167 | Train Acc: 0.2816
 Site-Painting                  (0) | Train Loss: 2.1118 | Train Acc: 0.3605
 Site-Painting                  (0) | Train Loss: 2.1080 | Train Acc: 0.3495
 Site-Painting                  (0) | Train Loss: 2.0811 | Train Acc: 0.3149
 Site-Sketch                    (1) | Train Loss: 2.0476 | Train Acc: 0.3508
 Site-Sketch                    (1) | Train Loss: 2.1048 | Train Acc: 0.3558
 Site-QuickDraw                 (3) | Train Loss: 2.3103 | Train Acc: 0.1713
 Site-Infograph                 (4) | Train Loss: 2.2553 | Train Acc: 0.1880
Average Train Accuracy: 0.3067
 Site-Clipart                   (2) | Val  Loss: 2.0400 | Val  Acc: 0.2500
 Site-Clipart                   (2) | Val  Loss: 2.1068 | Val  Acc: 0.2991
 Site-Clipart                   (2) | Val  Loss: 2.0650 | Val  Acc: 0.3333
 Site-Clipart                   (2) | Val  Loss: 2.0566 | Val  Acc: 0.3571
 Site-Clipart                   (2) | Val  Loss: 2.1134 | Val  Acc: 0.2678
 Site-Real                      (5) | Val  Loss: 2.0676 | Val  Acc: 0.3452
 Site-Real                      (5) | Val  Loss: 2.0913 | Val  Acc: 0.3220
 Site-Real                      (5) | Val  Loss: 2.0499 | Val  Acc: 0.4061
 Site-Real                      (5) | Val  Loss: 2.0611 | Val  Acc: 0.3766
 Site-Painting                  (0) | Val  Loss: 2.1028 | Val  Acc: 0.3776
 Site-Painting                  (0) | Val  Loss: 2.0467 | Val  Acc: 0.3650
 Site-Painting                  (0) | Val  Loss: 2.1136 | Val  Acc: 0.3385
 Site-Sketch                    (1) | Val  Loss: 2.0787 | Val  Acc: 0.3622
 Site-Sketch                    (1) | Val  Loss: 2.0737 | Val  Acc: 0.3539
 Site-QuickDraw                 (3) | Val  Loss: 2.3222 | Val  Acc: 0.1881
 Site-Infograph                 (4) | Val  Loss: 2.2939 | Val  Acc: 0.1603
Average Valid Accuracy: 0.3189
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.2500
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.2991
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.2678
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.3452
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.3220
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.4061
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.3766
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.3776
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.3650
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.3385
 Best site-Sketch                   (1)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (1)  | Epoch:0 | Val Acc: 0.3539
 Best site-QuickDraw                (3)  | Epoch:0 | Val Acc: 0.1881
 Best site-Infograph                (4)  | Epoch:0 | Val Acc: 0.1603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 1 ============
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.8869 | Train Acc: 0.5043
 Site-Clipart                   (0) | Train Loss: 1.8286 | Train Acc: 0.5155
 Site-Clipart                   (0) | Train Loss: 1.9375 | Train Acc: 0.4844
 Site-Clipart                   (0) | Train Loss: 1.8624 | Train Acc: 0.5222
 Site-Clipart                   (0) | Train Loss: 1.9010 | Train Acc: 0.4932
 Site-Real                      (1) | Train Loss: 1.8421 | Train Acc: 0.5476
 Site-Real                      (1) | Train Loss: 1.7809 | Train Acc: 0.6271
 Site-Real                      (1) | Train Loss: 1.7581 | Train Acc: 0.6452
 Site-Real                      (1) | Train Loss: 1.8397 | Train Acc: 0.5230
 Site-Painting                  (2) | Train Loss: 1.8436 | Train Acc: 0.4898
 Site-Painting                  (2) | Train Loss: 1.8538 | Train Acc: 0.5146
 Site-Painting                  (2) | Train Loss: 1.8387 | Train Acc: 0.5052
 Site-Sketch                    (5) | Train Loss: 1.8491 | Train Acc: 0.5759
 Site-Sketch                    (5) | Train Loss: 1.9012 | Train Acc: 0.4644
 Site-QuickDraw                 (3) | Train Loss: 2.2402 | Train Acc: 0.1560
 Site-Infograph                 (4) | Train Loss: 2.1860 | Train Acc: 0.2350
Average Train Accuracy: 0.4877
 Site-Clipart                   (0) | Val  Loss: 1.7727 | Val  Acc: 0.5000
 Site-Clipart                   (0) | Val  Loss: 1.8841 | Val  Acc: 0.4860
 Site-Clipart                   (0) | Val  Loss: 1.8591 | Val  Acc: 0.5400
 Site-Clipart                   (0) | Val  Loss: 1.8561 | Val  Acc: 0.5095
 Site-Clipart                   (0) | Val  Loss: 1.9269 | Val  Acc: 0.4169
 Site-Real                      (1) | Val  Loss: 1.7600 | Val  Acc: 0.5595
 Site-Real                      (1) | Val  Loss: 1.8026 | Val  Acc: 0.5593
 Site-Real                      (1) | Val  Loss: 1.7590 | Val  Acc: 0.6545
 Site-Real                      (1) | Val  Loss: 1.7776 | Val  Acc: 0.6147
 Site-Painting                  (2) | Val  Loss: 1.8359 | Val  Acc: 0.5612
 Site-Painting                  (2) | Val  Loss: 1.8051 | Val  Acc: 0.5036
 Site-Painting                  (2) | Val  Loss: 1.8596 | Val  Acc: 0.5052
 Site-Sketch                    (5) | Val  Loss: 1.8196 | Val  Acc: 0.5512
 Site-Sketch                    (5) | Val  Loss: 1.8988 | Val  Acc: 0.4663
 Site-QuickDraw                 (3) | Val  Loss: 2.2534 | Val  Acc: 0.1789
 Site-Infograph                 (4) | Val  Loss: 2.1490 | Val  Acc: 0.2179
Average Valid Accuracy: 0.4891
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4860
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5400
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5095
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4169
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.5595
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.5593
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6545
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6147
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.5612
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.5036
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.5052
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5512
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4663
 Best site-QuickDraw                (3)  | Epoch:1 | Val Acc: 0.1789
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.2179
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 2 ============
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.6662 | Train Acc: 0.6000
 Site-Clipart                   (0) | Train Loss: 1.5946 | Train Acc: 0.5652
 Site-Clipart                   (0) | Train Loss: 1.7027 | Train Acc: 0.5644
 Site-Clipart                   (0) | Train Loss: 1.6448 | Train Acc: 0.6076
 Site-Clipart                   (0) | Train Loss: 1.6636 | Train Acc: 0.6086
 Site-Real                      (1) | Train Loss: 1.5697 | Train Acc: 0.6984
 Site-Real                      (1) | Train Loss: 1.4702 | Train Acc: 0.7514
 Site-Real                      (1) | Train Loss: 1.4439 | Train Acc: 0.7540
 Site-Real                      (1) | Train Loss: 1.5553 | Train Acc: 0.7270
 Site-Painting                  (2) | Train Loss: 1.5705 | Train Acc: 0.6667
 Site-Painting                  (2) | Train Loss: 1.6033 | Train Acc: 0.6505
 Site-Painting                  (2) | Train Loss: 1.5432 | Train Acc: 0.6990
 Site-Sketch                    (5) | Train Loss: 1.6407 | Train Acc: 0.5812
 Site-Sketch                    (5) | Train Loss: 1.6724 | Train Acc: 0.5918
 Site-QuickDraw                 (3) | Train Loss: 2.2194 | Train Acc: 0.1896
 Site-Infograph                 (4) | Train Loss: 2.0596 | Train Acc: 0.2991
Average Train Accuracy: 0.5972
 Site-Clipart                   (0) | Val  Loss: 1.5469 | Val  Acc: 0.6316
 Site-Clipart                   (0) | Val  Loss: 1.6304 | Val  Acc: 0.6729
 Site-Clipart                   (0) | Val  Loss: 1.6528 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 1.6453 | Val  Acc: 0.6381
 Site-Clipart                   (0) | Val  Loss: 1.7104 | Val  Acc: 0.5831
 Site-Real                      (1) | Val  Loss: 1.4939 | Val  Acc: 0.6548
 Site-Real                      (1) | Val  Loss: 1.4851 | Val  Acc: 0.7627
 Site-Real                      (1) | Val  Loss: 1.3948 | Val  Acc: 0.8061
 Site-Real                      (1) | Val  Loss: 1.4690 | Val  Acc: 0.7879
 Site-Painting                  (2) | Val  Loss: 1.5405 | Val  Acc: 0.7041
 Site-Painting                  (2) | Val  Loss: 1.5354 | Val  Acc: 0.6569
 Site-Painting                  (2) | Val  Loss: 1.5806 | Val  Acc: 0.6406
 Site-Sketch                    (5) | Val  Loss: 1.6457 | Val  Acc: 0.5827
 Site-Sketch                    (5) | Val  Loss: 1.7164 | Val  Acc: 0.5281
 Site-QuickDraw                 (3) | Val  Loss: 2.2310 | Val  Acc: 0.2110
 Site-Infograph                 (4) | Val  Loss: 2.0324 | Val  Acc: 0.3782
Average Valid Accuracy: 0.6191
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6316
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6729
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6381
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5831
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.6548
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7627
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.8061
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7879
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.7041
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.6569
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.6406
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5827
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5281
 Best site-QuickDraw                (3)  | Epoch:2 | Val Acc: 0.2110
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.3782
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 3 ============
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.4846 | Train Acc: 0.6261
 Site-Clipart                   (0) | Train Loss: 1.3737 | Train Acc: 0.7329
 Site-Clipart                   (0) | Train Loss: 1.5388 | Train Acc: 0.6800
 Site-Clipart                   (0) | Train Loss: 1.4452 | Train Acc: 0.7089
 Site-Clipart                   (0) | Train Loss: 1.4628 | Train Acc: 0.7081
 Site-Real                      (1) | Train Loss: 1.3080 | Train Acc: 0.8254
 Site-Real                      (1) | Train Loss: 1.2199 | Train Acc: 0.8531
 Site-Real                      (1) | Train Loss: 1.2067 | Train Acc: 0.8145
 Site-Real                      (1) | Train Loss: 1.3176 | Train Acc: 0.8075
 Site-Painting                  (2) | Train Loss: 1.4093 | Train Acc: 0.7075
 Site-Painting                  (2) | Train Loss: 1.3960 | Train Acc: 0.7233
 Site-Painting                  (2) | Train Loss: 1.3679 | Train Acc: 0.7405
 Site-Sketch                    (5) | Train Loss: 1.3991 | Train Acc: 0.6911
 Site-Sketch                    (5) | Train Loss: 1.4316 | Train Acc: 0.6554
 Site-QuickDraw                 (3) | Train Loss: 2.1333 | Train Acc: 0.2263
 Site-Infograph                 (4) | Train Loss: 1.9592 | Train Acc: 0.3889
Average Train Accuracy: 0.6806
 Site-Clipart                   (0) | Val  Loss: 1.3600 | Val  Acc: 0.6974
 Site-Clipart                   (0) | Val  Loss: 1.4356 | Val  Acc: 0.7009
 Site-Clipart                   (0) | Val  Loss: 1.4245 | Val  Acc: 0.7133
 Site-Clipart                   (0) | Val  Loss: 1.4003 | Val  Acc: 0.7286
 Site-Clipart                   (0) | Val  Loss: 1.5006 | Val  Acc: 0.6712
 Site-Real                      (1) | Val  Loss: 1.1937 | Val  Acc: 0.7976
 Site-Real                      (1) | Val  Loss: 1.2272 | Val  Acc: 0.8136
 Site-Real                      (1) | Val  Loss: 1.1771 | Val  Acc: 0.8545
 Site-Real                      (1) | Val  Loss: 1.2142 | Val  Acc: 0.8571
 Site-Painting                  (2) | Val  Loss: 1.2824 | Val  Acc: 0.7857
 Site-Painting                  (2) | Val  Loss: 1.3552 | Val  Acc: 0.7299
 Site-Painting                  (2) | Val  Loss: 1.3630 | Val  Acc: 0.7396
 Site-Sketch                    (5) | Val  Loss: 1.3939 | Val  Acc: 0.7323
 Site-Sketch                    (5) | Val  Loss: 1.5212 | Val  Acc: 0.6124
 Site-QuickDraw                 (3) | Val  Loss: 2.1313 | Val  Acc: 0.2661
 Site-Infograph                 (4) | Val  Loss: 1.9062 | Val  Acc: 0.4295
Average Valid Accuracy: 0.6956
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6974
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7009
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7133
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7286
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6712
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.7976
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8136
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8545
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8571
 Best site-Painting                 (2)  | Epoch:3 | Val Acc: 0.7857
 Best site-Painting                 (2)  | Epoch:3 | Val Acc: 0.7299
 Best site-Painting                 (2)  | Epoch:3 | Val Acc: 0.7396
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.7323
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6124
 Best site-QuickDraw                (3)  | Epoch:3 | Val Acc: 0.2661
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.4295
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 4 ============
cnt=[5, 3, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.3147 | Train Acc: 0.7217
 Site-Clipart                   (0) | Train Loss: 1.2223 | Train Acc: 0.7826
 Site-Clipart                   (0) | Train Loss: 1.3518 | Train Acc: 0.7511
 Site-Clipart                   (0) | Train Loss: 1.2538 | Train Acc: 0.7405
 Site-Clipart                   (0) | Train Loss: 1.2942 | Train Acc: 0.7398
 Site-Real                      (2) | Train Loss: 1.1066 | Train Acc: 0.8810
 Site-Real                      (2) | Train Loss: 1.0086 | Train Acc: 0.8644
 Site-Real                      (2) | Train Loss: 0.9738 | Train Acc: 0.8831
 Site-Real                      (2) | Train Loss: 1.1066 | Train Acc: 0.8563
 Site-Painting                  (1) | Train Loss: 1.1621 | Train Acc: 0.7823
 Site-Painting                  (1) | Train Loss: 1.1147 | Train Acc: 0.7670
 Site-Painting                  (1) | Train Loss: 1.1290 | Train Acc: 0.7958
 Site-Sketch                    (5) | Train Loss: 1.2218 | Train Acc: 0.7592
 Site-Sketch                    (5) | Train Loss: 1.2688 | Train Acc: 0.7191
 Site-QuickDraw                 (3) | Train Loss: 2.1041 | Train Acc: 0.2752
 Site-Infograph                 (4) | Train Loss: 1.8445 | Train Acc: 0.4316
Average Train Accuracy: 0.7344
 Site-Clipart                   (0) | Val  Loss: 1.1797 | Val  Acc: 0.7500
 Site-Clipart                   (0) | Val  Loss: 1.2467 | Val  Acc: 0.7850
 Site-Clipart                   (0) | Val  Loss: 1.2527 | Val  Acc: 0.7600
 Site-Clipart                   (0) | Val  Loss: 1.2105 | Val  Acc: 0.7476
 Site-Clipart                   (0) | Val  Loss: 1.3365 | Val  Acc: 0.7254
 Site-Real                      (2) | Val  Loss: 1.0023 | Val  Acc: 0.8452
 Site-Real                      (2) | Val  Loss: 0.9979 | Val  Acc: 0.8729
 Site-Real                      (2) | Val  Loss: 0.9448 | Val  Acc: 0.8727
 Site-Real                      (2) | Val  Loss: 1.0104 | Val  Acc: 0.8788
 Site-Painting                  (1) | Val  Loss: 1.0638 | Val  Acc: 0.8265
 Site-Painting                  (1) | Val  Loss: 1.1577 | Val  Acc: 0.7664
 Site-Painting                  (1) | Val  Loss: 1.1707 | Val  Acc: 0.7552
 Site-Sketch                    (5) | Val  Loss: 1.2835 | Val  Acc: 0.6614
 Site-Sketch                    (5) | Val  Loss: 1.3064 | Val  Acc: 0.6517
 Site-QuickDraw                 (3) | Val  Loss: 2.0801 | Val  Acc: 0.2706
 Site-Infograph                 (4) | Val  Loss: 1.7811 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7286
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7850
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7600
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7476
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7254
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8452
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8729
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8727
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8788
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.8265
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7664
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7552
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6614
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6517
 Best site-QuickDraw                (3)  | Epoch:4 | Val Acc: 0.2706
 Best site-Infograph                (4)  | Epoch:4 | Val Acc: 0.4872
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 5 ============
cnt=[5, 3, 2, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (0) | Train Loss: 1.1843 | Train Acc: 0.7478
 Site-Clipart                   (0) | Train Loss: 1.0364 | Train Acc: 0.7888
 Site-Clipart                   (0) | Train Loss: 1.1801 | Train Acc: 0.7467
 Site-Clipart                   (0) | Train Loss: 1.0922 | Train Acc: 0.7722
 Site-Clipart                   (0) | Train Loss: 1.1478 | Train Acc: 0.7783
 Site-Real                      (5) | Train Loss: 0.9189 | Train Acc: 0.8651
 Site-Real                      (5) | Train Loss: 0.8613 | Train Acc: 0.8757
 Site-Real                      (5) | Train Loss: 0.8325 | Train Acc: 0.8871
 Site-Real                      (5) | Train Loss: 0.9595 | Train Acc: 0.8678
 Site-Painting                  (1) | Train Loss: 0.9924 | Train Acc: 0.8095
 Site-Painting                  (1) | Train Loss: 1.0462 | Train Acc: 0.7913
 Site-Painting                  (1) | Train Loss: 0.9986 | Train Acc: 0.8131
 Site-Sketch                    (2) | Train Loss: 1.0873 | Train Acc: 0.7435
 Site-Sketch                    (2) | Train Loss: 1.0685 | Train Acc: 0.7154
 Site-QuickDraw                 (3) | Train Loss: 1.9761 | Train Acc: 0.3425
 Site-Infograph                 (4) | Train Loss: 1.7880 | Train Acc: 0.4017
Average Train Accuracy: 0.7467
 Site-Clipart                   (0) | Val  Loss: 0.9819 | Val  Acc: 0.8158
 Site-Clipart                   (0) | Val  Loss: 1.0773 | Val  Acc: 0.8037
 Site-Clipart                   (0) | Val  Loss: 1.0880 | Val  Acc: 0.7600
 Site-Clipart                   (0) | Val  Loss: 1.0610 | Val  Acc: 0.7952
 Site-Clipart                   (0) | Val  Loss: 1.1708 | Val  Acc: 0.7492
 Site-Real                      (5) | Val  Loss: 0.8759 | Val  Acc: 0.8810
 Site-Real                      (5) | Val  Loss: 0.8687 | Val  Acc: 0.8559
 Site-Real                      (5) | Val  Loss: 0.8139 | Val  Acc: 0.9030
 Site-Real                      (5) | Val  Loss: 0.8549 | Val  Acc: 0.9004
 Site-Painting                  (1) | Val  Loss: 0.9618 | Val  Acc: 0.8469
 Site-Painting                  (1) | Val  Loss: 0.9766 | Val  Acc: 0.8029
 Site-Painting                  (1) | Val  Loss: 1.0218 | Val  Acc: 0.7865
 Site-Sketch                    (2) | Val  Loss: 1.0989 | Val  Acc: 0.7402
 Site-Sketch                    (2) | Val  Loss: 1.1459 | Val  Acc: 0.6966
 Site-QuickDraw                 (3) | Val  Loss: 1.9923 | Val  Acc: 0.3440
 Site-Infograph                 (4) | Val  Loss: 1.7040 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7621
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.8158
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.8037
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7600
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7952
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7492
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8810
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.8559
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.9030
 Best site-Real                     (5)  | Epoch:5 | Val Acc: 0.9004
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.8469
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.8029
 Best site-Painting                 (1)  | Epoch:5 | Val Acc: 0.7865
 Best site-Sketch                   (2)  | Epoch:5 | Val Acc: 0.7402
 Best site-Sketch                   (2)  | Epoch:5 | Val Acc: 0.6966
 Best site-QuickDraw                (3)  | Epoch:5 | Val Acc: 0.3440
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.5128
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 6 ============
cnt=[4, 3, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (4) | Train Loss: 1.0359 | Train Acc: 0.7739
 Site-Clipart                   (0) | Train Loss: 0.8680 | Train Acc: 0.8199
 Site-Clipart                   (0) | Train Loss: 1.0454 | Train Acc: 0.7600
 Site-Clipart                   (4) | Train Loss: 0.9463 | Train Acc: 0.8133
 Site-Clipart                   (4) | Train Loss: 0.9938 | Train Acc: 0.7986
 Site-Real                      (2) | Train Loss: 0.8074 | Train Acc: 0.8889
 Site-Real                      (2) | Train Loss: 0.7532 | Train Acc: 0.9040
 Site-Real                      (2) | Train Loss: 0.7187 | Train Acc: 0.9032
 Site-Real                      (2) | Train Loss: 0.8070 | Train Acc: 0.8994
 Site-Painting                  (1) | Train Loss: 0.9512 | Train Acc: 0.8163
 Site-Painting                  (1) | Train Loss: 0.9499 | Train Acc: 0.8301
 Site-Painting                  (1) | Train Loss: 0.9188 | Train Acc: 0.8097
 Site-Sketch                    (0) | Train Loss: 0.9537 | Train Acc: 0.7696
 Site-Sketch                    (0) | Train Loss: 0.9784 | Train Acc: 0.7678
 Site-QuickDraw                 (3) | Train Loss: 1.8506 | Train Acc: 0.3578
 Site-Infograph                 (5) | Train Loss: 1.6825 | Train Acc: 0.4744
Average Train Accuracy: 0.7742
 Site-Clipart                   (4) | Val  Loss: 0.8649 | Val  Acc: 0.8026
 Site-Clipart                   (0) | Val  Loss: 0.9337 | Val  Acc: 0.8037
 Site-Clipart                   (0) | Val  Loss: 0.9931 | Val  Acc: 0.8000
 Site-Clipart                   (4) | Val  Loss: 0.9134 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 1.0287 | Val  Acc: 0.7695
 Site-Real                      (2) | Val  Loss: 0.7520 | Val  Acc: 0.8810
 Site-Real                      (2) | Val  Loss: 0.7504 | Val  Acc: 0.8814
 Site-Real                      (2) | Val  Loss: 0.7268 | Val  Acc: 0.8727
 Site-Real                      (2) | Val  Loss: 0.7569 | Val  Acc: 0.9091
 Site-Painting                  (1) | Val  Loss: 0.8208 | Val  Acc: 0.8367
 Site-Painting                  (1) | Val  Loss: 0.8782 | Val  Acc: 0.8394
 Site-Painting                  (1) | Val  Loss: 0.8990 | Val  Acc: 0.8177
 Site-Sketch                    (0) | Val  Loss: 1.0021 | Val  Acc: 0.7480
 Site-Sketch                    (0) | Val  Loss: 1.0066 | Val  Acc: 0.7528
 Site-QuickDraw                 (3) | Val  Loss: 1.9006 | Val  Acc: 0.3670
 Site-Infograph                 (5) | Val  Loss: 1.6269 | Val  Acc: 0.4808
Average Valid Accuracy: 0.7747
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.8026
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8037
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8000
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7695
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.8810
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.8814
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.8727
 Best site-Real                     (2)  | Epoch:6 | Val Acc: 0.9091
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8367
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8394
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8177
 Best site-Sketch                   (0)  | Epoch:6 | Val Acc: 0.7480
 Best site-Sketch                   (0)  | Epoch:6 | Val Acc: 0.7528
 Best site-QuickDraw                (3)  | Epoch:6 | Val Acc: 0.3670
 Best site-Infograph                (5)  | Epoch:6 | Val Acc: 0.4808
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 7 ============
cnt=[4, 4, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (1) | Train Loss: 0.8410 | Train Acc: 0.8435
 Site-Clipart                   (4) | Train Loss: 0.8135 | Train Acc: 0.8385
 Site-Clipart                   (1) | Train Loss: 0.9139 | Train Acc: 0.8222
 Site-Clipart                   (1) | Train Loss: 0.8825 | Train Acc: 0.8101
 Site-Clipart                   (1) | Train Loss: 0.9257 | Train Acc: 0.7851
 Site-Real                      (0) | Train Loss: 0.7318 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.6571 | Train Acc: 0.9379
 Site-Real                      (0) | Train Loss: 0.6189 | Train Acc: 0.9032
 Site-Real                      (0) | Train Loss: 0.7243 | Train Acc: 0.9167
 Site-Painting                  (2) | Train Loss: 0.8745 | Train Acc: 0.7891
 Site-Painting                  (2) | Train Loss: 0.7995 | Train Acc: 0.8592
 Site-Painting                  (2) | Train Loss: 0.7928 | Train Acc: 0.8374
 Site-Sketch                    (4) | Train Loss: 0.8276 | Train Acc: 0.7906
 Site-Sketch                    (4) | Train Loss: 0.8539 | Train Acc: 0.7603
 Site-QuickDraw                 (3) | Train Loss: 1.7726 | Train Acc: 0.4495
 Site-Infograph                 (5) | Train Loss: 1.5931 | Train Acc: 0.4786
Average Train Accuracy: 0.7949
 Site-Clipart                   (1) | Val  Loss: 0.7849 | Val  Acc: 0.8158
 Site-Clipart                   (4) | Val  Loss: 0.8612 | Val  Acc: 0.8224
 Site-Clipart                   (1) | Val  Loss: 0.9129 | Val  Acc: 0.7933
 Site-Clipart                   (1) | Val  Loss: 0.8511 | Val  Acc: 0.7952
 Site-Clipart                   (1) | Val  Loss: 0.9452 | Val  Acc: 0.7831
 Site-Real                      (0) | Val  Loss: 0.6531 | Val  Acc: 0.9167
 Site-Real                      (0) | Val  Loss: 0.6366 | Val  Acc: 0.9237
 Site-Real                      (0) | Val  Loss: 0.6159 | Val  Acc: 0.9030
 Site-Real                      (0) | Val  Loss: 0.6661 | Val  Acc: 0.9048
 Site-Painting                  (2) | Val  Loss: 0.7268 | Val  Acc: 0.8571
 Site-Painting                  (2) | Val  Loss: 0.8074 | Val  Acc: 0.8248
 Site-Painting                  (2) | Val  Loss: 0.8088 | Val  Acc: 0.8229
 Site-Sketch                    (4) | Val  Loss: 0.8637 | Val  Acc: 0.7953
 Site-Sketch                    (4) | Val  Loss: 0.9281 | Val  Acc: 0.7303
 Site-QuickDraw                 (3) | Val  Loss: 1.7964 | Val  Acc: 0.4587
 Site-Infograph                 (5) | Val  Loss: 1.5046 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7921
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8158
 Best site-Clipart                  (4)  | Epoch:7 | Val Acc: 0.8224
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7933
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7952
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7831
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 0.9167
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 0.9237
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 0.9030
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 0.9048
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8571
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8248
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8229
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.7953
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.7303
 Best site-QuickDraw                (3)  | Epoch:7 | Val Acc: 0.4587
 Best site-Infograph                (5)  | Epoch:7 | Val Acc: 0.5256
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 8 ============
cnt=[4, 3, 5, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (2) | Train Loss: 0.8261 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.7276 | Train Acc: 0.8820
 Site-Clipart                   (2) | Train Loss: 0.8669 | Train Acc: 0.8267
 Site-Clipart                   (2) | Train Loss: 0.7906 | Train Acc: 0.8259
 Site-Clipart                   (2) | Train Loss: 0.8246 | Train Acc: 0.8167
 Site-Real                      (0) | Train Loss: 0.6541 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.5686 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.5644 | Train Acc: 0.9274
 Site-Real                      (0) | Train Loss: 0.6465 | Train Acc: 0.9224
 Site-Painting                  (1) | Train Loss: 0.7986 | Train Acc: 0.8231
 Site-Painting                  (1) | Train Loss: 0.7849 | Train Acc: 0.8301
 Site-Painting                  (1) | Train Loss: 0.7303 | Train Acc: 0.8235
 Site-Sketch                    (5) | Train Loss: 0.7775 | Train Acc: 0.8010
 Site-Sketch                    (5) | Train Loss: 0.8838 | Train Acc: 0.7828
 Site-QuickDraw                 (3) | Train Loss: 1.6114 | Train Acc: 0.5229
 Site-Infograph                 (4) | Train Loss: 1.5444 | Train Acc: 0.5043
Average Train Accuracy: 0.8119
 Site-Clipart                   (2) | Val  Loss: 0.6888 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.7484 | Val  Acc: 0.8692
 Site-Clipart                   (2) | Val  Loss: 0.7862 | Val  Acc: 0.8400
 Site-Clipart                   (2) | Val  Loss: 0.7601 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.8636 | Val  Acc: 0.8203
 Site-Real                      (0) | Val  Loss: 0.5500 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.5815 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.5675 | Val  Acc: 0.8970
 Site-Real                      (0) | Val  Loss: 0.5830 | Val  Acc: 0.9394
 Site-Painting                  (1) | Val  Loss: 0.6394 | Val  Acc: 0.8571
 Site-Painting                  (1) | Val  Loss: 0.7055 | Val  Acc: 0.8321
 Site-Painting                  (1) | Val  Loss: 0.7660 | Val  Acc: 0.8438
 Site-Sketch                    (5) | Val  Loss: 0.8324 | Val  Acc: 0.8110
 Site-Sketch                    (5) | Val  Loss: 0.8549 | Val  Acc: 0.7865
 Site-QuickDraw                 (3) | Val  Loss: 1.6672 | Val  Acc: 0.5459
 Site-Infograph                 (4) | Val  Loss: 1.4557 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8213
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8421
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8692
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8400
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8203
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.9322
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.8970
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.9394
 Best site-Painting                 (1)  | Epoch:8 | Val Acc: 0.8571
 Best site-Painting                 (1)  | Epoch:8 | Val Acc: 0.8321
 Best site-Painting                 (1)  | Epoch:8 | Val Acc: 0.8438
 Best site-Sketch                   (5)  | Epoch:8 | Val Acc: 0.8110
 Best site-Sketch                   (5)  | Epoch:8 | Val Acc: 0.7865
 Best site-QuickDraw                (3)  | Epoch:8 | Val Acc: 0.5459
 Best site-Infograph                (4)  | Epoch:8 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 9 ============
cnt=[4, 4, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (4) | Train Loss: 0.7172 | Train Acc: 0.8435
 Site-Clipart                   (2) | Train Loss: 0.6932 | Train Acc: 0.8137
 Site-Clipart                   (4) | Train Loss: 0.8140 | Train Acc: 0.8311
 Site-Clipart                   (0) | Train Loss: 0.7282 | Train Acc: 0.8133
 Site-Clipart                   (4) | Train Loss: 0.7638 | Train Acc: 0.8394
 Site-Real                      (1) | Train Loss: 0.5708 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.4707 | Train Acc: 0.9548
 Site-Real                      (1) | Train Loss: 0.4718 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.5516 | Train Acc: 0.9310
 Site-Painting                  (0) | Train Loss: 0.7002 | Train Acc: 0.8435
 Site-Painting                  (0) | Train Loss: 0.7240 | Train Acc: 0.8641
 Site-Painting                  (0) | Train Loss: 0.6710 | Train Acc: 0.8408
 Site-Sketch                    (2) | Train Loss: 0.7162 | Train Acc: 0.8220
 Site-Sketch                    (2) | Train Loss: 0.7285 | Train Acc: 0.7865
 Site-QuickDraw                 (3) | Train Loss: 1.4900 | Train Acc: 0.5382
 Site-Infograph                 (5) | Train Loss: 1.5202 | Train Acc: 0.5214
Average Train Accuracy: 0.8177
 Site-Clipart                   (4) | Val  Loss: 0.5963 | Val  Acc: 0.8816
 Site-Clipart                   (2) | Val  Loss: 0.6911 | Val  Acc: 0.8505
 Site-Clipart                   (4) | Val  Loss: 0.7353 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.6601 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.8106 | Val  Acc: 0.8136
 Site-Real                      (1) | Val  Loss: 0.5050 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.4760 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.4881 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.5223 | Val  Acc: 0.9307
 Site-Painting                  (0) | Val  Loss: 0.6169 | Val  Acc: 0.8571
 Site-Painting                  (0) | Val  Loss: 0.6825 | Val  Acc: 0.7956
 Site-Painting                  (0) | Val  Loss: 0.6903 | Val  Acc: 0.8385
 Site-Sketch                    (2) | Val  Loss: 0.7582 | Val  Acc: 0.7874
 Site-Sketch                    (2) | Val  Loss: 0.8275 | Val  Acc: 0.7697
 Site-QuickDraw                 (3) | Val  Loss: 1.5574 | Val  Acc: 0.5642
 Site-Infograph                 (5) | Val  Loss: 1.4140 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8246
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8816
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8505
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8333
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.8571
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8136
 Best site-Real                     (1)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:9 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:9 | Val Acc: 0.9212
 Best site-Real                     (1)  | Epoch:9 | Val Acc: 0.9307
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.8571
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.7956
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.8385
 Best site-Sketch                   (2)  | Epoch:9 | Val Acc: 0.7874
 Best site-Sketch                   (2)  | Epoch:9 | Val Acc: 0.7697
 Best site-QuickDraw                (3)  | Epoch:9 | Val Acc: 0.5642
 Best site-Infograph                (5)  | Epoch:9 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 10 ============
cnt=[4, 3, 2, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (5) | Train Loss: 0.6905 | Train Acc: 0.8348
 Site-Clipart                   (5) | Train Loss: 0.6089 | Train Acc: 0.8758
 Site-Clipart                   (5) | Train Loss: 0.7526 | Train Acc: 0.8222
 Site-Clipart                   (2) | Train Loss: 0.6632 | Train Acc: 0.8513
 Site-Clipart                   (5) | Train Loss: 0.7037 | Train Acc: 0.8439
 Site-Real                      (0) | Train Loss: 0.5347 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.4552 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.4470 | Train Acc: 0.9234
 Site-Real                      (0) | Train Loss: 0.5132 | Train Acc: 0.9339
 Site-Painting                  (1) | Train Loss: 0.6568 | Train Acc: 0.8639
 Site-Painting                  (1) | Train Loss: 0.6791 | Train Acc: 0.8350
 Site-Painting                  (1) | Train Loss: 0.6377 | Train Acc: 0.8651
 Site-Sketch                    (4) | Train Loss: 0.6796 | Train Acc: 0.8220
 Site-Sketch                    (4) | Train Loss: 0.7794 | Train Acc: 0.7978
 Site-QuickDraw                 (3) | Train Loss: 1.3786 | Train Acc: 0.5810
 Site-Infograph                 (2) | Train Loss: 1.4909 | Train Acc: 0.5256
Average Train Accuracy: 0.8267
 Site-Clipart                   (5) | Val  Loss: 0.5462 | Val  Acc: 0.8421
 Site-Clipart                   (5) | Val  Loss: 0.6464 | Val  Acc: 0.8692
 Site-Clipart                   (5) | Val  Loss: 0.6603 | Val  Acc: 0.8333
 Site-Clipart                   (2) | Val  Loss: 0.6267 | Val  Acc: 0.8381
 Site-Clipart                   (5) | Val  Loss: 0.7617 | Val  Acc: 0.8136
 Site-Real                      (0) | Val  Loss: 0.4641 | Val  Acc: 0.9048
 Site-Real                      (0) | Val  Loss: 0.4552 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.4615 | Val  Acc: 0.9152
 Site-Real                      (0) | Val  Loss: 0.4879 | Val  Acc: 0.9394
 Site-Painting                  (1) | Val  Loss: 0.5464 | Val  Acc: 0.8673
 Site-Painting                  (1) | Val  Loss: 0.6362 | Val  Acc: 0.8175
 Site-Painting                  (1) | Val  Loss: 0.6835 | Val  Acc: 0.8542
 Site-Sketch                    (4) | Val  Loss: 0.6696 | Val  Acc: 0.8346
 Site-Sketch                    (4) | Val  Loss: 0.7757 | Val  Acc: 0.7809
 Site-QuickDraw                 (3) | Val  Loss: 1.4925 | Val  Acc: 0.6101
 Site-Infograph                 (2) | Val  Loss: 1.3491 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8278
 Best site-Clipart                  (5)  | Epoch:10 | Val Acc: 0.8421
 Best site-Clipart                  (5)  | Epoch:10 | Val Acc: 0.8692
 Best site-Clipart                  (5)  | Epoch:10 | Val Acc: 0.8333
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8381
 Best site-Clipart                  (5)  | Epoch:10 | Val Acc: 0.8136
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9048
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9152
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9394
 Best site-Painting                 (1)  | Epoch:10 | Val Acc: 0.8673
 Best site-Painting                 (1)  | Epoch:10 | Val Acc: 0.8175
 Best site-Painting                 (1)  | Epoch:10 | Val Acc: 0.8542
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.8346
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.7809
 Best site-QuickDraw                (3)  | Epoch:10 | Val Acc: 0.6101
 Best site-Infograph                (2)  | Epoch:10 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 11 ============
cnt=[6, 4, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.6677 | Train Acc: 0.8261
 Site-Clipart                   (0) | Train Loss: 0.6002 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.7238 | Train Acc: 0.8400
 Site-Clipart                   (0) | Train Loss: 0.6336 | Train Acc: 0.8513
 Site-Clipart                   (0) | Train Loss: 0.6807 | Train Acc: 0.8213
 Site-Real                      (1) | Train Loss: 0.5242 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.4231 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.4170 | Train Acc: 0.9355
 Site-Real                      (1) | Train Loss: 0.4800 | Train Acc: 0.9368
 Site-Painting                  (2) | Train Loss: 0.6571 | Train Acc: 0.8231
 Site-Painting                  (2) | Train Loss: 0.6441 | Train Acc: 0.8495
 Site-Painting                  (2) | Train Loss: 0.6024 | Train Acc: 0.8547
 Site-Sketch                    (0) | Train Loss: 0.6332 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.6514 | Train Acc: 0.8127
 Site-QuickDraw                 (3) | Train Loss: 1.3813 | Train Acc: 0.6147
 Site-Infograph                 (4) | Train Loss: 1.4548 | Train Acc: 0.5385
Average Train Accuracy: 0.8300
 Site-Clipart                   (0) | Val  Loss: 0.5802 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.6084 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.6197 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.5989 | Val  Acc: 0.8429
 Site-Clipart                   (0) | Val  Loss: 0.7001 | Val  Acc: 0.8441
 Site-Real                      (1) | Val  Loss: 0.4107 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.4250 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.4317 | Val  Acc: 0.9273
 Site-Real                      (1) | Val  Loss: 0.4658 | Val  Acc: 0.9048
 Site-Painting                  (2) | Val  Loss: 0.5054 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.5617 | Val  Acc: 0.8613
 Site-Painting                  (2) | Val  Loss: 0.6142 | Val  Acc: 0.8438
 Site-Sketch                    (0) | Val  Loss: 0.6534 | Val  Acc: 0.7874
 Site-Sketch                    (5) | Val  Loss: 0.7176 | Val  Acc: 0.7697
 Site-QuickDraw                 (3) | Val  Loss: 1.4104 | Val  Acc: 0.6101
 Site-Infograph                 (4) | Val  Loss: 1.3229 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8384
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8553
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8785
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8733
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8429
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8441
 Best site-Real                     (1)  | Epoch:11 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:11 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:11 | Val Acc: 0.9273
 Best site-Real                     (1)  | Epoch:11 | Val Acc: 0.9048
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.9286
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8613
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8438
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.7874
 Best site-Sketch                   (5)  | Epoch:11 | Val Acc: 0.7697
 Best site-QuickDraw                (3)  | Epoch:11 | Val Acc: 0.6101
 Best site-Infograph                (4)  | Epoch:11 | Val Acc: 0.5897
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 12 ============
cnt=[4, 2, 3, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (0) | Train Loss: 0.6150 | Train Acc: 0.8348
 Site-Clipart                   (0) | Train Loss: 0.5406 | Train Acc: 0.9006
 Site-Clipart                   (4) | Train Loss: 0.6390 | Train Acc: 0.8533
 Site-Clipart                   (0) | Train Loss: 0.6098 | Train Acc: 0.8481
 Site-Clipart                   (0) | Train Loss: 0.6254 | Train Acc: 0.8620
 Site-Real                      (5) | Train Loss: 0.4810 | Train Acc: 0.8968
 Site-Real                      (5) | Train Loss: 0.3702 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.3937 | Train Acc: 0.9355
 Site-Real                      (5) | Train Loss: 0.4328 | Train Acc: 0.9425
 Site-Painting                  (1) | Train Loss: 0.6498 | Train Acc: 0.8503
 Site-Painting                  (2) | Train Loss: 0.5490 | Train Acc: 0.8495
 Site-Painting                  (2) | Train Loss: 0.5518 | Train Acc: 0.8754
 Site-Sketch                    (4) | Train Loss: 0.6448 | Train Acc: 0.8220
 Site-Sketch                    (4) | Train Loss: 0.6648 | Train Acc: 0.8165
 Site-QuickDraw                 (3) | Train Loss: 1.3511 | Train Acc: 0.5810
 Site-Infograph                 (1) | Train Loss: 1.3861 | Train Acc: 0.5513
Average Train Accuracy: 0.8356
 Site-Clipart                   (0) | Val  Loss: 0.4989 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.5595 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.6334 | Val  Acc: 0.8267
 Site-Clipart                   (0) | Val  Loss: 0.6101 | Val  Acc: 0.8143
 Site-Clipart                   (0) | Val  Loss: 0.6834 | Val  Acc: 0.8203
 Site-Real                      (5) | Val  Loss: 0.3806 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.3792 | Val  Acc: 0.9492
 Site-Real                      (2) | Val  Loss: 0.3820 | Val  Acc: 0.9212
 Site-Real                      (5) | Val  Loss: 0.4021 | Val  Acc: 0.9394
 Site-Painting                  (1) | Val  Loss: 0.4152 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.5260 | Val  Acc: 0.8686
 Site-Painting                  (2) | Val  Loss: 0.5806 | Val  Acc: 0.8490
 Site-Sketch                    (4) | Val  Loss: 0.6004 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 0.6998 | Val  Acc: 0.7921
 Site-QuickDraw                 (3) | Val  Loss: 1.3800 | Val  Acc: 0.6147
 Site-Infograph                 (1) | Val  Loss: 1.3040 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8425
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.9079
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8879
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8267
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8143
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.8203
 Best site-Real                     (5)  | Epoch:12 | Val Acc: 0.9286
 Best site-Real                     (5)  | Epoch:12 | Val Acc: 0.9492
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9212
 Best site-Real                     (5)  | Epoch:12 | Val Acc: 0.9394
 Best site-Painting                 (1)  | Epoch:12 | Val Acc: 0.9184
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.8686
 Best site-Painting                 (2)  | Epoch:12 | Val Acc: 0.8490
 Best site-Sketch                   (4)  | Epoch:12 | Val Acc: 0.8583
 Best site-Sketch                   (4)  | Epoch:12 | Val Acc: 0.7921
 Best site-QuickDraw                (3)  | Epoch:12 | Val Acc: 0.6147
 Best site-Infograph                (1)  | Epoch:12 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 13 ============
cnt=[6, 2, 3, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (5) | Train Loss: 0.6572 | Train Acc: 0.8348
 Site-Clipart                   (5) | Train Loss: 0.4818 | Train Acc: 0.8758
 Site-Clipart                   (2) | Train Loss: 0.6405 | Train Acc: 0.8089
 Site-Clipart                   (4) | Train Loss: 0.5828 | Train Acc: 0.8608
 Site-Clipart                   (5) | Train Loss: 0.5949 | Train Acc: 0.8620
 Site-Real                      (0) | Train Loss: 0.4480 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.3666 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.3746 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.4206 | Train Acc: 0.9454
 Site-Painting                  (1) | Train Loss: 0.5924 | Train Acc: 0.8435
 Site-Painting                  (0) | Train Loss: 0.5596 | Train Acc: 0.8641
 Site-Painting                  (0) | Train Loss: 0.5466 | Train Acc: 0.8789
 Site-Sketch                    (2) | Train Loss: 0.6285 | Train Acc: 0.8325
 Site-Sketch                    (2) | Train Loss: 0.7104 | Train Acc: 0.8127
 Site-QuickDraw                 (3) | Train Loss: 1.2750 | Train Acc: 0.6514
 Site-Infograph                 (1) | Train Loss: 1.3505 | Train Acc: 0.5684
Average Train Accuracy: 0.8401
 Site-Clipart                   (5) | Val  Loss: 0.4776 | Val  Acc: 0.8553
 Site-Clipart                   (5) | Val  Loss: 0.5720 | Val  Acc: 0.8598
 Site-Clipart                   (2) | Val  Loss: 0.5397 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.5869 | Val  Acc: 0.8190
 Site-Clipart                   (5) | Val  Loss: 0.6539 | Val  Acc: 0.8305
 Site-Real                      (0) | Val  Loss: 0.3796 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.3628 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.3593 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.3794 | Val  Acc: 0.9437
 Site-Painting                  (1) | Val  Loss: 0.4626 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.5434 | Val  Acc: 0.8613
 Site-Painting                  (0) | Val  Loss: 0.5317 | Val  Acc: 0.8802
 Site-Sketch                    (2) | Val  Loss: 0.6214 | Val  Acc: 0.8268
 Site-Sketch                    (2) | Val  Loss: 0.6997 | Val  Acc: 0.7809
 Site-QuickDraw                 (3) | Val  Loss: 1.2493 | Val  Acc: 0.6743
 Site-Infograph                 (1) | Val  Loss: 1.2710 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8479
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.8553
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.8598
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:13 | Val Acc: 0.8190
 Best site-Clipart                  (5)  | Epoch:13 | Val Acc: 0.8305
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.9576
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.9437
 Best site-Painting                 (1)  | Epoch:13 | Val Acc: 0.9082
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8613
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8802
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8268
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.7809
 Best site-QuickDraw                (3)  | Epoch:13 | Val Acc: 0.6743
 Best site-Infograph                (1)  | Epoch:13 | Val Acc: 0.6090
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 14 ============
cnt=[5, 4, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (4) | Train Loss: 0.5707 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.4548 | Train Acc: 0.8944
 Site-Clipart                   (0) | Train Loss: 0.6207 | Train Acc: 0.8444
 Site-Clipart                   (4) | Train Loss: 0.5424 | Train Acc: 0.8544
 Site-Clipart                   (0) | Train Loss: 0.5936 | Train Acc: 0.8484
 Site-Real                      (1) | Train Loss: 0.4405 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.3482 | Train Acc: 0.9548
 Site-Real                      (1) | Train Loss: 0.3682 | Train Acc: 0.9355
 Site-Real                      (1) | Train Loss: 0.3942 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.5986 | Train Acc: 0.8571
 Site-Painting                  (2) | Train Loss: 0.6304 | Train Acc: 0.8592
 Site-Painting                  (2) | Train Loss: 0.5531 | Train Acc: 0.8720
 Site-Sketch                    (0) | Train Loss: 0.5800 | Train Acc: 0.8325
 Site-Sketch                    (0) | Train Loss: 0.6398 | Train Acc: 0.7978
 Site-QuickDraw                 (3) | Train Loss: 1.2648 | Train Acc: 0.6422
 Site-Infograph                 (5) | Train Loss: 1.3646 | Train Acc: 0.5726
Average Train Accuracy: 0.8413
 Site-Clipart                   (4) | Val  Loss: 0.4593 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.4879 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.5640 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 0.5338 | Val  Acc: 0.8476
 Site-Clipart                   (0) | Val  Loss: 0.6489 | Val  Acc: 0.8237
 Site-Real                      (1) | Val  Loss: 0.3372 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.3515 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.4004 | Val  Acc: 0.9091
 Site-Real                      (1) | Val  Loss: 0.3817 | Val  Acc: 0.9351
 Site-Painting                  (2) | Val  Loss: 0.4146 | Val  Acc: 0.8878
 Site-Painting                  (2) | Val  Loss: 0.4946 | Val  Acc: 0.8540
 Site-Painting                  (2) | Val  Loss: 0.5385 | Val  Acc: 0.8542
 Site-Sketch                    (0) | Val  Loss: 0.6143 | Val  Acc: 0.8425
 Site-Sketch                    (0) | Val  Loss: 0.6551 | Val  Acc: 0.7978
 Site-QuickDraw                 (3) | Val  Loss: 1.1839 | Val  Acc: 0.6881
 Site-Infograph                 (5) | Val  Loss: 1.2043 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8494
 Best site-Clipart                  (4)  | Epoch:14 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8785
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8333
 Best site-Clipart                  (4)  | Epoch:14 | Val Acc: 0.8476
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.8237
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9492
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9091
 Best site-Real                     (1)  | Epoch:14 | Val Acc: 0.9351
 Best site-Painting                 (2)  | Epoch:14 | Val Acc: 0.8878
 Best site-Painting                 (2)  | Epoch:14 | Val Acc: 0.8540
 Best site-Painting                 (2)  | Epoch:14 | Val Acc: 0.8542
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.8425
 Best site-Sketch                   (0)  | Epoch:14 | Val Acc: 0.7978
 Best site-QuickDraw                (3)  | Epoch:14 | Val Acc: 0.6881
 Best site-Infograph                (5)  | Epoch:14 | Val Acc: 0.6538
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 15 ============
cnt=[4, 4, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (4) | Train Loss: 0.5617 | Train Acc: 0.8522
 Site-Clipart                   (0) | Train Loss: 0.4459 | Train Acc: 0.8944
 Site-Clipart                   (0) | Train Loss: 0.6246 | Train Acc: 0.8444
 Site-Clipart                   (4) | Train Loss: 0.5384 | Train Acc: 0.8639
 Site-Clipart                   (4) | Train Loss: 0.5580 | Train Acc: 0.8710
 Site-Real                      (1) | Train Loss: 0.4347 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.3169 | Train Acc: 0.9548
 Site-Real                      (1) | Train Loss: 0.3242 | Train Acc: 0.9516
 Site-Real                      (1) | Train Loss: 0.3914 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.6216 | Train Acc: 0.8639
 Site-Painting                  (2) | Train Loss: 0.5045 | Train Acc: 0.8641
 Site-Painting                  (2) | Train Loss: 0.4821 | Train Acc: 0.8824
 Site-Sketch                    (0) | Train Loss: 0.6170 | Train Acc: 0.8272
 Site-Sketch                    (0) | Train Loss: 0.6436 | Train Acc: 0.8165
 Site-QuickDraw                 (3) | Train Loss: 1.2110 | Train Acc: 0.6453
 Site-Infograph                 (5) | Train Loss: 1.3081 | Train Acc: 0.5641
Average Train Accuracy: 0.8469
 Site-Clipart                   (4) | Val  Loss: 0.4169 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.4935 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.5370 | Val  Acc: 0.8600
 Site-Clipart                   (4) | Val  Loss: 0.5297 | Val  Acc: 0.8476
 Site-Clipart                   (4) | Val  Loss: 0.6284 | Val  Acc: 0.8102
 Site-Real                      (1) | Val  Loss: 0.3570 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.3271 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.3550 | Val  Acc: 0.9152
 Site-Real                      (1) | Val  Loss: 0.3632 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.4000 | Val  Acc: 0.9082
 Site-Painting                  (2) | Val  Loss: 0.4887 | Val  Acc: 0.8759
 Site-Painting                  (2) | Val  Loss: 0.4751 | Val  Acc: 0.9062
 Site-Sketch                    (0) | Val  Loss: 0.5869 | Val  Acc: 0.8346
 Site-Sketch                    (0) | Val  Loss: 0.6057 | Val  Acc: 0.8202
 Site-QuickDraw                 (3) | Val  Loss: 1.2152 | Val  Acc: 0.6606
 Site-Infograph                 (5) | Val  Loss: 1.1832 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8564
 Best site-Clipart                  (4)  | Epoch:15 | Val Acc: 0.8816
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8972
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8600
 Best site-Clipart                  (4)  | Epoch:15 | Val Acc: 0.8476
 Best site-Clipart                  (4)  | Epoch:15 | Val Acc: 0.8102
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9407
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9152
 Best site-Real                     (1)  | Epoch:15 | Val Acc: 0.9437
 Best site-Painting                 (2)  | Epoch:15 | Val Acc: 0.9082
 Best site-Painting                 (2)  | Epoch:15 | Val Acc: 0.8759
 Best site-Painting                 (2)  | Epoch:15 | Val Acc: 0.9062
 Best site-Sketch                   (0)  | Epoch:15 | Val Acc: 0.8346
 Best site-Sketch                   (0)  | Epoch:15 | Val Acc: 0.8202
 Best site-QuickDraw                (3)  | Epoch:15 | Val Acc: 0.6606
 Best site-Infograph                (5)  | Epoch:15 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 16 ============
cnt=[4, 3, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (1) | Train Loss: 0.5368 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.4190 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.5776 | Train Acc: 0.8489
 Site-Clipart                   (1) | Train Loss: 0.5186 | Train Acc: 0.8449
 Site-Clipart                   (1) | Train Loss: 0.5272 | Train Acc: 0.8665
 Site-Real                      (4) | Train Loss: 0.4099 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.3114 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.3223 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.4065 | Train Acc: 0.9310
 Site-Painting                  (2) | Train Loss: 0.5512 | Train Acc: 0.8435
 Site-Painting                  (2) | Train Loss: 0.4513 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.5279 | Train Acc: 0.8824
 Site-Sketch                    (0) | Train Loss: 0.5661 | Train Acc: 0.8220
 Site-Sketch                    (0) | Train Loss: 0.6618 | Train Acc: 0.8240
 Site-QuickDraw                 (3) | Train Loss: 1.0363 | Train Acc: 0.6850
 Site-Infograph                 (5) | Train Loss: 1.2521 | Train Acc: 0.5940
Average Train Accuracy: 0.8462
 Site-Clipart                   (1) | Val  Loss: 0.4175 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.5050 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.5514 | Val  Acc: 0.8533
 Site-Clipart                   (1) | Val  Loss: 0.5363 | Val  Acc: 0.8429
 Site-Clipart                   (1) | Val  Loss: 0.5770 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.3299 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.3346 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.3442 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.3421 | Val  Acc: 0.9394
 Site-Painting                  (2) | Val  Loss: 0.4128 | Val  Acc: 0.8980
 Site-Painting                  (2) | Val  Loss: 0.4653 | Val  Acc: 0.8832
 Site-Painting                  (2) | Val  Loss: 0.4909 | Val  Acc: 0.8750
 Site-Sketch                    (0) | Val  Loss: 0.5685 | Val  Acc: 0.8346
 Site-Sketch                    (0) | Val  Loss: 0.6195 | Val  Acc: 0.7978
 Site-QuickDraw                 (3) | Val  Loss: 1.1226 | Val  Acc: 0.7339
 Site-Infograph                 (5) | Val  Loss: 1.1489 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8609
 Best site-Clipart                  (1)  | Epoch:16 | Val Acc: 0.9079
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8785
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8533
 Best site-Clipart                  (1)  | Epoch:16 | Val Acc: 0.8429
 Best site-Clipart                  (1)  | Epoch:16 | Val Acc: 0.8542
 Best site-Real                     (4)  | Epoch:16 | Val Acc: 0.9524
 Best site-Real                     (4)  | Epoch:16 | Val Acc: 0.9492
 Best site-Real                     (4)  | Epoch:16 | Val Acc: 0.9455
 Best site-Real                     (4)  | Epoch:16 | Val Acc: 0.9394
 Best site-Painting                 (2)  | Epoch:16 | Val Acc: 0.8980
 Best site-Painting                 (2)  | Epoch:16 | Val Acc: 0.8832
 Best site-Painting                 (2)  | Epoch:16 | Val Acc: 0.8750
 Best site-Sketch                   (0)  | Epoch:16 | Val Acc: 0.8346
 Best site-Sketch                   (0)  | Epoch:16 | Val Acc: 0.7978
 Best site-QuickDraw                (3)  | Epoch:16 | Val Acc: 0.7339
 Best site-Infograph                (5)  | Epoch:16 | Val Acc: 0.6282
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1/ccop_q=1_agg...
============ Train epoch 17 ============
cnt=[4, 3, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (1) | Train Loss: 0.5163 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.4230 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.5722 | Train Acc: 0.8356
 Site-Clipart                   (1) | Train Loss: 0.5317 | Train Acc: 0.8608
 Site-Clipart                   (1) | Train Loss: 0.5328 | Train Acc: 0.8733
 Site-Real                      (4) | Train Loss: 0.4292 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.3063 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.3137 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.3619 | Train Acc: 0.9224
 Site-Painting                  (2) | Train Loss: 0.4475 | Train Acc: 0.8844
 Site-Painting                  (2) | Train Loss: 0.5068 | Train Acc: 0.8786
 Site-Painting                  (2) | Train Loss: 0.4331 | Train Acc: 0.8927
 Site-Sketch                    (0) | Train Loss: 0.5710 | Train Acc: 0.8272
 Site-Sketch                    (0) | Train Loss: 0.5539 | Train Acc: 0.8165
 Site-QuickDraw                 (3) | Train Loss: 1.0771 | Train Acc: 0.7034
 Site-Infograph                 (5) | Train Loss: 1.2696 | Train Acc: 0.6026
Average Train Accuracy: 0.8555
 Site-Clipart                   (1) | Val  Loss: 0.4317 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.4867 | Val  Acc: 0.8598
 Site-Clipart                   (0) | Val  Loss: 0.4704 | Val  Acc: 0.8600
 Site-Clipart                   (1) | Val  Loss: 0.4802 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.6138 | Val  Acc: 0.8271
 Site-Real                      (4) | Val  Loss: 0.3077 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.3202 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.3061 | Val  Acc: 0.9212
 Site-Real                      (4) | Val  Loss: 0.3164 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3813 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.4499 | Val  Acc: 0.8832
 Site-Painting                  (2) | Val  Loss: 0.4519 | Val  Acc: 0.8802
 Site-Sketch                    (0) | Val  Loss: 0.5688 | Val  Acc: 0.8110
 Site-Sketch                    (0) | Val  Loss: 0.6170 | Val  Acc: 0.8146
 Site-QuickDraw                 (3) | Val  Loss: 1.1289 | Val  Acc: 0.7064
 Site-Infograph                 (5) | Val  Loss: 1.1918 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8572
============ Train epoch 18 ============
