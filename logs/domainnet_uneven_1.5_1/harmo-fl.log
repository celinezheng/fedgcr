===2023-05-12 09:49:19===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[25,38,57,86,129,194,291,437,63,95,143,215,322,117,176,265,149,223,99,148,165,
client_nums=[8,5,3,2,2,1,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 1.4792 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.4871 | Train Acc: 0.7632
 Site-Clipart   | Train Loss: 1.4986 | Train Acc: 0.8070
 Site-Clipart   | Train Loss: 1.4722 | Train Acc: 0.8140
 Site-Clipart   | Train Loss: 1.4617 | Train Acc: 0.7907
 Site-Clipart   | Train Loss: 1.5102 | Train Acc: 0.7938
 Site-Clipart   | Train Loss: 1.4468 | Train Acc: 0.8076
 Site-Clipart   | Train Loss: 1.4709 | Train Acc: 0.8192
 Site-Real      | Train Loss: 1.2700 | Train Acc: 0.8889
 Site-Real      | Train Loss: 1.2581 | Train Acc: 0.9368
 Site-Real      | Train Loss: 1.2129 | Train Acc: 0.9161
 Site-Real      | Train Loss: 1.1947 | Train Acc: 0.9535
 Site-Real      | Train Loss: 1.1948 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 1.4125 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 1.4071 | Train Acc: 0.8239
 Site-Painting  | Train Loss: 1.3736 | Train Acc: 0.8491
 Site-Sketch    | Train Loss: 1.4826 | Train Acc: 0.7114
 Site-Sketch    | Train Loss: 1.4599 | Train Acc: 0.7399
 Site-QuickDraw | Train Loss: 2.1414 | Train Acc: 0.3030
 Site-QuickDraw | Train Loss: 2.1414 | Train Acc: 0.2905
 Site-Infograph | Train Loss: 2.0392 | Train Acc: 0.3697
 Site-Clipart   | Val  Loss: 1.2806 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 1.2311 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 1.5754 | Val  Acc: 0.7632
 Site-Clipart   | Val  Loss: 1.4914 | Val  Acc: 0.7544
 Site-Clipart   | Val  Loss: 1.4225 | Val  Acc: 0.8256
 Site-Clipart   | Val  Loss: 1.2118 | Val  Acc: 0.8372
 Site-Clipart   | Val  Loss: 1.5340 | Val  Acc: 0.8144
 Site-Clipart   | Val  Loss: 1.4921 | Val  Acc: 0.7904
 Site-Real      | Val  Loss: 1.3159 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 1.1639 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 1.2120 | Val  Acc: 0.9684
 Site-Real      | Val  Loss: 1.1978 | Val  Acc: 0.9441
 Site-Real      | Val  Loss: 1.1413 | Val  Acc: 0.9486
 Site-Painting  | Val  Loss: 1.4319 | Val  Acc: 0.7564
 Site-Painting  | Val  Loss: 1.3695 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 1.3608 | Val  Acc: 0.8182
 Site-Sketch    | Val  Loss: 1.4436 | Val  Acc: 0.7778
 Site-Sketch    | Val  Loss: 1.4393 | Val  Acc: 0.7230
 Site-QuickDraw | Val  Loss: 2.1153 | Val  Acc: 0.3485
 Site-QuickDraw | Val  Loss: 2.1748 | Val  Acc: 0.2929
 Site-Infograph | Val  Loss: 1.9808 | Val  Acc: 0.4273
Average Valid Accuracy: 0.7749
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:0 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7632
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7544
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8256
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8372
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8144
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7904
 Best site-Real       | Epoch:0 | Val Acc: 0.8810
 Best site-Real       | Epoch:0 | Val Acc: 0.9524
 Best site-Real       | Epoch:0 | Val Acc: 0.9684
 Best site-Real       | Epoch:0 | Val Acc: 0.9441
 Best site-Real       | Epoch:0 | Val Acc: 0.9486
 Best site-Painting   | Epoch:0 | Val Acc: 0.7564
 Best site-Painting   | Epoch:0 | Val Acc: 0.8462
 Best site-Painting   | Epoch:0 | Val Acc: 0.8182
 Best site-Sketch     | Epoch:0 | Val Acc: 0.7778
 Best site-Sketch     | Epoch:0 | Val Acc: 0.7230
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.3485
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2929
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 0.9546 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0742 | Train Acc: 0.7632
 Site-Clipart   | Train Loss: 0.9864 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.8990 | Train Acc: 0.8953
 Site-Clipart   | Train Loss: 0.7789 | Train Acc: 0.8450
 Site-Clipart   | Train Loss: 1.0417 | Train Acc: 0.8505
 Site-Clipart   | Train Loss: 0.9909 | Train Acc: 0.8282
 Site-Clipart   | Train Loss: 0.9776 | Train Acc: 0.8558
 Site-Real      | Train Loss: 0.7898 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.6961 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.6594 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.6138 | Train Acc: 0.9628
 Site-Real      | Train Loss: 0.7684 | Train Acc: 0.9441
 Site-Painting  | Train Loss: 0.9562 | Train Acc: 0.8547
 Site-Painting  | Train Loss: 0.9291 | Train Acc: 0.8466
 Site-Painting  | Train Loss: 0.8115 | Train Acc: 0.8679
 Site-Sketch    | Train Loss: 1.0210 | Train Acc: 0.7315
 Site-Sketch    | Train Loss: 1.0750 | Train Acc: 0.7668
 Site-QuickDraw | Train Loss: 2.0012 | Train Acc: 0.3838
 Site-QuickDraw | Train Loss: 1.9998 | Train Acc: 0.3446
 Site-Infograph | Train Loss: 1.8531 | Train Acc: 0.4303
 Site-Clipart   | Val  Loss: 0.9944 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.8124 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 1.0422 | Val  Acc: 0.7368
 Site-Clipart   | Val  Loss: 1.0159 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.9462 | Val  Acc: 0.8372
 Site-Clipart   | Val  Loss: 0.7058 | Val  Acc: 0.8760
 Site-Clipart   | Val  Loss: 1.1680 | Val  Acc: 0.8454
 Site-Clipart   | Val  Loss: 1.0389 | Val  Acc: 0.8179
 Site-Real      | Val  Loss: 0.7569 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.6203 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.6601 | Val  Acc: 0.9684
 Site-Real      | Val  Loss: 0.6928 | Val  Acc: 0.9441
 Site-Real      | Val  Loss: 0.5589 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.9358 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 0.9365 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 0.8412 | Val  Acc: 0.8864
 Site-Sketch    | Val  Loss: 0.9302 | Val  Acc: 0.7980
 Site-Sketch    | Val  Loss: 1.0766 | Val  Acc: 0.7635
 Site-QuickDraw | Val  Loss: 1.9583 | Val  Acc: 0.3636
 Site-QuickDraw | Val  Loss: 2.0602 | Val  Acc: 0.3232
 Site-Infograph | Val  Loss: 1.7392 | Val  Acc: 0.4727
Average Valid Accuracy: 0.7991
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7368
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8596
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8372
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8760
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8454
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8179
 Best site-Real       | Epoch:1 | Val Acc: 0.9048
 Best site-Real       | Epoch:1 | Val Acc: 0.9524
 Best site-Real       | Epoch:1 | Val Acc: 0.9684
 Best site-Real       | Epoch:1 | Val Acc: 0.9441
 Best site-Real       | Epoch:1 | Val Acc: 0.9626
 Best site-Painting   | Epoch:1 | Val Acc: 0.8205
 Best site-Painting   | Epoch:1 | Val Acc: 0.8462
 Best site-Painting   | Epoch:1 | Val Acc: 0.8864
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7980
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7635
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3636
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3232
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4727
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 0.9410 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.8454 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.8825 | Train Acc: 0.8070
 Site-Clipart   | Train Loss: 0.7587 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.7985 | Train Acc: 0.8372
 Site-Clipart   | Train Loss: 0.9400 | Train Acc: 0.8454
 Site-Clipart   | Train Loss: 0.7654 | Train Acc: 0.8591
 Site-Clipart   | Train Loss: 0.7620 | Train Acc: 0.8604
 Site-Real      | Train Loss: 0.5669 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.4379 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.3531 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.3861 | Train Acc: 0.9581
 Site-Real      | Train Loss: 0.5560 | Train Acc: 0.9472
 Site-Painting  | Train Loss: 0.7111 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 0.7231 | Train Acc: 0.8466
 Site-Painting  | Train Loss: 0.7277 | Train Acc: 0.8642
 Site-Sketch    | Train Loss: 0.8314 | Train Acc: 0.7651
 Site-Sketch    | Train Loss: 0.8559 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9305 | Train Acc: 0.3636
 Site-QuickDraw | Train Loss: 1.9606 | Train Acc: 0.3581
 Site-Infograph | Train Loss: 1.7221 | Train Acc: 0.4545
 Site-Clipart   | Val  Loss: 0.7725 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.5410 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.8472 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.8203 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.7370 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.5242 | Val  Acc: 0.8915
 Site-Clipart   | Val  Loss: 0.8890 | Val  Acc: 0.8711
 Site-Clipart   | Val  Loss: 0.8035 | Val  Acc: 0.8454
 Site-Real      | Val  Loss: 0.5534 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.4090 | Val  Acc: 0.9683
 Site-Real      | Val  Loss: 0.4302 | Val  Acc: 0.9789
 Site-Real      | Val  Loss: 0.4527 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.3205 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.8115 | Val  Acc: 0.7692
 Site-Painting  | Val  Loss: 0.7411 | Val  Acc: 0.8376
 Site-Painting  | Val  Loss: 0.6498 | Val  Acc: 0.8807
 Site-Sketch    | Val  Loss: 0.7179 | Val  Acc: 0.8182
 Site-Sketch    | Val  Loss: 0.7973 | Val  Acc: 0.7838
 Site-QuickDraw | Val  Loss: 1.8882 | Val  Acc: 0.3788
 Site-QuickDraw | Val  Loss: 2.0372 | Val  Acc: 0.2727
 Site-Infograph | Val  Loss: 1.6740 | Val  Acc: 0.4364
Average Valid Accuracy: 0.8055
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8421
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8596
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8721
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8915
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8711
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8454
 Best site-Real       | Epoch:2 | Val Acc: 0.8810
 Best site-Real       | Epoch:2 | Val Acc: 0.9683
 Best site-Real       | Epoch:2 | Val Acc: 0.9789
 Best site-Real       | Epoch:2 | Val Acc: 0.9580
 Best site-Real       | Epoch:2 | Val Acc: 0.9673
 Best site-Painting   | Epoch:2 | Val Acc: 0.7692
 Best site-Painting   | Epoch:2 | Val Acc: 0.8376
 Best site-Painting   | Epoch:2 | Val Acc: 0.8807
 Best site-Sketch     | Epoch:2 | Val Acc: 0.8182
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7838
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3788
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2727
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4364
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 0.5926 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6273 | Train Acc: 0.9211
 Site-Clipart   | Train Loss: 0.6459 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.5417 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.6731 | Train Acc: 0.8682
 Site-Clipart   | Train Loss: 0.6683 | Train Acc: 0.8660
 Site-Clipart   | Train Loss: 0.6244 | Train Acc: 0.8522
 Site-Clipart   | Train Loss: 0.6450 | Train Acc: 0.8787
 Site-Real      | Train Loss: 0.4814 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.3459 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.2824 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.2623 | Train Acc: 0.9674
 Site-Real      | Train Loss: 0.2976 | Train Acc: 0.9720
 Site-Painting  | Train Loss: 0.6004 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.5937 | Train Acc: 0.8920
 Site-Painting  | Train Loss: 0.5629 | Train Acc: 0.8604
 Site-Sketch    | Train Loss: 0.7968 | Train Acc: 0.7718
 Site-Sketch    | Train Loss: 0.7351 | Train Acc: 0.7758
 Site-QuickDraw | Train Loss: 1.8627 | Train Acc: 0.3838
 Site-QuickDraw | Train Loss: 1.8496 | Train Acc: 0.3581
 Site-Infograph | Train Loss: 1.7238 | Train Acc: 0.4485
 Site-Clipart   | Val  Loss: 0.4287 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.3164 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.7238 | Val  Acc: 0.8684
 Site-Clipart   | Val  Loss: 0.6676 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.6538 | Val  Acc: 0.8605
 Site-Clipart   | Val  Loss: 0.4056 | Val  Acc: 0.9070
 Site-Clipart   | Val  Loss: 0.8339 | Val  Acc: 0.8351
 Site-Clipart   | Val  Loss: 0.7054 | Val  Acc: 0.8316
 Site-Real      | Val  Loss: 0.3999 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2830 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.3067 | Val  Acc: 0.9895
 Site-Real      | Val  Loss: 0.3665 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.2603 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.6828 | Val  Acc: 0.7821
 Site-Painting  | Val  Loss: 0.6024 | Val  Acc: 0.8547
 Site-Painting  | Val  Loss: 0.5330 | Val  Acc: 0.9034
 Site-Sketch    | Val  Loss: 0.5842 | Val  Acc: 0.8384
 Site-Sketch    | Val  Loss: 0.6391 | Val  Acc: 0.8311
 Site-QuickDraw | Val  Loss: 1.6900 | Val  Acc: 0.3485
 Site-QuickDraw | Val  Loss: 1.9244 | Val  Acc: 0.3737
 Site-Infograph | Val  Loss: 1.6266 | Val  Acc: 0.4818
Average Valid Accuracy: 0.8268
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8684
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8605
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9070
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8351
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8316
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Real       | Epoch:3 | Val Acc: 0.9841
 Best site-Real       | Epoch:3 | Val Acc: 0.9895
 Best site-Real       | Epoch:3 | Val Acc: 0.9580
 Best site-Real       | Epoch:3 | Val Acc: 0.9673
 Best site-Painting   | Epoch:3 | Val Acc: 0.7821
 Best site-Painting   | Epoch:3 | Val Acc: 0.8547
 Best site-Painting   | Epoch:3 | Val Acc: 0.9034
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8384
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8311
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3485
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3737
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4818
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 0.6236 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6508 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.5855 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.4743 | Train Acc: 0.8953
 Site-Clipart   | Train Loss: 0.5692 | Train Acc: 0.8760
 Site-Clipart   | Train Loss: 0.6776 | Train Acc: 0.8814
 Site-Clipart   | Train Loss: 0.5572 | Train Acc: 0.8660
 Site-Clipart   | Train Loss: 0.5434 | Train Acc: 0.8879
 Site-Real      | Train Loss: 0.3865 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.2929 | Train Acc: 0.9579
 Site-Real      | Train Loss: 0.2425 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.2354 | Train Acc: 0.9535
 Site-Real      | Train Loss: 0.2852 | Train Acc: 0.9720
 Site-Painting  | Train Loss: 0.5212 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 0.5011 | Train Acc: 0.8864
 Site-Painting  | Train Loss: 0.5140 | Train Acc: 0.8604
 Site-Sketch    | Train Loss: 0.6911 | Train Acc: 0.7718
 Site-Sketch    | Train Loss: 0.6238 | Train Acc: 0.8117
 Site-QuickDraw | Train Loss: 1.8120 | Train Acc: 0.4141
 Site-QuickDraw | Train Loss: 1.8790 | Train Acc: 0.3716
 Site-Infograph | Train Loss: 1.6382 | Train Acc: 0.4182
 Site-Clipart   | Val  Loss: 0.3627 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.3020 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.6347 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.5742 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.4991 | Val  Acc: 0.9070
 Site-Clipart   | Val  Loss: 0.3188 | Val  Acc: 0.9380
 Site-Clipart   | Val  Loss: 0.7737 | Val  Acc: 0.8608
 Site-Clipart   | Val  Loss: 0.6215 | Val  Acc: 0.8557
 Site-Real      | Val  Loss: 0.3025 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2395 | Val  Acc: 0.9683
 Site-Real      | Val  Loss: 0.2417 | Val  Acc: 0.9789
 Site-Real      | Val  Loss: 0.2766 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.1972 | Val  Acc: 0.9533
 Site-Painting  | Val  Loss: 0.6286 | Val  Acc: 0.8077
 Site-Painting  | Val  Loss: 0.5604 | Val  Acc: 0.8291
 Site-Painting  | Val  Loss: 0.4744 | Val  Acc: 0.8693
 Site-Sketch    | Val  Loss: 0.5110 | Val  Acc: 0.8586
 Site-Sketch    | Val  Loss: 0.6704 | Val  Acc: 0.8108
 Site-QuickDraw | Val  Loss: 1.4703 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 1.9077 | Val  Acc: 0.3939
 Site-Infograph | Val  Loss: 1.5762 | Val  Acc: 0.4727
Average Valid Accuracy: 0.8306
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8421
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9070
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9380
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8608
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8557
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Real       | Epoch:4 | Val Acc: 0.9683
 Best site-Real       | Epoch:4 | Val Acc: 0.9789
 Best site-Real       | Epoch:4 | Val Acc: 0.9580
 Best site-Real       | Epoch:4 | Val Acc: 0.9533
 Best site-Painting   | Epoch:4 | Val Acc: 0.8077
 Best site-Painting   | Epoch:4 | Val Acc: 0.8291
 Best site-Painting   | Epoch:4 | Val Acc: 0.8693
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8586
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8108
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4545
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3939
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4727
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 0.4316 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6040 | Train Acc: 0.7895
 Site-Clipart   | Train Loss: 0.5528 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.4265 | Train Acc: 0.8721
 Site-Clipart   | Train Loss: 0.4359 | Train Acc: 0.8450
 Site-Clipart   | Train Loss: 0.6072 | Train Acc: 0.8866
 Site-Clipart   | Train Loss: 0.5298 | Train Acc: 0.8969
 Site-Clipart   | Train Loss: 0.4836 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.3555 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.2354 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.1942 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.1926 | Train Acc: 0.9581
 Site-Real      | Train Loss: 0.3668 | Train Acc: 0.9627
 Site-Painting  | Train Loss: 0.4974 | Train Acc: 0.8632
 Site-Painting  | Train Loss: 0.4463 | Train Acc: 0.8977
 Site-Painting  | Train Loss: 0.4576 | Train Acc: 0.8830
 Site-Sketch    | Train Loss: 0.5804 | Train Acc: 0.8255
 Site-Sketch    | Train Loss: 0.6041 | Train Acc: 0.8251
 Site-QuickDraw | Train Loss: 1.8004 | Train Acc: 0.4242
 Site-QuickDraw | Train Loss: 1.7898 | Train Acc: 0.4392
 Site-Infograph | Train Loss: 1.6561 | Train Acc: 0.4303
 Site-Clipart   | Val  Loss: 0.4134 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.2437 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5229 | Val  Acc: 0.8684
 Site-Clipart   | Val  Loss: 0.5376 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.4497 | Val  Acc: 0.9186
 Site-Clipart   | Val  Loss: 0.2989 | Val  Acc: 0.9457
 Site-Clipart   | Val  Loss: 0.6407 | Val  Acc: 0.8814
 Site-Clipart   | Val  Loss: 0.5698 | Val  Acc: 0.8694
 Site-Real      | Val  Loss: 0.2512 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2040 | Val  Acc: 0.9683
 Site-Real      | Val  Loss: 0.2175 | Val  Acc: 0.9789
 Site-Real      | Val  Loss: 0.2511 | Val  Acc: 0.9650
 Site-Real      | Val  Loss: 0.1654 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.5388 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.5381 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.4264 | Val  Acc: 0.8693
 Site-Sketch    | Val  Loss: 0.5005 | Val  Acc: 0.8687
 Site-Sketch    | Val  Loss: 0.4968 | Val  Acc: 0.8581
 Site-QuickDraw | Val  Loss: 1.4421 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 1.8188 | Val  Acc: 0.3939
 Site-Infograph | Val  Loss: 1.5692 | Val  Acc: 0.4727
Average Valid Accuracy: 0.8472
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8684
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9123
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9186
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9457
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8814
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8694
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Real       | Epoch:5 | Val Acc: 0.9683
 Best site-Real       | Epoch:5 | Val Acc: 0.9789
 Best site-Real       | Epoch:5 | Val Acc: 0.9650
 Best site-Real       | Epoch:5 | Val Acc: 0.9673
 Best site-Painting   | Epoch:5 | Val Acc: 0.8333
 Best site-Painting   | Epoch:5 | Val Acc: 0.8718
 Best site-Painting   | Epoch:5 | Val Acc: 0.8693
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8687
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8581
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4545
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3939
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4727
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 0.4672 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5488 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.5076 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.4382 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.9582 | Train Acc: 0.8682
 Site-Clipart   | Train Loss: 0.4014 | Train Acc: 0.8711
 Site-Clipart   | Train Loss: 0.4822 | Train Acc: 0.8969
 Site-Clipart   | Train Loss: 0.4503 | Train Acc: 0.9153
 Site-Real      | Train Loss: 0.3233 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2238 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.2012 | Train Acc: 0.9790
 Site-Real      | Train Loss: 0.1895 | Train Acc: 0.9628
 Site-Real      | Train Loss: 0.2179 | Train Acc: 0.9752
 Site-Painting  | Train Loss: 0.4966 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.4219 | Train Acc: 0.8920
 Site-Painting  | Train Loss: 0.4331 | Train Acc: 0.8906
 Site-Sketch    | Train Loss: 0.6053 | Train Acc: 0.8322
 Site-Sketch    | Train Loss: 0.5965 | Train Acc: 0.8206
 Site-QuickDraw | Train Loss: 1.7767 | Train Acc: 0.4343
 Site-QuickDraw | Train Loss: 1.6262 | Train Acc: 0.4392
 Site-Infograph | Train Loss: 1.6352 | Train Acc: 0.4303
 Site-Clipart   | Val  Loss: 0.2901 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.2811 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.5684 | Val  Acc: 0.8158
 Site-Clipart   | Val  Loss: 0.4882 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.4334 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.2819 | Val  Acc: 0.9070
 Site-Clipart   | Val  Loss: 0.5455 | Val  Acc: 0.9227
 Site-Clipart   | Val  Loss: 0.5166 | Val  Acc: 0.8694
 Site-Real      | Val  Loss: 0.2458 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.1414 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.1591 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2304 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.1409 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.4743 | Val  Acc: 0.8590
 Site-Painting  | Val  Loss: 0.4640 | Val  Acc: 0.8632
 Site-Painting  | Val  Loss: 0.4072 | Val  Acc: 0.9034
 Site-Sketch    | Val  Loss: 0.4660 | Val  Acc: 0.8384
 Site-Sketch    | Val  Loss: 0.5001 | Val  Acc: 0.8378
 Site-QuickDraw | Val  Loss: 1.5890 | Val  Acc: 0.4242
 Site-QuickDraw | Val  Loss: 1.8406 | Val  Acc: 0.3535
 Site-Infograph | Val  Loss: 1.5082 | Val  Acc: 0.4727
Average Valid Accuracy: 0.8372
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 0.4011 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5629 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.4273 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.4268 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.3183 | Train Acc: 0.8992
 Site-Clipart   | Train Loss: 0.5454 | Train Acc: 0.9330
 Site-Clipart   | Train Loss: 0.4339 | Train Acc: 0.9038
 Site-Clipart   | Train Loss: 0.4371 | Train Acc: 0.9108
 Site-Real      | Train Loss: 0.3128 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.1848 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.1730 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.1649 | Train Acc: 0.9674
 Site-Real      | Train Loss: 0.1641 | Train Acc: 0.9752
 Site-Painting  | Train Loss: 0.4338 | Train Acc: 0.9060
 Site-Painting  | Train Loss: 0.3991 | Train Acc: 0.8920
 Site-Painting  | Train Loss: 0.4415 | Train Acc: 0.8830
 Site-Sketch    | Train Loss: 0.5973 | Train Acc: 0.8121
 Site-Sketch    | Train Loss: 0.5694 | Train Acc: 0.8655
 Site-QuickDraw | Train Loss: 1.6858 | Train Acc: 0.4545
 Site-QuickDraw | Train Loss: 1.6703 | Train Acc: 0.4730
 Site-Infograph | Train Loss: 1.5804 | Train Acc: 0.4667
 Site-Clipart   | Val  Loss: 0.2641 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.3032 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.4619 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.5257 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.4280 | Val  Acc: 0.9302
 Site-Clipart   | Val  Loss: 0.2641 | Val  Acc: 0.9457
 Site-Clipart   | Val  Loss: 0.4682 | Val  Acc: 0.9021
 Site-Clipart   | Val  Loss: 0.4965 | Val  Acc: 0.8763
 Site-Real      | Val  Loss: 0.2351 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.1418 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.1601 | Val  Acc: 0.9895
 Site-Real      | Val  Loss: 0.2335 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.1273 | Val  Acc: 0.9720
 Site-Painting  | Val  Loss: 0.4485 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 0.4410 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.3651 | Val  Acc: 0.9148
 Site-Sketch    | Val  Loss: 0.4692 | Val  Acc: 0.8687
 Site-Sketch    | Val  Loss: 0.5060 | Val  Acc: 0.8378
 Site-QuickDraw | Val  Loss: 1.3292 | Val  Acc: 0.4848
 Site-QuickDraw | Val  Loss: 1.7376 | Val  Acc: 0.4242
 Site-Infograph | Val  Loss: 1.5614 | Val  Acc: 0.4636
Average Valid Accuracy: 0.8555
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8772
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9302
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9457
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9021
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8763
 Best site-Real       | Epoch:7 | Val Acc: 0.9524
 Best site-Real       | Epoch:7 | Val Acc: 0.9841
 Best site-Real       | Epoch:7 | Val Acc: 0.9895
 Best site-Real       | Epoch:7 | Val Acc: 0.9580
 Best site-Real       | Epoch:7 | Val Acc: 0.9720
 Best site-Painting   | Epoch:7 | Val Acc: 0.8462
 Best site-Painting   | Epoch:7 | Val Acc: 0.8889
 Best site-Painting   | Epoch:7 | Val Acc: 0.9148
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8687
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8378
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4848
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4242
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4636
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 0.4234 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5319 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.3740 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.3942 | Train Acc: 0.8721
 Site-Clipart   | Train Loss: 0.5375 | Train Acc: 0.8837
 Site-Clipart   | Train Loss: 0.4479 | Train Acc: 0.8969
 Site-Clipart   | Train Loss: 0.4086 | Train Acc: 0.9038
 Site-Clipart   | Train Loss: 0.3891 | Train Acc: 0.9085
 Site-Real      | Train Loss: 0.2946 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.1681 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.2477 | Train Acc: 0.9790
 Site-Real      | Train Loss: 0.1533 | Train Acc: 0.9628
 Site-Real      | Train Loss: 0.1672 | Train Acc: 0.9814
 Site-Painting  | Train Loss: 0.4320 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.3758 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.3873 | Train Acc: 0.8981
 Site-Sketch    | Train Loss: 0.5838 | Train Acc: 0.8188
 Site-Sketch    | Train Loss: 0.5413 | Train Acc: 0.8430
 Site-QuickDraw | Train Loss: 1.6799 | Train Acc: 0.4747
 Site-QuickDraw | Train Loss: 1.7004 | Train Acc: 0.4527
 Site-Infograph | Train Loss: 1.6158 | Train Acc: 0.4242
 Site-Clipart   | Val  Loss: 0.3587 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1800 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4841 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.4318 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.3490 | Val  Acc: 0.9186
 Site-Clipart   | Val  Loss: 0.2198 | Val  Acc: 0.9380
 Site-Clipart   | Val  Loss: 0.5165 | Val  Acc: 0.8969
 Site-Clipart   | Val  Loss: 0.4548 | Val  Acc: 0.8866
 Site-Real      | Val  Loss: 0.2394 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.1455 | Val  Acc: 0.9683
 Site-Real      | Val  Loss: 0.1207 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2004 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.1512 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.4498 | Val  Acc: 0.8590
 Site-Painting  | Val  Loss: 0.4640 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.3775 | Val  Acc: 0.8523
 Site-Sketch    | Val  Loss: 0.4143 | Val  Acc: 0.8586
 Site-Sketch    | Val  Loss: 0.5138 | Val  Acc: 0.8311
 Site-QuickDraw | Val  Loss: 1.5449 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 1.7262 | Val  Acc: 0.4040
 Site-Infograph | Val  Loss: 1.5157 | Val  Acc: 0.4818
Average Valid Accuracy: 0.8490
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 0.3768 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5282 | Train Acc: 0.8158
 Site-Clipart   | Train Loss: 0.4462 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.4103 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.2849 | Train Acc: 0.8605
 Site-Clipart   | Train Loss: 0.2930 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.3677 | Train Acc: 0.9141
 Site-Clipart   | Train Loss: 0.3598 | Train Acc: 0.9268
 Site-Real      | Train Loss: 0.2806 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.1410 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1382 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.1618 | Train Acc: 0.9535
 Site-Real      | Train Loss: 0.2466 | Train Acc: 0.9720
 Site-Painting  | Train Loss: 0.4228 | Train Acc: 0.9145
 Site-Painting  | Train Loss: 0.3811 | Train Acc: 0.8977
 Site-Painting  | Train Loss: 0.3088 | Train Acc: 0.9132
 Site-Sketch    | Train Loss: 0.5375 | Train Acc: 0.7919
 Site-Sketch    | Train Loss: 0.4948 | Train Acc: 0.8610
 Site-QuickDraw | Train Loss: 1.5851 | Train Acc: 0.4343
 Site-QuickDraw | Train Loss: 1.6939 | Train Acc: 0.4324
 Site-Infograph | Train Loss: 1.5275 | Train Acc: 0.4788
 Site-Clipart   | Val  Loss: 0.2814 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1880 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.4185 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.4209 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.3597 | Val  Acc: 0.9070
 Site-Clipart   | Val  Loss: 0.2219 | Val  Acc: 0.9225
 Site-Clipart   | Val  Loss: 0.4107 | Val  Acc: 0.9175
 Site-Clipart   | Val  Loss: 0.4114 | Val  Acc: 0.8832
 Site-Real      | Val  Loss: 0.1652 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1223 | Val  Acc: 0.9683
 Site-Real      | Val  Loss: 0.1449 | Val  Acc: 0.9895
 Site-Real      | Val  Loss: 0.1958 | Val  Acc: 0.9650
 Site-Real      | Val  Loss: 0.1355 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.4141 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 0.4520 | Val  Acc: 0.8547
 Site-Painting  | Val  Loss: 0.3407 | Val  Acc: 0.9205
 Site-Sketch    | Val  Loss: 0.4266 | Val  Acc: 0.8889
 Site-Sketch    | Val  Loss: 0.4715 | Val  Acc: 0.8311
 Site-QuickDraw | Val  Loss: 1.2261 | Val  Acc: 0.5303
 Site-QuickDraw | Val  Loss: 1.7217 | Val  Acc: 0.4343
 Site-Infograph | Val  Loss: 1.5530 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8551
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 0.3228 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5049 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.4434 | Train Acc: 0.8772
 Site-Clipart   | Train Loss: 0.3677 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.8858 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.3410 | Train Acc: 0.9124
 Site-Clipart   | Train Loss: 0.3541 | Train Acc: 0.8969
 Site-Clipart   | Train Loss: 0.3385 | Train Acc: 0.9268
 Site-Real      | Train Loss: 0.2730 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1591 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1254 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.1411 | Train Acc: 0.9767
 Site-Real      | Train Loss: 0.1652 | Train Acc: 0.9845
 Site-Painting  | Train Loss: 0.4050 | Train Acc: 0.8974
 Site-Painting  | Train Loss: 0.3451 | Train Acc: 0.8864
 Site-Painting  | Train Loss: 0.3316 | Train Acc: 0.8906
 Site-Sketch    | Train Loss: 0.4988 | Train Acc: 0.8389
 Site-Sketch    | Train Loss: 0.4995 | Train Acc: 0.8251
 Site-QuickDraw | Train Loss: 1.5435 | Train Acc: 0.4747
 Site-QuickDraw | Train Loss: 1.6410 | Train Acc: 0.4527
 Site-Infograph | Train Loss: 1.5757 | Train Acc: 0.4606
 Site-Clipart   | Val  Loss: 0.2385 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.2081 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.3209 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.3384 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2956 | Val  Acc: 0.9302
 Site-Clipart   | Val  Loss: 0.1906 | Val  Acc: 0.9380
 Site-Clipart   | Val  Loss: 0.4441 | Val  Acc: 0.9124
 Site-Clipart   | Val  Loss: 0.3922 | Val  Acc: 0.8797
 Site-Real      | Val  Loss: 0.1777 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.0748 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1210 | Val  Acc: 0.9789
 Site-Real      | Val  Loss: 0.2092 | Val  Acc: 0.9510
 Site-Real      | Val  Loss: 0.1289 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.4226 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 0.4014 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.3514 | Val  Acc: 0.8807
 Site-Sketch    | Val  Loss: 0.3760 | Val  Acc: 0.8889
 Site-Sketch    | Val  Loss: 0.4801 | Val  Acc: 0.8311
 Site-QuickDraw | Val  Loss: 1.3004 | Val  Acc: 0.5152
 Site-QuickDraw | Val  Loss: 1.6924 | Val  Acc: 0.3838
 Site-Infograph | Val  Loss: 1.5400 | Val  Acc: 0.4545
Average Valid Accuracy: 0.8579
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9302
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9380
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9124
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8797
 Best site-Real       | Epoch:10 | Val Acc: 0.9524
 Best site-Real       | Epoch:10 | Val Acc: 1.0000
 Best site-Real       | Epoch:10 | Val Acc: 0.9789
 Best site-Real       | Epoch:10 | Val Acc: 0.9510
 Best site-Real       | Epoch:10 | Val Acc: 0.9626
 Best site-Painting   | Epoch:10 | Val Acc: 0.8462
 Best site-Painting   | Epoch:10 | Val Acc: 0.9145
 Best site-Painting   | Epoch:10 | Val Acc: 0.8807
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8889
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8311
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.5152
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3838
 Best site-Infograph  | Epoch:10 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 0.4679 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4616 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.4102 | Train Acc: 0.9474
 Site-Clipart   | Train Loss: 0.3649 | Train Acc: 0.9186
 Site-Clipart   | Train Loss: 0.2812 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.3782 | Train Acc: 0.9124
 Site-Clipart   | Train Loss: 0.3226 | Train Acc: 0.9175
 Site-Clipart   | Train Loss: 0.3271 | Train Acc: 0.9336
 Site-Real      | Train Loss: 0.2711 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.1546 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1064 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.1215 | Train Acc: 0.9721
 Site-Real      | Train Loss: 0.1186 | Train Acc: 0.9783
 Site-Painting  | Train Loss: 0.3517 | Train Acc: 0.9145
 Site-Painting  | Train Loss: 0.3081 | Train Acc: 0.9148
 Site-Painting  | Train Loss: 0.3434 | Train Acc: 0.9208
 Site-Sketch    | Train Loss: 0.4314 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.4907 | Train Acc: 0.8117
 Site-QuickDraw | Train Loss: 1.5718 | Train Acc: 0.4747
 Site-QuickDraw | Train Loss: 1.4301 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 1.6049 | Train Acc: 0.4242
 Site-Clipart   | Val  Loss: 0.3086 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.2126 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3243 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.3819 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.2886 | Val  Acc: 0.9186
 Site-Clipart   | Val  Loss: 0.2134 | Val  Acc: 0.9302
 Site-Clipart   | Val  Loss: 0.4113 | Val  Acc: 0.9227
 Site-Clipart   | Val  Loss: 0.3648 | Val  Acc: 0.9175
 Site-Real      | Val  Loss: 0.2254 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.0945 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.0712 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1959 | Val  Acc: 0.9720
 Site-Real      | Val  Loss: 0.1231 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.3376 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.3832 | Val  Acc: 0.9060
 Site-Painting  | Val  Loss: 0.3110 | Val  Acc: 0.9148
 Site-Sketch    | Val  Loss: 0.3654 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 0.4736 | Val  Acc: 0.8446
 Site-QuickDraw | Val  Loss: 1.2948 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.5561 | Val  Acc: 0.4747
 Site-Infograph | Val  Loss: 1.4793 | Val  Acc: 0.5091
Average Valid Accuracy: 0.8745
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9186
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9302
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9227
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9175
 Best site-Real       | Epoch:11 | Val Acc: 0.9286
 Best site-Real       | Epoch:11 | Val Acc: 0.9841
 Best site-Real       | Epoch:11 | Val Acc: 1.0000
 Best site-Real       | Epoch:11 | Val Acc: 0.9720
 Best site-Real       | Epoch:11 | Val Acc: 0.9673
 Best site-Painting   | Epoch:11 | Val Acc: 0.9359
 Best site-Painting   | Epoch:11 | Val Acc: 0.9060
 Best site-Painting   | Epoch:11 | Val Acc: 0.9148
 Best site-Sketch     | Epoch:11 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:11 | Val Acc: 0.8446
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.4747
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5091
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 0.3582 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.4966 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.3329 | Train Acc: 0.9298
 Site-Clipart   | Train Loss: 0.3043 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.2533 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.2707 | Train Acc: 0.9175
 Site-Clipart   | Train Loss: 0.3411 | Train Acc: 0.9175
 Site-Clipart   | Train Loss: 0.3137 | Train Acc: 0.9222
 Site-Real      | Train Loss: 0.2387 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1748 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0896 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.1505 | Train Acc: 0.9674
 Site-Real      | Train Loss: 0.1078 | Train Acc: 0.9814
 Site-Painting  | Train Loss: 0.3926 | Train Acc: 0.8974
 Site-Painting  | Train Loss: 0.3106 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4002 | Train Acc: 0.9132
 Site-Sketch    | Train Loss: 0.4628 | Train Acc: 0.8456
 Site-Sketch    | Train Loss: 0.5166 | Train Acc: 0.8430
 Site-QuickDraw | Train Loss: 1.5713 | Train Acc: 0.4747
 Site-QuickDraw | Train Loss: 1.5157 | Train Acc: 0.4932
 Site-Infograph | Train Loss: 1.5452 | Train Acc: 0.4485
 Site-Clipart   | Val  Loss: 0.2361 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1408 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3416 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.3506 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.2868 | Val  Acc: 0.9419
 Site-Clipart   | Val  Loss: 0.2627 | Val  Acc: 0.9070
 Site-Clipart   | Val  Loss: 0.3652 | Val  Acc: 0.9330
 Site-Clipart   | Val  Loss: 0.3780 | Val  Acc: 0.8900
 Site-Real      | Val  Loss: 0.1889 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.0572 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1188 | Val  Acc: 0.9789
 Site-Real      | Val  Loss: 0.1668 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.1071 | Val  Acc: 0.9720
 Site-Painting  | Val  Loss: 0.3518 | Val  Acc: 0.8846
 Site-Painting  | Val  Loss: 0.3579 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.2855 | Val  Acc: 0.9318
 Site-Sketch    | Val  Loss: 0.3705 | Val  Acc: 0.8889
 Site-Sketch    | Val  Loss: 0.4016 | Val  Acc: 0.8649
 Site-QuickDraw | Val  Loss: 1.0490 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 1.5794 | Val  Acc: 0.4848
 Site-Infograph | Val  Loss: 1.5129 | Val  Acc: 0.4818
Average Valid Accuracy: 0.8678
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 0.2603 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.4384 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.3174 | Train Acc: 0.9825
 Site-Clipart   | Train Loss: 0.2452 | Train Acc: 0.9186
 Site-Clipart   | Train Loss: 0.2127 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.3515 | Train Acc: 0.9175
 Site-Clipart   | Train Loss: 0.2915 | Train Acc: 0.9313
 Site-Clipart   | Train Loss: 0.2824 | Train Acc: 0.9428
 Site-Real      | Train Loss: 0.2669 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1282 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.1402 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.1128 | Train Acc: 0.9721
 Site-Real      | Train Loss: 0.1243 | Train Acc: 0.9876
 Site-Painting  | Train Loss: 0.3642 | Train Acc: 0.8803
 Site-Painting  | Train Loss: 0.3236 | Train Acc: 0.9148
 Site-Painting  | Train Loss: 0.3223 | Train Acc: 0.9057
 Site-Sketch    | Train Loss: 0.5196 | Train Acc: 0.8389
 Site-Sketch    | Train Loss: 0.4142 | Train Acc: 0.8520
 Site-QuickDraw | Train Loss: 1.5363 | Train Acc: 0.4646
 Site-QuickDraw | Train Loss: 1.5717 | Train Acc: 0.4730
 Site-Infograph | Train Loss: 1.5706 | Train Acc: 0.4909
 Site-Clipart   | Val  Loss: 0.3196 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1024 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3812 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.2806 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2619 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.1758 | Val  Acc: 0.9380
 Site-Clipart   | Val  Loss: 0.3342 | Val  Acc: 0.9124
 Site-Clipart   | Val  Loss: 0.3530 | Val  Acc: 0.9313
 Site-Real      | Val  Loss: 0.1653 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.0639 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0695 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1621 | Val  Acc: 0.9650
 Site-Real      | Val  Loss: 0.0970 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.2889 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3917 | Val  Acc: 0.8803
 Site-Painting  | Val  Loss: 0.2781 | Val  Acc: 0.9261
 Site-Sketch    | Val  Loss: 0.4058 | Val  Acc: 0.8586
 Site-Sketch    | Val  Loss: 0.5021 | Val  Acc: 0.8446
 Site-QuickDraw | Val  Loss: 1.1432 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.6650 | Val  Acc: 0.4646
 Site-Infograph | Val  Loss: 1.5270 | Val  Acc: 0.4818
Average Valid Accuracy: 0.8706
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 0.3396 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4667 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.3077 | Train Acc: 0.9298
 Site-Clipart   | Train Loss: 0.3693 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.2345 | Train Acc: 0.8760
 Site-Clipart   | Train Loss: 0.3080 | Train Acc: 0.9278
 Site-Clipart   | Train Loss: 0.2941 | Train Acc: 0.9244
 Site-Clipart   | Train Loss: 0.2669 | Train Acc: 0.9497
 Site-Real      | Train Loss: 0.2513 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0992 | Train Acc: 0.9895
 Site-Real      | Train Loss: 0.1013 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.1325 | Train Acc: 0.9674
 Site-Real      | Train Loss: 0.1728 | Train Acc: 0.9845
 Site-Painting  | Train Loss: 0.3316 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.3208 | Train Acc: 0.9261
 Site-Painting  | Train Loss: 0.2586 | Train Acc: 0.9208
 Site-Sketch    | Train Loss: 0.4620 | Train Acc: 0.8523
 Site-Sketch    | Train Loss: 0.4346 | Train Acc: 0.8341
 Site-QuickDraw | Train Loss: 1.5752 | Train Acc: 0.5051
 Site-QuickDraw | Train Loss: 1.4762 | Train Acc: 0.4730
 Site-Infograph | Train Loss: 1.5089 | Train Acc: 0.4970
 Site-Clipart   | Val  Loss: 0.2359 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1092 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3153 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.3490 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.2926 | Val  Acc: 0.9186
 Site-Clipart   | Val  Loss: 0.1849 | Val  Acc: 0.9612
 Site-Clipart   | Val  Loss: 0.3596 | Val  Acc: 0.9330
 Site-Clipart   | Val  Loss: 0.3544 | Val  Acc: 0.9313
 Site-Real      | Val  Loss: 0.1266 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0723 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0819 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1617 | Val  Acc: 0.9720
 Site-Real      | Val  Loss: 0.0984 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.2886 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3709 | Val  Acc: 0.8803
 Site-Painting  | Val  Loss: 0.2798 | Val  Acc: 0.9205
 Site-Sketch    | Val  Loss: 0.3649 | Val  Acc: 0.8990
 Site-Sketch    | Val  Loss: 0.4726 | Val  Acc: 0.8378
 Site-QuickDraw | Val  Loss: 1.3867 | Val  Acc: 0.4545
 Site-QuickDraw | Val  Loss: 1.5831 | Val  Acc: 0.4242
 Site-Infograph | Val  Loss: 1.4771 | Val  Acc: 0.5364
Average Valid Accuracy: 0.8740
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 0.3227 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.4610 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.3593 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.2256 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.3842 | Train Acc: 0.8992
 Site-Clipart   | Train Loss: 0.2508 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.3050 | Train Acc: 0.9244
 Site-Clipart   | Train Loss: 0.2647 | Train Acc: 0.9382
 Site-Real      | Train Loss: 0.2411 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1229 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0959 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.1167 | Train Acc: 0.9674
 Site-Real      | Train Loss: 0.0800 | Train Acc: 0.9845
 Site-Painting  | Train Loss: 0.3040 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.3131 | Train Acc: 0.9318
 Site-Painting  | Train Loss: 0.2979 | Train Acc: 0.9283
 Site-Sketch    | Train Loss: 0.4215 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.4620 | Train Acc: 0.8700
 Site-QuickDraw | Train Loss: 1.4551 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 1.6096 | Train Acc: 0.4730
 Site-Infograph | Train Loss: 1.4779 | Train Acc: 0.4848
 Site-Clipart   | Val  Loss: 0.2496 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1209 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3182 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.3446 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.2958 | Val  Acc: 0.8953
 Site-Clipart   | Val  Loss: 0.2466 | Val  Acc: 0.9457
 Site-Clipart   | Val  Loss: 0.3183 | Val  Acc: 0.9330
 Site-Clipart   | Val  Loss: 0.3305 | Val  Acc: 0.9175
 Site-Real      | Val  Loss: 0.1259 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0551 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0765 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1546 | Val  Acc: 0.9720
 Site-Real      | Val  Loss: 0.0850 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.3349 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3008 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.2709 | Val  Acc: 0.9205
 Site-Sketch    | Val  Loss: 0.3147 | Val  Acc: 0.8990
 Site-Sketch    | Val  Loss: 0.3993 | Val  Acc: 0.8919
 Site-QuickDraw | Val  Loss: 1.0871 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.5354 | Val  Acc: 0.4949
 Site-Infograph | Val  Loss: 1.4647 | Val  Acc: 0.5273
Average Valid Accuracy: 0.8801
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9211
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9123
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8953
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9457
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9330
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9175
 Best site-Real       | Epoch:15 | Val Acc: 0.9762
 Best site-Real       | Epoch:15 | Val Acc: 1.0000
 Best site-Real       | Epoch:15 | Val Acc: 1.0000
 Best site-Real       | Epoch:15 | Val Acc: 0.9720
 Best site-Real       | Epoch:15 | Val Acc: 0.9766
 Best site-Painting   | Epoch:15 | Val Acc: 0.8974
 Best site-Painting   | Epoch:15 | Val Acc: 0.9145
 Best site-Painting   | Epoch:15 | Val Acc: 0.9205
 Best site-Sketch     | Epoch:15 | Val Acc: 0.8990
 Best site-Sketch     | Epoch:15 | Val Acc: 0.8919
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.4949
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 0.2556 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.4591 | Train Acc: 0.8158
 Site-Clipart   | Train Loss: 0.3904 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.3219 | Train Acc: 0.9186
 Site-Clipart   | Train Loss: 0.5927 | Train Acc: 0.8837
 Site-Clipart   | Train Loss: 0.2358 | Train Acc: 0.9433
 Site-Clipart   | Train Loss: 0.2832 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.2595 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2609 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.1310 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1486 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.1316 | Train Acc: 0.9674
 Site-Real      | Train Loss: 0.0841 | Train Acc: 0.9814
 Site-Painting  | Train Loss: 0.3551 | Train Acc: 0.9060
 Site-Painting  | Train Loss: 0.2898 | Train Acc: 0.9318
 Site-Painting  | Train Loss: 0.2972 | Train Acc: 0.9094
 Site-Sketch    | Train Loss: 0.4471 | Train Acc: 0.8658
 Site-Sketch    | Train Loss: 0.4523 | Train Acc: 0.8700
 Site-QuickDraw | Train Loss: 1.5627 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 1.4850 | Train Acc: 0.4797
 Site-Infograph | Train Loss: 1.5671 | Train Acc: 0.4667
 Site-Clipart   | Val  Loss: 0.2025 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.2088 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2453 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.2460 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2184 | Val  Acc: 0.9651
 Site-Clipart   | Val  Loss: 0.1841 | Val  Acc: 0.9457
 Site-Clipart   | Val  Loss: 0.2820 | Val  Acc: 0.9381
 Site-Clipart   | Val  Loss: 0.3212 | Val  Acc: 0.9175
 Site-Real      | Val  Loss: 0.1130 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0998 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.0701 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1512 | Val  Acc: 0.9720
 Site-Real      | Val  Loss: 0.1127 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.3154 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3287 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.3067 | Val  Acc: 0.9148
 Site-Sketch    | Val  Loss: 0.3408 | Val  Acc: 0.9192
 Site-Sketch    | Val  Loss: 0.4262 | Val  Acc: 0.8716
 Site-QuickDraw | Val  Loss: 0.9598 | Val  Acc: 0.4848
 Site-QuickDraw | Val  Loss: 1.5720 | Val  Acc: 0.4545
 Site-Infograph | Val  Loss: 1.4534 | Val  Acc: 0.5182
Average Valid Accuracy: 0.8792
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 0.3267 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4390 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.3471 | Train Acc: 0.9474
 Site-Clipart   | Train Loss: 0.2673 | Train Acc: 0.9186
 Site-Clipart   | Train Loss: 0.1874 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.4020 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.2593 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.2303 | Train Acc: 0.9542
 Site-Real      | Train Loss: 0.2597 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0959 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1282 | Train Acc: 0.9790
 Site-Real      | Train Loss: 0.0800 | Train Acc: 0.9767
 Site-Real      | Train Loss: 0.0782 | Train Acc: 0.9907
 Site-Painting  | Train Loss: 0.3435 | Train Acc: 0.9231
 Site-Painting  | Train Loss: 0.3002 | Train Acc: 0.9205
 Site-Painting  | Train Loss: 0.2466 | Train Acc: 0.9245
 Site-Sketch    | Train Loss: 0.4022 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.4255 | Train Acc: 0.8744
 Site-QuickDraw | Train Loss: 1.4586 | Train Acc: 0.5152
 Site-QuickDraw | Train Loss: 1.5271 | Train Acc: 0.4730
 Site-Infograph | Train Loss: 1.4466 | Train Acc: 0.4909
 Site-Clipart   | Val  Loss: 0.2496 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0846 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2648 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2696 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2356 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.1518 | Val  Acc: 0.9612
 Site-Clipart   | Val  Loss: 0.3051 | Val  Acc: 0.9433
 Site-Clipart   | Val  Loss: 0.3021 | Val  Acc: 0.9210
 Site-Real      | Val  Loss: 0.1314 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0776 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.0721 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1307 | Val  Acc: 0.9650
 Site-Real      | Val  Loss: 0.0986 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.2735 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.2829 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.2350 | Val  Acc: 0.9318
 Site-Sketch    | Val  Loss: 0.3359 | Val  Acc: 0.9192
 Site-Sketch    | Val  Loss: 0.3780 | Val  Acc: 0.8784
 Site-QuickDraw | Val  Loss: 1.2020 | Val  Acc: 0.5303
 Site-QuickDraw | Val  Loss: 1.5486 | Val  Acc: 0.4242
 Site-Infograph | Val  Loss: 1.4441 | Val  Acc: 0.5273
Average Valid Accuracy: 0.8855
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9535
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9612
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9433
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9210
 Best site-Real       | Epoch:17 | Val Acc: 0.9762
 Best site-Real       | Epoch:17 | Val Acc: 0.9841
 Best site-Real       | Epoch:17 | Val Acc: 1.0000
 Best site-Real       | Epoch:17 | Val Acc: 0.9650
 Best site-Real       | Epoch:17 | Val Acc: 0.9766
 Best site-Painting   | Epoch:17 | Val Acc: 0.9359
 Best site-Painting   | Epoch:17 | Val Acc: 0.9316
 Best site-Painting   | Epoch:17 | Val Acc: 0.9318
 Best site-Sketch     | Epoch:17 | Val Acc: 0.9192
 Best site-Sketch     | Epoch:17 | Val Acc: 0.8784
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.5303
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.4242
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 0.2294 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4537 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.3022 | Train Acc: 0.9474
 Site-Clipart   | Train Loss: 0.1916 | Train Acc: 0.9651
 Site-Clipart   | Train Loss: 0.1928 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.2590 | Train Acc: 0.9433
 Site-Clipart   | Train Loss: 0.2596 | Train Acc: 0.9210
 Site-Clipart   | Train Loss: 0.2534 | Train Acc: 0.9359
 Site-Real      | Train Loss: 0.2681 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1224 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0991 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.0829 | Train Acc: 0.9721
 Site-Real      | Train Loss: 0.0847 | Train Acc: 0.9845
 Site-Painting  | Train Loss: 0.3159 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.2419 | Train Acc: 0.9318
 Site-Painting  | Train Loss: 0.2921 | Train Acc: 0.9208
 Site-Sketch    | Train Loss: 0.4102 | Train Acc: 0.8658
 Site-Sketch    | Train Loss: 0.4052 | Train Acc: 0.8565
 Site-QuickDraw | Train Loss: 1.4286 | Train Acc: 0.5354
 Site-QuickDraw | Train Loss: 1.5396 | Train Acc: 0.4932
 Site-Infograph | Train Loss: 1.5681 | Train Acc: 0.4727
 Site-Clipart   | Val  Loss: 0.2215 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1897 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2235 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.2301 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2701 | Val  Acc: 0.9419
 Site-Clipart   | Val  Loss: 0.1411 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.2674 | Val  Acc: 0.9278
 Site-Clipart   | Val  Loss: 0.3018 | Val  Acc: 0.9347
 Site-Real      | Val  Loss: 0.1132 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0606 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0577 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1465 | Val  Acc: 0.9650
 Site-Real      | Val  Loss: 0.0795 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.3316 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.3602 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.2376 | Val  Acc: 0.9432
 Site-Sketch    | Val  Loss: 0.3603 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 0.3347 | Val  Acc: 0.8919
 Site-QuickDraw | Val  Loss: 0.9436 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.4764 | Val  Acc: 0.4545
 Site-Infograph | Val  Loss: 1.5030 | Val  Acc: 0.5091
Average Valid Accuracy: 0.8813
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.4358 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3122 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2566 | Train Acc: 0.9474
 Site-Clipart   | Train Loss: 0.2234 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.2136 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.2536 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.2830 | Train Acc: 0.9416
 Site-Clipart   | Train Loss: 0.2339 | Train Acc: 0.9519
 Site-Real      | Train Loss: 0.2418 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0894 | Train Acc: 0.9895
 Site-Real      | Train Loss: 0.0876 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.0928 | Train Acc: 0.9721
 Site-Real      | Train Loss: 0.0784 | Train Acc: 0.9907
 Site-Painting  | Train Loss: 0.3224 | Train Acc: 0.9060
 Site-Painting  | Train Loss: 0.2751 | Train Acc: 0.9261
 Site-Painting  | Train Loss: 0.2692 | Train Acc: 0.9170
 Site-Sketch    | Train Loss: 0.3633 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.3705 | Train Acc: 0.8789
 Site-QuickDraw | Train Loss: 1.4430 | Train Acc: 0.5051
 Site-QuickDraw | Train Loss: 1.4998 | Train Acc: 0.4527
 Site-Infograph | Train Loss: 1.5618 | Train Acc: 0.4788
 Site-Clipart   | Val  Loss: 0.2567 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.0866 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2223 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2378 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2653 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.1414 | Val  Acc: 0.9612
 Site-Clipart   | Val  Loss: 0.2834 | Val  Acc: 0.9381
 Site-Clipart   | Val  Loss: 0.3232 | Val  Acc: 0.9072
 Site-Real      | Val  Loss: 0.1276 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.0318 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0529 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1135 | Val  Acc: 0.9720
 Site-Real      | Val  Loss: 0.1051 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.2725 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.3535 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.2173 | Val  Acc: 0.9545
 Site-Sketch    | Val  Loss: 0.3510 | Val  Acc: 0.9192
 Site-Sketch    | Val  Loss: 0.3834 | Val  Acc: 0.8649
 Site-QuickDraw | Val  Loss: 1.1617 | Val  Acc: 0.5758
 Site-QuickDraw | Val  Loss: 1.5200 | Val  Acc: 0.4444
 Site-Infograph | Val  Loss: 1.4588 | Val  Acc: 0.4818
Average Valid Accuracy: 0.8788
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 0.2424 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.3380 | Train Acc: 0.9211
 Site-Clipart   | Train Loss: 0.3037 | Train Acc: 0.9298
 Site-Clipart   | Train Loss: 0.2023 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.2034 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.3236 | Train Acc: 0.9588
 Site-Clipart   | Train Loss: 0.2398 | Train Acc: 0.9416
 Site-Clipart   | Train Loss: 0.2182 | Train Acc: 0.9611
 Site-Real      | Train Loss: 0.2579 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.1322 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.0860 | Train Acc: 0.9790
 Site-Real      | Train Loss: 0.0788 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0717 | Train Acc: 0.9907
 Site-Painting  | Train Loss: 0.3357 | Train Acc: 0.9231
 Site-Painting  | Train Loss: 0.2582 | Train Acc: 0.9375
 Site-Painting  | Train Loss: 0.2796 | Train Acc: 0.9283
 Site-Sketch    | Train Loss: 0.4109 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.3889 | Train Acc: 0.8655
 Site-QuickDraw | Train Loss: 1.4286 | Train Acc: 0.4949
 Site-QuickDraw | Train Loss: 1.4640 | Train Acc: 0.5135
 Site-Infograph | Train Loss: 1.4854 | Train Acc: 0.5152
 Site-Clipart   | Val  Loss: 0.1961 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1421 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2129 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2388 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2226 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.1412 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.2772 | Val  Acc: 0.9278
 Site-Clipart   | Val  Loss: 0.2800 | Val  Acc: 0.9347
 Site-Real      | Val  Loss: 0.1510 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.0525 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0563 | Val  Acc: 0.9895
 Site-Real      | Val  Loss: 0.1191 | Val  Acc: 0.9720
 Site-Real      | Val  Loss: 0.0891 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.2640 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3183 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.2352 | Val  Acc: 0.9205
 Site-Sketch    | Val  Loss: 0.3402 | Val  Acc: 0.8788
 Site-Sketch    | Val  Loss: 0.3598 | Val  Acc: 0.8649
 Site-QuickDraw | Val  Loss: 1.1636 | Val  Acc: 0.5303
 Site-QuickDraw | Val  Loss: 1.4363 | Val  Acc: 0.4747
 Site-Infograph | Val  Loss: 1.4755 | Val  Acc: 0.5364
Average Valid Accuracy: 0.8823
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 0.1242 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3983 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.3177 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2326 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.2156 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.3009 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.2365 | Train Acc: 0.9416
 Site-Clipart   | Train Loss: 0.2032 | Train Acc: 0.9634
 Site-Real      | Train Loss: 0.2652 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.0804 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0969 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.0724 | Train Acc: 0.9721
 Site-Real      | Train Loss: 0.0672 | Train Acc: 0.9876
 Site-Painting  | Train Loss: 0.2855 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.2143 | Train Acc: 0.9489
 Site-Painting  | Train Loss: 0.2649 | Train Acc: 0.9170
 Site-Sketch    | Train Loss: 0.4267 | Train Acc: 0.8658
 Site-Sketch    | Train Loss: 0.3728 | Train Acc: 0.8789
 Site-QuickDraw | Train Loss: 1.3826 | Train Acc: 0.4949
 Site-QuickDraw | Train Loss: 1.3644 | Train Acc: 0.5270
 Site-Infograph | Train Loss: 1.4904 | Train Acc: 0.4667
 Site-Clipart   | Val  Loss: 0.1583 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0883 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2125 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2081 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.1983 | Val  Acc: 0.9302
 Site-Clipart   | Val  Loss: 0.1145 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.2539 | Val  Acc: 0.9175
 Site-Clipart   | Val  Loss: 0.2520 | Val  Acc: 0.9450
 Site-Real      | Val  Loss: 0.1234 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0254 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0538 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1132 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0993 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.2532 | Val  Acc: 0.8846
 Site-Painting  | Val  Loss: 0.2870 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.2163 | Val  Acc: 0.9489
 Site-Sketch    | Val  Loss: 0.2842 | Val  Acc: 0.9192
 Site-Sketch    | Val  Loss: 0.3609 | Val  Acc: 0.8784
 Site-QuickDraw | Val  Loss: 0.9612 | Val  Acc: 0.5303
 Site-QuickDraw | Val  Loss: 1.4604 | Val  Acc: 0.4747
 Site-Infograph | Val  Loss: 1.4667 | Val  Acc: 0.5455
Average Valid Accuracy: 0.8853
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.2819 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.3839 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.2578 | Train Acc: 0.9649
 Site-Clipart   | Train Loss: 0.2314 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1844 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.2465 | Train Acc: 0.9433
 Site-Clipart   | Train Loss: 0.2316 | Train Acc: 0.9416
 Site-Clipart   | Train Loss: 0.2141 | Train Acc: 0.9519
 Site-Real      | Train Loss: 0.2357 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.1033 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0820 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.0664 | Train Acc: 0.9767
 Site-Real      | Train Loss: 0.0704 | Train Acc: 0.9876
 Site-Painting  | Train Loss: 0.2437 | Train Acc: 0.9573
 Site-Painting  | Train Loss: 0.2230 | Train Acc: 0.9205
 Site-Painting  | Train Loss: 0.2461 | Train Acc: 0.9170
 Site-Sketch    | Train Loss: 0.4116 | Train Acc: 0.8658
 Site-Sketch    | Train Loss: 0.3694 | Train Acc: 0.9058
 Site-QuickDraw | Train Loss: 1.3739 | Train Acc: 0.5152
 Site-QuickDraw | Train Loss: 1.3986 | Train Acc: 0.4932
 Site-Infograph | Train Loss: 1.5552 | Train Acc: 0.4667
 Site-Clipart   | Val  Loss: 0.1572 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1079 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2007 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2351 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2134 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.1390 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.2263 | Val  Acc: 0.9485
 Site-Clipart   | Val  Loss: 0.3295 | Val  Acc: 0.9210
 Site-Real      | Val  Loss: 0.1119 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0392 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0484 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1125 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0874 | Val  Acc: 0.9720
 Site-Painting  | Val  Loss: 0.2259 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.3016 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.2521 | Val  Acc: 0.9318
 Site-Sketch    | Val  Loss: 0.3137 | Val  Acc: 0.8990
 Site-Sketch    | Val  Loss: 0.3614 | Val  Acc: 0.8649
 Site-QuickDraw | Val  Loss: 1.1463 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.4760 | Val  Acc: 0.4949
 Site-Infograph | Val  Loss: 1.4881 | Val  Acc: 0.4909
Average Valid Accuracy: 0.8865
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9535
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9535
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9485
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9210
 Best site-Real       | Epoch:22 | Val Acc: 0.9762
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Real       | Epoch:22 | Val Acc: 0.9790
 Best site-Real       | Epoch:22 | Val Acc: 0.9720
 Best site-Painting   | Epoch:22 | Val Acc: 0.9359
 Best site-Painting   | Epoch:22 | Val Acc: 0.9145
 Best site-Painting   | Epoch:22 | Val Acc: 0.9318
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8990
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8649
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.4949
 Best site-Infograph  | Epoch:22 | Val Acc: 0.4909
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.1921 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.3749 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.3314 | Train Acc: 0.9298
 Site-Clipart   | Train Loss: 0.2559 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1923 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.2282 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.2215 | Train Acc: 0.9622
 Site-Clipart   | Train Loss: 0.2022 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.2236 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1065 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1069 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.0706 | Train Acc: 0.9814
 Site-Real      | Train Loss: 0.1189 | Train Acc: 0.9876
 Site-Painting  | Train Loss: 0.2915 | Train Acc: 0.9231
 Site-Painting  | Train Loss: 0.2485 | Train Acc: 0.9261
 Site-Painting  | Train Loss: 0.2214 | Train Acc: 0.9472
 Site-Sketch    | Train Loss: 0.4100 | Train Acc: 0.8389
 Site-Sketch    | Train Loss: 0.3517 | Train Acc: 0.8924
 Site-QuickDraw | Train Loss: 1.3906 | Train Acc: 0.5657
 Site-QuickDraw | Train Loss: 1.3745 | Train Acc: 0.5338
 Site-Infograph | Train Loss: 1.5028 | Train Acc: 0.4909
 Site-Clipart   | Val  Loss: 0.1503 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1225 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1928 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2890 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.3122 | Val  Acc: 0.9302
 Site-Clipart   | Val  Loss: 0.1184 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.2561 | Val  Acc: 0.9588
 Site-Clipart   | Val  Loss: 0.2755 | Val  Acc: 0.9381
 Site-Real      | Val  Loss: 0.0934 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0537 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0479 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1394 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0791 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.2048 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.2645 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.2353 | Val  Acc: 0.9432
 Site-Sketch    | Val  Loss: 0.2725 | Val  Acc: 0.9293
 Site-Sketch    | Val  Loss: 0.3809 | Val  Acc: 0.8649
 Site-QuickDraw | Val  Loss: 1.0128 | Val  Acc: 0.5455
 Site-QuickDraw | Val  Loss: 1.3457 | Val  Acc: 0.5253
 Site-Infograph | Val  Loss: 1.3442 | Val  Acc: 0.5364
Average Valid Accuracy: 0.8941
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9302
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9690
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9588
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9381
 Best site-Real       | Epoch:23 | Val Acc: 0.9762
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Real       | Epoch:23 | Val Acc: 0.9790
 Best site-Real       | Epoch:23 | Val Acc: 0.9766
 Best site-Painting   | Epoch:23 | Val Acc: 0.9359
 Best site-Painting   | Epoch:23 | Val Acc: 0.9316
 Best site-Painting   | Epoch:23 | Val Acc: 0.9432
 Best site-Sketch     | Epoch:23 | Val Acc: 0.9293
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8649
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.5455
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.5253
 Best site-Infograph  | Epoch:23 | Val Acc: 0.5364
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.1434 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3780 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.2934 | Train Acc: 0.9474
 Site-Clipart   | Train Loss: 0.2478 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.2901 | Train Acc: 0.8992
 Site-Clipart   | Train Loss: 0.1945 | Train Acc: 0.9485
 Site-Clipart   | Train Loss: 0.2188 | Train Acc: 0.9588
 Site-Clipart   | Train Loss: 0.1902 | Train Acc: 0.9611
 Site-Real      | Train Loss: 0.2053 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0827 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1581 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.0706 | Train Acc: 0.9814
 Site-Real      | Train Loss: 0.2885 | Train Acc: 0.9876
 Site-Painting  | Train Loss: 0.2550 | Train Acc: 0.9402
 Site-Painting  | Train Loss: 0.2103 | Train Acc: 0.9432
 Site-Painting  | Train Loss: 0.2544 | Train Acc: 0.9358
 Site-Sketch    | Train Loss: 0.3824 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.3420 | Train Acc: 0.8879
 Site-QuickDraw | Train Loss: 1.3902 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 1.4033 | Train Acc: 0.5338
 Site-Infograph | Train Loss: 1.5149 | Train Acc: 0.4848
 Site-Clipart   | Val  Loss: 0.1950 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0783 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2108 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2587 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2080 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.1190 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.2376 | Val  Acc: 0.9330
 Site-Clipart   | Val  Loss: 0.2976 | Val  Acc: 0.9313
 Site-Real      | Val  Loss: 0.0773 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0383 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0418 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1118 | Val  Acc: 0.9720
 Site-Real      | Val  Loss: 0.0897 | Val  Acc: 0.9720
 Site-Painting  | Val  Loss: 0.2207 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.2468 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.2222 | Val  Acc: 0.9205
 Site-Sketch    | Val  Loss: 0.2490 | Val  Acc: 0.9394
 Site-Sketch    | Val  Loss: 0.2897 | Val  Acc: 0.8919
 Site-QuickDraw | Val  Loss: 1.0780 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.4555 | Val  Acc: 0.5152
 Site-Infograph | Val  Loss: 1.4555 | Val  Acc: 0.5273
Average Valid Accuracy: 0.8885
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.2154 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.4296 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.2940 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.1589 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.2046 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.1654 | Train Acc: 0.9588
 Site-Clipart   | Train Loss: 0.2185 | Train Acc: 0.9519
 Site-Clipart   | Train Loss: 0.1899 | Train Acc: 0.9611
 Site-Real      | Train Loss: 0.2496 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0877 | Train Acc: 0.9579
 Site-Real      | Train Loss: 0.0893 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.0988 | Train Acc: 0.9721
 Site-Real      | Train Loss: 0.0632 | Train Acc: 0.9876
 Site-Painting  | Train Loss: 0.2583 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.2287 | Train Acc: 0.9261
 Site-Painting  | Train Loss: 0.2184 | Train Acc: 0.9396
 Site-Sketch    | Train Loss: 0.4143 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.3121 | Train Acc: 0.9148
 Site-QuickDraw | Train Loss: 1.3328 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 1.3371 | Train Acc: 0.5676
 Site-Infograph | Train Loss: 1.4297 | Train Acc: 0.5152
 Site-Clipart   | Val  Loss: 0.1540 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1355 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.1646 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1860 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.1800 | Val  Acc: 0.9651
 Site-Clipart   | Val  Loss: 0.1067 | Val  Acc: 0.9612
 Site-Clipart   | Val  Loss: 0.1973 | Val  Acc: 0.9536
 Site-Clipart   | Val  Loss: 0.2588 | Val  Acc: 0.9347
 Site-Real      | Val  Loss: 0.1013 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0352 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0405 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0980 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0737 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.2457 | Val  Acc: 0.9103
 Site-Painting  | Val  Loss: 0.2565 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.2114 | Val  Acc: 0.9318
 Site-Sketch    | Val  Loss: 0.3513 | Val  Acc: 0.9293
 Site-Sketch    | Val  Loss: 0.3556 | Val  Acc: 0.8851
 Site-QuickDraw | Val  Loss: 0.9438 | Val  Acc: 0.5303
 Site-QuickDraw | Val  Loss: 1.4276 | Val  Acc: 0.5051
 Site-Infograph | Val  Loss: 1.3977 | Val  Acc: 0.5273
Average Valid Accuracy: 0.8889
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.1166 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3006 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2924 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.1722 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.2976 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.1791 | Train Acc: 0.9536
 Site-Clipart   | Train Loss: 0.2109 | Train Acc: 0.9416
 Site-Clipart   | Train Loss: 0.1793 | Train Acc: 0.9657
 Site-Real      | Train Loss: 0.2466 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0910 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.0752 | Train Acc: 0.9790
 Site-Real      | Train Loss: 0.0666 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0605 | Train Acc: 0.9907
 Site-Painting  | Train Loss: 0.2364 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.2466 | Train Acc: 0.9261
 Site-Painting  | Train Loss: 0.2043 | Train Acc: 0.9245
 Site-Sketch    | Train Loss: 0.3561 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.3390 | Train Acc: 0.9148
 Site-QuickDraw | Train Loss: 1.3938 | Train Acc: 0.6061
 Site-QuickDraw | Train Loss: 1.4098 | Train Acc: 0.5270
 Site-Infograph | Train Loss: 1.4698 | Train Acc: 0.5152
 Site-Clipart   | Val  Loss: 0.1523 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1183 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.1754 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.2042 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1799 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.1211 | Val  Acc: 0.9612
 Site-Clipart   | Val  Loss: 0.2750 | Val  Acc: 0.9485
 Site-Clipart   | Val  Loss: 0.2537 | Val  Acc: 0.9347
 Site-Real      | Val  Loss: 0.0829 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0248 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0404 | Val  Acc: 0.9895
 Site-Real      | Val  Loss: 0.1012 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0843 | Val  Acc: 0.9720
 Site-Painting  | Val  Loss: 0.1815 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.2456 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.2053 | Val  Acc: 0.9318
 Site-Sketch    | Val  Loss: 0.2591 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 0.3521 | Val  Acc: 0.8919
 Site-QuickDraw | Val  Loss: 0.8681 | Val  Acc: 0.5758
 Site-QuickDraw | Val  Loss: 1.3791 | Val  Acc: 0.4747
 Site-Infograph | Val  Loss: 1.4048 | Val  Acc: 0.5364
Average Valid Accuracy: 0.8917
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.1228 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3454 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2602 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.2239 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.1694 | Train Acc: 0.8992
 Site-Clipart   | Train Loss: 0.5407 | Train Acc: 0.9278
 Site-Clipart   | Train Loss: 0.1974 | Train Acc: 0.9519
 Site-Clipart   | Train Loss: 0.1869 | Train Acc: 0.9611
 Site-Real      | Train Loss: 0.2355 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1025 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.1154 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.0741 | Train Acc: 0.9814
 Site-Real      | Train Loss: 0.0519 | Train Acc: 0.9969
 Site-Painting  | Train Loss: 0.2720 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.2125 | Train Acc: 0.9545
 Site-Painting  | Train Loss: 0.2134 | Train Acc: 0.9434
 Site-Sketch    | Train Loss: 0.3620 | Train Acc: 0.8926
 Site-Sketch    | Train Loss: 0.3106 | Train Acc: 0.9148
 Site-QuickDraw | Train Loss: 1.4473 | Train Acc: 0.5152
 Site-QuickDraw | Train Loss: 1.4323 | Train Acc: 0.5541
 Site-Infograph | Train Loss: 1.5664 | Train Acc: 0.4848
 Site-Clipart   | Val  Loss: 0.2110 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0704 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2089 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2139 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.1865 | Val  Acc: 0.9651
 Site-Clipart   | Val  Loss: 0.1071 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.2329 | Val  Acc: 0.9381
 Site-Clipart   | Val  Loss: 0.2988 | Val  Acc: 0.9141
 Site-Real      | Val  Loss: 0.1097 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0558 | Val  Acc: 0.9895
 Site-Real      | Val  Loss: 0.0751 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0773 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.2273 | Val  Acc: 0.8846
 Site-Painting  | Val  Loss: 0.2992 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.2044 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2220 | Val  Acc: 0.9394
 Site-Sketch    | Val  Loss: 0.2626 | Val  Acc: 0.9122
 Site-QuickDraw | Val  Loss: 0.8492 | Val  Acc: 0.6061
 Site-QuickDraw | Val  Loss: 1.4603 | Val  Acc: 0.4848
 Site-Infograph | Val  Loss: 1.4270 | Val  Acc: 0.5091
Average Valid Accuracy: 0.8915
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.3097 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3629 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.2885 | Train Acc: 0.9298
 Site-Clipart   | Train Loss: 0.2906 | Train Acc: 0.8953
 Site-Clipart   | Train Loss: 0.2560 | Train Acc: 0.8992
 Site-Clipart   | Train Loss: 0.2172 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.1788 | Train Acc: 0.9485
 Site-Clipart   | Train Loss: 0.1775 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.2097 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1083 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0603 | Train Acc: 0.9790
 Site-Real      | Train Loss: 0.0692 | Train Acc: 0.9814
 Site-Real      | Train Loss: 0.1308 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.2912 | Train Acc: 0.9060
 Site-Painting  | Train Loss: 0.2004 | Train Acc: 0.9375
 Site-Painting  | Train Loss: 0.2240 | Train Acc: 0.9396
 Site-Sketch    | Train Loss: 0.4062 | Train Acc: 0.8658
 Site-Sketch    | Train Loss: 0.3944 | Train Acc: 0.8744
 Site-QuickDraw | Train Loss: 1.4278 | Train Acc: 0.5253
 Site-QuickDraw | Train Loss: 1.3103 | Train Acc: 0.5338
 Site-Infograph | Train Loss: 1.4699 | Train Acc: 0.4909
 Site-Clipart   | Val  Loss: 0.1274 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0530 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1871 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1690 | Val  Acc: 0.9649
 Site-Clipart   | Val  Loss: 0.2339 | Val  Acc: 0.9186
 Site-Clipart   | Val  Loss: 0.1233 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.2161 | Val  Acc: 0.9381
 Site-Clipart   | Val  Loss: 0.2468 | Val  Acc: 0.9313
 Site-Real      | Val  Loss: 0.0932 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0321 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0399 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0904 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0697 | Val  Acc: 0.9720
 Site-Painting  | Val  Loss: 0.1863 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.2780 | Val  Acc: 0.9060
 Site-Painting  | Val  Loss: 0.2434 | Val  Acc: 0.9205
 Site-Sketch    | Val  Loss: 0.2439 | Val  Acc: 0.9394
 Site-Sketch    | Val  Loss: 0.3472 | Val  Acc: 0.8649
 Site-QuickDraw | Val  Loss: 0.8998 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.3524 | Val  Acc: 0.5354
 Site-Infograph | Val  Loss: 1.5567 | Val  Acc: 0.4727
Average Valid Accuracy: 0.8929
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.1643 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.3719 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2880 | Train Acc: 0.9298
 Site-Clipart   | Train Loss: 0.1183 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.5631 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.1817 | Train Acc: 0.9485
 Site-Clipart   | Train Loss: 0.2248 | Train Acc: 0.9416
 Site-Clipart   | Train Loss: 0.1654 | Train Acc: 0.9680
 Site-Real      | Train Loss: 0.2109 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.1156 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0738 | Train Acc: 0.9790
 Site-Real      | Train Loss: 0.0582 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.1257 | Train Acc: 0.9907
 Site-Painting  | Train Loss: 0.2686 | Train Acc: 0.9231
 Site-Painting  | Train Loss: 0.1873 | Train Acc: 0.9489
 Site-Painting  | Train Loss: 0.2353 | Train Acc: 0.9396
 Site-Sketch    | Train Loss: 0.3760 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.3400 | Train Acc: 0.8879
 Site-QuickDraw | Train Loss: 1.3237 | Train Acc: 0.5253
 Site-QuickDraw | Train Loss: 1.4393 | Train Acc: 0.5203
 Site-Infograph | Train Loss: 1.5115 | Train Acc: 0.4970
 Site-Clipart   | Val  Loss: 0.1794 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0820 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1928 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2264 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.2026 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.1245 | Val  Acc: 0.9612
 Site-Clipart   | Val  Loss: 0.2254 | Val  Acc: 0.9588
 Site-Clipart   | Val  Loss: 0.2597 | Val  Acc: 0.9381
 Site-Real      | Val  Loss: 0.1072 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0731 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0809 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0637 | Val  Acc: 0.9813
 Site-Painting  | Val  Loss: 0.1873 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.2662 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.2040 | Val  Acc: 0.9489
 Site-Sketch    | Val  Loss: 0.2714 | Val  Acc: 0.9192
 Site-Sketch    | Val  Loss: 0.2949 | Val  Acc: 0.8784
 Site-QuickDraw | Val  Loss: 0.9442 | Val  Acc: 0.5303
 Site-QuickDraw | Val  Loss: 1.3543 | Val  Acc: 0.5253
 Site-Infograph | Val  Loss: 1.4355 | Val  Acc: 0.5091
Average Valid Accuracy: 0.8902
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.2952 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3878 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.2330 | Train Acc: 0.9474
 Site-Clipart   | Train Loss: 0.1692 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1444 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1697 | Train Acc: 0.9433
 Site-Clipart   | Train Loss: 0.1825 | Train Acc: 0.9588
 Site-Clipart   | Train Loss: 0.1629 | Train Acc: 0.9703
 Site-Real      | Train Loss: 0.2240 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0919 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0672 | Train Acc: 0.9790
 Site-Real      | Train Loss: 0.0565 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0579 | Train Acc: 0.9876
 Site-Painting  | Train Loss: 0.2496 | Train Acc: 0.9402
 Site-Painting  | Train Loss: 0.2497 | Train Acc: 0.9318
 Site-Painting  | Train Loss: 0.1563 | Train Acc: 0.9585
 Site-Sketch    | Train Loss: 0.3542 | Train Acc: 0.8926
 Site-Sketch    | Train Loss: 0.3919 | Train Acc: 0.8834
 Site-QuickDraw | Train Loss: 1.3997 | Train Acc: 0.4949
 Site-QuickDraw | Train Loss: 1.3503 | Train Acc: 0.5608
 Site-Infograph | Train Loss: 1.4424 | Train Acc: 0.4848
 Site-Clipart   | Val  Loss: 0.1705 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0954 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1753 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.2136 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.2153 | Val  Acc: 0.9419
 Site-Clipart   | Val  Loss: 0.1049 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.2132 | Val  Acc: 0.9485
 Site-Clipart   | Val  Loss: 0.2653 | Val  Acc: 0.9450
 Site-Real      | Val  Loss: 0.0784 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0270 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0723 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0730 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.1795 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.3203 | Val  Acc: 0.9060
 Site-Painting  | Val  Loss: 0.1822 | Val  Acc: 0.9261
 Site-Sketch    | Val  Loss: 0.2807 | Val  Acc: 0.9394
 Site-Sketch    | Val  Loss: 0.3633 | Val  Acc: 0.8514
 Site-QuickDraw | Val  Loss: 0.9591 | Val  Acc: 0.5758
 Site-QuickDraw | Val  Loss: 1.3887 | Val  Acc: 0.4646
 Site-Infograph | Val  Loss: 1.4582 | Val  Acc: 0.5364
Average Valid Accuracy: 0.8908
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.1514 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3763 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.2486 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.1801 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.1444 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1868 | Train Acc: 0.9278
 Site-Clipart   | Train Loss: 0.1965 | Train Acc: 0.9553
 Site-Clipart   | Train Loss: 0.1682 | Train Acc: 0.9611
 Site-Real      | Train Loss: 0.2360 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.0812 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0847 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.0487 | Train Acc: 0.9814
 Site-Real      | Train Loss: 0.0528 | Train Acc: 0.9907
 Site-Painting  | Train Loss: 0.2219 | Train Acc: 0.9402
 Site-Painting  | Train Loss: 0.2143 | Train Acc: 0.9432
 Site-Painting  | Train Loss: 0.1873 | Train Acc: 0.9472
 Site-Sketch    | Train Loss: 0.3662 | Train Acc: 0.8725
 Site-Sketch    | Train Loss: 0.3083 | Train Acc: 0.8969
 Site-QuickDraw | Train Loss: 1.3478 | Train Acc: 0.5354
 Site-QuickDraw | Train Loss: 1.2856 | Train Acc: 0.5405
 Site-Infograph | Train Loss: 1.5227 | Train Acc: 0.4667
 Site-Clipart   | Val  Loss: 0.1481 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0949 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1847 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2077 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1637 | Val  Acc: 0.9651
 Site-Clipart   | Val  Loss: 0.1199 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.2305 | Val  Acc: 0.9278
 Site-Clipart   | Val  Loss: 0.2660 | Val  Acc: 0.9175
 Site-Real      | Val  Loss: 0.0714 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0486 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0230 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0912 | Val  Acc: 0.9720
 Site-Real      | Val  Loss: 0.0660 | Val  Acc: 0.9813
 Site-Painting  | Val  Loss: 0.1455 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.2595 | Val  Acc: 0.9060
 Site-Painting  | Val  Loss: 0.1889 | Val  Acc: 0.9545
 Site-Sketch    | Val  Loss: 0.1912 | Val  Acc: 0.9596
 Site-Sketch    | Val  Loss: 0.2725 | Val  Acc: 0.9122
 Site-QuickDraw | Val  Loss: 0.8120 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.3284 | Val  Acc: 0.4848
 Site-Infograph | Val  Loss: 1.4801 | Val  Acc: 0.5273
Average Valid Accuracy: 0.8997
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9651
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9767
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9278
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9175
 Best site-Real       | Epoch:31 | Val Acc: 1.0000
 Best site-Real       | Epoch:31 | Val Acc: 1.0000
 Best site-Real       | Epoch:31 | Val Acc: 1.0000
 Best site-Real       | Epoch:31 | Val Acc: 0.9720
 Best site-Real       | Epoch:31 | Val Acc: 0.9813
 Best site-Painting   | Epoch:31 | Val Acc: 0.9359
 Best site-Painting   | Epoch:31 | Val Acc: 0.9060
 Best site-Painting   | Epoch:31 | Val Acc: 0.9545
 Best site-Sketch     | Epoch:31 | Val Acc: 0.9596
 Best site-Sketch     | Epoch:31 | Val Acc: 0.9122
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.6364
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.4848
 Best site-Infograph  | Epoch:31 | Val Acc: 0.5273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.2873 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3854 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2278 | Train Acc: 0.9474
 Site-Clipart   | Train Loss: 0.1629 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.1607 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1919 | Train Acc: 0.9433
 Site-Clipart   | Train Loss: 0.1965 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.1540 | Train Acc: 0.9771
 Site-Real      | Train Loss: 0.2137 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1086 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.0648 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0776 | Train Acc: 0.9814
 Site-Real      | Train Loss: 0.0470 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.2247 | Train Acc: 0.9487
 Site-Painting  | Train Loss: 0.1926 | Train Acc: 0.9545
 Site-Painting  | Train Loss: 0.1744 | Train Acc: 0.9472
 Site-Sketch    | Train Loss: 0.3293 | Train Acc: 0.8993
 Site-Sketch    | Train Loss: 0.2979 | Train Acc: 0.9148
 Site-QuickDraw | Train Loss: 1.3320 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.3716 | Train Acc: 0.5405
 Site-Infograph | Train Loss: 1.4825 | Train Acc: 0.5091
 Site-Clipart   | Val  Loss: 0.1468 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0384 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1776 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1998 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1782 | Val  Acc: 0.9651
 Site-Clipart   | Val  Loss: 0.0960 | Val  Acc: 0.9845
 Site-Clipart   | Val  Loss: 0.1855 | Val  Acc: 0.9433
 Site-Clipart   | Val  Loss: 0.2424 | Val  Acc: 0.9381
 Site-Real      | Val  Loss: 0.0582 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0286 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0309 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0657 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0536 | Val  Acc: 0.9860
 Site-Painting  | Val  Loss: 0.1722 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.2672 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.1855 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2199 | Val  Acc: 0.9596
 Site-Sketch    | Val  Loss: 0.3503 | Val  Acc: 0.8986
 Site-QuickDraw | Val  Loss: 0.8857 | Val  Acc: 0.6061
 Site-QuickDraw | Val  Loss: 1.3259 | Val  Acc: 0.5758
 Site-Infograph | Val  Loss: 1.4784 | Val  Acc: 0.5000
Average Valid Accuracy: 0.9036
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9651
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9845
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9433
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9381
 Best site-Real       | Epoch:32 | Val Acc: 1.0000
 Best site-Real       | Epoch:32 | Val Acc: 1.0000
 Best site-Real       | Epoch:32 | Val Acc: 1.0000
 Best site-Real       | Epoch:32 | Val Acc: 0.9860
 Best site-Real       | Epoch:32 | Val Acc: 0.9860
 Best site-Painting   | Epoch:32 | Val Acc: 0.9359
 Best site-Painting   | Epoch:32 | Val Acc: 0.9231
 Best site-Painting   | Epoch:32 | Val Acc: 0.9375
 Best site-Sketch     | Epoch:32 | Val Acc: 0.9596
 Best site-Sketch     | Epoch:32 | Val Acc: 0.8986
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.6061
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.5758
 Best site-Infograph  | Epoch:32 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.3350 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3684 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2422 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.1750 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1526 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.1798 | Train Acc: 0.9433
 Site-Clipart   | Train Loss: 0.1966 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.1451 | Train Acc: 0.9657
 Site-Real      | Train Loss: 0.1981 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0968 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1073 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.0476 | Train Acc: 0.9907
 Site-Real      | Train Loss: 0.0586 | Train Acc: 0.9969
 Site-Painting  | Train Loss: 0.2239 | Train Acc: 0.9487
 Site-Painting  | Train Loss: 0.1667 | Train Acc: 0.9489
 Site-Painting  | Train Loss: 0.1999 | Train Acc: 0.9472
 Site-Sketch    | Train Loss: 0.3407 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.4185 | Train Acc: 0.8789
 Site-QuickDraw | Train Loss: 1.1732 | Train Acc: 0.5758
 Site-QuickDraw | Train Loss: 1.3175 | Train Acc: 0.5135
 Site-Infograph | Train Loss: 1.4039 | Train Acc: 0.4909
 Site-Clipart   | Val  Loss: 0.2248 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.0688 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1730 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1901 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1715 | Val  Acc: 0.9419
 Site-Clipart   | Val  Loss: 0.0809 | Val  Acc: 0.9845
 Site-Clipart   | Val  Loss: 0.2063 | Val  Acc: 0.9330
 Site-Clipart   | Val  Loss: 0.2524 | Val  Acc: 0.9347
 Site-Real      | Val  Loss: 0.0590 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0370 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.0339 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0861 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0818 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.1716 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.1826 | Val  Acc: 0.9573
 Site-Painting  | Val  Loss: 0.2482 | Val  Acc: 0.9205
 Site-Sketch    | Val  Loss: 0.2820 | Val  Acc: 0.9495
 Site-Sketch    | Val  Loss: 0.2964 | Val  Acc: 0.8986
 Site-QuickDraw | Val  Loss: 1.2407 | Val  Acc: 0.6061
 Site-QuickDraw | Val  Loss: 1.3357 | Val  Acc: 0.5051
 Site-Infograph | Val  Loss: 1.5452 | Val  Acc: 0.5364
Average Valid Accuracy: 0.8971
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.3042 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2978 | Train Acc: 0.9211
 Site-Clipart   | Train Loss: 0.3319 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2173 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.1198 | Train Acc: 0.9457
 Site-Clipart   | Train Loss: 0.1785 | Train Acc: 0.9433
 Site-Clipart   | Train Loss: 0.1846 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.1612 | Train Acc: 0.9542
 Site-Real      | Train Loss: 0.2003 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.0927 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1303 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.0424 | Train Acc: 0.9953
 Site-Real      | Train Loss: 0.0459 | Train Acc: 0.9938
 Site-Painting  | Train Loss: 0.2244 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.2387 | Train Acc: 0.9375
 Site-Painting  | Train Loss: 0.2206 | Train Acc: 0.9396
 Site-Sketch    | Train Loss: 0.3664 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.3338 | Train Acc: 0.9058
 Site-QuickDraw | Train Loss: 1.2851 | Train Acc: 0.5657
 Site-QuickDraw | Train Loss: 1.2378 | Train Acc: 0.5135
 Site-Infograph | Train Loss: 1.5029 | Train Acc: 0.4667
 Site-Clipart   | Val  Loss: 0.2073 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.1234 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.1486 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.2401 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.1554 | Val  Acc: 0.9651
 Site-Clipart   | Val  Loss: 0.0990 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.2190 | Val  Acc: 0.9588
 Site-Clipart   | Val  Loss: 0.2430 | Val  Acc: 0.9381
 Site-Real      | Val  Loss: 0.0636 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0441 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.0317 | Val  Acc: 0.9895
 Site-Real      | Val  Loss: 0.0765 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0814 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.2160 | Val  Acc: 0.9103
 Site-Painting  | Val  Loss: 0.1972 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2135 | Val  Acc: 0.9432
 Site-Sketch    | Val  Loss: 0.2703 | Val  Acc: 0.9192
 Site-Sketch    | Val  Loss: 0.2803 | Val  Acc: 0.8851
 Site-QuickDraw | Val  Loss: 0.9954 | Val  Acc: 0.6061
 Site-QuickDraw | Val  Loss: 1.3358 | Val  Acc: 0.5455
 Site-Infograph | Val  Loss: 1.5367 | Val  Acc: 0.4727
Average Valid Accuracy: 0.8921
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.3611 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3165 | Train Acc: 0.9211
 Site-Clipart   | Train Loss: 0.2312 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.1787 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.1620 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.1469 | Train Acc: 0.9588
 Site-Clipart   | Train Loss: 0.1836 | Train Acc: 0.9519
 Site-Clipart   | Train Loss: 0.1368 | Train Acc: 0.9725
 Site-Real      | Train Loss: 0.2116 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0697 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.1132 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.0606 | Train Acc: 0.9814
 Site-Real      | Train Loss: 0.0320 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.2319 | Train Acc: 0.9231
 Site-Painting  | Train Loss: 0.1924 | Train Acc: 0.9375
 Site-Painting  | Train Loss: 0.1768 | Train Acc: 0.9547
 Site-Sketch    | Train Loss: 0.2987 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.2766 | Train Acc: 0.9193
 Site-QuickDraw | Train Loss: 1.3079 | Train Acc: 0.5758
 Site-QuickDraw | Train Loss: 1.2670 | Train Acc: 0.5676
 Site-Infograph | Train Loss: 1.4164 | Train Acc: 0.5273
 Site-Clipart   | Val  Loss: 0.1873 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0539 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1461 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.1823 | Val  Acc: 0.9649
 Site-Clipart   | Val  Loss: 0.1958 | Val  Acc: 0.9186
 Site-Clipart   | Val  Loss: 0.1148 | Val  Acc: 0.9612
 Site-Clipart   | Val  Loss: 0.2784 | Val  Acc: 0.9330
 Site-Clipart   | Val  Loss: 0.2166 | Val  Acc: 0.9450
 Site-Real      | Val  Loss: 0.0571 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0210 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0324 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0654 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0518 | Val  Acc: 0.9813
 Site-Painting  | Val  Loss: 0.1740 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.1903 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.1936 | Val  Acc: 0.9489
 Site-Sketch    | Val  Loss: 0.2541 | Val  Acc: 0.9394
 Site-Sketch    | Val  Loss: 0.2966 | Val  Acc: 0.8986
 Site-QuickDraw | Val  Loss: 1.0390 | Val  Acc: 0.5152
 Site-QuickDraw | Val  Loss: 1.3071 | Val  Acc: 0.5556
 Site-Infograph | Val  Loss: 1.4433 | Val  Acc: 0.4909
Average Valid Accuracy: 0.8961
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.3233 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2504 | Train Acc: 0.9211
 Site-Clipart   | Train Loss: 0.2871 | Train Acc: 0.9298
 Site-Clipart   | Train Loss: 0.2693 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1825 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.1793 | Train Acc: 0.9381
 Site-Clipart   | Train Loss: 0.1487 | Train Acc: 0.9519
 Site-Clipart   | Train Loss: 0.1440 | Train Acc: 0.9657
 Site-Real      | Train Loss: 0.2197 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0742 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1354 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.0493 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0395 | Train Acc: 0.9969
 Site-Painting  | Train Loss: 0.2514 | Train Acc: 0.9145
 Site-Painting  | Train Loss: 0.1867 | Train Acc: 0.9489
 Site-Painting  | Train Loss: 0.1557 | Train Acc: 0.9623
 Site-Sketch    | Train Loss: 0.3677 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.2413 | Train Acc: 0.9193
 Site-QuickDraw | Train Loss: 1.3715 | Train Acc: 0.5657
 Site-QuickDraw | Train Loss: 1.2884 | Train Acc: 0.5203
 Site-Infograph | Train Loss: 1.4543 | Train Acc: 0.5212
 Site-Clipart   | Val  Loss: 0.1719 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0551 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1824 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1631 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1770 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.0999 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.1835 | Val  Acc: 0.9330
 Site-Clipart   | Val  Loss: 0.2601 | Val  Acc: 0.9107
 Site-Real      | Val  Loss: 0.0482 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0445 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.0200 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0576 | Val  Acc: 0.9930
 Site-Real      | Val  Loss: 0.0476 | Val  Acc: 0.9813
 Site-Painting  | Val  Loss: 0.1716 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.2241 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.1699 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2681 | Val  Acc: 0.9192
 Site-Sketch    | Val  Loss: 0.2863 | Val  Acc: 0.9054
 Site-QuickDraw | Val  Loss: 1.0410 | Val  Acc: 0.5606
 Site-QuickDraw | Val  Loss: 1.2668 | Val  Acc: 0.5758
 Site-Infograph | Val  Loss: 1.4147 | Val  Acc: 0.5091
Average Valid Accuracy: 0.8973
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.1862 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2322 | Train Acc: 0.9474
 Site-Clipart   | Train Loss: 0.2561 | Train Acc: 0.9298
 Site-Clipart   | Train Loss: 0.1774 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.1767 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.3407 | Train Acc: 0.9330
 Site-Clipart   | Train Loss: 0.1591 | Train Acc: 0.9519
 Site-Clipart   | Train Loss: 0.1405 | Train Acc: 0.9703
 Site-Real      | Train Loss: 0.1822 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.0512 | Train Acc: 0.9895
 Site-Real      | Train Loss: 0.1258 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.0519 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0347 | Train Acc: 0.9969
 Site-Painting  | Train Loss: 0.2284 | Train Acc: 0.9231
 Site-Painting  | Train Loss: 0.2309 | Train Acc: 0.9489
 Site-Painting  | Train Loss: 0.1569 | Train Acc: 0.9434
 Site-Sketch    | Train Loss: 0.4113 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.2492 | Train Acc: 0.9238
 Site-QuickDraw | Train Loss: 1.3213 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 1.3176 | Train Acc: 0.5338
 Site-Infograph | Train Loss: 1.4496 | Train Acc: 0.4909
 Site-Clipart   | Val  Loss: 0.1033 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0753 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1865 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.1818 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.1551 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.1115 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.1840 | Val  Acc: 0.9639
 Site-Clipart   | Val  Loss: 0.2255 | Val  Acc: 0.9450
 Site-Real      | Val  Loss: 0.0545 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0143 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0363 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0630 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0492 | Val  Acc: 0.9860
 Site-Painting  | Val  Loss: 0.1800 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2090 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.1851 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2649 | Val  Acc: 0.9192
 Site-Sketch    | Val  Loss: 0.2995 | Val  Acc: 0.8919
 Site-QuickDraw | Val  Loss: 1.1062 | Val  Acc: 0.5909
 Site-QuickDraw | Val  Loss: 1.2596 | Val  Acc: 0.5657
 Site-Infograph | Val  Loss: 1.4261 | Val  Acc: 0.5364
Average Valid Accuracy: 0.9044
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9211
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9298
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9767
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9690
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9639
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9450
 Best site-Real       | Epoch:37 | Val Acc: 1.0000
 Best site-Real       | Epoch:37 | Val Acc: 1.0000
 Best site-Real       | Epoch:37 | Val Acc: 1.0000
 Best site-Real       | Epoch:37 | Val Acc: 0.9790
 Best site-Real       | Epoch:37 | Val Acc: 0.9860
 Best site-Painting   | Epoch:37 | Val Acc: 0.9487
 Best site-Painting   | Epoch:37 | Val Acc: 0.9316
 Best site-Painting   | Epoch:37 | Val Acc: 0.9375
 Best site-Sketch     | Epoch:37 | Val Acc: 0.9192
 Best site-Sketch     | Epoch:37 | Val Acc: 0.8919
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.5909
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.5657
 Best site-Infograph  | Epoch:37 | Val Acc: 0.5364
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.1401 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.3357 | Train Acc: 0.9211
 Site-Clipart   | Train Loss: 0.2541 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.1474 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.1822 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.2358 | Train Acc: 0.9433
 Site-Clipart   | Train Loss: 0.1789 | Train Acc: 0.9416
 Site-Clipart   | Train Loss: 0.1386 | Train Acc: 0.9703
 Site-Real      | Train Loss: 0.2097 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1086 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1399 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.0503 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0335 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1719 | Train Acc: 0.9573
 Site-Painting  | Train Loss: 0.1863 | Train Acc: 0.9375
 Site-Painting  | Train Loss: 0.2126 | Train Acc: 0.9547
 Site-Sketch    | Train Loss: 0.2978 | Train Acc: 0.9128
 Site-Sketch    | Train Loss: 0.2691 | Train Acc: 0.9058
 Site-QuickDraw | Train Loss: 1.2287 | Train Acc: 0.6061
 Site-QuickDraw | Train Loss: 1.3163 | Train Acc: 0.5608
 Site-Infograph | Train Loss: 1.4499 | Train Acc: 0.5212
 Site-Clipart   | Val  Loss: 0.0978 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0831 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1538 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.1455 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1631 | Val  Acc: 0.9651
 Site-Clipart   | Val  Loss: 0.1024 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.1940 | Val  Acc: 0.9536
 Site-Clipart   | Val  Loss: 0.2187 | Val  Acc: 0.9416
 Site-Real      | Val  Loss: 0.0823 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0455 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0392 | Val  Acc: 0.9895
 Site-Real      | Val  Loss: 0.0691 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0536 | Val  Acc: 0.9860
 Site-Painting  | Val  Loss: 0.1664 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.2305 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.1963 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2737 | Val  Acc: 0.9394
 Site-Sketch    | Val  Loss: 0.2663 | Val  Acc: 0.8851
 Site-QuickDraw | Val  Loss: 1.1599 | Val  Acc: 0.5606
 Site-QuickDraw | Val  Loss: 1.3576 | Val  Acc: 0.4848
 Site-Infograph | Val  Loss: 1.4786 | Val  Acc: 0.4909
Average Valid Accuracy: 0.8933
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.2051 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3096 | Train Acc: 0.9211
 Site-Clipart   | Train Loss: 0.1987 | Train Acc: 0.9649
 Site-Clipart   | Train Loss: 0.1923 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1388 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.1740 | Train Acc: 0.9691
 Site-Clipart   | Train Loss: 0.1744 | Train Acc: 0.9519
 Site-Clipart   | Train Loss: 0.1202 | Train Acc: 0.9748
 Site-Real      | Train Loss: 0.2137 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0874 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0752 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.0626 | Train Acc: 0.9907
 Site-Real      | Train Loss: 0.0379 | Train Acc: 0.9969
 Site-Painting  | Train Loss: 0.2341 | Train Acc: 0.9402
 Site-Painting  | Train Loss: 0.1789 | Train Acc: 0.9602
 Site-Painting  | Train Loss: 0.2002 | Train Acc: 0.9472
 Site-Sketch    | Train Loss: 0.4903 | Train Acc: 0.8456
 Site-Sketch    | Train Loss: 0.2842 | Train Acc: 0.9193
 Site-QuickDraw | Train Loss: 1.3305 | Train Acc: 0.5758
 Site-QuickDraw | Train Loss: 1.3049 | Train Acc: 0.5541
 Site-Infograph | Train Loss: 1.4463 | Train Acc: 0.4727
 Site-Clipart   | Val  Loss: 0.1761 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0463 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1611 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1933 | Val  Acc: 0.9649
 Site-Clipart   | Val  Loss: 0.1511 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.1073 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.1475 | Val  Acc: 0.9639
 Site-Clipart   | Val  Loss: 0.2615 | Val  Acc: 0.9313
 Site-Real      | Val  Loss: 0.0755 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0293 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0269 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0673 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0564 | Val  Acc: 0.9860
 Site-Painting  | Val  Loss: 0.1396 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2008 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.1811 | Val  Acc: 0.9318
 Site-Sketch    | Val  Loss: 0.2619 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 0.3579 | Val  Acc: 0.8851
 Site-QuickDraw | Val  Loss: 1.0148 | Val  Acc: 0.5152
 Site-QuickDraw | Val  Loss: 1.2697 | Val  Acc: 0.5657
 Site-Infograph | Val  Loss: 1.4409 | Val  Acc: 0.5182
Average Valid Accuracy: 0.8968
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.3339 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2749 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2572 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.1911 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.1441 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.2442 | Train Acc: 0.9485
 Site-Clipart   | Train Loss: 0.1784 | Train Acc: 0.9519
 Site-Clipart   | Train Loss: 0.1171 | Train Acc: 0.9771
 Site-Real      | Train Loss: 0.1755 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0561 | Train Acc: 0.9895
 Site-Real      | Train Loss: 0.0853 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.0642 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0369 | Train Acc: 0.9969
 Site-Painting  | Train Loss: 0.2284 | Train Acc: 0.9487
 Site-Painting  | Train Loss: 0.1985 | Train Acc: 0.9489
 Site-Painting  | Train Loss: 0.1569 | Train Acc: 0.9509
 Site-Sketch    | Train Loss: 0.2556 | Train Acc: 0.9195
 Site-Sketch    | Train Loss: 0.3000 | Train Acc: 0.9058
 Site-QuickDraw | Train Loss: 1.3453 | Train Acc: 0.5758
 Site-QuickDraw | Train Loss: 1.2898 | Train Acc: 0.5878
 Site-Infograph | Train Loss: 1.4080 | Train Acc: 0.5576
 Site-Clipart   | Val  Loss: 0.1157 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0748 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1842 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.1409 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1803 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.0658 | Val  Acc: 0.9845
 Site-Clipart   | Val  Loss: 0.1787 | Val  Acc: 0.9485
 Site-Clipart   | Val  Loss: 0.2480 | Val  Acc: 0.9416
 Site-Real      | Val  Loss: 0.0600 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0338 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.0246 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0579 | Val  Acc: 0.9930
 Site-Real      | Val  Loss: 0.0757 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.1620 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.1888 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2011 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2854 | Val  Acc: 0.9293
 Site-Sketch    | Val  Loss: 0.3060 | Val  Acc: 0.8784
 Site-QuickDraw | Val  Loss: 0.8443 | Val  Acc: 0.5909
 Site-QuickDraw | Val  Loss: 1.3213 | Val  Acc: 0.5152
 Site-Infograph | Val  Loss: 1.4628 | Val  Acc: 0.4727
Average Valid Accuracy: 0.8935
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.1644 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.3175 | Train Acc: 0.9211
 Site-Clipart   | Train Loss: 0.3048 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.1422 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.1875 | Train Acc: 0.9457
 Site-Clipart   | Train Loss: 0.2531 | Train Acc: 0.9021
 Site-Clipart   | Train Loss: 0.1736 | Train Acc: 0.9553
 Site-Clipart   | Train Loss: 0.1349 | Train Acc: 0.9657
 Site-Real      | Train Loss: 0.1878 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0668 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1242 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.0449 | Train Acc: 0.9907
 Site-Real      | Train Loss: 0.0428 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1901 | Train Acc: 0.9487
 Site-Painting  | Train Loss: 0.1570 | Train Acc: 0.9659
 Site-Painting  | Train Loss: 0.1645 | Train Acc: 0.9547
 Site-Sketch    | Train Loss: 0.3933 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.2338 | Train Acc: 0.9238
 Site-QuickDraw | Train Loss: 1.3612 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 1.2675 | Train Acc: 0.5608
 Site-Infograph | Train Loss: 1.4468 | Train Acc: 0.5091
 Site-Clipart   | Val  Loss: 0.0766 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0583 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1432 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.1358 | Val  Acc: 0.9649
 Site-Clipart   | Val  Loss: 0.1163 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.0906 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.1683 | Val  Acc: 0.9485
 Site-Clipart   | Val  Loss: 0.2480 | Val  Acc: 0.9278
 Site-Real      | Val  Loss: 0.0527 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0162 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0300 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0788 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0628 | Val  Acc: 0.9813
 Site-Painting  | Val  Loss: 0.1921 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.1644 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.1888 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.2329 | Val  Acc: 0.9394
 Site-Sketch    | Val  Loss: 0.3126 | Val  Acc: 0.8581
 Site-QuickDraw | Val  Loss: 0.8281 | Val  Acc: 0.5606
 Site-QuickDraw | Val  Loss: 1.3426 | Val  Acc: 0.5253
 Site-Infograph | Val  Loss: 1.5107 | Val  Acc: 0.4818
Average Valid Accuracy: 0.8986
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.2587 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3478 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2352 | Train Acc: 0.9649
 Site-Clipart   | Train Loss: 0.2774 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.1468 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.1637 | Train Acc: 0.9536
 Site-Clipart   | Train Loss: 0.1666 | Train Acc: 0.9588
 Site-Clipart   | Train Loss: 0.1230 | Train Acc: 0.9703
 Site-Real      | Train Loss: 0.1959 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0881 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1047 | Train Acc: 0.9790
 Site-Real      | Train Loss: 0.0454 | Train Acc: 0.9907
 Site-Real      | Train Loss: 0.0374 | Train Acc: 0.9876
 Site-Painting  | Train Loss: 0.1830 | Train Acc: 0.9487
 Site-Painting  | Train Loss: 0.2070 | Train Acc: 0.9375
 Site-Painting  | Train Loss: 0.1236 | Train Acc: 0.9660
 Site-Sketch    | Train Loss: 0.3297 | Train Acc: 0.9128
 Site-Sketch    | Train Loss: 0.2661 | Train Acc: 0.9103
 Site-QuickDraw | Train Loss: 1.2613 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 1.3286 | Train Acc: 0.5676
 Site-Infograph | Train Loss: 1.3848 | Train Acc: 0.5333
 Site-Clipart   | Val  Loss: 0.1389 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0647 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1547 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1713 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1903 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.0857 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.1767 | Val  Acc: 0.9691
 Site-Clipart   | Val  Loss: 0.2450 | Val  Acc: 0.9278
 Site-Real      | Val  Loss: 0.0706 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0329 | Val  Acc: 0.9895
 Site-Real      | Val  Loss: 0.0696 | Val  Acc: 0.9930
 Site-Real      | Val  Loss: 0.0474 | Val  Acc: 0.9860
 Site-Painting  | Val  Loss: 0.1819 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.2184 | Val  Acc: 0.9402
 Site-Painting  | Val  Loss: 0.1692 | Val  Acc: 0.9489
 Site-Sketch    | Val  Loss: 0.2218 | Val  Acc: 0.9394
 Site-Sketch    | Val  Loss: 0.2761 | Val  Acc: 0.8986
 Site-QuickDraw | Val  Loss: 0.8200 | Val  Acc: 0.5758
 Site-QuickDraw | Val  Loss: 1.3452 | Val  Acc: 0.4747
 Site-Infograph | Val  Loss: 1.4279 | Val  Acc: 0.5273
Average Valid Accuracy: 0.8966
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.2240 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3269 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.1952 | Train Acc: 0.9825
 Site-Clipart   | Train Loss: 0.1620 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1593 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.2080 | Train Acc: 0.9536
 Site-Clipart   | Train Loss: 0.1713 | Train Acc: 0.9519
 Site-Clipart   | Train Loss: 0.1169 | Train Acc: 0.9817
 Site-Real      | Train Loss: 0.2456 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0812 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0724 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.0419 | Train Acc: 0.9907
 Site-Real      | Train Loss: 0.1187 | Train Acc: 0.9938
 Site-Painting  | Train Loss: 0.2433 | Train Acc: 0.9402
 Site-Painting  | Train Loss: 0.2189 | Train Acc: 0.9545
 Site-Painting  | Train Loss: 0.1589 | Train Acc: 0.9585
 Site-Sketch    | Train Loss: 0.3389 | Train Acc: 0.9128
 Site-Sketch    | Train Loss: 0.2195 | Train Acc: 0.9238
 Site-QuickDraw | Train Loss: 1.3120 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 1.3468 | Train Acc: 0.5405
 Site-Infograph | Train Loss: 1.3604 | Train Acc: 0.5394
 Site-Clipart   | Val  Loss: 0.1494 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0949 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.1552 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1570 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1372 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.0740 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.1635 | Val  Acc: 0.9536
 Site-Clipart   | Val  Loss: 0.2100 | Val  Acc: 0.9416
 Site-Real      | Val  Loss: 0.0603 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0326 | Val  Acc: 0.9895
 Site-Real      | Val  Loss: 0.0699 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0479 | Val  Acc: 0.9860
 Site-Painting  | Val  Loss: 0.1809 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.1912 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.1535 | Val  Acc: 0.9489
 Site-Sketch    | Val  Loss: 0.2959 | Val  Acc: 0.9293
 Site-Sketch    | Val  Loss: 0.2953 | Val  Acc: 0.8784
 Site-QuickDraw | Val  Loss: 0.8545 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.2654 | Val  Acc: 0.5354
 Site-Infograph | Val  Loss: 1.4007 | Val  Acc: 0.5455
Average Valid Accuracy: 0.8993
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.0642 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3118 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.1522 | Train Acc: 0.9825
 Site-Clipart   | Train Loss: 0.1867 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.4012 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.1525 | Train Acc: 0.9639
 Site-Clipart   | Train Loss: 0.1607 | Train Acc: 0.9485
 Site-Clipart   | Train Loss: 0.1175 | Train Acc: 0.9817
 Site-Real      | Train Loss: 0.2327 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.0573 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0955 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.0421 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0308 | Train Acc: 0.9969
 Site-Painting  | Train Loss: 0.2484 | Train Acc: 0.9487
 Site-Painting  | Train Loss: 0.1840 | Train Acc: 0.9432
 Site-Painting  | Train Loss: 0.1400 | Train Acc: 0.9623
 Site-Sketch    | Train Loss: 0.3755 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.3224 | Train Acc: 0.8789
 Site-QuickDraw | Train Loss: 1.2780 | Train Acc: 0.5859
 Site-QuickDraw | Train Loss: 1.2392 | Train Acc: 0.5743
 Site-Infograph | Train Loss: 1.4095 | Train Acc: 0.5333
 Site-Clipart   | Val  Loss: 0.1202 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0634 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1119 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.1467 | Val  Acc: 0.9649
 Site-Clipart   | Val  Loss: 0.1418 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.0830 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.1374 | Val  Acc: 0.9691
 Site-Clipart   | Val  Loss: 0.2079 | Val  Acc: 0.9416
 Site-Real      | Val  Loss: 0.0624 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0279 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0698 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0602 | Val  Acc: 0.9813
 Site-Painting  | Val  Loss: 0.1604 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.1952 | Val  Acc: 0.9658
 Site-Painting  | Val  Loss: 0.1502 | Val  Acc: 0.9602
 Site-Sketch    | Val  Loss: 0.1955 | Val  Acc: 0.9394
 Site-Sketch    | Val  Loss: 0.3325 | Val  Acc: 0.8986
 Site-QuickDraw | Val  Loss: 0.7880 | Val  Acc: 0.6212
 Site-QuickDraw | Val  Loss: 1.3358 | Val  Acc: 0.5354
 Site-Infograph | Val  Loss: 1.4319 | Val  Acc: 0.5364
Average Valid Accuracy: 0.9100
 Best site-Clipart    | Epoch:44 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:44 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:44 | Val Acc: 0.9737
 Best site-Clipart    | Epoch:44 | Val Acc: 0.9649
 Best site-Clipart    | Epoch:44 | Val Acc: 0.9767
 Best site-Clipart    | Epoch:44 | Val Acc: 0.9690
 Best site-Clipart    | Epoch:44 | Val Acc: 0.9691
 Best site-Clipart    | Epoch:44 | Val Acc: 0.9416
 Best site-Real       | Epoch:44 | Val Acc: 0.9762
 Best site-Real       | Epoch:44 | Val Acc: 1.0000
 Best site-Real       | Epoch:44 | Val Acc: 1.0000
 Best site-Real       | Epoch:44 | Val Acc: 0.9860
 Best site-Real       | Epoch:44 | Val Acc: 0.9813
 Best site-Painting   | Epoch:44 | Val Acc: 0.9744
 Best site-Painting   | Epoch:44 | Val Acc: 0.9658
 Best site-Painting   | Epoch:44 | Val Acc: 0.9602
 Best site-Sketch     | Epoch:44 | Val Acc: 0.9394
 Best site-Sketch     | Epoch:44 | Val Acc: 0.8986
 Best site-QuickDraw  | Epoch:44 | Val Acc: 0.6212
 Best site-QuickDraw  | Epoch:44 | Val Acc: 0.5354
 Best site-Infograph  | Epoch:44 | Val Acc: 0.5364
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.2460 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3474 | Train Acc: 0.9474
 Site-Clipart   | Train Loss: 0.2693 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.1604 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.1329 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1528 | Train Acc: 0.9536
 Site-Clipart   | Train Loss: 0.1547 | Train Acc: 0.9622
 Site-Clipart   | Train Loss: 0.1339 | Train Acc: 0.9771
 Site-Real      | Train Loss: 0.2135 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0587 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.1542 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.0487 | Train Acc: 0.9953
 Site-Real      | Train Loss: 0.0458 | Train Acc: 0.9938
 Site-Painting  | Train Loss: 0.2504 | Train Acc: 0.9231
 Site-Painting  | Train Loss: 0.1781 | Train Acc: 0.9545
 Site-Painting  | Train Loss: 0.1405 | Train Acc: 0.9472
 Site-Sketch    | Train Loss: 0.3452 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.2321 | Train Acc: 0.9058
 Site-QuickDraw | Train Loss: 1.2398 | Train Acc: 0.6162
 Site-QuickDraw | Train Loss: 1.1886 | Train Acc: 0.5743
 Site-Infograph | Train Loss: 1.3890 | Train Acc: 0.5394
 Site-Clipart   | Val  Loss: 0.1256 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0592 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1103 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.1862 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.1545 | Val  Acc: 0.9651
 Site-Clipart   | Val  Loss: 0.0770 | Val  Acc: 0.9845
 Site-Clipart   | Val  Loss: 0.1364 | Val  Acc: 0.9691
 Site-Clipart   | Val  Loss: 0.2082 | Val  Acc: 0.9416
 Site-Real      | Val  Loss: 0.0591 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0246 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0670 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0627 | Val  Acc: 0.9720
 Site-Painting  | Val  Loss: 0.1330 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.1876 | Val  Acc: 0.9402
 Site-Painting  | Val  Loss: 0.2159 | Val  Acc: 0.9261
 Site-Sketch    | Val  Loss: 0.2722 | Val  Acc: 0.9394
 Site-Sketch    | Val  Loss: 0.2074 | Val  Acc: 0.9122
 Site-QuickDraw | Val  Loss: 1.1498 | Val  Acc: 0.6061
 Site-QuickDraw | Val  Loss: 1.2840 | Val  Acc: 0.5354
 Site-Infograph | Val  Loss: 1.3263 | Val  Acc: 0.5545
Average Valid Accuracy: 0.9039
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.0980 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2726 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.1923 | Train Acc: 0.9649
 Site-Clipart   | Train Loss: 0.3088 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.2848 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.1692 | Train Acc: 0.9433
 Site-Clipart   | Train Loss: 0.1436 | Train Acc: 0.9622
 Site-Clipart   | Train Loss: 0.1167 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.2089 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.1130 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.1166 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.0541 | Train Acc: 0.9814
 Site-Real      | Train Loss: 0.0444 | Train Acc: 0.9938
 Site-Painting  | Train Loss: 0.1874 | Train Acc: 0.9487
 Site-Painting  | Train Loss: 0.1365 | Train Acc: 0.9716
 Site-Painting  | Train Loss: 0.1259 | Train Acc: 0.9660
 Site-Sketch    | Train Loss: 0.3623 | Train Acc: 0.8926
 Site-Sketch    | Train Loss: 0.2487 | Train Acc: 0.9103
 Site-QuickDraw | Train Loss: 1.3164 | Train Acc: 0.5758
 Site-QuickDraw | Train Loss: 1.1688 | Train Acc: 0.6149
 Site-Infograph | Train Loss: 1.3590 | Train Acc: 0.5455
 Site-Clipart   | Val  Loss: 0.0917 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0320 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0880 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.1627 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.1767 | Val  Acc: 0.9535
 Site-Clipart   | Val  Loss: 0.0889 | Val  Acc: 0.9690
 Site-Clipart   | Val  Loss: 0.1751 | Val  Acc: 0.9588
 Site-Clipart   | Val  Loss: 0.1924 | Val  Acc: 0.9519
 Site-Real      | Val  Loss: 0.0492 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0131 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0210 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0421 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0810 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.1249 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.2292 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.1717 | Val  Acc: 0.9659
 Site-Sketch    | Val  Loss: 0.2028 | Val  Acc: 0.9293
 Site-Sketch    | Val  Loss: 0.2699 | Val  Acc: 0.9054
 Site-QuickDraw | Val  Loss: 0.7243 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.2789 | Val  Acc: 0.5657
 Site-Infograph | Val  Loss: 1.4547 | Val  Acc: 0.5182
Average Valid Accuracy: 0.9098
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.0729 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3129 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2772 | Train Acc: 0.9298
 Site-Clipart   | Train Loss: 0.2040 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.1394 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.2173 | Train Acc: 0.9536
 Site-Clipart   | Train Loss: 0.1535 | Train Acc: 0.9622
 Site-Clipart   | Train Loss: 0.1106 | Train Acc: 0.9748
 Site-Real      | Train Loss: 0.2085 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.1026 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.2119 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.0575 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0315 | Train Acc: 0.9969
 Site-Painting  | Train Loss: 0.2674 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.1843 | Train Acc: 0.9489
 Site-Painting  | Train Loss: 0.1687 | Train Acc: 0.9396
 Site-Sketch    | Train Loss: 0.3185 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.3114 | Train Acc: 0.9058
 Site-QuickDraw | Train Loss: 1.3408 | Train Acc: 0.5859
 Site-QuickDraw | Train Loss: 1.2139 | Train Acc: 0.6149
 Site-Infograph | Train Loss: 1.3618 | Train Acc: 0.5091
 Site-Clipart   | Val  Loss: 0.1545 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.0557 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1333 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2028 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.1513 | Val  Acc: 0.9651
 Site-Clipart   | Val  Loss: 0.0722 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.1408 | Val  Acc: 0.9536
 Site-Clipart   | Val  Loss: 0.2164 | Val  Acc: 0.9416
 Site-Real      | Val  Loss: 0.0508 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0187 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0583 | Val  Acc: 0.9930
 Site-Real      | Val  Loss: 0.0598 | Val  Acc: 0.9813
 Site-Painting  | Val  Loss: 0.1407 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.1417 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.1627 | Val  Acc: 0.9716
 Site-Sketch    | Val  Loss: 0.2317 | Val  Acc: 0.9293
 Site-Sketch    | Val  Loss: 0.2909 | Val  Acc: 0.9122
 Site-QuickDraw | Val  Loss: 0.7489 | Val  Acc: 0.6061
 Site-QuickDraw | Val  Loss: 1.3221 | Val  Acc: 0.5051
 Site-Infograph | Val  Loss: 1.3693 | Val  Acc: 0.5636
Average Valid Accuracy: 0.9031
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.3387 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3322 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.2336 | Train Acc: 0.9649
 Site-Clipart   | Train Loss: 0.3035 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.1505 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.1303 | Train Acc: 0.9742
 Site-Clipart   | Train Loss: 0.1394 | Train Acc: 0.9656
 Site-Clipart   | Train Loss: 0.1166 | Train Acc: 0.9771
 Site-Real      | Train Loss: 0.2095 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.1029 | Train Acc: 0.9789
 Site-Real      | Train Loss: 0.0509 | Train Acc: 0.9790
 Site-Real      | Train Loss: 0.0441 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0307 | Train Acc: 0.9969
 Site-Painting  | Train Loss: 0.1805 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.1699 | Train Acc: 0.9432
 Site-Painting  | Train Loss: 0.1298 | Train Acc: 0.9623
 Site-Sketch    | Train Loss: 0.3007 | Train Acc: 0.8926
 Site-Sketch    | Train Loss: 0.2795 | Train Acc: 0.9148
 Site-QuickDraw | Train Loss: 1.3086 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.1148 | Train Acc: 0.5878
 Site-Infograph | Train Loss: 1.3999 | Train Acc: 0.5152
 Site-Clipart   | Val  Loss: 0.1143 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0358 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1426 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1786 | Val  Acc: 0.9649
 Site-Clipart   | Val  Loss: 0.1434 | Val  Acc: 0.9767
 Site-Clipart   | Val  Loss: 0.0740 | Val  Acc: 0.9845
 Site-Clipart   | Val  Loss: 0.1830 | Val  Acc: 0.9485
 Site-Clipart   | Val  Loss: 0.1920 | Val  Acc: 0.9588
 Site-Real      | Val  Loss: 0.0636 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0235 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0196 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1070 | Val  Acc: 0.9790
 Site-Real      | Val  Loss: 0.0453 | Val  Acc: 0.9860
 Site-Painting  | Val  Loss: 0.1371 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.1757 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.1587 | Val  Acc: 0.9602
 Site-Sketch    | Val  Loss: 0.2030 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 0.2978 | Val  Acc: 0.8986
 Site-QuickDraw | Val  Loss: 1.2324 | Val  Acc: 0.6212
 Site-QuickDraw | Val  Loss: 1.2103 | Val  Acc: 0.5859
 Site-Infograph | Val  Loss: 1.4038 | Val  Acc: 0.5545
Average Valid Accuracy: 0.9104
 Best site-Clipart    | Epoch:48 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:48 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:48 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:48 | Val Acc: 0.9649
 Best site-Clipart    | Epoch:48 | Val Acc: 0.9767
 Best site-Clipart    | Epoch:48 | Val Acc: 0.9845
 Best site-Clipart    | Epoch:48 | Val Acc: 0.9485
 Best site-Clipart    | Epoch:48 | Val Acc: 0.9588
 Best site-Real       | Epoch:48 | Val Acc: 0.9762
 Best site-Real       | Epoch:48 | Val Acc: 1.0000
 Best site-Real       | Epoch:48 | Val Acc: 1.0000
 Best site-Real       | Epoch:48 | Val Acc: 0.9790
 Best site-Real       | Epoch:48 | Val Acc: 0.9860
 Best site-Painting   | Epoch:48 | Val Acc: 0.9359
 Best site-Painting   | Epoch:48 | Val Acc: 0.9316
 Best site-Painting   | Epoch:48 | Val Acc: 0.9602
 Best site-Sketch     | Epoch:48 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:48 | Val Acc: 0.8986
 Best site-QuickDraw  | Epoch:48 | Val Acc: 0.6212
 Best site-QuickDraw  | Epoch:48 | Val Acc: 0.5859
 Best site-Infograph  | Epoch:48 | Val Acc: 0.5545
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.0745 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2614 | Train Acc: 0.9474
 Site-Clipart   | Train Loss: 0.2814 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.1781 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.1904 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.1230 | Train Acc: 0.9639
 Site-Clipart   | Train Loss: 0.1429 | Train Acc: 0.9691
 Site-Clipart   | Train Loss: 0.1263 | Train Acc: 0.9748
 Site-Real      | Train Loss: 0.1848 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.0562 | Train Acc: 0.9895
 Site-Real      | Train Loss: 0.0487 | Train Acc: 0.9860
 Site-Real      | Train Loss: 0.0374 | Train Acc: 0.9953
 Site-Real      | Train Loss: 0.0292 | Train Acc: 0.9938
 Site-Painting  | Train Loss: 0.2581 | Train Acc: 0.9402
 Site-Painting  | Train Loss: 0.1524 | Train Acc: 0.9432
 Site-Painting  | Train Loss: 0.1595 | Train Acc: 0.9660
 Site-Sketch    | Train Loss: 0.2507 | Train Acc: 0.8926
 Site-Sketch    | Train Loss: 0.2661 | Train Acc: 0.9103
 Site-QuickDraw | Train Loss: 1.3179 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.3012 | Train Acc: 0.5608
 Site-Infograph | Train Loss: 1.4520 | Train Acc: 0.5091
 Site-Clipart   | Val  Loss: 0.1592 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1436 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.1209 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.1077 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.1441 | Val  Acc: 0.9651
 Site-Clipart   | Val  Loss: 0.0964 | Val  Acc: 0.9612
 Site-Clipart   | Val  Loss: 0.1503 | Val  Acc: 0.9536
 Site-Clipart   | Val  Loss: 0.2074 | Val  Acc: 0.9485
 Site-Real      | Val  Loss: 0.0557 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.0337 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0266 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0511 | Val  Acc: 0.9860
 Site-Real      | Val  Loss: 0.0726 | Val  Acc: 0.9766
 Site-Painting  | Val  Loss: 0.1304 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.1292 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.1827 | Val  Acc: 0.9602
 Site-Sketch    | Val  Loss: 0.2721 | Val  Acc: 0.9293
 Site-Sketch    | Val  Loss: 0.2344 | Val  Acc: 0.9122
 Site-QuickDraw | Val  Loss: 0.7498 | Val  Acc: 0.7273
 Site-QuickDraw | Val  Loss: 1.1650 | Val  Acc: 0.5960
 Site-Infograph | Val  Loss: 1.4733 | Val  Acc: 0.5000
Average Valid Accuracy: 0.9125
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9737
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9651
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9612
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9536
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9485
 Best site-Real       | Epoch:49 | Val Acc: 0.9762
 Best site-Real       | Epoch:49 | Val Acc: 1.0000
 Best site-Real       | Epoch:49 | Val Acc: 1.0000
 Best site-Real       | Epoch:49 | Val Acc: 0.9860
 Best site-Real       | Epoch:49 | Val Acc: 0.9766
 Best site-Painting   | Epoch:49 | Val Acc: 0.9744
 Best site-Painting   | Epoch:49 | Val Acc: 0.9744
 Best site-Painting   | Epoch:49 | Val Acc: 0.9602
 Best site-Sketch     | Epoch:49 | Val Acc: 0.9293
 Best site-Sketch     | Epoch:49 | Val Acc: 0.9122
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.7273
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.5960
 Best site-Infograph  | Epoch:49 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/harmo-fl...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.9411
 Test site-Real      | Epoch:49 | Test Acc: 0.9614
 Test site-Painting  | Epoch:49 | Test Acc: 0.9338
 Test site-Sketch    | Epoch:49 | Test Acc: 0.9043
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.6220
 Test site-Infograph | Epoch:49 | Test Acc: 0.5099
Average Test Accuracy: 0.8121
===2023-05-12 13:28:21===
===2023-05-12 13:28:36===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[25,38,57,86,129,194,291,437,63,95,143,215,322,117,176,265,149,223,99,148,165,
client_nums=[8,5,3,2,2,1,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.9411
 Test site-Real      | Epoch:49 | Test Acc: 0.9614
 Test site-Painting  | Epoch:49 | Test Acc: 0.9338
 Test site-Sketch    | Epoch:49 | Test Acc: 0.9043
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.6220
 Test site-Infograph | Epoch:49 | Test Acc: 0.5099
Average Test Accuracy: 0.8121
