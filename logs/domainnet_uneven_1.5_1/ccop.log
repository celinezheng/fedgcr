===2023-05-11 19:24:18===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[25,38,57,86,129,194,291,437,63,95,143,215,322,117,176,265,149,223,99,148,165,
client_nums=[8,5,3,2,2,1,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-5
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[7, 2, 8, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 2.1197 | Train Acc: 0.3200
 Site-Clipart   | Train Loss: 2.2103 | Train Acc: 0.1842
 Site-Clipart   | Train Loss: 2.0982 | Train Acc: 0.2807
 Site-Clipart   | Train Loss: 2.0237 | Train Acc: 0.2674
 Site-Clipart   | Train Loss: 2.0590 | Train Acc: 0.2713
 Site-Clipart   | Train Loss: 2.0725 | Train Acc: 0.2113
 Site-Clipart   | Train Loss: 2.0952 | Train Acc: 0.2543
 Site-Clipart   | Train Loss: 2.1344 | Train Acc: 0.2426
 Site-Real      | Train Loss: 2.1387 | Train Acc: 0.2857
 Site-Real      | Train Loss: 2.1307 | Train Acc: 0.3053
 Site-Real      | Train Loss: 2.1153 | Train Acc: 0.3427
 Site-Real      | Train Loss: 2.0733 | Train Acc: 0.3163
 Site-Real      | Train Loss: 2.0348 | Train Acc: 0.2609
 Site-Painting  | Train Loss: 2.1585 | Train Acc: 0.2564
 Site-Painting  | Train Loss: 2.1817 | Train Acc: 0.2784
 Site-Painting  | Train Loss: 2.0890 | Train Acc: 0.3283
 Site-Sketch    | Train Loss: 2.0513 | Train Acc: 0.3289
 Site-Sketch    | Train Loss: 2.0848 | Train Acc: 0.2915
 Site-QuickDraw | Train Loss: 2.3290 | Train Acc: 0.0909
 Site-QuickDraw | Train Loss: 2.3275 | Train Acc: 0.0811
 Site-Infograph | Train Loss: 2.2700 | Train Acc: 0.1394
 Site-Clipart   | Val  Loss: 2.0211 | Val  Acc: 0.2941
 Site-Clipart   | Val  Loss: 1.9300 | Val  Acc: 0.2800
 Site-Clipart   | Val  Loss: 2.1320 | Val  Acc: 0.2632
 Site-Clipart   | Val  Loss: 2.1027 | Val  Acc: 0.2632
 Site-Clipart   | Val  Loss: 2.0932 | Val  Acc: 0.1977
 Site-Clipart   | Val  Loss: 2.2558 | Val  Acc: 0.2868
 Site-Clipart   | Val  Loss: 2.1681 | Val  Acc: 0.2577
 Site-Clipart   | Val  Loss: 2.1165 | Val  Acc: 0.2646
 Site-Real      | Val  Loss: 2.2048 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 2.1001 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 2.0789 | Val  Acc: 0.3474
 Site-Real      | Val  Loss: 2.1009 | Val  Acc: 0.3007
 Site-Real      | Val  Loss: 2.0534 | Val  Acc: 0.3505
 Site-Painting  | Val  Loss: 2.0664 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 2.1087 | Val  Acc: 0.3248
 Site-Painting  | Val  Loss: 2.1355 | Val  Acc: 0.3182
 Site-Sketch    | Val  Loss: 2.0108 | Val  Acc: 0.3434
 Site-Sketch    | Val  Loss: 2.0953 | Val  Acc: 0.2568
 Site-QuickDraw | Val  Loss: 2.2894 | Val  Acc: 0.1061
 Site-QuickDraw | Val  Loss: 2.3064 | Val  Acc: 0.0909
 Site-Infograph | Val  Loss: 2.2795 | Val  Acc: 0.1818
Average Valid Accuracy: 0.2648
Aggregated Acc | Val Acc: 0.2361
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2941
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2800
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2632
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2632
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1977
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2868
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2577
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2646
 Best site-Real       | Epoch:0 | Val Acc: 0.2143
 Best site-Real       | Epoch:0 | Val Acc: 0.2857
 Best site-Real       | Epoch:0 | Val Acc: 0.3474
 Best site-Real       | Epoch:0 | Val Acc: 0.3007
 Best site-Real       | Epoch:0 | Val Acc: 0.3505
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-Painting   | Epoch:0 | Val Acc: 0.3248
 Best site-Painting   | Epoch:0 | Val Acc: 0.3182
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3434
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2568
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1061
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0909
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[8, 2, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.8963 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.9049 | Train Acc: 0.3947
 Site-Clipart   | Train Loss: 1.8597 | Train Acc: 0.5439
 Site-Clipart   | Train Loss: 1.7980 | Train Acc: 0.5233
 Site-Clipart   | Train Loss: 1.6067 | Train Acc: 0.4419
 Site-Clipart   | Train Loss: 1.9308 | Train Acc: 0.4021
 Site-Clipart   | Train Loss: 1.8449 | Train Acc: 0.5052
 Site-Clipart   | Train Loss: 1.8699 | Train Acc: 0.4897
 Site-Real      | Train Loss: 1.8137 | Train Acc: 0.5556
 Site-Real      | Train Loss: 1.8556 | Train Acc: 0.5579
 Site-Real      | Train Loss: 1.7589 | Train Acc: 0.6014
 Site-Real      | Train Loss: 1.7727 | Train Acc: 0.6047
 Site-Real      | Train Loss: 1.8034 | Train Acc: 0.5280
 Site-Painting  | Train Loss: 1.9265 | Train Acc: 0.4530
 Site-Painting  | Train Loss: 1.8705 | Train Acc: 0.4943
 Site-Painting  | Train Loss: 1.8455 | Train Acc: 0.5321
 Site-Sketch    | Train Loss: 1.8138 | Train Acc: 0.5302
 Site-Sketch    | Train Loss: 1.8352 | Train Acc: 0.4798
 Site-QuickDraw | Train Loss: 2.3263 | Train Acc: 0.1313
 Site-QuickDraw | Train Loss: 2.2609 | Train Acc: 0.1216
 Site-Infograph | Train Loss: 2.1815 | Train Acc: 0.2364
 Site-Clipart   | Val  Loss: 1.7020 | Val  Acc: 0.5882
 Site-Clipart   | Val  Loss: 1.6328 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.8636 | Val  Acc: 0.4737
 Site-Clipart   | Val  Loss: 1.8146 | Val  Acc: 0.5439
 Site-Clipart   | Val  Loss: 1.8825 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9654 | Val  Acc: 0.5116
 Site-Clipart   | Val  Loss: 1.9086 | Val  Acc: 0.4639
 Site-Clipart   | Val  Loss: 1.8911 | Val  Acc: 0.4708
 Site-Real      | Val  Loss: 1.8330 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 1.7064 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 1.7006 | Val  Acc: 0.6211
 Site-Real      | Val  Loss: 1.8017 | Val  Acc: 0.6014
 Site-Real      | Val  Loss: 1.7299 | Val  Acc: 0.6121
 Site-Painting  | Val  Loss: 1.7781 | Val  Acc: 0.5256
 Site-Painting  | Val  Loss: 1.8421 | Val  Acc: 0.4957
 Site-Painting  | Val  Loss: 1.8334 | Val  Acc: 0.4830
 Site-Sketch    | Val  Loss: 1.7423 | Val  Acc: 0.5455
 Site-Sketch    | Val  Loss: 1.8604 | Val  Acc: 0.4527
 Site-QuickDraw | Val  Loss: 2.2771 | Val  Acc: 0.1515
 Site-QuickDraw | Val  Loss: 2.3016 | Val  Acc: 0.1010
 Site-Infograph | Val  Loss: 2.1525 | Val  Acc: 0.2818
Average Valid Accuracy: 0.4902
Aggregated Acc | Val Acc: 0.4238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5882
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4737
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5439
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5116
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4639
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4708
 Best site-Real       | Epoch:1 | Val Acc: 0.4762
 Best site-Real       | Epoch:1 | Val Acc: 0.7143
 Best site-Real       | Epoch:1 | Val Acc: 0.6211
 Best site-Real       | Epoch:1 | Val Acc: 0.6014
 Best site-Real       | Epoch:1 | Val Acc: 0.6121
 Best site-Painting   | Epoch:1 | Val Acc: 0.5256
 Best site-Painting   | Epoch:1 | Val Acc: 0.4957
 Best site-Painting   | Epoch:1 | Val Acc: 0.4830
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5455
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4527
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1515
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1010
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2818
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-0
cnt=[8, 2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.6098 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6970 | Train Acc: 0.5263
 Site-Clipart   | Train Loss: 1.6623 | Train Acc: 0.5789
 Site-Clipart   | Train Loss: 1.5234 | Train Acc: 0.6977
 Site-Clipart   | Train Loss: 1.6573 | Train Acc: 0.6124
 Site-Clipart   | Train Loss: 1.8045 | Train Acc: 0.5825
 Site-Clipart   | Train Loss: 1.6120 | Train Acc: 0.6598
 Site-Clipart   | Train Loss: 1.6515 | Train Acc: 0.6293
 Site-Real      | Train Loss: 1.6156 | Train Acc: 0.7778
 Site-Real      | Train Loss: 1.5781 | Train Acc: 0.6947
 Site-Real      | Train Loss: 1.4926 | Train Acc: 0.7692
 Site-Real      | Train Loss: 1.4904 | Train Acc: 0.7628
 Site-Real      | Train Loss: 1.5672 | Train Acc: 0.7329
 Site-Painting  | Train Loss: 1.6627 | Train Acc: 0.6325
 Site-Painting  | Train Loss: 1.6364 | Train Acc: 0.6136
 Site-Painting  | Train Loss: 1.5111 | Train Acc: 0.7019
 Site-Sketch    | Train Loss: 1.5786 | Train Acc: 0.6242
 Site-Sketch    | Train Loss: 1.6444 | Train Acc: 0.5830
 Site-QuickDraw | Train Loss: 2.2193 | Train Acc: 0.1919
 Site-QuickDraw | Train Loss: 2.2559 | Train Acc: 0.1689
 Site-Infograph | Train Loss: 2.0596 | Train Acc: 0.3758
 Site-Clipart   | Val  Loss: 1.4627 | Val  Acc: 0.8235
 Site-Clipart   | Val  Loss: 1.4027 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.6023 | Val  Acc: 0.6579
 Site-Clipart   | Val  Loss: 1.6347 | Val  Acc: 0.6491
 Site-Clipart   | Val  Loss: 1.5852 | Val  Acc: 0.6860
 Site-Clipart   | Val  Loss: 1.9170 | Val  Acc: 0.6589
 Site-Clipart   | Val  Loss: 1.7520 | Val  Acc: 0.6443
 Site-Clipart   | Val  Loss: 1.6739 | Val  Acc: 0.5911
 Site-Real      | Val  Loss: 1.5462 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 1.3607 | Val  Acc: 0.8254
 Site-Real      | Val  Loss: 1.4198 | Val  Acc: 0.7789
 Site-Real      | Val  Loss: 1.5195 | Val  Acc: 0.7413
 Site-Real      | Val  Loss: 1.3902 | Val  Acc: 0.7617
 Site-Painting  | Val  Loss: 1.4801 | Val  Acc: 0.6538
 Site-Painting  | Val  Loss: 1.5856 | Val  Acc: 0.6325
 Site-Painting  | Val  Loss: 1.5721 | Val  Acc: 0.6591
 Site-Sketch    | Val  Loss: 1.5503 | Val  Acc: 0.6162
 Site-Sketch    | Val  Loss: 1.6167 | Val  Acc: 0.5743
 Site-QuickDraw | Val  Loss: 2.1917 | Val  Acc: 0.1515
 Site-QuickDraw | Val  Loss: 2.2509 | Val  Acc: 0.1818
 Site-Infograph | Val  Loss: 2.0301 | Val  Acc: 0.3636
Average Valid Accuracy: 0.6280
Aggregated Acc | Val Acc: 0.6072
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8235
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6579
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6491
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6860
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6589
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6443
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5911
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Real       | Epoch:2 | Val Acc: 0.8254
 Best site-Real       | Epoch:2 | Val Acc: 0.7789
 Best site-Real       | Epoch:2 | Val Acc: 0.7413
 Best site-Real       | Epoch:2 | Val Acc: 0.7617
 Best site-Painting   | Epoch:2 | Val Acc: 0.6538
 Best site-Painting   | Epoch:2 | Val Acc: 0.6325
 Best site-Painting   | Epoch:2 | Val Acc: 0.6591
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6162
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5743
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1515
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1818
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 3 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-4
client-17 is in G-4
client-18 is in G-2
client-19 is in G-2
client-20 is in G-5
cnt=[8, 5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.3527 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.4750 | Train Acc: 0.5789
 Site-Clipart   | Train Loss: 1.4466 | Train Acc: 0.6842
 Site-Clipart   | Train Loss: 1.3536 | Train Acc: 0.7326
 Site-Clipart   | Train Loss: 1.4102 | Train Acc: 0.7364
 Site-Clipart   | Train Loss: 1.3065 | Train Acc: 0.6753
 Site-Clipart   | Train Loss: 1.3770 | Train Acc: 0.7045
 Site-Clipart   | Train Loss: 1.4265 | Train Acc: 0.7208
 Site-Real      | Train Loss: 1.3208 | Train Acc: 0.8095
 Site-Real      | Train Loss: 1.2582 | Train Acc: 0.8000
 Site-Real      | Train Loss: 1.1544 | Train Acc: 0.8322
 Site-Real      | Train Loss: 1.2049 | Train Acc: 0.8419
 Site-Real      | Train Loss: 1.2337 | Train Acc: 0.8416
 Site-Painting  | Train Loss: 1.3871 | Train Acc: 0.7009
 Site-Painting  | Train Loss: 1.3934 | Train Acc: 0.7102
 Site-Painting  | Train Loss: 1.2232 | Train Acc: 0.7396
 Site-Sketch    | Train Loss: 1.3944 | Train Acc: 0.7047
 Site-Sketch    | Train Loss: 1.3972 | Train Acc: 0.6726
 Site-QuickDraw | Train Loss: 2.1831 | Train Acc: 0.2323
 Site-QuickDraw | Train Loss: 2.2162 | Train Acc: 0.2162
 Site-Infograph | Train Loss: 1.9882 | Train Acc: 0.3697
 Site-Clipart   | Val  Loss: 1.2257 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 1.1254 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 1.3750 | Val  Acc: 0.7632
 Site-Clipart   | Val  Loss: 1.4516 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3892 | Val  Acc: 0.7674
 Site-Clipart   | Val  Loss: 1.5699 | Val  Acc: 0.7829
 Site-Clipart   | Val  Loss: 1.5133 | Val  Acc: 0.6804
 Site-Clipart   | Val  Loss: 1.4639 | Val  Acc: 0.6907
 Site-Real      | Val  Loss: 1.3378 | Val  Acc: 0.7619
 Site-Real      | Val  Loss: 1.0842 | Val  Acc: 0.8889
 Site-Real      | Val  Loss: 1.1144 | Val  Acc: 0.8632
 Site-Real      | Val  Loss: 1.2463 | Val  Acc: 0.8182
 Site-Real      | Val  Loss: 1.1417 | Val  Acc: 0.8551
 Site-Painting  | Val  Loss: 1.3206 | Val  Acc: 0.7051
 Site-Painting  | Val  Loss: 1.3429 | Val  Acc: 0.7265
 Site-Painting  | Val  Loss: 1.3497 | Val  Acc: 0.7443
 Site-Sketch    | Val  Loss: 1.3043 | Val  Acc: 0.7071
 Site-Sketch    | Val  Loss: 1.3988 | Val  Acc: 0.5946
 Site-QuickDraw | Val  Loss: 2.2846 | Val  Acc: 0.1970
 Site-QuickDraw | Val  Loss: 2.2792 | Val  Acc: 0.1515
 Site-Infograph | Val  Loss: 1.8777 | Val  Acc: 0.4636
Average Valid Accuracy: 0.6948
Aggregated Acc | Val Acc: 0.6026
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7632
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7674
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7829
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6804
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6907
 Best site-Real       | Epoch:3 | Val Acc: 0.7619
 Best site-Real       | Epoch:3 | Val Acc: 0.8889
 Best site-Real       | Epoch:3 | Val Acc: 0.8632
 Best site-Real       | Epoch:3 | Val Acc: 0.8182
 Best site-Real       | Epoch:3 | Val Acc: 0.8551
 Best site-Painting   | Epoch:3 | Val Acc: 0.7051
 Best site-Painting   | Epoch:3 | Val Acc: 0.7265
 Best site-Painting   | Epoch:3 | Val Acc: 0.7443
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7071
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5946
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1970
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1515
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4636
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 4 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-1
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-0
client-17 is in G-0
client-18 is in G-2
client-19 is in G-2
client-20 is in G-4
cnt=[2, 5, 2, 8, 1, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.2196 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.2595 | Train Acc: 0.6579
 Site-Clipart   | Train Loss: 1.2854 | Train Acc: 0.7544
 Site-Clipart   | Train Loss: 1.1399 | Train Acc: 0.7907
 Site-Clipart   | Train Loss: 1.3868 | Train Acc: 0.8217
 Site-Clipart   | Train Loss: 1.2806 | Train Acc: 0.7526
 Site-Clipart   | Train Loss: 1.1937 | Train Acc: 0.7560
 Site-Clipart   | Train Loss: 1.2410 | Train Acc: 0.7666
 Site-Real      | Train Loss: 1.0763 | Train Acc: 0.8571
 Site-Real      | Train Loss: 1.0751 | Train Acc: 0.8421
 Site-Real      | Train Loss: 0.9174 | Train Acc: 0.8811
 Site-Real      | Train Loss: 0.9688 | Train Acc: 0.8605
 Site-Real      | Train Loss: 0.9483 | Train Acc: 0.8820
 Site-Painting  | Train Loss: 1.1931 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 1.1940 | Train Acc: 0.7330
 Site-Painting  | Train Loss: 1.1759 | Train Acc: 0.7887
 Site-Sketch    | Train Loss: 1.1532 | Train Acc: 0.7383
 Site-Sketch    | Train Loss: 1.2406 | Train Acc: 0.7265
 Site-QuickDraw | Train Loss: 2.1523 | Train Acc: 0.2525
 Site-QuickDraw | Train Loss: 2.1636 | Train Acc: 0.2365
 Site-Infograph | Train Loss: 1.8932 | Train Acc: 0.4242
 Site-Clipart   | Val  Loss: 1.0377 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.9093 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 1.3552 | Val  Acc: 0.6842
 Site-Clipart   | Val  Loss: 1.1997 | Val  Acc: 0.7544
 Site-Clipart   | Val  Loss: 1.1950 | Val  Acc: 0.7791
 Site-Clipart   | Val  Loss: 1.3916 | Val  Acc: 0.8140
 Site-Clipart   | Val  Loss: 1.3593 | Val  Acc: 0.7526
 Site-Clipart   | Val  Loss: 1.2971 | Val  Acc: 0.7010
 Site-Real      | Val  Loss: 1.0710 | Val  Acc: 0.8333
 Site-Real      | Val  Loss: 0.8358 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.9078 | Val  Acc: 0.8737
 Site-Real      | Val  Loss: 1.0190 | Val  Acc: 0.8671
 Site-Real      | Val  Loss: 0.9156 | Val  Acc: 0.8692
 Site-Painting  | Val  Loss: 1.1242 | Val  Acc: 0.7436
 Site-Painting  | Val  Loss: 1.1527 | Val  Acc: 0.7607
 Site-Painting  | Val  Loss: 1.1248 | Val  Acc: 0.8068
 Site-Sketch    | Val  Loss: 1.1517 | Val  Acc: 0.7374
 Site-Sketch    | Val  Loss: 1.2359 | Val  Acc: 0.6554
 Site-QuickDraw | Val  Loss: 2.0947 | Val  Acc: 0.2121
 Site-QuickDraw | Val  Loss: 2.2436 | Val  Acc: 0.1919
 Site-Infograph | Val  Loss: 1.7398 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7293
Aggregated Acc | Val Acc: 0.6393
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6842
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7544
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7791
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8140
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7526
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7010
 Best site-Real       | Epoch:4 | Val Acc: 0.8333
 Best site-Real       | Epoch:4 | Val Acc: 0.9365
 Best site-Real       | Epoch:4 | Val Acc: 0.8737
 Best site-Real       | Epoch:4 | Val Acc: 0.8671
 Best site-Real       | Epoch:4 | Val Acc: 0.8692
 Best site-Painting   | Epoch:4 | Val Acc: 0.7436
 Best site-Painting   | Epoch:4 | Val Acc: 0.7607
 Best site-Painting   | Epoch:4 | Val Acc: 0.8068
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7374
 Best site-Sketch     | Epoch:4 | Val Acc: 0.6554
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2121
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1919
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 5 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-5
client-17 is in G-5
client-18 is in G-0
client-19 is in G-0
client-20 is in G-3
cnt=[2, 8, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.9604 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.1421 | Train Acc: 0.7368
 Site-Clipart   | Train Loss: 1.1320 | Train Acc: 0.7544
 Site-Clipart   | Train Loss: 0.9673 | Train Acc: 0.8140
 Site-Clipart   | Train Loss: 1.6010 | Train Acc: 0.8295
 Site-Clipart   | Train Loss: 1.0340 | Train Acc: 0.7577
 Site-Clipart   | Train Loss: 1.0374 | Train Acc: 0.8007
 Site-Clipart   | Train Loss: 1.0607 | Train Acc: 0.8124
 Site-Real      | Train Loss: 0.9208 | Train Acc: 0.8571
 Site-Real      | Train Loss: 0.9471 | Train Acc: 0.8842
 Site-Real      | Train Loss: 0.7720 | Train Acc: 0.9161
 Site-Real      | Train Loss: 0.8608 | Train Acc: 0.9163
 Site-Real      | Train Loss: 0.8408 | Train Acc: 0.8913
 Site-Painting  | Train Loss: 1.0451 | Train Acc: 0.8034
 Site-Painting  | Train Loss: 1.0214 | Train Acc: 0.7898
 Site-Painting  | Train Loss: 0.9879 | Train Acc: 0.8151
 Site-Sketch    | Train Loss: 1.0094 | Train Acc: 0.7852
 Site-Sketch    | Train Loss: 1.0695 | Train Acc: 0.7354
 Site-QuickDraw | Train Loss: 2.0816 | Train Acc: 0.2727
 Site-QuickDraw | Train Loss: 2.1109 | Train Acc: 0.2297
 Site-Infograph | Train Loss: 1.8081 | Train Acc: 0.3939
 Site-Clipart   | Val  Loss: 0.8775 | Val  Acc: 0.8235
 Site-Clipart   | Val  Loss: 0.7554 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 1.1071 | Val  Acc: 0.7368
 Site-Clipart   | Val  Loss: 1.0715 | Val  Acc: 0.7895
 Site-Clipart   | Val  Loss: 1.0219 | Val  Acc: 0.7791
 Site-Clipart   | Val  Loss: 1.1704 | Val  Acc: 0.8295
 Site-Clipart   | Val  Loss: 1.0977 | Val  Acc: 0.7938
 Site-Clipart   | Val  Loss: 1.1284 | Val  Acc: 0.7560
 Site-Real      | Val  Loss: 0.9637 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 0.7678 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.7696 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 0.8881 | Val  Acc: 0.8811
 Site-Real      | Val  Loss: 0.7624 | Val  Acc: 0.9019
 Site-Painting  | Val  Loss: 0.9873 | Val  Acc: 0.7564
 Site-Painting  | Val  Loss: 1.0187 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 0.9729 | Val  Acc: 0.7784
 Site-Sketch    | Val  Loss: 1.0240 | Val  Acc: 0.7273
 Site-Sketch    | Val  Loss: 1.0926 | Val  Acc: 0.6824
 Site-QuickDraw | Val  Loss: 2.0323 | Val  Acc: 0.2727
 Site-QuickDraw | Val  Loss: 2.2045 | Val  Acc: 0.2121
 Site-Infograph | Val  Loss: 1.6389 | Val  Acc: 0.5182
Average Valid Accuracy: 0.7425
Aggregated Acc | Val Acc: 0.6546
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8235
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7368
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7895
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7791
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8295
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7938
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7560
 Best site-Real       | Epoch:5 | Val Acc: 0.8571
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Real       | Epoch:5 | Val Acc: 0.8947
 Best site-Real       | Epoch:5 | Val Acc: 0.8811
 Best site-Real       | Epoch:5 | Val Acc: 0.9019
 Best site-Painting   | Epoch:5 | Val Acc: 0.7564
 Best site-Painting   | Epoch:5 | Val Acc: 0.7778
 Best site-Painting   | Epoch:5 | Val Acc: 0.7784
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7273
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6824
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2727
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2121
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5182
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 6 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-5
client-17 is in G-5
client-18 is in G-2
client-19 is in G-2
client-20 is in G-3
cnt=[5, 8, 2, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8707 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.0275 | Train Acc: 0.6842
 Site-Clipart   | Train Loss: 1.0184 | Train Acc: 0.7895
 Site-Clipart   | Train Loss: 0.9095 | Train Acc: 0.8140
 Site-Clipart   | Train Loss: 1.1141 | Train Acc: 0.8527
 Site-Clipart   | Train Loss: 1.1203 | Train Acc: 0.7680
 Site-Clipart   | Train Loss: 0.9352 | Train Acc: 0.7869
 Site-Clipart   | Train Loss: 0.9586 | Train Acc: 0.8146
 Site-Real      | Train Loss: 0.7821 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.7280 | Train Acc: 0.8737
 Site-Real      | Train Loss: 0.7293 | Train Acc: 0.9161
 Site-Real      | Train Loss: 0.7214 | Train Acc: 0.9023
 Site-Real      | Train Loss: 0.6709 | Train Acc: 0.8944
 Site-Painting  | Train Loss: 0.9484 | Train Acc: 0.7863
 Site-Painting  | Train Loss: 0.9734 | Train Acc: 0.7898
 Site-Painting  | Train Loss: 0.8740 | Train Acc: 0.8264
 Site-Sketch    | Train Loss: 0.9484 | Train Acc: 0.7651
 Site-Sketch    | Train Loss: 0.9927 | Train Acc: 0.7354
 Site-QuickDraw | Train Loss: 2.0492 | Train Acc: 0.2828
 Site-QuickDraw | Train Loss: 2.0599 | Train Acc: 0.2500
 Site-Infograph | Train Loss: 1.6968 | Train Acc: 0.4727
 Site-Clipart   | Val  Loss: 0.7198 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.6256 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 1.0614 | Val  Acc: 0.7105
 Site-Clipart   | Val  Loss: 0.9434 | Val  Acc: 0.8070
 Site-Clipart   | Val  Loss: 0.9371 | Val  Acc: 0.8256
 Site-Clipart   | Val  Loss: 1.0746 | Val  Acc: 0.8062
 Site-Clipart   | Val  Loss: 1.1446 | Val  Acc: 0.7938
 Site-Clipart   | Val  Loss: 0.9926 | Val  Acc: 0.7904
 Site-Real      | Val  Loss: 0.8257 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.6499 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.6703 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 0.7991 | Val  Acc: 0.8671
 Site-Real      | Val  Loss: 0.6295 | Val  Acc: 0.9159
 Site-Painting  | Val  Loss: 0.8786 | Val  Acc: 0.8077
 Site-Painting  | Val  Loss: 0.8543 | Val  Acc: 0.8291
 Site-Painting  | Val  Loss: 0.8893 | Val  Acc: 0.8182
 Site-Sketch    | Val  Loss: 0.9331 | Val  Acc: 0.7475
 Site-Sketch    | Val  Loss: 0.9692 | Val  Acc: 0.7095
 Site-QuickDraw | Val  Loss: 1.9053 | Val  Acc: 0.2727
 Site-QuickDraw | Val  Loss: 2.1351 | Val  Acc: 0.2828
 Site-Infograph | Val  Loss: 1.5778 | Val  Acc: 0.5273
Average Valid Accuracy: 0.7631
Aggregated Acc | Val Acc: 0.6780
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7105
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8070
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8256
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8062
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7938
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7904
 Best site-Real       | Epoch:6 | Val Acc: 0.8810
 Best site-Real       | Epoch:6 | Val Acc: 0.9365
 Best site-Real       | Epoch:6 | Val Acc: 0.8947
 Best site-Real       | Epoch:6 | Val Acc: 0.8671
 Best site-Real       | Epoch:6 | Val Acc: 0.9159
 Best site-Painting   | Epoch:6 | Val Acc: 0.8077
 Best site-Painting   | Epoch:6 | Val Acc: 0.8291
 Best site-Painting   | Epoch:6 | Val Acc: 0.8182
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7475
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7095
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2727
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2828
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 7 ============
gmm
client-0 is in G-0
client-1 is in G-5
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-0
cnt=[8, 2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7370 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.9374 | Train Acc: 0.7368
 Site-Clipart   | Train Loss: 0.9513 | Train Acc: 0.7544
 Site-Clipart   | Train Loss: 0.7863 | Train Acc: 0.8721
 Site-Clipart   | Train Loss: 1.2790 | Train Acc: 0.8605
 Site-Clipart   | Train Loss: 0.8565 | Train Acc: 0.8041
 Site-Clipart   | Train Loss: 0.8075 | Train Acc: 0.8316
 Site-Clipart   | Train Loss: 0.8707 | Train Acc: 0.8032
 Site-Real      | Train Loss: 0.7169 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.7049 | Train Acc: 0.8842
 Site-Real      | Train Loss: 0.5801 | Train Acc: 0.9301
 Site-Real      | Train Loss: 0.6524 | Train Acc: 0.9023
 Site-Real      | Train Loss: 0.7800 | Train Acc: 0.9161
 Site-Painting  | Train Loss: 0.9087 | Train Acc: 0.8034
 Site-Painting  | Train Loss: 0.8609 | Train Acc: 0.8239
 Site-Painting  | Train Loss: 0.7505 | Train Acc: 0.8491
 Site-Sketch    | Train Loss: 0.7782 | Train Acc: 0.8121
 Site-Sketch    | Train Loss: 0.9196 | Train Acc: 0.7444
 Site-QuickDraw | Train Loss: 1.8725 | Train Acc: 0.3737
 Site-QuickDraw | Train Loss: 1.9423 | Train Acc: 0.3243
 Site-Infograph | Train Loss: 1.6670 | Train Acc: 0.4606
 Site-Clipart   | Val  Loss: 0.6933 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.5464 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.8771 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.8689 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.8004 | Val  Acc: 0.8140
 Site-Clipart   | Val  Loss: 1.1419 | Val  Acc: 0.8450
 Site-Clipart   | Val  Loss: 1.0268 | Val  Acc: 0.7577
 Site-Clipart   | Val  Loss: 0.9114 | Val  Acc: 0.8110
 Site-Real      | Val  Loss: 0.7140 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.5572 | Val  Acc: 0.9683
 Site-Real      | Val  Loss: 0.6027 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 0.7108 | Val  Acc: 0.8881
 Site-Real      | Val  Loss: 0.5622 | Val  Acc: 0.9346
 Site-Painting  | Val  Loss: 0.7897 | Val  Acc: 0.8077
 Site-Painting  | Val  Loss: 0.8424 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 0.8358 | Val  Acc: 0.8125
 Site-Sketch    | Val  Loss: 0.8391 | Val  Acc: 0.7576
 Site-Sketch    | Val  Loss: 0.9101 | Val  Acc: 0.7162
 Site-QuickDraw | Val  Loss: 1.6964 | Val  Acc: 0.3030
 Site-QuickDraw | Val  Loss: 2.0110 | Val  Acc: 0.2727
 Site-Infograph | Val  Loss: 1.5430 | Val  Acc: 0.5091
Average Valid Accuracy: 0.7797
Aggregated Acc | Val Acc: 0.7510
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8421
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8140
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8450
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7577
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8110
 Best site-Real       | Epoch:7 | Val Acc: 0.8810
 Best site-Real       | Epoch:7 | Val Acc: 0.9683
 Best site-Real       | Epoch:7 | Val Acc: 0.8947
 Best site-Real       | Epoch:7 | Val Acc: 0.8881
 Best site-Real       | Epoch:7 | Val Acc: 0.9346
 Best site-Painting   | Epoch:7 | Val Acc: 0.8077
 Best site-Painting   | Epoch:7 | Val Acc: 0.8205
 Best site-Painting   | Epoch:7 | Val Acc: 0.8125
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7576
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7162
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3030
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2727
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5091
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 8 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-0
client-17 is in G-0
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[2, 2, 8, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7093 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7564 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.8403 | Train Acc: 0.8246
 Site-Clipart   | Train Loss: 0.6479 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.6139 | Train Acc: 0.8682
 Site-Clipart   | Train Loss: 0.8524 | Train Acc: 0.8093
 Site-Clipart   | Train Loss: 0.7511 | Train Acc: 0.8282
 Site-Clipart   | Train Loss: 0.7926 | Train Acc: 0.8513
 Site-Real      | Train Loss: 0.6566 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.6063 | Train Acc: 0.9053
 Site-Real      | Train Loss: 0.5250 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.5410 | Train Acc: 0.9302
 Site-Real      | Train Loss: 0.7276 | Train Acc: 0.9379
 Site-Painting  | Train Loss: 0.7728 | Train Acc: 0.8291
 Site-Painting  | Train Loss: 0.8110 | Train Acc: 0.8125
 Site-Painting  | Train Loss: 0.7560 | Train Acc: 0.8604
 Site-Sketch    | Train Loss: 0.8712 | Train Acc: 0.8121
 Site-Sketch    | Train Loss: 0.8800 | Train Acc: 0.7489
 Site-QuickDraw | Train Loss: 1.8364 | Train Acc: 0.4141
 Site-QuickDraw | Train Loss: 1.7898 | Train Acc: 0.3514
 Site-Infograph | Train Loss: 1.6623 | Train Acc: 0.5030
 Site-Clipart   | Val  Loss: 0.6539 | Val  Acc: 0.8235
 Site-Clipart   | Val  Loss: 0.5057 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.8033 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.7657 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.7373 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.9825 | Val  Acc: 0.8450
 Site-Clipart   | Val  Loss: 1.0063 | Val  Acc: 0.8299
 Site-Clipart   | Val  Loss: 0.8526 | Val  Acc: 0.8007
 Site-Real      | Val  Loss: 0.6388 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.4954 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.5117 | Val  Acc: 0.9263
 Site-Real      | Val  Loss: 0.6323 | Val  Acc: 0.9091
 Site-Real      | Val  Loss: 0.4849 | Val  Acc: 0.9486
 Site-Painting  | Val  Loss: 0.7372 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 0.7448 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.7486 | Val  Acc: 0.8409
 Site-Sketch    | Val  Loss: 0.8122 | Val  Acc: 0.7879
 Site-Sketch    | Val  Loss: 0.8525 | Val  Acc: 0.7432
 Site-QuickDraw | Val  Loss: 1.6436 | Val  Acc: 0.2727
 Site-QuickDraw | Val  Loss: 1.8938 | Val  Acc: 0.3434
 Site-Infograph | Val  Loss: 1.5294 | Val  Acc: 0.4909
Average Valid Accuracy: 0.7919
Aggregated Acc | Val Acc: 0.6988
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8235
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8421
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8421
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8721
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8450
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8299
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8007
 Best site-Real       | Epoch:8 | Val Acc: 0.8810
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Real       | Epoch:8 | Val Acc: 0.9263
 Best site-Real       | Epoch:8 | Val Acc: 0.9091
 Best site-Real       | Epoch:8 | Val Acc: 0.9486
 Best site-Painting   | Epoch:8 | Val Acc: 0.8462
 Best site-Painting   | Epoch:8 | Val Acc: 0.8718
 Best site-Painting   | Epoch:8 | Val Acc: 0.8409
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7879
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7432
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2727
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3434
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4909
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 9 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-4
client-11 is in G-4
client-12 is in G-4
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-3
client-17 is in G-3
client-18 is in G-0
client-19 is in G-0
client-20 is in G-2
cnt=[2, 7, 4, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6957 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7801 | Train Acc: 0.8158
 Site-Clipart   | Train Loss: 0.8373 | Train Acc: 0.8246
 Site-Clipart   | Train Loss: 0.6418 | Train Acc: 0.8721
 Site-Clipart   | Train Loss: 0.5170 | Train Acc: 0.8682
 Site-Clipart   | Train Loss: 0.8601 | Train Acc: 0.8351
 Site-Clipart   | Train Loss: 0.7300 | Train Acc: 0.8179
 Site-Clipart   | Train Loss: 0.7526 | Train Acc: 0.8215
 Site-Real      | Train Loss: 0.5763 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.5175 | Train Acc: 0.9368
 Site-Real      | Train Loss: 0.4936 | Train Acc: 0.9441
 Site-Real      | Train Loss: 0.5148 | Train Acc: 0.9209
 Site-Real      | Train Loss: 0.5402 | Train Acc: 0.9379
 Site-Painting  | Train Loss: 0.7186 | Train Acc: 0.8547
 Site-Painting  | Train Loss: 0.7088 | Train Acc: 0.8352
 Site-Painting  | Train Loss: 0.6485 | Train Acc: 0.8491
 Site-Sketch    | Train Loss: 0.7632 | Train Acc: 0.8255
 Site-Sketch    | Train Loss: 0.8203 | Train Acc: 0.7803
 Site-QuickDraw | Train Loss: 1.6898 | Train Acc: 0.4747
 Site-QuickDraw | Train Loss: 1.7891 | Train Acc: 0.4324
 Site-Infograph | Train Loss: 1.5598 | Train Acc: 0.4727
 Site-Clipart   | Val  Loss: 0.5883 | Val  Acc: 0.8235
 Site-Clipart   | Val  Loss: 0.5243 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.8449 | Val  Acc: 0.7895
 Site-Clipart   | Val  Loss: 0.7322 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.7024 | Val  Acc: 0.8605
 Site-Clipart   | Val  Loss: 0.9514 | Val  Acc: 0.8372
 Site-Clipart   | Val  Loss: 0.9250 | Val  Acc: 0.7938
 Site-Clipart   | Val  Loss: 0.8049 | Val  Acc: 0.7904
 Site-Real      | Val  Loss: 0.5912 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.4515 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.4559 | Val  Acc: 0.9684
 Site-Real      | Val  Loss: 0.5773 | Val  Acc: 0.9301
 Site-Real      | Val  Loss: 0.4357 | Val  Acc: 0.9486
 Site-Painting  | Val  Loss: 0.6734 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.6838 | Val  Acc: 0.8632
 Site-Painting  | Val  Loss: 0.6735 | Val  Acc: 0.8352
 Site-Sketch    | Val  Loss: 0.7080 | Val  Acc: 0.8182
 Site-Sketch    | Val  Loss: 0.7698 | Val  Acc: 0.7568
 Site-QuickDraw | Val  Loss: 1.5832 | Val  Acc: 0.4242
 Site-QuickDraw | Val  Loss: 1.8668 | Val  Acc: 0.3737
 Site-Infograph | Val  Loss: 1.4827 | Val  Acc: 0.5273
Average Valid Accuracy: 0.7994
Aggregated Acc | Val Acc: 0.7582
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8235
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7895
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8596
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8605
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8372
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7938
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7904
 Best site-Real       | Epoch:9 | Val Acc: 0.9524
 Best site-Real       | Epoch:9 | Val Acc: 0.9206
 Best site-Real       | Epoch:9 | Val Acc: 0.9684
 Best site-Real       | Epoch:9 | Val Acc: 0.9301
 Best site-Real       | Epoch:9 | Val Acc: 0.9486
 Best site-Painting   | Epoch:9 | Val Acc: 0.8333
 Best site-Painting   | Epoch:9 | Val Acc: 0.8632
 Best site-Painting   | Epoch:9 | Val Acc: 0.8352
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8182
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7568
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4242
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3737
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8574
 Test site-Real      | Epoch:9 | Test Acc: 0.9417
 Test site-Painting  | Epoch:9 | Test Acc: 0.8837
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8448
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.5240
 Test site-Infograph | Epoch:9 | Test Acc: 0.5099
Average Test Accuracy: 0.7602
============ Train epoch 10 ============
gmm
client-0 is in G-5
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-5
client-6 is in G-2
client-7 is in G-5
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-2
client-17 is in G-2
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[5, 2, 7, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5184 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7864 | Train Acc: 0.7632
 Site-Clipart   | Train Loss: 0.7596 | Train Acc: 0.8772
 Site-Clipart   | Train Loss: 0.5780 | Train Acc: 0.8837
 Site-Clipart   | Train Loss: 0.8148 | Train Acc: 0.8760
 Site-Clipart   | Train Loss: 0.7503 | Train Acc: 0.8144
 Site-Clipart   | Train Loss: 0.6851 | Train Acc: 0.8213
 Site-Clipart   | Train Loss: 0.7043 | Train Acc: 0.8398
 Site-Real      | Train Loss: 0.5736 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.5268 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.4926 | Train Acc: 0.9441
 Site-Real      | Train Loss: 0.4627 | Train Acc: 0.9256
 Site-Real      | Train Loss: 0.5851 | Train Acc: 0.9348
 Site-Painting  | Train Loss: 0.7256 | Train Acc: 0.8120
 Site-Painting  | Train Loss: 0.6824 | Train Acc: 0.8466
 Site-Painting  | Train Loss: 0.7146 | Train Acc: 0.8642
 Site-Sketch    | Train Loss: 0.6524 | Train Acc: 0.8255
 Site-Sketch    | Train Loss: 0.7952 | Train Acc: 0.7668
 Site-QuickDraw | Train Loss: 1.7029 | Train Acc: 0.5354
 Site-QuickDraw | Train Loss: 1.5794 | Train Acc: 0.4730
 Site-Infograph | Train Loss: 1.6031 | Train Acc: 0.4727
 Site-Clipart   | Val  Loss: 0.5257 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.4693 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6755 | Val  Acc: 0.8684
 Site-Clipart   | Val  Loss: 0.6697 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.6636 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.7650 | Val  Acc: 0.8527
 Site-Clipart   | Val  Loss: 0.8154 | Val  Acc: 0.8247
 Site-Clipart   | Val  Loss: 0.7652 | Val  Acc: 0.8007
 Site-Real      | Val  Loss: 0.5448 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.4052 | Val  Acc: 0.9683
 Site-Real      | Val  Loss: 0.4073 | Val  Acc: 0.9579
 Site-Real      | Val  Loss: 0.5269 | Val  Acc: 0.9161
 Site-Real      | Val  Loss: 0.3903 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.7142 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 0.6947 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 0.6143 | Val  Acc: 0.8750
 Site-Sketch    | Val  Loss: 0.6957 | Val  Acc: 0.7778
 Site-Sketch    | Val  Loss: 0.7729 | Val  Acc: 0.7635
 Site-QuickDraw | Val  Loss: 1.3835 | Val  Acc: 0.4848
 Site-QuickDraw | Val  Loss: 1.7358 | Val  Acc: 0.4545
 Site-Infograph | Val  Loss: 1.4974 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8180
Aggregated Acc | Val Acc: 0.7445
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8684
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8772
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8721
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8527
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8247
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8007
 Best site-Real       | Epoch:10 | Val Acc: 0.9286
 Best site-Real       | Epoch:10 | Val Acc: 0.9683
 Best site-Real       | Epoch:10 | Val Acc: 0.9579
 Best site-Real       | Epoch:10 | Val Acc: 0.9161
 Best site-Real       | Epoch:10 | Val Acc: 0.9673
 Best site-Painting   | Epoch:10 | Val Acc: 0.8205
 Best site-Painting   | Epoch:10 | Val Acc: 0.8462
 Best site-Painting   | Epoch:10 | Val Acc: 0.8750
 Best site-Sketch     | Epoch:10 | Val Acc: 0.7778
 Best site-Sketch     | Epoch:10 | Val Acc: 0.7635
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.4848
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.4545
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 11 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-3
client-17 is in G-3
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[8, 2, 5, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5997 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6758 | Train Acc: 0.7632
 Site-Clipart   | Train Loss: 0.7037 | Train Acc: 0.8070
 Site-Clipart   | Train Loss: 0.6490 | Train Acc: 0.8721
 Site-Clipart   | Train Loss: 0.6553 | Train Acc: 0.8760
 Site-Clipart   | Train Loss: 0.5843 | Train Acc: 0.7938
 Site-Clipart   | Train Loss: 0.6446 | Train Acc: 0.8316
 Site-Clipart   | Train Loss: 0.6822 | Train Acc: 0.8261
 Site-Real      | Train Loss: 0.5478 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.4449 | Train Acc: 0.9158
 Site-Real      | Train Loss: 0.3628 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.4346 | Train Acc: 0.9349
 Site-Real      | Train Loss: 0.5080 | Train Acc: 0.9317
 Site-Painting  | Train Loss: 0.6657 | Train Acc: 0.8632
 Site-Painting  | Train Loss: 0.6649 | Train Acc: 0.8239
 Site-Painting  | Train Loss: 0.5546 | Train Acc: 0.8830
 Site-Sketch    | Train Loss: 0.6413 | Train Acc: 0.8456
 Site-Sketch    | Train Loss: 0.7381 | Train Acc: 0.7668
 Site-QuickDraw | Train Loss: 1.6064 | Train Acc: 0.5051
 Site-QuickDraw | Train Loss: 1.6545 | Train Acc: 0.5135
 Site-Infograph | Train Loss: 1.5497 | Train Acc: 0.4606
 Site-Clipart   | Val  Loss: 0.6222 | Val  Acc: 0.8235
 Site-Clipart   | Val  Loss: 0.4406 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.7073 | Val  Acc: 0.8684
 Site-Clipart   | Val  Loss: 0.6636 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.6294 | Val  Acc: 0.8488
 Site-Clipart   | Val  Loss: 0.8083 | Val  Acc: 0.8915
 Site-Clipart   | Val  Loss: 0.8380 | Val  Acc: 0.8196
 Site-Clipart   | Val  Loss: 0.7307 | Val  Acc: 0.8247
 Site-Real      | Val  Loss: 0.5372 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.3316 | Val  Acc: 0.9683
 Site-Real      | Val  Loss: 0.4178 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.5475 | Val  Acc: 0.9231
 Site-Real      | Val  Loss: 0.3738 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.6488 | Val  Acc: 0.8077
 Site-Painting  | Val  Loss: 0.6417 | Val  Acc: 0.8632
 Site-Painting  | Val  Loss: 0.5830 | Val  Acc: 0.8693
 Site-Sketch    | Val  Loss: 0.7181 | Val  Acc: 0.8081
 Site-Sketch    | Val  Loss: 0.7180 | Val  Acc: 0.7770
 Site-QuickDraw | Val  Loss: 1.6033 | Val  Acc: 0.4848
 Site-QuickDraw | Val  Loss: 1.7555 | Val  Acc: 0.4141
 Site-Infograph | Val  Loss: 1.4252 | Val  Acc: 0.5364
Average Valid Accuracy: 0.8147
Aggregated Acc | Val Acc: 0.7367
============ Train epoch 12 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-0
client-17 is in G-0
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[2, 2, 5, 8, 1, 3, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5770 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6727 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.7020 | Train Acc: 0.8246
 Site-Clipart   | Train Loss: 0.5343 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.6397 | Train Acc: 0.8992
 Site-Clipart   | Train Loss: 0.5889 | Train Acc: 0.8351
 Site-Clipart   | Train Loss: 0.5904 | Train Acc: 0.8522
 Site-Clipart   | Train Loss: 0.6461 | Train Acc: 0.8398
 Site-Real      | Train Loss: 0.5437 | Train Acc: 0.8571
 Site-Real      | Train Loss: 0.4829 | Train Acc: 0.9158
 Site-Real      | Train Loss: 0.4621 | Train Acc: 0.9301
 Site-Real      | Train Loss: 0.4114 | Train Acc: 0.9488
 Site-Real      | Train Loss: 0.3942 | Train Acc: 0.9255
 Site-Painting  | Train Loss: 0.6283 | Train Acc: 0.8205
 Site-Painting  | Train Loss: 0.6375 | Train Acc: 0.8409
 Site-Painting  | Train Loss: 0.5377 | Train Acc: 0.8679
 Site-Sketch    | Train Loss: 0.6077 | Train Acc: 0.8389
 Site-Sketch    | Train Loss: 0.6869 | Train Acc: 0.7758
 Site-QuickDraw | Train Loss: 1.5539 | Train Acc: 0.5253
 Site-QuickDraw | Train Loss: 1.5932 | Train Acc: 0.5338
 Site-Infograph | Train Loss: 1.4883 | Train Acc: 0.5455
 Site-Clipart   | Val  Loss: 0.5412 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.4297 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.6393 | Val  Acc: 0.8158
 Site-Clipart   | Val  Loss: 0.5677 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.5668 | Val  Acc: 0.8605
 Site-Clipart   | Val  Loss: 0.7576 | Val  Acc: 0.9302
 Site-Clipart   | Val  Loss: 0.8176 | Val  Acc: 0.8247
 Site-Clipart   | Val  Loss: 0.6698 | Val  Acc: 0.8385
 Site-Real      | Val  Loss: 0.5261 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.3271 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4143 | Val  Acc: 0.9158
 Site-Real      | Val  Loss: 0.5271 | Val  Acc: 0.9091
 Site-Real      | Val  Loss: 0.3623 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.6492 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 0.6477 | Val  Acc: 0.8547
 Site-Painting  | Val  Loss: 0.5898 | Val  Acc: 0.8580
 Site-Sketch    | Val  Loss: 0.7133 | Val  Acc: 0.7879
 Site-Sketch    | Val  Loss: 0.6851 | Val  Acc: 0.7838
 Site-QuickDraw | Val  Loss: 1.2873 | Val  Acc: 0.5758
 Site-QuickDraw | Val  Loss: 1.6233 | Val  Acc: 0.4848
 Site-Infograph | Val  Loss: 1.3765 | Val  Acc: 0.5727
Average Valid Accuracy: 0.8262
Aggregated Acc | Val Acc: 0.7558
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8158
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8772
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8605
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9302
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8247
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8385
 Best site-Real       | Epoch:12 | Val Acc: 0.8810
 Best site-Real       | Epoch:12 | Val Acc: 1.0000
 Best site-Real       | Epoch:12 | Val Acc: 0.9158
 Best site-Real       | Epoch:12 | Val Acc: 0.9091
 Best site-Real       | Epoch:12 | Val Acc: 0.9579
 Best site-Painting   | Epoch:12 | Val Acc: 0.8205
 Best site-Painting   | Epoch:12 | Val Acc: 0.8547
 Best site-Painting   | Epoch:12 | Val Acc: 0.8580
 Best site-Sketch     | Epoch:12 | Val Acc: 0.7879
 Best site-Sketch     | Epoch:12 | Val Acc: 0.7838
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.5758
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.4848
 Best site-Infograph  | Epoch:12 | Val Acc: 0.5727
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 13 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-5
client-17 is in G-5
client-18 is in G-0
client-19 is in G-0
client-20 is in G-4
cnt=[2, 8, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5043 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6101 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.6852 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.5187 | Train Acc: 0.8605
 Site-Clipart   | Train Loss: 0.4335 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.6369 | Train Acc: 0.8299
 Site-Clipart   | Train Loss: 0.5864 | Train Acc: 0.8488
 Site-Clipart   | Train Loss: 0.6178 | Train Acc: 0.8673
 Site-Real      | Train Loss: 0.5092 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.4845 | Train Acc: 0.9053
 Site-Real      | Train Loss: 0.3618 | Train Acc: 0.9441
 Site-Real      | Train Loss: 0.4167 | Train Acc: 0.9442
 Site-Real      | Train Loss: 0.4415 | Train Acc: 0.9410
 Site-Painting  | Train Loss: 0.6285 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.6559 | Train Acc: 0.8523
 Site-Painting  | Train Loss: 0.5128 | Train Acc: 0.8717
 Site-Sketch    | Train Loss: 0.6584 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.7254 | Train Acc: 0.7623
 Site-QuickDraw | Train Loss: 1.4166 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.5218 | Train Acc: 0.5608
 Site-Infograph | Train Loss: 1.4513 | Train Acc: 0.5273
 Site-Clipart   | Val  Loss: 0.4732 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.3906 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5467 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.5908 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.5732 | Val  Acc: 0.8488
 Site-Clipart   | Val  Loss: 0.6905 | Val  Acc: 0.8527
 Site-Clipart   | Val  Loss: 0.7410 | Val  Acc: 0.8505
 Site-Clipart   | Val  Loss: 0.6502 | Val  Acc: 0.8282
 Site-Real      | Val  Loss: 0.5075 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.3593 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.4098 | Val  Acc: 0.9158
 Site-Real      | Val  Loss: 0.5158 | Val  Acc: 0.9021
 Site-Real      | Val  Loss: 0.3421 | Val  Acc: 0.9533
 Site-Painting  | Val  Loss: 0.6593 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 0.6077 | Val  Acc: 0.8803
 Site-Painting  | Val  Loss: 0.5752 | Val  Acc: 0.8693
 Site-Sketch    | Val  Loss: 0.6206 | Val  Acc: 0.8081
 Site-Sketch    | Val  Loss: 0.6744 | Val  Acc: 0.7568
 Site-QuickDraw | Val  Loss: 1.2498 | Val  Acc: 0.5152
 Site-QuickDraw | Val  Loss: 1.5259 | Val  Acc: 0.4949
 Site-Infograph | Val  Loss: 1.2777 | Val  Acc: 0.5818
Average Valid Accuracy: 0.8236
Aggregated Acc | Val Acc: 0.7530
============ Train epoch 14 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[8, 2, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5176 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6239 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.6556 | Train Acc: 0.8246
 Site-Clipart   | Train Loss: 0.4675 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.4788 | Train Acc: 0.8837
 Site-Clipart   | Train Loss: 0.5765 | Train Acc: 0.8247
 Site-Clipart   | Train Loss: 0.5876 | Train Acc: 0.8522
 Site-Clipart   | Train Loss: 0.6069 | Train Acc: 0.8375
 Site-Real      | Train Loss: 0.4723 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.4055 | Train Acc: 0.9263
 Site-Real      | Train Loss: 0.3409 | Train Acc: 0.9441
 Site-Real      | Train Loss: 0.3586 | Train Acc: 0.9581
 Site-Real      | Train Loss: 0.4276 | Train Acc: 0.9472
 Site-Painting  | Train Loss: 0.6267 | Train Acc: 0.8291
 Site-Painting  | Train Loss: 0.5914 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.4562 | Train Acc: 0.8830
 Site-Sketch    | Train Loss: 0.5894 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.6579 | Train Acc: 0.8027
 Site-QuickDraw | Train Loss: 1.4260 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.4010 | Train Acc: 0.5541
 Site-Infograph | Train Loss: 1.4381 | Train Acc: 0.5333
 Site-Clipart   | Val  Loss: 0.5236 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.3184 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5993 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.5334 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.5245 | Val  Acc: 0.8605
 Site-Clipart   | Val  Loss: 0.5903 | Val  Acc: 0.8915
 Site-Clipart   | Val  Loss: 0.7197 | Val  Acc: 0.8454
 Site-Clipart   | Val  Loss: 0.6693 | Val  Acc: 0.8247
 Site-Real      | Val  Loss: 0.4677 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2914 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.3741 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.4732 | Val  Acc: 0.9301
 Site-Real      | Val  Loss: 0.3414 | Val  Acc: 0.9439
 Site-Painting  | Val  Loss: 0.5567 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.5648 | Val  Acc: 0.8803
 Site-Painting  | Val  Loss: 0.5015 | Val  Acc: 0.8977
 Site-Sketch    | Val  Loss: 0.5851 | Val  Acc: 0.8384
 Site-Sketch    | Val  Loss: 0.7027 | Val  Acc: 0.8108
 Site-QuickDraw | Val  Loss: 1.2907 | Val  Acc: 0.5152
 Site-QuickDraw | Val  Loss: 1.5036 | Val  Acc: 0.5253
 Site-Infograph | Val  Loss: 1.2608 | Val  Acc: 0.6182
Average Valid Accuracy: 0.8402
Aggregated Acc | Val Acc: 0.7761
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8421
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8772
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8605
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8915
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8454
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8247
 Best site-Real       | Epoch:14 | Val Acc: 0.9048
 Best site-Real       | Epoch:14 | Val Acc: 0.9365
 Best site-Real       | Epoch:14 | Val Acc: 0.9474
 Best site-Real       | Epoch:14 | Val Acc: 0.9301
 Best site-Real       | Epoch:14 | Val Acc: 0.9439
 Best site-Painting   | Epoch:14 | Val Acc: 0.8718
 Best site-Painting   | Epoch:14 | Val Acc: 0.8803
 Best site-Painting   | Epoch:14 | Val Acc: 0.8977
 Best site-Sketch     | Epoch:14 | Val Acc: 0.8384
 Best site-Sketch     | Epoch:14 | Val Acc: 0.8108
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.5152
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.5253
 Best site-Infograph  | Epoch:14 | Val Acc: 0.6182
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 15 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-3
client-17 is in G-3
client-18 is in G-1
client-19 is in G-1
client-20 is in G-5
cnt=[8, 2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5607 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6358 | Train Acc: 0.8158
 Site-Clipart   | Train Loss: 0.5769 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.5795 | Train Acc: 0.8605
 Site-Clipart   | Train Loss: 0.6226 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.4861 | Train Acc: 0.8505
 Site-Clipart   | Train Loss: 0.5506 | Train Acc: 0.8522
 Site-Clipart   | Train Loss: 0.5946 | Train Acc: 0.8467
 Site-Real      | Train Loss: 0.4724 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.3814 | Train Acc: 0.9368
 Site-Real      | Train Loss: 0.3365 | Train Acc: 0.9441
 Site-Real      | Train Loss: 0.3346 | Train Acc: 0.9442
 Site-Real      | Train Loss: 0.5828 | Train Acc: 0.9317
 Site-Painting  | Train Loss: 0.5632 | Train Acc: 0.8547
 Site-Painting  | Train Loss: 0.5426 | Train Acc: 0.8693
 Site-Painting  | Train Loss: 0.5347 | Train Acc: 0.9019
 Site-Sketch    | Train Loss: 0.5088 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.6281 | Train Acc: 0.8206
 Site-QuickDraw | Train Loss: 1.4100 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 1.3911 | Train Acc: 0.5541
 Site-Infograph | Train Loss: 1.4155 | Train Acc: 0.5152
 Site-Clipart   | Val  Loss: 0.4920 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.3514 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.5805 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.4824 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.4943 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.7714 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.6603 | Val  Acc: 0.8247
 Site-Clipart   | Val  Loss: 0.6431 | Val  Acc: 0.8179
 Site-Real      | Val  Loss: 0.4168 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2650 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3427 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.4468 | Val  Acc: 0.9510
 Site-Real      | Val  Loss: 0.3178 | Val  Acc: 0.9486
 Site-Painting  | Val  Loss: 0.5197 | Val  Acc: 0.8590
 Site-Painting  | Val  Loss: 0.4979 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.5222 | Val  Acc: 0.8750
 Site-Sketch    | Val  Loss: 0.6824 | Val  Acc: 0.7980
 Site-Sketch    | Val  Loss: 0.6613 | Val  Acc: 0.7770
 Site-QuickDraw | Val  Loss: 1.2043 | Val  Acc: 0.5303
 Site-QuickDraw | Val  Loss: 1.4837 | Val  Acc: 0.5354
 Site-Infograph | Val  Loss: 1.2648 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8338
Aggregated Acc | Val Acc: 0.7677
============ Train epoch 16 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[8, 2, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3876 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5895 | Train Acc: 0.8158
 Site-Clipart   | Train Loss: 0.6187 | Train Acc: 0.8772
 Site-Clipart   | Train Loss: 0.5468 | Train Acc: 0.8953
 Site-Clipart   | Train Loss: 0.3639 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.6501 | Train Acc: 0.8299
 Site-Clipart   | Train Loss: 0.5274 | Train Acc: 0.8729
 Site-Clipart   | Train Loss: 0.5420 | Train Acc: 0.8719
 Site-Real      | Train Loss: 0.4387 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.3877 | Train Acc: 0.9263
 Site-Real      | Train Loss: 0.3248 | Train Acc: 0.9441
 Site-Real      | Train Loss: 0.3234 | Train Acc: 0.9395
 Site-Real      | Train Loss: 0.3386 | Train Acc: 0.9472
 Site-Painting  | Train Loss: 0.5315 | Train Acc: 0.9060
 Site-Painting  | Train Loss: 0.5140 | Train Acc: 0.8693
 Site-Painting  | Train Loss: 0.4298 | Train Acc: 0.8830
 Site-Sketch    | Train Loss: 0.5802 | Train Acc: 0.8725
 Site-Sketch    | Train Loss: 0.6049 | Train Acc: 0.8161
 Site-QuickDraw | Train Loss: 1.3592 | Train Acc: 0.5758
 Site-QuickDraw | Train Loss: 1.4395 | Train Acc: 0.5946
 Site-Infograph | Train Loss: 1.3673 | Train Acc: 0.5515
 Site-Clipart   | Val  Loss: 0.4371 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.2858 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.5492 | Val  Acc: 0.8158
 Site-Clipart   | Val  Loss: 0.5276 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.5348 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.5359 | Val  Acc: 0.8915
 Site-Clipart   | Val  Loss: 0.8192 | Val  Acc: 0.8196
 Site-Clipart   | Val  Loss: 0.6347 | Val  Acc: 0.8282
 Site-Real      | Val  Loss: 0.4033 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.3051 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.3177 | Val  Acc: 0.9263
 Site-Real      | Val  Loss: 0.4189 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.2954 | Val  Acc: 0.9533
 Site-Painting  | Val  Loss: 0.4895 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.5331 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.4831 | Val  Acc: 0.8807
 Site-Sketch    | Val  Loss: 0.5983 | Val  Acc: 0.8283
 Site-Sketch    | Val  Loss: 0.6197 | Val  Acc: 0.7973
 Site-QuickDraw | Val  Loss: 1.3902 | Val  Acc: 0.5303
 Site-QuickDraw | Val  Loss: 1.4492 | Val  Acc: 0.5455
 Site-Infograph | Val  Loss: 1.2504 | Val  Acc: 0.5909
Average Valid Accuracy: 0.8340
Aggregated Acc | Val Acc: 0.7691
============ Train epoch 17 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-0
client-17 is in G-0
client-18 is in G-1
client-19 is in G-1
client-20 is in G-5
cnt=[9, 2, 5, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4693 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5666 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.6154 | Train Acc: 0.8772
 Site-Clipart   | Train Loss: 0.4969 | Train Acc: 0.9186
 Site-Clipart   | Train Loss: 0.3670 | Train Acc: 0.8992
 Site-Clipart   | Train Loss: 0.7758 | Train Acc: 0.8505
 Site-Clipart   | Train Loss: 0.5196 | Train Acc: 0.8522
 Site-Clipart   | Train Loss: 0.5545 | Train Acc: 0.8581
 Site-Real      | Train Loss: 0.4539 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.3305 | Train Acc: 0.9263
 Site-Real      | Train Loss: 0.3347 | Train Acc: 0.9301
 Site-Real      | Train Loss: 0.3076 | Train Acc: 0.9442
 Site-Real      | Train Loss: 0.3972 | Train Acc: 0.9379
 Site-Painting  | Train Loss: 0.5648 | Train Acc: 0.8205
 Site-Painting  | Train Loss: 0.5169 | Train Acc: 0.8693
 Site-Painting  | Train Loss: 0.4219 | Train Acc: 0.8830
 Site-Sketch    | Train Loss: 0.5527 | Train Acc: 0.8322
 Site-Sketch    | Train Loss: 0.6094 | Train Acc: 0.8072
 Site-QuickDraw | Train Loss: 1.2331 | Train Acc: 0.6566
 Site-QuickDraw | Train Loss: 1.2068 | Train Acc: 0.6351
 Site-Infograph | Train Loss: 1.3112 | Train Acc: 0.5636
 Site-Clipart   | Val  Loss: 0.4208 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.3175 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6034 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.4742 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.5171 | Val  Acc: 0.8605
 Site-Clipart   | Val  Loss: 0.5313 | Val  Acc: 0.8527
 Site-Clipart   | Val  Loss: 0.5918 | Val  Acc: 0.8299
 Site-Clipart   | Val  Loss: 0.5999 | Val  Acc: 0.8419
 Site-Real      | Val  Loss: 0.4218 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2886 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.3250 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.4426 | Val  Acc: 0.9231
 Site-Real      | Val  Loss: 0.2977 | Val  Acc: 0.9439
 Site-Painting  | Val  Loss: 0.4960 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 0.5097 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.4556 | Val  Acc: 0.8807
 Site-Sketch    | Val  Loss: 0.5311 | Val  Acc: 0.8384
 Site-Sketch    | Val  Loss: 0.6376 | Val  Acc: 0.7905
 Site-QuickDraw | Val  Loss: 1.0086 | Val  Acc: 0.6061
 Site-QuickDraw | Val  Loss: 1.3894 | Val  Acc: 0.5657
 Site-Infograph | Val  Loss: 1.2581 | Val  Acc: 0.5727
Average Valid Accuracy: 0.8346
Aggregated Acc | Val Acc: 0.7827
============ Train epoch 18 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-0
client-17 is in G-0
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[2, 2, 8, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4228 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5025 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.6172 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.4445 | Train Acc: 0.8953
 Site-Clipart   | Train Loss: 0.3989 | Train Acc: 0.9457
 Site-Clipart   | Train Loss: 0.4846 | Train Acc: 0.8454
 Site-Clipart   | Train Loss: 0.5174 | Train Acc: 0.8591
 Site-Clipart   | Train Loss: 0.5234 | Train Acc: 0.8696
 Site-Real      | Train Loss: 0.4767 | Train Acc: 0.8413
 Site-Real      | Train Loss: 0.3637 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.3188 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.3285 | Train Acc: 0.9302
 Site-Real      | Train Loss: 0.2911 | Train Acc: 0.9317
 Site-Painting  | Train Loss: 0.5177 | Train Acc: 0.8803
 Site-Painting  | Train Loss: 0.5287 | Train Acc: 0.8636
 Site-Painting  | Train Loss: 0.5038 | Train Acc: 0.8943
 Site-Sketch    | Train Loss: 0.5302 | Train Acc: 0.8456
 Site-Sketch    | Train Loss: 0.6366 | Train Acc: 0.8027
 Site-QuickDraw | Train Loss: 1.2425 | Train Acc: 0.6263
 Site-QuickDraw | Train Loss: 1.2618 | Train Acc: 0.6149
 Site-Infograph | Train Loss: 1.3230 | Train Acc: 0.5636
 Site-Clipart   | Val  Loss: 0.4246 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.3258 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.5160 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.4807 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.4663 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.5531 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.6394 | Val  Acc: 0.8402
 Site-Clipart   | Val  Loss: 0.6283 | Val  Acc: 0.8076
 Site-Real      | Val  Loss: 0.3803 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2845 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3316 | Val  Acc: 0.9263
 Site-Real      | Val  Loss: 0.4176 | Val  Acc: 0.9161
 Site-Real      | Val  Loss: 0.2892 | Val  Acc: 0.9486
 Site-Painting  | Val  Loss: 0.5432 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.5002 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.4793 | Val  Acc: 0.8693
 Site-Sketch    | Val  Loss: 0.5706 | Val  Acc: 0.8182
 Site-Sketch    | Val  Loss: 0.5894 | Val  Acc: 0.8041
 Site-QuickDraw | Val  Loss: 1.1219 | Val  Acc: 0.6212
 Site-QuickDraw | Val  Loss: 1.3614 | Val  Acc: 0.5758
 Site-Infograph | Val  Loss: 1.2252 | Val  Acc: 0.6091
Average Valid Accuracy: 0.8414
Aggregated Acc | Val Acc: 0.7835
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8421
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8596
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8721
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8837
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8402
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8076
 Best site-Real       | Epoch:18 | Val Acc: 0.9524
 Best site-Real       | Epoch:18 | Val Acc: 0.9524
 Best site-Real       | Epoch:18 | Val Acc: 0.9263
 Best site-Real       | Epoch:18 | Val Acc: 0.9161
 Best site-Real       | Epoch:18 | Val Acc: 0.9486
 Best site-Painting   | Epoch:18 | Val Acc: 0.8718
 Best site-Painting   | Epoch:18 | Val Acc: 0.8974
 Best site-Painting   | Epoch:18 | Val Acc: 0.8693
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8182
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8041
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.6212
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.5758
 Best site-Infograph  | Epoch:18 | Val Acc: 0.6091
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 19 ============
gmm
client-0 is in G-5
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-2
client-17 is in G-2
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[5, 2, 9, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4488 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5629 | Train Acc: 0.8158
 Site-Clipart   | Train Loss: 0.5840 | Train Acc: 0.8772
 Site-Clipart   | Train Loss: 0.4234 | Train Acc: 0.8837
 Site-Clipart   | Train Loss: 0.6071 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.5307 | Train Acc: 0.8093
 Site-Clipart   | Train Loss: 0.5021 | Train Acc: 0.8694
 Site-Clipart   | Train Loss: 0.5026 | Train Acc: 0.8696
 Site-Real      | Train Loss: 0.3932 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.3118 | Train Acc: 0.9368
 Site-Real      | Train Loss: 0.2869 | Train Acc: 0.9441
 Site-Real      | Train Loss: 0.3220 | Train Acc: 0.9395
 Site-Real      | Train Loss: 0.3426 | Train Acc: 0.9379
 Site-Painting  | Train Loss: 0.5221 | Train Acc: 0.8632
 Site-Painting  | Train Loss: 0.4752 | Train Acc: 0.8864
 Site-Painting  | Train Loss: 0.5123 | Train Acc: 0.9057
 Site-Sketch    | Train Loss: 0.4845 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.6282 | Train Acc: 0.8072
 Site-QuickDraw | Train Loss: 1.2542 | Train Acc: 0.6061
 Site-QuickDraw | Train Loss: 1.2183 | Train Acc: 0.6419
 Site-Infograph | Train Loss: 1.3170 | Train Acc: 0.5636
 Site-Clipart   | Val  Loss: 0.4127 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.3138 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.5333 | Val  Acc: 0.7632
 Site-Clipart   | Val  Loss: 0.4786 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.4844 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.4445 | Val  Acc: 0.8915
 Site-Clipart   | Val  Loss: 0.6334 | Val  Acc: 0.8454
 Site-Clipart   | Val  Loss: 0.5542 | Val  Acc: 0.8351
 Site-Real      | Val  Loss: 0.3465 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2937 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.3114 | Val  Acc: 0.9263
 Site-Real      | Val  Loss: 0.4341 | Val  Acc: 0.9231
 Site-Real      | Val  Loss: 0.2458 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.5355 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.4645 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.4347 | Val  Acc: 0.9034
 Site-Sketch    | Val  Loss: 0.5485 | Val  Acc: 0.8485
 Site-Sketch    | Val  Loss: 0.6163 | Val  Acc: 0.7905
 Site-QuickDraw | Val  Loss: 0.9850 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.3314 | Val  Acc: 0.5758
 Site-Infograph | Val  Loss: 1.2344 | Val  Acc: 0.5909
Average Valid Accuracy: 0.8405
Aggregated Acc | Val Acc: 0.7899
============ Train epoch 20 ============
gmm
client-0 is in G-4
client-1 is in G-2
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-4
client-6 is in G-4
client-7 is in G-4
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[5, 2, 1, 1, 9, 3, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4593 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6069 | Train Acc: 0.7895
 Site-Clipart   | Train Loss: 0.5627 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.5632 | Train Acc: 0.8721
 Site-Clipart   | Train Loss: 0.4731 | Train Acc: 0.8992
 Site-Clipart   | Train Loss: 0.4624 | Train Acc: 0.8608
 Site-Clipart   | Train Loss: 0.5077 | Train Acc: 0.8660
 Site-Clipart   | Train Loss: 0.5063 | Train Acc: 0.8673
 Site-Real      | Train Loss: 0.4058 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.3234 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.3114 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.3025 | Train Acc: 0.9581
 Site-Real      | Train Loss: 0.3817 | Train Acc: 0.9348
 Site-Painting  | Train Loss: 0.5162 | Train Acc: 0.8120
 Site-Painting  | Train Loss: 0.4915 | Train Acc: 0.8523
 Site-Painting  | Train Loss: 0.4344 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.5649 | Train Acc: 0.8054
 Site-Sketch    | Train Loss: 0.5787 | Train Acc: 0.8386
 Site-QuickDraw | Train Loss: 1.1745 | Train Acc: 0.6768
 Site-QuickDraw | Train Loss: 1.2576 | Train Acc: 0.6081
 Site-Infograph | Train Loss: 1.2663 | Train Acc: 0.5879
 Site-Clipart   | Val  Loss: 0.4000 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.2735 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.4521 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.4333 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.4568 | Val  Acc: 0.8953
 Site-Clipart   | Val  Loss: 0.4930 | Val  Acc: 0.8992
 Site-Clipart   | Val  Loss: 0.5709 | Val  Acc: 0.8814
 Site-Clipart   | Val  Loss: 0.5564 | Val  Acc: 0.8385
 Site-Real      | Val  Loss: 0.3363 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2978 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.2801 | Val  Acc: 0.9579
 Site-Real      | Val  Loss: 0.3801 | Val  Acc: 0.9441
 Site-Real      | Val  Loss: 0.2832 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.4854 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.4677 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.4616 | Val  Acc: 0.8750
 Site-Sketch    | Val  Loss: 0.5050 | Val  Acc: 0.8384
 Site-Sketch    | Val  Loss: 0.5891 | Val  Acc: 0.8108
 Site-QuickDraw | Val  Loss: 0.8241 | Val  Acc: 0.6364
 Site-QuickDraw | Val  Loss: 1.3030 | Val  Acc: 0.6061
 Site-Infograph | Val  Loss: 1.1463 | Val  Acc: 0.6636
Average Valid Accuracy: 0.8612
Aggregated Acc | Val Acc: 0.8240
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8953
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8992
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8814
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8385
 Best site-Real       | Epoch:20 | Val Acc: 0.9524
 Best site-Real       | Epoch:20 | Val Acc: 0.9365
 Best site-Real       | Epoch:20 | Val Acc: 0.9579
 Best site-Real       | Epoch:20 | Val Acc: 0.9441
 Best site-Real       | Epoch:20 | Val Acc: 0.9579
 Best site-Painting   | Epoch:20 | Val Acc: 0.8718
 Best site-Painting   | Epoch:20 | Val Acc: 0.8889
 Best site-Painting   | Epoch:20 | Val Acc: 0.8750
 Best site-Sketch     | Epoch:20 | Val Acc: 0.8384
 Best site-Sketch     | Epoch:20 | Val Acc: 0.8108
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.6364
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.6061
 Best site-Infograph  | Epoch:20 | Val Acc: 0.6636
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 21 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[8, 2, 5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3968 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5107 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.5624 | Train Acc: 0.8070
 Site-Clipart   | Train Loss: 0.4336 | Train Acc: 0.8605
 Site-Clipart   | Train Loss: 0.3253 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.4947 | Train Acc: 0.8454
 Site-Clipart   | Train Loss: 0.4509 | Train Acc: 0.8625
 Site-Clipart   | Train Loss: 0.4789 | Train Acc: 0.8764
 Site-Real      | Train Loss: 0.4200 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.3509 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2778 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.2758 | Train Acc: 0.9535
 Site-Real      | Train Loss: 0.2786 | Train Acc: 0.9441
 Site-Painting  | Train Loss: 0.4705 | Train Acc: 0.8974
 Site-Painting  | Train Loss: 0.4508 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.4226 | Train Acc: 0.9094
 Site-Sketch    | Train Loss: 0.5967 | Train Acc: 0.7987
 Site-Sketch    | Train Loss: 0.5660 | Train Acc: 0.8072
 Site-QuickDraw | Train Loss: 1.1722 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 1.0843 | Train Acc: 0.6824
 Site-Infograph | Train Loss: 1.2906 | Train Acc: 0.5758
 Site-Clipart   | Val  Loss: 0.4085 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.2605 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4293 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.4133 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.4460 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.4404 | Val  Acc: 0.8992
 Site-Clipart   | Val  Loss: 0.5930 | Val  Acc: 0.8299
 Site-Clipart   | Val  Loss: 0.5369 | Val  Acc: 0.8419
 Site-Real      | Val  Loss: 0.3924 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.3062 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2949 | Val  Acc: 0.9263
 Site-Real      | Val  Loss: 0.3877 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.2603 | Val  Acc: 0.9439
 Site-Painting  | Val  Loss: 0.4732 | Val  Acc: 0.8590
 Site-Painting  | Val  Loss: 0.4345 | Val  Acc: 0.9060
 Site-Painting  | Val  Loss: 0.4150 | Val  Acc: 0.9034
 Site-Sketch    | Val  Loss: 0.5051 | Val  Acc: 0.8182
 Site-Sketch    | Val  Loss: 0.5689 | Val  Acc: 0.7973
 Site-QuickDraw | Val  Loss: 0.9792 | Val  Acc: 0.7273
 Site-QuickDraw | Val  Loss: 1.1912 | Val  Acc: 0.6263
 Site-Infograph | Val  Loss: 1.1733 | Val  Acc: 0.6545
Average Valid Accuracy: 0.8572
Aggregated Acc | Val Acc: 0.8064
============ Train epoch 22 ============
gmm
client-0 is in G-2
client-1 is in G-5
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-0
client-17 is in G-0
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[2, 2, 7, 8, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5050 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5316 | Train Acc: 0.8158
 Site-Clipart   | Train Loss: 0.5253 | Train Acc: 0.8772
 Site-Clipart   | Train Loss: 0.3510 | Train Acc: 0.8953
 Site-Clipart   | Train Loss: 0.3720 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.4273 | Train Acc: 0.8557
 Site-Clipart   | Train Loss: 0.4858 | Train Acc: 0.8488
 Site-Clipart   | Train Loss: 0.4720 | Train Acc: 0.8696
 Site-Real      | Train Loss: 0.3741 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.3322 | Train Acc: 0.9263
 Site-Real      | Train Loss: 0.3272 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.3128 | Train Acc: 0.9442
 Site-Real      | Train Loss: 0.2790 | Train Acc: 0.9348
 Site-Painting  | Train Loss: 0.5086 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.4926 | Train Acc: 0.8523
 Site-Painting  | Train Loss: 0.4050 | Train Acc: 0.9057
 Site-Sketch    | Train Loss: 0.5148 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.5679 | Train Acc: 0.8161
 Site-QuickDraw | Train Loss: 1.1140 | Train Acc: 0.6566
 Site-QuickDraw | Train Loss: 1.1213 | Train Acc: 0.6689
 Site-Infograph | Train Loss: 1.2461 | Train Acc: 0.6242
 Site-Clipart   | Val  Loss: 0.3685 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.3116 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5143 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.4529 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.4180 | Val  Acc: 0.8953
 Site-Clipart   | Val  Loss: 0.4878 | Val  Acc: 0.8992
 Site-Clipart   | Val  Loss: 0.6883 | Val  Acc: 0.8351
 Site-Clipart   | Val  Loss: 0.5076 | Val  Acc: 0.8488
 Site-Real      | Val  Loss: 0.4160 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2756 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.2608 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.4153 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.2244 | Val  Acc: 0.9486
 Site-Painting  | Val  Loss: 0.4888 | Val  Acc: 0.8590
 Site-Painting  | Val  Loss: 0.4375 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.4383 | Val  Acc: 0.8864
 Site-Sketch    | Val  Loss: 0.4859 | Val  Acc: 0.8687
 Site-Sketch    | Val  Loss: 0.6075 | Val  Acc: 0.7770
 Site-QuickDraw | Val  Loss: 0.8782 | Val  Acc: 0.5909
 Site-QuickDraw | Val  Loss: 1.1167 | Val  Acc: 0.6364
 Site-Infograph | Val  Loss: 1.1750 | Val  Acc: 0.6727
Average Valid Accuracy: 0.8494
Aggregated Acc | Val Acc: 0.7958
============ Train epoch 23 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-1
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-0
client-17 is in G-0
client-18 is in G-2
client-19 is in G-2
client-20 is in G-4
cnt=[2, 5, 2, 8, 1, 3, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4200 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5136 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.5214 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.4166 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.2947 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.4241 | Train Acc: 0.8299
 Site-Clipart   | Train Loss: 0.4872 | Train Acc: 0.8694
 Site-Clipart   | Train Loss: 0.4570 | Train Acc: 0.8719
 Site-Real      | Train Loss: 0.4007 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.3339 | Train Acc: 0.9368
 Site-Real      | Train Loss: 0.2982 | Train Acc: 0.9371
 Site-Real      | Train Loss: 0.3076 | Train Acc: 0.9442
 Site-Real      | Train Loss: 0.2584 | Train Acc: 0.9472
 Site-Painting  | Train Loss: 0.4871 | Train Acc: 0.8803
 Site-Painting  | Train Loss: 0.4403 | Train Acc: 0.8977
 Site-Painting  | Train Loss: 0.4179 | Train Acc: 0.8981
 Site-Sketch    | Train Loss: 0.5037 | Train Acc: 0.8725
 Site-Sketch    | Train Loss: 0.5736 | Train Acc: 0.8251
 Site-QuickDraw | Train Loss: 1.0725 | Train Acc: 0.6566
 Site-QuickDraw | Train Loss: 1.1123 | Train Acc: 0.6689
 Site-Infograph | Train Loss: 1.2148 | Train Acc: 0.6121
 Site-Clipart   | Val  Loss: 0.3915 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.2234 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.4434 | Val  Acc: 0.8158
 Site-Clipart   | Val  Loss: 0.4034 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.4387 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.4867 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.6464 | Val  Acc: 0.8505
 Site-Clipart   | Val  Loss: 0.5337 | Val  Acc: 0.8419
 Site-Real      | Val  Loss: 0.4042 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.2347 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.2948 | Val  Acc: 0.9158
 Site-Real      | Val  Loss: 0.3751 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.2355 | Val  Acc: 0.9533
 Site-Painting  | Val  Loss: 0.4939 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 0.4266 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.4166 | Val  Acc: 0.8807
 Site-Sketch    | Val  Loss: 0.5337 | Val  Acc: 0.8182
 Site-Sketch    | Val  Loss: 0.6018 | Val  Acc: 0.8041
 Site-QuickDraw | Val  Loss: 0.8587 | Val  Acc: 0.6970
 Site-QuickDraw | Val  Loss: 1.1760 | Val  Acc: 0.6465
 Site-Infograph | Val  Loss: 1.1587 | Val  Acc: 0.6364
Average Valid Accuracy: 0.8537
Aggregated Acc | Val Acc: 0.8017
============ Train epoch 24 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-5
client-17 is in G-5
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[5, 2, 8, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3199 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4687 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.5708 | Train Acc: 0.8246
 Site-Clipart   | Train Loss: 0.3627 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.6107 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.4044 | Train Acc: 0.8763
 Site-Clipart   | Train Loss: 0.4348 | Train Acc: 0.8935
 Site-Clipart   | Train Loss: 0.4297 | Train Acc: 0.9016
 Site-Real      | Train Loss: 0.3984 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2757 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2917 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2668 | Train Acc: 0.9349
 Site-Real      | Train Loss: 0.2749 | Train Acc: 0.9441
 Site-Painting  | Train Loss: 0.5283 | Train Acc: 0.8462
 Site-Painting  | Train Loss: 0.4489 | Train Acc: 0.8864
 Site-Painting  | Train Loss: 0.3403 | Train Acc: 0.8943
 Site-Sketch    | Train Loss: 0.5406 | Train Acc: 0.8322
 Site-Sketch    | Train Loss: 0.5571 | Train Acc: 0.8072
 Site-QuickDraw | Train Loss: 1.0769 | Train Acc: 0.6768
 Site-QuickDraw | Train Loss: 1.0190 | Train Acc: 0.6959
 Site-Infograph | Train Loss: 1.2166 | Train Acc: 0.5939
 Site-Clipart   | Val  Loss: 0.3741 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.2644 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.4683 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.4444 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.3907 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.3552 | Val  Acc: 0.9225
 Site-Clipart   | Val  Loss: 0.5798 | Val  Acc: 0.8505
 Site-Clipart   | Val  Loss: 0.5099 | Val  Acc: 0.8660
 Site-Real      | Val  Loss: 0.3400 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.3142 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.3284 | Val  Acc: 0.9158
 Site-Real      | Val  Loss: 0.4017 | Val  Acc: 0.9231
 Site-Real      | Val  Loss: 0.2259 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.4149 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.4507 | Val  Acc: 0.9060
 Site-Painting  | Val  Loss: 0.4022 | Val  Acc: 0.9034
 Site-Sketch    | Val  Loss: 0.5165 | Val  Acc: 0.8485
 Site-Sketch    | Val  Loss: 0.5535 | Val  Acc: 0.7973
 Site-QuickDraw | Val  Loss: 0.8464 | Val  Acc: 0.6212
 Site-QuickDraw | Val  Loss: 1.1592 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0865 | Val  Acc: 0.6818
Average Valid Accuracy: 0.8577
Aggregated Acc | Val Acc: 0.8100
============ Train epoch 25 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-5
client-17 is in G-5
client-18 is in G-0
client-19 is in G-0
client-20 is in G-3
cnt=[2, 8, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3846 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4502 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.5261 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.3099 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.5420 | Train Acc: 0.8915
 Site-Clipart   | Train Loss: 0.4872 | Train Acc: 0.8660
 Site-Clipart   | Train Loss: 0.4276 | Train Acc: 0.8935
 Site-Clipart   | Train Loss: 0.4242 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.3901 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2414 | Train Acc: 0.9579
 Site-Real      | Train Loss: 0.2752 | Train Acc: 0.9441
 Site-Real      | Train Loss: 0.2989 | Train Acc: 0.9488
 Site-Real      | Train Loss: 0.2500 | Train Acc: 0.9441
 Site-Painting  | Train Loss: 0.4466 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.4369 | Train Acc: 0.8864
 Site-Painting  | Train Loss: 0.3684 | Train Acc: 0.8981
 Site-Sketch    | Train Loss: 0.4260 | Train Acc: 0.8725
 Site-Sketch    | Train Loss: 0.5195 | Train Acc: 0.8341
 Site-QuickDraw | Train Loss: 1.1133 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 1.0231 | Train Acc: 0.6689
 Site-Infograph | Train Loss: 1.1890 | Train Acc: 0.6182
 Site-Clipart   | Val  Loss: 0.3241 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.2030 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.3479 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.3877 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.4014 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.3499 | Val  Acc: 0.8992
 Site-Clipart   | Val  Loss: 0.5650 | Val  Acc: 0.8608
 Site-Clipart   | Val  Loss: 0.5242 | Val  Acc: 0.8351
 Site-Real      | Val  Loss: 0.2890 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2487 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2747 | Val  Acc: 0.9158
 Site-Real      | Val  Loss: 0.3489 | Val  Acc: 0.9510
 Site-Real      | Val  Loss: 0.2452 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.4802 | Val  Acc: 0.9103
 Site-Painting  | Val  Loss: 0.4061 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3840 | Val  Acc: 0.9034
 Site-Sketch    | Val  Loss: 0.5180 | Val  Acc: 0.8283
 Site-Sketch    | Val  Loss: 0.5527 | Val  Acc: 0.8176
 Site-QuickDraw | Val  Loss: 1.0987 | Val  Acc: 0.6061
 Site-QuickDraw | Val  Loss: 1.1324 | Val  Acc: 0.6768
 Site-Infograph | Val  Loss: 1.1420 | Val  Acc: 0.6091
Average Valid Accuracy: 0.8636
Aggregated Acc | Val Acc: 0.8030
 Best site-Clipart    | Epoch:25 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:25 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:25 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:25 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:25 | Val Acc: 0.8721
 Best site-Clipart    | Epoch:25 | Val Acc: 0.8992
 Best site-Clipart    | Epoch:25 | Val Acc: 0.8608
 Best site-Clipart    | Epoch:25 | Val Acc: 0.8351
 Best site-Real       | Epoch:25 | Val Acc: 0.9524
 Best site-Real       | Epoch:25 | Val Acc: 0.9524
 Best site-Real       | Epoch:25 | Val Acc: 0.9158
 Best site-Real       | Epoch:25 | Val Acc: 0.9510
 Best site-Real       | Epoch:25 | Val Acc: 0.9626
 Best site-Painting   | Epoch:25 | Val Acc: 0.9103
 Best site-Painting   | Epoch:25 | Val Acc: 0.8974
 Best site-Painting   | Epoch:25 | Val Acc: 0.9034
 Best site-Sketch     | Epoch:25 | Val Acc: 0.8283
 Best site-Sketch     | Epoch:25 | Val Acc: 0.8176
 Best site-QuickDraw  | Epoch:25 | Val Acc: 0.6061
 Best site-QuickDraw  | Epoch:25 | Val Acc: 0.6768
 Best site-Infograph  | Epoch:25 | Val Acc: 0.6091
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 26 ============
gmm
client-0 is in G-5
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-4
client-9 is in G-4
client-10 is in G-4
client-11 is in G-4
client-12 is in G-4
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-2
client-17 is in G-2
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[3, 2, 2, 8, 5, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3416 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5124 | Train Acc: 0.8158
 Site-Clipart   | Train Loss: 0.5350 | Train Acc: 0.8246
 Site-Clipart   | Train Loss: 0.4166 | Train Acc: 0.8953
 Site-Clipart   | Train Loss: 0.3302 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.4871 | Train Acc: 0.8557
 Site-Clipart   | Train Loss: 0.4086 | Train Acc: 0.8729
 Site-Clipart   | Train Loss: 0.4167 | Train Acc: 0.9016
 Site-Real      | Train Loss: 0.4146 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2941 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2915 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2455 | Train Acc: 0.9581
 Site-Real      | Train Loss: 0.2953 | Train Acc: 0.9379
 Site-Painting  | Train Loss: 0.4594 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.4142 | Train Acc: 0.8693
 Site-Painting  | Train Loss: 0.3884 | Train Acc: 0.9132
 Site-Sketch    | Train Loss: 0.5359 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.5021 | Train Acc: 0.8251
 Site-QuickDraw | Train Loss: 1.0499 | Train Acc: 0.7172
 Site-QuickDraw | Train Loss: 1.0231 | Train Acc: 0.7162
 Site-Infograph | Train Loss: 1.2606 | Train Acc: 0.5818
 Site-Clipart   | Val  Loss: 0.2799 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.2403 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.4287 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.3962 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.3860 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.3914 | Val  Acc: 0.8992
 Site-Clipart   | Val  Loss: 0.6169 | Val  Acc: 0.8299
 Site-Clipart   | Val  Loss: 0.4648 | Val  Acc: 0.8729
 Site-Real      | Val  Loss: 0.3210 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2301 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2974 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.3493 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.2346 | Val  Acc: 0.9486
 Site-Painting  | Val  Loss: 0.4065 | Val  Acc: 0.8846
 Site-Painting  | Val  Loss: 0.3842 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.4048 | Val  Acc: 0.8864
 Site-Sketch    | Val  Loss: 0.4585 | Val  Acc: 0.8182
 Site-Sketch    | Val  Loss: 0.5245 | Val  Acc: 0.8176
 Site-QuickDraw | Val  Loss: 0.7905 | Val  Acc: 0.6970
 Site-QuickDraw | Val  Loss: 1.1049 | Val  Acc: 0.6465
 Site-Infograph | Val  Loss: 1.1375 | Val  Acc: 0.6636
Average Valid Accuracy: 0.8675
Aggregated Acc | Val Acc: 0.8553
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8721
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8992
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8299
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8729
 Best site-Real       | Epoch:26 | Val Acc: 0.9286
 Best site-Real       | Epoch:26 | Val Acc: 0.9524
 Best site-Real       | Epoch:26 | Val Acc: 0.9368
 Best site-Real       | Epoch:26 | Val Acc: 0.9580
 Best site-Real       | Epoch:26 | Val Acc: 0.9486
 Best site-Painting   | Epoch:26 | Val Acc: 0.8846
 Best site-Painting   | Epoch:26 | Val Acc: 0.9145
 Best site-Painting   | Epoch:26 | Val Acc: 0.8864
 Best site-Sketch     | Epoch:26 | Val Acc: 0.8182
 Best site-Sketch     | Epoch:26 | Val Acc: 0.8176
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.6970
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.6465
 Best site-Infograph  | Epoch:26 | Val Acc: 0.6636
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 27 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-5
client-6 is in G-5
client-7 is in G-5
client-8 is in G-1
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-0
client-17 is in G-0
client-18 is in G-2
client-19 is in G-2
client-20 is in G-3
cnt=[2, 8, 2, 1, 1, 7, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5269 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4236 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.5371 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.4287 | Train Acc: 0.8837
 Site-Clipart   | Train Loss: 0.9075 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.6165 | Train Acc: 0.8608
 Site-Clipart   | Train Loss: 0.4442 | Train Acc: 0.8591
 Site-Clipart   | Train Loss: 0.4052 | Train Acc: 0.9016
 Site-Real      | Train Loss: 0.3878 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.2473 | Train Acc: 0.9368
 Site-Real      | Train Loss: 0.2695 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.2528 | Train Acc: 0.9535
 Site-Real      | Train Loss: 0.2504 | Train Acc: 0.9472
 Site-Painting  | Train Loss: 0.4517 | Train Acc: 0.8632
 Site-Painting  | Train Loss: 0.4897 | Train Acc: 0.8636
 Site-Painting  | Train Loss: 0.4140 | Train Acc: 0.9019
 Site-Sketch    | Train Loss: 0.3903 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.5082 | Train Acc: 0.8117
 Site-QuickDraw | Train Loss: 1.0402 | Train Acc: 0.6869
 Site-QuickDraw | Train Loss: 0.9728 | Train Acc: 0.6892
 Site-Infograph | Train Loss: 1.2140 | Train Acc: 0.5939
 Site-Clipart   | Val  Loss: 0.3007 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.2894 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.4011 | Val  Acc: 0.8421
 Site-Clipart   | Val  Loss: 0.4081 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.3763 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.4304 | Val  Acc: 0.8605
 Site-Clipart   | Val  Loss: 0.5129 | Val  Acc: 0.8763
 Site-Clipart   | Val  Loss: 0.4981 | Val  Acc: 0.8522
 Site-Real      | Val  Loss: 0.3013 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2374 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.2588 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3566 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.2253 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.4438 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 0.3918 | Val  Acc: 0.9060
 Site-Painting  | Val  Loss: 0.3699 | Val  Acc: 0.9148
 Site-Sketch    | Val  Loss: 0.4594 | Val  Acc: 0.8586
 Site-Sketch    | Val  Loss: 0.5167 | Val  Acc: 0.8378
 Site-QuickDraw | Val  Loss: 0.7898 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.0835 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0624 | Val  Acc: 0.6909
Average Valid Accuracy: 0.8601
Aggregated Acc | Val Acc: 0.8217
============ Train epoch 28 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-5
client-17 is in G-5
client-18 is in G-1
client-19 is in G-1
client-20 is in G-2
cnt=[8, 2, 1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3467 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4438 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.5475 | Train Acc: 0.8246
 Site-Clipart   | Train Loss: 0.2898 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.3858 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.4883 | Train Acc: 0.8608
 Site-Clipart   | Train Loss: 0.4097 | Train Acc: 0.8694
 Site-Clipart   | Train Loss: 0.4302 | Train Acc: 0.8696
 Site-Real      | Train Loss: 0.3920 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.3034 | Train Acc: 0.9368
 Site-Real      | Train Loss: 0.2712 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2226 | Train Acc: 0.9581
 Site-Real      | Train Loss: 0.2904 | Train Acc: 0.9379
 Site-Painting  | Train Loss: 0.4307 | Train Acc: 0.8803
 Site-Painting  | Train Loss: 0.4180 | Train Acc: 0.8977
 Site-Painting  | Train Loss: 0.3474 | Train Acc: 0.9283
 Site-Sketch    | Train Loss: 0.4527 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.5249 | Train Acc: 0.8296
 Site-QuickDraw | Train Loss: 1.0072 | Train Acc: 0.7475
 Site-QuickDraw | Train Loss: 0.9801 | Train Acc: 0.7230
 Site-Infograph | Train Loss: 1.1554 | Train Acc: 0.6303
 Site-Clipart   | Val  Loss: 0.3125 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.2100 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4403 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.3618 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.3817 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.3778 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.6157 | Val  Acc: 0.8763
 Site-Clipart   | Val  Loss: 0.4974 | Val  Acc: 0.8454
 Site-Real      | Val  Loss: 0.3340 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.1831 | Val  Acc: 0.9683
 Site-Real      | Val  Loss: 0.2466 | Val  Acc: 0.9579
 Site-Real      | Val  Loss: 0.3917 | Val  Acc: 0.9441
 Site-Real      | Val  Loss: 0.2249 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.3919 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3817 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.3637 | Val  Acc: 0.9148
 Site-Sketch    | Val  Loss: 0.4340 | Val  Acc: 0.8788
 Site-Sketch    | Val  Loss: 0.4933 | Val  Acc: 0.8446
 Site-QuickDraw | Val  Loss: 0.6271 | Val  Acc: 0.7424
 Site-QuickDraw | Val  Loss: 1.0731 | Val  Acc: 0.6465
 Site-Infograph | Val  Loss: 1.0893 | Val  Acc: 0.6182
Average Valid Accuracy: 0.8733
Aggregated Acc | Val Acc: 0.8203
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8596
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8721
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8837
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8763
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8454
 Best site-Real       | Epoch:28 | Val Acc: 0.8810
 Best site-Real       | Epoch:28 | Val Acc: 0.9683
 Best site-Real       | Epoch:28 | Val Acc: 0.9579
 Best site-Real       | Epoch:28 | Val Acc: 0.9441
 Best site-Real       | Epoch:28 | Val Acc: 0.9579
 Best site-Painting   | Epoch:28 | Val Acc: 0.8974
 Best site-Painting   | Epoch:28 | Val Acc: 0.9145
 Best site-Painting   | Epoch:28 | Val Acc: 0.9148
 Best site-Sketch     | Epoch:28 | Val Acc: 0.8788
 Best site-Sketch     | Epoch:28 | Val Acc: 0.8446
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.7424
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.6465
 Best site-Infograph  | Epoch:28 | Val Acc: 0.6182
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 29 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-4
client-6 is in G-4
client-7 is in G-4
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-0
client-17 is in G-0
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[2, 2, 5, 1, 8, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4509 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4239 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.5143 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.3594 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.4249 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.5357 | Train Acc: 0.8763
 Site-Clipart   | Train Loss: 0.4008 | Train Acc: 0.8797
 Site-Clipart   | Train Loss: 0.3912 | Train Acc: 0.9039
 Site-Real      | Train Loss: 0.3632 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2476 | Train Acc: 0.9579
 Site-Real      | Train Loss: 0.2418 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2405 | Train Acc: 0.9535
 Site-Real      | Train Loss: 0.2350 | Train Acc: 0.9441
 Site-Painting  | Train Loss: 0.4401 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.4290 | Train Acc: 0.8750
 Site-Painting  | Train Loss: 0.4283 | Train Acc: 0.9208
 Site-Sketch    | Train Loss: 0.4500 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.5289 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 0.9405 | Train Acc: 0.6869
 Site-QuickDraw | Train Loss: 0.9071 | Train Acc: 0.7297
 Site-Infograph | Train Loss: 1.1664 | Train Acc: 0.6424
 Site-Clipart   | Val  Loss: 0.2792 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.2141 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.3442 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.3772 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.4062 | Val  Acc: 0.8372
 Site-Clipart   | Val  Loss: 0.3582 | Val  Acc: 0.9147
 Site-Clipart   | Val  Loss: 0.5569 | Val  Acc: 0.8763
 Site-Clipart   | Val  Loss: 0.4871 | Val  Acc: 0.8557
 Site-Real      | Val  Loss: 0.3592 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2327 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.2699 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.3676 | Val  Acc: 0.9510
 Site-Real      | Val  Loss: 0.1959 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.4266 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3869 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.3850 | Val  Acc: 0.8864
 Site-Sketch    | Val  Loss: 0.5137 | Val  Acc: 0.8384
 Site-Sketch    | Val  Loss: 0.4585 | Val  Acc: 0.8446
 Site-QuickDraw | Val  Loss: 0.7756 | Val  Acc: 0.6515
 Site-QuickDraw | Val  Loss: 1.0522 | Val  Acc: 0.6465
 Site-Infograph | Val  Loss: 1.1096 | Val  Acc: 0.6545
Average Valid Accuracy: 0.8687
Aggregated Acc | Val Acc: 0.8148
============ Train epoch 30 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-5
client-17 is in G-5
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[3, 2, 8, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4248 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4846 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.4868 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.3452 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.2814 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.4305 | Train Acc: 0.8814
 Site-Clipart   | Train Loss: 0.4136 | Train Acc: 0.8694
 Site-Clipart   | Train Loss: 0.3971 | Train Acc: 0.8902
 Site-Real      | Train Loss: 0.3677 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2593 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.3016 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2821 | Train Acc: 0.9442
 Site-Real      | Train Loss: 0.2761 | Train Acc: 0.9379
 Site-Painting  | Train Loss: 0.3915 | Train Acc: 0.8974
 Site-Painting  | Train Loss: 0.3920 | Train Acc: 0.8807
 Site-Painting  | Train Loss: 0.3860 | Train Acc: 0.9019
 Site-Sketch    | Train Loss: 0.4246 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.5023 | Train Acc: 0.8430
 Site-QuickDraw | Train Loss: 1.0017 | Train Acc: 0.7071
 Site-QuickDraw | Train Loss: 0.8749 | Train Acc: 0.7095
 Site-Infograph | Train Loss: 1.2043 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 0.3365 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.2261 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.3484 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.3436 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.3812 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.3890 | Val  Acc: 0.8760
 Site-Clipart   | Val  Loss: 0.5564 | Val  Acc: 0.8557
 Site-Clipart   | Val  Loss: 0.4817 | Val  Acc: 0.8522
 Site-Real      | Val  Loss: 0.3781 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 0.2108 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.2365 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3424 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.2183 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.4025 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.3586 | Val  Acc: 0.9060
 Site-Painting  | Val  Loss: 0.3201 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.4786 | Val  Acc: 0.8687
 Site-Sketch    | Val  Loss: 0.5543 | Val  Acc: 0.8041
 Site-QuickDraw | Val  Loss: 0.6341 | Val  Acc: 0.6970
 Site-QuickDraw | Val  Loss: 1.0070 | Val  Acc: 0.6566
 Site-Infograph | Val  Loss: 1.1320 | Val  Acc: 0.6273
Average Valid Accuracy: 0.8629
Aggregated Acc | Val Acc: 0.8104
============ Train epoch 31 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[7, 2, 8, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4164 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5021 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.4110 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.3047 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.6941 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.4564 | Train Acc: 0.8711
 Site-Clipart   | Train Loss: 0.4021 | Train Acc: 0.8763
 Site-Clipart   | Train Loss: 0.3756 | Train Acc: 0.9016
 Site-Real      | Train Loss: 0.4003 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.2375 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2119 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.2182 | Train Acc: 0.9488
 Site-Real      | Train Loss: 0.2504 | Train Acc: 0.9410
 Site-Painting  | Train Loss: 0.4354 | Train Acc: 0.8974
 Site-Painting  | Train Loss: 0.4115 | Train Acc: 0.8636
 Site-Painting  | Train Loss: 0.3796 | Train Acc: 0.9170
 Site-Sketch    | Train Loss: 0.4998 | Train Acc: 0.8725
 Site-Sketch    | Train Loss: 0.5258 | Train Acc: 0.8027
 Site-QuickDraw | Train Loss: 0.9139 | Train Acc: 0.7273
 Site-QuickDraw | Train Loss: 0.9607 | Train Acc: 0.6757
 Site-Infograph | Train Loss: 1.1128 | Train Acc: 0.6121
 Site-Clipart   | Val  Loss: 0.3773 | Val  Acc: 0.8235
 Site-Clipart   | Val  Loss: 0.2173 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4580 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.3875 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.3832 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.2998 | Val  Acc: 0.9225
 Site-Clipart   | Val  Loss: 0.5017 | Val  Acc: 0.8763
 Site-Clipart   | Val  Loss: 0.4733 | Val  Acc: 0.8522
 Site-Real      | Val  Loss: 0.3072 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2459 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.2187 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3298 | Val  Acc: 0.9301
 Site-Real      | Val  Loss: 0.2239 | Val  Acc: 0.9533
 Site-Painting  | Val  Loss: 0.3573 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3649 | Val  Acc: 0.9060
 Site-Painting  | Val  Loss: 0.3601 | Val  Acc: 0.8977
 Site-Sketch    | Val  Loss: 0.5220 | Val  Acc: 0.8384
 Site-Sketch    | Val  Loss: 0.5193 | Val  Acc: 0.8378
 Site-QuickDraw | Val  Loss: 0.7990 | Val  Acc: 0.6818
 Site-QuickDraw | Val  Loss: 1.0023 | Val  Acc: 0.6566
 Site-Infograph | Val  Loss: 1.0435 | Val  Acc: 0.6727
Average Valid Accuracy: 0.8657
Aggregated Acc | Val Acc: 0.8041
============ Train epoch 32 ============
gmm
client-0 is in G-1
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-1
client-17 is in G-1
client-18 is in G-2
client-19 is in G-2
client-20 is in G-4
cnt=[5, 9, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3129 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5402 | Train Acc: 0.8158
 Site-Clipart   | Train Loss: 0.4961 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.3943 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.2168 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.5816 | Train Acc: 0.8660
 Site-Clipart   | Train Loss: 0.3788 | Train Acc: 0.8832
 Site-Clipart   | Train Loss: 0.3807 | Train Acc: 0.8856
 Site-Real      | Train Loss: 0.3778 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2512 | Train Acc: 0.9368
 Site-Real      | Train Loss: 0.2607 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.2260 | Train Acc: 0.9302
 Site-Real      | Train Loss: 0.2383 | Train Acc: 0.9410
 Site-Painting  | Train Loss: 0.3936 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.3676 | Train Acc: 0.8864
 Site-Painting  | Train Loss: 0.3680 | Train Acc: 0.9245
 Site-Sketch    | Train Loss: 0.4519 | Train Acc: 0.8523
 Site-Sketch    | Train Loss: 0.4850 | Train Acc: 0.8386
 Site-QuickDraw | Train Loss: 0.8951 | Train Acc: 0.7273
 Site-QuickDraw | Train Loss: 0.8904 | Train Acc: 0.7095
 Site-Infograph | Train Loss: 1.0553 | Train Acc: 0.6424
 Site-Clipart   | Val  Loss: 0.3098 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.2372 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.3126 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.3477 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.3836 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.3511 | Val  Acc: 0.8915
 Site-Clipart   | Val  Loss: 0.4550 | Val  Acc: 0.8814
 Site-Clipart   | Val  Loss: 0.4607 | Val  Acc: 0.8797
 Site-Real      | Val  Loss: 0.3154 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2197 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2015 | Val  Acc: 0.9579
 Site-Real      | Val  Loss: 0.3271 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.2087 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.4272 | Val  Acc: 0.8846
 Site-Painting  | Val  Loss: 0.3626 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.3321 | Val  Acc: 0.9148
 Site-Sketch    | Val  Loss: 0.4594 | Val  Acc: 0.8485
 Site-Sketch    | Val  Loss: 0.5003 | Val  Acc: 0.8041
 Site-QuickDraw | Val  Loss: 0.6297 | Val  Acc: 0.7121
 Site-QuickDraw | Val  Loss: 0.9886 | Val  Acc: 0.6465
 Site-Infograph | Val  Loss: 1.0322 | Val  Acc: 0.6455
Average Valid Accuracy: 0.8713
Aggregated Acc | Val Acc: 0.8351
============ Train epoch 33 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-5
client-17 is in G-5
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[8, 2, 3, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3612 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3801 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.4531 | Train Acc: 0.8772
 Site-Clipart   | Train Loss: 0.2667 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.3703 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.3483 | Train Acc: 0.8866
 Site-Clipart   | Train Loss: 0.3834 | Train Acc: 0.8866
 Site-Clipart   | Train Loss: 0.3681 | Train Acc: 0.9062
 Site-Real      | Train Loss: 0.3567 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2472 | Train Acc: 0.9368
 Site-Real      | Train Loss: 0.2295 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.2851 | Train Acc: 0.9488
 Site-Real      | Train Loss: 0.2337 | Train Acc: 0.9472
 Site-Painting  | Train Loss: 0.4089 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.3838 | Train Acc: 0.8920
 Site-Painting  | Train Loss: 0.3215 | Train Acc: 0.9358
 Site-Sketch    | Train Loss: 0.3996 | Train Acc: 0.8725
 Site-Sketch    | Train Loss: 0.5007 | Train Acc: 0.8296
 Site-QuickDraw | Train Loss: 0.9218 | Train Acc: 0.7374
 Site-QuickDraw | Train Loss: 0.9305 | Train Acc: 0.7365
 Site-Infograph | Train Loss: 1.0739 | Train Acc: 0.6485
 Site-Clipart   | Val  Loss: 0.3665 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.2073 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.3314 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.3187 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.3868 | Val  Acc: 0.8605
 Site-Clipart   | Val  Loss: 0.3140 | Val  Acc: 0.9225
 Site-Clipart   | Val  Loss: 0.4537 | Val  Acc: 0.8969
 Site-Clipart   | Val  Loss: 0.4549 | Val  Acc: 0.8625
 Site-Real      | Val  Loss: 0.3048 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.1916 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2379 | Val  Acc: 0.9263
 Site-Real      | Val  Loss: 0.3226 | Val  Acc: 0.9510
 Site-Real      | Val  Loss: 0.2028 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.4008 | Val  Acc: 0.9103
 Site-Painting  | Val  Loss: 0.3783 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.3423 | Val  Acc: 0.9205
 Site-Sketch    | Val  Loss: 0.4284 | Val  Acc: 0.8586
 Site-Sketch    | Val  Loss: 0.5043 | Val  Acc: 0.8446
 Site-QuickDraw | Val  Loss: 0.6600 | Val  Acc: 0.7273
 Site-QuickDraw | Val  Loss: 0.9796 | Val  Acc: 0.6768
 Site-Infograph | Val  Loss: 1.0964 | Val  Acc: 0.6091
Average Valid Accuracy: 0.8760
Aggregated Acc | Val Acc: 0.8205
 Best site-Clipart    | Epoch:33 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9211
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9123
 Best site-Clipart    | Epoch:33 | Val Acc: 0.8605
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9225
 Best site-Clipart    | Epoch:33 | Val Acc: 0.8969
 Best site-Clipart    | Epoch:33 | Val Acc: 0.8625
 Best site-Real       | Epoch:33 | Val Acc: 0.9286
 Best site-Real       | Epoch:33 | Val Acc: 0.9524
 Best site-Real       | Epoch:33 | Val Acc: 0.9263
 Best site-Real       | Epoch:33 | Val Acc: 0.9510
 Best site-Real       | Epoch:33 | Val Acc: 0.9579
 Best site-Painting   | Epoch:33 | Val Acc: 0.9103
 Best site-Painting   | Epoch:33 | Val Acc: 0.9145
 Best site-Painting   | Epoch:33 | Val Acc: 0.9205
 Best site-Sketch     | Epoch:33 | Val Acc: 0.8586
 Best site-Sketch     | Epoch:33 | Val Acc: 0.8446
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.7273
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.6768
 Best site-Infograph  | Epoch:33 | Val Acc: 0.6091
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 34 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-5
client-17 is in G-5
client-18 is in G-2
client-19 is in G-2
client-20 is in G-4
cnt=[8, 3, 2, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3198 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5608 | Train Acc: 0.7895
 Site-Clipart   | Train Loss: 0.4861 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.2990 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.4079 | Train Acc: 0.8992
 Site-Clipart   | Train Loss: 0.3724 | Train Acc: 0.8608
 Site-Clipart   | Train Loss: 0.3669 | Train Acc: 0.8866
 Site-Clipart   | Train Loss: 0.3735 | Train Acc: 0.9016
 Site-Real      | Train Loss: 0.3592 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.1981 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.2382 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2173 | Train Acc: 0.9628
 Site-Real      | Train Loss: 0.2677 | Train Acc: 0.9379
 Site-Painting  | Train Loss: 0.4398 | Train Acc: 0.8547
 Site-Painting  | Train Loss: 0.3870 | Train Acc: 0.8920
 Site-Painting  | Train Loss: 0.4380 | Train Acc: 0.9057
 Site-Sketch    | Train Loss: 0.3653 | Train Acc: 0.8926
 Site-Sketch    | Train Loss: 0.4812 | Train Acc: 0.8430
 Site-QuickDraw | Train Loss: 0.8515 | Train Acc: 0.7475
 Site-QuickDraw | Train Loss: 0.8258 | Train Acc: 0.7568
 Site-Infograph | Train Loss: 1.0540 | Train Acc: 0.6545
 Site-Clipart   | Val  Loss: 0.3065 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.2271 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.3637 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.3272 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.3264 | Val  Acc: 0.8953
 Site-Clipart   | Val  Loss: 0.3136 | Val  Acc: 0.9302
 Site-Clipart   | Val  Loss: 0.4367 | Val  Acc: 0.8918
 Site-Clipart   | Val  Loss: 0.4567 | Val  Acc: 0.8729
 Site-Real      | Val  Loss: 0.2764 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.1760 | Val  Acc: 0.9683
 Site-Real      | Val  Loss: 0.2339 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.3456 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.1951 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.3887 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3604 | Val  Acc: 0.9060
 Site-Painting  | Val  Loss: 0.3362 | Val  Acc: 0.9205
 Site-Sketch    | Val  Loss: 0.4074 | Val  Acc: 0.8687
 Site-Sketch    | Val  Loss: 0.5497 | Val  Acc: 0.8108
 Site-QuickDraw | Val  Loss: 0.7111 | Val  Acc: 0.7879
 Site-QuickDraw | Val  Loss: 0.9491 | Val  Acc: 0.6970
 Site-Infograph | Val  Loss: 1.0464 | Val  Acc: 0.6727
Average Valid Accuracy: 0.8826
Aggregated Acc | Val Acc: 0.8357
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9123
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8953
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9302
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8918
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8729
 Best site-Real       | Epoch:34 | Val Acc: 0.9286
 Best site-Real       | Epoch:34 | Val Acc: 0.9683
 Best site-Real       | Epoch:34 | Val Acc: 0.9368
 Best site-Real       | Epoch:34 | Val Acc: 0.9371
 Best site-Real       | Epoch:34 | Val Acc: 0.9626
 Best site-Painting   | Epoch:34 | Val Acc: 0.8974
 Best site-Painting   | Epoch:34 | Val Acc: 0.9060
 Best site-Painting   | Epoch:34 | Val Acc: 0.9205
 Best site-Sketch     | Epoch:34 | Val Acc: 0.8687
 Best site-Sketch     | Epoch:34 | Val Acc: 0.8108
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.7879
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.6970
 Best site-Infograph  | Epoch:34 | Val Acc: 0.6727
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 35 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-4
client-17 is in G-4
client-18 is in G-2
client-19 is in G-2
client-20 is in G-0
cnt=[1, 8, 2, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3724 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4161 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.5538 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.4408 | Train Acc: 0.8837
 Site-Clipart   | Train Loss: 0.3126 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.3629 | Train Acc: 0.8557
 Site-Clipart   | Train Loss: 0.3982 | Train Acc: 0.8797
 Site-Clipart   | Train Loss: 0.3587 | Train Acc: 0.9085
 Site-Real      | Train Loss: 0.3624 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.2312 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.2297 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2394 | Train Acc: 0.9535
 Site-Real      | Train Loss: 0.2343 | Train Acc: 0.9410
 Site-Painting  | Train Loss: 0.3873 | Train Acc: 0.9060
 Site-Painting  | Train Loss: 0.3845 | Train Acc: 0.8977
 Site-Painting  | Train Loss: 0.3469 | Train Acc: 0.9094
 Site-Sketch    | Train Loss: 0.4482 | Train Acc: 0.8658
 Site-Sketch    | Train Loss: 0.5051 | Train Acc: 0.8520
 Site-QuickDraw | Train Loss: 0.8690 | Train Acc: 0.7576
 Site-QuickDraw | Train Loss: 0.8721 | Train Acc: 0.7432
 Site-Infograph | Train Loss: 1.0981 | Train Acc: 0.6485
 Site-Clipart   | Val  Loss: 0.2300 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1962 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.3005 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.3371 | Val  Acc: 0.8772
 Site-Clipart   | Val  Loss: 0.3605 | Val  Acc: 0.8605
 Site-Clipart   | Val  Loss: 0.3380 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.4665 | Val  Acc: 0.8814
 Site-Clipart   | Val  Loss: 0.4512 | Val  Acc: 0.8522
 Site-Real      | Val  Loss: 0.3637 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2181 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.2096 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3920 | Val  Acc: 0.9161
 Site-Real      | Val  Loss: 0.2091 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.3444 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.3121 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.3120 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.4888 | Val  Acc: 0.8283
 Site-Sketch    | Val  Loss: 0.4844 | Val  Acc: 0.8378
 Site-QuickDraw | Val  Loss: 0.7797 | Val  Acc: 0.7424
 Site-QuickDraw | Val  Loss: 0.9906 | Val  Acc: 0.6869
 Site-Infograph | Val  Loss: 1.0901 | Val  Acc: 0.6091
Average Valid Accuracy: 0.8740
Aggregated Acc | Val Acc: 0.8204
============ Train epoch 36 ============
gmm
client-0 is in G-2
client-1 is in G-5
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-5
client-6 is in G-5
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-5
client-17 is in G-5
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[3, 2, 2, 5, 1, 8, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3936 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3911 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.4816 | Train Acc: 0.8772
 Site-Clipart   | Train Loss: 0.3227 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.5065 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.3640 | Train Acc: 0.8814
 Site-Clipart   | Train Loss: 0.3452 | Train Acc: 0.8866
 Site-Clipart   | Train Loss: 0.3733 | Train Acc: 0.9085
 Site-Real      | Train Loss: 0.3946 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.2323 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2434 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.2653 | Train Acc: 0.9488
 Site-Real      | Train Loss: 0.2079 | Train Acc: 0.9410
 Site-Painting  | Train Loss: 0.3770 | Train Acc: 0.8803
 Site-Painting  | Train Loss: 0.3550 | Train Acc: 0.8807
 Site-Painting  | Train Loss: 0.3312 | Train Acc: 0.9358
 Site-Sketch    | Train Loss: 0.3968 | Train Acc: 0.8658
 Site-Sketch    | Train Loss: 0.4769 | Train Acc: 0.8386
 Site-QuickDraw | Train Loss: 0.8260 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 0.8863 | Train Acc: 0.7027
 Site-Infograph | Train Loss: 1.0789 | Train Acc: 0.6788
 Site-Clipart   | Val  Loss: 0.2994 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1974 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.3047 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.3287 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.3962 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.2972 | Val  Acc: 0.8915
 Site-Clipart   | Val  Loss: 0.4320 | Val  Acc: 0.8918
 Site-Clipart   | Val  Loss: 0.4489 | Val  Acc: 0.8832
 Site-Real      | Val  Loss: 0.2930 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2141 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2173 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3665 | Val  Acc: 0.9301
 Site-Real      | Val  Loss: 0.1847 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.4015 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3528 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.3222 | Val  Acc: 0.9318
 Site-Sketch    | Val  Loss: 0.4838 | Val  Acc: 0.8081
 Site-Sketch    | Val  Loss: 0.4543 | Val  Acc: 0.8243
 Site-QuickDraw | Val  Loss: 0.8171 | Val  Acc: 0.7879
 Site-QuickDraw | Val  Loss: 0.8992 | Val  Acc: 0.6869
 Site-Infograph | Val  Loss: 0.9993 | Val  Acc: 0.6364
Average Valid Accuracy: 0.8774
Aggregated Acc | Val Acc: 0.8362
============ Train epoch 37 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-5
client-17 is in G-5
client-18 is in G-2
client-19 is in G-2
client-20 is in G-3
cnt=[8, 5, 2, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4043 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4068 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.5822 | Train Acc: 0.8070
 Site-Clipart   | Train Loss: 0.3122 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.5046 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.6586 | Train Acc: 0.8711
 Site-Clipart   | Train Loss: 0.3642 | Train Acc: 0.8763
 Site-Clipart   | Train Loss: 0.3417 | Train Acc: 0.9108
 Site-Real      | Train Loss: 0.3930 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2574 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2312 | Train Acc: 0.9441
 Site-Real      | Train Loss: 0.2353 | Train Acc: 0.9442
 Site-Real      | Train Loss: 0.2464 | Train Acc: 0.9472
 Site-Painting  | Train Loss: 0.4171 | Train Acc: 0.8547
 Site-Painting  | Train Loss: 0.3932 | Train Acc: 0.8920
 Site-Painting  | Train Loss: 0.3111 | Train Acc: 0.9358
 Site-Sketch    | Train Loss: 0.3853 | Train Acc: 0.8658
 Site-Sketch    | Train Loss: 0.4670 | Train Acc: 0.8520
 Site-QuickDraw | Train Loss: 0.8931 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 0.8840 | Train Acc: 0.7432
 Site-Infograph | Train Loss: 1.0370 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 0.2780 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1986 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3164 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.3376 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.3037 | Val  Acc: 0.9070
 Site-Clipart   | Val  Loss: 0.3070 | Val  Acc: 0.9302
 Site-Clipart   | Val  Loss: 0.5183 | Val  Acc: 0.8918
 Site-Clipart   | Val  Loss: 0.4291 | Val  Acc: 0.8763
 Site-Real      | Val  Loss: 0.3011 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.2376 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.2863 | Val  Acc: 0.9158
 Site-Real      | Val  Loss: 0.3294 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.1775 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.3683 | Val  Acc: 0.9103
 Site-Painting  | Val  Loss: 0.3453 | Val  Acc: 0.9402
 Site-Painting  | Val  Loss: 0.3211 | Val  Acc: 0.9318
 Site-Sketch    | Val  Loss: 0.4343 | Val  Acc: 0.8283
 Site-Sketch    | Val  Loss: 0.4962 | Val  Acc: 0.8243
 Site-QuickDraw | Val  Loss: 0.5686 | Val  Acc: 0.7424
 Site-QuickDraw | Val  Loss: 0.8988 | Val  Acc: 0.6566
 Site-Infograph | Val  Loss: 1.0565 | Val  Acc: 0.6727
Average Valid Accuracy: 0.8850
Aggregated Acc | Val Acc: 0.8307
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9737
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9123
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9070
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9302
 Best site-Clipart    | Epoch:37 | Val Acc: 0.8918
 Best site-Clipart    | Epoch:37 | Val Acc: 0.8763
 Best site-Real       | Epoch:37 | Val Acc: 0.9048
 Best site-Real       | Epoch:37 | Val Acc: 0.9206
 Best site-Real       | Epoch:37 | Val Acc: 0.9158
 Best site-Real       | Epoch:37 | Val Acc: 0.9371
 Best site-Real       | Epoch:37 | Val Acc: 0.9673
 Best site-Painting   | Epoch:37 | Val Acc: 0.9103
 Best site-Painting   | Epoch:37 | Val Acc: 0.9402
 Best site-Painting   | Epoch:37 | Val Acc: 0.9318
 Best site-Sketch     | Epoch:37 | Val Acc: 0.8283
 Best site-Sketch     | Epoch:37 | Val Acc: 0.8243
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.7424
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.6566
 Best site-Infograph  | Epoch:37 | Val Acc: 0.6727
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 38 ============
gmm
client-0 is in G-1
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-1
client-17 is in G-1
client-18 is in G-2
client-19 is in G-2
client-20 is in G-3
cnt=[5, 9, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3519 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4984 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.4337 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.2774 | Train Acc: 0.9186
 Site-Clipart   | Train Loss: 0.3831 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.4290 | Train Acc: 0.8711
 Site-Clipart   | Train Loss: 0.3418 | Train Acc: 0.8935
 Site-Clipart   | Train Loss: 0.3262 | Train Acc: 0.9291
 Site-Real      | Train Loss: 0.3340 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.2544 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2339 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2322 | Train Acc: 0.9535
 Site-Real      | Train Loss: 0.2675 | Train Acc: 0.9317
 Site-Painting  | Train Loss: 0.3825 | Train Acc: 0.9145
 Site-Painting  | Train Loss: 0.3665 | Train Acc: 0.8807
 Site-Painting  | Train Loss: 0.3302 | Train Acc: 0.9358
 Site-Sketch    | Train Loss: 0.4542 | Train Acc: 0.8926
 Site-Sketch    | Train Loss: 0.4439 | Train Acc: 0.8341
 Site-QuickDraw | Train Loss: 0.9365 | Train Acc: 0.7071
 Site-QuickDraw | Train Loss: 0.8291 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 1.0503 | Train Acc: 0.6303
 Site-Clipart   | Val  Loss: 0.2362 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1858 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2328 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.3089 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.3550 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.2948 | Val  Acc: 0.8992
 Site-Clipart   | Val  Loss: 0.4823 | Val  Acc: 0.9278
 Site-Clipart   | Val  Loss: 0.4463 | Val  Acc: 0.8694
 Site-Real      | Val  Loss: 0.3478 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.2181 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.2340 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3233 | Val  Acc: 0.9441
 Site-Real      | Val  Loss: 0.2080 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.3340 | Val  Acc: 0.9359
 Site-Painting  | Val  Loss: 0.3522 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.3421 | Val  Acc: 0.8920
 Site-Sketch    | Val  Loss: 0.4186 | Val  Acc: 0.8687
 Site-Sketch    | Val  Loss: 0.4869 | Val  Acc: 0.8243
 Site-QuickDraw | Val  Loss: 0.7045 | Val  Acc: 0.7424
 Site-QuickDraw | Val  Loss: 0.9674 | Val  Acc: 0.6970
 Site-Infograph | Val  Loss: 1.0002 | Val  Acc: 0.6909
Average Valid Accuracy: 0.8858
Aggregated Acc | Val Acc: 0.8533
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9737
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9123
 Best site-Clipart    | Epoch:38 | Val Acc: 0.8837
 Best site-Clipart    | Epoch:38 | Val Acc: 0.8992
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9278
 Best site-Clipart    | Epoch:38 | Val Acc: 0.8694
 Best site-Real       | Epoch:38 | Val Acc: 0.8810
 Best site-Real       | Epoch:38 | Val Acc: 0.9206
 Best site-Real       | Epoch:38 | Val Acc: 0.9474
 Best site-Real       | Epoch:38 | Val Acc: 0.9441
 Best site-Real       | Epoch:38 | Val Acc: 0.9673
 Best site-Painting   | Epoch:38 | Val Acc: 0.9359
 Best site-Painting   | Epoch:38 | Val Acc: 0.9231
 Best site-Painting   | Epoch:38 | Val Acc: 0.8920
 Best site-Sketch     | Epoch:38 | Val Acc: 0.8687
 Best site-Sketch     | Epoch:38 | Val Acc: 0.8243
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.7424
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.6970
 Best site-Infograph  | Epoch:38 | Val Acc: 0.6909
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 39 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-5
client-6 is in G-5
client-7 is in G-5
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-1
client-14 is in G-1
client-15 is in G-1
client-16 is in G-5
client-17 is in G-5
client-18 is in G-2
client-19 is in G-2
client-20 is in G-4
cnt=[1, 3, 2, 5, 1, 9, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2935 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4601 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.5025 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.4157 | Train Acc: 0.8953
 Site-Clipart   | Train Loss: 0.2620 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.5037 | Train Acc: 0.8969
 Site-Clipart   | Train Loss: 0.3417 | Train Acc: 0.8866
 Site-Clipart   | Train Loss: 0.3445 | Train Acc: 0.9039
 Site-Real      | Train Loss: 0.3737 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2567 | Train Acc: 0.9579
 Site-Real      | Train Loss: 0.2211 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.2312 | Train Acc: 0.9488
 Site-Real      | Train Loss: 0.2200 | Train Acc: 0.9472
 Site-Painting  | Train Loss: 0.3645 | Train Acc: 0.8974
 Site-Painting  | Train Loss: 0.3983 | Train Acc: 0.8636
 Site-Painting  | Train Loss: 0.3521 | Train Acc: 0.9245
 Site-Sketch    | Train Loss: 0.3601 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.5064 | Train Acc: 0.8341
 Site-QuickDraw | Train Loss: 0.8974 | Train Acc: 0.7374
 Site-QuickDraw | Train Loss: 0.8193 | Train Acc: 0.7635
 Site-Infograph | Train Loss: 0.9629 | Train Acc: 0.7333
 Site-Clipart   | Val  Loss: 0.2809 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.1692 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2992 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.4016 | Val  Acc: 0.8596
 Site-Clipart   | Val  Loss: 0.3025 | Val  Acc: 0.8837
 Site-Clipart   | Val  Loss: 0.2875 | Val  Acc: 0.9380
 Site-Clipart   | Val  Loss: 0.4648 | Val  Acc: 0.9072
 Site-Clipart   | Val  Loss: 0.4301 | Val  Acc: 0.8729
 Site-Real      | Val  Loss: 0.3129 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2221 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.2140 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3258 | Val  Acc: 0.9510
 Site-Real      | Val  Loss: 0.2144 | Val  Acc: 0.9533
 Site-Painting  | Val  Loss: 0.3854 | Val  Acc: 0.9103
 Site-Painting  | Val  Loss: 0.2907 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.3488 | Val  Acc: 0.9148
 Site-Sketch    | Val  Loss: 0.4292 | Val  Acc: 0.8384
 Site-Sketch    | Val  Loss: 0.4669 | Val  Acc: 0.8514
 Site-QuickDraw | Val  Loss: 0.8923 | Val  Acc: 0.7424
 Site-QuickDraw | Val  Loss: 0.9245 | Val  Acc: 0.6970
 Site-Infograph | Val  Loss: 1.1056 | Val  Acc: 0.6364
Average Valid Accuracy: 0.8804
Aggregated Acc | Val Acc: 0.8498
============ Train epoch 40 ============
gmm
client-0 is in G-0
client-1 is in G-5
client-2 is in G-0
client-3 is in G-5
client-4 is in G-0
client-5 is in G-5
client-6 is in G-5
client-7 is in G-5
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-5
client-17 is in G-0
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[4, 2, 5, 3, 1, 6, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3670 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3601 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.4730 | Train Acc: 0.8246
 Site-Clipart   | Train Loss: 0.2766 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.5068 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.3402 | Train Acc: 0.8608
 Site-Clipart   | Train Loss: 0.3832 | Train Acc: 0.8935
 Site-Clipart   | Train Loss: 0.3380 | Train Acc: 0.9245
 Site-Real      | Train Loss: 0.3693 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2394 | Train Acc: 0.9579
 Site-Real      | Train Loss: 0.1758 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2425 | Train Acc: 0.9628
 Site-Real      | Train Loss: 0.2163 | Train Acc: 0.9379
 Site-Painting  | Train Loss: 0.4074 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.3042 | Train Acc: 0.9205
 Site-Painting  | Train Loss: 0.2969 | Train Acc: 0.8981
 Site-Sketch    | Train Loss: 0.3432 | Train Acc: 0.8523
 Site-Sketch    | Train Loss: 0.4799 | Train Acc: 0.8520
 Site-QuickDraw | Train Loss: 0.9747 | Train Acc: 0.6970
 Site-QuickDraw | Train Loss: 0.8354 | Train Acc: 0.7905
 Site-Infograph | Train Loss: 1.0089 | Train Acc: 0.6303
 Site-Clipart   | Val  Loss: 0.2290 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1721 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2973 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.3313 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.3209 | Val  Acc: 0.9070
 Site-Clipart   | Val  Loss: 0.2840 | Val  Acc: 0.9070
 Site-Clipart   | Val  Loss: 0.4864 | Val  Acc: 0.8814
 Site-Clipart   | Val  Loss: 0.4205 | Val  Acc: 0.8625
 Site-Real      | Val  Loss: 0.3531 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.2062 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.2382 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.2771 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.2023 | Val  Acc: 0.9533
 Site-Painting  | Val  Loss: 0.3663 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.3523 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.3383 | Val  Acc: 0.9034
 Site-Sketch    | Val  Loss: 0.4023 | Val  Acc: 0.8687
 Site-Sketch    | Val  Loss: 0.4271 | Val  Acc: 0.8311
 Site-QuickDraw | Val  Loss: 0.7414 | Val  Acc: 0.7424
 Site-QuickDraw | Val  Loss: 0.9190 | Val  Acc: 0.6970
 Site-Infograph | Val  Loss: 0.9742 | Val  Acc: 0.7091
Average Valid Accuracy: 0.8830
Aggregated Acc | Val Acc: 0.8455
============ Train epoch 41 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-5
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-4
client-9 is in G-4
client-10 is in G-4
client-11 is in G-4
client-12 is in G-4
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[9, 2, 3, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3332 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4138 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.4730 | Train Acc: 0.8772
 Site-Clipart   | Train Loss: 0.2992 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.2098 | Train Acc: 0.9457
 Site-Clipart   | Train Loss: 0.4175 | Train Acc: 0.8814
 Site-Clipart   | Train Loss: 0.3308 | Train Acc: 0.8900
 Site-Clipart   | Train Loss: 0.3347 | Train Acc: 0.9153
 Site-Real      | Train Loss: 0.4056 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.2180 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.1917 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2050 | Train Acc: 0.9535
 Site-Real      | Train Loss: 0.2124 | Train Acc: 0.9379
 Site-Painting  | Train Loss: 0.4042 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.3461 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.2669 | Train Acc: 0.9358
 Site-Sketch    | Train Loss: 0.4287 | Train Acc: 0.8389
 Site-Sketch    | Train Loss: 0.4303 | Train Acc: 0.8430
 Site-QuickDraw | Train Loss: 0.7796 | Train Acc: 0.7475
 Site-QuickDraw | Train Loss: 0.8339 | Train Acc: 0.7568
 Site-Infograph | Train Loss: 0.9269 | Train Acc: 0.6727
 Site-Clipart   | Val  Loss: 0.2840 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.1747 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2443 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.3472 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.3424 | Val  Acc: 0.9070
 Site-Clipart   | Val  Loss: 0.3297 | Val  Acc: 0.9225
 Site-Clipart   | Val  Loss: 0.3941 | Val  Acc: 0.8969
 Site-Clipart   | Val  Loss: 0.4526 | Val  Acc: 0.8694
 Site-Real      | Val  Loss: 0.2960 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2439 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.2155 | Val  Acc: 0.9579
 Site-Real      | Val  Loss: 0.3268 | Val  Acc: 0.9580
 Site-Real      | Val  Loss: 0.2101 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.3136 | Val  Acc: 0.9103
 Site-Painting  | Val  Loss: 0.2983 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.3110 | Val  Acc: 0.9148
 Site-Sketch    | Val  Loss: 0.3902 | Val  Acc: 0.8485
 Site-Sketch    | Val  Loss: 0.4875 | Val  Acc: 0.8581
 Site-QuickDraw | Val  Loss: 0.8903 | Val  Acc: 0.7727
 Site-QuickDraw | Val  Loss: 0.8913 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0348 | Val  Acc: 0.6545
Average Valid Accuracy: 0.8864
Aggregated Acc | Val Acc: 0.8514
 Best site-Clipart    | Epoch:41 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:41 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:41 | Val Acc: 0.9737
 Best site-Clipart    | Epoch:41 | Val Acc: 0.9123
 Best site-Clipart    | Epoch:41 | Val Acc: 0.9070
 Best site-Clipart    | Epoch:41 | Val Acc: 0.9225
 Best site-Clipart    | Epoch:41 | Val Acc: 0.8969
 Best site-Clipart    | Epoch:41 | Val Acc: 0.8694
 Best site-Real       | Epoch:41 | Val Acc: 0.9286
 Best site-Real       | Epoch:41 | Val Acc: 0.9206
 Best site-Real       | Epoch:41 | Val Acc: 0.9579
 Best site-Real       | Epoch:41 | Val Acc: 0.9580
 Best site-Real       | Epoch:41 | Val Acc: 0.9673
 Best site-Painting   | Epoch:41 | Val Acc: 0.9103
 Best site-Painting   | Epoch:41 | Val Acc: 0.9316
 Best site-Painting   | Epoch:41 | Val Acc: 0.9148
 Best site-Sketch     | Epoch:41 | Val Acc: 0.8485
 Best site-Sketch     | Epoch:41 | Val Acc: 0.8581
 Best site-QuickDraw  | Epoch:41 | Val Acc: 0.7727
 Best site-QuickDraw  | Epoch:41 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:41 | Val Acc: 0.6545
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 42 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-0
client-17 is in G-0
client-18 is in G-2
client-19 is in G-2
client-20 is in G-4
cnt=[2, 8, 2, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4248 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4578 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.4345 | Train Acc: 0.8772
 Site-Clipart   | Train Loss: 0.2565 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.4217 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.3513 | Train Acc: 0.8918
 Site-Clipart   | Train Loss: 0.3528 | Train Acc: 0.8866
 Site-Clipart   | Train Loss: 0.3319 | Train Acc: 0.9153
 Site-Real      | Train Loss: 0.3308 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.2699 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2933 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2041 | Train Acc: 0.9581
 Site-Real      | Train Loss: 0.2465 | Train Acc: 0.9348
 Site-Painting  | Train Loss: 0.3827 | Train Acc: 0.8632
 Site-Painting  | Train Loss: 0.3788 | Train Acc: 0.8920
 Site-Painting  | Train Loss: 0.2685 | Train Acc: 0.9170
 Site-Sketch    | Train Loss: 0.3944 | Train Acc: 0.8792
 Site-Sketch    | Train Loss: 0.4062 | Train Acc: 0.8744
 Site-QuickDraw | Train Loss: 0.8480 | Train Acc: 0.7576
 Site-QuickDraw | Train Loss: 0.8279 | Train Acc: 0.7905
 Site-Infograph | Train Loss: 0.9728 | Train Acc: 0.6727
 Site-Clipart   | Val  Loss: 0.2738 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.1827 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3002 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.3070 | Val  Acc: 0.8947
 Site-Clipart   | Val  Loss: 0.3518 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.3571 | Val  Acc: 0.8915
 Site-Clipart   | Val  Loss: 0.3652 | Val  Acc: 0.8660
 Site-Clipart   | Val  Loss: 0.4059 | Val  Acc: 0.8797
 Site-Real      | Val  Loss: 0.3300 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.1609 | Val  Acc: 0.9841
 Site-Real      | Val  Loss: 0.1762 | Val  Acc: 0.9789
 Site-Real      | Val  Loss: 0.3552 | Val  Acc: 0.9301
 Site-Real      | Val  Loss: 0.1747 | Val  Acc: 0.9626
 Site-Painting  | Val  Loss: 0.3592 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3219 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.3070 | Val  Acc: 0.9261
 Site-Sketch    | Val  Loss: 0.3670 | Val  Acc: 0.8990
 Site-Sketch    | Val  Loss: 0.4745 | Val  Acc: 0.8649
 Site-QuickDraw | Val  Loss: 0.7396 | Val  Acc: 0.7576
 Site-QuickDraw | Val  Loss: 0.8929 | Val  Acc: 0.7475
 Site-Infograph | Val  Loss: 1.0053 | Val  Acc: 0.6727
Average Valid Accuracy: 0.8869
Aggregated Acc | Val Acc: 0.8447
 Best site-Clipart    | Epoch:42 | Val Acc: 0.8824
 Best site-Clipart    | Epoch:42 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:42 | Val Acc: 0.9211
 Best site-Clipart    | Epoch:42 | Val Acc: 0.8947
 Best site-Clipart    | Epoch:42 | Val Acc: 0.8721
 Best site-Clipart    | Epoch:42 | Val Acc: 0.8915
 Best site-Clipart    | Epoch:42 | Val Acc: 0.8660
 Best site-Clipart    | Epoch:42 | Val Acc: 0.8797
 Best site-Real       | Epoch:42 | Val Acc: 0.8810
 Best site-Real       | Epoch:42 | Val Acc: 0.9841
 Best site-Real       | Epoch:42 | Val Acc: 0.9789
 Best site-Real       | Epoch:42 | Val Acc: 0.9301
 Best site-Real       | Epoch:42 | Val Acc: 0.9626
 Best site-Painting   | Epoch:42 | Val Acc: 0.8974
 Best site-Painting   | Epoch:42 | Val Acc: 0.9145
 Best site-Painting   | Epoch:42 | Val Acc: 0.9261
 Best site-Sketch     | Epoch:42 | Val Acc: 0.8990
 Best site-Sketch     | Epoch:42 | Val Acc: 0.8649
 Best site-QuickDraw  | Epoch:42 | Val Acc: 0.7576
 Best site-QuickDraw  | Epoch:42 | Val Acc: 0.7475
 Best site-Infograph  | Epoch:42 | Val Acc: 0.6727
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-3
client-17 is in G-3
client-18 is in G-1
client-19 is in G-1
client-20 is in G-4
cnt=[8, 2, 5, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4405 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4416 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.4953 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.2466 | Train Acc: 0.9651
 Site-Clipart   | Train Loss: 0.3214 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.3181 | Train Acc: 0.8866
 Site-Clipart   | Train Loss: 0.3580 | Train Acc: 0.8832
 Site-Clipart   | Train Loss: 0.3173 | Train Acc: 0.9176
 Site-Real      | Train Loss: 0.3644 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2040 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2005 | Train Acc: 0.9510
 Site-Real      | Train Loss: 0.2131 | Train Acc: 0.9535
 Site-Real      | Train Loss: 0.2074 | Train Acc: 0.9441
 Site-Painting  | Train Loss: 0.3946 | Train Acc: 0.8632
 Site-Painting  | Train Loss: 0.3369 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.2644 | Train Acc: 0.9396
 Site-Sketch    | Train Loss: 0.4303 | Train Acc: 0.8658
 Site-Sketch    | Train Loss: 0.4252 | Train Acc: 0.8789
 Site-QuickDraw | Train Loss: 0.7873 | Train Acc: 0.7576
 Site-QuickDraw | Train Loss: 0.7824 | Train Acc: 0.7635
 Site-Infograph | Train Loss: 0.9558 | Train Acc: 0.6788
 Site-Clipart   | Val  Loss: 0.2878 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1798 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2860 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2896 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.3223 | Val  Acc: 0.9186
 Site-Clipart   | Val  Loss: 0.2561 | Val  Acc: 0.9147
 Site-Clipart   | Val  Loss: 0.5074 | Val  Acc: 0.9021
 Site-Clipart   | Val  Loss: 0.4308 | Val  Acc: 0.8488
 Site-Real      | Val  Loss: 0.2937 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.1966 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2794 | Val  Acc: 0.9263
 Site-Real      | Val  Loss: 0.3562 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.1899 | Val  Acc: 0.9486
 Site-Painting  | Val  Loss: 0.3192 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.3364 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.2897 | Val  Acc: 0.9261
 Site-Sketch    | Val  Loss: 0.4003 | Val  Acc: 0.8687
 Site-Sketch    | Val  Loss: 0.4395 | Val  Acc: 0.8514
 Site-QuickDraw | Val  Loss: 0.6067 | Val  Acc: 0.8030
 Site-QuickDraw | Val  Loss: 0.8904 | Val  Acc: 0.7475
 Site-Infograph | Val  Loss: 0.9325 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8936
Aggregated Acc | Val Acc: 0.8518
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9474
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9298
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9186
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9147
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9021
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8488
 Best site-Real       | Epoch:43 | Val Acc: 0.9048
 Best site-Real       | Epoch:43 | Val Acc: 0.9524
 Best site-Real       | Epoch:43 | Val Acc: 0.9263
 Best site-Real       | Epoch:43 | Val Acc: 0.9371
 Best site-Real       | Epoch:43 | Val Acc: 0.9486
 Best site-Painting   | Epoch:43 | Val Acc: 0.9231
 Best site-Painting   | Epoch:43 | Val Acc: 0.9145
 Best site-Painting   | Epoch:43 | Val Acc: 0.9261
 Best site-Sketch     | Epoch:43 | Val Acc: 0.8687
 Best site-Sketch     | Epoch:43 | Val Acc: 0.8514
 Best site-QuickDraw  | Epoch:43 | Val Acc: 0.8030
 Best site-QuickDraw  | Epoch:43 | Val Acc: 0.7475
 Best site-Infograph  | Epoch:43 | Val Acc: 0.7000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 44 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-0
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-4
client-17 is in G-4
client-18 is in G-3
client-19 is in G-3
client-20 is in G-5
cnt=[5, 8, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3339 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3589 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.4065 | Train Acc: 0.8947
 Site-Clipart   | Train Loss: 0.3169 | Train Acc: 0.9070
 Site-Clipart   | Train Loss: 0.2317 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.3430 | Train Acc: 0.8763
 Site-Clipart   | Train Loss: 0.3360 | Train Acc: 0.8900
 Site-Clipart   | Train Loss: 0.3342 | Train Acc: 0.9108
 Site-Real      | Train Loss: 0.3734 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2222 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2975 | Train Acc: 0.9441
 Site-Real      | Train Loss: 0.1938 | Train Acc: 0.9488
 Site-Real      | Train Loss: 0.2022 | Train Acc: 0.9534
 Site-Painting  | Train Loss: 0.4029 | Train Acc: 0.8632
 Site-Painting  | Train Loss: 0.3204 | Train Acc: 0.9148
 Site-Painting  | Train Loss: 0.2769 | Train Acc: 0.9283
 Site-Sketch    | Train Loss: 0.4923 | Train Acc: 0.8456
 Site-Sketch    | Train Loss: 0.4739 | Train Acc: 0.8565
 Site-QuickDraw | Train Loss: 0.8250 | Train Acc: 0.7576
 Site-QuickDraw | Train Loss: 0.8237 | Train Acc: 0.7568
 Site-Infograph | Train Loss: 0.8977 | Train Acc: 0.7152
 Site-Clipart   | Val  Loss: 0.2719 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.1603 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2926 | Val  Acc: 0.9211
 Site-Clipart   | Val  Loss: 0.2743 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2709 | Val  Acc: 0.8953
 Site-Clipart   | Val  Loss: 0.2406 | Val  Acc: 0.9070
 Site-Clipart   | Val  Loss: 0.4282 | Val  Acc: 0.8763
 Site-Clipart   | Val  Loss: 0.3973 | Val  Acc: 0.8729
 Site-Real      | Val  Loss: 0.3007 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.2056 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.2373 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.2994 | Val  Acc: 0.9441
 Site-Real      | Val  Loss: 0.1833 | Val  Acc: 0.9720
 Site-Painting  | Val  Loss: 0.3216 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.3067 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.2878 | Val  Acc: 0.9432
 Site-Sketch    | Val  Loss: 0.3522 | Val  Acc: 0.8889
 Site-Sketch    | Val  Loss: 0.4055 | Val  Acc: 0.8514
 Site-QuickDraw | Val  Loss: 0.5909 | Val  Acc: 0.7424
 Site-QuickDraw | Val  Loss: 0.8575 | Val  Acc: 0.7677
 Site-Infograph | Val  Loss: 1.0254 | Val  Acc: 0.6727
Average Valid Accuracy: 0.8894
Aggregated Acc | Val Acc: 0.8457
============ Train epoch 45 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-5
client-11 is in G-5
client-12 is in G-5
client-13 is in G-0
client-14 is in G-0
client-15 is in G-0
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[3, 2, 8, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3337 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3445 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.4785 | Train Acc: 0.8246
 Site-Clipart   | Train Loss: 0.2659 | Train Acc: 0.9186
 Site-Clipart   | Train Loss: 0.2098 | Train Acc: 0.9302
 Site-Clipart   | Train Loss: 0.3127 | Train Acc: 0.8866
 Site-Clipart   | Train Loss: 0.3466 | Train Acc: 0.8900
 Site-Clipart   | Train Loss: 0.3073 | Train Acc: 0.9245
 Site-Real      | Train Loss: 0.3463 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.2014 | Train Acc: 0.9579
 Site-Real      | Train Loss: 0.1816 | Train Acc: 0.9650
 Site-Real      | Train Loss: 0.1857 | Train Acc: 0.9581
 Site-Real      | Train Loss: 0.2092 | Train Acc: 0.9503
 Site-Painting  | Train Loss: 0.3748 | Train Acc: 0.8718
 Site-Painting  | Train Loss: 0.3564 | Train Acc: 0.9034
 Site-Painting  | Train Loss: 0.3148 | Train Acc: 0.9208
 Site-Sketch    | Train Loss: 0.3660 | Train Acc: 0.8591
 Site-Sketch    | Train Loss: 0.4107 | Train Acc: 0.8565
 Site-QuickDraw | Train Loss: 0.8093 | Train Acc: 0.7576
 Site-QuickDraw | Train Loss: 0.7954 | Train Acc: 0.7365
 Site-Infograph | Train Loss: 0.9471 | Train Acc: 0.6909
 Site-Clipart   | Val  Loss: 0.2174 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1979 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2533 | Val  Acc: 0.9737
 Site-Clipart   | Val  Loss: 0.2950 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.3441 | Val  Acc: 0.8488
 Site-Clipart   | Val  Loss: 0.2320 | Val  Acc: 0.9225
 Site-Clipart   | Val  Loss: 0.3895 | Val  Acc: 0.8866
 Site-Clipart   | Val  Loss: 0.4117 | Val  Acc: 0.8625
 Site-Real      | Val  Loss: 0.3030 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2374 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.1831 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3258 | Val  Acc: 0.9231
 Site-Real      | Val  Loss: 0.1726 | Val  Acc: 0.9673
 Site-Painting  | Val  Loss: 0.3594 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.2813 | Val  Acc: 0.9402
 Site-Painting  | Val  Loss: 0.2991 | Val  Acc: 0.9148
 Site-Sketch    | Val  Loss: 0.3730 | Val  Acc: 0.8788
 Site-Sketch    | Val  Loss: 0.4738 | Val  Acc: 0.8311
 Site-QuickDraw | Val  Loss: 0.4865 | Val  Acc: 0.7273
 Site-QuickDraw | Val  Loss: 0.9010 | Val  Acc: 0.7374
 Site-Infograph | Val  Loss: 1.0612 | Val  Acc: 0.6727
Average Valid Accuracy: 0.8870
Aggregated Acc | Val Acc: 0.8389
 Test site-Clipart   | Epoch:43 | Test Acc: 0.8878
 Test site-Real      | Epoch:43 | Test Acc: 0.9433
 Test site-Painting  | Epoch:43 | Test Acc: 0.9370
 Test site-Sketch    | Epoch:43 | Test Acc: 0.8935
 Test site-QuickDraw | Epoch:43 | Test Acc: 0.7260
 Test site-Infograph | Epoch:43 | Test Acc: 0.5647
Average Test Accuracy: 0.8254
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 46 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-3
client-13 is in G-3
client-14 is in G-3
client-15 is in G-3
client-16 is in G-4
client-17 is in G-4
client-18 is in G-2
client-19 is in G-2
client-20 is in G-0
cnt=[1, 7, 2, 8, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3454 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3764 | Train Acc: 0.9211
 Site-Clipart   | Train Loss: 0.3806 | Train Acc: 0.9123
 Site-Clipart   | Train Loss: 0.3401 | Train Acc: 0.9535
 Site-Clipart   | Train Loss: 0.2643 | Train Acc: 0.9225
 Site-Clipart   | Train Loss: 0.3557 | Train Acc: 0.8454
 Site-Clipart   | Train Loss: 0.3377 | Train Acc: 0.8935
 Site-Clipart   | Train Loss: 0.3090 | Train Acc: 0.9062
 Site-Real      | Train Loss: 0.3468 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.2022 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2629 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.2118 | Train Acc: 0.9628
 Site-Real      | Train Loss: 0.3315 | Train Acc: 0.9410
 Site-Painting  | Train Loss: 0.3622 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.3512 | Train Acc: 0.8864
 Site-Painting  | Train Loss: 0.2849 | Train Acc: 0.9321
 Site-Sketch    | Train Loss: 0.3788 | Train Acc: 0.8926
 Site-Sketch    | Train Loss: 0.3895 | Train Acc: 0.8655
 Site-QuickDraw | Train Loss: 0.7713 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 0.7332 | Train Acc: 0.7905
 Site-Infograph | Train Loss: 0.9065 | Train Acc: 0.7394
 Site-Clipart   | Val  Loss: 0.2667 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1232 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2053 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2855 | Val  Acc: 0.9298
 Site-Clipart   | Val  Loss: 0.3351 | Val  Acc: 0.8721
 Site-Clipart   | Val  Loss: 0.2989 | Val  Acc: 0.9147
 Site-Clipart   | Val  Loss: 0.5128 | Val  Acc: 0.8814
 Site-Clipart   | Val  Loss: 0.4086 | Val  Acc: 0.8660
 Site-Real      | Val  Loss: 0.3261 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2272 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.2516 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.3160 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.1667 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.3589 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.3225 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.3090 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 0.3509 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 0.4003 | Val  Acc: 0.8514
 Site-QuickDraw | Val  Loss: 0.8280 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 0.8322 | Val  Acc: 0.7475
 Site-Infograph | Val  Loss: 1.0570 | Val  Acc: 0.6636
Average Valid Accuracy: 0.8943
Aggregated Acc | Val Acc: 0.8532
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9412
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9600
 Best site-Clipart    | Epoch:46 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9298
 Best site-Clipart    | Epoch:46 | Val Acc: 0.8721
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9147
 Best site-Clipart    | Epoch:46 | Val Acc: 0.8814
 Best site-Clipart    | Epoch:46 | Val Acc: 0.8660
 Best site-Real       | Epoch:46 | Val Acc: 0.9286
 Best site-Real       | Epoch:46 | Val Acc: 0.9206
 Best site-Real       | Epoch:46 | Val Acc: 0.9368
 Best site-Real       | Epoch:46 | Val Acc: 0.9371
 Best site-Real       | Epoch:46 | Val Acc: 0.9579
 Best site-Painting   | Epoch:46 | Val Acc: 0.8974
 Best site-Painting   | Epoch:46 | Val Acc: 0.9231
 Best site-Painting   | Epoch:46 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:46 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:46 | Val Acc: 0.8514
 Best site-QuickDraw  | Epoch:46 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:46 | Val Acc: 0.7475
 Best site-Infograph  | Epoch:46 | Val Acc: 0.6636
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8878
 Test site-Real      | Epoch:46 | Test Acc: 0.9449
 Test site-Painting  | Epoch:46 | Test Acc: 0.9354
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8953
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.7270
 Test site-Infograph | Epoch:46 | Test Acc: 0.5662
Average Test Accuracy: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 47 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-4
client-6 is in G-4
client-7 is in G-4
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-5
client-14 is in G-5
client-15 is in G-5
client-16 is in G-4
client-17 is in G-4
client-18 is in G-1
client-19 is in G-1
client-20 is in G-3
cnt=[1, 2, 5, 1, 9, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4191 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4177 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.4357 | Train Acc: 0.8596
 Site-Clipart   | Train Loss: 0.3474 | Train Acc: 0.8837
 Site-Clipart   | Train Loss: 0.2003 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.3169 | Train Acc: 0.8763
 Site-Clipart   | Train Loss: 0.3346 | Train Acc: 0.9107
 Site-Clipart   | Train Loss: 0.3274 | Train Acc: 0.9085
 Site-Real      | Train Loss: 0.3381 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.2190 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.3011 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.1925 | Train Acc: 0.9488
 Site-Real      | Train Loss: 0.2077 | Train Acc: 0.9348
 Site-Painting  | Train Loss: 0.2950 | Train Acc: 0.9316
 Site-Painting  | Train Loss: 0.2875 | Train Acc: 0.9261
 Site-Painting  | Train Loss: 0.2421 | Train Acc: 0.9321
 Site-Sketch    | Train Loss: 0.4418 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.4469 | Train Acc: 0.8655
 Site-QuickDraw | Train Loss: 0.7390 | Train Acc: 0.7980
 Site-QuickDraw | Train Loss: 0.8529 | Train Acc: 0.7838
 Site-Infograph | Train Loss: 0.8892 | Train Acc: 0.7333
 Site-Clipart   | Val  Loss: 0.2632 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.1748 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2594 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2838 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.2944 | Val  Acc: 0.9186
 Site-Clipart   | Val  Loss: 0.2798 | Val  Acc: 0.8992
 Site-Clipart   | Val  Loss: 0.4369 | Val  Acc: 0.9175
 Site-Clipart   | Val  Loss: 0.4194 | Val  Acc: 0.8694
 Site-Real      | Val  Loss: 0.2861 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.1822 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2145 | Val  Acc: 0.9579
 Site-Real      | Val  Loss: 0.3091 | Val  Acc: 0.9371
 Site-Real      | Val  Loss: 0.1744 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.2977 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.3192 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.2785 | Val  Acc: 0.9205
 Site-Sketch    | Val  Loss: 0.4842 | Val  Acc: 0.8182
 Site-Sketch    | Val  Loss: 0.4672 | Val  Acc: 0.8176
 Site-QuickDraw | Val  Loss: 0.6783 | Val  Acc: 0.7727
 Site-QuickDraw | Val  Loss: 0.8378 | Val  Acc: 0.7475
 Site-Infograph | Val  Loss: 0.9779 | Val  Acc: 0.7091
Average Valid Accuracy: 0.8903
Aggregated Acc | Val Acc: 0.8705
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8859
 Test site-Real      | Epoch:46 | Test Acc: 0.9466
 Test site-Painting  | Epoch:46 | Test Acc: 0.9354
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8935
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.7290
 Test site-Infograph | Epoch:46 | Test Acc: 0.5647
Average Test Accuracy: 0.8258
============ Train epoch 48 ============
gmm
client-0 is in G-4
client-1 is in G-3
client-2 is in G-0
client-3 is in G-3
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-2
client-13 is in G-2
client-14 is in G-2
client-15 is in G-2
client-16 is in G-0
client-17 is in G-0
client-18 is in G-1
client-19 is in G-1
client-20 is in G-5
cnt=[7, 2, 8, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3411 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4653 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.5208 | Train Acc: 0.8421
 Site-Clipart   | Train Loss: 0.2849 | Train Acc: 0.9186
 Site-Clipart   | Train Loss: 0.1864 | Train Acc: 0.9380
 Site-Clipart   | Train Loss: 0.3574 | Train Acc: 0.8866
 Site-Clipart   | Train Loss: 0.3135 | Train Acc: 0.9244
 Site-Clipart   | Train Loss: 0.3234 | Train Acc: 0.9222
 Site-Real      | Train Loss: 0.3472 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.2003 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.1755 | Train Acc: 0.9720
 Site-Real      | Train Loss: 0.2332 | Train Acc: 0.9581
 Site-Real      | Train Loss: 0.2061 | Train Acc: 0.9410
 Site-Painting  | Train Loss: 0.3502 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.3557 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.2285 | Train Acc: 0.9321
 Site-Sketch    | Train Loss: 0.3678 | Train Acc: 0.8859
 Site-Sketch    | Train Loss: 0.3934 | Train Acc: 0.8789
 Site-QuickDraw | Train Loss: 0.7828 | Train Acc: 0.7879
 Site-QuickDraw | Train Loss: 0.7287 | Train Acc: 0.7297
 Site-Infograph | Train Loss: 0.8574 | Train Acc: 0.7212
 Site-Clipart   | Val  Loss: 0.2531 | Val  Acc: 0.9412
 Site-Clipart   | Val  Loss: 0.1443 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2601 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2687 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.3227 | Val  Acc: 0.8953
 Site-Clipart   | Val  Loss: 0.3346 | Val  Acc: 0.9147
 Site-Clipart   | Val  Loss: 0.4833 | Val  Acc: 0.8763
 Site-Clipart   | Val  Loss: 0.4253 | Val  Acc: 0.8729
 Site-Real      | Val  Loss: 0.2428 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.2313 | Val  Acc: 0.9206
 Site-Real      | Val  Loss: 0.2188 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.3185 | Val  Acc: 0.9161
 Site-Real      | Val  Loss: 0.1677 | Val  Acc: 0.9579
 Site-Painting  | Val  Loss: 0.3438 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.2856 | Val  Acc: 0.9316
 Site-Painting  | Val  Loss: 0.2726 | Val  Acc: 0.9375
 Site-Sketch    | Val  Loss: 0.3347 | Val  Acc: 0.8788
 Site-Sketch    | Val  Loss: 0.4861 | Val  Acc: 0.8446
 Site-QuickDraw | Val  Loss: 0.6401 | Val  Acc: 0.7727
 Site-QuickDraw | Val  Loss: 0.7928 | Val  Acc: 0.7576
 Site-Infograph | Val  Loss: 0.9692 | Val  Acc: 0.7091
Average Valid Accuracy: 0.8941
Aggregated Acc | Val Acc: 0.8655
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8916
 Test site-Real      | Epoch:46 | Test Acc: 0.9466
 Test site-Painting  | Epoch:46 | Test Acc: 0.9354
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8917
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.7310
 Test site-Infograph | Epoch:46 | Test Acc: 0.5632
Average Test Accuracy: 0.8266
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
============ Train epoch 49 ============
gmm
client-0 is in G-3
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-1
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-1
client-13 is in G-4
client-14 is in G-4
client-15 is in G-4
client-16 is in G-5
client-17 is in G-5
client-18 is in G-2
client-19 is in G-2
client-20 is in G-4
cnt=[1, 5, 2, 7, 4, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3730 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.3926 | Train Acc: 0.8684
 Site-Clipart   | Train Loss: 0.5125 | Train Acc: 0.8246
 Site-Clipart   | Train Loss: 0.2788 | Train Acc: 0.9419
 Site-Clipart   | Train Loss: 0.3118 | Train Acc: 0.9147
 Site-Clipart   | Train Loss: 0.3584 | Train Acc: 0.9072
 Site-Clipart   | Train Loss: 0.3610 | Train Acc: 0.8969
 Site-Clipart   | Train Loss: 0.2943 | Train Acc: 0.9268
 Site-Real      | Train Loss: 0.3382 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.1992 | Train Acc: 0.9684
 Site-Real      | Train Loss: 0.2227 | Train Acc: 0.9580
 Site-Real      | Train Loss: 0.2012 | Train Acc: 0.9674
 Site-Real      | Train Loss: 0.1879 | Train Acc: 0.9534
 Site-Painting  | Train Loss: 0.3244 | Train Acc: 0.9145
 Site-Painting  | Train Loss: 0.3208 | Train Acc: 0.8977
 Site-Painting  | Train Loss: 0.2418 | Train Acc: 0.9358
 Site-Sketch    | Train Loss: 0.3705 | Train Acc: 0.8523
 Site-Sketch    | Train Loss: 0.4709 | Train Acc: 0.8520
 Site-QuickDraw | Train Loss: 0.8015 | Train Acc: 0.7576
 Site-QuickDraw | Train Loss: 0.7628 | Train Acc: 0.7635
 Site-Infograph | Train Loss: 0.8758 | Train Acc: 0.7394
 Site-Clipart   | Val  Loss: 0.2475 | Val  Acc: 0.8824
 Site-Clipart   | Val  Loss: 0.1870 | Val  Acc: 0.9600
 Site-Clipart   | Val  Loss: 0.2566 | Val  Acc: 0.9474
 Site-Clipart   | Val  Loss: 0.2534 | Val  Acc: 0.9123
 Site-Clipart   | Val  Loss: 0.3063 | Val  Acc: 0.8953
 Site-Clipart   | Val  Loss: 0.2409 | Val  Acc: 0.9457
 Site-Clipart   | Val  Loss: 0.5016 | Val  Acc: 0.8969
 Site-Clipart   | Val  Loss: 0.3853 | Val  Acc: 0.9003
 Site-Real      | Val  Loss: 0.2824 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.1861 | Val  Acc: 0.9365
 Site-Real      | Val  Loss: 0.1876 | Val  Acc: 0.9368
 Site-Real      | Val  Loss: 0.2614 | Val  Acc: 0.9301
 Site-Real      | Val  Loss: 0.1720 | Val  Acc: 0.9720
 Site-Painting  | Val  Loss: 0.2936 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.2957 | Val  Acc: 0.9145
 Site-Painting  | Val  Loss: 0.2774 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 0.3952 | Val  Acc: 0.8283
 Site-Sketch    | Val  Loss: 0.4181 | Val  Acc: 0.8716
 Site-QuickDraw | Val  Loss: 0.9856 | Val  Acc: 0.7879
 Site-QuickDraw | Val  Loss: 0.8175 | Val  Acc: 0.7576
 Site-Infograph | Val  Loss: 0.9988 | Val  Acc: 0.6818
Average Valid Accuracy: 0.8902
Aggregated Acc | Val Acc: 0.8812
 Test site-Clipart   | Epoch:48 | Test Acc: 0.8916
 Test site-Real      | Epoch:48 | Test Acc: 0.9466
 Test site-Painting  | Epoch:48 | Test Acc: 0.9418
 Test site-Sketch    | Epoch:48 | Test Acc: 0.8935
 Test site-QuickDraw | Epoch:48 | Test Acc: 0.7330
 Test site-Infograph | Epoch:48 | Test Acc: 0.5616
Average Test Accuracy: 0.8280
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.5_1/ccop_q=1...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8916
 Test site-Real      | Epoch:49 | Test Acc: 0.9466
 Test site-Painting  | Epoch:49 | Test Acc: 0.9418
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8935
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.7330
 Test site-Infograph | Epoch:49 | Test Acc: 0.5616
Average Test Accuracy: 0.8280
===2023-05-11 22:14:08===
===2023-05-11 22:14:23===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[25,38,57,86,129,194,291,437,63,95,143,215,322,117,176,265,149,223,99,148,165,
client_nums=[8,5,3,2,2,1,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8916
 Test site-Real      | Epoch:49 | Test Acc: 0.9466
 Test site-Painting  | Epoch:49 | Test Acc: 0.9418
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8935
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.7330
 Test site-Infograph | Epoch:49 | Test Acc: 0.5616
Average Test Accuracy: 0.8280
