===2023-05-25 01:25:27===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
data_number=[9,13,19,29,42,62,92,136,199,293,20,30,44,66,97,142,209,33,48,71,105,155,60,89,131,77,114,130,88,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[1500,1020,693,471,320,217,147,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 8, 10, 1, 1, 1, 7, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.9093 | Train Acc: 0.4444
 Site-White                    | Train Loss: 2.2120 | Train Acc: 0.2308
 Site-White                    | Train Loss: 2.0054 | Train Acc: 0.2632
 Site-White                    | Train Loss: 1.8591 | Train Acc: 0.2759
 Site-White                    | Train Loss: 1.9378 | Train Acc: 0.3095
 Site-White                    | Train Loss: 1.9839 | Train Acc: 0.3226
 Site-White                    | Train Loss: 2.0287 | Train Acc: 0.2717
 Site-White                    | Train Loss: 1.9870 | Train Acc: 0.1912
 Site-White                    | Train Loss: 2.0348 | Train Acc: 0.3015
 Site-White                    | Train Loss: 1.9659 | Train Acc: 0.2799
 Site-Latino_Hispanic          | Train Loss: 2.1058 | Train Acc: 0.1500
 Site-Latino_Hispanic          | Train Loss: 1.9769 | Train Acc: 0.2667
 Site-Latino_Hispanic          | Train Loss: 1.8660 | Train Acc: 0.3636
 Site-Latino_Hispanic          | Train Loss: 1.9316 | Train Acc: 0.1667
 Site-Latino_Hispanic          | Train Loss: 1.9626 | Train Acc: 0.2474
 Site-Latino_Hispanic          | Train Loss: 1.9613 | Train Acc: 0.2887
 Site-Latino_Hispanic          | Train Loss: 1.9785 | Train Acc: 0.2105
 Site-Black                    | Train Loss: 1.9243 | Train Acc: 0.3030
 Site-Black                    | Train Loss: 2.0511 | Train Acc: 0.1875
 Site-Black                    | Train Loss: 1.8453 | Train Acc: 0.2394
 Site-Black                    | Train Loss: 2.0246 | Train Acc: 0.1905
 Site-Black                    | Train Loss: 2.0179 | Train Acc: 0.2323
 Site-East_Asian               | Train Loss: 2.0005 | Train Acc: 0.2833
 Site-East_Asian               | Train Loss: 1.9334 | Train Acc: 0.2247
 Site-East_Asian               | Train Loss: 2.0029 | Train Acc: 0.2519
 Site-Indian                   | Train Loss: 1.9499 | Train Acc: 0.2208
 Site-Indian                   | Train Loss: 2.0141 | Train Acc: 0.2368
 Site-Southeast_Asian          | Train Loss: 2.1739 | Train Acc: 0.1923
 Site-Middle_Eastern           | Train Loss: 2.1318 | Train Acc: 0.2614
 Site-White                     (6) | Val  Loss: 1.9842 | Val  Acc: 0.3333
 Site-White                     (2) | Val  Loss: 2.5408 | Val  Acc: 0.0000
 Site-White                     (5) | Val  Loss: 1.8864 | Val  Acc: 0.2308
 Site-White                     (4) | Val  Loss: 2.0184 | Val  Acc: 0.1053
 Site-White                     (2) | Val  Loss: 2.1530 | Val  Acc: 0.1786
 Site-White                     (0) | Val  Loss: 2.0009 | Val  Acc: 0.2439
 Site-White                     (2) | Val  Loss: 1.9123 | Val  Acc: 0.2951
 Site-White                     (2) | Val  Loss: 1.9068 | Val  Acc: 0.2556
 Site-White                     (2) | Val  Loss: 1.9165 | Val  Acc: 0.2180
 Site-White                     (2) | Val  Loss: 1.9930 | Val  Acc: 0.2667
 Site-Latino_Hispanic           (3) | Val  Loss: 1.6112 | Val  Acc: 0.5385
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4826 | Val  Acc: 0.4500
 Site-Latino_Hispanic           (2) | Val  Loss: 2.2620 | Val  Acc: 0.0690
 Site-Latino_Hispanic           (6) | Val  Loss: 1.8981 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (6) | Val  Loss: 1.8713 | Val  Acc: 0.2656
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9211 | Val  Acc: 0.2947
 Site-Latino_Hispanic           (2) | Val  Loss: 1.9773 | Val  Acc: 0.2734
 Site-Black                     (1) | Val  Loss: 2.4236 | Val  Acc: 0.0000
 Site-Black                     (1) | Val  Loss: 1.8951 | Val  Acc: 0.2812
 Site-Black                     (1) | Val  Loss: 1.9039 | Val  Acc: 0.2766
 Site-Black                     (1) | Val  Loss: 2.1628 | Val  Acc: 0.2714
 Site-Black                     (1) | Val  Loss: 2.0007 | Val  Acc: 0.2427
 Site-East_Asian                (6) | Val  Loss: 1.9790 | Val  Acc: 0.2250
 Site-East_Asian                (6) | Val  Loss: 2.0337 | Val  Acc: 0.1864
 Site-East_Asian                (6) | Val  Loss: 1.9676 | Val  Acc: 0.2989
 Site-Indian                    (1) | Val  Loss: 1.9548 | Val  Acc: 0.2941
 Site-Indian                    (1) | Val  Loss: 1.9352 | Val  Acc: 0.2368
 Site-Southeast_Asian           (6) | Val  Loss: 2.1596 | Val  Acc: 0.1977
 Site-Middle_Eastern            (2) | Val  Loss: 2.1803 | Val  Acc: 0.1207
Average Valid Accuracy: 0.2418
Aggregated Acc | Val Acc: 0.2622
 Best site-White                    (6)  | Epoch:0 | Val Acc: 0.3333
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.0000
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.2308
 Best site-White                    (4)  | Epoch:0 | Val Acc: 0.1053
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.1786
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.2439
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.2951
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.2556
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.2180
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.2667
 Best site-Latino_Hispanic          (3)  | Epoch:0 | Val Acc: 0.5385
 Best site-Latino_Hispanic          (2)  | Epoch:0 | Val Acc: 0.4500
 Best site-Latino_Hispanic          (2)  | Epoch:0 | Val Acc: 0.0690
 Best site-Latino_Hispanic          (6)  | Epoch:0 | Val Acc: 0.3636
 Best site-Latino_Hispanic          (6)  | Epoch:0 | Val Acc: 0.2656
 Best site-Latino_Hispanic          (1)  | Epoch:0 | Val Acc: 0.2947
 Best site-Latino_Hispanic          (2)  | Epoch:0 | Val Acc: 0.2734
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.0000
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2812
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2766
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2714
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2427
 Best site-East_Asian               (6)  | Epoch:0 | Val Acc: 0.2250
 Best site-East_Asian               (6)  | Epoch:0 | Val Acc: 0.1864
 Best site-East_Asian               (6)  | Epoch:0 | Val Acc: 0.2989
 Best site-Indian                   (1)  | Epoch:0 | Val Acc: 0.2941
 Best site-Indian                   (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Southeast_Asian          (6)  | Epoch:0 | Val Acc: 0.1977
 Best site-Middle_Eastern           (2)  | Epoch:0 | Val Acc: 0.1207
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_single_cluster_7/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 7, 2, 6, 11, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8359 | Train Acc: 0.4444
 Site-White                    | Train Loss: 2.2275 | Train Acc: 0.0769
 Site-White                    | Train Loss: 1.8905 | Train Acc: 0.3158
 Site-White                    | Train Loss: 1.8078 | Train Acc: 0.3103
 Site-White                    | Train Loss: 1.8914 | Train Acc: 0.3095
 Site-White                    | Train Loss: 1.9861 | Train Acc: 0.2581
 Site-White                    | Train Loss: 2.0494 | Train Acc: 0.2609
 Site-White                    | Train Loss: 1.9273 | Train Acc: 0.2353
 Site-White                    | Train Loss: 1.9351 | Train Acc: 0.2764
 Site-White                    | Train Loss: 1.9722 | Train Acc: 0.2457
 Site-Latino_Hispanic          | Train Loss: 2.0022 | Train Acc: 0.3000
 Site-Latino_Hispanic          | Train Loss: 1.9322 | Train Acc: 0.0667
 Site-Latino_Hispanic          | Train Loss: 1.8425 | Train Acc: 0.2955
 Site-Latino_Hispanic          | Train Loss: 2.0385 | Train Acc: 0.1667
 Site-Latino_Hispanic          | Train Loss: 1.9494 | Train Acc: 0.2268
 Site-Latino_Hispanic          | Train Loss: 1.9218 | Train Acc: 0.2113
 Site-Latino_Hispanic          | Train Loss: 1.9074 | Train Acc: 0.2392
 Site-Black                    | Train Loss: 1.8658 | Train Acc: 0.3636
 Site-Black                    | Train Loss: 2.0584 | Train Acc: 0.2500
 Site-Black                    | Train Loss: 1.8713 | Train Acc: 0.2394
 Site-Black                    | Train Loss: 2.0224 | Train Acc: 0.2190
 Site-Black                    | Train Loss: 1.9411 | Train Acc: 0.2452
 Site-East_Asian               | Train Loss: 1.9432 | Train Acc: 0.3500
 Site-East_Asian               | Train Loss: 1.9316 | Train Acc: 0.3371
 Site-East_Asian               | Train Loss: 1.9966 | Train Acc: 0.2977
 Site-Indian                   | Train Loss: 2.0639 | Train Acc: 0.2078
 Site-Indian                   | Train Loss: 2.0170 | Train Acc: 0.2544
 Site-Southeast_Asian          | Train Loss: 2.3575 | Train Acc: 0.2231
 Site-Middle_Eastern           | Train Loss: 2.0644 | Train Acc: 0.2045
 Site-White                     (0) | Val  Loss: 1.8979 | Val  Acc: 0.5000
 Site-White                     (4) | Val  Loss: 2.5749 | Val  Acc: 0.0000
 Site-White                     (6) | Val  Loss: 1.7717 | Val  Acc: 0.3077
 Site-White                     (2) | Val  Loss: 1.9412 | Val  Acc: 0.2105
 Site-White                     (4) | Val  Loss: 2.1181 | Val  Acc: 0.1429
 Site-White                     (3) | Val  Loss: 1.9670 | Val  Acc: 0.1951
 Site-White                     (3) | Val  Loss: 1.9164 | Val  Acc: 0.2623
 Site-White                     (3) | Val  Loss: 1.8464 | Val  Acc: 0.3222
 Site-White                     (4) | Val  Loss: 1.7993 | Val  Acc: 0.2782
 Site-White                     (3) | Val  Loss: 1.9420 | Val  Acc: 0.2718
 Site-Latino_Hispanic           (5) | Val  Loss: 1.6365 | Val  Acc: 0.2308
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3500 | Val  Acc: 0.5500
 Site-Latino_Hispanic           (4) | Val  Loss: 2.1481 | Val  Acc: 0.2069
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8826 | Val  Acc: 0.2273
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8010 | Val  Acc: 0.2500
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8510 | Val  Acc: 0.2421
 Site-Latino_Hispanic           (4) | Val  Loss: 1.9520 | Val  Acc: 0.2230
 Site-Black                     (1) | Val  Loss: 2.4417 | Val  Acc: 0.0000
 Site-Black                     (1) | Val  Loss: 1.8941 | Val  Acc: 0.2812
 Site-Black                     (1) | Val  Loss: 1.8386 | Val  Acc: 0.3191
 Site-Black                     (1) | Val  Loss: 2.1459 | Val  Acc: 0.3143
 Site-Black                     (1) | Val  Loss: 1.9674 | Val  Acc: 0.2136
 Site-East_Asian                (4) | Val  Loss: 1.9893 | Val  Acc: 0.2250
 Site-East_Asian                (2) | Val  Loss: 2.0042 | Val  Acc: 0.3390
 Site-East_Asian                (4) | Val  Loss: 1.9209 | Val  Acc: 0.3218
 Site-Indian                    (1) | Val  Loss: 1.9349 | Val  Acc: 0.2353
 Site-Indian                    (1) | Val  Loss: 1.9340 | Val  Acc: 0.2368
 Site-Southeast_Asian           (4) | Val  Loss: 2.1515 | Val  Acc: 0.2674
 Site-Middle_Eastern            (3) | Val  Loss: 2.1640 | Val  Acc: 0.1724
Average Valid Accuracy: 0.2533
Aggregated Acc | Val Acc: 0.2935
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.5000
 Best site-White                    (4)  | Epoch:1 | Val Acc: 0.0000
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3077
 Best site-White                    (2)  | Epoch:1 | Val Acc: 0.2105
 Best site-White                    (4)  | Epoch:1 | Val Acc: 0.1429
 Best site-White                    (3)  | Epoch:1 | Val Acc: 0.1951
 Best site-White                    (3)  | Epoch:1 | Val Acc: 0.2623
 Best site-White                    (3)  | Epoch:1 | Val Acc: 0.3222
 Best site-White                    (4)  | Epoch:1 | Val Acc: 0.2782
 Best site-White                    (3)  | Epoch:1 | Val Acc: 0.2718
 Best site-Latino_Hispanic          (5)  | Epoch:1 | Val Acc: 0.2308
 Best site-Latino_Hispanic          (3)  | Epoch:1 | Val Acc: 0.5500
 Best site-Latino_Hispanic          (4)  | Epoch:1 | Val Acc: 0.2069
 Best site-Latino_Hispanic          (4)  | Epoch:1 | Val Acc: 0.2273
 Best site-Latino_Hispanic          (4)  | Epoch:1 | Val Acc: 0.2500
 Best site-Latino_Hispanic          (4)  | Epoch:1 | Val Acc: 0.2421
 Best site-Latino_Hispanic          (4)  | Epoch:1 | Val Acc: 0.2230
 Best site-Black                    (1)  | Epoch:1 | Val Acc: 0.0000
 Best site-Black                    (1)  | Epoch:1 | Val Acc: 0.2812
 Best site-Black                    (1)  | Epoch:1 | Val Acc: 0.3191
 Best site-Black                    (1)  | Epoch:1 | Val Acc: 0.3143
 Best site-Black                    (1)  | Epoch:1 | Val Acc: 0.2136
 Best site-East_Asian               (4)  | Epoch:1 | Val Acc: 0.2250
 Best site-East_Asian               (2)  | Epoch:1 | Val Acc: 0.3390
 Best site-East_Asian               (4)  | Epoch:1 | Val Acc: 0.3218
 Best site-Indian                   (1)  | Epoch:1 | Val Acc: 0.2353
 Best site-Indian                   (1)  | Epoch:1 | Val Acc: 0.2368
 Best site-Southeast_Asian          (4)  | Epoch:1 | Val Acc: 0.2674
 Best site-Middle_Eastern           (3)  | Epoch:1 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_single_cluster_7/ccop_q=1...
============ Train epoch 2 ============
cnt=[10, 10, 5, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8135 | Train Acc: 0.4444
 Site-White                    | Train Loss: 2.1874 | Train Acc: 0.0769
 Site-White                    | Train Loss: 1.9305 | Train Acc: 0.2632
 Site-White                    | Train Loss: 1.7923 | Train Acc: 0.3103
 Site-White                    | Train Loss: 1.9222 | Train Acc: 0.3095
 Site-White                    | Train Loss: 1.9335 | Train Acc: 0.2258
 Site-White                    | Train Loss: 1.9326 | Train Acc: 0.2935
 Site-White                    | Train Loss: 1.8583 | Train Acc: 0.2426
 Site-White                    | Train Loss: 1.7908 | Train Acc: 0.2965
 Site-White                    | Train Loss: 1.9334 | Train Acc: 0.2730
 Site-Latino_Hispanic          | Train Loss: 2.0061 | Train Acc: 0.3000
 Site-Latino_Hispanic          | Train Loss: 1.9251 | Train Acc: 0.1000
 Site-Latino_Hispanic          | Train Loss: 1.7933 | Train Acc: 0.3182
 Site-Latino_Hispanic          | Train Loss: 2.1699 | Train Acc: 0.1970
 Site-Latino_Hispanic          | Train Loss: 1.9071 | Train Acc: 0.2474
 Site-Latino_Hispanic          | Train Loss: 1.9692 | Train Acc: 0.2183
 Site-Latino_Hispanic          | Train Loss: 1.9075 | Train Acc: 0.2488
 Site-Black                    | Train Loss: 1.8840 | Train Acc: 0.3333
 Site-Black                    | Train Loss: 2.0414 | Train Acc: 0.1458
 Site-Black                    | Train Loss: 2.1220 | Train Acc: 0.2676
 Site-Black                    | Train Loss: 1.9953 | Train Acc: 0.2476
 Site-Black                    | Train Loss: 1.9188 | Train Acc: 0.2452
 Site-East_Asian               | Train Loss: 1.9385 | Train Acc: 0.3333
 Site-East_Asian               | Train Loss: 1.8741 | Train Acc: 0.2921
 Site-East_Asian               | Train Loss: 1.8926 | Train Acc: 0.2824
 Site-Indian                   | Train Loss: 1.9570 | Train Acc: 0.1948
 Site-Indian                   | Train Loss: 2.0258 | Train Acc: 0.2544
 Site-Southeast_Asian          | Train Loss: 2.2741 | Train Acc: 0.2308
 Site-Middle_Eastern           | Train Loss: 2.1283 | Train Acc: 0.2045
 Site-White                     (5) | Val  Loss: 1.8753 | Val  Acc: 0.3333
 Site-White                     (3) | Val  Loss: 2.6170 | Val  Acc: 0.0000
 Site-White                     (4) | Val  Loss: 1.8054 | Val  Acc: 0.2308
 Site-White                     (6) | Val  Loss: 1.9793 | Val  Acc: 0.1579
 Site-White                     (1) | Val  Loss: 2.1192 | Val  Acc: 0.2500
 Site-White                     (1) | Val  Loss: 1.9257 | Val  Acc: 0.2195
 Site-White                     (1) | Val  Loss: 1.9053 | Val  Acc: 0.2951
 Site-White                     (1) | Val  Loss: 1.8277 | Val  Acc: 0.2667
 Site-White                     (1) | Val  Loss: 1.8250 | Val  Acc: 0.2932
 Site-White                     (1) | Val  Loss: 1.9473 | Val  Acc: 0.2564
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5668 | Val  Acc: 0.2308
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4446 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (0) | Val  Loss: 2.1392 | Val  Acc: 0.1724
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8533 | Val  Acc: 0.2500
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7633 | Val  Acc: 0.3438
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8323 | Val  Acc: 0.2421
 Site-Latino_Hispanic           (0) | Val  Loss: 1.9237 | Val  Acc: 0.2590
 Site-Black                     (2) | Val  Loss: 2.3837 | Val  Acc: 0.0000
 Site-Black                     (2) | Val  Loss: 1.8747 | Val  Acc: 0.3125
 Site-Black                     (2) | Val  Loss: 1.8539 | Val  Acc: 0.3617
 Site-Black                     (2) | Val  Loss: 2.1681 | Val  Acc: 0.3286
 Site-Black                     (2) | Val  Loss: 1.9646 | Val  Acc: 0.2330
 Site-East_Asian                (0) | Val  Loss: 1.9869 | Val  Acc: 0.2000
 Site-East_Asian                (0) | Val  Loss: 1.9925 | Val  Acc: 0.2542
 Site-East_Asian                (0) | Val  Loss: 1.8871 | Val  Acc: 0.2874
 Site-Indian                    (0) | Val  Loss: 1.9175 | Val  Acc: 0.2745
 Site-Indian                    (0) | Val  Loss: 1.9207 | Val  Acc: 0.2632
 Site-Southeast_Asian           (0) | Val  Loss: 2.1586 | Val  Acc: 0.2209
 Site-Middle_Eastern            (1) | Val  Loss: 2.1714 | Val  Acc: 0.1552
Average Valid Accuracy: 0.2446
Aggregated Acc | Val Acc: 0.2118
============ Train epoch 3 ============
cnt=[2, 6, 4, 1, 1, 5, 10, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7766 | Train Acc: 0.4444
 Site-White                    | Train Loss: 2.1697 | Train Acc: 0.0769
 Site-White                    | Train Loss: 1.9222 | Train Acc: 0.2105
 Site-White                    | Train Loss: 1.7906 | Train Acc: 0.3103
 Site-White                    | Train Loss: 1.8522 | Train Acc: 0.3571
 Site-White                    | Train Loss: 1.9418 | Train Acc: 0.2419
 Site-White                    | Train Loss: 2.0907 | Train Acc: 0.2717
 Site-White                    | Train Loss: 2.0687 | Train Acc: 0.1912
 Site-White                    | Train Loss: 1.9082 | Train Acc: 0.2663
 Site-White                    | Train Loss: 1.9288 | Train Acc: 0.2560
 Site-Latino_Hispanic          | Train Loss: 2.0166 | Train Acc: 0.2500
 Site-Latino_Hispanic          | Train Loss: 1.8964 | Train Acc: 0.1000
 Site-Latino_Hispanic          | Train Loss: 1.7600 | Train Acc: 0.4091
 Site-Latino_Hispanic          | Train Loss: 2.2623 | Train Acc: 0.1970
 Site-Latino_Hispanic          | Train Loss: 1.9063 | Train Acc: 0.2474
 Site-Latino_Hispanic          | Train Loss: 1.8215 | Train Acc: 0.2394
 Site-Latino_Hispanic          | Train Loss: 1.8637 | Train Acc: 0.2297
 Site-Black                    | Train Loss: 1.8314 | Train Acc: 0.3030
 Site-Black                    | Train Loss: 1.9900 | Train Acc: 0.1875
 Site-Black                    | Train Loss: 2.0630 | Train Acc: 0.2113
 Site-Black                    | Train Loss: 1.9780 | Train Acc: 0.2190
 Site-Black                    | Train Loss: 1.9222 | Train Acc: 0.2258
 Site-East_Asian               | Train Loss: 1.9029 | Train Acc: 0.3167
 Site-East_Asian               | Train Loss: 1.9266 | Train Acc: 0.2697
 Site-East_Asian               | Train Loss: 1.8819 | Train Acc: 0.2672
 Site-Indian                   | Train Loss: 1.8862 | Train Acc: 0.1948
 Site-Indian                   | Train Loss: 1.9944 | Train Acc: 0.2807
 Site-Southeast_Asian          | Train Loss: 2.3501 | Train Acc: 0.2308
 Site-Middle_Eastern           | Train Loss: 2.0828 | Train Acc: 0.2045
 Site-White                     (2) | Val  Loss: 1.8736 | Val  Acc: 0.5000
 Site-White                     (4) | Val  Loss: 2.4510 | Val  Acc: 0.0000
 Site-White                     (6) | Val  Loss: 1.7771 | Val  Acc: 0.2308
 Site-White                     (6) | Val  Loss: 1.9789 | Val  Acc: 0.2105
 Site-White                     (6) | Val  Loss: 2.1219 | Val  Acc: 0.1429
 Site-White                     (6) | Val  Loss: 1.8846 | Val  Acc: 0.2683
 Site-White                     (6) | Val  Loss: 1.8784 | Val  Acc: 0.3279
 Site-White                     (6) | Val  Loss: 1.8311 | Val  Acc: 0.2889
 Site-White                     (6) | Val  Loss: 1.8185 | Val  Acc: 0.2556
 Site-White                     (6) | Val  Loss: 1.9320 | Val  Acc: 0.2667
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5730 | Val  Acc: 0.3846
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3548 | Val  Acc: 0.5500
 Site-Latino_Hispanic           (1) | Val  Loss: 2.1650 | Val  Acc: 0.1724
 Site-Latino_Hispanic           (2) | Val  Loss: 1.8398 | Val  Acc: 0.2955
 Site-Latino_Hispanic           (6) | Val  Loss: 1.7446 | Val  Acc: 0.2969
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8056 | Val  Acc: 0.2737
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9030 | Val  Acc: 0.2734
 Site-Black                     (5) | Val  Loss: 2.3776 | Val  Acc: 0.0000
 Site-Black                     (5) | Val  Loss: 1.8222 | Val  Acc: 0.3438
 Site-Black                     (5) | Val  Loss: 1.8110 | Val  Acc: 0.3191
 Site-Black                     (5) | Val  Loss: 2.1102 | Val  Acc: 0.3000
 Site-Black                     (5) | Val  Loss: 1.9176 | Val  Acc: 0.2427
 Site-East_Asian                (1) | Val  Loss: 1.9274 | Val  Acc: 0.2250
 Site-East_Asian                (2) | Val  Loss: 1.9629 | Val  Acc: 0.2881
 Site-East_Asian                (2) | Val  Loss: 1.8992 | Val  Acc: 0.2989
 Site-Indian                    (0) | Val  Loss: 1.9188 | Val  Acc: 0.2157
 Site-Indian                    (0) | Val  Loss: 1.8699 | Val  Acc: 0.2763
 Site-Southeast_Asian           (1) | Val  Loss: 2.1457 | Val  Acc: 0.2558
 Site-Middle_Eastern            (6) | Val  Loss: 2.1466 | Val  Acc: 0.2069
Average Valid Accuracy: 0.2659
Aggregated Acc | Val Acc: 0.2512
 Best site-White                    (2)  | Epoch:3 | Val Acc: 0.5000
 Best site-White                    (4)  | Epoch:3 | Val Acc: 0.0000
 Best site-White                    (6)  | Epoch:3 | Val Acc: 0.2308
 Best site-White                    (6)  | Epoch:3 | Val Acc: 0.2105
 Best site-White                    (6)  | Epoch:3 | Val Acc: 0.1429
 Best site-White                    (6)  | Epoch:3 | Val Acc: 0.2683
 Best site-White                    (6)  | Epoch:3 | Val Acc: 0.3279
 Best site-White                    (6)  | Epoch:3 | Val Acc: 0.2889
 Best site-White                    (6)  | Epoch:3 | Val Acc: 0.2556
 Best site-White                    (6)  | Epoch:3 | Val Acc: 0.2667
 Best site-Latino_Hispanic          (3)  | Epoch:3 | Val Acc: 0.3846
 Best site-Latino_Hispanic          (1)  | Epoch:3 | Val Acc: 0.5500
 Best site-Latino_Hispanic          (1)  | Epoch:3 | Val Acc: 0.1724
 Best site-Latino_Hispanic          (2)  | Epoch:3 | Val Acc: 0.2955
 Best site-Latino_Hispanic          (6)  | Epoch:3 | Val Acc: 0.2969
 Best site-Latino_Hispanic          (1)  | Epoch:3 | Val Acc: 0.2737
 Best site-Latino_Hispanic          (1)  | Epoch:3 | Val Acc: 0.2734
 Best site-Black                    (5)  | Epoch:3 | Val Acc: 0.0000
 Best site-Black                    (5)  | Epoch:3 | Val Acc: 0.3438
 Best site-Black                    (5)  | Epoch:3 | Val Acc: 0.3191
 Best site-Black                    (5)  | Epoch:3 | Val Acc: 0.3000
 Best site-Black                    (5)  | Epoch:3 | Val Acc: 0.2427
 Best site-East_Asian               (1)  | Epoch:3 | Val Acc: 0.2250
 Best site-East_Asian               (2)  | Epoch:3 | Val Acc: 0.2881
 Best site-East_Asian               (2)  | Epoch:3 | Val Acc: 0.2989
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2157
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2763
 Best site-Southeast_Asian          (1)  | Epoch:3 | Val Acc: 0.2558
 Best site-Middle_Eastern           (6)  | Epoch:3 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_single_cluster_7/ccop_q=1...
============ Train epoch 4 ============
cnt=[12, 5, 1, 1, 1, 8, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7157 | Train Acc: 0.4444
 Site-White                    | Train Loss: 2.2186 | Train Acc: 0.0769
 Site-White                    | Train Loss: 1.8995 | Train Acc: 0.3158
 Site-White                    | Train Loss: 1.7854 | Train Acc: 0.3103
 Site-White                    | Train Loss: 1.8965 | Train Acc: 0.3810
 Site-White                    | Train Loss: 1.9465 | Train Acc: 0.2903
 Site-White                    | Train Loss: 1.9797 | Train Acc: 0.2717
 Site-White                    | Train Loss: 1.9454 | Train Acc: 0.1985
 Site-White                    | Train Loss: 1.8660 | Train Acc: 0.2814
 Site-White                    | Train Loss: 1.8939 | Train Acc: 0.2662
 Site-Latino_Hispanic          | Train Loss: 2.0331 | Train Acc: 0.2000
 Site-Latino_Hispanic          | Train Loss: 1.8943 | Train Acc: 0.1333
 Site-Latino_Hispanic          | Train Loss: 1.7907 | Train Acc: 0.2955
 Site-Latino_Hispanic          | Train Loss: 1.7720 | Train Acc: 0.2121
 Site-Latino_Hispanic          | Train Loss: 1.8900 | Train Acc: 0.2784
 Site-Latino_Hispanic          | Train Loss: 1.8559 | Train Acc: 0.2394
 Site-Latino_Hispanic          | Train Loss: 1.8467 | Train Acc: 0.2536
 Site-Black                    | Train Loss: 1.8482 | Train Acc: 0.2121
 Site-Black                    | Train Loss: 1.9907 | Train Acc: 0.1875
 Site-Black                    | Train Loss: 1.8484 | Train Acc: 0.2113
 Site-Black                    | Train Loss: 1.9631 | Train Acc: 0.2095
 Site-Black                    | Train Loss: 1.9006 | Train Acc: 0.2129
 Site-East_Asian               | Train Loss: 1.8893 | Train Acc: 0.2833
 Site-East_Asian               | Train Loss: 1.9236 | Train Acc: 0.2584
 Site-East_Asian               | Train Loss: 1.7646 | Train Acc: 0.2748
 Site-Indian                   | Train Loss: 2.0731 | Train Acc: 0.2338
 Site-Indian                   | Train Loss: 1.9738 | Train Acc: 0.2544
 Site-Southeast_Asian          | Train Loss: 2.0196 | Train Acc: 0.2308
 Site-Middle_Eastern           | Train Loss: 2.0514 | Train Acc: 0.2386
 Site-White                     (0) | Val  Loss: 1.9740 | Val  Acc: 0.5000
 Site-White                     (6) | Val  Loss: 2.4847 | Val  Acc: 0.0000
 Site-White                     (0) | Val  Loss: 1.7432 | Val  Acc: 0.3077
 Site-White                     (4) | Val  Loss: 1.9216 | Val  Acc: 0.2632
 Site-White                     (0) | Val  Loss: 2.1113 | Val  Acc: 0.1786
 Site-White                     (0) | Val  Loss: 1.9224 | Val  Acc: 0.2439
 Site-White                     (0) | Val  Loss: 1.8436 | Val  Acc: 0.3770
 Site-White                     (0) | Val  Loss: 1.8100 | Val  Acc: 0.3000
 Site-White                     (0) | Val  Loss: 1.7816 | Val  Acc: 0.2481
 Site-White                     (0) | Val  Loss: 1.9079 | Val  Acc: 0.2615
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5108 | Val  Acc: 0.3846
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3900 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (5) | Val  Loss: 2.0857 | Val  Acc: 0.2069
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8001 | Val  Acc: 0.3182
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7517 | Val  Acc: 0.3281
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7985 | Val  Acc: 0.2632
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8890 | Val  Acc: 0.2590
 Site-Black                     (1) | Val  Loss: 2.3799 | Val  Acc: 0.0455
 Site-Black                     (3) | Val  Loss: 1.8136 | Val  Acc: 0.3125
 Site-Black                     (2) | Val  Loss: 1.8116 | Val  Acc: 0.3617
 Site-Black                     (1) | Val  Loss: 2.1945 | Val  Acc: 0.3571
 Site-Black                     (1) | Val  Loss: 1.8896 | Val  Acc: 0.2136
 Site-East_Asian                (0) | Val  Loss: 1.9066 | Val  Acc: 0.2500
 Site-East_Asian                (5) | Val  Loss: 1.9495 | Val  Acc: 0.2373
 Site-East_Asian                (0) | Val  Loss: 1.8800 | Val  Acc: 0.2759
 Site-Indian                    (1) | Val  Loss: 1.9178 | Val  Acc: 0.2549
 Site-Indian                    (1) | Val  Loss: 1.8828 | Val  Acc: 0.2368
 Site-Southeast_Asian           (5) | Val  Loss: 2.1354 | Val  Acc: 0.2442
 Site-Middle_Eastern            (0) | Val  Loss: 2.1358 | Val  Acc: 0.2069
Average Valid Accuracy: 0.2702
Aggregated Acc | Val Acc: 0.2479
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.5000
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.0000
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3077
 Best site-White                    (4)  | Epoch:4 | Val Acc: 0.2632
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.1786
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.2439
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3770
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3000
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.2481
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.2615
 Best site-Latino_Hispanic          (0)  | Epoch:4 | Val Acc: 0.3846
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.4000
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.2069
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.3182
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.3281
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.2632
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.2590
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.0455
 Best site-Black                    (3)  | Epoch:4 | Val Acc: 0.3125
 Best site-Black                    (2)  | Epoch:4 | Val Acc: 0.3617
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.3571
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.2136
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.2500
 Best site-East_Asian               (5)  | Epoch:4 | Val Acc: 0.2373
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.2759
 Best site-Indian                   (1)  | Epoch:4 | Val Acc: 0.2549
 Best site-Indian                   (1)  | Epoch:4 | Val Acc: 0.2368
 Best site-Southeast_Asian          (5)  | Epoch:4 | Val Acc: 0.2442
 Best site-Middle_Eastern           (0)  | Epoch:4 | Val Acc: 0.2069
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_single_cluster_7/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 11, 8, 1, 1, 6, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7646 | Train Acc: 0.5556
 Site-White                    | Train Loss: 2.2168 | Train Acc: 0.0769
 Site-White                    | Train Loss: 1.9041 | Train Acc: 0.1579
 Site-White                    | Train Loss: 1.7248 | Train Acc: 0.3448
 Site-White                    | Train Loss: 1.8531 | Train Acc: 0.3571
 Site-White                    | Train Loss: 1.9241 | Train Acc: 0.2258
 Site-White                    | Train Loss: 1.9541 | Train Acc: 0.2826
 Site-White                    | Train Loss: 1.9057 | Train Acc: 0.2426
 Site-White                    | Train Loss: 1.9401 | Train Acc: 0.2764
 Site-White                    | Train Loss: 1.8889 | Train Acc: 0.2867
 Site-Latino_Hispanic          | Train Loss: 1.9473 | Train Acc: 0.2500
 Site-Latino_Hispanic          | Train Loss: 1.9059 | Train Acc: 0.1333
 Site-Latino_Hispanic          | Train Loss: 1.7724 | Train Acc: 0.3182
 Site-Latino_Hispanic          | Train Loss: 1.8880 | Train Acc: 0.2273
 Site-Latino_Hispanic          | Train Loss: 1.8685 | Train Acc: 0.3093
 Site-Latino_Hispanic          | Train Loss: 1.8554 | Train Acc: 0.2606
 Site-Latino_Hispanic          | Train Loss: 1.8388 | Train Acc: 0.2344
 Site-Black                    | Train Loss: 1.8130 | Train Acc: 0.2121
 Site-Black                    | Train Loss: 2.0026 | Train Acc: 0.1458
 Site-Black                    | Train Loss: 1.7417 | Train Acc: 0.2535
 Site-Black                    | Train Loss: 1.9339 | Train Acc: 0.2476
 Site-Black                    | Train Loss: 1.8641 | Train Acc: 0.2645
 Site-East_Asian               | Train Loss: 1.8799 | Train Acc: 0.3667
 Site-East_Asian               | Train Loss: 1.8135 | Train Acc: 0.3146
 Site-East_Asian               | Train Loss: 1.8899 | Train Acc: 0.2824
 Site-Indian                   | Train Loss: 1.8411 | Train Acc: 0.2208
 Site-Indian                   | Train Loss: 1.9405 | Train Acc: 0.2895
 Site-Southeast_Asian          | Train Loss: 2.1244 | Train Acc: 0.2077
 Site-Middle_Eastern           | Train Loss: 2.0868 | Train Acc: 0.2386
 Site-White                     (0) | Val  Loss: 1.8393 | Val  Acc: 0.3333
 Site-White                     (6) | Val  Loss: 2.5993 | Val  Acc: 0.0000
 Site-White                     (2) | Val  Loss: 1.7797 | Val  Acc: 0.3077
 Site-White                     (3) | Val  Loss: 1.9611 | Val  Acc: 0.1579
 Site-White                     (2) | Val  Loss: 2.0359 | Val  Acc: 0.1786
 Site-White                     (2) | Val  Loss: 1.8580 | Val  Acc: 0.3659
 Site-White                     (2) | Val  Loss: 1.8627 | Val  Acc: 0.3279
 Site-White                     (2) | Val  Loss: 1.8192 | Val  Acc: 0.2778
 Site-White                     (2) | Val  Loss: 1.7767 | Val  Acc: 0.2782
 Site-White                     (2) | Val  Loss: 1.9207 | Val  Acc: 0.2410
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5057 | Val  Acc: 0.5385
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3659 | Val  Acc: 0.5500
 Site-Latino_Hispanic           (1) | Val  Loss: 2.0938 | Val  Acc: 0.1034
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8357 | Val  Acc: 0.2955
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7352 | Val  Acc: 0.2500
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7851 | Val  Acc: 0.2632
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8477 | Val  Acc: 0.3453
 Site-Black                     (5) | Val  Loss: 2.3239 | Val  Acc: 0.0000
 Site-Black                     (5) | Val  Loss: 1.8120 | Val  Acc: 0.2188
 Site-Black                     (5) | Val  Loss: 1.8038 | Val  Acc: 0.2553
 Site-Black                     (4) | Val  Loss: 2.0903 | Val  Acc: 0.3000
 Site-Black                     (5) | Val  Loss: 1.9036 | Val  Acc: 0.2330
 Site-East_Asian                (1) | Val  Loss: 1.9089 | Val  Acc: 0.2250
 Site-East_Asian                (1) | Val  Loss: 1.9349 | Val  Acc: 0.2881
 Site-East_Asian                (1) | Val  Loss: 1.8027 | Val  Acc: 0.3103
 Site-Indian                    (5) | Val  Loss: 1.8970 | Val  Acc: 0.2941
 Site-Indian                    (5) | Val  Loss: 1.8476 | Val  Acc: 0.2632
 Site-Southeast_Asian           (1) | Val  Loss: 2.1358 | Val  Acc: 0.1977
 Site-Middle_Eastern            (2) | Val  Loss: 2.1048 | Val  Acc: 0.1897
Average Valid Accuracy: 0.2617
Aggregated Acc | Val Acc: 0.2256
============ Train epoch 6 ============
cnt=[1, 3, 10, 1, 1, 4, 9, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7100 | Train Acc: 0.4444
 Site-White                    | Train Loss: 2.1256 | Train Acc: 0.0769
 Site-White                    | Train Loss: 1.8871 | Train Acc: 0.3158
 Site-White                    | Train Loss: 1.7459 | Train Acc: 0.4138
 Site-White                    | Train Loss: 1.8423 | Train Acc: 0.4048
 Site-White                    | Train Loss: 1.9194 | Train Acc: 0.3226
 Site-White                    | Train Loss: 1.9176 | Train Acc: 0.2717
 Site-White                    | Train Loss: 1.8963 | Train Acc: 0.2206
 Site-White                    | Train Loss: 1.9378 | Train Acc: 0.3015
 Site-White                    | Train Loss: 1.8482 | Train Acc: 0.2969
 Site-Latino_Hispanic          | Train Loss: 1.9788 | Train Acc: 0.2000
 Site-Latino_Hispanic          | Train Loss: 1.8422 | Train Acc: 0.1333
 Site-Latino_Hispanic          | Train Loss: 1.7291 | Train Acc: 0.3182
 Site-Latino_Hispanic          | Train Loss: 1.8603 | Train Acc: 0.1667
 Site-Latino_Hispanic          | Train Loss: 1.8941 | Train Acc: 0.2784
 Site-Latino_Hispanic          | Train Loss: 1.8082 | Train Acc: 0.2676
 Site-Latino_Hispanic          | Train Loss: 1.8427 | Train Acc: 0.2440
 Site-Black                    | Train Loss: 1.8353 | Train Acc: 0.2727
 Site-Black                    | Train Loss: 1.9772 | Train Acc: 0.2083
 Site-Black                    | Train Loss: 1.9495 | Train Acc: 0.2817
 Site-Black                    | Train Loss: 1.9162 | Train Acc: 0.2667
 Site-Black                    | Train Loss: 1.8451 | Train Acc: 0.2516
 Site-East_Asian               | Train Loss: 1.8333 | Train Acc: 0.3500
 Site-East_Asian               | Train Loss: 1.7951 | Train Acc: 0.3034
 Site-East_Asian               | Train Loss: 1.8488 | Train Acc: 0.2901
 Site-Indian                   | Train Loss: 1.9383 | Train Acc: 0.2078
 Site-Indian                   | Train Loss: 1.9403 | Train Acc: 0.2544
 Site-Southeast_Asian          | Train Loss: 2.2782 | Train Acc: 0.1923
 Site-Middle_Eastern           | Train Loss: 2.0418 | Train Acc: 0.2614
 Site-White                     (4) | Val  Loss: 1.9009 | Val  Acc: 0.3333
 Site-White                     (3) | Val  Loss: 2.4952 | Val  Acc: 0.0000
 Site-White                     (6) | Val  Loss: 1.7683 | Val  Acc: 0.2308
 Site-White                     (2) | Val  Loss: 1.9299 | Val  Acc: 0.2632
 Site-White                     (6) | Val  Loss: 2.0254 | Val  Acc: 0.2500
 Site-White                     (6) | Val  Loss: 1.8482 | Val  Acc: 0.2927
 Site-White                     (6) | Val  Loss: 1.8368 | Val  Acc: 0.3115
 Site-White                     (6) | Val  Loss: 1.7913 | Val  Acc: 0.2889
 Site-White                     (2) | Val  Loss: 1.7823 | Val  Acc: 0.2556
 Site-White                     (6) | Val  Loss: 1.9127 | Val  Acc: 0.2667
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4695 | Val  Acc: 0.4615
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3830 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (2) | Val  Loss: 2.1036 | Val  Acc: 0.1034
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7877 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (6) | Val  Loss: 1.7248 | Val  Acc: 0.2812
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8087 | Val  Acc: 0.2421
 Site-Latino_Hispanic           (2) | Val  Loss: 1.8567 | Val  Acc: 0.2734
 Site-Black                     (0) | Val  Loss: 2.3030 | Val  Acc: 0.0455
 Site-Black                     (5) | Val  Loss: 1.8189 | Val  Acc: 0.3438
 Site-Black                     (5) | Val  Loss: 1.8189 | Val  Acc: 0.2128
 Site-Black                     (5) | Val  Loss: 2.1032 | Val  Acc: 0.3429
 Site-Black                     (5) | Val  Loss: 1.8669 | Val  Acc: 0.2718
 Site-East_Asian                (2) | Val  Loss: 1.8937 | Val  Acc: 0.2500
 Site-East_Asian                (2) | Val  Loss: 1.8732 | Val  Acc: 0.2373
 Site-East_Asian                (2) | Val  Loss: 1.7894 | Val  Acc: 0.2644
 Site-Indian                    (1) | Val  Loss: 1.8610 | Val  Acc: 0.2941
 Site-Indian                    (1) | Val  Loss: 1.8406 | Val  Acc: 0.2500
 Site-Southeast_Asian           (2) | Val  Loss: 2.0948 | Val  Acc: 0.1977
 Site-Middle_Eastern            (6) | Val  Loss: 2.0663 | Val  Acc: 0.1897
Average Valid Accuracy: 0.2627
Aggregated Acc | Val Acc: 0.2129
============ Train epoch 7 ============
cnt=[1, 17, 2, 1, 6, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7120 | Train Acc: 0.4444
 Site-White                    | Train Loss: 2.1050 | Train Acc: 0.1538
 Site-White                    | Train Loss: 1.8749 | Train Acc: 0.2632
 Site-White                    | Train Loss: 1.7337 | Train Acc: 0.4483
 Site-White                    | Train Loss: 1.8253 | Train Acc: 0.3571
 Site-White                    | Train Loss: 1.8832 | Train Acc: 0.3065
 Site-White                    | Train Loss: 1.9352 | Train Acc: 0.2826
 Site-White                    | Train Loss: 1.8684 | Train Acc: 0.2279
 Site-White                    | Train Loss: 1.9070 | Train Acc: 0.3317
 Site-White                    | Train Loss: 1.8485 | Train Acc: 0.2935
 Site-Latino_Hispanic          | Train Loss: 1.9307 | Train Acc: 0.3000
 Site-Latino_Hispanic          | Train Loss: 1.8292 | Train Acc: 0.1667
 Site-Latino_Hispanic          | Train Loss: 1.7229 | Train Acc: 0.3864
 Site-Latino_Hispanic          | Train Loss: 1.7287 | Train Acc: 0.2121
 Site-Latino_Hispanic          | Train Loss: 1.8733 | Train Acc: 0.2680
 Site-Latino_Hispanic          | Train Loss: 1.8224 | Train Acc: 0.2676
 Site-Latino_Hispanic          | Train Loss: 1.7967 | Train Acc: 0.2201
 Site-Black                    | Train Loss: 1.8057 | Train Acc: 0.2424
 Site-Black                    | Train Loss: 1.9645 | Train Acc: 0.1667
 Site-Black                    | Train Loss: 1.9080 | Train Acc: 0.2535
 Site-Black                    | Train Loss: 1.9118 | Train Acc: 0.2762
 Site-Black                    | Train Loss: 1.8720 | Train Acc: 0.2129
 Site-East_Asian               | Train Loss: 1.7979 | Train Acc: 0.3167
 Site-East_Asian               | Train Loss: 1.8287 | Train Acc: 0.2697
 Site-East_Asian               | Train Loss: 1.8145 | Train Acc: 0.2748
 Site-Indian                   | Train Loss: 1.8666 | Train Acc: 0.2338
 Site-Indian                   | Train Loss: 1.9074 | Train Acc: 0.2632
 Site-Southeast_Asian          | Train Loss: 2.1612 | Train Acc: 0.2308
 Site-Middle_Eastern           | Train Loss: 2.0536 | Train Acc: 0.2045
 Site-White                     (6) | Val  Loss: 1.8201 | Val  Acc: 0.3333
 Site-White                     (5) | Val  Loss: 2.4156 | Val  Acc: 0.0000
 Site-White                     (2) | Val  Loss: 1.7077 | Val  Acc: 0.2308
 Site-White                     (0) | Val  Loss: 1.8939 | Val  Acc: 0.3158
 Site-White                     (4) | Val  Loss: 2.0014 | Val  Acc: 0.1786
 Site-White                     (2) | Val  Loss: 1.8276 | Val  Acc: 0.3171
 Site-White                     (4) | Val  Loss: 1.8416 | Val  Acc: 0.3115
 Site-White                     (4) | Val  Loss: 1.7870 | Val  Acc: 0.3111
 Site-White                     (4) | Val  Loss: 1.7810 | Val  Acc: 0.3233
 Site-White                     (4) | Val  Loss: 1.8838 | Val  Acc: 0.2821
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4118 | Val  Acc: 0.6923
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3890 | Val  Acc: 0.5500
 Site-Latino_Hispanic           (1) | Val  Loss: 2.0310 | Val  Acc: 0.1379
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7862 | Val  Acc: 0.2955
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7158 | Val  Acc: 0.2969
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7525 | Val  Acc: 0.2842
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8324 | Val  Acc: 0.3094
 Site-Black                     (1) | Val  Loss: 2.2554 | Val  Acc: 0.0455
 Site-Black                     (1) | Val  Loss: 1.7942 | Val  Acc: 0.3125
 Site-Black                     (1) | Val  Loss: 1.7996 | Val  Acc: 0.2979
 Site-Black                     (1) | Val  Loss: 2.0851 | Val  Acc: 0.3429
 Site-Black                     (1) | Val  Loss: 1.8529 | Val  Acc: 0.2621
 Site-East_Asian                (1) | Val  Loss: 1.8555 | Val  Acc: 0.3000
 Site-East_Asian                (1) | Val  Loss: 1.8662 | Val  Acc: 0.3051
 Site-East_Asian                (1) | Val  Loss: 1.7814 | Val  Acc: 0.3103
 Site-Indian                    (1) | Val  Loss: 1.8551 | Val  Acc: 0.2941
 Site-Indian                    (1) | Val  Loss: 1.8269 | Val  Acc: 0.2632
 Site-Southeast_Asian           (1) | Val  Loss: 2.1125 | Val  Acc: 0.2093
 Site-Middle_Eastern            (4) | Val  Loss: 2.0342 | Val  Acc: 0.1552
Average Valid Accuracy: 0.2851
Aggregated Acc | Val Acc: 0.3084
 Best site-White                    (6)  | Epoch:7 | Val Acc: 0.3333
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.0000
 Best site-White                    (2)  | Epoch:7 | Val Acc: 0.2308
 Best site-White                    (0)  | Epoch:7 | Val Acc: 0.3158
 Best site-White                    (4)  | Epoch:7 | Val Acc: 0.1786
 Best site-White                    (2)  | Epoch:7 | Val Acc: 0.3171
 Best site-White                    (4)  | Epoch:7 | Val Acc: 0.3115
 Best site-White                    (4)  | Epoch:7 | Val Acc: 0.3111
 Best site-White                    (4)  | Epoch:7 | Val Acc: 0.3233
 Best site-White                    (4)  | Epoch:7 | Val Acc: 0.2821
 Best site-Latino_Hispanic          (3)  | Epoch:7 | Val Acc: 0.6923
 Best site-Latino_Hispanic          (1)  | Epoch:7 | Val Acc: 0.5500
 Best site-Latino_Hispanic          (1)  | Epoch:7 | Val Acc: 0.1379
 Best site-Latino_Hispanic          (1)  | Epoch:7 | Val Acc: 0.2955
 Best site-Latino_Hispanic          (1)  | Epoch:7 | Val Acc: 0.2969
 Best site-Latino_Hispanic          (1)  | Epoch:7 | Val Acc: 0.2842
 Best site-Latino_Hispanic          (1)  | Epoch:7 | Val Acc: 0.3094
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.0455
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.3125
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.2979
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.3429
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.2621
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.3000
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.3051
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.3103
 Best site-Indian                   (1)  | Epoch:7 | Val Acc: 0.2941
 Best site-Indian                   (1)  | Epoch:7 | Val Acc: 0.2632
 Best site-Southeast_Asian          (1)  | Epoch:7 | Val Acc: 0.2093
 Best site-Middle_Eastern           (4)  | Epoch:7 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_single_cluster_7/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 14, 1, 1, 7, 4, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7032 | Train Acc: 0.5556
 Site-White                    | Train Loss: 2.1365 | Train Acc: 0.1538
 Site-White                    | Train Loss: 1.8408 | Train Acc: 0.3158
 Site-White                    | Train Loss: 1.7214 | Train Acc: 0.3793
 Site-White                    | Train Loss: 1.8264 | Train Acc: 0.3333
 Site-White                    | Train Loss: 1.8696 | Train Acc: 0.3387
 Site-White                    | Train Loss: 1.9132 | Train Acc: 0.3152
 Site-White                    | Train Loss: 1.9188 | Train Acc: 0.2353
 Site-White                    | Train Loss: 1.8641 | Train Acc: 0.2864
 Site-White                    | Train Loss: 1.8332 | Train Acc: 0.3106
 Site-Latino_Hispanic          | Train Loss: 1.8998 | Train Acc: 0.1000
 Site-Latino_Hispanic          | Train Loss: 1.8090 | Train Acc: 0.1333
 Site-Latino_Hispanic          | Train Loss: 1.7306 | Train Acc: 0.3864
 Site-Latino_Hispanic          | Train Loss: 1.7730 | Train Acc: 0.2273
 Site-Latino_Hispanic          | Train Loss: 1.8482 | Train Acc: 0.2887
 Site-Latino_Hispanic          | Train Loss: 1.8469 | Train Acc: 0.2606
 Site-Latino_Hispanic          | Train Loss: 1.8054 | Train Acc: 0.2440
 Site-Black                    | Train Loss: 1.8221 | Train Acc: 0.2121
 Site-Black                    | Train Loss: 1.9542 | Train Acc: 0.1667
 Site-Black                    | Train Loss: 1.6867 | Train Acc: 0.2676
 Site-Black                    | Train Loss: 1.9087 | Train Acc: 0.2381
 Site-Black                    | Train Loss: 1.8901 | Train Acc: 0.2774
 Site-East_Asian               | Train Loss: 1.8008 | Train Acc: 0.3167
 Site-East_Asian               | Train Loss: 1.7622 | Train Acc: 0.3258
 Site-East_Asian               | Train Loss: 1.7350 | Train Acc: 0.2977
 Site-Indian                   | Train Loss: 1.9302 | Train Acc: 0.2078
 Site-Indian                   | Train Loss: 1.9045 | Train Acc: 0.2895
 Site-Southeast_Asian          | Train Loss: 1.9332 | Train Acc: 0.2462
 Site-Middle_Eastern           | Train Loss: 2.0312 | Train Acc: 0.2386
 Site-White                     (0) | Val  Loss: 1.6879 | Val  Acc: 0.5000
 Site-White                     (6) | Val  Loss: 2.5027 | Val  Acc: 0.1250
 Site-White                     (4) | Val  Loss: 1.7284 | Val  Acc: 0.3077
 Site-White                     (2) | Val  Loss: 1.8329 | Val  Acc: 0.3684
 Site-White                     (4) | Val  Loss: 1.9724 | Val  Acc: 0.1429
 Site-White                     (4) | Val  Loss: 1.8433 | Val  Acc: 0.3415
 Site-White                     (4) | Val  Loss: 1.7662 | Val  Acc: 0.3770
 Site-White                     (4) | Val  Loss: 1.7597 | Val  Acc: 0.3333
 Site-White                     (1) | Val  Loss: 1.7450 | Val  Acc: 0.2331
 Site-White                     (4) | Val  Loss: 1.8454 | Val  Acc: 0.2615
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4960 | Val  Acc: 0.5385
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3987 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (1) | Val  Loss: 2.0289 | Val  Acc: 0.0690
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7450 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (1) | Val  Loss: 1.6879 | Val  Acc: 0.3125
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7735 | Val  Acc: 0.2737
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8276 | Val  Acc: 0.2878
 Site-Black                     (5) | Val  Loss: 2.2845 | Val  Acc: 0.0455
 Site-Black                     (5) | Val  Loss: 1.8714 | Val  Acc: 0.1875
 Site-Black                     (3) | Val  Loss: 1.8017 | Val  Acc: 0.2553
 Site-Black                     (5) | Val  Loss: 2.0062 | Val  Acc: 0.3429
 Site-Black                     (5) | Val  Loss: 1.8677 | Val  Acc: 0.2718
 Site-East_Asian                (1) | Val  Loss: 1.8400 | Val  Acc: 0.2750
 Site-East_Asian                (1) | Val  Loss: 1.8410 | Val  Acc: 0.2542
 Site-East_Asian                (1) | Val  Loss: 1.7716 | Val  Acc: 0.3448
 Site-Indian                    (1) | Val  Loss: 1.8202 | Val  Acc: 0.2941
 Site-Indian                    (1) | Val  Loss: 1.8552 | Val  Acc: 0.3158
 Site-Southeast_Asian           (1) | Val  Loss: 2.0224 | Val  Acc: 0.2093
 Site-Middle_Eastern            (4) | Val  Loss: 2.0255 | Val  Acc: 0.2586
Average Valid Accuracy: 0.2893
Aggregated Acc | Val Acc: 0.2935
 Best site-White                    (0)  | Epoch:8 | Val Acc: 0.5000
 Best site-White                    (6)  | Epoch:8 | Val Acc: 0.1250
 Best site-White                    (4)  | Epoch:8 | Val Acc: 0.3077
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.3684
 Best site-White                    (4)  | Epoch:8 | Val Acc: 0.1429
 Best site-White                    (4)  | Epoch:8 | Val Acc: 0.3415
 Best site-White                    (4)  | Epoch:8 | Val Acc: 0.3770
 Best site-White                    (4)  | Epoch:8 | Val Acc: 0.3333
 Best site-White                    (1)  | Epoch:8 | Val Acc: 0.2331
 Best site-White                    (4)  | Epoch:8 | Val Acc: 0.2615
 Best site-Latino_Hispanic          (1)  | Epoch:8 | Val Acc: 0.5385
 Best site-Latino_Hispanic          (1)  | Epoch:8 | Val Acc: 0.5000
 Best site-Latino_Hispanic          (1)  | Epoch:8 | Val Acc: 0.0690
 Best site-Latino_Hispanic          (1)  | Epoch:8 | Val Acc: 0.3636
 Best site-Latino_Hispanic          (1)  | Epoch:8 | Val Acc: 0.3125
 Best site-Latino_Hispanic          (1)  | Epoch:8 | Val Acc: 0.2737
 Best site-Latino_Hispanic          (1)  | Epoch:8 | Val Acc: 0.2878
 Best site-Black                    (5)  | Epoch:8 | Val Acc: 0.0455
 Best site-Black                    (5)  | Epoch:8 | Val Acc: 0.1875
 Best site-Black                    (3)  | Epoch:8 | Val Acc: 0.2553
 Best site-Black                    (5)  | Epoch:8 | Val Acc: 0.3429
 Best site-Black                    (5)  | Epoch:8 | Val Acc: 0.2718
 Best site-East_Asian               (1)  | Epoch:8 | Val Acc: 0.2750
 Best site-East_Asian               (1)  | Epoch:8 | Val Acc: 0.2542
 Best site-East_Asian               (1)  | Epoch:8 | Val Acc: 0.3448
 Best site-Indian                   (1)  | Epoch:8 | Val Acc: 0.2941
 Best site-Indian                   (1)  | Epoch:8 | Val Acc: 0.3158
 Best site-Southeast_Asian          (1)  | Epoch:8 | Val Acc: 0.2093
 Best site-Middle_Eastern           (4)  | Epoch:8 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_single_cluster_7/ccop_q=1...
============ Train epoch 9 ============
cnt=[10, 7, 1, 8, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6954 | Train Acc: 0.4444
 Site-White                    | Train Loss: 2.1094 | Train Acc: 0.1538
 Site-White                    | Train Loss: 1.8605 | Train Acc: 0.3158
 Site-White                    | Train Loss: 1.7158 | Train Acc: 0.4138
 Site-White                    | Train Loss: 1.7905 | Train Acc: 0.3333
 Site-White                    | Train Loss: 1.8712 | Train Acc: 0.2258
 Site-White                    | Train Loss: 1.8785 | Train Acc: 0.2935
 Site-White                    | Train Loss: 1.7565 | Train Acc: 0.2574
 Site-White                    | Train Loss: 1.7938 | Train Acc: 0.3467
 Site-White                    | Train Loss: 1.8169 | Train Acc: 0.2867
 Site-Latino_Hispanic          | Train Loss: 1.9706 | Train Acc: 0.2000
 Site-Latino_Hispanic          | Train Loss: 1.8135 | Train Acc: 0.2333
 Site-Latino_Hispanic          | Train Loss: 1.6912 | Train Acc: 0.3864
 Site-Latino_Hispanic          | Train Loss: 1.9931 | Train Acc: 0.2121
 Site-Latino_Hispanic          | Train Loss: 1.8570 | Train Acc: 0.2887
 Site-Latino_Hispanic          | Train Loss: 1.7767 | Train Acc: 0.2465
 Site-Latino_Hispanic          | Train Loss: 1.7946 | Train Acc: 0.2632
 Site-Black                    | Train Loss: 1.8187 | Train Acc: 0.2727
 Site-Black                    | Train Loss: 1.8987 | Train Acc: 0.1875
 Site-Black                    | Train Loss: 1.7400 | Train Acc: 0.2535
 Site-Black                    | Train Loss: 1.8965 | Train Acc: 0.2667
 Site-Black                    | Train Loss: 1.8274 | Train Acc: 0.2194
 Site-East_Asian               | Train Loss: 1.7885 | Train Acc: 0.3333
 Site-East_Asian               | Train Loss: 1.7691 | Train Acc: 0.3371
 Site-East_Asian               | Train Loss: 1.8472 | Train Acc: 0.2977
 Site-Indian                   | Train Loss: 1.8778 | Train Acc: 0.2727
 Site-Indian                   | Train Loss: 1.8840 | Train Acc: 0.2719
 Site-Southeast_Asian          | Train Loss: 1.7741 | Train Acc: 0.2615
 Site-Middle_Eastern           | Train Loss: 2.0255 | Train Acc: 0.2727
 Site-White                     (5) | Val  Loss: 1.7233 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 2.4111 | Val  Acc: 0.0000
 Site-White                     (4) | Val  Loss: 1.7302 | Val  Acc: 0.3077
 Site-White                     (0) | Val  Loss: 1.7982 | Val  Acc: 0.3158
 Site-White                     (0) | Val  Loss: 1.9237 | Val  Acc: 0.2500
 Site-White                     (0) | Val  Loss: 1.8142 | Val  Acc: 0.3659
 Site-White                     (0) | Val  Loss: 1.7717 | Val  Acc: 0.3443
 Site-White                     (0) | Val  Loss: 1.7164 | Val  Acc: 0.3889
