===2023-06-16 08:07:26===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.02668, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White-0                   (0) | Train Loss: 1.6631 | Train Acc: 0.3944
 Site-White-1                   (0) | Train Loss: 1.8383 | Train Acc: 0.3636
 Site-White-2                   (0) | Train Loss: 1.8633 | Train Acc: 0.3220
 Site-White-3                   (0) | Train Loss: 1.7865 | Train Acc: 0.3604
 Site-White-4                   (0) | Train Loss: 1.7342 | Train Acc: 0.3573
 Site-Middle_Eastern-0          (0) | Train Loss: 2.3338 | Train Acc: 0.2901
 Site-Middle_Eastern-1          (0) | Train Loss: 2.0507 | Train Acc: 0.2500
 Site-Middle_Eastern-2          (0) | Train Loss: 1.9946 | Train Acc: 0.2651
 Site-Black-0                   (2) | Train Loss: 2.0441 | Train Acc: 0.2435
 Site-Black-1                   (2) | Train Loss: 2.0850 | Train Acc: 0.2112
 Site-White_ffhq-0              (1) | Train Loss: 1.1960 | Train Acc: 0.5420
Average Train Accuracy: 0.3272
 Site-White-0                   (0) | Val  Loss: 1.9823 | Val  Acc: 0.2500
 Site-White-1                   (0) | Val  Loss: 1.9170 | Val  Acc: 0.2059
 Site-White-2                   (0) | Val  Loss: 1.8822 | Val  Acc: 0.3390
 Site-White-3                   (0) | Val  Loss: 1.7967 | Val  Acc: 0.3000
 Site-White-4                   (0) | Val  Loss: 1.8630 | Val  Acc: 0.3000
 Site-Middle_Eastern-0          (0) | Val  Loss: 2.2136 | Val  Acc: 0.2222
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.7635 | Val  Acc: 0.2812
 Site-Middle_Eastern-2          (0) | Val  Loss: 2.0206 | Val  Acc: 0.2037
 Site-Black-0                   (2) | Val  Loss: 2.0792 | Val  Acc: 0.2449
 Site-Black-1                   (2) | Val  Loss: 1.9099 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1460 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2920
 Best site-White-0                  (0)  | Epoch:0 | Val Acc: 0.2500
 Best site-White-1                  (0)  | Epoch:0 | Val Acc: 0.2059
 Best site-White-2                  (0)  | Epoch:0 | Val Acc: 0.3390
 Best site-White-3                  (0)  | Epoch:0 | Val Acc: 0.3000
 Best site-White-4                  (0)  | Epoch:0 | Val Acc: 0.3000
 Best site-Middle_Eastern-0         (0)  | Epoch:0 | Val Acc: 0.2222
 Best site-Middle_Eastern-1         (0)  | Epoch:0 | Val Acc: 0.2812
 Best site-Middle_Eastern-2         (0)  | Epoch:0 | Val Acc: 0.2037
 Best site-Black-0                  (2)  | Epoch:0 | Val Acc: 0.2449
 Best site-Black-1                  (2)  | Epoch:0 | Val Acc: 0.3133
 Best site-White_ffhq-0             (1)  | Epoch:0 | Val Acc: 0.5513
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 1 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.08202, quan_i=2.08, quan_c=1.86
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.7586 | Train Acc: 0.3944
 Site-White-1                   (0) | Train Loss: 1.7824 | Train Acc: 0.3430
 Site-White-2                   (0) | Train Loss: 1.7726 | Train Acc: 0.3414
 Site-White-3                   (0) | Train Loss: 1.7334 | Train Acc: 0.3519
 Site-White-4                   (0) | Train Loss: 1.6752 | Train Acc: 0.3657
 Site-Middle_Eastern-0          (0) | Train Loss: 2.1169 | Train Acc: 0.2824
 Site-Middle_Eastern-1          (0) | Train Loss: 1.9395 | Train Acc: 0.2723
 Site-Middle_Eastern-2          (0) | Train Loss: 1.9071 | Train Acc: 0.2730
 Site-Black-0                   (2) | Train Loss: 1.9376 | Train Acc: 0.2406
 Site-Black-1                   (2) | Train Loss: 2.0090 | Train Acc: 0.1976
 Site-White_ffhq-0              (1) | Train Loss: 1.2624 | Train Acc: 0.4872
Average Train Accuracy: 0.3227
 Site-White-0                   (0) | Val  Loss: 1.9439 | Val  Acc: 0.2000
 Site-White-1                   (0) | Val  Loss: 1.8254 | Val  Acc: 0.2059
 Site-White-2                   (0) | Val  Loss: 1.8296 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.7854 | Val  Acc: 0.3100
 Site-White-4                   (0) | Val  Loss: 1.7792 | Val  Acc: 0.3294
 Site-Middle_Eastern-0          (0) | Val  Loss: 2.0602 | Val  Acc: 0.1667
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.6831 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.9029 | Val  Acc: 0.2222
 Site-Black-0                   (2) | Val  Loss: 1.9833 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.9212 | Val  Acc: 0.2410
 Site-White_ffhq-0              (1) | Val  Loss: 1.2526 | Val  Acc: 0.4359
Average Valid Accuracy: 0.2846
============ Train epoch 2 ============
cnt=[1, 8, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.09225, quan_i=1.96, quan_c=1.79
minimize weight of clients:[10, ]
 Site-White-0                   (1) | Train Loss: 1.6852 | Train Acc: 0.4014
 Site-White-1                   (1) | Train Loss: 1.7307 | Train Acc: 0.3678
 Site-White-2                   (1) | Train Loss: 1.7136 | Train Acc: 0.3898
 Site-White-3                   (1) | Train Loss: 1.6799 | Train Acc: 0.3718
 Site-White-4                   (1) | Train Loss: 1.6224 | Train Acc: 0.3749
 Site-Middle_Eastern-0          (1) | Train Loss: 1.9598 | Train Acc: 0.2977
 Site-Middle_Eastern-1          (1) | Train Loss: 1.8730 | Train Acc: 0.2946
 Site-Middle_Eastern-2          (1) | Train Loss: 1.8260 | Train Acc: 0.3176
 Site-Black-0                   (2) | Train Loss: 1.9048 | Train Acc: 0.2609
 Site-Black-1                   (2) | Train Loss: 1.9727 | Train Acc: 0.2368
 Site-White_ffhq-0              (0) | Train Loss: 1.2798 | Train Acc: 0.4964
Average Train Accuracy: 0.3463
 Site-White-0                   (1) | Val  Loss: 1.8810 | Val  Acc: 0.2500
 Site-White-1                   (1) | Val  Loss: 1.7547 | Val  Acc: 0.2353
 Site-White-2                   (1) | Val  Loss: 1.7813 | Val  Acc: 0.3559
 Site-White-3                   (1) | Val  Loss: 1.7024 | Val  Acc: 0.3600
 Site-White-4                   (1) | Val  Loss: 1.7454 | Val  Acc: 0.3765
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.9507 | Val  Acc: 0.3333
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.6143 | Val  Acc: 0.3125
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.8104 | Val  Acc: 0.2778
 Site-Black-0                   (2) | Val  Loss: 1.9738 | Val  Acc: 0.2245
 Site-Black-1                   (2) | Val  Loss: 1.8764 | Val  Acc: 0.2892
 Site-White_ffhq-0              (0) | Val  Loss: 1.2406 | Val  Acc: 0.5256
Average Valid Accuracy: 0.3219
 Best site-White-0                  (1)  | Epoch:2 | Val Acc: 0.2500
 Best site-White-1                  (1)  | Epoch:2 | Val Acc: 0.2353
 Best site-White-2                  (1)  | Epoch:2 | Val Acc: 0.3559
 Best site-White-3                  (1)  | Epoch:2 | Val Acc: 0.3600
 Best site-White-4                  (1)  | Epoch:2 | Val Acc: 0.3765
 Best site-Middle_Eastern-0         (1)  | Epoch:2 | Val Acc: 0.3333
 Best site-Middle_Eastern-1         (1)  | Epoch:2 | Val Acc: 0.3125
 Best site-Middle_Eastern-2         (1)  | Epoch:2 | Val Acc: 0.2778
 Best site-Black-0                  (2)  | Epoch:2 | Val Acc: 0.2245
 Best site-Black-1                  (2)  | Epoch:2 | Val Acc: 0.2892
 Best site-White_ffhq-0             (0)  | Epoch:2 | Val Acc: 0.5256
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 3 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.08356, quan_i=1.89, quan_c=1.72
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.6170 | Train Acc: 0.4366
 Site-White-1                   (0) | Train Loss: 1.6521 | Train Acc: 0.4050
 Site-White-2                   (0) | Train Loss: 1.6202 | Train Acc: 0.4019
 Site-White-3                   (0) | Train Loss: 1.5878 | Train Acc: 0.4046
 Site-White-4                   (0) | Train Loss: 1.5640 | Train Acc: 0.3841
 Site-Middle_Eastern-0          (0) | Train Loss: 1.7343 | Train Acc: 0.3130
 Site-Middle_Eastern-1          (0) | Train Loss: 1.7610 | Train Acc: 0.3393
 Site-Middle_Eastern-2          (0) | Train Loss: 1.7481 | Train Acc: 0.3386
 Site-Black-0                   (2) | Train Loss: 1.8494 | Train Acc: 0.2725
 Site-Black-1                   (2) | Train Loss: 1.9074 | Train Acc: 0.2402
 Site-White_ffhq-0              (1) | Train Loss: 1.2924 | Train Acc: 0.4653
Average Train Accuracy: 0.3637
 Site-White-0                   (0) | Val  Loss: 1.8666 | Val  Acc: 0.3000
 Site-White-1                   (0) | Val  Loss: 1.6455 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.7701 | Val  Acc: 0.3220
 Site-White-3                   (0) | Val  Loss: 1.6550 | Val  Acc: 0.3500
 Site-White-4                   (0) | Val  Loss: 1.6684 | Val  Acc: 0.4118
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.8187 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.5650 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.7372 | Val  Acc: 0.2593
 Site-Black-0                   (2) | Val  Loss: 1.8868 | Val  Acc: 0.2653
 Site-Black-1                   (2) | Val  Loss: 1.8401 | Val  Acc: 0.2530
 Site-White_ffhq-0              (1) | Val  Loss: 1.2692 | Val  Acc: 0.4744
Average Valid Accuracy: 0.3356
 Best site-White-0                  (0)  | Epoch:3 | Val Acc: 0.3000
 Best site-White-1                  (0)  | Epoch:3 | Val Acc: 0.3235
 Best site-White-2                  (0)  | Epoch:3 | Val Acc: 0.3220
 Best site-White-3                  (0)  | Epoch:3 | Val Acc: 0.3500
 Best site-White-4                  (0)  | Epoch:3 | Val Acc: 0.4118
 Best site-Middle_Eastern-0         (0)  | Epoch:3 | Val Acc: 0.3889
 Best site-Middle_Eastern-1         (0)  | Epoch:3 | Val Acc: 0.3438
 Best site-Middle_Eastern-2         (0)  | Epoch:3 | Val Acc: 0.2593
 Best site-Black-0                  (2)  | Epoch:3 | Val Acc: 0.2653
 Best site-Black-1                  (2)  | Epoch:3 | Val Acc: 0.2530
 Best site-White_ffhq-0             (1)  | Epoch:3 | Val Acc: 0.4744
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.07782, quan_i=1.75, quan_c=1.64
minimize weight of clients:[10, ]
 Site-White-0                   (1) | Train Loss: 1.5205 | Train Acc: 0.4507
 Site-White-1                   (1) | Train Loss: 1.5551 | Train Acc: 0.4215
 Site-White-2                   (1) | Train Loss: 1.5542 | Train Acc: 0.4140
 Site-White-3                   (1) | Train Loss: 1.5129 | Train Acc: 0.4088
 Site-White-4                   (1) | Train Loss: 1.4692 | Train Acc: 0.4192
 Site-Middle_Eastern-0          (1) | Train Loss: 1.5241 | Train Acc: 0.3893
 Site-Middle_Eastern-1          (1) | Train Loss: 1.6531 | Train Acc: 0.3571
 Site-Middle_Eastern-2          (1) | Train Loss: 1.6049 | Train Acc: 0.3780
 Site-Black-0                   (0) | Train Loss: 1.8117 | Train Acc: 0.2580
 Site-Black-1                   (0) | Train Loss: 1.7840 | Train Acc: 0.2743
 Site-White_ffhq-0              (2) | Train Loss: 1.5504 | Train Acc: 0.3923
Average Train Accuracy: 0.3785
 Site-White-0                   (1) | Val  Loss: 1.8151 | Val  Acc: 0.3000
 Site-White-1                   (1) | Val  Loss: 1.5616 | Val  Acc: 0.2941
 Site-White-2                   (1) | Val  Loss: 1.7037 | Val  Acc: 0.3220
 Site-White-3                   (1) | Val  Loss: 1.5839 | Val  Acc: 0.3800
 Site-White-4                   (1) | Val  Loss: 1.6008 | Val  Acc: 0.3765
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.7340 | Val  Acc: 0.3333
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.4734 | Val  Acc: 0.3125
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.5994 | Val  Acc: 0.2963
 Site-Black-0                   (0) | Val  Loss: 1.8507 | Val  Acc: 0.3061
 Site-Black-1                   (0) | Val  Loss: 1.7975 | Val  Acc: 0.3253
 Site-White_ffhq-0              (2) | Val  Loss: 1.4391 | Val  Acc: 0.3846
Average Valid Accuracy: 0.3301
============ Train epoch 5 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.06301, quan_i=1.61, quan_c=1.53
minimize weight of clients:[]
 Site-White-0                   (0) | Train Loss: 1.4645 | Train Acc: 0.4718
 Site-White-1                   (0) | Train Loss: 1.5414 | Train Acc: 0.4545
 Site-White-2                   (0) | Train Loss: 1.4894 | Train Acc: 0.4165
 Site-White-3                   (0) | Train Loss: 1.4421 | Train Acc: 0.4430
 Site-White-4                   (0) | Train Loss: 1.4182 | Train Acc: 0.4368
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5096 | Train Acc: 0.3893
 Site-Middle_Eastern-1          (0) | Train Loss: 1.5319 | Train Acc: 0.4375
 Site-Middle_Eastern-2          (0) | Train Loss: 1.5771 | Train Acc: 0.3990
 Site-Black-0                   (2) | Train Loss: 1.7862 | Train Acc: 0.3072
 Site-Black-1                   (2) | Train Loss: 1.7993 | Train Acc: 0.2947
 Site-White_ffhq-0              (1) | Train Loss: 1.3873 | Train Acc: 0.4416
Average Train Accuracy: 0.4084
 Site-White-0                   (0) | Val  Loss: 1.8161 | Val  Acc: 0.3000
 Site-White-1                   (0) | Val  Loss: 1.5140 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.6378 | Val  Acc: 0.3729
 Site-White-3                   (0) | Val  Loss: 1.5520 | Val  Acc: 0.4200
 Site-White-4                   (0) | Val  Loss: 1.6050 | Val  Acc: 0.3941
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.7423 | Val  Acc: 0.3333
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.5137 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.5598 | Val  Acc: 0.3333
 Site-Black-0                   (2) | Val  Loss: 1.8142 | Val  Acc: 0.2449
 Site-Black-1                   (2) | Val  Loss: 1.8432 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.2769 | Val  Acc: 0.4231
Average Valid Accuracy: 0.3513
 Best site-White-0                  (0)  | Epoch:5 | Val Acc: 0.3000
 Best site-White-1                  (0)  | Epoch:5 | Val Acc: 0.3235
 Best site-White-2                  (0)  | Epoch:5 | Val Acc: 0.3729
 Best site-White-3                  (0)  | Epoch:5 | Val Acc: 0.4200
 Best site-White-4                  (0)  | Epoch:5 | Val Acc: 0.3941
 Best site-Middle_Eastern-0         (0)  | Epoch:5 | Val Acc: 0.3333
 Best site-Middle_Eastern-1         (0)  | Epoch:5 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (0)  | Epoch:5 | Val Acc: 0.3333
 Best site-Black-0                  (2)  | Epoch:5 | Val Acc: 0.2449
 Best site-Black-1                  (2)  | Epoch:5 | Val Acc: 0.3133
 Best site-White_ffhq-0             (1)  | Epoch:5 | Val Acc: 0.4231
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 6, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.06200, quan_i=1.56, quan_c=1.56
minimize weight of clients:[0, 2, 3, 4, 10, ]
 Site-White-0                   (1) | Train Loss: 1.4444 | Train Acc: 0.4859
 Site-White-1                   (1) | Train Loss: 1.5170 | Train Acc: 0.4298
 Site-White-2                   (1) | Train Loss: 1.5048 | Train Acc: 0.4189
 Site-White-3                   (1) | Train Loss: 1.4759 | Train Acc: 0.4316
 Site-White-4                   (1) | Train Loss: 1.4355 | Train Acc: 0.4385
 Site-Middle_Eastern-0          (2) | Train Loss: 1.6816 | Train Acc: 0.4122
 Site-Middle_Eastern-1          (2) | Train Loss: 1.5536 | Train Acc: 0.3929
 Site-Middle_Eastern-2          (2) | Train Loss: 1.5344 | Train Acc: 0.4278
 Site-Black-0                   (0) | Train Loss: 1.6845 | Train Acc: 0.3362
 Site-Black-1                   (0) | Train Loss: 1.6530 | Train Acc: 0.3271
 Site-White_ffhq-0              (1) | Train Loss: 1.4325 | Train Acc: 0.4197
Average Train Accuracy: 0.4110
 Site-White-0                   (1) | Val  Loss: 1.7658 | Val  Acc: 0.2500
 Site-White-1                   (1) | Val  Loss: 1.5178 | Val  Acc: 0.2647
 Site-White-2                   (1) | Val  Loss: 1.6943 | Val  Acc: 0.3559
 Site-White-3                   (1) | Val  Loss: 1.5492 | Val  Acc: 0.3800
 Site-White-4                   (1) | Val  Loss: 1.5634 | Val  Acc: 0.4412
 Site-Middle_Eastern-0          (2) | Val  Loss: 1.6105 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (2) | Val  Loss: 1.3923 | Val  Acc: 0.5000
 Site-Middle_Eastern-2          (2) | Val  Loss: 1.6066 | Val  Acc: 0.2963
 Site-Black-0                   (0) | Val  Loss: 1.7431 | Val  Acc: 0.2653
 Site-Black-1                   (0) | Val  Loss: 1.7927 | Val  Acc: 0.2410
 Site-White_ffhq-0              (1) | Val  Loss: 1.3062 | Val  Acc: 0.4487
Average Valid Accuracy: 0.3534
 Best site-White-0                  (1)  | Epoch:6 | Val Acc: 0.2500
 Best site-White-1                  (1)  | Epoch:6 | Val Acc: 0.2647
 Best site-White-2                  (1)  | Epoch:6 | Val Acc: 0.3559
 Best site-White-3                  (1)  | Epoch:6 | Val Acc: 0.3800
 Best site-White-4                  (1)  | Epoch:6 | Val Acc: 0.4412
 Best site-Middle_Eastern-0         (2)  | Epoch:6 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (2)  | Epoch:6 | Val Acc: 0.5000
 Best site-Middle_Eastern-2         (2)  | Epoch:6 | Val Acc: 0.2963
 Best site-Black-0                  (0)  | Epoch:6 | Val Acc: 0.2653
 Best site-Black-1                  (0)  | Epoch:6 | Val Acc: 0.2410
 Best site-White_ffhq-0             (1)  | Epoch:6 | Val Acc: 0.4487
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 7 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.06192, quan_i=1.56, quan_c=1.50
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.4116 | Train Acc: 0.4789
 Site-White-1                   (0) | Train Loss: 1.4834 | Train Acc: 0.4421
 Site-White-2                   (0) | Train Loss: 1.4433 | Train Acc: 0.4576
 Site-White-3                   (0) | Train Loss: 1.4171 | Train Acc: 0.4444
 Site-White-4                   (0) | Train Loss: 1.3763 | Train Acc: 0.4636
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5100 | Train Acc: 0.4198
 Site-Middle_Eastern-1          (0) | Train Loss: 1.5343 | Train Acc: 0.4286
 Site-Middle_Eastern-2          (0) | Train Loss: 1.4841 | Train Acc: 0.4278
 Site-Black-0                   (2) | Train Loss: 1.7287 | Train Acc: 0.3275
 Site-Black-1                   (2) | Train Loss: 1.6914 | Train Acc: 0.3288
 Site-White_ffhq-0              (1) | Train Loss: 1.4180 | Train Acc: 0.4307
Average Train Accuracy: 0.4227
 Site-White-0                   (0) | Val  Loss: 1.7635 | Val  Acc: 0.2500
 Site-White-1                   (0) | Val  Loss: 1.4632 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.6462 | Val  Acc: 0.3559
 Site-White-3                   (0) | Val  Loss: 1.5064 | Val  Acc: 0.3700
 Site-White-4                   (0) | Val  Loss: 1.5394 | Val  Acc: 0.4471
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6258 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4493 | Val  Acc: 0.3125
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.4977 | Val  Acc: 0.3704
 Site-Black-0                   (2) | Val  Loss: 1.7487 | Val  Acc: 0.3061
 Site-Black-1                   (2) | Val  Loss: 1.6706 | Val  Acc: 0.3012
 Site-White_ffhq-0              (1) | Val  Loss: 1.2708 | Val  Acc: 0.4615
Average Valid Accuracy: 0.3635
 Best site-White-0                  (0)  | Epoch:7 | Val Acc: 0.2500
 Best site-White-1                  (0)  | Epoch:7 | Val Acc: 0.3235
 Best site-White-2                  (0)  | Epoch:7 | Val Acc: 0.3559
 Best site-White-3                  (0)  | Epoch:7 | Val Acc: 0.3700
 Best site-White-4                  (0)  | Epoch:7 | Val Acc: 0.4471
 Best site-Middle_Eastern-0         (0)  | Epoch:7 | Val Acc: 0.5000
 Best site-Middle_Eastern-1         (0)  | Epoch:7 | Val Acc: 0.3125
 Best site-Middle_Eastern-2         (0)  | Epoch:7 | Val Acc: 0.3704
 Best site-Black-0                  (2)  | Epoch:7 | Val Acc: 0.3061
 Best site-Black-1                  (2)  | Epoch:7 | Val Acc: 0.3012
 Best site-White_ffhq-0             (1)  | Epoch:7 | Val Acc: 0.4615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.05929, quan_i=1.52, quan_c=1.44
minimize weight of clients:[10, ]
 Site-White-0                   (1) | Train Loss: 1.3747 | Train Acc: 0.5423
 Site-White-1                   (1) | Train Loss: 1.4853 | Train Acc: 0.4421
 Site-White-2                   (1) | Train Loss: 1.4292 | Train Acc: 0.4455
 Site-White-3                   (1) | Train Loss: 1.3991 | Train Acc: 0.4387
 Site-White-4                   (1) | Train Loss: 1.3475 | Train Acc: 0.4803
 Site-Middle_Eastern-0          (1) | Train Loss: 1.4497 | Train Acc: 0.4351
 Site-Middle_Eastern-1          (1) | Train Loss: 1.4932 | Train Acc: 0.4598
 Site-Middle_Eastern-2          (1) | Train Loss: 1.4714 | Train Acc: 0.4173
 Site-Black-0                   (0) | Train Loss: 1.6722 | Train Acc: 0.3362
 Site-Black-1                   (0) | Train Loss: 1.6773 | Train Acc: 0.3237
 Site-White_ffhq-0              (2) | Train Loss: 1.4307 | Train Acc: 0.4252
Average Train Accuracy: 0.4315
 Site-White-0                   (1) | Val  Loss: 1.7255 | Val  Acc: 0.3500
 Site-White-1                   (1) | Val  Loss: 1.4961 | Val  Acc: 0.3529
 Site-White-2                   (1) | Val  Loss: 1.6669 | Val  Acc: 0.3729
 Site-White-3                   (1) | Val  Loss: 1.4644 | Val  Acc: 0.4200
 Site-White-4                   (1) | Val  Loss: 1.5440 | Val  Acc: 0.4471
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.5479 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.4281 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.4979 | Val  Acc: 0.3704
 Site-Black-0                   (0) | Val  Loss: 1.7615 | Val  Acc: 0.2857
 Site-Black-1                   (0) | Val  Loss: 1.7500 | Val  Acc: 0.2892
 Site-White_ffhq-0              (2) | Val  Loss: 1.3307 | Val  Acc: 0.4359
Average Valid Accuracy: 0.3795
 Best site-White-0                  (1)  | Epoch:8 | Val Acc: 0.3500
 Best site-White-1                  (1)  | Epoch:8 | Val Acc: 0.3529
 Best site-White-2                  (1)  | Epoch:8 | Val Acc: 0.3729
 Best site-White-3                  (1)  | Epoch:8 | Val Acc: 0.4200
 Best site-White-4                  (1)  | Epoch:8 | Val Acc: 0.4471
 Best site-Middle_Eastern-0         (1)  | Epoch:8 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (1)  | Epoch:8 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (1)  | Epoch:8 | Val Acc: 0.3704
 Best site-Black-0                  (0)  | Epoch:8 | Val Acc: 0.2857
 Best site-Black-1                  (0)  | Epoch:8 | Val Acc: 0.2892
 Best site-White_ffhq-0             (2)  | Epoch:8 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 9 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
min_w=0.05633, quan_i=1.49, quan_c=1.42
minimize weight of clients:[]
 Site-White-0                   (0) | Train Loss: 1.3942 | Train Acc: 0.4789
 Site-White-1                   (0) | Train Loss: 1.4945 | Train Acc: 0.4380
 Site-White-2                   (0) | Train Loss: 1.4401 | Train Acc: 0.4286
 Site-White-3                   (0) | Train Loss: 1.3840 | Train Acc: 0.4587
 Site-White-4                   (0) | Train Loss: 1.3394 | Train Acc: 0.4678
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5404 | Train Acc: 0.3817
 Site-Middle_Eastern-1          (0) | Train Loss: 1.5192 | Train Acc: 0.4554
 Site-Middle_Eastern-2          (0) | Train Loss: 1.4715 | Train Acc: 0.4173
 Site-Black-0                   (2) | Train Loss: 1.7188 | Train Acc: 0.3275
 Site-Black-1                   (2) | Train Loss: 1.6516 | Train Acc: 0.3152
 Site-White_ffhq-0              (1) | Train Loss: 1.2931 | Train Acc: 0.4891
Average Train Accuracy: 0.4235
 Site-White-0                   (0) | Val  Loss: 1.7119 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.4282 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.6494 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.4565 | Val  Acc: 0.4400
 Site-White-4                   (0) | Val  Loss: 1.5184 | Val  Acc: 0.4588
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6563 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3825 | Val  Acc: 0.3750
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.5268 | Val  Acc: 0.2963
 Site-Black-0                   (2) | Val  Loss: 1.8412 | Val  Acc: 0.2653
 Site-Black-1                   (2) | Val  Loss: 1.7388 | Val  Acc: 0.2530
 Site-White_ffhq-0              (1) | Val  Loss: 1.1730 | Val  Acc: 0.4615
Average Valid Accuracy: 0.3689
 Test site-White-0                   (0)| Epoch:8 | Test Acc: 0.3571
 Test site-White-1                   (0)| Epoch:8 | Test Acc: 0.4930
 Test site-White-2                   (0)| Epoch:8 | Test Acc: 0.4706
 Test site-White-3                   (0)| Epoch:8 | Test Acc: 0.4109
 Test site-White-4                   (0)| Epoch:8 | Test Acc: 0.4490
 Test site-Middle_Eastern-0          (0)| Epoch:8 | Test Acc: 0.3846
 Test site-Middle_Eastern-1          (0)| Epoch:8 | Test Acc: 0.3077
 Test site-Middle_Eastern-2          (0)| Epoch:8 | Test Acc: 0.4364
 Test site-Black-0                   (2)| Epoch:8 | Test Acc: 0.3500
 Test site-Black-1                   (2)| Epoch:8 | Test Acc: 0.3195
 Test site-White_ffhq-0              (1)| Epoch:8 | Test Acc: 0.4430
White: 0.4361, Middle_Eastern: 0.3762, Black: 0.3348, White_ffhq: 0.4430, 
Average Test Accuracy(group): 0.3975, Average Test Accuracy(individual): 0.4020,
domain std=0.0446, cluster std=0.0457, individual std=0.0594, 
============ Train epoch 10 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
min_w=0.05771, quan_i=1.54, quan_c=1.42
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.3488 | Train Acc: 0.5211
 Site-White-1                   (0) | Train Loss: 1.4636 | Train Acc: 0.4421
 Site-White-2                   (0) | Train Loss: 1.4152 | Train Acc: 0.4431
 Site-White-3                   (0) | Train Loss: 1.3677 | Train Acc: 0.4729
 Site-White-4                   (0) | Train Loss: 1.3148 | Train Acc: 0.4812
 Site-Middle_Eastern-0          (0) | Train Loss: 1.3614 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (0) | Train Loss: 1.4653 | Train Acc: 0.4554
 Site-Middle_Eastern-2          (0) | Train Loss: 1.4422 | Train Acc: 0.4409
 Site-Black-0                   (2) | Train Loss: 1.6302 | Train Acc: 0.3681
 Site-Black-1                   (2) | Train Loss: 1.6417 | Train Acc: 0.3390
 Site-White_ffhq-0              (1) | Train Loss: 1.3547 | Train Acc: 0.4635
Average Train Accuracy: 0.4414
 Site-White-0                   (0) | Val  Loss: 1.7758 | Val  Acc: 0.3000
 Site-White-1                   (0) | Val  Loss: 1.3768 | Val  Acc: 0.3529
 Site-White-2                   (0) | Val  Loss: 1.6344 | Val  Acc: 0.3559
 Site-White-3                   (0) | Val  Loss: 1.4530 | Val  Acc: 0.4200
 Site-White-4                   (0) | Val  Loss: 1.4909 | Val  Acc: 0.4412
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6230 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4184 | Val  Acc: 0.3750
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.4258 | Val  Acc: 0.3704
 Site-Black-0                   (2) | Val  Loss: 1.6727 | Val  Acc: 0.4490
 Site-Black-1                   (2) | Val  Loss: 1.7568 | Val  Acc: 0.3012
 Site-White_ffhq-0              (1) | Val  Loss: 1.2587 | Val  Acc: 0.4744
Average Valid Accuracy: 0.3895
 Best site-White-0                  (0)  | Epoch:10 | Val Acc: 0.3000
 Best site-White-1                  (0)  | Epoch:10 | Val Acc: 0.3529
 Best site-White-2                  (0)  | Epoch:10 | Val Acc: 0.3559
 Best site-White-3                  (0)  | Epoch:10 | Val Acc: 0.4200
 Best site-White-4                  (0)  | Epoch:10 | Val Acc: 0.4412
 Best site-Middle_Eastern-0         (0)  | Epoch:10 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (0)  | Epoch:10 | Val Acc: 0.3750
 Best site-Middle_Eastern-2         (0)  | Epoch:10 | Val Acc: 0.3704
 Best site-Black-0                  (2)  | Epoch:10 | Val Acc: 0.4490
 Best site-Black-1                  (2)  | Epoch:10 | Val Acc: 0.3012
 Best site-White_ffhq-0             (1)  | Epoch:10 | Val Acc: 0.4744
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 11 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
min_w=0.05033, quan_i=1.47, quan_c=1.38
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.3386 | Train Acc: 0.5423
 Site-White-1                   (0) | Train Loss: 1.4369 | Train Acc: 0.4669
 Site-White-2                   (0) | Train Loss: 1.4092 | Train Acc: 0.4528
 Site-White-3                   (0) | Train Loss: 1.3561 | Train Acc: 0.4886
 Site-White-4                   (0) | Train Loss: 1.3071 | Train Acc: 0.4854
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5232 | Train Acc: 0.4122
 Site-Middle_Eastern-1          (0) | Train Loss: 1.4478 | Train Acc: 0.4554
 Site-Middle_Eastern-2          (0) | Train Loss: 1.4398 | Train Acc: 0.4304
 Site-Black-0                   (2) | Train Loss: 1.6514 | Train Acc: 0.3565
 Site-Black-1                   (2) | Train Loss: 1.6384 | Train Acc: 0.3731
 Site-White_ffhq-0              (1) | Train Loss: 1.3962 | Train Acc: 0.4398
Average Train Accuracy: 0.4458
 Site-White-0                   (0) | Val  Loss: 1.6673 | Val  Acc: 0.4000
 Site-White-1                   (0) | Val  Loss: 1.4137 | Val  Acc: 0.3824
 Site-White-2                   (0) | Val  Loss: 1.5764 | Val  Acc: 0.4237
 Site-White-3                   (0) | Val  Loss: 1.4521 | Val  Acc: 0.4200
 Site-White-4                   (0) | Val  Loss: 1.4866 | Val  Acc: 0.4765
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6030 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4307 | Val  Acc: 0.3750
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.4550 | Val  Acc: 0.3704
 Site-Black-0                   (2) | Val  Loss: 1.7351 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.6755 | Val  Acc: 0.2892
 Site-White_ffhq-0              (1) | Val  Loss: 1.2987 | Val  Acc: 0.4103
Average Valid Accuracy: 0.3889
============ Train epoch 12 ============
cnt=[1, 8, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
min_w=0.05374, quan_i=1.45, quan_c=1.38
minimize weight of clients:[]
 Site-White-0                   (1) | Train Loss: 1.2742 | Train Acc: 0.5423
 Site-White-1                   (1) | Train Loss: 1.4338 | Train Acc: 0.4587
 Site-White-2                   (1) | Train Loss: 1.4121 | Train Acc: 0.4625
 Site-White-3                   (1) | Train Loss: 1.3434 | Train Acc: 0.4601
 Site-White-4                   (1) | Train Loss: 1.2775 | Train Acc: 0.5013
 Site-Middle_Eastern-0          (1) | Train Loss: 1.7644 | Train Acc: 0.3969
 Site-Middle_Eastern-1          (1) | Train Loss: 1.4715 | Train Acc: 0.4420
 Site-Middle_Eastern-2          (1) | Train Loss: 1.4278 | Train Acc: 0.4436
 Site-Black-0                   (2) | Train Loss: 1.7155 | Train Acc: 0.3652
 Site-Black-1                   (2) | Train Loss: 1.6826 | Train Acc: 0.3186
 Site-White_ffhq-0              (0) | Train Loss: 1.2515 | Train Acc: 0.4781
Average Train Accuracy: 0.4426
 Site-White-0                   (1) | Val  Loss: 1.6943 | Val  Acc: 0.3500
 Site-White-1                   (1) | Val  Loss: 1.3971 | Val  Acc: 0.3824
 Site-White-2                   (1) | Val  Loss: 1.6531 | Val  Acc: 0.3898
 Site-White-3                   (1) | Val  Loss: 1.4508 | Val  Acc: 0.4100
 Site-White-4                   (1) | Val  Loss: 1.5034 | Val  Acc: 0.4529
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.6467 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.4363 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.4371 | Val  Acc: 0.3704
 Site-Black-0                   (2) | Val  Loss: 1.7459 | Val  Acc: 0.2449
 Site-Black-1                   (2) | Val  Loss: 1.7472 | Val  Acc: 0.3494
 Site-White_ffhq-0              (0) | Val  Loss: 1.1363 | Val  Acc: 0.5128
Average Valid Accuracy: 0.3814
============ Train epoch 13 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
min_w=0.05017, quan_i=1.49, quan_c=1.37
minimize weight of clients:[10, ]
 Site-White-0                   (1) | Train Loss: 1.2291 | Train Acc: 0.5704
 Site-White-1                   (1) | Train Loss: 1.4201 | Train Acc: 0.4628
 Site-White-2                   (1) | Train Loss: 1.3769 | Train Acc: 0.4528
 Site-White-3                   (1) | Train Loss: 1.3482 | Train Acc: 0.4644
 Site-White-4                   (1) | Train Loss: 1.2780 | Train Acc: 0.5004
 Site-Middle_Eastern-0          (1) | Train Loss: 1.4266 | Train Acc: 0.4580
 Site-Middle_Eastern-1          (1) | Train Loss: 1.4143 | Train Acc: 0.4375
 Site-Middle_Eastern-2          (1) | Train Loss: 1.3949 | Train Acc: 0.4619
 Site-Black-0                   (0) | Train Loss: 1.6081 | Train Acc: 0.3826
 Site-Black-1                   (0) | Train Loss: 1.5733 | Train Acc: 0.3629
 Site-White_ffhq-0              (2) | Train Loss: 1.3710 | Train Acc: 0.4580
Average Train Accuracy: 0.4556
 Site-White-0                   (1) | Val  Loss: 1.6752 | Val  Acc: 0.3500
 Site-White-1                   (1) | Val  Loss: 1.3587 | Val  Acc: 0.3529
 Site-White-2                   (1) | Val  Loss: 1.6051 | Val  Acc: 0.3390
 Site-White-3                   (1) | Val  Loss: 1.3779 | Val  Acc: 0.4500
 Site-White-4                   (1) | Val  Loss: 1.4892 | Val  Acc: 0.4647
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.5423 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.4139 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.4035 | Val  Acc: 0.4074
 Site-Black-0                   (0) | Val  Loss: 1.6981 | Val  Acc: 0.3265
 Site-Black-1                   (0) | Val  Loss: 1.6604 | Val  Acc: 0.3253
 Site-White_ffhq-0              (2) | Val  Loss: 1.2434 | Val  Acc: 0.4231
Average Valid Accuracy: 0.3878
============ Train epoch 14 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
min_w=0.04723, quan_i=1.43, quan_c=1.35
minimize weight of clients:[]
 Site-White-0                   (1) | Train Loss: 1.4167 | Train Acc: 0.5423
 Site-White-1                   (1) | Train Loss: 1.4215 | Train Acc: 0.4463
 Site-White-2                   (1) | Train Loss: 1.3677 | Train Acc: 0.4552
 Site-White-3                   (1) | Train Loss: 1.3221 | Train Acc: 0.4744
 Site-White-4                   (1) | Train Loss: 1.2575 | Train Acc: 0.5071
 Site-Middle_Eastern-0          (1) | Train Loss: 1.2934 | Train Acc: 0.4504
 Site-Middle_Eastern-1          (1) | Train Loss: 1.4565 | Train Acc: 0.4554
 Site-Middle_Eastern-2          (1) | Train Loss: 1.4204 | Train Acc: 0.4409
 Site-Black-0                   (0) | Train Loss: 1.6341 | Train Acc: 0.3594
 Site-Black-1                   (0) | Train Loss: 1.5871 | Train Acc: 0.3339
 Site-White_ffhq-0              (2) | Train Loss: 1.2346 | Train Acc: 0.5036
Average Train Accuracy: 0.4517
 Site-White-0                   (1) | Val  Loss: 1.6953 | Val  Acc: 0.4500
 Site-White-1                   (1) | Val  Loss: 1.4271 | Val  Acc: 0.3529
 Site-White-2                   (1) | Val  Loss: 1.6172 | Val  Acc: 0.4068
 Site-White-3                   (1) | Val  Loss: 1.4039 | Val  Acc: 0.4900
 Site-White-4                   (1) | Val  Loss: 1.4917 | Val  Acc: 0.4412
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.5962 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.4073 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.4338 | Val  Acc: 0.4259
 Site-Black-0                   (0) | Val  Loss: 1.7519 | Val  Acc: 0.3265
 Site-Black-1                   (0) | Val  Loss: 1.6695 | Val  Acc: 0.2410
 Site-White_ffhq-0              (2) | Val  Loss: 1.1364 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4003
 Best site-White-0                  (1)  | Epoch:14 | Val Acc: 0.4500
 Best site-White-1                  (1)  | Epoch:14 | Val Acc: 0.3529
 Best site-White-2                  (1)  | Epoch:14 | Val Acc: 0.4068
 Best site-White-3                  (1)  | Epoch:14 | Val Acc: 0.4900
 Best site-White-4                  (1)  | Epoch:14 | Val Acc: 0.4412
 Best site-Middle_Eastern-0         (1)  | Epoch:14 | Val Acc: 0.3889
 Best site-Middle_Eastern-1         (1)  | Epoch:14 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (1)  | Epoch:14 | Val Acc: 0.4259
 Best site-Black-0                  (0)  | Epoch:14 | Val Acc: 0.3265
 Best site-Black-1                  (0)  | Epoch:14 | Val Acc: 0.2410
 Best site-White_ffhq-0             (2)  | Epoch:14 | Val Acc: 0.4744
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 15 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
min_w=0.04625, quan_i=1.43, quan_c=1.34
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.3122 | Train Acc: 0.5493
 Site-White-1                   (0) | Train Loss: 1.4079 | Train Acc: 0.4752
 Site-White-2                   (0) | Train Loss: 1.3234 | Train Acc: 0.4649
 Site-White-3                   (0) | Train Loss: 1.3118 | Train Acc: 0.5071
 Site-White-4                   (0) | Train Loss: 1.2494 | Train Acc: 0.5063
 Site-Middle_Eastern-0          (0) | Train Loss: 1.4826 | Train Acc: 0.3893
 Site-Middle_Eastern-1          (0) | Train Loss: 1.4611 | Train Acc: 0.4420
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3755 | Train Acc: 0.4619
 Site-Black-0                   (2) | Train Loss: 1.6270 | Train Acc: 0.3710
 Site-Black-1                   (2) | Train Loss: 1.5758 | Train Acc: 0.3629
 Site-White_ffhq-0              (1) | Train Loss: 1.3417 | Train Acc: 0.4726
Average Train Accuracy: 0.4548
 Site-White-0                   (0) | Val  Loss: 1.6050 | Val  Acc: 0.4000
 Site-White-1                   (0) | Val  Loss: 1.3945 | Val  Acc: 0.3824
 Site-White-2                   (0) | Val  Loss: 1.6145 | Val  Acc: 0.3390
 Site-White-3                   (0) | Val  Loss: 1.3491 | Val  Acc: 0.4600
 Site-White-4                   (0) | Val  Loss: 1.4805 | Val  Acc: 0.4529
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6452 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3486 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.4100 | Val  Acc: 0.3704
 Site-Black-0                   (2) | Val  Loss: 1.6572 | Val  Acc: 0.3469
 Site-Black-1                   (2) | Val  Loss: 1.6912 | Val  Acc: 0.3614
 Site-White_ffhq-0              (1) | Val  Loss: 1.2366 | Val  Acc: 0.4872
Average Valid Accuracy: 0.4103
 Best site-White-0                  (0)  | Epoch:15 | Val Acc: 0.4000
 Best site-White-1                  (0)  | Epoch:15 | Val Acc: 0.3824
 Best site-White-2                  (0)  | Epoch:15 | Val Acc: 0.3390
 Best site-White-3                  (0)  | Epoch:15 | Val Acc: 0.4600
 Best site-White-4                  (0)  | Epoch:15 | Val Acc: 0.4529
 Best site-Middle_Eastern-0         (0)  | Epoch:15 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (0)  | Epoch:15 | Val Acc: 0.4688
 Best site-Middle_Eastern-2         (0)  | Epoch:15 | Val Acc: 0.3704
 Best site-Black-0                  (2)  | Epoch:15 | Val Acc: 0.3469
 Best site-Black-1                  (2)  | Epoch:15 | Val Acc: 0.3614
 Best site-White_ffhq-0             (1)  | Epoch:15 | Val Acc: 0.4872
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 16 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
min_w=0.05041, quan_i=1.47, quan_c=1.33
minimize weight of clients:[]
 Site-White-0                   (0) | Train Loss: 1.4359 | Train Acc: 0.5000
 Site-White-1                   (0) | Train Loss: 1.4016 | Train Acc: 0.4545
 Site-White-2                   (0) | Train Loss: 1.3752 | Train Acc: 0.4528
 Site-White-3                   (0) | Train Loss: 1.3059 | Train Acc: 0.4758
 Site-White-4                   (0) | Train Loss: 1.2197 | Train Acc: 0.5088
 Site-Middle_Eastern-0          (0) | Train Loss: 1.7292 | Train Acc: 0.3969
 Site-Middle_Eastern-1          (0) | Train Loss: 1.4301 | Train Acc: 0.4643
 Site-Middle_Eastern-2          (0) | Train Loss: 1.4027 | Train Acc: 0.4514
 Site-Black-0                   (2) | Train Loss: 1.6443 | Train Acc: 0.3681
 Site-Black-1                   (2) | Train Loss: 1.6181 | Train Acc: 0.3339
 Site-White_ffhq-0              (1) | Train Loss: 1.2116 | Train Acc: 0.4964
Average Train Accuracy: 0.4457
 Site-White-0                   (0) | Val  Loss: 1.6863 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.3684 | Val  Acc: 0.4118
 Site-White-2                   (0) | Val  Loss: 1.6520 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.3765 | Val  Acc: 0.4200
 Site-White-4                   (0) | Val  Loss: 1.4775 | Val  Acc: 0.4647
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5115 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3495 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3859 | Val  Acc: 0.3889
 Site-Black-0                   (2) | Val  Loss: 1.7768 | Val  Acc: 0.3061
 Site-Black-1                   (2) | Val  Loss: 1.7098 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1439 | Val  Acc: 0.4487
Average Valid Accuracy: 0.4006
============ Train epoch 17 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
min_w=0.05698, quan_i=1.45, quan_c=1.34
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.1989 | Train Acc: 0.5352
 Site-White-1                   (0) | Train Loss: 1.4376 | Train Acc: 0.4669
 Site-White-2                   (0) | Train Loss: 1.3380 | Train Acc: 0.4479
 Site-White-3                   (0) | Train Loss: 1.2904 | Train Acc: 0.4858
 Site-White-4                   (0) | Train Loss: 1.2358 | Train Acc: 0.5331
 Site-Middle_Eastern-0          (0) | Train Loss: 1.2269 | Train Acc: 0.3893
 Site-Middle_Eastern-1          (0) | Train Loss: 1.4013 | Train Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3573 | Train Acc: 0.4593
 Site-Black-0                   (1) | Train Loss: 1.5851 | Train Acc: 0.3739
 Site-Black-1                   (1) | Train Loss: 1.5654 | Train Acc: 0.3884
 Site-White_ffhq-0              (2) | Train Loss: 1.3067 | Train Acc: 0.4891
Average Train Accuracy: 0.4580
 Site-White-0                   (0) | Val  Loss: 1.6741 | Val  Acc: 0.2500
 Site-White-1                   (0) | Val  Loss: 1.3658 | Val  Acc: 0.3235
 Site-White-2                   (0) | Val  Loss: 1.6224 | Val  Acc: 0.3390
 Site-White-3                   (0) | Val  Loss: 1.3969 | Val  Acc: 0.4300
 Site-White-4                   (0) | Val  Loss: 1.4670 | Val  Acc: 0.4706
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5280 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3343 | Val  Acc: 0.3750
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.4015 | Val  Acc: 0.4259
 Site-Black-0                   (1) | Val  Loss: 1.7016 | Val  Acc: 0.3673
 Site-Black-1                   (1) | Val  Loss: 1.6269 | Val  Acc: 0.3614
 Site-White_ffhq-0              (2) | Val  Loss: 1.1631 | Val  Acc: 0.4744
Average Valid Accuracy: 0.3824
============ Train epoch 18 ============
cnt=[5, 5, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
min_w=0.04465, quan_i=1.41, quan_c=1.49
minimize weight of clients:[0, 2, 3, 4, 10, ]
 Site-White-0                   (1) | Train Loss: 1.2586 | Train Acc: 0.5211
 Site-White-1                   (1) | Train Loss: 1.4387 | Train Acc: 0.4545
 Site-White-2                   (1) | Train Loss: 1.3988 | Train Acc: 0.4600
 Site-White-3                   (1) | Train Loss: 1.3257 | Train Acc: 0.5057
 Site-White-4                   (1) | Train Loss: 1.2715 | Train Acc: 0.5146
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5948 | Train Acc: 0.4351
 Site-Middle_Eastern-1          (0) | Train Loss: 1.4151 | Train Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3708 | Train Acc: 0.4672
 Site-Black-0                   (0) | Train Loss: 1.5403 | Train Acc: 0.3942
 Site-Black-1                   (0) | Train Loss: 1.5027 | Train Acc: 0.4276
 Site-White_ffhq-0              (2) | Train Loss: 1.4201 | Train Acc: 0.4544
Average Train Accuracy: 0.4639
 Site-White-0                   (1) | Val  Loss: 1.5928 | Val  Acc: 0.3500
 Site-White-1                   (1) | Val  Loss: 1.3756 | Val  Acc: 0.3529
 Site-White-2                   (1) | Val  Loss: 1.6688 | Val  Acc: 0.3898
 Site-White-3                   (1) | Val  Loss: 1.3778 | Val  Acc: 0.4600
 Site-White-4                   (1) | Val  Loss: 1.4978 | Val  Acc: 0.4529
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4469 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4724 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.4198 | Val  Acc: 0.3519
 Site-Black-0                   (0) | Val  Loss: 1.6500 | Val  Acc: 0.4082
 Site-Black-1                   (0) | Val  Loss: 1.6922 | Val  Acc: 0.3012
 Site-White_ffhq-0              (2) | Val  Loss: 1.2597 | Val  Acc: 0.4359
Average Valid Accuracy: 0.4008
============ Train epoch 19 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
min_w=0.04913, quan_i=1.45, quan_c=1.35
minimize weight of clients:[]
 Site-White-0                   (1) | Train Loss: 1.2464 | Train Acc: 0.5211
 Site-White-1                   (1) | Train Loss: 1.3822 | Train Acc: 0.5041
 Site-White-2                   (1) | Train Loss: 1.3504 | Train Acc: 0.4746
 Site-White-3                   (1) | Train Loss: 1.2870 | Train Acc: 0.4943
 Site-White-4                   (1) | Train Loss: 1.2116 | Train Acc: 0.5163
 Site-Middle_Eastern-0          (1) | Train Loss: 1.3969 | Train Acc: 0.4198
 Site-Middle_Eastern-1          (1) | Train Loss: 1.4579 | Train Acc: 0.4643
 Site-Middle_Eastern-2          (1) | Train Loss: 1.3739 | Train Acc: 0.4436
 Site-Black-0                   (0) | Train Loss: 1.6575 | Train Acc: 0.3768
 Site-Black-1                   (0) | Train Loss: 1.5824 | Train Acc: 0.3390
 Site-White_ffhq-0              (2) | Train Loss: 1.1774 | Train Acc: 0.5182
Average Train Accuracy: 0.4611
 Site-White-0                   (1) | Val  Loss: 1.7167 | Val  Acc: 0.3000
 Site-White-1                   (1) | Val  Loss: 1.4135 | Val  Acc: 0.3529
 Site-White-2                   (1) | Val  Loss: 1.6128 | Val  Acc: 0.3898
 Site-White-3                   (1) | Val  Loss: 1.3691 | Val  Acc: 0.4600
 Site-White-4                   (1) | Val  Loss: 1.4617 | Val  Acc: 0.4529
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.5205 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3684 | Val  Acc: 0.3750
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.4141 | Val  Acc: 0.4074
 Site-Black-0                   (0) | Val  Loss: 1.8282 | Val  Acc: 0.3061
 Site-Black-1                   (0) | Val  Loss: 1.7081 | Val  Acc: 0.3012
 Site-White_ffhq-0              (2) | Val  Loss: 1.0595 | Val  Acc: 0.4615
Average Valid Accuracy: 0.3865
 Test site-White-0                   (1)| Epoch:15 | Test Acc: 0.3810
 Test site-White-1                   (1)| Epoch:15 | Test Acc: 0.4930
 Test site-White-2                   (1)| Epoch:15 | Test Acc: 0.4202
 Test site-White-3                   (1)| Epoch:15 | Test Acc: 0.4653
 Test site-White-4                   (1)| Epoch:15 | Test Acc: 0.4577
 Test site-Middle_Eastern-0          (1)| Epoch:15 | Test Acc: 0.4359
 Test site-Middle_Eastern-1          (1)| Epoch:15 | Test Acc: 0.3385
 Test site-Middle_Eastern-2          (1)| Epoch:15 | Test Acc: 0.4273
 Test site-Black-0                   (0)| Epoch:15 | Test Acc: 0.3500
 Test site-Black-1                   (0)| Epoch:15 | Test Acc: 0.3491
 Test site-White_ffhq-0              (2)| Epoch:15 | Test Acc: 0.5190
White: 0.4434, Middle_Eastern: 0.4005, Black: 0.3496, White_ffhq: 0.5190, 
Average Test Accuracy(group): 0.4281, Average Test Accuracy(individual): 0.4215,
domain std=0.0621, cluster std=0.0692, individual std=0.0580, 
============ Train epoch 20 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
min_w=0.04703, quan_i=1.41, quan_c=1.31
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.2674 | Train Acc: 0.5141
 Site-White-1                   (0) | Train Loss: 1.4119 | Train Acc: 0.4917
 Site-White-2                   (0) | Train Loss: 1.3533 | Train Acc: 0.4697
 Site-White-3                   (0) | Train Loss: 1.2856 | Train Acc: 0.4815
 Site-White-4                   (0) | Train Loss: 1.2166 | Train Acc: 0.5213
 Site-Middle_Eastern-0          (0) | Train Loss: 1.4412 | Train Acc: 0.4046
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3960 | Train Acc: 0.4554
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3567 | Train Acc: 0.4593
 Site-Black-0                   (2) | Train Loss: 1.5778 | Train Acc: 0.3739
 Site-Black-1                   (2) | Train Loss: 1.5923 | Train Acc: 0.3748
 Site-White_ffhq-0              (1) | Train Loss: 1.2853 | Train Acc: 0.4982
Average Train Accuracy: 0.4586
 Site-White-0                   (0) | Val  Loss: 1.6980 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.3189 | Val  Acc: 0.4412
 Site-White-2                   (0) | Val  Loss: 1.6197 | Val  Acc: 0.3390
 Site-White-3                   (0) | Val  Loss: 1.3428 | Val  Acc: 0.4600
 Site-White-4                   (0) | Val  Loss: 1.4741 | Val  Acc: 0.4647
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5090 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3956 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3950 | Val  Acc: 0.4630
 Site-Black-0                   (2) | Val  Loss: 1.6654 | Val  Acc: 0.3878
 Site-Black-1                   (2) | Val  Loss: 1.6413 | Val  Acc: 0.3253
 Site-White_ffhq-0              (1) | Val  Loss: 1.1281 | Val  Acc: 0.4615
Average Valid Accuracy: 0.4130
 Best site-White-0                  (0)  | Epoch:20 | Val Acc: 0.3500
 Best site-White-1                  (0)  | Epoch:20 | Val Acc: 0.4412
 Best site-White-2                  (0)  | Epoch:20 | Val Acc: 0.3390
 Best site-White-3                  (0)  | Epoch:20 | Val Acc: 0.4600
 Best site-White-4                  (0)  | Epoch:20 | Val Acc: 0.4647
 Best site-Middle_Eastern-0         (0)  | Epoch:20 | Val Acc: 0.4444
 Best site-Middle_Eastern-1         (0)  | Epoch:20 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (0)  | Epoch:20 | Val Acc: 0.4630
 Best site-Black-0                  (2)  | Epoch:20 | Val Acc: 0.3878
 Best site-Black-1                  (2)  | Epoch:20 | Val Acc: 0.3253
 Best site-White_ffhq-0             (1)  | Epoch:20 | Val Acc: 0.4615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 21 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
min_w=0.04843, quan_i=1.43, quan_c=1.31
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.1531 | Train Acc: 0.5070
 Site-White-1                   (0) | Train Loss: 1.3563 | Train Acc: 0.4959
 Site-White-2                   (0) | Train Loss: 1.3197 | Train Acc: 0.4939
 Site-White-3                   (0) | Train Loss: 1.2832 | Train Acc: 0.4986
 Site-White-4                   (0) | Train Loss: 1.2038 | Train Acc: 0.5255
 Site-Middle_Eastern-0          (0) | Train Loss: 1.4573 | Train Acc: 0.4580
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3978 | Train Acc: 0.4866
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3435 | Train Acc: 0.4803
 Site-Black-0                   (1) | Train Loss: 1.5745 | Train Acc: 0.4058
 Site-Black-1                   (1) | Train Loss: 1.5093 | Train Acc: 0.3952
 Site-White_ffhq-0              (2) | Train Loss: 1.3012 | Train Acc: 0.5036
Average Train Accuracy: 0.4773
 Site-White-0                   (0) | Val  Loss: 1.6123 | Val  Acc: 0.2500
 Site-White-1                   (0) | Val  Loss: 1.3510 | Val  Acc: 0.4412
 Site-White-2                   (0) | Val  Loss: 1.6170 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.2682 | Val  Acc: 0.5300
 Site-White-4                   (0) | Val  Loss: 1.4717 | Val  Acc: 0.4529
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6179 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.4659 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3701 | Val  Acc: 0.3519
 Site-Black-0                   (1) | Val  Loss: 1.6232 | Val  Acc: 0.3265
 Site-Black-1                   (1) | Val  Loss: 1.7086 | Val  Acc: 0.3735
 Site-White_ffhq-0              (2) | Val  Loss: 1.1786 | Val  Acc: 0.4103
Average Valid Accuracy: 0.4036
============ Train epoch 22 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
min_w=0.04296, quan_i=1.41, quan_c=1.29
minimize weight of clients:[]
 Site-White-0                   (1) | Train Loss: 1.3436 | Train Acc: 0.5563
 Site-White-1                   (1) | Train Loss: 1.3715 | Train Acc: 0.4463
 Site-White-2                   (1) | Train Loss: 1.3328 | Train Acc: 0.4673
 Site-White-3                   (1) | Train Loss: 1.2649 | Train Acc: 0.4929
 Site-White-4                   (1) | Train Loss: 1.1997 | Train Acc: 0.5289
 Site-Middle_Eastern-0          (1) | Train Loss: 1.3700 | Train Acc: 0.4198
 Site-Middle_Eastern-1          (1) | Train Loss: 1.3891 | Train Acc: 0.4777
 Site-Middle_Eastern-2          (1) | Train Loss: 1.3571 | Train Acc: 0.4436
 Site-Black-0                   (0) | Train Loss: 1.5777 | Train Acc: 0.3855
 Site-Black-1                   (0) | Train Loss: 1.5299 | Train Acc: 0.3748
 Site-White_ffhq-0              (2) | Train Loss: 1.2138 | Train Acc: 0.5219
Average Train Accuracy: 0.4650
 Site-White-0                   (1) | Val  Loss: 1.6109 | Val  Acc: 0.4500
 Site-White-1                   (1) | Val  Loss: 1.2811 | Val  Acc: 0.5294
 Site-White-2                   (1) | Val  Loss: 1.6086 | Val  Acc: 0.3559
 Site-White-3                   (1) | Val  Loss: 1.3389 | Val  Acc: 0.4500
 Site-White-4                   (1) | Val  Loss: 1.4643 | Val  Acc: 0.4941
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.5261 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3847 | Val  Acc: 0.3125
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.3877 | Val  Acc: 0.4074
 Site-Black-0                   (0) | Val  Loss: 1.7892 | Val  Acc: 0.2857
 Site-Black-1                   (0) | Val  Loss: 1.6661 | Val  Acc: 0.3373
 Site-White_ffhq-0              (2) | Val  Loss: 1.0848 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4202
 Best site-White-0                  (1)  | Epoch:22 | Val Acc: 0.4500
 Best site-White-1                  (1)  | Epoch:22 | Val Acc: 0.5294
 Best site-White-2                  (1)  | Epoch:22 | Val Acc: 0.3559
 Best site-White-3                  (1)  | Epoch:22 | Val Acc: 0.4500
 Best site-White-4                  (1)  | Epoch:22 | Val Acc: 0.4941
 Best site-Middle_Eastern-0         (1)  | Epoch:22 | Val Acc: 0.5000
 Best site-Middle_Eastern-1         (1)  | Epoch:22 | Val Acc: 0.3125
 Best site-Middle_Eastern-2         (1)  | Epoch:22 | Val Acc: 0.4074
 Best site-Black-0                  (0)  | Epoch:22 | Val Acc: 0.2857
 Best site-Black-1                  (0)  | Epoch:22 | Val Acc: 0.3373
 Best site-White_ffhq-0             (2)  | Epoch:22 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 23 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
min_w=0.04810, quan_i=1.39, quan_c=1.29
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.2622 | Train Acc: 0.4930
 Site-White-1                   (0) | Train Loss: 1.3754 | Train Acc: 0.4421
 Site-White-2                   (0) | Train Loss: 1.3080 | Train Acc: 0.4794
 Site-White-3                   (0) | Train Loss: 1.2707 | Train Acc: 0.5100
 Site-White-4                   (0) | Train Loss: 1.2001 | Train Acc: 0.5331
 Site-Middle_Eastern-0          (0) | Train Loss: 1.3584 | Train Acc: 0.4198
 Site-Middle_Eastern-1          (0) | Train Loss: 1.4361 | Train Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3515 | Train Acc: 0.4619
 Site-Black-0                   (2) | Train Loss: 1.5731 | Train Acc: 0.3942
 Site-Black-1                   (2) | Train Loss: 1.4982 | Train Acc: 0.3969
 Site-White_ffhq-0              (1) | Train Loss: 1.2831 | Train Acc: 0.4799
Average Train Accuracy: 0.4617
 Site-White-0                   (0) | Val  Loss: 1.6433 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.3097 | Val  Acc: 0.3824
 Site-White-2                   (0) | Val  Loss: 1.5280 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.3300 | Val  Acc: 0.4700
 Site-White-4                   (0) | Val  Loss: 1.4706 | Val  Acc: 0.4765
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.6299 | Val  Acc: 0.3333
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3390 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.4011 | Val  Acc: 0.3704
 Site-Black-0                   (2) | Val  Loss: 1.6775 | Val  Acc: 0.3673
 Site-Black-1                   (2) | Val  Loss: 1.6852 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1946 | Val  Acc: 0.3974
Average Valid Accuracy: 0.3870
============ Train epoch 24 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
min_w=0.04716, quan_i=1.39, quan_c=1.29
minimize weight of clients:[]
 Site-White-0                   (0) | Train Loss: 1.2474 | Train Acc: 0.4930
 Site-White-1                   (0) | Train Loss: 1.3901 | Train Acc: 0.4587
 Site-White-2                   (0) | Train Loss: 1.2906 | Train Acc: 0.4770
 Site-White-3                   (0) | Train Loss: 1.2612 | Train Acc: 0.5085
 Site-White-4                   (0) | Train Loss: 1.1812 | Train Acc: 0.5356
 Site-Middle_Eastern-0          (0) | Train Loss: 1.3165 | Train Acc: 0.4351
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3480 | Train Acc: 0.4732
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3354 | Train Acc: 0.4829
 Site-Black-0                   (2) | Train Loss: 1.5643 | Train Acc: 0.3855
 Site-Black-1                   (2) | Train Loss: 1.4989 | Train Acc: 0.3816
 Site-White_ffhq-0              (1) | Train Loss: 1.1975 | Train Acc: 0.5164
Average Train Accuracy: 0.4680
 Site-White-0                   (0) | Val  Loss: 1.6103 | Val  Acc: 0.4000
 Site-White-1                   (0) | Val  Loss: 1.3041 | Val  Acc: 0.4706
 Site-White-2                   (0) | Val  Loss: 1.5719 | Val  Acc: 0.4407
 Site-White-3                   (0) | Val  Loss: 1.3271 | Val  Acc: 0.4200
 Site-White-4                   (0) | Val  Loss: 1.4447 | Val  Acc: 0.5000
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5451 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3146 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3717 | Val  Acc: 0.3889
 Site-Black-0                   (2) | Val  Loss: 1.6677 | Val  Acc: 0.3061
 Site-Black-1                   (2) | Val  Loss: 1.6610 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1017 | Val  Acc: 0.5128
Average Valid Accuracy: 0.4191
============ Train epoch 25 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
min_w=0.04534, quan_i=1.35, quan_c=1.27
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.2865 | Train Acc: 0.4930
 Site-White-1                   (0) | Train Loss: 1.4026 | Train Acc: 0.4463
 Site-White-2                   (0) | Train Loss: 1.2862 | Train Acc: 0.4649
 Site-White-3                   (0) | Train Loss: 1.2568 | Train Acc: 0.5114
 Site-White-4                   (0) | Train Loss: 1.1735 | Train Acc: 0.5397
 Site-Middle_Eastern-0          (0) | Train Loss: 1.6107 | Train Acc: 0.4656
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3573 | Train Acc: 0.4732
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3296 | Train Acc: 0.4567
 Site-Black-0                   (2) | Train Loss: 1.5423 | Train Acc: 0.3739
 Site-Black-1                   (2) | Train Loss: 1.4838 | Train Acc: 0.4344
 Site-White_ffhq-0              (1) | Train Loss: 1.3137 | Train Acc: 0.5055
Average Train Accuracy: 0.4695
 Site-White-0                   (0) | Val  Loss: 1.6274 | Val  Acc: 0.4500
 Site-White-1                   (0) | Val  Loss: 1.3588 | Val  Acc: 0.4118
 Site-White-2                   (0) | Val  Loss: 1.5341 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.2947 | Val  Acc: 0.4500
 Site-White-4                   (0) | Val  Loss: 1.4072 | Val  Acc: 0.5118
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4900 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3766 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3984 | Val  Acc: 0.2963
 Site-Black-0                   (2) | Val  Loss: 1.6872 | Val  Acc: 0.3469
 Site-Black-1                   (2) | Val  Loss: 1.6703 | Val  Acc: 0.3012
 Site-White_ffhq-0              (1) | Val  Loss: 1.1491 | Val  Acc: 0.4615
Average Valid Accuracy: 0.4171
============ Train epoch 26 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
min_w=0.04803, quan_i=1.41, quan_c=1.28
minimize weight of clients:[]
 Site-White-0                   (0) | Train Loss: 1.1963 | Train Acc: 0.5352
 Site-White-1                   (0) | Train Loss: 1.3355 | Train Acc: 0.4835
 Site-White-2                   (0) | Train Loss: 1.2888 | Train Acc: 0.4625
 Site-White-3                   (0) | Train Loss: 1.2486 | Train Acc: 0.5228
 Site-White-4                   (0) | Train Loss: 1.1713 | Train Acc: 0.5506
 Site-Middle_Eastern-0          (0) | Train Loss: 1.3012 | Train Acc: 0.4122
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3927 | Train Acc: 0.4509
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3556 | Train Acc: 0.4646
 Site-Black-0                   (2) | Train Loss: 1.5653 | Train Acc: 0.3855
 Site-Black-1                   (2) | Train Loss: 1.5195 | Train Acc: 0.3765
 Site-White_ffhq-0              (1) | Train Loss: 1.2253 | Train Acc: 0.5292
Average Train Accuracy: 0.4703
 Site-White-0                   (0) | Val  Loss: 1.6395 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.2935 | Val  Acc: 0.3824
 Site-White-2                   (0) | Val  Loss: 1.5655 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.3270 | Val  Acc: 0.4800
 Site-White-4                   (0) | Val  Loss: 1.4611 | Val  Acc: 0.4588
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5038 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3951 | Val  Acc: 0.4375
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3841 | Val  Acc: 0.4444
 Site-Black-0                   (2) | Val  Loss: 1.6860 | Val  Acc: 0.2245
 Site-Black-1                   (2) | Val  Loss: 1.6804 | Val  Acc: 0.3494
 Site-White_ffhq-0              (1) | Val  Loss: 1.1346 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4083
============ Train epoch 27 ============
cnt=[1, 8, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
min_w=0.04386, quan_i=1.37, quan_c=1.26
minimize weight of clients:[10, ]
 Site-White-0                   (1) | Train Loss: 1.2858 | Train Acc: 0.4859
 Site-White-1                   (1) | Train Loss: 1.3544 | Train Acc: 0.4752
 Site-White-2                   (1) | Train Loss: 1.2713 | Train Acc: 0.4891
 Site-White-3                   (1) | Train Loss: 1.2387 | Train Acc: 0.5171
 Site-White-4                   (1) | Train Loss: 1.1809 | Train Acc: 0.5481
 Site-Middle_Eastern-0          (1) | Train Loss: 1.6465 | Train Acc: 0.4733
 Site-Middle_Eastern-1          (1) | Train Loss: 1.3721 | Train Acc: 0.4554
 Site-Middle_Eastern-2          (1) | Train Loss: 1.3403 | Train Acc: 0.4646
 Site-Black-0                   (2) | Train Loss: 1.5352 | Train Acc: 0.3884
 Site-Black-1                   (2) | Train Loss: 1.4838 | Train Acc: 0.4191
 Site-White_ffhq-0              (0) | Train Loss: 1.2446 | Train Acc: 0.5328
Average Train Accuracy: 0.4772
 Site-White-0                   (1) | Val  Loss: 1.4335 | Val  Acc: 0.5000
 Site-White-1                   (1) | Val  Loss: 1.2664 | Val  Acc: 0.4706
 Site-White-2                   (1) | Val  Loss: 1.5618 | Val  Acc: 0.3898
 Site-White-3                   (1) | Val  Loss: 1.2910 | Val  Acc: 0.5000
 Site-White-4                   (1) | Val  Loss: 1.4276 | Val  Acc: 0.5059
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.4804 | Val  Acc: 0.5556
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3871 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.3640 | Val  Acc: 0.4444
 Site-Black-0                   (2) | Val  Loss: 1.7678 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.6851 | Val  Acc: 0.3976
 Site-White_ffhq-0              (0) | Val  Loss: 1.1541 | Val  Acc: 0.4615
Average Valid Accuracy: 0.4470
 Best site-White-0                  (1)  | Epoch:27 | Val Acc: 0.5000
 Best site-White-1                  (1)  | Epoch:27 | Val Acc: 0.4706
 Best site-White-2                  (1)  | Epoch:27 | Val Acc: 0.3898
 Best site-White-3                  (1)  | Epoch:27 | Val Acc: 0.5000
 Best site-White-4                  (1)  | Epoch:27 | Val Acc: 0.5059
 Best site-Middle_Eastern-0         (1)  | Epoch:27 | Val Acc: 0.5556
 Best site-Middle_Eastern-1         (1)  | Epoch:27 | Val Acc: 0.4062
 Best site-Middle_Eastern-2         (1)  | Epoch:27 | Val Acc: 0.4444
 Best site-Black-0                  (2)  | Epoch:27 | Val Acc: 0.2857
 Best site-Black-1                  (2)  | Epoch:27 | Val Acc: 0.3976
 Best site-White_ffhq-0             (0)  | Epoch:27 | Val Acc: 0.4615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_3_weak_white_split/ccop_q=1...
============ Train epoch 28 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
min_w=0.04810, quan_i=1.39, quan_c=1.28
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.3036 | Train Acc: 0.5211
 Site-White-1                   (0) | Train Loss: 1.3720 | Train Acc: 0.4380
 Site-White-2                   (0) | Train Loss: 1.2602 | Train Acc: 0.4794
 Site-White-3                   (0) | Train Loss: 1.2460 | Train Acc: 0.5128
 Site-White-4                   (0) | Train Loss: 1.1714 | Train Acc: 0.5372
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5288 | Train Acc: 0.4504
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3745 | Train Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3037 | Train Acc: 0.4724
 Site-Black-0                   (2) | Train Loss: 1.5026 | Train Acc: 0.3971
 Site-Black-1                   (2) | Train Loss: 1.5033 | Train Acc: 0.3969
 Site-White_ffhq-0              (1) | Train Loss: 1.3204 | Train Acc: 0.4964
Average Train Accuracy: 0.4701
 Site-White-0                   (0) | Val  Loss: 1.5297 | Val  Acc: 0.4000
 Site-White-1                   (0) | Val  Loss: 1.2592 | Val  Acc: 0.4706
 Site-White-2                   (0) | Val  Loss: 1.5720 | Val  Acc: 0.4068
 Site-White-3                   (0) | Val  Loss: 1.2983 | Val  Acc: 0.4600
 Site-White-4                   (0) | Val  Loss: 1.4365 | Val  Acc: 0.4647
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4846 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3804 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3985 | Val  Acc: 0.3889
 Site-Black-0                   (2) | Val  Loss: 1.7497 | Val  Acc: 0.3265
 Site-Black-1                   (2) | Val  Loss: 1.6841 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1571 | Val  Acc: 0.4359
Average Valid Accuracy: 0.4214
============ Train epoch 29 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
min_w=0.04826, quan_i=1.39, quan_c=1.27
minimize weight of clients:[]
 Site-White-0                   (0) | Train Loss: 1.3096 | Train Acc: 0.5211
 Site-White-1                   (0) | Train Loss: 1.3501 | Train Acc: 0.4752
 Site-White-2                   (0) | Train Loss: 1.2683 | Train Acc: 0.4697
 Site-White-3                   (0) | Train Loss: 1.2272 | Train Acc: 0.5214
 Site-White-4                   (0) | Train Loss: 1.1545 | Train Acc: 0.5464
 Site-Middle_Eastern-0          (0) | Train Loss: 1.2414 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (0) | Train Loss: 1.4134 | Train Acc: 0.4598
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3109 | Train Acc: 0.4698
 Site-Black-0                   (2) | Train Loss: 1.5867 | Train Acc: 0.3739
 Site-Black-1                   (2) | Train Loss: 1.5060 | Train Acc: 0.3595
 Site-White_ffhq-0              (1) | Train Loss: 1.2008 | Train Acc: 0.5237
Average Train Accuracy: 0.4680
 Site-White-0                   (0) | Val  Loss: 1.6513 | Val  Acc: 0.4000
 Site-White-1                   (0) | Val  Loss: 1.2278 | Val  Acc: 0.3824
 Site-White-2                   (0) | Val  Loss: 1.6121 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.2872 | Val  Acc: 0.4600
 Site-White-4                   (0) | Val  Loss: 1.4474 | Val  Acc: 0.4824
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4602 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3263 | Val  Acc: 0.5000
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3818 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.7075 | Val  Acc: 0.2653
 Site-Black-1                   (2) | Val  Loss: 1.6906 | Val  Acc: 0.3373
 Site-White_ffhq-0              (1) | Val  Loss: 1.1459 | Val  Acc: 0.4103
Average Valid Accuracy: 0.4072
 Test site-White-0                   (0)| Epoch:27 | Test Acc: 0.3810
 Test site-White-1                   (0)| Epoch:27 | Test Acc: 0.4648
 Test site-White-2                   (0)| Epoch:27 | Test Acc: 0.4706
 Test site-White-3                   (0)| Epoch:27 | Test Acc: 0.4851
 Test site-White-4                   (0)| Epoch:27 | Test Acc: 0.4431
 Test site-Middle_Eastern-0          (0)| Epoch:27 | Test Acc: 0.3333
 Test site-Middle_Eastern-1          (0)| Epoch:27 | Test Acc: 0.3692
 Test site-Middle_Eastern-2          (0)| Epoch:27 | Test Acc: 0.4273
 Test site-Black-0                   (2)| Epoch:27 | Test Acc: 0.3900
 Test site-Black-1                   (2)| Epoch:27 | Test Acc: 0.3491
 Test site-White_ffhq-0              (1)| Epoch:27 | Test Acc: 0.5190
White: 0.4489, Middle_Eastern: 0.3766, Black: 0.3696, White_ffhq: 0.5190, 
Average Test Accuracy(group): 0.4285, Average Test Accuracy(individual): 0.4211,
domain std=0.0608, cluster std=0.0619, individual std=0.0578, 
============ Train epoch 30 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
min_w=0.04166, quan_i=1.35, quan_c=1.25
minimize weight of clients:[10, ]
 Site-White-0                   (1) | Train Loss: 1.2162 | Train Acc: 0.5141
 Site-White-1                   (1) | Train Loss: 1.3543 | Train Acc: 0.4587
 Site-White-2                   (1) | Train Loss: 1.2727 | Train Acc: 0.4673
 Site-White-3                   (1) | Train Loss: 1.2299 | Train Acc: 0.5271
 Site-White-4                   (1) | Train Loss: 1.1664 | Train Acc: 0.5565
 Site-Middle_Eastern-0          (1) | Train Loss: 1.3821 | Train Acc: 0.4885
 Site-Middle_Eastern-1          (1) | Train Loss: 1.4015 | Train Acc: 0.4688
 Site-Middle_Eastern-2          (1) | Train Loss: 1.2862 | Train Acc: 0.4987
 Site-Black-0                   (0) | Train Loss: 1.5332 | Train Acc: 0.4029
 Site-Black-1                   (0) | Train Loss: 1.4440 | Train Acc: 0.4174
 Site-White_ffhq-0              (2) | Train Loss: 1.2910 | Train Acc: 0.4945
Average Train Accuracy: 0.4813
 Site-White-0                   (1) | Val  Loss: 1.5772 | Val  Acc: 0.3000
 Site-White-1                   (1) | Val  Loss: 1.3280 | Val  Acc: 0.3824
 Site-White-2                   (1) | Val  Loss: 1.5752 | Val  Acc: 0.3559
 Site-White-3                   (1) | Val  Loss: 1.2978 | Val  Acc: 0.5100
 Site-White-4                   (1) | Val  Loss: 1.4415 | Val  Acc: 0.4471
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.5299 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3392 | Val  Acc: 0.5000
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.3910 | Val  Acc: 0.3704
 Site-Black-0                   (0) | Val  Loss: 1.6187 | Val  Acc: 0.3061
 Site-Black-1                   (0) | Val  Loss: 1.6012 | Val  Acc: 0.3614
 Site-White_ffhq-0              (2) | Val  Loss: 1.1390 | Val  Acc: 0.4487
Average Valid Accuracy: 0.4024
============ Train epoch 31 ============
cnt=[5, 1, 5, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
min_w=0.04328, quan_i=1.39, quan_c=1.42
minimize weight of clients:[0, 1, 2, 3, 4, 10, ]
 Site-White-0                   (2) | Train Loss: 1.1926 | Train Acc: 0.5423
 Site-White-1                   (2) | Train Loss: 1.3536 | Train Acc: 0.4752
 Site-White-2                   (2) | Train Loss: 1.3149 | Train Acc: 0.4673
 Site-White-3                   (2) | Train Loss: 1.2653 | Train Acc: 0.4986
 Site-White-4                   (2) | Train Loss: 1.1831 | Train Acc: 0.5406
 Site-Middle_Eastern-0          (0) | Train Loss: 1.1983 | Train Acc: 0.4351
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3098 | Train Acc: 0.4955
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3074 | Train Acc: 0.4856
 Site-Black-0                   (0) | Train Loss: 1.4484 | Train Acc: 0.4406
 Site-Black-1                   (0) | Train Loss: 1.3951 | Train Acc: 0.4497
 Site-White_ffhq-0              (1) | Train Loss: 1.3601 | Train Acc: 0.4836
Average Train Accuracy: 0.4831
 Site-White-0                   (2) | Val  Loss: 1.5317 | Val  Acc: 0.3000
 Site-White-1                   (2) | Val  Loss: 1.3507 | Val  Acc: 0.4118
 Site-White-2                   (2) | Val  Loss: 1.5882 | Val  Acc: 0.3559
 Site-White-3                   (2) | Val  Loss: 1.3100 | Val  Acc: 0.4800
 Site-White-4                   (2) | Val  Loss: 1.4663 | Val  Acc: 0.4471
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4703 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3641 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3898 | Val  Acc: 0.4259
 Site-Black-0                   (0) | Val  Loss: 1.6871 | Val  Acc: 0.3673
 Site-Black-1                   (0) | Val  Loss: 1.6170 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.1435 | Val  Acc: 0.4615
Average Valid Accuracy: 0.4069
============ Train epoch 32 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
min_w=0.04035, quan_i=1.37, quan_c=1.26
minimize weight of clients:[]
 Site-White-0                   (0) | Train Loss: 1.2430 | Train Acc: 0.5211
 Site-White-1                   (0) | Train Loss: 1.3388 | Train Acc: 0.4835
 Site-White-2                   (0) | Train Loss: 1.2724 | Train Acc: 0.4939
 Site-White-3                   (0) | Train Loss: 1.2328 | Train Acc: 0.5199
 Site-White-4                   (0) | Train Loss: 1.1512 | Train Acc: 0.5431
 Site-Middle_Eastern-0          (0) | Train Loss: 1.2176 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3648 | Train Acc: 0.4866
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3105 | Train Acc: 0.4646
 Site-Black-0                   (2) | Train Loss: 1.5809 | Train Acc: 0.4087
 Site-Black-1                   (2) | Train Loss: 1.4759 | Train Acc: 0.3884
 Site-White_ffhq-0              (1) | Train Loss: 1.1480 | Train Acc: 0.5201
Average Train Accuracy: 0.4779
 Site-White-0                   (0) | Val  Loss: 1.6894 | Val  Acc: 0.2500
 Site-White-1                   (0) | Val  Loss: 1.3391 | Val  Acc: 0.4118
 Site-White-2                   (0) | Val  Loss: 1.6313 | Val  Acc: 0.3559
 Site-White-3                   (0) | Val  Loss: 1.2919 | Val  Acc: 0.5000
 Site-White-4                   (0) | Val  Loss: 1.4508 | Val  Acc: 0.4824
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4869 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3287 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.4469 | Val  Acc: 0.3519
 Site-Black-0                   (2) | Val  Loss: 1.7819 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.6669 | Val  Acc: 0.3012
 Site-White_ffhq-0              (1) | Val  Loss: 1.0570 | Val  Acc: 0.5000
Average Valid Accuracy: 0.3893
============ Train epoch 33 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
min_w=0.04037, quan_i=1.35, quan_c=1.24
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.1553 | Train Acc: 0.5704
 Site-White-1                   (0) | Train Loss: 1.3677 | Train Acc: 0.4752
 Site-White-2                   (0) | Train Loss: 1.2476 | Train Acc: 0.4746
 Site-White-3                   (0) | Train Loss: 1.2339 | Train Acc: 0.5142
 Site-White-4                   (0) | Train Loss: 1.1353 | Train Acc: 0.5531
 Site-Middle_Eastern-0          (0) | Train Loss: 1.6351 | Train Acc: 0.4122
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3574 | Train Acc: 0.4955
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3059 | Train Acc: 0.5066
 Site-Black-0                   (2) | Train Loss: 1.5000 | Train Acc: 0.4087
 Site-Black-1                   (2) | Train Loss: 1.4844 | Train Acc: 0.4174
 Site-White_ffhq-0              (1) | Train Loss: 1.2336 | Train Acc: 0.5073
Average Train Accuracy: 0.4850
 Site-White-0                   (0) | Val  Loss: 1.4763 | Val  Acc: 0.4500
 Site-White-1                   (0) | Val  Loss: 1.3554 | Val  Acc: 0.4412
 Site-White-2                   (0) | Val  Loss: 1.5842 | Val  Acc: 0.3559
 Site-White-3                   (0) | Val  Loss: 1.2942 | Val  Acc: 0.4900
 Site-White-4                   (0) | Val  Loss: 1.4290 | Val  Acc: 0.4882
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4290 | Val  Acc: 0.5556
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3764 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3322 | Val  Acc: 0.3889
 Site-Black-0                   (2) | Val  Loss: 1.6809 | Val  Acc: 0.2857
 Site-Black-1                   (2) | Val  Loss: 1.6445 | Val  Acc: 0.3373
 Site-White_ffhq-0              (1) | Val  Loss: 1.0999 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4249
============ Train epoch 34 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
min_w=0.04170, quan_i=1.37, quan_c=1.24
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.2432 | Train Acc: 0.5282
 Site-White-1                   (0) | Train Loss: 1.3308 | Train Acc: 0.4628
 Site-White-2                   (0) | Train Loss: 1.2528 | Train Acc: 0.4746
 Site-White-3                   (0) | Train Loss: 1.2160 | Train Acc: 0.5256
 Site-White-4                   (0) | Train Loss: 1.1398 | Train Acc: 0.5632
 Site-Middle_Eastern-0          (0) | Train Loss: 1.4707 | Train Acc: 0.4046
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3429 | Train Acc: 0.4955
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3090 | Train Acc: 0.4751
 Site-Black-0                   (2) | Train Loss: 1.5051 | Train Acc: 0.4000
 Site-Black-1                   (2) | Train Loss: 1.4103 | Train Acc: 0.4480
 Site-White_ffhq-0              (1) | Train Loss: 1.3003 | Train Acc: 0.4945
Average Train Accuracy: 0.4793
 Site-White-0                   (0) | Val  Loss: 1.6942 | Val  Acc: 0.3500
 Site-White-1                   (0) | Val  Loss: 1.3088 | Val  Acc: 0.5294
 Site-White-2                   (0) | Val  Loss: 1.6246 | Val  Acc: 0.3898
 Site-White-3                   (0) | Val  Loss: 1.3343 | Val  Acc: 0.5000
 Site-White-4                   (0) | Val  Loss: 1.4240 | Val  Acc: 0.4882
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4803 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3236 | Val  Acc: 0.5000
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3362 | Val  Acc: 0.4074
 Site-Black-0                   (2) | Val  Loss: 1.6937 | Val  Acc: 0.3673
 Site-Black-1                   (2) | Val  Loss: 1.6895 | Val  Acc: 0.2651
 Site-White_ffhq-0              (1) | Val  Loss: 1.1929 | Val  Acc: 0.4744
Average Valid Accuracy: 0.4287
============ Train epoch 35 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
min_w=0.04482, quan_i=1.35, quan_c=1.24
minimize weight of clients:[]
 Site-White-0                   (0) | Train Loss: 1.1679 | Train Acc: 0.5493
 Site-White-1                   (0) | Train Loss: 1.3479 | Train Acc: 0.4876
 Site-White-2                   (0) | Train Loss: 1.2282 | Train Acc: 0.4552
 Site-White-3                   (0) | Train Loss: 1.2199 | Train Acc: 0.5427
 Site-White-4                   (0) | Train Loss: 1.1309 | Train Acc: 0.5523
 Site-Middle_Eastern-0          (0) | Train Loss: 1.2552 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3835 | Train Acc: 0.4821
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3140 | Train Acc: 0.4803
 Site-Black-0                   (2) | Train Loss: 1.5404 | Train Acc: 0.3942
 Site-Black-1                   (2) | Train Loss: 1.4831 | Train Acc: 0.3952
 Site-White_ffhq-0              (1) | Train Loss: 1.1450 | Train Acc: 0.5383
Average Train Accuracy: 0.4823
 Site-White-0                   (0) | Val  Loss: 1.5845 | Val  Acc: 0.4000
 Site-White-1                   (0) | Val  Loss: 1.3154 | Val  Acc: 0.5000
 Site-White-2                   (0) | Val  Loss: 1.6231 | Val  Acc: 0.3729
 Site-White-3                   (0) | Val  Loss: 1.3317 | Val  Acc: 0.5300
 Site-White-4                   (0) | Val  Loss: 1.4582 | Val  Acc: 0.4647
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5636 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3501 | Val  Acc: 0.4062
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3408 | Val  Acc: 0.3889
 Site-Black-0                   (2) | Val  Loss: 1.7864 | Val  Acc: 0.3265
 Site-Black-1                   (2) | Val  Loss: 1.6511 | Val  Acc: 0.3012
 Site-White_ffhq-0              (1) | Val  Loss: 1.0909 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4214
============ Train epoch 36 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
min_w=0.04145, quan_i=1.35, quan_c=1.23
minimize weight of clients:[10, ]
 Site-White-0                   (1) | Train Loss: 1.2272 | Train Acc: 0.5141
 Site-White-1                   (1) | Train Loss: 1.3598 | Train Acc: 0.4793
 Site-White-2                   (1) | Train Loss: 1.2618 | Train Acc: 0.4939
 Site-White-3                   (1) | Train Loss: 1.2173 | Train Acc: 0.5356
 Site-White-4                   (1) | Train Loss: 1.1348 | Train Acc: 0.5732
 Site-Middle_Eastern-0          (1) | Train Loss: 1.4230 | Train Acc: 0.4275
 Site-Middle_Eastern-1          (1) | Train Loss: 1.3582 | Train Acc: 0.4866
 Site-Middle_Eastern-2          (1) | Train Loss: 1.3019 | Train Acc: 0.4751
 Site-Black-0                   (0) | Train Loss: 1.5132 | Train Acc: 0.4261
 Site-Black-1                   (0) | Train Loss: 1.4546 | Train Acc: 0.4514
 Site-White_ffhq-0              (2) | Train Loss: 1.2746 | Train Acc: 0.5219
Average Train Accuracy: 0.4895
 Site-White-0                   (1) | Val  Loss: 1.3750 | Val  Acc: 0.4500
 Site-White-1                   (1) | Val  Loss: 1.3740 | Val  Acc: 0.3824
 Site-White-2                   (1) | Val  Loss: 1.5898 | Val  Acc: 0.3559
 Site-White-3                   (1) | Val  Loss: 1.3447 | Val  Acc: 0.4700
 Site-White-4                   (1) | Val  Loss: 1.4579 | Val  Acc: 0.4471
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.6139 | Val  Acc: 0.4444
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.4241 | Val  Acc: 0.3750
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.3882 | Val  Acc: 0.3704
 Site-Black-0                   (0) | Val  Loss: 1.6612 | Val  Acc: 0.3878
 Site-Black-1                   (0) | Val  Loss: 1.6462 | Val  Acc: 0.3253
 Site-White_ffhq-0              (2) | Val  Loss: 1.1209 | Val  Acc: 0.4872
Average Valid Accuracy: 0.4087
============ Train epoch 37 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
min_w=0.04412, quan_i=1.37, quan_c=1.24
minimize weight of clients:[]
 Site-White-0                   (0) | Train Loss: 1.2506 | Train Acc: 0.5211
 Site-White-1                   (0) | Train Loss: 1.3346 | Train Acc: 0.4876
 Site-White-2                   (0) | Train Loss: 1.2570 | Train Acc: 0.4867
 Site-White-3                   (0) | Train Loss: 1.2198 | Train Acc: 0.5157
 Site-White-4                   (0) | Train Loss: 1.1240 | Train Acc: 0.5665
 Site-Middle_Eastern-0          (0) | Train Loss: 1.3947 | Train Acc: 0.4198
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3686 | Train Acc: 0.4598
 Site-Middle_Eastern-2          (0) | Train Loss: 1.3039 | Train Acc: 0.4724
 Site-Black-0                   (2) | Train Loss: 1.5712 | Train Acc: 0.4087
 Site-Black-1                   (2) | Train Loss: 1.4781 | Train Acc: 0.3969
 Site-White_ffhq-0              (1) | Train Loss: 1.1543 | Train Acc: 0.5456
Average Train Accuracy: 0.4801
 Site-White-0                   (0) | Val  Loss: 1.5287 | Val  Acc: 0.3000
 Site-White-1                   (0) | Val  Loss: 1.3304 | Val  Acc: 0.3824
 Site-White-2                   (0) | Val  Loss: 1.5513 | Val  Acc: 0.4237
 Site-White-3                   (0) | Val  Loss: 1.3173 | Val  Acc: 0.4900
 Site-White-4                   (0) | Val  Loss: 1.4002 | Val  Acc: 0.5059
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5606 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3236 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3177 | Val  Acc: 0.4259
 Site-Black-0                   (2) | Val  Loss: 1.7745 | Val  Acc: 0.2653
 Site-Black-1                   (2) | Val  Loss: 1.7107 | Val  Acc: 0.3133
 Site-White_ffhq-0              (1) | Val  Loss: 1.0871 | Val  Acc: 0.4103
Average Valid Accuracy: 0.3977
============ Train epoch 38 ============
cnt=[8, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
min_w=0.04534, quan_i=1.37, quan_c=1.24
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.1642 | Train Acc: 0.5845
 Site-White-1                   (0) | Train Loss: 1.3603 | Train Acc: 0.4628
 Site-White-2                   (0) | Train Loss: 1.2631 | Train Acc: 0.4939
 Site-White-3                   (0) | Train Loss: 1.2340 | Train Acc: 0.5114
 Site-White-4                   (0) | Train Loss: 1.1201 | Train Acc: 0.5623
 Site-Middle_Eastern-0          (0) | Train Loss: 1.5930 | Train Acc: 0.4504
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3726 | Train Acc: 0.5045
 Site-Middle_Eastern-2          (0) | Train Loss: 1.2970 | Train Acc: 0.5013
 Site-Black-0                   (1) | Train Loss: 1.4811 | Train Acc: 0.4232
 Site-Black-1                   (1) | Train Loss: 1.4451 | Train Acc: 0.4123
 Site-White_ffhq-0              (2) | Train Loss: 1.2288 | Train Acc: 0.5128
Average Train Accuracy: 0.4927
 Site-White-0                   (0) | Val  Loss: 1.5952 | Val  Acc: 0.5000
 Site-White-1                   (0) | Val  Loss: 1.2968 | Val  Acc: 0.5000
 Site-White-2                   (0) | Val  Loss: 1.6501 | Val  Acc: 0.4576
 Site-White-3                   (0) | Val  Loss: 1.2635 | Val  Acc: 0.5000
 Site-White-4                   (0) | Val  Loss: 1.4390 | Val  Acc: 0.4176
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.5571 | Val  Acc: 0.3889
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.2535 | Val  Acc: 0.5000
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3724 | Val  Acc: 0.4074
 Site-Black-0                   (1) | Val  Loss: 1.6999 | Val  Acc: 0.3061
 Site-Black-1                   (1) | Val  Loss: 1.6471 | Val  Acc: 0.3012
 Site-White_ffhq-0              (2) | Val  Loss: 1.1322 | Val  Acc: 0.5385
Average Valid Accuracy: 0.4379
============ Train epoch 39 ============
cnt=[8, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
min_w=0.04211, quan_i=1.39, quan_c=1.24
minimize weight of clients:[10, ]
 Site-White-0                   (0) | Train Loss: 1.3314 | Train Acc: 0.5493
 Site-White-1                   (0) | Train Loss: 1.3828 | Train Acc: 0.4628
 Site-White-2                   (0) | Train Loss: 1.2480 | Train Acc: 0.4867
 Site-White-3                   (0) | Train Loss: 1.2140 | Train Acc: 0.5427
 Site-White-4                   (0) | Train Loss: 1.1042 | Train Acc: 0.5749
 Site-Middle_Eastern-0          (0) | Train Loss: 1.3346 | Train Acc: 0.3969
 Site-Middle_Eastern-1          (0) | Train Loss: 1.3273 | Train Acc: 0.5000
 Site-Middle_Eastern-2          (0) | Train Loss: 1.2944 | Train Acc: 0.4698
 Site-Black-0                   (2) | Train Loss: 1.5262 | Train Acc: 0.4000
 Site-Black-1                   (2) | Train Loss: 1.4527 | Train Acc: 0.4259
 Site-White_ffhq-0              (1) | Train Loss: 1.2381 | Train Acc: 0.5091
Average Train Accuracy: 0.4835
 Site-White-0                   (0) | Val  Loss: 1.5932 | Val  Acc: 0.4000
 Site-White-1                   (0) | Val  Loss: 1.3112 | Val  Acc: 0.3529
 Site-White-2                   (0) | Val  Loss: 1.5520 | Val  Acc: 0.4068
 Site-White-3                   (0) | Val  Loss: 1.3084 | Val  Acc: 0.4900
 Site-White-4                   (0) | Val  Loss: 1.4437 | Val  Acc: 0.4824
 Site-Middle_Eastern-0          (0) | Val  Loss: 1.4311 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (0) | Val  Loss: 1.3585 | Val  Acc: 0.4688
 Site-Middle_Eastern-2          (0) | Val  Loss: 1.3883 | Val  Acc: 0.3704
 Site-Black-0                   (2) | Val  Loss: 1.7347 | Val  Acc: 0.2653
 Site-Black-1                   (2) | Val  Loss: 1.6817 | Val  Acc: 0.3253
 Site-White_ffhq-0              (1) | Val  Loss: 1.0923 | Val  Acc: 0.4615
Average Valid Accuracy: 0.4112
 Test site-White-0                   (0)| Epoch:27 | Test Acc: 0.4286
 Test site-White-1                   (0)| Epoch:27 | Test Acc: 0.5634
 Test site-White-2                   (0)| Epoch:27 | Test Acc: 0.4370
 Test site-White-3                   (0)| Epoch:27 | Test Acc: 0.4901
 Test site-White-4                   (0)| Epoch:27 | Test Acc: 0.4548
 Test site-Middle_Eastern-0          (0)| Epoch:27 | Test Acc: 0.5385
 Test site-Middle_Eastern-1          (0)| Epoch:27 | Test Acc: 0.3692
 Test site-Middle_Eastern-2          (0)| Epoch:27 | Test Acc: 0.4455
 Test site-Black-0                   (2)| Epoch:27 | Test Acc: 0.3300
 Test site-Black-1                   (2)| Epoch:27 | Test Acc: 0.3077
 Test site-White_ffhq-0              (1)| Epoch:27 | Test Acc: 0.4557
White: 0.4748, Middle_Eastern: 0.4510, Black: 0.3188, White_ffhq: 0.4557, 
Average Test Accuracy(group): 0.4251, Average Test Accuracy(individual): 0.4382,
domain std=0.0620, cluster std=0.0670, individual std=0.0755, 
============ Train epoch 40 ============
cnt=[2, 8, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
min_w=0.04417, quan_i=1.35, quan_c=1.22
minimize weight of clients:[]
 Site-White-0                   (1) | Train Loss: 1.2735 | Train Acc: 0.5211
 Site-White-1                   (1) | Train Loss: 1.3405 | Train Acc: 0.4628
 Site-White-2                   (1) | Train Loss: 1.2510 | Train Acc: 0.4673
 Site-White-3                   (1) | Train Loss: 1.2123 | Train Acc: 0.5157
 Site-White-4                   (1) | Train Loss: 1.1114 | Train Acc: 0.5590
 Site-Middle_Eastern-0          (1) | Train Loss: 1.4778 | Train Acc: 0.4046
 Site-Middle_Eastern-1          (1) | Train Loss: 1.3266 | Train Acc: 0.4866
 Site-Middle_Eastern-2          (1) | Train Loss: 1.3079 | Train Acc: 0.4724
 Site-Black-0                   (0) | Train Loss: 1.5435 | Train Acc: 0.4029
 Site-Black-1                   (0) | Train Loss: 1.4662 | Train Acc: 0.3952
 Site-White_ffhq-0              (2) | Train Loss: 1.1314 | Train Acc: 0.5328
Average Train Accuracy: 0.4746
 Site-White-0                   (1) | Val  Loss: 1.4520 | Val  Acc: 0.3500
 Site-White-1                   (1) | Val  Loss: 1.2501 | Val  Acc: 0.4706
 Site-White-2                   (1) | Val  Loss: 1.6166 | Val  Acc: 0.3729
 Site-White-3                   (1) | Val  Loss: 1.2725 | Val  Acc: 0.4500
 Site-White-4                   (1) | Val  Loss: 1.4106 | Val  Acc: 0.5000
 Site-Middle_Eastern-0          (1) | Val  Loss: 1.3219 | Val  Acc: 0.5000
 Site-Middle_Eastern-1          (1) | Val  Loss: 1.3540 | Val  Acc: 0.3438
 Site-Middle_Eastern-2          (1) | Val  Loss: 1.4069 | Val  Acc: 0.3519
 Site-Black-0                   (0) | Val  Loss: 1.7741 | Val  Acc: 0.2857
 Site-Black-1                   (0) | Val  Loss: 1.6702 | Val  Acc: 0.3253
 Site-White_ffhq-0              (2) | Val  Loss: 0.9888 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4046
 Test site-White-0                   (1)| Epoch:27 | Test Acc: 0.4524
 Test site-White-1                   (1)| Epoch:27 | Test Acc: 0.4789
 Test site-White-2                   (1)| Epoch:27 | Test Acc: 0.4706
 Test site-White-3                   (1)| Epoch:27 | Test Acc: 0.4851
 Test site-White-4                   (1)| Epoch:27 | Test Acc: 0.4519
 Test site-Middle_Eastern-0          (1)| Epoch:27 | Test Acc: 0.3590
 Test site-Middle_Eastern-1          (1)| Epoch:27 | Test Acc: 0.3385
 Test site-Middle_Eastern-2          (1)| Epoch:27 | Test Acc: 0.4273
 Test site-Black-0                   (0)| Epoch:27 | Test Acc: 0.4000
 Test site-Black-1                   (0)| Epoch:27 | Test Acc: 0.3491
 Test site-White_ffhq-0              (2)| Epoch:27 | Test Acc: 0.5506
White: 0.4678, Middle_Eastern: 0.3749, Black: 0.3746, White_ffhq: 0.5506, 
Average Test Accuracy(group): 0.4420, Average Test Accuracy(individual): 0.4330,
domain std=0.0733, cluster std=0.0732, individual std=0.0628, 
===2023-06-16 09:54:41===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = 3
Loading snapshots...
 Test site-White-0                   (1)| Epoch:27 | Test Acc: 0.4524
 Test site-White-1                   (1)| Epoch:27 | Test Acc: 0.5352
 Test site-White-2                   (1)| Epoch:27 | Test Acc: 0.4286
 Test site-White-3                   (1)| Epoch:27 | Test Acc: 0.4802
 Test site-White-4                   (1)| Epoch:27 | Test Acc: 0.4840
 Test site-Middle_Eastern-0          (1)| Epoch:27 | Test Acc: 0.4615
 Test site-Middle_Eastern-1          (1)| Epoch:27 | Test Acc: 0.3538
 Test site-Middle_Eastern-2          (1)| Epoch:27 | Test Acc: 0.4545
 Test site-Black-0                   (2)| Epoch:27 | Test Acc: 0.3600
 Test site-Black-1                   (2)| Epoch:27 | Test Acc: 0.3609
 Test site-White_ffhq-0              (0)| Epoch:27 | Test Acc: 0.5000
White: 0.4761, Middle_Eastern: 0.4233, Black: 0.3605, White_ffhq: 0.5000, 
Average Test Accuracy(group): 0.4400, Average Test Accuracy(individual): 0.4428,
domain std=0.0536, cluster std=0.0583, individual std=0.0581, 
