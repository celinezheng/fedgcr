===2023-06-15 10:56:43===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 8, 16, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (0) | Train Loss: 2.1346 | Train Acc: 0.1667
 Site-White_utk                 (4) | Train Loss: 2.1999 | Train Acc: 0.1176
 Site-White_utk                 (4) | Train Loss: 2.3304 | Train Acc: 0.1154
 Site-White_utk                 (4) | Train Loss: 2.2945 | Train Acc: 0.0789
 Site-White_utk                 (4) | Train Loss: 2.2714 | Train Acc: 0.0893
 Site-White_utk                 (4) | Train Loss: 2.2489 | Train Acc: 0.1341
 Site-White_utk                 (4) | Train Loss: 2.2057 | Train Acc: 0.1240
 Site-White_utk                 (4) | Train Loss: 2.2391 | Train Acc: 0.1229
 Site-White_utk                 (4) | Train Loss: 2.2783 | Train Acc: 0.0989
 Site-White_utk                 (4) | Train Loss: 2.2366 | Train Acc: 0.1189
 Site-East_Asian                (3) | Train Loss: 1.9104 | Train Acc: 0.4815
 Site-East_Asian                (3) | Train Loss: 1.9713 | Train Acc: 0.4750
 Site-East_Asian                (2) | Train Loss: 1.9704 | Train Acc: 0.3390
 Site-East_Asian                (3) | Train Loss: 1.9859 | Train Acc: 0.3721
 Site-East_Asian                (3) | Train Loss: 1.9761 | Train Acc: 0.3780
 Site-East_Asian                (3) | Train Loss: 1.9928 | Train Acc: 0.3102
 Site-East_Asian                (3) | Train Loss: 1.9373 | Train Acc: 0.3732
 Site-Indian_utk                (5) | Train Loss: 2.0500 | Train Acc: 0.3256
 Site-Indian_utk                (4) | Train Loss: 1.9709 | Train Acc: 0.3750
 Site-Indian_utk                (4) | Train Loss: 2.0599 | Train Acc: 0.2660
 Site-Indian_utk                (4) | Train Loss: 2.0041 | Train Acc: 0.2878
 Site-Indian_utk                (4) | Train Loss: 2.0759 | Train Acc: 0.3024
 Site-Black_utk                 (4) | Train Loss: 2.0064 | Train Acc: 0.2909
 Site-Black_utk                 (4) | Train Loss: 2.0331 | Train Acc: 0.2469
 Site-Black_utk                 (4) | Train Loss: 2.0878 | Train Acc: 0.2437
 Site-Southeast_Asian           (3) | Train Loss: 2.0789 | Train Acc: 0.3137
 Site-Southeast_Asian           (3) | Train Loss: 2.0902 | Train Acc: 0.2600
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.6731 | Train Acc: 0.4709
 Site-White_ffhq                (1) | Train Loss: 1.6446 | Train Acc: 0.7179
Average Train Accuracy: 0.2757
 Site-White_utk                 (0) | Val  Loss: 2.2015 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.3058 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.2570 | Val  Acc: 0.1176
 Site-White_utk                 (4) | Val  Loss: 2.2297 | Val  Acc: 0.1600
 Site-White_utk                 (4) | Val  Loss: 2.2485 | Val  Acc: 0.1081
 Site-White_utk                 (4) | Val  Loss: 2.1859 | Val  Acc: 0.1091
 Site-White_utk                 (4) | Val  Loss: 2.1977 | Val  Acc: 0.0741
 Site-White_utk                 (4) | Val  Loss: 2.2552 | Val  Acc: 0.1008
 Site-White_utk                 (4) | Val  Loss: 2.2290 | Val  Acc: 0.1143
 Site-White_utk                 (4) | Val  Loss: 2.3147 | Val  Acc: 0.1202
 Site-East_Asian                (3) | Val  Loss: 2.1320 | Val  Acc: 0.1667
 Site-East_Asian                (3) | Val  Loss: 2.0120 | Val  Acc: 0.3462
 Site-East_Asian                (2) | Val  Loss: 1.9945 | Val  Acc: 0.3333
 Site-East_Asian                (3) | Val  Loss: 1.9647 | Val  Acc: 0.3333
 Site-East_Asian                (3) | Val  Loss: 1.9792 | Val  Acc: 0.3529
 Site-East_Asian                (3) | Val  Loss: 1.9380 | Val  Acc: 0.3840
 Site-East_Asian                (3) | Val  Loss: 1.9669 | Val  Acc: 0.3641
 Site-Indian_utk                (5) | Val  Loss: 2.0064 | Val  Acc: 0.3448
 Site-Indian_utk                (4) | Val  Loss: 2.0740 | Val  Acc: 0.2558
 Site-Indian_utk                (4) | Val  Loss: 2.0554 | Val  Acc: 0.3175
 Site-Indian_utk                (4) | Val  Loss: 2.0783 | Val  Acc: 0.2935
 Site-Indian_utk                (4) | Val  Loss: 1.9727 | Val  Acc: 0.3603
 Site-Black_utk                 (4) | Val  Loss: 2.0203 | Val  Acc: 0.3056
 Site-Black_utk                 (4) | Val  Loss: 2.0368 | Val  Acc: 0.2778
 Site-Black_utk                 (4) | Val  Loss: 1.9980 | Val  Acc: 0.3038
 Site-Southeast_Asian           (3) | Val  Loss: 2.2813 | Val  Acc: 0.2353
 Site-Southeast_Asian           (3) | Val  Loss: 2.1025 | Val  Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.9589 | Val  Acc: 0.2087
 Site-White_ffhq                (1) | Val  Loss: 1.5250 | Val  Acc: 0.8077
Average Valid Accuracy: 0.2549
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0909
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1176
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1600
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1081
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1091
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0741
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1008
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1143
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1202
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.1667
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3462
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3333
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3529
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3840
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3641
 Best site-Indian_utk               (5)  | Epoch:0 | Val Acc: 0.3448
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.2558
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3175
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.2935
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3603
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3056
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.2778
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3038
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2353
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2800
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:0 | Val Acc: 0.2087
 Best site-White_ffhq               (1)  | Epoch:0 | Val Acc: 0.8077
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 9, 2, 13, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (3) | Train Loss: 2.0572 | Train Acc: 0.0833
 Site-White_utk                 (5) | Train Loss: 2.3124 | Train Acc: 0.1176
 Site-White_utk                 (3) | Train Loss: 2.3474 | Train Acc: 0.1154
 Site-White_utk                 (3) | Train Loss: 2.3601 | Train Acc: 0.1053
 Site-White_utk                 (0) | Train Loss: 2.3142 | Train Acc: 0.1071
 Site-White_utk                 (3) | Train Loss: 2.3300 | Train Acc: 0.1098
 Site-White_utk                 (3) | Train Loss: 2.3137 | Train Acc: 0.0992
 Site-White_utk                 (3) | Train Loss: 2.3002 | Train Acc: 0.1117
 Site-White_utk                 (3) | Train Loss: 2.1967 | Train Acc: 0.0989
 Site-White_utk                 (3) | Train Loss: 2.3545 | Train Acc: 0.1085
 Site-East_Asian                (1) | Train Loss: 1.8297 | Train Acc: 0.4074
 Site-East_Asian                (1) | Train Loss: 1.8248 | Train Acc: 0.4750
 Site-East_Asian                (1) | Train Loss: 1.8457 | Train Acc: 0.3898
 Site-East_Asian                (1) | Train Loss: 2.0082 | Train Acc: 0.3488
 Site-East_Asian                (1) | Train Loss: 1.8665 | Train Acc: 0.3937
 Site-East_Asian                (1) | Train Loss: 1.8910 | Train Acc: 0.3422
 Site-East_Asian                (1) | Train Loss: 1.8167 | Train Acc: 0.3877
 Site-Indian_utk                (3) | Train Loss: 1.9767 | Train Acc: 0.3256
 Site-Indian_utk                (3) | Train Loss: 1.8822 | Train Acc: 0.3906
 Site-Indian_utk                (3) | Train Loss: 1.9697 | Train Acc: 0.3404
 Site-Indian_utk                (3) | Train Loss: 1.9025 | Train Acc: 0.3381
 Site-Indian_utk                (3) | Train Loss: 1.9475 | Train Acc: 0.3415
 Site-Black_utk                 (4) | Train Loss: 1.8805 | Train Acc: 0.3636
 Site-Black_utk                 (4) | Train Loss: 2.0319 | Train Acc: 0.3086
 Site-Black_utk                 (4) | Train Loss: 1.9376 | Train Acc: 0.3277
 Site-Southeast_Asian           (1) | Train Loss: 2.0011 | Train Acc: 0.3137
 Site-Southeast_Asian           (1) | Train Loss: 2.0341 | Train Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.4661 | Train Acc: 0.4767
 Site-White_ffhq                (2) | Train Loss: 1.4225 | Train Acc: 0.7863
Average Train Accuracy: 0.2895
 Site-White_utk                 (3) | Val  Loss: 2.2690 | Val  Acc: 0.1250
 Site-White_utk                 (5) | Val  Loss: 2.2926 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.2641 | Val  Acc: 0.1176
 Site-White_utk                 (3) | Val  Loss: 2.3369 | Val  Acc: 0.1200
 Site-White_utk                 (0) | Val  Loss: 2.2879 | Val  Acc: 0.1351
 Site-White_utk                 (3) | Val  Loss: 2.2883 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.2826 | Val  Acc: 0.0864
 Site-White_utk                 (3) | Val  Loss: 2.3048 | Val  Acc: 0.1008
 Site-White_utk                 (3) | Val  Loss: 2.2960 | Val  Acc: 0.1143
 Site-White_utk                 (3) | Val  Loss: 2.3823 | Val  Acc: 0.1008
 Site-East_Asian                (1) | Val  Loss: 2.1124 | Val  Acc: 0.2222
 Site-East_Asian                (1) | Val  Loss: 1.8831 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.8941 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.8364 | Val  Acc: 0.3509
 Site-East_Asian                (1) | Val  Loss: 1.9094 | Val  Acc: 0.4118
 Site-East_Asian                (1) | Val  Loss: 1.8289 | Val  Acc: 0.4080
 Site-East_Asian                (1) | Val  Loss: 1.8642 | Val  Acc: 0.3750
 Site-Indian_utk                (3) | Val  Loss: 1.9693 | Val  Acc: 0.2759
 Site-Indian_utk                (3) | Val  Loss: 1.9936 | Val  Acc: 0.3488
 Site-Indian_utk                (3) | Val  Loss: 1.9583 | Val  Acc: 0.3651
 Site-Indian_utk                (3) | Val  Loss: 1.9353 | Val  Acc: 0.3370
 Site-Indian_utk                (3) | Val  Loss: 1.8681 | Val  Acc: 0.3750
 Site-Black_utk                 (4) | Val  Loss: 1.9072 | Val  Acc: 0.3333
 Site-Black_utk                 (4) | Val  Loss: 1.9088 | Val  Acc: 0.3704
 Site-Black_utk                 (4) | Val  Loss: 1.9294 | Val  Acc: 0.3291
 Site-Southeast_Asian           (1) | Val  Loss: 2.2727 | Val  Acc: 0.2794
 Site-Southeast_Asian           (1) | Val  Loss: 2.0605 | Val  Acc: 0.2900
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8681 | Val  Acc: 0.1652
 Site-White_ffhq                (2) | Val  Loss: 1.2223 | Val  Acc: 0.9487
Average Valid Accuracy: 0.2785
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1250
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1176
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1200
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1351
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0864
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1008
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1143
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1008
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.2222
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3846
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3509
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4118
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4080
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3750
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.2759
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3488
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3651
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3370
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3750
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3333
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3704
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3291
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2794
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2900
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:1 | Val Acc: 0.1652
 Best site-White_ffhq               (2)  | Epoch:1 | Val Acc: 0.9487
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 9, 2, 8, 8, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk                 (5) | Train Loss: 1.9236 | Train Acc: 0.2500
 Site-White_utk                 (4) | Train Loss: 2.1298 | Train Acc: 0.1176
 Site-White_utk                 (4) | Train Loss: 2.1361 | Train Acc: 0.1154
 Site-White_utk                 (0) | Train Loss: 2.2708 | Train Acc: 0.1053
 Site-White_utk                 (4) | Train Loss: 2.1451 | Train Acc: 0.1607
 Site-White_utk                 (4) | Train Loss: 2.1195 | Train Acc: 0.1463
 Site-White_utk                 (4) | Train Loss: 2.1530 | Train Acc: 0.1157
 Site-White_utk                 (4) | Train Loss: 2.1793 | Train Acc: 0.1285
 Site-White_utk                 (4) | Train Loss: 2.1316 | Train Acc: 0.1255
 Site-White_utk                 (4) | Train Loss: 2.1346 | Train Acc: 0.1318
 Site-East_Asian                (1) | Train Loss: 1.8363 | Train Acc: 0.4074
 Site-East_Asian                (1) | Train Loss: 1.9276 | Train Acc: 0.4500
 Site-East_Asian                (1) | Train Loss: 1.9063 | Train Acc: 0.3390
 Site-East_Asian                (1) | Train Loss: 1.9704 | Train Acc: 0.3605
 Site-East_Asian                (1) | Train Loss: 1.9070 | Train Acc: 0.3622
 Site-East_Asian                (1) | Train Loss: 1.9240 | Train Acc: 0.3743
 Site-East_Asian                (1) | Train Loss: 1.9027 | Train Acc: 0.3696
 Site-Indian_utk                (3) | Train Loss: 1.9634 | Train Acc: 0.3023
 Site-Indian_utk                (3) | Train Loss: 1.9036 | Train Acc: 0.4062
 Site-Indian_utk                (3) | Train Loss: 1.9633 | Train Acc: 0.3511
 Site-Indian_utk                (3) | Train Loss: 1.9633 | Train Acc: 0.3525
 Site-Indian_utk                (3) | Train Loss: 1.9731 | Train Acc: 0.3122
 Site-Black_utk                 (3) | Train Loss: 1.9245 | Train Acc: 0.3455
 Site-Black_utk                 (3) | Train Loss: 2.0371 | Train Acc: 0.3210
 Site-Black_utk                 (3) | Train Loss: 2.0216 | Train Acc: 0.2773
 Site-Southeast_Asian           (1) | Train Loss: 1.9650 | Train Acc: 0.3137
 Site-Southeast_Asian           (1) | Train Loss: 2.0197 | Train Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6736 | Train Acc: 0.4884
 Site-White_ffhq                (2) | Train Loss: 1.6062 | Train Acc: 0.7094
Average Train Accuracy: 0.2938
 Site-White_utk                 (5) | Val  Loss: 2.2066 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.1447 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.0984 | Val  Acc: 0.1765
 Site-White_utk                 (0) | Val  Loss: 2.2268 | Val  Acc: 0.1200
 Site-White_utk                 (4) | Val  Loss: 2.2269 | Val  Acc: 0.0811
 Site-White_utk                 (4) | Val  Loss: 2.1308 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.1489 | Val  Acc: 0.1481
 Site-White_utk                 (4) | Val  Loss: 2.1804 | Val  Acc: 0.1345
 Site-White_utk                 (4) | Val  Loss: 2.1671 | Val  Acc: 0.1314
 Site-White_utk                 (4) | Val  Loss: 2.2368 | Val  Acc: 0.1434
 Site-East_Asian                (1) | Val  Loss: 2.0670 | Val  Acc: 0.2778
 Site-East_Asian                (1) | Val  Loss: 1.9322 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.9967 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.8944 | Val  Acc: 0.4035
 Site-East_Asian                (1) | Val  Loss: 1.9294 | Val  Acc: 0.4000
 Site-East_Asian                (1) | Val  Loss: 1.8685 | Val  Acc: 0.4080
 Site-East_Asian                (1) | Val  Loss: 1.8956 | Val  Acc: 0.3859
 Site-Indian_utk                (3) | Val  Loss: 1.9546 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.9256 | Val  Acc: 0.3256
 Site-Indian_utk                (3) | Val  Loss: 1.9770 | Val  Acc: 0.3651
 Site-Indian_utk                (3) | Val  Loss: 2.0221 | Val  Acc: 0.3152
 Site-Indian_utk                (3) | Val  Loss: 1.9280 | Val  Acc: 0.3235
 Site-Black_utk                 (3) | Val  Loss: 1.9537 | Val  Acc: 0.2778
 Site-Black_utk                 (3) | Val  Loss: 1.9910 | Val  Acc: 0.2778
 Site-Black_utk                 (3) | Val  Loss: 1.9970 | Val  Acc: 0.3418
 Site-Southeast_Asian           (1) | Val  Loss: 2.2328 | Val  Acc: 0.2794
 Site-Southeast_Asian           (1) | Val  Loss: 2.0398 | Val  Acc: 0.2700
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9629 | Val  Acc: 0.1739
 Site-White_ffhq                (2) | Val  Loss: 1.4492 | Val  Acc: 0.8974
Average Valid Accuracy: 0.2774
============ Train epoch 3 ============
cnt=[7, 1, 3, 8, 2, 8, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White_utk                 (2) | Train Loss: 1.9477 | Train Acc: 0.3333
 Site-White_utk                 (0) | Train Loss: 2.0822 | Train Acc: 0.2353
 Site-White_utk                 (0) | Train Loss: 2.1351 | Train Acc: 0.1154
 Site-White_utk                 (0) | Train Loss: 2.2036 | Train Acc: 0.0526
 Site-White_utk                 (2) | Train Loss: 2.1533 | Train Acc: 0.1607
 Site-White_utk                 (2) | Train Loss: 2.1490 | Train Acc: 0.1707
 Site-White_utk                 (0) | Train Loss: 2.1025 | Train Acc: 0.1570
 Site-White_utk                 (0) | Train Loss: 2.1554 | Train Acc: 0.1508
 Site-White_utk                 (0) | Train Loss: 2.1743 | Train Acc: 0.1179
 Site-White_utk                 (0) | Train Loss: 2.0624 | Train Acc: 0.1550
 Site-East_Asian                (5) | Train Loss: 1.8374 | Train Acc: 0.4074
 Site-East_Asian                (5) | Train Loss: 1.8272 | Train Acc: 0.4500
 Site-East_Asian                (1) | Train Loss: 1.8663 | Train Acc: 0.3051
 Site-East_Asian                (5) | Train Loss: 1.9418 | Train Acc: 0.3488
 Site-East_Asian                (5) | Train Loss: 1.8571 | Train Acc: 0.3858
 Site-East_Asian                (5) | Train Loss: 1.8833 | Train Acc: 0.3636
 Site-East_Asian                (5) | Train Loss: 1.8283 | Train Acc: 0.3877
 Site-Indian_utk                (3) | Train Loss: 1.9505 | Train Acc: 0.2791
 Site-Indian_utk                (3) | Train Loss: 1.8425 | Train Acc: 0.4219
 Site-Indian_utk                (3) | Train Loss: 1.9541 | Train Acc: 0.3191
 Site-Indian_utk                (3) | Train Loss: 1.9119 | Train Acc: 0.3597
 Site-Indian_utk                (3) | Train Loss: 1.9425 | Train Acc: 0.3220
 Site-Black_utk                 (3) | Train Loss: 1.8894 | Train Acc: 0.4000
 Site-Black_utk                 (3) | Train Loss: 1.9403 | Train Acc: 0.2963
 Site-Black_utk                 (3) | Train Loss: 1.9409 | Train Acc: 0.2773
 Site-Southeast_Asian           (5) | Train Loss: 2.0029 | Train Acc: 0.3137
 Site-Southeast_Asian           (5) | Train Loss: 1.9966 | Train Acc: 0.3067
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6011 | Train Acc: 0.4767
 Site-White_ffhq                (4) | Train Loss: 1.5352 | Train Acc: 0.7436
Average Train Accuracy: 0.3039
 Site-White_utk                 (2) | Val  Loss: 2.0545 | Val  Acc: 0.3750
 Site-White_utk                 (0) | Val  Loss: 2.1140 | Val  Acc: 0.1818
 Site-White_utk                 (0) | Val  Loss: 2.1442 | Val  Acc: 0.1176
 Site-White_utk                 (0) | Val  Loss: 2.2113 | Val  Acc: 0.1600
 Site-White_utk                 (2) | Val  Loss: 2.1698 | Val  Acc: 0.1351
 Site-White_utk                 (2) | Val  Loss: 2.1272 | Val  Acc: 0.0909
 Site-White_utk                 (0) | Val  Loss: 2.1201 | Val  Acc: 0.1111
 Site-White_utk                 (0) | Val  Loss: 2.1542 | Val  Acc: 0.1429
 Site-White_utk                 (0) | Val  Loss: 2.1395 | Val  Acc: 0.1543
 Site-White_utk                 (0) | Val  Loss: 2.1520 | Val  Acc: 0.1473
 Site-East_Asian                (5) | Val  Loss: 2.0184 | Val  Acc: 0.2222
 Site-East_Asian                (5) | Val  Loss: 1.8678 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.9464 | Val  Acc: 0.3333
 Site-East_Asian                (5) | Val  Loss: 1.8703 | Val  Acc: 0.3860
 Site-East_Asian                (5) | Val  Loss: 1.9020 | Val  Acc: 0.4118
 Site-East_Asian                (5) | Val  Loss: 1.8328 | Val  Acc: 0.4080
 Site-East_Asian                (5) | Val  Loss: 1.8540 | Val  Acc: 0.3913
 Site-Indian_utk                (3) | Val  Loss: 1.9433 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.9132 | Val  Acc: 0.3488
 Site-Indian_utk                (3) | Val  Loss: 1.9386 | Val  Acc: 0.3333
 Site-Indian_utk                (3) | Val  Loss: 1.9366 | Val  Acc: 0.3043
 Site-Indian_utk                (3) | Val  Loss: 1.8752 | Val  Acc: 0.3088
 Site-Black_utk                 (3) | Val  Loss: 1.8892 | Val  Acc: 0.2778
 Site-Black_utk                 (3) | Val  Loss: 1.9633 | Val  Acc: 0.2222
 Site-Black_utk                 (3) | Val  Loss: 1.9804 | Val  Acc: 0.3165
 Site-Southeast_Asian           (5) | Val  Loss: 2.1087 | Val  Acc: 0.2794
 Site-Southeast_Asian           (5) | Val  Loss: 1.9996 | Val  Acc: 0.3100
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.9042 | Val  Acc: 0.1913
 Site-White_ffhq                (4) | Val  Loss: 1.4117 | Val  Acc: 0.8333
Average Valid Accuracy: 0.2837
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.3750
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1818
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1176
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1600
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1351
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.0909
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1111
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1429
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1543
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1473
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.2222
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:3 | Val Acc: 0.3333
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.3860
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4118
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4080
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.3913
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3103
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3488
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3333
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3043
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3088
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.2778
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.2222
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.3165
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.2794
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3100
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:3 | Val Acc: 0.1913
 Best site-White_ffhq               (4)  | Epoch:3 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 9, 3, 2, 10, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White_utk                 (4) | Train Loss: 1.9586 | Train Acc: 0.1667
 Site-White_utk                 (4) | Train Loss: 2.1110 | Train Acc: 0.1765
 Site-White_utk                 (4) | Train Loss: 2.1296 | Train Acc: 0.1154
 Site-White_utk                 (4) | Train Loss: 2.2354 | Train Acc: 0.1316
 Site-White_utk                 (4) | Train Loss: 2.1322 | Train Acc: 0.1429
 Site-White_utk                 (4) | Train Loss: 2.1594 | Train Acc: 0.1707
 Site-White_utk                 (4) | Train Loss: 2.1494 | Train Acc: 0.1570
 Site-White_utk                 (4) | Train Loss: 2.1579 | Train Acc: 0.1453
 Site-White_utk                 (4) | Train Loss: 2.2093 | Train Acc: 0.1331
 Site-White_utk                 (4) | Train Loss: 2.1462 | Train Acc: 0.1499
 Site-East_Asian                (1) | Train Loss: 1.7359 | Train Acc: 0.3704
 Site-East_Asian                (1) | Train Loss: 1.7219 | Train Acc: 0.4750
 Site-East_Asian                (1) | Train Loss: 1.8043 | Train Acc: 0.3559
 Site-East_Asian                (1) | Train Loss: 1.8184 | Train Acc: 0.3605
 Site-East_Asian                (1) | Train Loss: 1.7761 | Train Acc: 0.4094
 Site-East_Asian                (1) | Train Loss: 1.8140 | Train Acc: 0.3690
 Site-East_Asian                (1) | Train Loss: 1.7612 | Train Acc: 0.3986
 Site-Indian_utk                (0) | Train Loss: 1.8387 | Train Acc: 0.3256
 Site-Indian_utk                (5) | Train Loss: 1.8077 | Train Acc: 0.3906
 Site-Indian_utk                (5) | Train Loss: 1.8539 | Train Acc: 0.3404
 Site-Indian_utk                (5) | Train Loss: 1.8850 | Train Acc: 0.3525
 Site-Indian_utk                (5) | Train Loss: 1.8661 | Train Acc: 0.3707
 Site-Black_utk                 (2) | Train Loss: 1.7899 | Train Acc: 0.3818
 Site-Black_utk                 (2) | Train Loss: 1.8994 | Train Acc: 0.3333
 Site-Black_utk                 (2) | Train Loss: 1.8697 | Train Acc: 0.3193
 Site-Southeast_Asian           (1) | Train Loss: 1.9389 | Train Acc: 0.3137
 Site-Southeast_Asian           (1) | Train Loss: 2.0119 | Train Acc: 0.3133
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.4374 | Train Acc: 0.4709
 Site-White_ffhq                (3) | Train Loss: 1.3295 | Train Acc: 0.8034
Average Train Accuracy: 0.3084
 Site-White_utk                 (4) | Val  Loss: 2.1117 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.1230 | Val  Acc: 0.1818
 Site-White_utk                 (4) | Val  Loss: 2.1763 | Val  Acc: 0.0588
 Site-White_utk                 (4) | Val  Loss: 2.1678 | Val  Acc: 0.1200
 Site-White_utk                 (4) | Val  Loss: 2.1676 | Val  Acc: 0.1351
 Site-White_utk                 (4) | Val  Loss: 2.1253 | Val  Acc: 0.1273
 Site-White_utk                 (4) | Val  Loss: 2.2060 | Val  Acc: 0.1111
 Site-White_utk                 (4) | Val  Loss: 2.1661 | Val  Acc: 0.1345
 Site-White_utk                 (4) | Val  Loss: 2.1835 | Val  Acc: 0.1371
 Site-White_utk                 (4) | Val  Loss: 2.2351 | Val  Acc: 0.1434
 Site-East_Asian                (1) | Val  Loss: 2.0022 | Val  Acc: 0.1667
 Site-East_Asian                (1) | Val  Loss: 1.7975 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.8244 | Val  Acc: 0.4103
 Site-East_Asian                (1) | Val  Loss: 1.7481 | Val  Acc: 0.4211
 Site-East_Asian                (1) | Val  Loss: 1.7888 | Val  Acc: 0.4235
 Site-East_Asian                (1) | Val  Loss: 1.7425 | Val  Acc: 0.4160
 Site-East_Asian                (1) | Val  Loss: 1.7861 | Val  Acc: 0.3804
 Site-Indian_utk                (0) | Val  Loss: 1.8435 | Val  Acc: 0.3448
 Site-Indian_utk                (5) | Val  Loss: 1.8161 | Val  Acc: 0.3721
 Site-Indian_utk                (5) | Val  Loss: 1.8466 | Val  Acc: 0.4127
 Site-Indian_utk                (5) | Val  Loss: 1.8661 | Val  Acc: 0.3587
 Site-Indian_utk                (5) | Val  Loss: 1.7697 | Val  Acc: 0.3529
 Site-Black_utk                 (2) | Val  Loss: 1.7688 | Val  Acc: 0.3611
 Site-Black_utk                 (2) | Val  Loss: 1.8577 | Val  Acc: 0.3333
 Site-Black_utk                 (2) | Val  Loss: 1.8536 | Val  Acc: 0.3038
 Site-Southeast_Asian           (1) | Val  Loss: 2.1477 | Val  Acc: 0.3088
 Site-Southeast_Asian           (1) | Val  Loss: 2.0133 | Val  Acc: 0.3000
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.8465 | Val  Acc: 0.1739
 Site-White_ffhq                (3) | Val  Loss: 1.1557 | Val  Acc: 0.9615
Average Valid Accuracy: 0.2931
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1818
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.0588
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1200
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1351
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1273
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1111
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1345
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1371
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1434
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.1667
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4103
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4211
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4235
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4160
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.3804
 Best site-Indian_utk               (0)  | Epoch:4 | Val Acc: 0.3448
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.3721
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.4127
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.3587
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.3529
 Best site-Black_utk                (2)  | Epoch:4 | Val Acc: 0.3611
 Best site-Black_utk                (2)  | Epoch:4 | Val Acc: 0.3333
 Best site-Black_utk                (2)  | Epoch:4 | Val Acc: 0.3038
 Best site-Southeast_Asian          (1)  | Epoch:4 | Val Acc: 0.3088
 Best site-Southeast_Asian          (1)  | Epoch:4 | Val Acc: 0.3000
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:4 | Val Acc: 0.1739
 Best site-White_ffhq               (3)  | Epoch:4 | Val Acc: 0.9615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 8, 9, 9, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White_utk                 (5) | Train Loss: 1.8207 | Train Acc: 0.3333
 Site-White_utk                 (3) | Train Loss: 1.9283 | Train Acc: 0.3529
 Site-White_utk                 (3) | Train Loss: 2.0398 | Train Acc: 0.1538
 Site-White_utk                 (3) | Train Loss: 2.0758 | Train Acc: 0.1579
 Site-White_utk                 (3) | Train Loss: 2.0411 | Train Acc: 0.1786
 Site-White_utk                 (3) | Train Loss: 2.0536 | Train Acc: 0.2073
 Site-White_utk                 (3) | Train Loss: 1.9996 | Train Acc: 0.1901
 Site-White_utk                 (3) | Train Loss: 2.0647 | Train Acc: 0.1844
 Site-White_utk                 (3) | Train Loss: 2.0642 | Train Acc: 0.2053
 Site-White_utk                 (3) | Train Loss: 2.0730 | Train Acc: 0.1809
 Site-East_Asian                (2) | Train Loss: 1.7192 | Train Acc: 0.4074
 Site-East_Asian                (2) | Train Loss: 1.7148 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.7960 | Train Acc: 0.3898
 Site-East_Asian                (2) | Train Loss: 1.8340 | Train Acc: 0.3721
 Site-East_Asian                (2) | Train Loss: 1.7494 | Train Acc: 0.4173
 Site-East_Asian                (2) | Train Loss: 1.8107 | Train Acc: 0.3529
 Site-East_Asian                (2) | Train Loss: 1.7254 | Train Acc: 0.3986
 Site-Indian_utk                (1) | Train Loss: 1.8609 | Train Acc: 0.2326
 Site-Indian_utk                (1) | Train Loss: 1.7746 | Train Acc: 0.4062
 Site-Indian_utk                (1) | Train Loss: 1.8156 | Train Acc: 0.3191
 Site-Indian_utk                (1) | Train Loss: 1.8537 | Train Acc: 0.3885
 Site-Indian_utk                (1) | Train Loss: 1.8802 | Train Acc: 0.3366
 Site-Black_utk                 (1) | Train Loss: 1.7587 | Train Acc: 0.4545
 Site-Black_utk                 (1) | Train Loss: 1.8400 | Train Acc: 0.2963
 Site-Black_utk                 (1) | Train Loss: 1.8732 | Train Acc: 0.3361
 Site-Southeast_Asian           (2) | Train Loss: 1.9608 | Train Acc: 0.3333
 Site-Southeast_Asian           (2) | Train Loss: 1.9148 | Train Acc: 0.3000
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.4549 | Train Acc: 0.5291
 Site-White_ffhq                (0) | Train Loss: 1.4632 | Train Acc: 0.6325
Average Train Accuracy: 0.3292
 Site-White_utk                 (5) | Val  Loss: 2.0339 | Val  Acc: 0.2500
 Site-White_utk                 (3) | Val  Loss: 1.9800 | Val  Acc: 0.2727
 Site-White_utk                 (3) | Val  Loss: 2.0037 | Val  Acc: 0.2353
 Site-White_utk                 (3) | Val  Loss: 1.9994 | Val  Acc: 0.2400
 Site-White_utk                 (3) | Val  Loss: 2.0747 | Val  Acc: 0.1081
 Site-White_utk                 (3) | Val  Loss: 2.0438 | Val  Acc: 0.1636
 Site-White_utk                 (3) | Val  Loss: 2.0795 | Val  Acc: 0.1728
 Site-White_utk                 (3) | Val  Loss: 2.0841 | Val  Acc: 0.1681
 Site-White_utk                 (3) | Val  Loss: 2.0668 | Val  Acc: 0.1714
 Site-White_utk                 (3) | Val  Loss: 2.0948 | Val  Acc: 0.1822
 Site-East_Asian                (2) | Val  Loss: 1.9626 | Val  Acc: 0.2222
 Site-East_Asian                (2) | Val  Loss: 1.8013 | Val  Acc: 0.3846
 Site-East_Asian                (2) | Val  Loss: 1.8119 | Val  Acc: 0.3846
 Site-East_Asian                (2) | Val  Loss: 1.7718 | Val  Acc: 0.3158
 Site-East_Asian                (2) | Val  Loss: 1.8270 | Val  Acc: 0.4000
 Site-East_Asian                (2) | Val  Loss: 1.7384 | Val  Acc: 0.4400
 Site-East_Asian                (2) | Val  Loss: 1.7772 | Val  Acc: 0.3913
 Site-Indian_utk                (1) | Val  Loss: 1.8128 | Val  Acc: 0.3793
 Site-Indian_utk                (1) | Val  Loss: 1.8197 | Val  Acc: 0.3721
 Site-Indian_utk                (1) | Val  Loss: 1.8239 | Val  Acc: 0.4444
 Site-Indian_utk                (1) | Val  Loss: 1.8778 | Val  Acc: 0.3696
 Site-Indian_utk                (1) | Val  Loss: 1.7324 | Val  Acc: 0.3750
 Site-Black_utk                 (1) | Val  Loss: 1.8003 | Val  Acc: 0.5000
 Site-Black_utk                 (1) | Val  Loss: 1.8639 | Val  Acc: 0.3519
 Site-Black_utk                 (1) | Val  Loss: 1.8289 | Val  Acc: 0.3418
 Site-Southeast_Asian           (2) | Val  Loss: 2.0669 | Val  Acc: 0.2794
 Site-Southeast_Asian           (2) | Val  Loss: 1.9478 | Val  Acc: 0.2900
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.7798 | Val  Acc: 0.2783
 Site-White_ffhq                (0) | Val  Loss: 1.3181 | Val  Acc: 0.7436
Average Valid Accuracy: 0.3182
 Best site-White_utk                (5)  | Epoch:5 | Val Acc: 0.2500
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2727
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2353
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2400
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1081
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1636
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1728
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1681
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1714
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1822
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.2222
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3846
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3846
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3158
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4000
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4400
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3913
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3793
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3721
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.4444
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3696
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3750
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.5000
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.3519
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.3418
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.2794
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.2900
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:5 | Val Acc: 0.2783
 Best site-White_ffhq               (0)  | Epoch:5 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 3, 9, 1, 2, 13, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White_utk                 (0) | Train Loss: 1.6880 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 1.8750 | Train Acc: 0.2353
 Site-White_utk                 (5) | Train Loss: 1.9976 | Train Acc: 0.2308
 Site-White_utk                 (3) | Train Loss: 2.0307 | Train Acc: 0.2105
 Site-White_utk                 (5) | Train Loss: 1.9799 | Train Acc: 0.2143
 Site-White_utk                 (5) | Train Loss: 1.9653 | Train Acc: 0.2317
 Site-White_utk                 (5) | Train Loss: 1.9573 | Train Acc: 0.2479
 Site-White_utk                 (5) | Train Loss: 1.9949 | Train Acc: 0.2235
 Site-White_utk                 (5) | Train Loss: 1.9745 | Train Acc: 0.2357
 Site-White_utk                 (5) | Train Loss: 1.9650 | Train Acc: 0.2429
 Site-East_Asian                (2) | Train Loss: 1.6866 | Train Acc: 0.3704
 Site-East_Asian                (2) | Train Loss: 1.7484 | Train Acc: 0.4000
 Site-East_Asian                (2) | Train Loss: 1.7846 | Train Acc: 0.3898
 Site-East_Asian                (2) | Train Loss: 1.7878 | Train Acc: 0.3605
 Site-East_Asian                (2) | Train Loss: 1.7616 | Train Acc: 0.4016
 Site-East_Asian                (2) | Train Loss: 1.7909 | Train Acc: 0.3369
 Site-East_Asian                (2) | Train Loss: 1.7213 | Train Acc: 0.4130
 Site-Indian_utk                (5) | Train Loss: 1.8374 | Train Acc: 0.3488
 Site-Indian_utk                (5) | Train Loss: 1.7679 | Train Acc: 0.3750
 Site-Indian_utk                (5) | Train Loss: 1.8227 | Train Acc: 0.3404
 Site-Indian_utk                (5) | Train Loss: 1.8339 | Train Acc: 0.3453
 Site-Indian_utk                (5) | Train Loss: 1.8218 | Train Acc: 0.3561
 Site-Black_utk                 (1) | Train Loss: 1.7610 | Train Acc: 0.4364
 Site-Black_utk                 (1) | Train Loss: 1.8747 | Train Acc: 0.2593
 Site-Black_utk                 (1) | Train Loss: 1.8592 | Train Acc: 0.3445
 Site-Southeast_Asian           (2) | Train Loss: 1.9284 | Train Acc: 0.3137
 Site-Southeast_Asian           (2) | Train Loss: 1.9134 | Train Acc: 0.2867
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5102 | Train Acc: 0.5291
 Site-White_ffhq                (4) | Train Loss: 1.5433 | Train Acc: 0.4872
Average Train Accuracy: 0.3276
 Site-White_utk                 (0) | Val  Loss: 1.8880 | Val  Acc: 0.1250
 Site-White_utk                 (5) | Val  Loss: 1.9189 | Val  Acc: 0.2727
 Site-White_utk                 (5) | Val  Loss: 1.9868 | Val  Acc: 0.2353
 Site-White_utk                 (3) | Val  Loss: 2.0185 | Val  Acc: 0.2800
 Site-White_utk                 (5) | Val  Loss: 1.9750 | Val  Acc: 0.1892
 Site-White_utk                 (5) | Val  Loss: 1.9763 | Val  Acc: 0.2182
 Site-White_utk                 (5) | Val  Loss: 2.0495 | Val  Acc: 0.1975
 Site-White_utk                 (5) | Val  Loss: 1.9803 | Val  Acc: 0.2269
 Site-White_utk                 (5) | Val  Loss: 2.0072 | Val  Acc: 0.2057
 Site-White_utk                 (5) | Val  Loss: 2.0318 | Val  Acc: 0.2093
 Site-East_Asian                (2) | Val  Loss: 1.8731 | Val  Acc: 0.2222
 Site-East_Asian                (2) | Val  Loss: 1.7686 | Val  Acc: 0.4231
 Site-East_Asian                (2) | Val  Loss: 1.8093 | Val  Acc: 0.3846
 Site-East_Asian                (2) | Val  Loss: 1.7702 | Val  Acc: 0.3509
 Site-East_Asian                (2) | Val  Loss: 1.7807 | Val  Acc: 0.4000
 Site-East_Asian                (2) | Val  Loss: 1.7355 | Val  Acc: 0.4080
 Site-East_Asian                (2) | Val  Loss: 1.7366 | Val  Acc: 0.4402
 Site-Indian_utk                (5) | Val  Loss: 1.7849 | Val  Acc: 0.3103
 Site-Indian_utk                (5) | Val  Loss: 1.8447 | Val  Acc: 0.3256
 Site-Indian_utk                (5) | Val  Loss: 1.7866 | Val  Acc: 0.3968
 Site-Indian_utk                (5) | Val  Loss: 1.8931 | Val  Acc: 0.3478
 Site-Indian_utk                (5) | Val  Loss: 1.7372 | Val  Acc: 0.3603
 Site-Black_utk                 (1) | Val  Loss: 1.8840 | Val  Acc: 0.3889
 Site-Black_utk                 (1) | Val  Loss: 1.8475 | Val  Acc: 0.3333
 Site-Black_utk                 (1) | Val  Loss: 1.8169 | Val  Acc: 0.3418
 Site-Southeast_Asian           (2) | Val  Loss: 1.9688 | Val  Acc: 0.2647
 Site-Southeast_Asian           (2) | Val  Loss: 1.9664 | Val  Acc: 0.3300
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.7740 | Val  Acc: 0.3391
 Site-White_ffhq                (4) | Val  Loss: 1.4765 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3144
============ Train epoch 7 ============
cnt=[8, 1, 2, 8, 1, 9, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White_utk                 (4) | Train Loss: 1.6741 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 1.9497 | Train Acc: 0.2353
 Site-White_utk                 (5) | Train Loss: 1.9662 | Train Acc: 0.1923
 Site-White_utk                 (5) | Train Loss: 2.0286 | Train Acc: 0.2105
 Site-White_utk                 (5) | Train Loss: 1.9326 | Train Acc: 0.2679
 Site-White_utk                 (5) | Train Loss: 1.9290 | Train Acc: 0.1829
 Site-White_utk                 (5) | Train Loss: 1.9840 | Train Acc: 0.2149
 Site-White_utk                 (5) | Train Loss: 2.0199 | Train Acc: 0.2067
 Site-White_utk                 (5) | Train Loss: 1.8750 | Train Acc: 0.2167
 Site-White_utk                 (5) | Train Loss: 2.0378 | Train Acc: 0.2248
 Site-East_Asian                (1) | Train Loss: 1.6361 | Train Acc: 0.3704
 Site-East_Asian                (3) | Train Loss: 1.6506 | Train Acc: 0.4750
 Site-East_Asian                (3) | Train Loss: 1.7428 | Train Acc: 0.3390
 Site-East_Asian                (3) | Train Loss: 1.8595 | Train Acc: 0.3372
 Site-East_Asian                (3) | Train Loss: 1.7096 | Train Acc: 0.4173
 Site-East_Asian                (3) | Train Loss: 1.7499 | Train Acc: 0.3690
 Site-East_Asian                (3) | Train Loss: 1.7025 | Train Acc: 0.3949
 Site-Indian_utk                (0) | Train Loss: 1.7767 | Train Acc: 0.3721
 Site-Indian_utk                (0) | Train Loss: 1.7346 | Train Acc: 0.4375
 Site-Indian_utk                (0) | Train Loss: 1.7575 | Train Acc: 0.3617
 Site-Indian_utk                (0) | Train Loss: 1.7858 | Train Acc: 0.3957
 Site-Indian_utk                (0) | Train Loss: 1.7521 | Train Acc: 0.4098
 Site-Black_utk                 (0) | Train Loss: 1.6680 | Train Acc: 0.4545
 Site-Black_utk                 (0) | Train Loss: 1.7893 | Train Acc: 0.3457
 Site-Black_utk                 (0) | Train Loss: 1.8077 | Train Acc: 0.3277
 Site-Southeast_Asian           (3) | Train Loss: 1.9422 | Train Acc: 0.3137
 Site-Southeast_Asian           (3) | Train Loss: 1.9090 | Train Acc: 0.3267
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3841 | Train Acc: 0.4884
 Site-White_ffhq                (2) | Train Loss: 1.3792 | Train Acc: 0.5983
Average Train Accuracy: 0.3386
 Site-White_utk                 (4) | Val  Loss: 1.8650 | Val  Acc: 0.2500
 Site-White_utk                 (5) | Val  Loss: 2.0143 | Val  Acc: 0.2727
 Site-White_utk                 (5) | Val  Loss: 2.0054 | Val  Acc: 0.2353
 Site-White_utk                 (5) | Val  Loss: 2.0092 | Val  Acc: 0.2800
 Site-White_utk                 (5) | Val  Loss: 1.9448 | Val  Acc: 0.2162
 Site-White_utk                 (5) | Val  Loss: 2.0252 | Val  Acc: 0.1818
 Site-White_utk                 (5) | Val  Loss: 2.0285 | Val  Acc: 0.2099
 Site-White_utk                 (5) | Val  Loss: 2.0121 | Val  Acc: 0.1933
 Site-White_utk                 (5) | Val  Loss: 2.0218 | Val  Acc: 0.2000
 Site-White_utk                 (5) | Val  Loss: 2.0844 | Val  Acc: 0.2054
 Site-East_Asian                (1) | Val  Loss: 1.9349 | Val  Acc: 0.2222
 Site-East_Asian                (3) | Val  Loss: 1.7187 | Val  Acc: 0.3846
 Site-East_Asian                (3) | Val  Loss: 1.7369 | Val  Acc: 0.4359
 Site-East_Asian                (3) | Val  Loss: 1.6845 | Val  Acc: 0.3684
 Site-East_Asian                (3) | Val  Loss: 1.7392 | Val  Acc: 0.4235
 Site-East_Asian                (3) | Val  Loss: 1.6587 | Val  Acc: 0.4320
 Site-East_Asian                (3) | Val  Loss: 1.7114 | Val  Acc: 0.4076
 Site-Indian_utk                (0) | Val  Loss: 1.7413 | Val  Acc: 0.4138
 Site-Indian_utk                (0) | Val  Loss: 1.7409 | Val  Acc: 0.3953
 Site-Indian_utk                (0) | Val  Loss: 1.7436 | Val  Acc: 0.4127
 Site-Indian_utk                (0) | Val  Loss: 1.7826 | Val  Acc: 0.3804
 Site-Indian_utk                (0) | Val  Loss: 1.6643 | Val  Acc: 0.3971
 Site-Black_utk                 (0) | Val  Loss: 1.7888 | Val  Acc: 0.5000
 Site-Black_utk                 (0) | Val  Loss: 1.8154 | Val  Acc: 0.3704
 Site-Black_utk                 (0) | Val  Loss: 1.7752 | Val  Acc: 0.3165
 Site-Southeast_Asian           (3) | Val  Loss: 2.0728 | Val  Acc: 0.2941
 Site-Southeast_Asian           (3) | Val  Loss: 1.9281 | Val  Acc: 0.3200
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.7465 | Val  Acc: 0.2348
 Site-White_ffhq                (2) | Val  Loss: 1.2488 | Val  Acc: 0.7692
Average Valid Accuracy: 0.3353
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2500
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2727
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2353
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2800
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2162
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.1818
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2099
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.1933
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2000
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2054
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.2222
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.3846
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4359
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.3684
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4235
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4320
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4076
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.4138
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.3953
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.4127
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.3804
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.3971
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.5000
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3704
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3165
 Best site-Southeast_Asian          (3)  | Epoch:7 | Val Acc: 0.2941
 Best site-Southeast_Asian          (3)  | Epoch:7 | Val Acc: 0.3200
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:7 | Val Acc: 0.2348
 Best site-White_ffhq               (2)  | Epoch:7 | Val Acc: 0.7692
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 1, 10, 8, 2, 7, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White_utk                 (2) | Train Loss: 1.6161 | Train Acc: 0.3333
 Site-White_utk                 (2) | Train Loss: 1.8366 | Train Acc: 0.2353
 Site-White_utk                 (2) | Train Loss: 1.9203 | Train Acc: 0.1923
 Site-White_utk                 (2) | Train Loss: 2.0072 | Train Acc: 0.1842
 Site-White_utk                 (2) | Train Loss: 1.9019 | Train Acc: 0.2500
 Site-White_utk                 (2) | Train Loss: 1.9267 | Train Acc: 0.2317
 Site-White_utk                 (2) | Train Loss: 1.9333 | Train Acc: 0.2149
 Site-White_utk                 (2) | Train Loss: 1.9805 | Train Acc: 0.2123
 Site-White_utk                 (2) | Train Loss: 1.9875 | Train Acc: 0.2205
 Site-White_utk                 (2) | Train Loss: 1.9667 | Train Acc: 0.2119
 Site-East_Asian                (1) | Train Loss: 1.6032 | Train Acc: 0.4815
 Site-East_Asian                (3) | Train Loss: 1.5962 | Train Acc: 0.5250
 Site-East_Asian                (3) | Train Loss: 1.7466 | Train Acc: 0.3729
 Site-East_Asian                (3) | Train Loss: 1.7587 | Train Acc: 0.3605
 Site-East_Asian                (3) | Train Loss: 1.6839 | Train Acc: 0.4173
 Site-East_Asian                (3) | Train Loss: 1.6868 | Train Acc: 0.3904
 Site-East_Asian                (3) | Train Loss: 1.6794 | Train Acc: 0.4130
 Site-Indian_utk                (0) | Train Loss: 1.7041 | Train Acc: 0.3721
 Site-Indian_utk                (5) | Train Loss: 1.6451 | Train Acc: 0.4531
 Site-Indian_utk                (5) | Train Loss: 1.7717 | Train Acc: 0.3617
 Site-Indian_utk                (5) | Train Loss: 1.6929 | Train Acc: 0.3885
 Site-Indian_utk                (5) | Train Loss: 1.7528 | Train Acc: 0.4244
 Site-Black_utk                 (5) | Train Loss: 1.6807 | Train Acc: 0.4000
 Site-Black_utk                 (5) | Train Loss: 1.8267 | Train Acc: 0.3457
 Site-Black_utk                 (5) | Train Loss: 1.7798 | Train Acc: 0.3109
 Site-Southeast_Asian           (3) | Train Loss: 1.8890 | Train Acc: 0.3627
 Site-Southeast_Asian           (3) | Train Loss: 1.9167 | Train Acc: 0.3267
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.4302 | Train Acc: 0.4651
 Site-White_ffhq                (4) | Train Loss: 1.3522 | Train Acc: 0.6838
Average Train Accuracy: 0.3497
 Site-White_utk                 (2) | Val  Loss: 1.8782 | Val  Acc: 0.2500
 Site-White_utk                 (2) | Val  Loss: 1.8925 | Val  Acc: 0.2727
 Site-White_utk                 (2) | Val  Loss: 1.9617 | Val  Acc: 0.1765
 Site-White_utk                 (2) | Val  Loss: 1.9590 | Val  Acc: 0.3200
 Site-White_utk                 (2) | Val  Loss: 1.9102 | Val  Acc: 0.2432
 Site-White_utk                 (2) | Val  Loss: 1.9675 | Val  Acc: 0.2000
 Site-White_utk                 (2) | Val  Loss: 2.0067 | Val  Acc: 0.2099
 Site-White_utk                 (2) | Val  Loss: 1.9648 | Val  Acc: 0.2101
 Site-White_utk                 (2) | Val  Loss: 1.9918 | Val  Acc: 0.2000
 Site-White_utk                 (2) | Val  Loss: 2.0032 | Val  Acc: 0.2132
 Site-East_Asian                (1) | Val  Loss: 1.8619 | Val  Acc: 0.2778
 Site-East_Asian                (3) | Val  Loss: 1.6395 | Val  Acc: 0.4231
 Site-East_Asian                (3) | Val  Loss: 1.7270 | Val  Acc: 0.4103
 Site-East_Asian                (3) | Val  Loss: 1.6499 | Val  Acc: 0.4211
 Site-East_Asian                (3) | Val  Loss: 1.7078 | Val  Acc: 0.4118
 Site-East_Asian                (3) | Val  Loss: 1.6422 | Val  Acc: 0.4480
 Site-East_Asian                (3) | Val  Loss: 1.6901 | Val  Acc: 0.4022
 Site-Indian_utk                (0) | Val  Loss: 1.7865 | Val  Acc: 0.3793
 Site-Indian_utk                (5) | Val  Loss: 1.6779 | Val  Acc: 0.3721
 Site-Indian_utk                (5) | Val  Loss: 1.7220 | Val  Acc: 0.4286
 Site-Indian_utk                (5) | Val  Loss: 1.7669 | Val  Acc: 0.3804
 Site-Indian_utk                (5) | Val  Loss: 1.6518 | Val  Acc: 0.3971
 Site-Black_utk                 (5) | Val  Loss: 1.7665 | Val  Acc: 0.5000
 Site-Black_utk                 (5) | Val  Loss: 1.7586 | Val  Acc: 0.3704
 Site-Black_utk                 (5) | Val  Loss: 1.7250 | Val  Acc: 0.3291
 Site-Southeast_Asian           (3) | Val  Loss: 2.0074 | Val  Acc: 0.3382
 Site-Southeast_Asian           (3) | Val  Loss: 1.9049 | Val  Acc: 0.3400
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.7943 | Val  Acc: 0.2174
 Site-White_ffhq                (4) | Val  Loss: 1.1691 | Val  Acc: 0.8333
Average Valid Accuracy: 0.3440
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2500
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2727
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.1765
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3200
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2432
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2000
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2099
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2101
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2000
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2132
 Best site-East_Asian               (1)  | Epoch:8 | Val Acc: 0.2778
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4231
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4103
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4211
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4118
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4480
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4022
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.3793
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.3721
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.4286
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.3804
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.3971
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.5000
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.3704
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.3291
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.3382
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.3400
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:8 | Val Acc: 0.2174
 Best site-White_ffhq               (4)  | Epoch:8 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 9, 5, 11, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White_utk                 (5) | Train Loss: 1.5142 | Train Acc: 0.4167
 Site-White_utk                 (4) | Train Loss: 1.8096 | Train Acc: 0.3529
 Site-White_utk                 (4) | Train Loss: 1.7885 | Train Acc: 0.2692
 Site-White_utk                 (4) | Train Loss: 1.9146 | Train Acc: 0.1842
 Site-White_utk                 (1) | Train Loss: 1.8086 | Train Acc: 0.3393
 Site-White_utk                 (4) | Train Loss: 1.8983 | Train Acc: 0.3415
 Site-White_utk                 (4) | Train Loss: 1.8445 | Train Acc: 0.2645
 Site-White_utk                 (4) | Train Loss: 1.8708 | Train Acc: 0.2793
 Site-White_utk                 (4) | Train Loss: 1.8318 | Train Acc: 0.2624
 Site-White_utk                 (4) | Train Loss: 1.8449 | Train Acc: 0.3049
 Site-East_Asian                (2) | Train Loss: 1.5271 | Train Acc: 0.5556
 Site-East_Asian                (2) | Train Loss: 1.6178 | Train Acc: 0.4250
 Site-East_Asian                (2) | Train Loss: 1.7726 | Train Acc: 0.3390
 Site-East_Asian                (2) | Train Loss: 1.7054 | Train Acc: 0.3605
 Site-East_Asian                (2) | Train Loss: 1.7048 | Train Acc: 0.4567
 Site-East_Asian                (2) | Train Loss: 1.7096 | Train Acc: 0.3957
 Site-East_Asian                (2) | Train Loss: 1.6598 | Train Acc: 0.4420
 Site-Indian_utk                (3) | Train Loss: 1.6802 | Train Acc: 0.4651
 Site-Indian_utk                (3) | Train Loss: 1.6978 | Train Acc: 0.4688
 Site-Indian_utk                (3) | Train Loss: 1.7846 | Train Acc: 0.3191
 Site-Indian_utk                (3) | Train Loss: 1.7254 | Train Acc: 0.4173
 Site-Indian_utk                (3) | Train Loss: 1.7162 | Train Acc: 0.4244
 Site-Black_utk                 (4) | Train Loss: 1.6871 | Train Acc: 0.4182
 Site-Black_utk                 (4) | Train Loss: 1.7077 | Train Acc: 0.3086
 Site-Black_utk                 (4) | Train Loss: 1.8463 | Train Acc: 0.3529
 Site-Southeast_Asian           (2) | Train Loss: 1.8870 | Train Acc: 0.3824
 Site-Southeast_Asian           (2) | Train Loss: 1.8519 | Train Acc: 0.3667
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.5858 | Train Acc: 0.4826
 Site-White_ffhq                (0) | Train Loss: 1.5674 | Train Acc: 0.4957
Average Train Accuracy: 0.3756
 Site-White_utk                 (5) | Val  Loss: 1.7763 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 1.7735 | Val  Acc: 0.3636
 Site-White_utk                 (4) | Val  Loss: 1.8365 | Val  Acc: 0.2353
 Site-White_utk                 (4) | Val  Loss: 1.8570 | Val  Acc: 0.2400
 Site-White_utk                 (1) | Val  Loss: 1.8476 | Val  Acc: 0.2703
 Site-White_utk                 (4) | Val  Loss: 1.8532 | Val  Acc: 0.2909
 Site-White_utk                 (4) | Val  Loss: 1.9378 | Val  Acc: 0.2346
 Site-White_utk                 (4) | Val  Loss: 1.8697 | Val  Acc: 0.2521
 Site-White_utk                 (4) | Val  Loss: 1.8928 | Val  Acc: 0.2857
 Site-White_utk                 (4) | Val  Loss: 1.8702 | Val  Acc: 0.2752
 Site-East_Asian                (2) | Val  Loss: 1.7458 | Val  Acc: 0.3333
 Site-East_Asian                (2) | Val  Loss: 1.7213 | Val  Acc: 0.3462
 Site-East_Asian                (2) | Val  Loss: 1.7045 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.6938 | Val  Acc: 0.3509
 Site-East_Asian                (2) | Val  Loss: 1.7266 | Val  Acc: 0.4235
 Site-East_Asian                (2) | Val  Loss: 1.6656 | Val  Acc: 0.5120
 Site-East_Asian                (2) | Val  Loss: 1.6761 | Val  Acc: 0.4783
 Site-Indian_utk                (3) | Val  Loss: 1.6957 | Val  Acc: 0.4138
 Site-Indian_utk                (3) | Val  Loss: 1.6853 | Val  Acc: 0.4884
 Site-Indian_utk                (3) | Val  Loss: 1.7409 | Val  Acc: 0.3492
 Site-Indian_utk                (3) | Val  Loss: 1.7808 | Val  Acc: 0.4130
 Site-Indian_utk                (3) | Val  Loss: 1.6747 | Val  Acc: 0.4118
 Site-Black_utk                 (4) | Val  Loss: 1.8008 | Val  Acc: 0.4444
 Site-Black_utk                 (4) | Val  Loss: 1.8271 | Val  Acc: 0.3333
 Site-Black_utk                 (4) | Val  Loss: 1.7779 | Val  Acc: 0.3924
 Site-Southeast_Asian           (2) | Val  Loss: 1.9378 | Val  Acc: 0.3088
 Site-Southeast_Asian           (2) | Val  Loss: 1.8697 | Val  Acc: 0.3300
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.8344 | Val  Acc: 0.2870
 Site-White_ffhq                (0) | Val  Loss: 1.5073 | Val  Acc: 0.6410
Average Valid Accuracy: 0.3549
 Best site-White_utk                (5)  | Epoch:9 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3636
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2353
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2400
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.2703
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2909
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2346
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2521
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2857
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2752
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.3333
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.3462
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4615
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.3509
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4235
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.5120
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4783
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4138
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4884
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.3492
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4130
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4118
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.4444
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.3333
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.3924
 Best site-Southeast_Asian          (2)  | Epoch:9 | Val Acc: 0.3088
 Best site-Southeast_Asian          (2)  | Epoch:9 | Val Acc: 0.3300
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:9 | Val Acc: 0.2870
 Best site-White_ffhq               (0)  | Epoch:9 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Test site-White_utk                 (5)| Epoch:9 | Test Acc: 0.2970
 Test site-East_Asian                (2)| Epoch:9 | Test Acc: 0.4269
 Test site-Indian_utk                (3)| Epoch:9 | Test Acc: 0.4229
 Test site-Black_utk                 (4)| Epoch:9 | Test Acc: 0.3061
 Test site-Southeast_Asian           (2)| Epoch:9 | Test Acc: 0.3830
 Test site-Latino_Hispanic_ffhq      (0)| Epoch:9 | Test Acc: 0.2537
 Test site-White_ffhq                (0)| Epoch:9 | Test Acc: 0.2741
White_utk: 0.2970, East_Asian: 0.4269, Indian_utk: 0.4229, Black_utk: 0.3061, Southeast_Asian: 0.3830, Latino_Hispanic_ffhq: 0.2537, White_ffhq: 0.2741, 
Average Test Accuracy(group): 0.3377, Average Test Accuracy(individual): 0.3547,
domain CV=0.1971, cluster CV=nan, individual CV=0.1801, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
===2023-06-15 11:36:58===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 6
Loading snapshots...
 Test site-White_utk                 (5)| Epoch:8 | Test Acc: 0.2662
 Test site-East_Asian                (2)| Epoch:8 | Test Acc: 0.4507
 Test site-Indian_utk                (3)| Epoch:8 | Test Acc: 0.4792
 Test site-Black_utk                 (4)| Epoch:8 | Test Acc: 0.3622
===2023-06-15 11:38:34===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 15
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 8, 16, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (0) | Train Loss: 2.1346 | Train Acc: 0.1667
 Site-White_utk                 (4) | Train Loss: 2.1999 | Train Acc: 0.1176
 Site-White_utk                 (4) | Train Loss: 2.3304 | Train Acc: 0.1154
 Site-White_utk                 (4) | Train Loss: 2.2945 | Train Acc: 0.0789
 Site-White_utk                 (4) | Train Loss: 2.2714 | Train Acc: 0.0893
 Site-White_utk                 (4) | Train Loss: 2.2489 | Train Acc: 0.1341
 Site-White_utk                 (4) | Train Loss: 2.2057 | Train Acc: 0.1240
 Site-White_utk                 (4) | Train Loss: 2.2391 | Train Acc: 0.1229
 Site-White_utk                 (4) | Train Loss: 2.2783 | Train Acc: 0.0989
 Site-White_utk                 (4) | Train Loss: 2.2366 | Train Acc: 0.1189
 Site-East_Asian                (3) | Train Loss: 1.9104 | Train Acc: 0.4815
 Site-East_Asian                (3) | Train Loss: 1.9713 | Train Acc: 0.4750
 Site-East_Asian                (2) | Train Loss: 1.9704 | Train Acc: 0.3390
 Site-East_Asian                (3) | Train Loss: 1.9859 | Train Acc: 0.3721
 Site-East_Asian                (3) | Train Loss: 1.9761 | Train Acc: 0.3780
 Site-East_Asian                (3) | Train Loss: 1.9928 | Train Acc: 0.3102
 Site-East_Asian                (3) | Train Loss: 1.9373 | Train Acc: 0.3732
 Site-Indian_utk                (5) | Train Loss: 2.0500 | Train Acc: 0.3256
 Site-Indian_utk                (4) | Train Loss: 1.9709 | Train Acc: 0.3750
 Site-Indian_utk                (4) | Train Loss: 2.0599 | Train Acc: 0.2660
 Site-Indian_utk                (4) | Train Loss: 2.0041 | Train Acc: 0.2878
 Site-Indian_utk                (4) | Train Loss: 2.0759 | Train Acc: 0.3024
 Site-Black_utk                 (4) | Train Loss: 2.0064 | Train Acc: 0.2909
 Site-Black_utk                 (4) | Train Loss: 2.0331 | Train Acc: 0.2469
 Site-Black_utk                 (4) | Train Loss: 2.0878 | Train Acc: 0.2437
 Site-Southeast_Asian           (3) | Train Loss: 2.0789 | Train Acc: 0.3137
 Site-Southeast_Asian           (3) | Train Loss: 2.0902 | Train Acc: 0.2600
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.6731 | Train Acc: 0.4709
 Site-White_ffhq                (1) | Train Loss: 1.6446 | Train Acc: 0.7179
Average Train Accuracy: 0.2757
 Site-White_utk                 (0) | Val  Loss: 2.2015 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.3058 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.2570 | Val  Acc: 0.1176
 Site-White_utk                 (4) | Val  Loss: 2.2297 | Val  Acc: 0.1600
 Site-White_utk                 (4) | Val  Loss: 2.2485 | Val  Acc: 0.1081
 Site-White_utk                 (4) | Val  Loss: 2.1859 | Val  Acc: 0.1091
 Site-White_utk                 (4) | Val  Loss: 2.1977 | Val  Acc: 0.0741
 Site-White_utk                 (4) | Val  Loss: 2.2552 | Val  Acc: 0.1008
 Site-White_utk                 (4) | Val  Loss: 2.2290 | Val  Acc: 0.1143
 Site-White_utk                 (4) | Val  Loss: 2.3147 | Val  Acc: 0.1202
 Site-East_Asian                (3) | Val  Loss: 2.1320 | Val  Acc: 0.1667
 Site-East_Asian                (3) | Val  Loss: 2.0120 | Val  Acc: 0.3462
 Site-East_Asian                (2) | Val  Loss: 1.9945 | Val  Acc: 0.3333
 Site-East_Asian                (3) | Val  Loss: 1.9647 | Val  Acc: 0.3333
 Site-East_Asian                (3) | Val  Loss: 1.9792 | Val  Acc: 0.3529
 Site-East_Asian                (3) | Val  Loss: 1.9380 | Val  Acc: 0.3840
 Site-East_Asian                (3) | Val  Loss: 1.9669 | Val  Acc: 0.3641
 Site-Indian_utk                (5) | Val  Loss: 2.0064 | Val  Acc: 0.3448
 Site-Indian_utk                (4) | Val  Loss: 2.0740 | Val  Acc: 0.2558
 Site-Indian_utk                (4) | Val  Loss: 2.0554 | Val  Acc: 0.3175
 Site-Indian_utk                (4) | Val  Loss: 2.0783 | Val  Acc: 0.2935
 Site-Indian_utk                (4) | Val  Loss: 1.9727 | Val  Acc: 0.3603
 Site-Black_utk                 (4) | Val  Loss: 2.0203 | Val  Acc: 0.3056
 Site-Black_utk                 (4) | Val  Loss: 2.0368 | Val  Acc: 0.2778
 Site-Black_utk                 (4) | Val  Loss: 1.9980 | Val  Acc: 0.3038
 Site-Southeast_Asian           (3) | Val  Loss: 2.2813 | Val  Acc: 0.2353
 Site-Southeast_Asian           (3) | Val  Loss: 2.1025 | Val  Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.9589 | Val  Acc: 0.2087
 Site-White_ffhq                (1) | Val  Loss: 1.5250 | Val  Acc: 0.8077
Average Valid Accuracy: 0.2549
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0909
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1176
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1600
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1081
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1091
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0741
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1008
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1143
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1202
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.1667
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3462
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3333
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3529
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3840
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3641
 Best site-Indian_utk               (5)  | Epoch:0 | Val Acc: 0.3448
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.2558
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3175
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.2935
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3603
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3056
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.2778
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3038
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2353
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2800
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:0 | Val Acc: 0.2087
 Best site-White_ffhq               (1)  | Epoch:0 | Val Acc: 0.8077
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 9, 2, 13, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (3) | Train Loss: 2.0572 | Train Acc: 0.0833
 Site-White_utk                 (5) | Train Loss: 2.3124 | Train Acc: 0.1176
 Site-White_utk                 (3) | Train Loss: 2.3474 | Train Acc: 0.1154
 Site-White_utk                 (3) | Train Loss: 2.3601 | Train Acc: 0.1053
 Site-White_utk                 (0) | Train Loss: 2.3142 | Train Acc: 0.1071
 Site-White_utk                 (3) | Train Loss: 2.3300 | Train Acc: 0.1098
 Site-White_utk                 (3) | Train Loss: 2.3137 | Train Acc: 0.0992
 Site-White_utk                 (3) | Train Loss: 2.3002 | Train Acc: 0.1117
 Site-White_utk                 (3) | Train Loss: 2.1967 | Train Acc: 0.0989
 Site-White_utk                 (3) | Train Loss: 2.3545 | Train Acc: 0.1085
 Site-East_Asian                (1) | Train Loss: 1.8297 | Train Acc: 0.4074
 Site-East_Asian                (1) | Train Loss: 1.8248 | Train Acc: 0.4750
 Site-East_Asian                (1) | Train Loss: 1.8457 | Train Acc: 0.3898
 Site-East_Asian                (1) | Train Loss: 2.0082 | Train Acc: 0.3488
 Site-East_Asian                (1) | Train Loss: 1.8665 | Train Acc: 0.3937
 Site-East_Asian                (1) | Train Loss: 1.8910 | Train Acc: 0.3422
 Site-East_Asian                (1) | Train Loss: 1.8167 | Train Acc: 0.3877
 Site-Indian_utk                (3) | Train Loss: 1.9767 | Train Acc: 0.3256
 Site-Indian_utk                (3) | Train Loss: 1.8822 | Train Acc: 0.3906
 Site-Indian_utk                (3) | Train Loss: 1.9697 | Train Acc: 0.3404
 Site-Indian_utk                (3) | Train Loss: 1.9025 | Train Acc: 0.3381
 Site-Indian_utk                (3) | Train Loss: 1.9475 | Train Acc: 0.3415
 Site-Black_utk                 (4) | Train Loss: 1.8805 | Train Acc: 0.3636
 Site-Black_utk                 (4) | Train Loss: 2.0319 | Train Acc: 0.3086
 Site-Black_utk                 (4) | Train Loss: 1.9376 | Train Acc: 0.3277
 Site-Southeast_Asian           (1) | Train Loss: 2.0011 | Train Acc: 0.3137
 Site-Southeast_Asian           (1) | Train Loss: 2.0341 | Train Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.4661 | Train Acc: 0.4767
 Site-White_ffhq                (2) | Train Loss: 1.4225 | Train Acc: 0.7863
Average Train Accuracy: 0.2895
 Site-White_utk                 (3) | Val  Loss: 2.2690 | Val  Acc: 0.1250
 Site-White_utk                 (5) | Val  Loss: 2.2926 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.2641 | Val  Acc: 0.1176
 Site-White_utk                 (3) | Val  Loss: 2.3369 | Val  Acc: 0.1200
 Site-White_utk                 (0) | Val  Loss: 2.2879 | Val  Acc: 0.1351
 Site-White_utk                 (3) | Val  Loss: 2.2883 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.2826 | Val  Acc: 0.0864
 Site-White_utk                 (3) | Val  Loss: 2.3048 | Val  Acc: 0.1008
 Site-White_utk                 (3) | Val  Loss: 2.2960 | Val  Acc: 0.1143
 Site-White_utk                 (3) | Val  Loss: 2.3823 | Val  Acc: 0.1008
 Site-East_Asian                (1) | Val  Loss: 2.1124 | Val  Acc: 0.2222
 Site-East_Asian                (1) | Val  Loss: 1.8831 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.8941 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.8364 | Val  Acc: 0.3509
 Site-East_Asian                (1) | Val  Loss: 1.9094 | Val  Acc: 0.4118
 Site-East_Asian                (1) | Val  Loss: 1.8289 | Val  Acc: 0.4080
 Site-East_Asian                (1) | Val  Loss: 1.8642 | Val  Acc: 0.3750
 Site-Indian_utk                (3) | Val  Loss: 1.9693 | Val  Acc: 0.2759
 Site-Indian_utk                (3) | Val  Loss: 1.9936 | Val  Acc: 0.3488
 Site-Indian_utk                (3) | Val  Loss: 1.9583 | Val  Acc: 0.3651
 Site-Indian_utk                (3) | Val  Loss: 1.9353 | Val  Acc: 0.3370
 Site-Indian_utk                (3) | Val  Loss: 1.8681 | Val  Acc: 0.3750
 Site-Black_utk                 (4) | Val  Loss: 1.9072 | Val  Acc: 0.3333
 Site-Black_utk                 (4) | Val  Loss: 1.9088 | Val  Acc: 0.3704
 Site-Black_utk                 (4) | Val  Loss: 1.9294 | Val  Acc: 0.3291
 Site-Southeast_Asian           (1) | Val  Loss: 2.2727 | Val  Acc: 0.2794
 Site-Southeast_Asian           (1) | Val  Loss: 2.0605 | Val  Acc: 0.2900
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8681 | Val  Acc: 0.1652
 Site-White_ffhq                (2) | Val  Loss: 1.2223 | Val  Acc: 0.9487
Average Valid Accuracy: 0.2785
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1250
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1176
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1200
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1351
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0864
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1008
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1143
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1008
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.2222
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3846
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3509
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4118
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4080
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3750
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.2759
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3488
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3651
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3370
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3750
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3333
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3704
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3291
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2794
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2900
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:1 | Val Acc: 0.1652
 Best site-White_ffhq               (2)  | Epoch:1 | Val Acc: 0.9487
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 9, 2, 8, 8, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk                 (5) | Train Loss: 1.9236 | Train Acc: 0.2500
 Site-White_utk                 (4) | Train Loss: 2.1298 | Train Acc: 0.1176
 Site-White_utk                 (4) | Train Loss: 2.1361 | Train Acc: 0.1154
 Site-White_utk                 (0) | Train Loss: 2.2708 | Train Acc: 0.1053
 Site-White_utk                 (4) | Train Loss: 2.1451 | Train Acc: 0.1607
 Site-White_utk                 (4) | Train Loss: 2.1195 | Train Acc: 0.1463
 Site-White_utk                 (4) | Train Loss: 2.1530 | Train Acc: 0.1157
 Site-White_utk                 (4) | Train Loss: 2.1793 | Train Acc: 0.1285
 Site-White_utk                 (4) | Train Loss: 2.1316 | Train Acc: 0.1255
 Site-White_utk                 (4) | Train Loss: 2.1346 | Train Acc: 0.1318
 Site-East_Asian                (1) | Train Loss: 1.8363 | Train Acc: 0.4074
 Site-East_Asian                (1) | Train Loss: 1.9276 | Train Acc: 0.4500
 Site-East_Asian                (1) | Train Loss: 1.9063 | Train Acc: 0.3390
 Site-East_Asian                (1) | Train Loss: 1.9704 | Train Acc: 0.3605
 Site-East_Asian                (1) | Train Loss: 1.9070 | Train Acc: 0.3622
 Site-East_Asian                (1) | Train Loss: 1.9240 | Train Acc: 0.3743
 Site-East_Asian                (1) | Train Loss: 1.9027 | Train Acc: 0.3696
 Site-Indian_utk                (3) | Train Loss: 1.9634 | Train Acc: 0.3023
 Site-Indian_utk                (3) | Train Loss: 1.9036 | Train Acc: 0.4062
 Site-Indian_utk                (3) | Train Loss: 1.9633 | Train Acc: 0.3511
 Site-Indian_utk                (3) | Train Loss: 1.9633 | Train Acc: 0.3525
 Site-Indian_utk                (3) | Train Loss: 1.9731 | Train Acc: 0.3122
 Site-Black_utk                 (3) | Train Loss: 1.9245 | Train Acc: 0.3455
 Site-Black_utk                 (3) | Train Loss: 2.0371 | Train Acc: 0.3210
 Site-Black_utk                 (3) | Train Loss: 2.0216 | Train Acc: 0.2773
 Site-Southeast_Asian           (1) | Train Loss: 1.9650 | Train Acc: 0.3137
 Site-Southeast_Asian           (1) | Train Loss: 2.0197 | Train Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6736 | Train Acc: 0.4884
 Site-White_ffhq                (2) | Train Loss: 1.6062 | Train Acc: 0.7094
Average Train Accuracy: 0.2938
 Site-White_utk                 (5) | Val  Loss: 2.2066 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.1447 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.0984 | Val  Acc: 0.1765
 Site-White_utk                 (0) | Val  Loss: 2.2268 | Val  Acc: 0.1200
 Site-White_utk                 (4) | Val  Loss: 2.2269 | Val  Acc: 0.0811
 Site-White_utk                 (4) | Val  Loss: 2.1308 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.1489 | Val  Acc: 0.1481
 Site-White_utk                 (4) | Val  Loss: 2.1804 | Val  Acc: 0.1345
 Site-White_utk                 (4) | Val  Loss: 2.1671 | Val  Acc: 0.1314
 Site-White_utk                 (4) | Val  Loss: 2.2368 | Val  Acc: 0.1434
 Site-East_Asian                (1) | Val  Loss: 2.0670 | Val  Acc: 0.2778
 Site-East_Asian                (1) | Val  Loss: 1.9322 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.9967 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.8944 | Val  Acc: 0.4035
 Site-East_Asian                (1) | Val  Loss: 1.9294 | Val  Acc: 0.4000
 Site-East_Asian                (1) | Val  Loss: 1.8685 | Val  Acc: 0.4080
 Site-East_Asian                (1) | Val  Loss: 1.8956 | Val  Acc: 0.3859
 Site-Indian_utk                (3) | Val  Loss: 1.9546 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.9256 | Val  Acc: 0.3256
 Site-Indian_utk                (3) | Val  Loss: 1.9770 | Val  Acc: 0.3651
 Site-Indian_utk                (3) | Val  Loss: 2.0221 | Val  Acc: 0.3152
 Site-Indian_utk                (3) | Val  Loss: 1.9280 | Val  Acc: 0.3235
 Site-Black_utk                 (3) | Val  Loss: 1.9537 | Val  Acc: 0.2778
 Site-Black_utk                 (3) | Val  Loss: 1.9910 | Val  Acc: 0.2778
 Site-Black_utk                 (3) | Val  Loss: 1.9970 | Val  Acc: 0.3418
 Site-Southeast_Asian           (1) | Val  Loss: 2.2328 | Val  Acc: 0.2794
 Site-Southeast_Asian           (1) | Val  Loss: 2.0398 | Val  Acc: 0.2700
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9629 | Val  Acc: 0.1739
 Site-White_ffhq                (2) | Val  Loss: 1.4492 | Val  Acc: 0.8974
Average Valid Accuracy: 0.2774
============ Train epoch 3 ============
cnt=[7, 1, 3, 8, 2, 8, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White_utk                 (2) | Train Loss: 1.9477 | Train Acc: 0.3333
 Site-White_utk                 (0) | Train Loss: 2.0822 | Train Acc: 0.2353
 Site-White_utk                 (0) | Train Loss: 2.1351 | Train Acc: 0.1154
 Site-White_utk                 (0) | Train Loss: 2.2036 | Train Acc: 0.0526
 Site-White_utk                 (2) | Train Loss: 2.1533 | Train Acc: 0.1607
 Site-White_utk                 (2) | Train Loss: 2.1490 | Train Acc: 0.1707
 Site-White_utk                 (0) | Train Loss: 2.1025 | Train Acc: 0.1570
 Site-White_utk                 (0) | Train Loss: 2.1554 | Train Acc: 0.1508
 Site-White_utk                 (0) | Train Loss: 2.1743 | Train Acc: 0.1179
 Site-White_utk                 (0) | Train Loss: 2.0624 | Train Acc: 0.1550
 Site-East_Asian                (5) | Train Loss: 1.8374 | Train Acc: 0.4074
 Site-East_Asian                (5) | Train Loss: 1.8272 | Train Acc: 0.4500
 Site-East_Asian                (1) | Train Loss: 1.8663 | Train Acc: 0.3051
 Site-East_Asian                (5) | Train Loss: 1.9418 | Train Acc: 0.3488
 Site-East_Asian                (5) | Train Loss: 1.8571 | Train Acc: 0.3858
 Site-East_Asian                (5) | Train Loss: 1.8833 | Train Acc: 0.3636
 Site-East_Asian                (5) | Train Loss: 1.8283 | Train Acc: 0.3877
 Site-Indian_utk                (3) | Train Loss: 1.9505 | Train Acc: 0.2791
 Site-Indian_utk                (3) | Train Loss: 1.8425 | Train Acc: 0.4219
 Site-Indian_utk                (3) | Train Loss: 1.9541 | Train Acc: 0.3191
 Site-Indian_utk                (3) | Train Loss: 1.9119 | Train Acc: 0.3597
 Site-Indian_utk                (3) | Train Loss: 1.9425 | Train Acc: 0.3220
 Site-Black_utk                 (3) | Train Loss: 1.8894 | Train Acc: 0.4000
 Site-Black_utk                 (3) | Train Loss: 1.9403 | Train Acc: 0.2963
 Site-Black_utk                 (3) | Train Loss: 1.9409 | Train Acc: 0.2773
 Site-Southeast_Asian           (5) | Train Loss: 2.0029 | Train Acc: 0.3137
 Site-Southeast_Asian           (5) | Train Loss: 1.9966 | Train Acc: 0.3067
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6011 | Train Acc: 0.4767
 Site-White_ffhq                (4) | Train Loss: 1.5352 | Train Acc: 0.7436
Average Train Accuracy: 0.3039
 Site-White_utk                 (2) | Val  Loss: 2.0545 | Val  Acc: 0.3750
 Site-White_utk                 (0) | Val  Loss: 2.1140 | Val  Acc: 0.1818
 Site-White_utk                 (0) | Val  Loss: 2.1442 | Val  Acc: 0.1176
 Site-White_utk                 (0) | Val  Loss: 2.2113 | Val  Acc: 0.1600
 Site-White_utk                 (2) | Val  Loss: 2.1698 | Val  Acc: 0.1351
 Site-White_utk                 (2) | Val  Loss: 2.1272 | Val  Acc: 0.0909
 Site-White_utk                 (0) | Val  Loss: 2.1201 | Val  Acc: 0.1111
 Site-White_utk                 (0) | Val  Loss: 2.1542 | Val  Acc: 0.1429
 Site-White_utk                 (0) | Val  Loss: 2.1395 | Val  Acc: 0.1543
 Site-White_utk                 (0) | Val  Loss: 2.1520 | Val  Acc: 0.1473
 Site-East_Asian                (5) | Val  Loss: 2.0184 | Val  Acc: 0.2222
 Site-East_Asian                (5) | Val  Loss: 1.8678 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.9464 | Val  Acc: 0.3333
 Site-East_Asian                (5) | Val  Loss: 1.8703 | Val  Acc: 0.3860
 Site-East_Asian                (5) | Val  Loss: 1.9020 | Val  Acc: 0.4118
 Site-East_Asian                (5) | Val  Loss: 1.8328 | Val  Acc: 0.4080
 Site-East_Asian                (5) | Val  Loss: 1.8540 | Val  Acc: 0.3913
 Site-Indian_utk                (3) | Val  Loss: 1.9433 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.9132 | Val  Acc: 0.3488
 Site-Indian_utk                (3) | Val  Loss: 1.9386 | Val  Acc: 0.3333
 Site-Indian_utk                (3) | Val  Loss: 1.9366 | Val  Acc: 0.3043
 Site-Indian_utk                (3) | Val  Loss: 1.8752 | Val  Acc: 0.3088
 Site-Black_utk                 (3) | Val  Loss: 1.8892 | Val  Acc: 0.2778
 Site-Black_utk                 (3) | Val  Loss: 1.9633 | Val  Acc: 0.2222
 Site-Black_utk                 (3) | Val  Loss: 1.9804 | Val  Acc: 0.3165
 Site-Southeast_Asian           (5) | Val  Loss: 2.1087 | Val  Acc: 0.2794
 Site-Southeast_Asian           (5) | Val  Loss: 1.9996 | Val  Acc: 0.3100
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.9042 | Val  Acc: 0.1913
 Site-White_ffhq                (4) | Val  Loss: 1.4117 | Val  Acc: 0.8333
Average Valid Accuracy: 0.2837
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.3750
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1818
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1176
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1600
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1351
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.0909
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1111
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1429
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1543
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1473
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.2222
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:3 | Val Acc: 0.3333
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.3860
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4118
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4080
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.3913
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3103
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3488
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3333
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3043
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3088
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.2778
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.2222
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.3165
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.2794
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3100
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:3 | Val Acc: 0.1913
 Best site-White_ffhq               (4)  | Epoch:3 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 9, 3, 2, 10, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White_utk                 (4) | Train Loss: 1.9586 | Train Acc: 0.1667
 Site-White_utk                 (4) | Train Loss: 2.1110 | Train Acc: 0.1765
 Site-White_utk                 (4) | Train Loss: 2.1296 | Train Acc: 0.1154
 Site-White_utk                 (4) | Train Loss: 2.2354 | Train Acc: 0.1316
 Site-White_utk                 (4) | Train Loss: 2.1322 | Train Acc: 0.1429
 Site-White_utk                 (4) | Train Loss: 2.1594 | Train Acc: 0.1707
 Site-White_utk                 (4) | Train Loss: 2.1494 | Train Acc: 0.1570
 Site-White_utk                 (4) | Train Loss: 2.1579 | Train Acc: 0.1453
 Site-White_utk                 (4) | Train Loss: 2.2093 | Train Acc: 0.1331
 Site-White_utk                 (4) | Train Loss: 2.1462 | Train Acc: 0.1499
 Site-East_Asian                (1) | Train Loss: 1.7359 | Train Acc: 0.3704
 Site-East_Asian                (1) | Train Loss: 1.7219 | Train Acc: 0.4750
 Site-East_Asian                (1) | Train Loss: 1.8043 | Train Acc: 0.3559
 Site-East_Asian                (1) | Train Loss: 1.8184 | Train Acc: 0.3605
 Site-East_Asian                (1) | Train Loss: 1.7761 | Train Acc: 0.4094
 Site-East_Asian                (1) | Train Loss: 1.8140 | Train Acc: 0.3690
 Site-East_Asian                (1) | Train Loss: 1.7612 | Train Acc: 0.3986
 Site-Indian_utk                (0) | Train Loss: 1.8387 | Train Acc: 0.3256
 Site-Indian_utk                (5) | Train Loss: 1.8077 | Train Acc: 0.3906
 Site-Indian_utk                (5) | Train Loss: 1.8539 | Train Acc: 0.3404
 Site-Indian_utk                (5) | Train Loss: 1.8850 | Train Acc: 0.3525
 Site-Indian_utk                (5) | Train Loss: 1.8661 | Train Acc: 0.3707
 Site-Black_utk                 (2) | Train Loss: 1.7899 | Train Acc: 0.3818
 Site-Black_utk                 (2) | Train Loss: 1.8994 | Train Acc: 0.3333
 Site-Black_utk                 (2) | Train Loss: 1.8697 | Train Acc: 0.3193
 Site-Southeast_Asian           (1) | Train Loss: 1.9389 | Train Acc: 0.3137
 Site-Southeast_Asian           (1) | Train Loss: 2.0119 | Train Acc: 0.3133
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.4374 | Train Acc: 0.4709
 Site-White_ffhq                (3) | Train Loss: 1.3295 | Train Acc: 0.8034
Average Train Accuracy: 0.3084
 Site-White_utk                 (4) | Val  Loss: 2.1117 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.1230 | Val  Acc: 0.1818
 Site-White_utk                 (4) | Val  Loss: 2.1763 | Val  Acc: 0.0588
 Site-White_utk                 (4) | Val  Loss: 2.1678 | Val  Acc: 0.1200
 Site-White_utk                 (4) | Val  Loss: 2.1676 | Val  Acc: 0.1351
 Site-White_utk                 (4) | Val  Loss: 2.1253 | Val  Acc: 0.1273
 Site-White_utk                 (4) | Val  Loss: 2.2060 | Val  Acc: 0.1111
 Site-White_utk                 (4) | Val  Loss: 2.1661 | Val  Acc: 0.1345
 Site-White_utk                 (4) | Val  Loss: 2.1835 | Val  Acc: 0.1371
 Site-White_utk                 (4) | Val  Loss: 2.2351 | Val  Acc: 0.1434
 Site-East_Asian                (1) | Val  Loss: 2.0022 | Val  Acc: 0.1667
 Site-East_Asian                (1) | Val  Loss: 1.7975 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.8244 | Val  Acc: 0.4103
 Site-East_Asian                (1) | Val  Loss: 1.7481 | Val  Acc: 0.4211
 Site-East_Asian                (1) | Val  Loss: 1.7888 | Val  Acc: 0.4235
 Site-East_Asian                (1) | Val  Loss: 1.7425 | Val  Acc: 0.4160
 Site-East_Asian                (1) | Val  Loss: 1.7861 | Val  Acc: 0.3804
 Site-Indian_utk                (0) | Val  Loss: 1.8435 | Val  Acc: 0.3448
 Site-Indian_utk                (5) | Val  Loss: 1.8161 | Val  Acc: 0.3721
 Site-Indian_utk                (5) | Val  Loss: 1.8466 | Val  Acc: 0.4127
 Site-Indian_utk                (5) | Val  Loss: 1.8661 | Val  Acc: 0.3587
 Site-Indian_utk                (5) | Val  Loss: 1.7697 | Val  Acc: 0.3529
 Site-Black_utk                 (2) | Val  Loss: 1.7688 | Val  Acc: 0.3611
 Site-Black_utk                 (2) | Val  Loss: 1.8577 | Val  Acc: 0.3333
 Site-Black_utk                 (2) | Val  Loss: 1.8536 | Val  Acc: 0.3038
 Site-Southeast_Asian           (1) | Val  Loss: 2.1477 | Val  Acc: 0.3088
 Site-Southeast_Asian           (1) | Val  Loss: 2.0133 | Val  Acc: 0.3000
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.8465 | Val  Acc: 0.1739
 Site-White_ffhq                (3) | Val  Loss: 1.1557 | Val  Acc: 0.9615
Average Valid Accuracy: 0.2931
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1818
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.0588
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1200
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1351
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1273
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1111
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1345
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1371
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.1434
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.1667
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4103
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4211
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4235
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4160
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.3804
 Best site-Indian_utk               (0)  | Epoch:4 | Val Acc: 0.3448
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.3721
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.4127
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.3587
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.3529
 Best site-Black_utk                (2)  | Epoch:4 | Val Acc: 0.3611
 Best site-Black_utk                (2)  | Epoch:4 | Val Acc: 0.3333
 Best site-Black_utk                (2)  | Epoch:4 | Val Acc: 0.3038
 Best site-Southeast_Asian          (1)  | Epoch:4 | Val Acc: 0.3088
 Best site-Southeast_Asian          (1)  | Epoch:4 | Val Acc: 0.3000
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:4 | Val Acc: 0.1739
 Best site-White_ffhq               (3)  | Epoch:4 | Val Acc: 0.9615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 8, 9, 9, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White_utk                 (5) | Train Loss: 1.8207 | Train Acc: 0.3333
 Site-White_utk                 (3) | Train Loss: 1.9283 | Train Acc: 0.3529
 Site-White_utk                 (3) | Train Loss: 2.0398 | Train Acc: 0.1538
 Site-White_utk                 (3) | Train Loss: 2.0758 | Train Acc: 0.1579
 Site-White_utk                 (3) | Train Loss: 2.0411 | Train Acc: 0.1786
 Site-White_utk                 (3) | Train Loss: 2.0536 | Train Acc: 0.2073
 Site-White_utk                 (3) | Train Loss: 1.9996 | Train Acc: 0.1901
 Site-White_utk                 (3) | Train Loss: 2.0647 | Train Acc: 0.1844
 Site-White_utk                 (3) | Train Loss: 2.0642 | Train Acc: 0.2053
 Site-White_utk                 (3) | Train Loss: 2.0730 | Train Acc: 0.1809
 Site-East_Asian                (2) | Train Loss: 1.7192 | Train Acc: 0.4074
 Site-East_Asian                (2) | Train Loss: 1.7148 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.7960 | Train Acc: 0.3898
 Site-East_Asian                (2) | Train Loss: 1.8340 | Train Acc: 0.3721
 Site-East_Asian                (2) | Train Loss: 1.7494 | Train Acc: 0.4173
 Site-East_Asian                (2) | Train Loss: 1.8107 | Train Acc: 0.3529
 Site-East_Asian                (2) | Train Loss: 1.7254 | Train Acc: 0.3986
 Site-Indian_utk                (1) | Train Loss: 1.8609 | Train Acc: 0.2326
 Site-Indian_utk                (1) | Train Loss: 1.7746 | Train Acc: 0.4062
 Site-Indian_utk                (1) | Train Loss: 1.8156 | Train Acc: 0.3191
 Site-Indian_utk                (1) | Train Loss: 1.8537 | Train Acc: 0.3885
 Site-Indian_utk                (1) | Train Loss: 1.8802 | Train Acc: 0.3366
 Site-Black_utk                 (1) | Train Loss: 1.7587 | Train Acc: 0.4545
 Site-Black_utk                 (1) | Train Loss: 1.8400 | Train Acc: 0.2963
 Site-Black_utk                 (1) | Train Loss: 1.8732 | Train Acc: 0.3361
 Site-Southeast_Asian           (2) | Train Loss: 1.9608 | Train Acc: 0.3333
 Site-Southeast_Asian           (2) | Train Loss: 1.9148 | Train Acc: 0.3000
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.4549 | Train Acc: 0.5291
 Site-White_ffhq                (0) | Train Loss: 1.4632 | Train Acc: 0.6325
Average Train Accuracy: 0.3292
 Site-White_utk                 (5) | Val  Loss: 2.0339 | Val  Acc: 0.2500
 Site-White_utk                 (3) | Val  Loss: 1.9800 | Val  Acc: 0.2727
 Site-White_utk                 (3) | Val  Loss: 2.0037 | Val  Acc: 0.2353
 Site-White_utk                 (3) | Val  Loss: 1.9994 | Val  Acc: 0.2400
 Site-White_utk                 (3) | Val  Loss: 2.0747 | Val  Acc: 0.1081
 Site-White_utk                 (3) | Val  Loss: 2.0438 | Val  Acc: 0.1636
 Site-White_utk                 (3) | Val  Loss: 2.0795 | Val  Acc: 0.1728
 Site-White_utk                 (3) | Val  Loss: 2.0841 | Val  Acc: 0.1681
 Site-White_utk                 (3) | Val  Loss: 2.0668 | Val  Acc: 0.1714
 Site-White_utk                 (3) | Val  Loss: 2.0948 | Val  Acc: 0.1822
 Site-East_Asian                (2) | Val  Loss: 1.9626 | Val  Acc: 0.2222
 Site-East_Asian                (2) | Val  Loss: 1.8013 | Val  Acc: 0.3846
 Site-East_Asian                (2) | Val  Loss: 1.8119 | Val  Acc: 0.3846
 Site-East_Asian                (2) | Val  Loss: 1.7718 | Val  Acc: 0.3158
 Site-East_Asian                (2) | Val  Loss: 1.8270 | Val  Acc: 0.4000
 Site-East_Asian                (2) | Val  Loss: 1.7384 | Val  Acc: 0.4400
 Site-East_Asian                (2) | Val  Loss: 1.7772 | Val  Acc: 0.3913
 Site-Indian_utk                (1) | Val  Loss: 1.8128 | Val  Acc: 0.3793
 Site-Indian_utk                (1) | Val  Loss: 1.8197 | Val  Acc: 0.3721
 Site-Indian_utk                (1) | Val  Loss: 1.8239 | Val  Acc: 0.4444
 Site-Indian_utk                (1) | Val  Loss: 1.8778 | Val  Acc: 0.3696
 Site-Indian_utk                (1) | Val  Loss: 1.7324 | Val  Acc: 0.3750
 Site-Black_utk                 (1) | Val  Loss: 1.8003 | Val  Acc: 0.5000
 Site-Black_utk                 (1) | Val  Loss: 1.8639 | Val  Acc: 0.3519
 Site-Black_utk                 (1) | Val  Loss: 1.8289 | Val  Acc: 0.3418
 Site-Southeast_Asian           (2) | Val  Loss: 2.0669 | Val  Acc: 0.2794
 Site-Southeast_Asian           (2) | Val  Loss: 1.9478 | Val  Acc: 0.2900
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.7798 | Val  Acc: 0.2783
 Site-White_ffhq                (0) | Val  Loss: 1.3181 | Val  Acc: 0.7436
Average Valid Accuracy: 0.3182
 Best site-White_utk                (5)  | Epoch:5 | Val Acc: 0.2500
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2727
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2353
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2400
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1081
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1636
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1728
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1681
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1714
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1822
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.2222
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3846
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3846
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3158
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4000
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4400
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3913
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3793
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3721
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.4444
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3696
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3750
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.5000
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.3519
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.3418
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.2794
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.2900
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:5 | Val Acc: 0.2783
 Best site-White_ffhq               (0)  | Epoch:5 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 3, 9, 1, 2, 13, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White_utk                 (0) | Train Loss: 1.6880 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 1.8750 | Train Acc: 0.2353
 Site-White_utk                 (5) | Train Loss: 1.9976 | Train Acc: 0.2308
 Site-White_utk                 (3) | Train Loss: 2.0307 | Train Acc: 0.2105
 Site-White_utk                 (5) | Train Loss: 1.9799 | Train Acc: 0.2143
 Site-White_utk                 (5) | Train Loss: 1.9653 | Train Acc: 0.2317
 Site-White_utk                 (5) | Train Loss: 1.9573 | Train Acc: 0.2479
 Site-White_utk                 (5) | Train Loss: 1.9949 | Train Acc: 0.2235
 Site-White_utk                 (5) | Train Loss: 1.9745 | Train Acc: 0.2357
 Site-White_utk                 (5) | Train Loss: 1.9650 | Train Acc: 0.2429
 Site-East_Asian                (2) | Train Loss: 1.6866 | Train Acc: 0.3704
 Site-East_Asian                (2) | Train Loss: 1.7484 | Train Acc: 0.4000
 Site-East_Asian                (2) | Train Loss: 1.7846 | Train Acc: 0.3898
 Site-East_Asian                (2) | Train Loss: 1.7878 | Train Acc: 0.3605
 Site-East_Asian                (2) | Train Loss: 1.7616 | Train Acc: 0.4016
 Site-East_Asian                (2) | Train Loss: 1.7909 | Train Acc: 0.3369
 Site-East_Asian                (2) | Train Loss: 1.7213 | Train Acc: 0.4130
 Site-Indian_utk                (5) | Train Loss: 1.8374 | Train Acc: 0.3488
 Site-Indian_utk                (5) | Train Loss: 1.7679 | Train Acc: 0.3750
 Site-Indian_utk                (5) | Train Loss: 1.8227 | Train Acc: 0.3404
 Site-Indian_utk                (5) | Train Loss: 1.8339 | Train Acc: 0.3453
 Site-Indian_utk                (5) | Train Loss: 1.8218 | Train Acc: 0.3561
 Site-Black_utk                 (1) | Train Loss: 1.7610 | Train Acc: 0.4364
 Site-Black_utk                 (1) | Train Loss: 1.8747 | Train Acc: 0.2593
 Site-Black_utk                 (1) | Train Loss: 1.8592 | Train Acc: 0.3445
 Site-Southeast_Asian           (2) | Train Loss: 1.9284 | Train Acc: 0.3137
 Site-Southeast_Asian           (2) | Train Loss: 1.9134 | Train Acc: 0.2867
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5102 | Train Acc: 0.5291
 Site-White_ffhq                (4) | Train Loss: 1.5433 | Train Acc: 0.4872
Average Train Accuracy: 0.3276
 Site-White_utk                 (0) | Val  Loss: 1.8880 | Val  Acc: 0.1250
 Site-White_utk                 (5) | Val  Loss: 1.9189 | Val  Acc: 0.2727
 Site-White_utk                 (5) | Val  Loss: 1.9868 | Val  Acc: 0.2353
 Site-White_utk                 (3) | Val  Loss: 2.0185 | Val  Acc: 0.2800
 Site-White_utk                 (5) | Val  Loss: 1.9750 | Val  Acc: 0.1892
 Site-White_utk                 (5) | Val  Loss: 1.9763 | Val  Acc: 0.2182
 Site-White_utk                 (5) | Val  Loss: 2.0495 | Val  Acc: 0.1975
 Site-White_utk                 (5) | Val  Loss: 1.9803 | Val  Acc: 0.2269
 Site-White_utk                 (5) | Val  Loss: 2.0072 | Val  Acc: 0.2057
 Site-White_utk                 (5) | Val  Loss: 2.0318 | Val  Acc: 0.2093
 Site-East_Asian                (2) | Val  Loss: 1.8731 | Val  Acc: 0.2222
 Site-East_Asian                (2) | Val  Loss: 1.7686 | Val  Acc: 0.4231
 Site-East_Asian                (2) | Val  Loss: 1.8093 | Val  Acc: 0.3846
 Site-East_Asian                (2) | Val  Loss: 1.7702 | Val  Acc: 0.3509
 Site-East_Asian                (2) | Val  Loss: 1.7807 | Val  Acc: 0.4000
 Site-East_Asian                (2) | Val  Loss: 1.7355 | Val  Acc: 0.4080
 Site-East_Asian                (2) | Val  Loss: 1.7366 | Val  Acc: 0.4402
 Site-Indian_utk                (5) | Val  Loss: 1.7849 | Val  Acc: 0.3103
 Site-Indian_utk                (5) | Val  Loss: 1.8447 | Val  Acc: 0.3256
 Site-Indian_utk                (5) | Val  Loss: 1.7866 | Val  Acc: 0.3968
 Site-Indian_utk                (5) | Val  Loss: 1.8931 | Val  Acc: 0.3478
 Site-Indian_utk                (5) | Val  Loss: 1.7372 | Val  Acc: 0.3603
 Site-Black_utk                 (1) | Val  Loss: 1.8840 | Val  Acc: 0.3889
 Site-Black_utk                 (1) | Val  Loss: 1.8475 | Val  Acc: 0.3333
 Site-Black_utk                 (1) | Val  Loss: 1.8169 | Val  Acc: 0.3418
 Site-Southeast_Asian           (2) | Val  Loss: 1.9688 | Val  Acc: 0.2647
 Site-Southeast_Asian           (2) | Val  Loss: 1.9664 | Val  Acc: 0.3300
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.7740 | Val  Acc: 0.3391
 Site-White_ffhq                (4) | Val  Loss: 1.4765 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3144
============ Train epoch 7 ============
cnt=[8, 1, 2, 8, 1, 9, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White_utk                 (4) | Train Loss: 1.6741 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 1.9497 | Train Acc: 0.2353
 Site-White_utk                 (5) | Train Loss: 1.9662 | Train Acc: 0.1923
 Site-White_utk                 (5) | Train Loss: 2.0286 | Train Acc: 0.2105
 Site-White_utk                 (5) | Train Loss: 1.9326 | Train Acc: 0.2679
 Site-White_utk                 (5) | Train Loss: 1.9290 | Train Acc: 0.1829
 Site-White_utk                 (5) | Train Loss: 1.9840 | Train Acc: 0.2149
 Site-White_utk                 (5) | Train Loss: 2.0199 | Train Acc: 0.2067
 Site-White_utk                 (5) | Train Loss: 1.8750 | Train Acc: 0.2167
 Site-White_utk                 (5) | Train Loss: 2.0378 | Train Acc: 0.2248
 Site-East_Asian                (1) | Train Loss: 1.6361 | Train Acc: 0.3704
 Site-East_Asian                (3) | Train Loss: 1.6506 | Train Acc: 0.4750
 Site-East_Asian                (3) | Train Loss: 1.7428 | Train Acc: 0.3390
 Site-East_Asian                (3) | Train Loss: 1.8595 | Train Acc: 0.3372
 Site-East_Asian                (3) | Train Loss: 1.7096 | Train Acc: 0.4173
 Site-East_Asian                (3) | Train Loss: 1.7499 | Train Acc: 0.3690
 Site-East_Asian                (3) | Train Loss: 1.7025 | Train Acc: 0.3949
 Site-Indian_utk                (0) | Train Loss: 1.7767 | Train Acc: 0.3721
 Site-Indian_utk                (0) | Train Loss: 1.7346 | Train Acc: 0.4375
 Site-Indian_utk                (0) | Train Loss: 1.7575 | Train Acc: 0.3617
 Site-Indian_utk                (0) | Train Loss: 1.7858 | Train Acc: 0.3957
 Site-Indian_utk                (0) | Train Loss: 1.7521 | Train Acc: 0.4098
 Site-Black_utk                 (0) | Train Loss: 1.6680 | Train Acc: 0.4545
 Site-Black_utk                 (0) | Train Loss: 1.7893 | Train Acc: 0.3457
 Site-Black_utk                 (0) | Train Loss: 1.8077 | Train Acc: 0.3277
 Site-Southeast_Asian           (3) | Train Loss: 1.9422 | Train Acc: 0.3137
 Site-Southeast_Asian           (3) | Train Loss: 1.9090 | Train Acc: 0.3267
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3841 | Train Acc: 0.4884
 Site-White_ffhq                (2) | Train Loss: 1.3792 | Train Acc: 0.5983
Average Train Accuracy: 0.3386
 Site-White_utk                 (4) | Val  Loss: 1.8650 | Val  Acc: 0.2500
 Site-White_utk                 (5) | Val  Loss: 2.0143 | Val  Acc: 0.2727
 Site-White_utk                 (5) | Val  Loss: 2.0054 | Val  Acc: 0.2353
 Site-White_utk                 (5) | Val  Loss: 2.0092 | Val  Acc: 0.2800
 Site-White_utk                 (5) | Val  Loss: 1.9448 | Val  Acc: 0.2162
 Site-White_utk                 (5) | Val  Loss: 2.0252 | Val  Acc: 0.1818
 Site-White_utk                 (5) | Val  Loss: 2.0285 | Val  Acc: 0.2099
 Site-White_utk                 (5) | Val  Loss: 2.0121 | Val  Acc: 0.1933
 Site-White_utk                 (5) | Val  Loss: 2.0218 | Val  Acc: 0.2000
 Site-White_utk                 (5) | Val  Loss: 2.0844 | Val  Acc: 0.2054
 Site-East_Asian                (1) | Val  Loss: 1.9349 | Val  Acc: 0.2222
 Site-East_Asian                (3) | Val  Loss: 1.7187 | Val  Acc: 0.3846
 Site-East_Asian                (3) | Val  Loss: 1.7369 | Val  Acc: 0.4359
 Site-East_Asian                (3) | Val  Loss: 1.6845 | Val  Acc: 0.3684
 Site-East_Asian                (3) | Val  Loss: 1.7392 | Val  Acc: 0.4235
 Site-East_Asian                (3) | Val  Loss: 1.6587 | Val  Acc: 0.4320
 Site-East_Asian                (3) | Val  Loss: 1.7114 | Val  Acc: 0.4076
 Site-Indian_utk                (0) | Val  Loss: 1.7413 | Val  Acc: 0.4138
 Site-Indian_utk                (0) | Val  Loss: 1.7409 | Val  Acc: 0.3953
 Site-Indian_utk                (0) | Val  Loss: 1.7436 | Val  Acc: 0.4127
 Site-Indian_utk                (0) | Val  Loss: 1.7826 | Val  Acc: 0.3804
 Site-Indian_utk                (0) | Val  Loss: 1.6643 | Val  Acc: 0.3971
 Site-Black_utk                 (0) | Val  Loss: 1.7888 | Val  Acc: 0.5000
 Site-Black_utk                 (0) | Val  Loss: 1.8154 | Val  Acc: 0.3704
 Site-Black_utk                 (0) | Val  Loss: 1.7752 | Val  Acc: 0.3165
 Site-Southeast_Asian           (3) | Val  Loss: 2.0728 | Val  Acc: 0.2941
 Site-Southeast_Asian           (3) | Val  Loss: 1.9281 | Val  Acc: 0.3200
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.7465 | Val  Acc: 0.2348
 Site-White_ffhq                (2) | Val  Loss: 1.2488 | Val  Acc: 0.7692
Average Valid Accuracy: 0.3353
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2500
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2727
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2353
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2800
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2162
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.1818
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2099
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.1933
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2000
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2054
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.2222
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.3846
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4359
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.3684
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4235
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4320
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4076
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.4138
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.3953
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.4127
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.3804
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.3971
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.5000
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3704
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3165
 Best site-Southeast_Asian          (3)  | Epoch:7 | Val Acc: 0.2941
 Best site-Southeast_Asian          (3)  | Epoch:7 | Val Acc: 0.3200
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:7 | Val Acc: 0.2348
 Best site-White_ffhq               (2)  | Epoch:7 | Val Acc: 0.7692
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 1, 10, 8, 2, 7, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White_utk                 (2) | Train Loss: 1.6161 | Train Acc: 0.3333
 Site-White_utk                 (2) | Train Loss: 1.8366 | Train Acc: 0.2353
 Site-White_utk                 (2) | Train Loss: 1.9203 | Train Acc: 0.1923
 Site-White_utk                 (2) | Train Loss: 2.0072 | Train Acc: 0.1842
 Site-White_utk                 (2) | Train Loss: 1.9019 | Train Acc: 0.2500
 Site-White_utk                 (2) | Train Loss: 1.9267 | Train Acc: 0.2317
 Site-White_utk                 (2) | Train Loss: 1.9333 | Train Acc: 0.2149
 Site-White_utk                 (2) | Train Loss: 1.9805 | Train Acc: 0.2123
 Site-White_utk                 (2) | Train Loss: 1.9875 | Train Acc: 0.2205
 Site-White_utk                 (2) | Train Loss: 1.9667 | Train Acc: 0.2119
 Site-East_Asian                (1) | Train Loss: 1.6032 | Train Acc: 0.4815
 Site-East_Asian                (3) | Train Loss: 1.5962 | Train Acc: 0.5250
 Site-East_Asian                (3) | Train Loss: 1.7466 | Train Acc: 0.3729
 Site-East_Asian                (3) | Train Loss: 1.7587 | Train Acc: 0.3605
 Site-East_Asian                (3) | Train Loss: 1.6839 | Train Acc: 0.4173
 Site-East_Asian                (3) | Train Loss: 1.6868 | Train Acc: 0.3904
 Site-East_Asian                (3) | Train Loss: 1.6794 | Train Acc: 0.4130
 Site-Indian_utk                (0) | Train Loss: 1.7041 | Train Acc: 0.3721
 Site-Indian_utk                (5) | Train Loss: 1.6451 | Train Acc: 0.4531
 Site-Indian_utk                (5) | Train Loss: 1.7717 | Train Acc: 0.3617
 Site-Indian_utk                (5) | Train Loss: 1.6929 | Train Acc: 0.3885
 Site-Indian_utk                (5) | Train Loss: 1.7528 | Train Acc: 0.4244
 Site-Black_utk                 (5) | Train Loss: 1.6807 | Train Acc: 0.4000
 Site-Black_utk                 (5) | Train Loss: 1.8267 | Train Acc: 0.3457
 Site-Black_utk                 (5) | Train Loss: 1.7798 | Train Acc: 0.3109
 Site-Southeast_Asian           (3) | Train Loss: 1.8890 | Train Acc: 0.3627
 Site-Southeast_Asian           (3) | Train Loss: 1.9167 | Train Acc: 0.3267
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.4302 | Train Acc: 0.4651
 Site-White_ffhq                (4) | Train Loss: 1.3522 | Train Acc: 0.6838
Average Train Accuracy: 0.3497
 Site-White_utk                 (2) | Val  Loss: 1.8782 | Val  Acc: 0.2500
 Site-White_utk                 (2) | Val  Loss: 1.8925 | Val  Acc: 0.2727
 Site-White_utk                 (2) | Val  Loss: 1.9617 | Val  Acc: 0.1765
 Site-White_utk                 (2) | Val  Loss: 1.9590 | Val  Acc: 0.3200
 Site-White_utk                 (2) | Val  Loss: 1.9102 | Val  Acc: 0.2432
 Site-White_utk                 (2) | Val  Loss: 1.9675 | Val  Acc: 0.2000
 Site-White_utk                 (2) | Val  Loss: 2.0067 | Val  Acc: 0.2099
 Site-White_utk                 (2) | Val  Loss: 1.9648 | Val  Acc: 0.2101
 Site-White_utk                 (2) | Val  Loss: 1.9918 | Val  Acc: 0.2000
 Site-White_utk                 (2) | Val  Loss: 2.0032 | Val  Acc: 0.2132
 Site-East_Asian                (1) | Val  Loss: 1.8619 | Val  Acc: 0.2778
 Site-East_Asian                (3) | Val  Loss: 1.6395 | Val  Acc: 0.4231
 Site-East_Asian                (3) | Val  Loss: 1.7270 | Val  Acc: 0.4103
 Site-East_Asian                (3) | Val  Loss: 1.6499 | Val  Acc: 0.4211
 Site-East_Asian                (3) | Val  Loss: 1.7078 | Val  Acc: 0.4118
 Site-East_Asian                (3) | Val  Loss: 1.6422 | Val  Acc: 0.4480
 Site-East_Asian                (3) | Val  Loss: 1.6901 | Val  Acc: 0.4022
 Site-Indian_utk                (0) | Val  Loss: 1.7865 | Val  Acc: 0.3793
 Site-Indian_utk                (5) | Val  Loss: 1.6779 | Val  Acc: 0.3721
 Site-Indian_utk                (5) | Val  Loss: 1.7220 | Val  Acc: 0.4286
 Site-Indian_utk                (5) | Val  Loss: 1.7669 | Val  Acc: 0.3804
 Site-Indian_utk                (5) | Val  Loss: 1.6518 | Val  Acc: 0.3971
 Site-Black_utk                 (5) | Val  Loss: 1.7665 | Val  Acc: 0.5000
 Site-Black_utk                 (5) | Val  Loss: 1.7586 | Val  Acc: 0.3704
 Site-Black_utk                 (5) | Val  Loss: 1.7250 | Val  Acc: 0.3291
 Site-Southeast_Asian           (3) | Val  Loss: 2.0074 | Val  Acc: 0.3382
 Site-Southeast_Asian           (3) | Val  Loss: 1.9049 | Val  Acc: 0.3400
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.7943 | Val  Acc: 0.2174
 Site-White_ffhq                (4) | Val  Loss: 1.1691 | Val  Acc: 0.8333
Average Valid Accuracy: 0.3440
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2500
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2727
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.1765
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3200
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2432
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2000
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2099
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2101
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2000
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2132
 Best site-East_Asian               (1)  | Epoch:8 | Val Acc: 0.2778
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4231
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4103
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4211
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4118
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4480
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4022
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.3793
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.3721
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.4286
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.3804
 Best site-Indian_utk               (5)  | Epoch:8 | Val Acc: 0.3971
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.5000
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.3704
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.3291
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.3382
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.3400
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:8 | Val Acc: 0.2174
 Best site-White_ffhq               (4)  | Epoch:8 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 9, 5, 11, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White_utk                 (5) | Train Loss: 1.5142 | Train Acc: 0.4167
 Site-White_utk                 (4) | Train Loss: 1.8096 | Train Acc: 0.3529
 Site-White_utk                 (4) | Train Loss: 1.7885 | Train Acc: 0.2692
 Site-White_utk                 (4) | Train Loss: 1.9146 | Train Acc: 0.1842
 Site-White_utk                 (1) | Train Loss: 1.8086 | Train Acc: 0.3393
 Site-White_utk                 (4) | Train Loss: 1.8983 | Train Acc: 0.3415
 Site-White_utk                 (4) | Train Loss: 1.8445 | Train Acc: 0.2645
 Site-White_utk                 (4) | Train Loss: 1.8708 | Train Acc: 0.2793
 Site-White_utk                 (4) | Train Loss: 1.8318 | Train Acc: 0.2624
 Site-White_utk                 (4) | Train Loss: 1.8449 | Train Acc: 0.3049
 Site-East_Asian                (2) | Train Loss: 1.5271 | Train Acc: 0.5556
 Site-East_Asian                (2) | Train Loss: 1.6178 | Train Acc: 0.4250
 Site-East_Asian                (2) | Train Loss: 1.7726 | Train Acc: 0.3390
 Site-East_Asian                (2) | Train Loss: 1.7054 | Train Acc: 0.3605
 Site-East_Asian                (2) | Train Loss: 1.7048 | Train Acc: 0.4567
 Site-East_Asian                (2) | Train Loss: 1.7096 | Train Acc: 0.3957
 Site-East_Asian                (2) | Train Loss: 1.6598 | Train Acc: 0.4420
 Site-Indian_utk                (3) | Train Loss: 1.6802 | Train Acc: 0.4651
 Site-Indian_utk                (3) | Train Loss: 1.6978 | Train Acc: 0.4688
 Site-Indian_utk                (3) | Train Loss: 1.7846 | Train Acc: 0.3191
 Site-Indian_utk                (3) | Train Loss: 1.7254 | Train Acc: 0.4173
 Site-Indian_utk                (3) | Train Loss: 1.7162 | Train Acc: 0.4244
 Site-Black_utk                 (4) | Train Loss: 1.6871 | Train Acc: 0.4182
 Site-Black_utk                 (4) | Train Loss: 1.7077 | Train Acc: 0.3086
 Site-Black_utk                 (4) | Train Loss: 1.8463 | Train Acc: 0.3529
 Site-Southeast_Asian           (2) | Train Loss: 1.8870 | Train Acc: 0.3824
 Site-Southeast_Asian           (2) | Train Loss: 1.8519 | Train Acc: 0.3667
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.5858 | Train Acc: 0.4826
 Site-White_ffhq                (0) | Train Loss: 1.5674 | Train Acc: 0.4957
Average Train Accuracy: 0.3756
 Site-White_utk                 (5) | Val  Loss: 1.7763 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 1.7735 | Val  Acc: 0.3636
 Site-White_utk                 (4) | Val  Loss: 1.8365 | Val  Acc: 0.2353
 Site-White_utk                 (4) | Val  Loss: 1.8570 | Val  Acc: 0.2400
 Site-White_utk                 (1) | Val  Loss: 1.8476 | Val  Acc: 0.2703
 Site-White_utk                 (4) | Val  Loss: 1.8532 | Val  Acc: 0.2909
 Site-White_utk                 (4) | Val  Loss: 1.9378 | Val  Acc: 0.2346
 Site-White_utk                 (4) | Val  Loss: 1.8697 | Val  Acc: 0.2521
 Site-White_utk                 (4) | Val  Loss: 1.8928 | Val  Acc: 0.2857
 Site-White_utk                 (4) | Val  Loss: 1.8702 | Val  Acc: 0.2752
 Site-East_Asian                (2) | Val  Loss: 1.7458 | Val  Acc: 0.3333
 Site-East_Asian                (2) | Val  Loss: 1.7213 | Val  Acc: 0.3462
 Site-East_Asian                (2) | Val  Loss: 1.7045 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.6938 | Val  Acc: 0.3509
 Site-East_Asian                (2) | Val  Loss: 1.7266 | Val  Acc: 0.4235
 Site-East_Asian                (2) | Val  Loss: 1.6656 | Val  Acc: 0.5120
 Site-East_Asian                (2) | Val  Loss: 1.6761 | Val  Acc: 0.4783
 Site-Indian_utk                (3) | Val  Loss: 1.6957 | Val  Acc: 0.4138
 Site-Indian_utk                (3) | Val  Loss: 1.6853 | Val  Acc: 0.4884
 Site-Indian_utk                (3) | Val  Loss: 1.7409 | Val  Acc: 0.3492
 Site-Indian_utk                (3) | Val  Loss: 1.7808 | Val  Acc: 0.4130
 Site-Indian_utk                (3) | Val  Loss: 1.6747 | Val  Acc: 0.4118
 Site-Black_utk                 (4) | Val  Loss: 1.8008 | Val  Acc: 0.4444
 Site-Black_utk                 (4) | Val  Loss: 1.8271 | Val  Acc: 0.3333
 Site-Black_utk                 (4) | Val  Loss: 1.7779 | Val  Acc: 0.3924
 Site-Southeast_Asian           (2) | Val  Loss: 1.9378 | Val  Acc: 0.3088
 Site-Southeast_Asian           (2) | Val  Loss: 1.8697 | Val  Acc: 0.3300
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.8344 | Val  Acc: 0.2870
 Site-White_ffhq                (0) | Val  Loss: 1.5073 | Val  Acc: 0.6410
Average Valid Accuracy: 0.3549
 Best site-White_utk                (5)  | Epoch:9 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3636
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2353
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2400
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.2703
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2909
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2346
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2521
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2857
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2752
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.3333
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.3462
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4615
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.3509
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4235
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.5120
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4783
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4138
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4884
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.3492
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4130
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4118
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.4444
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.3333
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.3924
 Best site-Southeast_Asian          (2)  | Epoch:9 | Val Acc: 0.3088
 Best site-Southeast_Asian          (2)  | Epoch:9 | Val Acc: 0.3300
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:9 | Val Acc: 0.2870
 Best site-White_ffhq               (0)  | Epoch:9 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Test site-White_utk                 (5)| Epoch:9 | Test Acc: 0.2970
 Test site-East_Asian                (2)| Epoch:9 | Test Acc: 0.4269
 Test site-Indian_utk                (3)| Epoch:9 | Test Acc: 0.4229
 Test site-Black_utk                 (4)| Epoch:9 | Test Acc: 0.3061
 Test site-Southeast_Asian           (2)| Epoch:9 | Test Acc: 0.3830
 Test site-Latino_Hispanic_ffhq      (0)| Epoch:9 | Test Acc: 0.2537
 Test site-White_ffhq                (0)| Epoch:9 | Test Acc: 0.2741
White_utk: 0.2970, East_Asian: 0.4269, Indian_utk: 0.4229, Black_utk: 0.3061, Southeast_Asian: 0.3830, Latino_Hispanic_ffhq: 0.2537, White_ffhq: 0.2741, 
Average Test Accuracy(group): 0.3377, Average Test Accuracy(individual): 0.3547,
domain CV=0.1971, cluster CV=nan, individual CV=0.1801, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
===2023-06-15 13:53:10===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 15
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 8, 16, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (0) | Train Loss: 2.1346 | Train Acc: 0.1667
 Site-White_utk                 (4) | Train Loss: 2.1999 | Train Acc: 0.1176
 Site-White_utk                 (4) | Train Loss: 2.3304 | Train Acc: 0.1154
 Site-White_utk                 (4) | Train Loss: 2.2945 | Train Acc: 0.0789
 Site-White_utk                 (4) | Train Loss: 2.2714 | Train Acc: 0.0893
 Site-White_utk                 (4) | Train Loss: 2.2489 | Train Acc: 0.1341
 Site-White_utk                 (4) | Train Loss: 2.2057 | Train Acc: 0.1240
 Site-White_utk                 (4) | Train Loss: 2.2391 | Train Acc: 0.1229
 Site-White_utk                 (4) | Train Loss: 2.2783 | Train Acc: 0.0989
 Site-White_utk                 (4) | Train Loss: 2.2366 | Train Acc: 0.1189
 Site-East_Asian                (3) | Train Loss: 1.9104 | Train Acc: 0.4815
 Site-East_Asian                (3) | Train Loss: 1.9713 | Train Acc: 0.4750
 Site-East_Asian                (2) | Train Loss: 1.9704 | Train Acc: 0.3390
 Site-East_Asian                (3) | Train Loss: 1.9859 | Train Acc: 0.3721
 Site-East_Asian                (3) | Train Loss: 1.9761 | Train Acc: 0.3780
 Site-East_Asian                (3) | Train Loss: 1.9928 | Train Acc: 0.3102
 Site-East_Asian                (3) | Train Loss: 1.9373 | Train Acc: 0.3732
 Site-Indian_utk                (5) | Train Loss: 2.0500 | Train Acc: 0.3256
 Site-Indian_utk                (4) | Train Loss: 1.9709 | Train Acc: 0.3750
 Site-Indian_utk                (4) | Train Loss: 2.0599 | Train Acc: 0.2660
 Site-Indian_utk                (4) | Train Loss: 2.0041 | Train Acc: 0.2878
 Site-Indian_utk                (4) | Train Loss: 2.0759 | Train Acc: 0.3024
 Site-Black_utk                 (4) | Train Loss: 2.0064 | Train Acc: 0.2909
 Site-Black_utk                 (4) | Train Loss: 2.0331 | Train Acc: 0.2469
 Site-Black_utk                 (4) | Train Loss: 2.0878 | Train Acc: 0.2437
 Site-Southeast_Asian           (3) | Train Loss: 2.0789 | Train Acc: 0.3137
 Site-Southeast_Asian           (3) | Train Loss: 2.0902 | Train Acc: 0.2600
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.6731 | Train Acc: 0.4709
 Site-White_ffhq                (1) | Train Loss: 1.6446 | Train Acc: 0.7179
Average Train Accuracy: 0.2757
 Site-White_utk                 (0) | Val  Loss: 2.2015 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.3058 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.2570 | Val  Acc: 0.1176
 Site-White_utk                 (4) | Val  Loss: 2.2297 | Val  Acc: 0.1600
 Site-White_utk                 (4) | Val  Loss: 2.2485 | Val  Acc: 0.1081
 Site-White_utk                 (4) | Val  Loss: 2.1859 | Val  Acc: 0.1091
 Site-White_utk                 (4) | Val  Loss: 2.1977 | Val  Acc: 0.0741
 Site-White_utk                 (4) | Val  Loss: 2.2552 | Val  Acc: 0.1008
 Site-White_utk                 (4) | Val  Loss: 2.2290 | Val  Acc: 0.1143
 Site-White_utk                 (4) | Val  Loss: 2.3147 | Val  Acc: 0.1202
 Site-East_Asian                (3) | Val  Loss: 2.1320 | Val  Acc: 0.1667
 Site-East_Asian                (3) | Val  Loss: 2.0120 | Val  Acc: 0.3462
 Site-East_Asian                (2) | Val  Loss: 1.9945 | Val  Acc: 0.3333
 Site-East_Asian                (3) | Val  Loss: 1.9647 | Val  Acc: 0.3333
 Site-East_Asian                (3) | Val  Loss: 1.9792 | Val  Acc: 0.3529
 Site-East_Asian                (3) | Val  Loss: 1.9380 | Val  Acc: 0.3840
 Site-East_Asian                (3) | Val  Loss: 1.9669 | Val  Acc: 0.3641
 Site-Indian_utk                (5) | Val  Loss: 2.0064 | Val  Acc: 0.3448
 Site-Indian_utk                (4) | Val  Loss: 2.0740 | Val  Acc: 0.2558
 Site-Indian_utk                (4) | Val  Loss: 2.0554 | Val  Acc: 0.3175
 Site-Indian_utk                (4) | Val  Loss: 2.0783 | Val  Acc: 0.2935
 Site-Indian_utk                (4) | Val  Loss: 1.9727 | Val  Acc: 0.3603
 Site-Black_utk                 (4) | Val  Loss: 2.0203 | Val  Acc: 0.3056
 Site-Black_utk                 (4) | Val  Loss: 2.0368 | Val  Acc: 0.2778
 Site-Black_utk                 (4) | Val  Loss: 1.9980 | Val  Acc: 0.3038
 Site-Southeast_Asian           (3) | Val  Loss: 2.2813 | Val  Acc: 0.2353
 Site-Southeast_Asian           (3) | Val  Loss: 2.1025 | Val  Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.9589 | Val  Acc: 0.2087
 Site-White_ffhq                (1) | Val  Loss: 1.5250 | Val  Acc: 0.8077
Average Valid Accuracy: 0.2549
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0909
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1176
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1600
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1081
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1091
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0741
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1008
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1143
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1202
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.1667
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3462
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3333
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3529
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3840
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3641
 Best site-Indian_utk               (5)  | Epoch:0 | Val Acc: 0.3448
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.2558
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3175
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.2935
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3603
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3056
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.2778
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3038
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2353
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2800
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:0 | Val Acc: 0.2087
 Best site-White_ffhq               (1)  | Epoch:0 | Val Acc: 0.8077
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 9, 2, 13, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (3) | Train Loss: 2.0572 | Train Acc: 0.0833
 Site-White_utk                 (5) | Train Loss: 2.3124 | Train Acc: 0.1176
 Site-White_utk                 (3) | Train Loss: 2.3474 | Train Acc: 0.1154
 Site-White_utk                 (3) | Train Loss: 2.3601 | Train Acc: 0.1053
 Site-White_utk                 (0) | Train Loss: 2.3142 | Train Acc: 0.1071
 Site-White_utk                 (3) | Train Loss: 2.3300 | Train Acc: 0.1098
 Site-White_utk                 (3) | Train Loss: 2.3137 | Train Acc: 0.0992
 Site-White_utk                 (3) | Train Loss: 2.3002 | Train Acc: 0.1117
 Site-White_utk                 (3) | Train Loss: 2.1967 | Train Acc: 0.0989
 Site-White_utk                 (3) | Train Loss: 2.3545 | Train Acc: 0.1085
 Site-East_Asian                (1) | Train Loss: 1.8297 | Train Acc: 0.4074
 Site-East_Asian                (1) | Train Loss: 1.8248 | Train Acc: 0.4750
 Site-East_Asian                (1) | Train Loss: 1.8457 | Train Acc: 0.3898
 Site-East_Asian                (1) | Train Loss: 2.0082 | Train Acc: 0.3488
 Site-East_Asian                (1) | Train Loss: 1.8665 | Train Acc: 0.3937
 Site-East_Asian                (1) | Train Loss: 1.8910 | Train Acc: 0.3422
 Site-East_Asian                (1) | Train Loss: 1.8167 | Train Acc: 0.3877
 Site-Indian_utk                (3) | Train Loss: 1.9767 | Train Acc: 0.3256
 Site-Indian_utk                (3) | Train Loss: 1.8822 | Train Acc: 0.3906
 Site-Indian_utk                (3) | Train Loss: 1.9697 | Train Acc: 0.3404
 Site-Indian_utk                (3) | Train Loss: 1.9025 | Train Acc: 0.3381
 Site-Indian_utk                (3) | Train Loss: 1.9475 | Train Acc: 0.3415
 Site-Black_utk                 (4) | Train Loss: 1.8805 | Train Acc: 0.3636
 Site-Black_utk                 (4) | Train Loss: 2.0319 | Train Acc: 0.3086
 Site-Black_utk                 (4) | Train Loss: 1.9376 | Train Acc: 0.3277
 Site-Southeast_Asian           (1) | Train Loss: 2.0011 | Train Acc: 0.3137
 Site-Southeast_Asian           (1) | Train Loss: 2.0341 | Train Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.4661 | Train Acc: 0.4767
 Site-White_ffhq                (2) | Train Loss: 1.4225 | Train Acc: 0.7863
Average Train Accuracy: 0.2895
 Site-White_utk                 (3) | Val  Loss: 2.2690 | Val  Acc: 0.1250
 Site-White_utk                 (5) | Val  Loss: 2.2926 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.2641 | Val  Acc: 0.1176
 Site-White_utk                 (3) | Val  Loss: 2.3369 | Val  Acc: 0.1200
 Site-White_utk                 (0) | Val  Loss: 2.2879 | Val  Acc: 0.1351
 Site-White_utk                 (3) | Val  Loss: 2.2883 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.2826 | Val  Acc: 0.0864
 Site-White_utk                 (3) | Val  Loss: 2.3048 | Val  Acc: 0.1008
 Site-White_utk                 (3) | Val  Loss: 2.2960 | Val  Acc: 0.1143
 Site-White_utk                 (3) | Val  Loss: 2.3823 | Val  Acc: 0.1008
 Site-East_Asian                (1) | Val  Loss: 2.1124 | Val  Acc: 0.2222
 Site-East_Asian                (1) | Val  Loss: 1.8831 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.8941 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.8364 | Val  Acc: 0.3509
 Site-East_Asian                (1) | Val  Loss: 1.9094 | Val  Acc: 0.4118
 Site-East_Asian                (1) | Val  Loss: 1.8289 | Val  Acc: 0.4080
 Site-East_Asian                (1) | Val  Loss: 1.8642 | Val  Acc: 0.3750
 Site-Indian_utk                (3) | Val  Loss: 1.9693 | Val  Acc: 0.2759
 Site-Indian_utk                (3) | Val  Loss: 1.9936 | Val  Acc: 0.3488
 Site-Indian_utk                (3) | Val  Loss: 1.9583 | Val  Acc: 0.3651
 Site-Indian_utk                (3) | Val  Loss: 1.9353 | Val  Acc: 0.3370
 Site-Indian_utk                (3) | Val  Loss: 1.8681 | Val  Acc: 0.3750
 Site-Black_utk                 (4) | Val  Loss: 1.9072 | Val  Acc: 0.3333
 Site-Black_utk                 (4) | Val  Loss: 1.9088 | Val  Acc: 0.3704
 Site-Black_utk                 (4) | Val  Loss: 1.9294 | Val  Acc: 0.3291
 Site-Southeast_Asian           (1) | Val  Loss: 2.2727 | Val  Acc: 0.2794
 Site-Southeast_Asian           (1) | Val  Loss: 2.0605 | Val  Acc: 0.2900
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8681 | Val  Acc: 0.1652
 Site-White_ffhq                (2) | Val  Loss: 1.2223 | Val  Acc: 0.9487
Average Valid Accuracy: 0.2785
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1250
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1176
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1200
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1351
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0864
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1008
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1143
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1008
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.2222
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3846
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3509
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4118
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4080
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3750
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.2759
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3488
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3651
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3370
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3750
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3333
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3704
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3291
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2794
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2900
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:1 | Val Acc: 0.1652
 Best site-White_ffhq               (2)  | Epoch:1 | Val Acc: 0.9487
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 9, 2, 8, 8, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk                 (5) | Train Loss: 1.9236 | Train Acc: 0.2500
 Site-White_utk                 (4) | Train Loss: 2.1298 | Train Acc: 0.1176
 Site-White_utk                 (4) | Train Loss: 2.1361 | Train Acc: 0.1154
 Site-White_utk                 (0) | Train Loss: 2.2708 | Train Acc: 0.1053
 Site-White_utk                 (4) | Train Loss: 2.1451 | Train Acc: 0.1607
 Site-White_utk                 (4) | Train Loss: 2.1195 | Train Acc: 0.1463
 Site-White_utk                 (4) | Train Loss: 2.1530 | Train Acc: 0.1157
 Site-White_utk                 (4) | Train Loss: 2.1793 | Train Acc: 0.1285
 Site-White_utk                 (4) | Train Loss: 2.1316 | Train Acc: 0.1255
 Site-White_utk                 (4) | Train Loss: 2.1346 | Train Acc: 0.1318
 Site-East_Asian                (1) | Train Loss: 1.8363 | Train Acc: 0.4074
 Site-East_Asian                (1) | Train Loss: 1.9276 | Train Acc: 0.4500
 Site-East_Asian                (1) | Train Loss: 1.9063 | Train Acc: 0.3390
 Site-East_Asian                (1) | Train Loss: 1.9704 | Train Acc: 0.3605
 Site-East_Asian                (1) | Train Loss: 1.9070 | Train Acc: 0.3622
 Site-East_Asian                (1) | Train Loss: 1.9240 | Train Acc: 0.3743
 Site-East_Asian                (1) | Train Loss: 1.9027 | Train Acc: 0.3696
 Site-Indian_utk                (3) | Train Loss: 1.9634 | Train Acc: 0.3023
 Site-Indian_utk                (3) | Train Loss: 1.9036 | Train Acc: 0.4062
 Site-Indian_utk                (3) | Train Loss: 1.9633 | Train Acc: 0.3511
 Site-Indian_utk                (3) | Train Loss: 1.9633 | Train Acc: 0.3525
 Site-Indian_utk                (3) | Train Loss: 1.9731 | Train Acc: 0.3122
 Site-Black_utk                 (3) | Train Loss: 1.9245 | Train Acc: 0.3455
 Site-Black_utk                 (3) | Train Loss: 2.0371 | Train Acc: 0.3210
 Site-Black_utk                 (3) | Train Loss: 2.0216 | Train Acc: 0.2773
 Site-Southeast_Asian           (1) | Train Loss: 1.9650 | Train Acc: 0.3137
 Site-Southeast_Asian           (1) | Train Loss: 2.0197 | Train Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6736 | Train Acc: 0.4884
 Site-White_ffhq                (2) | Train Loss: 1.6062 | Train Acc: 0.7094
Average Train Accuracy: 0.2938
 Site-White_utk                 (5) | Val  Loss: 2.2066 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.1447 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.0984 | Val  Acc: 0.1765
 Site-White_utk                 (0) | Val  Loss: 2.2268 | Val  Acc: 0.1200
 Site-White_utk                 (4) | Val  Loss: 2.2269 | Val  Acc: 0.0811
 Site-White_utk                 (4) | Val  Loss: 2.1308 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.1489 | Val  Acc: 0.1481
 Site-White_utk                 (4) | Val  Loss: 2.1804 | Val  Acc: 0.1345
 Site-White_utk                 (4) | Val  Loss: 2.1671 | Val  Acc: 0.1314
 Site-White_utk                 (4) | Val  Loss: 2.2368 | Val  Acc: 0.1434
 Site-East_Asian                (1) | Val  Loss: 2.0670 | Val  Acc: 0.2778
 Site-East_Asian                (1) | Val  Loss: 1.9322 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.9967 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.8944 | Val  Acc: 0.4035
 Site-East_Asian                (1) | Val  Loss: 1.9294 | Val  Acc: 0.4000
 Site-East_Asian                (1) | Val  Loss: 1.8685 | Val  Acc: 0.4080
 Site-East_Asian                (1) | Val  Loss: 1.8956 | Val  Acc: 0.3859
 Site-Indian_utk                (3) | Val  Loss: 1.9546 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.9256 | Val  Acc: 0.3256
 Site-Indian_utk                (3) | Val  Loss: 1.9770 | Val  Acc: 0.3651
 Site-Indian_utk                (3) | Val  Loss: 2.0221 | Val  Acc: 0.3152
 Site-Indian_utk                (3) | Val  Loss: 1.9280 | Val  Acc: 0.3235
 Site-Black_utk                 (3) | Val  Loss: 1.9537 | Val  Acc: 0.2778
 Site-Black_utk                 (3) | Val  Loss: 1.9910 | Val  Acc: 0.2778
 Site-Black_utk                 (3) | Val  Loss: 1.9970 | Val  Acc: 0.3418
 Site-Southeast_Asian           (1) | Val  Loss: 2.2328 | Val  Acc: 0.2794
 Site-Southeast_Asian           (1) | Val  Loss: 2.0398 | Val  Acc: 0.2700
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9629 | Val  Acc: 0.1739
 Site-White_ffhq                (2) | Val  Loss: 1.4492 | Val  Acc: 0.8974
Average Valid Accuracy: 0.2774
============ Train epoch 3 ============
cnt=[7, 1, 3, 8, 2, 8, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White_utk                 (2) | Train Loss: 1.9477 | Train Acc: 0.3333
 Site-White_utk                 (0) | Train Loss: 2.0822 | Train Acc: 0.2353
 Site-White_utk                 (0) | Train Loss: 2.1351 | Train Acc: 0.1154
 Site-White_utk                 (0) | Train Loss: 2.2036 | Train Acc: 0.0526
 Site-White_utk                 (2) | Train Loss: 2.1533 | Train Acc: 0.1607
 Site-White_utk                 (2) | Train Loss: 2.1490 | Train Acc: 0.1707
 Site-White_utk                 (0) | Train Loss: 2.1025 | Train Acc: 0.1570
 Site-White_utk                 (0) | Train Loss: 2.1554 | Train Acc: 0.1508
 Site-White_utk                 (0) | Train Loss: 2.1743 | Train Acc: 0.1179
 Site-White_utk                 (0) | Train Loss: 2.0624 | Train Acc: 0.1550
 Site-East_Asian                (5) | Train Loss: 1.8374 | Train Acc: 0.4074
 Site-East_Asian                (5) | Train Loss: 1.8272 | Train Acc: 0.4500
 Site-East_Asian                (1) | Train Loss: 1.8663 | Train Acc: 0.3051
 Site-East_Asian                (5) | Train Loss: 1.9418 | Train Acc: 0.3488
 Site-East_Asian                (5) | Train Loss: 1.8571 | Train Acc: 0.3858
 Site-East_Asian                (5) | Train Loss: 1.8833 | Train Acc: 0.3636
 Site-East_Asian                (5) | Train Loss: 1.8283 | Train Acc: 0.3877
 Site-Indian_utk                (3) | Train Loss: 1.9505 | Train Acc: 0.2791
 Site-Indian_utk                (3) | Train Loss: 1.8425 | Train Acc: 0.4219
 Site-Indian_utk                (3) | Train Loss: 1.9541 | Train Acc: 0.3191
 Site-Indian_utk                (3) | Train Loss: 1.9119 | Train Acc: 0.3597
 Site-Indian_utk                (3) | Train Loss: 1.9425 | Train Acc: 0.3220
 Site-Black_utk                 (3) | Train Loss: 1.8894 | Train Acc: 0.4000
 Site-Black_utk                 (3) | Train Loss: 1.9403 | Train Acc: 0.2963
 Site-Black_utk                 (3) | Train Loss: 1.9409 | Train Acc: 0.2773
 Site-Southeast_Asian           (5) | Train Loss: 2.0029 | Train Acc: 0.3137
 Site-Southeast_Asian           (5) | Train Loss: 1.9966 | Train Acc: 0.3067
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6011 | Train Acc: 0.4767
 Site-White_ffhq                (4) | Train Loss: 1.5352 | Train Acc: 0.7436
Average Train Accuracy: 0.3039
 Site-White_utk                 (2) | Val  Loss: 2.0545 | Val  Acc: 0.3750
 Site-White_utk                 (0) | Val  Loss: 2.1140 | Val  Acc: 0.1818
 Site-White_utk                 (0) | Val  Loss: 2.1442 | Val  Acc: 0.1176
 Site-White_utk                 (0) | Val  Loss: 2.2113 | Val  Acc: 0.1600
 Site-White_utk                 (2) | Val  Loss: 2.1698 | Val  Acc: 0.1351
 Site-White_utk                 (2) | Val  Loss: 2.1272 | Val  Acc: 0.0909
 Site-White_utk                 (0) | Val  Loss: 2.1201 | Val  Acc: 0.1111
 Site-White_utk                 (0) | Val  Loss: 2.1542 | Val  Acc: 0.1429
 Site-White_utk                 (0) | Val  Loss: 2.1395 | Val  Acc: 0.1543
 Site-White_utk                 (0) | Val  Loss: 2.1520 | Val  Acc: 0.1473
 Site-East_Asian                (5) | Val  Loss: 2.0184 | Val  Acc: 0.2222
 Site-East_Asian                (5) | Val  Loss: 1.8678 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.9464 | Val  Acc: 0.3333
 Site-East_Asian                (5) | Val  Loss: 1.8703 | Val  Acc: 0.3860
 Site-East_Asian                (5) | Val  Loss: 1.9020 | Val  Acc: 0.4118
 Site-East_Asian                (5) | Val  Loss: 1.8328 | Val  Acc: 0.4080
 Site-East_Asian                (5) | Val  Loss: 1.8540 | Val  Acc: 0.3913
 Site-Indian_utk                (3) | Val  Loss: 1.9433 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.9132 | Val  Acc: 0.3488
 Site-Indian_utk                (3) | Val  Loss: 1.9386 | Val  Acc: 0.3333
 Site-Indian_utk                (3) | Val  Loss: 1.9366 | Val  Acc: 0.3043
 Site-Indian_utk                (3) | Val  Loss: 1.8752 | Val  Acc: 0.3088
 Site-Black_utk                 (3) | Val  Loss: 1.8892 | Val  Acc: 0.2778
 Site-Black_utk                 (3) | Val  Loss: 1.9633 | Val  Acc: 0.2222
 Site-Black_utk                 (3) | Val  Loss: 1.9804 | Val  Acc: 0.3165
 Site-Southeast_Asian           (5) | Val  Loss: 2.1087 | Val  Acc: 0.2794
 Site-Southeast_Asian           (5) | Val  Loss: 1.9996 | Val  Acc: 0.3100
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.9042 | Val  Acc: 0.1913
 Site-White_ffhq                (4) | Val  Loss: 1.4117 | Val  Acc: 0.8333
Average Valid Accuracy: 0.2837
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.3750
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1818
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1176
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1600
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1351
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.0909
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1111
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1429
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1543
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1473
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.2222
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:3 | Val Acc: 0.3333
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.3860
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4118
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4080
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.3913
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3103
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3488
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3333
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3043
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3088
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.2778
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.2222
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.3165
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.2794
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3100
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:3 | Val Acc: 0.1913
 Best site-White_ffhq               (4)  | Epoch:3 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white_cb/ccop_q=1...
============ Train epoch 4 ============
