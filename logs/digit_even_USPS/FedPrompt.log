===2023-03-26 14:34:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 4
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8106 | Train Acc: 0.5045
 Site-MNIST     | Train Loss: 1.8256 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 2.1907 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.2214 | Train Acc: 0.2432
 Site-SynthDigits| Train Loss: 2.0951 | Train Acc: 0.3063
 Site-SynthDigits| Train Loss: 2.1235 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.1898 | Train Acc: 0.2252
 Site-MNIST-M   | Train Loss: 2.1757 | Train Acc: 0.2432
 Site-MNIST     | Val  Loss: 1.8173 | Val  Acc: 0.5270
 Site-MNIST     | Val  Loss: 1.7687 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 2.2570 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.2002 | Val  Acc: 0.2432
 Site-SynthDigits| Val  Loss: 2.1239 | Val  Acc: 0.2568
 Site-SynthDigits| Val  Loss: 2.1053 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.1630 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1686 | Val  Acc: 0.2432
Average Valid Accuracy: 0.3209
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5270
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2432
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2568
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_USPS...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4347 | Train Acc: 0.6577
 Site-MNIST     | Train Loss: 1.4774 | Train Acc: 0.6577
 Site-SVHN      | Train Loss: 2.0848 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 2.1080 | Train Acc: 0.2523
 Site-SynthDigits| Train Loss: 1.8705 | Train Acc: 0.4144
 Site-SynthDigits| Train Loss: 1.9365 | Train Acc: 0.3874
 Site-MNIST-M   | Train Loss: 2.0053 | Train Acc: 0.3153
 Site-MNIST-M   | Train Loss: 1.9825 | Train Acc: 0.3423
 Site-MNIST     | Val  Loss: 1.4804 | Val  Acc: 0.6622
 Site-MNIST     | Val  Loss: 1.3901 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 2.1557 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.0609 | Val  Acc: 0.2838
 Site-SynthDigits| Val  Loss: 1.9476 | Val  Acc: 0.3649
 Site-SynthDigits| Val  Loss: 1.8702 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 1.9635 | Val  Acc: 0.3649
 Site-MNIST-M   | Val  Loss: 1.9827 | Val  Acc: 0.2973
Average Valid Accuracy: 0.4172
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6622
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2838
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3649
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3649
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_USPS...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1406 | Train Acc: 0.7027
 Site-MNIST     | Train Loss: 1.2154 | Train Acc: 0.6847
 Site-SVHN      | Train Loss: 1.9570 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.9582 | Train Acc: 0.3423
 Site-SynthDigits| Train Loss: 1.6613 | Train Acc: 0.4685
 Site-SynthDigits| Train Loss: 1.6581 | Train Acc: 0.5495
 Site-MNIST-M   | Train Loss: 1.8222 | Train Acc: 0.3784
 Site-MNIST-M   | Train Loss: 1.8362 | Train Acc: 0.4054
 Site-MNIST     | Val  Loss: 1.2382 | Val  Acc: 0.6622
 Site-MNIST     | Val  Loss: 1.0772 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 2.0625 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 1.8670 | Val  Acc: 0.3919
 Site-SynthDigits| Val  Loss: 1.6707 | Val  Acc: 0.5405
 Site-SynthDigits| Val  Loss: 1.6329 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.8433 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 1.7685 | Val  Acc: 0.4730
Average Valid Accuracy: 0.5051
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6622
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3919
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5405
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_USPS...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9369 | Train Acc: 0.7387
 Site-MNIST     | Train Loss: 1.0377 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 1.8238 | Train Acc: 0.3874
 Site-SVHN      | Train Loss: 1.8163 | Train Acc: 0.4234
 Site-SynthDigits| Train Loss: 1.4836 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 1.5045 | Train Acc: 0.5225
 Site-MNIST-M   | Train Loss: 1.5920 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.6265 | Train Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.0623 | Val  Acc: 0.7432
 Site-MNIST     | Val  Loss: 0.9133 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 1.9236 | Val  Acc: 0.3378
 Site-SVHN      | Val  Loss: 1.7140 | Val  Acc: 0.4730
 Site-SynthDigits| Val  Loss: 1.5326 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.4528 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.6129 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.5558 | Val  Acc: 0.6081
Average Valid Accuracy: 0.5625
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7432
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4730
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_USPS...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7236 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.8190 | Train Acc: 0.8288
 Site-SVHN      | Train Loss: 1.7215 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 1.7248 | Train Acc: 0.4955
 Site-SynthDigits| Train Loss: 1.2923 | Train Acc: 0.6306
 Site-SynthDigits| Train Loss: 1.2795 | Train Acc: 0.6306
 Site-MNIST-M   | Train Loss: 1.4311 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.4289 | Train Acc: 0.5946
 Site-MNIST     | Val  Loss: 0.8109 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.7258 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 1.7897 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 1.6869 | Val  Acc: 0.5135
 Site-SynthDigits| Val  Loss: 1.3154 | Val  Acc: 0.6216
 Site-SynthDigits| Val  Loss: 1.2594 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.4252 | Val  Acc: 0.6081
 Site-MNIST-M   | Val  Loss: 1.3640 | Val  Acc: 0.6351
Average Valid Accuracy: 0.6470
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5135
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6216
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6081
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_USPS...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.5632 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.6781 | Train Acc: 0.8288
 Site-SVHN      | Train Loss: 1.3819 | Train Acc: 0.5856
 Site-SVHN      | Train Loss: 1.3819 | Train Acc: 0.5856
 Site-SynthDigits| Train Loss: 0.9807 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 0.9620 | Train Acc: 0.7838
 Site-MNIST-M   | Train Loss: 1.1038 | Train Acc: 0.6937
 Site-MNIST-M   | Train Loss: 1.1126 | Train Acc: 0.7117
 Site-MNIST     | Val  Loss: 0.6718 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 0.6093 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.5136 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.2805 | Val  Acc: 0.6216
 Site-SynthDigits| Val  Loss: 1.0090 | Val  Acc: 0.7973
 Site-SynthDigits| Val  Loss: 0.9452 | Val  Acc: 0.7432
 Site-MNIST-M   | Val  Loss: 1.0933 | Val  Acc: 0.7162
 Site-MNIST-M   | Val  Loss: 1.0425 | Val  Acc: 0.7297
Average Valid Accuracy: 0.7280
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6216
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7973
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7432
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7162
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_USPS...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.3522 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.4541 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 1.1972 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 1.2083 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 0.7867 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 0.7426 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 0.9046 | Train Acc: 0.7658
 Site-MNIST-M   | Train Loss: 0.8953 | Train Acc: 0.8018
 Site-MNIST     | Val  Loss: 0.4216 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.4061 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.2985 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.1372 | Val  Acc: 0.6892
 Site-SynthDigits| Val  Loss: 0.8104 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 0.7173 | Val  Acc: 0.8108
 Site-MNIST-M   | Val  Loss: 0.8866 | Val  Acc: 0.8108
 Site-MNIST-M   | Val  Loss: 0.8355 | Val  Acc: 0.8108
Average Valid Accuracy: 0.7838
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6892
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8108
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8108
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_USPS...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.3246 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.3867 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 0.8653 | Train Acc: 0.7387
 Site-SVHN      | Train Loss: 0.8769 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.6617 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.5725 | Train Acc: 0.9009
 Site-MNIST-M   | Train Loss: 0.5875 | Train Acc: 0.9279
 Site-MNIST-M   | Train Loss: 0.5897 | Train Acc: 0.9369
 Site-MNIST     | Val  Loss: 0.3594 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.3725 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 0.9747 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 0.7971 | Val  Acc: 0.7973
 Site-SynthDigits| Val  Loss: 0.6352 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 0.5368 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.5715 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 0.5489 | Val  Acc: 0.9459
Average Valid Accuracy: 0.8767
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7973
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_USPS...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.2165 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.2822 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 0.7727 | Train Acc: 0.8108
 Site-SVHN      | Train Loss: 0.7823 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 0.4721 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.3933 | Train Acc: 0.9640
 Site-MNIST-M   | Train Loss: 0.4896 | Train Acc: 0.9369
 Site-MNIST-M   | Train Loss: 0.4888 | Train Acc: 0.9550
 Site-MNIST     | Val  Loss: 0.2465 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.2737 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 0.8624 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 0.7232 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 0.4410 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.3871 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 0.4893 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 0.4435 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9122
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9595
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_USPS...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1877 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.2183 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 0.4844 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 0.5295 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.4287 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.3428 | Train Acc: 0.9550
 Site-MNIST-M   | Train Loss: 0.2998 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.3075 | Train Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2054 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2050 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 0.6138 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 0.4411 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.4058 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.2999 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 0.2997 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.2741 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9358
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9595
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_USPS...
===2023-03-26 15:08:01===
===2023-03-26 15:22:14===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 4
Loading snapshots...
Test Accuracy of USPS: 0.7151
Average Test Accuracy: 0.7151
