===2023-06-01 14:29:18===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.5
    std_rw: False
    gender_label: False
    binary_race: False
data_number=[82,247,82,247,82,247,82,247,82,247,82,247,82,247,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1100,1100,1100,1100,1100,1100,1100,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 3, 4, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.03561, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White                    | Train Loss: 1.9557 | Train Acc: 0.3293
 Site-White                    | Train Loss: 1.9122 | Train Acc: 0.3198
 Site-Latino_Hispanic          | Train Loss: 1.9956 | Train Acc: 0.2805
 Site-Latino_Hispanic          | Train Loss: 1.9510 | Train Acc: 0.2591
 Site-Black                    | Train Loss: 1.9222 | Train Acc: 0.2561
 Site-Black                    | Train Loss: 1.9245 | Train Acc: 0.2794
 Site-East_Asian               | Train Loss: 1.9610 | Train Acc: 0.3780
 Site-East_Asian               | Train Loss: 1.9270 | Train Acc: 0.3320
 Site-Indian                   | Train Loss: 2.0751 | Train Acc: 0.2805
 Site-Indian                   | Train Loss: 2.1515 | Train Acc: 0.2348
 Site-Southeast_Asian          | Train Loss: 2.0308 | Train Acc: 0.3049
 Site-Southeast_Asian          | Train Loss: 2.1023 | Train Acc: 0.3036
 Site-Middle_Eastern           | Train Loss: 1.8241 | Train Acc: 0.3415
 Site-Middle_Eastern           | Train Loss: 1.8727 | Train Acc: 0.3522
 Site-White                     (1) | Val  Loss: 1.9641 | Val  Acc: 0.3273
 Site-White                     (1) | Val  Loss: 1.9450 | Val  Acc: 0.3212
 Site-Latino_Hispanic           (5) | Val  Loss: 1.9539 | Val  Acc: 0.3091
 Site-Latino_Hispanic           (2) | Val  Loss: 1.9568 | Val  Acc: 0.2545
 Site-Black                     (0) | Val  Loss: 2.1710 | Val  Acc: 0.1818
 Site-Black                     (0) | Val  Loss: 1.9023 | Val  Acc: 0.2970
 Site-East_Asian                (3) | Val  Loss: 1.8725 | Val  Acc: 0.3273
 Site-East_Asian                (3) | Val  Loss: 1.9065 | Val  Acc: 0.3333
 Site-Indian                    (6) | Val  Loss: 2.1336 | Val  Acc: 0.2182
 Site-Indian                    (2) | Val  Loss: 2.1210 | Val  Acc: 0.2242
 Site-Southeast_Asian           (2) | Val  Loss: 2.1326 | Val  Acc: 0.2909
 Site-Southeast_Asian           (2) | Val  Loss: 2.1305 | Val  Acc: 0.2970
 Site-Middle_Eastern            (4) | Val  Loss: 2.0141 | Val  Acc: 0.3273
 Site-Middle_Eastern            (1) | Val  Loss: 1.9652 | Val  Acc: 0.3333
Average Valid Accuracy: 0.2887
Aggregated Acc | Val Acc: 0.2883
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.3273
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.3212
 Best site-Latino_Hispanic          (5)  | Epoch:0 | Val Acc: 0.3091
 Best site-Latino_Hispanic          (2)  | Epoch:0 | Val Acc: 0.2545
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.1818
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.2970
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3273
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3333
 Best site-Indian                   (6)  | Epoch:0 | Val Acc: 0.2182
 Best site-Indian                   (2)  | Epoch:0 | Val Acc: 0.2242
 Best site-Southeast_Asian          (2)  | Epoch:0 | Val Acc: 0.2909
 Best site-Southeast_Asian          (2)  | Epoch:0 | Val Acc: 0.2970
 Best site-Middle_Eastern           (4)  | Epoch:0 | Val Acc: 0.3273
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 3, 2, 1, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.12210, quan_i=1.96, quan_c=2.00
minimize weight of clients:[1, 12, ]
 Site-White                    | Train Loss: 1.8796 | Train Acc: 0.3171
 Site-White                    | Train Loss: 1.9147 | Train Acc: 0.3158
 Site-Latino_Hispanic          | Train Loss: 1.9783 | Train Acc: 0.2805
 Site-Latino_Hispanic          | Train Loss: 1.9213 | Train Acc: 0.2470
 Site-Black                    | Train Loss: 1.9209 | Train Acc: 0.2561
 Site-Black                    | Train Loss: 1.8800 | Train Acc: 0.2713
 Site-East_Asian               | Train Loss: 1.7753 | Train Acc: 0.3780
 Site-East_Asian               | Train Loss: 1.8766 | Train Acc: 0.3279
 Site-Indian                   | Train Loss: 2.0788 | Train Acc: 0.2683
 Site-Indian                   | Train Loss: 2.1016 | Train Acc: 0.1984
 Site-Southeast_Asian          | Train Loss: 2.0718 | Train Acc: 0.3049
 Site-Southeast_Asian          | Train Loss: 2.0481 | Train Acc: 0.3077
 Site-Middle_Eastern           | Train Loss: 1.8170 | Train Acc: 0.3293
 Site-Middle_Eastern           | Train Loss: 1.8497 | Train Acc: 0.3522
 Site-White                     (0) | Val  Loss: 1.9959 | Val  Acc: 0.3273
 Site-White                     (0) | Val  Loss: 1.9487 | Val  Acc: 0.3152
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8730 | Val  Acc: 0.2909
 Site-Latino_Hispanic           (6) | Val  Loss: 1.9269 | Val  Acc: 0.2485
 Site-Black                     (1) | Val  Loss: 2.1036 | Val  Acc: 0.1818
 Site-Black                     (1) | Val  Loss: 1.8766 | Val  Acc: 0.2848
 Site-East_Asian                (2) | Val  Loss: 1.8959 | Val  Acc: 0.3273
 Site-East_Asian                (2) | Val  Loss: 1.8653 | Val  Acc: 0.3273
 Site-Indian                    (4) | Val  Loss: 2.0927 | Val  Acc: 0.2000
 Site-Indian                    (1) | Val  Loss: 2.0866 | Val  Acc: 0.2242
 Site-Southeast_Asian           (6) | Val  Loss: 2.0878 | Val  Acc: 0.3091
 Site-Southeast_Asian           (6) | Val  Loss: 2.0412 | Val  Acc: 0.2909
 Site-Middle_Eastern            (3) | Val  Loss: 1.9491 | Val  Acc: 0.3455
 Site-Middle_Eastern            (6) | Val  Loss: 1.9029 | Val  Acc: 0.2970
Average Valid Accuracy: 0.2835
Aggregated Acc | Val Acc: 0.2859
============ Train epoch 2 ============
cnt=[3, 1, 3, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.11622, quan_i=1.92, quan_c=1.95
minimize weight of clients:[0, 5, 13, ]
 Site-White                    | Train Loss: 1.8565 | Train Acc: 0.3293
 Site-White                    | Train Loss: 1.8790 | Train Acc: 0.3158
 Site-Latino_Hispanic          | Train Loss: 1.8253 | Train Acc: 0.2927
 Site-Latino_Hispanic          | Train Loss: 1.9008 | Train Acc: 0.2551
 Site-Black                    | Train Loss: 1.8831 | Train Acc: 0.2439
 Site-Black                    | Train Loss: 1.8645 | Train Acc: 0.2874
 Site-East_Asian               | Train Loss: 1.8094 | Train Acc: 0.3780
 Site-East_Asian               | Train Loss: 1.8455 | Train Acc: 0.3198
 Site-Indian                   | Train Loss: 2.0052 | Train Acc: 0.2561
 Site-Indian                   | Train Loss: 2.0778 | Train Acc: 0.2105
 Site-Southeast_Asian          | Train Loss: 2.0799 | Train Acc: 0.2927
 Site-Southeast_Asian          | Train Loss: 2.0334 | Train Acc: 0.3036
 Site-Middle_Eastern           | Train Loss: 1.8168 | Train Acc: 0.3293
 Site-Middle_Eastern           | Train Loss: 1.8382 | Train Acc: 0.3279
 Site-White                     (0) | Val  Loss: 1.9396 | Val  Acc: 0.3091
 Site-White                     (0) | Val  Loss: 1.9142 | Val  Acc: 0.3030
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8771 | Val  Acc: 0.2545
 Site-Latino_Hispanic           (5) | Val  Loss: 1.9188 | Val  Acc: 0.2485
 Site-Black                     (4) | Val  Loss: 2.0691 | Val  Acc: 0.2000
 Site-Black                     (6) | Val  Loss: 1.8493 | Val  Acc: 0.3091
 Site-East_Asian                (5) | Val  Loss: 1.8506 | Val  Acc: 0.3091
 Site-East_Asian                (5) | Val  Loss: 1.8309 | Val  Acc: 0.3576
 Site-Indian                    (2) | Val  Loss: 2.0407 | Val  Acc: 0.2182
 Site-Indian                    (2) | Val  Loss: 2.0579 | Val  Acc: 0.2424
 Site-Southeast_Asian           (1) | Val  Loss: 2.0507 | Val  Acc: 0.3091
 Site-Southeast_Asian           (5) | Val  Loss: 2.0351 | Val  Acc: 0.2788
 Site-Middle_Eastern            (2) | Val  Loss: 1.9357 | Val  Acc: 0.3273
 Site-Middle_Eastern            (0) | Val  Loss: 1.8877 | Val  Acc: 0.3333
Average Valid Accuracy: 0.2857
Aggregated Acc | Val Acc: 0.2784
============ Train epoch 3 ============
cnt=[4, 2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.11827, quan_i=1.89, quan_c=1.89
minimize weight of clients:[6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.8979 | Train Acc: 0.3171
 Site-White                    | Train Loss: 1.8658 | Train Acc: 0.3158
 Site-Latino_Hispanic          | Train Loss: 1.8522 | Train Acc: 0.2927
 Site-Latino_Hispanic          | Train Loss: 1.8696 | Train Acc: 0.2591
 Site-Black                    | Train Loss: 1.9671 | Train Acc: 0.2317
 Site-Black                    | Train Loss: 1.8467 | Train Acc: 0.2874
 Site-East_Asian               | Train Loss: 1.7489 | Train Acc: 0.3537
 Site-East_Asian               | Train Loss: 1.8357 | Train Acc: 0.3279
 Site-Indian                   | Train Loss: 2.0097 | Train Acc: 0.2561
 Site-Indian                   | Train Loss: 2.0391 | Train Acc: 0.2389
 Site-Southeast_Asian          | Train Loss: 2.0567 | Train Acc: 0.2927
 Site-Southeast_Asian          | Train Loss: 1.9987 | Train Acc: 0.3077
 Site-Middle_Eastern           | Train Loss: 1.8815 | Train Acc: 0.3049
 Site-Middle_Eastern           | Train Loss: 1.8188 | Train Acc: 0.3482
 Site-White                     (5) | Val  Loss: 1.9398 | Val  Acc: 0.3273
 Site-White                     (5) | Val  Loss: 1.8922 | Val  Acc: 0.3212
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8755 | Val  Acc: 0.3091
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8852 | Val  Acc: 0.2545
 Site-Black                     (3) | Val  Loss: 2.0498 | Val  Acc: 0.1636
 Site-Black                     (6) | Val  Loss: 1.8286 | Val  Acc: 0.3091
 Site-East_Asian                (2) | Val  Loss: 1.8171 | Val  Acc: 0.3273
 Site-East_Asian                (2) | Val  Loss: 1.8217 | Val  Acc: 0.3273
 Site-Indian                    (0) | Val  Loss: 2.0095 | Val  Acc: 0.2000
 Site-Indian                    (0) | Val  Loss: 2.0218 | Val  Acc: 0.2545
 Site-Southeast_Asian           (4) | Val  Loss: 2.0391 | Val  Acc: 0.3455
 Site-Southeast_Asian           (4) | Val  Loss: 1.9947 | Val  Acc: 0.2848
 Site-Middle_Eastern            (1) | Val  Loss: 1.9147 | Val  Acc: 0.3455
 Site-Middle_Eastern            (1) | Val  Loss: 1.8766 | Val  Acc: 0.3152
Average Valid Accuracy: 0.2918
Aggregated Acc | Val Acc: 0.2892
 Best site-White                    (5)  | Epoch:3 | Val Acc: 0.3273
 Best site-White                    (5)  | Epoch:3 | Val Acc: 0.3212
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.3091
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.2545
 Best site-Black                    (3)  | Epoch:3 | Val Acc: 0.1636
 Best site-Black                    (6)  | Epoch:3 | Val Acc: 0.3091
 Best site-East_Asian               (2)  | Epoch:3 | Val Acc: 0.3273
 Best site-East_Asian               (2)  | Epoch:3 | Val Acc: 0.3273
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2000
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2545
 Best site-Southeast_Asian          (4)  | Epoch:3 | Val Acc: 0.3455
 Best site-Southeast_Asian          (4)  | Epoch:3 | Val Acc: 0.2848
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.3455
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.3152
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.11144, quan_i=1.89, quan_c=1.91
minimize weight of clients:[5, 6, 7, 13, ]
 Site-White                    | Train Loss: 1.8316 | Train Acc: 0.3171
 Site-White                    | Train Loss: 1.8459 | Train Acc: 0.3158
 Site-Latino_Hispanic          | Train Loss: 1.9342 | Train Acc: 0.2683
 Site-Latino_Hispanic          | Train Loss: 1.8588 | Train Acc: 0.2470
 Site-Black                    | Train Loss: 1.8723 | Train Acc: 0.2439
 Site-Black                    | Train Loss: 1.8450 | Train Acc: 0.2915
 Site-East_Asian               | Train Loss: 1.7795 | Train Acc: 0.3659
 Site-East_Asian               | Train Loss: 1.8050 | Train Acc: 0.3239
 Site-Indian                   | Train Loss: 1.9879 | Train Acc: 0.2195
 Site-Indian                   | Train Loss: 1.9895 | Train Acc: 0.2389
 Site-Southeast_Asian          | Train Loss: 1.9172 | Train Acc: 0.3171
 Site-Southeast_Asian          | Train Loss: 1.9594 | Train Acc: 0.3077
 Site-Middle_Eastern           | Train Loss: 1.7433 | Train Acc: 0.3049
 Site-Middle_Eastern           | Train Loss: 1.7956 | Train Acc: 0.3887
 Site-White                     (6) | Val  Loss: 1.9398 | Val  Acc: 0.3091
 Site-White                     (3) | Val  Loss: 1.8676 | Val  Acc: 0.3152
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8329 | Val  Acc: 0.2727
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8678 | Val  Acc: 0.2606
 Site-Black                     (1) | Val  Loss: 2.0059 | Val  Acc: 0.1636
 Site-Black                     (1) | Val  Loss: 1.8380 | Val  Acc: 0.2727
 Site-East_Asian                (0) | Val  Loss: 1.8390 | Val  Acc: 0.2909
 Site-East_Asian                (0) | Val  Loss: 1.8169 | Val  Acc: 0.3394
 Site-Indian                    (3) | Val  Loss: 1.9353 | Val  Acc: 0.2364
 Site-Indian                    (3) | Val  Loss: 1.9911 | Val  Acc: 0.2061
 Site-Southeast_Asian           (2) | Val  Loss: 1.9831 | Val  Acc: 0.3273
 Site-Southeast_Asian           (2) | Val  Loss: 1.9496 | Val  Acc: 0.3030
 Site-Middle_Eastern            (5) | Val  Loss: 1.8799 | Val  Acc: 0.3273
 Site-Middle_Eastern            (5) | Val  Loss: 1.8580 | Val  Acc: 0.3212
Average Valid Accuracy: 0.2818
Aggregated Acc | Val Acc: 0.2870
============ Train epoch 5 ============
cnt=[4, 2, 2, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.10959, quan_i=1.87, quan_c=1.86
minimize weight of clients:[0, 1, 6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.8636 | Train Acc: 0.3171
 Site-White                    | Train Loss: 1.8303 | Train Acc: 0.3158
 Site-Latino_Hispanic          | Train Loss: 1.8731 | Train Acc: 0.2927
 Site-Latino_Hispanic          | Train Loss: 1.8354 | Train Acc: 0.2470
 Site-Black                    | Train Loss: 1.8279 | Train Acc: 0.2195
 Site-Black                    | Train Loss: 1.8305 | Train Acc: 0.2874
 Site-East_Asian               | Train Loss: 1.8430 | Train Acc: 0.3902
 Site-East_Asian               | Train Loss: 1.8034 | Train Acc: 0.3239
 Site-Indian                   | Train Loss: 1.8962 | Train Acc: 0.2683
 Site-Indian                   | Train Loss: 1.9655 | Train Acc: 0.2510
 Site-Southeast_Asian          | Train Loss: 1.9572 | Train Acc: 0.2805
 Site-Southeast_Asian          | Train Loss: 1.9437 | Train Acc: 0.2955
 Site-Middle_Eastern           | Train Loss: 1.7821 | Train Acc: 0.3415
 Site-Middle_Eastern           | Train Loss: 1.7867 | Train Acc: 0.3441
 Site-White                     (0) | Val  Loss: 1.9366 | Val  Acc: 0.3273
 Site-White                     (0) | Val  Loss: 1.8670 | Val  Acc: 0.3030
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8232 | Val  Acc: 0.2909
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8353 | Val  Acc: 0.2727
 Site-Black                     (1) | Val  Loss: 1.9368 | Val  Acc: 0.1818
 Site-Black                     (1) | Val  Loss: 1.7953 | Val  Acc: 0.3152
 Site-East_Asian                (6) | Val  Loss: 1.8524 | Val  Acc: 0.3455
 Site-East_Asian                (6) | Val  Loss: 1.7863 | Val  Acc: 0.3515
 Site-Indian                    (4) | Val  Loss: 1.8919 | Val  Acc: 0.2182
 Site-Indian                    (4) | Val  Loss: 1.9461 | Val  Acc: 0.2303
 Site-Southeast_Asian           (2) | Val  Loss: 1.9950 | Val  Acc: 0.3273
 Site-Southeast_Asian           (2) | Val  Loss: 1.9419 | Val  Acc: 0.3091
 Site-Middle_Eastern            (5) | Val  Loss: 1.8952 | Val  Acc: 0.3455
 Site-Middle_Eastern            (0) | Val  Loss: 1.8300 | Val  Acc: 0.3455
Average Valid Accuracy: 0.2974
Aggregated Acc | Val Acc: 0.2983
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.3273
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.3030
 Best site-Latino_Hispanic          (3)  | Epoch:5 | Val Acc: 0.2909
 Best site-Latino_Hispanic          (0)  | Epoch:5 | Val Acc: 0.2727
 Best site-Black                    (1)  | Epoch:5 | Val Acc: 0.1818
 Best site-Black                    (1)  | Epoch:5 | Val Acc: 0.3152
 Best site-East_Asian               (6)  | Epoch:5 | Val Acc: 0.3455
 Best site-East_Asian               (6)  | Epoch:5 | Val Acc: 0.3515
 Best site-Indian                   (4)  | Epoch:5 | Val Acc: 0.2182
 Best site-Indian                   (4)  | Epoch:5 | Val Acc: 0.2303
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3273
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3091
 Best site-Middle_Eastern           (5)  | Epoch:5 | Val Acc: 0.3455
 Best site-Middle_Eastern           (0)  | Epoch:5 | Val Acc: 0.3455
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 2, 1, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.11354, quan_i=1.85, quan_c=1.88
minimize weight of clients:[12, 13, ]
 Site-White                    | Train Loss: 1.8730 | Train Acc: 0.3537
 Site-White                    | Train Loss: 1.8127 | Train Acc: 0.3441
 Site-Latino_Hispanic          | Train Loss: 1.7841 | Train Acc: 0.2805
 Site-Latino_Hispanic          | Train Loss: 1.8217 | Train Acc: 0.2713
 Site-Black                    | Train Loss: 1.8501 | Train Acc: 0.2561
 Site-Black                    | Train Loss: 1.7973 | Train Acc: 0.3036
 Site-East_Asian               | Train Loss: 1.7670 | Train Acc: 0.3902
 Site-East_Asian               | Train Loss: 1.7854 | Train Acc: 0.3279
 Site-Indian                   | Train Loss: 1.8800 | Train Acc: 0.2927
 Site-Indian                   | Train Loss: 1.9437 | Train Acc: 0.2551
 Site-Southeast_Asian          | Train Loss: 1.9783 | Train Acc: 0.2561
 Site-Southeast_Asian          | Train Loss: 1.9094 | Train Acc: 0.2996
 Site-Middle_Eastern           | Train Loss: 1.7254 | Train Acc: 0.3293
 Site-Middle_Eastern           | Train Loss: 1.7791 | Train Acc: 0.3644
 Site-White                     (0) | Val  Loss: 1.8986 | Val  Acc: 0.3091
 Site-White                     (0) | Val  Loss: 1.8595 | Val  Acc: 0.2970
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8102 | Val  Acc: 0.3091
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8342 | Val  Acc: 0.2606
 Site-Black                     (4) | Val  Loss: 1.9731 | Val  Acc: 0.2000
 Site-Black                     (6) | Val  Loss: 1.7933 | Val  Acc: 0.2788
 Site-East_Asian                (5) | Val  Loss: 1.7890 | Val  Acc: 0.3455
 Site-East_Asian                (5) | Val  Loss: 1.7742 | Val  Acc: 0.3576
 Site-Indian                    (1) | Val  Loss: 1.8546 | Val  Acc: 0.2545
 Site-Indian                    (1) | Val  Loss: 1.9304 | Val  Acc: 0.2424
 Site-Southeast_Asian           (5) | Val  Loss: 1.9310 | Val  Acc: 0.2909
 Site-Southeast_Asian           (5) | Val  Loss: 1.9101 | Val  Acc: 0.3030
 Site-Middle_Eastern            (2) | Val  Loss: 1.8527 | Val  Acc: 0.3273
 Site-Middle_Eastern            (0) | Val  Loss: 1.7963 | Val  Acc: 0.3455
Average Valid Accuracy: 0.2944
Aggregated Acc | Val Acc: 0.2846
============ Train epoch 7 ============
cnt=[2, 2, 1, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.10959, quan_i=1.84, quan_c=1.83
minimize weight of clients:[1, 2, 6, 12, 13, ]
 Site-White                    | Train Loss: 1.7814 | Train Acc: 0.3171
 Site-White                    | Train Loss: 1.7967 | Train Acc: 0.3320
 Site-Latino_Hispanic          | Train Loss: 1.8121 | Train Acc: 0.3293
 Site-Latino_Hispanic          | Train Loss: 1.7979 | Train Acc: 0.2874
 Site-Black                    | Train Loss: 1.7602 | Train Acc: 0.2561
 Site-Black                    | Train Loss: 1.7801 | Train Acc: 0.2996
 Site-East_Asian               | Train Loss: 1.7112 | Train Acc: 0.3902
 Site-East_Asian               | Train Loss: 1.7419 | Train Acc: 0.3603
 Site-Indian                   | Train Loss: 1.8533 | Train Acc: 0.2805
 Site-Indian                   | Train Loss: 1.9160 | Train Acc: 0.2308
 Site-Southeast_Asian          | Train Loss: 1.9053 | Train Acc: 0.2927
 Site-Southeast_Asian          | Train Loss: 1.9111 | Train Acc: 0.2874
 Site-Middle_Eastern           | Train Loss: 1.6676 | Train Acc: 0.3293
 Site-Middle_Eastern           | Train Loss: 1.7603 | Train Acc: 0.3522
 Site-White                     (5) | Val  Loss: 1.9013 | Val  Acc: 0.3273
 Site-White                     (5) | Val  Loss: 1.8431 | Val  Acc: 0.3333
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7890 | Val  Acc: 0.2909
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8110 | Val  Acc: 0.2727
 Site-Black                     (1) | Val  Loss: 1.9403 | Val  Acc: 0.2364
 Site-Black                     (1) | Val  Loss: 1.7854 | Val  Acc: 0.3030
 Site-East_Asian                (4) | Val  Loss: 1.7767 | Val  Acc: 0.3818
 Site-East_Asian                (3) | Val  Loss: 1.7475 | Val  Acc: 0.3576
 Site-Indian                    (0) | Val  Loss: 1.8445 | Val  Acc: 0.2545
 Site-Indian                    (3) | Val  Loss: 1.9143 | Val  Acc: 0.2242
 Site-Southeast_Asian           (3) | Val  Loss: 1.9185 | Val  Acc: 0.3091
 Site-Southeast_Asian           (3) | Val  Loss: 1.8914 | Val  Acc: 0.3030
 Site-Middle_Eastern            (6) | Val  Loss: 1.8415 | Val  Acc: 0.3455
 Site-Middle_Eastern            (5) | Val  Loss: 1.7967 | Val  Acc: 0.3333
Average Valid Accuracy: 0.3052
Aggregated Acc | Val Acc: 0.3116
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.3273
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.3333
 Best site-Latino_Hispanic          (2)  | Epoch:7 | Val Acc: 0.2909
 Best site-Latino_Hispanic          (0)  | Epoch:7 | Val Acc: 0.2727
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.2364
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.3030
 Best site-East_Asian               (4)  | Epoch:7 | Val Acc: 0.3818
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.3576
 Best site-Indian                   (0)  | Epoch:7 | Val Acc: 0.2545
 Best site-Indian                   (3)  | Epoch:7 | Val Acc: 0.2242
 Best site-Southeast_Asian          (3)  | Epoch:7 | Val Acc: 0.3091
 Best site-Southeast_Asian          (3)  | Epoch:7 | Val Acc: 0.3030
 Best site-Middle_Eastern           (6)  | Epoch:7 | Val Acc: 0.3455
 Best site-Middle_Eastern           (5)  | Epoch:7 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 2, 1, 3, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.10479, quan_i=1.80, quan_c=1.84
minimize weight of clients:[0, 4, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.7636 | Train Acc: 0.3049
 Site-White                    | Train Loss: 1.7686 | Train Acc: 0.3239
 Site-Latino_Hispanic          | Train Loss: 1.7376 | Train Acc: 0.2805
 Site-Latino_Hispanic          | Train Loss: 1.7727 | Train Acc: 0.2834
 Site-Black                    | Train Loss: 1.8688 | Train Acc: 0.2683
 Site-Black                    | Train Loss: 1.7839 | Train Acc: 0.2834
 Site-East_Asian               | Train Loss: 1.6224 | Train Acc: 0.4268
 Site-East_Asian               | Train Loss: 1.7312 | Train Acc: 0.3644
 Site-Indian                   | Train Loss: 1.9143 | Train Acc: 0.2561
 Site-Indian                   | Train Loss: 1.8935 | Train Acc: 0.2672
 Site-Southeast_Asian          | Train Loss: 1.8621 | Train Acc: 0.3171
 Site-Southeast_Asian          | Train Loss: 1.8621 | Train Acc: 0.3117
 Site-Middle_Eastern           | Train Loss: 1.7618 | Train Acc: 0.3415
 Site-Middle_Eastern           | Train Loss: 1.7320 | Train Acc: 0.3846
 Site-White                     (0) | Val  Loss: 1.8818 | Val  Acc: 0.2545
 Site-White                     (6) | Val  Loss: 1.8011 | Val  Acc: 0.3576
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7708 | Val  Acc: 0.3273
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7966 | Val  Acc: 0.2788
 Site-Black                     (2) | Val  Loss: 1.9068 | Val  Acc: 0.1818
 Site-Black                     (3) | Val  Loss: 1.7545 | Val  Acc: 0.3333
 Site-East_Asian                (5) | Val  Loss: 1.7696 | Val  Acc: 0.3636
 Site-East_Asian                (6) | Val  Loss: 1.7079 | Val  Acc: 0.3879
 Site-Indian                    (3) | Val  Loss: 1.8539 | Val  Acc: 0.3091
 Site-Indian                    (3) | Val  Loss: 1.8939 | Val  Acc: 0.2485
 Site-Southeast_Asian           (5) | Val  Loss: 1.8869 | Val  Acc: 0.3091
 Site-Southeast_Asian           (5) | Val  Loss: 1.8566 | Val  Acc: 0.2970
 Site-Middle_Eastern            (1) | Val  Loss: 1.8159 | Val  Acc: 0.3455
 Site-Middle_Eastern            (1) | Val  Loss: 1.7824 | Val  Acc: 0.3394
Average Valid Accuracy: 0.3095
Aggregated Acc | Val Acc: 0.2983
 Best site-White                    (0)  | Epoch:8 | Val Acc: 0.2545
 Best site-White                    (6)  | Epoch:8 | Val Acc: 0.3576
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.3273
 Best site-Latino_Hispanic          (5)  | Epoch:8 | Val Acc: 0.2788
 Best site-Black                    (2)  | Epoch:8 | Val Acc: 0.1818
 Best site-Black                    (3)  | Epoch:8 | Val Acc: 0.3333
 Best site-East_Asian               (5)  | Epoch:8 | Val Acc: 0.3636
 Best site-East_Asian               (6)  | Epoch:8 | Val Acc: 0.3879
 Best site-Indian                   (3)  | Epoch:8 | Val Acc: 0.3091
 Best site-Indian                   (3)  | Epoch:8 | Val Acc: 0.2485
 Best site-Southeast_Asian          (5)  | Epoch:8 | Val Acc: 0.3091
 Best site-Southeast_Asian          (5)  | Epoch:8 | Val Acc: 0.2970
 Best site-Middle_Eastern           (1)  | Epoch:8 | Val Acc: 0.3455
 Best site-Middle_Eastern           (1)  | Epoch:8 | Val Acc: 0.3394
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 9 ============
cnt=[3, 1, 3, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
min_w=0.10150, quan_i=1.79, quan_c=1.79
minimize weight of clients:[2, ]
 Site-White                    | Train Loss: 1.7582 | Train Acc: 0.3415
 Site-White                    | Train Loss: 1.7629 | Train Acc: 0.3198
 Site-Latino_Hispanic          | Train Loss: 1.6664 | Train Acc: 0.3293
 Site-Latino_Hispanic          | Train Loss: 1.7815 | Train Acc: 0.2713
 Site-Black                    | Train Loss: 1.7692 | Train Acc: 0.2317
 Site-Black                    | Train Loss: 1.7716 | Train Acc: 0.3320
 Site-East_Asian               | Train Loss: 1.8241 | Train Acc: 0.3902
 Site-East_Asian               | Train Loss: 1.6984 | Train Acc: 0.3765
 Site-Indian                   | Train Loss: 1.7443 | Train Acc: 0.2561
 Site-Indian                   | Train Loss: 1.8776 | Train Acc: 0.2470
 Site-Southeast_Asian          | Train Loss: 2.0002 | Train Acc: 0.2927
 Site-Southeast_Asian          | Train Loss: 1.8373 | Train Acc: 0.3117
 Site-Middle_Eastern           | Train Loss: 1.6635 | Train Acc: 0.3537
 Site-Middle_Eastern           | Train Loss: 1.7234 | Train Acc: 0.3563
 Site-White                     (2) | Val  Loss: 1.8842 | Val  Acc: 0.3273
 Site-White                     (2) | Val  Loss: 1.7803 | Val  Acc: 0.3333
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7527 | Val  Acc: 0.3091
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7726 | Val  Acc: 0.2606
 Site-Black                     (5) | Val  Loss: 1.9268 | Val  Acc: 0.2182
 Site-Black                     (1) | Val  Loss: 1.7590 | Val  Acc: 0.3273
 Site-East_Asian                (0) | Val  Loss: 1.7497 | Val  Acc: 0.3818
 Site-East_Asian                (0) | Val  Loss: 1.6912 | Val  Acc: 0.4061
 Site-Indian                    (6) | Val  Loss: 1.8151 | Val  Acc: 0.2727
 Site-Indian                    (3) | Val  Loss: 1.8726 | Val  Acc: 0.2424
 Site-Southeast_Asian           (3) | Val  Loss: 1.8964 | Val  Acc: 0.2545
 Site-Southeast_Asian           (0) | Val  Loss: 1.8457 | Val  Acc: 0.3152
 Site-Middle_Eastern            (2) | Val  Loss: 1.7994 | Val  Acc: 0.3455
 Site-Middle_Eastern            (3) | Val  Loss: 1.7483 | Val  Acc: 0.3636
Average Valid Accuracy: 0.3113
Aggregated Acc | Val Acc: 0.3015
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.3273
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.3333
 Best site-Latino_Hispanic          (4)  | Epoch:9 | Val Acc: 0.3091
 Best site-Latino_Hispanic          (3)  | Epoch:9 | Val Acc: 0.2606
 Best site-Black                    (5)  | Epoch:9 | Val Acc: 0.2182
 Best site-Black                    (1)  | Epoch:9 | Val Acc: 0.3273
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.3818
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.4061
 Best site-Indian                   (6)  | Epoch:9 | Val Acc: 0.2727
 Best site-Indian                   (3)  | Epoch:9 | Val Acc: 0.2424
 Best site-Southeast_Asian          (3)  | Epoch:9 | Val Acc: 0.2545
 Best site-Southeast_Asian          (0)  | Epoch:9 | Val Acc: 0.3152
 Best site-Middle_Eastern           (2)  | Epoch:9 | Val Acc: 0.3455
 Best site-Middle_Eastern           (3)  | Epoch:9 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
 Test site-White                    | Epoch:9 | Test Acc: 0.3113
 Test site-Latino_Hispanic          | Epoch:9 | Test Acc: 0.2797
 Test site-Black                    | Epoch:9 | Test Acc: 0.2770
 Test site-East_Asian               | Epoch:9 | Test Acc: 0.4542
 Test site-Indian                   | Epoch:9 | Test Acc: 0.2731
 Test site-Southeast_Asian          | Epoch:9 | Test Acc: 0.3470
 Test site-Middle_Eastern           | Epoch:9 | Test Acc: 0.3085
Average Test Accuracy: 0.3215, domain std=0.0593, individual std=0.0593
============ Train epoch 10 ============
cnt=[6, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
min_w=0.09890, quan_i=1.79, quan_c=1.80
minimize weight of clients:[7, 12, 13, ]
 Site-White                    | Train Loss: 1.7672 | Train Acc: 0.3659
 Site-White                    | Train Loss: 1.7388 | Train Acc: 0.3360
 Site-Latino_Hispanic          | Train Loss: 1.7964 | Train Acc: 0.3049
 Site-Latino_Hispanic          | Train Loss: 1.7628 | Train Acc: 0.2713
 Site-Black                    | Train Loss: 1.7328 | Train Acc: 0.2927
 Site-Black                    | Train Loss: 1.7349 | Train Acc: 0.3401
 Site-East_Asian               | Train Loss: 1.6308 | Train Acc: 0.4268
 Site-East_Asian               | Train Loss: 1.6976 | Train Acc: 0.3765
 Site-Indian                   | Train Loss: 1.7997 | Train Acc: 0.2805
 Site-Indian                   | Train Loss: 1.8522 | Train Acc: 0.2753
 Site-Southeast_Asian          | Train Loss: 1.8861 | Train Acc: 0.3171
 Site-Southeast_Asian          | Train Loss: 1.8181 | Train Acc: 0.3158
 Site-Middle_Eastern           | Train Loss: 1.6272 | Train Acc: 0.3537
 Site-Middle_Eastern           | Train Loss: 1.7043 | Train Acc: 0.3846
 Site-White                     (4) | Val  Loss: 1.8299 | Val  Acc: 0.3273
 Site-White                     (4) | Val  Loss: 1.7653 | Val  Acc: 0.3818
 Site-Latino_Hispanic           (0) | Val  Loss: 1.7599 | Val  Acc: 0.2727
 Site-Latino_Hispanic           (0) | Val  Loss: 1.7864 | Val  Acc: 0.2909
 Site-Black                     (0) | Val  Loss: 1.8950 | Val  Acc: 0.2364
 Site-Black                     (6) | Val  Loss: 1.7574 | Val  Acc: 0.3152
 Site-East_Asian                (1) | Val  Loss: 1.7421 | Val  Acc: 0.4000
 Site-East_Asian                (1) | Val  Loss: 1.6869 | Val  Acc: 0.4121
 Site-Indian                    (0) | Val  Loss: 1.7856 | Val  Acc: 0.2727
 Site-Indian                    (0) | Val  Loss: 1.8211 | Val  Acc: 0.2667
 Site-Southeast_Asian           (3) | Val  Loss: 1.8462 | Val  Acc: 0.3636
 Site-Southeast_Asian           (0) | Val  Loss: 1.8313 | Val  Acc: 0.3394
 Site-Middle_Eastern            (5) | Val  Loss: 1.7796 | Val  Acc: 0.3636
 Site-Middle_Eastern            (2) | Val  Loss: 1.7297 | Val  Acc: 0.3212
Average Valid Accuracy: 0.3260
Aggregated Acc | Val Acc: 0.3434
 Best site-White                    (4)  | Epoch:10 | Val Acc: 0.3273
 Best site-White                    (4)  | Epoch:10 | Val Acc: 0.3818
 Best site-Latino_Hispanic          (0)  | Epoch:10 | Val Acc: 0.2727
 Best site-Latino_Hispanic          (0)  | Epoch:10 | Val Acc: 0.2909
 Best site-Black                    (0)  | Epoch:10 | Val Acc: 0.2364
 Best site-Black                    (6)  | Epoch:10 | Val Acc: 0.3152
 Best site-East_Asian               (1)  | Epoch:10 | Val Acc: 0.4000
 Best site-East_Asian               (1)  | Epoch:10 | Val Acc: 0.4121
 Best site-Indian                   (0)  | Epoch:10 | Val Acc: 0.2727
 Best site-Indian                   (0)  | Epoch:10 | Val Acc: 0.2667
 Best site-Southeast_Asian          (3)  | Epoch:10 | Val Acc: 0.3636
 Best site-Southeast_Asian          (0)  | Epoch:10 | Val Acc: 0.3394
 Best site-Middle_Eastern           (5)  | Epoch:10 | Val Acc: 0.3636
 Best site-Middle_Eastern           (2)  | Epoch:10 | Val Acc: 0.3212
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 4, 2, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
min_w=0.09834, quan_i=1.77, quan_c=1.76
minimize weight of clients:[4, 5, 6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.7364 | Train Acc: 0.3659
 Site-White                    | Train Loss: 1.7135 | Train Acc: 0.3684
 Site-Latino_Hispanic          | Train Loss: 1.8253 | Train Acc: 0.3171
 Site-Latino_Hispanic          | Train Loss: 1.7412 | Train Acc: 0.2753
 Site-Black                    | Train Loss: 1.7544 | Train Acc: 0.3049
 Site-Black                    | Train Loss: 1.7400 | Train Acc: 0.3482
 Site-East_Asian               | Train Loss: 1.6279 | Train Acc: 0.4146
 Site-East_Asian               | Train Loss: 1.6873 | Train Acc: 0.4008
 Site-Indian                   | Train Loss: 1.7537 | Train Acc: 0.2683
 Site-Indian                   | Train Loss: 1.8153 | Train Acc: 0.2753
 Site-Southeast_Asian          | Train Loss: 1.8278 | Train Acc: 0.3293
 Site-Southeast_Asian          | Train Loss: 1.7999 | Train Acc: 0.3522
 Site-Middle_Eastern           | Train Loss: 1.6822 | Train Acc: 0.3659
 Site-Middle_Eastern           | Train Loss: 1.6938 | Train Acc: 0.3806
 Site-White                     (3) | Val  Loss: 1.8292 | Val  Acc: 0.3091
 Site-White                     (3) | Val  Loss: 1.7509 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7255 | Val  Acc: 0.3091
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7556 | Val  Acc: 0.2788
 Site-Black                     (2) | Val  Loss: 1.8259 | Val  Acc: 0.2545
 Site-Black                     (2) | Val  Loss: 1.7303 | Val  Acc: 0.3212
 Site-East_Asian                (6) | Val  Loss: 1.7579 | Val  Acc: 0.4000
 Site-East_Asian                (6) | Val  Loss: 1.6840 | Val  Acc: 0.4121
 Site-Indian                    (1) | Val  Loss: 1.6817 | Val  Acc: 0.4000
 Site-Indian                    (1) | Val  Loss: 1.7863 | Val  Acc: 0.2848
 Site-Southeast_Asian           (0) | Val  Loss: 1.8390 | Val  Acc: 0.3273
 Site-Southeast_Asian           (1) | Val  Loss: 1.7792 | Val  Acc: 0.3818
 Site-Middle_Eastern            (5) | Val  Loss: 1.7640 | Val  Acc: 0.3636
 Site-Middle_Eastern            (5) | Val  Loss: 1.7315 | Val  Acc: 0.3636
Average Valid Accuracy: 0.3433
Aggregated Acc | Val Acc: 0.3407
 Best site-White                    (3)  | Epoch:11 | Val Acc: 0.3091
 Best site-White                    (3)  | Epoch:11 | Val Acc: 0.4000
 Best site-Latino_Hispanic          (4)  | Epoch:11 | Val Acc: 0.3091
 Best site-Latino_Hispanic          (1)  | Epoch:11 | Val Acc: 0.2788
 Best site-Black                    (2)  | Epoch:11 | Val Acc: 0.2545
 Best site-Black                    (2)  | Epoch:11 | Val Acc: 0.3212
 Best site-East_Asian               (6)  | Epoch:11 | Val Acc: 0.4000
 Best site-East_Asian               (6)  | Epoch:11 | Val Acc: 0.4121
 Best site-Indian                   (1)  | Epoch:11 | Val Acc: 0.4000
 Best site-Indian                   (1)  | Epoch:11 | Val Acc: 0.2848
 Best site-Southeast_Asian          (0)  | Epoch:11 | Val Acc: 0.3273
 Best site-Southeast_Asian          (1)  | Epoch:11 | Val Acc: 0.3818
 Best site-Middle_Eastern           (5)  | Epoch:11 | Val Acc: 0.3636
 Best site-Middle_Eastern           (5)  | Epoch:11 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 12 ============
cnt=[7, 1, 1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
min_w=0.09569, quan_i=1.75, quan_c=1.76
minimize weight of clients:[1, 6, 12, ]
 Site-White                    | Train Loss: 1.7239 | Train Acc: 0.3902
 Site-White                    | Train Loss: 1.6913 | Train Acc: 0.3401
 Site-Latino_Hispanic          | Train Loss: 1.7057 | Train Acc: 0.3171
 Site-Latino_Hispanic          | Train Loss: 1.7128 | Train Acc: 0.2834
 Site-Black                    | Train Loss: 1.7941 | Train Acc: 0.2561
 Site-Black                    | Train Loss: 1.7069 | Train Acc: 0.3684
 Site-East_Asian               | Train Loss: 1.6137 | Train Acc: 0.5000
 Site-East_Asian               | Train Loss: 1.6768 | Train Acc: 0.4170
 Site-Indian                   | Train Loss: 1.7430 | Train Acc: 0.3293
 Site-Indian                   | Train Loss: 1.7745 | Train Acc: 0.3036
 Site-Southeast_Asian          | Train Loss: 1.8093 | Train Acc: 0.3049
 Site-Southeast_Asian          | Train Loss: 1.7647 | Train Acc: 0.3806
 Site-Middle_Eastern           | Train Loss: 1.6488 | Train Acc: 0.4268
 Site-Middle_Eastern           | Train Loss: 1.6821 | Train Acc: 0.4008
 Site-White                     (5) | Val  Loss: 1.8188 | Val  Acc: 0.3273
 Site-White                     (5) | Val  Loss: 1.7468 | Val  Acc: 0.3515
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7162 | Val  Acc: 0.3455
 Site-Latino_Hispanic           (0) | Val  Loss: 1.7107 | Val  Acc: 0.3091
 Site-Black                     (1) | Val  Loss: 1.8445 | Val  Acc: 0.2182
 Site-Black                     (3) | Val  Loss: 1.7060 | Val  Acc: 0.3697
 Site-East_Asian                (6) | Val  Loss: 1.6980 | Val  Acc: 0.4182
 Site-East_Asian                (0) | Val  Loss: 1.6588 | Val  Acc: 0.4303
 Site-Indian                    (0) | Val  Loss: 1.6749 | Val  Acc: 0.3818
 Site-Indian                    (0) | Val  Loss: 1.7509 | Val  Acc: 0.2970
 Site-Southeast_Asian           (0) | Val  Loss: 1.8158 | Val  Acc: 0.3455
 Site-Southeast_Asian           (0) | Val  Loss: 1.7615 | Val  Acc: 0.3879
 Site-Middle_Eastern            (2) | Val  Loss: 1.7554 | Val  Acc: 0.4182
 Site-Middle_Eastern            (0) | Val  Loss: 1.6886 | Val  Acc: 0.3758
Average Valid Accuracy: 0.3554
Aggregated Acc | Val Acc: 0.3529
 Best site-White                    (5)  | Epoch:12 | Val Acc: 0.3273
 Best site-White                    (5)  | Epoch:12 | Val Acc: 0.3515
 Best site-Latino_Hispanic          (4)  | Epoch:12 | Val Acc: 0.3455
 Best site-Latino_Hispanic          (0)  | Epoch:12 | Val Acc: 0.3091
 Best site-Black                    (1)  | Epoch:12 | Val Acc: 0.2182
 Best site-Black                    (3)  | Epoch:12 | Val Acc: 0.3697
 Best site-East_Asian               (6)  | Epoch:12 | Val Acc: 0.4182
 Best site-East_Asian               (0)  | Epoch:12 | Val Acc: 0.4303
 Best site-Indian                   (0)  | Epoch:12 | Val Acc: 0.3818
 Best site-Indian                   (0)  | Epoch:12 | Val Acc: 0.2970
 Best site-Southeast_Asian          (0)  | Epoch:12 | Val Acc: 0.3455
 Best site-Southeast_Asian          (0)  | Epoch:12 | Val Acc: 0.3879
 Best site-Middle_Eastern           (2)  | Epoch:12 | Val Acc: 0.4182
 Best site-Middle_Eastern           (0)  | Epoch:12 | Val Acc: 0.3758
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 13 ============
cnt=[4, 3, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
min_w=0.10001, quan_i=1.72, quan_c=1.75
minimize weight of clients:[1, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.6315 | Train Acc: 0.3537
 Site-White                    | Train Loss: 1.6943 | Train Acc: 0.3765
 Site-Latino_Hispanic          | Train Loss: 1.8142 | Train Acc: 0.3171
 Site-Latino_Hispanic          | Train Loss: 1.6864 | Train Acc: 0.3401
 Site-Black                    | Train Loss: 1.7569 | Train Acc: 0.2805
 Site-Black                    | Train Loss: 1.7169 | Train Acc: 0.3806
 Site-East_Asian               | Train Loss: 1.6130 | Train Acc: 0.5366
 Site-East_Asian               | Train Loss: 1.6461 | Train Acc: 0.3846
 Site-Indian                   | Train Loss: 1.7483 | Train Acc: 0.3537
 Site-Indian                   | Train Loss: 1.7399 | Train Acc: 0.3198
 Site-Southeast_Asian          | Train Loss: 1.8836 | Train Acc: 0.3659
 Site-Southeast_Asian          | Train Loss: 1.7445 | Train Acc: 0.3482
 Site-Middle_Eastern           | Train Loss: 1.6679 | Train Acc: 0.4024
 Site-Middle_Eastern           | Train Loss: 1.6629 | Train Acc: 0.4008
 Site-White                     (2) | Val  Loss: 1.8182 | Val  Acc: 0.3455
 Site-White                     (3) | Val  Loss: 1.7011 | Val  Acc: 0.3879
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7039 | Val  Acc: 0.3273
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6847 | Val  Acc: 0.3333
 Site-Black                     (4) | Val  Loss: 1.8147 | Val  Acc: 0.3091
 Site-Black                     (0) | Val  Loss: 1.7186 | Val  Acc: 0.3697
 Site-East_Asian                (1) | Val  Loss: 1.7203 | Val  Acc: 0.3818
 Site-East_Asian                (6) | Val  Loss: 1.6309 | Val  Acc: 0.4485
 Site-Indian                    (0) | Val  Loss: 1.6478 | Val  Acc: 0.3818
 Site-Indian                    (0) | Val  Loss: 1.6996 | Val  Acc: 0.3030
 Site-Southeast_Asian           (1) | Val  Loss: 1.7841 | Val  Acc: 0.4182
 Site-Southeast_Asian           (1) | Val  Loss: 1.7385 | Val  Acc: 0.3879
 Site-Middle_Eastern            (3) | Val  Loss: 1.7464 | Val  Acc: 0.4000
 Site-Middle_Eastern            (3) | Val  Loss: 1.6750 | Val  Acc: 0.4000
Average Valid Accuracy: 0.3710
Aggregated Acc | Val Acc: 0.3670
 Best site-White                    (2)  | Epoch:13 | Val Acc: 0.3455
 Best site-White                    (3)  | Epoch:13 | Val Acc: 0.3879
 Best site-Latino_Hispanic          (5)  | Epoch:13 | Val Acc: 0.3273
 Best site-Latino_Hispanic          (0)  | Epoch:13 | Val Acc: 0.3333
 Best site-Black                    (4)  | Epoch:13 | Val Acc: 0.3091
 Best site-Black                    (0)  | Epoch:13 | Val Acc: 0.3697
 Best site-East_Asian               (1)  | Epoch:13 | Val Acc: 0.3818
 Best site-East_Asian               (6)  | Epoch:13 | Val Acc: 0.4485
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.3818
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.3030
 Best site-Southeast_Asian          (1)  | Epoch:13 | Val Acc: 0.4182
 Best site-Southeast_Asian          (1)  | Epoch:13 | Val Acc: 0.3879
 Best site-Middle_Eastern           (3)  | Epoch:13 | Val Acc: 0.4000
 Best site-Middle_Eastern           (3)  | Epoch:13 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 5, 1, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
min_w=0.09733, quan_i=1.71, quan_c=1.72
minimize weight of clients:[0, 1, 12, 13, ]
 Site-White                    | Train Loss: 1.5340 | Train Acc: 0.3780
 Site-White                    | Train Loss: 1.6317 | Train Acc: 0.3603
 Site-Latino_Hispanic          | Train Loss: 1.7278 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.6565 | Train Acc: 0.3360
 Site-Black                    | Train Loss: 1.7033 | Train Acc: 0.3415
 Site-Black                    | Train Loss: 1.6697 | Train Acc: 0.3927
 Site-East_Asian               | Train Loss: 1.5838 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.6005 | Train Acc: 0.4130
 Site-Indian                   | Train Loss: 1.7072 | Train Acc: 0.3659
 Site-Indian                   | Train Loss: 1.6947 | Train Acc: 0.3401
 Site-Southeast_Asian          | Train Loss: 1.7706 | Train Acc: 0.3537
 Site-Southeast_Asian          | Train Loss: 1.6753 | Train Acc: 0.4089
 Site-Middle_Eastern           | Train Loss: 1.6376 | Train Acc: 0.4146
 Site-Middle_Eastern           | Train Loss: 1.6242 | Train Acc: 0.4130
 Site-White                     (5) | Val  Loss: 1.7829 | Val  Acc: 0.3455
 Site-White                     (5) | Val  Loss: 1.6713 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6391 | Val  Acc: 0.3455
 Site-Latino_Hispanic           (1) | Val  Loss: 1.6639 | Val  Acc: 0.3152
 Site-Black                     (3) | Val  Loss: 1.7491 | Val  Acc: 0.3455
 Site-Black                     (6) | Val  Loss: 1.6905 | Val  Acc: 0.3758
 Site-East_Asian                (1) | Val  Loss: 1.6879 | Val  Acc: 0.4182
 Site-East_Asian                (1) | Val  Loss: 1.6028 | Val  Acc: 0.4485
 Site-Indian                    (0) | Val  Loss: 1.5920 | Val  Acc: 0.4364
 Site-Indian                    (0) | Val  Loss: 1.6713 | Val  Acc: 0.3152
 Site-Southeast_Asian           (1) | Val  Loss: 1.7302 | Val  Acc: 0.4182
 Site-Southeast_Asian           (1) | Val  Loss: 1.6714 | Val  Acc: 0.4303
 Site-Middle_Eastern            (2) | Val  Loss: 1.7135 | Val  Acc: 0.4000
 Site-Middle_Eastern            (5) | Val  Loss: 1.6343 | Val  Acc: 0.3879
Average Valid Accuracy: 0.3818
Aggregated Acc | Val Acc: 0.3734
 Best site-White                    (5)  | Epoch:14 | Val Acc: 0.3455
 Best site-White                    (5)  | Epoch:14 | Val Acc: 0.3636
 Best site-Latino_Hispanic          (4)  | Epoch:14 | Val Acc: 0.3455
 Best site-Latino_Hispanic          (1)  | Epoch:14 | Val Acc: 0.3152
 Best site-Black                    (3)  | Epoch:14 | Val Acc: 0.3455
 Best site-Black                    (6)  | Epoch:14 | Val Acc: 0.3758
 Best site-East_Asian               (1)  | Epoch:14 | Val Acc: 0.4182
 Best site-East_Asian               (1)  | Epoch:14 | Val Acc: 0.4485
 Best site-Indian                   (0)  | Epoch:14 | Val Acc: 0.4364
 Best site-Indian                   (0)  | Epoch:14 | Val Acc: 0.3152
 Best site-Southeast_Asian          (1)  | Epoch:14 | Val Acc: 0.4182
 Best site-Southeast_Asian          (1)  | Epoch:14 | Val Acc: 0.4303
 Best site-Middle_Eastern           (2)  | Epoch:14 | Val Acc: 0.4000
 Best site-Middle_Eastern           (5)  | Epoch:14 | Val Acc: 0.3879
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 2, 2, 1, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
min_w=0.08764, quan_i=1.68, quan_c=1.67
minimize weight of clients:[0, 1, 6, 12, 13, ]
 Site-White                    | Train Loss: 1.6418 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.6131 | Train Acc: 0.3968
 Site-Latino_Hispanic          | Train Loss: 1.7215 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.6566 | Train Acc: 0.3563
 Site-Black                    | Train Loss: 1.6922 | Train Acc: 0.3537
 Site-Black                    | Train Loss: 1.6703 | Train Acc: 0.4008
 Site-East_Asian               | Train Loss: 1.4522 | Train Acc: 0.4878
 Site-East_Asian               | Train Loss: 1.5692 | Train Acc: 0.4291
 Site-Indian                   | Train Loss: 1.6786 | Train Acc: 0.3902
 Site-Indian                   | Train Loss: 1.6634 | Train Acc: 0.3360
 Site-Southeast_Asian          | Train Loss: 1.7298 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.6520 | Train Acc: 0.3968
 Site-Middle_Eastern           | Train Loss: 1.6213 | Train Acc: 0.4146
 Site-Middle_Eastern           | Train Loss: 1.5723 | Train Acc: 0.4251
 Site-White                     (4) | Val  Loss: 1.7280 | Val  Acc: 0.3273
 Site-White                     (4) | Val  Loss: 1.6593 | Val  Acc: 0.3515
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5924 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (6) | Val  Loss: 1.6217 | Val  Acc: 0.3515
 Site-Black                     (5) | Val  Loss: 1.8042 | Val  Acc: 0.3091
 Site-Black                     (5) | Val  Loss: 1.6780 | Val  Acc: 0.3758
 Site-East_Asian                (0) | Val  Loss: 1.6611 | Val  Acc: 0.3636
 Site-East_Asian                (6) | Val  Loss: 1.5237 | Val  Acc: 0.4727
 Site-Indian                    (2) | Val  Loss: 1.5731 | Val  Acc: 0.4000
 Site-Indian                    (2) | Val  Loss: 1.6358 | Val  Acc: 0.3394
 Site-Southeast_Asian           (6) | Val  Loss: 1.6902 | Val  Acc: 0.4727
 Site-Southeast_Asian           (6) | Val  Loss: 1.6159 | Val  Acc: 0.4485
 Site-Middle_Eastern            (1) | Val  Loss: 1.6487 | Val  Acc: 0.3818
 Site-Middle_Eastern            (1) | Val  Loss: 1.6009 | Val  Acc: 0.3939
Average Valid Accuracy: 0.3823
Aggregated Acc | Val Acc: 0.3719
 Best site-White                    (4)  | Epoch:15 | Val Acc: 0.3273
 Best site-White                    (4)  | Epoch:15 | Val Acc: 0.3515
 Best site-Latino_Hispanic          (3)  | Epoch:15 | Val Acc: 0.3636
 Best site-Latino_Hispanic          (6)  | Epoch:15 | Val Acc: 0.3515
 Best site-Black                    (5)  | Epoch:15 | Val Acc: 0.3091
 Best site-Black                    (5)  | Epoch:15 | Val Acc: 0.3758
 Best site-East_Asian               (0)  | Epoch:15 | Val Acc: 0.3636
 Best site-East_Asian               (6)  | Epoch:15 | Val Acc: 0.4727
 Best site-Indian                   (2)  | Epoch:15 | Val Acc: 0.4000
 Best site-Indian                   (2)  | Epoch:15 | Val Acc: 0.3394
 Best site-Southeast_Asian          (6)  | Epoch:15 | Val Acc: 0.4727
 Best site-Southeast_Asian          (6)  | Epoch:15 | Val Acc: 0.4485
 Best site-Middle_Eastern           (1)  | Epoch:15 | Val Acc: 0.3818
 Best site-Middle_Eastern           (1)  | Epoch:15 | Val Acc: 0.3939
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 1, 5, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
min_w=0.08412, quan_i=1.67, quan_c=1.64
minimize weight of clients:[6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.5420 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.5913 | Train Acc: 0.3968
 Site-Latino_Hispanic          | Train Loss: 1.6881 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.5887 | Train Acc: 0.3684
 Site-Black                    | Train Loss: 1.6948 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.6144 | Train Acc: 0.3806
 Site-East_Asian               | Train Loss: 1.5322 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.5554 | Train Acc: 0.4170
 Site-Indian                   | Train Loss: 1.6662 | Train Acc: 0.3659
 Site-Indian                   | Train Loss: 1.6482 | Train Acc: 0.3158
 Site-Southeast_Asian          | Train Loss: 1.6635 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.5956 | Train Acc: 0.4291
 Site-Middle_Eastern           | Train Loss: 1.4891 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.5563 | Train Acc: 0.4130
 Site-White                     (6) | Val  Loss: 1.7538 | Val  Acc: 0.3455
 Site-White                     (6) | Val  Loss: 1.6186 | Val  Acc: 0.3818
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5672 | Val  Acc: 0.4182
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5972 | Val  Acc: 0.3697
 Site-Black                     (3) | Val  Loss: 1.7429 | Val  Acc: 0.3091
 Site-Black                     (3) | Val  Loss: 1.6483 | Val  Acc: 0.3939
 Site-East_Asian                (2) | Val  Loss: 1.6227 | Val  Acc: 0.3273
 Site-East_Asian                (2) | Val  Loss: 1.5309 | Val  Acc: 0.4606
 Site-Indian                    (4) | Val  Loss: 1.5179 | Val  Acc: 0.4000
 Site-Indian                    (4) | Val  Loss: 1.6177 | Val  Acc: 0.3333
 Site-Southeast_Asian           (2) | Val  Loss: 1.7128 | Val  Acc: 0.4000
 Site-Southeast_Asian           (2) | Val  Loss: 1.6123 | Val  Acc: 0.3879
 Site-Middle_Eastern            (5) | Val  Loss: 1.6445 | Val  Acc: 0.4182
 Site-Middle_Eastern            (0) | Val  Loss: 1.5967 | Val  Acc: 0.4061
Average Valid Accuracy: 0.3823
Aggregated Acc | Val Acc: 0.3876
 Best site-White                    (6)  | Epoch:16 | Val Acc: 0.3455
 Best site-White                    (6)  | Epoch:16 | Val Acc: 0.3818
 Best site-Latino_Hispanic          (1)  | Epoch:16 | Val Acc: 0.4182
 Best site-Latino_Hispanic          (2)  | Epoch:16 | Val Acc: 0.3697
 Best site-Black                    (3)  | Epoch:16 | Val Acc: 0.3091
 Best site-Black                    (3)  | Epoch:16 | Val Acc: 0.3939
 Best site-East_Asian               (2)  | Epoch:16 | Val Acc: 0.3273
 Best site-East_Asian               (2)  | Epoch:16 | Val Acc: 0.4606
 Best site-Indian                   (4)  | Epoch:16 | Val Acc: 0.4000
 Best site-Indian                   (4)  | Epoch:16 | Val Acc: 0.3333
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.4000
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.3879
 Best site-Middle_Eastern           (5)  | Epoch:16 | Val Acc: 0.4182
 Best site-Middle_Eastern           (0)  | Epoch:16 | Val Acc: 0.4061
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 17 ============
cnt=[1, 4, 2, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
min_w=0.07932, quan_i=1.61, quan_c=1.59
minimize weight of clients:[6, 7, 12, ]
 Site-White                    | Train Loss: 1.4762 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.5669 | Train Acc: 0.4049
 Site-Latino_Hispanic          | Train Loss: 1.6030 | Train Acc: 0.3293
 Site-Latino_Hispanic          | Train Loss: 1.5871 | Train Acc: 0.3603
 Site-Black                    | Train Loss: 1.6573 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.6250 | Train Acc: 0.3684
 Site-East_Asian               | Train Loss: 1.4243 | Train Acc: 0.5244
 Site-East_Asian               | Train Loss: 1.5715 | Train Acc: 0.4008
 Site-Indian                   | Train Loss: 1.6771 | Train Acc: 0.3780
 Site-Indian                   | Train Loss: 1.6114 | Train Acc: 0.3522
 Site-Southeast_Asian          | Train Loss: 1.7445 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.6171 | Train Acc: 0.4008
 Site-Middle_Eastern           | Train Loss: 1.5176 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.5409 | Train Acc: 0.4332
 Site-White                     (1) | Val  Loss: 1.7333 | Val  Acc: 0.3273
 Site-White                     (1) | Val  Loss: 1.6020 | Val  Acc: 0.3818
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5827 | Val  Acc: 0.3455
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5372 | Val  Acc: 0.4121
 Site-Black                     (3) | Val  Loss: 1.6996 | Val  Acc: 0.3455
 Site-Black                     (3) | Val  Loss: 1.6376 | Val  Acc: 0.3879
 Site-East_Asian                (5) | Val  Loss: 1.6752 | Val  Acc: 0.3455
 Site-East_Asian                (5) | Val  Loss: 1.5376 | Val  Acc: 0.4000
 Site-Indian                    (2) | Val  Loss: 1.5463 | Val  Acc: 0.4182
 Site-Indian                    (2) | Val  Loss: 1.5732 | Val  Acc: 0.4000
 Site-Southeast_Asian           (0) | Val  Loss: 1.6809 | Val  Acc: 0.4727
 Site-Southeast_Asian           (5) | Val  Loss: 1.6082 | Val  Acc: 0.4121
 Site-Middle_Eastern            (4) | Val  Loss: 1.6800 | Val  Acc: 0.4182
 Site-Middle_Eastern            (1) | Val  Loss: 1.5544 | Val  Acc: 0.4364
Average Valid Accuracy: 0.3931
Aggregated Acc | Val Acc: 0.3982
 Best site-White                    (1)  | Epoch:17 | Val Acc: 0.3273
 Best site-White                    (1)  | Epoch:17 | Val Acc: 0.3818
 Best site-Latino_Hispanic          (6)  | Epoch:17 | Val Acc: 0.3455
 Best site-Latino_Hispanic          (1)  | Epoch:17 | Val Acc: 0.4121
 Best site-Black                    (3)  | Epoch:17 | Val Acc: 0.3455
 Best site-Black                    (3)  | Epoch:17 | Val Acc: 0.3879
 Best site-East_Asian               (5)  | Epoch:17 | Val Acc: 0.3455
 Best site-East_Asian               (5)  | Epoch:17 | Val Acc: 0.4000
 Best site-Indian                   (2)  | Epoch:17 | Val Acc: 0.4182
 Best site-Indian                   (2)  | Epoch:17 | Val Acc: 0.4000
 Best site-Southeast_Asian          (0)  | Epoch:17 | Val Acc: 0.4727
 Best site-Southeast_Asian          (5)  | Epoch:17 | Val Acc: 0.4121
 Best site-Middle_Eastern           (4)  | Epoch:17 | Val Acc: 0.4182
 Best site-Middle_Eastern           (1)  | Epoch:17 | Val Acc: 0.4364
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 3, 4, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
min_w=0.07266, quan_i=1.60, quan_c=1.62
minimize weight of clients:[0, 1, 6, 12, 13, ]
 Site-White                    | Train Loss: 1.6516 | Train Acc: 0.3659
 Site-White                    | Train Loss: 1.5773 | Train Acc: 0.4089
 Site-Latino_Hispanic          | Train Loss: 1.6944 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.5550 | Train Acc: 0.4332
 Site-Black                    | Train Loss: 1.5855 | Train Acc: 0.4146
 Site-Black                    | Train Loss: 1.6209 | Train Acc: 0.4089
 Site-East_Asian               | Train Loss: 1.4083 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.5349 | Train Acc: 0.4170
 Site-Indian                   | Train Loss: 1.5186 | Train Acc: 0.3659
 Site-Indian                   | Train Loss: 1.5991 | Train Acc: 0.3765
 Site-Southeast_Asian          | Train Loss: 1.5575 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.5909 | Train Acc: 0.4251
 Site-Middle_Eastern           | Train Loss: 1.4355 | Train Acc: 0.4390
 Site-Middle_Eastern           | Train Loss: 1.5186 | Train Acc: 0.4332
 Site-White                     (6) | Val  Loss: 1.7232 | Val  Acc: 0.3636
 Site-White                     (6) | Val  Loss: 1.6130 | Val  Acc: 0.3758
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5565 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5758 | Val  Acc: 0.3818
 Site-Black                     (4) | Val  Loss: 1.7482 | Val  Acc: 0.3273
 Site-Black                     (4) | Val  Loss: 1.6064 | Val  Acc: 0.4000
 Site-East_Asian                (5) | Val  Loss: 1.6700 | Val  Acc: 0.3636
 Site-East_Asian                (2) | Val  Loss: 1.5046 | Val  Acc: 0.4364
 Site-Indian                    (1) | Val  Loss: 1.4807 | Val  Acc: 0.4182
 Site-Indian                    (1) | Val  Loss: 1.5118 | Val  Acc: 0.3758
 Site-Southeast_Asian           (2) | Val  Loss: 1.6901 | Val  Acc: 0.4364
 Site-Southeast_Asian           (2) | Val  Loss: 1.5663 | Val  Acc: 0.4061
 Site-Middle_Eastern            (0) | Val  Loss: 1.5941 | Val  Acc: 0.3636
 Site-Middle_Eastern            (3) | Val  Loss: 1.5272 | Val  Acc: 0.4303
Average Valid Accuracy: 0.3913
Aggregated Acc | Val Acc: 0.3863
============ Train epoch 19 ============
cnt=[1, 4, 3, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
min_w=0.07736, quan_i=1.57, quan_c=1.59
minimize weight of clients:[6, 7, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.5283 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.5328 | Train Acc: 0.4049
 Site-Latino_Hispanic          | Train Loss: 1.6983 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.5568 | Train Acc: 0.3887
 Site-Black                    | Train Loss: 1.6573 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.5979 | Train Acc: 0.4089
 Site-East_Asian               | Train Loss: 1.4950 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.5425 | Train Acc: 0.4413
 Site-Indian                   | Train Loss: 1.5451 | Train Acc: 0.3902
 Site-Indian                   | Train Loss: 1.5711 | Train Acc: 0.3846
 Site-Southeast_Asian          | Train Loss: 1.6836 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.5783 | Train Acc: 0.4372
 Site-Middle_Eastern           | Train Loss: 1.5413 | Train Acc: 0.4146
 Site-Middle_Eastern           | Train Loss: 1.5018 | Train Acc: 0.4211
 Site-White                     (5) | Val  Loss: 1.7123 | Val  Acc: 0.3273
 Site-White                     (5) | Val  Loss: 1.5744 | Val  Acc: 0.3939
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5465 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5224 | Val  Acc: 0.4061
 Site-Black                     (6) | Val  Loss: 1.6789 | Val  Acc: 0.3091
 Site-Black                     (4) | Val  Loss: 1.5996 | Val  Acc: 0.3636
 Site-East_Asian                (2) | Val  Loss: 1.6362 | Val  Acc: 0.3636
 Site-East_Asian                (0) | Val  Loss: 1.5062 | Val  Acc: 0.4485
 Site-Indian                    (1) | Val  Loss: 1.4972 | Val  Acc: 0.4727
 Site-Indian                    (1) | Val  Loss: 1.5270 | Val  Acc: 0.3939
 Site-Southeast_Asian           (2) | Val  Loss: 1.6301 | Val  Acc: 0.4727
 Site-Southeast_Asian           (2) | Val  Loss: 1.5513 | Val  Acc: 0.4121
 Site-Middle_Eastern            (3) | Val  Loss: 1.6280 | Val  Acc: 0.4364
 Site-Middle_Eastern            (3) | Val  Loss: 1.5295 | Val  Acc: 0.4121
Average Valid Accuracy: 0.3983
Aggregated Acc | Val Acc: 0.3902
 Best site-White                    (5)  | Epoch:19 | Val Acc: 0.3273
 Best site-White                    (5)  | Epoch:19 | Val Acc: 0.3939
 Best site-Latino_Hispanic          (1)  | Epoch:19 | Val Acc: 0.3636
 Best site-Latino_Hispanic          (1)  | Epoch:19 | Val Acc: 0.4061
 Best site-Black                    (6)  | Epoch:19 | Val Acc: 0.3091
 Best site-Black                    (4)  | Epoch:19 | Val Acc: 0.3636
 Best site-East_Asian               (2)  | Epoch:19 | Val Acc: 0.3636
 Best site-East_Asian               (0)  | Epoch:19 | Val Acc: 0.4485
 Best site-Indian                   (1)  | Epoch:19 | Val Acc: 0.4727
 Best site-Indian                   (1)  | Epoch:19 | Val Acc: 0.3939
 Best site-Southeast_Asian          (2)  | Epoch:19 | Val Acc: 0.4727
 Best site-Southeast_Asian          (2)  | Epoch:19 | Val Acc: 0.4121
 Best site-Middle_Eastern           (3)  | Epoch:19 | Val Acc: 0.4364
 Best site-Middle_Eastern           (3)  | Epoch:19 | Val Acc: 0.4121
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
 Test site-White                    | Epoch:19 | Test Acc: 0.3683
 Test site-Latino_Hispanic          | Epoch:19 | Test Acc: 0.3296
 Test site-Black                    | Epoch:19 | Test Acc: 0.3239
 Test site-East_Asian               | Epoch:19 | Test Acc: 0.4497
 Test site-Indian                   | Epoch:19 | Test Acc: 0.3120
 Test site-Southeast_Asian          | Epoch:19 | Test Acc: 0.3936
 Test site-Middle_Eastern           | Epoch:19 | Test Acc: 0.3532
Average Test Accuracy: 0.3615, domain std=0.0444, individual std=0.0444
============ Train epoch 20 ============
cnt=[4, 2, 2, 1, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
min_w=0.08174, quan_i=1.56, quan_c=1.57
minimize weight of clients:[0, 1, 6, 13, ]
 Site-White                    | Train Loss: 1.5672 | Train Acc: 0.3780
 Site-White                    | Train Loss: 1.5536 | Train Acc: 0.4089
 Site-Latino_Hispanic          | Train Loss: 1.6796 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.5425 | Train Acc: 0.3887
 Site-Black                    | Train Loss: 1.5905 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.5973 | Train Acc: 0.4089
 Site-East_Asian               | Train Loss: 1.4787 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.5229 | Train Acc: 0.4332
 Site-Indian                   | Train Loss: 1.6004 | Train Acc: 0.3659
 Site-Indian                   | Train Loss: 1.5604 | Train Acc: 0.3806
 Site-Southeast_Asian          | Train Loss: 1.7165 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.5694 | Train Acc: 0.4453
 Site-Middle_Eastern           | Train Loss: 1.4276 | Train Acc: 0.4390
 Site-Middle_Eastern           | Train Loss: 1.5095 | Train Acc: 0.4656
 Site-White                     (0) | Val  Loss: 1.7110 | Val  Acc: 0.3273
 Site-White                     (0) | Val  Loss: 1.5861 | Val  Acc: 0.3818
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5190 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5091 | Val  Acc: 0.3879
 Site-Black                     (2) | Val  Loss: 1.7113 | Val  Acc: 0.3273
 Site-Black                     (2) | Val  Loss: 1.6446 | Val  Acc: 0.3818
 Site-East_Asian                (4) | Val  Loss: 1.6040 | Val  Acc: 0.4182
 Site-East_Asian                (5) | Val  Loss: 1.4952 | Val  Acc: 0.4303
 Site-Indian                    (1) | Val  Loss: 1.5154 | Val  Acc: 0.3818
 Site-Indian                    (1) | Val  Loss: 1.5390 | Val  Acc: 0.3939
 Site-Southeast_Asian           (6) | Val  Loss: 1.5756 | Val  Acc: 0.4909
 Site-Southeast_Asian           (6) | Val  Loss: 1.5323 | Val  Acc: 0.4364
 Site-Middle_Eastern            (0) | Val  Loss: 1.5735 | Val  Acc: 0.4364
 Site-Middle_Eastern            (0) | Val  Loss: 1.5208 | Val  Acc: 0.4485
Average Valid Accuracy: 0.4004
Aggregated Acc | Val Acc: 0.3994
 Best site-White                    (0)  | Epoch:20 | Val Acc: 0.3273
 Best site-White                    (0)  | Epoch:20 | Val Acc: 0.3818
 Best site-Latino_Hispanic          (3)  | Epoch:20 | Val Acc: 0.3636
 Best site-Latino_Hispanic          (5)  | Epoch:20 | Val Acc: 0.3879
 Best site-Black                    (2)  | Epoch:20 | Val Acc: 0.3273
 Best site-Black                    (2)  | Epoch:20 | Val Acc: 0.3818
 Best site-East_Asian               (4)  | Epoch:20 | Val Acc: 0.4182
 Best site-East_Asian               (5)  | Epoch:20 | Val Acc: 0.4303
 Best site-Indian                   (1)  | Epoch:20 | Val Acc: 0.3818
 Best site-Indian                   (1)  | Epoch:20 | Val Acc: 0.3939
 Best site-Southeast_Asian          (6)  | Epoch:20 | Val Acc: 0.4909
 Best site-Southeast_Asian          (6)  | Epoch:20 | Val Acc: 0.4364
 Best site-Middle_Eastern           (0)  | Epoch:20 | Val Acc: 0.4364
 Best site-Middle_Eastern           (0)  | Epoch:20 | Val Acc: 0.4485
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 21 ============
cnt=[1, 1, 4, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
min_w=0.07266, quan_i=1.57, quan_c=1.57
minimize weight of clients:[1, 3, 12, 13, ]
 Site-White                    | Train Loss: 1.5161 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.5545 | Train Acc: 0.3806
 Site-Latino_Hispanic          | Train Loss: 1.6287 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.5414 | Train Acc: 0.4089
 Site-Black                    | Train Loss: 1.7455 | Train Acc: 0.4146
 Site-Black                    | Train Loss: 1.5784 | Train Acc: 0.4211
 Site-East_Asian               | Train Loss: 1.4843 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.4970 | Train Acc: 0.4291
 Site-Indian                   | Train Loss: 1.5155 | Train Acc: 0.4146
 Site-Indian                   | Train Loss: 1.5498 | Train Acc: 0.3765
 Site-Southeast_Asian          | Train Loss: 1.6316 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.5515 | Train Acc: 0.4413
 Site-Middle_Eastern           | Train Loss: 1.4960 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.4806 | Train Acc: 0.4211
 Site-White                     (2) | Val  Loss: 1.6923 | Val  Acc: 0.3636
 Site-White                     (2) | Val  Loss: 1.5247 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5146 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5315 | Val  Acc: 0.3939
 Site-Black                     (3) | Val  Loss: 1.6712 | Val  Acc: 0.3636
 Site-Black                     (6) | Val  Loss: 1.6319 | Val  Acc: 0.3455
 Site-East_Asian                (4) | Val  Loss: 1.6019 | Val  Acc: 0.4182
 Site-East_Asian                (4) | Val  Loss: 1.4609 | Val  Acc: 0.4485
 Site-Indian                    (5) | Val  Loss: 1.4745 | Val  Acc: 0.3636
 Site-Indian                    (4) | Val  Loss: 1.5409 | Val  Acc: 0.4000
 Site-Southeast_Asian           (4) | Val  Loss: 1.6662 | Val  Acc: 0.4545
 Site-Southeast_Asian           (4) | Val  Loss: 1.5223 | Val  Acc: 0.4364
 Site-Middle_Eastern            (0) | Val  Loss: 1.5899 | Val  Acc: 0.4364
 Site-Middle_Eastern            (2) | Val  Loss: 1.5287 | Val  Acc: 0.4000
Average Valid Accuracy: 0.4017
Aggregated Acc | Val Acc: 0.3894
 Best site-White                    (2)  | Epoch:21 | Val Acc: 0.3636
 Best site-White                    (2)  | Epoch:21 | Val Acc: 0.4000
 Best site-Latino_Hispanic          (2)  | Epoch:21 | Val Acc: 0.4000
 Best site-Latino_Hispanic          (1)  | Epoch:21 | Val Acc: 0.3939
 Best site-Black                    (3)  | Epoch:21 | Val Acc: 0.3636
 Best site-Black                    (6)  | Epoch:21 | Val Acc: 0.3455
 Best site-East_Asian               (4)  | Epoch:21 | Val Acc: 0.4182
 Best site-East_Asian               (4)  | Epoch:21 | Val Acc: 0.4485
 Best site-Indian                   (5)  | Epoch:21 | Val Acc: 0.3636
 Best site-Indian                   (4)  | Epoch:21 | Val Acc: 0.4000
 Best site-Southeast_Asian          (4)  | Epoch:21 | Val Acc: 0.4545
 Best site-Southeast_Asian          (4)  | Epoch:21 | Val Acc: 0.4364
 Best site-Middle_Eastern           (0)  | Epoch:21 | Val Acc: 0.4364
 Best site-Middle_Eastern           (2)  | Epoch:21 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 22 ============
cnt=[4, 2, 3, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
min_w=0.07932, quan_i=1.56, quan_c=1.55
minimize weight of clients:[0, 6, 12, 13, ]
 Site-White                    | Train Loss: 1.5140 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.5168 | Train Acc: 0.4170
 Site-Latino_Hispanic          | Train Loss: 1.5863 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.5162 | Train Acc: 0.3927
 Site-Black                    | Train Loss: 1.6437 | Train Acc: 0.4146
 Site-Black                    | Train Loss: 1.5908 | Train Acc: 0.4049
 Site-East_Asian               | Train Loss: 1.3817 | Train Acc: 0.5000
 Site-East_Asian               | Train Loss: 1.4864 | Train Acc: 0.4372
 Site-Indian                   | Train Loss: 1.5794 | Train Acc: 0.3537
 Site-Indian                   | Train Loss: 1.5395 | Train Acc: 0.3927
 Site-Southeast_Asian          | Train Loss: 1.6149 | Train Acc: 0.4512
 Site-Southeast_Asian          | Train Loss: 1.5494 | Train Acc: 0.4372
 Site-Middle_Eastern           | Train Loss: 1.4897 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.4782 | Train Acc: 0.4251
 Site-White                     (0) | Val  Loss: 1.6584 | Val  Acc: 0.3455
 Site-White                     (0) | Val  Loss: 1.5706 | Val  Acc: 0.3939
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5377 | Val  Acc: 0.3455
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5092 | Val  Acc: 0.4242
 Site-Black                     (1) | Val  Loss: 1.6925 | Val  Acc: 0.3091
 Site-Black                     (1) | Val  Loss: 1.6215 | Val  Acc: 0.4061
 Site-East_Asian                (6) | Val  Loss: 1.6104 | Val  Acc: 0.3455
 Site-East_Asian                (2) | Val  Loss: 1.4462 | Val  Acc: 0.4424
 Site-Indian                    (4) | Val  Loss: 1.4478 | Val  Acc: 0.5273
 Site-Indian                    (4) | Val  Loss: 1.5415 | Val  Acc: 0.3939
 Site-Southeast_Asian           (2) | Val  Loss: 1.6335 | Val  Acc: 0.4727
 Site-Southeast_Asian           (2) | Val  Loss: 1.5202 | Val  Acc: 0.4606
 Site-Middle_Eastern            (3) | Val  Loss: 1.6008 | Val  Acc: 0.4364
 Site-Middle_Eastern            (0) | Val  Loss: 1.5266 | Val  Acc: 0.4061
Average Valid Accuracy: 0.4078
Aggregated Acc | Val Acc: 0.3995
 Best site-White                    (0)  | Epoch:22 | Val Acc: 0.3455
 Best site-White                    (0)  | Epoch:22 | Val Acc: 0.3939
 Best site-Latino_Hispanic          (5)  | Epoch:22 | Val Acc: 0.3455
 Best site-Latino_Hispanic          (0)  | Epoch:22 | Val Acc: 0.4242
 Best site-Black                    (1)  | Epoch:22 | Val Acc: 0.3091
 Best site-Black                    (1)  | Epoch:22 | Val Acc: 0.4061
 Best site-East_Asian               (6)  | Epoch:22 | Val Acc: 0.3455
 Best site-East_Asian               (2)  | Epoch:22 | Val Acc: 0.4424
 Best site-Indian                   (4)  | Epoch:22 | Val Acc: 0.5273
 Best site-Indian                   (4)  | Epoch:22 | Val Acc: 0.3939
 Best site-Southeast_Asian          (2)  | Epoch:22 | Val Acc: 0.4727
 Best site-Southeast_Asian          (2)  | Epoch:22 | Val Acc: 0.4606
 Best site-Middle_Eastern           (3)  | Epoch:22 | Val Acc: 0.4364
 Best site-Middle_Eastern           (0)  | Epoch:22 | Val Acc: 0.4061
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 23 ============
cnt=[1, 3, 3, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
min_w=0.07408, quan_i=1.55, quan_c=1.53
minimize weight of clients:[3, 6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.5314 | Train Acc: 0.4878
 Site-White                    | Train Loss: 1.4959 | Train Acc: 0.4049
 Site-Latino_Hispanic          | Train Loss: 1.5825 | Train Acc: 0.4146
 Site-Latino_Hispanic          | Train Loss: 1.5246 | Train Acc: 0.3806
 Site-Black                    | Train Loss: 1.5642 | Train Acc: 0.4268
 Site-Black                    | Train Loss: 1.5673 | Train Acc: 0.4332
 Site-East_Asian               | Train Loss: 1.3571 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.4929 | Train Acc: 0.4049
 Site-Indian                   | Train Loss: 1.5191 | Train Acc: 0.4390
 Site-Indian                   | Train Loss: 1.5317 | Train Acc: 0.4211
 Site-Southeast_Asian          | Train Loss: 1.5586 | Train Acc: 0.4634
 Site-Southeast_Asian          | Train Loss: 1.5313 | Train Acc: 0.4332
 Site-Middle_Eastern           | Train Loss: 1.4935 | Train Acc: 0.4390
 Site-Middle_Eastern           | Train Loss: 1.4794 | Train Acc: 0.4291
 Site-White                     (5) | Val  Loss: 1.6104 | Val  Acc: 0.4364
 Site-White                     (5) | Val  Loss: 1.5348 | Val  Acc: 0.4121
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4836 | Val  Acc: 0.3273
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4683 | Val  Acc: 0.4424
 Site-Black                     (6) | Val  Loss: 1.6565 | Val  Acc: 0.4182
 Site-Black                     (3) | Val  Loss: 1.6277 | Val  Acc: 0.4121
 Site-East_Asian                (2) | Val  Loss: 1.6146 | Val  Acc: 0.3273
 Site-East_Asian                (2) | Val  Loss: 1.4687 | Val  Acc: 0.4606
 Site-Indian                    (3) | Val  Loss: 1.4414 | Val  Acc: 0.4545
 Site-Indian                    (3) | Val  Loss: 1.5180 | Val  Acc: 0.3576
 Site-Southeast_Asian           (4) | Val  Loss: 1.6489 | Val  Acc: 0.4545
 Site-Southeast_Asian           (2) | Val  Loss: 1.4940 | Val  Acc: 0.4364
 Site-Middle_Eastern            (1) | Val  Loss: 1.6340 | Val  Acc: 0.4000
 Site-Middle_Eastern            (1) | Val  Loss: 1.5024 | Val  Acc: 0.4242
Average Valid Accuracy: 0.4117
Aggregated Acc | Val Acc: 0.4089
 Best site-White                    (5)  | Epoch:23 | Val Acc: 0.4364
 Best site-White                    (5)  | Epoch:23 | Val Acc: 0.4121
 Best site-Latino_Hispanic          (0)  | Epoch:23 | Val Acc: 0.3273
 Best site-Latino_Hispanic          (1)  | Epoch:23 | Val Acc: 0.4424
 Best site-Black                    (6)  | Epoch:23 | Val Acc: 0.4182
 Best site-Black                    (3)  | Epoch:23 | Val Acc: 0.4121
 Best site-East_Asian               (2)  | Epoch:23 | Val Acc: 0.3273
 Best site-East_Asian               (2)  | Epoch:23 | Val Acc: 0.4606
 Best site-Indian                   (3)  | Epoch:23 | Val Acc: 0.4545
 Best site-Indian                   (3)  | Epoch:23 | Val Acc: 0.3576
 Best site-Southeast_Asian          (4)  | Epoch:23 | Val Acc: 0.4545
 Best site-Southeast_Asian          (2)  | Epoch:23 | Val Acc: 0.4364
 Best site-Middle_Eastern           (1)  | Epoch:23 | Val Acc: 0.4000
 Best site-Middle_Eastern           (1)  | Epoch:23 | Val Acc: 0.4242
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 4, 3, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
min_w=0.07335, quan_i=1.54, quan_c=1.51
minimize weight of clients:[1, 6, 7, 13, ]
 Site-White                    | Train Loss: 1.5345 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.5287 | Train Acc: 0.4130
 Site-Latino_Hispanic          | Train Loss: 1.5723 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.5256 | Train Acc: 0.3887
 Site-Black                    | Train Loss: 1.5471 | Train Acc: 0.4024
 Site-Black                    | Train Loss: 1.5368 | Train Acc: 0.4130
 Site-East_Asian               | Train Loss: 1.5030 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.5030 | Train Acc: 0.4291
 Site-Indian                   | Train Loss: 1.4271 | Train Acc: 0.4268
 Site-Indian                   | Train Loss: 1.5224 | Train Acc: 0.3927
 Site-Southeast_Asian          | Train Loss: 1.5400 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.5591 | Train Acc: 0.4453
 Site-Middle_Eastern           | Train Loss: 1.3554 | Train Acc: 0.4268
 Site-Middle_Eastern           | Train Loss: 1.4534 | Train Acc: 0.4332
 Site-White                     (2) | Val  Loss: 1.6600 | Val  Acc: 0.3455
 Site-White                     (2) | Val  Loss: 1.5571 | Val  Acc: 0.4061
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4538 | Val  Acc: 0.4727
 Site-Latino_Hispanic           (1) | Val  Loss: 1.5124 | Val  Acc: 0.4121
 Site-Black                     (5) | Val  Loss: 1.6032 | Val  Acc: 0.4000
 Site-Black                     (5) | Val  Loss: 1.6052 | Val  Acc: 0.3818
 Site-East_Asian                (1) | Val  Loss: 1.6385 | Val  Acc: 0.4545
 Site-East_Asian                (1) | Val  Loss: 1.4735 | Val  Acc: 0.4485
 Site-Indian                    (4) | Val  Loss: 1.4268 | Val  Acc: 0.3818
 Site-Indian                    (4) | Val  Loss: 1.4797 | Val  Acc: 0.4061
 Site-Southeast_Asian           (6) | Val  Loss: 1.6271 | Val  Acc: 0.4909
 Site-Southeast_Asian           (1) | Val  Loss: 1.4928 | Val  Acc: 0.4606
 Site-Middle_Eastern            (3) | Val  Loss: 1.5565 | Val  Acc: 0.4182
 Site-Middle_Eastern            (2) | Val  Loss: 1.4679 | Val  Acc: 0.4364
Average Valid Accuracy: 0.4225
Aggregated Acc | Val Acc: 0.4295
 Best site-White                    (2)  | Epoch:24 | Val Acc: 0.3455
 Best site-White                    (2)  | Epoch:24 | Val Acc: 0.4061
 Best site-Latino_Hispanic          (0)  | Epoch:24 | Val Acc: 0.4727
 Best site-Latino_Hispanic          (1)  | Epoch:24 | Val Acc: 0.4121
 Best site-Black                    (5)  | Epoch:24 | Val Acc: 0.4000
 Best site-Black                    (5)  | Epoch:24 | Val Acc: 0.3818
 Best site-East_Asian               (1)  | Epoch:24 | Val Acc: 0.4545
 Best site-East_Asian               (1)  | Epoch:24 | Val Acc: 0.4485
 Best site-Indian                   (4)  | Epoch:24 | Val Acc: 0.3818
 Best site-Indian                   (4)  | Epoch:24 | Val Acc: 0.4061
 Best site-Southeast_Asian          (6)  | Epoch:24 | Val Acc: 0.4909
 Best site-Southeast_Asian          (1)  | Epoch:24 | Val Acc: 0.4606
 Best site-Middle_Eastern           (3)  | Epoch:24 | Val Acc: 0.4182
 Best site-Middle_Eastern           (2)  | Epoch:24 | Val Acc: 0.4364
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 25 ============
cnt=[4, 1, 5, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
min_w=0.06682, quan_i=1.54, quan_c=1.54
minimize weight of clients:[8, 12, 13, ]
 Site-White                    | Train Loss: 1.4311 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.4986 | Train Acc: 0.4170
 Site-Latino_Hispanic          | Train Loss: 1.5456 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.4988 | Train Acc: 0.3846
 Site-Black                    | Train Loss: 1.6399 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.5544 | Train Acc: 0.4130
 Site-East_Asian               | Train Loss: 1.4512 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.4667 | Train Acc: 0.4453
 Site-Indian                   | Train Loss: 1.5491 | Train Acc: 0.4146
 Site-Indian                   | Train Loss: 1.5299 | Train Acc: 0.3725
 Site-Southeast_Asian          | Train Loss: 1.7143 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.4929 | Train Acc: 0.4413
 Site-Middle_Eastern           | Train Loss: 1.4324 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.4533 | Train Acc: 0.4494
 Site-White                     (0) | Val  Loss: 1.6391 | Val  Acc: 0.3273
 Site-White                     (0) | Val  Loss: 1.5248 | Val  Acc: 0.4121
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4633 | Val  Acc: 0.3818
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4974 | Val  Acc: 0.3879
 Site-Black                     (1) | Val  Loss: 1.6136 | Val  Acc: 0.2727
 Site-Black                     (6) | Val  Loss: 1.5935 | Val  Acc: 0.4182
 Site-East_Asian                (2) | Val  Loss: 1.6615 | Val  Acc: 0.3091
 Site-East_Asian                (2) | Val  Loss: 1.4459 | Val  Acc: 0.4545
 Site-Indian                    (5) | Val  Loss: 1.4198 | Val  Acc: 0.5091
 Site-Indian                    (2) | Val  Loss: 1.4820 | Val  Acc: 0.4182
 Site-Southeast_Asian           (2) | Val  Loss: 1.6015 | Val  Acc: 0.4909
 Site-Southeast_Asian           (2) | Val  Loss: 1.4689 | Val  Acc: 0.4727
 Site-Middle_Eastern            (4) | Val  Loss: 1.5699 | Val  Acc: 0.3455
 Site-Middle_Eastern            (0) | Val  Loss: 1.4824 | Val  Acc: 0.4303
Average Valid Accuracy: 0.4022
Aggregated Acc | Val Acc: 0.3923
============ Train epoch 26 ============
cnt=[1, 2, 5, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
min_w=0.07479, quan_i=1.52, quan_c=1.53
minimize weight of clients:[0, 6, 12, 13, ]
 Site-White                    | Train Loss: 1.4432 | Train Acc: 0.3902
 Site-White                    | Train Loss: 1.4986 | Train Acc: 0.4049
 Site-Latino_Hispanic          | Train Loss: 1.6389 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.5082 | Train Acc: 0.3846
 Site-Black                    | Train Loss: 1.6282 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.5452 | Train Acc: 0.3927
 Site-East_Asian               | Train Loss: 1.3865 | Train Acc: 0.4634
 Site-East_Asian               | Train Loss: 1.4699 | Train Acc: 0.4211
 Site-Indian                   | Train Loss: 1.4790 | Train Acc: 0.3902
 Site-Indian                   | Train Loss: 1.5063 | Train Acc: 0.3927
 Site-Southeast_Asian          | Train Loss: 1.6583 | Train Acc: 0.4390
 Site-Southeast_Asian          | Train Loss: 1.5125 | Train Acc: 0.4332
 Site-Middle_Eastern           | Train Loss: 1.2837 | Train Acc: 0.4390
 Site-Middle_Eastern           | Train Loss: 1.4702 | Train Acc: 0.4534
 Site-White                     (6) | Val  Loss: 1.6014 | Val  Acc: 0.2909
 Site-White                     (6) | Val  Loss: 1.5222 | Val  Acc: 0.3697
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4997 | Val  Acc: 0.3455
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4921 | Val  Acc: 0.4061
 Site-Black                     (3) | Val  Loss: 1.6676 | Val  Acc: 0.3273
 Site-Black                     (3) | Val  Loss: 1.6181 | Val  Acc: 0.4000
 Site-East_Asian                (0) | Val  Loss: 1.5291 | Val  Acc: 0.3818
 Site-East_Asian                (2) | Val  Loss: 1.4666 | Val  Acc: 0.4303
 Site-Indian                    (1) | Val  Loss: 1.3690 | Val  Acc: 0.4909
 Site-Indian                    (1) | Val  Loss: 1.4789 | Val  Acc: 0.4061
 Site-Southeast_Asian           (2) | Val  Loss: 1.6219 | Val  Acc: 0.4727
 Site-Southeast_Asian           (2) | Val  Loss: 1.4915 | Val  Acc: 0.4485
 Site-Middle_Eastern            (5) | Val  Loss: 1.5647 | Val  Acc: 0.4364
 Site-Middle_Eastern            (4) | Val  Loss: 1.4797 | Val  Acc: 0.4303
Average Valid Accuracy: 0.4026
Aggregated Acc | Val Acc: 0.4016
============ Train epoch 27 ============
cnt=[1, 2, 3, 2, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
min_w=0.06733, quan_i=1.52, quan_c=1.50
minimize weight of clients:[0, 8, 12, 13, ]
 Site-White                    | Train Loss: 1.5026 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.4770 | Train Acc: 0.4494
 Site-Latino_Hispanic          | Train Loss: 1.4958 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.4960 | Train Acc: 0.4130
 Site-Black                    | Train Loss: 1.6188 | Train Acc: 0.4146
 Site-Black                    | Train Loss: 1.5327 | Train Acc: 0.4291
 Site-East_Asian               | Train Loss: 1.4810 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.4572 | Train Acc: 0.4494
 Site-Indian                   | Train Loss: 1.5496 | Train Acc: 0.4146
 Site-Indian                   | Train Loss: 1.4748 | Train Acc: 0.4291
 Site-Southeast_Asian          | Train Loss: 1.4922 | Train Acc: 0.4878
 Site-Southeast_Asian          | Train Loss: 1.4801 | Train Acc: 0.4656
 Site-Middle_Eastern           | Train Loss: 1.3292 | Train Acc: 0.5122
 Site-Middle_Eastern           | Train Loss: 1.4626 | Train Acc: 0.4332
 Site-White                     (1) | Val  Loss: 1.6120 | Val  Acc: 0.2545
 Site-White                     (1) | Val  Loss: 1.4986 | Val  Acc: 0.4061
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4804 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4742 | Val  Acc: 0.4242
 Site-Black                     (3) | Val  Loss: 1.6578 | Val  Acc: 0.3091
 Site-Black                     (3) | Val  Loss: 1.5480 | Val  Acc: 0.4303
 Site-East_Asian                (4) | Val  Loss: 1.6033 | Val  Acc: 0.4182
 Site-East_Asian                (4) | Val  Loss: 1.4545 | Val  Acc: 0.4424
 Site-Indian                    (0) | Val  Loss: 1.3540 | Val  Acc: 0.4727
 Site-Indian                    (6) | Val  Loss: 1.4912 | Val  Acc: 0.4242
 Site-Southeast_Asian           (4) | Val  Loss: 1.5635 | Val  Acc: 0.4545
 Site-Southeast_Asian           (4) | Val  Loss: 1.4577 | Val  Acc: 0.4485
 Site-Middle_Eastern            (2) | Val  Loss: 1.6021 | Val  Acc: 0.4364
 Site-Middle_Eastern            (2) | Val  Loss: 1.4629 | Val  Acc: 0.4303
Average Valid Accuracy: 0.4108
Aggregated Acc | Val Acc: 0.4097
============ Train epoch 28 ============
cnt=[2, 6, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
min_w=0.06330, quan_i=1.49, quan_c=1.49
minimize weight of clients:[12, 13, ]
 Site-White                    | Train Loss: 1.4077 | Train Acc: 0.4756
 Site-White                    | Train Loss: 1.4748 | Train Acc: 0.4211
 Site-Latino_Hispanic          | Train Loss: 1.5635 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.4918 | Train Acc: 0.3846
 Site-Black                    | Train Loss: 1.6110 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.5616 | Train Acc: 0.3887
 Site-East_Asian               | Train Loss: 1.4419 | Train Acc: 0.4634
 Site-East_Asian               | Train Loss: 1.4888 | Train Acc: 0.4008
 Site-Indian                   | Train Loss: 1.4500 | Train Acc: 0.4268
 Site-Indian                   | Train Loss: 1.4788 | Train Acc: 0.4089
 Site-Southeast_Asian          | Train Loss: 1.6286 | Train Acc: 0.4390
 Site-Southeast_Asian          | Train Loss: 1.4975 | Train Acc: 0.4615
 Site-Middle_Eastern           | Train Loss: 1.4070 | Train Acc: 0.5244
 Site-Middle_Eastern           | Train Loss: 1.4558 | Train Acc: 0.4332
 Site-White                     (3) | Val  Loss: 1.5957 | Val  Acc: 0.3455
 Site-White                     (3) | Val  Loss: 1.4869 | Val  Acc: 0.4303
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4513 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4810 | Val  Acc: 0.4303
 Site-Black                     (0) | Val  Loss: 1.6487 | Val  Acc: 0.4182
 Site-Black                     (0) | Val  Loss: 1.5827 | Val  Acc: 0.4000
 Site-East_Asian                (1) | Val  Loss: 1.6205 | Val  Acc: 0.3636
 Site-East_Asian                (1) | Val  Loss: 1.4203 | Val  Acc: 0.4848
 Site-Indian                    (6) | Val  Loss: 1.3879 | Val  Acc: 0.4364
 Site-Indian                    (1) | Val  Loss: 1.4607 | Val  Acc: 0.4182
 Site-Southeast_Asian           (1) | Val  Loss: 1.5638 | Val  Acc: 0.4182
 Site-Southeast_Asian           (1) | Val  Loss: 1.5289 | Val  Acc: 0.4121
 Site-Middle_Eastern            (4) | Val  Loss: 1.5830 | Val  Acc: 0.4182
 Site-Middle_Eastern            (2) | Val  Loss: 1.4758 | Val  Acc: 0.4000
Average Valid Accuracy: 0.4100
Aggregated Acc | Val Acc: 0.4052
============ Train epoch 29 ============
cnt=[2, 3, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
min_w=0.07063, quan_i=1.49, quan_c=1.50
minimize weight of clients:[0, 6, 12, 13, ]
 Site-White                    | Train Loss: 1.5088 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.4550 | Train Acc: 0.4291
 Site-Latino_Hispanic          | Train Loss: 1.6095 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.4603 | Train Acc: 0.3887
 Site-Black                    | Train Loss: 1.4983 | Train Acc: 0.4024
 Site-Black                    | Train Loss: 1.5226 | Train Acc: 0.4211
 Site-East_Asian               | Train Loss: 1.4574 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.4574 | Train Acc: 0.4372
 Site-Indian                   | Train Loss: 1.5203 | Train Acc: 0.4390
 Site-Indian                   | Train Loss: 1.4700 | Train Acc: 0.4251
 Site-Southeast_Asian          | Train Loss: 1.5980 | Train Acc: 0.4512
 Site-Southeast_Asian          | Train Loss: 1.4743 | Train Acc: 0.4534
 Site-Middle_Eastern           | Train Loss: 1.3963 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.4224 | Train Acc: 0.4656
 Site-White                     (3) | Val  Loss: 1.6131 | Val  Acc: 0.3455
 Site-White                     (3) | Val  Loss: 1.4695 | Val  Acc: 0.4061
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4687 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4772 | Val  Acc: 0.4242
 Site-Black                     (4) | Val  Loss: 1.6771 | Val  Acc: 0.3273
 Site-Black                     (4) | Val  Loss: 1.5991 | Val  Acc: 0.4303
 Site-East_Asian                (2) | Val  Loss: 1.6085 | Val  Acc: 0.3818
 Site-East_Asian                (5) | Val  Loss: 1.4424 | Val  Acc: 0.4485
 Site-Indian                    (1) | Val  Loss: 1.3747 | Val  Acc: 0.4182
 Site-Indian                    (1) | Val  Loss: 1.4605 | Val  Acc: 0.4424
 Site-Southeast_Asian           (0) | Val  Loss: 1.5957 | Val  Acc: 0.4364
 Site-Southeast_Asian           (0) | Val  Loss: 1.4517 | Val  Acc: 0.4545
 Site-Middle_Eastern            (6) | Val  Loss: 1.5115 | Val  Acc: 0.4364
 Site-Middle_Eastern            (3) | Val  Loss: 1.4583 | Val  Acc: 0.4545
Average Valid Accuracy: 0.4121
Aggregated Acc | Val Acc: 0.4152
============ Train epoch 30 ============
cnt=[2, 1, 4, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
min_w=0.07136, quan_i=1.48, quan_c=1.49
minimize weight of clients:[6, 7, 9, 12, 13, ]
 Site-White                    | Train Loss: 1.5182 | Train Acc: 0.4512
 Site-White                    | Train Loss: 1.4459 | Train Acc: 0.4453
 Site-Latino_Hispanic          | Train Loss: 1.5028 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.4959 | Train Acc: 0.3765
 Site-Black                    | Train Loss: 1.6120 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.5471 | Train Acc: 0.4251
 Site-East_Asian               | Train Loss: 1.5069 | Train Acc: 0.4268
 Site-East_Asian               | Train Loss: 1.4566 | Train Acc: 0.4453
 Site-Indian                   | Train Loss: 1.4990 | Train Acc: 0.4146
 Site-Indian                   | Train Loss: 1.4768 | Train Acc: 0.4251
 Site-Southeast_Asian          | Train Loss: 1.5582 | Train Acc: 0.4512
 Site-Southeast_Asian          | Train Loss: 1.5117 | Train Acc: 0.4737
 Site-Middle_Eastern           | Train Loss: 1.4096 | Train Acc: 0.4756
 Site-Middle_Eastern           | Train Loss: 1.4323 | Train Acc: 0.4737
 Site-White                     (2) | Val  Loss: 1.6368 | Val  Acc: 0.3091
 Site-White                     (2) | Val  Loss: 1.4784 | Val  Acc: 0.4242
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4528 | Val  Acc: 0.3455
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4899 | Val  Acc: 0.3818
 Site-Black                     (4) | Val  Loss: 1.6237 | Val  Acc: 0.3636
 Site-Black                     (4) | Val  Loss: 1.5781 | Val  Acc: 0.4121
 Site-East_Asian                (5) | Val  Loss: 1.5897 | Val  Acc: 0.3818
 Site-East_Asian                (1) | Val  Loss: 1.4206 | Val  Acc: 0.4424
 Site-Indian                    (0) | Val  Loss: 1.3715 | Val  Acc: 0.4182
 Site-Indian                    (0) | Val  Loss: 1.4189 | Val  Acc: 0.4303
 Site-Southeast_Asian           (3) | Val  Loss: 1.5976 | Val  Acc: 0.4727
 Site-Southeast_Asian           (3) | Val  Loss: 1.4404 | Val  Acc: 0.4788
 Site-Middle_Eastern            (6) | Val  Loss: 1.5469 | Val  Acc: 0.4727
 Site-Middle_Eastern            (6) | Val  Loss: 1.4883 | Val  Acc: 0.3939
Average Valid Accuracy: 0.4091
Aggregated Acc | Val Acc: 0.4158
============ Train epoch 31 ============
cnt=[1, 5, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
min_w=0.07266, quan_i=1.52, quan_c=1.51
minimize weight of clients:[1, 12, 13, ]
 Site-White                    | Train Loss: 1.3671 | Train Acc: 0.4634
 Site-White                    | Train Loss: 1.4443 | Train Acc: 0.4372
 Site-Latino_Hispanic          | Train Loss: 1.6249 | Train Acc: 0.3293
 Site-Latino_Hispanic          | Train Loss: 1.4688 | Train Acc: 0.4251
 Site-Black                    | Train Loss: 1.6004 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.5016 | Train Acc: 0.4453
 Site-East_Asian               | Train Loss: 1.4291 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.4537 | Train Acc: 0.4575
 Site-Indian                   | Train Loss: 1.5165 | Train Acc: 0.4756
 Site-Indian                   | Train Loss: 1.4545 | Train Acc: 0.4372
 Site-Southeast_Asian          | Train Loss: 1.4906 | Train Acc: 0.4512
 Site-Southeast_Asian          | Train Loss: 1.4964 | Train Acc: 0.4615
 Site-Middle_Eastern           | Train Loss: 1.4037 | Train Acc: 0.4756
 Site-Middle_Eastern           | Train Loss: 1.4323 | Train Acc: 0.4575
 Site-White                     (3) | Val  Loss: 1.5544 | Val  Acc: 0.3636
 Site-White                     (3) | Val  Loss: 1.4966 | Val  Acc: 0.4061
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4171 | Val  Acc: 0.4364
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4880 | Val  Acc: 0.3818
 Site-Black                     (4) | Val  Loss: 1.5837 | Val  Acc: 0.3091
 Site-Black                     (0) | Val  Loss: 1.5129 | Val  Acc: 0.4121
 Site-East_Asian                (1) | Val  Loss: 1.6433 | Val  Acc: 0.4000
 Site-East_Asian                (1) | Val  Loss: 1.4047 | Val  Acc: 0.4727
 Site-Indian                    (4) | Val  Loss: 1.3865 | Val  Acc: 0.4545
 Site-Indian                    (4) | Val  Loss: 1.4403 | Val  Acc: 0.4182
 Site-Southeast_Asian           (1) | Val  Loss: 1.5503 | Val  Acc: 0.4909
 Site-Southeast_Asian           (1) | Val  Loss: 1.4666 | Val  Acc: 0.4242
 Site-Middle_Eastern            (5) | Val  Loss: 1.5260 | Val  Acc: 0.4364
 Site-Middle_Eastern            (6) | Val  Loss: 1.4638 | Val  Acc: 0.4121
Average Valid Accuracy: 0.4156
Aggregated Acc | Val Acc: 0.4157
============ Train epoch 32 ============
cnt=[2, 5, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
min_w=0.07153, quan_i=1.47, quan_c=1.47
minimize weight of clients:[6, 12, 13, ]
 Site-White                    | Train Loss: 1.5070 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.4243 | Train Acc: 0.4211
 Site-Latino_Hispanic          | Train Loss: 1.5829 | Train Acc: 0.4390
 Site-Latino_Hispanic          | Train Loss: 1.4504 | Train Acc: 0.4008
 Site-Black                    | Train Loss: 1.4649 | Train Acc: 0.3537
 Site-Black                    | Train Loss: 1.5589 | Train Acc: 0.4089
 Site-East_Asian               | Train Loss: 1.5019 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.4311 | Train Acc: 0.4534
 Site-Indian                   | Train Loss: 1.4801 | Train Acc: 0.4024
 Site-Indian                   | Train Loss: 1.4724 | Train Acc: 0.4372
 Site-Southeast_Asian          | Train Loss: 1.5503 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.4918 | Train Acc: 0.4656
 Site-Middle_Eastern           | Train Loss: 1.4444 | Train Acc: 0.4756
 Site-Middle_Eastern           | Train Loss: 1.4144 | Train Acc: 0.4615
 Site-White                     (1) | Val  Loss: 1.5849 | Val  Acc: 0.2909
 Site-White                     (1) | Val  Loss: 1.4386 | Val  Acc: 0.4364
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4325 | Val  Acc: 0.3455
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4548 | Val  Acc: 0.4000
 Site-Black                     (6) | Val  Loss: 1.6180 | Val  Acc: 0.4000
 Site-Black                     (2) | Val  Loss: 1.5965 | Val  Acc: 0.4303
 Site-East_Asian                (5) | Val  Loss: 1.6152 | Val  Acc: 0.4182
 Site-East_Asian                (5) | Val  Loss: 1.4228 | Val  Acc: 0.4364
 Site-Indian                    (3) | Val  Loss: 1.3643 | Val  Acc: 0.4545
 Site-Indian                    (3) | Val  Loss: 1.4687 | Val  Acc: 0.4182
 Site-Southeast_Asian           (1) | Val  Loss: 1.5408 | Val  Acc: 0.4727
 Site-Southeast_Asian           (1) | Val  Loss: 1.4378 | Val  Acc: 0.4667
 Site-Middle_Eastern            (0) | Val  Loss: 1.5422 | Val  Acc: 0.4364
 Site-Middle_Eastern            (0) | Val  Loss: 1.4673 | Val  Acc: 0.4303
Average Valid Accuracy: 0.4169
Aggregated Acc | Val Acc: 0.4123
============ Train epoch 33 ============
cnt=[1, 2, 5, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
min_w=0.07479, quan_i=1.49, quan_c=1.48
minimize weight of clients:[1, 4, 12, 13, ]
 Site-White                    | Train Loss: 1.4134 | Train Acc: 0.4756
 Site-White                    | Train Loss: 1.4636 | Train Acc: 0.4453
 Site-Latino_Hispanic          | Train Loss: 1.6979 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.4597 | Train Acc: 0.4008
 Site-Black                    | Train Loss: 1.5449 | Train Acc: 0.4146
 Site-Black                    | Train Loss: 1.5271 | Train Acc: 0.4170
 Site-East_Asian               | Train Loss: 1.4539 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.4502 | Train Acc: 0.4575
 Site-Indian                   | Train Loss: 1.5441 | Train Acc: 0.3780
 Site-Indian                   | Train Loss: 1.4608 | Train Acc: 0.4372
 Site-Southeast_Asian          | Train Loss: 1.6652 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.4673 | Train Acc: 0.4615
 Site-Middle_Eastern           | Train Loss: 1.4886 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.4298 | Train Acc: 0.4291
 Site-White                     (1) | Val  Loss: 1.5795 | Val  Acc: 0.3818
 Site-White                     (1) | Val  Loss: 1.4633 | Val  Acc: 0.4061
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4006 | Val  Acc: 0.4182
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4255 | Val  Acc: 0.4242
 Site-Black                     (4) | Val  Loss: 1.6821 | Val  Acc: 0.3273
 Site-Black                     (0) | Val  Loss: 1.5335 | Val  Acc: 0.4182
 Site-East_Asian                (2) | Val  Loss: 1.6438 | Val  Acc: 0.4364
 Site-East_Asian                (2) | Val  Loss: 1.4129 | Val  Acc: 0.4788
 Site-Indian                    (6) | Val  Loss: 1.3467 | Val  Acc: 0.4727
 Site-Indian                    (6) | Val  Loss: 1.4158 | Val  Acc: 0.4545
 Site-Southeast_Asian           (2) | Val  Loss: 1.5543 | Val  Acc: 0.4545
 Site-Southeast_Asian           (2) | Val  Loss: 1.4529 | Val  Acc: 0.4909
 Site-Middle_Eastern            (5) | Val  Loss: 1.5406 | Val  Acc: 0.4182
 Site-Middle_Eastern            (3) | Val  Loss: 1.4554 | Val  Acc: 0.4061
Average Valid Accuracy: 0.4277
Aggregated Acc | Val Acc: 0.4099
 Best site-White                    (1)  | Epoch:33 | Val Acc: 0.3818
 Best site-White                    (1)  | Epoch:33 | Val Acc: 0.4061
 Best site-Latino_Hispanic          (6)  | Epoch:33 | Val Acc: 0.4182
 Best site-Latino_Hispanic          (2)  | Epoch:33 | Val Acc: 0.4242
 Best site-Black                    (4)  | Epoch:33 | Val Acc: 0.3273
 Best site-Black                    (0)  | Epoch:33 | Val Acc: 0.4182
 Best site-East_Asian               (2)  | Epoch:33 | Val Acc: 0.4364
 Best site-East_Asian               (2)  | Epoch:33 | Val Acc: 0.4788
 Best site-Indian                   (6)  | Epoch:33 | Val Acc: 0.4727
 Best site-Indian                   (6)  | Epoch:33 | Val Acc: 0.4545
 Best site-Southeast_Asian          (2)  | Epoch:33 | Val Acc: 0.4545
 Best site-Southeast_Asian          (2)  | Epoch:33 | Val Acc: 0.4909
 Best site-Middle_Eastern           (5)  | Epoch:33 | Val Acc: 0.4182
 Best site-Middle_Eastern           (3)  | Epoch:33 | Val Acc: 0.4061
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 34 ============
cnt=[5, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
min_w=0.07423, quan_i=1.47, quan_c=1.50
minimize weight of clients:[0, 13, ]
 Site-White                    | Train Loss: 1.4714 | Train Acc: 0.4756
 Site-White                    | Train Loss: 1.4295 | Train Acc: 0.4211
 Site-Latino_Hispanic          | Train Loss: 1.6444 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.4412 | Train Acc: 0.4130
 Site-Black                    | Train Loss: 1.5094 | Train Acc: 0.4024
 Site-Black                    | Train Loss: 1.5007 | Train Acc: 0.4534
 Site-East_Asian               | Train Loss: 1.4336 | Train Acc: 0.4024
 Site-East_Asian               | Train Loss: 1.4376 | Train Acc: 0.4494
 Site-Indian                   | Train Loss: 1.6256 | Train Acc: 0.3780
 Site-Indian                   | Train Loss: 1.4490 | Train Acc: 0.4413
 Site-Southeast_Asian          | Train Loss: 1.6521 | Train Acc: 0.4634
 Site-Southeast_Asian          | Train Loss: 1.4926 | Train Acc: 0.4737
 Site-Middle_Eastern           | Train Loss: 1.3760 | Train Acc: 0.5000
 Site-Middle_Eastern           | Train Loss: 1.4388 | Train Acc: 0.4372
 Site-White                     (4) | Val  Loss: 1.5783 | Val  Acc: 0.3273
 Site-White                     (4) | Val  Loss: 1.4613 | Val  Acc: 0.4303
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4303 | Val  Acc: 0.3091
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4521 | Val  Acc: 0.4121
 Site-Black                     (2) | Val  Loss: 1.5506 | Val  Acc: 0.4182
 Site-Black                     (2) | Val  Loss: 1.4852 | Val  Acc: 0.4606
 Site-East_Asian                (0) | Val  Loss: 1.5949 | Val  Acc: 0.3818
 Site-East_Asian                (5) | Val  Loss: 1.4033 | Val  Acc: 0.4545
 Site-Indian                    (0) | Val  Loss: 1.3960 | Val  Acc: 0.4000
 Site-Indian                    (0) | Val  Loss: 1.4806 | Val  Acc: 0.4606
 Site-Southeast_Asian           (0) | Val  Loss: 1.5926 | Val  Acc: 0.4727
 Site-Southeast_Asian           (0) | Val  Loss: 1.4108 | Val  Acc: 0.4970
 Site-Middle_Eastern            (1) | Val  Loss: 1.5217 | Val  Acc: 0.4182
 Site-Middle_Eastern            (1) | Val  Loss: 1.4629 | Val  Acc: 0.4182
Average Valid Accuracy: 0.4186
Aggregated Acc | Val Acc: 0.4078
============ Train epoch 35 ============
cnt=[1, 2, 5, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
min_w=0.06868, quan_i=1.47, quan_c=1.49
minimize weight of clients:[7, 12, 13, ]
 Site-White                    | Train Loss: 1.5092 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.4436 | Train Acc: 0.4332
 Site-Latino_Hispanic          | Train Loss: 1.6521 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.4511 | Train Acc: 0.4170
 Site-Black                    | Train Loss: 1.5368 | Train Acc: 0.4268
 Site-Black                    | Train Loss: 1.5151 | Train Acc: 0.4494
 Site-East_Asian               | Train Loss: 1.3935 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.4292 | Train Acc: 0.4413
 Site-Indian                   | Train Loss: 1.4597 | Train Acc: 0.4634
 Site-Indian                   | Train Loss: 1.4527 | Train Acc: 0.4089
 Site-Southeast_Asian          | Train Loss: 1.6215 | Train Acc: 0.4512
 Site-Southeast_Asian          | Train Loss: 1.4977 | Train Acc: 0.4737
 Site-Middle_Eastern           | Train Loss: 1.3776 | Train Acc: 0.4268
 Site-Middle_Eastern           | Train Loss: 1.4270 | Train Acc: 0.4211
 Site-White                     (4) | Val  Loss: 1.5215 | Val  Acc: 0.4182
 Site-White                     (4) | Val  Loss: 1.4292 | Val  Acc: 0.4303
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4388 | Val  Acc: 0.4182
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4511 | Val  Acc: 0.4242
 Site-Black                     (1) | Val  Loss: 1.5493 | Val  Acc: 0.4364
 Site-Black                     (1) | Val  Loss: 1.4919 | Val  Acc: 0.4424
 Site-East_Asian                (2) | Val  Loss: 1.5821 | Val  Acc: 0.4182
 Site-East_Asian                (0) | Val  Loss: 1.4051 | Val  Acc: 0.4788
 Site-Indian                    (5) | Val  Loss: 1.3834 | Val  Acc: 0.4364
 Site-Indian                    (2) | Val  Loss: 1.4545 | Val  Acc: 0.4242
 Site-Southeast_Asian           (2) | Val  Loss: 1.5028 | Val  Acc: 0.4909
 Site-Southeast_Asian           (2) | Val  Loss: 1.4461 | Val  Acc: 0.4970
 Site-Middle_Eastern            (6) | Val  Loss: 1.5601 | Val  Acc: 0.4182
 Site-Middle_Eastern            (3) | Val  Loss: 1.4320 | Val  Acc: 0.4182
Average Valid Accuracy: 0.4394
Aggregated Acc | Val Acc: 0.4377
 Best site-White                    (4)  | Epoch:35 | Val Acc: 0.4182
 Best site-White                    (4)  | Epoch:35 | Val Acc: 0.4303
 Best site-Latino_Hispanic          (4)  | Epoch:35 | Val Acc: 0.4182
 Best site-Latino_Hispanic          (2)  | Epoch:35 | Val Acc: 0.4242
 Best site-Black                    (1)  | Epoch:35 | Val Acc: 0.4364
 Best site-Black                    (1)  | Epoch:35 | Val Acc: 0.4424
 Best site-East_Asian               (2)  | Epoch:35 | Val Acc: 0.4182
 Best site-East_Asian               (0)  | Epoch:35 | Val Acc: 0.4788
 Best site-Indian                   (5)  | Epoch:35 | Val Acc: 0.4364
 Best site-Indian                   (2)  | Epoch:35 | Val Acc: 0.4242
 Best site-Southeast_Asian          (2)  | Epoch:35 | Val Acc: 0.4909
 Best site-Southeast_Asian          (2)  | Epoch:35 | Val Acc: 0.4970
 Best site-Middle_Eastern           (6)  | Epoch:35 | Val Acc: 0.4182
 Best site-Middle_Eastern           (3)  | Epoch:35 | Val Acc: 0.4182
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 36 ============
cnt=[4, 1, 2, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
min_w=0.07127, quan_i=1.47, quan_c=1.47
minimize weight of clients:[1, 6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.3589 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.4273 | Train Acc: 0.4372
 Site-Latino_Hispanic          | Train Loss: 1.5419 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.4507 | Train Acc: 0.4089
 Site-Black                    | Train Loss: 1.6001 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.4831 | Train Acc: 0.4818
 Site-East_Asian               | Train Loss: 1.4685 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.4445 | Train Acc: 0.4211
 Site-Indian                   | Train Loss: 1.4956 | Train Acc: 0.4390
 Site-Indian                   | Train Loss: 1.4452 | Train Acc: 0.4291
 Site-Southeast_Asian          | Train Loss: 1.5337 | Train Acc: 0.4634
 Site-Southeast_Asian          | Train Loss: 1.4949 | Train Acc: 0.4615
 Site-Middle_Eastern           | Train Loss: 1.3858 | Train Acc: 0.4878
 Site-Middle_Eastern           | Train Loss: 1.4190 | Train Acc: 0.4453
 Site-White                     (0) | Val  Loss: 1.5337 | Val  Acc: 0.3455
 Site-White                     (0) | Val  Loss: 1.4787 | Val  Acc: 0.3939
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3766 | Val  Acc: 0.3818
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4412 | Val  Acc: 0.4121
 Site-Black                     (2) | Val  Loss: 1.5139 | Val  Acc: 0.4364
 Site-Black                     (2) | Val  Loss: 1.5329 | Val  Acc: 0.3818
 Site-East_Asian                (5) | Val  Loss: 1.5929 | Val  Acc: 0.3818
 Site-East_Asian                (5) | Val  Loss: 1.4263 | Val  Acc: 0.4364
 Site-Indian                    (6) | Val  Loss: 1.3139 | Val  Acc: 0.4364
 Site-Indian                    (6) | Val  Loss: 1.4116 | Val  Acc: 0.4788
 Site-Southeast_Asian           (3) | Val  Loss: 1.5949 | Val  Acc: 0.4545
 Site-Southeast_Asian           (3) | Val  Loss: 1.4553 | Val  Acc: 0.4485
 Site-Middle_Eastern            (0) | Val  Loss: 1.4570 | Val  Acc: 0.4727
 Site-Middle_Eastern            (0) | Val  Loss: 1.3917 | Val  Acc: 0.4545
Average Valid Accuracy: 0.4225
Aggregated Acc | Val Acc: 0.4197
============ Train epoch 37 ============
cnt=[2, 3, 2, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
min_w=0.06892, quan_i=1.47, quan_c=1.45
minimize weight of clients:[0, 1, 7, 13, ]
 Site-White                    | Train Loss: 1.3993 | Train Acc: 0.4512
 Site-White                    | Train Loss: 1.4258 | Train Acc: 0.4575
 Site-Latino_Hispanic          | Train Loss: 1.4476 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.4221 | Train Acc: 0.4211
 Site-Black                    | Train Loss: 1.6127 | Train Acc: 0.4634
 Site-Black                    | Train Loss: 1.4654 | Train Acc: 0.4575
 Site-East_Asian               | Train Loss: 1.5003 | Train Acc: 0.4146
 Site-East_Asian               | Train Loss: 1.4858 | Train Acc: 0.4332
 Site-Indian                   | Train Loss: 1.4239 | Train Acc: 0.4390
 Site-Indian                   | Train Loss: 1.4268 | Train Acc: 0.4575
 Site-Southeast_Asian          | Train Loss: 1.6212 | Train Acc: 0.4390
 Site-Southeast_Asian          | Train Loss: 1.4848 | Train Acc: 0.4575
 Site-Middle_Eastern           | Train Loss: 1.3217 | Train Acc: 0.4878
 Site-Middle_Eastern           | Train Loss: 1.4124 | Train Acc: 0.4453
 Site-White                     (4) | Val  Loss: 1.6038 | Val  Acc: 0.3455
 Site-White                     (4) | Val  Loss: 1.4568 | Val  Acc: 0.4303
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3991 | Val  Acc: 0.4182
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3984 | Val  Acc: 0.4364
 Site-Black                     (2) | Val  Loss: 1.5546 | Val  Acc: 0.3818
 Site-Black                     (2) | Val  Loss: 1.5102 | Val  Acc: 0.4242
 Site-East_Asian                (6) | Val  Loss: 1.5947 | Val  Acc: 0.3818
 Site-East_Asian                (3) | Val  Loss: 1.4562 | Val  Acc: 0.4485
 Site-Indian                    (1) | Val  Loss: 1.3851 | Val  Acc: 0.4000
 Site-Indian                    (1) | Val  Loss: 1.3861 | Val  Acc: 0.4545
 Site-Southeast_Asian           (6) | Val  Loss: 1.5940 | Val  Acc: 0.5818
 Site-Southeast_Asian           (6) | Val  Loss: 1.4089 | Val  Acc: 0.5030
 Site-Middle_Eastern            (1) | Val  Loss: 1.5245 | Val  Acc: 0.4364
 Site-Middle_Eastern            (0) | Val  Loss: 1.4205 | Val  Acc: 0.4424
Average Valid Accuracy: 0.4346
Aggregated Acc | Val Acc: 0.4309
============ Train epoch 38 ============
cnt=[1, 3, 3, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
min_w=0.06330, quan_i=1.44, quan_c=1.43
minimize weight of clients:[0, 1, 8, 9, 12, ]
 Site-White                    | Train Loss: 1.4438 | Train Acc: 0.4756
 Site-White                    | Train Loss: 1.4285 | Train Acc: 0.4332
 Site-Latino_Hispanic          | Train Loss: 1.6260 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.4223 | Train Acc: 0.3927
 Site-Black                    | Train Loss: 1.6002 | Train Acc: 0.3293
 Site-Black                    | Train Loss: 1.5296 | Train Acc: 0.4130
 Site-East_Asian               | Train Loss: 1.2845 | Train Acc: 0.4146
 Site-East_Asian               | Train Loss: 1.4346 | Train Acc: 0.4575
 Site-Indian                   | Train Loss: 1.6335 | Train Acc: 0.4024
 Site-Indian                   | Train Loss: 1.4510 | Train Acc: 0.4534
 Site-Southeast_Asian          | Train Loss: 1.4943 | Train Acc: 0.4390
 Site-Southeast_Asian          | Train Loss: 1.4616 | Train Acc: 0.4494
 Site-Middle_Eastern           | Train Loss: 1.3282 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.3880 | Train Acc: 0.4534
 Site-White                     (6) | Val  Loss: 1.5304 | Val  Acc: 0.3273
 Site-White                     (6) | Val  Loss: 1.4314 | Val  Acc: 0.4364
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4028 | Val  Acc: 0.3818
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4455 | Val  Acc: 0.4121
 Site-Black                     (3) | Val  Loss: 1.6500 | Val  Acc: 0.4182
 Site-Black                     (3) | Val  Loss: 1.5767 | Val  Acc: 0.4000
 Site-East_Asian                (1) | Val  Loss: 1.5876 | Val  Acc: 0.4000
 Site-East_Asian                (1) | Val  Loss: 1.3657 | Val  Acc: 0.4970
 Site-Indian                    (4) | Val  Loss: 1.3981 | Val  Acc: 0.4545
 Site-Indian                    (4) | Val  Loss: 1.4382 | Val  Acc: 0.4182
 Site-Southeast_Asian           (0) | Val  Loss: 1.4950 | Val  Acc: 0.4909
 Site-Southeast_Asian           (1) | Val  Loss: 1.4434 | Val  Acc: 0.5030
 Site-Middle_Eastern            (5) | Val  Loss: 1.5435 | Val  Acc: 0.4727
 Site-Middle_Eastern            (2) | Val  Loss: 1.4630 | Val  Acc: 0.4242
Average Valid Accuracy: 0.4312
Aggregated Acc | Val Acc: 0.4377
============ Train epoch 39 ============
cnt=[2, 1, 2, 3, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
min_w=0.06330, quan_i=1.46, quan_c=1.47
minimize weight of clients:[3, 6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.4526 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.4090 | Train Acc: 0.4372
 Site-Latino_Hispanic          | Train Loss: 1.5675 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.4526 | Train Acc: 0.4130
 Site-Black                    | Train Loss: 1.5717 | Train Acc: 0.3415
 Site-Black                    | Train Loss: 1.4796 | Train Acc: 0.4291
 Site-East_Asian               | Train Loss: 1.4034 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.4161 | Train Acc: 0.4291
 Site-Indian                   | Train Loss: 1.4828 | Train Acc: 0.3902
 Site-Indian                   | Train Loss: 1.4535 | Train Acc: 0.4332
 Site-Southeast_Asian          | Train Loss: 1.5786 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.4692 | Train Acc: 0.4575
 Site-Middle_Eastern           | Train Loss: 1.3642 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.3999 | Train Acc: 0.4534
 Site-White                     (4) | Val  Loss: 1.5596 | Val  Acc: 0.3455
 Site-White                     (4) | Val  Loss: 1.4348 | Val  Acc: 0.4545
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3983 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4120 | Val  Acc: 0.4303
 Site-Black                     (2) | Val  Loss: 1.5654 | Val  Acc: 0.3455
 Site-Black                     (2) | Val  Loss: 1.5313 | Val  Acc: 0.4303
 Site-East_Asian                (0) | Val  Loss: 1.5772 | Val  Acc: 0.3818
 Site-East_Asian                (0) | Val  Loss: 1.4257 | Val  Acc: 0.4545
 Site-Indian                    (6) | Val  Loss: 1.3272 | Val  Acc: 0.4727
 Site-Indian                    (6) | Val  Loss: 1.4273 | Val  Acc: 0.4424
 Site-Southeast_Asian           (3) | Val  Loss: 1.4667 | Val  Acc: 0.5455
 Site-Southeast_Asian           (3) | Val  Loss: 1.4226 | Val  Acc: 0.4788
 Site-Middle_Eastern            (5) | Val  Loss: 1.5570 | Val  Acc: 0.4364
 Site-Middle_Eastern            (1) | Val  Loss: 1.4276 | Val  Acc: 0.4727
Average Valid Accuracy: 0.4351
Aggregated Acc | Val Acc: 0.4368
============ Train epoch 40 ============
cnt=[2, 3, 1, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
min_w=0.06682, quan_i=1.47, quan_c=1.46
minimize weight of clients:[1, 6, 12, 13, ]
 Site-White                    | Train Loss: 1.3871 | Train Acc: 0.4634
 Site-White                    | Train Loss: 1.4446 | Train Acc: 0.4332
 Site-Latino_Hispanic          | Train Loss: 1.6771 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.4007 | Train Acc: 0.4211
 Site-Black                    | Train Loss: 1.5570 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.5033 | Train Acc: 0.4656
 Site-East_Asian               | Train Loss: 1.4473 | Train Acc: 0.4024
 Site-East_Asian               | Train Loss: 1.4513 | Train Acc: 0.4251
 Site-Indian                   | Train Loss: 1.4613 | Train Acc: 0.4146
 Site-Indian                   | Train Loss: 1.3864 | Train Acc: 0.4534
 Site-Southeast_Asian          | Train Loss: 1.5299 | Train Acc: 0.4512
 Site-Southeast_Asian          | Train Loss: 1.4521 | Train Acc: 0.4818
 Site-Middle_Eastern           | Train Loss: 1.3574 | Train Acc: 0.5366
 Site-Middle_Eastern           | Train Loss: 1.4113 | Train Acc: 0.4575
 Site-White                     (4) | Val  Loss: 1.5932 | Val  Acc: 0.3636
 Site-White                     (4) | Val  Loss: 1.4679 | Val  Acc: 0.4121
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3869 | Val  Acc: 0.4182
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4061 | Val  Acc: 0.4303
 Site-Black                     (0) | Val  Loss: 1.4778 | Val  Acc: 0.3818
 Site-Black                     (0) | Val  Loss: 1.5239 | Val  Acc: 0.4121
 Site-East_Asian                (3) | Val  Loss: 1.5162 | Val  Acc: 0.4364
 Site-East_Asian                (5) | Val  Loss: 1.4257 | Val  Acc: 0.4545
 Site-Indian                    (6) | Val  Loss: 1.3183 | Val  Acc: 0.4909
 Site-Indian                    (6) | Val  Loss: 1.3971 | Val  Acc: 0.4667
 Site-Southeast_Asian           (5) | Val  Loss: 1.5432 | Val  Acc: 0.5091
 Site-Southeast_Asian           (5) | Val  Loss: 1.3875 | Val  Acc: 0.5333
 Site-Middle_Eastern            (2) | Val  Loss: 1.5283 | Val  Acc: 0.4545
 Site-Middle_Eastern            (1) | Val  Loss: 1.4253 | Val  Acc: 0.4242
Average Valid Accuracy: 0.4420
Aggregated Acc | Val Acc: 0.4397
 Best site-White                    (4)  | Epoch:40 | Val Acc: 0.3636
 Best site-White                    (4)  | Epoch:40 | Val Acc: 0.4121
 Best site-Latino_Hispanic          (1)  | Epoch:40 | Val Acc: 0.4182
 Best site-Latino_Hispanic          (1)  | Epoch:40 | Val Acc: 0.4303
 Best site-Black                    (0)  | Epoch:40 | Val Acc: 0.3818
 Best site-Black                    (0)  | Epoch:40 | Val Acc: 0.4121
 Best site-East_Asian               (3)  | Epoch:40 | Val Acc: 0.4364
 Best site-East_Asian               (5)  | Epoch:40 | Val Acc: 0.4545
 Best site-Indian                   (6)  | Epoch:40 | Val Acc: 0.4909
 Best site-Indian                   (6)  | Epoch:40 | Val Acc: 0.4667
 Best site-Southeast_Asian          (5)  | Epoch:40 | Val Acc: 0.5091
 Best site-Southeast_Asian          (5)  | Epoch:40 | Val Acc: 0.5333
 Best site-Middle_Eastern           (2)  | Epoch:40 | Val Acc: 0.4545
 Best site-Middle_Eastern           (1)  | Epoch:40 | Val Acc: 0.4242
 Test site-White                    | Epoch:40 | Test Acc: 0.3755
 Test site-Latino_Hispanic          | Epoch:40 | Test Acc: 0.3315
 Test site-Black                    | Epoch:40 | Test Acc: 0.3368
 Test site-East_Asian               | Epoch:40 | Test Acc: 0.4161
 Test site-Indian                   | Epoch:40 | Test Acc: 0.3100
 Test site-Southeast_Asian          | Epoch:40 | Test Acc: 0.3816
 Test site-Middle_Eastern           | Epoch:40 | Test Acc: 0.3656
Average Test Accuracy: 0.3596, domain std=0.0333, individual std=0.0333
Average Test Accuracy: 0.3596
============ Train epoch 41 ============
cnt=[1, 2, 3, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
min_w=0.06682, quan_i=1.46, quan_c=1.45
minimize weight of clients:[0, 1, 3, 9, 12, 13, ]
 Site-White                    | Train Loss: 1.4573 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.4159 | Train Acc: 0.4453
 Site-Latino_Hispanic          | Train Loss: 1.5943 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.4538 | Train Acc: 0.4089
 Site-Black                    | Train Loss: 1.6134 | Train Acc: 0.3293
 Site-Black                    | Train Loss: 1.4895 | Train Acc: 0.4615
 Site-East_Asian               | Train Loss: 1.3282 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.3834 | Train Acc: 0.4777
 Site-Indian                   | Train Loss: 1.3575 | Train Acc: 0.4146
 Site-Indian                   | Train Loss: 1.4440 | Train Acc: 0.4494
 Site-Southeast_Asian          | Train Loss: 1.5191 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.4624 | Train Acc: 0.4818
 Site-Middle_Eastern           | Train Loss: 1.3432 | Train Acc: 0.5366
 Site-Middle_Eastern           | Train Loss: 1.4147 | Train Acc: 0.4413
 Site-White                     (2) | Val  Loss: 1.5291 | Val  Acc: 0.3455
 Site-White                     (2) | Val  Loss: 1.4105 | Val  Acc: 0.4424
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4382 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4698 | Val  Acc: 0.4061
 Site-Black                     (1) | Val  Loss: 1.5870 | Val  Acc: 0.2545
 Site-Black                     (1) | Val  Loss: 1.5689 | Val  Acc: 0.3939
 Site-East_Asian                (3) | Val  Loss: 1.5853 | Val  Acc: 0.4364
 Site-East_Asian                (3) | Val  Loss: 1.3963 | Val  Acc: 0.4970
 Site-Indian                    (5) | Val  Loss: 1.3897 | Val  Acc: 0.4545
 Site-Indian                    (5) | Val  Loss: 1.4310 | Val  Acc: 0.4424
 Site-Southeast_Asian           (3) | Val  Loss: 1.5033 | Val  Acc: 0.5273
 Site-Southeast_Asian           (3) | Val  Loss: 1.4042 | Val  Acc: 0.4909
 Site-Middle_Eastern            (4) | Val  Loss: 1.5094 | Val  Acc: 0.4364
 Site-Middle_Eastern            (2) | Val  Loss: 1.4178 | Val  Acc: 0.4182
Average Valid Accuracy: 0.4221
Aggregated Acc | Val Acc: 0.4098
 Test site-White                    | Epoch:40 | Test Acc: 0.3741
 Test site-Latino_Hispanic          | Epoch:40 | Test Acc: 0.3346
 Test site-Black                    | Epoch:40 | Test Acc: 0.3374
 Test site-East_Asian               | Epoch:40 | Test Acc: 0.4516
 Test site-Indian                   | Epoch:40 | Test Acc: 0.3173
 Test site-Southeast_Asian          | Epoch:40 | Test Acc: 0.4064
 Test site-Middle_Eastern           | Epoch:40 | Test Acc: 0.3590
Average Test Accuracy: 0.3686, domain std=0.0434, individual std=0.0434
Average Test Accuracy: 0.3686
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 42 ============
cnt=[1, 2, 3, 2, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
min_w=0.06330, quan_i=1.46, quan_c=1.44
minimize weight of clients:[1, 6, 8, 9, 12, ]
 Site-White                    | Train Loss: 1.4686 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.4238 | Train Acc: 0.4413
 Site-Latino_Hispanic          | Train Loss: 1.6146 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.4605 | Train Acc: 0.4049
 Site-Black                    | Train Loss: 1.6187 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.4808 | Train Acc: 0.4372
 Site-East_Asian               | Train Loss: 1.3769 | Train Acc: 0.4268
 Site-East_Asian               | Train Loss: 1.3897 | Train Acc: 0.4494
 Site-Indian                   | Train Loss: 1.4629 | Train Acc: 0.4390
 Site-Indian                   | Train Loss: 1.4729 | Train Acc: 0.4332
 Site-Southeast_Asian          | Train Loss: 1.6047 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.4106 | Train Acc: 0.5020
 Site-Middle_Eastern           | Train Loss: 1.3740 | Train Acc: 0.5000
 Site-Middle_Eastern           | Train Loss: 1.3789 | Train Acc: 0.4211
 Site-White                     (2) | Val  Loss: 1.4986 | Val  Acc: 0.3273
 Site-White                     (2) | Val  Loss: 1.4475 | Val  Acc: 0.4121
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4104 | Val  Acc: 0.3455
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4149 | Val  Acc: 0.4000
 Site-Black                     (1) | Val  Loss: 1.5815 | Val  Acc: 0.3636
 Site-Black                     (1) | Val  Loss: 1.5162 | Val  Acc: 0.4121
 Site-East_Asian                (0) | Val  Loss: 1.5512 | Val  Acc: 0.4364
 Site-East_Asian                (4) | Val  Loss: 1.3726 | Val  Acc: 0.4485
 Site-Indian                    (3) | Val  Loss: 1.3819 | Val  Acc: 0.4545
 Site-Indian                    (3) | Val  Loss: 1.4385 | Val  Acc: 0.4061
 Site-Southeast_Asian           (5) | Val  Loss: 1.5248 | Val  Acc: 0.5273
 Site-Southeast_Asian           (4) | Val  Loss: 1.4011 | Val  Acc: 0.4848
 Site-Middle_Eastern            (2) | Val  Loss: 1.5209 | Val  Acc: 0.4727
 Site-Middle_Eastern            (4) | Val  Loss: 1.4050 | Val  Acc: 0.4424
Average Valid Accuracy: 0.4238
Aggregated Acc | Val Acc: 0.4250
 Test site-White                    | Epoch:41 | Test Acc: 0.3746
 Test site-Latino_Hispanic          | Epoch:41 | Test Acc: 0.3346
 Test site-Black                    | Epoch:41 | Test Acc: 0.3393
 Test site-East_Asian               | Epoch:41 | Test Acc: 0.4542
 Test site-Indian                   | Epoch:41 | Test Acc: 0.3179
 Test site-Southeast_Asian          | Epoch:41 | Test Acc: 0.4064
 Test site-Middle_Eastern           | Epoch:41 | Test Acc: 0.3631
Average Test Accuracy: 0.3700, domain std=0.0437, individual std=0.0437
Average Test Accuracy: 0.3700
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 1, 2, 4, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
min_w=0.06868, quan_i=1.47, quan_c=1.48
minimize weight of clients:[6, 7, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.5491 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.4247 | Train Acc: 0.4372
 Site-Latino_Hispanic          | Train Loss: 1.5831 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.3985 | Train Acc: 0.4251
 Site-Black                    | Train Loss: 1.4754 | Train Acc: 0.4512
 Site-Black                    | Train Loss: 1.4372 | Train Acc: 0.4696
 Site-East_Asian               | Train Loss: 1.3710 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.4150 | Train Acc: 0.4413
 Site-Indian                   | Train Loss: 1.4280 | Train Acc: 0.4268
 Site-Indian                   | Train Loss: 1.4306 | Train Acc: 0.4656
 Site-Southeast_Asian          | Train Loss: 1.4089 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.4552 | Train Acc: 0.4858
 Site-Middle_Eastern           | Train Loss: 1.3977 | Train Acc: 0.4878
 Site-Middle_Eastern           | Train Loss: 1.3832 | Train Acc: 0.4615
 Site-White                     (5) | Val  Loss: 1.5720 | Val  Acc: 0.3273
 Site-White                     (5) | Val  Loss: 1.4398 | Val  Acc: 0.4364
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3948 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4049 | Val  Acc: 0.4182
 Site-Black                     (4) | Val  Loss: 1.4834 | Val  Acc: 0.3455
 Site-Black                     (4) | Val  Loss: 1.4691 | Val  Acc: 0.4545
 Site-East_Asian                (3) | Val  Loss: 1.5441 | Val  Acc: 0.4545
 Site-East_Asian                (3) | Val  Loss: 1.4156 | Val  Acc: 0.4545
 Site-Indian                    (2) | Val  Loss: 1.3558 | Val  Acc: 0.4364
 Site-Indian                    (2) | Val  Loss: 1.3915 | Val  Acc: 0.4606
 Site-Southeast_Asian           (1) | Val  Loss: 1.5192 | Val  Acc: 0.4727
 Site-Southeast_Asian           (3) | Val  Loss: 1.4234 | Val  Acc: 0.4727
 Site-Middle_Eastern            (6) | Val  Loss: 1.5236 | Val  Acc: 0.4545
 Site-Middle_Eastern            (0) | Val  Loss: 1.3810 | Val  Acc: 0.4545
Average Valid Accuracy: 0.4316
Aggregated Acc | Val Acc: 0.4383
 Test site-White                    | Epoch:42 | Test Acc: 0.3707
 Test site-Latino_Hispanic          | Epoch:42 | Test Acc: 0.3327
 Test site-Black                    | Epoch:42 | Test Acc: 0.3406
 Test site-East_Asian               | Epoch:42 | Test Acc: 0.4181
 Test site-Indian                   | Epoch:42 | Test Acc: 0.3133
 Test site-Southeast_Asian          | Epoch:42 | Test Acc: 0.3823
 Test site-Middle_Eastern           | Epoch:42 | Test Acc: 0.3714
Average Test Accuracy: 0.3613, domain std=0.0325, individual std=0.0325
Average Test Accuracy: 0.3613
============ Train epoch 44 ============
cnt=[4, 3, 2, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
min_w=0.07116, quan_i=1.43, quan_c=1.44
minimize weight of clients:[3, 12, 13, ]
 Site-White                    | Train Loss: 1.4481 | Train Acc: 0.4878
 Site-White                    | Train Loss: 1.3857 | Train Acc: 0.4615
 Site-Latino_Hispanic          | Train Loss: 1.5508 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.4129 | Train Acc: 0.4008
 Site-Black                    | Train Loss: 1.5914 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.4290 | Train Acc: 0.4818
 Site-East_Asian               | Train Loss: 1.4745 | Train Acc: 0.4146
 Site-East_Asian               | Train Loss: 1.3874 | Train Acc: 0.4494
 Site-Indian                   | Train Loss: 1.4449 | Train Acc: 0.4634
 Site-Indian                   | Train Loss: 1.4219 | Train Acc: 0.4534
 Site-Southeast_Asian          | Train Loss: 1.5644 | Train Acc: 0.4756
 Site-Southeast_Asian          | Train Loss: 1.4215 | Train Acc: 0.4777
 Site-Middle_Eastern           | Train Loss: 1.2172 | Train Acc: 0.5000
 Site-Middle_Eastern           | Train Loss: 1.3530 | Train Acc: 0.4777
 Site-White                     (2) | Val  Loss: 1.4897 | Val  Acc: 0.3636
 Site-White                     (2) | Val  Loss: 1.4443 | Val  Acc: 0.4788
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4408 | Val  Acc: 0.3636
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3968 | Val  Acc: 0.4364
 Site-Black                     (5) | Val  Loss: 1.5744 | Val  Acc: 0.3091
 Site-Black                     (3) | Val  Loss: 1.5127 | Val  Acc: 0.4182
 Site-East_Asian                (0) | Val  Loss: 1.5330 | Val  Acc: 0.4182
 Site-East_Asian                (0) | Val  Loss: 1.3617 | Val  Acc: 0.4788
 Site-Indian                    (1) | Val  Loss: 1.3443 | Val  Acc: 0.4545
 Site-Indian                    (1) | Val  Loss: 1.3965 | Val  Acc: 0.4303
 Site-Southeast_Asian           (0) | Val  Loss: 1.4777 | Val  Acc: 0.5636
 Site-Southeast_Asian           (0) | Val  Loss: 1.3893 | Val  Acc: 0.4909
 Site-Middle_Eastern            (1) | Val  Loss: 1.4562 | Val  Acc: 0.4909
 Site-Middle_Eastern            (6) | Val  Loss: 1.3807 | Val  Acc: 0.4606
Average Valid Accuracy: 0.4398
Aggregated Acc | Val Acc: 0.4153
 Test site-White                    | Epoch:42 | Test Acc: 0.3760
 Test site-Latino_Hispanic          | Epoch:42 | Test Acc: 0.3352
 Test site-Black                    | Epoch:42 | Test Acc: 0.3387
 Test site-East_Asian               | Epoch:42 | Test Acc: 0.4348
 Test site-Indian                   | Epoch:42 | Test Acc: 0.3067
 Test site-Southeast_Asian          | Epoch:42 | Test Acc: 0.3859
 Test site-Middle_Eastern           | Epoch:42 | Test Acc: 0.3648
Average Test Accuracy: 0.3632, domain std=0.0385, individual std=0.0385
Average Test Accuracy: 0.3632
============ Train epoch 45 ============
cnt=[2, 2, 2, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
min_w=0.05295, quan_i=1.44, quan_c=1.43
minimize weight of clients:[7, 12, 13, ]
 Site-White                    | Train Loss: 1.3394 | Train Acc: 0.4634
 Site-White                    | Train Loss: 1.3846 | Train Acc: 0.4980
 Site-Latino_Hispanic          | Train Loss: 1.6568 | Train Acc: 0.4390
 Site-Latino_Hispanic          | Train Loss: 1.4066 | Train Acc: 0.4130
 Site-Black                    | Train Loss: 1.4738 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.4709 | Train Acc: 0.4656
 Site-East_Asian               | Train Loss: 1.4851 | Train Acc: 0.4268
 Site-East_Asian               | Train Loss: 1.4241 | Train Acc: 0.4453
 Site-Indian                   | Train Loss: 1.4849 | Train Acc: 0.4024
 Site-Indian                   | Train Loss: 1.4394 | Train Acc: 0.4575
 Site-Southeast_Asian          | Train Loss: 1.5180 | Train Acc: 0.4756
 Site-Southeast_Asian          | Train Loss: 1.4195 | Train Acc: 0.5061
 Site-Middle_Eastern           | Train Loss: 1.4210 | Train Acc: 0.4878
 Site-Middle_Eastern           | Train Loss: 1.3807 | Train Acc: 0.4615
 Site-White                     (3) | Val  Loss: 1.5144 | Val  Acc: 0.3636
 Site-White                     (3) | Val  Loss: 1.4153 | Val  Acc: 0.4182
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4259 | Val  Acc: 0.3455
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3920 | Val  Acc: 0.4424
 Site-Black                     (1) | Val  Loss: 1.5402 | Val  Acc: 0.4000
 Site-Black                     (1) | Val  Loss: 1.5143 | Val  Acc: 0.4303
 Site-East_Asian                (2) | Val  Loss: 1.5141 | Val  Acc: 0.4545
 Site-East_Asian                (2) | Val  Loss: 1.3864 | Val  Acc: 0.4606
 Site-Indian                    (5) | Val  Loss: 1.3387 | Val  Acc: 0.4182
 Site-Indian                    (5) | Val  Loss: 1.4266 | Val  Acc: 0.4303
 Site-Southeast_Asian           (0) | Val  Loss: 1.5355 | Val  Acc: 0.5818
 Site-Southeast_Asian           (0) | Val  Loss: 1.4038 | Val  Acc: 0.4788
 Site-Middle_Eastern            (4) | Val  Loss: 1.4523 | Val  Acc: 0.4545
 Site-Middle_Eastern            (6) | Val  Loss: 1.3920 | Val  Acc: 0.4545
Average Valid Accuracy: 0.4381
Aggregated Acc | Val Acc: 0.4470
 Test site-White                    | Epoch:42 | Test Acc: 0.3760
 Test site-Latino_Hispanic          | Epoch:42 | Test Acc: 0.3346
 Test site-Black                    | Epoch:42 | Test Acc: 0.3329
 Test site-East_Asian               | Epoch:42 | Test Acc: 0.4310
 Test site-Indian                   | Epoch:42 | Test Acc: 0.3094
 Test site-Southeast_Asian          | Epoch:42 | Test Acc: 0.3901
 Test site-Middle_Eastern           | Epoch:42 | Test Acc: 0.3639
Average Test Accuracy: 0.3626, domain std=0.0380, individual std=0.0380
Average Test Accuracy: 0.3626
============ Train epoch 46 ============
cnt=[2, 1, 5, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
min_w=0.06502, quan_i=1.44, quan_c=1.44
minimize weight of clients:[0, 1, 3, 12, 13, ]
 Site-White                    | Train Loss: 1.4245 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.3881 | Train Acc: 0.4696
 Site-Latino_Hispanic          | Train Loss: 1.6291 | Train Acc: 0.3293
 Site-Latino_Hispanic          | Train Loss: 1.4101 | Train Acc: 0.4211
 Site-Black                    | Train Loss: 1.5079 | Train Acc: 0.3415
 Site-Black                    | Train Loss: 1.4325 | Train Acc: 0.4291
 Site-East_Asian               | Train Loss: 1.2832 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.3807 | Train Acc: 0.4575
 Site-Indian                   | Train Loss: 1.2874 | Train Acc: 0.4512
 Site-Indian                   | Train Loss: 1.4319 | Train Acc: 0.4534
 Site-Southeast_Asian          | Train Loss: 1.5258 | Train Acc: 0.4512
 Site-Southeast_Asian          | Train Loss: 1.4119 | Train Acc: 0.4939
 Site-Middle_Eastern           | Train Loss: 1.3853 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.3664 | Train Acc: 0.4818
 Site-White                     (1) | Val  Loss: 1.5035 | Val  Acc: 0.3273
 Site-White                     (2) | Val  Loss: 1.4064 | Val  Acc: 0.4606
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4678 | Val  Acc: 0.3818
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4293 | Val  Acc: 0.4364
 Site-Black                     (6) | Val  Loss: 1.5553 | Val  Acc: 0.3636
 Site-Black                     (3) | Val  Loss: 1.4902 | Val  Acc: 0.4000
 Site-East_Asian                (5) | Val  Loss: 1.4866 | Val  Acc: 0.4545
 Site-East_Asian                (5) | Val  Loss: 1.3671 | Val  Acc: 0.4667
 Site-Indian                    (0) | Val  Loss: 1.3273 | Val  Acc: 0.4727
 Site-Indian                    (0) | Val  Loss: 1.3747 | Val  Acc: 0.4667
 Site-Southeast_Asian           (2) | Val  Loss: 1.4993 | Val  Acc: 0.4909
 Site-Southeast_Asian           (5) | Val  Loss: 1.3842 | Val  Acc: 0.5212
 Site-Middle_Eastern            (2) | Val  Loss: 1.4545 | Val  Acc: 0.4727
 Site-Middle_Eastern            (2) | Val  Loss: 1.4181 | Val  Acc: 0.4727
Average Valid Accuracy: 0.4420
Aggregated Acc | Val Acc: 0.4128
 Best site-White                    (1)  | Epoch:46 | Val Acc: 0.3273
 Best site-White                    (2)  | Epoch:46 | Val Acc: 0.4606
 Best site-Latino_Hispanic          (4)  | Epoch:46 | Val Acc: 0.3818
 Best site-Latino_Hispanic          (2)  | Epoch:46 | Val Acc: 0.4364
 Best site-Black                    (6)  | Epoch:46 | Val Acc: 0.3636
 Best site-Black                    (3)  | Epoch:46 | Val Acc: 0.4000
 Best site-East_Asian               (5)  | Epoch:46 | Val Acc: 0.4545
 Best site-East_Asian               (5)  | Epoch:46 | Val Acc: 0.4667
 Best site-Indian                   (0)  | Epoch:46 | Val Acc: 0.4727
 Best site-Indian                   (0)  | Epoch:46 | Val Acc: 0.4667
 Best site-Southeast_Asian          (2)  | Epoch:46 | Val Acc: 0.4909
 Best site-Southeast_Asian          (5)  | Epoch:46 | Val Acc: 0.5212
 Best site-Middle_Eastern           (2)  | Epoch:46 | Val Acc: 0.4727
 Best site-Middle_Eastern           (2)  | Epoch:46 | Val Acc: 0.4727
 Test site-White                    | Epoch:46 | Test Acc: 0.3770
 Test site-Latino_Hispanic          | Epoch:46 | Test Acc: 0.3333
 Test site-Black                    | Epoch:46 | Test Acc: 0.3310
 Test site-East_Asian               | Epoch:46 | Test Acc: 0.4348
 Test site-Indian                   | Epoch:46 | Test Acc: 0.3094
 Test site-Southeast_Asian          | Epoch:46 | Test Acc: 0.3943
 Test site-Middle_Eastern           | Epoch:46 | Test Acc: 0.3615
Average Test Accuracy: 0.3630, domain std=0.0399, individual std=0.0399
Average Test Accuracy: 0.3630
============ Train epoch 47 ============
cnt=[1, 2, 1, 3, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
min_w=0.06488, quan_i=1.43, quan_c=1.40
minimize weight of clients:[1, 12, 13, ]
 Site-White                    | Train Loss: 1.4391 | Train Acc: 0.4756
 Site-White                    | Train Loss: 1.4007 | Train Acc: 0.4372
 Site-Latino_Hispanic          | Train Loss: 1.5745 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.3818 | Train Acc: 0.4453
 Site-Black                    | Train Loss: 1.5366 | Train Acc: 0.3293
 Site-Black                    | Train Loss: 1.4453 | Train Acc: 0.4494
 Site-East_Asian               | Train Loss: 1.4974 | Train Acc: 0.4268
 Site-East_Asian               | Train Loss: 1.3933 | Train Acc: 0.4696
 Site-Indian                   | Train Loss: 1.4786 | Train Acc: 0.4634
 Site-Indian                   | Train Loss: 1.3925 | Train Acc: 0.4494
 Site-Southeast_Asian          | Train Loss: 1.6538 | Train Acc: 0.3902
 Site-Southeast_Asian          | Train Loss: 1.4313 | Train Acc: 0.4858
 Site-Middle_Eastern           | Train Loss: 1.4527 | Train Acc: 0.4390
 Site-Middle_Eastern           | Train Loss: 1.3724 | Train Acc: 0.4615
 Site-White                     (1) | Val  Loss: 1.4495 | Val  Acc: 0.4000
 Site-White                     (1) | Val  Loss: 1.4304 | Val  Acc: 0.4424
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4380 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4167 | Val  Acc: 0.4364
 Site-Black                     (2) | Val  Loss: 1.5439 | Val  Acc: 0.3455
 Site-Black                     (6) | Val  Loss: 1.4508 | Val  Acc: 0.4606
 Site-East_Asian                (4) | Val  Loss: 1.4949 | Val  Acc: 0.4364
 Site-East_Asian                (4) | Val  Loss: 1.3979 | Val  Acc: 0.4727
 Site-Indian                    (3) | Val  Loss: 1.2921 | Val  Acc: 0.5091
 Site-Indian                    (3) | Val  Loss: 1.3913 | Val  Acc: 0.4545
 Site-Southeast_Asian           (0) | Val  Loss: 1.4743 | Val  Acc: 0.5091
 Site-Southeast_Asian           (4) | Val  Loss: 1.3830 | Val  Acc: 0.5030
 Site-Middle_Eastern            (5) | Val  Loss: 1.4435 | Val  Acc: 0.4364
 Site-Middle_Eastern            (5) | Val  Loss: 1.4243 | Val  Acc: 0.4121
Average Valid Accuracy: 0.4442
Aggregated Acc | Val Acc: 0.4396
 Best site-White                    (1)  | Epoch:47 | Val Acc: 0.4000
 Best site-White                    (1)  | Epoch:47 | Val Acc: 0.4424
 Best site-Latino_Hispanic          (3)  | Epoch:47 | Val Acc: 0.4000
 Best site-Latino_Hispanic          (4)  | Epoch:47 | Val Acc: 0.4364
 Best site-Black                    (2)  | Epoch:47 | Val Acc: 0.3455
 Best site-Black                    (6)  | Epoch:47 | Val Acc: 0.4606
 Best site-East_Asian               (4)  | Epoch:47 | Val Acc: 0.4364
 Best site-East_Asian               (4)  | Epoch:47 | Val Acc: 0.4727
 Best site-Indian                   (3)  | Epoch:47 | Val Acc: 0.5091
 Best site-Indian                   (3)  | Epoch:47 | Val Acc: 0.4545
 Best site-Southeast_Asian          (0)  | Epoch:47 | Val Acc: 0.5091
 Best site-Southeast_Asian          (4)  | Epoch:47 | Val Acc: 0.5030
 Best site-Middle_Eastern           (5)  | Epoch:47 | Val Acc: 0.4364
 Best site-Middle_Eastern           (5)  | Epoch:47 | Val Acc: 0.4121
 Test site-White                    | Epoch:47 | Test Acc: 0.3765
 Test site-Latino_Hispanic          | Epoch:47 | Test Acc: 0.3352
 Test site-Black                    | Epoch:47 | Test Acc: 0.3400
 Test site-East_Asian               | Epoch:47 | Test Acc: 0.4258
 Test site-Indian                   | Epoch:47 | Test Acc: 0.3127
 Test site-Southeast_Asian          | Epoch:47 | Test Acc: 0.3922
 Test site-Middle_Eastern           | Epoch:47 | Test Acc: 0.3615
Average Test Accuracy: 0.3634, domain std=0.0355, individual std=0.0355
Average Test Accuracy: 0.3634
============ Train epoch 48 ============
cnt=[3, 2, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
min_w=0.07321, quan_i=1.45, quan_c=1.46
minimize weight of clients:[1, 7, 9, 13, ]
 Site-White                    | Train Loss: 1.3987 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.4333 | Train Acc: 0.4291
 Site-Latino_Hispanic          | Train Loss: 1.5895 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.3625 | Train Acc: 0.4211
 Site-Black                    | Train Loss: 1.5163 | Train Acc: 0.4146
 Site-Black                    | Train Loss: 1.4500 | Train Acc: 0.4575
 Site-East_Asian               | Train Loss: 1.4622 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.3992 | Train Acc: 0.4858
 Site-Indian                   | Train Loss: 1.5423 | Train Acc: 0.4268
 Site-Indian                   | Train Loss: 1.4042 | Train Acc: 0.4858
 Site-Southeast_Asian          | Train Loss: 1.6496 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.4256 | Train Acc: 0.4656
 Site-Middle_Eastern           | Train Loss: 1.4930 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.3567 | Train Acc: 0.4534
 Site-White                     (1) | Val  Loss: 1.4907 | Val  Acc: 0.3636
 Site-White                     (1) | Val  Loss: 1.3974 | Val  Acc: 0.4485
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3221 | Val  Acc: 0.3818
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4085 | Val  Acc: 0.4182
 Site-Black                     (4) | Val  Loss: 1.5885 | Val  Acc: 0.3818
 Site-Black                     (4) | Val  Loss: 1.5025 | Val  Acc: 0.4242
 Site-East_Asian                (3) | Val  Loss: 1.5666 | Val  Acc: 0.4364
 Site-East_Asian                (2) | Val  Loss: 1.3623 | Val  Acc: 0.4545
 Site-Indian                    (0) | Val  Loss: 1.3577 | Val  Acc: 0.5273
 Site-Indian                    (0) | Val  Loss: 1.3873 | Val  Acc: 0.4788
 Site-Southeast_Asian           (3) | Val  Loss: 1.4744 | Val  Acc: 0.5455
 Site-Southeast_Asian           (3) | Val  Loss: 1.3660 | Val  Acc: 0.5394
 Site-Middle_Eastern            (6) | Val  Loss: 1.4614 | Val  Acc: 0.4727
 Site-Middle_Eastern            (5) | Val  Loss: 1.4102 | Val  Acc: 0.4303
Average Valid Accuracy: 0.4502
Aggregated Acc | Val Acc: 0.4449
 Best site-White                    (1)  | Epoch:48 | Val Acc: 0.3636
 Best site-White                    (1)  | Epoch:48 | Val Acc: 0.4485
 Best site-Latino_Hispanic          (0)  | Epoch:48 | Val Acc: 0.3818
 Best site-Latino_Hispanic          (3)  | Epoch:48 | Val Acc: 0.4182
 Best site-Black                    (4)  | Epoch:48 | Val Acc: 0.3818
 Best site-Black                    (4)  | Epoch:48 | Val Acc: 0.4242
 Best site-East_Asian               (3)  | Epoch:48 | Val Acc: 0.4364
 Best site-East_Asian               (2)  | Epoch:48 | Val Acc: 0.4545
 Best site-Indian                   (0)  | Epoch:48 | Val Acc: 0.5273
 Best site-Indian                   (0)  | Epoch:48 | Val Acc: 0.4788
 Best site-Southeast_Asian          (3)  | Epoch:48 | Val Acc: 0.5455
 Best site-Southeast_Asian          (3)  | Epoch:48 | Val Acc: 0.5394
 Best site-Middle_Eastern           (6)  | Epoch:48 | Val Acc: 0.4727
 Best site-Middle_Eastern           (5)  | Epoch:48 | Val Acc: 0.4303
 Test site-White                    | Epoch:48 | Test Acc: 0.3755
 Test site-Latino_Hispanic          | Epoch:48 | Test Acc: 0.3339
 Test site-Black                    | Epoch:48 | Test Acc: 0.3368
 Test site-East_Asian               | Epoch:48 | Test Acc: 0.4265
 Test site-Indian                   | Epoch:48 | Test Acc: 0.3153
 Test site-Southeast_Asian          | Epoch:48 | Test Acc: 0.3936
 Test site-Middle_Eastern           | Epoch:48 | Test Acc: 0.3664
Average Test Accuracy: 0.3640, domain std=0.0357, individual std=0.0357
Average Test Accuracy: 0.3640
============ Train epoch 49 ============
cnt=[2, 2, 2, 2, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
min_w=0.07068, quan_i=1.46, quan_c=1.44
minimize weight of clients:[0, 1, 3, 7, 13, ]
 Site-White                    | Train Loss: 1.2577 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.3941 | Train Acc: 0.4656
 Site-Latino_Hispanic          | Train Loss: 1.6083 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.3833 | Train Acc: 0.4332
 Site-Black                    | Train Loss: 1.5740 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.4211 | Train Acc: 0.4899
 Site-East_Asian               | Train Loss: 1.3799 | Train Acc: 0.4024
 Site-East_Asian               | Train Loss: 1.3983 | Train Acc: 0.4575
 Site-Indian                   | Train Loss: 1.4477 | Train Acc: 0.4512
 Site-Indian                   | Train Loss: 1.3886 | Train Acc: 0.4696
 Site-Southeast_Asian          | Train Loss: 1.4027 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.3923 | Train Acc: 0.5142
 Site-Middle_Eastern           | Train Loss: 1.5158 | Train Acc: 0.4390
 Site-Middle_Eastern           | Train Loss: 1.3716 | Train Acc: 0.4575
 Site-White                     (5) | Val  Loss: 1.5212 | Val  Acc: 0.3818
 Site-White                     (5) | Val  Loss: 1.3960 | Val  Acc: 0.4485
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4174 | Val  Acc: 0.4000
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4280 | Val  Acc: 0.4182
 Site-Black                     (3) | Val  Loss: 1.4688 | Val  Acc: 0.4545
 Site-Black                     (3) | Val  Loss: 1.5317 | Val  Acc: 0.4606
 Site-East_Asian                (1) | Val  Loss: 1.5229 | Val  Acc: 0.3636
 Site-East_Asian                (1) | Val  Loss: 1.4049 | Val  Acc: 0.4424
 Site-Indian                    (2) | Val  Loss: 1.3698 | Val  Acc: 0.4182
 Site-Indian                    (2) | Val  Loss: 1.3859 | Val  Acc: 0.4727
 Site-Southeast_Asian           (6) | Val  Loss: 1.4370 | Val  Acc: 0.5273
 Site-Southeast_Asian           (6) | Val  Loss: 1.3463 | Val  Acc: 0.5091
 Site-Middle_Eastern            (4) | Val  Loss: 1.5098 | Val  Acc: 0.4545
 Site-Middle_Eastern            (5) | Val  Loss: 1.3977 | Val  Acc: 0.4424
Average Valid Accuracy: 0.4424
Aggregated Acc | Val Acc: 0.4446
 Test site-White                    | Epoch:48 | Test Acc: 0.3736
 Test site-Latino_Hispanic          | Epoch:48 | Test Acc: 0.3327
 Test site-Black                    | Epoch:48 | Test Acc: 0.3374
 Test site-East_Asian               | Epoch:48 | Test Acc: 0.4297
 Test site-Indian                   | Epoch:48 | Test Acc: 0.3146
 Test site-Southeast_Asian          | Epoch:48 | Test Acc: 0.3894
 Test site-Middle_Eastern           | Epoch:48 | Test Acc: 0.3590
Average Test Accuracy: 0.3623, domain std=0.0362, individual std=0.0362
Average Test Accuracy: 0.3623
===2023-06-01 17:19:57===
===2023-06-01 17:20:15===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.5
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: 49
data_number=[82,247,82,247,82,247,82,247,82,247,82,247,82,247,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1100,1100,1100,1100,1100,1100,1100,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
Loading snapshots...
 Test site-White                    | Epoch:42 | Test Acc: 0.3746
 Test site-Latino_Hispanic          | Epoch:42 | Test Acc: 0.3346
 Test site-Black                    | Epoch:42 | Test Acc: 0.3393
 Test site-East_Asian               | Epoch:42 | Test Acc: 0.4542
 Test site-Indian                   | Epoch:42 | Test Acc: 0.3179
 Test site-Southeast_Asian          | Epoch:42 | Test Acc: 0.4064
 Test site-Middle_Eastern           | Epoch:42 | Test Acc: 0.3631
Average Test Accuracy: 0.3700, domain std=0.0437, individual std=0.0437
