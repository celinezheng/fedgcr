===2023-08-04 11:59:30===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[28,37,47,61,79,103,133,172,222,287,24,37,55,83,124,50,100,69,
client_nums=[10,5,2,1,]
len_dataset=[1959,544,251,116,]
domain number = 4
============ Train epoch 0 ============
 Site-amazon                        | Train Loss: 3.3592 | Train Acc: 0.1786
 Site-amazon                        | Train Loss: 3.3026 | Train Acc: 0.4865
 Site-amazon                        | Train Loss: 3.3432 | Train Acc: 0.2340
 Site-amazon                        | Train Loss: 3.3382 | Train Acc: 0.1639
 Site-amazon                        | Train Loss: 3.3402 | Train Acc: 0.2152
 Site-amazon                        | Train Loss: 3.3348 | Train Acc: 0.2524
 Site-amazon                        | Train Loss: 3.3824 | Train Acc: 0.2481
 Site-amazon                        | Train Loss: 3.3351 | Train Acc: 0.1744
 Site-amazon                        | Train Loss: 3.3431 | Train Acc: 0.1937
 Site-amazon                        | Train Loss: 3.3355 | Train Acc: 0.2474
 Site-webcam                        | Train Loss: 3.2970 | Train Acc: 0.2917
 Site-webcam                        | Train Loss: 3.3331 | Train Acc: 0.1351
 Site-webcam                        | Train Loss: 3.3327 | Train Acc: 0.2364
 Site-webcam                        | Train Loss: 3.3662 | Train Acc: 0.1928
 Site-webcam                        | Train Loss: 3.3399 | Train Acc: 0.2339
 Site-dslr                          | Train Loss: 3.3478 | Train Acc: 0.1200
 Site-dslr                          | Train Loss: 3.3377 | Train Acc: 0.1500
 Site-synthetic                     | Train Loss: 3.3937 | Train Acc: 0.1594
Average Train Accuracy: 0.2174
 Site-amazon                        | Val  Loss: 3.3119 | Val  Acc: 0.3158
 Site-amazon                        | Val  Loss: 3.3290 | Val  Acc: 0.3750
 Site-amazon                        | Val  Loss: 3.3541 | Val  Acc: 0.1935
 Site-amazon                        | Val  Loss: 3.3633 | Val  Acc: 0.1951
 Site-amazon                        | Val  Loss: 3.3346 | Val  Acc: 0.2642
 Site-amazon                        | Val  Loss: 3.3248 | Val  Acc: 0.3088
 Site-amazon                        | Val  Loss: 3.3337 | Val  Acc: 0.2045
 Site-amazon                        | Val  Loss: 3.3344 | Val  Acc: 0.2544
 Site-amazon                        | Val  Loss: 3.3295 | Val  Acc: 0.2973
 Site-amazon                        | Val  Loss: 3.3405 | Val  Acc: 0.2356
 Site-webcam                        | Val  Loss: 3.2918 | Val  Acc: 0.3125
 Site-webcam                        | Val  Loss: 3.2834 | Val  Acc: 0.3333
 Site-webcam                        | Val  Loss: 3.3435 | Val  Acc: 0.2432
 Site-webcam                        | Val  Loss: 3.3430 | Val  Acc: 0.1273
 Site-webcam                        | Val  Loss: 3.3463 | Val  Acc: 0.1829
 Site-dslr                          | Val  Loss: 3.3759 | Val  Acc: 0.0606
 Site-dslr                          | Val  Loss: 3.3577 | Val  Acc: 0.1818
 Site-synthetic                     | Val  Loss: 3.4295 | Val  Acc: 0.0870
Average Valid Accuracy: 0.2318
 Best site-amazon                    | Epoch:0 | Val Acc: 0.3158
 Best site-amazon                    | Epoch:0 | Val Acc: 0.3750
 Best site-amazon                    | Epoch:0 | Val Acc: 0.1935
 Best site-amazon                    | Epoch:0 | Val Acc: 0.1951
 Best site-amazon                    | Epoch:0 | Val Acc: 0.2642
 Best site-amazon                    | Epoch:0 | Val Acc: 0.3088
 Best site-amazon                    | Epoch:0 | Val Acc: 0.2045
 Best site-amazon                    | Epoch:0 | Val Acc: 0.2544
 Best site-amazon                    | Epoch:0 | Val Acc: 0.2973
 Best site-amazon                    | Epoch:0 | Val Acc: 0.2356
 Best site-webcam                    | Epoch:0 | Val Acc: 0.3125
 Best site-webcam                    | Epoch:0 | Val Acc: 0.3333
 Best site-webcam                    | Epoch:0 | Val Acc: 0.2432
 Best site-webcam                    | Epoch:0 | Val Acc: 0.1273
 Best site-webcam                    | Epoch:0 | Val Acc: 0.1829
 Best site-dslr                      | Epoch:0 | Val Acc: 0.0606
 Best site-dslr                      | Epoch:0 | Val Acc: 0.1818
 Best site-synthetic                 | Epoch:0 | Val Acc: 0.0870
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 1 ============
 Site-amazon                        | Train Loss: 3.2489 | Train Acc: 0.4286
 Site-amazon                        | Train Loss: 3.2081 | Train Acc: 0.6757
 Site-amazon                        | Train Loss: 3.2354 | Train Acc: 0.5957
 Site-amazon                        | Train Loss: 3.2331 | Train Acc: 0.5902
 Site-amazon                        | Train Loss: 3.2513 | Train Acc: 0.5316
 Site-amazon                        | Train Loss: 3.2301 | Train Acc: 0.6019
 Site-amazon                        | Train Loss: 3.2184 | Train Acc: 0.5414
 Site-amazon                        | Train Loss: 3.2365 | Train Acc: 0.5756
 Site-amazon                        | Train Loss: 3.2346 | Train Acc: 0.5541
 Site-amazon                        | Train Loss: 3.2393 | Train Acc: 0.5610
 Site-webcam                        | Train Loss: 3.2078 | Train Acc: 0.6250
 Site-webcam                        | Train Loss: 3.2490 | Train Acc: 0.5946
 Site-webcam                        | Train Loss: 3.2469 | Train Acc: 0.5818
 Site-webcam                        | Train Loss: 3.2780 | Train Acc: 0.4217
 Site-webcam                        | Train Loss: 3.2523 | Train Acc: 0.5081
 Site-dslr                          | Train Loss: 3.2734 | Train Acc: 0.3800
 Site-dslr                          | Train Loss: 3.2545 | Train Acc: 0.4800
 Site-synthetic                     | Train Loss: 3.3114 | Train Acc: 0.2319
Average Train Accuracy: 0.5266
 Site-amazon                        | Val  Loss: 3.1963 | Val  Acc: 0.6316
 Site-amazon                        | Val  Loss: 3.2204 | Val  Acc: 0.6250
 Site-amazon                        | Val  Loss: 3.2716 | Val  Acc: 0.4839
 Site-amazon                        | Val  Loss: 3.2680 | Val  Acc: 0.4146
 Site-amazon                        | Val  Loss: 3.2396 | Val  Acc: 0.5472
 Site-amazon                        | Val  Loss: 3.2092 | Val  Acc: 0.5294
 Site-amazon                        | Val  Loss: 3.2250 | Val  Acc: 0.6250
 Site-amazon                        | Val  Loss: 3.2375 | Val  Acc: 0.5614
 Site-amazon                        | Val  Loss: 3.2331 | Val  Acc: 0.5743
 Site-amazon                        | Val  Loss: 3.2329 | Val  Acc: 0.5393
 Site-webcam                        | Val  Loss: 3.1888 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 3.2227 | Val  Acc: 0.5833
 Site-webcam                        | Val  Loss: 3.2617 | Val  Acc: 0.4595
 Site-webcam                        | Val  Loss: 3.2735 | Val  Acc: 0.4909
 Site-webcam                        | Val  Loss: 3.2603 | Val  Acc: 0.5122
 Site-dslr                          | Val  Loss: 3.2808 | Val  Acc: 0.4848
 Site-dslr                          | Val  Loss: 3.2668 | Val  Acc: 0.4242
 Site-synthetic                     | Val  Loss: 3.3611 | Val  Acc: 0.1957
Average Valid Accuracy: 0.5240
 Best site-amazon                    | Epoch:1 | Val Acc: 0.6316
 Best site-amazon                    | Epoch:1 | Val Acc: 0.6250
 Best site-amazon                    | Epoch:1 | Val Acc: 0.4839
 Best site-amazon                    | Epoch:1 | Val Acc: 0.4146
 Best site-amazon                    | Epoch:1 | Val Acc: 0.5472
 Best site-amazon                    | Epoch:1 | Val Acc: 0.5294
 Best site-amazon                    | Epoch:1 | Val Acc: 0.6250
 Best site-amazon                    | Epoch:1 | Val Acc: 0.5614
 Best site-amazon                    | Epoch:1 | Val Acc: 0.5743
 Best site-amazon                    | Epoch:1 | Val Acc: 0.5393
 Best site-webcam                    | Epoch:1 | Val Acc: 0.7500
 Best site-webcam                    | Epoch:1 | Val Acc: 0.5833
 Best site-webcam                    | Epoch:1 | Val Acc: 0.4595
 Best site-webcam                    | Epoch:1 | Val Acc: 0.4909
 Best site-webcam                    | Epoch:1 | Val Acc: 0.5122
 Best site-dslr                      | Epoch:1 | Val Acc: 0.4848
 Best site-dslr                      | Epoch:1 | Val Acc: 0.4242
 Best site-synthetic                 | Epoch:1 | Val Acc: 0.1957
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 2 ============
 Site-amazon                        | Train Loss: 3.1399 | Train Acc: 0.6071
 Site-amazon                        | Train Loss: 3.0997 | Train Acc: 0.7838
 Site-amazon                        | Train Loss: 3.1178 | Train Acc: 0.8298
 Site-amazon                        | Train Loss: 3.1393 | Train Acc: 0.6721
 Site-amazon                        | Train Loss: 3.1345 | Train Acc: 0.7342
 Site-amazon                        | Train Loss: 3.1418 | Train Acc: 0.6893
 Site-amazon                        | Train Loss: 3.1453 | Train Acc: 0.6842
 Site-amazon                        | Train Loss: 3.1351 | Train Acc: 0.7093
 Site-amazon                        | Train Loss: 3.1372 | Train Acc: 0.6712
 Site-amazon                        | Train Loss: 3.1421 | Train Acc: 0.7143
 Site-webcam                        | Train Loss: 3.1432 | Train Acc: 0.7083
 Site-webcam                        | Train Loss: 3.1745 | Train Acc: 0.7568
 Site-webcam                        | Train Loss: 3.1597 | Train Acc: 0.6545
 Site-webcam                        | Train Loss: 3.1902 | Train Acc: 0.5663
 Site-webcam                        | Train Loss: 3.1670 | Train Acc: 0.6694
 Site-dslr                          | Train Loss: 3.1833 | Train Acc: 0.6600
 Site-dslr                          | Train Loss: 3.1546 | Train Acc: 0.6700
 Site-synthetic                     | Train Loss: 3.2279 | Train Acc: 0.2754
Average Train Accuracy: 0.6698
 Site-amazon                        | Val  Loss: 3.0836 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 3.1108 | Val  Acc: 0.7083
 Site-amazon                        | Val  Loss: 3.1565 | Val  Acc: 0.6774
 Site-amazon                        | Val  Loss: 3.1870 | Val  Acc: 0.5366
 Site-amazon                        | Val  Loss: 3.1425 | Val  Acc: 0.7358
 Site-amazon                        | Val  Loss: 3.0915 | Val  Acc: 0.7353
 Site-amazon                        | Val  Loss: 3.1363 | Val  Acc: 0.6932
 Site-amazon                        | Val  Loss: 3.1385 | Val  Acc: 0.6930
 Site-amazon                        | Val  Loss: 3.1337 | Val  Acc: 0.6689
 Site-amazon                        | Val  Loss: 3.1313 | Val  Acc: 0.6911
 Site-webcam                        | Val  Loss: 3.1317 | Val  Acc: 0.6250
 Site-webcam                        | Val  Loss: 3.1398 | Val  Acc: 0.7083
 Site-webcam                        | Val  Loss: 3.1667 | Val  Acc: 0.6216
 Site-webcam                        | Val  Loss: 3.1738 | Val  Acc: 0.6000
 Site-webcam                        | Val  Loss: 3.1819 | Val  Acc: 0.5976
 Site-dslr                          | Val  Loss: 3.1885 | Val  Acc: 0.5152
 Site-dslr                          | Val  Loss: 3.1955 | Val  Acc: 0.6667
 Site-synthetic                     | Val  Loss: 3.3393 | Val  Acc: 0.2609
Average Valid Accuracy: 0.6519
 Best site-amazon                    | Epoch:2 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:2 | Val Acc: 0.7083
 Best site-amazon                    | Epoch:2 | Val Acc: 0.6774
 Best site-amazon                    | Epoch:2 | Val Acc: 0.5366
 Best site-amazon                    | Epoch:2 | Val Acc: 0.7358
 Best site-amazon                    | Epoch:2 | Val Acc: 0.7353
 Best site-amazon                    | Epoch:2 | Val Acc: 0.6932
 Best site-amazon                    | Epoch:2 | Val Acc: 0.6930
 Best site-amazon                    | Epoch:2 | Val Acc: 0.6689
 Best site-amazon                    | Epoch:2 | Val Acc: 0.6911
 Best site-webcam                    | Epoch:2 | Val Acc: 0.6250
 Best site-webcam                    | Epoch:2 | Val Acc: 0.7083
 Best site-webcam                    | Epoch:2 | Val Acc: 0.6216
 Best site-webcam                    | Epoch:2 | Val Acc: 0.6000
 Best site-webcam                    | Epoch:2 | Val Acc: 0.5976
 Best site-dslr                      | Epoch:2 | Val Acc: 0.5152
 Best site-dslr                      | Epoch:2 | Val Acc: 0.6667
 Best site-synthetic                 | Epoch:2 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 3 ============
 Site-amazon                        | Train Loss: 3.0422 | Train Acc: 0.7857
 Site-amazon                        | Train Loss: 2.9952 | Train Acc: 0.7838
 Site-amazon                        | Train Loss: 3.0269 | Train Acc: 0.8298
 Site-amazon                        | Train Loss: 3.0311 | Train Acc: 0.7377
 Site-amazon                        | Train Loss: 3.0438 | Train Acc: 0.7848
 Site-amazon                        | Train Loss: 3.0351 | Train Acc: 0.8155
 Site-amazon                        | Train Loss: 3.0381 | Train Acc: 0.7519
 Site-amazon                        | Train Loss: 3.0385 | Train Acc: 0.7616
 Site-amazon                        | Train Loss: 3.0441 | Train Acc: 0.7928
 Site-amazon                        | Train Loss: 3.0396 | Train Acc: 0.7770
 Site-webcam                        | Train Loss: 3.0507 | Train Acc: 0.7917
 Site-webcam                        | Train Loss: 3.0944 | Train Acc: 0.7297
 Site-webcam                        | Train Loss: 3.0679 | Train Acc: 0.7455
 Site-webcam                        | Train Loss: 3.0646 | Train Acc: 0.6506
 Site-webcam                        | Train Loss: 3.0910 | Train Acc: 0.7016
 Site-dslr                          | Train Loss: 3.1092 | Train Acc: 0.6800
 Site-dslr                          | Train Loss: 3.0814 | Train Acc: 0.7200
 Site-synthetic                     | Train Loss: 3.2124 | Train Acc: 0.3333
Average Train Accuracy: 0.7318
 Site-amazon                        | Val  Loss: 2.9885 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 3.0262 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 3.0632 | Val  Acc: 0.6774
 Site-amazon                        | Val  Loss: 3.0860 | Val  Acc: 0.6829
 Site-amazon                        | Val  Loss: 3.0349 | Val  Acc: 0.8679
 Site-amazon                        | Val  Loss: 2.9970 | Val  Acc: 0.8382
 Site-amazon                        | Val  Loss: 3.0281 | Val  Acc: 0.7727
 Site-amazon                        | Val  Loss: 3.0387 | Val  Acc: 0.8070
 Site-amazon                        | Val  Loss: 3.0324 | Val  Acc: 0.7905
 Site-amazon                        | Val  Loss: 3.0313 | Val  Acc: 0.8115
 Site-webcam                        | Val  Loss: 3.0843 | Val  Acc: 0.6250
 Site-webcam                        | Val  Loss: 3.0571 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 3.0677 | Val  Acc: 0.7568
 Site-webcam                        | Val  Loss: 3.0886 | Val  Acc: 0.7455
 Site-webcam                        | Val  Loss: 3.0869 | Val  Acc: 0.6585
 Site-dslr                          | Val  Loss: 3.0978 | Val  Acc: 0.6667
 Site-dslr                          | Val  Loss: 3.0665 | Val  Acc: 0.7727
 Site-synthetic                     | Val  Loss: 3.2973 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7377
 Best site-amazon                    | Epoch:3 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:3 | Val Acc: 0.7500
 Best site-amazon                    | Epoch:3 | Val Acc: 0.6774
 Best site-amazon                    | Epoch:3 | Val Acc: 0.6829
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8679
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8382
 Best site-amazon                    | Epoch:3 | Val Acc: 0.7727
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8070
 Best site-amazon                    | Epoch:3 | Val Acc: 0.7905
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8115
 Best site-webcam                    | Epoch:3 | Val Acc: 0.6250
 Best site-webcam                    | Epoch:3 | Val Acc: 0.7500
 Best site-webcam                    | Epoch:3 | Val Acc: 0.7568
 Best site-webcam                    | Epoch:3 | Val Acc: 0.7455
 Best site-webcam                    | Epoch:3 | Val Acc: 0.6585
 Best site-dslr                      | Epoch:3 | Val Acc: 0.6667
 Best site-dslr                      | Epoch:3 | Val Acc: 0.7727
 Best site-synthetic                 | Epoch:3 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 4 ============
 Site-amazon                        | Train Loss: 2.9777 | Train Acc: 0.7857
 Site-amazon                        | Train Loss: 2.9031 | Train Acc: 0.8649
 Site-amazon                        | Train Loss: 2.9284 | Train Acc: 0.8723
 Site-amazon                        | Train Loss: 2.9364 | Train Acc: 0.8689
 Site-amazon                        | Train Loss: 2.9479 | Train Acc: 0.8481
 Site-amazon                        | Train Loss: 2.9124 | Train Acc: 0.8447
 Site-amazon                        | Train Loss: 2.9072 | Train Acc: 0.8045
 Site-amazon                        | Train Loss: 2.9501 | Train Acc: 0.8314
 Site-amazon                        | Train Loss: 2.9419 | Train Acc: 0.8514
 Site-amazon                        | Train Loss: 2.9437 | Train Acc: 0.8258
 Site-webcam                        | Train Loss: 2.9695 | Train Acc: 0.8333
 Site-webcam                        | Train Loss: 3.0188 | Train Acc: 0.7568
 Site-webcam                        | Train Loss: 2.9758 | Train Acc: 0.8182
 Site-webcam                        | Train Loss: 3.0028 | Train Acc: 0.7349
 Site-webcam                        | Train Loss: 3.0023 | Train Acc: 0.7823
 Site-dslr                          | Train Loss: 3.0537 | Train Acc: 0.7600
 Site-dslr                          | Train Loss: 2.9857 | Train Acc: 0.7500
 Site-synthetic                     | Train Loss: 3.1994 | Train Acc: 0.3478
Average Train Accuracy: 0.7878
 Site-amazon                        | Val  Loss: 2.8825 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 2.9227 | Val  Acc: 0.7917
 Site-amazon                        | Val  Loss: 2.9762 | Val  Acc: 0.7097
 Site-amazon                        | Val  Loss: 2.9927 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 2.9425 | Val  Acc: 0.8491
 Site-amazon                        | Val  Loss: 2.9213 | Val  Acc: 0.8824
 Site-amazon                        | Val  Loss: 2.9187 | Val  Acc: 0.8523
 Site-amazon                        | Val  Loss: 2.9458 | Val  Acc: 0.7895
 Site-amazon                        | Val  Loss: 2.9327 | Val  Acc: 0.7838
 Site-amazon                        | Val  Loss: 2.9379 | Val  Acc: 0.8220
 Site-webcam                        | Val  Loss: 2.9779 | Val  Acc: 0.6875
 Site-webcam                        | Val  Loss: 2.9845 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 2.9996 | Val  Acc: 0.7838
 Site-webcam                        | Val  Loss: 2.9891 | Val  Acc: 0.7818
 Site-webcam                        | Val  Loss: 2.9811 | Val  Acc: 0.7805
 Site-dslr                          | Val  Loss: 3.0390 | Val  Acc: 0.6364
 Site-dslr                          | Val  Loss: 3.0201 | Val  Acc: 0.7576
 Site-synthetic                     | Val  Loss: 3.2642 | Val  Acc: 0.3043
Average Valid Accuracy: 0.7703
 Best site-amazon                    | Epoch:4 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:4 | Val Acc: 0.7917
 Best site-amazon                    | Epoch:4 | Val Acc: 0.7097
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9024
 Best site-amazon                    | Epoch:4 | Val Acc: 0.8491
 Best site-amazon                    | Epoch:4 | Val Acc: 0.8824
 Best site-amazon                    | Epoch:4 | Val Acc: 0.8523
 Best site-amazon                    | Epoch:4 | Val Acc: 0.7895
 Best site-amazon                    | Epoch:4 | Val Acc: 0.7838
 Best site-amazon                    | Epoch:4 | Val Acc: 0.8220
 Best site-webcam                    | Epoch:4 | Val Acc: 0.6875
 Best site-webcam                    | Epoch:4 | Val Acc: 0.7500
 Best site-webcam                    | Epoch:4 | Val Acc: 0.7838
 Best site-webcam                    | Epoch:4 | Val Acc: 0.7818
 Best site-webcam                    | Epoch:4 | Val Acc: 0.7805
 Best site-dslr                      | Epoch:4 | Val Acc: 0.6364
 Best site-dslr                      | Epoch:4 | Val Acc: 0.7576
 Best site-synthetic                 | Epoch:4 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 5 ============
 Site-amazon                        | Train Loss: 2.8660 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 2.8100 | Train Acc: 0.8919
 Site-amazon                        | Train Loss: 2.8244 | Train Acc: 0.8723
 Site-amazon                        | Train Loss: 2.8373 | Train Acc: 0.8361
 Site-amazon                        | Train Loss: 2.8452 | Train Acc: 0.8228
 Site-amazon                        | Train Loss: 2.8321 | Train Acc: 0.8835
 Site-amazon                        | Train Loss: 2.8891 | Train Acc: 0.8722
 Site-amazon                        | Train Loss: 2.8422 | Train Acc: 0.8837
 Site-amazon                        | Train Loss: 2.8372 | Train Acc: 0.8694
 Site-amazon                        | Train Loss: 2.8515 | Train Acc: 0.8432
 Site-webcam                        | Train Loss: 2.8708 | Train Acc: 0.8333
 Site-webcam                        | Train Loss: 2.9194 | Train Acc: 0.7568
 Site-webcam                        | Train Loss: 2.8842 | Train Acc: 0.8545
 Site-webcam                        | Train Loss: 2.9329 | Train Acc: 0.7831
 Site-webcam                        | Train Loss: 2.9091 | Train Acc: 0.7984
 Site-dslr                          | Train Loss: 2.9629 | Train Acc: 0.8000
 Site-dslr                          | Train Loss: 2.9115 | Train Acc: 0.8300
 Site-synthetic                     | Train Loss: 3.1968 | Train Acc: 0.3768
Average Train Accuracy: 0.8147
 Site-amazon                        | Val  Loss: 2.7636 | Val  Acc: 0.9474
 Site-amazon                        | Val  Loss: 2.8192 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 2.8783 | Val  Acc: 0.7742
 Site-amazon                        | Val  Loss: 2.9121 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 2.8726 | Val  Acc: 0.8679
 Site-amazon                        | Val  Loss: 2.8173 | Val  Acc: 0.8824
 Site-amazon                        | Val  Loss: 2.8185 | Val  Acc: 0.8864
 Site-amazon                        | Val  Loss: 2.8661 | Val  Acc: 0.8158
 Site-amazon                        | Val  Loss: 2.8293 | Val  Acc: 0.8851
 Site-amazon                        | Val  Loss: 2.8408 | Val  Acc: 0.8534
 Site-webcam                        | Val  Loss: 2.9340 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 2.8859 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 2.8750 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 2.9150 | Val  Acc: 0.7273
 Site-webcam                        | Val  Loss: 2.9020 | Val  Acc: 0.7927
 Site-dslr                          | Val  Loss: 2.9277 | Val  Acc: 0.7879
 Site-dslr                          | Val  Loss: 2.9006 | Val  Acc: 0.7879
 Site-synthetic                     | Val  Loss: 3.2067 | Val  Acc: 0.3696
Average Valid Accuracy: 0.8072
 Best site-amazon                    | Epoch:5 | Val Acc: 0.9474
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8333
 Best site-amazon                    | Epoch:5 | Val Acc: 0.7742
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8293
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8679
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8824
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8864
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8158
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8851
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8534
 Best site-webcam                    | Epoch:5 | Val Acc: 0.7500
 Best site-webcam                    | Epoch:5 | Val Acc: 0.8750
 Best site-webcam                    | Epoch:5 | Val Acc: 0.8649
 Best site-webcam                    | Epoch:5 | Val Acc: 0.7273
 Best site-webcam                    | Epoch:5 | Val Acc: 0.7927
 Best site-dslr                      | Epoch:5 | Val Acc: 0.7879
 Best site-dslr                      | Epoch:5 | Val Acc: 0.7879
 Best site-synthetic                 | Epoch:5 | Val Acc: 0.3696
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 6 ============
 Site-amazon                        | Train Loss: 2.7635 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 2.7190 | Train Acc: 0.8919
 Site-amazon                        | Train Loss: 2.7301 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 2.7439 | Train Acc: 0.8689
 Site-amazon                        | Train Loss: 2.7220 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 2.7198 | Train Acc: 0.9223
 Site-amazon                        | Train Loss: 2.7328 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 2.7598 | Train Acc: 0.8953
 Site-amazon                        | Train Loss: 2.7433 | Train Acc: 0.8829
 Site-amazon                        | Train Loss: 2.7507 | Train Acc: 0.8920
 Site-webcam                        | Train Loss: 2.8162 | Train Acc: 0.7500
 Site-webcam                        | Train Loss: 2.8337 | Train Acc: 0.7838
 Site-webcam                        | Train Loss: 2.8095 | Train Acc: 0.8182
 Site-webcam                        | Train Loss: 2.8280 | Train Acc: 0.8193
 Site-webcam                        | Train Loss: 2.8442 | Train Acc: 0.8306
 Site-dslr                          | Train Loss: 2.8893 | Train Acc: 0.7800
 Site-dslr                          | Train Loss: 2.8141 | Train Acc: 0.8100
 Site-synthetic                     | Train Loss: 3.0993 | Train Acc: 0.4493
Average Train Accuracy: 0.8323
 Site-amazon                        | Val  Loss: 2.6424 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 2.7045 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 2.8184 | Val  Acc: 0.7419
 Site-amazon                        | Val  Loss: 2.8197 | Val  Acc: 0.7805
 Site-amazon                        | Val  Loss: 2.7459 | Val  Acc: 0.9057
 Site-amazon                        | Val  Loss: 2.6775 | Val  Acc: 0.8971
 Site-amazon                        | Val  Loss: 2.7391 | Val  Acc: 0.8977
 Site-amazon                        | Val  Loss: 2.7568 | Val  Acc: 0.8421
 Site-amazon                        | Val  Loss: 2.7289 | Val  Acc: 0.8649
 Site-amazon                        | Val  Loss: 2.7352 | Val  Acc: 0.9110
 Site-webcam                        | Val  Loss: 2.7814 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 2.8187 | Val  Acc: 0.8333
 Site-webcam                        | Val  Loss: 2.7935 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 2.8375 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 2.8114 | Val  Acc: 0.8293
 Site-dslr                          | Val  Loss: 2.8614 | Val  Acc: 0.7576
 Site-dslr                          | Val  Loss: 2.7979 | Val  Acc: 0.8030
 Site-synthetic                     | Val  Loss: 3.1833 | Val  Acc: 0.3478
Average Valid Accuracy: 0.8239
 Best site-amazon                    | Epoch:6 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:6 | Val Acc: 0.8333
 Best site-amazon                    | Epoch:6 | Val Acc: 0.7419
 Best site-amazon                    | Epoch:6 | Val Acc: 0.7805
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9057
 Best site-amazon                    | Epoch:6 | Val Acc: 0.8971
 Best site-amazon                    | Epoch:6 | Val Acc: 0.8977
 Best site-amazon                    | Epoch:6 | Val Acc: 0.8421
 Best site-amazon                    | Epoch:6 | Val Acc: 0.8649
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9110
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8750
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8333
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8182
 Best site-webcam                    | Epoch:6 | Val Acc: 0.8293
 Best site-dslr                      | Epoch:6 | Val Acc: 0.7576
 Best site-dslr                      | Epoch:6 | Val Acc: 0.8030
 Best site-synthetic                 | Epoch:6 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 7 ============
 Site-amazon                        | Train Loss: 2.7085 | Train Acc: 0.7857
 Site-amazon                        | Train Loss: 2.6202 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 2.6641 | Train Acc: 0.8511
 Site-amazon                        | Train Loss: 2.6570 | Train Acc: 0.8525
 Site-amazon                        | Train Loss: 2.6711 | Train Acc: 0.8861
 Site-amazon                        | Train Loss: 2.6155 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 2.6496 | Train Acc: 0.8947
 Site-amazon                        | Train Loss: 2.6607 | Train Acc: 0.9128
 Site-amazon                        | Train Loss: 2.6498 | Train Acc: 0.8964
 Site-amazon                        | Train Loss: 2.6622 | Train Acc: 0.8780
 Site-webcam                        | Train Loss: 2.7158 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 2.7656 | Train Acc: 0.7838
 Site-webcam                        | Train Loss: 2.7190 | Train Acc: 0.8364
 Site-webcam                        | Train Loss: 2.7205 | Train Acc: 0.8313
 Site-webcam                        | Train Loss: 2.7567 | Train Acc: 0.7903
 Site-dslr                          | Train Loss: 2.8234 | Train Acc: 0.8400
 Site-dslr                          | Train Loss: 2.7362 | Train Acc: 0.8300
 Site-synthetic                     | Train Loss: 3.0044 | Train Acc: 0.4348
Average Train Accuracy: 0.8385
 Site-amazon                        | Val  Loss: 2.5725 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 2.5787 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 2.7033 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 2.7113 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 2.6535 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 2.6132 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 2.6318 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 2.6735 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 2.6450 | Val  Acc: 0.8649
 Site-amazon                        | Val  Loss: 2.6504 | Val  Acc: 0.9005
 Site-webcam                        | Val  Loss: 2.8129 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 2.7044 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 2.7578 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 2.7355 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 2.7242 | Val  Acc: 0.8659
 Site-dslr                          | Val  Loss: 2.7789 | Val  Acc: 0.7879
 Site-dslr                          | Val  Loss: 2.7238 | Val  Acc: 0.8636
 Site-synthetic                     | Val  Loss: 3.1450 | Val  Acc: 0.3261
Average Valid Accuracy: 0.8471
 Best site-amazon                    | Epoch:7 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:7 | Val Acc: 0.8333
 Best site-amazon                    | Epoch:7 | Val Acc: 0.8065
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9024
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9245
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9412
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9318
 Best site-amazon                    | Epoch:7 | Val Acc: 0.8333
 Best site-amazon                    | Epoch:7 | Val Acc: 0.8649
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9005
 Best site-webcam                    | Epoch:7 | Val Acc: 0.8125
 Best site-webcam                    | Epoch:7 | Val Acc: 0.9167
 Best site-webcam                    | Epoch:7 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:7 | Val Acc: 0.8182
 Best site-webcam                    | Epoch:7 | Val Acc: 0.8659
 Best site-dslr                      | Epoch:7 | Val Acc: 0.7879
 Best site-dslr                      | Epoch:7 | Val Acc: 0.8636
 Best site-synthetic                 | Epoch:7 | Val Acc: 0.3261
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 8 ============
 Site-amazon                        | Train Loss: 2.5847 | Train Acc: 0.8929
 Site-amazon                        | Train Loss: 2.5375 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 2.5508 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 2.5775 | Train Acc: 0.8361
 Site-amazon                        | Train Loss: 2.6033 | Train Acc: 0.9241
 Site-amazon                        | Train Loss: 2.5167 | Train Acc: 0.9320
 Site-amazon                        | Train Loss: 2.5718 | Train Acc: 0.8496
 Site-amazon                        | Train Loss: 2.5635 | Train Acc: 0.9128
 Site-amazon                        | Train Loss: 2.5680 | Train Acc: 0.8829
 Site-amazon                        | Train Loss: 2.5628 | Train Acc: 0.8990
 Site-webcam                        | Train Loss: 2.6667 | Train Acc: 0.7917
 Site-webcam                        | Train Loss: 2.6842 | Train Acc: 0.7838
 Site-webcam                        | Train Loss: 2.6395 | Train Acc: 0.8545
 Site-webcam                        | Train Loss: 2.6851 | Train Acc: 0.8795
 Site-webcam                        | Train Loss: 2.6688 | Train Acc: 0.8468
 Site-dslr                          | Train Loss: 2.7416 | Train Acc: 0.8400
 Site-dslr                          | Train Loss: 2.6530 | Train Acc: 0.8400
 Site-synthetic                     | Train Loss: 3.0358 | Train Acc: 0.4348
Average Train Accuracy: 0.8505
 Site-amazon                        | Val  Loss: 2.4531 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 2.5238 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 2.5903 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 2.6483 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 2.5631 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 2.4787 | Val  Acc: 0.9118
 Site-amazon                        | Val  Loss: 2.5370 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 2.5680 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 2.5237 | Val  Acc: 0.9122
 Site-amazon                        | Val  Loss: 2.5573 | Val  Acc: 0.9110
 Site-webcam                        | Val  Loss: 2.7302 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 2.6558 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 2.7101 | Val  Acc: 0.7838
 Site-webcam                        | Val  Loss: 2.6573 | Val  Acc: 0.8000
 Site-webcam                        | Val  Loss: 2.6205 | Val  Acc: 0.8537
 Site-dslr                          | Val  Loss: 2.6519 | Val  Acc: 0.9394
 Site-dslr                          | Val  Loss: 2.6152 | Val  Acc: 0.8788
 Site-synthetic                     | Val  Loss: 3.1012 | Val  Acc: 0.3913
Average Valid Accuracy: 0.8576
 Best site-amazon                    | Epoch:8 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9167
 Best site-amazon                    | Epoch:8 | Val Acc: 0.8387
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9024
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9434
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9118
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9545
 Best site-amazon                    | Epoch:8 | Val Acc: 0.8333
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9122
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9110
 Best site-webcam                    | Epoch:8 | Val Acc: 0.7500
 Best site-webcam                    | Epoch:8 | Val Acc: 0.9167
 Best site-webcam                    | Epoch:8 | Val Acc: 0.7838
 Best site-webcam                    | Epoch:8 | Val Acc: 0.8000
 Best site-webcam                    | Epoch:8 | Val Acc: 0.8537
 Best site-dslr                      | Epoch:8 | Val Acc: 0.9394
 Best site-dslr                      | Epoch:8 | Val Acc: 0.8788
 Best site-synthetic                 | Epoch:8 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 9 ============
 Site-amazon                        | Train Loss: 2.4965 | Train Acc: 0.8214
 Site-amazon                        | Train Loss: 2.4720 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 2.4146 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 2.4758 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 2.4997 | Train Acc: 0.8987
 Site-amazon                        | Train Loss: 2.4166 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 2.4739 | Train Acc: 0.8797
 Site-amazon                        | Train Loss: 2.4589 | Train Acc: 0.9186
 Site-amazon                        | Train Loss: 2.4501 | Train Acc: 0.9054
 Site-amazon                        | Train Loss: 2.4602 | Train Acc: 0.9268
 Site-webcam                        | Train Loss: 2.5661 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 2.5878 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 2.5402 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 2.5632 | Train Acc: 0.8554
 Site-webcam                        | Train Loss: 2.6024 | Train Acc: 0.8145
 Site-dslr                          | Train Loss: 2.6838 | Train Acc: 0.8200
 Site-dslr                          | Train Loss: 2.5717 | Train Acc: 0.8700
 Site-synthetic                     | Train Loss: 3.0301 | Train Acc: 0.4928
Average Train Accuracy: 0.8627
 Site-amazon                        | Val  Loss: 2.3458 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 2.3758 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 2.5032 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 2.5669 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 2.4855 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 2.4027 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 2.4355 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 2.4907 | Val  Acc: 0.8509
 Site-amazon                        | Val  Loss: 2.4310 | Val  Acc: 0.8986
 Site-amazon                        | Val  Loss: 2.4526 | Val  Acc: 0.9215
 Site-webcam                        | Val  Loss: 2.5574 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 2.5523 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 2.5783 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 2.6228 | Val  Acc: 0.8364
 Site-webcam                        | Val  Loss: 2.5572 | Val  Acc: 0.8659
 Site-dslr                          | Val  Loss: 2.5776 | Val  Acc: 0.8485
 Site-dslr                          | Val  Loss: 2.5667 | Val  Acc: 0.8030
 Site-synthetic                     | Val  Loss: 3.0550 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8546
============ Train epoch 10 ============
 Site-amazon                        | Train Loss: 2.4638 | Train Acc: 0.8929
 Site-amazon                        | Train Loss: 2.3420 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 2.3232 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 2.3929 | Train Acc: 0.8361
 Site-amazon                        | Train Loss: 2.4036 | Train Acc: 0.9114
 Site-amazon                        | Train Loss: 2.3331 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 2.4205 | Train Acc: 0.9248
 Site-amazon                        | Train Loss: 2.3802 | Train Acc: 0.9070
 Site-amazon                        | Train Loss: 2.3802 | Train Acc: 0.9054
 Site-amazon                        | Train Loss: 2.3821 | Train Acc: 0.9024
 Site-webcam                        | Train Loss: 2.4932 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 2.5350 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 2.4735 | Train Acc: 0.8727
 Site-webcam                        | Train Loss: 2.4623 | Train Acc: 0.8554
 Site-webcam                        | Train Loss: 2.5254 | Train Acc: 0.8065
 Site-dslr                          | Train Loss: 2.6104 | Train Acc: 0.8600
 Site-dslr                          | Train Loss: 2.4936 | Train Acc: 0.8700
 Site-synthetic                     | Train Loss: 2.9351 | Train Acc: 0.4928
Average Train Accuracy: 0.8687
 Site-amazon                        | Val  Loss: 2.2727 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 2.3101 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 2.4283 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 2.5133 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 2.3833 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 2.2940 | Val  Acc: 0.9265
 Site-amazon                        | Val  Loss: 2.3465 | Val  Acc: 0.9432
 Site-amazon                        | Val  Loss: 2.4020 | Val  Acc: 0.8421
 Site-amazon                        | Val  Loss: 2.3372 | Val  Acc: 0.8919
 Site-amazon                        | Val  Loss: 2.3649 | Val  Acc: 0.9529
 Site-webcam                        | Val  Loss: 2.4864 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 2.5049 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 2.4504 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 2.5262 | Val  Acc: 0.8545
 Site-webcam                        | Val  Loss: 2.4764 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 2.4903 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 2.4691 | Val  Acc: 0.8788
 Site-synthetic                     | Val  Loss: 3.0137 | Val  Acc: 0.3696
Average Valid Accuracy: 0.8613
 Best site-amazon                    | Epoch:10 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8333
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8065
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8293
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9245
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9265
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9432
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8421
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8919
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9529
 Best site-webcam                    | Epoch:10 | Val Acc: 0.8750
 Best site-webcam                    | Epoch:10 | Val Acc: 0.8750
 Best site-webcam                    | Epoch:10 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:10 | Val Acc: 0.8545
 Best site-webcam                    | Epoch:10 | Val Acc: 0.9024
 Best site-dslr                      | Epoch:10 | Val Acc: 0.8788
 Best site-dslr                      | Epoch:10 | Val Acc: 0.8788
 Best site-synthetic                 | Epoch:10 | Val Acc: 0.3696
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 11 ============
 Site-amazon                        | Train Loss: 2.3016 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 2.2512 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 2.2649 | Train Acc: 0.9149
 Site-amazon                        | Train Loss: 2.3008 | Train Acc: 0.8689
 Site-amazon                        | Train Loss: 2.2726 | Train Acc: 0.8987
 Site-amazon                        | Train Loss: 2.2451 | Train Acc: 0.9320
 Site-amazon                        | Train Loss: 2.2863 | Train Acc: 0.9023
 Site-amazon                        | Train Loss: 2.3059 | Train Acc: 0.8837
 Site-amazon                        | Train Loss: 2.2785 | Train Acc: 0.9054
 Site-amazon                        | Train Loss: 2.2960 | Train Acc: 0.9059
 Site-webcam                        | Train Loss: 2.3867 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 2.4854 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 2.3819 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 2.4416 | Train Acc: 0.8313
 Site-webcam                        | Train Loss: 2.4221 | Train Acc: 0.8790
 Site-dslr                          | Train Loss: 2.5314 | Train Acc: 0.9000
 Site-dslr                          | Train Loss: 2.4285 | Train Acc: 0.8800
 Site-synthetic                     | Train Loss: 2.9446 | Train Acc: 0.4058
Average Train Accuracy: 0.8677
 Site-amazon                        | Val  Loss: 2.1825 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 2.2006 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 2.3586 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 2.3996 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 2.3012 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 2.2103 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 2.2674 | Val  Acc: 0.9205
 Site-amazon                        | Val  Loss: 2.3036 | Val  Acc: 0.8772
 Site-amazon                        | Val  Loss: 2.2463 | Val  Acc: 0.8986
 Site-amazon                        | Val  Loss: 2.2645 | Val  Acc: 0.9319
 Site-webcam                        | Val  Loss: 2.4585 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 2.4485 | Val  Acc: 0.8333
 Site-webcam                        | Val  Loss: 2.3697 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 2.4178 | Val  Acc: 0.7818
 Site-webcam                        | Val  Loss: 2.4199 | Val  Acc: 0.8049
 Site-dslr                          | Val  Loss: 2.4072 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 2.3945 | Val  Acc: 0.8485
 Site-synthetic                     | Val  Loss: 2.9942 | Val  Acc: 0.3913
Average Valid Accuracy: 0.8518
============ Train epoch 12 ============
 Site-amazon                        | Train Loss: 2.2711 | Train Acc: 0.8929
 Site-amazon                        | Train Loss: 2.1046 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 2.1579 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 2.2162 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 2.1618 | Train Acc: 0.8987
 Site-amazon                        | Train Loss: 2.1313 | Train Acc: 0.9223
 Site-amazon                        | Train Loss: 2.1691 | Train Acc: 0.8797
 Site-amazon                        | Train Loss: 2.2036 | Train Acc: 0.9012
 Site-amazon                        | Train Loss: 2.2038 | Train Acc: 0.9279
 Site-amazon                        | Train Loss: 2.2035 | Train Acc: 0.9303
 Site-webcam                        | Train Loss: 2.3081 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 2.3713 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 2.3117 | Train Acc: 0.8909
 Site-webcam                        | Train Loss: 2.3027 | Train Acc: 0.8916
 Site-webcam                        | Train Loss: 2.3713 | Train Acc: 0.8710
 Site-dslr                          | Train Loss: 2.4634 | Train Acc: 0.8400
 Site-dslr                          | Train Loss: 2.3104 | Train Acc: 0.8700
 Site-synthetic                     | Train Loss: 2.8252 | Train Acc: 0.5072
Average Train Accuracy: 0.8764
 Site-amazon                        | Val  Loss: 2.0840 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 2.1020 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 2.2543 | Val  Acc: 0.7419
 Site-amazon                        | Val  Loss: 2.2996 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 2.1971 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 2.1010 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 2.1767 | Val  Acc: 0.9205
 Site-amazon                        | Val  Loss: 2.2054 | Val  Acc: 0.8421
 Site-amazon                        | Val  Loss: 2.1976 | Val  Acc: 0.8784
 Site-amazon                        | Val  Loss: 2.1808 | Val  Acc: 0.9476
 Site-webcam                        | Val  Loss: 2.3776 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 2.3402 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 2.3255 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 2.3560 | Val  Acc: 0.8727
 Site-webcam                        | Val  Loss: 2.2773 | Val  Acc: 0.8659
 Site-dslr                          | Val  Loss: 2.3615 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 2.2886 | Val  Acc: 0.8788
 Site-synthetic                     | Val  Loss: 2.8943 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8632
 Best site-amazon                    | Epoch:12 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:12 | Val Acc: 0.8750
 Best site-amazon                    | Epoch:12 | Val Acc: 0.7419
 Best site-amazon                    | Epoch:12 | Val Acc: 0.8780
 Best site-amazon                    | Epoch:12 | Val Acc: 0.9245
 Best site-amazon                    | Epoch:12 | Val Acc: 0.9853
 Best site-amazon                    | Epoch:12 | Val Acc: 0.9205
 Best site-amazon                    | Epoch:12 | Val Acc: 0.8421
 Best site-amazon                    | Epoch:12 | Val Acc: 0.8784
 Best site-amazon                    | Epoch:12 | Val Acc: 0.9476
 Best site-webcam                    | Epoch:12 | Val Acc: 0.7500
 Best site-webcam                    | Epoch:12 | Val Acc: 0.9167
 Best site-webcam                    | Epoch:12 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:12 | Val Acc: 0.8727
 Best site-webcam                    | Epoch:12 | Val Acc: 0.8659
 Best site-dslr                      | Epoch:12 | Val Acc: 0.8788
 Best site-dslr                      | Epoch:12 | Val Acc: 0.8788
 Best site-synthetic                 | Epoch:12 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 13 ============
 Site-amazon                        | Train Loss: 2.1469 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 2.0590 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 2.0478 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 2.1386 | Train Acc: 0.8852
 Site-amazon                        | Train Loss: 2.0923 | Train Acc: 0.9494
 Site-amazon                        | Train Loss: 2.0412 | Train Acc: 0.9320
 Site-amazon                        | Train Loss: 2.0381 | Train Acc: 0.9323
 Site-amazon                        | Train Loss: 2.1405 | Train Acc: 0.8895
 Site-amazon                        | Train Loss: 2.1109 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 2.1292 | Train Acc: 0.9303
 Site-webcam                        | Train Loss: 2.2581 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 2.3274 | Train Acc: 0.7568
 Site-webcam                        | Train Loss: 2.1877 | Train Acc: 0.8727
 Site-webcam                        | Train Loss: 2.2649 | Train Acc: 0.8675
 Site-webcam                        | Train Loss: 2.2946 | Train Acc: 0.8468
 Site-dslr                          | Train Loss: 2.4016 | Train Acc: 0.8600
 Site-dslr                          | Train Loss: 2.2665 | Train Acc: 0.8700
 Site-synthetic                     | Train Loss: 2.8919 | Train Acc: 0.4783
Average Train Accuracy: 0.8770
 Site-amazon                        | Val  Loss: 1.9884 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 2.0721 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 2.1544 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 2.2474 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 2.1296 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 1.9881 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 2.0920 | Val  Acc: 0.9659
 Site-amazon                        | Val  Loss: 2.1471 | Val  Acc: 0.8509
 Site-amazon                        | Val  Loss: 2.0947 | Val  Acc: 0.8919
 Site-amazon                        | Val  Loss: 2.1028 | Val  Acc: 0.9162
 Site-webcam                        | Val  Loss: 2.3090 | Val  Acc: 0.6250
 Site-webcam                        | Val  Loss: 2.2818 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 2.2040 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 2.2918 | Val  Acc: 0.8182
 Site-webcam                        | Val  Loss: 2.1898 | Val  Acc: 0.9146
 Site-dslr                          | Val  Loss: 2.2593 | Val  Acc: 0.8485
 Site-dslr                          | Val  Loss: 2.2437 | Val  Acc: 0.8636
 Site-synthetic                     | Val  Loss: 2.9168 | Val  Acc: 0.3478
Average Valid Accuracy: 0.8490
============ Train epoch 14 ============
 Site-amazon                        | Train Loss: 2.0733 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 2.0071 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 1.9761 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 2.0559 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 2.0984 | Train Acc: 0.8987
 Site-amazon                        | Train Loss: 1.9757 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 2.0613 | Train Acc: 0.8947
 Site-amazon                        | Train Loss: 2.0342 | Train Acc: 0.8953
 Site-amazon                        | Train Loss: 2.0396 | Train Acc: 0.9144
 Site-amazon                        | Train Loss: 2.0205 | Train Acc: 0.9164
 Site-webcam                        | Train Loss: 2.1740 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 2.2482 | Train Acc: 0.7838
 Site-webcam                        | Train Loss: 2.1541 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 2.1843 | Train Acc: 0.8434
 Site-webcam                        | Train Loss: 2.2188 | Train Acc: 0.8468
 Site-dslr                          | Train Loss: 2.3181 | Train Acc: 0.9000
 Site-dslr                          | Train Loss: 2.1999 | Train Acc: 0.8500
 Site-synthetic                     | Train Loss: 2.8258 | Train Acc: 0.4783
Average Train Accuracy: 0.8708
 Site-amazon                        | Val  Loss: 1.8919 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.9298 | Val  Acc: 0.9583
 Site-amazon                        | Val  Loss: 2.1279 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 2.1512 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 2.0126 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 1.9004 | Val  Acc: 0.9559
 Site-amazon                        | Val  Loss: 1.9799 | Val  Acc: 0.9659
 Site-amazon                        | Val  Loss: 2.0602 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 1.9733 | Val  Acc: 0.9122
 Site-amazon                        | Val  Loss: 2.0119 | Val  Acc: 0.9476
 Site-webcam                        | Val  Loss: 2.3042 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 2.1568 | Val  Acc: 0.8333
 Site-webcam                        | Val  Loss: 2.2457 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 2.1954 | Val  Acc: 0.8364
 Site-webcam                        | Val  Loss: 2.1491 | Val  Acc: 0.8537
 Site-dslr                          | Val  Loss: 2.1981 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 2.1396 | Val  Acc: 0.8788
 Site-synthetic                     | Val  Loss: 2.8606 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8634
 Best site-amazon                    | Epoch:14 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9583
 Best site-amazon                    | Epoch:14 | Val Acc: 0.8065
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9024
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9245
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9559
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9659
 Best site-amazon                    | Epoch:14 | Val Acc: 0.8333
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9122
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9476
 Best site-webcam                    | Epoch:14 | Val Acc: 0.7500
 Best site-webcam                    | Epoch:14 | Val Acc: 0.8333
 Best site-webcam                    | Epoch:14 | Val Acc: 0.8378
 Best site-webcam                    | Epoch:14 | Val Acc: 0.8364
 Best site-webcam                    | Epoch:14 | Val Acc: 0.8537
 Best site-dslr                      | Epoch:14 | Val Acc: 0.9091
 Best site-dslr                      | Epoch:14 | Val Acc: 0.8788
 Best site-synthetic                 | Epoch:14 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 15 ============
 Site-amazon                        | Train Loss: 1.9702 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 1.9287 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 1.8942 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 1.9836 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 1.8525 | Train Acc: 0.9114
 Site-amazon                        | Train Loss: 1.8543 | Train Acc: 0.9126
 Site-amazon                        | Train Loss: 2.0272 | Train Acc: 0.9173
 Site-amazon                        | Train Loss: 1.9697 | Train Acc: 0.8953
 Site-amazon                        | Train Loss: 1.9444 | Train Acc: 0.9144
 Site-amazon                        | Train Loss: 1.9323 | Train Acc: 0.9233
 Site-webcam                        | Train Loss: 2.1249 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 2.1843 | Train Acc: 0.7838
 Site-webcam                        | Train Loss: 2.0821 | Train Acc: 0.8727
 Site-webcam                        | Train Loss: 2.0862 | Train Acc: 0.8675
 Site-webcam                        | Train Loss: 2.1483 | Train Acc: 0.8468
 Site-dslr                          | Train Loss: 2.2653 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 2.0619 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 2.7896 | Train Acc: 0.5072
Average Train Accuracy: 0.8757
 Site-amazon                        | Val  Loss: 1.8095 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.8457 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 2.0375 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 2.0133 | Val  Acc: 0.9268
 Site-amazon                        | Val  Loss: 1.9426 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 1.8522 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 1.9063 | Val  Acc: 0.9659
 Site-amazon                        | Val  Loss: 1.9753 | Val  Acc: 0.8772
 Site-amazon                        | Val  Loss: 1.9030 | Val  Acc: 0.9189
 Site-amazon                        | Val  Loss: 1.9109 | Val  Acc: 0.9215
 Site-webcam                        | Val  Loss: 2.1635 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 2.0217 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 2.0491 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 2.0944 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 2.0456 | Val  Acc: 0.9146
 Site-dslr                          | Val  Loss: 2.1460 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 2.0869 | Val  Acc: 0.8788
 Site-synthetic                     | Val  Loss: 2.8202 | Val  Acc: 0.3913
Average Valid Accuracy: 0.8888
 Best site-amazon                    | Epoch:15 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9167
 Best site-amazon                    | Epoch:15 | Val Acc: 0.8387
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9268
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9245
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9853
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9659
 Best site-amazon                    | Epoch:15 | Val Acc: 0.8772
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9189
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9215
 Best site-webcam                    | Epoch:15 | Val Acc: 0.8750
 Best site-webcam                    | Epoch:15 | Val Acc: 0.9167
 Best site-webcam                    | Epoch:15 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:15 | Val Acc: 0.8909
 Best site-webcam                    | Epoch:15 | Val Acc: 0.9146
 Best site-dslr                      | Epoch:15 | Val Acc: 0.9091
 Best site-dslr                      | Epoch:15 | Val Acc: 0.8788
 Best site-synthetic                 | Epoch:15 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 16 ============
 Site-amazon                        | Train Loss: 1.9245 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 1.7997 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 1.7599 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 1.8930 | Train Acc: 0.8525
 Site-amazon                        | Train Loss: 1.7856 | Train Acc: 0.9241
 Site-amazon                        | Train Loss: 1.7956 | Train Acc: 0.9223
 Site-amazon                        | Train Loss: 1.8948 | Train Acc: 0.9474
 Site-amazon                        | Train Loss: 1.8785 | Train Acc: 0.9186
 Site-amazon                        | Train Loss: 1.8611 | Train Acc: 0.9234
 Site-amazon                        | Train Loss: 1.8640 | Train Acc: 0.9338
 Site-webcam                        | Train Loss: 2.0562 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 2.1027 | Train Acc: 0.7568
 Site-webcam                        | Train Loss: 1.9942 | Train Acc: 0.8909
 Site-webcam                        | Train Loss: 2.0155 | Train Acc: 0.8675
 Site-webcam                        | Train Loss: 2.0681 | Train Acc: 0.8629
 Site-dslr                          | Train Loss: 2.2381 | Train Acc: 0.8400
 Site-dslr                          | Train Loss: 2.0337 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 2.7550 | Train Acc: 0.5072
Average Train Accuracy: 0.8791
 Site-amazon                        | Val  Loss: 1.7085 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.7898 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 1.9824 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 2.0217 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 1.8723 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 1.7617 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 1.8322 | Val  Acc: 0.9432
 Site-amazon                        | Val  Loss: 1.9094 | Val  Acc: 0.8684
 Site-amazon                        | Val  Loss: 1.8745 | Val  Acc: 0.8986
 Site-amazon                        | Val  Loss: 1.8296 | Val  Acc: 0.9372
 Site-webcam                        | Val  Loss: 2.0104 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 2.0183 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.9825 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 2.0040 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 1.9877 | Val  Acc: 0.8902
 Site-dslr                          | Val  Loss: 2.0348 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 2.0117 | Val  Acc: 0.9091
 Site-synthetic                     | Val  Loss: 2.8236 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8756
============ Train epoch 17 ============
 Site-amazon                        | Train Loss: 1.9214 | Train Acc: 0.8214
 Site-amazon                        | Train Loss: 1.7164 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 1.7008 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 1.7738 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 1.7966 | Train Acc: 0.8987
 Site-amazon                        | Train Loss: 1.7345 | Train Acc: 0.9612
 Site-amazon                        | Train Loss: 1.8899 | Train Acc: 0.8872
 Site-amazon                        | Train Loss: 1.7862 | Train Acc: 0.9186
 Site-amazon                        | Train Loss: 1.7870 | Train Acc: 0.9054
 Site-amazon                        | Train Loss: 1.7644 | Train Acc: 0.9303
 Site-webcam                        | Train Loss: 1.9008 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 2.0508 | Train Acc: 0.7838
 Site-webcam                        | Train Loss: 1.9288 | Train Acc: 0.8727
 Site-webcam                        | Train Loss: 1.8933 | Train Acc: 0.8916
 Site-webcam                        | Train Loss: 2.0113 | Train Acc: 0.8710
 Site-dslr                          | Train Loss: 2.1492 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 1.9740 | Train Acc: 0.8800
 Site-synthetic                     | Train Loss: 2.4826 | Train Acc: 0.5652
Average Train Accuracy: 0.8796
 Site-amazon                        | Val  Loss: 1.6331 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.7212 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 1.8331 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 1.9699 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 1.8199 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 1.7207 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 1.7346 | Val  Acc: 0.9432
 Site-amazon                        | Val  Loss: 1.8172 | Val  Acc: 0.8772
 Site-amazon                        | Val  Loss: 1.7385 | Val  Acc: 0.9324
 Site-amazon                        | Val  Loss: 1.7744 | Val  Acc: 0.9267
 Site-webcam                        | Val  Loss: 2.0205 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.9664 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.9337 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.9784 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 1.9036 | Val  Acc: 0.8780
 Site-dslr                          | Val  Loss: 1.9176 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 1.8466 | Val  Acc: 0.8485
 Site-synthetic                     | Val  Loss: 2.7483 | Val  Acc: 0.4130
Average Valid Accuracy: 0.8747
============ Train epoch 18 ============
 Site-amazon                        | Train Loss: 1.7765 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 1.6576 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 1.6712 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 1.7532 | Train Acc: 0.8852
 Site-amazon                        | Train Loss: 1.6975 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 1.6656 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 1.6093 | Train Acc: 0.9248
 Site-amazon                        | Train Loss: 1.7127 | Train Acc: 0.9244
 Site-amazon                        | Train Loss: 1.7316 | Train Acc: 0.9234
 Site-amazon                        | Train Loss: 1.7051 | Train Acc: 0.9268
 Site-webcam                        | Train Loss: 1.9500 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.9256 | Train Acc: 0.8649
 Site-webcam                        | Train Loss: 1.8515 | Train Acc: 0.8727
 Site-webcam                        | Train Loss: 1.8493 | Train Acc: 0.9277
 Site-webcam                        | Train Loss: 1.8967 | Train Acc: 0.9113
 Site-dslr                          | Train Loss: 2.0413 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 1.8955 | Train Acc: 0.8800
 Site-synthetic                     | Train Loss: 2.6105 | Train Acc: 0.4928
Average Train Accuracy: 0.8882
 Site-amazon                        | Val  Loss: 1.4983 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.6449 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 1.8654 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.9083 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 1.6779 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 1.6054 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.6764 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.7816 | Val  Acc: 0.8772
 Site-amazon                        | Val  Loss: 1.6619 | Val  Acc: 0.9257
 Site-amazon                        | Val  Loss: 1.6973 | Val  Acc: 0.9476
 Site-webcam                        | Val  Loss: 2.0278 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 1.9558 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.9003 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.9358 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 1.8634 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 1.9981 | Val  Acc: 0.8485
 Site-dslr                          | Val  Loss: 1.7927 | Val  Acc: 0.8636
 Site-synthetic                     | Val  Loss: 2.7245 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8712
============ Train epoch 19 ============
 Site-amazon                        | Train Loss: 1.7956 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.5861 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 1.5702 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 1.6410 | Train Acc: 0.8689
 Site-amazon                        | Train Loss: 1.6386 | Train Acc: 0.9114
 Site-amazon                        | Train Loss: 1.5770 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 1.7184 | Train Acc: 0.9023
 Site-amazon                        | Train Loss: 1.6401 | Train Acc: 0.9244
 Site-amazon                        | Train Loss: 1.6483 | Train Acc: 0.9009
 Site-amazon                        | Train Loss: 1.6436 | Train Acc: 0.9443
 Site-webcam                        | Train Loss: 1.9191 | Train Acc: 0.8333
 Site-webcam                        | Train Loss: 1.9459 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 1.7704 | Train Acc: 0.8909
 Site-webcam                        | Train Loss: 1.8045 | Train Acc: 0.9036
 Site-webcam                        | Train Loss: 1.8696 | Train Acc: 0.9032
 Site-dslr                          | Train Loss: 2.0265 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 1.7489 | Train Acc: 0.9100
 Site-synthetic                     | Train Loss: 2.2522 | Train Acc: 0.5797
Average Train Accuracy: 0.8850
 Site-amazon                        | Val  Loss: 1.4305 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.5465 | Val  Acc: 0.9583
 Site-amazon                        | Val  Loss: 1.6809 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.8723 | Val  Acc: 0.8049
 Site-amazon                        | Val  Loss: 1.6602 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 1.4829 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 1.6007 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 1.6732 | Val  Acc: 0.8772
 Site-amazon                        | Val  Loss: 1.5655 | Val  Acc: 0.9459
 Site-amazon                        | Val  Loss: 1.6148 | Val  Acc: 0.9372
 Site-webcam                        | Val  Loss: 1.8504 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 1.8816 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.8631 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 1.8666 | Val  Acc: 0.8727
 Site-webcam                        | Val  Loss: 1.7847 | Val  Acc: 0.8780
 Site-dslr                          | Val  Loss: 1.8953 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 1.7519 | Val  Acc: 0.8636
 Site-synthetic                     | Val  Loss: 2.7375 | Val  Acc: 0.3913
Average Valid Accuracy: 0.8724
============ Train epoch 20 ============
 Site-amazon                        | Train Loss: 1.6716 | Train Acc: 0.8929
 Site-amazon                        | Train Loss: 1.5217 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 1.5274 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 1.5441 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 1.4918 | Train Acc: 0.9620
 Site-amazon                        | Train Loss: 1.4359 | Train Acc: 0.9320
 Site-amazon                        | Train Loss: 1.5648 | Train Acc: 0.9323
 Site-amazon                        | Train Loss: 1.5727 | Train Acc: 0.9186
 Site-amazon                        | Train Loss: 1.5459 | Train Acc: 0.9414
 Site-amazon                        | Train Loss: 1.5812 | Train Acc: 0.9164
 Site-webcam                        | Train Loss: 1.7347 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 1.8481 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 1.7628 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 1.6384 | Train Acc: 0.9277
 Site-webcam                        | Train Loss: 1.8157 | Train Acc: 0.8952
 Site-dslr                          | Train Loss: 1.9645 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 1.7562 | Train Acc: 0.9100
 Site-synthetic                     | Train Loss: 2.6484 | Train Acc: 0.4928
Average Train Accuracy: 0.8928
 Site-amazon                        | Val  Loss: 1.3856 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.4382 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 1.7034 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.7952 | Val  Acc: 0.8049
 Site-amazon                        | Val  Loss: 1.5760 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 1.5319 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 1.4927 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 1.6446 | Val  Acc: 0.8772
 Site-amazon                        | Val  Loss: 1.5564 | Val  Acc: 0.9189
 Site-amazon                        | Val  Loss: 1.5253 | Val  Acc: 0.9372
 Site-webcam                        | Val  Loss: 1.9009 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 1.8146 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.6695 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.7548 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 1.7170 | Val  Acc: 0.9268
 Site-dslr                          | Val  Loss: 1.7666 | Val  Acc: 0.8485
 Site-dslr                          | Val  Loss: 1.6719 | Val  Acc: 0.9091
 Site-synthetic                     | Val  Loss: 2.6746 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8773
============ Train epoch 21 ============
 Site-amazon                        | Train Loss: 1.5360 | Train Acc: 0.8929
 Site-amazon                        | Train Loss: 1.4233 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 1.4073 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 1.4772 | Train Acc: 0.9344
 Site-amazon                        | Train Loss: 1.5841 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 1.4007 | Train Acc: 0.9223
 Site-amazon                        | Train Loss: 1.4713 | Train Acc: 0.9248
 Site-amazon                        | Train Loss: 1.4619 | Train Acc: 0.9360
 Site-amazon                        | Train Loss: 1.4985 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 1.5074 | Train Acc: 0.9338
 Site-webcam                        | Train Loss: 1.8191 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.8595 | Train Acc: 0.7568
 Site-webcam                        | Train Loss: 1.6717 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 1.6691 | Train Acc: 0.9036
 Site-webcam                        | Train Loss: 1.7736 | Train Acc: 0.8548
 Site-dslr                          | Train Loss: 1.9081 | Train Acc: 0.9000
 Site-dslr                          | Train Loss: 1.7449 | Train Acc: 0.8600
 Site-synthetic                     | Train Loss: 2.3816 | Train Acc: 0.4638
Average Train Accuracy: 0.8819
 Site-amazon                        | Val  Loss: 1.3162 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.2765 | Val  Acc: 0.9583
 Site-amazon                        | Val  Loss: 1.6006 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.6654 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 1.5476 | Val  Acc: 0.8868
 Site-amazon                        | Val  Loss: 1.4387 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.4609 | Val  Acc: 0.9659
 Site-amazon                        | Val  Loss: 1.5604 | Val  Acc: 0.8596
 Site-amazon                        | Val  Loss: 1.4645 | Val  Acc: 0.9392
 Site-amazon                        | Val  Loss: 1.4923 | Val  Acc: 0.9110
 Site-webcam                        | Val  Loss: 1.8376 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 1.6280 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 1.6840 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.6902 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 1.6939 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 1.7534 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 1.6696 | Val  Acc: 0.8788
 Site-synthetic                     | Val  Loss: 2.6290 | Val  Acc: 0.4783
Average Valid Accuracy: 0.8870
============ Train epoch 22 ============
 Site-amazon                        | Train Loss: 1.5190 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 1.3956 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 1.3681 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 1.4239 | Train Acc: 0.9344
 Site-amazon                        | Train Loss: 1.3046 | Train Acc: 0.9241
 Site-amazon                        | Train Loss: 1.3361 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 1.4383 | Train Acc: 0.9323
 Site-amazon                        | Train Loss: 1.4448 | Train Acc: 0.9244
 Site-amazon                        | Train Loss: 1.4433 | Train Acc: 0.9279
 Site-amazon                        | Train Loss: 1.4112 | Train Acc: 0.9477
 Site-webcam                        | Train Loss: 1.6424 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 1.7104 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 1.5776 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 1.6914 | Train Acc: 0.8795
 Site-webcam                        | Train Loss: 1.6713 | Train Acc: 0.8952
 Site-dslr                          | Train Loss: 1.7911 | Train Acc: 0.9200
 Site-dslr                          | Train Loss: 1.6601 | Train Acc: 0.8800
 Site-synthetic                     | Train Loss: 2.2864 | Train Acc: 0.5217
Average Train Accuracy: 0.8946
 Site-amazon                        | Val  Loss: 1.2681 | Val  Acc: 0.9474
 Site-amazon                        | Val  Loss: 1.3739 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 1.5842 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.6071 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 1.4071 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 1.3889 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.4177 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.4401 | Val  Acc: 0.9035
 Site-amazon                        | Val  Loss: 1.4010 | Val  Acc: 0.9257
 Site-amazon                        | Val  Loss: 1.4015 | Val  Acc: 0.9476
 Site-webcam                        | Val  Loss: 1.7317 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 1.7187 | Val  Acc: 0.8333
 Site-webcam                        | Val  Loss: 1.6252 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.6193 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.5744 | Val  Acc: 0.9268
 Site-dslr                          | Val  Loss: 1.7160 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 1.4846 | Val  Acc: 0.9091
 Site-synthetic                     | Val  Loss: 2.5731 | Val  Acc: 0.4130
Average Valid Accuracy: 0.8777
============ Train epoch 23 ============
 Site-amazon                        | Train Loss: 1.5058 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.3057 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 1.2866 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 1.3767 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 1.4446 | Train Acc: 0.9114
 Site-amazon                        | Train Loss: 1.2966 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 1.3707 | Train Acc: 0.9549
 Site-amazon                        | Train Loss: 1.4004 | Train Acc: 0.9244
 Site-amazon                        | Train Loss: 1.3915 | Train Acc: 0.9099
 Site-amazon                        | Train Loss: 1.3386 | Train Acc: 0.9443
 Site-webcam                        | Train Loss: 1.6788 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.6932 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 1.5469 | Train Acc: 0.8909
 Site-webcam                        | Train Loss: 1.5563 | Train Acc: 0.8795
 Site-webcam                        | Train Loss: 1.6196 | Train Acc: 0.8871
 Site-dslr                          | Train Loss: 1.8116 | Train Acc: 0.9000
 Site-dslr                          | Train Loss: 1.5695 | Train Acc: 0.9100
 Site-synthetic                     | Train Loss: 2.2985 | Train Acc: 0.4638
Average Train Accuracy: 0.8823
 Site-amazon                        | Val  Loss: 1.1994 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.2223 | Val  Acc: 0.9583
 Site-amazon                        | Val  Loss: 1.4709 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 1.6082 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 1.3737 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 1.2187 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 1.3236 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.4121 | Val  Acc: 0.9035
 Site-amazon                        | Val  Loss: 1.3050 | Val  Acc: 0.9459
 Site-amazon                        | Val  Loss: 1.3391 | Val  Acc: 0.9372
 Site-webcam                        | Val  Loss: 1.7731 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 1.6288 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 1.4911 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.6670 | Val  Acc: 0.8364
 Site-webcam                        | Val  Loss: 1.6061 | Val  Acc: 0.8659
 Site-dslr                          | Val  Loss: 1.6753 | Val  Acc: 0.9394
 Site-dslr                          | Val  Loss: 1.4876 | Val  Acc: 0.9242
 Site-synthetic                     | Val  Loss: 2.5712 | Val  Acc: 0.4130
Average Valid Accuracy: 0.8836
============ Train epoch 24 ============
 Site-amazon                        | Train Loss: 1.4686 | Train Acc: 0.8929
 Site-amazon                        | Train Loss: 1.3203 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 1.3130 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 1.3065 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 1.2448 | Train Acc: 0.9241
 Site-amazon                        | Train Loss: 1.2199 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 1.4437 | Train Acc: 0.9323
 Site-amazon                        | Train Loss: 1.3311 | Train Acc: 0.9360
 Site-amazon                        | Train Loss: 1.3019 | Train Acc: 0.9234
 Site-amazon                        | Train Loss: 1.3133 | Train Acc: 0.9338
 Site-webcam                        | Train Loss: 1.5211 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 1.5586 | Train Acc: 0.7838
 Site-webcam                        | Train Loss: 1.4485 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 1.4260 | Train Acc: 0.9036
 Site-webcam                        | Train Loss: 1.5869 | Train Acc: 0.9032
 Site-dslr                          | Train Loss: 1.7295 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 1.4998 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 2.2414 | Train Acc: 0.5072
Average Train Accuracy: 0.8896
 Site-amazon                        | Val  Loss: 1.1293 | Val  Acc: 0.9474
 Site-amazon                        | Val  Loss: 1.1326 | Val  Acc: 0.9583
 Site-amazon                        | Val  Loss: 1.4655 | Val  Acc: 0.9032
 Site-amazon                        | Val  Loss: 1.4850 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 1.2764 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 1.1550 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 1.2527 | Val  Acc: 0.9432
 Site-amazon                        | Val  Loss: 1.3351 | Val  Acc: 0.9123
 Site-amazon                        | Val  Loss: 1.2926 | Val  Acc: 0.9054
 Site-amazon                        | Val  Loss: 1.2761 | Val  Acc: 0.9476
 Site-webcam                        | Val  Loss: 1.6510 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 1.4856 | Val  Acc: 0.9583
 Site-webcam                        | Val  Loss: 1.4889 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.5493 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.5222 | Val  Acc: 0.8415
 Site-dslr                          | Val  Loss: 1.6158 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 1.4777 | Val  Acc: 0.8636
 Site-synthetic                     | Val  Loss: 2.5898 | Val  Acc: 0.4130
Average Valid Accuracy: 0.8825
============ Train epoch 25 ============
 Site-amazon                        | Train Loss: 1.3146 | Train Acc: 0.9643
 Site-amazon                        | Train Loss: 1.2192 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 1.2312 | Train Acc: 0.9149
 Site-amazon                        | Train Loss: 1.2473 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 1.2260 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 1.1422 | Train Acc: 0.9709
 Site-amazon                        | Train Loss: 1.1393 | Train Acc: 0.9398
 Site-amazon                        | Train Loss: 1.2537 | Train Acc: 0.9419
 Site-amazon                        | Train Loss: 1.2313 | Train Acc: 0.9099
 Site-amazon                        | Train Loss: 1.2474 | Train Acc: 0.9443
 Site-webcam                        | Train Loss: 1.5956 | Train Acc: 0.8333
 Site-webcam                        | Train Loss: 1.5722 | Train Acc: 0.7568
 Site-webcam                        | Train Loss: 1.4342 | Train Acc: 0.8727
 Site-webcam                        | Train Loss: 1.4761 | Train Acc: 0.9518
 Site-webcam                        | Train Loss: 1.5192 | Train Acc: 0.8790
 Site-dslr                          | Train Loss: 1.7065 | Train Acc: 0.8600
 Site-dslr                          | Train Loss: 1.4491 | Train Acc: 0.9100
 Site-synthetic                     | Train Loss: 2.2888 | Train Acc: 0.5072
Average Train Accuracy: 0.8850
 Site-amazon                        | Val  Loss: 1.0591 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.2215 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 1.4189 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.4503 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 1.3171 | Val  Acc: 0.8868
 Site-amazon                        | Val  Loss: 1.2025 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 1.2073 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.2907 | Val  Acc: 0.8860
 Site-amazon                        | Val  Loss: 1.1913 | Val  Acc: 0.9257
 Site-amazon                        | Val  Loss: 1.2111 | Val  Acc: 0.9529
 Site-webcam                        | Val  Loss: 1.5674 | Val  Acc: 0.9375
 Site-webcam                        | Val  Loss: 1.4273 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 1.3417 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 1.5239 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 1.5117 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 1.5091 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 1.3504 | Val  Acc: 0.8788
 Site-synthetic                     | Val  Loss: 2.5650 | Val  Acc: 0.3913
Average Valid Accuracy: 0.8843
============ Train epoch 26 ============
 Site-amazon                        | Train Loss: 1.3207 | Train Acc: 0.8214
 Site-amazon                        | Train Loss: 1.1772 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 1.1003 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 1.1816 | Train Acc: 0.9344
 Site-amazon                        | Train Loss: 1.1483 | Train Acc: 0.9241
 Site-amazon                        | Train Loss: 1.0996 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 1.2530 | Train Acc: 0.9173
 Site-amazon                        | Train Loss: 1.2159 | Train Acc: 0.9128
 Site-amazon                        | Train Loss: 1.2294 | Train Acc: 0.9369
 Site-amazon                        | Train Loss: 1.1594 | Train Acc: 0.9443
 Site-webcam                        | Train Loss: 1.5898 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.5385 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 1.3766 | Train Acc: 0.8545
 Site-webcam                        | Train Loss: 1.4019 | Train Acc: 0.8675
 Site-webcam                        | Train Loss: 1.4188 | Train Acc: 0.8952
 Site-dslr                          | Train Loss: 1.5954 | Train Acc: 0.9400
 Site-dslr                          | Train Loss: 1.4357 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 2.2835 | Train Acc: 0.4928
Average Train Accuracy: 0.8830
 Site-amazon                        | Val  Loss: 0.9611 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.0244 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.4310 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 1.4283 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 1.2055 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 1.0800 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 1.1797 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.2584 | Val  Acc: 0.8772
 Site-amazon                        | Val  Loss: 1.1534 | Val  Acc: 0.9392
 Site-amazon                        | Val  Loss: 1.1731 | Val  Acc: 0.9476
 Site-webcam                        | Val  Loss: 1.5606 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 1.4103 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.4667 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.4713 | Val  Acc: 0.8545
 Site-webcam                        | Val  Loss: 1.3562 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 1.6086 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 1.2557 | Val  Acc: 0.9242
 Site-synthetic                     | Val  Loss: 2.4668 | Val  Acc: 0.4565
Average Valid Accuracy: 0.8893
 Best site-amazon                    | Epoch:26 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:26 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:26 | Val Acc: 0.8387
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9024
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9623
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9853
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9318
 Best site-amazon                    | Epoch:26 | Val Acc: 0.8772
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9392
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9476
 Best site-webcam                    | Epoch:26 | Val Acc: 0.8125
 Best site-webcam                    | Epoch:26 | Val Acc: 0.8750
 Best site-webcam                    | Epoch:26 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:26 | Val Acc: 0.8545
 Best site-webcam                    | Epoch:26 | Val Acc: 0.9024
 Best site-dslr                      | Epoch:26 | Val Acc: 0.8788
 Best site-dslr                      | Epoch:26 | Val Acc: 0.9242
 Best site-synthetic                 | Epoch:26 | Val Acc: 0.4565
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 27 ============
 Site-amazon                        | Train Loss: 1.3457 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 1.1429 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 1.0577 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 1.1534 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 1.1113 | Train Acc: 0.9494
 Site-amazon                        | Train Loss: 1.0649 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 1.2094 | Train Acc: 0.9323
 Site-amazon                        | Train Loss: 1.1688 | Train Acc: 0.9302
 Site-amazon                        | Train Loss: 1.1075 | Train Acc: 0.9279
 Site-amazon                        | Train Loss: 1.0986 | Train Acc: 0.9547
 Site-webcam                        | Train Loss: 1.3349 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 1.4429 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 1.3586 | Train Acc: 0.8727
 Site-webcam                        | Train Loss: 1.3678 | Train Acc: 0.9157
 Site-webcam                        | Train Loss: 1.4019 | Train Acc: 0.8790
 Site-dslr                          | Train Loss: 1.5893 | Train Acc: 0.8600
 Site-dslr                          | Train Loss: 1.3723 | Train Acc: 0.9300
 Site-synthetic                     | Train Loss: 2.2669 | Train Acc: 0.5362
Average Train Accuracy: 0.8933
 Site-amazon                        | Val  Loss: 0.9293 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.0162 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 1.2687 | Val  Acc: 0.9355
 Site-amazon                        | Val  Loss: 1.3052 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 1.1606 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 1.0715 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 1.1364 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.1785 | Val  Acc: 0.8947
 Site-amazon                        | Val  Loss: 1.0991 | Val  Acc: 0.9257
 Site-amazon                        | Val  Loss: 1.1123 | Val  Acc: 0.9529
 Site-webcam                        | Val  Loss: 1.6194 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 1.3772 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 1.2835 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.3079 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 1.3567 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 1.4455 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 1.2490 | Val  Acc: 0.9091
 Site-synthetic                     | Val  Loss: 2.5052 | Val  Acc: 0.3913
Average Valid Accuracy: 0.8924
 Best site-amazon                    | Epoch:27 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:27 | Val Acc: 0.8750
 Best site-amazon                    | Epoch:27 | Val Acc: 0.9355
 Best site-amazon                    | Epoch:27 | Val Acc: 0.9024
 Best site-amazon                    | Epoch:27 | Val Acc: 0.9811
 Best site-amazon                    | Epoch:27 | Val Acc: 0.9853
 Best site-amazon                    | Epoch:27 | Val Acc: 0.9318
 Best site-amazon                    | Epoch:27 | Val Acc: 0.8947
 Best site-amazon                    | Epoch:27 | Val Acc: 0.9257
 Best site-amazon                    | Epoch:27 | Val Acc: 0.9529
 Best site-webcam                    | Epoch:27 | Val Acc: 0.8125
 Best site-webcam                    | Epoch:27 | Val Acc: 0.9167
 Best site-webcam                    | Epoch:27 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:27 | Val Acc: 0.8909
 Best site-webcam                    | Epoch:27 | Val Acc: 0.9024
 Best site-dslr                      | Epoch:27 | Val Acc: 0.9091
 Best site-dslr                      | Epoch:27 | Val Acc: 0.9091
 Best site-synthetic                 | Epoch:27 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 28 ============
 Site-amazon                        | Train Loss: 1.1823 | Train Acc: 0.9643
 Site-amazon                        | Train Loss: 1.0045 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.9562 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 1.1511 | Train Acc: 0.9344
 Site-amazon                        | Train Loss: 1.0621 | Train Acc: 0.9494
 Site-amazon                        | Train Loss: 0.9956 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 1.0286 | Train Acc: 0.9098
 Site-amazon                        | Train Loss: 1.1176 | Train Acc: 0.9244
 Site-amazon                        | Train Loss: 1.1216 | Train Acc: 0.9054
 Site-amazon                        | Train Loss: 1.0723 | Train Acc: 0.9338
 Site-webcam                        | Train Loss: 1.3574 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 1.4736 | Train Acc: 0.7568
 Site-webcam                        | Train Loss: 1.3320 | Train Acc: 0.8364
 Site-webcam                        | Train Loss: 1.3794 | Train Acc: 0.8675
 Site-webcam                        | Train Loss: 1.4150 | Train Acc: 0.8629
 Site-dslr                          | Train Loss: 1.5181 | Train Acc: 0.9200
 Site-dslr                          | Train Loss: 1.3617 | Train Acc: 0.8800
 Site-synthetic                     | Train Loss: 2.2607 | Train Acc: 0.4783
Average Train Accuracy: 0.8855
 Site-amazon                        | Val  Loss: 0.8728 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.0644 | Val  Acc: 0.8333
 Site-amazon                        | Val  Loss: 1.2852 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.3002 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 1.1468 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 0.9105 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 1.0452 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.1628 | Val  Acc: 0.8947
 Site-amazon                        | Val  Loss: 1.0547 | Val  Acc: 0.9459
 Site-amazon                        | Val  Loss: 1.0926 | Val  Acc: 0.9319
 Site-webcam                        | Val  Loss: 1.4679 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.3542 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.3130 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.3966 | Val  Acc: 0.8545
 Site-webcam                        | Val  Loss: 1.3038 | Val  Acc: 0.9146
 Site-dslr                          | Val  Loss: 1.4735 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 1.2705 | Val  Acc: 0.9091
 Site-synthetic                     | Val  Loss: 2.4915 | Val  Acc: 0.4130
Average Valid Accuracy: 0.8839
============ Train epoch 29 ============
 Site-amazon                        | Train Loss: 1.1447 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 1.0326 | Train Acc: 0.8919
 Site-amazon                        | Train Loss: 0.9943 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 1.0870 | Train Acc: 0.8852
 Site-amazon                        | Train Loss: 1.0898 | Train Acc: 0.8987
 Site-amazon                        | Train Loss: 0.9446 | Train Acc: 0.9709
 Site-amazon                        | Train Loss: 0.9770 | Train Acc: 0.9323
 Site-amazon                        | Train Loss: 1.0860 | Train Acc: 0.9128
 Site-amazon                        | Train Loss: 1.0632 | Train Acc: 0.9369
 Site-amazon                        | Train Loss: 1.0491 | Train Acc: 0.9443
 Site-webcam                        | Train Loss: 1.4430 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.3364 | Train Acc: 0.8649
 Site-webcam                        | Train Loss: 1.2303 | Train Acc: 0.8909
 Site-webcam                        | Train Loss: 1.2094 | Train Acc: 0.8554
 Site-webcam                        | Train Loss: 1.3828 | Train Acc: 0.8468
 Site-dslr                          | Train Loss: 1.4953 | Train Acc: 0.8600
 Site-dslr                          | Train Loss: 1.2220 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 2.4793 | Train Acc: 0.5652
Average Train Accuracy: 0.8843
 Site-amazon                        | Val  Loss: 0.8784 | Val  Acc: 0.9474
 Site-amazon                        | Val  Loss: 0.9864 | Val  Acc: 0.9583
 Site-amazon                        | Val  Loss: 1.1558 | Val  Acc: 0.9032
 Site-amazon                        | Val  Loss: 1.2593 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 1.0946 | Val  Acc: 0.9057
 Site-amazon                        | Val  Loss: 0.8415 | Val  Acc: 0.9706
 Site-amazon                        | Val  Loss: 0.9928 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.1036 | Val  Acc: 0.8860
 Site-amazon                        | Val  Loss: 1.0339 | Val  Acc: 0.9324
 Site-amazon                        | Val  Loss: 1.0008 | Val  Acc: 0.9424
 Site-webcam                        | Val  Loss: 1.6000 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 1.3230 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.2010 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.3846 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.2481 | Val  Acc: 0.8902
 Site-dslr                          | Val  Loss: 1.3053 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 1.1129 | Val  Acc: 0.8636
 Site-synthetic                     | Val  Loss: 2.3562 | Val  Acc: 0.4130
Average Valid Accuracy: 0.8742
============ Train epoch 30 ============
 Site-amazon                        | Train Loss: 1.0888 | Train Acc: 0.9643
 Site-amazon                        | Train Loss: 0.9632 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.9002 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 1.0059 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 0.9833 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 0.9159 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 1.0765 | Train Acc: 0.9549
 Site-amazon                        | Train Loss: 1.0321 | Train Acc: 0.9302
 Site-amazon                        | Train Loss: 1.0551 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 0.9861 | Train Acc: 0.9408
 Site-webcam                        | Train Loss: 1.2947 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.3260 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 1.2079 | Train Acc: 0.8364
 Site-webcam                        | Train Loss: 1.2845 | Train Acc: 0.9157
 Site-webcam                        | Train Loss: 1.2740 | Train Acc: 0.9032
 Site-dslr                          | Train Loss: 1.4278 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 1.1906 | Train Acc: 0.8900
 Site-synthetic                     | Train Loss: 2.1772 | Train Acc: 0.5652
Average Train Accuracy: 0.8974
 Site-amazon                        | Val  Loss: 0.7464 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.8790 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 1.1939 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.2669 | Val  Acc: 0.8049
 Site-amazon                        | Val  Loss: 0.9922 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 0.8891 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.9396 | Val  Acc: 0.9659
 Site-amazon                        | Val  Loss: 1.0046 | Val  Acc: 0.9035
 Site-amazon                        | Val  Loss: 0.9657 | Val  Acc: 0.9392
 Site-amazon                        | Val  Loss: 0.9863 | Val  Acc: 0.9372
 Site-webcam                        | Val  Loss: 1.3991 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.1756 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 1.2878 | Val  Acc: 0.8108
 Site-webcam                        | Val  Loss: 1.2657 | Val  Acc: 0.9273
 Site-webcam                        | Val  Loss: 1.1664 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 1.3891 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 1.2170 | Val  Acc: 0.8939
 Site-synthetic                     | Val  Loss: 2.4191 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8814
============ Train epoch 31 ============
 Site-amazon                        | Train Loss: 1.1588 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 0.9092 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 0.8757 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 0.9538 | Train Acc: 0.9344
 Site-amazon                        | Train Loss: 0.8878 | Train Acc: 0.9241
 Site-amazon                        | Train Loss: 0.8678 | Train Acc: 0.9709
 Site-amazon                        | Train Loss: 0.9041 | Train Acc: 0.9624
 Site-amazon                        | Train Loss: 0.9580 | Train Acc: 0.9302
 Site-amazon                        | Train Loss: 0.9868 | Train Acc: 0.9234
 Site-amazon                        | Train Loss: 0.9143 | Train Acc: 0.9547
 Site-webcam                        | Train Loss: 1.2619 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 1.3115 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 1.1978 | Train Acc: 0.9273
 Site-webcam                        | Train Loss: 1.2577 | Train Acc: 0.9036
 Site-webcam                        | Train Loss: 1.2748 | Train Acc: 0.8871
 Site-dslr                          | Train Loss: 1.4040 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 1.1819 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 2.0941 | Train Acc: 0.5362
Average Train Accuracy: 0.9000
 Site-amazon                        | Val  Loss: 0.7271 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.9027 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 1.0723 | Val  Acc: 0.9032
 Site-amazon                        | Val  Loss: 1.1820 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 0.9892 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 0.7694 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.9189 | Val  Acc: 0.9432
 Site-amazon                        | Val  Loss: 0.9791 | Val  Acc: 0.9035
 Site-amazon                        | Val  Loss: 0.8990 | Val  Acc: 0.9122
 Site-amazon                        | Val  Loss: 0.9403 | Val  Acc: 0.9424
 Site-webcam                        | Val  Loss: 1.5555 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 1.2129 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 1.1575 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.2658 | Val  Acc: 0.8545
 Site-webcam                        | Val  Loss: 1.1716 | Val  Acc: 0.9268
 Site-dslr                          | Val  Loss: 1.3035 | Val  Acc: 0.8182
 Site-dslr                          | Val  Loss: 1.0167 | Val  Acc: 0.9091
 Site-synthetic                     | Val  Loss: 2.4826 | Val  Acc: 0.3913
Average Valid Accuracy: 0.8740
============ Train epoch 32 ============
 Site-amazon                        | Train Loss: 0.9600 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 0.8868 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 0.7862 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 0.9249 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 0.7982 | Train Acc: 0.9620
 Site-amazon                        | Train Loss: 0.8543 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 0.7624 | Train Acc: 0.9173
 Site-amazon                        | Train Loss: 0.8969 | Train Acc: 0.9477
 Site-amazon                        | Train Loss: 0.9027 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 0.8979 | Train Acc: 0.9547
 Site-webcam                        | Train Loss: 1.1927 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 1.2762 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 1.1426 | Train Acc: 0.8545
 Site-webcam                        | Train Loss: 1.1239 | Train Acc: 0.8916
 Site-webcam                        | Train Loss: 1.2202 | Train Acc: 0.8629
 Site-dslr                          | Train Loss: 1.3140 | Train Acc: 0.9200
 Site-dslr                          | Train Loss: 1.2004 | Train Acc: 0.8900
 Site-synthetic                     | Train Loss: 2.0742 | Train Acc: 0.5362
Average Train Accuracy: 0.8978
 Site-amazon                        | Val  Loss: 0.6324 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.8490 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 1.1429 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.0557 | Val  Acc: 0.9268
 Site-amazon                        | Val  Loss: 1.0207 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 0.8507 | Val  Acc: 0.9412
 Site-amazon                        | Val  Loss: 0.8526 | Val  Acc: 0.9432
 Site-amazon                        | Val  Loss: 0.9636 | Val  Acc: 0.9035
 Site-amazon                        | Val  Loss: 0.8835 | Val  Acc: 0.9257
 Site-amazon                        | Val  Loss: 0.9101 | Val  Acc: 0.9424
 Site-webcam                        | Val  Loss: 1.3340 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 1.1447 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.1922 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.2120 | Val  Acc: 0.8727
 Site-webcam                        | Val  Loss: 1.1158 | Val  Acc: 0.9146
 Site-dslr                          | Val  Loss: 1.1886 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 1.0670 | Val  Acc: 0.8485
 Site-synthetic                     | Val  Loss: 2.3274 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8749
============ Train epoch 33 ============
 Site-amazon                        | Train Loss: 0.9302 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 0.8114 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.7682 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 0.9063 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 0.7850 | Train Acc: 0.9494
 Site-amazon                        | Train Loss: 0.7878 | Train Acc: 0.9709
 Site-amazon                        | Train Loss: 0.8532 | Train Acc: 0.9549
 Site-amazon                        | Train Loss: 0.8701 | Train Acc: 0.9244
 Site-amazon                        | Train Loss: 0.8518 | Train Acc: 0.9234
 Site-amazon                        | Train Loss: 0.8568 | Train Acc: 0.9582
 Site-webcam                        | Train Loss: 1.1992 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 1.1612 | Train Acc: 0.8919
 Site-webcam                        | Train Loss: 1.0508 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 1.1878 | Train Acc: 0.8675
 Site-webcam                        | Train Loss: 1.1827 | Train Acc: 0.8871
 Site-dslr                          | Train Loss: 1.2371 | Train Acc: 0.8600
 Site-dslr                          | Train Loss: 1.0848 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 1.7680 | Train Acc: 0.5507
Average Train Accuracy: 0.9041
 Site-amazon                        | Val  Loss: 0.5979 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.7483 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 0.9818 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 1.1147 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 0.8040 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.7672 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.8119 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.9525 | Val  Acc: 0.8860
 Site-amazon                        | Val  Loss: 0.8000 | Val  Acc: 0.9189
 Site-amazon                        | Val  Loss: 0.8539 | Val  Acc: 0.9424
 Site-webcam                        | Val  Loss: 1.1821 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 1.0699 | Val  Acc: 0.9583
 Site-webcam                        | Val  Loss: 1.0741 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.1112 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.1202 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 1.1127 | Val  Acc: 0.9394
 Site-dslr                          | Val  Loss: 1.1720 | Val  Acc: 0.9242
 Site-synthetic                     | Val  Loss: 2.3205 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8967
 Best site-amazon                    | Epoch:33 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:33 | Val Acc: 0.9167
 Best site-amazon                    | Epoch:33 | Val Acc: 0.8387
 Best site-amazon                    | Epoch:33 | Val Acc: 0.8780
 Best site-amazon                    | Epoch:33 | Val Acc: 0.9623
 Best site-amazon                    | Epoch:33 | Val Acc: 0.9853
 Best site-amazon                    | Epoch:33 | Val Acc: 0.9773
 Best site-amazon                    | Epoch:33 | Val Acc: 0.8860
 Best site-amazon                    | Epoch:33 | Val Acc: 0.9189
 Best site-amazon                    | Epoch:33 | Val Acc: 0.9424
 Best site-webcam                    | Epoch:33 | Val Acc: 0.8750
 Best site-webcam                    | Epoch:33 | Val Acc: 0.9583
 Best site-webcam                    | Epoch:33 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:33 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:33 | Val Acc: 0.9024
 Best site-dslr                      | Epoch:33 | Val Acc: 0.9394
 Best site-dslr                      | Epoch:33 | Val Acc: 0.9242
 Best site-synthetic                 | Epoch:33 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 34 ============
 Site-amazon                        | Train Loss: 0.9864 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 0.8038 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.6892 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.8785 | Train Acc: 0.9344
 Site-amazon                        | Train Loss: 0.7607 | Train Acc: 0.9494
 Site-amazon                        | Train Loss: 0.7422 | Train Acc: 0.9709
 Site-amazon                        | Train Loss: 0.7063 | Train Acc: 0.9624
 Site-amazon                        | Train Loss: 0.8560 | Train Acc: 0.9535
 Site-amazon                        | Train Loss: 0.8688 | Train Acc: 0.9279
 Site-amazon                        | Train Loss: 0.8190 | Train Acc: 0.9547
 Site-webcam                        | Train Loss: 1.1842 | Train Acc: 0.8333
 Site-webcam                        | Train Loss: 1.3228 | Train Acc: 0.7838
 Site-webcam                        | Train Loss: 1.0725 | Train Acc: 0.8545
 Site-webcam                        | Train Loss: 1.0831 | Train Acc: 0.9398
 Site-webcam                        | Train Loss: 1.1778 | Train Acc: 0.8952
 Site-dslr                          | Train Loss: 1.3080 | Train Acc: 0.9200
 Site-dslr                          | Train Loss: 1.1331 | Train Acc: 0.8700
 Site-synthetic                     | Train Loss: 2.2585 | Train Acc: 0.5652
Average Train Accuracy: 0.9024
 Site-amazon                        | Val  Loss: 0.5954 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.7526 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 0.9982 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.0797 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 0.8418 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.7353 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.8127 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 0.9092 | Val  Acc: 0.8947
 Site-amazon                        | Val  Loss: 0.7894 | Val  Acc: 0.9392
 Site-amazon                        | Val  Loss: 0.7936 | Val  Acc: 0.9529
 Site-webcam                        | Val  Loss: 1.3363 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 1.0942 | Val  Acc: 0.9583
 Site-webcam                        | Val  Loss: 1.0287 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.1444 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 1.0270 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 1.0625 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 1.0071 | Val  Acc: 0.9091
 Site-synthetic                     | Val  Loss: 2.3447 | Val  Acc: 0.4565
Average Valid Accuracy: 0.8971
 Best site-amazon                    | Epoch:34 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9167
 Best site-amazon                    | Epoch:34 | Val Acc: 0.8710
 Best site-amazon                    | Epoch:34 | Val Acc: 0.8537
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9623
 Best site-amazon                    | Epoch:34 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9545
 Best site-amazon                    | Epoch:34 | Val Acc: 0.8947
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9392
 Best site-amazon                    | Epoch:34 | Val Acc: 0.9529
 Best site-webcam                    | Epoch:34 | Val Acc: 0.8125
 Best site-webcam                    | Epoch:34 | Val Acc: 0.9583
 Best site-webcam                    | Epoch:34 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:34 | Val Acc: 0.9091
 Best site-webcam                    | Epoch:34 | Val Acc: 0.9024
 Best site-dslr                      | Epoch:34 | Val Acc: 0.9091
 Best site-dslr                      | Epoch:34 | Val Acc: 0.9091
 Best site-synthetic                 | Epoch:34 | Val Acc: 0.4565
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 35 ============
 Site-amazon                        | Train Loss: 0.9206 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 0.7981 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 0.7936 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 0.7954 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 0.9224 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 0.7415 | Train Acc: 0.9612
 Site-amazon                        | Train Loss: 0.8993 | Train Acc: 0.9398
 Site-amazon                        | Train Loss: 0.7767 | Train Acc: 0.9651
 Site-amazon                        | Train Loss: 0.8431 | Train Acc: 0.9279
 Site-amazon                        | Train Loss: 0.8043 | Train Acc: 0.9617
 Site-webcam                        | Train Loss: 1.0907 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 1.1910 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 1.0122 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 1.0902 | Train Acc: 0.8916
 Site-webcam                        | Train Loss: 1.1283 | Train Acc: 0.9032
 Site-dslr                          | Train Loss: 1.3247 | Train Acc: 0.8600
 Site-dslr                          | Train Loss: 1.1035 | Train Acc: 0.8800
 Site-synthetic                     | Train Loss: 2.2481 | Train Acc: 0.5942
Average Train Accuracy: 0.9008
 Site-amazon                        | Val  Loss: 0.5325 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.6770 | Val  Acc: 0.9583
 Site-amazon                        | Val  Loss: 0.9249 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 0.9967 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 0.7289 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.5972 | Val  Acc: 0.9559
 Site-amazon                        | Val  Loss: 0.8113 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 0.8325 | Val  Acc: 0.9123
 Site-amazon                        | Val  Loss: 0.7785 | Val  Acc: 0.9392
 Site-amazon                        | Val  Loss: 0.7540 | Val  Acc: 0.9581
 Site-webcam                        | Val  Loss: 1.1412 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 0.9289 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 0.9017 | Val  Acc: 0.9730
 Site-webcam                        | Val  Loss: 1.1247 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.9368 | Val  Acc: 0.9268
 Site-dslr                          | Val  Loss: 1.1473 | Val  Acc: 0.8485
 Site-dslr                          | Val  Loss: 0.9071 | Val  Acc: 0.8939
 Site-synthetic                     | Val  Loss: 2.3751 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8874
============ Train epoch 36 ============
 Site-amazon                        | Train Loss: 0.9234 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 0.7712 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 0.7113 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 0.7498 | Train Acc: 0.9508
 Site-amazon                        | Train Loss: 0.6923 | Train Acc: 0.9494
 Site-amazon                        | Train Loss: 0.7067 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 0.7306 | Train Acc: 0.9323
 Site-amazon                        | Train Loss: 0.7826 | Train Acc: 0.9302
 Site-amazon                        | Train Loss: 0.8070 | Train Acc: 0.9324
 Site-amazon                        | Train Loss: 0.7564 | Train Acc: 0.9512
 Site-webcam                        | Train Loss: 1.0903 | Train Acc: 0.8333
 Site-webcam                        | Train Loss: 1.2032 | Train Acc: 0.7568
 Site-webcam                        | Train Loss: 1.0052 | Train Acc: 0.8545
 Site-webcam                        | Train Loss: 1.0113 | Train Acc: 0.9157
 Site-webcam                        | Train Loss: 1.0662 | Train Acc: 0.8871
 Site-dslr                          | Train Loss: 1.2478 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 0.9861 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 1.8918 | Train Acc: 0.5072
Average Train Accuracy: 0.8864
 Site-amazon                        | Val  Loss: 0.5150 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.6920 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 0.9163 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 0.9953 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 0.7281 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.7068 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.7533 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.8250 | Val  Acc: 0.9123
 Site-amazon                        | Val  Loss: 0.6811 | Val  Acc: 0.9392
 Site-amazon                        | Val  Loss: 0.7504 | Val  Acc: 0.9581
 Site-webcam                        | Val  Loss: 1.0057 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.9110 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 1.1295 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.0896 | Val  Acc: 0.8727
 Site-webcam                        | Val  Loss: 0.9295 | Val  Acc: 0.9146
 Site-dslr                          | Val  Loss: 1.1790 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 0.8799 | Val  Acc: 0.8788
 Site-synthetic                     | Val  Loss: 2.2928 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8944
============ Train epoch 37 ============
 Site-amazon                        | Train Loss: 0.8442 | Train Acc: 0.8929
 Site-amazon                        | Train Loss: 0.7809 | Train Acc: 0.8919
 Site-amazon                        | Train Loss: 0.6813 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.7755 | Train Acc: 0.8852
 Site-amazon                        | Train Loss: 0.9082 | Train Acc: 0.9620
 Site-amazon                        | Train Loss: 0.6729 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 0.6240 | Train Acc: 0.9474
 Site-amazon                        | Train Loss: 0.7548 | Train Acc: 0.9128
 Site-amazon                        | Train Loss: 0.7486 | Train Acc: 0.9369
 Site-amazon                        | Train Loss: 0.7680 | Train Acc: 0.9512
 Site-webcam                        | Train Loss: 1.1429 | Train Acc: 0.8333
 Site-webcam                        | Train Loss: 1.0866 | Train Acc: 0.7838
 Site-webcam                        | Train Loss: 1.0642 | Train Acc: 0.8727
 Site-webcam                        | Train Loss: 1.0256 | Train Acc: 0.9036
 Site-webcam                        | Train Loss: 1.0650 | Train Acc: 0.8952
 Site-dslr                          | Train Loss: 1.2120 | Train Acc: 0.8600
 Site-dslr                          | Train Loss: 1.0229 | Train Acc: 0.9100
 Site-synthetic                     | Train Loss: 1.4686 | Train Acc: 0.4783
Average Train Accuracy: 0.8811
 Site-amazon                        | Val  Loss: 0.5850 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.6950 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 0.9029 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 0.9818 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 0.6769 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.6763 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.7443 | Val  Acc: 0.9659
 Site-amazon                        | Val  Loss: 0.7897 | Val  Acc: 0.8860
 Site-amazon                        | Val  Loss: 0.6911 | Val  Acc: 0.9662
 Site-amazon                        | Val  Loss: 0.7088 | Val  Acc: 0.9738
 Site-webcam                        | Val  Loss: 1.0481 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 0.9854 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 0.9451 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.0390 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 1.0209 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 1.1091 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 0.9470 | Val  Acc: 0.8939
 Site-synthetic                     | Val  Loss: 2.2762 | Val  Acc: 0.4130
Average Valid Accuracy: 0.8884
============ Train epoch 38 ============
 Site-amazon                        | Train Loss: 0.7504 | Train Acc: 0.9643
 Site-amazon                        | Train Loss: 0.6699 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 0.6416 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 0.6926 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 0.7212 | Train Acc: 0.9747
 Site-amazon                        | Train Loss: 0.6590 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 0.7377 | Train Acc: 0.9474
 Site-amazon                        | Train Loss: 0.7180 | Train Acc: 0.9535
 Site-amazon                        | Train Loss: 0.7362 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 0.7196 | Train Acc: 0.9408
 Site-webcam                        | Train Loss: 1.0315 | Train Acc: 0.8333
 Site-webcam                        | Train Loss: 1.0359 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 0.9711 | Train Acc: 0.8909
 Site-webcam                        | Train Loss: 1.0217 | Train Acc: 0.8795
 Site-webcam                        | Train Loss: 1.0361 | Train Acc: 0.8548
 Site-dslr                          | Train Loss: 1.1488 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 0.9630 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 1.8539 | Train Acc: 0.5072
Average Train Accuracy: 0.8935
 Site-amazon                        | Val  Loss: 0.5179 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.7065 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 0.8033 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 0.9628 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 0.6687 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.5423 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.7115 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 0.7663 | Val  Acc: 0.9035
 Site-amazon                        | Val  Loss: 0.6228 | Val  Acc: 0.9527
 Site-amazon                        | Val  Loss: 0.7086 | Val  Acc: 0.9424
 Site-webcam                        | Val  Loss: 1.2683 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 0.9090 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 0.9893 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.0029 | Val  Acc: 0.9273
 Site-webcam                        | Val  Loss: 0.9338 | Val  Acc: 0.9268
 Site-dslr                          | Val  Loss: 1.0434 | Val  Acc: 0.9394
 Site-dslr                          | Val  Loss: 0.9906 | Val  Acc: 0.8939
 Site-synthetic                     | Val  Loss: 2.3126 | Val  Acc: 0.3696
Average Valid Accuracy: 0.8909
============ Train epoch 39 ============
 Site-amazon                        | Train Loss: 0.7883 | Train Acc: 0.9643
 Site-amazon                        | Train Loss: 0.6603 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 0.7100 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 0.6691 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 0.6471 | Train Acc: 0.9620
 Site-amazon                        | Train Loss: 0.6328 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 0.6813 | Train Acc: 0.9098
 Site-amazon                        | Train Loss: 0.6509 | Train Acc: 0.9419
 Site-amazon                        | Train Loss: 0.7058 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 0.6704 | Train Acc: 0.9582
 Site-webcam                        | Train Loss: 1.0694 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.1379 | Train Acc: 0.7297
 Site-webcam                        | Train Loss: 0.9309 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 1.0665 | Train Acc: 0.8434
 Site-webcam                        | Train Loss: 0.9261 | Train Acc: 0.9032
 Site-dslr                          | Train Loss: 1.1176 | Train Acc: 0.9200
 Site-dslr                          | Train Loss: 0.9550 | Train Acc: 0.8800
 Site-synthetic                     | Train Loss: 2.0742 | Train Acc: 0.5362
Average Train Accuracy: 0.8882
 Site-amazon                        | Val  Loss: 0.4258 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.7004 | Val  Acc: 0.8750
 Site-amazon                        | Val  Loss: 0.8732 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 0.8308 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 0.7153 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 0.5033 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.6473 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.7622 | Val  Acc: 0.9298
 Site-amazon                        | Val  Loss: 0.7184 | Val  Acc: 0.9324
 Site-amazon                        | Val  Loss: 0.6803 | Val  Acc: 0.9424
 Site-webcam                        | Val  Loss: 1.1829 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 0.9208 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.9161 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.9173 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.9147 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 0.9592 | Val  Acc: 0.9394
 Site-dslr                          | Val  Loss: 0.8592 | Val  Acc: 0.9091
 Site-synthetic                     | Val  Loss: 2.2672 | Val  Acc: 0.4130
Average Valid Accuracy: 0.8829
============ Train epoch 40 ============
 Site-amazon                        | Train Loss: 0.6779 | Train Acc: 0.9643
 Site-amazon                        | Train Loss: 0.6638 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 0.5349 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.6567 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 0.8023 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 0.6105 | Train Acc: 0.9612
 Site-amazon                        | Train Loss: 0.8437 | Train Acc: 0.9023
 Site-amazon                        | Train Loss: 0.6163 | Train Acc: 0.9535
 Site-amazon                        | Train Loss: 0.7191 | Train Acc: 0.9234
 Site-amazon                        | Train Loss: 0.6210 | Train Acc: 0.9686
 Site-webcam                        | Train Loss: 0.9985 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 0.9999 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 0.8769 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 0.9819 | Train Acc: 0.8916
 Site-webcam                        | Train Loss: 0.9860 | Train Acc: 0.8790
 Site-dslr                          | Train Loss: 1.1448 | Train Acc: 0.9000
 Site-dslr                          | Train Loss: 0.9100 | Train Acc: 0.8900
 Site-synthetic                     | Train Loss: 2.2303 | Train Acc: 0.5652
Average Train Accuracy: 0.9012
 Site-amazon                        | Val  Loss: 0.4103 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.6491 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 0.7898 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 0.9282 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 0.7759 | Val  Acc: 0.8868
 Site-amazon                        | Val  Loss: 0.5212 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.5981 | Val  Acc: 0.9659
 Site-amazon                        | Val  Loss: 0.7026 | Val  Acc: 0.9123
 Site-amazon                        | Val  Loss: 0.6008 | Val  Acc: 0.9527
 Site-amazon                        | Val  Loss: 0.6394 | Val  Acc: 0.9529
 Site-webcam                        | Val  Loss: 0.9625 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.8988 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.8782 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.9294 | Val  Acc: 0.8727
 Site-webcam                        | Val  Loss: 0.9185 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 0.9626 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 0.7713 | Val  Acc: 0.8636
 Site-synthetic                     | Val  Loss: 2.3287 | Val  Acc: 0.3261
Average Valid Accuracy: 0.8798
============ Train epoch 41 ============
 Site-amazon                        | Train Loss: 0.6750 | Train Acc: 0.9643
 Site-amazon                        | Train Loss: 0.5819 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 0.6285 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 0.6356 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 0.6124 | Train Acc: 0.9747
 Site-amazon                        | Train Loss: 0.5832 | Train Acc: 0.9612
 Site-amazon                        | Train Loss: 0.7312 | Train Acc: 0.9624
 Site-amazon                        | Train Loss: 0.6556 | Train Acc: 0.9360
 Site-amazon                        | Train Loss: 0.6498 | Train Acc: 0.9414
 Site-amazon                        | Train Loss: 0.6166 | Train Acc: 0.9582
 Site-webcam                        | Train Loss: 1.0055 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 1.0287 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 0.8855 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 0.9897 | Train Acc: 0.9036
 Site-webcam                        | Train Loss: 0.9414 | Train Acc: 0.8790
 Site-dslr                          | Train Loss: 1.0262 | Train Acc: 0.9200
 Site-dslr                          | Train Loss: 0.8378 | Train Acc: 0.9100
 Site-synthetic                     | Train Loss: 1.6580 | Train Acc: 0.5652
Average Train Accuracy: 0.9074
 Site-amazon                        | Val  Loss: 0.3822 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.6193 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 0.7233 | Val  Acc: 0.9032
 Site-amazon                        | Val  Loss: 0.9259 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 0.6012 | Val  Acc: 0.9811
 Site-amazon                        | Val  Loss: 0.6276 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.6338 | Val  Acc: 0.9659
 Site-amazon                        | Val  Loss: 0.6318 | Val  Acc: 0.9211
 Site-amazon                        | Val  Loss: 0.5961 | Val  Acc: 0.9257
 Site-amazon                        | Val  Loss: 0.6313 | Val  Acc: 0.9424
 Site-webcam                        | Val  Loss: 1.0682 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.8526 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.9991 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 0.8985 | Val  Acc: 0.9455
 Site-webcam                        | Val  Loss: 0.8849 | Val  Acc: 0.9268
 Site-dslr                          | Val  Loss: 1.0641 | Val  Acc: 0.8182
 Site-dslr                          | Val  Loss: 0.7720 | Val  Acc: 0.9242
 Site-synthetic                     | Val  Loss: 2.2121 | Val  Acc: 0.3913
Average Valid Accuracy: 0.8883
============ Train epoch 42 ============
 Site-amazon                        | Train Loss: 0.6867 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 0.5890 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 0.5884 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 0.6562 | Train Acc: 0.9016
 Site-amazon                        | Train Loss: 0.5776 | Train Acc: 0.9367
 Site-amazon                        | Train Loss: 0.5377 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 0.6073 | Train Acc: 0.9398
 Site-amazon                        | Train Loss: 0.6352 | Train Acc: 0.9419
 Site-amazon                        | Train Loss: 0.6506 | Train Acc: 0.9324
 Site-amazon                        | Train Loss: 0.5717 | Train Acc: 0.9512
 Site-webcam                        | Train Loss: 0.9452 | Train Acc: 0.7917
 Site-webcam                        | Train Loss: 1.0901 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 0.8730 | Train Acc: 0.9273
 Site-webcam                        | Train Loss: 0.9317 | Train Acc: 0.8795
 Site-webcam                        | Train Loss: 0.9622 | Train Acc: 0.9113
 Site-dslr                          | Train Loss: 0.9792 | Train Acc: 0.9000
 Site-dslr                          | Train Loss: 0.8647 | Train Acc: 0.9100
 Site-synthetic                     | Train Loss: 2.2730 | Train Acc: 0.5362
Average Train Accuracy: 0.8919
 Site-amazon                        | Val  Loss: 0.4016 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.5627 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 0.8068 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 0.8802 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 0.6323 | Val  Acc: 0.9245
 Site-amazon                        | Val  Loss: 0.4023 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.5617 | Val  Acc: 0.9432
 Site-amazon                        | Val  Loss: 0.6682 | Val  Acc: 0.9035
 Site-amazon                        | Val  Loss: 0.5544 | Val  Acc: 0.9527
 Site-amazon                        | Val  Loss: 0.5974 | Val  Acc: 0.9634
 Site-webcam                        | Val  Loss: 0.9405 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.9149 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.7855 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.8999 | Val  Acc: 0.8545
 Site-webcam                        | Val  Loss: 0.8607 | Val  Acc: 0.8780
 Site-dslr                          | Val  Loss: 0.9811 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 0.6299 | Val  Acc: 0.9394
 Site-synthetic                     | Val  Loss: 2.2112 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8899
============ Train epoch 43 ============
 Site-amazon                        | Train Loss: 0.6968 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 0.5818 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 0.5779 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 0.6117 | Train Acc: 0.9344
 Site-amazon                        | Train Loss: 0.6701 | Train Acc: 0.9494
 Site-amazon                        | Train Loss: 0.5218 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 0.7728 | Train Acc: 0.9474
 Site-amazon                        | Train Loss: 0.5793 | Train Acc: 0.9651
 Site-amazon                        | Train Loss: 0.5851 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 0.5511 | Train Acc: 0.9547
 Site-webcam                        | Train Loss: 0.8678 | Train Acc: 0.9583
 Site-webcam                        | Train Loss: 0.9837 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 0.8332 | Train Acc: 0.8727
 Site-webcam                        | Train Loss: 0.7509 | Train Acc: 0.9277
 Site-webcam                        | Train Loss: 0.8776 | Train Acc: 0.9113
 Site-dslr                          | Train Loss: 0.9845 | Train Acc: 0.9000
 Site-dslr                          | Train Loss: 0.8032 | Train Acc: 0.9400
 Site-synthetic                     | Train Loss: 1.7695 | Train Acc: 0.5362
Average Train Accuracy: 0.9118
 Site-amazon                        | Val  Loss: 0.3706 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.5723 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 0.7191 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 0.8589 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 0.6286 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 0.4767 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.5229 | Val  Acc: 0.9886
 Site-amazon                        | Val  Loss: 0.6931 | Val  Acc: 0.9123
 Site-amazon                        | Val  Loss: 0.5546 | Val  Acc: 0.9459
 Site-amazon                        | Val  Loss: 0.5845 | Val  Acc: 0.9424
 Site-webcam                        | Val  Loss: 1.0484 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.8142 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 0.8384 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.9182 | Val  Acc: 0.8364
 Site-webcam                        | Val  Loss: 0.7968 | Val  Acc: 0.9390
 Site-dslr                          | Val  Loss: 0.9134 | Val  Acc: 0.8788
 Site-dslr                          | Val  Loss: 0.5865 | Val  Acc: 0.9091
 Site-synthetic                     | Val  Loss: 2.1699 | Val  Acc: 0.4348
Average Valid Accuracy: 0.8888
============ Train epoch 44 ============
 Site-amazon                        | Train Loss: 0.6764 | Train Acc: 0.9643
 Site-amazon                        | Train Loss: 0.5209 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 0.5247 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.5845 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 0.5655 | Train Acc: 0.9494
 Site-amazon                        | Train Loss: 0.5562 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 0.4385 | Train Acc: 0.9474
 Site-amazon                        | Train Loss: 0.5655 | Train Acc: 0.9360
 Site-amazon                        | Train Loss: 0.5714 | Train Acc: 0.9369
 Site-amazon                        | Train Loss: 0.5432 | Train Acc: 0.9617
 Site-webcam                        | Train Loss: 0.7699 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.0783 | Train Acc: 0.8108
 Site-webcam                        | Train Loss: 0.7909 | Train Acc: 0.8545
 Site-webcam                        | Train Loss: 0.8452 | Train Acc: 0.8916
 Site-webcam                        | Train Loss: 0.9152 | Train Acc: 0.8468
 Site-dslr                          | Train Loss: 0.9846 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 0.8905 | Train Acc: 0.8600
 Site-synthetic                     | Train Loss: 2.1906 | Train Acc: 0.5652
Average Train Accuracy: 0.8942
 Site-amazon                        | Val  Loss: 0.3626 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.5055 | Val  Acc: 0.9583
 Site-amazon                        | Val  Loss: 0.7101 | Val  Acc: 0.9032
 Site-amazon                        | Val  Loss: 0.8431 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 0.6355 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 0.3982 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.5819 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 0.6260 | Val  Acc: 0.9123
 Site-amazon                        | Val  Loss: 0.5188 | Val  Acc: 0.9527
 Site-amazon                        | Val  Loss: 0.5618 | Val  Acc: 0.9581
 Site-webcam                        | Val  Loss: 0.9298 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.7679 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 0.7284 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.8609 | Val  Acc: 0.9273
 Site-webcam                        | Val  Loss: 0.7833 | Val  Acc: 0.9268
 Site-dslr                          | Val  Loss: 0.8182 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 0.7756 | Val  Acc: 0.8636
 Site-synthetic                     | Val  Loss: 2.2311 | Val  Acc: 0.4348
Average Valid Accuracy: 0.9005
 Best site-amazon                    | Epoch:44 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9583
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9032
 Best site-amazon                    | Epoch:44 | Val Acc: 0.8537
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9434
 Best site-amazon                    | Epoch:44 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9545
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9123
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9527
 Best site-amazon                    | Epoch:44 | Val Acc: 0.9581
 Best site-webcam                    | Epoch:44 | Val Acc: 0.8750
 Best site-webcam                    | Epoch:44 | Val Acc: 0.9167
 Best site-webcam                    | Epoch:44 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:44 | Val Acc: 0.9273
 Best site-webcam                    | Epoch:44 | Val Acc: 0.9268
 Best site-dslr                      | Epoch:44 | Val Acc: 0.9091
 Best site-dslr                      | Epoch:44 | Val Acc: 0.8636
 Best site-synthetic                 | Epoch:44 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 45 ============
 Site-amazon                        | Train Loss: 0.6068 | Train Acc: 0.9643
 Site-amazon                        | Train Loss: 0.5628 | Train Acc: 0.9189
 Site-amazon                        | Train Loss: 0.5032 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 0.5597 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 0.5473 | Train Acc: 0.9620
 Site-amazon                        | Train Loss: 0.5181 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 0.6176 | Train Acc: 0.9549
 Site-amazon                        | Train Loss: 0.5365 | Train Acc: 0.9535
 Site-amazon                        | Train Loss: 0.5639 | Train Acc: 0.9234
 Site-amazon                        | Train Loss: 0.5265 | Train Acc: 0.9617
 Site-webcam                        | Train Loss: 0.8173 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 0.8348 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 0.7917 | Train Acc: 0.9091
 Site-webcam                        | Train Loss: 0.8136 | Train Acc: 0.9036
 Site-webcam                        | Train Loss: 0.8176 | Train Acc: 0.8790
 Site-dslr                          | Train Loss: 0.8902 | Train Acc: 0.9200
 Site-dslr                          | Train Loss: 0.7466 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 2.0348 | Train Acc: 0.5507
Average Train Accuracy: 0.9058
 Site-amazon                        | Val  Loss: 0.3637 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.4810 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 0.7273 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 0.7404 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 0.6957 | Val  Acc: 0.8868
 Site-amazon                        | Val  Loss: 0.5286 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.5179 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 0.5693 | Val  Acc: 0.9474
 Site-amazon                        | Val  Loss: 0.5292 | Val  Acc: 0.9392
 Site-amazon                        | Val  Loss: 0.5241 | Val  Acc: 0.9581
 Site-webcam                        | Val  Loss: 0.9391 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.7900 | Val  Acc: 0.9167
 Site-webcam                        | Val  Loss: 0.7134 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.9092 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 0.7875 | Val  Acc: 0.8902
 Site-dslr                          | Val  Loss: 0.8169 | Val  Acc: 0.9394
 Site-dslr                          | Val  Loss: 0.5320 | Val  Acc: 0.9242
 Site-synthetic                     | Val  Loss: 2.2146 | Val  Acc: 0.4130
Average Valid Accuracy: 0.8922
============ Train epoch 46 ============
 Site-amazon                        | Train Loss: 0.5124 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.5267 | Train Acc: 0.9459
 Site-amazon                        | Train Loss: 0.4995 | Train Acc: 0.9574
 Site-amazon                        | Train Loss: 0.5478 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 0.4611 | Train Acc: 0.9747
 Site-amazon                        | Train Loss: 0.4949 | Train Acc: 0.9515
 Site-amazon                        | Train Loss: 0.5936 | Train Acc: 0.9549
 Site-amazon                        | Train Loss: 0.5340 | Train Acc: 0.9709
 Site-amazon                        | Train Loss: 0.5142 | Train Acc: 0.9595
 Site-amazon                        | Train Loss: 0.5141 | Train Acc: 0.9477
 Site-webcam                        | Train Loss: 0.8168 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 0.8135 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 0.8192 | Train Acc: 0.9273
 Site-webcam                        | Train Loss: 0.9070 | Train Acc: 0.8916
 Site-webcam                        | Train Loss: 0.8171 | Train Acc: 0.9355
 Site-dslr                          | Train Loss: 0.9890 | Train Acc: 0.8600
 Site-dslr                          | Train Loss: 0.7478 | Train Acc: 0.9300
 Site-synthetic                     | Train Loss: 2.0224 | Train Acc: 0.5942
Average Train Accuracy: 0.9152
 Site-amazon                        | Val  Loss: 0.2655 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.4087 | Val  Acc: 0.9583
 Site-amazon                        | Val  Loss: 0.6132 | Val  Acc: 0.9355
 Site-amazon                        | Val  Loss: 0.7685 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 0.5730 | Val  Acc: 0.9623
 Site-amazon                        | Val  Loss: 0.3465 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.5069 | Val  Acc: 0.9432
 Site-amazon                        | Val  Loss: 0.5734 | Val  Acc: 0.9211
 Site-amazon                        | Val  Loss: 0.5047 | Val  Acc: 0.9527
 Site-amazon                        | Val  Loss: 0.5493 | Val  Acc: 0.9634
 Site-webcam                        | Val  Loss: 0.8710 | Val  Acc: 0.8125
 Site-webcam                        | Val  Loss: 0.8422 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.6610 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.8042 | Val  Acc: 0.9273
 Site-webcam                        | Val  Loss: 0.6422 | Val  Acc: 0.9268
 Site-dslr                          | Val  Loss: 0.8334 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 0.5954 | Val  Acc: 0.8788
 Site-synthetic                     | Val  Loss: 2.1462 | Val  Acc: 0.4783
Average Valid Accuracy: 0.9011
 Best site-amazon                    | Epoch:46 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:46 | Val Acc: 0.9583
 Best site-amazon                    | Epoch:46 | Val Acc: 0.9355
 Best site-amazon                    | Epoch:46 | Val Acc: 0.8293
 Best site-amazon                    | Epoch:46 | Val Acc: 0.9623
 Best site-amazon                    | Epoch:46 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:46 | Val Acc: 0.9432
 Best site-amazon                    | Epoch:46 | Val Acc: 0.9211
 Best site-amazon                    | Epoch:46 | Val Acc: 0.9527
 Best site-amazon                    | Epoch:46 | Val Acc: 0.9634
 Best site-webcam                    | Epoch:46 | Val Acc: 0.8125
 Best site-webcam                    | Epoch:46 | Val Acc: 0.8750
 Best site-webcam                    | Epoch:46 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:46 | Val Acc: 0.9273
 Best site-webcam                    | Epoch:46 | Val Acc: 0.9268
 Best site-dslr                      | Epoch:46 | Val Acc: 0.9091
 Best site-dslr                      | Epoch:46 | Val Acc: 0.8788
 Best site-synthetic                 | Epoch:46 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
============ Train epoch 47 ============
 Site-amazon                        | Train Loss: 0.7109 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 0.4720 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 0.4663 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 0.4984 | Train Acc: 0.9508
 Site-amazon                        | Train Loss: 0.4469 | Train Acc: 0.9620
 Site-amazon                        | Train Loss: 0.4893 | Train Acc: 0.9417
 Site-amazon                        | Train Loss: 0.4181 | Train Acc: 0.9549
 Site-amazon                        | Train Loss: 0.4807 | Train Acc: 0.9593
 Site-amazon                        | Train Loss: 0.5443 | Train Acc: 0.9414
 Site-amazon                        | Train Loss: 0.4967 | Train Acc: 0.9582
 Site-webcam                        | Train Loss: 0.7569 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 0.9309 | Train Acc: 0.8378
 Site-webcam                        | Train Loss: 0.7457 | Train Acc: 0.8909
 Site-webcam                        | Train Loss: 0.8037 | Train Acc: 0.9036
 Site-webcam                        | Train Loss: 0.7805 | Train Acc: 0.8710
 Site-dslr                          | Train Loss: 0.8580 | Train Acc: 0.9200
 Site-dslr                          | Train Loss: 0.7456 | Train Acc: 0.9300
 Site-synthetic                     | Train Loss: 2.2208 | Train Acc: 0.4928
Average Train Accuracy: 0.9038
 Site-amazon                        | Val  Loss: 0.3093 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.5374 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 0.6153 | Val  Acc: 0.9032
 Site-amazon                        | Val  Loss: 0.7328 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 0.5415 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 0.4149 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.4600 | Val  Acc: 0.9886
 Site-amazon                        | Val  Loss: 0.5606 | Val  Acc: 0.9298
 Site-amazon                        | Val  Loss: 0.4506 | Val  Acc: 0.9797
 Site-amazon                        | Val  Loss: 0.4812 | Val  Acc: 0.9738
 Site-webcam                        | Val  Loss: 0.7648 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.6498 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.8304 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.6864 | Val  Acc: 0.9091
 Site-webcam                        | Val  Loss: 0.8043 | Val  Acc: 0.8902
 Site-dslr                          | Val  Loss: 0.7186 | Val  Acc: 0.9394
 Site-dslr                          | Val  Loss: 0.6044 | Val  Acc: 0.8939
 Site-synthetic                     | Val  Loss: 2.2500 | Val  Acc: 0.3913
Average Valid Accuracy: 0.8967
============ Train epoch 48 ============
 Site-amazon                        | Train Loss: 0.5825 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.4792 | Train Acc: 0.9730
 Site-amazon                        | Train Loss: 0.4109 | Train Acc: 0.9787
 Site-amazon                        | Train Loss: 0.5172 | Train Acc: 0.8689
 Site-amazon                        | Train Loss: 0.4605 | Train Acc: 0.9747
 Site-amazon                        | Train Loss: 0.4606 | Train Acc: 0.9612
 Site-amazon                        | Train Loss: 0.5695 | Train Acc: 0.9323
 Site-amazon                        | Train Loss: 0.4985 | Train Acc: 0.9419
 Site-amazon                        | Train Loss: 0.4887 | Train Acc: 0.9550
 Site-amazon                        | Train Loss: 0.4739 | Train Acc: 0.9721
 Site-webcam                        | Train Loss: 0.7128 | Train Acc: 0.9583
 Site-webcam                        | Train Loss: 1.0264 | Train Acc: 0.7568
 Site-webcam                        | Train Loss: 0.7434 | Train Acc: 0.8909
 Site-webcam                        | Train Loss: 0.6975 | Train Acc: 0.9157
 Site-webcam                        | Train Loss: 0.7153 | Train Acc: 0.9435
 Site-dslr                          | Train Loss: 0.8562 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 0.7595 | Train Acc: 0.9200
 Site-synthetic                     | Train Loss: 2.0883 | Train Acc: 0.5507
Average Train Accuracy: 0.9096
 Site-amazon                        | Val  Loss: 0.2478 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.4234 | Val  Acc: 0.9167
 Site-amazon                        | Val  Loss: 0.6932 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 0.7017 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 0.5220 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 0.4691 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.4264 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.5370 | Val  Acc: 0.9211
 Site-amazon                        | Val  Loss: 0.4658 | Val  Acc: 0.9459
 Site-amazon                        | Val  Loss: 0.4582 | Val  Acc: 0.9634
 Site-webcam                        | Val  Loss: 0.9299 | Val  Acc: 0.7500
 Site-webcam                        | Val  Loss: 0.7793 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.7157 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 0.8665 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 0.6646 | Val  Acc: 0.9024
 Site-dslr                          | Val  Loss: 0.7362 | Val  Acc: 0.9697
 Site-dslr                          | Val  Loss: 0.6380 | Val  Acc: 0.9394
 Site-synthetic                     | Val  Loss: 2.1771 | Val  Acc: 0.4565
Average Valid Accuracy: 0.8931
============ Train epoch 49 ============
 Site-amazon                        | Train Loss: 0.5172 | Train Acc: 0.9286
 Site-amazon                        | Train Loss: 0.3976 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.4809 | Train Acc: 0.9362
 Site-amazon                        | Train Loss: 0.4411 | Train Acc: 0.9508
 Site-amazon                        | Train Loss: 0.4186 | Train Acc: 0.9747
 Site-amazon                        | Train Loss: 0.4689 | Train Acc: 0.9612
 Site-amazon                        | Train Loss: 0.6143 | Train Acc: 0.9323
 Site-amazon                        | Train Loss: 0.4747 | Train Acc: 0.9651
 Site-amazon                        | Train Loss: 0.4813 | Train Acc: 0.9640
 Site-amazon                        | Train Loss: 0.4491 | Train Acc: 0.9686
 Site-webcam                        | Train Loss: 0.7608 | Train Acc: 0.9167
 Site-webcam                        | Train Loss: 0.8510 | Train Acc: 0.8649
 Site-webcam                        | Train Loss: 0.6905 | Train Acc: 0.8727
 Site-webcam                        | Train Loss: 0.8408 | Train Acc: 0.8916
 Site-webcam                        | Train Loss: 0.8003 | Train Acc: 0.9032
 Site-dslr                          | Train Loss: 0.9355 | Train Acc: 0.8800
 Site-dslr                          | Train Loss: 0.7147 | Train Acc: 0.9000
 Site-synthetic                     | Train Loss: 1.6340 | Train Acc: 0.5797
Average Train Accuracy: 0.9106
 Site-amazon                        | Val  Loss: 0.2923 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.3482 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.6692 | Val  Acc: 0.9032
 Site-amazon                        | Val  Loss: 0.6261 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 0.5038 | Val  Acc: 0.9434
 Site-amazon                        | Val  Loss: 0.2921 | Val  Acc: 0.9853
 Site-amazon                        | Val  Loss: 0.4605 | Val  Acc: 0.9432
 Site-amazon                        | Val  Loss: 0.5436 | Val  Acc: 0.8947
 Site-amazon                        | Val  Loss: 0.4706 | Val  Acc: 0.9662
 Site-amazon                        | Val  Loss: 0.4595 | Val  Acc: 0.9738
 Site-webcam                        | Val  Loss: 0.9065 | Val  Acc: 0.9375
 Site-webcam                        | Val  Loss: 0.7404 | Val  Acc: 0.8750
 Site-webcam                        | Val  Loss: 0.6745 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 0.7328 | Val  Acc: 0.8909
 Site-webcam                        | Val  Loss: 0.6958 | Val  Acc: 0.9268
 Site-dslr                          | Val  Loss: 0.8003 | Val  Acc: 0.9091
 Site-dslr                          | Val  Loss: 0.5390 | Val  Acc: 0.9091
 Site-synthetic                     | Val  Loss: 2.1785 | Val  Acc: 0.4348
Average Valid Accuracy: 0.9064
 Best site-amazon                    | Epoch:49 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:49 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9032
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9024
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9434
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9853
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9432
 Best site-amazon                    | Epoch:49 | Val Acc: 0.8947
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9662
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9738
 Best site-webcam                    | Epoch:49 | Val Acc: 0.9375
 Best site-webcam                    | Epoch:49 | Val Acc: 0.8750
 Best site-webcam                    | Epoch:49 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:49 | Val Acc: 0.8909
 Best site-webcam                    | Epoch:49 | Val Acc: 0.9268
 Best site-dslr                      | Epoch:49 | Val Acc: 0.9091
 Best site-dslr                      | Epoch:49 | Val Acc: 0.9091
 Best site-synthetic                 | Epoch:49 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_modern_uneven_2.16_1/fedavg...
===2023-08-04 13:09:34===
===2023-08-04 13:09:51===
===Setting===
    dataset: modern
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[28,37,47,61,79,103,133,172,222,287,24,37,55,83,124,50,100,69,
client_nums=[10,5,2,1,]
len_dataset=[1959,544,251,116,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (2)| Epoch:49 | Test Acc: 0.9604
 Test site-webcam                    (2)| Epoch:49 | Test Acc: 0.9124
 Test site-dslr                      (3)| Epoch:49 | Test Acc: 0.8951
 Test site-synthetic                 (1)| Epoch:49 | Test Acc: 0.6065
amazon: 0.9604, webcam: 0.9124, dslr: 0.8951, synthetic: 0.6065, 
Average Test Accuracy(group): 0.8436, Average Test Accuracy(individual): 0.9201,
domain std=0.1390, cluster std=0.0452, individual std=0.0803, 
