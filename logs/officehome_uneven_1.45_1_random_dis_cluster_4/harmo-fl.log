===2023-08-03 19:26:39===
===Setting===
    dataset: officehome
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[150,260,450,148,444,409,282,
client_nums=[3,2,1,1,]
len_dataset=[1435,989,682,470,]
domain number = 4
============ Train epoch 0 ============
 Site-Art                           | Train Loss: 2.4671 | Train Acc: 0.7800
 Site-Art                           | Train Loss: 2.5523 | Train Acc: 0.5923
 Site-Art                           | Train Loss: 3.5648 | Train Acc: 0.1844
 Site-RealWorld                     | Train Loss: 2.8738 | Train Acc: 0.6554
 Site-RealWorld                     | Train Loss: 2.2671 | Train Acc: 0.8153
 Site-Clipart                       | Train Loss: 2.2860 | Train Acc: 0.7017
 Site-Product                       | Train Loss: 2.3907 | Train Acc: 0.7447
Average Train Accuracy: 0.6391
 Site-Art                           | Val  Loss: 3.5548 | Val  Acc: 0.2200
 Site-Art                           | Val  Loss: 3.5940 | Val  Acc: 0.2254
 Site-Art                           | Val  Loss: 3.5753 | Val  Acc: 0.1567
 Site-RealWorld                     | Val  Loss: 2.3012 | Val  Acc: 0.9082
 Site-RealWorld                     | Val  Loss: 2.4480 | Val  Acc: 0.7365
 Site-Clipart                       | Val  Loss: 2.7753 | Val  Acc: 0.5515
 Site-Product                       | Val  Loss: 1.9298 | Val  Acc: 0.9362
Average Valid Accuracy: 0.5335
 Best site-Art                       | Epoch:0 | Val Acc: 0.2200
 Best site-Art                       | Epoch:0 | Val Acc: 0.2254
 Best site-Art                       | Epoch:0 | Val Acc: 0.1567
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.9082
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.7365
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.5515
 Best site-Product                   | Epoch:0 | Val Acc: 0.9362
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 1 ============
 Site-Art                           | Train Loss: 1.4564 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 1.9589 | Train Acc: 0.6385
 Site-Art                           | Train Loss: 3.2034 | Train Acc: 0.2644
 Site-RealWorld                     | Train Loss: 1.8464 | Train Acc: 0.7770
 Site-RealWorld                     | Train Loss: 1.2177 | Train Acc: 0.8581
 Site-Clipart                       | Train Loss: 1.3840 | Train Acc: 0.7213
 Site-Product                       | Train Loss: 1.3452 | Train Acc: 0.8369
Average Train Accuracy: 0.7090
 Site-Art                           | Val  Loss: 3.1829 | Val  Acc: 0.2400
 Site-Art                           | Val  Loss: 3.2159 | Val  Acc: 0.2890
 Site-Art                           | Val  Loss: 3.1947 | Val  Acc: 0.2133
 Site-RealWorld                     | Val  Loss: 1.0133 | Val  Acc: 0.9388
 Site-RealWorld                     | Val  Loss: 1.5220 | Val  Acc: 0.7736
 Site-Clipart                       | Val  Loss: 2.1803 | Val  Acc: 0.5625
 Site-Product                       | Val  Loss: 0.8616 | Val  Acc: 0.9309
Average Valid Accuracy: 0.5640
 Best site-Art                       | Epoch:1 | Val Acc: 0.2400
 Best site-Art                       | Epoch:1 | Val Acc: 0.2890
 Best site-Art                       | Epoch:1 | Val Acc: 0.2133
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.9388
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.7736
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5625
 Best site-Product                   | Epoch:1 | Val Acc: 0.9309
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 2 ============
 Site-Art                           | Train Loss: 0.9903 | Train Acc: 0.8600
 Site-Art                           | Train Loss: 1.5947 | Train Acc: 0.6654
 Site-Art                           | Train Loss: 2.8979 | Train Acc: 0.3533
 Site-RealWorld                     | Train Loss: 1.1536 | Train Acc: 0.8649
 Site-RealWorld                     | Train Loss: 0.7719 | Train Acc: 0.8761
 Site-Clipart                       | Train Loss: 1.0176 | Train Acc: 0.7824
 Site-Product                       | Train Loss: 0.9007 | Train Acc: 0.8972
Average Train Accuracy: 0.7570
 Site-Art                           | Val  Loss: 2.7892 | Val  Acc: 0.3800
 Site-Art                           | Val  Loss: 2.8396 | Val  Acc: 0.4393
 Site-Art                           | Val  Loss: 2.8112 | Val  Acc: 0.2867
 Site-RealWorld                     | Val  Loss: 0.5195 | Val  Acc: 0.9490
 Site-RealWorld                     | Val  Loss: 1.0557 | Val  Acc: 0.8209
 Site-Clipart                       | Val  Loss: 1.8773 | Val  Acc: 0.6250
 Site-Product                       | Val  Loss: 0.5556 | Val  Acc: 0.9362
Average Valid Accuracy: 0.6339
 Best site-Art                       | Epoch:2 | Val Acc: 0.3800
 Best site-Art                       | Epoch:2 | Val Acc: 0.4393
 Best site-Art                       | Epoch:2 | Val Acc: 0.2867
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9490
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.8209
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6250
 Best site-Product                   | Epoch:2 | Val Acc: 0.9362
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 3 ============
 Site-Art                           | Train Loss: 0.6731 | Train Acc: 0.8933
 Site-Art                           | Train Loss: 1.3287 | Train Acc: 0.7269
 Site-Art                           | Train Loss: 2.4366 | Train Acc: 0.4800
 Site-RealWorld                     | Train Loss: 0.6942 | Train Acc: 0.8919
 Site-RealWorld                     | Train Loss: 0.5280 | Train Acc: 0.9234
 Site-Clipart                       | Train Loss: 0.7993 | Train Acc: 0.8289
 Site-Product                       | Train Loss: 0.5664 | Train Acc: 0.9326
Average Train Accuracy: 0.8110
 Site-Art                           | Val  Loss: 2.4520 | Val  Acc: 0.5500
 Site-Art                           | Val  Loss: 2.4377 | Val  Acc: 0.5318
 Site-Art                           | Val  Loss: 2.3951 | Val  Acc: 0.4133
 Site-RealWorld                     | Val  Loss: 0.3344 | Val  Acc: 0.9490
 Site-RealWorld                     | Val  Loss: 0.7762 | Val  Acc: 0.8885
 Site-Clipart                       | Val  Loss: 1.6202 | Val  Acc: 0.6875
 Site-Product                       | Val  Loss: 0.4004 | Val  Acc: 0.9521
Average Valid Accuracy: 0.7103
 Best site-Art                       | Epoch:3 | Val Acc: 0.5500
 Best site-Art                       | Epoch:3 | Val Acc: 0.5318
 Best site-Art                       | Epoch:3 | Val Acc: 0.4133
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9490
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.8885
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.6875
 Best site-Product                   | Epoch:3 | Val Acc: 0.9521
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 4 ============
 Site-Art                           | Train Loss: 0.5619 | Train Acc: 0.8933
 Site-Art                           | Train Loss: 0.9246 | Train Acc: 0.7923
 Site-Art                           | Train Loss: 2.1166 | Train Acc: 0.5778
 Site-RealWorld                     | Train Loss: 0.5423 | Train Acc: 0.9257
 Site-RealWorld                     | Train Loss: 0.4294 | Train Acc: 0.9505
 Site-Clipart                       | Train Loss: 0.6629 | Train Acc: 0.8655
 Site-Product                       | Train Loss: 0.4222 | Train Acc: 0.9574
Average Train Accuracy: 0.8518
 Site-Art                           | Val  Loss: 2.1300 | Val  Acc: 0.6300
 Site-Art                           | Val  Loss: 2.1994 | Val  Acc: 0.6301
 Site-Art                           | Val  Loss: 2.1038 | Val  Acc: 0.5567
 Site-RealWorld                     | Val  Loss: 0.2557 | Val  Acc: 0.9490
 Site-RealWorld                     | Val  Loss: 0.5988 | Val  Acc: 0.9223
 Site-Clipart                       | Val  Loss: 1.4509 | Val  Acc: 0.6801
 Site-Product                       | Val  Loss: 0.3746 | Val  Acc: 0.9415
Average Valid Accuracy: 0.7585
 Best site-Art                       | Epoch:4 | Val Acc: 0.6300
 Best site-Art                       | Epoch:4 | Val Acc: 0.6301
 Best site-Art                       | Epoch:4 | Val Acc: 0.5567
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.9490
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.9223
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.6801
 Best site-Product                   | Epoch:4 | Val Acc: 0.9415
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 5 ============
 Site-Art                           | Train Loss: 0.5083 | Train Acc: 0.9200
 Site-Art                           | Train Loss: 1.2420 | Train Acc: 0.8077
 Site-Art                           | Train Loss: 1.8986 | Train Acc: 0.6467
 Site-RealWorld                     | Train Loss: 0.4555 | Train Acc: 0.9527
 Site-RealWorld                     | Train Loss: 0.3394 | Train Acc: 0.9617
 Site-Clipart                       | Train Loss: 0.6046 | Train Acc: 0.8778
 Site-Product                       | Train Loss: 0.3619 | Train Acc: 0.9645
Average Train Accuracy: 0.8759
 Site-Art                           | Val  Loss: 1.8424 | Val  Acc: 0.7200
 Site-Art                           | Val  Loss: 1.9089 | Val  Acc: 0.6532
 Site-Art                           | Val  Loss: 1.8953 | Val  Acc: 0.5933
 Site-RealWorld                     | Val  Loss: 0.2117 | Val  Acc: 0.9694
 Site-RealWorld                     | Val  Loss: 0.4954 | Val  Acc: 0.9493
 Site-Clipart                       | Val  Loss: 1.4381 | Val  Acc: 0.6801
 Site-Product                       | Val  Loss: 0.2964 | Val  Acc: 0.9574
Average Valid Accuracy: 0.7890
 Best site-Art                       | Epoch:5 | Val Acc: 0.7200
 Best site-Art                       | Epoch:5 | Val Acc: 0.6532
 Best site-Art                       | Epoch:5 | Val Acc: 0.5933
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9694
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9493
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.6801
 Best site-Product                   | Epoch:5 | Val Acc: 0.9574
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 6 ============
 Site-Art                           | Train Loss: 0.5465 | Train Acc: 0.9200
 Site-Art                           | Train Loss: 0.8669 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.8661 | Train Acc: 0.6578
 Site-RealWorld                     | Train Loss: 0.3363 | Train Acc: 0.9527
 Site-RealWorld                     | Train Loss: 0.2898 | Train Acc: 0.9662
 Site-Clipart                       | Train Loss: 0.5457 | Train Acc: 0.9071
 Site-Product                       | Train Loss: 0.3156 | Train Acc: 0.9681
Average Train Accuracy: 0.8817
 Site-Art                           | Val  Loss: 1.7558 | Val  Acc: 0.7000
 Site-Art                           | Val  Loss: 1.8578 | Val  Acc: 0.6821
 Site-Art                           | Val  Loss: 1.8251 | Val  Acc: 0.6233
 Site-RealWorld                     | Val  Loss: 0.1369 | Val  Acc: 0.9694
 Site-RealWorld                     | Val  Loss: 0.4611 | Val  Acc: 0.9291
 Site-Clipart                       | Val  Loss: 1.3819 | Val  Acc: 0.7059
 Site-Product                       | Val  Loss: 0.2641 | Val  Acc: 0.9628
Average Valid Accuracy: 0.7961
 Best site-Art                       | Epoch:6 | Val Acc: 0.7000
 Best site-Art                       | Epoch:6 | Val Acc: 0.6821
 Best site-Art                       | Epoch:6 | Val Acc: 0.6233
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9694
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9291
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7059
 Best site-Product                   | Epoch:6 | Val Acc: 0.9628
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 7 ============
 Site-Art                           | Train Loss: 0.4579 | Train Acc: 0.9000
 Site-Art                           | Train Loss: 0.8070 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.6220 | Train Acc: 0.6733
 Site-RealWorld                     | Train Loss: 0.3276 | Train Acc: 0.9595
 Site-RealWorld                     | Train Loss: 0.2443 | Train Acc: 0.9640
 Site-Clipart                       | Train Loss: 0.5382 | Train Acc: 0.8900
 Site-Product                       | Train Loss: 0.2666 | Train Acc: 0.9681
Average Train Accuracy: 0.8793
 Site-Art                           | Val  Loss: 1.5045 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 1.6728 | Val  Acc: 0.6879
 Site-Art                           | Val  Loss: 1.6921 | Val  Acc: 0.6367
 Site-RealWorld                     | Val  Loss: 0.1375 | Val  Acc: 0.9796
 Site-RealWorld                     | Val  Loss: 0.3821 | Val  Acc: 0.9662
 Site-Clipart                       | Val  Loss: 1.3104 | Val  Acc: 0.7574
 Site-Product                       | Val  Loss: 0.2679 | Val  Acc: 0.9681
Average Valid Accuracy: 0.8208
 Best site-Art                       | Epoch:7 | Val Acc: 0.7500
 Best site-Art                       | Epoch:7 | Val Acc: 0.6879
 Best site-Art                       | Epoch:7 | Val Acc: 0.6367
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9796
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9662
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7574
 Best site-Product                   | Epoch:7 | Val Acc: 0.9681
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 8 ============
 Site-Art                           | Train Loss: 0.4737 | Train Acc: 0.9067
 Site-Art                           | Train Loss: 0.9692 | Train Acc: 0.8538
 Site-Art                           | Train Loss: 1.3925 | Train Acc: 0.7244
 Site-RealWorld                     | Train Loss: 0.2709 | Train Acc: 0.9662
 Site-RealWorld                     | Train Loss: 0.2336 | Train Acc: 0.9797
 Site-Clipart                       | Train Loss: 0.4865 | Train Acc: 0.8998
 Site-Product                       | Train Loss: 0.2344 | Train Acc: 0.9645
Average Train Accuracy: 0.8993
 Site-Art                           | Val  Loss: 1.4876 | Val  Acc: 0.7300
 Site-Art                           | Val  Loss: 1.5893 | Val  Acc: 0.7283
 Site-Art                           | Val  Loss: 1.5895 | Val  Acc: 0.6600
 Site-RealWorld                     | Val  Loss: 0.1194 | Val  Acc: 0.9694
 Site-RealWorld                     | Val  Loss: 0.3486 | Val  Acc: 0.9696
 Site-Clipart                       | Val  Loss: 1.2496 | Val  Acc: 0.7684
 Site-Product                       | Val  Loss: 0.2363 | Val  Acc: 0.9415
Average Valid Accuracy: 0.8239
 Best site-Art                       | Epoch:8 | Val Acc: 0.7300
 Best site-Art                       | Epoch:8 | Val Acc: 0.7283
 Best site-Art                       | Epoch:8 | Val Acc: 0.6600
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9694
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9696
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7684
 Best site-Product                   | Epoch:8 | Val Acc: 0.9415
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 9 ============
 Site-Art                           | Train Loss: 0.4077 | Train Acc: 0.9200
 Site-Art                           | Train Loss: 0.7373 | Train Acc: 0.8346
 Site-Art                           | Train Loss: 1.3473 | Train Acc: 0.7356
 Site-RealWorld                     | Train Loss: 0.2436 | Train Acc: 0.9662
 Site-RealWorld                     | Train Loss: 0.2039 | Train Acc: 0.9730
 Site-Clipart                       | Train Loss: 0.4332 | Train Acc: 0.9071
 Site-Product                       | Train Loss: 0.2167 | Train Acc: 0.9716
Average Train Accuracy: 0.9012
 Site-Art                           | Val  Loss: 1.3821 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 1.4132 | Val  Acc: 0.7341
 Site-Art                           | Val  Loss: 1.4298 | Val  Acc: 0.7367
 Site-RealWorld                     | Val  Loss: 0.1716 | Val  Acc: 0.9796
 Site-RealWorld                     | Val  Loss: 0.3141 | Val  Acc: 0.9797
 Site-Clipart                       | Val  Loss: 1.2264 | Val  Acc: 0.6949
 Site-Product                       | Val  Loss: 0.2563 | Val  Acc: 0.9628
Average Valid Accuracy: 0.8340
 Best site-Art                       | Epoch:9 | Val Acc: 0.7500
 Best site-Art                       | Epoch:9 | Val Acc: 0.7341
 Best site-Art                       | Epoch:9 | Val Acc: 0.7367
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9796
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9797
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.6949
 Best site-Product                   | Epoch:9 | Val Acc: 0.9628
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 10 ============
 Site-Art                           | Train Loss: 0.4265 | Train Acc: 0.9133
 Site-Art                           | Train Loss: 0.8529 | Train Acc: 0.8692
 Site-Art                           | Train Loss: 1.3339 | Train Acc: 0.7756
 Site-RealWorld                     | Train Loss: 0.2240 | Train Acc: 0.9797
 Site-RealWorld                     | Train Loss: 0.1882 | Train Acc: 0.9865
 Site-Clipart                       | Train Loss: 0.4362 | Train Acc: 0.9169
 Site-Product                       | Train Loss: 0.2288 | Train Acc: 0.9716
Average Train Accuracy: 0.9161
 Site-Art                           | Val  Loss: 1.2406 | Val  Acc: 0.7800
 Site-Art                           | Val  Loss: 1.3336 | Val  Acc: 0.7861
 Site-Art                           | Val  Loss: 1.3270 | Val  Acc: 0.7533
 Site-RealWorld                     | Val  Loss: 0.0683 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3156 | Val  Acc: 0.9527
 Site-Clipart                       | Val  Loss: 1.2762 | Val  Acc: 0.7463
 Site-Product                       | Val  Loss: 0.2169 | Val  Acc: 0.9628
Average Valid Accuracy: 0.8545
 Best site-Art                       | Epoch:10 | Val Acc: 0.7800
 Best site-Art                       | Epoch:10 | Val Acc: 0.7861
 Best site-Art                       | Epoch:10 | Val Acc: 0.7533
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9527
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.7463
 Best site-Product                   | Epoch:10 | Val Acc: 0.9628
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_1.45_1/harmo-fl...
============ Train epoch 11 ============
