===2023-08-12 17:45:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 5, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (1) | Train Loss: 1.6235 | Train Acc: 0.6578
 Site-MNIST                     (1) | Train Loss: 1.5961 | Train Acc: 0.6982
 Site-MNIST                     (1) | Train Loss: 1.6599 | Train Acc: 0.6213
 Site-MNIST                     (1) | Train Loss: 1.6277 | Train Acc: 0.6321
 Site-MNIST                     (1) | Train Loss: 1.6288 | Train Acc: 0.6515
 Site-USPS                      (0) | Train Loss: 1.6180 | Train Acc: 0.7194
 Site-USPS                      (5) | Train Loss: 1.6205 | Train Acc: 0.7364
 Site-USPS                      (0) | Train Loss: 1.6168 | Train Acc: 0.7061
 Site-SynthDigits               (3) | Train Loss: 2.0876 | Train Acc: 0.2538
 Site-SynthDigits               (3) | Train Loss: 2.0605 | Train Acc: 0.2828
 Site-MNIST_M                   (2) | Train Loss: 2.2041 | Train Acc: 0.1903
 Site-MNIST_M                   (6) | Train Loss: 2.1899 | Train Acc: 0.2292
 Site-SVHN                      (4) | Train Loss: 2.1919 | Train Acc: 0.2164
Average Train Accuracy: 0.5073
 Site-MNIST                     (1) | Val  Loss: 1.7304 | Val  Acc: 0.6429
 Site-MNIST                     (1) | Val  Loss: 1.7310 | Val  Acc: 0.6429
 Site-MNIST                     (1) | Val  Loss: 1.5776 | Val  Acc: 0.7302
 Site-MNIST                     (1) | Val  Loss: 1.6214 | Val  Acc: 0.6579
 Site-MNIST                     (1) | Val  Loss: 1.6194 | Val  Acc: 0.6772
 Site-USPS                      (0) | Val  Loss: 1.6432 | Val  Acc: 0.7404
 Site-USPS                      (5) | Val  Loss: 1.6616 | Val  Acc: 0.6987
 Site-USPS                      (0) | Val  Loss: 1.5938 | Val  Acc: 0.6966
 Site-SynthDigits               (3) | Val  Loss: 2.2191 | Val  Acc: 0.2273
 Site-SynthDigits               (3) | Val  Loss: 2.0671 | Val  Acc: 0.2525
 Site-MNIST_M                   (2) | Val  Loss: 2.1321 | Val  Acc: 0.2159
 Site-MNIST_M                   (6) | Val  Loss: 2.1630 | Val  Acc: 0.1818
 Site-SVHN                      (4) | Val  Loss: 2.2067 | Val  Acc: 0.2671
Average Valid Accuracy: 0.5101
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6429
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6429
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.7302
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6579
 Best site-MNIST                    (1)  | Epoch:0 | Val Acc: 0.6772
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.7404
 Best site-USPS                     (5)  | Epoch:0 | Val Acc: 0.6987
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.6966
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2273
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2525
 Best site-MNIST_M                  (2)  | Epoch:0 | Val Acc: 0.2159
 Best site-MNIST_M                  (6)  | Epoch:0 | Val Acc: 0.1818
 Best site-SVHN                     (4)  | Epoch:0 | Val Acc: 0.2671
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 1, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.1623 | Train Acc: 0.7867
 Site-MNIST                     (0) | Train Loss: 1.1262 | Train Acc: 0.8136
 Site-MNIST                     (0) | Train Loss: 1.2361 | Train Acc: 0.7436
 Site-MNIST                     (0) | Train Loss: 1.1872 | Train Acc: 0.7556
 Site-MNIST                     (0) | Train Loss: 1.1797 | Train Acc: 0.7601
 Site-USPS                      (3) | Train Loss: 1.1236 | Train Acc: 0.7842
 Site-USPS                      (3) | Train Loss: 1.1357 | Train Acc: 0.7812
 Site-USPS                      (3) | Train Loss: 1.1303 | Train Acc: 0.7753
 Site-SynthDigits               (2) | Train Loss: 1.8597 | Train Acc: 0.3333
 Site-SynthDigits               (5) | Train Loss: 1.8423 | Train Acc: 0.3308
 Site-MNIST_M                   (6) | Train Loss: 2.0541 | Train Acc: 0.2841
 Site-MNIST_M                   (1) | Train Loss: 2.0524 | Train Acc: 0.2955
 Site-SVHN                      (4) | Train Loss: 2.0958 | Train Acc: 0.2658
Average Train Accuracy: 0.5930
 Site-MNIST                     (0) | Val  Loss: 1.2749 | Val  Acc: 0.7857
 Site-MNIST                     (0) | Val  Loss: 1.2684 | Val  Acc: 0.7976
 Site-MNIST                     (0) | Val  Loss: 1.1457 | Val  Acc: 0.8175
 Site-MNIST                     (0) | Val  Loss: 1.2124 | Val  Acc: 0.7789
 Site-MNIST                     (0) | Val  Loss: 1.1835 | Val  Acc: 0.8000
 Site-USPS                      (3) | Val  Loss: 1.1541 | Val  Acc: 0.7692
 Site-USPS                      (3) | Val  Loss: 1.2029 | Val  Acc: 0.7372
 Site-USPS                      (3) | Val  Loss: 1.1219 | Val  Acc: 0.7778
 Site-SynthDigits               (2) | Val  Loss: 2.0891 | Val  Acc: 0.3409
 Site-SynthDigits               (5) | Val  Loss: 1.8143 | Val  Acc: 0.3384
 Site-MNIST_M                   (6) | Val  Loss: 1.9216 | Val  Acc: 0.3864
 Site-MNIST_M                   (1) | Val  Loss: 2.0401 | Val  Acc: 0.2500
 Site-SVHN                      (4) | Val  Loss: 2.1116 | Val  Acc: 0.2945
Average Valid Accuracy: 0.6057
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7857
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7976
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.8175
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7789
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.8000
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7692
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7372
 Best site-USPS                     (3)  | Epoch:1 | Val Acc: 0.7778
 Best site-SynthDigits              (2)  | Epoch:1 | Val Acc: 0.3409
 Best site-SynthDigits              (5)  | Epoch:1 | Val Acc: 0.3384
 Best site-MNIST_M                  (6)  | Epoch:1 | Val Acc: 0.3864
 Best site-MNIST_M                  (1)  | Epoch:1 | Val Acc: 0.2500
 Best site-SVHN                     (4)  | Epoch:1 | Val Acc: 0.2945
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 1, 1, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (0) | Train Loss: 1.0257 | Train Acc: 0.7822
 Site-MNIST                     (0) | Train Loss: 0.9944 | Train Acc: 0.7988
 Site-MNIST                     (0) | Train Loss: 1.0788 | Train Acc: 0.7554
 Site-MNIST                     (0) | Train Loss: 1.0246 | Train Acc: 0.7687
 Site-MNIST                     (0) | Train Loss: 1.0169 | Train Acc: 0.7767
 Site-USPS                      (4) | Train Loss: 0.9309 | Train Acc: 0.7938
 Site-USPS                      (6) | Train Loss: 0.9484 | Train Acc: 0.7939
 Site-USPS                      (6) | Train Loss: 0.9411 | Train Acc: 0.8030
 Site-SynthDigits               (5) | Train Loss: 1.6721 | Train Acc: 0.4205
 Site-SynthDigits               (2) | Train Loss: 1.6248 | Train Acc: 0.4306
 Site-MNIST_M                   (3) | Train Loss: 1.8881 | Train Acc: 0.3438
 Site-MNIST_M                   (3) | Train Loss: 1.8816 | Train Acc: 0.3826
 Site-SVHN                      (1) | Train Loss: 2.0043 | Train Acc: 0.2981
Average Train Accuracy: 0.6268
 Site-MNIST                     (0) | Val  Loss: 1.1019 | Val  Acc: 0.8036
 Site-MNIST                     (0) | Val  Loss: 1.0923 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.9774 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 1.0641 | Val  Acc: 0.7526
 Site-MNIST                     (0) | Val  Loss: 1.0297 | Val  Acc: 0.7860
 Site-USPS                      (4) | Val  Loss: 0.9671 | Val  Acc: 0.7692
 Site-USPS                      (6) | Val  Loss: 1.0196 | Val  Acc: 0.7436
 Site-USPS                      (6) | Val  Loss: 0.9410 | Val  Acc: 0.8034
 Site-SynthDigits               (5) | Val  Loss: 1.9154 | Val  Acc: 0.4545
 Site-SynthDigits               (2) | Val  Loss: 1.6084 | Val  Acc: 0.4091
 Site-MNIST_M                   (3) | Val  Loss: 1.7623 | Val  Acc: 0.3977
 Site-MNIST_M                   (3) | Val  Loss: 1.9141 | Val  Acc: 0.3030
 Site-SVHN                      (1) | Val  Loss: 2.0182 | Val  Acc: 0.2877
Average Valid Accuracy: 0.6308
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8036
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7526
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7860
 Best site-USPS                     (4)  | Epoch:2 | Val Acc: 0.7692
 Best site-USPS                     (6)  | Epoch:2 | Val Acc: 0.7436
 Best site-USPS                     (6)  | Epoch:2 | Val Acc: 0.8034
 Best site-SynthDigits              (5)  | Epoch:2 | Val Acc: 0.4545
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4091
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.3977
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.3030
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.2877
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 5, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (1) | Train Loss: 0.9024 | Train Acc: 0.7911
 Site-MNIST                     (1) | Train Loss: 0.9148 | Train Acc: 0.8314
 Site-MNIST                     (1) | Train Loss: 0.9730 | Train Acc: 0.7791
 Site-MNIST                     (1) | Train Loss: 0.9228 | Train Acc: 0.7989
 Site-MNIST                     (1) | Train Loss: 0.9170 | Train Acc: 0.7872
 Site-USPS                      (6) | Train Loss: 0.8170 | Train Acc: 0.8225
 Site-USPS                      (3) | Train Loss: 0.8218 | Train Acc: 0.8131
 Site-USPS                      (3) | Train Loss: 0.8179 | Train Acc: 0.8349
 Site-SynthDigits               (0) | Train Loss: 1.5470 | Train Acc: 0.4735
 Site-SynthDigits               (0) | Train Loss: 1.4708 | Train Acc: 0.5063
 Site-MNIST_M                   (2) | Train Loss: 1.7767 | Train Acc: 0.3892
 Site-MNIST_M                   (5) | Train Loss: 1.7771 | Train Acc: 0.4034
 Site-SVHN                      (4) | Train Loss: 1.9218 | Train Acc: 0.3578
Average Train Accuracy: 0.6607
 Site-MNIST                     (1) | Val  Loss: 1.0026 | Val  Acc: 0.7857
 Site-MNIST                     (1) | Val  Loss: 0.9802 | Val  Acc: 0.8214
 Site-MNIST                     (1) | Val  Loss: 0.8740 | Val  Acc: 0.8095
 Site-MNIST                     (1) | Val  Loss: 0.9589 | Val  Acc: 0.8105
 Site-MNIST                     (1) | Val  Loss: 0.9287 | Val  Acc: 0.8211
 Site-USPS                      (6) | Val  Loss: 0.8351 | Val  Acc: 0.8365
 Site-USPS                      (3) | Val  Loss: 0.8904 | Val  Acc: 0.7821
 Site-USPS                      (3) | Val  Loss: 0.8263 | Val  Acc: 0.8120
 Site-SynthDigits               (0) | Val  Loss: 1.7517 | Val  Acc: 0.5000
 Site-SynthDigits               (0) | Val  Loss: 1.4608 | Val  Acc: 0.4899
 Site-MNIST_M                   (2) | Val  Loss: 1.6416 | Val  Acc: 0.4659
 Site-MNIST_M                   (5) | Val  Loss: 1.7915 | Val  Acc: 0.3636
 Site-SVHN                      (4) | Val  Loss: 1.9215 | Val  Acc: 0.3288
Average Valid Accuracy: 0.6636
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.7857
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8214
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8095
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8105
 Best site-MNIST                    (1)  | Epoch:3 | Val Acc: 0.8211
 Best site-USPS                     (6)  | Epoch:3 | Val Acc: 0.8365
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.7821
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.8120
 Best site-SynthDigits              (0)  | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits              (0)  | Epoch:3 | Val Acc: 0.4899
 Best site-MNIST_M                  (2)  | Epoch:3 | Val Acc: 0.4659
 Best site-MNIST_M                  (5)  | Epoch:3 | Val Acc: 0.3636
 Best site-SVHN                     (4)  | Epoch:3 | Val Acc: 0.3288
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 1, 2, 2, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (4) | Train Loss: 0.7930 | Train Acc: 0.8400
 Site-MNIST                     (4) | Train Loss: 0.7580 | Train Acc: 0.8521
 Site-MNIST                     (6) | Train Loss: 0.8304 | Train Acc: 0.8166
 Site-MNIST                     (4) | Train Loss: 0.7926 | Train Acc: 0.8384
 Site-MNIST                     (4) | Train Loss: 0.7778 | Train Acc: 0.8327
 Site-USPS                      (0) | Train Loss: 0.7377 | Train Acc: 0.8321
 Site-USPS                      (5) | Train Loss: 0.7522 | Train Acc: 0.8179
 Site-USPS                      (0) | Train Loss: 0.7502 | Train Acc: 0.8349
 Site-SynthDigits               (2) | Train Loss: 1.4284 | Train Acc: 0.5303
 Site-SynthDigits               (2) | Train Loss: 1.3413 | Train Acc: 0.5644
 Site-MNIST_M                   (3) | Train Loss: 1.6941 | Train Acc: 0.4375
 Site-MNIST_M                   (3) | Train Loss: 1.6971 | Train Acc: 0.4451
 Site-SVHN                      (1) | Train Loss: 1.8267 | Train Acc: 0.3629
Average Train Accuracy: 0.6927
 Site-MNIST                     (4) | Val  Loss: 0.8339 | Val  Acc: 0.8393
 Site-MNIST                     (4) | Val  Loss: 0.8112 | Val  Acc: 0.8690
 Site-MNIST                     (6) | Val  Loss: 0.7445 | Val  Acc: 0.8413
 Site-MNIST                     (4) | Val  Loss: 0.8326 | Val  Acc: 0.8211
 Site-MNIST                     (4) | Val  Loss: 0.7973 | Val  Acc: 0.8421
 Site-USPS                      (0) | Val  Loss: 0.7521 | Val  Acc: 0.8173
 Site-USPS                      (5) | Val  Loss: 0.8125 | Val  Acc: 0.7692
 Site-USPS                      (0) | Val  Loss: 0.7607 | Val  Acc: 0.8291
 Site-SynthDigits               (2) | Val  Loss: 1.6704 | Val  Acc: 0.5227
 Site-SynthDigits               (2) | Val  Loss: 1.3397 | Val  Acc: 0.5606
 Site-MNIST_M                   (3) | Val  Loss: 1.5636 | Val  Acc: 0.4659
 Site-MNIST_M                   (3) | Val  Loss: 1.7151 | Val  Acc: 0.4242
 Site-SVHN                      (1) | Val  Loss: 1.8544 | Val  Acc: 0.3699
Average Valid Accuracy: 0.6901
 Best site-MNIST                    (4)  | Epoch:4 | Val Acc: 0.8393
 Best site-MNIST                    (4)  | Epoch:4 | Val Acc: 0.8690
 Best site-MNIST                    (6)  | Epoch:4 | Val Acc: 0.8413
 Best site-MNIST                    (4)  | Epoch:4 | Val Acc: 0.8211
 Best site-MNIST                    (4)  | Epoch:4 | Val Acc: 0.8421
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8173
 Best site-USPS                     (5)  | Epoch:4 | Val Acc: 0.7692
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8291
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5227
 Best site-SynthDigits              (2)  | Epoch:4 | Val Acc: 0.5606
 Best site-MNIST_M                  (3)  | Epoch:4 | Val Acc: 0.4659
 Best site-MNIST_M                  (3)  | Epoch:4 | Val Acc: 0.4242
 Best site-SVHN                     (1)  | Epoch:4 | Val Acc: 0.3699
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 5 ============
cnt=[4, 1, 2, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 0.7651 | Train Acc: 0.8356
 Site-MNIST                     (0) | Train Loss: 0.7154 | Train Acc: 0.8580
 Site-MNIST                     (0) | Train Loss: 0.7932 | Train Acc: 0.8028
 Site-MNIST                     (5) | Train Loss: 0.7547 | Train Acc: 0.8265
 Site-MNIST                     (0) | Train Loss: 0.7439 | Train Acc: 0.8231
 Site-USPS                      (4) | Train Loss: 0.7089 | Train Acc: 0.8393
 Site-USPS                      (4) | Train Loss: 0.7090 | Train Acc: 0.8387
 Site-USPS                      (4) | Train Loss: 0.7137 | Train Acc: 0.8424
 Site-SynthDigits               (2) | Train Loss: 1.3070 | Train Acc: 0.5966
 Site-SynthDigits               (2) | Train Loss: 1.2332 | Train Acc: 0.6275
 Site-MNIST_M                   (3) | Train Loss: 1.5808 | Train Acc: 0.4943
 Site-MNIST_M                   (6) | Train Loss: 1.6266 | Train Acc: 0.4905
 Site-SVHN                      (1) | Train Loss: 1.7720 | Train Acc: 0.3969
Average Train Accuracy: 0.7132
 Site-MNIST                     (0) | Val  Loss: 0.7903 | Val  Acc: 0.8214
 Site-MNIST                     (0) | Val  Loss: 0.7672 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 0.7097 | Val  Acc: 0.8333
 Site-MNIST                     (5) | Val  Loss: 0.8024 | Val  Acc: 0.8368
 Site-MNIST                     (0) | Val  Loss: 0.7595 | Val  Acc: 0.8526
 Site-USPS                      (4) | Val  Loss: 0.7084 | Val  Acc: 0.8462
 Site-USPS                      (4) | Val  Loss: 0.7660 | Val  Acc: 0.8077
 Site-USPS                      (4) | Val  Loss: 0.7235 | Val  Acc: 0.8376
 Site-SynthDigits               (2) | Val  Loss: 1.5636 | Val  Acc: 0.5758
 Site-SynthDigits               (2) | Val  Loss: 1.2308 | Val  Acc: 0.6010
 Site-MNIST_M                   (3) | Val  Loss: 1.4560 | Val  Acc: 0.5455
 Site-MNIST_M                   (6) | Val  Loss: 1.6186 | Val  Acc: 0.5000
 Site-SVHN                      (1) | Val  Loss: 1.7673 | Val  Acc: 0.3904
Average Valid Accuracy: 0.7140
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8214
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8333
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8333
 Best site-MNIST                    (5)  | Epoch:5 | Val Acc: 0.8368
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8526
 Best site-USPS                     (4)  | Epoch:5 | Val Acc: 0.8462
 Best site-USPS                     (4)  | Epoch:5 | Val Acc: 0.8077
 Best site-USPS                     (4)  | Epoch:5 | Val Acc: 0.8376
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.5758
 Best site-SynthDigits              (2)  | Epoch:5 | Val Acc: 0.6010
 Best site-MNIST_M                  (3)  | Epoch:5 | Val Acc: 0.5455
 Best site-MNIST_M                  (6)  | Epoch:5 | Val Acc: 0.5000
 Best site-SVHN                     (1)  | Epoch:5 | Val Acc: 0.3904
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 6 ============
cnt=[4, 1, 2, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (0) | Train Loss: 0.6603 | Train Acc: 0.8489
 Site-MNIST                     (0) | Train Loss: 0.6585 | Train Acc: 0.8521
 Site-MNIST                     (0) | Train Loss: 0.7118 | Train Acc: 0.8323
 Site-MNIST                     (0) | Train Loss: 0.6783 | Train Acc: 0.8357
 Site-MNIST                     (6) | Train Loss: 0.6645 | Train Acc: 0.8433
 Site-USPS                      (4) | Train Loss: 0.6651 | Train Acc: 0.8297
 Site-USPS                      (4) | Train Loss: 0.6593 | Train Acc: 0.8243
 Site-USPS                      (4) | Train Loss: 0.6577 | Train Acc: 0.8456
 Site-SynthDigits               (5) | Train Loss: 1.1943 | Train Acc: 0.6496
 Site-SynthDigits               (3) | Train Loss: 1.1043 | Train Acc: 0.6768
 Site-MNIST_M                   (2) | Train Loss: 1.5250 | Train Acc: 0.5398
 Site-MNIST_M                   (2) | Train Loss: 1.5217 | Train Acc: 0.5208
 Site-SVHN                      (1) | Train Loss: 1.6418 | Train Acc: 0.4429
Average Train Accuracy: 0.7340
 Site-MNIST                     (0) | Val  Loss: 0.7058 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.6804 | Val  Acc: 0.8690
 Site-MNIST                     (0) | Val  Loss: 0.6309 | Val  Acc: 0.8730
 Site-MNIST                     (0) | Val  Loss: 0.7192 | Val  Acc: 0.8579
 Site-MNIST                     (6) | Val  Loss: 0.6849 | Val  Acc: 0.8386
 Site-USPS                      (4) | Val  Loss: 0.6386 | Val  Acc: 0.8365
 Site-USPS                      (4) | Val  Loss: 0.7105 | Val  Acc: 0.7692
 Site-USPS                      (4) | Val  Loss: 0.6786 | Val  Acc: 0.7991
 Site-SynthDigits               (5) | Val  Loss: 1.4494 | Val  Acc: 0.6288
 Site-SynthDigits               (3) | Val  Loss: 1.1229 | Val  Acc: 0.6566
 Site-MNIST_M                   (2) | Val  Loss: 1.4059 | Val  Acc: 0.5909
 Site-MNIST_M                   (2) | Val  Loss: 1.5208 | Val  Acc: 0.5455
 Site-SVHN                      (1) | Val  Loss: 1.6755 | Val  Acc: 0.4452
Average Valid Accuracy: 0.7360
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8690
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8730
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8579
 Best site-MNIST                    (6)  | Epoch:6 | Val Acc: 0.8386
 Best site-USPS                     (4)  | Epoch:6 | Val Acc: 0.8365
 Best site-USPS                     (4)  | Epoch:6 | Val Acc: 0.7692
 Best site-USPS                     (4)  | Epoch:6 | Val Acc: 0.7991
 Best site-SynthDigits              (5)  | Epoch:6 | Val Acc: 0.6288
 Best site-SynthDigits              (3)  | Epoch:6 | Val Acc: 0.6566
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.5909
 Best site-MNIST_M                  (2)  | Epoch:6 | Val Acc: 0.5455
 Best site-SVHN                     (1)  | Epoch:6 | Val Acc: 0.4452
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 1, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (5) | Train Loss: 0.6299 | Train Acc: 0.8489
 Site-MNIST                     (5) | Train Loss: 0.6096 | Train Acc: 0.8491
 Site-MNIST                     (5) | Train Loss: 0.6702 | Train Acc: 0.8284
 Site-MNIST                     (0) | Train Loss: 0.6369 | Train Acc: 0.8384
 Site-MNIST                     (0) | Train Loss: 0.6225 | Train Acc: 0.8476
 Site-USPS                      (3) | Train Loss: 0.6269 | Train Acc: 0.8441
 Site-USPS                      (3) | Train Loss: 0.6178 | Train Acc: 0.8450
 Site-USPS                      (3) | Train Loss: 0.6150 | Train Acc: 0.8520
 Site-SynthDigits               (6) | Train Loss: 1.0988 | Train Acc: 0.6667
 Site-SynthDigits               (2) | Train Loss: 1.0030 | Train Acc: 0.7159
 Site-MNIST_M                   (1) | Train Loss: 1.4434 | Train Acc: 0.5483
 Site-MNIST_M                   (1) | Train Loss: 1.4409 | Train Acc: 0.5473
 Site-SVHN                      (4) | Train Loss: 1.5768 | Train Acc: 0.4770
Average Train Accuracy: 0.7468
 Site-MNIST                     (5) | Val  Loss: 0.6555 | Val  Acc: 0.8393
 Site-MNIST                     (5) | Val  Loss: 0.6322 | Val  Acc: 0.8571
 Site-MNIST                     (5) | Val  Loss: 0.5940 | Val  Acc: 0.8492
 Site-MNIST                     (0) | Val  Loss: 0.6804 | Val  Acc: 0.8474
 Site-MNIST                     (0) | Val  Loss: 0.6414 | Val  Acc: 0.8456
 Site-USPS                      (3) | Val  Loss: 0.5944 | Val  Acc: 0.8654
 Site-USPS                      (3) | Val  Loss: 0.6621 | Val  Acc: 0.8205
 Site-USPS                      (3) | Val  Loss: 0.6433 | Val  Acc: 0.8248
 Site-SynthDigits               (6) | Val  Loss: 1.3620 | Val  Acc: 0.6364
 Site-SynthDigits               (2) | Val  Loss: 1.0241 | Val  Acc: 0.6768
 Site-MNIST_M                   (1) | Val  Loss: 1.3269 | Val  Acc: 0.5909
 Site-MNIST_M                   (1) | Val  Loss: 1.4289 | Val  Acc: 0.5606
 Site-SVHN                      (4) | Val  Loss: 1.5960 | Val  Acc: 0.4795
Average Valid Accuracy: 0.7456
 Best site-MNIST                    (5)  | Epoch:7 | Val Acc: 0.8393
 Best site-MNIST                    (5)  | Epoch:7 | Val Acc: 0.8571
 Best site-MNIST                    (5)  | Epoch:7 | Val Acc: 0.8492
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8474
 Best site-MNIST                    (0)  | Epoch:7 | Val Acc: 0.8456
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8654
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8205
 Best site-USPS                     (3)  | Epoch:7 | Val Acc: 0.8248
 Best site-SynthDigits              (6)  | Epoch:7 | Val Acc: 0.6364
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.6768
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5909
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5606
 Best site-SVHN                     (4)  | Epoch:7 | Val Acc: 0.4795
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 8 ============
cnt=[3, 1, 2, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (0) | Train Loss: 0.5699 | Train Acc: 0.8622
 Site-MNIST                     (0) | Train Loss: 0.5935 | Train Acc: 0.8609
 Site-MNIST                     (6) | Train Loss: 0.6095 | Train Acc: 0.8402
 Site-MNIST                     (6) | Train Loss: 0.5837 | Train Acc: 0.8489
 Site-MNIST                     (0) | Train Loss: 0.5643 | Train Acc: 0.8634
 Site-USPS                      (4) | Train Loss: 0.5843 | Train Acc: 0.8513
 Site-USPS                      (4) | Train Loss: 0.5740 | Train Acc: 0.8498
 Site-USPS                      (4) | Train Loss: 0.5741 | Train Acc: 0.8562
 Site-SynthDigits               (2) | Train Loss: 1.0414 | Train Acc: 0.6818
 Site-SynthDigits               (2) | Train Loss: 0.9551 | Train Acc: 0.7285
 Site-MNIST_M                   (5) | Train Loss: 1.3347 | Train Acc: 0.5824
 Site-MNIST_M                   (3) | Train Loss: 1.3584 | Train Acc: 0.5663
 Site-SVHN                      (1) | Train Loss: 1.4574 | Train Acc: 0.5162
Average Train Accuracy: 0.7622
 Site-MNIST                     (0) | Val  Loss: 0.5824 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.5664 | Val  Acc: 0.8690
 Site-MNIST                     (6) | Val  Loss: 0.5400 | Val  Acc: 0.8492
 Site-MNIST                     (6) | Val  Loss: 0.6244 | Val  Acc: 0.8684
 Site-MNIST                     (0) | Val  Loss: 0.5861 | Val  Acc: 0.8491
 Site-USPS                      (4) | Val  Loss: 0.5413 | Val  Acc: 0.8846
 Site-USPS                      (4) | Val  Loss: 0.6153 | Val  Acc: 0.8397
 Site-USPS                      (4) | Val  Loss: 0.6062 | Val  Acc: 0.8291
 Site-SynthDigits               (2) | Val  Loss: 1.2958 | Val  Acc: 0.6439
 Site-SynthDigits               (2) | Val  Loss: 0.9569 | Val  Acc: 0.6970
 Site-MNIST_M                   (5) | Val  Loss: 1.2528 | Val  Acc: 0.5909
 Site-MNIST_M                   (3) | Val  Loss: 1.3426 | Val  Acc: 0.5758
 Site-SVHN                      (1) | Val  Loss: 1.5376 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7580
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8690
 Best site-MNIST                    (6)  | Epoch:8 | Val Acc: 0.8492
 Best site-MNIST                    (6)  | Epoch:8 | Val Acc: 0.8684
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8491
 Best site-USPS                     (4)  | Epoch:8 | Val Acc: 0.8846
 Best site-USPS                     (4)  | Epoch:8 | Val Acc: 0.8397
 Best site-USPS                     (4)  | Epoch:8 | Val Acc: 0.8291
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.6439
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.6970
 Best site-MNIST_M                  (5)  | Epoch:8 | Val Acc: 0.5909
 Best site-MNIST_M                  (3)  | Epoch:8 | Val Acc: 0.5758
 Best site-SVHN                     (1)  | Epoch:8 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 2, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (3) | Train Loss: 0.5497 | Train Acc: 0.8400
 Site-MNIST                     (3) | Train Loss: 0.5643 | Train Acc: 0.8521
 Site-MNIST                     (3) | Train Loss: 0.5927 | Train Acc: 0.8402
 Site-MNIST                     (3) | Train Loss: 0.5592 | Train Acc: 0.8476
 Site-MNIST                     (3) | Train Loss: 0.5435 | Train Acc: 0.8581
 Site-USPS                      (0) | Train Loss: 0.5382 | Train Acc: 0.8657
 Site-USPS                      (5) | Train Loss: 0.5414 | Train Acc: 0.8658
 Site-USPS                      (0) | Train Loss: 0.5443 | Train Acc: 0.8743
 Site-SynthDigits               (2) | Train Loss: 0.9654 | Train Acc: 0.6989
 Site-SynthDigits               (2) | Train Loss: 0.8840 | Train Acc: 0.7588
 Site-MNIST_M                   (1) | Train Loss: 1.2956 | Train Acc: 0.6023
 Site-MNIST_M                   (6) | Train Loss: 1.3056 | Train Acc: 0.5947
 Site-SVHN                      (4) | Train Loss: 1.4530 | Train Acc: 0.5468
Average Train Accuracy: 0.7727
 Site-MNIST                     (3) | Val  Loss: 0.5603 | Val  Acc: 0.8393
 Site-MNIST                     (3) | Val  Loss: 0.5416 | Val  Acc: 0.8452
 Site-MNIST                     (3) | Val  Loss: 0.5207 | Val  Acc: 0.8571
 Site-MNIST                     (3) | Val  Loss: 0.6073 | Val  Acc: 0.8526
 Site-MNIST                     (3) | Val  Loss: 0.5625 | Val  Acc: 0.8526
 Site-USPS                      (0) | Val  Loss: 0.5136 | Val  Acc: 0.8750
 Site-USPS                      (5) | Val  Loss: 0.5791 | Val  Acc: 0.8526
 Site-USPS                      (0) | Val  Loss: 0.5770 | Val  Acc: 0.8419
 Site-SynthDigits               (2) | Val  Loss: 1.1992 | Val  Acc: 0.6591
 Site-SynthDigits               (2) | Val  Loss: 0.8786 | Val  Acc: 0.7020
 Site-MNIST_M                   (1) | Val  Loss: 1.2027 | Val  Acc: 0.5909
 Site-MNIST_M                   (6) | Val  Loss: 1.2810 | Val  Acc: 0.5985
 Site-SVHN                      (4) | Val  Loss: 1.4740 | Val  Acc: 0.5205
Average Valid Accuracy: 0.7606
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.8393
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.8452
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.8571
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.8526
 Best site-MNIST                    (3)  | Epoch:9 | Val Acc: 0.8526
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8750
 Best site-USPS                     (5)  | Epoch:9 | Val Acc: 0.8526
 Best site-USPS                     (0)  | Epoch:9 | Val Acc: 0.8419
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.6591
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.7020
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.5909
 Best site-MNIST_M                  (6)  | Epoch:9 | Val Acc: 0.5985
 Best site-SVHN                     (4)  | Epoch:9 | Val Acc: 0.5205
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 5, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (1) | Train Loss: 0.4749 | Train Acc: 0.8800
 Site-MNIST                     (1) | Train Loss: 0.4702 | Train Acc: 0.8994
 Site-MNIST                     (1) | Train Loss: 0.5010 | Train Acc: 0.8698
 Site-MNIST                     (1) | Train Loss: 0.4831 | Train Acc: 0.8752
 Site-MNIST                     (1) | Train Loss: 0.4609 | Train Acc: 0.8914
 Site-USPS                      (4) | Train Loss: 0.5322 | Train Acc: 0.8441
 Site-USPS                      (4) | Train Loss: 0.5274 | Train Acc: 0.8482
 Site-USPS                      (4) | Train Loss: 0.5213 | Train Acc: 0.8701
 Site-SynthDigits               (5) | Train Loss: 0.9196 | Train Acc: 0.7159
 Site-SynthDigits               (0) | Train Loss: 0.8411 | Train Acc: 0.7753
 Site-MNIST_M                   (2) | Train Loss: 1.2513 | Train Acc: 0.6136
 Site-MNIST_M                   (6) | Train Loss: 1.2301 | Train Acc: 0.6061
 Site-SVHN                      (3) | Train Loss: 1.3914 | Train Acc: 0.5588
Average Train Accuracy: 0.7883
 Site-MNIST                     (1) | Val  Loss: 0.4531 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.4402 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.4414 | Val  Acc: 0.8968
 Site-MNIST                     (1) | Val  Loss: 0.5208 | Val  Acc: 0.8895
 Site-MNIST                     (1) | Val  Loss: 0.4785 | Val  Acc: 0.8912
 Site-USPS                      (4) | Val  Loss: 0.4726 | Val  Acc: 0.8846
 Site-USPS                      (4) | Val  Loss: 0.5549 | Val  Acc: 0.8333
 Site-USPS                      (4) | Val  Loss: 0.5691 | Val  Acc: 0.8205
 Site-SynthDigits               (5) | Val  Loss: 1.1583 | Val  Acc: 0.6970
 Site-SynthDigits               (0) | Val  Loss: 0.8409 | Val  Acc: 0.7273
 Site-MNIST_M                   (2) | Val  Loss: 1.2102 | Val  Acc: 0.5909
 Site-MNIST_M                   (6) | Val  Loss: 1.2511 | Val  Acc: 0.6136
 Site-SVHN                      (3) | Val  Loss: 1.4107 | Val  Acc: 0.5479
Average Valid Accuracy: 0.7843
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8929
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8968
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8895
 Best site-MNIST                    (1)  | Epoch:10 | Val Acc: 0.8912
 Best site-USPS                     (4)  | Epoch:10 | Val Acc: 0.8846
 Best site-USPS                     (4)  | Epoch:10 | Val Acc: 0.8333
 Best site-USPS                     (4)  | Epoch:10 | Val Acc: 0.8205
 Best site-SynthDigits              (5)  | Epoch:10 | Val Acc: 0.6970
 Best site-SynthDigits              (0)  | Epoch:10 | Val Acc: 0.7273
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.5909
 Best site-MNIST_M                  (6)  | Epoch:10 | Val Acc: 0.6136
 Best site-SVHN                     (3)  | Epoch:10 | Val Acc: 0.5479
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 2, 2, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (5) | Train Loss: 0.4592 | Train Acc: 0.8711
 Site-MNIST                     (1) | Train Loss: 0.4185 | Train Acc: 0.9053
 Site-MNIST                     (5) | Train Loss: 0.4845 | Train Acc: 0.8698
 Site-MNIST                     (5) | Train Loss: 0.4643 | Train Acc: 0.8712
 Site-MNIST                     (1) | Train Loss: 0.4403 | Train Acc: 0.8949
 Site-USPS                      (3) | Train Loss: 0.5280 | Train Acc: 0.8561
 Site-USPS                      (3) | Train Loss: 0.4903 | Train Acc: 0.8594
 Site-USPS                      (3) | Train Loss: 0.4870 | Train Acc: 0.8797
 Site-SynthDigits               (2) | Train Loss: 0.8333 | Train Acc: 0.7424
 Site-SynthDigits               (2) | Train Loss: 0.7736 | Train Acc: 0.7891
 Site-MNIST_M                   (0) | Train Loss: 1.2164 | Train Acc: 0.6449
 Site-MNIST_M                   (6) | Train Loss: 1.1873 | Train Acc: 0.6345
 Site-SVHN                      (4) | Train Loss: 1.3064 | Train Acc: 0.5928
Average Train Accuracy: 0.8009
 Site-MNIST                     (5) | Val  Loss: 0.4367 | Val  Acc: 0.8750
 Site-MNIST                     (1) | Val  Loss: 0.4281 | Val  Acc: 0.8929
 Site-MNIST                     (5) | Val  Loss: 0.4248 | Val  Acc: 0.8968
 Site-MNIST                     (5) | Val  Loss: 0.5036 | Val  Acc: 0.8842
 Site-MNIST                     (1) | Val  Loss: 0.4575 | Val  Acc: 0.8982
 Site-USPS                      (3) | Val  Loss: 0.4380 | Val  Acc: 0.8846
 Site-USPS                      (3) | Val  Loss: 0.5177 | Val  Acc: 0.8462
 Site-USPS                      (3) | Val  Loss: 0.5370 | Val  Acc: 0.8291
 Site-SynthDigits               (2) | Val  Loss: 1.0626 | Val  Acc: 0.7121
 Site-SynthDigits               (2) | Val  Loss: 0.7651 | Val  Acc: 0.7626
 Site-MNIST_M                   (0) | Val  Loss: 1.1481 | Val  Acc: 0.6250
 Site-MNIST_M                   (6) | Val  Loss: 1.1889 | Val  Acc: 0.6591
 Site-SVHN                      (4) | Val  Loss: 1.3276 | Val  Acc: 0.5616
Average Valid Accuracy: 0.7944
 Best site-MNIST                    (5)  | Epoch:11 | Val Acc: 0.8750
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8929
 Best site-MNIST                    (5)  | Epoch:11 | Val Acc: 0.8968
 Best site-MNIST                    (5)  | Epoch:11 | Val Acc: 0.8842
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8982
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8846
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8462
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8291
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7121
 Best site-SynthDigits              (2)  | Epoch:11 | Val Acc: 0.7626
 Best site-MNIST_M                  (0)  | Epoch:11 | Val Acc: 0.6250
 Best site-MNIST_M                  (6)  | Epoch:11 | Val Acc: 0.6591
 Best site-SVHN                     (4)  | Epoch:11 | Val Acc: 0.5616
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 3, 3, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (2) | Train Loss: 0.4795 | Train Acc: 0.8578
 Site-MNIST                     (6) | Train Loss: 0.4194 | Train Acc: 0.8964
 Site-MNIST                     (6) | Train Loss: 0.4892 | Train Acc: 0.8600
 Site-MNIST                     (2) | Train Loss: 0.4629 | Train Acc: 0.8633
 Site-MNIST                     (2) | Train Loss: 0.4380 | Train Acc: 0.8870
 Site-USPS                      (1) | Train Loss: 0.4882 | Train Acc: 0.8825
 Site-USPS                      (1) | Train Loss: 0.4639 | Train Acc: 0.8738
 Site-USPS                      (1) | Train Loss: 0.4608 | Train Acc: 0.8850
 Site-SynthDigits               (5) | Train Loss: 0.7876 | Train Acc: 0.7633
 Site-SynthDigits               (4) | Train Loss: 0.7231 | Train Acc: 0.8043
 Site-MNIST_M                   (0) | Train Loss: 1.1057 | Train Acc: 0.6733
 Site-MNIST_M                   (0) | Train Loss: 1.0954 | Train Acc: 0.6667
 Site-SVHN                      (3) | Train Loss: 1.2590 | Train Acc: 0.5911
Average Train Accuracy: 0.8080
 Site-MNIST                     (2) | Val  Loss: 0.4458 | Val  Acc: 0.8750
 Site-MNIST                     (6) | Val  Loss: 0.4353 | Val  Acc: 0.8690
 Site-MNIST                     (6) | Val  Loss: 0.4247 | Val  Acc: 0.8730
 Site-MNIST                     (2) | Val  Loss: 0.5069 | Val  Acc: 0.8684
 Site-MNIST                     (2) | Val  Loss: 0.4562 | Val  Acc: 0.8807
 Site-USPS                      (1) | Val  Loss: 0.4158 | Val  Acc: 0.9038
 Site-USPS                      (1) | Val  Loss: 0.4927 | Val  Acc: 0.8718
 Site-USPS                      (1) | Val  Loss: 0.5151 | Val  Acc: 0.8547
 Site-SynthDigits               (5) | Val  Loss: 0.9757 | Val  Acc: 0.7348
 Site-SynthDigits               (4) | Val  Loss: 0.7094 | Val  Acc: 0.7576
 Site-MNIST_M                   (0) | Val  Loss: 1.0314 | Val  Acc: 0.6477
 Site-MNIST_M                   (0) | Val  Loss: 1.1076 | Val  Acc: 0.6667
 Site-SVHN                      (3) | Val  Loss: 1.3000 | Val  Acc: 0.5753
Average Valid Accuracy: 0.7984
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8750
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.8690
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.8730
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8684
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.8807
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.9038
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8718
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8547
 Best site-SynthDigits              (5)  | Epoch:12 | Val Acc: 0.7348
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.7576
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.6477
 Best site-MNIST_M                  (0)  | Epoch:12 | Val Acc: 0.6667
 Best site-SVHN                     (3)  | Epoch:12 | Val Acc: 0.5753
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 4, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (1) | Train Loss: 0.4152 | Train Acc: 0.8667
 Site-MNIST                     (1) | Train Loss: 0.3664 | Train Acc: 0.9083
 Site-MNIST                     (5) | Train Loss: 0.4455 | Train Acc: 0.8757
 Site-MNIST                     (1) | Train Loss: 0.4222 | Train Acc: 0.8817
 Site-MNIST                     (1) | Train Loss: 0.3968 | Train Acc: 0.9011
 Site-USPS                      (3) | Train Loss: 0.4545 | Train Acc: 0.8873
 Site-USPS                      (3) | Train Loss: 0.4375 | Train Acc: 0.8802
 Site-USPS                      (3) | Train Loss: 0.4349 | Train Acc: 0.8892
 Site-SynthDigits               (0) | Train Loss: 0.7457 | Train Acc: 0.7727
 Site-SynthDigits               (0) | Train Loss: 0.6884 | Train Acc: 0.8081
 Site-MNIST_M                   (6) | Train Loss: 1.0898 | Train Acc: 0.6676
 Site-MNIST_M                   (2) | Train Loss: 1.0804 | Train Acc: 0.6970
 Site-SVHN                      (4) | Train Loss: 1.2165 | Train Acc: 0.6252
Average Train Accuracy: 0.8201
 Site-MNIST                     (1) | Val  Loss: 0.3911 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.3874 | Val  Acc: 0.9048
 Site-MNIST                     (5) | Val  Loss: 0.3899 | Val  Acc: 0.9048
 Site-MNIST                     (1) | Val  Loss: 0.4649 | Val  Acc: 0.8895
 Site-MNIST                     (1) | Val  Loss: 0.4138 | Val  Acc: 0.8982
 Site-USPS                      (3) | Val  Loss: 0.3822 | Val  Acc: 0.9135
 Site-USPS                      (3) | Val  Loss: 0.4555 | Val  Acc: 0.8590
 Site-USPS                      (3) | Val  Loss: 0.4900 | Val  Acc: 0.8590
 Site-SynthDigits               (0) | Val  Loss: 0.9329 | Val  Acc: 0.7348
 Site-SynthDigits               (0) | Val  Loss: 0.6695 | Val  Acc: 0.7879
 Site-MNIST_M                   (6) | Val  Loss: 1.0470 | Val  Acc: 0.6250
 Site-MNIST_M                   (2) | Val  Loss: 1.0895 | Val  Acc: 0.6591
 Site-SVHN                      (4) | Val  Loss: 1.2316 | Val  Acc: 0.6027
Average Valid Accuracy: 0.8101
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.8929
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.9048
 Best site-MNIST                    (5)  | Epoch:13 | Val Acc: 0.9048
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.8895
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.8982
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.9135
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.8590
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.8590
 Best site-SynthDigits              (0)  | Epoch:13 | Val Acc: 0.7348
 Best site-SynthDigits              (0)  | Epoch:13 | Val Acc: 0.7879
 Best site-MNIST_M                  (6)  | Epoch:13 | Val Acc: 0.6250
 Best site-MNIST_M                  (2)  | Epoch:13 | Val Acc: 0.6591
 Best site-SVHN                     (4)  | Epoch:13 | Val Acc: 0.6027
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 1, 5, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (2) | Train Loss: 0.4114 | Train Acc: 0.8711
 Site-MNIST                     (2) | Train Loss: 0.3433 | Train Acc: 0.9172
 Site-MNIST                     (2) | Train Loss: 0.4141 | Train Acc: 0.8876
 Site-MNIST                     (2) | Train Loss: 0.3980 | Train Acc: 0.8922
 Site-MNIST                     (2) | Train Loss: 0.3720 | Train Acc: 0.9089
 Site-USPS                      (3) | Train Loss: 0.4483 | Train Acc: 0.8825
 Site-USPS                      (6) | Train Loss: 0.4283 | Train Acc: 0.8882
 Site-USPS                      (3) | Train Loss: 0.4303 | Train Acc: 0.8882
 Site-SynthDigits               (0) | Train Loss: 0.7293 | Train Acc: 0.8030
 Site-SynthDigits               (0) | Train Loss: 0.6578 | Train Acc: 0.8422
 Site-MNIST_M                   (1) | Train Loss: 1.0510 | Train Acc: 0.7017
 Site-MNIST_M                   (5) | Train Loss: 0.9983 | Train Acc: 0.7064
 Site-SVHN                      (4) | Train Loss: 1.1931 | Train Acc: 0.6218
Average Train Accuracy: 0.8316
 Site-MNIST                     (2) | Val  Loss: 0.3565 | Val  Acc: 0.8929
 Site-MNIST                     (2) | Val  Loss: 0.3526 | Val  Acc: 0.9167
 Site-MNIST                     (2) | Val  Loss: 0.3666 | Val  Acc: 0.9127
 Site-MNIST                     (2) | Val  Loss: 0.4366 | Val  Acc: 0.8947
 Site-MNIST                     (2) | Val  Loss: 0.3880 | Val  Acc: 0.9088
 Site-USPS                      (3) | Val  Loss: 0.3717 | Val  Acc: 0.8942
 Site-USPS                      (6) | Val  Loss: 0.4378 | Val  Acc: 0.8526
 Site-USPS                      (3) | Val  Loss: 0.4833 | Val  Acc: 0.8462
 Site-SynthDigits               (0) | Val  Loss: 0.8685 | Val  Acc: 0.7727
 Site-SynthDigits               (0) | Val  Loss: 0.6200 | Val  Acc: 0.8081
 Site-MNIST_M                   (1) | Val  Loss: 1.0274 | Val  Acc: 0.6591
 Site-MNIST_M                   (5) | Val  Loss: 1.0602 | Val  Acc: 0.6742
 Site-SVHN                      (4) | Val  Loss: 1.1903 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8192
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8929
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9167
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9127
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8947
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.9088
 Best site-USPS                     (3)  | Epoch:14 | Val Acc: 0.8942
 Best site-USPS                     (6)  | Epoch:14 | Val Acc: 0.8526
 Best site-USPS                     (3)  | Epoch:14 | Val Acc: 0.8462
 Best site-SynthDigits              (0)  | Epoch:14 | Val Acc: 0.7727
 Best site-SynthDigits              (0)  | Epoch:14 | Val Acc: 0.8081
 Best site-MNIST_M                  (1)  | Epoch:14 | Val Acc: 0.6591
 Best site-MNIST_M                  (5)  | Epoch:14 | Val Acc: 0.6742
 Best site-SVHN                     (4)  | Epoch:14 | Val Acc: 0.6164
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 15 ============
cnt=[3, 3, 2, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (1) | Train Loss: 0.3425 | Train Acc: 0.9111
 Site-MNIST                     (1) | Train Loss: 0.3099 | Train Acc: 0.9290
 Site-MNIST                     (5) | Train Loss: 0.3783 | Train Acc: 0.8915
 Site-MNIST                     (5) | Train Loss: 0.3641 | Train Acc: 0.9028
 Site-MNIST                     (1) | Train Loss: 0.3368 | Train Acc: 0.9247
 Site-USPS                      (0) | Train Loss: 0.4353 | Train Acc: 0.8825
 Site-USPS                      (0) | Train Loss: 0.4130 | Train Acc: 0.8898
 Site-USPS                      (0) | Train Loss: 0.4062 | Train Acc: 0.8892
 Site-SynthDigits               (6) | Train Loss: 0.6849 | Train Acc: 0.8011
 Site-SynthDigits               (3) | Train Loss: 0.6191 | Train Acc: 0.8384
 Site-MNIST_M                   (2) | Train Loss: 0.9956 | Train Acc: 0.7244
 Site-MNIST_M                   (2) | Train Loss: 1.0155 | Train Acc: 0.7102
 Site-SVHN                      (4) | Train Loss: 1.1142 | Train Acc: 0.6371
Average Train Accuracy: 0.8409
 Site-MNIST                     (1) | Val  Loss: 0.3192 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.3217 | Val  Acc: 0.9167
 Site-MNIST                     (5) | Val  Loss: 0.3304 | Val  Acc: 0.9127
 Site-MNIST                     (5) | Val  Loss: 0.3996 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.3551 | Val  Acc: 0.9193
 Site-USPS                      (0) | Val  Loss: 0.3443 | Val  Acc: 0.9231
 Site-USPS                      (0) | Val  Loss: 0.4231 | Val  Acc: 0.8782
 Site-USPS                      (0) | Val  Loss: 0.4659 | Val  Acc: 0.8590
 Site-SynthDigits               (6) | Val  Loss: 0.8448 | Val  Acc: 0.7727
 Site-SynthDigits               (3) | Val  Loss: 0.5878 | Val  Acc: 0.8081
 Site-MNIST_M                   (2) | Val  Loss: 0.9903 | Val  Acc: 0.6818
 Site-MNIST_M                   (2) | Val  Loss: 1.0228 | Val  Acc: 0.7045
 Site-SVHN                      (4) | Val  Loss: 1.1897 | Val  Acc: 0.5959
Average Valid Accuracy: 0.8294
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9167
 Best site-MNIST                    (5)  | Epoch:15 | Val Acc: 0.9127
 Best site-MNIST                    (5)  | Epoch:15 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9193
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.9231
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.8782
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.8590
 Best site-SynthDigits              (6)  | Epoch:15 | Val Acc: 0.7727
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.8081
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.6818
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.7045
 Best site-SVHN                     (4)  | Epoch:15 | Val Acc: 0.5959
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 5, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (1) | Train Loss: 0.3675 | Train Acc: 0.8711
 Site-MNIST                     (1) | Train Loss: 0.3366 | Train Acc: 0.9201
 Site-MNIST                     (1) | Train Loss: 0.3713 | Train Acc: 0.8895
 Site-MNIST                     (1) | Train Loss: 0.3616 | Train Acc: 0.9001
 Site-MNIST                     (1) | Train Loss: 0.3360 | Train Acc: 0.9177
 Site-USPS                      (3) | Train Loss: 0.4143 | Train Acc: 0.8849
 Site-USPS                      (3) | Train Loss: 0.3910 | Train Acc: 0.8994
 Site-USPS                      (3) | Train Loss: 0.3897 | Train Acc: 0.9010
 Site-SynthDigits               (5) | Train Loss: 0.6596 | Train Acc: 0.8163
 Site-SynthDigits               (2) | Train Loss: 0.6009 | Train Acc: 0.8409
 Site-MNIST_M                   (6) | Train Loss: 0.9382 | Train Acc: 0.7301
 Site-MNIST_M                   (0) | Train Loss: 0.9214 | Train Acc: 0.7330
 Site-SVHN                      (4) | Train Loss: 1.1800 | Train Acc: 0.6303
Average Train Accuracy: 0.8411
 Site-MNIST                     (1) | Val  Loss: 0.3156 | Val  Acc: 0.8929
 Site-MNIST                     (1) | Val  Loss: 0.3165 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.3292 | Val  Acc: 0.9048
 Site-MNIST                     (1) | Val  Loss: 0.3933 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.3522 | Val  Acc: 0.9123
 Site-USPS                      (3) | Val  Loss: 0.3271 | Val  Acc: 0.9135
 Site-USPS                      (3) | Val  Loss: 0.3964 | Val  Acc: 0.8590
 Site-USPS                      (3) | Val  Loss: 0.4439 | Val  Acc: 0.8504
 Site-SynthDigits               (5) | Val  Loss: 0.7901 | Val  Acc: 0.7955
 Site-SynthDigits               (2) | Val  Loss: 0.5598 | Val  Acc: 0.8081
 Site-MNIST_M                   (6) | Val  Loss: 0.9292 | Val  Acc: 0.7045
 Site-MNIST_M                   (0) | Val  Loss: 0.9798 | Val  Acc: 0.7045
 Site-SVHN                      (4) | Val  Loss: 1.1880 | Val  Acc: 0.5890
Average Valid Accuracy: 0.8270
============ Train epoch 17 ============
cnt=[1, 5, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (1) | Train Loss: 0.3521 | Train Acc: 0.8800
 Site-MNIST                     (1) | Train Loss: 0.3232 | Train Acc: 0.9320
 Site-MNIST                     (1) | Train Loss: 0.3541 | Train Acc: 0.8974
 Site-MNIST                     (1) | Train Loss: 0.3496 | Train Acc: 0.9028
 Site-MNIST                     (1) | Train Loss: 0.3235 | Train Acc: 0.9212
 Site-USPS                      (3) | Train Loss: 0.4136 | Train Acc: 0.8945
 Site-USPS                      (3) | Train Loss: 0.3769 | Train Acc: 0.9042
 Site-USPS                      (3) | Train Loss: 0.3828 | Train Acc: 0.8978
 Site-SynthDigits               (0) | Train Loss: 0.6301 | Train Acc: 0.8087
 Site-SynthDigits               (6) | Train Loss: 0.5908 | Train Acc: 0.8485
 Site-MNIST_M                   (5) | Train Loss: 0.9237 | Train Acc: 0.7386
 Site-MNIST_M                   (2) | Train Loss: 0.9047 | Train Acc: 0.7443
 Site-SVHN                      (4) | Train Loss: 1.1115 | Train Acc: 0.6610
Average Train Accuracy: 0.8485
 Site-MNIST                     (1) | Val  Loss: 0.2965 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.3003 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.3183 | Val  Acc: 0.9127
 Site-MNIST                     (1) | Val  Loss: 0.3800 | Val  Acc: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.3367 | Val  Acc: 0.9228
 Site-USPS                      (3) | Val  Loss: 0.3170 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.3830 | Val  Acc: 0.8782
 Site-USPS                      (3) | Val  Loss: 0.4338 | Val  Acc: 0.8632
 Site-SynthDigits               (0) | Val  Loss: 0.7628 | Val  Acc: 0.7955
 Site-SynthDigits               (6) | Val  Loss: 0.5372 | Val  Acc: 0.8131
 Site-MNIST_M                   (5) | Val  Loss: 0.9367 | Val  Acc: 0.6818
 Site-MNIST_M                   (2) | Val  Loss: 0.9732 | Val  Acc: 0.7197
 Site-SVHN                      (4) | Val  Loss: 1.1404 | Val  Acc: 0.6370
Average Valid Accuracy: 0.8365
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9167
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9127
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9000
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9228
 Best site-USPS                     (3)  | Epoch:17 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:17 | Val Acc: 0.8782
 Best site-USPS                     (3)  | Epoch:17 | Val Acc: 0.8632
 Best site-SynthDigits              (0)  | Epoch:17 | Val Acc: 0.7955
 Best site-SynthDigits              (6)  | Epoch:17 | Val Acc: 0.8131
 Best site-MNIST_M                  (5)  | Epoch:17 | Val Acc: 0.6818
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.7197
 Best site-SVHN                     (4)  | Epoch:17 | Val Acc: 0.6370
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 5, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (1) | Train Loss: 0.3432 | Train Acc: 0.8933
 Site-MNIST                     (1) | Train Loss: 0.2906 | Train Acc: 0.9320
 Site-MNIST                     (1) | Train Loss: 0.3401 | Train Acc: 0.9034
 Site-MNIST                     (1) | Train Loss: 0.3334 | Train Acc: 0.9080
 Site-MNIST                     (1) | Train Loss: 0.3063 | Train Acc: 0.9282
 Site-USPS                      (4) | Train Loss: 0.3894 | Train Acc: 0.9017
 Site-USPS                      (4) | Train Loss: 0.3645 | Train Acc: 0.9073
 Site-USPS                      (4) | Train Loss: 0.3628 | Train Acc: 0.9042
 Site-SynthDigits               (6) | Train Loss: 0.6062 | Train Acc: 0.8239
 Site-SynthDigits               (2) | Train Loss: 0.5454 | Train Acc: 0.8548
 Site-MNIST_M                   (5) | Train Loss: 0.9140 | Train Acc: 0.7500
 Site-MNIST_M                   (0) | Train Loss: 0.9025 | Train Acc: 0.7500
 Site-SVHN                      (3) | Train Loss: 1.0495 | Train Acc: 0.6644
Average Train Accuracy: 0.8555
 Site-MNIST                     (1) | Val  Loss: 0.2845 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2859 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.3043 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3618 | Val  Acc: 0.9158
 Site-MNIST                     (1) | Val  Loss: 0.3220 | Val  Acc: 0.9228
 Site-USPS                      (4) | Val  Loss: 0.3000 | Val  Acc: 0.9327
 Site-USPS                      (4) | Val  Loss: 0.3685 | Val  Acc: 0.8846
 Site-USPS                      (4) | Val  Loss: 0.4230 | Val  Acc: 0.8675
 Site-SynthDigits               (6) | Val  Loss: 0.7224 | Val  Acc: 0.7879
 Site-SynthDigits               (2) | Val  Loss: 0.5040 | Val  Acc: 0.8384
 Site-MNIST_M                   (5) | Val  Loss: 0.9300 | Val  Acc: 0.7159
 Site-MNIST_M                   (0) | Val  Loss: 0.9546 | Val  Acc: 0.7424
 Site-SVHN                      (3) | Val  Loss: 1.1003 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8446
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9167
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9158
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9228
 Best site-USPS                     (4)  | Epoch:18 | Val Acc: 0.9327
 Best site-USPS                     (4)  | Epoch:18 | Val Acc: 0.8846
 Best site-USPS                     (4)  | Epoch:18 | Val Acc: 0.8675
 Best site-SynthDigits              (6)  | Epoch:18 | Val Acc: 0.7879
 Best site-SynthDigits              (2)  | Epoch:18 | Val Acc: 0.8384
 Best site-MNIST_M                  (5)  | Epoch:18 | Val Acc: 0.7159
 Best site-MNIST_M                  (0)  | Epoch:18 | Val Acc: 0.7424
 Best site-SVHN                     (3)  | Epoch:18 | Val Acc: 0.6164
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 5, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (1) | Train Loss: 0.3175 | Train Acc: 0.8933
 Site-MNIST                     (1) | Train Loss: 0.2830 | Train Acc: 0.9260
 Site-MNIST                     (1) | Train Loss: 0.3306 | Train Acc: 0.9112
 Site-MNIST                     (1) | Train Loss: 0.3252 | Train Acc: 0.9106
 Site-MNIST                     (1) | Train Loss: 0.2941 | Train Acc: 0.9299
 Site-USPS                      (0) | Train Loss: 0.3826 | Train Acc: 0.8945
 Site-USPS                      (6) | Train Loss: 0.3592 | Train Acc: 0.8946
 Site-USPS                      (0) | Train Loss: 0.3602 | Train Acc: 0.8956
 Site-SynthDigits               (3) | Train Loss: 0.5591 | Train Acc: 0.8428
 Site-SynthDigits               (3) | Train Loss: 0.5207 | Train Acc: 0.8788
 Site-MNIST_M                   (5) | Train Loss: 0.8696 | Train Acc: 0.7557
 Site-MNIST_M                   (2) | Train Loss: 0.8713 | Train Acc: 0.7765
 Site-SVHN                      (4) | Train Loss: 1.0326 | Train Acc: 0.6678
Average Train Accuracy: 0.8598
 Site-MNIST                     (1) | Val  Loss: 0.2727 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2758 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2922 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3553 | Val  Acc: 0.9158
 Site-MNIST                     (1) | Val  Loss: 0.3120 | Val  Acc: 0.9228
 Site-USPS                      (0) | Val  Loss: 0.2929 | Val  Acc: 0.9231
 Site-USPS                      (6) | Val  Loss: 0.3567 | Val  Acc: 0.8910
 Site-USPS                      (0) | Val  Loss: 0.4095 | Val  Acc: 0.8590
 Site-SynthDigits               (3) | Val  Loss: 0.6815 | Val  Acc: 0.8182
 Site-SynthDigits               (3) | Val  Loss: 0.4770 | Val  Acc: 0.8586
 Site-MNIST_M                   (5) | Val  Loss: 0.9128 | Val  Acc: 0.6818
 Site-MNIST_M                   (2) | Val  Loss: 0.9341 | Val  Acc: 0.7500
 Site-SVHN                      (4) | Val  Loss: 1.0843 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8470
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9158
 Best site-MNIST                    (1)  | Epoch:19 | Val Acc: 0.9228
 Best site-USPS                     (0)  | Epoch:19 | Val Acc: 0.9231
 Best site-USPS                     (6)  | Epoch:19 | Val Acc: 0.8910
 Best site-USPS                     (0)  | Epoch:19 | Val Acc: 0.8590
 Best site-SynthDigits              (3)  | Epoch:19 | Val Acc: 0.8182
 Best site-SynthDigits              (3)  | Epoch:19 | Val Acc: 0.8586
 Best site-MNIST_M                  (5)  | Epoch:19 | Val Acc: 0.6818
 Best site-MNIST_M                  (2)  | Epoch:19 | Val Acc: 0.7500
 Best site-SVHN                     (4)  | Epoch:19 | Val Acc: 0.6233
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 20 ============
cnt=[5, 1, 1, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (0) | Train Loss: 0.3366 | Train Acc: 0.8978
 Site-MNIST                     (0) | Train Loss: 0.2744 | Train Acc: 0.9290
 Site-MNIST                     (0) | Train Loss: 0.3237 | Train Acc: 0.9093
 Site-MNIST                     (0) | Train Loss: 0.3177 | Train Acc: 0.9106
 Site-MNIST                     (0) | Train Loss: 0.2896 | Train Acc: 0.9317
 Site-USPS                      (1) | Train Loss: 0.3712 | Train Acc: 0.8945
 Site-USPS                      (6) | Train Loss: 0.3432 | Train Acc: 0.9042
 Site-USPS                      (6) | Train Loss: 0.3457 | Train Acc: 0.8988
 Site-SynthDigits               (3) | Train Loss: 0.5697 | Train Acc: 0.8371
 Site-SynthDigits               (3) | Train Loss: 0.5097 | Train Acc: 0.8725
 Site-MNIST_M                   (2) | Train Loss: 0.8608 | Train Acc: 0.7585
 Site-MNIST_M                   (5) | Train Loss: 0.8452 | Train Acc: 0.7614
 Site-SVHN                      (4) | Train Loss: 0.9868 | Train Acc: 0.6644
Average Train Accuracy: 0.8592
 Site-MNIST                     (0) | Val  Loss: 0.2642 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2673 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.2883 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.3470 | Val  Acc: 0.9158
 Site-MNIST                     (0) | Val  Loss: 0.3075 | Val  Acc: 0.9193
 Site-USPS                      (1) | Val  Loss: 0.2814 | Val  Acc: 0.9327
 Site-USPS                      (6) | Val  Loss: 0.3469 | Val  Acc: 0.8910
 Site-USPS                      (6) | Val  Loss: 0.4004 | Val  Acc: 0.8632
 Site-SynthDigits               (3) | Val  Loss: 0.6823 | Val  Acc: 0.8106
 Site-SynthDigits               (3) | Val  Loss: 0.4652 | Val  Acc: 0.8384
 Site-MNIST_M                   (2) | Val  Loss: 0.8787 | Val  Acc: 0.7045
 Site-MNIST_M                   (5) | Val  Loss: 0.9107 | Val  Acc: 0.7424
 Site-SVHN                      (4) | Val  Loss: 1.0710 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8473
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9167
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9158
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9193
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.9327
 Best site-USPS                     (6)  | Epoch:20 | Val Acc: 0.8910
 Best site-USPS                     (6)  | Epoch:20 | Val Acc: 0.8632
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.8106
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.8384
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.7045
 Best site-MNIST_M                  (5)  | Epoch:20 | Val Acc: 0.7424
 Best site-SVHN                     (4)  | Epoch:20 | Val Acc: 0.6233
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 21 ============
cnt=[1, 5, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (1) | Train Loss: 0.2966 | Train Acc: 0.9156
 Site-MNIST                     (1) | Train Loss: 0.2735 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.3076 | Train Acc: 0.9112
 Site-MNIST                     (1) | Train Loss: 0.3043 | Train Acc: 0.9159
 Site-MNIST                     (1) | Train Loss: 0.2733 | Train Acc: 0.9343
 Site-USPS                      (5) | Train Loss: 0.3615 | Train Acc: 0.8945
 Site-USPS                      (0) | Train Loss: 0.3415 | Train Acc: 0.9073
 Site-USPS                      (6) | Train Loss: 0.3372 | Train Acc: 0.9042
 Site-SynthDigits               (4) | Train Loss: 0.5539 | Train Acc: 0.8409
 Site-SynthDigits               (4) | Train Loss: 0.5030 | Train Acc: 0.8662
 Site-MNIST_M                   (2) | Train Loss: 0.8276 | Train Acc: 0.7585
 Site-MNIST_M                   (2) | Train Loss: 0.8070 | Train Acc: 0.7803
 Site-SVHN                      (3) | Train Loss: 1.0266 | Train Acc: 0.6695
Average Train Accuracy: 0.8636
 Site-MNIST                     (1) | Val  Loss: 0.2546 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2553 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.2736 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3296 | Val  Acc: 0.9211
 Site-MNIST                     (1) | Val  Loss: 0.2938 | Val  Acc: 0.9228
 Site-USPS                      (5) | Val  Loss: 0.2707 | Val  Acc: 0.9327
 Site-USPS                      (0) | Val  Loss: 0.3411 | Val  Acc: 0.8910
 Site-USPS                      (6) | Val  Loss: 0.3949 | Val  Acc: 0.8632
 Site-SynthDigits               (4) | Val  Loss: 0.6487 | Val  Acc: 0.8409
 Site-SynthDigits               (4) | Val  Loss: 0.4544 | Val  Acc: 0.8535
 Site-MNIST_M                   (2) | Val  Loss: 0.8626 | Val  Acc: 0.6932
 Site-MNIST_M                   (2) | Val  Loss: 0.8796 | Val  Acc: 0.7424
 Site-SVHN                      (3) | Val  Loss: 1.0635 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8492
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9167
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9211
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9228
 Best site-USPS                     (5)  | Epoch:21 | Val Acc: 0.9327
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.8910
 Best site-USPS                     (6)  | Epoch:21 | Val Acc: 0.8632
 Best site-SynthDigits              (4)  | Epoch:21 | Val Acc: 0.8409
 Best site-SynthDigits              (4)  | Epoch:21 | Val Acc: 0.8535
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.6932
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.7424
 Best site-SVHN                     (3)  | Epoch:21 | Val Acc: 0.6233
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 22 ============
cnt=[5, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (0) | Train Loss: 0.2707 | Train Acc: 0.9111
 Site-MNIST                     (0) | Train Loss: 0.2591 | Train Acc: 0.9408
 Site-MNIST                     (0) | Train Loss: 0.2920 | Train Acc: 0.9191
 Site-MNIST                     (0) | Train Loss: 0.2922 | Train Acc: 0.9185
 Site-MNIST                     (0) | Train Loss: 0.2622 | Train Acc: 0.9352
 Site-USPS                      (1) | Train Loss: 0.3656 | Train Acc: 0.8921
 Site-USPS                      (6) | Train Loss: 0.3307 | Train Acc: 0.9089
 Site-USPS                      (5) | Train Loss: 0.3323 | Train Acc: 0.8999
 Site-SynthDigits               (3) | Train Loss: 0.5597 | Train Acc: 0.8617
 Site-SynthDigits               (3) | Train Loss: 0.4780 | Train Acc: 0.8788
 Site-MNIST_M                   (2) | Train Loss: 0.8224 | Train Acc: 0.7585
 Site-MNIST_M                   (2) | Train Loss: 0.7902 | Train Acc: 0.7860
 Site-SVHN                      (4) | Train Loss: 0.9571 | Train Acc: 0.6899
Average Train Accuracy: 0.8693
 Site-MNIST                     (0) | Val  Loss: 0.2362 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2381 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.2602 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.3166 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2808 | Val  Acc: 0.9404
 Site-USPS                      (1) | Val  Loss: 0.2621 | Val  Acc: 0.9327
 Site-USPS                      (6) | Val  Loss: 0.3302 | Val  Acc: 0.8910
 Site-USPS                      (5) | Val  Loss: 0.3894 | Val  Acc: 0.8632
 Site-SynthDigits               (3) | Val  Loss: 0.6375 | Val  Acc: 0.8258
 Site-SynthDigits               (3) | Val  Loss: 0.4369 | Val  Acc: 0.8636
 Site-MNIST_M                   (2) | Val  Loss: 0.8927 | Val  Acc: 0.6818
 Site-MNIST_M                   (2) | Val  Loss: 0.8902 | Val  Acc: 0.7348
 Site-SVHN                      (4) | Val  Loss: 1.0206 | Val  Acc: 0.6370
Average Valid Accuracy: 0.8526
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9167
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9365
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9316
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9404
 Best site-USPS                     (1)  | Epoch:22 | Val Acc: 0.9327
 Best site-USPS                     (6)  | Epoch:22 | Val Acc: 0.8910
 Best site-USPS                     (5)  | Epoch:22 | Val Acc: 0.8632
 Best site-SynthDigits              (3)  | Epoch:22 | Val Acc: 0.8258
 Best site-SynthDigits              (3)  | Epoch:22 | Val Acc: 0.8636
 Best site-MNIST_M                  (2)  | Epoch:22 | Val Acc: 0.6818
 Best site-MNIST_M                  (2)  | Epoch:22 | Val Acc: 0.7348
 Best site-SVHN                     (4)  | Epoch:22 | Val Acc: 0.6370
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 23 ============
cnt=[1, 2, 1, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (5) | Train Loss: 0.2676 | Train Acc: 0.9200
 Site-MNIST                     (5) | Train Loss: 0.2548 | Train Acc: 0.9408
 Site-MNIST                     (5) | Train Loss: 0.2834 | Train Acc: 0.9191
 Site-MNIST                     (5) | Train Loss: 0.2867 | Train Acc: 0.9198
 Site-MNIST                     (0) | Train Loss: 0.2551 | Train Acc: 0.9370
 Site-USPS                      (3) | Train Loss: 0.3468 | Train Acc: 0.8969
 Site-USPS                      (3) | Train Loss: 0.3287 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.3266 | Train Acc: 0.9020
 Site-SynthDigits               (1) | Train Loss: 0.5321 | Train Acc: 0.8428
 Site-SynthDigits               (1) | Train Loss: 0.4597 | Train Acc: 0.8838
 Site-MNIST_M                   (2) | Train Loss: 0.8369 | Train Acc: 0.7386
 Site-MNIST_M                   (6) | Train Loss: 0.8055 | Train Acc: 0.7822
 Site-SVHN                      (4) | Train Loss: 0.9616 | Train Acc: 0.6865
Average Train Accuracy: 0.8680
 Site-MNIST                     (5) | Val  Loss: 0.2315 | Val  Acc: 0.9107
 Site-MNIST                     (5) | Val  Loss: 0.2346 | Val  Acc: 0.9286
 Site-MNIST                     (5) | Val  Loss: 0.2537 | Val  Acc: 0.9444
 Site-MNIST                     (5) | Val  Loss: 0.3074 | Val  Acc: 0.9263
 Site-MNIST                     (0) | Val  Loss: 0.2740 | Val  Acc: 0.9333
 Site-USPS                      (3) | Val  Loss: 0.2539 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.3200 | Val  Acc: 0.8910
 Site-USPS                      (3) | Val  Loss: 0.3790 | Val  Acc: 0.8632
 Site-SynthDigits               (1) | Val  Loss: 0.6230 | Val  Acc: 0.8409
 Site-SynthDigits               (1) | Val  Loss: 0.4275 | Val  Acc: 0.8737
 Site-MNIST_M                   (2) | Val  Loss: 0.8923 | Val  Acc: 0.6705
 Site-MNIST_M                   (6) | Val  Loss: 0.8674 | Val  Acc: 0.7500
 Site-SVHN                      (4) | Val  Loss: 1.0059 | Val  Acc: 0.6438
Average Valid Accuracy: 0.8553
 Best site-MNIST                    (5)  | Epoch:23 | Val Acc: 0.9107
 Best site-MNIST                    (5)  | Epoch:23 | Val Acc: 0.9286
 Best site-MNIST                    (5)  | Epoch:23 | Val Acc: 0.9444
 Best site-MNIST                    (5)  | Epoch:23 | Val Acc: 0.9263
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9333
 Best site-USPS                     (3)  | Epoch:23 | Val Acc: 0.9423
 Best site-USPS                     (3)  | Epoch:23 | Val Acc: 0.8910
 Best site-USPS                     (3)  | Epoch:23 | Val Acc: 0.8632
 Best site-SynthDigits              (1)  | Epoch:23 | Val Acc: 0.8409
 Best site-SynthDigits              (1)  | Epoch:23 | Val Acc: 0.8737
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.6705
 Best site-MNIST_M                  (6)  | Epoch:23 | Val Acc: 0.7500
 Best site-SVHN                     (4)  | Epoch:23 | Val Acc: 0.6438
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 24 ============
cnt=[2, 5, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (1) | Train Loss: 0.2500 | Train Acc: 0.9289
 Site-MNIST                     (1) | Train Loss: 0.2450 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.2749 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.2770 | Train Acc: 0.9304
 Site-MNIST                     (1) | Train Loss: 0.2445 | Train Acc: 0.9413
 Site-USPS                      (6) | Train Loss: 0.3353 | Train Acc: 0.8993
 Site-USPS                      (0) | Train Loss: 0.3099 | Train Acc: 0.9089
 Site-USPS                      (0) | Train Loss: 0.3123 | Train Acc: 0.9063
 Site-SynthDigits               (4) | Train Loss: 0.5102 | Train Acc: 0.8561
 Site-SynthDigits               (5) | Train Loss: 0.4502 | Train Acc: 0.8952
 Site-MNIST_M                   (2) | Train Loss: 0.8046 | Train Acc: 0.7642
 Site-MNIST_M                   (2) | Train Loss: 0.7944 | Train Acc: 0.7879
 Site-SVHN                      (3) | Train Loss: 0.9353 | Train Acc: 0.7121
Average Train Accuracy: 0.8774
 Site-MNIST                     (1) | Val  Loss: 0.2232 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2285 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2447 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.3010 | Val  Acc: 0.9211
 Site-MNIST                     (1) | Val  Loss: 0.2667 | Val  Acc: 0.9404
 Site-USPS                      (6) | Val  Loss: 0.2450 | Val  Acc: 0.9327
 Site-USPS                      (0) | Val  Loss: 0.3105 | Val  Acc: 0.8846
 Site-USPS                      (0) | Val  Loss: 0.3694 | Val  Acc: 0.8547
 Site-SynthDigits               (4) | Val  Loss: 0.5936 | Val  Acc: 0.8182
 Site-SynthDigits               (5) | Val  Loss: 0.3984 | Val  Acc: 0.8737
 Site-MNIST_M                   (2) | Val  Loss: 0.8739 | Val  Acc: 0.6818
 Site-MNIST_M                   (2) | Val  Loss: 0.8559 | Val  Acc: 0.7500
 Site-SVHN                      (3) | Val  Loss: 0.9728 | Val  Acc: 0.6712
Average Valid Accuracy: 0.8554
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9211
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9404
 Best site-USPS                     (6)  | Epoch:24 | Val Acc: 0.9327
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8846
 Best site-USPS                     (0)  | Epoch:24 | Val Acc: 0.8547
 Best site-SynthDigits              (4)  | Epoch:24 | Val Acc: 0.8182
 Best site-SynthDigits              (5)  | Epoch:24 | Val Acc: 0.8737
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.6818
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7500
 Best site-SVHN                     (3)  | Epoch:24 | Val Acc: 0.6712
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 5, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (1) | Train Loss: 0.2628 | Train Acc: 0.9200
 Site-MNIST                     (1) | Train Loss: 0.2485 | Train Acc: 0.9379
 Site-MNIST                     (1) | Train Loss: 0.2763 | Train Acc: 0.9231
 Site-MNIST                     (1) | Train Loss: 0.2777 | Train Acc: 0.9198
 Site-MNIST                     (1) | Train Loss: 0.2466 | Train Acc: 0.9396
 Site-USPS                      (0) | Train Loss: 0.3320 | Train Acc: 0.9017
 Site-USPS                      (5) | Train Loss: 0.3053 | Train Acc: 0.9105
 Site-USPS                      (0) | Train Loss: 0.3007 | Train Acc: 0.9137
 Site-SynthDigits               (3) | Train Loss: 0.4877 | Train Acc: 0.8617
 Site-SynthDigits               (3) | Train Loss: 0.4252 | Train Acc: 0.8952
 Site-MNIST_M                   (6) | Train Loss: 0.7597 | Train Acc: 0.7784
 Site-MNIST_M                   (2) | Train Loss: 0.7593 | Train Acc: 0.8144
 Site-SVHN                      (4) | Train Loss: 0.9402 | Train Acc: 0.6899
Average Train Accuracy: 0.8774
 Site-MNIST                     (1) | Val  Loss: 0.2328 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2366 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2470 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2986 | Val  Acc: 0.9211
 Site-MNIST                     (1) | Val  Loss: 0.2674 | Val  Acc: 0.9368
 Site-USPS                      (0) | Val  Loss: 0.2358 | Val  Acc: 0.9327
 Site-USPS                      (5) | Val  Loss: 0.3004 | Val  Acc: 0.8910
 Site-USPS                      (0) | Val  Loss: 0.3566 | Val  Acc: 0.8632
 Site-SynthDigits               (3) | Val  Loss: 0.5986 | Val  Acc: 0.8333
 Site-SynthDigits               (3) | Val  Loss: 0.3893 | Val  Acc: 0.8838
 Site-MNIST_M                   (6) | Val  Loss: 0.8181 | Val  Acc: 0.6818
 Site-MNIST_M                   (2) | Val  Loss: 0.8149 | Val  Acc: 0.7576
 Site-SVHN                      (4) | Val  Loss: 0.9733 | Val  Acc: 0.6575
Average Valid Accuracy: 0.8565
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9211
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9368
 Best site-USPS                     (0)  | Epoch:25 | Val Acc: 0.9327
 Best site-USPS                     (5)  | Epoch:25 | Val Acc: 0.8910
 Best site-USPS                     (0)  | Epoch:25 | Val Acc: 0.8632
 Best site-SynthDigits              (3)  | Epoch:25 | Val Acc: 0.8333
 Best site-SynthDigits              (3)  | Epoch:25 | Val Acc: 0.8838
 Best site-MNIST_M                  (6)  | Epoch:25 | Val Acc: 0.6818
 Best site-MNIST_M                  (2)  | Epoch:25 | Val Acc: 0.7576
 Best site-SVHN                     (4)  | Epoch:25 | Val Acc: 0.6575
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 26 ============
cnt=[3, 2, 1, 2, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (6) | Train Loss: 0.2725 | Train Acc: 0.9244
 Site-MNIST                     (6) | Train Loss: 0.2375 | Train Acc: 0.9408
 Site-MNIST                     (6) | Train Loss: 0.2722 | Train Acc: 0.9211
 Site-MNIST                     (1) | Train Loss: 0.2756 | Train Acc: 0.9198
 Site-MNIST                     (1) | Train Loss: 0.2443 | Train Acc: 0.9361
 Site-USPS                      (0) | Train Loss: 0.3263 | Train Acc: 0.8945
 Site-USPS                      (0) | Train Loss: 0.2984 | Train Acc: 0.9121
 Site-USPS                      (0) | Train Loss: 0.3033 | Train Acc: 0.9116
 Site-SynthDigits               (3) | Train Loss: 0.5131 | Train Acc: 0.8617
 Site-SynthDigits               (3) | Train Loss: 0.4319 | Train Acc: 0.8952
 Site-MNIST_M                   (5) | Train Loss: 0.7529 | Train Acc: 0.7898
 Site-MNIST_M                   (2) | Train Loss: 0.7165 | Train Acc: 0.8106
 Site-SVHN                      (4) | Train Loss: 0.9267 | Train Acc: 0.7002
Average Train Accuracy: 0.8783
 Site-MNIST                     (6) | Val  Loss: 0.2297 | Val  Acc: 0.9107
 Site-MNIST                     (6) | Val  Loss: 0.2341 | Val  Acc: 0.9167
 Site-MNIST                     (6) | Val  Loss: 0.2447 | Val  Acc: 0.9444
 Site-MNIST                     (1) | Val  Loss: 0.2937 | Val  Acc: 0.9263
 Site-MNIST                     (1) | Val  Loss: 0.2644 | Val  Acc: 0.9368
 Site-USPS                      (0) | Val  Loss: 0.2326 | Val  Acc: 0.9423
 Site-USPS                      (0) | Val  Loss: 0.2965 | Val  Acc: 0.8974
 Site-USPS                      (0) | Val  Loss: 0.3516 | Val  Acc: 0.8675
 Site-SynthDigits               (3) | Val  Loss: 0.5994 | Val  Acc: 0.8258
 Site-SynthDigits               (3) | Val  Loss: 0.3855 | Val  Acc: 0.8889
 Site-MNIST_M                   (5) | Val  Loss: 0.7980 | Val  Acc: 0.7045
 Site-MNIST_M                   (2) | Val  Loss: 0.8019 | Val  Acc: 0.7803
 Site-SVHN                      (4) | Val  Loss: 0.9499 | Val  Acc: 0.6712
Average Valid Accuracy: 0.8625
 Best site-MNIST                    (6)  | Epoch:26 | Val Acc: 0.9107
 Best site-MNIST                    (6)  | Epoch:26 | Val Acc: 0.9167
 Best site-MNIST                    (6)  | Epoch:26 | Val Acc: 0.9444
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9263
 Best site-MNIST                    (1)  | Epoch:26 | Val Acc: 0.9368
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.9423
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.8974
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.8675
 Best site-SynthDigits              (3)  | Epoch:26 | Val Acc: 0.8258
 Best site-SynthDigits              (3)  | Epoch:26 | Val Acc: 0.8889
 Best site-MNIST_M                  (5)  | Epoch:26 | Val Acc: 0.7045
 Best site-MNIST_M                  (2)  | Epoch:26 | Val Acc: 0.7803
 Best site-SVHN                     (4)  | Epoch:26 | Val Acc: 0.6712
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 3, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (1) | Train Loss: 0.2410 | Train Acc: 0.9244
 Site-MNIST                     (1) | Train Loss: 0.2256 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2657 | Train Acc: 0.9270
 Site-MNIST                     (5) | Train Loss: 0.2689 | Train Acc: 0.9238
 Site-MNIST                     (5) | Train Loss: 0.2357 | Train Acc: 0.9422
 Site-USPS                      (3) | Train Loss: 0.3255 | Train Acc: 0.9017
 Site-USPS                      (6) | Train Loss: 0.2995 | Train Acc: 0.9201
 Site-USPS                      (3) | Train Loss: 0.3007 | Train Acc: 0.9084
 Site-SynthDigits               (4) | Train Loss: 0.4639 | Train Acc: 0.8731
 Site-SynthDigits               (4) | Train Loss: 0.4095 | Train Acc: 0.8990
 Site-MNIST_M                   (2) | Train Loss: 0.7317 | Train Acc: 0.7841
 Site-MNIST_M                   (2) | Train Loss: 0.7357 | Train Acc: 0.8030
 Site-SVHN                      (0) | Train Loss: 0.8732 | Train Acc: 0.7155
Average Train Accuracy: 0.8820
 Site-MNIST                     (1) | Val  Loss: 0.2173 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2248 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2387 | Val  Acc: 0.9365
 Site-MNIST                     (5) | Val  Loss: 0.2886 | Val  Acc: 0.9316
 Site-MNIST                     (5) | Val  Loss: 0.2570 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2360 | Val  Acc: 0.9327
 Site-USPS                      (6) | Val  Loss: 0.2952 | Val  Acc: 0.8974
 Site-USPS                      (3) | Val  Loss: 0.3510 | Val  Acc: 0.8718
 Site-SynthDigits               (4) | Val  Loss: 0.5661 | Val  Acc: 0.8333
 Site-SynthDigits               (4) | Val  Loss: 0.3677 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.7981 | Val  Acc: 0.7159
 Site-MNIST_M                   (2) | Val  Loss: 0.8039 | Val  Acc: 0.7803
 Site-SVHN                      (0) | Val  Loss: 0.9080 | Val  Acc: 0.7055
Average Valid Accuracy: 0.8672
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9365
 Best site-MNIST                    (5)  | Epoch:27 | Val Acc: 0.9316
 Best site-MNIST                    (5)  | Epoch:27 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:27 | Val Acc: 0.9327
 Best site-USPS                     (6)  | Epoch:27 | Val Acc: 0.8974
 Best site-USPS                     (3)  | Epoch:27 | Val Acc: 0.8718
 Best site-SynthDigits              (4)  | Epoch:27 | Val Acc: 0.8333
 Best site-SynthDigits              (4)  | Epoch:27 | Val Acc: 0.8889
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.7159
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.7803
 Best site-SVHN                     (0)  | Epoch:27 | Val Acc: 0.7055
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 28 ============
cnt=[5, 1, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (0) | Train Loss: 0.2624 | Train Acc: 0.9200
 Site-MNIST                     (0) | Train Loss: 0.2260 | Train Acc: 0.9379
 Site-MNIST                     (0) | Train Loss: 0.2669 | Train Acc: 0.9191
 Site-MNIST                     (0) | Train Loss: 0.2708 | Train Acc: 0.9133
 Site-MNIST                     (0) | Train Loss: 0.2362 | Train Acc: 0.9378
 Site-USPS                      (3) | Train Loss: 0.3035 | Train Acc: 0.9065
 Site-USPS                      (3) | Train Loss: 0.2925 | Train Acc: 0.9153
 Site-USPS                      (3) | Train Loss: 0.2859 | Train Acc: 0.9105
 Site-SynthDigits               (5) | Train Loss: 0.4567 | Train Acc: 0.8712
 Site-SynthDigits               (4) | Train Loss: 0.3987 | Train Acc: 0.9003
 Site-MNIST_M                   (2) | Train Loss: 0.7002 | Train Acc: 0.7955
 Site-MNIST_M                   (6) | Train Loss: 0.7042 | Train Acc: 0.8333
 Site-SVHN                      (1) | Train Loss: 0.8735 | Train Acc: 0.7257
Average Train Accuracy: 0.8836
 Site-MNIST                     (0) | Val  Loss: 0.2285 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2329 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.2384 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2890 | Val  Acc: 0.9211
 Site-MNIST                     (0) | Val  Loss: 0.2572 | Val  Acc: 0.9333
 Site-USPS                      (3) | Val  Loss: 0.2287 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.2847 | Val  Acc: 0.8974
 Site-USPS                      (3) | Val  Loss: 0.3341 | Val  Acc: 0.8718
 Site-SynthDigits               (5) | Val  Loss: 0.5241 | Val  Acc: 0.8636
 Site-SynthDigits               (4) | Val  Loss: 0.3575 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.7687 | Val  Acc: 0.7273
 Site-MNIST_M                   (6) | Val  Loss: 0.7725 | Val  Acc: 0.8106
 Site-SVHN                      (1) | Val  Loss: 0.8910 | Val  Acc: 0.6986
Average Valid Accuracy: 0.8701
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9167
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9211
 Best site-MNIST                    (0)  | Epoch:28 | Val Acc: 0.9333
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.9423
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.8974
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.8718
 Best site-SynthDigits              (5)  | Epoch:28 | Val Acc: 0.8636
 Best site-SynthDigits              (4)  | Epoch:28 | Val Acc: 0.8889
 Best site-MNIST_M                  (2)  | Epoch:28 | Val Acc: 0.7273
 Best site-MNIST_M                  (6)  | Epoch:28 | Val Acc: 0.8106
 Best site-SVHN                     (1)  | Epoch:28 | Val Acc: 0.6986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 29 ============
cnt=[2, 2, 1, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (5) | Train Loss: 0.2399 | Train Acc: 0.9244
 Site-MNIST                     (5) | Train Loss: 0.2334 | Train Acc: 0.9408
 Site-MNIST                     (0) | Train Loss: 0.2493 | Train Acc: 0.9310
 Site-MNIST                     (5) | Train Loss: 0.2575 | Train Acc: 0.9251
 Site-MNIST                     (0) | Train Loss: 0.2245 | Train Acc: 0.9413
 Site-USPS                      (3) | Train Loss: 0.3041 | Train Acc: 0.9017
 Site-USPS                      (3) | Train Loss: 0.2781 | Train Acc: 0.9121
 Site-USPS                      (3) | Train Loss: 0.2843 | Train Acc: 0.9127
 Site-SynthDigits               (1) | Train Loss: 0.4439 | Train Acc: 0.8769
 Site-SynthDigits               (1) | Train Loss: 0.3901 | Train Acc: 0.8965
 Site-MNIST_M                   (2) | Train Loss: 0.6851 | Train Acc: 0.8011
 Site-MNIST_M                   (6) | Train Loss: 0.6833 | Train Acc: 0.8258
 Site-SVHN                      (4) | Train Loss: 0.8646 | Train Acc: 0.7240
Average Train Accuracy: 0.8856
 Site-MNIST                     (5) | Val  Loss: 0.2074 | Val  Acc: 0.9107
 Site-MNIST                     (5) | Val  Loss: 0.2144 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2249 | Val  Acc: 0.9444
 Site-MNIST                     (5) | Val  Loss: 0.2733 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2434 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2175 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.2711 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3236 | Val  Acc: 0.8718
 Site-SynthDigits               (1) | Val  Loss: 0.5184 | Val  Acc: 0.8561
 Site-SynthDigits               (1) | Val  Loss: 0.3479 | Val  Acc: 0.8939
 Site-MNIST_M                   (2) | Val  Loss: 0.7572 | Val  Acc: 0.7273
 Site-MNIST_M                   (6) | Val  Loss: 0.7578 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.8786 | Val  Acc: 0.7055
Average Valid Accuracy: 0.8736
 Best site-MNIST                    (5)  | Epoch:29 | Val Acc: 0.9107
 Best site-MNIST                    (5)  | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9444
 Best site-MNIST                    (5)  | Epoch:29 | Val Acc: 0.9316
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9404
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.9327
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.9038
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.8718
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.8561
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.8939
 Best site-MNIST_M                  (2)  | Epoch:29 | Val Acc: 0.7273
 Best site-MNIST_M                  (6)  | Epoch:29 | Val Acc: 0.8106
 Best site-SVHN                     (4)  | Epoch:29 | Val Acc: 0.7055
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 30 ============
cnt=[2, 2, 5, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (2) | Train Loss: 0.2178 | Train Acc: 0.9333
 Site-MNIST                     (2) | Train Loss: 0.2065 | Train Acc: 0.9497
 Site-MNIST                     (2) | Train Loss: 0.2362 | Train Acc: 0.9408
 Site-MNIST                     (2) | Train Loss: 0.2443 | Train Acc: 0.9277
 Site-MNIST                     (2) | Train Loss: 0.2139 | Train Acc: 0.9483
 Site-USPS                      (1) | Train Loss: 0.2991 | Train Acc: 0.8993
 Site-USPS                      (6) | Train Loss: 0.2754 | Train Acc: 0.9137
 Site-USPS                      (1) | Train Loss: 0.2805 | Train Acc: 0.9180
 Site-SynthDigits               (5) | Train Loss: 0.4311 | Train Acc: 0.8693
 Site-SynthDigits               (4) | Train Loss: 0.3924 | Train Acc: 0.9104
 Site-MNIST_M                   (0) | Train Loss: 0.6902 | Train Acc: 0.8040
 Site-MNIST_M                   (0) | Train Loss: 0.6573 | Train Acc: 0.8239
 Site-SVHN                      (3) | Train Loss: 0.8321 | Train Acc: 0.7513
Average Train Accuracy: 0.8915
 Site-MNIST                     (2) | Val  Loss: 0.1901 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2023 | Val  Acc: 0.9405
 Site-MNIST                     (2) | Val  Loss: 0.2160 | Val  Acc: 0.9603
 Site-MNIST                     (2) | Val  Loss: 0.2635 | Val  Acc: 0.9368
 Site-MNIST                     (2) | Val  Loss: 0.2322 | Val  Acc: 0.9404
 Site-USPS                      (1) | Val  Loss: 0.2166 | Val  Acc: 0.9327
 Site-USPS                      (6) | Val  Loss: 0.2699 | Val  Acc: 0.9038
 Site-USPS                      (1) | Val  Loss: 0.3245 | Val  Acc: 0.8718
 Site-SynthDigits               (5) | Val  Loss: 0.5136 | Val  Acc: 0.8485
 Site-SynthDigits               (4) | Val  Loss: 0.3380 | Val  Acc: 0.9040
 Site-MNIST_M                   (0) | Val  Loss: 0.7586 | Val  Acc: 0.7159
 Site-MNIST_M                   (0) | Val  Loss: 0.7523 | Val  Acc: 0.8409
 Site-SVHN                      (3) | Val  Loss: 0.8340 | Val  Acc: 0.7192
Average Valid Accuracy: 0.8803
 Best site-MNIST                    (2)  | Epoch:30 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:30 | Val Acc: 0.9405
 Best site-MNIST                    (2)  | Epoch:30 | Val Acc: 0.9603
 Best site-MNIST                    (2)  | Epoch:30 | Val Acc: 0.9368
 Best site-MNIST                    (2)  | Epoch:30 | Val Acc: 0.9404
 Best site-USPS                     (1)  | Epoch:30 | Val Acc: 0.9327
 Best site-USPS                     (6)  | Epoch:30 | Val Acc: 0.9038
 Best site-USPS                     (1)  | Epoch:30 | Val Acc: 0.8718
 Best site-SynthDigits              (5)  | Epoch:30 | Val Acc: 0.8485
 Best site-SynthDigits              (4)  | Epoch:30 | Val Acc: 0.9040
 Best site-MNIST_M                  (0)  | Epoch:30 | Val Acc: 0.7159
 Best site-MNIST_M                  (0)  | Epoch:30 | Val Acc: 0.8409
 Best site-SVHN                     (3)  | Epoch:30 | Val Acc: 0.7192
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 2, 1, 2, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (6) | Train Loss: 0.2231 | Train Acc: 0.9333
 Site-MNIST                     (6) | Train Loss: 0.2137 | Train Acc: 0.9467
 Site-MNIST                     (2) | Train Loss: 0.2355 | Train Acc: 0.9329
 Site-MNIST                     (6) | Train Loss: 0.2480 | Train Acc: 0.9251
 Site-MNIST                     (6) | Train Loss: 0.2127 | Train Acc: 0.9492
 Site-USPS                      (5) | Train Loss: 0.2796 | Train Acc: 0.9161
 Site-USPS                      (1) | Train Loss: 0.2621 | Train Acc: 0.9201
 Site-USPS                      (1) | Train Loss: 0.2616 | Train Acc: 0.9223
 Site-SynthDigits               (3) | Train Loss: 0.4301 | Train Acc: 0.8788
 Site-SynthDigits               (3) | Train Loss: 0.3777 | Train Acc: 0.9104
 Site-MNIST_M                   (0) | Train Loss: 0.6475 | Train Acc: 0.8040
 Site-MNIST_M                   (0) | Train Loss: 0.6546 | Train Acc: 0.8239
 Site-SVHN                      (4) | Train Loss: 0.8586 | Train Acc: 0.7479
Average Train Accuracy: 0.8931
 Site-MNIST                     (6) | Val  Loss: 0.1908 | Val  Acc: 0.9107
 Site-MNIST                     (6) | Val  Loss: 0.2018 | Val  Acc: 0.9167
 Site-MNIST                     (2) | Val  Loss: 0.2159 | Val  Acc: 0.9444
 Site-MNIST                     (6) | Val  Loss: 0.2592 | Val  Acc: 0.9368
 Site-MNIST                     (6) | Val  Loss: 0.2302 | Val  Acc: 0.9368
 Site-USPS                      (5) | Val  Loss: 0.1961 | Val  Acc: 0.9519
 Site-USPS                      (1) | Val  Loss: 0.2577 | Val  Acc: 0.9103
 Site-USPS                      (1) | Val  Loss: 0.3094 | Val  Acc: 0.8761
 Site-SynthDigits               (3) | Val  Loss: 0.5197 | Val  Acc: 0.8409
 Site-SynthDigits               (3) | Val  Loss: 0.3307 | Val  Acc: 0.8939
 Site-MNIST_M                   (0) | Val  Loss: 0.7281 | Val  Acc: 0.7727
 Site-MNIST_M                   (0) | Val  Loss: 0.7335 | Val  Acc: 0.8182
 Site-SVHN                      (4) | Val  Loss: 0.8318 | Val  Acc: 0.7260
Average Valid Accuracy: 0.8797
============ Train epoch 32 ============
cnt=[1, 2, 1, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (5) | Train Loss: 0.2358 | Train Acc: 0.9244
 Site-MNIST                     (5) | Train Loss: 0.2029 | Train Acc: 0.9408
 Site-MNIST                     (5) | Train Loss: 0.2363 | Train Acc: 0.9270
 Site-MNIST                     (5) | Train Loss: 0.2474 | Train Acc: 0.9277
 Site-MNIST                     (0) | Train Loss: 0.2132 | Train Acc: 0.9466
 Site-USPS                      (3) | Train Loss: 0.3021 | Train Acc: 0.9113
 Site-USPS                      (3) | Train Loss: 0.2646 | Train Acc: 0.9201
 Site-USPS                      (3) | Train Loss: 0.2659 | Train Acc: 0.9201
 Site-SynthDigits               (1) | Train Loss: 0.4154 | Train Acc: 0.8807
 Site-SynthDigits               (1) | Train Loss: 0.3789 | Train Acc: 0.9116
 Site-MNIST_M                   (6) | Train Loss: 0.6388 | Train Acc: 0.7926
 Site-MNIST_M                   (2) | Train Loss: 0.6599 | Train Acc: 0.8201
 Site-SVHN                      (4) | Train Loss: 0.7551 | Train Acc: 0.7581
Average Train Accuracy: 0.8909
 Site-MNIST                     (5) | Val  Loss: 0.2021 | Val  Acc: 0.9107
 Site-MNIST                     (5) | Val  Loss: 0.2054 | Val  Acc: 0.9167
 Site-MNIST                     (5) | Val  Loss: 0.2163 | Val  Acc: 0.9444
 Site-MNIST                     (5) | Val  Loss: 0.2601 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2316 | Val  Acc: 0.9368
 Site-USPS                      (3) | Val  Loss: 0.2002 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.2580 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.3078 | Val  Acc: 0.8761
 Site-SynthDigits               (1) | Val  Loss: 0.4780 | Val  Acc: 0.8561
 Site-SynthDigits               (1) | Val  Loss: 0.3189 | Val  Acc: 0.9040
 Site-MNIST_M                   (6) | Val  Loss: 0.7289 | Val  Acc: 0.7159
 Site-MNIST_M                   (2) | Val  Loss: 0.7288 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.8148 | Val  Acc: 0.7329
Average Valid Accuracy: 0.8753
============ Train epoch 33 ============
cnt=[2, 4, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (1) | Train Loss: 0.2550 | Train Acc: 0.9289
 Site-MNIST                     (1) | Train Loss: 0.2297 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2382 | Train Acc: 0.9250
 Site-MNIST                     (1) | Train Loss: 0.2494 | Train Acc: 0.9198
 Site-MNIST                     (6) | Train Loss: 0.2137 | Train Acc: 0.9422
 Site-USPS                      (0) | Train Loss: 0.2902 | Train Acc: 0.9113
 Site-USPS                      (5) | Train Loss: 0.2563 | Train Acc: 0.9217
 Site-USPS                      (0) | Train Loss: 0.2594 | Train Acc: 0.9223
 Site-SynthDigits               (2) | Train Loss: 0.4318 | Train Acc: 0.8807
 Site-SynthDigits               (2) | Train Loss: 0.3675 | Train Acc: 0.9066
 Site-MNIST_M                   (3) | Train Loss: 0.6427 | Train Acc: 0.8210
 Site-MNIST_M                   (3) | Train Loss: 0.6327 | Train Acc: 0.8371
 Site-SVHN                      (4) | Train Loss: 0.7865 | Train Acc: 0.7666
Average Train Accuracy: 0.8944
 Site-MNIST                     (1) | Val  Loss: 0.2001 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2075 | Val  Acc: 0.9167
 Site-MNIST                     (1) | Val  Loss: 0.2171 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2589 | Val  Acc: 0.9368
 Site-MNIST                     (6) | Val  Loss: 0.2312 | Val  Acc: 0.9439
 Site-USPS                      (0) | Val  Loss: 0.1951 | Val  Acc: 0.9423
 Site-USPS                      (5) | Val  Loss: 0.2501 | Val  Acc: 0.9103
 Site-USPS                      (0) | Val  Loss: 0.2994 | Val  Acc: 0.8761
 Site-SynthDigits               (2) | Val  Loss: 0.5003 | Val  Acc: 0.8333
 Site-SynthDigits               (2) | Val  Loss: 0.3168 | Val  Acc: 0.9141
 Site-MNIST_M                   (3) | Val  Loss: 0.7205 | Val  Acc: 0.7727
 Site-MNIST_M                   (3) | Val  Loss: 0.7263 | Val  Acc: 0.8182
 Site-SVHN                      (4) | Val  Loss: 0.7998 | Val  Acc: 0.7329
Average Valid Accuracy: 0.8803
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9167
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:33 | Val Acc: 0.9368
 Best site-MNIST                    (6)  | Epoch:33 | Val Acc: 0.9439
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.9423
 Best site-USPS                     (5)  | Epoch:33 | Val Acc: 0.9103
 Best site-USPS                     (0)  | Epoch:33 | Val Acc: 0.8761
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.8333
 Best site-SynthDigits              (2)  | Epoch:33 | Val Acc: 0.9141
 Best site-MNIST_M                  (3)  | Epoch:33 | Val Acc: 0.7727
 Best site-MNIST_M                  (3)  | Epoch:33 | Val Acc: 0.8182
 Best site-SVHN                     (4)  | Epoch:33 | Val Acc: 0.7329
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 34 ============
cnt=[2, 2, 5, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (2) | Train Loss: 0.2274 | Train Acc: 0.9378
 Site-MNIST                     (2) | Train Loss: 0.2028 | Train Acc: 0.9438
 Site-MNIST                     (2) | Train Loss: 0.2292 | Train Acc: 0.9290
 Site-MNIST                     (2) | Train Loss: 0.2378 | Train Acc: 0.9264
 Site-MNIST                     (2) | Train Loss: 0.2054 | Train Acc: 0.9457
 Site-USPS                      (0) | Train Loss: 0.2725 | Train Acc: 0.9161
 Site-USPS                      (0) | Train Loss: 0.2533 | Train Acc: 0.9233
 Site-USPS                      (6) | Train Loss: 0.2531 | Train Acc: 0.9244
 Site-SynthDigits               (1) | Train Loss: 0.4303 | Train Acc: 0.8826
 Site-SynthDigits               (1) | Train Loss: 0.3613 | Train Acc: 0.9167
 Site-MNIST_M                   (3) | Train Loss: 0.6191 | Train Acc: 0.8153
 Site-MNIST_M                   (5) | Train Loss: 0.6161 | Train Acc: 0.8466
 Site-SVHN                      (4) | Train Loss: 0.7449 | Train Acc: 0.7751
Average Train Accuracy: 0.8987
 Site-MNIST                     (2) | Val  Loss: 0.1896 | Val  Acc: 0.9107
 Site-MNIST                     (2) | Val  Loss: 0.1981 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2081 | Val  Acc: 0.9444
 Site-MNIST                     (2) | Val  Loss: 0.2496 | Val  Acc: 0.9316
 Site-MNIST                     (2) | Val  Loss: 0.2232 | Val  Acc: 0.9404
 Site-USPS                      (0) | Val  Loss: 0.1892 | Val  Acc: 0.9615
 Site-USPS                      (0) | Val  Loss: 0.2433 | Val  Acc: 0.9167
 Site-USPS                      (6) | Val  Loss: 0.2930 | Val  Acc: 0.8803
 Site-SynthDigits               (1) | Val  Loss: 0.5128 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.3144 | Val  Acc: 0.9192
 Site-MNIST_M                   (3) | Val  Loss: 0.7128 | Val  Acc: 0.7614
 Site-MNIST_M                   (5) | Val  Loss: 0.7111 | Val  Acc: 0.8182
 Site-SVHN                      (4) | Val  Loss: 0.7863 | Val  Acc: 0.7397
Average Valid Accuracy: 0.8870
 Best site-MNIST                    (2)  | Epoch:34 | Val Acc: 0.9107
 Best site-MNIST                    (2)  | Epoch:34 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:34 | Val Acc: 0.9444
 Best site-MNIST                    (2)  | Epoch:34 | Val Acc: 0.9316
 Best site-MNIST                    (2)  | Epoch:34 | Val Acc: 0.9404
 Best site-USPS                     (0)  | Epoch:34 | Val Acc: 0.9615
 Best site-USPS                     (0)  | Epoch:34 | Val Acc: 0.9167
 Best site-USPS                     (6)  | Epoch:34 | Val Acc: 0.8803
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8788
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.9192
 Best site-MNIST_M                  (3)  | Epoch:34 | Val Acc: 0.7614
 Best site-MNIST_M                  (5)  | Epoch:34 | Val Acc: 0.8182
 Best site-SVHN                     (4)  | Epoch:34 | Val Acc: 0.7397
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 35 ============
cnt=[1, 5, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (1) | Train Loss: 0.2158 | Train Acc: 0.9378
 Site-MNIST                     (1) | Train Loss: 0.1842 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.2169 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2311 | Train Acc: 0.9264
 Site-MNIST                     (1) | Train Loss: 0.1983 | Train Acc: 0.9492
 Site-USPS                      (3) | Train Loss: 0.2613 | Train Acc: 0.9185
 Site-USPS                      (3) | Train Loss: 0.2532 | Train Acc: 0.9249
 Site-USPS                      (3) | Train Loss: 0.2481 | Train Acc: 0.9276
 Site-SynthDigits               (6) | Train Loss: 0.4023 | Train Acc: 0.8845
 Site-SynthDigits               (2) | Train Loss: 0.3666 | Train Acc: 0.9116
 Site-MNIST_M                   (5) | Train Loss: 0.6033 | Train Acc: 0.8239
 Site-MNIST_M                   (0) | Train Loss: 0.6424 | Train Acc: 0.8333
 Site-SVHN                      (4) | Train Loss: 0.7464 | Train Acc: 0.7683
Average Train Accuracy: 0.8994
 Site-MNIST                     (1) | Val  Loss: 0.1817 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1887 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1993 | Val  Acc: 0.9444
 Site-MNIST                     (1) | Val  Loss: 0.2381 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.2149 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.1805 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2403 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2876 | Val  Acc: 0.8718
 Site-SynthDigits               (6) | Val  Loss: 0.4726 | Val  Acc: 0.8561
 Site-SynthDigits               (2) | Val  Loss: 0.3023 | Val  Acc: 0.9141
 Site-MNIST_M                   (5) | Val  Loss: 0.6930 | Val  Acc: 0.7614
 Site-MNIST_M                   (0) | Val  Loss: 0.6919 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.7807 | Val  Acc: 0.7329
Average Valid Accuracy: 0.8848
============ Train epoch 36 ============
cnt=[1, 5, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (1) | Train Loss: 0.1996 | Train Acc: 0.9378
 Site-MNIST                     (1) | Train Loss: 0.2220 | Train Acc: 0.9497
 Site-MNIST                     (1) | Train Loss: 0.2125 | Train Acc: 0.9369
 Site-MNIST                     (1) | Train Loss: 0.2277 | Train Acc: 0.9290
 Site-MNIST                     (1) | Train Loss: 0.1937 | Train Acc: 0.9492
 Site-USPS                      (5) | Train Loss: 0.2632 | Train Acc: 0.9209
 Site-USPS                      (3) | Train Loss: 0.2387 | Train Acc: 0.9329
 Site-USPS                      (3) | Train Loss: 0.2389 | Train Acc: 0.9297
 Site-SynthDigits               (6) | Train Loss: 0.4102 | Train Acc: 0.8826
 Site-SynthDigits               (4) | Train Loss: 0.3440 | Train Acc: 0.9104
 Site-MNIST_M                   (2) | Train Loss: 0.5979 | Train Acc: 0.8295
 Site-MNIST_M                   (2) | Train Loss: 0.6144 | Train Acc: 0.8371
 Site-SVHN                      (0) | Train Loss: 0.7345 | Train Acc: 0.7802
Average Train Accuracy: 0.9020
 Site-MNIST                     (1) | Val  Loss: 0.1720 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1824 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1976 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2344 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.2100 | Val  Acc: 0.9439
 Site-USPS                      (5) | Val  Loss: 0.1740 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2330 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2817 | Val  Acc: 0.8803
 Site-SynthDigits               (6) | Val  Loss: 0.4826 | Val  Acc: 0.8636
 Site-SynthDigits               (4) | Val  Loss: 0.2950 | Val  Acc: 0.9192
 Site-MNIST_M                   (2) | Val  Loss: 0.6821 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.6847 | Val  Acc: 0.8258
 Site-SVHN                      (0) | Val  Loss: 0.7760 | Val  Acc: 0.7329
Average Valid Accuracy: 0.8901
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9368
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9439
 Best site-USPS                     (5)  | Epoch:36 | Val Acc: 0.9519
 Best site-USPS                     (3)  | Epoch:36 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:36 | Val Acc: 0.8803
 Best site-SynthDigits              (6)  | Epoch:36 | Val Acc: 0.8636
 Best site-SynthDigits              (4)  | Epoch:36 | Val Acc: 0.9192
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:36 | Val Acc: 0.8258
 Best site-SVHN                     (0)  | Epoch:36 | Val Acc: 0.7329
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 37 ============
cnt=[5, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (0) | Train Loss: 0.2071 | Train Acc: 0.9378
 Site-MNIST                     (0) | Train Loss: 0.1690 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.2063 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2234 | Train Acc: 0.9304
 Site-MNIST                     (0) | Train Loss: 0.1903 | Train Acc: 0.9475
 Site-USPS                      (3) | Train Loss: 0.2684 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2361 | Train Acc: 0.9329
 Site-USPS                      (6) | Train Loss: 0.2399 | Train Acc: 0.9255
 Site-SynthDigits               (5) | Train Loss: 0.4024 | Train Acc: 0.8902
 Site-SynthDigits               (1) | Train Loss: 0.3500 | Train Acc: 0.9154
 Site-MNIST_M                   (2) | Train Loss: 0.6062 | Train Acc: 0.8438
 Site-MNIST_M                   (2) | Train Loss: 0.5820 | Train Acc: 0.8428
 Site-SVHN                      (4) | Train Loss: 0.7397 | Train Acc: 0.7632
Average Train Accuracy: 0.9027
 Site-MNIST                     (0) | Val  Loss: 0.1608 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1699 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.1925 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2280 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.2041 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1724 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2355 | Val  Acc: 0.9167
 Site-USPS                      (6) | Val  Loss: 0.2808 | Val  Acc: 0.8889
 Site-SynthDigits               (5) | Val  Loss: 0.4694 | Val  Acc: 0.8636
 Site-SynthDigits               (1) | Val  Loss: 0.2939 | Val  Acc: 0.9091
 Site-MNIST_M                   (2) | Val  Loss: 0.6733 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.6887 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.7638 | Val  Acc: 0.7397
Average Valid Accuracy: 0.8900
============ Train epoch 38 ============
cnt=[3, 2, 1, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (3) | Train Loss: 0.1874 | Train Acc: 0.9467
 Site-MNIST                     (6) | Train Loss: 0.1674 | Train Acc: 0.9527
 Site-MNIST                     (3) | Train Loss: 0.1977 | Train Acc: 0.9546
 Site-MNIST                     (6) | Train Loss: 0.2147 | Train Acc: 0.9343
 Site-MNIST                     (3) | Train Loss: 0.1828 | Train Acc: 0.9501
 Site-USPS                      (0) | Train Loss: 0.2637 | Train Acc: 0.9185
 Site-USPS                      (0) | Train Loss: 0.2320 | Train Acc: 0.9329
 Site-USPS                      (0) | Train Loss: 0.2334 | Train Acc: 0.9340
 Site-SynthDigits               (1) | Train Loss: 0.3919 | Train Acc: 0.8883
 Site-SynthDigits               (1) | Train Loss: 0.3337 | Train Acc: 0.9230
 Site-MNIST_M                   (5) | Train Loss: 0.5821 | Train Acc: 0.8352
 Site-MNIST_M                   (2) | Train Loss: 0.5982 | Train Acc: 0.8485
 Site-SVHN                      (4) | Train Loss: 0.7476 | Train Acc: 0.7785
Average Train Accuracy: 0.9075
 Site-MNIST                     (3) | Val  Loss: 0.1507 | Val  Acc: 0.9821
 Site-MNIST                     (6) | Val  Loss: 0.1618 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1835 | Val  Acc: 0.9524
 Site-MNIST                     (6) | Val  Loss: 0.2223 | Val  Acc: 0.9368
 Site-MNIST                     (3) | Val  Loss: 0.1982 | Val  Acc: 0.9474
 Site-USPS                      (0) | Val  Loss: 0.1687 | Val  Acc: 0.9615
 Site-USPS                      (0) | Val  Loss: 0.2316 | Val  Acc: 0.9231
 Site-USPS                      (0) | Val  Loss: 0.2778 | Val  Acc: 0.8846
 Site-SynthDigits               (1) | Val  Loss: 0.4593 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.2866 | Val  Acc: 0.9091
 Site-MNIST_M                   (5) | Val  Loss: 0.6675 | Val  Acc: 0.8068
 Site-MNIST_M                   (2) | Val  Loss: 0.6839 | Val  Acc: 0.8182
 Site-SVHN                      (4) | Val  Loss: 0.7435 | Val  Acc: 0.7397
Average Valid Accuracy: 0.9004
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9821
 Best site-MNIST                    (6)  | Epoch:38 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9524
 Best site-MNIST                    (6)  | Epoch:38 | Val Acc: 0.9368
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9474
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.9615
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.9231
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.8846
 Best site-SynthDigits              (1)  | Epoch:38 | Val Acc: 0.8788
 Best site-SynthDigits              (1)  | Epoch:38 | Val Acc: 0.9091
 Best site-MNIST_M                  (5)  | Epoch:38 | Val Acc: 0.8068
 Best site-MNIST_M                  (2)  | Epoch:38 | Val Acc: 0.8182
 Best site-SVHN                     (4)  | Epoch:38 | Val Acc: 0.7397
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 39 ============
cnt=[5, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (0) | Train Loss: 0.1929 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.1927 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.1958 | Train Acc: 0.9507
 Site-MNIST                     (0) | Train Loss: 0.2103 | Train Acc: 0.9356
 Site-MNIST                     (0) | Train Loss: 0.1785 | Train Acc: 0.9510
 Site-USPS                      (6) | Train Loss: 0.2644 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2303 | Train Acc: 0.9313
 Site-USPS                      (3) | Train Loss: 0.2345 | Train Acc: 0.9308
 Site-SynthDigits               (4) | Train Loss: 0.3764 | Train Acc: 0.8920
 Site-SynthDigits               (4) | Train Loss: 0.3332 | Train Acc: 0.9154
 Site-MNIST_M                   (2) | Train Loss: 0.5657 | Train Acc: 0.8295
 Site-MNIST_M                   (5) | Train Loss: 0.5813 | Train Acc: 0.8447
 Site-SVHN                      (1) | Train Loss: 0.7407 | Train Acc: 0.7871
Average Train Accuracy: 0.9070
 Site-MNIST                     (0) | Val  Loss: 0.1473 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1571 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.1819 | Val  Acc: 0.9603
 Site-MNIST                     (0) | Val  Loss: 0.2206 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1962 | Val  Acc: 0.9474
 Site-USPS                      (6) | Val  Loss: 0.1673 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2252 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2753 | Val  Acc: 0.8889
 Site-SynthDigits               (4) | Val  Loss: 0.4541 | Val  Acc: 0.8712
 Site-SynthDigits               (4) | Val  Loss: 0.2850 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.6616 | Val  Acc: 0.7955
 Site-MNIST_M                   (5) | Val  Loss: 0.6644 | Val  Acc: 0.8333
 Site-SVHN                      (1) | Val  Loss: 0.7387 | Val  Acc: 0.7466
Average Valid Accuracy: 0.8996
============ Train epoch 40 ============
cnt=[1, 5, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.1997 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.1757 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.1945 | Train Acc: 0.9487
 Site-MNIST                     (1) | Train Loss: 0.2126 | Train Acc: 0.9382
 Site-MNIST                     (1) | Train Loss: 0.1801 | Train Acc: 0.9501
 Site-USPS                      (3) | Train Loss: 0.2647 | Train Acc: 0.9233
 Site-USPS                      (5) | Train Loss: 0.2218 | Train Acc: 0.9329
 Site-USPS                      (3) | Train Loss: 0.2321 | Train Acc: 0.9340
 Site-SynthDigits               (6) | Train Loss: 0.3638 | Train Acc: 0.8788
 Site-SynthDigits               (0) | Train Loss: 0.3198 | Train Acc: 0.9192
 Site-MNIST_M                   (2) | Train Loss: 0.5775 | Train Acc: 0.8438
 Site-MNIST_M                   (2) | Train Loss: 0.5866 | Train Acc: 0.8504
 Site-SVHN                      (4) | Train Loss: 0.6805 | Train Acc: 0.7836
Average Train Accuracy: 0.9081
 Site-MNIST                     (1) | Val  Loss: 0.1474 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.1570 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1821 | Val  Acc: 0.9603
 Site-MNIST                     (1) | Val  Loss: 0.2191 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.1949 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1625 | Val  Acc: 0.9615
 Site-USPS                      (5) | Val  Loss: 0.2234 | Val  Acc: 0.9295
 Site-USPS                      (3) | Val  Loss: 0.2698 | Val  Acc: 0.8889
 Site-SynthDigits               (6) | Val  Loss: 0.4478 | Val  Acc: 0.8712
 Site-SynthDigits               (0) | Val  Loss: 0.2794 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.6510 | Val  Acc: 0.7955
 Site-MNIST_M                   (2) | Val  Loss: 0.6583 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.7201 | Val  Acc: 0.7671
Average Valid Accuracy: 0.8995
============ Train epoch 41 ============
cnt=[2, 4, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (1) | Train Loss: 0.1977 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.1695 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.1966 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.2104 | Train Acc: 0.9317
 Site-MNIST                     (5) | Train Loss: 0.1773 | Train Acc: 0.9501
 Site-USPS                      (3) | Train Loss: 0.2515 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2204 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2214 | Train Acc: 0.9340
 Site-SynthDigits               (0) | Train Loss: 0.3600 | Train Acc: 0.8977
 Site-SynthDigits               (0) | Train Loss: 0.3236 | Train Acc: 0.9242
 Site-MNIST_M                   (6) | Train Loss: 0.5514 | Train Acc: 0.8494
 Site-MNIST_M                   (2) | Train Loss: 0.5832 | Train Acc: 0.8504
 Site-SVHN                      (4) | Train Loss: 0.7192 | Train Acc: 0.7888
Average Train Accuracy: 0.9100
 Site-MNIST                     (1) | Val  Loss: 0.1502 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.1594 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1801 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2178 | Val  Acc: 0.9368
 Site-MNIST                     (5) | Val  Loss: 0.1939 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.1566 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2175 | Val  Acc: 0.9295
 Site-USPS                      (3) | Val  Loss: 0.2583 | Val  Acc: 0.8932
 Site-SynthDigits               (0) | Val  Loss: 0.4372 | Val  Acc: 0.8788
 Site-SynthDigits               (0) | Val  Loss: 0.2763 | Val  Acc: 0.9141
 Site-MNIST_M                   (6) | Val  Loss: 0.6195 | Val  Acc: 0.8182
 Site-MNIST_M                   (2) | Val  Loss: 0.6323 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.7297 | Val  Acc: 0.7466
Average Valid Accuracy: 0.9002
============ Train epoch 42 ============
cnt=[2, 2, 1, 3, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (0) | Train Loss: 0.1761 | Train Acc: 0.9511
 Site-MNIST                     (6) | Train Loss: 0.1760 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.1916 | Train Acc: 0.9527
 Site-MNIST                     (6) | Train Loss: 0.2072 | Train Acc: 0.9356
 Site-MNIST                     (6) | Train Loss: 0.1733 | Train Acc: 0.9527
 Site-USPS                      (3) | Train Loss: 0.2355 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2130 | Train Acc: 0.9393
 Site-USPS                      (3) | Train Loss: 0.2190 | Train Acc: 0.9350
 Site-SynthDigits               (1) | Train Loss: 0.3675 | Train Acc: 0.8958
 Site-SynthDigits               (1) | Train Loss: 0.3307 | Train Acc: 0.9179
 Site-MNIST_M                   (2) | Train Loss: 0.5388 | Train Acc: 0.8523
 Site-MNIST_M                   (5) | Train Loss: 0.5603 | Train Acc: 0.8447
 Site-SVHN                      (4) | Train Loss: 0.6662 | Train Acc: 0.7888
Average Train Accuracy: 0.9109
 Site-MNIST                     (0) | Val  Loss: 0.1428 | Val  Acc: 0.9464
 Site-MNIST                     (6) | Val  Loss: 0.1539 | Val  Acc: 0.9405
 Site-MNIST                     (0) | Val  Loss: 0.1755 | Val  Acc: 0.9603
 Site-MNIST                     (6) | Val  Loss: 0.2147 | Val  Acc: 0.9368
 Site-MNIST                     (6) | Val  Loss: 0.1921 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.1549 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2112 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2543 | Val  Acc: 0.8932
 Site-SynthDigits               (1) | Val  Loss: 0.4596 | Val  Acc: 0.8864
 Site-SynthDigits               (1) | Val  Loss: 0.2755 | Val  Acc: 0.9192
 Site-MNIST_M                   (2) | Val  Loss: 0.6157 | Val  Acc: 0.8182
 Site-MNIST_M                   (5) | Val  Loss: 0.6373 | Val  Acc: 0.8182
 Site-SVHN                      (4) | Val  Loss: 0.7186 | Val  Acc: 0.7671
Average Valid Accuracy: 0.9011
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9464
 Best site-MNIST                    (6)  | Epoch:42 | Val Acc: 0.9405
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9603
 Best site-MNIST                    (6)  | Epoch:42 | Val Acc: 0.9368
 Best site-MNIST                    (6)  | Epoch:42 | Val Acc: 0.9439
 Best site-USPS                     (3)  | Epoch:42 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:42 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:42 | Val Acc: 0.8932
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.8864
 Best site-SynthDigits              (1)  | Epoch:42 | Val Acc: 0.9192
 Best site-MNIST_M                  (2)  | Epoch:42 | Val Acc: 0.8182
 Best site-MNIST_M                  (5)  | Epoch:42 | Val Acc: 0.8182
 Best site-SVHN                     (4)  | Epoch:42 | Val Acc: 0.7671
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 2, 2, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (3) | Train Loss: 0.1814 | Train Acc: 0.9511
 Site-MNIST                     (3) | Train Loss: 0.1658 | Train Acc: 0.9527
 Site-MNIST                     (3) | Train Loss: 0.1844 | Train Acc: 0.9527
 Site-MNIST                     (3) | Train Loss: 0.2017 | Train Acc: 0.9369
 Site-MNIST                     (3) | Train Loss: 0.1677 | Train Acc: 0.9553
 Site-USPS                      (1) | Train Loss: 0.2387 | Train Acc: 0.9185
 Site-USPS                      (6) | Train Loss: 0.2152 | Train Acc: 0.9377
 Site-USPS                      (1) | Train Loss: 0.2219 | Train Acc: 0.9329
 Site-SynthDigits               (2) | Train Loss: 0.3589 | Train Acc: 0.8996
 Site-SynthDigits               (2) | Train Loss: 0.3199 | Train Acc: 0.9230
 Site-MNIST_M                   (0) | Train Loss: 0.5331 | Train Acc: 0.8523
 Site-MNIST_M                   (5) | Train Loss: 0.5433 | Train Acc: 0.8485
 Site-SVHN                      (4) | Train Loss: 0.6623 | Train Acc: 0.7922
Average Train Accuracy: 0.9118
 Site-MNIST                     (3) | Val  Loss: 0.1378 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1511 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1698 | Val  Acc: 0.9603
 Site-MNIST                     (3) | Val  Loss: 0.2105 | Val  Acc: 0.9368
 Site-MNIST                     (3) | Val  Loss: 0.1879 | Val  Acc: 0.9474
 Site-USPS                      (1) | Val  Loss: 0.1528 | Val  Acc: 0.9615
 Site-USPS                      (6) | Val  Loss: 0.2107 | Val  Acc: 0.9295
 Site-USPS                      (1) | Val  Loss: 0.2560 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4529 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 0.2679 | Val  Acc: 0.9242
 Site-MNIST_M                   (0) | Val  Loss: 0.6052 | Val  Acc: 0.8068
 Site-MNIST_M                   (5) | Val  Loss: 0.6399 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.7085 | Val  Acc: 0.7534
Average Valid Accuracy: 0.9032
 Best site-MNIST                    (3)  | Epoch:43 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:43 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:43 | Val Acc: 0.9603
 Best site-MNIST                    (3)  | Epoch:43 | Val Acc: 0.9368
 Best site-MNIST                    (3)  | Epoch:43 | Val Acc: 0.9474
 Best site-USPS                     (1)  | Epoch:43 | Val Acc: 0.9615
 Best site-USPS                     (6)  | Epoch:43 | Val Acc: 0.9295
 Best site-USPS                     (1)  | Epoch:43 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:43 | Val Acc: 0.8788
 Best site-SynthDigits              (2)  | Epoch:43 | Val Acc: 0.9242
 Best site-MNIST_M                  (0)  | Epoch:43 | Val Acc: 0.8068
 Best site-MNIST_M                  (5)  | Epoch:43 | Val Acc: 0.8258
 Best site-SVHN                     (4)  | Epoch:43 | Val Acc: 0.7534
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 44 ============
cnt=[1, 2, 1, 5, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (3) | Train Loss: 0.1701 | Train Acc: 0.9511
 Site-MNIST                     (3) | Train Loss: 0.1519 | Train Acc: 0.9527
 Site-MNIST                     (3) | Train Loss: 0.1818 | Train Acc: 0.9507
 Site-MNIST                     (3) | Train Loss: 0.1985 | Train Acc: 0.9382
 Site-MNIST                     (3) | Train Loss: 0.1666 | Train Acc: 0.9562
 Site-USPS                      (6) | Train Loss: 0.2309 | Train Acc: 0.9233
 Site-USPS                      (6) | Train Loss: 0.2129 | Train Acc: 0.9409
 Site-USPS                      (0) | Train Loss: 0.2134 | Train Acc: 0.9414
 Site-SynthDigits               (1) | Train Loss: 0.3348 | Train Acc: 0.9091
 Site-SynthDigits               (1) | Train Loss: 0.3079 | Train Acc: 0.9255
 Site-MNIST_M                   (2) | Train Loss: 0.5350 | Train Acc: 0.8551
 Site-MNIST_M                   (5) | Train Loss: 0.5432 | Train Acc: 0.8580
 Site-SVHN                      (4) | Train Loss: 0.6451 | Train Acc: 0.8024
Average Train Accuracy: 0.9157
 Site-MNIST                     (3) | Val  Loss: 0.1322 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1501 | Val  Acc: 0.9524
 Site-MNIST                     (3) | Val  Loss: 0.1665 | Val  Acc: 0.9683
 Site-MNIST                     (3) | Val  Loss: 0.2069 | Val  Acc: 0.9421
 Site-MNIST                     (3) | Val  Loss: 0.1843 | Val  Acc: 0.9474
 Site-USPS                      (6) | Val  Loss: 0.1460 | Val  Acc: 0.9615
 Site-USPS                      (6) | Val  Loss: 0.2059 | Val  Acc: 0.9295
 Site-USPS                      (0) | Val  Loss: 0.2511 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.4311 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.2561 | Val  Acc: 0.9242
 Site-MNIST_M                   (2) | Val  Loss: 0.6016 | Val  Acc: 0.8068
 Site-MNIST_M                   (5) | Val  Loss: 0.6281 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.6871 | Val  Acc: 0.7808
Average Valid Accuracy: 0.9054
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9524
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9683
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9421
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9474
 Best site-USPS                     (6)  | Epoch:44 | Val Acc: 0.9615
 Best site-USPS                     (6)  | Epoch:44 | Val Acc: 0.9295
 Best site-USPS                     (0)  | Epoch:44 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:44 | Val Acc: 0.8788
 Best site-SynthDigits              (1)  | Epoch:44 | Val Acc: 0.9242
 Best site-MNIST_M                  (2)  | Epoch:44 | Val Acc: 0.8068
 Best site-MNIST_M                  (5)  | Epoch:44 | Val Acc: 0.8258
 Best site-SVHN                     (4)  | Epoch:44 | Val Acc: 0.7808
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 45 ============
cnt=[1, 5, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (1) | Train Loss: 0.1673 | Train Acc: 0.9511
 Site-MNIST                     (1) | Train Loss: 0.1474 | Train Acc: 0.9586
 Site-MNIST                     (1) | Train Loss: 0.1805 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.1951 | Train Acc: 0.9422
 Site-MNIST                     (1) | Train Loss: 0.1614 | Train Acc: 0.9553
 Site-USPS                      (3) | Train Loss: 0.2333 | Train Acc: 0.9257
 Site-USPS                      (3) | Train Loss: 0.2088 | Train Acc: 0.9425
 Site-USPS                      (3) | Train Loss: 0.2109 | Train Acc: 0.9350
 Site-SynthDigits               (0) | Train Loss: 0.3322 | Train Acc: 0.9015
 Site-SynthDigits               (6) | Train Loss: 0.3022 | Train Acc: 0.9268
 Site-MNIST_M                   (5) | Train Loss: 0.5229 | Train Acc: 0.8466
 Site-MNIST_M                   (2) | Train Loss: 0.5220 | Train Acc: 0.8466
 Site-SVHN                      (4) | Train Loss: 0.6343 | Train Acc: 0.8024
Average Train Accuracy: 0.9144
 Site-MNIST                     (1) | Val  Loss: 0.1300 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1474 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.1625 | Val  Acc: 0.9603
 Site-MNIST                     (1) | Val  Loss: 0.2054 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.1828 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1448 | Val  Acc: 0.9808
 Site-USPS                      (3) | Val  Loss: 0.2029 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2453 | Val  Acc: 0.8889
 Site-SynthDigits               (0) | Val  Loss: 0.4186 | Val  Acc: 0.8939
 Site-SynthDigits               (6) | Val  Loss: 0.2522 | Val  Acc: 0.9343
 Site-MNIST_M                   (5) | Val  Loss: 0.6043 | Val  Acc: 0.7955
 Site-MNIST_M                   (2) | Val  Loss: 0.6248 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.6721 | Val  Acc: 0.7877
Average Valid Accuracy: 0.9077
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9603
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:45 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:45 | Val Acc: 0.9808
 Best site-USPS                     (3)  | Epoch:45 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:45 | Val Acc: 0.8889
 Best site-SynthDigits              (0)  | Epoch:45 | Val Acc: 0.8939
 Best site-SynthDigits              (6)  | Epoch:45 | Val Acc: 0.9343
 Best site-MNIST_M                  (5)  | Epoch:45 | Val Acc: 0.7955
 Best site-MNIST_M                  (2)  | Epoch:45 | Val Acc: 0.8258
 Best site-SVHN                     (4)  | Epoch:45 | Val Acc: 0.7877
 Test site-MNIST                     (1)| Epoch:45 | Test Acc: 0.9427
 Test site-USPS                      (3)| Epoch:45 | Test Acc: 0.9430
 Test site-SynthDigits               (0)| Epoch:45 | Test Acc: 0.9019
 Test site-MNIST_M                   (5)| Epoch:45 | Test Acc: 0.7566
 Test site-SVHN                      (4)| Epoch:45 | Test Acc: 0.7093
MNIST: 0.9427, USPS: 0.9430, SynthDigits: 0.9019, MNIST_M: 0.7566, SVHN: 0.7093, 
Average Test Accuracy(group): 0.8507, Average Test Accuracy(individual): 0.8899,
domain std=0.0984, cluster std=0.0923, individual std=0.0836, 
Average Test Accuracy: 0.8507
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 46 ============
cnt=[3, 1, 1, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (3) | Train Loss: 0.1763 | Train Acc: 0.9511
 Site-MNIST                     (3) | Train Loss: 0.1572 | Train Acc: 0.9527
 Site-MNIST                     (3) | Train Loss: 0.1802 | Train Acc: 0.9546
 Site-MNIST                     (3) | Train Loss: 0.1954 | Train Acc: 0.9409
 Site-MNIST                     (3) | Train Loss: 0.1624 | Train Acc: 0.9545
 Site-USPS                      (0) | Train Loss: 0.2396 | Train Acc: 0.9281
 Site-USPS                      (0) | Train Loss: 0.2021 | Train Acc: 0.9409
 Site-USPS                      (0) | Train Loss: 0.2031 | Train Acc: 0.9436
 Site-SynthDigits               (2) | Train Loss: 0.3520 | Train Acc: 0.9110
 Site-SynthDigits               (5) | Train Loss: 0.2985 | Train Acc: 0.9280
 Site-MNIST_M                   (1) | Train Loss: 0.5334 | Train Acc: 0.8665
 Site-MNIST_M                   (6) | Train Loss: 0.5272 | Train Acc: 0.8504
 Site-SVHN                      (4) | Train Loss: 0.6169 | Train Acc: 0.8109
Average Train Accuracy: 0.9179
 Site-MNIST                     (3) | Val  Loss: 0.1315 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1478 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1653 | Val  Acc: 0.9603
 Site-MNIST                     (3) | Val  Loss: 0.2047 | Val  Acc: 0.9368
 Site-MNIST                     (3) | Val  Loss: 0.1829 | Val  Acc: 0.9474
 Site-USPS                      (0) | Val  Loss: 0.1408 | Val  Acc: 0.9712
 Site-USPS                      (0) | Val  Loss: 0.1970 | Val  Acc: 0.9231
 Site-USPS                      (0) | Val  Loss: 0.2331 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4314 | Val  Acc: 0.8788
 Site-SynthDigits               (5) | Val  Loss: 0.2515 | Val  Acc: 0.9343
 Site-MNIST_M                   (1) | Val  Loss: 0.5949 | Val  Acc: 0.7955
 Site-MNIST_M                   (6) | Val  Loss: 0.6269 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.6674 | Val  Acc: 0.7945
Average Valid Accuracy: 0.9077
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9603
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9368
 Best site-MNIST                    (3)  | Epoch:46 | Val Acc: 0.9474
 Best site-USPS                     (0)  | Epoch:46 | Val Acc: 0.9712
 Best site-USPS                     (0)  | Epoch:46 | Val Acc: 0.9231
 Best site-USPS                     (0)  | Epoch:46 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:46 | Val Acc: 0.8788
 Best site-SynthDigits              (5)  | Epoch:46 | Val Acc: 0.9343
 Best site-MNIST_M                  (1)  | Epoch:46 | Val Acc: 0.7955
 Best site-MNIST_M                  (6)  | Epoch:46 | Val Acc: 0.8409
 Best site-SVHN                     (4)  | Epoch:46 | Val Acc: 0.7945
 Test site-MNIST                     (3)| Epoch:46 | Test Acc: 0.9433
 Test site-USPS                      (0)| Epoch:46 | Test Acc: 0.9419
 Test site-SynthDigits               (2)| Epoch:46 | Test Acc: 0.9021
 Test site-MNIST_M                   (1)| Epoch:46 | Test Acc: 0.7539
 Test site-SVHN                      (4)| Epoch:46 | Test Acc: 0.7074
MNIST: 0.9433, USPS: 0.9419, SynthDigits: 0.9021, MNIST_M: 0.7539, SVHN: 0.7074, 
Average Test Accuracy(group): 0.8497, Average Test Accuracy(individual): 0.8894,
domain std=0.0994, cluster std=0.0934, individual std=0.0846, 
Average Test Accuracy: 0.8497
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 5, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (1) | Train Loss: 0.1716 | Train Acc: 0.9511
 Site-MNIST                     (1) | Train Loss: 0.1750 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.1774 | Train Acc: 0.9527
 Site-MNIST                     (1) | Train Loss: 0.1903 | Train Acc: 0.9369
 Site-MNIST                     (1) | Train Loss: 0.1572 | Train Acc: 0.9562
 Site-USPS                      (3) | Train Loss: 0.2186 | Train Acc: 0.9257
 Site-USPS                      (3) | Train Loss: 0.2073 | Train Acc: 0.9441
 Site-USPS                      (6) | Train Loss: 0.2079 | Train Acc: 0.9436
 Site-SynthDigits               (0) | Train Loss: 0.3457 | Train Acc: 0.9053
 Site-SynthDigits               (0) | Train Loss: 0.2983 | Train Acc: 0.9268
 Site-MNIST_M                   (5) | Train Loss: 0.4918 | Train Acc: 0.8551
 Site-MNIST_M                   (2) | Train Loss: 0.5267 | Train Acc: 0.8447
 Site-SVHN                      (4) | Train Loss: 0.6733 | Train Acc: 0.8143
Average Train Accuracy: 0.9163
 Site-MNIST                     (1) | Val  Loss: 0.1197 | Val  Acc: 0.9821
 Site-MNIST                     (1) | Val  Loss: 0.1430 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1624 | Val  Acc: 0.9603
 Site-MNIST                     (1) | Val  Loss: 0.2044 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1806 | Val  Acc: 0.9474
 Site-USPS                      (3) | Val  Loss: 0.1413 | Val  Acc: 0.9808
 Site-USPS                      (3) | Val  Loss: 0.1944 | Val  Acc: 0.9231
 Site-USPS                      (6) | Val  Loss: 0.2300 | Val  Acc: 0.8932
 Site-SynthDigits               (0) | Val  Loss: 0.4320 | Val  Acc: 0.8864
 Site-SynthDigits               (0) | Val  Loss: 0.2480 | Val  Acc: 0.9293
 Site-MNIST_M                   (5) | Val  Loss: 0.5846 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.6054 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.6653 | Val  Acc: 0.7877
Average Valid Accuracy: 0.9089
 Best site-MNIST                    (1)  | Epoch:47 | Val Acc: 0.9821
 Best site-MNIST                    (1)  | Epoch:47 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:47 | Val Acc: 0.9603
 Best site-MNIST                    (1)  | Epoch:47 | Val Acc: 0.9368
 Best site-MNIST                    (1)  | Epoch:47 | Val Acc: 0.9474
 Best site-USPS                     (3)  | Epoch:47 | Val Acc: 0.9808
 Best site-USPS                     (3)  | Epoch:47 | Val Acc: 0.9231
 Best site-USPS                     (6)  | Epoch:47 | Val Acc: 0.8932
 Best site-SynthDigits              (0)  | Epoch:47 | Val Acc: 0.8864
 Best site-SynthDigits              (0)  | Epoch:47 | Val Acc: 0.9293
 Best site-MNIST_M                  (5)  | Epoch:47 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:47 | Val Acc: 0.8409
 Best site-SVHN                     (4)  | Epoch:47 | Val Acc: 0.7877
 Test site-MNIST                     (1)| Epoch:47 | Test Acc: 0.9447
 Test site-USPS                      (3)| Epoch:47 | Test Acc: 0.9462
 Test site-SynthDigits               (0)| Epoch:47 | Test Acc: 0.9021
 Test site-MNIST_M                   (5)| Epoch:47 | Test Acc: 0.7566
 Test site-SVHN                      (4)| Epoch:47 | Test Acc: 0.7097
MNIST: 0.9447, USPS: 0.9462, SynthDigits: 0.9021, MNIST_M: 0.7566, SVHN: 0.7097, 
Average Test Accuracy(group): 0.8519, Average Test Accuracy(individual): 0.8915,
domain std=0.0993, cluster std=0.0981, individual std=0.0845, 
Average Test Accuracy: 0.8519
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 48 ============
cnt=[5, 1, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (0) | Train Loss: 0.1693 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.1537 | Train Acc: 0.9615
 Site-MNIST                     (0) | Train Loss: 0.1703 | Train Acc: 0.9546
 Site-MNIST                     (0) | Train Loss: 0.1857 | Train Acc: 0.9422
 Site-MNIST                     (0) | Train Loss: 0.1548 | Train Acc: 0.9553
 Site-USPS                      (3) | Train Loss: 0.2315 | Train Acc: 0.9305
 Site-USPS                      (3) | Train Loss: 0.2018 | Train Acc: 0.9441
 Site-USPS                      (3) | Train Loss: 0.2078 | Train Acc: 0.9393
 Site-SynthDigits               (6) | Train Loss: 0.3192 | Train Acc: 0.9053
 Site-SynthDigits               (1) | Train Loss: 0.3008 | Train Acc: 0.9369
 Site-MNIST_M                   (5) | Train Loss: 0.5140 | Train Acc: 0.8608
 Site-MNIST_M                   (2) | Train Loss: 0.5310 | Train Acc: 0.8617
 Site-SVHN                      (4) | Train Loss: 0.6100 | Train Acc: 0.8177
Average Train Accuracy: 0.9204
 Site-MNIST                     (0) | Val  Loss: 0.1086 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1319 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1593 | Val  Acc: 0.9603
 Site-MNIST                     (0) | Val  Loss: 0.2004 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.1770 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1416 | Val  Acc: 0.9808
 Site-USPS                      (3) | Val  Loss: 0.1975 | Val  Acc: 0.9295
 Site-USPS                      (3) | Val  Loss: 0.2427 | Val  Acc: 0.8932
 Site-SynthDigits               (6) | Val  Loss: 0.4255 | Val  Acc: 0.8939
 Site-SynthDigits               (1) | Val  Loss: 0.2449 | Val  Acc: 0.9242
 Site-MNIST_M                   (5) | Val  Loss: 0.5912 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.5937 | Val  Acc: 0.8333
 Site-SVHN                      (4) | Val  Loss: 0.6494 | Val  Acc: 0.8082
Average Valid Accuracy: 0.9127
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9603
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9421
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:48 | Val Acc: 0.9808
 Best site-USPS                     (3)  | Epoch:48 | Val Acc: 0.9295
 Best site-USPS                     (3)  | Epoch:48 | Val Acc: 0.8932
 Best site-SynthDigits              (6)  | Epoch:48 | Val Acc: 0.8939
 Best site-SynthDigits              (1)  | Epoch:48 | Val Acc: 0.9242
 Best site-MNIST_M                  (5)  | Epoch:48 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:48 | Val Acc: 0.8333
 Best site-SVHN                     (4)  | Epoch:48 | Val Acc: 0.8082
 Test site-MNIST                     (0)| Epoch:48 | Test Acc: 0.9461
 Test site-USPS                      (3)| Epoch:48 | Test Acc: 0.9409
 Test site-SynthDigits               (6)| Epoch:48 | Test Acc: 0.9030
 Test site-MNIST_M                   (5)| Epoch:48 | Test Acc: 0.7519
 Test site-SVHN                      (4)| Epoch:48 | Test Acc: 0.7109
MNIST: 0.9461, USPS: 0.9409, SynthDigits: 0.9030, MNIST_M: 0.7519, SVHN: 0.7109, 
Average Test Accuracy(group): 0.8506, Average Test Accuracy(individual): 0.8903,
domain std=0.0993, cluster std=0.0937, individual std=0.0851, 
Average Test Accuracy: 0.8506
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
============ Train epoch 49 ============
cnt=[3, 1, 2, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (6) | Train Loss: 0.1863 | Train Acc: 0.9511
 Site-MNIST                     (0) | Train Loss: 0.1607 | Train Acc: 0.9586
 Site-MNIST                     (0) | Train Loss: 0.1710 | Train Acc: 0.9527
 Site-MNIST                     (6) | Train Loss: 0.1877 | Train Acc: 0.9396
 Site-MNIST                     (0) | Train Loss: 0.1551 | Train Acc: 0.9536
 Site-USPS                      (3) | Train Loss: 0.2226 | Train Acc: 0.9305
 Site-USPS                      (3) | Train Loss: 0.1986 | Train Acc: 0.9473
 Site-USPS                      (3) | Train Loss: 0.1968 | Train Acc: 0.9446
 Site-SynthDigits               (4) | Train Loss: 0.3528 | Train Acc: 0.9110
 Site-SynthDigits               (5) | Train Loss: 0.2902 | Train Acc: 0.9381
 Site-MNIST_M                   (2) | Train Loss: 0.4808 | Train Acc: 0.8551
 Site-MNIST_M                   (2) | Train Loss: 0.5166 | Train Acc: 0.8580
 Site-SVHN                      (1) | Train Loss: 0.7136 | Train Acc: 0.8262
Average Train Accuracy: 0.9205
 Site-MNIST                     (6) | Val  Loss: 0.1109 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1306 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1586 | Val  Acc: 0.9603
 Site-MNIST                     (6) | Val  Loss: 0.1969 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.1750 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1307 | Val  Acc: 0.9808
 Site-USPS                      (3) | Val  Loss: 0.1907 | Val  Acc: 0.9295
 Site-USPS                      (3) | Val  Loss: 0.2353 | Val  Acc: 0.8932
 Site-SynthDigits               (4) | Val  Loss: 0.4449 | Val  Acc: 0.9015
 Site-SynthDigits               (5) | Val  Loss: 0.2428 | Val  Acc: 0.9495
 Site-MNIST_M                   (2) | Val  Loss: 0.5743 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.6052 | Val  Acc: 0.8409
 Site-SVHN                      (1) | Val  Loss: 0.6478 | Val  Acc: 0.8082
Average Valid Accuracy: 0.9134
 Best site-MNIST                    (6)  | Epoch:49 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9603
 Best site-MNIST                    (6)  | Epoch:49 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:49 | Val Acc: 0.9509
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.9808
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.9295
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.8932
 Best site-SynthDigits              (4)  | Epoch:49 | Val Acc: 0.9015
 Best site-SynthDigits              (5)  | Epoch:49 | Val Acc: 0.9495
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:49 | Val Acc: 0.8409
 Best site-SVHN                     (1)  | Epoch:49 | Val Acc: 0.8082
 Test site-MNIST                     (6)| Epoch:49 | Test Acc: 0.9456
 Test site-USPS                      (3)| Epoch:49 | Test Acc: 0.9430
 Test site-SynthDigits               (4)| Epoch:49 | Test Acc: 0.9014
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7543
 Test site-SVHN                      (1)| Epoch:49 | Test Acc: 0.7104
MNIST: 0.9456, USPS: 0.9430, SynthDigits: 0.9014, MNIST_M: 0.7543, SVHN: 0.7104, 
Average Test Accuracy(group): 0.8509, Average Test Accuracy(individual): 0.8907,
domain std=0.0991, cluster std=0.0907, individual std=0.0847, 
Average Test Accuracy: 0.8509
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1_cluster_7/ccop_q=1...
===2023-08-12 23:01:07===
===2023-08-12 23:01:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 7
Loading snapshots...
 Test site-MNIST                     (6)| Epoch:49 | Test Acc: 0.9456
 Test site-USPS                      (3)| Epoch:49 | Test Acc: 0.9430
 Test site-SynthDigits               (4)| Epoch:49 | Test Acc: 0.9014
 Test site-MNIST_M                   (2)| Epoch:49 | Test Acc: 0.7543
 Test site-SVHN                      (1)| Epoch:49 | Test Acc: 0.7104
MNIST: 0.9456, USPS: 0.9430, SynthDigits: 0.9014, MNIST_M: 0.7543, SVHN: 0.7104, 
Average Test Accuracy(group): 0.8509, Average Test Accuracy(individual): 0.8907,
domain std=0.0991, cluster std=0.0907, individual std=0.0847, 
