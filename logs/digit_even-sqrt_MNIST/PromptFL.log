===2023-03-26 12:11:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.2788 | Train Acc: 0.1622
 Site-SVHN      | Train Loss: 2.2866 | Train Acc: 0.0811
 Site-USPS      | Train Loss: 2.2360 | Train Acc: 0.3604
 Site-USPS      | Train Loss: 2.2456 | Train Acc: 0.3333
 Site-SynthDigits| Train Loss: 2.2908 | Train Acc: 0.1892
 Site-SynthDigits| Train Loss: 2.2834 | Train Acc: 0.0991
 Site-MNIST-M   | Train Loss: 2.2956 | Train Acc: 0.1351
 Site-MNIST-M   | Train Loss: 2.2970 | Train Acc: 0.1261
 Site-SVHN      | Val  Loss: 2.2879 | Val  Acc: 0.0541
 Site-SVHN      | Val  Loss: 2.2818 | Val  Acc: 0.1757
 Site-USPS      | Val  Loss: 2.2443 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 2.2440 | Val  Acc: 0.3919
 Site-SynthDigits| Val  Loss: 2.2887 | Val  Acc: 0.0676
 Site-SynthDigits| Val  Loss: 2.2905 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2888 | Val  Acc: 0.1216
 Site-MNIST-M   | Val  Loss: 2.3117 | Val  Acc: 0.1351
Average Valid Accuracy: 0.1723
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0541
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1757
 Best site-USPS       | Epoch:0 | Val Acc: 0.2973
 Best site-USPS       | Epoch:0 | Val Acc: 0.3919
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0676
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1216
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.2626 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.2703 | Train Acc: 0.1622
 Site-USPS      | Train Loss: 2.1733 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 2.1847 | Train Acc: 0.4234
 Site-SynthDigits| Train Loss: 2.2773 | Train Acc: 0.2342
 Site-SynthDigits| Train Loss: 2.2642 | Train Acc: 0.1892
 Site-MNIST-M   | Train Loss: 2.2816 | Train Acc: 0.1892
 Site-MNIST-M   | Train Loss: 2.2819 | Train Acc: 0.1351
 Site-SVHN      | Val  Loss: 2.2751 | Val  Acc: 0.1081
 Site-SVHN      | Val  Loss: 2.2634 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 2.1824 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 2.1813 | Val  Acc: 0.4730
 Site-SynthDigits| Val  Loss: 2.2666 | Val  Acc: 0.1622
 Site-SynthDigits| Val  Loss: 2.2798 | Val  Acc: 0.2027
 Site-MNIST-M   | Val  Loss: 2.2747 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2937 | Val  Acc: 0.1757
Average Valid Accuracy: 0.2449
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1081
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2568
 Best site-USPS       | Epoch:1 | Val Acc: 0.4459
 Best site-USPS       | Epoch:1 | Val Acc: 0.4730
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1622
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2027
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-SVHN      | Train Loss: 2.2486 | Train Acc: 0.1802
 Site-SVHN      | Train Loss: 2.2548 | Train Acc: 0.1892
 Site-USPS      | Train Loss: 2.1140 | Train Acc: 0.5586
 Site-USPS      | Train Loss: 2.1276 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 2.2636 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.2463 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.2683 | Train Acc: 0.2162
 Site-MNIST-M   | Train Loss: 2.2679 | Train Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.2629 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.2471 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 2.1236 | Val  Acc: 0.5135
 Site-USPS      | Val  Loss: 2.1217 | Val  Acc: 0.5135
 Site-SynthDigits| Val  Loss: 2.2462 | Val  Acc: 0.2568
 Site-SynthDigits| Val  Loss: 2.2683 | Val  Acc: 0.2027
 Site-MNIST-M   | Val  Loss: 2.2616 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2768 | Val  Acc: 0.2297
Average Valid Accuracy: 0.2787
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2568
 Best site-USPS       | Epoch:2 | Val Acc: 0.5135
 Best site-USPS       | Epoch:2 | Val Acc: 0.5135
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2568
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2027
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-SVHN      | Train Loss: 2.2359 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.2410 | Train Acc: 0.2342
 Site-USPS      | Train Loss: 2.0571 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 2.0715 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 2.2496 | Train Acc: 0.2613
 Site-SynthDigits| Train Loss: 2.2287 | Train Acc: 0.2883
 Site-MNIST-M   | Train Loss: 2.2551 | Train Acc: 0.2432
 Site-MNIST-M   | Train Loss: 2.2544 | Train Acc: 0.2252
 Site-SVHN      | Val  Loss: 2.2517 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.2326 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 2.0670 | Val  Acc: 0.5135
 Site-USPS      | Val  Loss: 2.0646 | Val  Acc: 0.5135
 Site-SynthDigits| Val  Loss: 2.2269 | Val  Acc: 0.3108
 Site-SynthDigits| Val  Loss: 2.2559 | Val  Acc: 0.2027
 Site-MNIST-M   | Val  Loss: 2.2485 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2605 | Val  Acc: 0.2838
Average Valid Accuracy: 0.3108
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2973
 Best site-USPS       | Epoch:3 | Val Acc: 0.5135
 Best site-USPS       | Epoch:3 | Val Acc: 0.5135
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3108
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2027
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-SVHN      | Train Loss: 2.2239 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2288 | Train Acc: 0.2252
 Site-USPS      | Train Loss: 2.0023 | Train Acc: 0.6126
 Site-USPS      | Train Loss: 2.0185 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 2.2344 | Train Acc: 0.2793
 Site-SynthDigits| Train Loss: 2.2112 | Train Acc: 0.3423
 Site-MNIST-M   | Train Loss: 2.2421 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.2410 | Train Acc: 0.2793
 Site-SVHN      | Val  Loss: 2.2413 | Val  Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.2196 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 2.0126 | Val  Acc: 0.5270
 Site-USPS      | Val  Loss: 2.0099 | Val  Acc: 0.5405
 Site-SynthDigits| Val  Loss: 2.2082 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 2.2426 | Val  Acc: 0.2297
 Site-MNIST-M   | Val  Loss: 2.2362 | Val  Acc: 0.2568
 Site-MNIST-M   | Val  Loss: 2.2448 | Val  Acc: 0.3243
Average Valid Accuracy: 0.3412
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1622
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3108
 Best site-USPS       | Epoch:4 | Val Acc: 0.5270
 Best site-USPS       | Epoch:4 | Val Acc: 0.5405
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2297
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2568
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-SVHN      | Train Loss: 2.2124 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2170 | Train Acc: 0.2252
 Site-USPS      | Train Loss: 1.9497 | Train Acc: 0.6126
 Site-USPS      | Train Loss: 1.9648 | Train Acc: 0.5045
 Site-SynthDigits| Train Loss: 2.2194 | Train Acc: 0.3063
 Site-SynthDigits| Train Loss: 2.1929 | Train Acc: 0.3694
 Site-MNIST-M   | Train Loss: 2.2302 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.2284 | Train Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.2318 | Val  Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.2080 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 1.9606 | Val  Acc: 0.5541
 Site-USPS      | Val  Loss: 1.9573 | Val  Acc: 0.5405
 Site-SynthDigits| Val  Loss: 2.1893 | Val  Acc: 0.4189
 Site-SynthDigits| Val  Loss: 2.2288 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.2236 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.2295 | Val  Acc: 0.3784
Average Valid Accuracy: 0.3649
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1622
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3108
 Best site-USPS       | Epoch:5 | Val Acc: 0.5541
 Best site-USPS       | Epoch:5 | Val Acc: 0.5405
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4189
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-SVHN      | Train Loss: 2.2019 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.2075 | Train Acc: 0.2252
 Site-USPS      | Train Loss: 1.8981 | Train Acc: 0.6216
 Site-USPS      | Train Loss: 1.9167 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 2.2028 | Train Acc: 0.3333
 Site-SynthDigits| Train Loss: 2.1748 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 2.2178 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.2168 | Train Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.2221 | Val  Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.1976 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 1.9101 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.9069 | Val  Acc: 0.5405
 Site-SynthDigits| Val  Loss: 2.1702 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 2.2141 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.2127 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.2152 | Val  Acc: 0.3649
Average Valid Accuracy: 0.3784
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1622
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3108
 Best site-USPS       | Epoch:6 | Val Acc: 0.5676
 Best site-USPS       | Epoch:6 | Val Acc: 0.5405
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-SVHN      | Train Loss: 2.1935 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.1968 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.8520 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 1.8685 | Train Acc: 0.5315
 Site-SynthDigits| Train Loss: 2.1865 | Train Acc: 0.3423
 Site-SynthDigits| Train Loss: 2.1569 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 2.2068 | Train Acc: 0.3063
 Site-MNIST-M   | Train Loss: 2.2053 | Train Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.2131 | Val  Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.1879 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.8622 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.8593 | Val  Acc: 0.5676
 Site-SynthDigits| Val  Loss: 2.1519 | Val  Acc: 0.4459
 Site-SynthDigits| Val  Loss: 2.1979 | Val  Acc: 0.2973
 Site-MNIST-M   | Val  Loss: 2.2014 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.2015 | Val  Acc: 0.3784
Average Valid Accuracy: 0.3801
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1622
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2973
 Best site-USPS       | Epoch:7 | Val Acc: 0.5811
 Best site-USPS       | Epoch:7 | Val Acc: 0.5676
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4459
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.2973
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-SVHN      | Train Loss: 2.1834 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.1872 | Train Acc: 0.2252
 Site-USPS      | Train Loss: 1.8052 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 1.8238 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 2.1687 | Train Acc: 0.3423
 Site-SynthDigits| Train Loss: 2.1396 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 2.1952 | Train Acc: 0.3333
 Site-MNIST-M   | Train Loss: 2.1928 | Train Acc: 0.3514
 Site-SVHN      | Val  Loss: 2.2047 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.1779 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.8171 | Val  Acc: 0.6081
 Site-USPS      | Val  Loss: 1.8142 | Val  Acc: 0.5811
 Site-SynthDigits| Val  Loss: 2.1335 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 2.1816 | Val  Acc: 0.2973
 Site-MNIST-M   | Val  Loss: 2.1892 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.1882 | Val  Acc: 0.4324
Average Valid Accuracy: 0.3970
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2973
 Best site-USPS       | Epoch:8 | Val Acc: 0.6081
 Best site-USPS       | Epoch:8 | Val Acc: 0.5811
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.2973
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-SVHN      | Train Loss: 2.1746 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.1776 | Train Acc: 0.2252
 Site-USPS      | Train Loss: 1.7623 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 1.7822 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 2.1513 | Train Acc: 0.3333
 Site-SynthDigits| Train Loss: 2.1220 | Train Acc: 0.4324
 Site-MNIST-M   | Train Loss: 2.1835 | Train Acc: 0.3694
 Site-MNIST-M   | Train Loss: 2.1812 | Train Acc: 0.3604
 Site-SVHN      | Val  Loss: 2.1960 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.1691 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.7748 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 1.7725 | Val  Acc: 0.5811
 Site-SynthDigits| Val  Loss: 2.1167 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 2.1652 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.1763 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 2.1751 | Val  Acc: 0.4459
Average Valid Accuracy: 0.4037
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2973
 Best site-USPS       | Epoch:9 | Val Acc: 0.6216
 Best site-USPS       | Epoch:9 | Val Acc: 0.5811
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_MNIST...
===2023-03-26 12:25:41===
===2023-03-26 12:25:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of MNIST: 0.3729
Average Test Accuracy: 0.3729
