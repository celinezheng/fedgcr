===2023-03-26 01:21:44===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
===2023-03-26 01:23:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
===2023-03-26 01:26:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
===2023-03-26 01:43:18===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
===2023-03-26 01:50:15===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
===2023-03-26 01:50:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.2047 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.2269 | Train Acc: 0.1982
 Site-USPS      | Train Loss: 1.7592 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 1.8079 | Train Acc: 0.5766
 Site-SynthDigits| Train Loss: 2.0749 | Train Acc: 0.3063
 Site-SynthDigits| Train Loss: 2.1136 | Train Acc: 0.2342
 Site-MNIST-M   | Train Loss: 2.1919 | Train Acc: 0.1982
 Site-MNIST-M   | Train Loss: 2.1986 | Train Acc: 0.2252
 Site-SVHN      | Val  Loss: 2.2672 | Val  Acc: 0.1486
 Site-SVHN      | Val  Loss: 2.1831 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 1.7804 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.7824 | Val  Acc: 0.6216
 Site-SynthDigits| Val  Loss: 2.1010 | Val  Acc: 0.2432
 Site-SynthDigits| Val  Loss: 2.0840 | Val  Acc: 0.2973
 Site-MNIST-M   | Val  Loss: 2.2047 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1827 | Val  Acc: 0.1892
Average Valid Accuracy: 0.3159
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2162
 Best site-USPS       | Epoch:0 | Val Acc: 0.5676
 Best site-USPS       | Epoch:0 | Val Acc: 0.6216
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2432
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2973
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.0610 | Train Acc: 0.2883
 Site-SVHN      | Train Loss: 2.0814 | Train Acc: 0.3153
 Site-USPS      | Train Loss: 1.3108 | Train Acc: 0.7658
 Site-USPS      | Train Loss: 1.3586 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 1.8281 | Train Acc: 0.4505
 Site-SynthDigits| Train Loss: 1.8960 | Train Acc: 0.4324
 Site-MNIST-M   | Train Loss: 2.0454 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.0245 | Train Acc: 0.3604
 Site-SVHN      | Val  Loss: 2.1231 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 2.0271 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 1.3298 | Val  Acc: 0.7703
 Site-USPS      | Val  Loss: 1.3338 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.8767 | Val  Acc: 0.4054
 Site-SynthDigits| Val  Loss: 1.8684 | Val  Acc: 0.4730
 Site-MNIST-M   | Val  Loss: 2.0115 | Val  Acc: 0.3784
 Site-MNIST-M   | Val  Loss: 2.0346 | Val  Acc: 0.2703
Average Valid Accuracy: 0.4645
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3514
 Best site-USPS       | Epoch:1 | Val Acc: 0.7703
 Best site-USPS       | Epoch:1 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4054
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4730
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3784
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
===2023-03-26 01:59:53===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
===2023-03-26 02:00:31===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.2047 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.2269 | Train Acc: 0.1982
 Site-USPS      | Train Loss: 1.7592 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 1.8079 | Train Acc: 0.5766
 Site-SynthDigits| Train Loss: 2.0749 | Train Acc: 0.3063
 Site-SynthDigits| Train Loss: 2.1136 | Train Acc: 0.2342
 Site-MNIST-M   | Train Loss: 2.1919 | Train Acc: 0.1982
 Site-MNIST-M   | Train Loss: 2.1986 | Train Acc: 0.2252
 Site-SVHN      | Val  Loss: 2.2672 | Val  Acc: 0.1486
 Site-SVHN      | Val  Loss: 2.1831 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 1.7804 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 1.7824 | Val  Acc: 0.6216
 Site-SynthDigits| Val  Loss: 2.1010 | Val  Acc: 0.2432
 Site-SynthDigits| Val  Loss: 2.0840 | Val  Acc: 0.2973
 Site-MNIST-M   | Val  Loss: 2.2047 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1827 | Val  Acc: 0.1892
Average Valid Accuracy: 0.3159
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2162
 Best site-USPS       | Epoch:0 | Val Acc: 0.5676
 Best site-USPS       | Epoch:0 | Val Acc: 0.6216
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2432
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2973
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.0610 | Train Acc: 0.2883
 Site-SVHN      | Train Loss: 2.0814 | Train Acc: 0.3153
 Site-USPS      | Train Loss: 1.3108 | Train Acc: 0.7658
 Site-USPS      | Train Loss: 1.3586 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 1.8281 | Train Acc: 0.4505
 Site-SynthDigits| Train Loss: 1.8960 | Train Acc: 0.4324
 Site-MNIST-M   | Train Loss: 2.0454 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.0245 | Train Acc: 0.3604
 Site-SVHN      | Val  Loss: 2.1231 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 2.0271 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 1.3298 | Val  Acc: 0.7703
 Site-USPS      | Val  Loss: 1.3338 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.8767 | Val  Acc: 0.4054
 Site-SynthDigits| Val  Loss: 1.8684 | Val  Acc: 0.4730
 Site-MNIST-M   | Val  Loss: 2.0115 | Val  Acc: 0.3784
 Site-MNIST-M   | Val  Loss: 2.0346 | Val  Acc: 0.2703
Average Valid Accuracy: 0.4645
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3514
 Best site-USPS       | Epoch:1 | Val Acc: 0.7703
 Best site-USPS       | Epoch:1 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4054
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4730
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3784
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-SVHN      | Train Loss: 1.8659 | Train Acc: 0.3423
 Site-SVHN      | Train Loss: 1.8514 | Train Acc: 0.4144
 Site-USPS      | Train Loss: 0.8345 | Train Acc: 0.8198
 Site-USPS      | Train Loss: 0.8852 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 1.5458 | Train Acc: 0.5045
 Site-SynthDigits| Train Loss: 1.5486 | Train Acc: 0.4775
 Site-MNIST-M   | Train Loss: 1.7809 | Train Acc: 0.3964
 Site-MNIST-M   | Train Loss: 1.7747 | Train Acc: 0.4234
 Site-SVHN      | Val  Loss: 1.9567 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.7759 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 0.8600 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 0.8592 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.5140 | Val  Acc: 0.4865
 Site-SynthDigits| Val  Loss: 1.5860 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.7555 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 1.7485 | Val  Acc: 0.4054
Average Valid Accuracy: 0.5203
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3784
 Best site-USPS       | Epoch:2 | Val Acc: 0.7568
 Best site-USPS       | Epoch:2 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4865
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-SVHN      | Train Loss: 1.6729 | Train Acc: 0.4144
 Site-SVHN      | Train Loss: 1.6614 | Train Acc: 0.5225
 Site-USPS      | Train Loss: 0.5314 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.6051 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.2102 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.2044 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.4597 | Train Acc: 0.5766
 Site-MNIST-M   | Train Loss: 1.4827 | Train Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.7590 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.6116 | Val  Acc: 0.4865
 Site-USPS      | Val  Loss: 0.5887 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.5710 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.1996 | Val  Acc: 0.6081
 Site-SynthDigits| Val  Loss: 1.2213 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.4271 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4325 | Val  Acc: 0.5946
Average Valid Accuracy: 0.6334
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4865
 Best site-USPS       | Epoch:3 | Val Acc: 0.8378
 Best site-USPS       | Epoch:3 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6081
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-SVHN      | Train Loss: 1.4480 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 1.4205 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 0.4674 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.5203 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.0144 | Train Acc: 0.6937
 Site-SynthDigits| Train Loss: 0.9907 | Train Acc: 0.6486
 Site-MNIST-M   | Train Loss: 1.1576 | Train Acc: 0.7027
 Site-MNIST-M   | Train Loss: 1.2284 | Train Acc: 0.6306
 Site-SVHN      | Val  Loss: 1.5486 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.3361 | Val  Acc: 0.5270
 Site-USPS      | Val  Loss: 0.5071 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.4774 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.9802 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 1.0273 | Val  Acc: 0.6892
 Site-MNIST-M   | Val  Loss: 1.1613 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.1827 | Val  Acc: 0.6757
Average Valid Accuracy: 0.6774
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5270
 Best site-USPS       | Epoch:4 | Val Acc: 0.8378
 Best site-USPS       | Epoch:4 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6892
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-SVHN      | Train Loss: 1.3285 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 1.3356 | Train Acc: 0.6036
 Site-USPS      | Train Loss: 0.3836 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.4129 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 0.8298 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 0.7843 | Train Acc: 0.7748
 Site-MNIST-M   | Train Loss: 0.9449 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 1.0058 | Train Acc: 0.7207
 Site-SVHN      | Val  Loss: 1.4558 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.2477 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 0.3875 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.4093 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 0.7688 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 0.8517 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 0.9588 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 0.9352 | Val  Acc: 0.7432
Average Valid Accuracy: 0.7365
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5811
 Best site-USPS       | Epoch:5 | Val Acc: 0.8784
 Best site-USPS       | Epoch:5 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-SVHN      | Train Loss: 1.0976 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 1.1859 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 0.3734 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.3882 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 0.6333 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 0.5389 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 0.6892 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.8144 | Train Acc: 0.7838
 Site-SVHN      | Val  Loss: 1.3276 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.0253 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 0.3509 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.3956 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 0.5461 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.5819 | Val  Acc: 0.8514
 Site-MNIST-M   | Val  Loss: 0.7794 | Val  Acc: 0.7703
 Site-MNIST-M   | Val  Loss: 0.7169 | Val  Acc: 0.8784
Average Valid Accuracy: 0.8074
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6892
 Best site-USPS       | Epoch:6 | Val Acc: 0.9054
 Best site-USPS       | Epoch:6 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8514
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7703
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-SVHN      | Train Loss: 0.8325 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 0.9316 | Train Acc: 0.7477
 Site-USPS      | Train Loss: 0.2790 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.2599 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.4941 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 0.4075 | Train Acc: 0.9279
 Site-MNIST-M   | Train Loss: 0.3964 | Train Acc: 0.9189
 Site-MNIST-M   | Train Loss: 0.4626 | Train Acc: 0.9279
 Site-SVHN      | Val  Loss: 1.0015 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 0.8452 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 0.2327 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2761 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.4125 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.4507 | Val  Acc: 0.8784
 Site-MNIST-M   | Val  Loss: 0.4356 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 0.4039 | Val  Acc: 0.9324
Average Valid Accuracy: 0.8801
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:7 | Val Acc: 0.8108
 Best site-USPS       | Epoch:7 | Val Acc: 0.9324
 Best site-USPS       | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8784
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-SVHN      | Train Loss: 0.6239 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 0.7151 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 0.2264 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.1868 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.3588 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.2861 | Train Acc: 0.9730
 Site-MNIST-M   | Train Loss: 0.2943 | Train Acc: 0.9459
 Site-MNIST-M   | Train Loss: 0.3612 | Train Acc: 0.9279
 Site-SVHN      | Val  Loss: 0.7675 | Val  Acc: 0.7568
 Site-SVHN      | Val  Loss: 0.6453 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.1642 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.2020 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2974 | Val  Acc: 0.9730
 Site-SynthDigits| Val  Loss: 0.3058 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 0.3440 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 0.3034 | Val  Acc: 0.9459
Average Valid Accuracy: 0.9139
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7568
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8784
 Best site-USPS       | Epoch:8 | Val Acc: 0.9595
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9730
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-SVHN      | Train Loss: 0.5501 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 0.6692 | Train Acc: 0.8108
 Site-USPS      | Train Loss: 0.2212 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.1737 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.3193 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.2257 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.1764 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2402 | Train Acc: 0.9820
 Site-SVHN      | Val  Loss: 0.7155 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 0.6085 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.1533 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.2031 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2214 | Val  Acc: 0.9730
 Site-SynthDigits| Val  Loss: 0.2866 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 0.2271 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.1969 | Val  Acc: 0.9865
Average Valid Accuracy: 0.9291
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8514
 Best site-USPS       | Epoch:9 | Val Acc: 0.9730
 Best site-USPS       | Epoch:9 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9730
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_MNIST...
===2023-03-26 02:34:14===
===2023-03-26 02:34:16===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3788
 Test site-USPS      | Epoch:9 | Test Acc: 0.8710
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6378
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4100
Average Test Accuracy: 0.5744
===2023-03-26 11:57:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
===2023-03-26 11:59:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of MNIST: 0.6993
Average Test Accuracy: 0.6993
===2023-03-28 01:16:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.1682 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.1621 | Train Acc: 0.2905
 Site-SVHN      | Train Loss: 2.1499 | Train Acc: 0.2973
 Site-USPS      | Train Loss: 1.6837 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 1.6020 | Train Acc: 0.6216
 Site-USPS      | Train Loss: 1.6399 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 2.0825 | Train Acc: 0.2838
 Site-SynthDigits| Train Loss: 2.0766 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.0759 | Train Acc: 0.2770
 Site-MNIST-M   | Train Loss: 2.2230 | Train Acc: 0.1419
 Site-MNIST-M   | Train Loss: 2.1623 | Train Acc: 0.2568
 Site-MNIST-M   | Train Loss: 2.1603 | Train Acc: 0.2635
 Site-SVHN      | Val  Loss: 2.1155 | Val  Acc: 0.2959
 Site-SVHN      | Val  Loss: 2.1138 | Val  Acc: 0.3163
 Site-SVHN      | Val  Loss: 2.1809 | Val  Acc: 0.2347
 Site-USPS      | Val  Loss: 1.6428 | Val  Acc: 0.5918
 Site-USPS      | Val  Loss: 1.6223 | Val  Acc: 0.6633
 Site-USPS      | Val  Loss: 1.6602 | Val  Acc: 0.5714
 Site-SynthDigits| Val  Loss: 2.0889 | Val  Acc: 0.2755
 Site-SynthDigits| Val  Loss: 2.0887 | Val  Acc: 0.2857
 Site-SynthDigits| Val  Loss: 2.1213 | Val  Acc: 0.2143
 Site-MNIST-M   | Val  Loss: 2.0145 | Val  Acc: 0.3061
 Site-MNIST-M   | Val  Loss: 2.1289 | Val  Acc: 0.2653
 Site-MNIST-M   | Val  Loss: 2.2478 | Val  Acc: 0.2143
Average Valid Accuracy: 0.3529
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2959
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3163
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2347
 Best site-USPS       | Epoch:0 | Val Acc: 0.5918
 Best site-USPS       | Epoch:0 | Val Acc: 0.6633
 Best site-USPS       | Epoch:0 | Val Acc: 0.5714
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2755
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2857
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2143
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3061
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2653
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
===2023-03-29 17:06:19===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.2026 | Train Acc: 0.1705
 Site-SVHN      | Train Loss: 2.1886 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.2190 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 1.8313 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 1.8974 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 1.7545 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 2.1311 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 2.1311 | Train Acc: 0.2386
 Site-SynthDigits| Train Loss: 2.1162 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2290 | Train Acc: 0.1591
 Site-MNIST-M   | Train Loss: 2.1967 | Train Acc: 0.1932
 Site-MNIST-M   | Train Loss: 2.2355 | Train Acc: 0.2386
 Site-SVHN      | Val  Loss: 2.2503 | Val  Acc: 0.1186
 Site-SVHN      | Val  Loss: 2.1669 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2240 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.7711 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 1.9177 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 1.8441 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 2.1242 | Val  Acc: 0.1864
 Site-SynthDigits| Val  Loss: 2.1585 | Val  Acc: 0.1695
 Site-SynthDigits| Val  Loss: 2.1075 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.2239 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.1981 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2345 | Val  Acc: 0.1356
Average Valid Accuracy: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1186
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-USPS       | Epoch:0 | Val Acc: 0.6271
 Best site-USPS       | Epoch:0 | Val Acc: 0.4576
 Best site-USPS       | Epoch:0 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1864
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1695
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.1558 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0376 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0915 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 1.4257 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 1.4751 | Train Acc: 0.7159
 Site-USPS      | Train Loss: 1.3476 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.9126 | Train Acc: 0.3977
 Site-SynthDigits| Train Loss: 1.9387 | Train Acc: 0.3750
 Site-SynthDigits| Train Loss: 1.9741 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.1315 | Train Acc: 0.2273
 Site-MNIST-M   | Train Loss: 2.0844 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.0515 | Train Acc: 0.3295
 Site-SVHN      | Val  Loss: 2.1489 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0549 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0941 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.3634 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.4932 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 1.4226 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.9514 | Val  Acc: 0.3220
 Site-SynthDigits| Val  Loss: 1.9910 | Val  Acc: 0.3220
 Site-SynthDigits| Val  Loss: 1.8948 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 2.1103 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0793 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1162 | Val  Acc: 0.1864
Average Valid Accuracy: 0.4124
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2203
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-USPS       | Epoch:1 | Val Acc: 0.7119
 Best site-USPS       | Epoch:1 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3220
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3220
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-SVHN      | Train Loss: 2.0335 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.8848 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.8930 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 1.0085 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.9921 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 0.9343 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.6947 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.6940 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.7484 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9977 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 1.9387 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.9111 | Train Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.9705 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9359 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.9278 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.9617 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.0032 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.0221 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.7567 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.7821 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.6832 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.9649 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 1.9199 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.9699 | Val  Acc: 0.2712
Average Valid Accuracy: 0.4831
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3390
 Best site-USPS       | Epoch:2 | Val Acc: 0.8136
 Best site-USPS       | Epoch:2 | Val Acc: 0.7966
 Best site-USPS       | Epoch:2 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-SVHN      | Train Loss: 1.8851 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8231 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7022 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.6351 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.6472 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.6414 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.4520 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.4493 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.4577 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.8540 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 1.6564 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.6686 | Train Acc: 0.4091
 Site-SVHN      | Val  Loss: 1.8401 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8400 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8405 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.6215 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.6596 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.6710 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.4878 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.5324 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.5246 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.7306 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.6595 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7503 | Val  Acc: 0.3898
Average Valid Accuracy: 0.5240
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3390
 Best site-USPS       | Epoch:3 | Val Acc: 0.8305
 Best site-USPS       | Epoch:3 | Val Acc: 0.8305
 Best site-USPS       | Epoch:3 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-SVHN      | Train Loss: 1.6225 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.4947 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.4771 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.4990 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.5239 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.4919 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.2615 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.3041 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.3423 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.5935 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.2782 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.3994 | Train Acc: 0.5455
 Site-SVHN      | Val  Loss: 1.6044 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.5170 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.6293 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.4508 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5144 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.4872 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.3257 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.3734 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.3554 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.4160 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.2966 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.3959 | Val  Acc: 0.5763
Average Valid Accuracy: 0.6031
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4068
 Best site-USPS       | Epoch:4 | Val Acc: 0.8644
 Best site-USPS       | Epoch:4 | Val Acc: 0.8644
 Best site-USPS       | Epoch:4 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-SVHN      | Train Loss: 1.5026 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.4398 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 1.3391 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.3736 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.3593 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.3733 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.9915 | Train Acc: 0.6705
 Site-SynthDigits| Train Loss: 0.9716 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 0.9531 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.3255 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.0999 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.1724 | Train Acc: 0.5795
 Site-SVHN      | Val  Loss: 1.4566 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.4146 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.4459 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.3534 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.3478 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.3285 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.0456 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 0.9992 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 1.0904 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.1785 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.1010 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.1902 | Val  Acc: 0.5932
Average Valid Accuracy: 0.6540
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4237
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-USPS       | Epoch:5 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-SVHN      | Train Loss: 1.3164 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.1533 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 1.1801 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.3885 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.3453 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3852 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.6803 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.7394 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.7075 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.1462 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 0.9340 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 0.9343 | Train Acc: 0.7386
 Site-SVHN      | Val  Loss: 1.2585 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.1384 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.2721 | Val  Acc: 0.5424
 Site-USPS      | Val  Loss: 0.3493 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.3355 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.2944 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.7101 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 0.7255 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.7887 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.9777 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 0.9374 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.0593 | Val  Acc: 0.6949
Average Valid Accuracy: 0.7373
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5424
 Best site-USPS       | Epoch:6 | Val Acc: 0.8814
 Best site-USPS       | Epoch:6 | Val Acc: 0.8983
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-SVHN      | Train Loss: 1.1583 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 0.9952 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 1.0784 | Train Acc: 0.6591
 Site-USPS      | Train Loss: 0.2821 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.1847 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.2219 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.6016 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 0.5267 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.6125 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.8029 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 0.7043 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.7049 | Train Acc: 0.8068
 Site-SVHN      | Val  Loss: 1.0982 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 1.0489 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.0385 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 0.2179 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.1911 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1885 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.6477 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 0.5196 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.6608 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.7489 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.6772 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 0.7753 | Val  Acc: 0.7627
Average Valid Accuracy: 0.7966
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6271
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-USPS       | Epoch:7 | Val Acc: 0.9492
 Best site-USPS       | Epoch:7 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8136
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7627
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-SVHN      | Train Loss: 0.8574 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 0.7492 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 0.8342 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.2174 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.1637 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.1937 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.4251 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.4306 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.4498 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.6335 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.4925 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.4881 | Train Acc: 0.9318
 Site-SVHN      | Val  Loss: 0.8910 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 0.7730 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.8029 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 0.1820 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1612 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1527 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4516 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.4061 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.5188 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 0.5232 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.4719 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.5508 | Val  Acc: 0.8644
Average Valid Accuracy: 0.8672
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7288
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8136
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8644
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-SVHN      | Train Loss: 0.8302 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 0.6123 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 0.7208 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 0.1952 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.0928 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1113 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4142 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3288 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.3961 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.4496 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.3905 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.3844 | Train Acc: 0.9318
 Site-SVHN      | Val  Loss: 0.7503 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.6804 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 0.6967 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.1059 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0977 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1195 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.4176 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 0.2956 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.4694 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.4176 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.3684 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.4219 | Val  Acc: 0.8814
Average Valid Accuracy: 0.8856
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7627
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.8814
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_MNIST...
===2023-03-29 17:46:54===
===2023-03-29 17:46:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST: 0.7314
Average Test Accuracy: 0.7314
