===2023-03-26 08:06:31===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.1915 | Train Acc: 0.1802
 Site-SVHN      | Train Loss: 2.2136 | Train Acc: 0.2072
 Site-USPS      | Train Loss: 1.7693 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 1.8099 | Train Acc: 0.5856
 Site-SynthDigits| Train Loss: 2.0747 | Train Acc: 0.3243
 Site-SynthDigits| Train Loss: 2.1242 | Train Acc: 0.2162
 Site-MNIST-M   | Train Loss: 2.1923 | Train Acc: 0.1892
 Site-MNIST-M   | Train Loss: 2.1909 | Train Acc: 0.2162
 Site-SVHN      | Val  Loss: 2.2523 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.1777 | Val  Acc: 0.1622
 Site-USPS      | Val  Loss: 1.7877 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.7910 | Val  Acc: 0.6351
 Site-SynthDigits| Val  Loss: 2.1135 | Val  Acc: 0.1892
 Site-SynthDigits| Val  Loss: 2.0898 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.1945 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1817 | Val  Acc: 0.1892
Average Valid Accuracy: 0.3125
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1622
 Best site-USPS       | Epoch:0 | Val Acc: 0.5811
 Best site-USPS       | Epoch:0 | Val Acc: 0.6351
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1892
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.0279 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 2.0796 | Train Acc: 0.3063
 Site-USPS      | Train Loss: 1.2527 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 1.3142 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 1.8483 | Train Acc: 0.3874
 Site-SynthDigits| Train Loss: 1.8814 | Train Acc: 0.3874
 Site-MNIST-M   | Train Loss: 2.0367 | Train Acc: 0.3243
 Site-MNIST-M   | Train Loss: 2.0311 | Train Acc: 0.3514
 Site-SVHN      | Val  Loss: 2.1482 | Val  Acc: 0.2432
 Site-SVHN      | Val  Loss: 2.0218 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.2969 | Val  Acc: 0.7297
 Site-USPS      | Val  Loss: 1.2961 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.9054 | Val  Acc: 0.3514
 Site-SynthDigits| Val  Loss: 1.8120 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 2.0196 | Val  Acc: 0.3649
 Site-MNIST-M   | Val  Loss: 2.0164 | Val  Acc: 0.3243
Average Valid Accuracy: 0.4375
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2432
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2973
 Best site-USPS       | Epoch:1 | Val Acc: 0.7297
 Best site-USPS       | Epoch:1 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3514
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3649
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-SVHN      | Train Loss: 1.8977 | Train Acc: 0.3153
 Site-SVHN      | Train Loss: 1.9464 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 0.7849 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.8513 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.5833 | Train Acc: 0.5045
 Site-SynthDigits| Train Loss: 1.6319 | Train Acc: 0.4595
 Site-MNIST-M   | Train Loss: 1.8105 | Train Acc: 0.4414
 Site-MNIST-M   | Train Loss: 1.8048 | Train Acc: 0.4324
 Site-SVHN      | Val  Loss: 2.0671 | Val  Acc: 0.2838
 Site-SVHN      | Val  Loss: 1.8597 | Val  Acc: 0.3378
 Site-USPS      | Val  Loss: 0.8389 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.8473 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.6389 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 1.5642 | Val  Acc: 0.5270
 Site-MNIST-M   | Val  Loss: 1.7778 | Val  Acc: 0.4730
 Site-MNIST-M   | Val  Loss: 1.7578 | Val  Acc: 0.4189
Average Valid Accuracy: 0.5220
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3378
 Best site-USPS       | Epoch:2 | Val Acc: 0.8514
 Best site-USPS       | Epoch:2 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5270
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4730
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-SVHN      | Train Loss: 1.7135 | Train Acc: 0.4234
 Site-SVHN      | Train Loss: 1.7263 | Train Acc: 0.4144
 Site-USPS      | Train Loss: 0.5456 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.5934 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.3312 | Train Acc: 0.5856
 Site-SynthDigits| Train Loss: 1.3744 | Train Acc: 0.5495
 Site-MNIST-M   | Train Loss: 1.5459 | Train Acc: 0.5045
 Site-MNIST-M   | Train Loss: 1.5662 | Train Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.8599 | Val  Acc: 0.3649
 Site-SVHN      | Val  Loss: 1.6520 | Val  Acc: 0.4189
 Site-USPS      | Val  Loss: 0.5919 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.5772 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.3886 | Val  Acc: 0.5405
 Site-SynthDigits| Val  Loss: 1.3042 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.5436 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 1.4845 | Val  Acc: 0.5135
Average Valid Accuracy: 0.5946
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3649
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4189
 Best site-USPS       | Epoch:3 | Val Acc: 0.8919
 Best site-USPS       | Epoch:3 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5405
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-SVHN      | Train Loss: 1.5349 | Train Acc: 0.4775
 Site-SVHN      | Train Loss: 1.5026 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.4244 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.4384 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.1115 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 1.1172 | Train Acc: 0.6306
 Site-MNIST-M   | Train Loss: 1.3276 | Train Acc: 0.6036
 Site-MNIST-M   | Train Loss: 1.2757 | Train Acc: 0.6126
 Site-SVHN      | Val  Loss: 1.6382 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.4642 | Val  Acc: 0.4730
 Site-USPS      | Val  Loss: 0.4467 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.4121 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.1727 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 1.0413 | Val  Acc: 0.6892
 Site-MNIST-M   | Val  Loss: 1.2546 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.2220 | Val  Acc: 0.6081
Average Valid Accuracy: 0.6537
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4730
 Best site-USPS       | Epoch:4 | Val Acc: 0.8514
 Best site-USPS       | Epoch:4 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6892
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-SVHN      | Train Loss: 1.3466 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 1.3702 | Train Acc: 0.5315
 Site-USPS      | Train Loss: 0.2964 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2997 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 1.0038 | Train Acc: 0.6577
 Site-SynthDigits| Train Loss: 1.0071 | Train Acc: 0.6757
 Site-MNIST-M   | Train Loss: 1.0150 | Train Acc: 0.7297
 Site-MNIST-M   | Train Loss: 0.9925 | Train Acc: 0.7297
 Site-SVHN      | Val  Loss: 1.5040 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.3030 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 0.3055 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2812 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 1.0823 | Val  Acc: 0.6351
 Site-SynthDigits| Val  Loss: 0.9080 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 0.9746 | Val  Acc: 0.7432
 Site-MNIST-M   | Val  Loss: 0.9515 | Val  Acc: 0.7297
Average Valid Accuracy: 0.7128
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5000
 Best site-USPS       | Epoch:5 | Val Acc: 0.9324
 Best site-USPS       | Epoch:5 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6351
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7432
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-SVHN      | Train Loss: 1.0269 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 1.0738 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 0.2346 | Train Acc: 0.9550
 Site-USPS      | Train Loss: 0.2193 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.8770 | Train Acc: 0.7117
 Site-SynthDigits| Train Loss: 0.8364 | Train Acc: 0.7027
 Site-MNIST-M   | Train Loss: 0.7209 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 0.6490 | Train Acc: 0.8829
 Site-SVHN      | Val  Loss: 1.1648 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 1.0174 | Val  Acc: 0.6081
 Site-USPS      | Val  Loss: 0.2225 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.2041 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.9110 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 0.7845 | Val  Acc: 0.7568
 Site-MNIST-M   | Val  Loss: 0.6418 | Val  Acc: 0.8784
 Site-MNIST-M   | Val  Loss: 0.6600 | Val  Acc: 0.8784
Average Valid Accuracy: 0.7855
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6081
 Best site-USPS       | Epoch:6 | Val Acc: 0.9459
 Best site-USPS       | Epoch:6 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7568
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8784
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-SVHN      | Train Loss: 0.9802 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 1.0505 | Train Acc: 0.6306
 Site-USPS      | Train Loss: 0.1698 | Train Acc: 0.9640
 Site-USPS      | Train Loss: 0.1585 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 0.7078 | Train Acc: 0.7748
 Site-SynthDigits| Train Loss: 0.6988 | Train Acc: 0.7477
 Site-MNIST-M   | Train Loss: 0.5901 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 0.5249 | Train Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.1346 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.0132 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 0.1568 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1502 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.7793 | Val  Acc: 0.7162
 Site-SynthDigits| Val  Loss: 0.6216 | Val  Acc: 0.7973
 Site-MNIST-M   | Val  Loss: 0.5310 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.5367 | Val  Acc: 0.9054
Average Valid Accuracy: 0.8041
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5946
 Best site-USPS       | Epoch:7 | Val Acc: 0.9865
 Best site-USPS       | Epoch:7 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7162
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7973
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-SVHN      | Train Loss: 0.7075 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 0.7864 | Train Acc: 0.7117
 Site-USPS      | Train Loss: 0.1209 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.1165 | Train Acc: 0.9910
 Site-SynthDigits| Train Loss: 0.6289 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 0.6106 | Train Acc: 0.8288
 Site-MNIST-M   | Train Loss: 0.4372 | Train Acc: 0.9640
 Site-MNIST-M   | Train Loss: 0.3736 | Train Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.8467 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 0.7416 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 0.1201 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1041 | Val  Acc: 0.9865
 Site-SynthDigits| Val  Loss: 0.6799 | Val  Acc: 0.7973
 Site-SynthDigits| Val  Loss: 0.5695 | Val  Acc: 0.8514
 Site-MNIST-M   | Val  Loss: 0.3728 | Val  Acc: 0.9730
 Site-MNIST-M   | Val  Loss: 0.4188 | Val  Acc: 0.9324
Average Valid Accuracy: 0.8682
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7568
 Best site-USPS       | Epoch:8 | Val Acc: 0.9865
 Best site-USPS       | Epoch:8 | Val Acc: 0.9865
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7973
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8514
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9730
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-SVHN      | Train Loss: 0.6266 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 0.7016 | Train Acc: 0.7297
 Site-USPS      | Train Loss: 0.1078 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.0927 | Train Acc: 0.9820
 Site-SynthDigits| Train Loss: 0.4482 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 0.4614 | Train Acc: 0.8829
 Site-MNIST-M   | Train Loss: 0.3270 | Train Acc: 0.9550
 Site-MNIST-M   | Train Loss: 0.3112 | Train Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.7586 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 0.6593 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 0.0868 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0917 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.5178 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.4102 | Val  Acc: 0.8649
 Site-MNIST-M   | Val  Loss: 0.3085 | Val  Acc: 0.9730
 Site-MNIST-M   | Val  Loss: 0.3332 | Val  Acc: 0.9324
Average Valid Accuracy: 0.8851
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7973
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 0.9595
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8649
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9730
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_MNIST...
===2023-03-26 08:38:42===
===2023-03-26 08:38:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3048
 Test site-USPS      | Epoch:9 | Test Acc: 0.8871
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5645
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3400
Average Test Accuracy: 0.5241
===2023-03-26 12:07:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of MNIST: 0.7400
Average Test Accuracy: 0.7400
===2023-03-29 20:33:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.2259 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1811 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.2305 | Train Acc: 0.1932
 Site-USPS      | Train Loss: 1.8749 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 1.9053 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 1.7861 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 2.1372 | Train Acc: 0.2727
 Site-SynthDigits| Train Loss: 2.1456 | Train Acc: 0.2273
 Site-SynthDigits| Train Loss: 2.1358 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.2455 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.2107 | Train Acc: 0.1705
 Site-MNIST-M   | Train Loss: 2.2427 | Train Acc: 0.2500
 Site-SVHN      | Val  Loss: 2.2622 | Val  Acc: 0.1017
 Site-SVHN      | Val  Loss: 2.1846 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2224 | Val  Acc: 0.1356
 Site-USPS      | Val  Loss: 1.8047 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 1.9439 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 1.8699 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 2.1318 | Val  Acc: 0.1186
 Site-SynthDigits| Val  Loss: 2.1732 | Val  Acc: 0.1356
 Site-SynthDigits| Val  Loss: 2.1285 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.2244 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.2023 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 2.2365 | Val  Acc: 0.1356
Average Valid Accuracy: 0.2698
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1017
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-USPS       | Epoch:0 | Val Acc: 0.6102
 Best site-USPS       | Epoch:0 | Val Acc: 0.4576
 Best site-USPS       | Epoch:0 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1186
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1356
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.1418 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1000 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.1172 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 1.5323 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 1.5901 | Train Acc: 0.6818
 Site-USPS      | Train Loss: 1.4823 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.9764 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 1.9886 | Train Acc: 0.3977
 Site-SynthDigits| Train Loss: 1.9749 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.1348 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.1087 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.0672 | Train Acc: 0.3182
 Site-SVHN      | Val  Loss: 2.1895 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.0857 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.1236 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.4838 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.6230 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.5544 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 1.9726 | Val  Acc: 0.2881
 Site-SynthDigits| Val  Loss: 2.0332 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 1.9571 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0972 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.0881 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.1283 | Val  Acc: 0.1864
Average Valid Accuracy: 0.3828
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-USPS       | Epoch:1 | Val Acc: 0.6610
 Best site-USPS       | Epoch:1 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2881
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-SVHN      | Train Loss: 2.0558 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0005 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 2.0384 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 1.2862 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.3682 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 1.2142 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8411 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.8337 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 1.8622 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 2.0440 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 1.9842 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 1.9394 | Train Acc: 0.3636
 Site-SVHN      | Val  Loss: 2.1178 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0112 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 2.0426 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.2348 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.3602 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 1.3087 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.8398 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 1.9173 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.8182 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.9893 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 1.9818 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0320 | Val  Acc: 0.2712
Average Valid Accuracy: 0.4407
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2203
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-USPS       | Epoch:2 | Val Acc: 0.7458
 Best site-USPS       | Epoch:2 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-SVHN      | Train Loss: 1.9917 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.9511 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.9123 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 1.0673 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 1.1533 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 1.0429 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.7234 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.7201 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.7256 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.9418 | Train Acc: 0.2955
 Site-MNIST-M   | Train Loss: 1.9068 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 1.8670 | Train Acc: 0.4091
 Site-SVHN      | Val  Loss: 2.0444 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9526 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.9472 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.0514 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.1670 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.1135 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.7127 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.8035 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.6908 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8842 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.8859 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.9531 | Val  Acc: 0.2542
Average Valid Accuracy: 0.4859
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3051
 Best site-USPS       | Epoch:3 | Val Acc: 0.7966
 Best site-USPS       | Epoch:3 | Val Acc: 0.7966
 Best site-USPS       | Epoch:3 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-SVHN      | Train Loss: 1.9466 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8492 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.8656 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.9190 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.9788 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.8957 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.6175 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.6096 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.6210 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.8761 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 1.8167 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.7281 | Train Acc: 0.4773
 Site-SVHN      | Val  Loss: 1.9825 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8995 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8732 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.9017 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.9975 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.9530 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.6142 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.6996 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.5800 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7923 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7906 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.8707 | Val  Acc: 0.3220
Average Valid Accuracy: 0.5099
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3051
 Best site-USPS       | Epoch:4 | Val Acc: 0.7966
 Best site-USPS       | Epoch:4 | Val Acc: 0.8136
 Best site-USPS       | Epoch:4 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-SVHN      | Train Loss: 1.9475 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7710 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.7921 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.7968 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.8562 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 0.7607 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.5225 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.5541 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.4922 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.7782 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.7186 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.6289 | Train Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.9161 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8454 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8019 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.7902 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.8650 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.8202 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.5193 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.5876 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.4749 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.7002 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.6922 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7894 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5367
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3559
 Best site-USPS       | Epoch:5 | Val Acc: 0.8136
 Best site-USPS       | Epoch:5 | Val Acc: 0.7966
 Best site-USPS       | Epoch:5 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-SVHN      | Train Loss: 1.8735 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.6942 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.7398 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.6962 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.7388 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.6761 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.4378 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.4319 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.3927 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.7052 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.6420 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.5760 | Train Acc: 0.5568
 Site-SVHN      | Val  Loss: 1.8554 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7695 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.7444 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.7077 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.7740 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.7230 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.4341 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.4946 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.3934 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.6145 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.6195 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7110 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5706
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3729
 Best site-USPS       | Epoch:6 | Val Acc: 0.8305
 Best site-USPS       | Epoch:6 | Val Acc: 0.8136
 Best site-USPS       | Epoch:6 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-SVHN      | Train Loss: 1.8329 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.6797 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 1.6607 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.6111 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.6748 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.6312 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.3247 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.3853 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.3068 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.5947 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.5659 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.4654 | Train Acc: 0.5795
 Site-SVHN      | Val  Loss: 1.8018 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7146 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.6902 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.6513 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.7045 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.6453 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.3588 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.3868 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.3114 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.5428 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.5468 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6323 | Val  Acc: 0.5593
Average Valid Accuracy: 0.5862
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4068
 Best site-USPS       | Epoch:7 | Val Acc: 0.8305
 Best site-USPS       | Epoch:7 | Val Acc: 0.8305
 Best site-USPS       | Epoch:7 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-SVHN      | Train Loss: 1.7517 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.5763 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.5976 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 0.5914 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.6237 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.5713 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.2597 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 1.2421 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.2370 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.5347 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.4482 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.4505 | Train Acc: 0.6250
 Site-SVHN      | Val  Loss: 1.7521 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.6654 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6386 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.6043 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.6429 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.5766 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2889 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.2885 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.2555 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4747 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4852 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.5517 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6144
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4576
 Best site-USPS       | Epoch:8 | Val Acc: 0.8305
 Best site-USPS       | Epoch:8 | Val Acc: 0.8305
 Best site-USPS       | Epoch:8 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-SVHN      | Train Loss: 1.7250 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.5801 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 1.5702 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.5268 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.5716 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.5419 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.2041 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 1.1893 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.1876 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.4896 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.4404 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.3378 | Train Acc: 0.6591
 Site-SVHN      | Val  Loss: 1.7013 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6160 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.6063 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.5598 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5909 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.5261 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2109 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.2046 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.1982 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4140 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.4246 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.4755 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6441
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4915
 Best site-USPS       | Epoch:9 | Val Acc: 0.8644
 Best site-USPS       | Epoch:9 | Val Acc: 0.8475
 Best site-USPS       | Epoch:9 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_MNIST...
===2023-03-29 21:12:47===
===2023-03-29 21:12:48===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST: 0.6493
Average Test Accuracy: 0.6493
