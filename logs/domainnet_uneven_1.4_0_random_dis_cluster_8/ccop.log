===2023-08-13 09:03:29===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 8
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 8
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 1, 5, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (3) | Train Loss: 2.0728 | Train Acc: 0.3826
 Site-Clipart                   (3) | Train Loss: 2.0555 | Train Acc: 0.3913
 Site-Clipart                   (3) | Train Loss: 2.1581 | Train Acc: 0.2756
 Site-Clipart                   (3) | Train Loss: 2.0718 | Train Acc: 0.3576
 Site-Clipart                   (3) | Train Loss: 2.0982 | Train Acc: 0.3394
 Site-Real                      (2) | Train Loss: 2.0615 | Train Acc: 0.4206
 Site-Real                      (7) | Train Loss: 2.0048 | Train Acc: 0.4520
 Site-Real                      (7) | Train Loss: 2.0282 | Train Acc: 0.4718
 Site-Real                      (7) | Train Loss: 2.0761 | Train Acc: 0.3793
 Site-Painting                  (6) | Train Loss: 2.0868 | Train Acc: 0.3741
 Site-Painting                  (5) | Train Loss: 2.0937 | Train Acc: 0.3301
 Site-Painting                  (5) | Train Loss: 2.0677 | Train Acc: 0.4291
 Site-Sketch                    (0) | Train Loss: 2.0626 | Train Acc: 0.3351
 Site-Sketch                    (0) | Train Loss: 2.0986 | Train Acc: 0.3521
 Site-QuickDraw                 (1) | Train Loss: 2.2563 | Train Acc: 0.1407
 Site-Infograph                 (4) | Train Loss: 2.2336 | Train Acc: 0.2179
Average Train Accuracy: 0.3531
 Site-Clipart                   (3) | Val  Loss: 2.0703 | Val  Acc: 0.3553
 Site-Clipart                   (3) | Val  Loss: 2.0923 | Val  Acc: 0.2617
 Site-Clipart                   (3) | Val  Loss: 2.0822 | Val  Acc: 0.3067
 Site-Clipart                   (3) | Val  Loss: 2.0760 | Val  Acc: 0.3190
 Site-Clipart                   (3) | Val  Loss: 2.1307 | Val  Acc: 0.2847
 Site-Real                      (2) | Val  Loss: 2.0237 | Val  Acc: 0.4167
 Site-Real                      (7) | Val  Loss: 2.0567 | Val  Acc: 0.4153
 Site-Real                      (7) | Val  Loss: 2.0181 | Val  Acc: 0.4970
 Site-Real                      (7) | Val  Loss: 2.0047 | Val  Acc: 0.4805
 Site-Painting                  (6) | Val  Loss: 2.0163 | Val  Acc: 0.3878
 Site-Painting                  (5) | Val  Loss: 2.0543 | Val  Acc: 0.4453
 Site-Painting                  (5) | Val  Loss: 2.0651 | Val  Acc: 0.3542
 Site-Sketch                    (0) | Val  Loss: 2.0833 | Val  Acc: 0.3465
 Site-Sketch                    (0) | Val  Loss: 2.0801 | Val  Acc: 0.3539
 Site-QuickDraw                 (1) | Val  Loss: 2.2552 | Val  Acc: 0.1606
 Site-Infograph                 (4) | Val  Loss: 2.2182 | Val  Acc: 0.2372
Average Valid Accuracy: 0.3514
 Best site-Clipart                  (3)  | Epoch:0 | Val Acc: 0.3553
 Best site-Clipart                  (3)  | Epoch:0 | Val Acc: 0.2617
 Best site-Clipart                  (3)  | Epoch:0 | Val Acc: 0.3067
 Best site-Clipart                  (3)  | Epoch:0 | Val Acc: 0.3190
 Best site-Clipart                  (3)  | Epoch:0 | Val Acc: 0.2847
 Best site-Real                     (2)  | Epoch:0 | Val Acc: 0.4167
 Best site-Real                     (7)  | Epoch:0 | Val Acc: 0.4153
 Best site-Real                     (7)  | Epoch:0 | Val Acc: 0.4970
 Best site-Real                     (7)  | Epoch:0 | Val Acc: 0.4805
 Best site-Painting                 (6)  | Epoch:0 | Val Acc: 0.3878
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4453
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3542
 Best site-Sketch                   (0)  | Epoch:0 | Val Acc: 0.3465
 Best site-Sketch                   (0)  | Epoch:0 | Val Acc: 0.3539
 Best site-QuickDraw                (1)  | Epoch:0 | Val Acc: 0.1606
 Best site-Infograph                (4)  | Epoch:0 | Val Acc: 0.2372
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 1, 1, 4, 1, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (2) | Train Loss: 1.8947 | Train Acc: 0.4957
 Site-Clipart                   (6) | Train Loss: 1.8196 | Train Acc: 0.5466
 Site-Clipart                   (6) | Train Loss: 1.9310 | Train Acc: 0.4444
 Site-Clipart                   (6) | Train Loss: 1.8857 | Train Acc: 0.4873
 Site-Clipart                   (6) | Train Loss: 1.8893 | Train Acc: 0.5136
 Site-Real                      (3) | Train Loss: 1.8249 | Train Acc: 0.5476
 Site-Real                      (3) | Train Loss: 1.7145 | Train Acc: 0.5819
 Site-Real                      (3) | Train Loss: 1.7407 | Train Acc: 0.6492
 Site-Real                      (3) | Train Loss: 1.8216 | Train Acc: 0.5546
 Site-Painting                  (7) | Train Loss: 1.9204 | Train Acc: 0.5102
 Site-Painting                  (0) | Train Loss: 1.8758 | Train Acc: 0.5097
 Site-Painting                  (0) | Train Loss: 1.8079 | Train Acc: 0.5571
 Site-Sketch                    (5) | Train Loss: 1.8451 | Train Acc: 0.5026
 Site-Sketch                    (5) | Train Loss: 1.9017 | Train Acc: 0.4719
 Site-QuickDraw                 (1) | Train Loss: 2.2353 | Train Acc: 0.1743
 Site-Infograph                 (4) | Train Loss: 2.1887 | Train Acc: 0.2308
Average Train Accuracy: 0.4861
 Site-Clipart                   (2) | Val  Loss: 1.7853 | Val  Acc: 0.5395
 Site-Clipart                   (6) | Val  Loss: 1.8575 | Val  Acc: 0.4860
 Site-Clipart                   (6) | Val  Loss: 1.8631 | Val  Acc: 0.5467
 Site-Clipart                   (6) | Val  Loss: 1.8695 | Val  Acc: 0.4429
 Site-Clipart                   (6) | Val  Loss: 1.9567 | Val  Acc: 0.4102
 Site-Real                      (3) | Val  Loss: 1.7442 | Val  Acc: 0.6071
 Site-Real                      (3) | Val  Loss: 1.7823 | Val  Acc: 0.6356
 Site-Real                      (3) | Val  Loss: 1.7373 | Val  Acc: 0.6182
 Site-Real                      (3) | Val  Loss: 1.7277 | Val  Acc: 0.6364
 Site-Painting                  (7) | Val  Loss: 1.7940 | Val  Acc: 0.5918
 Site-Painting                  (0) | Val  Loss: 1.7898 | Val  Acc: 0.5474
 Site-Painting                  (0) | Val  Loss: 1.8417 | Val  Acc: 0.5208
 Site-Sketch                    (5) | Val  Loss: 1.8709 | Val  Acc: 0.4567
 Site-Sketch                    (5) | Val  Loss: 1.8775 | Val  Acc: 0.4719
 Site-QuickDraw                 (1) | Val  Loss: 2.2283 | Val  Acc: 0.1606
 Site-Infograph                 (4) | Val  Loss: 2.1554 | Val  Acc: 0.2692
Average Valid Accuracy: 0.4963
 Best site-Clipart                  (2)  | Epoch:1 | Val Acc: 0.5395
 Best site-Clipart                  (6)  | Epoch:1 | Val Acc: 0.4860
 Best site-Clipart                  (6)  | Epoch:1 | Val Acc: 0.5467
 Best site-Clipart                  (6)  | Epoch:1 | Val Acc: 0.4429
 Best site-Clipart                  (6)  | Epoch:1 | Val Acc: 0.4102
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.6071
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.6356
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.6182
 Best site-Real                     (3)  | Epoch:1 | Val Acc: 0.6364
 Best site-Painting                 (7)  | Epoch:1 | Val Acc: 0.5918
 Best site-Painting                 (0)  | Epoch:1 | Val Acc: 0.5474
 Best site-Painting                 (0)  | Epoch:1 | Val Acc: 0.5208
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4567
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.4719
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.1606
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.2692
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 2 ============
cnt=[4, 1, 4, 2, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (2) | Train Loss: 1.6455 | Train Acc: 0.5739
 Site-Clipart                   (2) | Train Loss: 1.5522 | Train Acc: 0.6522
 Site-Clipart                   (2) | Train Loss: 1.7022 | Train Acc: 0.5911
 Site-Clipart                   (6) | Train Loss: 1.6158 | Train Acc: 0.6171
 Site-Clipart                   (2) | Train Loss: 1.6355 | Train Acc: 0.6063
 Site-Real                      (0) | Train Loss: 1.5277 | Train Acc: 0.7222
 Site-Real                      (0) | Train Loss: 1.4189 | Train Acc: 0.7175
 Site-Real                      (0) | Train Loss: 1.4161 | Train Acc: 0.7177
 Site-Real                      (0) | Train Loss: 1.5192 | Train Acc: 0.6839
 Site-Painting                  (7) | Train Loss: 1.5389 | Train Acc: 0.6667
 Site-Painting                  (7) | Train Loss: 1.5515 | Train Acc: 0.6699
 Site-Painting                  (4) | Train Loss: 1.5433 | Train Acc: 0.6540
 Site-Sketch                    (3) | Train Loss: 1.5894 | Train Acc: 0.6126
 Site-Sketch                    (3) | Train Loss: 1.6198 | Train Acc: 0.5955
 Site-QuickDraw                 (1) | Train Loss: 2.1721 | Train Acc: 0.2446
 Site-Infograph                 (5) | Train Loss: 2.0739 | Train Acc: 0.3291
Average Train Accuracy: 0.6034
 Site-Clipart                   (2) | Val  Loss: 1.5064 | Val  Acc: 0.6184
 Site-Clipart                   (2) | Val  Loss: 1.5697 | Val  Acc: 0.6729
 Site-Clipart                   (2) | Val  Loss: 1.5869 | Val  Acc: 0.6733
 Site-Clipart                   (6) | Val  Loss: 1.5994 | Val  Acc: 0.6190
 Site-Clipart                   (2) | Val  Loss: 1.6948 | Val  Acc: 0.5593
 Site-Real                      (0) | Val  Loss: 1.4354 | Val  Acc: 0.6905
 Site-Real                      (0) | Val  Loss: 1.5027 | Val  Acc: 0.6949
 Site-Real                      (0) | Val  Loss: 1.4055 | Val  Acc: 0.7394
 Site-Real                      (0) | Val  Loss: 1.4210 | Val  Acc: 0.7532
 Site-Painting                  (7) | Val  Loss: 1.4330 | Val  Acc: 0.7857
 Site-Painting                  (7) | Val  Loss: 1.5346 | Val  Acc: 0.6277
 Site-Painting                  (4) | Val  Loss: 1.5303 | Val  Acc: 0.6562
 Site-Sketch                    (3) | Val  Loss: 1.6112 | Val  Acc: 0.5906
 Site-Sketch                    (3) | Val  Loss: 1.6295 | Val  Acc: 0.5674
 Site-QuickDraw                 (1) | Val  Loss: 2.1674 | Val  Acc: 0.2661
 Site-Infograph                 (5) | Val  Loss: 2.0506 | Val  Acc: 0.3590
Average Valid Accuracy: 0.6171
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.6184
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.6729
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.6733
 Best site-Clipart                  (6)  | Epoch:2 | Val Acc: 0.6190
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.5593
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.6905
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.6949
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.7394
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.7532
 Best site-Painting                 (7)  | Epoch:2 | Val Acc: 0.7857
 Best site-Painting                 (7)  | Epoch:2 | Val Acc: 0.6277
 Best site-Painting                 (4)  | Epoch:2 | Val Acc: 0.6562
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.5906
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.5674
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2661
 Best site-Infograph                (5)  | Epoch:2 | Val Acc: 0.3590
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 3 ============
cnt=[3, 3, 1, 3, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.4522 | Train Acc: 0.6261
 Site-Clipart                   (0) | Train Loss: 1.3142 | Train Acc: 0.7764
 Site-Clipart                   (0) | Train Loss: 1.4797 | Train Acc: 0.7067
 Site-Clipart                   (6) | Train Loss: 1.3951 | Train Acc: 0.6962
 Site-Clipart                   (6) | Train Loss: 1.4148 | Train Acc: 0.6810
 Site-Real                      (3) | Train Loss: 1.2514 | Train Acc: 0.8254
 Site-Real                      (7) | Train Loss: 1.1288 | Train Acc: 0.8023
 Site-Real                      (3) | Train Loss: 1.1339 | Train Acc: 0.8226
 Site-Real                      (3) | Train Loss: 1.2657 | Train Acc: 0.8075
 Site-Painting                  (1) | Train Loss: 1.3506 | Train Acc: 0.7279
 Site-Painting                  (1) | Train Loss: 1.3655 | Train Acc: 0.7379
 Site-Painting                  (1) | Train Loss: 1.2962 | Train Acc: 0.7232
 Site-Sketch                    (5) | Train Loss: 1.3663 | Train Acc: 0.6806
 Site-Sketch                    (5) | Train Loss: 1.4372 | Train Acc: 0.6929
 Site-QuickDraw                 (2) | Train Loss: 2.1292 | Train Acc: 0.2294
 Site-Infograph                 (4) | Train Loss: 1.9576 | Train Acc: 0.3846
Average Train Accuracy: 0.6825
 Site-Clipart                   (0) | Val  Loss: 1.3006 | Val  Acc: 0.7632
 Site-Clipart                   (0) | Val  Loss: 1.3713 | Val  Acc: 0.7383
 Site-Clipart                   (0) | Val  Loss: 1.3999 | Val  Acc: 0.7400
 Site-Clipart                   (6) | Val  Loss: 1.4132 | Val  Acc: 0.6429
 Site-Clipart                   (6) | Val  Loss: 1.4936 | Val  Acc: 0.6678
 Site-Real                      (3) | Val  Loss: 1.1704 | Val  Acc: 0.7857
 Site-Real                      (7) | Val  Loss: 1.2271 | Val  Acc: 0.7881
 Site-Real                      (3) | Val  Loss: 1.1168 | Val  Acc: 0.8061
 Site-Real                      (3) | Val  Loss: 1.1501 | Val  Acc: 0.8571
 Site-Painting                  (1) | Val  Loss: 1.2186 | Val  Acc: 0.7959
 Site-Painting                  (1) | Val  Loss: 1.3045 | Val  Acc: 0.7372
 Site-Painting                  (1) | Val  Loss: 1.2687 | Val  Acc: 0.7500
 Site-Sketch                    (5) | Val  Loss: 1.3611 | Val  Acc: 0.7323
 Site-Sketch                    (5) | Val  Loss: 1.4057 | Val  Acc: 0.6854
 Site-QuickDraw                 (2) | Val  Loss: 2.1276 | Val  Acc: 0.2661
 Site-Infograph                 (4) | Val  Loss: 1.8811 | Val  Acc: 0.4295
Average Valid Accuracy: 0.6991
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7632
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7383
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7400
 Best site-Clipart                  (6)  | Epoch:3 | Val Acc: 0.6429
 Best site-Clipart                  (6)  | Epoch:3 | Val Acc: 0.6678
 Best site-Real                     (3)  | Epoch:3 | Val Acc: 0.7857
 Best site-Real                     (7)  | Epoch:3 | Val Acc: 0.7881
 Best site-Real                     (3)  | Epoch:3 | Val Acc: 0.8061
 Best site-Real                     (3)  | Epoch:3 | Val Acc: 0.8571
 Best site-Painting                 (1)  | Epoch:3 | Val Acc: 0.7959
 Best site-Painting                 (1)  | Epoch:3 | Val Acc: 0.7372
 Best site-Painting                 (1)  | Epoch:3 | Val Acc: 0.7500
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.7323
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6854
 Best site-QuickDraw                (2)  | Epoch:3 | Val Acc: 0.2661
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.4295
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 3, 1, 2, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (6) | Train Loss: 1.2878 | Train Acc: 0.7391
 Site-Clipart                   (6) | Train Loss: 1.1444 | Train Acc: 0.7764
 Site-Clipart                   (6) | Train Loss: 1.2844 | Train Acc: 0.7378
 Site-Clipart                   (3) | Train Loss: 1.2488 | Train Acc: 0.7373
 Site-Clipart                   (3) | Train Loss: 1.2496 | Train Acc: 0.7353
 Site-Real                      (4) | Train Loss: 1.0393 | Train Acc: 0.8571
 Site-Real                      (4) | Train Loss: 0.9319 | Train Acc: 0.8870
 Site-Real                      (7) | Train Loss: 0.9240 | Train Acc: 0.8548
 Site-Real                      (4) | Train Loss: 1.0560 | Train Acc: 0.8534
 Site-Painting                  (1) | Train Loss: 1.1781 | Train Acc: 0.7891
 Site-Painting                  (1) | Train Loss: 1.0882 | Train Acc: 0.8010
 Site-Painting                  (1) | Train Loss: 1.1179 | Train Acc: 0.7889
 Site-Sketch                    (0) | Train Loss: 1.1606 | Train Acc: 0.7644
 Site-Sketch                    (0) | Train Loss: 1.2032 | Train Acc: 0.7191
 Site-QuickDraw                 (2) | Train Loss: 2.0529 | Train Acc: 0.2630
 Site-Infograph                 (5) | Train Loss: 1.8320 | Train Acc: 0.4573
Average Train Accuracy: 0.7351
 Site-Clipart                   (6) | Val  Loss: 1.1104 | Val  Acc: 0.8158
 Site-Clipart                   (6) | Val  Loss: 1.1797 | Val  Acc: 0.8037
 Site-Clipart                   (6) | Val  Loss: 1.2202 | Val  Acc: 0.8000
 Site-Clipart                   (3) | Val  Loss: 1.1965 | Val  Acc: 0.7286
 Site-Clipart                   (3) | Val  Loss: 1.3079 | Val  Acc: 0.7119
 Site-Real                      (4) | Val  Loss: 0.9789 | Val  Acc: 0.8929
 Site-Real                      (4) | Val  Loss: 1.0011 | Val  Acc: 0.8644
 Site-Real                      (7) | Val  Loss: 0.9375 | Val  Acc: 0.8606
 Site-Real                      (4) | Val  Loss: 0.9378 | Val  Acc: 0.9091
 Site-Painting                  (1) | Val  Loss: 1.0056 | Val  Acc: 0.8776
 Site-Painting                  (1) | Val  Loss: 1.0850 | Val  Acc: 0.7810
 Site-Painting                  (1) | Val  Loss: 1.0807 | Val  Acc: 0.7917
 Site-Sketch                    (0) | Val  Loss: 1.2231 | Val  Acc: 0.7244
 Site-Sketch                    (0) | Val  Loss: 1.2391 | Val  Acc: 0.7135
 Site-QuickDraw                 (2) | Val  Loss: 2.0604 | Val  Acc: 0.2661
 Site-Infograph                 (5) | Val  Loss: 1.7940 | Val  Acc: 0.4359
Average Valid Accuracy: 0.7486
 Best site-Clipart                  (6)  | Epoch:4 | Val Acc: 0.8158
 Best site-Clipart                  (6)  | Epoch:4 | Val Acc: 0.8037
 Best site-Clipart                  (6)  | Epoch:4 | Val Acc: 0.8000
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.7286
 Best site-Clipart                  (3)  | Epoch:4 | Val Acc: 0.7119
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8929
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8644
 Best site-Real                     (7)  | Epoch:4 | Val Acc: 0.8606
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.9091
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.8776
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7810
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7917
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.7244
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.7135
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.2661
 Best site-Infograph                (5)  | Epoch:4 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 2, 1, 4, 3, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 1.1135 | Train Acc: 0.7130
 Site-Clipart                   (3) | Train Loss: 0.9854 | Train Acc: 0.8261
 Site-Clipart                   (3) | Train Loss: 1.1616 | Train Acc: 0.7867
 Site-Clipart                   (0) | Train Loss: 1.0432 | Train Acc: 0.8006
 Site-Clipart                   (3) | Train Loss: 1.0778 | Train Acc: 0.7941
 Site-Real                      (1) | Train Loss: 0.9103 | Train Acc: 0.8810
 Site-Real                      (1) | Train Loss: 0.8169 | Train Acc: 0.8814
 Site-Real                      (7) | Train Loss: 0.7954 | Train Acc: 0.8911
 Site-Real                      (7) | Train Loss: 0.8782 | Train Acc: 0.8937
 Site-Painting                  (4) | Train Loss: 1.0312 | Train Acc: 0.7891
 Site-Painting                  (4) | Train Loss: 0.9790 | Train Acc: 0.8058
 Site-Painting                  (4) | Train Loss: 1.0001 | Train Acc: 0.8166
 Site-Sketch                    (5) | Train Loss: 1.0111 | Train Acc: 0.7958
 Site-Sketch                    (5) | Train Loss: 1.1264 | Train Acc: 0.7116
 Site-QuickDraw                 (2) | Train Loss: 1.9649 | Train Acc: 0.3089
 Site-Infograph                 (6) | Train Loss: 1.7321 | Train Acc: 0.4786
Average Train Accuracy: 0.7609
 Site-Clipart                   (3) | Val  Loss: 0.9394 | Val  Acc: 0.7895
 Site-Clipart                   (3) | Val  Loss: 1.0502 | Val  Acc: 0.8224
 Site-Clipart                   (3) | Val  Loss: 1.0556 | Val  Acc: 0.8000
 Site-Clipart                   (0) | Val  Loss: 1.0465 | Val  Acc: 0.7667
 Site-Clipart                   (3) | Val  Loss: 1.1627 | Val  Acc: 0.7424
 Site-Real                      (1) | Val  Loss: 0.8261 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.8286 | Val  Acc: 0.8983
 Site-Real                      (7) | Val  Loss: 0.7958 | Val  Acc: 0.8848
 Site-Real                      (7) | Val  Loss: 0.8108 | Val  Acc: 0.8961
 Site-Painting                  (4) | Val  Loss: 0.8624 | Val  Acc: 0.8776
 Site-Painting                  (4) | Val  Loss: 0.9380 | Val  Acc: 0.7883
 Site-Painting                  (4) | Val  Loss: 1.0002 | Val  Acc: 0.8021
 Site-Sketch                    (5) | Val  Loss: 1.1167 | Val  Acc: 0.7559
 Site-Sketch                    (5) | Val  Loss: 1.1011 | Val  Acc: 0.7472
 Site-QuickDraw                 (2) | Val  Loss: 1.9664 | Val  Acc: 0.3257
 Site-Infograph                 (6) | Val  Loss: 1.6601 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7697
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7895
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.8224
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.8000
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7667
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7424
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:5 | Val Acc: 0.8983
 Best site-Real                     (7)  | Epoch:5 | Val Acc: 0.8848
 Best site-Real                     (7)  | Epoch:5 | Val Acc: 0.8961
 Best site-Painting                 (4)  | Epoch:5 | Val Acc: 0.8776
 Best site-Painting                 (4)  | Epoch:5 | Val Acc: 0.7883
 Best site-Painting                 (4)  | Epoch:5 | Val Acc: 0.8021
 Best site-Sketch                   (5)  | Epoch:5 | Val Acc: 0.7559
 Best site-Sketch                   (5)  | Epoch:5 | Val Acc: 0.7472
 Best site-QuickDraw                (2)  | Epoch:5 | Val Acc: 0.3257
 Best site-Infograph                (6)  | Epoch:5 | Val Acc: 0.5128
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 3, 1, 2, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (6) | Train Loss: 0.9909 | Train Acc: 0.8000
 Site-Clipart                   (0) | Train Loss: 0.8719 | Train Acc: 0.8634
 Site-Clipart                   (0) | Train Loss: 1.0334 | Train Acc: 0.8133
 Site-Clipart                   (6) | Train Loss: 0.9360 | Train Acc: 0.7816
 Site-Clipart                   (0) | Train Loss: 0.9641 | Train Acc: 0.8190
 Site-Real                      (1) | Train Loss: 0.7711 | Train Acc: 0.8968
 Site-Real                      (5) | Train Loss: 0.6858 | Train Acc: 0.9322
 Site-Real                      (1) | Train Loss: 0.6785 | Train Acc: 0.9194
 Site-Real                      (1) | Train Loss: 0.8066 | Train Acc: 0.8966
 Site-Painting                  (4) | Train Loss: 0.9020 | Train Acc: 0.8367
 Site-Painting                  (4) | Train Loss: 0.9309 | Train Acc: 0.8252
 Site-Painting                  (4) | Train Loss: 0.8751 | Train Acc: 0.8201
 Site-Sketch                    (3) | Train Loss: 0.9278 | Train Acc: 0.7696
 Site-Sketch                    (3) | Train Loss: 0.9526 | Train Acc: 0.7303
 Site-QuickDraw                 (2) | Train Loss: 1.8633 | Train Acc: 0.3853
 Site-Infograph                 (7) | Train Loss: 1.6507 | Train Acc: 0.4786
Average Train Accuracy: 0.7855
 Site-Clipart                   (6) | Val  Loss: 0.8032 | Val  Acc: 0.8158
 Site-Clipart                   (0) | Val  Loss: 0.9038 | Val  Acc: 0.8505
 Site-Clipart                   (0) | Val  Loss: 0.9631 | Val  Acc: 0.8200
 Site-Clipart                   (6) | Val  Loss: 0.9414 | Val  Acc: 0.7857
 Site-Clipart                   (0) | Val  Loss: 1.0487 | Val  Acc: 0.7661
 Site-Real                      (1) | Val  Loss: 0.7058 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.7219 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.6979 | Val  Acc: 0.9030
 Site-Real                      (1) | Val  Loss: 0.6892 | Val  Acc: 0.9177
 Site-Painting                  (4) | Val  Loss: 0.7471 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.8850 | Val  Acc: 0.8321
 Site-Painting                  (4) | Val  Loss: 0.8651 | Val  Acc: 0.8177
 Site-Sketch                    (3) | Val  Loss: 0.9498 | Val  Acc: 0.8189
 Site-Sketch                    (3) | Val  Loss: 1.0210 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 1.8484 | Val  Acc: 0.4266
 Site-Infograph                 (7) | Val  Loss: 1.5742 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8023
 Best site-Clipart                  (6)  | Epoch:6 | Val Acc: 0.8158
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8505
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8200
 Best site-Clipart                  (6)  | Epoch:6 | Val Acc: 0.7857
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7661
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9286
 Best site-Real                     (5)  | Epoch:6 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9030
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9177
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.8321
 Best site-Painting                 (4)  | Epoch:6 | Val Acc: 0.8177
 Best site-Sketch                   (3)  | Epoch:6 | Val Acc: 0.8189
 Best site-Sketch                   (3)  | Epoch:6 | Val Acc: 0.7753
 Best site-QuickDraw                (2)  | Epoch:6 | Val Acc: 0.4266
 Best site-Infograph                (7)  | Epoch:6 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 4, 1, 2, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (0) | Train Loss: 0.8551 | Train Acc: 0.8087
 Site-Clipart                   (0) | Train Loss: 0.7908 | Train Acc: 0.8323
 Site-Clipart                   (0) | Train Loss: 0.9197 | Train Acc: 0.8044
 Site-Clipart                   (7) | Train Loss: 0.8593 | Train Acc: 0.8196
 Site-Clipart                   (0) | Train Loss: 0.8774 | Train Acc: 0.8167
 Site-Real                      (1) | Train Loss: 0.6972 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.6037 | Train Acc: 0.9209
 Site-Real                      (1) | Train Loss: 0.6161 | Train Acc: 0.9153
 Site-Real                      (1) | Train Loss: 0.7044 | Train Acc: 0.9109
 Site-Painting                  (3) | Train Loss: 0.8889 | Train Acc: 0.8231
 Site-Painting                  (3) | Train Loss: 0.8337 | Train Acc: 0.8447
 Site-Painting                  (5) | Train Loss: 0.7951 | Train Acc: 0.8581
 Site-Sketch                    (6) | Train Loss: 0.8386 | Train Acc: 0.7644
 Site-Sketch                    (6) | Train Loss: 0.8660 | Train Acc: 0.7715
 Site-QuickDraw                 (2) | Train Loss: 1.7125 | Train Acc: 0.4373
 Site-Infograph                 (4) | Train Loss: 1.6084 | Train Acc: 0.5214
Average Train Accuracy: 0.7971
 Site-Clipart                   (0) | Val  Loss: 0.7216 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.8413 | Val  Acc: 0.8224
 Site-Clipart                   (0) | Val  Loss: 0.8340 | Val  Acc: 0.8467
 Site-Clipart                   (7) | Val  Loss: 0.8364 | Val  Acc: 0.8000
 Site-Clipart                   (0) | Val  Loss: 0.9578 | Val  Acc: 0.8000
 Site-Real                      (1) | Val  Loss: 0.6329 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.6421 | Val  Acc: 0.9068
 Site-Real                      (1) | Val  Loss: 0.6290 | Val  Acc: 0.9030
 Site-Real                      (1) | Val  Loss: 0.6100 | Val  Acc: 0.9264
 Site-Painting                  (3) | Val  Loss: 0.6824 | Val  Acc: 0.8980
 Site-Painting                  (3) | Val  Loss: 0.7576 | Val  Acc: 0.8467
 Site-Painting                  (5) | Val  Loss: 0.7921 | Val  Acc: 0.8490
 Site-Sketch                    (6) | Val  Loss: 0.8953 | Val  Acc: 0.8268
 Site-Sketch                    (6) | Val  Loss: 0.8909 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 1.7527 | Val  Acc: 0.4725
 Site-Infograph                 (4) | Val  Loss: 1.5172 | Val  Acc: 0.5449
Average Valid Accuracy: 0.8135
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8684
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8224
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8467
 Best site-Clipart                  (7)  | Epoch:7 | Val Acc: 0.8000
 Best site-Clipart                  (0)  | Epoch:7 | Val Acc: 0.8000
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9286
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9068
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9030
 Best site-Real                     (1)  | Epoch:7 | Val Acc: 0.9264
 Best site-Painting                 (3)  | Epoch:7 | Val Acc: 0.8980
 Best site-Painting                 (3)  | Epoch:7 | Val Acc: 0.8467
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8490
 Best site-Sketch                   (6)  | Epoch:7 | Val Acc: 0.8268
 Best site-Sketch                   (6)  | Epoch:7 | Val Acc: 0.7753
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.4725
 Best site-Infograph                (4)  | Epoch:7 | Val Acc: 0.5449
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 8 ============
cnt=[3, 1, 2, 2, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (4) | Train Loss: 0.8288 | Train Acc: 0.8261
 Site-Clipart                   (6) | Train Loss: 0.6889 | Train Acc: 0.9068
 Site-Clipart                   (2) | Train Loss: 0.8334 | Train Acc: 0.8178
 Site-Clipart                   (4) | Train Loss: 0.7688 | Train Acc: 0.8354
 Site-Clipart                   (4) | Train Loss: 0.8057 | Train Acc: 0.8484
 Site-Real                      (5) | Train Loss: 0.6277 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.5749 | Train Acc: 0.9153
 Site-Real                      (5) | Train Loss: 0.5358 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.6224 | Train Acc: 0.9080
 Site-Painting                  (0) | Train Loss: 0.8222 | Train Acc: 0.8299
 Site-Painting                  (0) | Train Loss: 0.6959 | Train Acc: 0.8350
 Site-Painting                  (0) | Train Loss: 0.7079 | Train Acc: 0.8754
 Site-Sketch                    (2) | Train Loss: 0.7854 | Train Acc: 0.8010
 Site-Sketch                    (6) | Train Loss: 0.8860 | Train Acc: 0.7940
 Site-QuickDraw                 (1) | Train Loss: 1.6071 | Train Acc: 0.4893
 Site-Infograph                 (7) | Train Loss: 1.5658 | Train Acc: 0.5000
Average Train Accuracy: 0.8137
 Site-Clipart                   (4) | Val  Loss: 0.6649 | Val  Acc: 0.8947
 Site-Clipart                   (6) | Val  Loss: 0.7556 | Val  Acc: 0.8785
 Site-Clipart                   (2) | Val  Loss: 0.7724 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.7739 | Val  Acc: 0.8048
 Site-Clipart                   (4) | Val  Loss: 0.8960 | Val  Acc: 0.8169
 Site-Real                      (5) | Val  Loss: 0.5511 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.5687 | Val  Acc: 0.9322
 Site-Real                      (5) | Val  Loss: 0.5552 | Val  Acc: 0.9152
 Site-Real                      (3) | Val  Loss: 0.5484 | Val  Acc: 0.9351
 Site-Painting                  (0) | Val  Loss: 0.6072 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.6967 | Val  Acc: 0.8467
 Site-Painting                  (0) | Val  Loss: 0.7302 | Val  Acc: 0.8385
 Site-Sketch                    (2) | Val  Loss: 0.8354 | Val  Acc: 0.8031
 Site-Sketch                    (6) | Val  Loss: 0.8890 | Val  Acc: 0.7472
 Site-QuickDraw                 (1) | Val  Loss: 1.6891 | Val  Acc: 0.4633
 Site-Infograph                 (7) | Val  Loss: 1.4432 | Val  Acc: 0.5769
Average Valid Accuracy: 0.8238
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8947
 Best site-Clipart                  (6)  | Epoch:8 | Val Acc: 0.8785
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8048
 Best site-Clipart                  (4)  | Epoch:8 | Val Acc: 0.8169
 Best site-Real                     (5)  | Epoch:8 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:8 | Val Acc: 0.9322
 Best site-Real                     (5)  | Epoch:8 | Val Acc: 0.9152
 Best site-Real                     (3)  | Epoch:8 | Val Acc: 0.9351
 Best site-Painting                 (0)  | Epoch:8 | Val Acc: 0.9082
 Best site-Painting                 (0)  | Epoch:8 | Val Acc: 0.8467
 Best site-Painting                 (0)  | Epoch:8 | Val Acc: 0.8385
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.8031
 Best site-Sketch                   (6)  | Epoch:8 | Val Acc: 0.7472
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.4633
 Best site-Infograph                (7)  | Epoch:8 | Val Acc: 0.5769
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 9 ============
cnt=[3, 1, 2, 4, 1, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (6) | Train Loss: 0.7482 | Train Acc: 0.8261
 Site-Clipart                   (2) | Train Loss: 0.6818 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.7882 | Train Acc: 0.8267
 Site-Clipart                   (4) | Train Loss: 0.7233 | Train Acc: 0.8608
 Site-Clipart                   (6) | Train Loss: 0.7492 | Train Acc: 0.8303
 Site-Real                      (3) | Train Loss: 0.5901 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.5015 | Train Acc: 0.9379
 Site-Real                      (3) | Train Loss: 0.4808 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.5746 | Train Acc: 0.9282
 Site-Painting                  (0) | Train Loss: 0.7369 | Train Acc: 0.8435
 Site-Painting                  (0) | Train Loss: 0.6227 | Train Acc: 0.8641
 Site-Painting                  (0) | Train Loss: 0.6448 | Train Acc: 0.8685
 Site-Sketch                    (7) | Train Loss: 0.7093 | Train Acc: 0.8429
 Site-Sketch                    (7) | Train Loss: 0.7793 | Train Acc: 0.7678
 Site-QuickDraw                 (1) | Train Loss: 1.4800 | Train Acc: 0.5352
 Site-Infograph                 (5) | Train Loss: 1.5111 | Train Acc: 0.5342
Average Train Accuracy: 0.8227
 Site-Clipart                   (6) | Val  Loss: 0.6014 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.6888 | Val  Acc: 0.8692
 Site-Clipart                   (2) | Val  Loss: 0.7382 | Val  Acc: 0.8467
 Site-Clipart                   (4) | Val  Loss: 0.7164 | Val  Acc: 0.8143
 Site-Clipart                   (6) | Val  Loss: 0.8190 | Val  Acc: 0.8237
 Site-Real                      (3) | Val  Loss: 0.5111 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.5267 | Val  Acc: 0.9153
 Site-Real                      (3) | Val  Loss: 0.5061 | Val  Acc: 0.8970
 Site-Real                      (3) | Val  Loss: 0.4949 | Val  Acc: 0.9481
 Site-Painting                  (0) | Val  Loss: 0.5556 | Val  Acc: 0.8878
 Site-Painting                  (0) | Val  Loss: 0.6600 | Val  Acc: 0.8759
 Site-Painting                  (0) | Val  Loss: 0.6618 | Val  Acc: 0.8594
 Site-Sketch                    (7) | Val  Loss: 0.7428 | Val  Acc: 0.8189
 Site-Sketch                    (7) | Val  Loss: 0.8246 | Val  Acc: 0.7584
 Site-QuickDraw                 (1) | Val  Loss: 1.5474 | Val  Acc: 0.5734
 Site-Infograph                 (5) | Val  Loss: 1.3711 | Val  Acc: 0.5577
Average Valid Accuracy: 0.8316
 Best site-Clipart                  (6)  | Epoch:9 | Val Acc: 0.9079
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8692
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8467
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8143
 Best site-Clipart                  (6)  | Epoch:9 | Val Acc: 0.8237
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9153
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.8970
 Best site-Real                     (3)  | Epoch:9 | Val Acc: 0.9481
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.8878
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.8759
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.8594
 Best site-Sketch                   (7)  | Epoch:9 | Val Acc: 0.8189
 Best site-Sketch                   (7)  | Epoch:9 | Val Acc: 0.7584
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.5734
 Best site-Infograph                (5)  | Epoch:9 | Val Acc: 0.5577
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 3, 1, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (1) | Train Loss: 0.7016 | Train Acc: 0.8435
 Site-Clipart                   (7) | Train Loss: 0.5945 | Train Acc: 0.8882
 Site-Clipart                   (7) | Train Loss: 0.7453 | Train Acc: 0.8311
 Site-Clipart                   (1) | Train Loss: 0.6674 | Train Acc: 0.8671
 Site-Clipart                   (1) | Train Loss: 0.7021 | Train Acc: 0.8462
 Site-Real                      (0) | Train Loss: 0.5474 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.4880 | Train Acc: 0.9379
 Site-Real                      (5) | Train Loss: 0.4543 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.5471 | Train Acc: 0.9253
 Site-Painting                  (3) | Train Loss: 0.6911 | Train Acc: 0.8299
 Site-Painting                  (3) | Train Loss: 0.5850 | Train Acc: 0.8786
 Site-Painting                  (5) | Train Loss: 0.6248 | Train Acc: 0.8824
 Site-Sketch                    (4) | Train Loss: 0.6739 | Train Acc: 0.8325
 Site-Sketch                    (4) | Train Loss: 0.6806 | Train Acc: 0.8015
 Site-QuickDraw                 (2) | Train Loss: 1.4120 | Train Acc: 0.5933
 Site-Infograph                 (6) | Train Loss: 1.4685 | Train Acc: 0.5342
Average Train Accuracy: 0.8337
 Site-Clipart                   (1) | Val  Loss: 0.5226 | Val  Acc: 0.9474
 Site-Clipart                   (7) | Val  Loss: 0.6748 | Val  Acc: 0.8505
 Site-Clipart                   (7) | Val  Loss: 0.6612 | Val  Acc: 0.8467
 Site-Clipart                   (1) | Val  Loss: 0.7043 | Val  Acc: 0.8000
 Site-Clipart                   (1) | Val  Loss: 0.7734 | Val  Acc: 0.8068
 Site-Real                      (0) | Val  Loss: 0.4810 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.4636 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.4732 | Val  Acc: 0.9152
 Site-Real                      (0) | Val  Loss: 0.4472 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.5255 | Val  Acc: 0.8980
 Site-Painting                  (3) | Val  Loss: 0.6304 | Val  Acc: 0.8467
 Site-Painting                  (5) | Val  Loss: 0.6322 | Val  Acc: 0.8646
 Site-Sketch                    (4) | Val  Loss: 0.7627 | Val  Acc: 0.7874
 Site-Sketch                    (4) | Val  Loss: 0.7289 | Val  Acc: 0.8202
 Site-QuickDraw                 (2) | Val  Loss: 1.4366 | Val  Acc: 0.5872
 Site-Infograph                 (6) | Val  Loss: 1.3761 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8355
 Best site-Clipart                  (1)  | Epoch:10 | Val Acc: 0.9474
 Best site-Clipart                  (7)  | Epoch:10 | Val Acc: 0.8505
 Best site-Clipart                  (7)  | Epoch:10 | Val Acc: 0.8467
 Best site-Clipart                  (1)  | Epoch:10 | Val Acc: 0.8000
 Best site-Clipart                  (1)  | Epoch:10 | Val Acc: 0.8068
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9407
 Best site-Real                     (5)  | Epoch:10 | Val Acc: 0.9152
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9524
 Best site-Painting                 (3)  | Epoch:10 | Val Acc: 0.8980
 Best site-Painting                 (3)  | Epoch:10 | Val Acc: 0.8467
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8646
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.7874
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.8202
 Best site-QuickDraw                (2)  | Epoch:10 | Val Acc: 0.5872
 Best site-Infograph                (6)  | Epoch:10 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 1, 3, 3, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.6455 | Train Acc: 0.9043
 Site-Clipart                   (5) | Train Loss: 0.5979 | Train Acc: 0.8758
 Site-Clipart                   (3) | Train Loss: 0.7030 | Train Acc: 0.8489
 Site-Clipart                   (0) | Train Loss: 0.6607 | Train Acc: 0.8291
 Site-Clipart                   (5) | Train Loss: 0.6604 | Train Acc: 0.8484
 Site-Real                      (2) | Train Loss: 0.5054 | Train Acc: 0.8889
 Site-Real                      (2) | Train Loss: 0.4360 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.4269 | Train Acc: 0.9435
 Site-Real                      (7) | Train Loss: 0.4960 | Train Acc: 0.9310
 Site-Painting                  (4) | Train Loss: 0.6643 | Train Acc: 0.8707
 Site-Painting                  (4) | Train Loss: 0.6093 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.6188 | Train Acc: 0.8685
 Site-Sketch                    (3) | Train Loss: 0.6603 | Train Acc: 0.8272
 Site-Sketch                    (3) | Train Loss: 0.7678 | Train Acc: 0.7978
 Site-QuickDraw                 (1) | Train Loss: 1.4457 | Train Acc: 0.5749
 Site-Infograph                 (6) | Train Loss: 1.4161 | Train Acc: 0.5598
Average Train Accuracy: 0.8380
 Site-Clipart                   (0) | Val  Loss: 0.5206 | Val  Acc: 0.8553
 Site-Clipart                   (5) | Val  Loss: 0.6211 | Val  Acc: 0.8598
 Site-Clipart                   (3) | Val  Loss: 0.6426 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.6376 | Val  Acc: 0.8286
 Site-Clipart                   (5) | Val  Loss: 0.7208 | Val  Acc: 0.8203
 Site-Real                      (2) | Val  Loss: 0.4629 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.4320 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.4311 | Val  Acc: 0.9273
 Site-Real                      (7) | Val  Loss: 0.4468 | Val  Acc: 0.9351
 Site-Painting                  (4) | Val  Loss: 0.4864 | Val  Acc: 0.9184
 Site-Painting                  (4) | Val  Loss: 0.6313 | Val  Acc: 0.8540
 Site-Painting                  (4) | Val  Loss: 0.6017 | Val  Acc: 0.8750
 Site-Sketch                    (3) | Val  Loss: 0.7020 | Val  Acc: 0.8031
 Site-Sketch                    (3) | Val  Loss: 0.7762 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 1.4223 | Val  Acc: 0.5872
 Site-Infograph                 (6) | Val  Loss: 1.3339 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8321
============ Train epoch 12 ============
cnt=[4, 2, 1, 1, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (4) | Train Loss: 0.6309 | Train Acc: 0.8522
 Site-Clipart                   (4) | Train Loss: 0.5569 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.6986 | Train Acc: 0.8533
 Site-Clipart                   (5) | Train Loss: 0.6204 | Train Acc: 0.8481
 Site-Clipart                   (4) | Train Loss: 0.6245 | Train Acc: 0.8462
 Site-Real                      (0) | Train Loss: 0.4762 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.4165 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.4197 | Train Acc: 0.9355
 Site-Real                      (0) | Train Loss: 0.4837 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.5994 | Train Acc: 0.8435
 Site-Painting                  (7) | Train Loss: 0.5343 | Train Acc: 0.8592
 Site-Painting                  (7) | Train Loss: 0.5904 | Train Acc: 0.8547
 Site-Sketch                    (1) | Train Loss: 0.6240 | Train Acc: 0.8377
 Site-Sketch                    (1) | Train Loss: 0.7732 | Train Acc: 0.7940
 Site-QuickDraw                 (2) | Train Loss: 1.2726 | Train Acc: 0.6055
 Site-Infograph                 (6) | Train Loss: 1.3781 | Train Acc: 0.5641
Average Train Accuracy: 0.8343
 Site-Clipart                   (4) | Val  Loss: 0.5180 | Val  Acc: 0.8947
 Site-Clipart                   (4) | Val  Loss: 0.5954 | Val  Acc: 0.8972
 Site-Clipart                   (4) | Val  Loss: 0.6007 | Val  Acc: 0.8467
 Site-Clipart                   (5) | Val  Loss: 0.6250 | Val  Acc: 0.8381
 Site-Clipart                   (4) | Val  Loss: 0.7208 | Val  Acc: 0.8136
 Site-Real                      (0) | Val  Loss: 0.4274 | Val  Acc: 0.9167
 Site-Real                      (0) | Val  Loss: 0.4528 | Val  Acc: 0.9153
 Site-Real                      (0) | Val  Loss: 0.4301 | Val  Acc: 0.9273
 Site-Real                      (0) | Val  Loss: 0.4251 | Val  Acc: 0.9351
 Site-Painting                  (3) | Val  Loss: 0.4915 | Val  Acc: 0.9082
 Site-Painting                  (7) | Val  Loss: 0.5805 | Val  Acc: 0.8394
 Site-Painting                  (7) | Val  Loss: 0.5712 | Val  Acc: 0.8802
 Site-Sketch                    (1) | Val  Loss: 0.6477 | Val  Acc: 0.7953
 Site-Sketch                    (1) | Val  Loss: 0.6966 | Val  Acc: 0.8202
 Site-QuickDraw                 (2) | Val  Loss: 1.2866 | Val  Acc: 0.6514
 Site-Infograph                 (6) | Val  Loss: 1.2574 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8442
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8947
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8972
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8467
 Best site-Clipart                  (5)  | Epoch:12 | Val Acc: 0.8381
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8136
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9167
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9153
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9273
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9351
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.9082
 Best site-Painting                 (7)  | Epoch:12 | Val Acc: 0.8394
 Best site-Painting                 (7)  | Epoch:12 | Val Acc: 0.8802
 Best site-Sketch                   (1)  | Epoch:12 | Val Acc: 0.7953
 Best site-Sketch                   (1)  | Epoch:12 | Val Acc: 0.8202
 Best site-QuickDraw                (2)  | Epoch:12 | Val Acc: 0.6514
 Best site-Infograph                (6)  | Epoch:12 | Val Acc: 0.6282
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 1, 3, 2, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (0) | Train Loss: 0.5868 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.5428 | Train Acc: 0.8634
 Site-Clipart                   (2) | Train Loss: 0.6415 | Train Acc: 0.8667
 Site-Clipart                   (0) | Train Loss: 0.6084 | Train Acc: 0.8449
 Site-Clipart                   (2) | Train Loss: 0.6118 | Train Acc: 0.8529
 Site-Real                      (6) | Train Loss: 0.4892 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.3673 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3952 | Train Acc: 0.9234
 Site-Real                      (4) | Train Loss: 0.4331 | Train Acc: 0.9310
 Site-Painting                  (4) | Train Loss: 0.5398 | Train Acc: 0.8503
 Site-Painting                  (4) | Train Loss: 0.5705 | Train Acc: 0.8738
 Site-Painting                  (4) | Train Loss: 0.5344 | Train Acc: 0.8927
 Site-Sketch                    (5) | Train Loss: 0.5953 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.7158 | Train Acc: 0.7978
 Site-QuickDraw                 (1) | Train Loss: 1.2675 | Train Acc: 0.6391
 Site-Infograph                 (7) | Train Loss: 1.3828 | Train Acc: 0.5470
Average Train Accuracy: 0.8405
 Site-Clipart                   (0) | Val  Loss: 0.4256 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.5460 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.5420 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.5939 | Val  Acc: 0.8524
 Site-Clipart                   (2) | Val  Loss: 0.6773 | Val  Acc: 0.8339
 Site-Real                      (6) | Val  Loss: 0.4024 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.3907 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.4145 | Val  Acc: 0.9030
 Site-Real                      (4) | Val  Loss: 0.3717 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.4373 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.5220 | Val  Acc: 0.8613
 Site-Painting                  (4) | Val  Loss: 0.5340 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.6235 | Val  Acc: 0.8268
 Site-Sketch                    (5) | Val  Loss: 0.7171 | Val  Acc: 0.7640
 Site-QuickDraw                 (1) | Val  Loss: 1.2624 | Val  Acc: 0.6789
 Site-Infograph                 (7) | Val  Loss: 1.2688 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8500
 Best site-Clipart                  (0)  | Epoch:13 | Val Acc: 0.9079
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8733
 Best site-Clipart                  (0)  | Epoch:13 | Val Acc: 0.8524
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8339
 Best site-Real                     (6)  | Epoch:13 | Val Acc: 0.9286
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:13 | Val Acc: 0.9030
 Best site-Real                     (4)  | Epoch:13 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.8613
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.8958
 Best site-Sketch                   (5)  | Epoch:13 | Val Acc: 0.8268
 Best site-Sketch                   (5)  | Epoch:13 | Val Acc: 0.7640
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.6789
 Best site-Infograph                (7)  | Epoch:13 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 14 ============
cnt=[3, 1, 4, 2, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (2) | Train Loss: 0.6010 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.4858 | Train Acc: 0.8882
 Site-Clipart                   (4) | Train Loss: 0.6377 | Train Acc: 0.8444
 Site-Clipart                   (2) | Train Loss: 0.6019 | Train Acc: 0.8386
 Site-Clipart                   (2) | Train Loss: 0.6086 | Train Acc: 0.8371
 Site-Real                      (0) | Train Loss: 0.4454 | Train Acc: 0.8968
 Site-Real                      (5) | Train Loss: 0.3473 | Train Acc: 0.9379
 Site-Real                      (0) | Train Loss: 0.3792 | Train Acc: 0.9355
 Site-Real                      (0) | Train Loss: 0.4246 | Train Acc: 0.9224
 Site-Painting                  (6) | Train Loss: 0.5314 | Train Acc: 0.8776
 Site-Painting                  (3) | Train Loss: 0.5648 | Train Acc: 0.8786
 Site-Painting                  (3) | Train Loss: 0.5166 | Train Acc: 0.8962
 Site-Sketch                    (4) | Train Loss: 0.5660 | Train Acc: 0.8429
 Site-Sketch                    (4) | Train Loss: 0.6027 | Train Acc: 0.8015
 Site-QuickDraw                 (1) | Train Loss: 1.1267 | Train Acc: 0.6575
 Site-Infograph                 (7) | Train Loss: 1.3674 | Train Acc: 0.5513
Average Train Accuracy: 0.8423
 Site-Clipart                   (2) | Val  Loss: 0.4108 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.5390 | Val  Acc: 0.8692
 Site-Clipart                   (4) | Val  Loss: 0.5503 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.5820 | Val  Acc: 0.8333
 Site-Clipart                   (2) | Val  Loss: 0.6769 | Val  Acc: 0.8169
 Site-Real                      (0) | Val  Loss: 0.3941 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.3622 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.3451 | Val  Acc: 0.9394
 Site-Real                      (0) | Val  Loss: 0.3757 | Val  Acc: 0.9437
 Site-Painting                  (6) | Val  Loss: 0.4502 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.4841 | Val  Acc: 0.8467
 Site-Painting                  (3) | Val  Loss: 0.5371 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.5882 | Val  Acc: 0.8425
 Site-Sketch                    (4) | Val  Loss: 0.6330 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 1.1741 | Val  Acc: 0.7064
 Site-Infograph                 (7) | Val  Loss: 1.2147 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8534
 Best site-Clipart                  (2)  | Epoch:14 | Val Acc: 0.9079
 Best site-Clipart                  (2)  | Epoch:14 | Val Acc: 0.8692
 Best site-Clipart                  (4)  | Epoch:14 | Val Acc: 0.8867
 Best site-Clipart                  (2)  | Epoch:14 | Val Acc: 0.8333
 Best site-Clipart                  (2)  | Epoch:14 | Val Acc: 0.8169
 Best site-Real                     (0)  | Epoch:14 | Val Acc: 0.9286
 Best site-Real                     (5)  | Epoch:14 | Val Acc: 0.9322
 Best site-Real                     (0)  | Epoch:14 | Val Acc: 0.9394
 Best site-Real                     (0)  | Epoch:14 | Val Acc: 0.9437
 Best site-Painting                 (6)  | Epoch:14 | Val Acc: 0.9184
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.8467
 Best site-Painting                 (3)  | Epoch:14 | Val Acc: 0.8698
 Best site-Sketch                   (4)  | Epoch:14 | Val Acc: 0.8425
 Best site-Sketch                   (4)  | Epoch:14 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:14 | Val Acc: 0.7064
 Best site-Infograph                (7)  | Epoch:14 | Val Acc: 0.6090
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 15 ============
cnt=[3, 1, 4, 1, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (0) | Train Loss: 0.6098 | Train Acc: 0.8957
 Site-Clipart                   (6) | Train Loss: 0.4711 | Train Acc: 0.9193
 Site-Clipart                   (6) | Train Loss: 0.6154 | Train Acc: 0.8533
 Site-Clipart                   (4) | Train Loss: 0.5790 | Train Acc: 0.8323
 Site-Clipart                   (6) | Train Loss: 0.5736 | Train Acc: 0.8394
 Site-Real                      (2) | Train Loss: 0.4251 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.3324 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.3352 | Train Acc: 0.9516
 Site-Real                      (2) | Train Loss: 0.4033 | Train Acc: 0.9339
 Site-Painting                  (3) | Train Loss: 0.5722 | Train Acc: 0.8844
 Site-Painting                  (7) | Train Loss: 0.5433 | Train Acc: 0.8689
 Site-Painting                  (7) | Train Loss: 0.5407 | Train Acc: 0.8720
 Site-Sketch                    (0) | Train Loss: 0.5853 | Train Acc: 0.8325
 Site-Sketch                    (0) | Train Loss: 0.6216 | Train Acc: 0.8052
 Site-QuickDraw                 (1) | Train Loss: 1.0849 | Train Acc: 0.6728
 Site-Infograph                 (5) | Train Loss: 1.2884 | Train Acc: 0.5897
Average Train Accuracy: 0.8504
 Site-Clipart                   (0) | Val  Loss: 0.4075 | Val  Acc: 0.8684
 Site-Clipart                   (6) | Val  Loss: 0.5135 | Val  Acc: 0.8692
 Site-Clipart                   (6) | Val  Loss: 0.5298 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.5744 | Val  Acc: 0.8286
 Site-Clipart                   (6) | Val  Loss: 0.6293 | Val  Acc: 0.8339
 Site-Real                      (2) | Val  Loss: 0.3578 | Val  Acc: 0.9167
 Site-Real                      (2) | Val  Loss: 0.3698 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.3647 | Val  Acc: 0.9091
 Site-Real                      (2) | Val  Loss: 0.3382 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.3970 | Val  Acc: 0.9286
 Site-Painting                  (7) | Val  Loss: 0.5425 | Val  Acc: 0.8613
 Site-Painting                  (7) | Val  Loss: 0.5201 | Val  Acc: 0.8750
 Site-Sketch                    (0) | Val  Loss: 0.5909 | Val  Acc: 0.8189
 Site-Sketch                    (0) | Val  Loss: 0.6163 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.1790 | Val  Acc: 0.6835
 Site-Infograph                 (5) | Val  Loss: 1.1785 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8494
============ Train epoch 16 ============
cnt=[1, 1, 4, 3, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (5) | Train Loss: 0.5612 | Train Acc: 0.8435
 Site-Clipart                   (2) | Train Loss: 0.4672 | Train Acc: 0.8758
 Site-Clipart                   (2) | Train Loss: 0.5762 | Train Acc: 0.8800
 Site-Clipart                   (5) | Train Loss: 0.5317 | Train Acc: 0.8449
 Site-Clipart                   (2) | Train Loss: 0.5433 | Train Acc: 0.8756
 Site-Real                      (3) | Train Loss: 0.4225 | Train Acc: 0.8968
 Site-Real                      (3) | Train Loss: 0.3116 | Train Acc: 0.9548
 Site-Real                      (3) | Train Loss: 0.3247 | Train Acc: 0.9395
 Site-Real                      (6) | Train Loss: 0.3964 | Train Acc: 0.9224
 Site-Painting                  (1) | Train Loss: 0.5636 | Train Acc: 0.8844
 Site-Painting                  (4) | Train Loss: 0.4996 | Train Acc: 0.8689
 Site-Painting                  (4) | Train Loss: 0.4712 | Train Acc: 0.8858
 Site-Sketch                    (5) | Train Loss: 0.5561 | Train Acc: 0.8534
 Site-Sketch                    (2) | Train Loss: 0.5441 | Train Acc: 0.8277
 Site-QuickDraw                 (0) | Train Loss: 1.0950 | Train Acc: 0.6422
 Site-Infograph                 (7) | Train Loss: 1.3101 | Train Acc: 0.5769
Average Train Accuracy: 0.8483
 Site-Clipart                   (5) | Val  Loss: 0.3727 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.4799 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.5220 | Val  Acc: 0.8533
 Site-Clipart                   (5) | Val  Loss: 0.5245 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.6216 | Val  Acc: 0.8441
 Site-Real                      (3) | Val  Loss: 0.3474 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3721 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.3539 | Val  Acc: 0.9152
 Site-Real                      (6) | Val  Loss: 0.3302 | Val  Acc: 0.9567
 Site-Painting                  (1) | Val  Loss: 0.3858 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.4578 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.5026 | Val  Acc: 0.8698
 Site-Sketch                    (5) | Val  Loss: 0.5879 | Val  Acc: 0.8346
 Site-Sketch                    (2) | Val  Loss: 0.6205 | Val  Acc: 0.7921
 Site-QuickDraw                 (0) | Val  Loss: 1.1350 | Val  Acc: 0.6927
 Site-Infograph                 (7) | Val  Loss: 1.1730 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8601
 Best site-Clipart                  (5)  | Epoch:16 | Val Acc: 0.9342
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8972
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8533
 Best site-Clipart                  (5)  | Epoch:16 | Val Acc: 0.8476
 Best site-Clipart                  (2)  | Epoch:16 | Val Acc: 0.8441
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9322
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9152
 Best site-Real                     (6)  | Epoch:16 | Val Acc: 0.9567
 Best site-Painting                 (1)  | Epoch:16 | Val Acc: 0.9388
 Best site-Painting                 (4)  | Epoch:16 | Val Acc: 0.8978
 Best site-Painting                 (4)  | Epoch:16 | Val Acc: 0.8698
 Best site-Sketch                   (5)  | Epoch:16 | Val Acc: 0.8346
 Best site-Sketch                   (2)  | Epoch:16 | Val Acc: 0.7921
 Best site-QuickDraw                (0)  | Epoch:16 | Val Acc: 0.6927
 Best site-Infograph                (7)  | Epoch:16 | Val Acc: 0.6154
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 1, 1, 4, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (4) | Train Loss: 0.4963 | Train Acc: 0.8783
 Site-Clipart                   (6) | Train Loss: 0.4209 | Train Acc: 0.9130
 Site-Clipart                   (6) | Train Loss: 0.5854 | Train Acc: 0.8667
 Site-Clipart                   (4) | Train Loss: 0.5222 | Train Acc: 0.8544
 Site-Clipart                   (6) | Train Loss: 0.5432 | Train Acc: 0.8665
 Site-Real                      (3) | Train Loss: 0.3943 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.3116 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.3020 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.3789 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.5141 | Train Acc: 0.8639
 Site-Painting                  (5) | Train Loss: 0.5690 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.5015 | Train Acc: 0.8927
 Site-Sketch                    (0) | Train Loss: 0.5401 | Train Acc: 0.8429
 Site-Sketch                    (0) | Train Loss: 0.6618 | Train Acc: 0.7903
 Site-QuickDraw                 (1) | Train Loss: 0.9943 | Train Acc: 0.7064
 Site-Infograph                 (7) | Train Loss: 1.2453 | Train Acc: 0.5812
Average Train Accuracy: 0.8563
 Site-Clipart                   (4) | Val  Loss: 0.4116 | Val  Acc: 0.8816
 Site-Clipart                   (6) | Val  Loss: 0.4970 | Val  Acc: 0.8785
 Site-Clipart                   (6) | Val  Loss: 0.5025 | Val  Acc: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.5143 | Val  Acc: 0.8429
 Site-Clipart                   (6) | Val  Loss: 0.6317 | Val  Acc: 0.8305
 Site-Real                      (3) | Val  Loss: 0.3199 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3315 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.3224 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.3186 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.3726 | Val  Acc: 0.8980
 Site-Painting                  (5) | Val  Loss: 0.4984 | Val  Acc: 0.8686
 Site-Painting                  (2) | Val  Loss: 0.5120 | Val  Acc: 0.8646
 Site-Sketch                    (0) | Val  Loss: 0.6219 | Val  Acc: 0.8110
 Site-Sketch                    (0) | Val  Loss: 0.5903 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.1259 | Val  Acc: 0.6835
 Site-Infograph                 (7) | Val  Loss: 1.1678 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8523
============ Train epoch 18 ============
cnt=[4, 1, 4, 3, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (5) | Train Loss: 0.5789 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.3815 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.5969 | Train Acc: 0.8444
 Site-Clipart                   (2) | Train Loss: 0.5141 | Train Acc: 0.8608
 Site-Clipart                   (2) | Train Loss: 0.5257 | Train Acc: 0.8688
 Site-Real                      (0) | Train Loss: 0.3763 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2692 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.3113 | Train Acc: 0.9355
 Site-Real                      (0) | Train Loss: 0.3514 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.4657 | Train Acc: 0.8639
 Site-Painting                  (3) | Train Loss: 0.5094 | Train Acc: 0.8883
 Site-Painting                  (3) | Train Loss: 0.4485 | Train Acc: 0.8997
 Site-Sketch                    (4) | Train Loss: 0.5131 | Train Acc: 0.8482
 Site-Sketch                    (7) | Train Loss: 0.6138 | Train Acc: 0.7903
 Site-QuickDraw                 (1) | Train Loss: 0.9766 | Train Acc: 0.6881
 Site-Infograph                 (6) | Train Loss: 1.2696 | Train Acc: 0.5812
Average Train Accuracy: 0.8549
 Site-Clipart                   (5) | Val  Loss: 0.3526 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.4745 | Val  Acc: 0.8505
 Site-Clipart                   (2) | Val  Loss: 0.4627 | Val  Acc: 0.8867
 Site-Clipart                   (2) | Val  Loss: 0.5032 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.5857 | Val  Acc: 0.8339
 Site-Real                      (0) | Val  Loss: 0.3077 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.3237 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.3008 | Val  Acc: 0.9273
 Site-Real                      (0) | Val  Loss: 0.3053 | Val  Acc: 0.9610
 Site-Painting                  (3) | Val  Loss: 0.3687 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.4879 | Val  Acc: 0.8759
 Site-Painting                  (3) | Val  Loss: 0.4549 | Val  Acc: 0.8854
 Site-Sketch                    (4) | Val  Loss: 0.5474 | Val  Acc: 0.8425
 Site-Sketch                    (7) | Val  Loss: 0.5805 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 1.0824 | Val  Acc: 0.7156
 Site-Infograph                 (6) | Val  Loss: 1.1377 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8659
 Best site-Clipart                  (5)  | Epoch:18 | Val Acc: 0.9342
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8505
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8867
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8571
 Best site-Clipart                  (2)  | Epoch:18 | Val Acc: 0.8339
 Best site-Real                     (0)  | Epoch:18 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:18 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:18 | Val Acc: 0.9273
 Best site-Real                     (0)  | Epoch:18 | Val Acc: 0.9610
 Best site-Painting                 (3)  | Epoch:18 | Val Acc: 0.9286
 Best site-Painting                 (3)  | Epoch:18 | Val Acc: 0.8759
 Best site-Painting                 (3)  | Epoch:18 | Val Acc: 0.8854
 Best site-Sketch                   (4)  | Epoch:18 | Val Acc: 0.8425
 Best site-Sketch                   (7)  | Epoch:18 | Val Acc: 0.8202
 Best site-QuickDraw                (1)  | Epoch:18 | Val Acc: 0.7156
 Best site-Infograph                (6)  | Epoch:18 | Val Acc: 0.6538
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 1, 2, 2, 4, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (7) | Train Loss: 0.5252 | Train Acc: 0.8870
 Site-Clipart                   (7) | Train Loss: 0.3927 | Train Acc: 0.9130
 Site-Clipart                   (7) | Train Loss: 0.5252 | Train Acc: 0.8489
 Site-Clipart                   (0) | Train Loss: 0.5183 | Train Acc: 0.8576
 Site-Clipart                   (0) | Train Loss: 0.5129 | Train Acc: 0.8756
 Site-Real                      (4) | Train Loss: 0.4266 | Train Acc: 0.8968
 Site-Real                      (4) | Train Loss: 0.2993 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2989 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.3419 | Train Acc: 0.9425
 Site-Painting                  (6) | Train Loss: 0.4918 | Train Acc: 0.8639
 Site-Painting                  (2) | Train Loss: 0.4739 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.4486 | Train Acc: 0.8858
 Site-Sketch                    (3) | Train Loss: 0.5278 | Train Acc: 0.8586
 Site-Sketch                    (3) | Train Loss: 0.5804 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 0.9462 | Train Acc: 0.7187
 Site-Infograph                 (5) | Train Loss: 1.2447 | Train Acc: 0.5897
Average Train Accuracy: 0.8585
 Site-Clipart                   (7) | Val  Loss: 0.3254 | Val  Acc: 0.9474
 Site-Clipart                   (7) | Val  Loss: 0.4574 | Val  Acc: 0.8692
 Site-Clipart                   (7) | Val  Loss: 0.4637 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4835 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.5893 | Val  Acc: 0.8407
 Site-Real                      (4) | Val  Loss: 0.3166 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.3287 | Val  Acc: 0.9153
 Site-Real                      (4) | Val  Loss: 0.2864 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2873 | Val  Acc: 0.9610
 Site-Painting                  (6) | Val  Loss: 0.3843 | Val  Acc: 0.8776
 Site-Painting                  (2) | Val  Loss: 0.4024 | Val  Acc: 0.8686
 Site-Painting                  (2) | Val  Loss: 0.4442 | Val  Acc: 0.8698
 Site-Sketch                    (3) | Val  Loss: 0.5476 | Val  Acc: 0.8425
 Site-Sketch                    (3) | Val  Loss: 0.6667 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 1.0692 | Val  Acc: 0.7064
 Site-Infograph                 (5) | Val  Loss: 1.0834 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8585
============ Train epoch 20 ============
cnt=[4, 1, 2, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (4) | Train Loss: 0.5243 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3896 | Train Acc: 0.9006
 Site-Clipart                   (7) | Train Loss: 0.5649 | Train Acc: 0.8533
 Site-Clipart                   (4) | Train Loss: 0.4698 | Train Acc: 0.8671
 Site-Clipart                   (4) | Train Loss: 0.4801 | Train Acc: 0.8937
 Site-Real                      (0) | Train Loss: 0.4099 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.2608 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2749 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.3606 | Train Acc: 0.9310
 Site-Painting                  (3) | Train Loss: 0.5247 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.4551 | Train Acc: 0.8738
 Site-Painting                  (5) | Train Loss: 0.4528 | Train Acc: 0.8824
 Site-Sketch                    (2) | Train Loss: 0.5233 | Train Acc: 0.8639
 Site-Sketch                    (2) | Train Loss: 0.5708 | Train Acc: 0.8127
 Site-QuickDraw                 (1) | Train Loss: 0.9544 | Train Acc: 0.7095
 Site-Infograph                 (6) | Train Loss: 1.2000 | Train Acc: 0.6068
Average Train Accuracy: 0.8588
 Site-Clipart                   (4) | Val  Loss: 0.3394 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.4256 | Val  Acc: 0.8972
 Site-Clipart                   (7) | Val  Loss: 0.4751 | Val  Acc: 0.8667
 Site-Clipart                   (4) | Val  Loss: 0.4918 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.5690 | Val  Acc: 0.8441
 Site-Real                      (0) | Val  Loss: 0.2884 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.3047 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.3052 | Val  Acc: 0.9273
 Site-Real                      (0) | Val  Loss: 0.2955 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.3438 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.4241 | Val  Acc: 0.8540
 Site-Painting                  (5) | Val  Loss: 0.4779 | Val  Acc: 0.8698
 Site-Sketch                    (2) | Val  Loss: 0.5142 | Val  Acc: 0.8504
 Site-Sketch                    (2) | Val  Loss: 0.5709 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 1.0128 | Val  Acc: 0.7339
 Site-Infograph                 (6) | Val  Loss: 1.0874 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8660
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.9211
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.8972
 Best site-Clipart                  (7)  | Epoch:20 | Val Acc: 0.8667
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.8571
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.8441
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9273
 Best site-Real                     (0)  | Epoch:20 | Val Acc: 0.9437
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.9286
 Best site-Painting                 (5)  | Epoch:20 | Val Acc: 0.8540
 Best site-Painting                 (5)  | Epoch:20 | Val Acc: 0.8698
 Best site-Sketch                   (2)  | Epoch:20 | Val Acc: 0.8504
 Best site-Sketch                   (2)  | Epoch:20 | Val Acc: 0.8146
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.7339
 Best site-Infograph                (6)  | Epoch:20 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 21 ============
cnt=[3, 1, 1, 2, 1, 3, 3, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.4879 | Train Acc: 0.8783
 Site-Clipart                   (0) | Train Loss: 0.3628 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.5535 | Train Acc: 0.8400
 Site-Clipart                   (7) | Train Loss: 0.4938 | Train Acc: 0.8513
 Site-Clipart                   (7) | Train Loss: 0.4860 | Train Acc: 0.8869
 Site-Real                      (6) | Train Loss: 0.3580 | Train Acc: 0.9127
 Site-Real                      (6) | Train Loss: 0.2670 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2695 | Train Acc: 0.9516
 Site-Real                      (6) | Train Loss: 0.3344 | Train Acc: 0.9397
 Site-Painting                  (5) | Train Loss: 0.4332 | Train Acc: 0.8707
 Site-Painting                  (5) | Train Loss: 0.3707 | Train Acc: 0.8883
 Site-Painting                  (5) | Train Loss: 0.4017 | Train Acc: 0.8962
 Site-Sketch                    (3) | Train Loss: 0.5353 | Train Acc: 0.8325
 Site-Sketch                    (3) | Train Loss: 0.5828 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 0.9930 | Train Acc: 0.7156
 Site-Infograph                 (4) | Train Loss: 1.1387 | Train Acc: 0.6410
Average Train Accuracy: 0.8624
 Site-Clipart                   (0) | Val  Loss: 0.3266 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.4199 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.4926 | Val  Acc: 0.8533
 Site-Clipart                   (7) | Val  Loss: 0.4706 | Val  Acc: 0.8762
 Site-Clipart                   (7) | Val  Loss: 0.5681 | Val  Acc: 0.8203
 Site-Real                      (6) | Val  Loss: 0.3055 | Val  Acc: 0.9405
 Site-Real                      (6) | Val  Loss: 0.3228 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.3004 | Val  Acc: 0.9273
 Site-Real                      (6) | Val  Loss: 0.2992 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.3268 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.4549 | Val  Acc: 0.8759
 Site-Painting                  (5) | Val  Loss: 0.3880 | Val  Acc: 0.9062
 Site-Sketch                    (3) | Val  Loss: 0.5140 | Val  Acc: 0.8425
 Site-Sketch                    (3) | Val  Loss: 0.5687 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 0.9870 | Val  Acc: 0.7431
 Site-Infograph                 (4) | Val  Loss: 1.0841 | Val  Acc: 0.6538
Average Valid Accuracy: 0.8692
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.9211
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.9252
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8533
 Best site-Clipart                  (7)  | Epoch:21 | Val Acc: 0.8762
 Best site-Clipart                  (7)  | Epoch:21 | Val Acc: 0.8203
 Best site-Real                     (6)  | Epoch:21 | Val Acc: 0.9405
 Best site-Real                     (6)  | Epoch:21 | Val Acc: 0.9322
 Best site-Real                     (2)  | Epoch:21 | Val Acc: 0.9273
 Best site-Real                     (6)  | Epoch:21 | Val Acc: 0.9524
 Best site-Painting                 (5)  | Epoch:21 | Val Acc: 0.9388
 Best site-Painting                 (5)  | Epoch:21 | Val Acc: 0.8759
 Best site-Painting                 (5)  | Epoch:21 | Val Acc: 0.9062
 Best site-Sketch                   (3)  | Epoch:21 | Val Acc: 0.8425
 Best site-Sketch                   (3)  | Epoch:21 | Val Acc: 0.7978
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.7431
 Best site-Infograph                (4)  | Epoch:21 | Val Acc: 0.6538
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 1, 2, 3, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (6) | Train Loss: 0.5305 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.3724 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.5167 | Train Acc: 0.8489
 Site-Clipart                   (6) | Train Loss: 0.5102 | Train Acc: 0.8481
 Site-Clipart                   (6) | Train Loss: 0.4534 | Train Acc: 0.8733
 Site-Real                      (3) | Train Loss: 0.3560 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2510 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2709 | Train Acc: 0.9476
 Site-Real                      (7) | Train Loss: 0.3142 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.4494 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.4100 | Train Acc: 0.8641
 Site-Painting                  (7) | Train Loss: 0.4092 | Train Acc: 0.9100
 Site-Sketch                    (5) | Train Loss: 0.4983 | Train Acc: 0.8482
 Site-Sketch                    (5) | Train Loss: 0.4658 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.9462 | Train Acc: 0.7125
 Site-Infograph                 (4) | Train Loss: 1.1083 | Train Acc: 0.6282
Average Train Accuracy: 0.8622
 Site-Clipart                   (6) | Val  Loss: 0.3194 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.3954 | Val  Acc: 0.9065
 Site-Clipart                   (2) | Val  Loss: 0.4455 | Val  Acc: 0.8800
 Site-Clipart                   (6) | Val  Loss: 0.4836 | Val  Acc: 0.8381
 Site-Clipart                   (6) | Val  Loss: 0.5560 | Val  Acc: 0.8576
 Site-Real                      (3) | Val  Loss: 0.2929 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2784 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2487 | Val  Acc: 0.9515
 Site-Real                      (7) | Val  Loss: 0.2581 | Val  Acc: 0.9610
 Site-Painting                  (0) | Val  Loss: 0.3269 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.4554 | Val  Acc: 0.8759
 Site-Painting                  (7) | Val  Loss: 0.4031 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.4994 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.5534 | Val  Acc: 0.8258
 Site-QuickDraw                 (1) | Val  Loss: 0.9786 | Val  Acc: 0.7431
 Site-Infograph                 (4) | Val  Loss: 1.0640 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8735
 Best site-Clipart                  (6)  | Epoch:22 | Val Acc: 0.9211
 Best site-Clipart                  (2)  | Epoch:22 | Val Acc: 0.9065
 Best site-Clipart                  (2)  | Epoch:22 | Val Acc: 0.8800
 Best site-Clipart                  (6)  | Epoch:22 | Val Acc: 0.8381
 Best site-Clipart                  (6)  | Epoch:22 | Val Acc: 0.8576
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9515
 Best site-Real                     (7)  | Epoch:22 | Val Acc: 0.9610
 Best site-Painting                 (0)  | Epoch:22 | Val Acc: 0.9286
 Best site-Painting                 (0)  | Epoch:22 | Val Acc: 0.8759
 Best site-Painting                 (7)  | Epoch:22 | Val Acc: 0.9062
 Best site-Sketch                   (5)  | Epoch:22 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:22 | Val Acc: 0.8258
 Best site-QuickDraw                (1)  | Epoch:22 | Val Acc: 0.7431
 Best site-Infograph                (4)  | Epoch:22 | Val Acc: 0.6474
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 23 ============
cnt=[4, 1, 4, 3, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.5412 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.3511 | Train Acc: 0.9379
 Site-Clipart                   (2) | Train Loss: 0.5345 | Train Acc: 0.8667
 Site-Clipart                   (6) | Train Loss: 0.4500 | Train Acc: 0.8797
 Site-Clipart                   (2) | Train Loss: 0.4547 | Train Acc: 0.8801
 Site-Real                      (0) | Train Loss: 0.3721 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2526 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2622 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 0.3200 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.4087 | Train Acc: 0.8844
 Site-Painting                  (3) | Train Loss: 0.3620 | Train Acc: 0.9029
 Site-Painting                  (3) | Train Loss: 0.3992 | Train Acc: 0.9031
 Site-Sketch                    (7) | Train Loss: 0.4999 | Train Acc: 0.8586
 Site-Sketch                    (4) | Train Loss: 0.5334 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.8961 | Train Acc: 0.7492
 Site-Infograph                 (5) | Train Loss: 1.0881 | Train Acc: 0.6410
Average Train Accuracy: 0.8720
 Site-Clipart                   (2) | Val  Loss: 0.2954 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3916 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.4563 | Val  Acc: 0.8867
 Site-Clipart                   (6) | Val  Loss: 0.4812 | Val  Acc: 0.8429
 Site-Clipart                   (2) | Val  Loss: 0.5741 | Val  Acc: 0.8305
 Site-Real                      (0) | Val  Loss: 0.2806 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2705 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2764 | Val  Acc: 0.9212
 Site-Real                      (0) | Val  Loss: 0.2689 | Val  Acc: 0.9567
 Site-Painting                  (3) | Val  Loss: 0.3128 | Val  Acc: 0.9286
 Site-Painting                  (3) | Val  Loss: 0.4572 | Val  Acc: 0.8978
 Site-Painting                  (3) | Val  Loss: 0.4191 | Val  Acc: 0.8854
 Site-Sketch                    (7) | Val  Loss: 0.4817 | Val  Acc: 0.8425
 Site-Sketch                    (4) | Val  Loss: 0.5283 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.9331 | Val  Acc: 0.7431
 Site-Infograph                 (5) | Val  Loss: 1.0182 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8710
============ Train epoch 24 ============
cnt=[2, 1, 3, 1, 3, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (4) | Train Loss: 0.4851 | Train Acc: 0.8783
 Site-Clipart                   (6) | Train Loss: 0.4171 | Train Acc: 0.9255
 Site-Clipart                   (6) | Train Loss: 0.5244 | Train Acc: 0.8667
 Site-Clipart                   (4) | Train Loss: 0.4763 | Train Acc: 0.8576
 Site-Clipart                   (4) | Train Loss: 0.4556 | Train Acc: 0.8801
 Site-Real                      (7) | Train Loss: 0.3472 | Train Acc: 0.9127
 Site-Real                      (7) | Train Loss: 0.2481 | Train Acc: 0.9718
 Site-Real                      (7) | Train Loss: 0.2584 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.2959 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.3637 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.4690 | Train Acc: 0.8932
 Site-Painting                  (2) | Train Loss: 0.3672 | Train Acc: 0.9273
 Site-Sketch                    (0) | Train Loss: 0.4491 | Train Acc: 0.8691
 Site-Sketch                    (0) | Train Loss: 0.5083 | Train Acc: 0.8277
 Site-QuickDraw                 (1) | Train Loss: 0.9097 | Train Acc: 0.7248
 Site-Infograph                 (5) | Train Loss: 1.1022 | Train Acc: 0.6496
Average Train Accuracy: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.2952 | Val  Acc: 0.9211
 Site-Clipart                   (6) | Val  Loss: 0.3554 | Val  Acc: 0.9346
 Site-Clipart                   (6) | Val  Loss: 0.4439 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.4811 | Val  Acc: 0.8524
 Site-Clipart                   (4) | Val  Loss: 0.5528 | Val  Acc: 0.8169
 Site-Real                      (7) | Val  Loss: 0.2933 | Val  Acc: 0.9286
 Site-Real                      (7) | Val  Loss: 0.2909 | Val  Acc: 0.9407
 Site-Real                      (7) | Val  Loss: 0.2809 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.2570 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2979 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.4460 | Val  Acc: 0.8832
 Site-Painting                  (2) | Val  Loss: 0.4021 | Val  Acc: 0.9010
 Site-Sketch                    (0) | Val  Loss: 0.4853 | Val  Acc: 0.8740
 Site-Sketch                    (0) | Val  Loss: 0.5204 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 0.9789 | Val  Acc: 0.7248
 Site-Infograph                 (5) | Val  Loss: 1.0580 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8733
============ Train epoch 25 ============
cnt=[2, 1, 2, 2, 1, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (3) | Train Loss: 0.4666 | Train Acc: 0.8870
 Site-Clipart                   (7) | Train Loss: 0.3857 | Train Acc: 0.8944
 Site-Clipart                   (7) | Train Loss: 0.4879 | Train Acc: 0.8756
 Site-Clipart                   (3) | Train Loss: 0.4516 | Train Acc: 0.8797
 Site-Clipart                   (7) | Train Loss: 0.4313 | Train Acc: 0.8937
 Site-Real                      (5) | Train Loss: 0.3760 | Train Acc: 0.8889
 Site-Real                      (5) | Train Loss: 0.2819 | Train Acc: 0.9379
 Site-Real                      (5) | Train Loss: 0.2666 | Train Acc: 0.9355
 Site-Real                      (2) | Train Loss: 0.3043 | Train Acc: 0.9397
 Site-Painting                  (6) | Train Loss: 0.4552 | Train Acc: 0.8776
 Site-Painting                  (6) | Train Loss: 0.4525 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.3973 | Train Acc: 0.8962
 Site-Sketch                    (0) | Train Loss: 0.4843 | Train Acc: 0.8534
 Site-Sketch                    (0) | Train Loss: 0.5384 | Train Acc: 0.8127
 Site-QuickDraw                 (1) | Train Loss: 0.9177 | Train Acc: 0.7339
 Site-Infograph                 (4) | Train Loss: 1.0580 | Train Acc: 0.7009
Average Train Accuracy: 0.8694
 Site-Clipart                   (3) | Val  Loss: 0.2856 | Val  Acc: 0.9342
 Site-Clipart                   (7) | Val  Loss: 0.3616 | Val  Acc: 0.9159
 Site-Clipart                   (7) | Val  Loss: 0.4387 | Val  Acc: 0.8733
 Site-Clipart                   (3) | Val  Loss: 0.4785 | Val  Acc: 0.8476
 Site-Clipart                   (7) | Val  Loss: 0.5048 | Val  Acc: 0.8441
 Site-Real                      (5) | Val  Loss: 0.2776 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.2602 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.2725 | Val  Acc: 0.9273
 Site-Real                      (2) | Val  Loss: 0.2629 | Val  Acc: 0.9567
 Site-Painting                  (6) | Val  Loss: 0.3019 | Val  Acc: 0.9286
 Site-Painting                  (6) | Val  Loss: 0.4060 | Val  Acc: 0.8832
 Site-Painting                  (2) | Val  Loss: 0.3894 | Val  Acc: 0.8906
 Site-Sketch                    (0) | Val  Loss: 0.4684 | Val  Acc: 0.8583
 Site-Sketch                    (0) | Val  Loss: 0.5325 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.8803 | Val  Acc: 0.7615
 Site-Infograph                 (4) | Val  Loss: 1.0344 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8769
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.9342
 Best site-Clipart                  (7)  | Epoch:25 | Val Acc: 0.9159
 Best site-Clipart                  (7)  | Epoch:25 | Val Acc: 0.8733
 Best site-Clipart                  (3)  | Epoch:25 | Val Acc: 0.8476
 Best site-Clipart                  (7)  | Epoch:25 | Val Acc: 0.8441
 Best site-Real                     (5)  | Epoch:25 | Val Acc: 0.9286
 Best site-Real                     (5)  | Epoch:25 | Val Acc: 0.9407
 Best site-Real                     (5)  | Epoch:25 | Val Acc: 0.9273
 Best site-Real                     (2)  | Epoch:25 | Val Acc: 0.9567
 Best site-Painting                 (6)  | Epoch:25 | Val Acc: 0.9286
 Best site-Painting                 (6)  | Epoch:25 | Val Acc: 0.8832
 Best site-Painting                 (2)  | Epoch:25 | Val Acc: 0.8906
 Best site-Sketch                   (0)  | Epoch:25 | Val Acc: 0.8583
 Best site-Sketch                   (0)  | Epoch:25 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:25 | Val Acc: 0.7615
 Best site-Infograph                (4)  | Epoch:25 | Val Acc: 0.6923
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 26 ============
cnt=[1, 1, 4, 3, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (2) | Train Loss: 0.4586 | Train Acc: 0.8870
 Site-Clipart                   (2) | Train Loss: 0.3438 | Train Acc: 0.9006
 Site-Clipart                   (2) | Train Loss: 0.4435 | Train Acc: 0.8978
 Site-Clipart                   (6) | Train Loss: 0.4458 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.4078 | Train Acc: 0.9095
 Site-Real                      (3) | Train Loss: 0.3484 | Train Acc: 0.9127
 Site-Real                      (7) | Train Loss: 0.2244 | Train Acc: 0.9718
 Site-Real                      (3) | Train Loss: 0.2616 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2813 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.4592 | Train Acc: 0.8844
 Site-Painting                  (4) | Train Loss: 0.3476 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.4195 | Train Acc: 0.8858
 Site-Sketch                    (5) | Train Loss: 0.4684 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.5363 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.8618 | Train Acc: 0.7187
 Site-Infograph                 (0) | Train Loss: 1.0423 | Train Acc: 0.6581
Average Train Accuracy: 0.8713
 Site-Clipart                   (2) | Val  Loss: 0.2864 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.3636 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.3957 | Val  Acc: 0.9067
 Site-Clipart                   (6) | Val  Loss: 0.4215 | Val  Acc: 0.8714
 Site-Clipart                   (2) | Val  Loss: 0.5293 | Val  Acc: 0.8441
 Site-Real                      (3) | Val  Loss: 0.2944 | Val  Acc: 0.9286
 Site-Real                      (7) | Val  Loss: 0.2594 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.2589 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.2369 | Val  Acc: 0.9610
 Site-Painting                  (4) | Val  Loss: 0.2827 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.3861 | Val  Acc: 0.8832
 Site-Painting                  (4) | Val  Loss: 0.4091 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4733 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.5157 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.8999 | Val  Acc: 0.7661
 Site-Infograph                 (0) | Val  Loss: 1.0189 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8805
 Best site-Clipart                  (2)  | Epoch:26 | Val Acc: 0.9342
 Best site-Clipart                  (2)  | Epoch:26 | Val Acc: 0.9252
 Best site-Clipart                  (2)  | Epoch:26 | Val Acc: 0.9067
 Best site-Clipart                  (6)  | Epoch:26 | Val Acc: 0.8714
 Best site-Clipart                  (2)  | Epoch:26 | Val Acc: 0.8441
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9286
 Best site-Real                     (7)  | Epoch:26 | Val Acc: 0.9492
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9273
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9610
 Best site-Painting                 (4)  | Epoch:26 | Val Acc: 0.9286
 Best site-Painting                 (4)  | Epoch:26 | Val Acc: 0.8832
 Best site-Painting                 (4)  | Epoch:26 | Val Acc: 0.8854
 Best site-Sketch                   (5)  | Epoch:26 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:26 | Val Acc: 0.8371
 Best site-QuickDraw                (1)  | Epoch:26 | Val Acc: 0.7661
 Best site-Infograph                (0)  | Epoch:26 | Val Acc: 0.7051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 1, 3, 4, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (7) | Train Loss: 0.4624 | Train Acc: 0.9130
 Site-Clipart                   (3) | Train Loss: 0.3317 | Train Acc: 0.9068
 Site-Clipart                   (3) | Train Loss: 0.4835 | Train Acc: 0.8756
 Site-Clipart                   (3) | Train Loss: 0.4501 | Train Acc: 0.8734
 Site-Clipart                   (3) | Train Loss: 0.4149 | Train Acc: 0.9027
 Site-Real                      (2) | Train Loss: 0.3468 | Train Acc: 0.9127
 Site-Real                      (6) | Train Loss: 0.2197 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.2549 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2950 | Train Acc: 0.9425
 Site-Painting                  (5) | Train Loss: 0.3730 | Train Acc: 0.9116
 Site-Painting                  (5) | Train Loss: 0.3719 | Train Acc: 0.9029
 Site-Painting                  (5) | Train Loss: 0.3477 | Train Acc: 0.9066
 Site-Sketch                    (0) | Train Loss: 0.4223 | Train Acc: 0.8639
 Site-Sketch                    (0) | Train Loss: 0.4830 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.8828 | Train Acc: 0.7339
 Site-Infograph                 (4) | Train Loss: 1.0672 | Train Acc: 0.6410
Average Train Accuracy: 0.8770
 Site-Clipart                   (7) | Val  Loss: 0.2971 | Val  Acc: 0.9342
 Site-Clipart                   (3) | Val  Loss: 0.3672 | Val  Acc: 0.9159
 Site-Clipart                   (3) | Val  Loss: 0.4153 | Val  Acc: 0.8933
 Site-Clipart                   (3) | Val  Loss: 0.4003 | Val  Acc: 0.8857
 Site-Clipart                   (3) | Val  Loss: 0.5123 | Val  Acc: 0.8508
 Site-Real                      (2) | Val  Loss: 0.2906 | Val  Acc: 0.9286
 Site-Real                      (6) | Val  Loss: 0.2652 | Val  Acc: 0.9322
 Site-Real                      (2) | Val  Loss: 0.2934 | Val  Acc: 0.9152
 Site-Real                      (2) | Val  Loss: 0.2617 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2990 | Val  Acc: 0.9184
 Site-Painting                  (5) | Val  Loss: 0.3923 | Val  Acc: 0.8759
 Site-Painting                  (5) | Val  Loss: 0.3732 | Val  Acc: 0.8906
 Site-Sketch                    (0) | Val  Loss: 0.5176 | Val  Acc: 0.8504
 Site-Sketch                    (0) | Val  Loss: 0.5828 | Val  Acc: 0.7865
 Site-QuickDraw                 (1) | Val  Loss: 0.8713 | Val  Acc: 0.7523
 Site-Infograph                 (4) | Val  Loss: 1.0149 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8746
============ Train epoch 28 ============
cnt=[3, 1, 3, 4, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (7) | Train Loss: 0.4198 | Train Acc: 0.8957
 Site-Clipart                   (0) | Train Loss: 0.3363 | Train Acc: 0.8882
 Site-Clipart                   (0) | Train Loss: 0.4802 | Train Acc: 0.8711
 Site-Clipart                   (6) | Train Loss: 0.4153 | Train Acc: 0.8797
 Site-Clipart                   (0) | Train Loss: 0.4210 | Train Acc: 0.9005
 Site-Real                      (3) | Train Loss: 0.3505 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2150 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2373 | Train Acc: 0.9556
 Site-Real                      (3) | Train Loss: 0.2962 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.4749 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.3778 | Train Acc: 0.8932
 Site-Painting                  (2) | Train Loss: 0.3864 | Train Acc: 0.8997
 Site-Sketch                    (4) | Train Loss: 0.4771 | Train Acc: 0.8325
 Site-Sketch                    (4) | Train Loss: 0.5127 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.7932 | Train Acc: 0.7523
 Site-Infograph                 (5) | Train Loss: 1.0117 | Train Acc: 0.6624
Average Train Accuracy: 0.8727
 Site-Clipart                   (7) | Val  Loss: 0.3131 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.3457 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.3936 | Val  Acc: 0.9000
 Site-Clipart                   (6) | Val  Loss: 0.4156 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.5249 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.2739 | Val  Acc: 0.9286
 Site-Real                      (3) | Val  Loss: 0.2838 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2485 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2281 | Val  Acc: 0.9654
 Site-Painting                  (2) | Val  Loss: 0.2675 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3380 | Val  Acc: 0.8905
 Site-Painting                  (2) | Val  Loss: 0.4104 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.4569 | Val  Acc: 0.8425
 Site-Sketch                    (4) | Val  Loss: 0.5853 | Val  Acc: 0.7921
 Site-QuickDraw                 (1) | Val  Loss: 0.8960 | Val  Acc: 0.7431
 Site-Infograph                 (5) | Val  Loss: 1.0099 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8737
============ Train epoch 29 ============
cnt=[4, 1, 1, 1, 4, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (2) | Train Loss: 0.4765 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3447 | Train Acc: 0.8882
 Site-Clipart                   (4) | Train Loss: 0.5016 | Train Acc: 0.8489
 Site-Clipart                   (4) | Train Loss: 0.4265 | Train Acc: 0.8766
 Site-Clipart                   (4) | Train Loss: 0.4140 | Train Acc: 0.8982
 Site-Real                      (0) | Train Loss: 0.3363 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2311 | Train Acc: 0.9492
 Site-Real                      (0) | Train Loss: 0.2444 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.2732 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.4490 | Train Acc: 0.8503
 Site-Painting                  (5) | Train Loss: 0.3289 | Train Acc: 0.9078
 Site-Painting                  (5) | Train Loss: 0.3743 | Train Acc: 0.9100
 Site-Sketch                    (6) | Train Loss: 0.4292 | Train Acc: 0.8639
 Site-Sketch                    (7) | Train Loss: 0.5524 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.7444 | Train Acc: 0.7584
 Site-Infograph                 (3) | Train Loss: 1.0513 | Train Acc: 0.6667
Average Train Accuracy: 0.8710
 Site-Clipart                   (2) | Val  Loss: 0.2943 | Val  Acc: 0.9342
 Site-Clipart                   (4) | Val  Loss: 0.3593 | Val  Acc: 0.8972
 Site-Clipart                   (4) | Val  Loss: 0.3626 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.4080 | Val  Acc: 0.8714
 Site-Clipart                   (4) | Val  Loss: 0.5105 | Val  Acc: 0.8475
 Site-Real                      (0) | Val  Loss: 0.2422 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2401 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.2454 | Val  Acc: 0.9273
 Site-Real                      (0) | Val  Loss: 0.2478 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2927 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.3579 | Val  Acc: 0.8978
 Site-Painting                  (5) | Val  Loss: 0.3954 | Val  Acc: 0.8958
 Site-Sketch                    (6) | Val  Loss: 0.4584 | Val  Acc: 0.8268
 Site-Sketch                    (7) | Val  Loss: 0.5523 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 0.8883 | Val  Acc: 0.7798
 Site-Infograph                 (3) | Val  Loss: 1.0400 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8781
============ Train epoch 30 ============
cnt=[2, 1, 5, 2, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (2) | Train Loss: 0.4182 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.3248 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.4883 | Train Acc: 0.8533
 Site-Clipart                   (2) | Train Loss: 0.4114 | Train Acc: 0.8861
 Site-Clipart                   (2) | Train Loss: 0.4051 | Train Acc: 0.9027
 Site-Real                      (7) | Train Loss: 0.3377 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2198 | Train Acc: 0.9718
 Site-Real                      (0) | Train Loss: 0.2346 | Train Acc: 0.9476
 Site-Real                      (7) | Train Loss: 0.2926 | Train Acc: 0.9425
 Site-Painting                  (6) | Train Loss: 0.3806 | Train Acc: 0.9252
 Site-Painting                  (3) | Train Loss: 0.3317 | Train Acc: 0.8786
 Site-Painting                  (3) | Train Loss: 0.3459 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4383 | Train Acc: 0.8796
 Site-Sketch                    (5) | Train Loss: 0.4803 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.8570 | Train Acc: 0.7768
 Site-Infograph                 (4) | Train Loss: 0.9934 | Train Acc: 0.6923
Average Train Accuracy: 0.8814
 Site-Clipart                   (2) | Val  Loss: 0.2825 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.3353 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.3712 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.4173 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.5009 | Val  Acc: 0.8780
 Site-Real                      (7) | Val  Loss: 0.2577 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2546 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2345 | Val  Acc: 0.9333
 Site-Real                      (7) | Val  Loss: 0.2372 | Val  Acc: 0.9610
 Site-Painting                  (6) | Val  Loss: 0.2662 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.3561 | Val  Acc: 0.8905
 Site-Painting                  (3) | Val  Loss: 0.3532 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4323 | Val  Acc: 0.8740
 Site-Sketch                    (5) | Val  Loss: 0.5223 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 0.8308 | Val  Acc: 0.7982
 Site-Infograph                 (4) | Val  Loss: 1.0279 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8867
 Best site-Clipart                  (2)  | Epoch:30 | Val Acc: 0.9342
 Best site-Clipart                  (2)  | Epoch:30 | Val Acc: 0.9252
 Best site-Clipart                  (2)  | Epoch:30 | Val Acc: 0.8933
 Best site-Clipart                  (2)  | Epoch:30 | Val Acc: 0.8857
 Best site-Clipart                  (2)  | Epoch:30 | Val Acc: 0.8780
 Best site-Real                     (7)  | Epoch:30 | Val Acc: 0.9405
 Best site-Real                     (0)  | Epoch:30 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:30 | Val Acc: 0.9333
 Best site-Real                     (7)  | Epoch:30 | Val Acc: 0.9610
 Best site-Painting                 (6)  | Epoch:30 | Val Acc: 0.9490
 Best site-Painting                 (3)  | Epoch:30 | Val Acc: 0.8905
 Best site-Painting                 (3)  | Epoch:30 | Val Acc: 0.9010
 Best site-Sketch                   (5)  | Epoch:30 | Val Acc: 0.8740
 Best site-Sketch                   (5)  | Epoch:30 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:30 | Val Acc: 0.7982
 Best site-Infograph                (4)  | Epoch:30 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 1, 3, 2, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (7) | Train Loss: 0.4117 | Train Acc: 0.9043
 Site-Clipart                   (2) | Train Loss: 0.3336 | Train Acc: 0.9379
 Site-Clipart                   (7) | Train Loss: 0.4731 | Train Acc: 0.8578
 Site-Clipart                   (2) | Train Loss: 0.4257 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.3833 | Train Acc: 0.9208
 Site-Real                      (4) | Train Loss: 0.3324 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.1921 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2094 | Train Acc: 0.9677
 Site-Real                      (4) | Train Loss: 0.2802 | Train Acc: 0.9368
 Site-Painting                  (6) | Train Loss: 0.4411 | Train Acc: 0.8639
 Site-Painting                  (0) | Train Loss: 0.3520 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.3426 | Train Acc: 0.9170
 Site-Sketch                    (3) | Train Loss: 0.4749 | Train Acc: 0.8429
 Site-Sketch                    (3) | Train Loss: 0.5140 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.7768 | Train Acc: 0.7706
 Site-Infograph                 (5) | Train Loss: 0.9887 | Train Acc: 0.6752
Average Train Accuracy: 0.8799
 Site-Clipart                   (7) | Val  Loss: 0.2727 | Val  Acc: 0.9342
 Site-Clipart                   (2) | Val  Loss: 0.3381 | Val  Acc: 0.9159
 Site-Clipart                   (7) | Val  Loss: 0.3458 | Val  Acc: 0.9133
 Site-Clipart                   (2) | Val  Loss: 0.4125 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.4949 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.2615 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2354 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2185 | Val  Acc: 0.9515
 Site-Real                      (4) | Val  Loss: 0.2452 | Val  Acc: 0.9610
 Site-Painting                  (6) | Val  Loss: 0.2583 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.3466 | Val  Acc: 0.8759
 Site-Painting                  (0) | Val  Loss: 0.3655 | Val  Acc: 0.8802
 Site-Sketch                    (3) | Val  Loss: 0.4123 | Val  Acc: 0.8976
 Site-Sketch                    (3) | Val  Loss: 0.5316 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.8382 | Val  Acc: 0.7661
 Site-Infograph                 (5) | Val  Loss: 1.0077 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8837
============ Train epoch 32 ============
cnt=[2, 1, 3, 2, 1, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (2) | Train Loss: 0.4742 | Train Acc: 0.8870
 Site-Clipart                   (6) | Train Loss: 0.3146 | Train Acc: 0.9068
 Site-Clipart                   (6) | Train Loss: 0.4472 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.4072 | Train Acc: 0.8671
 Site-Clipart                   (2) | Train Loss: 0.3999 | Train Acc: 0.9027
 Site-Real                      (0) | Train Loss: 0.3265 | Train Acc: 0.9206
 Site-Real                      (7) | Train Loss: 0.2065 | Train Acc: 0.9605
 Site-Real                      (7) | Train Loss: 0.2309 | Train Acc: 0.9355
 Site-Real                      (0) | Train Loss: 0.2821 | Train Acc: 0.9540
 Site-Painting                  (5) | Train Loss: 0.4509 | Train Acc: 0.8844
 Site-Painting                  (5) | Train Loss: 0.3535 | Train Acc: 0.9029
 Site-Painting                  (5) | Train Loss: 0.3246 | Train Acc: 0.9135
 Site-Sketch                    (3) | Train Loss: 0.4755 | Train Acc: 0.8586
 Site-Sketch                    (3) | Train Loss: 0.4568 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.7824 | Train Acc: 0.7737
 Site-Infograph                 (4) | Train Loss: 1.0130 | Train Acc: 0.6581
Average Train Accuracy: 0.8780
 Site-Clipart                   (2) | Val  Loss: 0.2672 | Val  Acc: 0.9342
 Site-Clipart                   (6) | Val  Loss: 0.3446 | Val  Acc: 0.8972
 Site-Clipart                   (6) | Val  Loss: 0.3651 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.4121 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.4778 | Val  Acc: 0.8644
 Site-Real                      (0) | Val  Loss: 0.2642 | Val  Acc: 0.9405
 Site-Real                      (7) | Val  Loss: 0.2182 | Val  Acc: 0.9492
 Site-Real                      (7) | Val  Loss: 0.2329 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2304 | Val  Acc: 0.9610
 Site-Painting                  (5) | Val  Loss: 0.2536 | Val  Acc: 0.9286
 Site-Painting                  (5) | Val  Loss: 0.3527 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.3588 | Val  Acc: 0.8958
 Site-Sketch                    (3) | Val  Loss: 0.4572 | Val  Acc: 0.8583
 Site-Sketch                    (3) | Val  Loss: 0.5198 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.8305 | Val  Acc: 0.7844
 Site-Infograph                 (4) | Val  Loss: 0.9477 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8858
============ Train epoch 33 ============
cnt=[2, 1, 2, 2, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (3) | Train Loss: 0.4328 | Train Acc: 0.8870
 Site-Clipart                   (6) | Train Loss: 0.3150 | Train Acc: 0.9193
 Site-Clipart                   (6) | Train Loss: 0.4618 | Train Acc: 0.8578
 Site-Clipart                   (3) | Train Loss: 0.4096 | Train Acc: 0.8829
 Site-Clipart                   (6) | Train Loss: 0.4041 | Train Acc: 0.9005
 Site-Real                      (4) | Train Loss: 0.3273 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.1993 | Train Acc: 0.9718
 Site-Real                      (4) | Train Loss: 0.2365 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2693 | Train Acc: 0.9368
 Site-Painting                  (7) | Train Loss: 0.4221 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3580 | Train Acc: 0.8932
 Site-Painting                  (2) | Train Loss: 0.3324 | Train Acc: 0.9239
 Site-Sketch                    (0) | Train Loss: 0.4565 | Train Acc: 0.8377
 Site-Sketch                    (0) | Train Loss: 0.4512 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.8036 | Train Acc: 0.7920
 Site-Infograph                 (5) | Train Loss: 0.9360 | Train Acc: 0.7009
Average Train Accuracy: 0.8817
 Site-Clipart                   (3) | Val  Loss: 0.2660 | Val  Acc: 0.8947
 Site-Clipart                   (6) | Val  Loss: 0.3512 | Val  Acc: 0.8972
 Site-Clipart                   (6) | Val  Loss: 0.3597 | Val  Acc: 0.9000
 Site-Clipart                   (3) | Val  Loss: 0.4276 | Val  Acc: 0.8714
 Site-Clipart                   (6) | Val  Loss: 0.4793 | Val  Acc: 0.8712
 Site-Real                      (4) | Val  Loss: 0.2448 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2689 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.2497 | Val  Acc: 0.9273
 Site-Real                      (4) | Val  Loss: 0.2230 | Val  Acc: 0.9524
 Site-Painting                  (7) | Val  Loss: 0.2501 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.3554 | Val  Acc: 0.8905
 Site-Painting                  (2) | Val  Loss: 0.3204 | Val  Acc: 0.9167
 Site-Sketch                    (0) | Val  Loss: 0.3904 | Val  Acc: 0.8898
 Site-Sketch                    (0) | Val  Loss: 0.5236 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7971 | Val  Acc: 0.7615
 Site-Infograph                 (5) | Val  Loss: 1.0170 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8812
============ Train epoch 34 ============
cnt=[2, 1, 3, 1, 2, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (7) | Train Loss: 0.4568 | Train Acc: 0.8609
 Site-Clipart                   (7) | Train Loss: 0.3492 | Train Acc: 0.9130
 Site-Clipart                   (7) | Train Loss: 0.4338 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.3961 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.3818 | Train Acc: 0.9050
 Site-Real                      (6) | Train Loss: 0.3150 | Train Acc: 0.9127
 Site-Real                      (6) | Train Loss: 0.1841 | Train Acc: 0.9718
 Site-Real                      (4) | Train Loss: 0.2469 | Train Acc: 0.9355
 Site-Real                      (4) | Train Loss: 0.2741 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.4376 | Train Acc: 0.8707
 Site-Painting                  (2) | Train Loss: 0.3151 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.3141 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.3833 | Train Acc: 0.8901
 Site-Sketch                    (5) | Train Loss: 0.4278 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.7766 | Train Acc: 0.7676
 Site-Infograph                 (3) | Train Loss: 0.9719 | Train Acc: 0.6752
Average Train Accuracy: 0.8811
 Site-Clipart                   (7) | Val  Loss: 0.2654 | Val  Acc: 0.9211
 Site-Clipart                   (7) | Val  Loss: 0.3327 | Val  Acc: 0.9252
 Site-Clipart                   (7) | Val  Loss: 0.3610 | Val  Acc: 0.9133
 Site-Clipart                   (0) | Val  Loss: 0.3856 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.4758 | Val  Acc: 0.8644
 Site-Real                      (6) | Val  Loss: 0.2289 | Val  Acc: 0.9405
 Site-Real                      (6) | Val  Loss: 0.2720 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.2620 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2303 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.2123 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.3243 | Val  Acc: 0.8978
 Site-Painting                  (2) | Val  Loss: 0.3357 | Val  Acc: 0.9167
 Site-Sketch                    (5) | Val  Loss: 0.4076 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.4886 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.7713 | Val  Acc: 0.7706
 Site-Infograph                 (3) | Val  Loss: 0.9910 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8900
 Best site-Clipart                  (7)  | Epoch:34 | Val Acc: 0.9211
 Best site-Clipart                  (7)  | Epoch:34 | Val Acc: 0.9252
 Best site-Clipart                  (7)  | Epoch:34 | Val Acc: 0.9133
 Best site-Clipart                  (0)  | Epoch:34 | Val Acc: 0.8714
 Best site-Clipart                  (0)  | Epoch:34 | Val Acc: 0.8644
 Best site-Real                     (6)  | Epoch:34 | Val Acc: 0.9405
 Best site-Real                     (6)  | Epoch:34 | Val Acc: 0.9322
 Best site-Real                     (4)  | Epoch:34 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:34 | Val Acc: 0.9610
 Best site-Painting                 (2)  | Epoch:34 | Val Acc: 0.9592
 Best site-Painting                 (2)  | Epoch:34 | Val Acc: 0.8978
 Best site-Painting                 (2)  | Epoch:34 | Val Acc: 0.9167
 Best site-Sketch                   (5)  | Epoch:34 | Val Acc: 0.8976
 Best site-Sketch                   (5)  | Epoch:34 | Val Acc: 0.8371
 Best site-QuickDraw                (1)  | Epoch:34 | Val Acc: 0.7706
 Best site-Infograph                (3)  | Epoch:34 | Val Acc: 0.6987
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 35 ============
cnt=[3, 1, 2, 1, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (2) | Train Loss: 0.4524 | Train Acc: 0.8957
 Site-Clipart                   (6) | Train Loss: 0.3015 | Train Acc: 0.9193
 Site-Clipart                   (6) | Train Loss: 0.4216 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.4119 | Train Acc: 0.8703
 Site-Clipart                   (6) | Train Loss: 0.3707 | Train Acc: 0.9140
 Site-Real                      (4) | Train Loss: 0.3170 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.1839 | Train Acc: 0.9718
 Site-Real                      (4) | Train Loss: 0.2351 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2669 | Train Acc: 0.9368
 Site-Painting                  (0) | Train Loss: 0.3588 | Train Acc: 0.8776
 Site-Painting                  (0) | Train Loss: 0.3257 | Train Acc: 0.9078
 Site-Painting                  (0) | Train Loss: 0.3356 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.4264 | Train Acc: 0.8848
 Site-Sketch                    (7) | Train Loss: 0.4693 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.7196 | Train Acc: 0.7951
 Site-Infograph                 (3) | Train Loss: 0.9573 | Train Acc: 0.6752
Average Train Accuracy: 0.8852
 Site-Clipart                   (2) | Val  Loss: 0.2552 | Val  Acc: 0.9605
 Site-Clipart                   (6) | Val  Loss: 0.3212 | Val  Acc: 0.9159
 Site-Clipart                   (6) | Val  Loss: 0.3268 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.4444 | Val  Acc: 0.8429
 Site-Clipart                   (6) | Val  Loss: 0.4813 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.2652 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2697 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.2211 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.2201 | Val  Acc: 0.9610
 Site-Painting                  (0) | Val  Loss: 0.2652 | Val  Acc: 0.9286
 Site-Painting                  (0) | Val  Loss: 0.3017 | Val  Acc: 0.9051
 Site-Painting                  (0) | Val  Loss: 0.3258 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.4452 | Val  Acc: 0.8504
 Site-Sketch                    (7) | Val  Loss: 0.5404 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.7849 | Val  Acc: 0.7982
 Site-Infograph                 (3) | Val  Loss: 0.9557 | Val  Acc: 0.7372
Average Valid Accuracy: 0.8863
============ Train epoch 36 ============
cnt=[1, 1, 4, 1, 3, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (0) | Train Loss: 0.4438 | Train Acc: 0.8783
 Site-Clipart                   (5) | Train Loss: 0.2934 | Train Acc: 0.9006
 Site-Clipart                   (5) | Train Loss: 0.4310 | Train Acc: 0.8844
 Site-Clipart                   (5) | Train Loss: 0.3954 | Train Acc: 0.8766
 Site-Clipart                   (7) | Train Loss: 0.3724 | Train Acc: 0.9050
 Site-Real                      (2) | Train Loss: 0.3090 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.1927 | Train Acc: 0.9718
 Site-Real                      (2) | Train Loss: 0.2344 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2550 | Train Acc: 0.9483
 Site-Painting                  (4) | Train Loss: 0.3266 | Train Acc: 0.8707
 Site-Painting                  (4) | Train Loss: 0.3509 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.3523 | Train Acc: 0.9170
 Site-Sketch                    (6) | Train Loss: 0.4596 | Train Acc: 0.8691
 Site-Sketch                    (6) | Train Loss: 0.4527 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.6594 | Train Acc: 0.7920
 Site-Infograph                 (3) | Train Loss: 0.8982 | Train Acc: 0.7009
Average Train Accuracy: 0.8825
 Site-Clipart                   (0) | Val  Loss: 0.2211 | Val  Acc: 0.9342
 Site-Clipart                   (5) | Val  Loss: 0.3272 | Val  Acc: 0.9439
 Site-Clipart                   (5) | Val  Loss: 0.3322 | Val  Acc: 0.9133
 Site-Clipart                   (5) | Val  Loss: 0.3722 | Val  Acc: 0.8905
 Site-Clipart                   (7) | Val  Loss: 0.4446 | Val  Acc: 0.8678
 Site-Real                      (2) | Val  Loss: 0.2496 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.2118 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2690 | Val  Acc: 0.9212
 Site-Real                      (2) | Val  Loss: 0.2068 | Val  Acc: 0.9610
 Site-Painting                  (4) | Val  Loss: 0.2409 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.3184 | Val  Acc: 0.9270
 Site-Painting                  (4) | Val  Loss: 0.3424 | Val  Acc: 0.9010
 Site-Sketch                    (6) | Val  Loss: 0.4228 | Val  Acc: 0.8819
 Site-Sketch                    (6) | Val  Loss: 0.5108 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7761 | Val  Acc: 0.7890
 Site-Infograph                 (3) | Val  Loss: 0.9941 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8919
 Best site-Clipart                  (0)  | Epoch:36 | Val Acc: 0.9342
 Best site-Clipart                  (5)  | Epoch:36 | Val Acc: 0.9439
 Best site-Clipart                  (5)  | Epoch:36 | Val Acc: 0.9133
 Best site-Clipart                  (5)  | Epoch:36 | Val Acc: 0.8905
 Best site-Clipart                  (7)  | Epoch:36 | Val Acc: 0.8678
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9212
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9610
 Best site-Painting                 (4)  | Epoch:36 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:36 | Val Acc: 0.9270
 Best site-Painting                 (4)  | Epoch:36 | Val Acc: 0.9010
 Best site-Sketch                   (6)  | Epoch:36 | Val Acc: 0.8819
 Best site-Sketch                   (6)  | Epoch:36 | Val Acc: 0.8315
 Best site-QuickDraw                (1)  | Epoch:36 | Val Acc: 0.7890
 Best site-Infograph                (3)  | Epoch:36 | Val Acc: 0.7308
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 1, 3, 3, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (3) | Train Loss: 0.4824 | Train Acc: 0.8435
 Site-Clipart                   (3) | Train Loss: 0.2524 | Train Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.4042 | Train Acc: 0.8844
 Site-Clipart                   (3) | Train Loss: 0.3662 | Train Acc: 0.8892
 Site-Clipart                   (0) | Train Loss: 0.3667 | Train Acc: 0.9027
 Site-Real                      (5) | Train Loss: 0.3444 | Train Acc: 0.9127
 Site-Real                      (5) | Train Loss: 0.1716 | Train Acc: 0.9718
 Site-Real                      (5) | Train Loss: 0.2190 | Train Acc: 0.9516
 Site-Real                      (7) | Train Loss: 0.2382 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.3351 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.3182 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.3226 | Train Acc: 0.9204
 Site-Sketch                    (6) | Train Loss: 0.4130 | Train Acc: 0.8691
 Site-Sketch                    (6) | Train Loss: 0.4671 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.7373 | Train Acc: 0.7859
 Site-Infograph                 (4) | Train Loss: 0.9552 | Train Acc: 0.6966
Average Train Accuracy: 0.8835
 Site-Clipart                   (3) | Val  Loss: 0.2439 | Val  Acc: 0.9342
 Site-Clipart                   (3) | Val  Loss: 0.2965 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.3633 | Val  Acc: 0.8800
 Site-Clipart                   (3) | Val  Loss: 0.3830 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.4714 | Val  Acc: 0.8780
 Site-Real                      (5) | Val  Loss: 0.2232 | Val  Acc: 0.9405
 Site-Real                      (5) | Val  Loss: 0.2169 | Val  Acc: 0.9322
 Site-Real                      (5) | Val  Loss: 0.2266 | Val  Acc: 0.9394
 Site-Real                      (7) | Val  Loss: 0.2112 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.1980 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.3201 | Val  Acc: 0.8978
 Site-Painting                  (2) | Val  Loss: 0.3717 | Val  Acc: 0.8906
 Site-Sketch                    (6) | Val  Loss: 0.4127 | Val  Acc: 0.8504
 Site-Sketch                    (6) | Val  Loss: 0.4870 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7957 | Val  Acc: 0.7844
 Site-Infograph                 (4) | Val  Loss: 0.9674 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8872
============ Train epoch 38 ============
cnt=[2, 1, 3, 1, 4, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (2) | Train Loss: 0.4053 | Train Acc: 0.8870
 Site-Clipart                   (7) | Train Loss: 0.2883 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.4059 | Train Acc: 0.8800
 Site-Clipart                   (7) | Train Loss: 0.3554 | Train Acc: 0.8924
 Site-Clipart                   (2) | Train Loss: 0.3691 | Train Acc: 0.9027
 Site-Real                      (4) | Train Loss: 0.3128 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.1959 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.2160 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.2937 | Train Acc: 0.9397
 Site-Painting                  (6) | Train Loss: 0.4199 | Train Acc: 0.8844
 Site-Painting                  (0) | Train Loss: 0.3296 | Train Acc: 0.8883
 Site-Painting                  (0) | Train Loss: 0.3395 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.4421 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.4465 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.7112 | Train Acc: 0.8043
 Site-Infograph                 (3) | Train Loss: 0.8896 | Train Acc: 0.7350
Average Train Accuracy: 0.8850
 Site-Clipart                   (2) | Val  Loss: 0.2144 | Val  Acc: 0.9342
 Site-Clipart                   (7) | Val  Loss: 0.3063 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.3867 | Val  Acc: 0.9000
 Site-Clipart                   (7) | Val  Loss: 0.3888 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.4588 | Val  Acc: 0.8610
 Site-Real                      (4) | Val  Loss: 0.2194 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2336 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2162 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2099 | Val  Acc: 0.9524
 Site-Painting                  (6) | Val  Loss: 0.2486 | Val  Acc: 0.9490
 Site-Painting                  (0) | Val  Loss: 0.3396 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3515 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.3671 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4956 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.7991 | Val  Acc: 0.7431
 Site-Infograph                 (3) | Val  Loss: 0.9630 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8872
============ Train epoch 39 ============
cnt=[3, 1, 3, 1, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (0) | Train Loss: 0.3647 | Train Acc: 0.9043
 Site-Clipart                   (0) | Train Loss: 0.2870 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.4187 | Train Acc: 0.8756
 Site-Clipart                   (7) | Train Loss: 0.3786 | Train Acc: 0.8734
 Site-Clipart                   (7) | Train Loss: 0.3564 | Train Acc: 0.9095
 Site-Real                      (4) | Train Loss: 0.3111 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.1703 | Train Acc: 0.9718
 Site-Real                      (4) | Train Loss: 0.2131 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2518 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.3219 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.3396 | Train Acc: 0.8932
 Site-Painting                  (2) | Train Loss: 0.3327 | Train Acc: 0.9031
 Site-Sketch                    (5) | Train Loss: 0.4027 | Train Acc: 0.8901
 Site-Sketch                    (6) | Train Loss: 0.3647 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.6883 | Train Acc: 0.7920
 Site-Infograph                 (3) | Train Loss: 0.8931 | Train Acc: 0.7393
Average Train Accuracy: 0.8905
 Site-Clipart                   (0) | Val  Loss: 0.2822 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3159 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.3045 | Val  Acc: 0.9200
 Site-Clipart                   (7) | Val  Loss: 0.3856 | Val  Acc: 0.8857
 Site-Clipart                   (7) | Val  Loss: 0.4286 | Val  Acc: 0.8644
 Site-Real                      (4) | Val  Loss: 0.2324 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2150 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.2403 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2133 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.2296 | Val  Acc: 0.9592
 Site-Painting                  (2) | Val  Loss: 0.3111 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.3381 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.3919 | Val  Acc: 0.8661
 Site-Sketch                    (6) | Val  Loss: 0.4487 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7571 | Val  Acc: 0.7844
 Site-Infograph                 (3) | Val  Loss: 0.9502 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8917
============ Train epoch 40 ============
cnt=[1, 1, 1, 4, 2, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (6) | Train Loss: 0.4150 | Train Acc: 0.8870
 Site-Clipart                   (7) | Train Loss: 0.2754 | Train Acc: 0.9255
 Site-Clipart                   (7) | Train Loss: 0.4275 | Train Acc: 0.8578
 Site-Clipart                   (2) | Train Loss: 0.4024 | Train Acc: 0.8671
 Site-Clipart                   (6) | Train Loss: 0.3301 | Train Acc: 0.9186
 Site-Real                      (3) | Train Loss: 0.2965 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.1911 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2195 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.2665 | Train Acc: 0.9511
 Site-Painting                  (5) | Train Loss: 0.3798 | Train Acc: 0.9252
 Site-Painting                  (5) | Train Loss: 0.3463 | Train Acc: 0.8883
 Site-Painting                  (5) | Train Loss: 0.3230 | Train Acc: 0.9204
 Site-Sketch                    (4) | Train Loss: 0.4338 | Train Acc: 0.8796
 Site-Sketch                    (4) | Train Loss: 0.3923 | Train Acc: 0.8577
 Site-QuickDraw                 (1) | Train Loss: 0.6655 | Train Acc: 0.8257
 Site-Infograph                 (0) | Train Loss: 0.8898 | Train Acc: 0.6923
Average Train Accuracy: 0.8893
 Site-Clipart                   (6) | Val  Loss: 0.2334 | Val  Acc: 0.9474
 Site-Clipart                   (7) | Val  Loss: 0.2572 | Val  Acc: 0.9439
 Site-Clipart                   (7) | Val  Loss: 0.3437 | Val  Acc: 0.9067
 Site-Clipart                   (2) | Val  Loss: 0.3660 | Val  Acc: 0.8714
 Site-Clipart                   (6) | Val  Loss: 0.4637 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2339 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2153 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2067 | Val  Acc: 0.9515
 Site-Real                      (3) | Val  Loss: 0.2198 | Val  Acc: 0.9481
 Site-Painting                  (5) | Val  Loss: 0.1850 | Val  Acc: 0.9592
 Site-Painting                  (5) | Val  Loss: 0.2856 | Val  Acc: 0.9051
 Site-Painting                  (5) | Val  Loss: 0.3489 | Val  Acc: 0.9010
 Site-Sketch                    (4) | Val  Loss: 0.3692 | Val  Acc: 0.9213
 Site-Sketch                    (4) | Val  Loss: 0.4730 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.7716 | Val  Acc: 0.7752
 Site-Infograph                 (0) | Val  Loss: 0.9481 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8954
 Best site-Clipart                  (6)  | Epoch:40 | Val Acc: 0.9474
 Best site-Clipart                  (7)  | Epoch:40 | Val Acc: 0.9439
 Best site-Clipart                  (7)  | Epoch:40 | Val Acc: 0.9067
 Best site-Clipart                  (2)  | Epoch:40 | Val Acc: 0.8714
 Best site-Clipart                  (6)  | Epoch:40 | Val Acc: 0.8610
 Best site-Real                     (3)  | Epoch:40 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:40 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:40 | Val Acc: 0.9515
 Best site-Real                     (3)  | Epoch:40 | Val Acc: 0.9481
 Best site-Painting                 (5)  | Epoch:40 | Val Acc: 0.9592
 Best site-Painting                 (5)  | Epoch:40 | Val Acc: 0.9051
 Best site-Painting                 (5)  | Epoch:40 | Val Acc: 0.9010
 Best site-Sketch                   (4)  | Epoch:40 | Val Acc: 0.9213
 Best site-Sketch                   (4)  | Epoch:40 | Val Acc: 0.8483
 Best site-QuickDraw                (1)  | Epoch:40 | Val Acc: 0.7752
 Best site-Infograph                (0)  | Epoch:40 | Val Acc: 0.7051
 Test site-Clipart                   (6)| Epoch:40 | Test Acc: 0.9030
 Test site-Real                      (3)| Epoch:40 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:40 | Test Acc: 0.9257
 Test site-Sketch                    (4)| Epoch:40 | Test Acc: 0.8736
 Test site-QuickDraw                 (1)| Epoch:40 | Test Acc: 0.7620
 Test site-Infograph                 (0)| Epoch:40 | Test Acc: 0.5875
Clipart: 0.9030, Real: 0.9441, Painting: 0.9257, Sketch: 0.8736, QuickDraw: 0.7620, Infograph: 0.5875, 
Average Test Accuracy(group): 0.8327, Average Test Accuracy(individual): 0.8853,
domain std=0.1244, cluster std=0.1119, individual std=0.0882, 
Average Test Accuracy: 0.8327
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 1, 3, 1, 4, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (6) | Train Loss: 0.3895 | Train Acc: 0.9217
 Site-Clipart                   (6) | Train Loss: 0.2971 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.4351 | Train Acc: 0.8667
 Site-Clipart                   (2) | Train Loss: 0.3660 | Train Acc: 0.8924
 Site-Clipart                   (2) | Train Loss: 0.3505 | Train Acc: 0.8937
 Site-Real                      (4) | Train Loss: 0.3081 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.1847 | Train Acc: 0.9605
 Site-Real                      (4) | Train Loss: 0.2216 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2296 | Train Acc: 0.9425
 Site-Painting                  (7) | Train Loss: 0.3642 | Train Acc: 0.8776
 Site-Painting                  (0) | Train Loss: 0.3435 | Train Acc: 0.8835
 Site-Painting                  (0) | Train Loss: 0.3070 | Train Acc: 0.9170
 Site-Sketch                    (5) | Train Loss: 0.3853 | Train Acc: 0.8848
 Site-Sketch                    (5) | Train Loss: 0.4016 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.6676 | Train Acc: 0.7982
 Site-Infograph                 (3) | Train Loss: 0.9152 | Train Acc: 0.7051
Average Train Accuracy: 0.8844
 Site-Clipart                   (6) | Val  Loss: 0.2276 | Val  Acc: 0.9079
 Site-Clipart                   (6) | Val  Loss: 0.2736 | Val  Acc: 0.9346
 Site-Clipart                   (2) | Val  Loss: 0.3465 | Val  Acc: 0.9067
 Site-Clipart                   (2) | Val  Loss: 0.3610 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.4670 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.2310 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2163 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.2254 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2023 | Val  Acc: 0.9481
 Site-Painting                  (7) | Val  Loss: 0.1934 | Val  Acc: 0.9694
 Site-Painting                  (0) | Val  Loss: 0.2664 | Val  Acc: 0.9051
 Site-Painting                  (0) | Val  Loss: 0.3547 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.3338 | Val  Acc: 0.9134
 Site-Sketch                    (5) | Val  Loss: 0.4624 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.7407 | Val  Acc: 0.7890
 Site-Infograph                 (3) | Val  Loss: 0.9778 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8903
 Test site-Clipart                   (6)| Epoch:40 | Test Acc: 0.8992
 Test site-Real                      (4)| Epoch:40 | Test Acc: 0.9425
 Test site-Painting                  (7)| Epoch:40 | Test Acc: 0.9289
 Test site-Sketch                    (5)| Epoch:40 | Test Acc: 0.8773
 Test site-QuickDraw                 (1)| Epoch:40 | Test Acc: 0.7640
 Test site-Infograph                 (3)| Epoch:40 | Test Acc: 0.5967
Clipart: 0.8992, Real: 0.9425, Painting: 0.9289, Sketch: 0.8773, QuickDraw: 0.7640, Infograph: 0.5967, 
Average Test Accuracy(group): 0.8348, Average Test Accuracy(individual): 0.8855,
domain std=0.1212, cluster std=0.1107, individual std=0.0858, 
Average Test Accuracy: 0.8348
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 42 ============
cnt=[3, 1, 3, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (7) | Train Loss: 0.3986 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.2874 | Train Acc: 0.9317
 Site-Clipart                   (0) | Train Loss: 0.4182 | Train Acc: 0.8933
 Site-Clipart                   (6) | Train Loss: 0.3745 | Train Acc: 0.8861
 Site-Clipart                   (0) | Train Loss: 0.3209 | Train Acc: 0.9140
 Site-Real                      (4) | Train Loss: 0.3137 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.1921 | Train Acc: 0.9718
 Site-Real                      (4) | Train Loss: 0.2091 | Train Acc: 0.9395
 Site-Real                      (4) | Train Loss: 0.2591 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.3367 | Train Acc: 0.9116
 Site-Painting                  (2) | Train Loss: 0.3616 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.3206 | Train Acc: 0.9135
 Site-Sketch                    (5) | Train Loss: 0.3669 | Train Acc: 0.8848
 Site-Sketch                    (5) | Train Loss: 0.4581 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.6615 | Train Acc: 0.8043
 Site-Infograph                 (3) | Train Loss: 0.8479 | Train Acc: 0.7308
Average Train Accuracy: 0.8904
 Site-Clipart                   (7) | Val  Loss: 0.2298 | Val  Acc: 0.9342
 Site-Clipart                   (0) | Val  Loss: 0.3103 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.3448 | Val  Acc: 0.9000
 Site-Clipart                   (6) | Val  Loss: 0.3804 | Val  Acc: 0.8619
 Site-Clipart                   (0) | Val  Loss: 0.4295 | Val  Acc: 0.8610
 Site-Real                      (4) | Val  Loss: 0.2213 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2462 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.1914 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.2166 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.1947 | Val  Acc: 0.9388
 Site-Painting                  (2) | Val  Loss: 0.3099 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.3374 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.4372 | Val  Acc: 0.8268
 Site-Sketch                    (5) | Val  Loss: 0.4674 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.7467 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 0.9539 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8856
 Test site-Clipart                   (7)| Epoch:41 | Test Acc: 0.9030
 Test site-Real                      (4)| Epoch:41 | Test Acc: 0.9408
 Test site-Painting                  (2)| Epoch:41 | Test Acc: 0.9273
 Test site-Sketch                    (5)| Epoch:41 | Test Acc: 0.8755
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7640
 Test site-Infograph                 (3)| Epoch:41 | Test Acc: 0.5967
Clipart: 0.9030, Real: 0.9408, Painting: 0.9273, Sketch: 0.8755, QuickDraw: 0.7640, Infograph: 0.5967, 
Average Test Accuracy(group): 0.8345, Average Test Accuracy(individual): 0.8858,
domain std=0.1210, cluster std=0.1089, individual std=0.0857, 
Average Test Accuracy: 0.8345
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 1, 4, 1, 3, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (0) | Train Loss: 0.4018 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.2393 | Train Acc: 0.9317
 Site-Clipart                   (7) | Train Loss: 0.3767 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.3771 | Train Acc: 0.8892
 Site-Clipart                   (4) | Train Loss: 0.3470 | Train Acc: 0.9186
 Site-Real                      (2) | Train Loss: 0.3059 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.1731 | Train Acc: 0.9718
 Site-Real                      (2) | Train Loss: 0.2103 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2612 | Train Acc: 0.9454
 Site-Painting                  (5) | Train Loss: 0.3034 | Train Acc: 0.9184
 Site-Painting                  (5) | Train Loss: 0.3754 | Train Acc: 0.9126
 Site-Painting                  (5) | Train Loss: 0.2717 | Train Acc: 0.9273
 Site-Sketch                    (6) | Train Loss: 0.4151 | Train Acc: 0.8586
 Site-Sketch                    (6) | Train Loss: 0.3648 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.7540 | Train Acc: 0.8043
 Site-Infograph                 (3) | Train Loss: 0.8648 | Train Acc: 0.7094
Average Train Accuracy: 0.8914
 Site-Clipart                   (0) | Val  Loss: 0.2205 | Val  Acc: 0.9474
 Site-Clipart                   (4) | Val  Loss: 0.2770 | Val  Acc: 0.9252
 Site-Clipart                   (7) | Val  Loss: 0.3219 | Val  Acc: 0.9000
 Site-Clipart                   (4) | Val  Loss: 0.3707 | Val  Acc: 0.8714
 Site-Clipart                   (4) | Val  Loss: 0.4430 | Val  Acc: 0.8576
 Site-Real                      (2) | Val  Loss: 0.2203 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2237 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2148 | Val  Acc: 0.9394
 Site-Real                      (2) | Val  Loss: 0.2136 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2705 | Val  Acc: 0.9184
 Site-Painting                  (5) | Val  Loss: 0.2704 | Val  Acc: 0.9124
 Site-Painting                  (5) | Val  Loss: 0.3189 | Val  Acc: 0.9010
 Site-Sketch                    (6) | Val  Loss: 0.3957 | Val  Acc: 0.8819
 Site-Sketch                    (6) | Val  Loss: 0.4703 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.7506 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 0.9014 | Val  Acc: 0.7372
Average Valid Accuracy: 0.8921
 Test site-Clipart                   (0)| Epoch:42 | Test Acc: 0.9049
 Test site-Real                      (2)| Epoch:42 | Test Acc: 0.9417
 Test site-Painting                  (5)| Epoch:42 | Test Acc: 0.9273
 Test site-Sketch                    (6)| Epoch:42 | Test Acc: 0.8700
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7630
 Test site-Infograph                 (3)| Epoch:42 | Test Acc: 0.6012
Clipart: 0.9049, Real: 0.9417, Painting: 0.9273, Sketch: 0.8700, QuickDraw: 0.7630, Infograph: 0.6012, 
Average Test Accuracy(group): 0.8347, Average Test Accuracy(individual): 0.8861,
domain std=0.1196, cluster std=0.1080, individual std=0.0852, 
Average Test Accuracy: 0.8347
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 44 ============
cnt=[4, 1, 4, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (7) | Train Loss: 0.3918 | Train Acc: 0.9130
 Site-Clipart                   (0) | Train Loss: 0.2716 | Train Acc: 0.9441
 Site-Clipart                   (0) | Train Loss: 0.4137 | Train Acc: 0.8622
 Site-Clipart                   (0) | Train Loss: 0.3453 | Train Acc: 0.8956
 Site-Clipart                   (0) | Train Loss: 0.3352 | Train Acc: 0.9140
 Site-Real                      (2) | Train Loss: 0.3029 | Train Acc: 0.9048
 Site-Real                      (2) | Train Loss: 0.1674 | Train Acc: 0.9548
 Site-Real                      (2) | Train Loss: 0.2086 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.2567 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.4247 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.3475 | Train Acc: 0.8932
 Site-Painting                  (4) | Train Loss: 0.2943 | Train Acc: 0.9273
 Site-Sketch                    (6) | Train Loss: 0.3543 | Train Acc: 0.8848
 Site-Sketch                    (5) | Train Loss: 0.4337 | Train Acc: 0.8839
 Site-QuickDraw                 (1) | Train Loss: 0.6751 | Train Acc: 0.8165
 Site-Infograph                 (3) | Train Loss: 0.8753 | Train Acc: 0.7094
Average Train Accuracy: 0.8932
 Site-Clipart                   (7) | Val  Loss: 0.2026 | Val  Acc: 0.9605
 Site-Clipart                   (0) | Val  Loss: 0.2651 | Val  Acc: 0.9533
 Site-Clipart                   (0) | Val  Loss: 0.3069 | Val  Acc: 0.9400
 Site-Clipart                   (0) | Val  Loss: 0.3319 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.4471 | Val  Acc: 0.8746
 Site-Real                      (2) | Val  Loss: 0.2251 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2489 | Val  Acc: 0.9237
 Site-Real                      (2) | Val  Loss: 0.2059 | Val  Acc: 0.9394
 Site-Real                      (2) | Val  Loss: 0.1883 | Val  Acc: 0.9567
 Site-Painting                  (4) | Val  Loss: 0.2198 | Val  Acc: 0.9184
 Site-Painting                  (4) | Val  Loss: 0.2617 | Val  Acc: 0.9197
 Site-Painting                  (4) | Val  Loss: 0.2984 | Val  Acc: 0.9167
 Site-Sketch                    (6) | Val  Loss: 0.3898 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4478 | Val  Acc: 0.8315
 Site-QuickDraw                 (1) | Val  Loss: 0.6933 | Val  Acc: 0.7982
 Site-Infograph                 (3) | Val  Loss: 0.9040 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9011
 Best site-Clipart                  (7)  | Epoch:44 | Val Acc: 0.9605
 Best site-Clipart                  (0)  | Epoch:44 | Val Acc: 0.9533
 Best site-Clipart                  (0)  | Epoch:44 | Val Acc: 0.9400
 Best site-Clipart                  (0)  | Epoch:44 | Val Acc: 0.9000
 Best site-Clipart                  (0)  | Epoch:44 | Val Acc: 0.8746
 Best site-Real                     (2)  | Epoch:44 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:44 | Val Acc: 0.9237
 Best site-Real                     (2)  | Epoch:44 | Val Acc: 0.9394
 Best site-Real                     (2)  | Epoch:44 | Val Acc: 0.9567
 Best site-Painting                 (4)  | Epoch:44 | Val Acc: 0.9184
 Best site-Painting                 (4)  | Epoch:44 | Val Acc: 0.9197
 Best site-Painting                 (4)  | Epoch:44 | Val Acc: 0.9167
 Best site-Sketch                   (6)  | Epoch:44 | Val Acc: 0.8898
 Best site-Sketch                   (5)  | Epoch:44 | Val Acc: 0.8315
 Best site-QuickDraw                (1)  | Epoch:44 | Val Acc: 0.7982
 Best site-Infograph                (3)  | Epoch:44 | Val Acc: 0.7436
 Test site-Clipart                   (7)| Epoch:44 | Test Acc: 0.8992
 Test site-Real                      (2)| Epoch:44 | Test Acc: 0.9441
 Test site-Painting                  (4)| Epoch:44 | Test Acc: 0.9273
 Test site-Sketch                    (6)| Epoch:44 | Test Acc: 0.8628
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.7660
 Test site-Infograph                 (3)| Epoch:44 | Test Acc: 0.5951
Clipart: 0.8992, Real: 0.9441, Painting: 0.9273, Sketch: 0.8628, QuickDraw: 0.7660, Infograph: 0.5951, 
Average Test Accuracy(group): 0.8324, Average Test Accuracy(individual): 0.8838,
domain std=0.1208, cluster std=0.1071, individual std=0.0864, 
Average Test Accuracy: 0.8324
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 45 ============
cnt=[3, 1, 4, 1, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (0) | Train Loss: 0.3349 | Train Acc: 0.9130
 Site-Clipart                   (7) | Train Loss: 0.2620 | Train Acc: 0.9379
 Site-Clipart                   (0) | Train Loss: 0.3816 | Train Acc: 0.8800
 Site-Clipart                   (7) | Train Loss: 0.3570 | Train Acc: 0.8924
 Site-Clipart                   (0) | Train Loss: 0.3330 | Train Acc: 0.9208
 Site-Real                      (2) | Train Loss: 0.3073 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.1504 | Train Acc: 0.9718
 Site-Real                      (2) | Train Loss: 0.2064 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2194 | Train Acc: 0.9425
 Site-Painting                  (6) | Train Loss: 0.3466 | Train Acc: 0.8912
 Site-Painting                  (4) | Train Loss: 0.3499 | Train Acc: 0.9126
 Site-Painting                  (4) | Train Loss: 0.2915 | Train Acc: 0.9273
 Site-Sketch                    (5) | Train Loss: 0.4129 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.4477 | Train Acc: 0.8764
 Site-QuickDraw                 (1) | Train Loss: 0.7051 | Train Acc: 0.8043
 Site-Infograph                 (3) | Train Loss: 0.8423 | Train Acc: 0.7308
Average Train Accuracy: 0.8956
 Site-Clipart                   (0) | Val  Loss: 0.2147 | Val  Acc: 0.9474
 Site-Clipart                   (7) | Val  Loss: 0.2990 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3213 | Val  Acc: 0.8933
 Site-Clipart                   (7) | Val  Loss: 0.3318 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.4292 | Val  Acc: 0.8780
 Site-Real                      (2) | Val  Loss: 0.2170 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2098 | Val  Acc: 0.9492
 Site-Real                      (2) | Val  Loss: 0.1911 | Val  Acc: 0.9515
 Site-Real                      (2) | Val  Loss: 0.2037 | Val  Acc: 0.9610
 Site-Painting                  (6) | Val  Loss: 0.2286 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.2387 | Val  Acc: 0.9343
 Site-Painting                  (4) | Val  Loss: 0.2943 | Val  Acc: 0.9219
 Site-Sketch                    (5) | Val  Loss: 0.4012 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.4550 | Val  Acc: 0.8427
 Site-QuickDraw                 (1) | Val  Loss: 0.7256 | Val  Acc: 0.8028
 Site-Infograph                 (3) | Val  Loss: 0.9485 | Val  Acc: 0.7372
Average Valid Accuracy: 0.8985
 Test site-Clipart                   (0)| Epoch:44 | Test Acc: 0.9011
 Test site-Real                      (2)| Epoch:44 | Test Acc: 0.9408
 Test site-Painting                  (6)| Epoch:44 | Test Acc: 0.9289
 Test site-Sketch                    (5)| Epoch:44 | Test Acc: 0.8682
 Test site-QuickDraw                 (1)| Epoch:44 | Test Acc: 0.7590
 Test site-Infograph                 (3)| Epoch:44 | Test Acc: 0.5936
Clipart: 0.9011, Real: 0.9408, Painting: 0.9289, Sketch: 0.8682, QuickDraw: 0.7590, Infograph: 0.5936, 
Average Test Accuracy(group): 0.8320, Average Test Accuracy(individual): 0.8841,
domain std=0.1221, cluster std=0.1119, individual std=0.0869, 
Average Test Accuracy: 0.8320
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 46 ============
cnt=[3, 1, 2, 1, 4, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (6) | Train Loss: 0.3525 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.2572 | Train Acc: 0.9441
 Site-Clipart                   (2) | Train Loss: 0.3804 | Train Acc: 0.8978
 Site-Clipart                   (7) | Train Loss: 0.3496 | Train Acc: 0.8829
 Site-Clipart                   (6) | Train Loss: 0.3279 | Train Acc: 0.9276
 Site-Real                      (4) | Train Loss: 0.2980 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.1779 | Train Acc: 0.9605
 Site-Real                      (4) | Train Loss: 0.2004 | Train Acc: 0.9556
 Site-Real                      (4) | Train Loss: 0.2444 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.2848 | Train Acc: 0.9320
 Site-Painting                  (0) | Train Loss: 0.2669 | Train Acc: 0.9078
 Site-Painting                  (0) | Train Loss: 0.3042 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.3800 | Train Acc: 0.8639
 Site-Sketch                    (5) | Train Loss: 0.4177 | Train Acc: 0.8689
 Site-QuickDraw                 (1) | Train Loss: 0.5705 | Train Acc: 0.8073
 Site-Infograph                 (3) | Train Loss: 0.8004 | Train Acc: 0.7692
Average Train Accuracy: 0.8978
 Site-Clipart                   (6) | Val  Loss: 0.2104 | Val  Acc: 0.9605
 Site-Clipart                   (2) | Val  Loss: 0.2758 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.2968 | Val  Acc: 0.9133
 Site-Clipart                   (7) | Val  Loss: 0.3443 | Val  Acc: 0.9000
 Site-Clipart                   (6) | Val  Loss: 0.4236 | Val  Acc: 0.8644
 Site-Real                      (4) | Val  Loss: 0.2148 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2048 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2176 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.1829 | Val  Acc: 0.9610
 Site-Painting                  (0) | Val  Loss: 0.2137 | Val  Acc: 0.9490
 Site-Painting                  (0) | Val  Loss: 0.2823 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3340 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.3708 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4630 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.7327 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 0.8828 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9006
 Test site-Clipart                   (6)| Epoch:45 | Test Acc: 0.9030
 Test site-Real                      (4)| Epoch:45 | Test Acc: 0.9441
 Test site-Painting                  (0)| Epoch:45 | Test Acc: 0.9289
 Test site-Sketch                    (5)| Epoch:45 | Test Acc: 0.8700
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7590
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5814
Clipart: 0.9030, Real: 0.9441, Painting: 0.9289, Sketch: 0.8700, QuickDraw: 0.7590, Infograph: 0.5814, 
Average Test Accuracy(group): 0.8311, Average Test Accuracy(individual): 0.8849,
domain std=0.1269, cluster std=0.1142, individual std=0.0901, 
Average Test Accuracy: 0.8311
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 1, 1, 1, 2, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (7) | Train Loss: 0.4183 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.2434 | Train Acc: 0.9441
 Site-Clipart                   (7) | Train Loss: 0.3853 | Train Acc: 0.8933
 Site-Clipart                   (0) | Train Loss: 0.3526 | Train Acc: 0.8924
 Site-Clipart                   (7) | Train Loss: 0.3096 | Train Acc: 0.9186
 Site-Real                      (5) | Train Loss: 0.2912 | Train Acc: 0.9127
 Site-Real                      (5) | Train Loss: 0.1626 | Train Acc: 0.9718
 Site-Real                      (5) | Train Loss: 0.1959 | Train Acc: 0.9556
 Site-Real                      (5) | Train Loss: 0.2607 | Train Acc: 0.9483
 Site-Painting                  (6) | Train Loss: 0.3283 | Train Acc: 0.9048
 Site-Painting                  (2) | Train Loss: 0.2775 | Train Acc: 0.9029
 Site-Painting                  (6) | Train Loss: 0.2648 | Train Acc: 0.9412
 Site-Sketch                    (4) | Train Loss: 0.4138 | Train Acc: 0.8743
 Site-Sketch                    (4) | Train Loss: 0.4086 | Train Acc: 0.8539
 Site-QuickDraw                 (1) | Train Loss: 0.6688 | Train Acc: 0.8135
 Site-Infograph                 (3) | Train Loss: 0.8319 | Train Acc: 0.7650
Average Train Accuracy: 0.8971
 Site-Clipart                   (7) | Val  Loss: 0.2138 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.2664 | Val  Acc: 0.9252
 Site-Clipart                   (7) | Val  Loss: 0.2936 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.3512 | Val  Acc: 0.8714
 Site-Clipart                   (7) | Val  Loss: 0.4187 | Val  Acc: 0.8780
 Site-Real                      (5) | Val  Loss: 0.2237 | Val  Acc: 0.9286
 Site-Real                      (5) | Val  Loss: 0.2341 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.1965 | Val  Acc: 0.9455
 Site-Real                      (5) | Val  Loss: 0.1796 | Val  Acc: 0.9654
 Site-Painting                  (6) | Val  Loss: 0.1763 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.2669 | Val  Acc: 0.9197
 Site-Painting                  (6) | Val  Loss: 0.3064 | Val  Acc: 0.9010
 Site-Sketch                    (4) | Val  Loss: 0.3430 | Val  Acc: 0.8898
 Site-Sketch                    (4) | Val  Loss: 0.4576 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.6856 | Val  Acc: 0.7982
 Site-Infograph                 (3) | Val  Loss: 0.9276 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8941
 Test site-Clipart                   (7)| Epoch:46 | Test Acc: 0.9030
 Test site-Real                      (5)| Epoch:46 | Test Acc: 0.9449
 Test site-Painting                  (6)| Epoch:46 | Test Acc: 0.9305
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8664
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7600
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5906
Clipart: 0.9030, Real: 0.9449, Painting: 0.9305, Sketch: 0.8664, QuickDraw: 0.7600, Infograph: 0.5906, 
Average Test Accuracy(group): 0.8326, Average Test Accuracy(individual): 0.8856,
domain std=0.1239, cluster std=0.1136, individual std=0.0885, 
Average Test Accuracy: 0.8326
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 1, 1, 4, 3, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (6) | Train Loss: 0.3721 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.2826 | Train Acc: 0.9255
 Site-Clipart                   (7) | Train Loss: 0.4096 | Train Acc: 0.9022
 Site-Clipart                   (4) | Train Loss: 0.3476 | Train Acc: 0.8829
 Site-Clipart                   (4) | Train Loss: 0.2980 | Train Acc: 0.9321
 Site-Real                      (3) | Train Loss: 0.2750 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.1630 | Train Acc: 0.9718
 Site-Real                      (3) | Train Loss: 0.1845 | Train Acc: 0.9556
 Site-Real                      (3) | Train Loss: 0.2342 | Train Acc: 0.9425
 Site-Painting                  (5) | Train Loss: 0.3385 | Train Acc: 0.8844
 Site-Painting                  (5) | Train Loss: 0.2944 | Train Acc: 0.9175
 Site-Painting                  (5) | Train Loss: 0.3252 | Train Acc: 0.9170
 Site-Sketch                    (0) | Train Loss: 0.3637 | Train Acc: 0.8848
 Site-Sketch                    (0) | Train Loss: 0.3609 | Train Acc: 0.8614
 Site-QuickDraw                 (1) | Train Loss: 0.6294 | Train Acc: 0.8318
 Site-Infograph                 (2) | Train Loss: 0.7646 | Train Acc: 0.7607
Average Train Accuracy: 0.8997
 Site-Clipart                   (6) | Val  Loss: 0.2516 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.2765 | Val  Acc: 0.9346
 Site-Clipart                   (7) | Val  Loss: 0.3272 | Val  Acc: 0.8867
 Site-Clipart                   (4) | Val  Loss: 0.3553 | Val  Acc: 0.8762
 Site-Clipart                   (4) | Val  Loss: 0.4447 | Val  Acc: 0.8644
 Site-Real                      (3) | Val  Loss: 0.2222 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2484 | Val  Acc: 0.9153
 Site-Real                      (3) | Val  Loss: 0.1872 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.1885 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.1816 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.2481 | Val  Acc: 0.9416
 Site-Painting                  (5) | Val  Loss: 0.3102 | Val  Acc: 0.9115
 Site-Sketch                    (0) | Val  Loss: 0.3309 | Val  Acc: 0.9055
 Site-Sketch                    (0) | Val  Loss: 0.4185 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.6624 | Val  Acc: 0.8303
 Site-Infograph                 (2) | Val  Loss: 0.9106 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8978
 Test site-Clipart                   (6)| Epoch:47 | Test Acc: 0.8992
 Test site-Real                      (3)| Epoch:47 | Test Acc: 0.9466
 Test site-Painting                  (5)| Epoch:47 | Test Acc: 0.9273
 Test site-Sketch                    (0)| Epoch:47 | Test Acc: 0.8718
 Test site-QuickDraw                 (1)| Epoch:47 | Test Acc: 0.7710
 Test site-Infograph                 (2)| Epoch:47 | Test Acc: 0.5845
Clipart: 0.8992, Real: 0.9466, Painting: 0.9273, Sketch: 0.8718, QuickDraw: 0.7710, Infograph: 0.5845, 
Average Test Accuracy(group): 0.8334, Average Test Accuracy(individual): 0.8852,
domain std=0.1247, cluster std=0.1117, individual std=0.0885, 
Average Test Accuracy: 0.8334
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
============ Train epoch 49 ============
cnt=[3, 1, 3, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (7) | Train Loss: 0.3685 | Train Acc: 0.9217
 Site-Clipart                   (6) | Train Loss: 0.2321 | Train Acc: 0.9379
 Site-Clipart                   (0) | Train Loss: 0.3743 | Train Acc: 0.9067
 Site-Clipart                   (0) | Train Loss: 0.3213 | Train Acc: 0.9019
 Site-Clipart                   (0) | Train Loss: 0.3392 | Train Acc: 0.9095
 Site-Real                      (4) | Train Loss: 0.2798 | Train Acc: 0.9048
 Site-Real                      (4) | Train Loss: 0.1708 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.1903 | Train Acc: 0.9516
 Site-Real                      (4) | Train Loss: 0.2423 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.4044 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.3258 | Train Acc: 0.8738
 Site-Painting                  (2) | Train Loss: 0.3097 | Train Acc: 0.9135
 Site-Sketch                    (5) | Train Loss: 0.3687 | Train Acc: 0.8953
 Site-Sketch                    (5) | Train Loss: 0.3996 | Train Acc: 0.8652
 Site-QuickDraw                 (1) | Train Loss: 0.6026 | Train Acc: 0.8165
 Site-Infograph                 (3) | Train Loss: 0.7748 | Train Acc: 0.7778
Average Train Accuracy: 0.8987
 Site-Clipart                   (7) | Val  Loss: 0.1935 | Val  Acc: 0.9474
 Site-Clipart                   (6) | Val  Loss: 0.2548 | Val  Acc: 0.9346
 Site-Clipart                   (0) | Val  Loss: 0.2959 | Val  Acc: 0.9267
 Site-Clipart                   (0) | Val  Loss: 0.3720 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.3874 | Val  Acc: 0.8949
 Site-Real                      (4) | Val  Loss: 0.2536 | Val  Acc: 0.9167
 Site-Real                      (4) | Val  Loss: 0.1892 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.1913 | Val  Acc: 0.9455
 Site-Real                      (4) | Val  Loss: 0.1861 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.1894 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.2468 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.2674 | Val  Acc: 0.9271
 Site-Sketch                    (5) | Val  Loss: 0.3648 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.4388 | Val  Acc: 0.8483
 Site-QuickDraw                 (1) | Val  Loss: 0.7277 | Val  Acc: 0.7844
 Site-Infograph                 (3) | Val  Loss: 0.9257 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8981
 Test site-Clipart                   (7)| Epoch:48 | Test Acc: 0.8973
 Test site-Real                      (4)| Epoch:48 | Test Acc: 0.9474
 Test site-Painting                  (2)| Epoch:48 | Test Acc: 0.9289
 Test site-Sketch                    (5)| Epoch:48 | Test Acc: 0.8718
 Test site-QuickDraw                 (1)| Epoch:48 | Test Acc: 0.7620
 Test site-Infograph                 (3)| Epoch:48 | Test Acc: 0.5890
Clipart: 0.8973, Real: 0.9474, Painting: 0.9289, Sketch: 0.8718, QuickDraw: 0.7620, Infograph: 0.5890, 
Average Test Accuracy(group): 0.8328, Average Test Accuracy(individual): 0.8849,
domain std=0.1242, cluster std=0.1111, individual std=0.0885, 
Average Test Accuracy: 0.8328
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_0_cluster_8/ccop_q=1...
===2023-08-13 12:48:55===
===2023-08-13 12:49:04===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 8
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 8
Loading snapshots...
 Test site-Clipart                   (7)| Epoch:49 | Test Acc: 0.8973
 Test site-Real                      (4)| Epoch:49 | Test Acc: 0.9474
 Test site-Painting                  (2)| Epoch:49 | Test Acc: 0.9289
 Test site-Sketch                    (5)| Epoch:49 | Test Acc: 0.8718
 Test site-QuickDraw                 (1)| Epoch:49 | Test Acc: 0.7620
 Test site-Infograph                 (3)| Epoch:49 | Test Acc: 0.5890
Clipart: 0.8973, Real: 0.9474, Painting: 0.9289, Sketch: 0.8718, QuickDraw: 0.7620, Infograph: 0.5890, 
Average Test Accuracy(group): 0.8328, Average Test Accuracy(individual): 0.8849,
domain std=0.1242, cluster std=0.1111, individual std=0.0885, 
