===2023-03-27 19:33:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7607 | Train Acc: 0.5495
 Site-MNIST     | Train Loss: 1.7698 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 2.2093 | Train Acc: 0.1802
 Site-SVHN      | Train Loss: 2.2254 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.7019 | Train Acc: 0.6126
 Site-USPS      | Train Loss: 1.7569 | Train Acc: 0.6486
 Site-SynthDigits| Train Loss: 2.0906 | Train Acc: 0.2523
 Site-SynthDigits| Train Loss: 2.1153 | Train Acc: 0.2432
 Site-MNIST-M   | Train Loss: 2.1886 | Train Acc: 0.1982
 Site-MNIST-M   | Train Loss: 2.1870 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 1.7804 | Val  Acc: 0.4730
 Site-MNIST     | Val  Loss: 1.6988 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 2.2656 | Val  Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.1881 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 1.7367 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 1.7265 | Val  Acc: 0.6622
 Site-SynthDigits| Val  Loss: 2.1077 | Val  Acc: 0.2162
 Site-SynthDigits| Val  Loss: 2.0908 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.1882 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1784 | Val  Acc: 0.1757
Average Valid Accuracy: 0.3703
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4730
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2162
 Best site-USPS       | Epoch:0 | Val Acc: 0.6351
 Best site-USPS       | Epoch:0 | Val Acc: 0.6622
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2162
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2921 | Train Acc: 0.6216
 Site-MNIST     | Train Loss: 1.3467 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 2.1342 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.0992 | Train Acc: 0.2793
 Site-USPS      | Train Loss: 1.1487 | Train Acc: 0.8198
 Site-USPS      | Train Loss: 1.2298 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 1.8242 | Train Acc: 0.3694
 Site-SynthDigits| Train Loss: 1.8912 | Train Acc: 0.3243
 Site-MNIST-M   | Train Loss: 2.0450 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.0423 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 1.3919 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.2062 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 2.1409 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 2.0791 | Val  Acc: 0.2027
 Site-USPS      | Val  Loss: 1.2349 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 1.1721 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.8941 | Val  Acc: 0.2838
 Site-SynthDigits| Val  Loss: 1.8291 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 2.0072 | Val  Acc: 0.3649
 Site-MNIST-M   | Val  Loss: 2.0780 | Val  Acc: 0.2703
Average Valid Accuracy: 0.4622
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2027
 Best site-USPS       | Epoch:1 | Val Acc: 0.7568
 Best site-USPS       | Epoch:1 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2838
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3649
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9429 | Train Acc: 0.7027
 Site-MNIST     | Train Loss: 0.9924 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 1.9630 | Train Acc: 0.2883
 Site-SVHN      | Train Loss: 1.9602 | Train Acc: 0.3423
 Site-USPS      | Train Loss: 0.7278 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.7874 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.6406 | Train Acc: 0.4234
 Site-SynthDigits| Train Loss: 1.6691 | Train Acc: 0.4595
 Site-MNIST-M   | Train Loss: 1.8520 | Train Acc: 0.3694
 Site-MNIST-M   | Train Loss: 1.7609 | Train Acc: 0.4775
 Site-MNIST     | Val  Loss: 1.0230 | Val  Acc: 0.6486
 Site-MNIST     | Val  Loss: 0.8982 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 2.0255 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 1.9264 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 0.7772 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.7466 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.6713 | Val  Acc: 0.4730
 Site-SynthDigits| Val  Loss: 1.7001 | Val  Acc: 0.4324
 Site-MNIST-M   | Val  Loss: 1.7588 | Val  Acc: 0.4730
 Site-MNIST-M   | Val  Loss: 1.7522 | Val  Acc: 0.4459
Average Valid Accuracy: 0.5473
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6486
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3243
 Best site-USPS       | Epoch:2 | Val Acc: 0.8378
 Best site-USPS       | Epoch:2 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4730
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4324
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4730
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5457 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.6627 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 1.8148 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.8176 | Train Acc: 0.3784
 Site-USPS      | Train Loss: 0.5141 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.6017 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.3059 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 1.2744 | Train Acc: 0.6036
 Site-MNIST-M   | Train Loss: 1.6662 | Train Acc: 0.4414
 Site-MNIST-M   | Train Loss: 1.5977 | Train Acc: 0.5045
 Site-MNIST     | Val  Loss: 0.6790 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 0.5739 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 1.9004 | Val  Acc: 0.3784
 Site-SVHN      | Val  Loss: 1.7235 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 0.5972 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 0.5461 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.2923 | Val  Acc: 0.6081
 Site-SynthDigits| Val  Loss: 1.2985 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.5620 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.6208 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6149
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3784
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3243
 Best site-USPS       | Epoch:3 | Val Acc: 0.8243
 Best site-USPS       | Epoch:3 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6081
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3809 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.4778 | Train Acc: 0.8378
 Site-SVHN      | Train Loss: 1.6961 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.5683 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.3770 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.4236 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.1165 | Train Acc: 0.6577
 Site-SynthDigits| Train Loss: 1.0719 | Train Acc: 0.6577
 Site-MNIST-M   | Train Loss: 1.4347 | Train Acc: 0.4865
 Site-MNIST-M   | Train Loss: 1.2629 | Train Acc: 0.6216
 Site-MNIST     | Val  Loss: 0.4735 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.4313 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.6771 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 1.5458 | Val  Acc: 0.4595
 Site-USPS      | Val  Loss: 0.3903 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.4118 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.1007 | Val  Acc: 0.6351
 Site-SynthDigits| Val  Loss: 1.1048 | Val  Acc: 0.6486
 Site-MNIST-M   | Val  Loss: 1.2694 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.2339 | Val  Acc: 0.5811
Average Valid Accuracy: 0.6919
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4595
 Best site-USPS       | Epoch:4 | Val Acc: 0.9054
 Best site-USPS       | Epoch:4 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6351
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6486
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2357 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2810 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.3974 | Train Acc: 0.4775
 Site-SVHN      | Train Loss: 1.3840 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.2819 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.3278 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.9557 | Train Acc: 0.6577
 Site-SynthDigits| Train Loss: 0.8659 | Train Acc: 0.7117
 Site-MNIST-M   | Train Loss: 1.1366 | Train Acc: 0.6216
 Site-MNIST-M   | Train Loss: 0.9786 | Train Acc: 0.7027
 Site-MNIST     | Val  Loss: 0.2661 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.2753 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.4220 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.4233 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.2899 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.3265 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 0.9168 | Val  Acc: 0.6892
 Site-SynthDigits| Val  Loss: 0.8509 | Val  Acc: 0.7162
 Site-MNIST-M   | Val  Loss: 1.0156 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 0.9275 | Val  Acc: 0.7162
Average Valid Accuracy: 0.7446
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4459
 Best site-USPS       | Epoch:5 | Val Acc: 0.9189
 Best site-USPS       | Epoch:5 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6892
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7162
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1798 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.1856 | Train Acc: 0.9640
 Site-SVHN      | Train Loss: 1.2483 | Train Acc: 0.5405
 Site-SVHN      | Train Loss: 1.0986 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 0.2359 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.2716 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.7564 | Train Acc: 0.7477
 Site-SynthDigits| Train Loss: 0.6596 | Train Acc: 0.8018
 Site-MNIST-M   | Train Loss: 0.9033 | Train Acc: 0.7207
 Site-MNIST-M   | Train Loss: 0.7801 | Train Acc: 0.7658
 Site-MNIST     | Val  Loss: 0.1727 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1881 | Val  Acc: 0.9459
 Site-SVHN      | Val  Loss: 1.1741 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 1.1454 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 0.2188 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.2879 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.7014 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 0.6659 | Val  Acc: 0.7703
 Site-MNIST-M   | Val  Loss: 0.8130 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 0.7353 | Val  Acc: 0.7973
Average Valid Accuracy: 0.8041
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9459
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5811
 Best site-USPS       | Epoch:6 | Val Acc: 0.9189
 Best site-USPS       | Epoch:6 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7703
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1183 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.1136 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 1.0441 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 0.9626 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 0.1881 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.2223 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.5672 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.5090 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.6167 | Train Acc: 0.8288
 Site-MNIST-M   | Train Loss: 0.5696 | Train Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.1049 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1177 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.9872 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 1.0695 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 0.1718 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.2422 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.5639 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 0.4597 | Val  Acc: 0.8514
 Site-MNIST-M   | Val  Loss: 0.5866 | Val  Acc: 0.8108
 Site-MNIST-M   | Val  Loss: 0.5196 | Val  Acc: 0.8784
Average Valid Accuracy: 0.8419
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5946
 Best site-USPS       | Epoch:7 | Val Acc: 0.9189
 Best site-USPS       | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8514
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8108
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1069 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.0897 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.9117 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 0.6558 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.1503 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.1500 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.4518 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 0.4175 | Train Acc: 0.8649
 Site-MNIST-M   | Train Loss: 0.4677 | Train Acc: 0.8919
 Site-MNIST-M   | Train Loss: 0.4236 | Train Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.0878 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.0883 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7002 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 0.7941 | Val  Acc: 0.7432
 Site-USPS      | Val  Loss: 0.1034 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1901 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.4718 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 0.3658 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 0.4051 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 0.4293 | Val  Acc: 0.9054
Average Valid Accuracy: 0.9068
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7432
 Best site-USPS       | Epoch:8 | Val Acc: 0.9730
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9189
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0717 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.0603 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7130 | Train Acc: 0.7838
 Site-SVHN      | Train Loss: 0.6939 | Train Acc: 0.7207
 Site-USPS      | Train Loss: 0.1096 | Train Acc: 0.9550
 Site-USPS      | Train Loss: 0.1214 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.3643 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.3155 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 0.3379 | Train Acc: 0.9550
 Site-MNIST-M   | Train Loss: 0.3423 | Train Acc: 0.9279
 Site-MNIST     | Val  Loss: 0.0567 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0630 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7133 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 0.7439 | Val  Acc: 0.7162
 Site-USPS      | Val  Loss: 0.0850 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1485 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3756 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.2554 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 0.3432 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 0.3217 | Val  Acc: 0.9459
Average Valid Accuracy: 0.9041
===2023-03-27 20:15:54===
===2023-03-27 20:15:55===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:8 | Test Acc: 0.8714
 Test site-SVHN      | Epoch:8 | Test Acc: 0.3612
 Test site-USPS      | Epoch:8 | Test Acc: 0.8925
 Test site-SynthDigits| Epoch:8 | Test Acc: 0.6421
 Test site-MNIST-M   | Epoch:8 | Test Acc: 0.4136
Average Test Accuracy: 0.6362
