===2023-03-27 18:46:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.1
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7507 | Train Acc: 0.5315
 Site-MNIST     | Train Loss: 1.7599 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 2.1964 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.2227 | Train Acc: 0.2252
 Site-USPS      | Train Loss: 1.6896 | Train Acc: 0.5856
 Site-USPS      | Train Loss: 1.7418 | Train Acc: 0.7207
 Site-SynthDigits| Train Loss: 2.0812 | Train Acc: 0.2252
 Site-SynthDigits| Train Loss: 2.1049 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.1890 | Train Acc: 0.1892
 Site-MNIST-M   | Train Loss: 2.1580 | Train Acc: 0.2252
 Site-MNIST     | Val  Loss: 1.7645 | Val  Acc: 0.4865
 Site-MNIST     | Val  Loss: 1.7004 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 2.2649 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.1782 | Val  Acc: 0.2297
 Site-USPS      | Val  Loss: 1.7300 | Val  Acc: 0.7162
 Site-USPS      | Val  Loss: 1.7100 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 2.0992 | Val  Acc: 0.2568
 Site-SynthDigits| Val  Loss: 2.0755 | Val  Acc: 0.2703
 Site-MNIST-M   | Val  Loss: 2.1545 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1742 | Val  Acc: 0.1892
Average Valid Accuracy: 0.3824
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4865
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2297
 Best site-USPS       | Epoch:0 | Val Acc: 0.7162
 Best site-USPS       | Epoch:0 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2568
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2703
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2696 | Train Acc: 0.6126
 Site-MNIST     | Train Loss: 1.3093 | Train Acc: 0.6486
 Site-SVHN      | Train Loss: 2.0594 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.1034 | Train Acc: 0.2613
 Site-USPS      | Train Loss: 1.0855 | Train Acc: 0.7658
 Site-USPS      | Train Loss: 1.1454 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.8399 | Train Acc: 0.3964
 Site-SynthDigits| Train Loss: 1.8602 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 2.0265 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 1.9442 | Train Acc: 0.3514
 Site-MNIST     | Val  Loss: 1.3390 | Val  Acc: 0.6486
 Site-MNIST     | Val  Loss: 1.1965 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 2.1541 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.0390 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 1.1614 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 1.1262 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 1.8506 | Val  Acc: 0.3919
 Site-SynthDigits| Val  Loss: 1.8674 | Val  Acc: 0.4054
 Site-MNIST-M   | Val  Loss: 1.9197 | Val  Acc: 0.3784
 Site-MNIST-M   | Val  Loss: 1.9876 | Val  Acc: 0.3108
Average Valid Accuracy: 0.4946
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6486
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3108
 Best site-USPS       | Epoch:1 | Val Acc: 0.8514
 Best site-USPS       | Epoch:1 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3919
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4054
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3784
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8598 | Train Acc: 0.7658
 Site-MNIST     | Train Loss: 0.9527 | Train Acc: 0.7568
 Site-SVHN      | Train Loss: 1.8852 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.8568 | Train Acc: 0.3964
 Site-USPS      | Train Loss: 0.6897 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.7639 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.5008 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 1.5357 | Train Acc: 0.5495
 Site-MNIST-M   | Train Loss: 1.7978 | Train Acc: 0.3694
 Site-MNIST-M   | Train Loss: 1.7025 | Train Acc: 0.4685
 Site-MNIST     | Val  Loss: 0.9962 | Val  Acc: 0.7432
 Site-MNIST     | Val  Loss: 0.8193 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 1.9135 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.8186 | Val  Acc: 0.4054
 Site-USPS      | Val  Loss: 0.7547 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.7262 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.5478 | Val  Acc: 0.5270
 Site-SynthDigits| Val  Loss: 1.5210 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 1.6644 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.7020 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6054
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7432
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4054
 Best site-USPS       | Epoch:2 | Val Acc: 0.8649
 Best site-USPS       | Epoch:2 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5270
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5622 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 0.6792 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 1.6301 | Train Acc: 0.4775
 Site-SVHN      | Train Loss: 1.6635 | Train Acc: 0.4775
 Site-USPS      | Train Loss: 0.4455 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.4788 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 1.2795 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 1.2804 | Train Acc: 0.6216
 Site-MNIST-M   | Train Loss: 1.4321 | Train Acc: 0.5135
 Site-MNIST-M   | Train Loss: 1.3074 | Train Acc: 0.6306
 Site-MNIST     | Val  Loss: 0.7245 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 0.5550 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.7531 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 1.5562 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.4652 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.4724 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.3131 | Val  Acc: 0.6081
 Site-SynthDigits| Val  Loss: 1.3015 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.3094 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.2261 | Val  Acc: 0.6486
Average Valid Accuracy: 0.6838
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4459
 Best site-USPS       | Epoch:3 | Val Acc: 0.9324
 Best site-USPS       | Epoch:3 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6081
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.6486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3704 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.4614 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 1.4166 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 1.4603 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 0.3497 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3742 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.9624 | Train Acc: 0.7117
 Site-SynthDigits| Train Loss: 0.9824 | Train Acc: 0.7207
 Site-MNIST-M   | Train Loss: 1.1776 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.0699 | Train Acc: 0.6757
 Site-MNIST     | Val  Loss: 0.4796 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.3980 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.5709 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.3296 | Val  Acc: 0.5405
 Site-USPS      | Val  Loss: 0.3434 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.3699 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.0284 | Val  Acc: 0.7162
 Site-SynthDigits| Val  Loss: 0.9531 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 1.0594 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 0.9804 | Val  Acc: 0.7297
Average Valid Accuracy: 0.7500
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5405
 Best site-USPS       | Epoch:4 | Val Acc: 0.9324
 Best site-USPS       | Epoch:4 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.7162
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.7297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2375 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.2954 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.1367 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 1.2019 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 0.2550 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2527 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.8522 | Train Acc: 0.7387
 Site-SynthDigits| Train Loss: 0.8093 | Train Acc: 0.7838
 Site-MNIST-M   | Train Loss: 0.8829 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 0.8659 | Train Acc: 0.7658
 Site-MNIST     | Val  Loss: 0.2865 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.2693 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.2915 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 1.1342 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 0.2216 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.2677 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.8630 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 0.8001 | Val  Acc: 0.7568
 Site-MNIST-M   | Val  Loss: 0.8747 | Val  Acc: 0.7703
 Site-MNIST-M   | Val  Loss: 0.7194 | Val  Acc: 0.7973
Average Valid Accuracy: 0.8068
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6216
 Best site-USPS       | Epoch:5 | Val Acc: 0.9595
 Best site-USPS       | Epoch:5 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7568
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7703
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1618 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.2044 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 0.9417 | Train Acc: 0.6486
 Site-SVHN      | Train Loss: 0.9779 | Train Acc: 0.7117
 Site-USPS      | Train Loss: 0.1967 | Train Acc: 0.9550
 Site-USPS      | Train Loss: 0.2174 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.6486 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 0.6339 | Train Acc: 0.8288
 Site-MNIST-M   | Train Loss: 0.6802 | Train Acc: 0.8198
 Site-MNIST-M   | Train Loss: 0.6751 | Train Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.1914 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.1989 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 1.0553 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 0.9518 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 0.1879 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.2158 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.6815 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 0.6078 | Val  Acc: 0.8108
 Site-MNIST-M   | Val  Loss: 0.6722 | Val  Acc: 0.7973
 Site-MNIST-M   | Val  Loss: 0.5620 | Val  Acc: 0.8784
Average Valid Accuracy: 0.8446
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6486
 Best site-USPS       | Epoch:6 | Val Acc: 0.9595
 Best site-USPS       | Epoch:6 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8108
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7973
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0918 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1033 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.7622 | Train Acc: 0.8018
 Site-SVHN      | Train Loss: 0.7430 | Train Acc: 0.7928
 Site-USPS      | Train Loss: 0.1071 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.1298 | Train Acc: 0.9730
 Site-SynthDigits| Train Loss: 0.6463 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 0.6354 | Train Acc: 0.7928
 Site-MNIST-M   | Train Loss: 0.4709 | Train Acc: 0.9009
 Site-MNIST-M   | Train Loss: 0.5041 | Train Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.1009 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.0919 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.7941 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 0.7744 | Val  Acc: 0.7703
 Site-USPS      | Val  Loss: 0.1181 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1117 | Val  Acc: 0.9865
 Site-SynthDigits| Val  Loss: 0.6928 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 0.5709 | Val  Acc: 0.8243
 Site-MNIST-M   | Val  Loss: 0.4940 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 0.4003 | Val  Acc: 0.9189
Average Valid Accuracy: 0.8919
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7703
 Best site-USPS       | Epoch:7 | Val Acc: 0.9730
 Best site-USPS       | Epoch:7 | Val Acc: 0.9865
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8243
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9189
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0685 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0697 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.5615 | Train Acc: 0.8378
 Site-SVHN      | Train Loss: 0.5832 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.0845 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.0942 | Train Acc: 0.9820
 Site-SynthDigits| Train Loss: 0.4935 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.4879 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 0.3780 | Train Acc: 0.9459
 Site-MNIST-M   | Train Loss: 0.3953 | Train Acc: 0.9279
 Site-MNIST     | Val  Loss: 0.0730 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.0603 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6474 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 0.5521 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.0896 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.0765 | Val  Acc: 0.9865
 Site-SynthDigits| Val  Loss: 0.5307 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 0.4356 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 0.3874 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 0.3262 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9297
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8649
 Best site-USPS       | Epoch:8 | Val Acc: 0.9865
 Best site-USPS       | Epoch:8 | Val Acc: 0.9865
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9189
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0455 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0457 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.4298 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 0.4783 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.0698 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.0919 | Train Acc: 0.9820
 Site-SynthDigits| Train Loss: 0.3529 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.3469 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 0.2469 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.2727 | Train Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.0456 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0410 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5222 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 0.4320 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.0921 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.0677 | Val  Acc: 0.9865
 Site-SynthDigits| Val  Loss: 0.3632 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.3076 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 0.2650 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 0.2387 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9459
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:9 | Val Acc: 0.9054
 Best site-USPS       | Epoch:9 | Val Acc: 0.9865
 Best site-USPS       | Epoch:9 | Val Acc: 0.9865
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9189
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_tune/FedPrompt_tune_0.1...
===2023-03-27 19:29:27===
===2023-03-27 19:29:28===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.1
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8807
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3315
 Test site-USPS      | Epoch:9 | Test Acc: 0.8978
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6072
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3821
Average Test Accuracy: 0.6199
