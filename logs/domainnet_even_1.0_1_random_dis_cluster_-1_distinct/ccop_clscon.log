===2023-07-03 10:06:34===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[252,252,252,252,252,252,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-07-03 10:06:52===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[252,252,252,252,252,252,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
===2023-07-03 11:14:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[252,252,252,252,252,252,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-07-03 11:15:00===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[252,252,252,252,252,252,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
===2023-07-03 14:19:15===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[252,252,252,252,252,252,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
===2023-07-03 14:19:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[252,252,252,252,252,252,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
===2023-07-03 21:20:02===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[252,252,252,252,252,252,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (3) | Train Loss: 1.9943 | Train Acc: 0.4365
 Site-Real                      (2) | Train Loss: 2.0159 | Train Acc: 0.4286
 Site-Painting                  (2) | Train Loss: 2.0668 | Train Acc: 0.3611
 Site-Sketch                    (4) | Train Loss: 2.0091 | Train Acc: 0.4325
 Site-QuickDraw                 (1) | Train Loss: 2.2411 | Train Acc: 0.2262
 Site-Infograph                 (0) | Train Loss: 2.2228 | Train Acc: 0.1984
Average Train Accuracy: 0.3472
 Site-Clipart                   (3) | Val  Loss: 2.0397 | Val  Acc: 0.3512
 Site-Real                      (2) | Val  Loss: 2.0142 | Val  Acc: 0.4345
 Site-Painting                  (2) | Val  Loss: 2.0660 | Val  Acc: 0.3452
 Site-Sketch                    (4) | Val  Loss: 1.9882 | Val  Acc: 0.3631
 Site-QuickDraw                 (1) | Val  Loss: 2.2292 | Val  Acc: 0.1964
 Site-Infograph                 (0) | Val  Loss: 2.2314 | Val  Acc: 0.1905
Average Valid Accuracy: 0.3135
 Best site-Clipart                  (3)  | Epoch:0 | Val Acc: 0.3512
 Best site-Real                     (2)  | Epoch:0 | Val Acc: 0.4345
 Best site-Painting                 (2)  | Epoch:0 | Val Acc: 0.3452
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3631
 Best site-QuickDraw                (1)  | Epoch:0 | Val Acc: 0.1964
 Best site-Infograph                (0)  | Epoch:0 | Val Acc: 0.1905
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (2) | Train Loss: 1.7030 | Train Acc: 0.5754
 Site-Real                      (1) | Train Loss: 1.5940 | Train Acc: 0.6587
 Site-Painting                  (1) | Train Loss: 1.7187 | Train Acc: 0.5556
 Site-Sketch                    (4) | Train Loss: 1.7094 | Train Acc: 0.5754
 Site-QuickDraw                 (0) | Train Loss: 2.1480 | Train Acc: 0.3254
 Site-Infograph                 (3) | Train Loss: 2.0706 | Train Acc: 0.3056
Average Train Accuracy: 0.4993
 Site-Clipart                   (2) | Val  Loss: 1.7754 | Val  Acc: 0.5000
 Site-Real                      (1) | Val  Loss: 1.6070 | Val  Acc: 0.6548
 Site-Painting                  (1) | Val  Loss: 1.6599 | Val  Acc: 0.5774
 Site-Sketch                    (4) | Val  Loss: 1.6365 | Val  Acc: 0.5774
 Site-QuickDraw                 (0) | Val  Loss: 2.1429 | Val  Acc: 0.2917
 Site-Infograph                 (3) | Val  Loss: 2.0629 | Val  Acc: 0.3036
Average Valid Accuracy: 0.4841
 Best site-Clipart                  (2)  | Epoch:1 | Val Acc: 0.5000
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6548
 Best site-Painting                 (1)  | Epoch:1 | Val Acc: 0.5774
 Best site-Sketch                   (4)  | Epoch:1 | Val Acc: 0.5774
 Best site-QuickDraw                (0)  | Epoch:1 | Val Acc: 0.2917
 Best site-Infograph                (3)  | Epoch:1 | Val Acc: 0.3036
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (4) | Train Loss: 1.4329 | Train Acc: 0.6548
 Site-Real                      (2) | Train Loss: 1.2613 | Train Acc: 0.8175
 Site-Painting                  (2) | Train Loss: 1.3722 | Train Acc: 0.6905
 Site-Sketch                    (3) | Train Loss: 1.3974 | Train Acc: 0.6905
 Site-QuickDraw                 (1) | Train Loss: 2.0655 | Train Acc: 0.3373
 Site-Infograph                 (0) | Train Loss: 1.8912 | Train Acc: 0.3889
Average Train Accuracy: 0.5966
 Site-Clipart                   (4) | Val  Loss: 1.4709 | Val  Acc: 0.6429
 Site-Real                      (2) | Val  Loss: 1.2064 | Val  Acc: 0.8214
 Site-Painting                  (2) | Val  Loss: 1.3501 | Val  Acc: 0.7262
 Site-Sketch                    (3) | Val  Loss: 1.3669 | Val  Acc: 0.6607
 Site-QuickDraw                 (1) | Val  Loss: 2.0698 | Val  Acc: 0.3393
 Site-Infograph                 (0) | Val  Loss: 1.8580 | Val  Acc: 0.4464
Average Valid Accuracy: 0.6062
 Best site-Clipart                  (4)  | Epoch:2 | Val Acc: 0.6429
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.8214
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.7262
 Best site-Sketch                   (3)  | Epoch:2 | Val Acc: 0.6607
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.3393
 Best site-Infograph                (0)  | Epoch:2 | Val Acc: 0.4464
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (3) | Train Loss: 1.1754 | Train Acc: 0.7738
 Site-Real                      (4) | Train Loss: 1.0029 | Train Acc: 0.8651
 Site-Painting                  (2) | Train Loss: 1.1433 | Train Acc: 0.7659
 Site-Sketch                    (3) | Train Loss: 1.1605 | Train Acc: 0.7183
 Site-QuickDraw                 (1) | Train Loss: 1.9501 | Train Acc: 0.3333
 Site-Infograph                 (0) | Train Loss: 1.7170 | Train Acc: 0.4881
Average Train Accuracy: 0.6574
 Site-Clipart                   (3) | Val  Loss: 1.1666 | Val  Acc: 0.7262
 Site-Real                      (4) | Val  Loss: 0.9433 | Val  Acc: 0.8869
 Site-Painting                  (2) | Val  Loss: 1.1464 | Val  Acc: 0.7738
 Site-Sketch                    (3) | Val  Loss: 1.1275 | Val  Acc: 0.7440
 Site-QuickDraw                 (1) | Val  Loss: 1.9520 | Val  Acc: 0.3452
 Site-Infograph                 (0) | Val  Loss: 1.6896 | Val  Acc: 0.4702
Average Valid Accuracy: 0.6577
 Best site-Clipart                  (3)  | Epoch:3 | Val Acc: 0.7262
 Best site-Real                     (4)  | Epoch:3 | Val Acc: 0.8869
 Best site-Painting                 (2)  | Epoch:3 | Val Acc: 0.7738
 Best site-Sketch                   (3)  | Epoch:3 | Val Acc: 0.7440
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.3452
 Best site-Infograph                (0)  | Epoch:3 | Val Acc: 0.4702
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.0083 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.8394 | Train Acc: 0.8770
 Site-Painting                  (4) | Train Loss: 0.9927 | Train Acc: 0.8016
 Site-Sketch                    (0) | Train Loss: 0.9583 | Train Acc: 0.8016
 Site-QuickDraw                 (1) | Train Loss: 1.7797 | Train Acc: 0.4881
 Site-Infograph                 (3) | Train Loss: 1.5670 | Train Acc: 0.5357
Average Train Accuracy: 0.7136
 Site-Clipart                   (0) | Val  Loss: 1.0023 | Val  Acc: 0.8036
 Site-Real                      (2) | Val  Loss: 0.7790 | Val  Acc: 0.9345
 Site-Painting                  (4) | Val  Loss: 0.9114 | Val  Acc: 0.8095
 Site-Sketch                    (0) | Val  Loss: 0.9798 | Val  Acc: 0.7381
 Site-QuickDraw                 (1) | Val  Loss: 1.8073 | Val  Acc: 0.4762
 Site-Infograph                 (3) | Val  Loss: 1.5393 | Val  Acc: 0.5476
Average Valid Accuracy: 0.7183
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.8036
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.9345
 Best site-Painting                 (4)  | Epoch:4 | Val Acc: 0.8095
 Best site-Sketch                   (0)  | Epoch:4 | Val Acc: 0.7381
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.4762
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.5476
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (0) | Train Loss: 0.8822 | Train Acc: 0.8294
 Site-Real                      (3) | Train Loss: 0.7331 | Train Acc: 0.8889
 Site-Painting                  (0) | Train Loss: 0.8953 | Train Acc: 0.8016
 Site-Sketch                    (4) | Train Loss: 0.9091 | Train Acc: 0.7659
 Site-QuickDraw                 (2) | Train Loss: 1.6009 | Train Acc: 0.5675
 Site-Infograph                 (1) | Train Loss: 1.5251 | Train Acc: 0.5238
Average Train Accuracy: 0.7295
 Site-Clipart                   (0) | Val  Loss: 0.9443 | Val  Acc: 0.7917
 Site-Real                      (3) | Val  Loss: 0.6985 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.8805 | Val  Acc: 0.7738
 Site-Sketch                    (4) | Val  Loss: 0.8471 | Val  Acc: 0.7857
 Site-QuickDraw                 (2) | Val  Loss: 1.6497 | Val  Acc: 0.5595
 Site-Infograph                 (1) | Val  Loss: 1.5225 | Val  Acc: 0.5476
Average Valid Accuracy: 0.7272
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7917
 Best site-Real                     (3)  | Epoch:5 | Val Acc: 0.9048
 Best site-Painting                 (0)  | Epoch:5 | Val Acc: 0.7738
 Best site-Sketch                   (4)  | Epoch:5 | Val Acc: 0.7857
 Best site-QuickDraw                (2)  | Epoch:5 | Val Acc: 0.5595
 Best site-Infograph                (1)  | Epoch:5 | Val Acc: 0.5476
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (2) | Train Loss: 0.8567 | Train Acc: 0.7857
 Site-Real                      (1) | Train Loss: 0.6143 | Train Acc: 0.8968
 Site-Painting                  (1) | Train Loss: 0.7993 | Train Acc: 0.8135
 Site-Sketch                    (4) | Train Loss: 0.8035 | Train Acc: 0.7976
 Site-QuickDraw                 (0) | Train Loss: 1.5208 | Train Acc: 0.5357
 Site-Infograph                 (3) | Train Loss: 1.4152 | Train Acc: 0.5992
Average Train Accuracy: 0.7381
 Site-Clipart                   (2) | Val  Loss: 0.8580 | Val  Acc: 0.7857
 Site-Real                      (1) | Val  Loss: 0.5717 | Val  Acc: 0.9345
 Site-Painting                  (1) | Val  Loss: 0.7517 | Val  Acc: 0.8393
 Site-Sketch                    (4) | Val  Loss: 0.8092 | Val  Acc: 0.7857
 Site-QuickDraw                 (0) | Val  Loss: 1.5798 | Val  Acc: 0.5536
 Site-Infograph                 (3) | Val  Loss: 1.4324 | Val  Acc: 0.5952
Average Valid Accuracy: 0.7490
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7857
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9345
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8393
 Best site-Sketch                   (4)  | Epoch:6 | Val Acc: 0.7857
 Best site-QuickDraw                (0)  | Epoch:6 | Val Acc: 0.5536
 Best site-Infograph                (3)  | Epoch:6 | Val Acc: 0.5952
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (3) | Train Loss: 0.7454 | Train Acc: 0.8294
 Site-Real                      (0) | Train Loss: 0.5738 | Train Acc: 0.9127
 Site-Painting                  (3) | Train Loss: 0.7710 | Train Acc: 0.8254
 Site-Sketch                    (4) | Train Loss: 0.7688 | Train Acc: 0.8056
 Site-QuickDraw                 (1) | Train Loss: 1.3379 | Train Acc: 0.6746
 Site-Infograph                 (2) | Train Loss: 1.3641 | Train Acc: 0.5992
Average Train Accuracy: 0.7745
 Site-Clipart                   (3) | Val  Loss: 0.7295 | Val  Acc: 0.8571
 Site-Real                      (0) | Val  Loss: 0.5398 | Val  Acc: 0.9345
 Site-Painting                  (3) | Val  Loss: 0.7127 | Val  Acc: 0.8631
 Site-Sketch                    (4) | Val  Loss: 0.7528 | Val  Acc: 0.7500
 Site-QuickDraw                 (1) | Val  Loss: 1.3775 | Val  Acc: 0.6369
 Site-Infograph                 (2) | Val  Loss: 1.3956 | Val  Acc: 0.6071
Average Valid Accuracy: 0.7748
 Best site-Clipart                  (3)  | Epoch:7 | Val Acc: 0.8571
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 0.9345
 Best site-Painting                 (3)  | Epoch:7 | Val Acc: 0.8631
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.7500
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.6369
 Best site-Infograph                (2)  | Epoch:7 | Val Acc: 0.6071
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (3) | Train Loss: 0.6691 | Train Acc: 0.8254
 Site-Real                      (0) | Train Loss: 0.5067 | Train Acc: 0.9206
 Site-Painting                  (4) | Train Loss: 0.7127 | Train Acc: 0.8056
 Site-Sketch                    (2) | Train Loss: 0.6700 | Train Acc: 0.8373
 Site-QuickDraw                 (1) | Train Loss: 1.2593 | Train Acc: 0.6706
 Site-Infograph                 (2) | Train Loss: 1.3328 | Train Acc: 0.5714
Average Train Accuracy: 0.7718
 Site-Clipart                   (3) | Val  Loss: 0.7318 | Val  Acc: 0.8214
 Site-Real                      (0) | Val  Loss: 0.4426 | Val  Acc: 0.9464
 Site-Painting                  (4) | Val  Loss: 0.6465 | Val  Acc: 0.8512
 Site-Sketch                    (2) | Val  Loss: 0.6739 | Val  Acc: 0.7976
 Site-QuickDraw                 (1) | Val  Loss: 1.3701 | Val  Acc: 0.6250
 Site-Infograph                 (2) | Val  Loss: 1.3616 | Val  Acc: 0.6190
Average Valid Accuracy: 0.7768
 Best site-Clipart                  (3)  | Epoch:8 | Val Acc: 0.8214
 Best site-Real                     (0)  | Epoch:8 | Val Acc: 0.9464
 Best site-Painting                 (4)  | Epoch:8 | Val Acc: 0.8512
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.7976
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.6250
 Best site-Infograph                (2)  | Epoch:8 | Val Acc: 0.6190
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (0) | Train Loss: 0.6684 | Train Acc: 0.8492
 Site-Real                      (2) | Train Loss: 0.4848 | Train Acc: 0.9048
 Site-Painting                  (4) | Train Loss: 0.6417 | Train Acc: 0.8611
 Site-Sketch                    (0) | Train Loss: 0.6696 | Train Acc: 0.8294
 Site-QuickDraw                 (1) | Train Loss: 1.2420 | Train Acc: 0.6508
 Site-Infograph                 (3) | Train Loss: 1.2572 | Train Acc: 0.6230
Average Train Accuracy: 0.7864
 Site-Clipart                   (0) | Val  Loss: 0.6557 | Val  Acc: 0.8333
 Site-Real                      (2) | Val  Loss: 0.4328 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.6575 | Val  Acc: 0.8393
 Site-Sketch                    (0) | Val  Loss: 0.6491 | Val  Acc: 0.8036
 Site-QuickDraw                 (1) | Val  Loss: 1.2752 | Val  Acc: 0.6667
 Site-Infograph                 (3) | Val  Loss: 1.2844 | Val  Acc: 0.6488
Average Valid Accuracy: 0.7907
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.8333
 Best site-Real                     (2)  | Epoch:9 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:9 | Val Acc: 0.8393
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.8036
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph                (3)  | Epoch:9 | Val Acc: 0.6488
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (3) | Train Loss: 0.6002 | Train Acc: 0.8611
 Site-Real                      (1) | Train Loss: 0.4646 | Train Acc: 0.8968
 Site-Painting                  (4) | Train Loss: 0.6649 | Train Acc: 0.8175
 Site-Sketch                    (3) | Train Loss: 0.6570 | Train Acc: 0.8135
 Site-QuickDraw                 (2) | Train Loss: 1.0998 | Train Acc: 0.6825
 Site-Infograph                 (0) | Train Loss: 1.1577 | Train Acc: 0.6706
Average Train Accuracy: 0.7903
 Site-Clipart                   (3) | Val  Loss: 0.6255 | Val  Acc: 0.8393
 Site-Real                      (1) | Val  Loss: 0.3816 | Val  Acc: 0.9583
 Site-Painting                  (4) | Val  Loss: 0.5921 | Val  Acc: 0.8512
 Site-Sketch                    (3) | Val  Loss: 0.6621 | Val  Acc: 0.7917
 Site-QuickDraw                 (2) | Val  Loss: 1.2185 | Val  Acc: 0.6607
 Site-Infograph                 (0) | Val  Loss: 1.2356 | Val  Acc: 0.6786
Average Valid Accuracy: 0.7966
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.8393
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9583
 Best site-Painting                 (4)  | Epoch:10 | Val Acc: 0.8512
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.7917
 Best site-QuickDraw                (2)  | Epoch:10 | Val Acc: 0.6607
 Best site-Infograph                (0)  | Epoch:10 | Val Acc: 0.6786
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.5811 | Train Acc: 0.8810
 Site-Real                      (2) | Train Loss: 0.4155 | Train Acc: 0.9167
 Site-Painting                  (2) | Train Loss: 0.6404 | Train Acc: 0.8175
 Site-Sketch                    (4) | Train Loss: 0.5990 | Train Acc: 0.8214
 Site-QuickDraw                 (1) | Train Loss: 1.1121 | Train Acc: 0.6667
 Site-Infograph                 (3) | Train Loss: 1.1299 | Train Acc: 0.6587
Average Train Accuracy: 0.7937
 Site-Clipart                   (0) | Val  Loss: 0.5845 | Val  Acc: 0.8810
 Site-Real                      (2) | Val  Loss: 0.3610 | Val  Acc: 0.9583
 Site-Painting                  (2) | Val  Loss: 0.5737 | Val  Acc: 0.8631
 Site-Sketch                    (4) | Val  Loss: 0.6200 | Val  Acc: 0.7857
 Site-QuickDraw                 (1) | Val  Loss: 1.1848 | Val  Acc: 0.6607
 Site-Infograph                 (3) | Val  Loss: 1.2177 | Val  Acc: 0.6786
Average Valid Accuracy: 0.8046
 Best site-Clipart                  (0)  | Epoch:11 | Val Acc: 0.8810
 Best site-Real                     (2)  | Epoch:11 | Val Acc: 0.9583
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8631
 Best site-Sketch                   (4)  | Epoch:11 | Val Acc: 0.7857
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.6607
 Best site-Infograph                (3)  | Epoch:11 | Val Acc: 0.6786
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 12 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (3) | Train Loss: 0.5719 | Train Acc: 0.8492
 Site-Real                      (4) | Train Loss: 0.4066 | Train Acc: 0.9048
 Site-Painting                  (1) | Train Loss: 0.5992 | Train Acc: 0.8333
 Site-Sketch                    (3) | Train Loss: 0.6121 | Train Acc: 0.8056
 Site-QuickDraw                 (0) | Train Loss: 1.0079 | Train Acc: 0.7302
 Site-Infograph                 (2) | Train Loss: 1.1208 | Train Acc: 0.6429
Average Train Accuracy: 0.7943
 Site-Clipart                   (3) | Val  Loss: 0.5770 | Val  Acc: 0.8452
 Site-Real                      (4) | Val  Loss: 0.3391 | Val  Acc: 0.9464
 Site-Painting                  (1) | Val  Loss: 0.5380 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.5622 | Val  Acc: 0.8214
 Site-QuickDraw                 (0) | Val  Loss: 1.1105 | Val  Acc: 0.6667
 Site-Infograph                 (2) | Val  Loss: 1.1997 | Val  Acc: 0.6607
Average Valid Accuracy: 0.7996
============ Train epoch 13 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (2) | Train Loss: 0.5546 | Train Acc: 0.8452
 Site-Real                      (0) | Train Loss: 0.3924 | Train Acc: 0.9167
 Site-Painting                  (0) | Train Loss: 0.5543 | Train Acc: 0.8452
 Site-Sketch                    (3) | Train Loss: 0.5593 | Train Acc: 0.8532
 Site-QuickDraw                 (1) | Train Loss: 0.9800 | Train Acc: 0.7381
 Site-Infograph                 (4) | Train Loss: 1.1075 | Train Acc: 0.6667
Average Train Accuracy: 0.8108
 Site-Clipart                   (2) | Val  Loss: 0.5429 | Val  Acc: 0.8750
 Site-Real                      (0) | Val  Loss: 0.3195 | Val  Acc: 0.9762
 Site-Painting                  (0) | Val  Loss: 0.5307 | Val  Acc: 0.8631
 Site-Sketch                    (3) | Val  Loss: 0.5951 | Val  Acc: 0.7976
 Site-QuickDraw                 (1) | Val  Loss: 1.0524 | Val  Acc: 0.7262
 Site-Infograph                 (4) | Val  Loss: 1.2050 | Val  Acc: 0.6786
Average Valid Accuracy: 0.8194
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8750
 Best site-Real                     (0)  | Epoch:13 | Val Acc: 0.9762
 Best site-Painting                 (0)  | Epoch:13 | Val Acc: 0.8631
 Best site-Sketch                   (3)  | Epoch:13 | Val Acc: 0.7976
 Best site-QuickDraw                (1)  | Epoch:13 | Val Acc: 0.7262
 Best site-Infograph                (4)  | Epoch:13 | Val Acc: 0.6786
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (3) | Train Loss: 0.5393 | Train Acc: 0.8651
 Site-Real                      (0) | Train Loss: 0.3513 | Train Acc: 0.9286
 Site-Painting                  (4) | Train Loss: 0.5218 | Train Acc: 0.8651
 Site-Sketch                    (3) | Train Loss: 0.5491 | Train Acc: 0.8413
 Site-QuickDraw                 (1) | Train Loss: 0.9597 | Train Acc: 0.7262
 Site-Infograph                 (2) | Train Loss: 1.0244 | Train Acc: 0.6746
Average Train Accuracy: 0.8168
 Site-Clipart                   (3) | Val  Loss: 0.5492 | Val  Acc: 0.8571
 Site-Real                      (0) | Val  Loss: 0.2800 | Val  Acc: 0.9821
 Site-Painting                  (4) | Val  Loss: 0.4954 | Val  Acc: 0.8988
 Site-Sketch                    (3) | Val  Loss: 0.6082 | Val  Acc: 0.8155
 Site-QuickDraw                 (1) | Val  Loss: 1.0494 | Val  Acc: 0.7262
 Site-Infograph                 (2) | Val  Loss: 1.1657 | Val  Acc: 0.7083
Average Valid Accuracy: 0.8313
 Best site-Clipart                  (3)  | Epoch:14 | Val Acc: 0.8571
 Best site-Real                     (0)  | Epoch:14 | Val Acc: 0.9821
 Best site-Painting                 (4)  | Epoch:14 | Val Acc: 0.8988
 Best site-Sketch                   (3)  | Epoch:14 | Val Acc: 0.8155
 Best site-QuickDraw                (1)  | Epoch:14 | Val Acc: 0.7262
 Best site-Infograph                (2)  | Epoch:14 | Val Acc: 0.7083
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (4) | Train Loss: 0.5020 | Train Acc: 0.8690
 Site-Real                      (2) | Train Loss: 0.3570 | Train Acc: 0.9286
 Site-Painting                  (3) | Train Loss: 0.5418 | Train Acc: 0.8373
 Site-Sketch                    (0) | Train Loss: 0.5561 | Train Acc: 0.8214
 Site-QuickDraw                 (1) | Train Loss: 0.9071 | Train Acc: 0.7302
 Site-Infograph                 (3) | Train Loss: 1.0109 | Train Acc: 0.6786
Average Train Accuracy: 0.8108
 Site-Clipart                   (4) | Val  Loss: 0.5024 | Val  Acc: 0.8393
 Site-Real                      (2) | Val  Loss: 0.2951 | Val  Acc: 0.9464
 Site-Painting                  (3) | Val  Loss: 0.4613 | Val  Acc: 0.8929
 Site-Sketch                    (0) | Val  Loss: 0.6056 | Val  Acc: 0.7976
 Site-QuickDraw                 (1) | Val  Loss: 0.9770 | Val  Acc: 0.7560
 Site-Infograph                 (3) | Val  Loss: 1.1702 | Val  Acc: 0.7262
Average Valid Accuracy: 0.8264
============ Train epoch 16 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (0) | Train Loss: 0.4905 | Train Acc: 0.8770
 Site-Real                      (3) | Train Loss: 0.3417 | Train Acc: 0.9246
 Site-Painting                  (3) | Train Loss: 0.4814 | Train Acc: 0.8690
 Site-Sketch                    (4) | Train Loss: 0.5213 | Train Acc: 0.8452
 Site-QuickDraw                 (1) | Train Loss: 0.8602 | Train Acc: 0.7698
 Site-Infograph                 (2) | Train Loss: 1.0229 | Train Acc: 0.6865
Average Train Accuracy: 0.8287
 Site-Clipart                   (0) | Val  Loss: 0.4995 | Val  Acc: 0.8571
 Site-Real                      (3) | Val  Loss: 0.2801 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.4683 | Val  Acc: 0.8810
 Site-Sketch                    (4) | Val  Loss: 0.5172 | Val  Acc: 0.8214
 Site-QuickDraw                 (1) | Val  Loss: 0.9597 | Val  Acc: 0.7440
 Site-Infograph                 (2) | Val  Loss: 1.1463 | Val  Acc: 0.6964
Average Valid Accuracy: 0.8254
============ Train epoch 17 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (4) | Train Loss: 0.4916 | Train Acc: 0.8810
 Site-Real                      (3) | Train Loss: 0.3067 | Train Acc: 0.9325
 Site-Painting                  (2) | Train Loss: 0.4729 | Train Acc: 0.8571
 Site-Sketch                    (0) | Train Loss: 0.5258 | Train Acc: 0.8175
 Site-QuickDraw                 (1) | Train Loss: 0.8163 | Train Acc: 0.7937
 Site-Infograph                 (2) | Train Loss: 0.9729 | Train Acc: 0.6746
Average Train Accuracy: 0.8261
 Site-Clipart                   (4) | Val  Loss: 0.4908 | Val  Acc: 0.8929
 Site-Real                      (3) | Val  Loss: 0.2463 | Val  Acc: 0.9643
 Site-Painting                  (2) | Val  Loss: 0.4599 | Val  Acc: 0.8810
 Site-Sketch                    (0) | Val  Loss: 0.5336 | Val  Acc: 0.8155
 Site-QuickDraw                 (1) | Val  Loss: 0.9829 | Val  Acc: 0.7381
 Site-Infograph                 (2) | Val  Loss: 1.1523 | Val  Acc: 0.7262
Average Valid Accuracy: 0.8363
 Best site-Clipart                  (4)  | Epoch:17 | Val Acc: 0.8929
 Best site-Real                     (3)  | Epoch:17 | Val Acc: 0.9643
 Best site-Painting                 (2)  | Epoch:17 | Val Acc: 0.8810
 Best site-Sketch                   (0)  | Epoch:17 | Val Acc: 0.8155
 Best site-QuickDraw                (1)  | Epoch:17 | Val Acc: 0.7381
 Best site-Infograph                (2)  | Epoch:17 | Val Acc: 0.7262
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (3) | Train Loss: 0.5099 | Train Acc: 0.8492
 Site-Real                      (0) | Train Loss: 0.3226 | Train Acc: 0.9206
 Site-Painting                  (4) | Train Loss: 0.4677 | Train Acc: 0.8611
 Site-Sketch                    (3) | Train Loss: 0.5269 | Train Acc: 0.8611
 Site-QuickDraw                 (1) | Train Loss: 0.8045 | Train Acc: 0.8095
 Site-Infograph                 (2) | Train Loss: 0.9021 | Train Acc: 0.7063
Average Train Accuracy: 0.8347
 Site-Clipart                   (3) | Val  Loss: 0.5079 | Val  Acc: 0.8690
 Site-Real                      (0) | Val  Loss: 0.2521 | Val  Acc: 0.9583
 Site-Painting                  (4) | Val  Loss: 0.4591 | Val  Acc: 0.8869
 Site-Sketch                    (3) | Val  Loss: 0.6094 | Val  Acc: 0.7560
 Site-QuickDraw                 (1) | Val  Loss: 0.8886 | Val  Acc: 0.7440
 Site-Infograph                 (2) | Val  Loss: 1.1526 | Val  Acc: 0.6786
Average Valid Accuracy: 0.8155
============ Train epoch 19 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (3) | Train Loss: 0.4412 | Train Acc: 0.8889
 Site-Real                      (0) | Train Loss: 0.3207 | Train Acc: 0.9365
 Site-Painting                  (4) | Train Loss: 0.4404 | Train Acc: 0.8730
 Site-Sketch                    (3) | Train Loss: 0.5089 | Train Acc: 0.8333
 Site-QuickDraw                 (1) | Train Loss: 0.7727 | Train Acc: 0.7778
 Site-Infograph                 (2) | Train Loss: 0.8899 | Train Acc: 0.7381
Average Train Accuracy: 0.8413
 Site-Clipart                   (3) | Val  Loss: 0.4421 | Val  Acc: 0.9048
 Site-Real                      (0) | Val  Loss: 0.2586 | Val  Acc: 0.9643
 Site-Painting                  (4) | Val  Loss: 0.3974 | Val  Acc: 0.8810
 Site-Sketch                    (3) | Val  Loss: 0.5681 | Val  Acc: 0.8214
 Site-QuickDraw                 (1) | Val  Loss: 0.9316 | Val  Acc: 0.7262
 Site-Infograph                 (2) | Val  Loss: 1.1633 | Val  Acc: 0.7202
Average Valid Accuracy: 0.8363
============ Train epoch 20 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (2) | Train Loss: 0.4665 | Train Acc: 0.8651
 Site-Real                      (3) | Train Loss: 0.3058 | Train Acc: 0.9286
 Site-Painting                  (3) | Train Loss: 0.4778 | Train Acc: 0.8611
 Site-Sketch                    (4) | Train Loss: 0.4594 | Train Acc: 0.8730
 Site-QuickDraw                 (1) | Train Loss: 0.7784 | Train Acc: 0.7857
 Site-Infograph                 (0) | Train Loss: 0.8641 | Train Acc: 0.7500
Average Train Accuracy: 0.8439
 Site-Clipart                   (2) | Val  Loss: 0.4506 | Val  Acc: 0.8929
 Site-Real                      (3) | Val  Loss: 0.2524 | Val  Acc: 0.9583
 Site-Painting                  (3) | Val  Loss: 0.3989 | Val  Acc: 0.8810
 Site-Sketch                    (4) | Val  Loss: 0.5025 | Val  Acc: 0.8452
 Site-QuickDraw                 (1) | Val  Loss: 0.8411 | Val  Acc: 0.7560
 Site-Infograph                 (0) | Val  Loss: 1.0989 | Val  Acc: 0.7262
Average Valid Accuracy: 0.8433
 Best site-Clipart                  (2)  | Epoch:20 | Val Acc: 0.8929
 Best site-Real                     (3)  | Epoch:20 | Val Acc: 0.9583
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.8810
 Best site-Sketch                   (4)  | Epoch:20 | Val Acc: 0.8452
 Best site-QuickDraw                (1)  | Epoch:20 | Val Acc: 0.7560
 Best site-Infograph                (0)  | Epoch:20 | Val Acc: 0.7262
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 21 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (2) | Train Loss: 0.4580 | Train Acc: 0.8730
 Site-Real                      (3) | Train Loss: 0.3067 | Train Acc: 0.9167
 Site-Painting                  (4) | Train Loss: 0.4174 | Train Acc: 0.8929
 Site-Sketch                    (2) | Train Loss: 0.4322 | Train Acc: 0.8770
 Site-QuickDraw                 (1) | Train Loss: 0.7434 | Train Acc: 0.8294
 Site-Infograph                 (0) | Train Loss: 0.8784 | Train Acc: 0.7222
Average Train Accuracy: 0.8519
 Site-Clipart                   (2) | Val  Loss: 0.4716 | Val  Acc: 0.8333
 Site-Real                      (3) | Val  Loss: 0.2426 | Val  Acc: 0.9583
 Site-Painting                  (4) | Val  Loss: 0.4237 | Val  Acc: 0.8631
 Site-Sketch                    (2) | Val  Loss: 0.5171 | Val  Acc: 0.8155
 Site-QuickDraw                 (1) | Val  Loss: 0.8337 | Val  Acc: 0.7560
 Site-Infograph                 (0) | Val  Loss: 1.1392 | Val  Acc: 0.7083
Average Valid Accuracy: 0.8224
============ Train epoch 22 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (3) | Train Loss: 0.4239 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2894 | Train Acc: 0.9325
 Site-Painting                  (4) | Train Loss: 0.4343 | Train Acc: 0.8849
 Site-Sketch                    (3) | Train Loss: 0.5048 | Train Acc: 0.8611
 Site-QuickDraw                 (1) | Train Loss: 0.7245 | Train Acc: 0.8254
 Site-Infograph                 (2) | Train Loss: 0.8236 | Train Acc: 0.7738
Average Train Accuracy: 0.8664
 Site-Clipart                   (3) | Val  Loss: 0.4435 | Val  Acc: 0.8750
 Site-Real                      (0) | Val  Loss: 0.2498 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.4292 | Val  Acc: 0.8512
 Site-Sketch                    (3) | Val  Loss: 0.5187 | Val  Acc: 0.7976
 Site-QuickDraw                 (1) | Val  Loss: 0.8372 | Val  Acc: 0.7500
 Site-Infograph                 (2) | Val  Loss: 1.1325 | Val  Acc: 0.7321
Average Valid Accuracy: 0.8264
============ Train epoch 23 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (4) | Train Loss: 0.3980 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2852 | Train Acc: 0.9365
 Site-Painting                  (3) | Train Loss: 0.4183 | Train Acc: 0.8730
 Site-Sketch                    (2) | Train Loss: 0.4459 | Train Acc: 0.8690
 Site-QuickDraw                 (1) | Train Loss: 0.7177 | Train Acc: 0.7937
 Site-Infograph                 (0) | Train Loss: 0.8425 | Train Acc: 0.7659
Average Train Accuracy: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.3917 | Val  Acc: 0.8929
 Site-Real                      (3) | Val  Loss: 0.2063 | Val  Acc: 0.9762
 Site-Painting                  (3) | Val  Loss: 0.3992 | Val  Acc: 0.8631
 Site-Sketch                    (2) | Val  Loss: 0.5199 | Val  Acc: 0.8333
 Site-QuickDraw                 (1) | Val  Loss: 0.8335 | Val  Acc: 0.7321
 Site-Infograph                 (0) | Val  Loss: 1.0779 | Val  Acc: 0.7440
Average Valid Accuracy: 0.8403
============ Train epoch 24 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (2) | Train Loss: 0.3989 | Train Acc: 0.8929
 Site-Real                      (3) | Train Loss: 0.2858 | Train Acc: 0.9325
 Site-Painting                  (3) | Train Loss: 0.4170 | Train Acc: 0.8730
 Site-Sketch                    (4) | Train Loss: 0.4508 | Train Acc: 0.8571
 Site-QuickDraw                 (1) | Train Loss: 0.7179 | Train Acc: 0.7857
 Site-Infograph                 (0) | Train Loss: 0.8174 | Train Acc: 0.7738
Average Train Accuracy: 0.8525
 Site-Clipart                   (2) | Val  Loss: 0.4212 | Val  Acc: 0.8929
 Site-Real                      (3) | Val  Loss: 0.2181 | Val  Acc: 0.9643
 Site-Painting                  (3) | Val  Loss: 0.4075 | Val  Acc: 0.8810
 Site-Sketch                    (4) | Val  Loss: 0.5149 | Val  Acc: 0.8274
 Site-QuickDraw                 (1) | Val  Loss: 0.8579 | Val  Acc: 0.7440
 Site-Infograph                 (0) | Val  Loss: 1.1035 | Val  Acc: 0.7440
Average Valid Accuracy: 0.8423
============ Train epoch 25 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (4) | Train Loss: 0.3956 | Train Acc: 0.9008
 Site-Real                      (2) | Train Loss: 0.2816 | Train Acc: 0.9325
 Site-Painting                  (2) | Train Loss: 0.3886 | Train Acc: 0.8730
 Site-Sketch                    (0) | Train Loss: 0.4454 | Train Acc: 0.8452
 Site-QuickDraw                 (1) | Train Loss: 0.6873 | Train Acc: 0.8175
 Site-Infograph                 (3) | Train Loss: 0.8012 | Train Acc: 0.7698
Average Train Accuracy: 0.8565
 Site-Clipart                   (4) | Val  Loss: 0.4355 | Val  Acc: 0.8929
 Site-Real                      (2) | Val  Loss: 0.2309 | Val  Acc: 0.9643
 Site-Painting                  (2) | Val  Loss: 0.3573 | Val  Acc: 0.8929
 Site-Sketch                    (0) | Val  Loss: 0.4865 | Val  Acc: 0.8214
 Site-QuickDraw                 (1) | Val  Loss: 0.8016 | Val  Acc: 0.7857
 Site-Infograph                 (3) | Val  Loss: 1.0825 | Val  Acc: 0.7321
Average Valid Accuracy: 0.8482
 Best site-Clipart                  (4)  | Epoch:25 | Val Acc: 0.8929
 Best site-Real                     (2)  | Epoch:25 | Val Acc: 0.9643
 Best site-Painting                 (2)  | Epoch:25 | Val Acc: 0.8929
 Best site-Sketch                   (0)  | Epoch:25 | Val Acc: 0.8214
 Best site-QuickDraw                (1)  | Epoch:25 | Val Acc: 0.7857
 Best site-Infograph                (3)  | Epoch:25 | Val Acc: 0.7321
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 26 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (3) | Train Loss: 0.3946 | Train Acc: 0.8889
 Site-Real                      (2) | Train Loss: 0.2782 | Train Acc: 0.9246
 Site-Painting                  (4) | Train Loss: 0.4004 | Train Acc: 0.8810
 Site-Sketch                    (3) | Train Loss: 0.4255 | Train Acc: 0.8849
 Site-QuickDraw                 (1) | Train Loss: 0.6784 | Train Acc: 0.8016
 Site-Infograph                 (0) | Train Loss: 0.7685 | Train Acc: 0.7698
Average Train Accuracy: 0.8585
 Site-Clipart                   (3) | Val  Loss: 0.4044 | Val  Acc: 0.8929
 Site-Real                      (2) | Val  Loss: 0.2232 | Val  Acc: 0.9702
 Site-Painting                  (4) | Val  Loss: 0.3402 | Val  Acc: 0.8929
 Site-Sketch                    (3) | Val  Loss: 0.4956 | Val  Acc: 0.8036
 Site-QuickDraw                 (1) | Val  Loss: 0.8058 | Val  Acc: 0.7798
 Site-Infograph                 (0) | Val  Loss: 1.0434 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8482
 Best site-Clipart                  (3)  | Epoch:26 | Val Acc: 0.8929
 Best site-Real                     (2)  | Epoch:26 | Val Acc: 0.9702
 Best site-Painting                 (4)  | Epoch:26 | Val Acc: 0.8929
 Best site-Sketch                   (3)  | Epoch:26 | Val Acc: 0.8036
 Best site-QuickDraw                (1)  | Epoch:26 | Val Acc: 0.7798
 Best site-Infograph                (0)  | Epoch:26 | Val Acc: 0.7500
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (4) | Train Loss: 0.3742 | Train Acc: 0.8929
 Site-Real                      (2) | Train Loss: 0.2833 | Train Acc: 0.9127
 Site-Painting                  (2) | Train Loss: 0.4005 | Train Acc: 0.8849
 Site-Sketch                    (0) | Train Loss: 0.4488 | Train Acc: 0.8611
 Site-QuickDraw                 (1) | Train Loss: 0.6388 | Train Acc: 0.8492
 Site-Infograph                 (3) | Train Loss: 0.7472 | Train Acc: 0.7976
Average Train Accuracy: 0.8664
 Site-Clipart                   (4) | Val  Loss: 0.4216 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.2136 | Val  Acc: 0.9643
 Site-Painting                  (2) | Val  Loss: 0.3199 | Val  Acc: 0.8988
 Site-Sketch                    (0) | Val  Loss: 0.4715 | Val  Acc: 0.8155
 Site-QuickDraw                 (1) | Val  Loss: 0.7929 | Val  Acc: 0.7619
 Site-Infograph                 (3) | Val  Loss: 1.0723 | Val  Acc: 0.7262
Average Valid Accuracy: 0.8452
============ Train epoch 28 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (3) | Train Loss: 0.3659 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.2624 | Train Acc: 0.9484
 Site-Painting                  (4) | Train Loss: 0.3794 | Train Acc: 0.8730
 Site-Sketch                    (3) | Train Loss: 0.4290 | Train Acc: 0.8690
 Site-QuickDraw                 (0) | Train Loss: 0.6583 | Train Acc: 0.8294
 Site-Infograph                 (2) | Train Loss: 0.7194 | Train Acc: 0.8016
Average Train Accuracy: 0.8710
 Site-Clipart                   (3) | Val  Loss: 0.3672 | Val  Acc: 0.8929
 Site-Real                      (1) | Val  Loss: 0.2227 | Val  Acc: 0.9583
 Site-Painting                  (4) | Val  Loss: 0.3706 | Val  Acc: 0.9048
 Site-Sketch                    (3) | Val  Loss: 0.4852 | Val  Acc: 0.8512
 Site-QuickDraw                 (0) | Val  Loss: 0.7751 | Val  Acc: 0.7857
 Site-Infograph                 (2) | Val  Loss: 1.0608 | Val  Acc: 0.7440
Average Valid Accuracy: 0.8562
 Best site-Clipart                  (3)  | Epoch:28 | Val Acc: 0.8929
 Best site-Real                     (1)  | Epoch:28 | Val Acc: 0.9583
 Best site-Painting                 (4)  | Epoch:28 | Val Acc: 0.9048
 Best site-Sketch                   (3)  | Epoch:28 | Val Acc: 0.8512
 Best site-QuickDraw                (0)  | Epoch:28 | Val Acc: 0.7857
 Best site-Infograph                (2)  | Epoch:28 | Val Acc: 0.7440
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 29 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (3) | Train Loss: 0.3907 | Train Acc: 0.8929
 Site-Real                      (1) | Train Loss: 0.2568 | Train Acc: 0.9365
 Site-Painting                  (4) | Train Loss: 0.3954 | Train Acc: 0.8690
 Site-Sketch                    (3) | Train Loss: 0.3915 | Train Acc: 0.8770
 Site-QuickDraw                 (0) | Train Loss: 0.6337 | Train Acc: 0.8373
 Site-Infograph                 (2) | Train Loss: 0.6958 | Train Acc: 0.8214
Average Train Accuracy: 0.8724
 Site-Clipart                   (3) | Val  Loss: 0.3695 | Val  Acc: 0.8929
 Site-Real                      (1) | Val  Loss: 0.2057 | Val  Acc: 0.9702
 Site-Painting                  (4) | Val  Loss: 0.3592 | Val  Acc: 0.8929
 Site-Sketch                    (3) | Val  Loss: 0.4214 | Val  Acc: 0.8571
 Site-QuickDraw                 (0) | Val  Loss: 0.7779 | Val  Acc: 0.7857
 Site-Infograph                 (2) | Val  Loss: 1.0432 | Val  Acc: 0.7381
Average Valid Accuracy: 0.8562
============ Train epoch 30 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (3) | Train Loss: 0.3766 | Train Acc: 0.9008
 Site-Real                      (0) | Train Loss: 0.2665 | Train Acc: 0.9325
 Site-Painting                  (4) | Train Loss: 0.3703 | Train Acc: 0.8810
 Site-Sketch                    (3) | Train Loss: 0.4056 | Train Acc: 0.8532
 Site-QuickDraw                 (1) | Train Loss: 0.6493 | Train Acc: 0.8135
 Site-Infograph                 (2) | Train Loss: 0.7126 | Train Acc: 0.8095
Average Train Accuracy: 0.8651
 Site-Clipart                   (3) | Val  Loss: 0.4288 | Val  Acc: 0.8869
 Site-Real                      (0) | Val  Loss: 0.1963 | Val  Acc: 0.9583
 Site-Painting                  (4) | Val  Loss: 0.3605 | Val  Acc: 0.8750
 Site-Sketch                    (3) | Val  Loss: 0.4130 | Val  Acc: 0.8393
 Site-QuickDraw                 (1) | Val  Loss: 0.7117 | Val  Acc: 0.7976
 Site-Infograph                 (2) | Val  Loss: 1.0563 | Val  Acc: 0.7619
Average Valid Accuracy: 0.8532
============ Train epoch 31 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (2) | Train Loss: 0.3426 | Train Acc: 0.9087
 Site-Real                      (3) | Train Loss: 0.2523 | Train Acc: 0.9444
 Site-Painting                  (3) | Train Loss: 0.3655 | Train Acc: 0.8849
 Site-Sketch                    (4) | Train Loss: 0.4197 | Train Acc: 0.8651
 Site-QuickDraw                 (1) | Train Loss: 0.6138 | Train Acc: 0.8571
 Site-Infograph                 (0) | Train Loss: 0.6994 | Train Acc: 0.8175
Average Train Accuracy: 0.8796
 Site-Clipart                   (2) | Val  Loss: 0.3542 | Val  Acc: 0.9226
 Site-Real                      (3) | Val  Loss: 0.1765 | Val  Acc: 0.9702
 Site-Painting                  (3) | Val  Loss: 0.3378 | Val  Acc: 0.8869
 Site-Sketch                    (4) | Val  Loss: 0.4811 | Val  Acc: 0.7976
 Site-QuickDraw                 (1) | Val  Loss: 0.7929 | Val  Acc: 0.7560
 Site-Infograph                 (0) | Val  Loss: 1.0687 | Val  Acc: 0.7619
Average Valid Accuracy: 0.8492
============ Train epoch 32 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (2) | Train Loss: 0.4138 | Train Acc: 0.8730
 Site-Real                      (3) | Train Loss: 0.2465 | Train Acc: 0.9325
 Site-Painting                  (3) | Train Loss: 0.3749 | Train Acc: 0.8730
 Site-Sketch                    (4) | Train Loss: 0.4177 | Train Acc: 0.8651
 Site-QuickDraw                 (1) | Train Loss: 0.6193 | Train Acc: 0.8095
 Site-Infograph                 (0) | Train Loss: 0.6854 | Train Acc: 0.8333
Average Train Accuracy: 0.8644
 Site-Clipart                   (2) | Val  Loss: 0.4092 | Val  Acc: 0.8929
 Site-Real                      (3) | Val  Loss: 0.2018 | Val  Acc: 0.9702
 Site-Painting                  (3) | Val  Loss: 0.3535 | Val  Acc: 0.8929
 Site-Sketch                    (4) | Val  Loss: 0.4506 | Val  Acc: 0.8155
 Site-QuickDraw                 (1) | Val  Loss: 0.7217 | Val  Acc: 0.8036
 Site-Infograph                 (0) | Val  Loss: 1.0839 | Val  Acc: 0.7619
Average Valid Accuracy: 0.8562
============ Train epoch 33 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (4) | Train Loss: 0.3568 | Train Acc: 0.9048
 Site-Real                      (0) | Train Loss: 0.2408 | Train Acc: 0.9444
 Site-Painting                  (0) | Train Loss: 0.3525 | Train Acc: 0.8849
 Site-Sketch                    (3) | Train Loss: 0.4380 | Train Acc: 0.8849
 Site-QuickDraw                 (1) | Train Loss: 0.6155 | Train Acc: 0.8333
 Site-Infograph                 (2) | Train Loss: 0.6688 | Train Acc: 0.8294
Average Train Accuracy: 0.8803
 Site-Clipart                   (4) | Val  Loss: 0.3574 | Val  Acc: 0.9167
 Site-Real                      (0) | Val  Loss: 0.1696 | Val  Acc: 0.9702
 Site-Painting                  (0) | Val  Loss: 0.2998 | Val  Acc: 0.9048
 Site-Sketch                    (3) | Val  Loss: 0.4039 | Val  Acc: 0.8690
 Site-QuickDraw                 (1) | Val  Loss: 0.6853 | Val  Acc: 0.8214
 Site-Infograph                 (2) | Val  Loss: 1.0629 | Val  Acc: 0.7798
Average Valid Accuracy: 0.8770
 Best site-Clipart                  (4)  | Epoch:33 | Val Acc: 0.9167
 Best site-Real                     (0)  | Epoch:33 | Val Acc: 0.9702
 Best site-Painting                 (0)  | Epoch:33 | Val Acc: 0.9048
 Best site-Sketch                   (3)  | Epoch:33 | Val Acc: 0.8690
 Best site-QuickDraw                (1)  | Epoch:33 | Val Acc: 0.8214
 Best site-Infograph                (2)  | Epoch:33 | Val Acc: 0.7798
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 34 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (2) | Train Loss: 0.3796 | Train Acc: 0.8929
 Site-Real                      (0) | Train Loss: 0.2586 | Train Acc: 0.9365
 Site-Painting                  (0) | Train Loss: 0.3745 | Train Acc: 0.8849
 Site-Sketch                    (4) | Train Loss: 0.3454 | Train Acc: 0.9087
 Site-QuickDraw                 (1) | Train Loss: 0.6054 | Train Acc: 0.8333
 Site-Infograph                 (3) | Train Loss: 0.6243 | Train Acc: 0.8571
Average Train Accuracy: 0.8856
 Site-Clipart                   (2) | Val  Loss: 0.3708 | Val  Acc: 0.8988
 Site-Real                      (0) | Val  Loss: 0.1714 | Val  Acc: 0.9702
 Site-Painting                  (0) | Val  Loss: 0.3355 | Val  Acc: 0.8988
 Site-Sketch                    (4) | Val  Loss: 0.4139 | Val  Acc: 0.8452
 Site-QuickDraw                 (1) | Val  Loss: 0.7225 | Val  Acc: 0.8036
 Site-Infograph                 (3) | Val  Loss: 1.0810 | Val  Acc: 0.7738
Average Valid Accuracy: 0.8651
============ Train epoch 35 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (4) | Train Loss: 0.3743 | Train Acc: 0.9008
 Site-Real                      (0) | Train Loss: 0.2461 | Train Acc: 0.9405
 Site-Painting                  (0) | Train Loss: 0.3431 | Train Acc: 0.8690
 Site-Sketch                    (1) | Train Loss: 0.3698 | Train Acc: 0.8611
 Site-QuickDraw                 (2) | Train Loss: 0.5328 | Train Acc: 0.8571
 Site-Infograph                 (3) | Train Loss: 0.6258 | Train Acc: 0.8373
Average Train Accuracy: 0.8776
 Site-Clipart                   (4) | Val  Loss: 0.3678 | Val  Acc: 0.8750
 Site-Real                      (0) | Val  Loss: 0.1695 | Val  Acc: 0.9702
 Site-Painting                  (0) | Val  Loss: 0.3000 | Val  Acc: 0.9107
 Site-Sketch                    (1) | Val  Loss: 0.4276 | Val  Acc: 0.8571
 Site-QuickDraw                 (2) | Val  Loss: 0.7094 | Val  Acc: 0.8036
 Site-Infograph                 (3) | Val  Loss: 1.1019 | Val  Acc: 0.7560
Average Valid Accuracy: 0.8621
============ Train epoch 36 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (2) | Train Loss: 0.3563 | Train Acc: 0.9008
 Site-Real                      (3) | Train Loss: 0.2078 | Train Acc: 0.9524
 Site-Painting                  (3) | Train Loss: 0.3326 | Train Acc: 0.9008
 Site-Sketch                    (4) | Train Loss: 0.3922 | Train Acc: 0.8651
 Site-QuickDraw                 (1) | Train Loss: 0.5796 | Train Acc: 0.8492
 Site-Infograph                 (0) | Train Loss: 0.5885 | Train Acc: 0.8492
Average Train Accuracy: 0.8862
 Site-Clipart                   (2) | Val  Loss: 0.3569 | Val  Acc: 0.9107
 Site-Real                      (3) | Val  Loss: 0.1869 | Val  Acc: 0.9643
 Site-Painting                  (3) | Val  Loss: 0.3525 | Val  Acc: 0.8869
 Site-Sketch                    (4) | Val  Loss: 0.4156 | Val  Acc: 0.8333
 Site-QuickDraw                 (1) | Val  Loss: 0.6755 | Val  Acc: 0.8333
 Site-Infograph                 (0) | Val  Loss: 1.0372 | Val  Acc: 0.7976
Average Valid Accuracy: 0.8710
============ Train epoch 37 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (2) | Train Loss: 0.3397 | Train Acc: 0.9008
 Site-Real                      (4) | Train Loss: 0.2305 | Train Acc: 0.9365
 Site-Painting                  (0) | Train Loss: 0.3372 | Train Acc: 0.8968
 Site-Sketch                    (2) | Train Loss: 0.3716 | Train Acc: 0.8849
 Site-QuickDraw                 (1) | Train Loss: 0.5473 | Train Acc: 0.8730
 Site-Infograph                 (3) | Train Loss: 0.5951 | Train Acc: 0.8571
Average Train Accuracy: 0.8915
 Site-Clipart                   (2) | Val  Loss: 0.3922 | Val  Acc: 0.8869
 Site-Real                      (4) | Val  Loss: 0.1674 | Val  Acc: 0.9762
 Site-Painting                  (0) | Val  Loss: 0.3596 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.3959 | Val  Acc: 0.8750
 Site-QuickDraw                 (1) | Val  Loss: 0.7178 | Val  Acc: 0.8274
 Site-Infograph                 (3) | Val  Loss: 0.9914 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8800
 Best site-Clipart                  (2)  | Epoch:37 | Val Acc: 0.8869
 Best site-Real                     (4)  | Epoch:37 | Val Acc: 0.9762
 Best site-Painting                 (0)  | Epoch:37 | Val Acc: 0.9048
 Best site-Sketch                   (2)  | Epoch:37 | Val Acc: 0.8750
 Best site-QuickDraw                (1)  | Epoch:37 | Val Acc: 0.8274
 Best site-Infograph                (3)  | Epoch:37 | Val Acc: 0.8095
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 38 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (3) | Train Loss: 0.2990 | Train Acc: 0.9246
 Site-Real                      (1) | Train Loss: 0.2275 | Train Acc: 0.9444
 Site-Painting                  (4) | Train Loss: 0.2997 | Train Acc: 0.9087
 Site-Sketch                    (3) | Train Loss: 0.3194 | Train Acc: 0.8889
 Site-QuickDraw                 (0) | Train Loss: 0.5820 | Train Acc: 0.8373
 Site-Infograph                 (2) | Train Loss: 0.5917 | Train Acc: 0.8532
Average Train Accuracy: 0.8929
 Site-Clipart                   (3) | Val  Loss: 0.3349 | Val  Acc: 0.8988
 Site-Real                      (1) | Val  Loss: 0.1897 | Val  Acc: 0.9643
 Site-Painting                  (4) | Val  Loss: 0.2670 | Val  Acc: 0.9226
 Site-Sketch                    (3) | Val  Loss: 0.3994 | Val  Acc: 0.8810
 Site-QuickDraw                 (0) | Val  Loss: 0.6661 | Val  Acc: 0.7798
 Site-Infograph                 (2) | Val  Loss: 1.0458 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8720
============ Train epoch 39 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (4) | Train Loss: 0.3026 | Train Acc: 0.9167
 Site-Real                      (2) | Train Loss: 0.2281 | Train Acc: 0.9405
 Site-Painting                  (2) | Train Loss: 0.3133 | Train Acc: 0.8968
 Site-Sketch                    (0) | Train Loss: 0.3363 | Train Acc: 0.8889
 Site-QuickDraw                 (1) | Train Loss: 0.5533 | Train Acc: 0.8373
 Site-Infograph                 (3) | Train Loss: 0.5915 | Train Acc: 0.8532
Average Train Accuracy: 0.8889
 Site-Clipart                   (4) | Val  Loss: 0.3362 | Val  Acc: 0.9226
 Site-Real                      (2) | Val  Loss: 0.1823 | Val  Acc: 0.9643
 Site-Painting                  (2) | Val  Loss: 0.2733 | Val  Acc: 0.9107
 Site-Sketch                    (0) | Val  Loss: 0.4532 | Val  Acc: 0.8512
 Site-QuickDraw                 (1) | Val  Loss: 0.6441 | Val  Acc: 0.8214
 Site-Infograph                 (3) | Val  Loss: 1.1072 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8700
============ Train epoch 40 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (1) | Train Loss: 0.3212 | Train Acc: 0.9325
 Site-Real                      (3) | Train Loss: 0.2150 | Train Acc: 0.9484
 Site-Painting                  (3) | Train Loss: 0.3042 | Train Acc: 0.9127
 Site-Sketch                    (4) | Train Loss: 0.3316 | Train Acc: 0.9008
 Site-QuickDraw                 (0) | Train Loss: 0.5480 | Train Acc: 0.8571
 Site-Infograph                 (2) | Train Loss: 0.5712 | Train Acc: 0.8730
Average Train Accuracy: 0.9041
 Site-Clipart                   (1) | Val  Loss: 0.4033 | Val  Acc: 0.8929
 Site-Real                      (3) | Val  Loss: 0.2109 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.3151 | Val  Acc: 0.8810
 Site-Sketch                    (4) | Val  Loss: 0.4313 | Val  Acc: 0.8095
 Site-QuickDraw                 (0) | Val  Loss: 0.6331 | Val  Acc: 0.8214
 Site-Infograph                 (2) | Val  Loss: 1.0288 | Val  Acc: 0.7679
Average Valid Accuracy: 0.8542
 Test site-Clipart                   (1)| Epoch:37 | Test Acc: 0.8517
 Test site-Real                      (3)| Epoch:37 | Test Acc: 0.9400
 Test site-Painting                  (3)| Epoch:37 | Test Acc: 0.9225
 Test site-Sketch                    (4)| Epoch:37 | Test Acc: 0.8646
 Test site-QuickDraw                 (0)| Epoch:37 | Test Acc: 0.7540
 Test site-Infograph                 (2)| Epoch:37 | Test Acc: 0.5677
Clipart: 0.8517, Real: 0.9400, Painting: 0.9225, Sketch: 0.8646, QuickDraw: 0.7540, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8168, Average Test Accuracy(individual): 0.8168,
domain std=0.1264, cluster std=0.1265, individual std=0.1264, 
Average Test Accuracy: 0.8168
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 41 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (0) | Train Loss: 0.3012 | Train Acc: 0.9246
 Site-Real                      (3) | Train Loss: 0.2238 | Train Acc: 0.9405
 Site-Painting                  (3) | Train Loss: 0.3003 | Train Acc: 0.9167
 Site-Sketch                    (4) | Train Loss: 0.3190 | Train Acc: 0.9127
 Site-QuickDraw                 (1) | Train Loss: 0.5192 | Train Acc: 0.8571
 Site-Infograph                 (2) | Train Loss: 0.5669 | Train Acc: 0.8730
Average Train Accuracy: 0.9041
 Site-Clipart                   (0) | Val  Loss: 0.3475 | Val  Acc: 0.8988
 Site-Real                      (3) | Val  Loss: 0.1645 | Val  Acc: 0.9762
 Site-Painting                  (3) | Val  Loss: 0.2744 | Val  Acc: 0.9048
 Site-Sketch                    (4) | Val  Loss: 0.4166 | Val  Acc: 0.8393
 Site-QuickDraw                 (1) | Val  Loss: 0.7140 | Val  Acc: 0.7738
 Site-Infograph                 (2) | Val  Loss: 1.0669 | Val  Acc: 0.7679
Average Valid Accuracy: 0.8601
 Test site-Clipart                   (0)| Epoch:40 | Test Acc: 0.8517
 Test site-Real                      (3)| Epoch:40 | Test Acc: 0.9417
 Test site-Painting                  (3)| Epoch:40 | Test Acc: 0.9273
 Test site-Sketch                    (4)| Epoch:40 | Test Acc: 0.8755
 Test site-QuickDraw                 (1)| Epoch:40 | Test Acc: 0.7550
 Test site-Infograph                 (2)| Epoch:40 | Test Acc: 0.5601
Clipart: 0.8517, Real: 0.9417, Painting: 0.9273, Sketch: 0.8755, QuickDraw: 0.7550, Infograph: 0.5601, 
Average Test Accuracy(group): 0.8185, Average Test Accuracy(individual): 0.8185,
domain std=0.1305, cluster std=0.1311, individual std=0.1305, 
Average Test Accuracy: 0.8185
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (0) | Train Loss: 0.3215 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2200 | Train Acc: 0.9524
 Site-Painting                  (4) | Train Loss: 0.2983 | Train Acc: 0.9008
 Site-Sketch                    (0) | Train Loss: 0.3470 | Train Acc: 0.8929
 Site-QuickDraw                 (1) | Train Loss: 0.5043 | Train Acc: 0.8492
 Site-Infograph                 (2) | Train Loss: 0.5632 | Train Acc: 0.8849
Average Train Accuracy: 0.8975
 Site-Clipart                   (0) | Val  Loss: 0.3333 | Val  Acc: 0.9048
 Site-Real                      (3) | Val  Loss: 0.1738 | Val  Acc: 0.9643
 Site-Painting                  (4) | Val  Loss: 0.3041 | Val  Acc: 0.9167
 Site-Sketch                    (0) | Val  Loss: 0.4339 | Val  Acc: 0.8512
 Site-QuickDraw                 (1) | Val  Loss: 0.5911 | Val  Acc: 0.8095
 Site-Infograph                 (2) | Val  Loss: 1.0501 | Val  Acc: 0.7798
Average Valid Accuracy: 0.8710
 Test site-Clipart                   (0)| Epoch:41 | Test Acc: 0.8498
 Test site-Real                      (3)| Epoch:41 | Test Acc: 0.9400
 Test site-Painting                  (4)| Epoch:41 | Test Acc: 0.9257
 Test site-Sketch                    (0)| Epoch:41 | Test Acc: 0.8755
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7540
 Test site-Infograph                 (2)| Epoch:41 | Test Acc: 0.5693
Clipart: 0.8498, Real: 0.9400, Painting: 0.9257, Sketch: 0.8755, QuickDraw: 0.7540, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8190, Average Test Accuracy(individual): 0.8190,
domain std=0.1270, cluster std=0.1372, individual std=0.1270, 
Average Test Accuracy: 0.8190
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (0) | Train Loss: 0.3330 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2319 | Train Acc: 0.9444
 Site-Painting                  (3) | Train Loss: 0.2910 | Train Acc: 0.9127
 Site-Sketch                    (4) | Train Loss: 0.3164 | Train Acc: 0.9167
 Site-QuickDraw                 (1) | Train Loss: 0.5074 | Train Acc: 0.8690
 Site-Infograph                 (2) | Train Loss: 0.5391 | Train Acc: 0.8770
Average Train Accuracy: 0.9041
 Site-Clipart                   (0) | Val  Loss: 0.3340 | Val  Acc: 0.9107
 Site-Real                      (3) | Val  Loss: 0.1478 | Val  Acc: 0.9702
 Site-Painting                  (3) | Val  Loss: 0.2704 | Val  Acc: 0.9226
 Site-Sketch                    (4) | Val  Loss: 0.4309 | Val  Acc: 0.8690
 Site-QuickDraw                 (1) | Val  Loss: 0.6409 | Val  Acc: 0.8214
 Site-Infograph                 (2) | Val  Loss: 1.1089 | Val  Acc: 0.7679
Average Valid Accuracy: 0.8770
 Test site-Clipart                   (0)| Epoch:42 | Test Acc: 0.8536
 Test site-Real                      (3)| Epoch:42 | Test Acc: 0.9408
 Test site-Painting                  (3)| Epoch:42 | Test Acc: 0.9257
 Test site-Sketch                    (4)| Epoch:42 | Test Acc: 0.8773
 Test site-QuickDraw                 (1)| Epoch:42 | Test Acc: 0.7640
 Test site-Infograph                 (2)| Epoch:42 | Test Acc: 0.5662
Clipart: 0.8536, Real: 0.9408, Painting: 0.9257, Sketch: 0.8773, QuickDraw: 0.7640, Infograph: 0.5662, 
Average Test Accuracy(group): 0.8213, Average Test Accuracy(individual): 0.8213,
domain std=0.1276, cluster std=0.1285, individual std=0.1276, 
Average Test Accuracy: 0.8213
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (4) | Train Loss: 0.2850 | Train Acc: 0.9365
 Site-Real                      (0) | Train Loss: 0.2161 | Train Acc: 0.9444
 Site-Painting                  (0) | Train Loss: 0.2719 | Train Acc: 0.9206
 Site-Sketch                    (3) | Train Loss: 0.3299 | Train Acc: 0.9008
 Site-QuickDraw                 (1) | Train Loss: 0.5104 | Train Acc: 0.8651
 Site-Infograph                 (2) | Train Loss: 0.5414 | Train Acc: 0.8690
Average Train Accuracy: 0.9061
 Site-Clipart                   (4) | Val  Loss: 0.3148 | Val  Acc: 0.9226
 Site-Real                      (0) | Val  Loss: 0.1443 | Val  Acc: 0.9762
 Site-Painting                  (0) | Val  Loss: 0.2833 | Val  Acc: 0.9167
 Site-Sketch                    (3) | Val  Loss: 0.4204 | Val  Acc: 0.8512
 Site-QuickDraw                 (1) | Val  Loss: 0.6799 | Val  Acc: 0.8214
 Site-Infograph                 (2) | Val  Loss: 1.0486 | Val  Acc: 0.7738
Average Valid Accuracy: 0.8770
 Test site-Clipart                   (4)| Epoch:43 | Test Acc: 0.8574
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9408
 Test site-Painting                  (0)| Epoch:43 | Test Acc: 0.9241
 Test site-Sketch                    (3)| Epoch:43 | Test Acc: 0.8736
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7580
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.5632
Clipart: 0.8574, Real: 0.9408, Painting: 0.9241, Sketch: 0.8736, QuickDraw: 0.7580, Infograph: 0.5632, 
Average Test Accuracy(group): 0.8195, Average Test Accuracy(individual): 0.8195,
domain std=0.1288, cluster std=0.1297, individual std=0.1288, 
Average Test Accuracy: 0.8195
============ Train epoch 45 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (3) | Train Loss: 0.3264 | Train Acc: 0.8968
 Site-Real                      (4) | Train Loss: 0.2231 | Train Acc: 0.9444
 Site-Painting                  (1) | Train Loss: 0.3037 | Train Acc: 0.9048
 Site-Sketch                    (3) | Train Loss: 0.3338 | Train Acc: 0.9048
 Site-QuickDraw                 (0) | Train Loss: 0.4798 | Train Acc: 0.8849
 Site-Infograph                 (2) | Train Loss: 0.5114 | Train Acc: 0.9048
Average Train Accuracy: 0.9067
 Site-Clipart                   (3) | Val  Loss: 0.3769 | Val  Acc: 0.9048
 Site-Real                      (4) | Val  Loss: 0.1678 | Val  Acc: 0.9702
 Site-Painting                  (1) | Val  Loss: 0.2799 | Val  Acc: 0.9107
 Site-Sketch                    (3) | Val  Loss: 0.3955 | Val  Acc: 0.8452
 Site-QuickDraw                 (0) | Val  Loss: 0.6035 | Val  Acc: 0.8333
 Site-Infograph                 (2) | Val  Loss: 0.9962 | Val  Acc: 0.7976
Average Valid Accuracy: 0.8770
 Test site-Clipart                   (3)| Epoch:43 | Test Acc: 0.8517
 Test site-Real                      (4)| Epoch:43 | Test Acc: 0.9400
 Test site-Painting                  (1)| Epoch:43 | Test Acc: 0.9273
 Test site-Sketch                    (3)| Epoch:43 | Test Acc: 0.8736
 Test site-QuickDraw                 (0)| Epoch:43 | Test Acc: 0.7680
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.5677
Clipart: 0.8517, Real: 0.9400, Painting: 0.9273, Sketch: 0.8736, QuickDraw: 0.7680, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8214, Average Test Accuracy(individual): 0.8214,
domain std=0.1266, cluster std=0.1370, individual std=0.1266, 
Average Test Accuracy: 0.8214
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 1, 1, 2, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (2) | Train Loss: 0.3185 | Train Acc: 0.9167
 Site-Real                      (3) | Train Loss: 0.2304 | Train Acc: 0.9444
 Site-Painting                  (3) | Train Loss: 0.2846 | Train Acc: 0.9167
 Site-Sketch                    (4) | Train Loss: 0.3367 | Train Acc: 0.8770
 Site-QuickDraw                 (1) | Train Loss: 0.4514 | Train Acc: 0.9048
 Site-Infograph                 (0) | Train Loss: 0.5418 | Train Acc: 0.8889
Average Train Accuracy: 0.9081
 Site-Clipart                   (2) | Val  Loss: 0.3216 | Val  Acc: 0.9107
 Site-Real                      (3) | Val  Loss: 0.1548 | Val  Acc: 0.9762
 Site-Painting                  (3) | Val  Loss: 0.2668 | Val  Acc: 0.8988
 Site-Sketch                    (4) | Val  Loss: 0.3932 | Val  Acc: 0.8631
 Site-QuickDraw                 (1) | Val  Loss: 0.6781 | Val  Acc: 0.8214
 Site-Infograph                 (0) | Val  Loss: 1.0849 | Val  Acc: 0.7917
Average Valid Accuracy: 0.8770
 Test site-Clipart                   (2)| Epoch:45 | Test Acc: 0.8574
 Test site-Real                      (3)| Epoch:45 | Test Acc: 0.9400
 Test site-Painting                  (3)| Epoch:45 | Test Acc: 0.9338
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8755
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7670
 Test site-Infograph                 (0)| Epoch:45 | Test Acc: 0.5647
Clipart: 0.8574, Real: 0.9400, Painting: 0.9338, Sketch: 0.8755, QuickDraw: 0.7670, Infograph: 0.5647, 
Average Test Accuracy(group): 0.8231, Average Test Accuracy(individual): 0.8231,
domain std=0.1289, cluster std=0.1298, individual std=0.1289, 
Average Test Accuracy: 0.8231
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 1, 1, 1, 1, ]
cnt=[2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (3) | Train Loss: 0.3000 | Train Acc: 0.9325
 Site-Real                      (0) | Train Loss: 0.2003 | Train Acc: 0.9484
 Site-Painting                  (0) | Train Loss: 0.2617 | Train Acc: 0.9365
 Site-Sketch                    (4) | Train Loss: 0.3428 | Train Acc: 0.8810
 Site-QuickDraw                 (1) | Train Loss: 0.4737 | Train Acc: 0.8929
 Site-Infograph                 (2) | Train Loss: 0.5080 | Train Acc: 0.9167
Average Train Accuracy: 0.9180
 Site-Clipart                   (3) | Val  Loss: 0.3171 | Val  Acc: 0.8988
 Site-Real                      (0) | Val  Loss: 0.1443 | Val  Acc: 0.9762
 Site-Painting                  (0) | Val  Loss: 0.3036 | Val  Acc: 0.9048
 Site-Sketch                    (4) | Val  Loss: 0.4395 | Val  Acc: 0.8274
 Site-QuickDraw                 (1) | Val  Loss: 0.6005 | Val  Acc: 0.8393
 Site-Infograph                 (2) | Val  Loss: 1.1067 | Val  Acc: 0.7976
Average Valid Accuracy: 0.8740
 Test site-Clipart                   (3)| Epoch:46 | Test Acc: 0.8612
 Test site-Real                      (0)| Epoch:46 | Test Acc: 0.9408
 Test site-Painting                  (0)| Epoch:46 | Test Acc: 0.9354
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.8700
 Test site-QuickDraw                 (1)| Epoch:46 | Test Acc: 0.7630
 Test site-Infograph                 (2)| Epoch:46 | Test Acc: 0.5677
Clipart: 0.8612, Real: 0.9408, Painting: 0.9354, Sketch: 0.8700, QuickDraw: 0.7630, Infograph: 0.5677, 
Average Test Accuracy(group): 0.8230, Average Test Accuracy(individual): 0.8230,
domain std=0.1284, cluster std=0.1289, individual std=0.1284, 
Average Test Accuracy: 0.8230
============ Train epoch 48 ============
cnt=[1, 2, 1, 1, 1, ]
cnt=[1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (4) | Train Loss: 0.2835 | Train Acc: 0.9365
 Site-Real                      (1) | Train Loss: 0.1959 | Train Acc: 0.9484
 Site-Painting                  (1) | Train Loss: 0.2950 | Train Acc: 0.8889
 Site-Sketch                    (3) | Train Loss: 0.3089 | Train Acc: 0.9008
 Site-QuickDraw                 (0) | Train Loss: 0.4691 | Train Acc: 0.8810
 Site-Infograph                 (2) | Train Loss: 0.5124 | Train Acc: 0.8889
Average Train Accuracy: 0.9074
 Site-Clipart                   (4) | Val  Loss: 0.2746 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.1434 | Val  Acc: 0.9702
 Site-Painting                  (1) | Val  Loss: 0.2870 | Val  Acc: 0.9107
 Site-Sketch                    (3) | Val  Loss: 0.3976 | Val  Acc: 0.8274
 Site-QuickDraw                 (0) | Val  Loss: 0.5728 | Val  Acc: 0.8512
 Site-Infograph                 (2) | Val  Loss: 1.0757 | Val  Acc: 0.7976
Average Valid Accuracy: 0.8829
 Best site-Clipart                  (4)  | Epoch:48 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:48 | Val Acc: 0.9702
 Best site-Painting                 (1)  | Epoch:48 | Val Acc: 0.9107
 Best site-Sketch                   (3)  | Epoch:48 | Val Acc: 0.8274
 Best site-QuickDraw                (0)  | Epoch:48 | Val Acc: 0.8512
 Best site-Infograph                (2)  | Epoch:48 | Val Acc: 0.7976
 Test site-Clipart                   (4)| Epoch:48 | Test Acc: 0.8669
 Test site-Real                      (1)| Epoch:48 | Test Acc: 0.9400
 Test site-Painting                  (1)| Epoch:48 | Test Acc: 0.9321
 Test site-Sketch                    (3)| Epoch:48 | Test Acc: 0.8718
 Test site-QuickDraw                 (0)| Epoch:48 | Test Acc: 0.7610
 Test site-Infograph                 (2)| Epoch:48 | Test Acc: 0.5693
Clipart: 0.8669, Real: 0.9400, Painting: 0.9321, Sketch: 0.8718, QuickDraw: 0.7610, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8235, Average Test Accuracy(individual): 0.8235,
domain std=0.1279, cluster std=0.1288, individual std=0.1279, 
Average Test Accuracy: 0.8235
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_clscon_distinct/ccop_q=1...
============ Train epoch 49 ============
cnt=[1, 1, 2, 1, 1, ]
cnt=[1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (4) | Train Loss: 0.2974 | Train Acc: 0.9246
 Site-Real                      (2) | Train Loss: 0.2076 | Train Acc: 0.9484
 Site-Painting                  (2) | Train Loss: 0.2821 | Train Acc: 0.9246
 Site-Sketch                    (3) | Train Loss: 0.3145 | Train Acc: 0.9008
 Site-QuickDraw                 (1) | Train Loss: 0.4498 | Train Acc: 0.9008
 Site-Infograph                 (0) | Train Loss: 0.5093 | Train Acc: 0.8889
Average Train Accuracy: 0.9147
 Site-Clipart                   (4) | Val  Loss: 0.2985 | Val  Acc: 0.9107
 Site-Real                      (2) | Val  Loss: 0.1389 | Val  Acc: 0.9762
 Site-Painting                  (2) | Val  Loss: 0.2998 | Val  Acc: 0.8988
 Site-Sketch                    (3) | Val  Loss: 0.4062 | Val  Acc: 0.8393
 Site-QuickDraw                 (1) | Val  Loss: 0.6610 | Val  Acc: 0.7798
 Site-Infograph                 (0) | Val  Loss: 0.9913 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8690
 Test site-Clipart                   (4)| Epoch:48 | Test Acc: 0.8631
 Test site-Real                      (2)| Epoch:48 | Test Acc: 0.9384
 Test site-Painting                  (2)| Epoch:48 | Test Acc: 0.9257
 Test site-Sketch                    (3)| Epoch:48 | Test Acc: 0.8718
 Test site-QuickDraw                 (1)| Epoch:48 | Test Acc: 0.7630
 Test site-Infograph                 (0)| Epoch:48 | Test Acc: 0.5693
Clipart: 0.8631, Real: 0.9384, Painting: 0.9257, Sketch: 0.8718, QuickDraw: 0.7630, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8219, Average Test Accuracy(individual): 0.8219,
domain std=0.1264, cluster std=0.1274, individual std=0.1264, 
Average Test Accuracy: 0.8219
===2023-07-03 23:52:22===
===2023-07-03 23:52:23===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[252,252,252,252,252,252,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:48 | Test Acc: 0.8669
 Test site-Real                      | Epoch:48 | Test Acc: 0.9400
 Test site-Painting                  | Epoch:48 | Test Acc: 0.9321
 Test site-Sketch                    | Epoch:48 | Test Acc: 0.8718
 Test site-QuickDraw                 | Epoch:48 | Test Acc: 0.7610
 Test site-Infograph                 | Epoch:48 | Test Acc: 0.5693
Clipart: 0.8669, Real: 0.9400, Painting: 0.9321, Sketch: 0.8718, QuickDraw: 0.7610, Infograph: 0.5693, 
Average Test Accuracy(group): 0.8235, Average Test Accuracy(individual): 0.8235,
domain std=0.1279, cluster std=-1.0000, individual std=0.1279, 
