===2023-08-07 10:37:53===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (0) | Train Loss: 1.8995 | Train Acc: 0.1429
 Site-photo                     (0) | Train Loss: 1.7820 | Train Acc: 0.3889
 Site-photo                     (0) | Train Loss: 1.7170 | Train Acc: 0.2917
 Site-photo                     (0) | Train Loss: 1.6573 | Train Acc: 0.5161
 Site-photo                     (0) | Train Loss: 1.7674 | Train Acc: 0.3000
 Site-photo                     (0) | Train Loss: 1.7652 | Train Acc: 0.3269
 Site-photo                     (0) | Train Loss: 1.5944 | Train Acc: 0.5294
 Site-photo                     (0) | Train Loss: 1.6861 | Train Acc: 0.4205
 Site-photo                     (0) | Train Loss: 1.6968 | Train Acc: 0.4248
 Site-photo                     (0) | Train Loss: 1.7747 | Train Acc: 0.3425
 Site-art_painting              (2) | Train Loss: 1.8106 | Train Acc: 0.4167
 Site-art_painting              (2) | Train Loss: 1.7839 | Train Acc: 0.3182
 Site-art_painting              (2) | Train Loss: 1.9499 | Train Acc: 0.2250
 Site-art_painting              (2) | Train Loss: 2.0031 | Train Acc: 0.1528
 Site-art_painting              (2) | Train Loss: 1.8656 | Train Acc: 0.2812
 Site-cartoon                   (3) | Train Loss: 1.8688 | Train Acc: 0.2727
 Site-cartoon                   (3) | Train Loss: 1.8914 | Train Acc: 0.2087
 Site-sketch                    (1) | Train Loss: 1.9540 | Train Acc: 0.2069
Average Train Accuracy: 0.3203
 Site-photo                     (0) | Val  Loss: 1.7900 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7503 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7375 | Val  Acc: 0.3125
 Site-photo                     (0) | Val  Loss: 1.7571 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7398 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7356 | Val  Acc: 0.4000
 Site-photo                     (0) | Val  Loss: 1.6118 | Val  Acc: 0.4222
 Site-photo                     (0) | Val  Loss: 1.6694 | Val  Acc: 0.4310
 Site-photo                     (0) | Val  Loss: 1.7507 | Val  Acc: 0.4533
 Site-photo                     (0) | Val  Loss: 1.7079 | Val  Acc: 0.3918
 Site-art_painting              (2) | Val  Loss: 2.0499 | Val  Acc: 0.1250
 Site-art_painting              (2) | Val  Loss: 1.8044 | Val  Acc: 0.3333
 Site-art_painting              (2) | Val  Loss: 1.6685 | Val  Acc: 0.3462
 Site-art_painting              (2) | Val  Loss: 1.9233 | Val  Acc: 0.1915
 Site-art_painting              (2) | Val  Loss: 1.9554 | Val  Acc: 0.2000
 Site-cartoon                   (3) | Val  Loss: 1.9725 | Val  Acc: 0.1429
 Site-cartoon                   (3) | Val  Loss: 1.8865 | Val  Acc: 0.1948
 Site-sketch                    (1) | Val  Loss: 1.9095 | Val  Acc: 0.2308
Average Valid Accuracy: 0.3060
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3125
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4000
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4222
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4310
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4533
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3918
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.1250
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.3462
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.1915
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.2000
 Best site-cartoon                  (3)  | Epoch:0 | Val Acc: 0.1429
 Best site-cartoon                  (3)  | Epoch:0 | Val Acc: 0.1948
 Best site-sketch                   (1)  | Epoch:0 | Val Acc: 0.2308
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (0) | Train Loss: 1.7895 | Train Acc: 0.3571
 Site-photo                     (0) | Train Loss: 1.5997 | Train Acc: 0.6111
 Site-photo                     (0) | Train Loss: 1.6274 | Train Acc: 0.3333
 Site-photo                     (0) | Train Loss: 1.5473 | Train Acc: 0.5806
 Site-photo                     (0) | Train Loss: 1.5920 | Train Acc: 0.4000
 Site-photo                     (0) | Train Loss: 1.5914 | Train Acc: 0.4615
 Site-photo                     (0) | Train Loss: 1.3751 | Train Acc: 0.5000
 Site-photo                     (0) | Train Loss: 1.5725 | Train Acc: 0.4773
 Site-photo                     (0) | Train Loss: 1.5820 | Train Acc: 0.4867
 Site-photo                     (0) | Train Loss: 1.6638 | Train Acc: 0.4315
 Site-art_painting              (2) | Train Loss: 1.6602 | Train Acc: 0.4167
 Site-art_painting              (2) | Train Loss: 1.7062 | Train Acc: 0.3182
 Site-art_painting              (2) | Train Loss: 1.9715 | Train Acc: 0.1750
 Site-art_painting              (2) | Train Loss: 1.7008 | Train Acc: 0.2500
 Site-art_painting              (2) | Train Loss: 1.7619 | Train Acc: 0.2969
 Site-cartoon                   (1) | Train Loss: 1.8199 | Train Acc: 0.2727
 Site-cartoon                   (1) | Train Loss: 1.8864 | Train Acc: 0.2174
 Site-sketch                    (3) | Train Loss: 1.9483 | Train Acc: 0.1897
Average Train Accuracy: 0.3764
 Site-photo                     (0) | Val  Loss: 1.6913 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.6674 | Val  Acc: 0.4167
 Site-photo                     (0) | Val  Loss: 1.6042 | Val  Acc: 0.5625
 Site-photo                     (0) | Val  Loss: 1.6035 | Val  Acc: 0.5238
 Site-photo                     (0) | Val  Loss: 1.5648 | Val  Acc: 0.4074
 Site-photo                     (0) | Val  Loss: 1.6550 | Val  Acc: 0.4571
 Site-photo                     (0) | Val  Loss: 1.4937 | Val  Acc: 0.5333
 Site-photo                     (0) | Val  Loss: 1.5387 | Val  Acc: 0.5172
 Site-photo                     (0) | Val  Loss: 1.6043 | Val  Acc: 0.5333
 Site-photo                     (0) | Val  Loss: 1.5522 | Val  Acc: 0.4948
 Site-art_painting              (2) | Val  Loss: 1.9408 | Val  Acc: 0.2500
 Site-art_painting              (2) | Val  Loss: 1.6787 | Val  Acc: 0.3333
 Site-art_painting              (2) | Val  Loss: 1.6493 | Val  Acc: 0.3077
 Site-art_painting              (2) | Val  Loss: 1.7727 | Val  Acc: 0.2766
 Site-art_painting              (2) | Val  Loss: 1.8156 | Val  Acc: 0.2353
 Site-cartoon                   (1) | Val  Loss: 1.8954 | Val  Acc: 0.1429
 Site-cartoon                   (1) | Val  Loss: 1.9074 | Val  Acc: 0.2338
 Site-sketch                    (3) | Val  Loss: 1.9181 | Val  Acc: 0.1795
Average Valid Accuracy: 0.3744
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.4167
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.5625
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.5238
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.4074
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.4571
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.5333
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.5172
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.5333
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.4948
 Best site-art_painting             (2)  | Epoch:1 | Val Acc: 0.2500
 Best site-art_painting             (2)  | Epoch:1 | Val Acc: 0.3333
 Best site-art_painting             (2)  | Epoch:1 | Val Acc: 0.3077
 Best site-art_painting             (2)  | Epoch:1 | Val Acc: 0.2766
 Best site-art_painting             (2)  | Epoch:1 | Val Acc: 0.2353
 Best site-cartoon                  (1)  | Epoch:1 | Val Acc: 0.1429
 Best site-cartoon                  (1)  | Epoch:1 | Val Acc: 0.2338
 Best site-sketch                   (3)  | Epoch:1 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (1) | Train Loss: 1.7184 | Train Acc: 0.4286
 Site-photo                     (1) | Train Loss: 1.4646 | Train Acc: 0.6111
 Site-photo                     (1) | Train Loss: 1.5132 | Train Acc: 0.4583
 Site-photo                     (1) | Train Loss: 1.4296 | Train Acc: 0.5806
 Site-photo                     (1) | Train Loss: 1.4651 | Train Acc: 0.5500
 Site-photo                     (1) | Train Loss: 1.4922 | Train Acc: 0.6346
 Site-photo                     (1) | Train Loss: 1.4730 | Train Acc: 0.6618
 Site-photo                     (1) | Train Loss: 1.4831 | Train Acc: 0.6364
 Site-photo                     (1) | Train Loss: 1.4406 | Train Acc: 0.6106
 Site-photo                     (1) | Train Loss: 1.5147 | Train Acc: 0.5616
 Site-art_painting              (3) | Train Loss: 1.6680 | Train Acc: 0.4167
 Site-art_painting              (3) | Train Loss: 1.7238 | Train Acc: 0.5000
 Site-art_painting              (3) | Train Loss: 1.8371 | Train Acc: 0.3000
 Site-art_painting              (3) | Train Loss: 1.6674 | Train Acc: 0.3333
 Site-art_painting              (3) | Train Loss: 1.7003 | Train Acc: 0.3750
 Site-cartoon                   (0) | Train Loss: 1.6849 | Train Acc: 0.2727
 Site-cartoon                   (0) | Train Loss: 1.8201 | Train Acc: 0.2435
 Site-sketch                    (2) | Train Loss: 1.9147 | Train Acc: 0.2759
Average Train Accuracy: 0.4695
 Site-photo                     (1) | Val  Loss: 1.5270 | Val  Acc: 0.5556
 Site-photo                     (1) | Val  Loss: 1.5252 | Val  Acc: 0.4167
 Site-photo                     (1) | Val  Loss: 1.4603 | Val  Acc: 0.5625
 Site-photo                     (1) | Val  Loss: 1.4893 | Val  Acc: 0.7143
 Site-photo                     (1) | Val  Loss: 1.4602 | Val  Acc: 0.4815
 Site-photo                     (1) | Val  Loss: 1.5270 | Val  Acc: 0.5143
 Site-photo                     (1) | Val  Loss: 1.3847 | Val  Acc: 0.6444
 Site-photo                     (1) | Val  Loss: 1.4231 | Val  Acc: 0.6379
 Site-photo                     (1) | Val  Loss: 1.5103 | Val  Acc: 0.6400
 Site-photo                     (1) | Val  Loss: 1.4115 | Val  Acc: 0.6598
 Site-art_painting              (3) | Val  Loss: 1.8664 | Val  Acc: 0.1250
 Site-art_painting              (3) | Val  Loss: 1.6869 | Val  Acc: 0.2667
 Site-art_painting              (3) | Val  Loss: 1.6011 | Val  Acc: 0.3846
 Site-art_painting              (3) | Val  Loss: 1.6898 | Val  Acc: 0.3617
 Site-art_painting              (3) | Val  Loss: 1.7541 | Val  Acc: 0.3176
 Site-cartoon                   (0) | Val  Loss: 1.7928 | Val  Acc: 0.2857
 Site-cartoon                   (0) | Val  Loss: 1.8078 | Val  Acc: 0.2468
 Site-sketch                    (2) | Val  Loss: 1.9124 | Val  Acc: 0.1795
Average Valid Accuracy: 0.4441
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.5556
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.4167
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.5625
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.7143
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.4815
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.5143
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.6444
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.6379
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.6400
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.6598
 Best site-art_painting             (3)  | Epoch:2 | Val Acc: 0.1250
 Best site-art_painting             (3)  | Epoch:2 | Val Acc: 0.2667
 Best site-art_painting             (3)  | Epoch:2 | Val Acc: 0.3846
 Best site-art_painting             (3)  | Epoch:2 | Val Acc: 0.3617
 Best site-art_painting             (3)  | Epoch:2 | Val Acc: 0.3176
 Best site-cartoon                  (0)  | Epoch:2 | Val Acc: 0.2857
 Best site-cartoon                  (0)  | Epoch:2 | Val Acc: 0.2468
 Best site-sketch                   (2)  | Epoch:2 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (0) | Train Loss: 1.5554 | Train Acc: 0.4286
 Site-photo                     (0) | Train Loss: 1.3691 | Train Acc: 0.7222
 Site-photo                     (0) | Train Loss: 1.3642 | Train Acc: 0.6250
 Site-photo                     (0) | Train Loss: 1.2721 | Train Acc: 0.8065
 Site-photo                     (0) | Train Loss: 1.3212 | Train Acc: 0.7500
 Site-photo                     (0) | Train Loss: 1.3291 | Train Acc: 0.6538
 Site-photo                     (0) | Train Loss: 1.2370 | Train Acc: 0.7794
 Site-photo                     (0) | Train Loss: 1.3044 | Train Acc: 0.7500
 Site-photo                     (0) | Train Loss: 1.3178 | Train Acc: 0.7699
 Site-photo                     (0) | Train Loss: 1.3752 | Train Acc: 0.6712
 Site-art_painting              (1) | Train Loss: 1.6012 | Train Acc: 0.5833
 Site-art_painting              (1) | Train Loss: 1.6560 | Train Acc: 0.5909
 Site-art_painting              (1) | Train Loss: 1.7445 | Train Acc: 0.3000
 Site-art_painting              (1) | Train Loss: 1.5792 | Train Acc: 0.4028
 Site-art_painting              (1) | Train Loss: 1.6443 | Train Acc: 0.4141
 Site-cartoon                   (3) | Train Loss: 1.5870 | Train Acc: 0.5455
 Site-cartoon                   (3) | Train Loss: 1.7345 | Train Acc: 0.3739
 Site-sketch                    (2) | Train Loss: 1.8560 | Train Acc: 0.2931
Average Train Accuracy: 0.5811
 Site-photo                     (0) | Val  Loss: 1.3397 | Val  Acc: 0.6667
 Site-photo                     (0) | Val  Loss: 1.3784 | Val  Acc: 0.5833
 Site-photo                     (0) | Val  Loss: 1.3941 | Val  Acc: 0.6875
 Site-photo                     (0) | Val  Loss: 1.3327 | Val  Acc: 0.7619
 Site-photo                     (0) | Val  Loss: 1.4075 | Val  Acc: 0.6667
 Site-photo                     (0) | Val  Loss: 1.3632 | Val  Acc: 0.6571
 Site-photo                     (0) | Val  Loss: 1.2668 | Val  Acc: 0.7333
 Site-photo                     (0) | Val  Loss: 1.2858 | Val  Acc: 0.7414
 Site-photo                     (0) | Val  Loss: 1.3129 | Val  Acc: 0.7600
 Site-photo                     (0) | Val  Loss: 1.2393 | Val  Acc: 0.7732
 Site-art_painting              (1) | Val  Loss: 1.8263 | Val  Acc: 0.2500
 Site-art_painting              (1) | Val  Loss: 1.6847 | Val  Acc: 0.3333
 Site-art_painting              (1) | Val  Loss: 1.5728 | Val  Acc: 0.3462
 Site-art_painting              (1) | Val  Loss: 1.6418 | Val  Acc: 0.5319
 Site-art_painting              (1) | Val  Loss: 1.6880 | Val  Acc: 0.4235
 Site-cartoon                   (3) | Val  Loss: 1.7936 | Val  Acc: 0.0000
 Site-cartoon                   (3) | Val  Loss: 1.7510 | Val  Acc: 0.2857
 Site-sketch                    (2) | Val  Loss: 1.8993 | Val  Acc: 0.1795
Average Valid Accuracy: 0.5212
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.5833
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.6875
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7619
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.6571
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7333
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7414
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7600
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7732
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.2500
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.3333
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.3462
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.5319
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.4235
 Best site-cartoon                  (3)  | Epoch:3 | Val Acc: 0.0000
 Best site-cartoon                  (3)  | Epoch:3 | Val Acc: 0.2857
 Best site-sketch                   (2)  | Epoch:3 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 10, 5, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (1) | Train Loss: 1.3940 | Train Acc: 0.7857
 Site-photo                     (1) | Train Loss: 1.2247 | Train Acc: 0.8333
 Site-photo                     (1) | Train Loss: 1.2304 | Train Acc: 0.7917
 Site-photo                     (1) | Train Loss: 1.1301 | Train Acc: 0.9032
 Site-photo                     (1) | Train Loss: 1.2032 | Train Acc: 0.8750
 Site-photo                     (1) | Train Loss: 1.1592 | Train Acc: 0.8846
 Site-photo                     (1) | Train Loss: 1.1108 | Train Acc: 0.8529
 Site-photo                     (1) | Train Loss: 1.1602 | Train Acc: 0.8636
 Site-photo                     (1) | Train Loss: 1.1945 | Train Acc: 0.8584
 Site-photo                     (1) | Train Loss: 1.1602 | Train Acc: 0.8562
 Site-art_painting              (2) | Train Loss: 1.6552 | Train Acc: 0.4167
 Site-art_painting              (2) | Train Loss: 1.5569 | Train Acc: 0.6364
 Site-art_painting              (2) | Train Loss: 1.6696 | Train Acc: 0.3500
 Site-art_painting              (2) | Train Loss: 1.5894 | Train Acc: 0.5139
 Site-art_painting              (2) | Train Loss: 1.5345 | Train Acc: 0.5000
 Site-cartoon                   (0) | Train Loss: 1.5340 | Train Acc: 0.6364
 Site-cartoon                   (0) | Train Loss: 1.6951 | Train Acc: 0.3391
 Site-sketch                    (3) | Train Loss: 1.8504 | Train Acc: 0.2069
Average Train Accuracy: 0.6724
 Site-photo                     (1) | Val  Loss: 1.2614 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 1.2331 | Val  Acc: 0.8333
 Site-photo                     (1) | Val  Loss: 1.2088 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 1.2469 | Val  Acc: 0.8095
 Site-photo                     (1) | Val  Loss: 1.2582 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 1.2267 | Val  Acc: 0.8571
 Site-photo                     (1) | Val  Loss: 1.1157 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.1415 | Val  Acc: 0.8966
 Site-photo                     (1) | Val  Loss: 1.1930 | Val  Acc: 0.8667
 Site-photo                     (1) | Val  Loss: 1.1205 | Val  Acc: 0.9072
 Site-art_painting              (2) | Val  Loss: 1.5625 | Val  Acc: 0.5000
 Site-art_painting              (2) | Val  Loss: 1.6172 | Val  Acc: 0.4667
 Site-art_painting              (2) | Val  Loss: 1.4611 | Val  Acc: 0.5769
 Site-art_painting              (2) | Val  Loss: 1.5414 | Val  Acc: 0.5106
 Site-art_painting              (2) | Val  Loss: 1.5709 | Val  Acc: 0.4353
 Site-cartoon                   (0) | Val  Loss: 1.6954 | Val  Acc: 0.1429
 Site-cartoon                   (0) | Val  Loss: 1.7167 | Val  Acc: 0.4156
 Site-sketch                    (3) | Val  Loss: 1.8722 | Val  Acc: 0.1795
Average Valid Accuracy: 0.6544
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.7778
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8333
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8095
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.7778
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8571
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8966
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8667
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.9072
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.5000
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.4667
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.5769
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.5106
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.4353
 Best site-cartoon                  (0)  | Epoch:4 | Val Acc: 0.1429
 Best site-cartoon                  (0)  | Epoch:4 | Val Acc: 0.4156
 Best site-sketch                   (3)  | Epoch:4 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[5, 10, 1, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (1) | Train Loss: 1.2740 | Train Acc: 0.7857
 Site-photo                     (1) | Train Loss: 1.0314 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 1.1798 | Train Acc: 0.7500
 Site-photo                     (1) | Train Loss: 0.9734 | Train Acc: 0.9032
 Site-photo                     (1) | Train Loss: 1.0486 | Train Acc: 0.9000
 Site-photo                     (1) | Train Loss: 1.0781 | Train Acc: 0.8654
 Site-photo                     (1) | Train Loss: 1.0708 | Train Acc: 0.8824
 Site-photo                     (1) | Train Loss: 1.0440 | Train Acc: 0.9091
 Site-photo                     (1) | Train Loss: 1.0374 | Train Acc: 0.9381
 Site-photo                     (1) | Train Loss: 1.0739 | Train Acc: 0.8904
 Site-art_painting              (0) | Train Loss: 1.4761 | Train Acc: 0.5000
 Site-art_painting              (0) | Train Loss: 1.5271 | Train Acc: 0.5909
 Site-art_painting              (0) | Train Loss: 1.6058 | Train Acc: 0.4250
 Site-art_painting              (0) | Train Loss: 1.4751 | Train Acc: 0.5417
 Site-art_painting              (0) | Train Loss: 1.4493 | Train Acc: 0.5938
 Site-cartoon                   (3) | Train Loss: 1.4872 | Train Acc: 0.5455
 Site-cartoon                   (3) | Train Loss: 1.6573 | Train Acc: 0.3826
 Site-sketch                    (2) | Train Loss: 1.7955 | Train Acc: 0.2414
Average Train Accuracy: 0.6963
 Site-photo                     (1) | Val  Loss: 1.1208 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.1142 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 1.0659 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.1001 | Val  Acc: 0.8571
 Site-photo                     (1) | Val  Loss: 1.1148 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.0892 | Val  Acc: 0.8571
 Site-photo                     (1) | Val  Loss: 0.9609 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 1.0044 | Val  Acc: 0.9310
 Site-photo                     (1) | Val  Loss: 1.0394 | Val  Acc: 0.9200
 Site-photo                     (1) | Val  Loss: 0.9901 | Val  Acc: 0.9381
 Site-art_painting              (0) | Val  Loss: 1.6925 | Val  Acc: 0.2500
 Site-art_painting              (0) | Val  Loss: 1.5227 | Val  Acc: 0.4667
 Site-art_painting              (0) | Val  Loss: 1.3546 | Val  Acc: 0.6923
 Site-art_painting              (0) | Val  Loss: 1.4391 | Val  Acc: 0.5745
 Site-art_painting              (0) | Val  Loss: 1.5001 | Val  Acc: 0.5294
 Site-cartoon                   (3) | Val  Loss: 1.5168 | Val  Acc: 0.4286
 Site-cartoon                   (3) | Val  Loss: 1.6267 | Val  Acc: 0.3896
 Site-sketch                    (2) | Val  Loss: 1.8225 | Val  Acc: 0.3077
Average Valid Accuracy: 0.7107
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8571
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8571
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9310
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9200
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9381
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.2500
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.4667
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.6923
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.5745
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.5294
 Best site-cartoon                  (3)  | Epoch:5 | Val Acc: 0.4286
 Best site-cartoon                  (3)  | Epoch:5 | Val Acc: 0.3896
 Best site-sketch                   (2)  | Epoch:5 | Val Acc: 0.3077
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 6 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (0) | Train Loss: 1.1074 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 0.9412 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 1.0125 | Train Acc: 0.8750
 Site-photo                     (0) | Train Loss: 0.8828 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.9026 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.9503 | Train Acc: 0.9038
 Site-photo                     (0) | Train Loss: 0.8617 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.8857 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.9210 | Train Acc: 0.9292
 Site-photo                     (0) | Train Loss: 0.9550 | Train Acc: 0.9178
 Site-art_painting              (1) | Train Loss: 1.4358 | Train Acc: 0.5833
 Site-art_painting              (1) | Train Loss: 1.4892 | Train Acc: 0.6818
 Site-art_painting              (1) | Train Loss: 1.5121 | Train Acc: 0.4500
 Site-art_painting              (1) | Train Loss: 1.4121 | Train Acc: 0.6250
 Site-art_painting              (1) | Train Loss: 1.3765 | Train Acc: 0.6328
 Site-cartoon                   (3) | Train Loss: 1.4589 | Train Acc: 0.5455
 Site-cartoon                   (3) | Train Loss: 1.5902 | Train Acc: 0.4261
 Site-sketch                    (2) | Train Loss: 1.7965 | Train Acc: 0.3276
Average Train Accuracy: 0.7557
 Site-photo                     (0) | Val  Loss: 0.9750 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 0.9572 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.9485 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.9502 | Val  Acc: 0.9048
 Site-photo                     (0) | Val  Loss: 0.9272 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 1.0101 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.8435 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.8788 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.9412 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.8674 | Val  Acc: 0.9381
 Site-art_painting              (1) | Val  Loss: 1.6241 | Val  Acc: 0.3750
 Site-art_painting              (1) | Val  Loss: 1.3732 | Val  Acc: 0.6000
 Site-art_painting              (1) | Val  Loss: 1.3040 | Val  Acc: 0.7308
 Site-art_painting              (1) | Val  Loss: 1.4126 | Val  Acc: 0.6383
 Site-art_painting              (1) | Val  Loss: 1.3668 | Val  Acc: 0.6588
 Site-cartoon                   (3) | Val  Loss: 1.6055 | Val  Acc: 0.1429
 Site-cartoon                   (3) | Val  Loss: 1.5795 | Val  Acc: 0.4286
 Site-sketch                    (2) | Val  Loss: 1.8120 | Val  Acc: 0.2821
Average Valid Accuracy: 0.7329
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9048
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9630
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9733
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9381
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.3750
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.6000
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.7308
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.6383
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.6588
 Best site-cartoon                  (3)  | Epoch:6 | Val Acc: 0.1429
 Best site-cartoon                  (3)  | Epoch:6 | Val Acc: 0.4286
 Best site-sketch                   (2)  | Epoch:6 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[8, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (0) | Train Loss: 1.0492 | Train Acc: 0.7857
 Site-photo                     (0) | Train Loss: 0.8602 | Train Acc: 0.8889
 Site-photo                     (3) | Train Loss: 0.9638 | Train Acc: 0.7500
 Site-photo                     (3) | Train Loss: 0.7702 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.8072 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.8346 | Train Acc: 0.9231
 Site-photo                     (0) | Train Loss: 0.6615 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.8132 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.8087 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.8277 | Train Acc: 0.9247
 Site-art_painting              (1) | Train Loss: 1.3391 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 1.3868 | Train Acc: 0.6818
 Site-art_painting              (1) | Train Loss: 1.4094 | Train Acc: 0.5750
 Site-art_painting              (1) | Train Loss: 1.3075 | Train Acc: 0.6528
 Site-art_painting              (1) | Train Loss: 1.2872 | Train Acc: 0.6641
 Site-cartoon                   (2) | Train Loss: 1.2870 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 1.5093 | Train Acc: 0.5043
 Site-sketch                    (2) | Train Loss: 1.7690 | Train Acc: 0.2759
Average Train Accuracy: 0.7687
 Site-photo                     (0) | Val  Loss: 0.9208 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 0.9214 | Val  Acc: 0.8333
 Site-photo                     (3) | Val  Loss: 0.8548 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.8665 | Val  Acc: 0.9048
 Site-photo                     (0) | Val  Loss: 0.8544 | Val  Acc: 0.9259
 Site-photo                     (0) | Val  Loss: 0.8737 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.7486 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.7988 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.8437 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.7794 | Val  Acc: 0.9381
 Site-art_painting              (1) | Val  Loss: 1.4754 | Val  Acc: 0.5000
 Site-art_painting              (1) | Val  Loss: 1.3107 | Val  Acc: 0.7333
 Site-art_painting              (1) | Val  Loss: 1.2466 | Val  Acc: 0.7308
 Site-art_painting              (1) | Val  Loss: 1.2691 | Val  Acc: 0.6596
 Site-art_painting              (1) | Val  Loss: 1.2931 | Val  Acc: 0.6118
 Site-cartoon                   (2) | Val  Loss: 1.4330 | Val  Acc: 0.4286
 Site-cartoon                   (2) | Val  Loss: 1.5365 | Val  Acc: 0.4935
 Site-sketch                    (2) | Val  Loss: 1.8173 | Val  Acc: 0.1282
Average Valid Accuracy: 0.7479
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.8333
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.9375
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.9048
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9259
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9733
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9381
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.5000
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.7333
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.7308
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.6596
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.6118
 Best site-cartoon                  (2)  | Epoch:7 | Val Acc: 0.4286
 Best site-cartoon                  (2)  | Epoch:7 | Val Acc: 0.4935
 Best site-sketch                   (2)  | Epoch:7 | Val Acc: 0.1282
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 7, 8, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (0) | Train Loss: 0.8756 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7169 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.8862 | Train Acc: 0.8750
 Site-photo                     (2) | Train Loss: 0.7093 | Train Acc: 0.9355
 Site-photo                     (2) | Train Loss: 0.7028 | Train Acc: 0.9250
 Site-photo                     (2) | Train Loss: 0.7499 | Train Acc: 0.9423
 Site-photo                     (2) | Train Loss: 0.6173 | Train Acc: 0.9706
 Site-photo                     (2) | Train Loss: 0.7651 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.7123 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.7734 | Train Acc: 0.9521
 Site-art_painting              (1) | Train Loss: 1.2777 | Train Acc: 0.6667
 Site-art_painting              (1) | Train Loss: 1.3288 | Train Acc: 0.7273
 Site-art_painting              (1) | Train Loss: 1.3936 | Train Acc: 0.5500
 Site-art_painting              (1) | Train Loss: 1.1425 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 1.2083 | Train Acc: 0.7422
 Site-cartoon                   (1) | Train Loss: 1.3289 | Train Acc: 0.4545
 Site-cartoon                   (1) | Train Loss: 1.4684 | Train Acc: 0.5391
 Site-sketch                    (3) | Train Loss: 1.7698 | Train Acc: 0.3103
Average Train Accuracy: 0.7890
 Site-photo                     (0) | Val  Loss: 0.7756 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.8242 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.7022 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.7366 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.7578 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.7944 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.6719 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.6895 | Val  Acc: 0.9483
 Site-photo                     (2) | Val  Loss: 0.7306 | Val  Acc: 0.9733
 Site-photo                     (2) | Val  Loss: 0.6846 | Val  Acc: 0.9588
 Site-art_painting              (1) | Val  Loss: 1.2101 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 1.2409 | Val  Acc: 0.7333
 Site-art_painting              (1) | Val  Loss: 1.1500 | Val  Acc: 0.8462
 Site-art_painting              (1) | Val  Loss: 1.2747 | Val  Acc: 0.7447
 Site-art_painting              (1) | Val  Loss: 1.2299 | Val  Acc: 0.6706
 Site-cartoon                   (1) | Val  Loss: 1.5223 | Val  Acc: 0.1429
 Site-cartoon                   (1) | Val  Loss: 1.4450 | Val  Acc: 0.5195
 Site-sketch                    (3) | Val  Loss: 1.7909 | Val  Acc: 0.1795
Average Valid Accuracy: 0.7919
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:8 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:8 | Val Acc: 0.9714
 Best site-photo                    (2)  | Epoch:8 | Val Acc: 0.9333
 Best site-photo                    (2)  | Epoch:8 | Val Acc: 0.9483
 Best site-photo                    (2)  | Epoch:8 | Val Acc: 0.9733
 Best site-photo                    (2)  | Epoch:8 | Val Acc: 0.9588
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.8750
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.7333
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.8462
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.7447
 Best site-art_painting             (1)  | Epoch:8 | Val Acc: 0.6706
 Best site-cartoon                  (1)  | Epoch:8 | Val Acc: 0.1429
 Best site-cartoon                  (1)  | Epoch:8 | Val Acc: 0.5195
 Best site-sketch                   (3)  | Epoch:8 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (0) | Train Loss: 0.8484 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7327 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 0.7889 | Train Acc: 0.8750
 Site-photo                     (0) | Train Loss: 0.6254 | Train Acc: 0.9355
 Site-photo                     (0) | Train Loss: 0.6263 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6642 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.6447 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6950 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.6433 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.6775 | Train Acc: 0.9452
 Site-art_painting              (2) | Train Loss: 1.2185 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 1.2484 | Train Acc: 0.7273
 Site-art_painting              (2) | Train Loss: 1.3485 | Train Acc: 0.5000
 Site-art_painting              (2) | Train Loss: 1.2118 | Train Acc: 0.6806
 Site-art_painting              (2) | Train Loss: 1.1475 | Train Acc: 0.7422
 Site-cartoon                   (1) | Train Loss: 1.2338 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 1.4198 | Train Acc: 0.6087
 Site-sketch                    (3) | Train Loss: 1.7375 | Train Acc: 0.3276
Average Train Accuracy: 0.8151
 Site-photo                     (0) | Val  Loss: 0.6620 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7886 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.6642 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.6563 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.6905 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7303 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.5885 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.6314 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.6154 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.6377 | Val  Acc: 0.9588
 Site-art_painting              (2) | Val  Loss: 1.2231 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 1.1477 | Val  Acc: 0.8000
 Site-art_painting              (2) | Val  Loss: 1.1372 | Val  Acc: 0.8077
 Site-art_painting              (2) | Val  Loss: 1.1233 | Val  Acc: 0.8298
 Site-art_painting              (2) | Val  Loss: 1.1471 | Val  Acc: 0.7176
 Site-cartoon                   (1) | Val  Loss: 1.4700 | Val  Acc: 0.4286
 Site-cartoon                   (1) | Val  Loss: 1.4240 | Val  Acc: 0.5714
 Site-sketch                    (3) | Val  Loss: 1.7639 | Val  Acc: 0.3077
Average Valid Accuracy: 0.8239
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9600
 Best site-photo                    (0)  | Epoch:9 | Val Acc: 0.9588
 Best site-art_painting             (2)  | Epoch:9 | Val Acc: 0.7500
 Best site-art_painting             (2)  | Epoch:9 | Val Acc: 0.8000
 Best site-art_painting             (2)  | Epoch:9 | Val Acc: 0.8077
 Best site-art_painting             (2)  | Epoch:9 | Val Acc: 0.8298
 Best site-art_painting             (2)  | Epoch:9 | Val Acc: 0.7176
 Best site-cartoon                  (1)  | Epoch:9 | Val Acc: 0.4286
 Best site-cartoon                  (1)  | Epoch:9 | Val Acc: 0.5714
 Best site-sketch                   (3)  | Epoch:9 | Val Acc: 0.3077
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 10 ============
cnt=[6, 9, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (1) | Train Loss: 0.7660 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6006 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.7097 | Train Acc: 0.9167
 Site-photo                     (1) | Train Loss: 0.5773 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6022 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.6327 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.4037 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5500 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.5870 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.6285 | Train Acc: 0.9589
 Site-art_painting              (0) | Train Loss: 1.2041 | Train Acc: 0.5833
 Site-art_painting              (0) | Train Loss: 1.2198 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 1.1908 | Train Acc: 0.6500
 Site-art_painting              (0) | Train Loss: 1.1527 | Train Acc: 0.7222
 Site-art_painting              (0) | Train Loss: 1.0171 | Train Acc: 0.8359
 Site-cartoon                   (3) | Train Loss: 1.1040 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 1.3424 | Train Acc: 0.6435
 Site-sketch                    (2) | Train Loss: 1.6583 | Train Acc: 0.3103
Average Train Accuracy: 0.8265
 Site-photo                     (1) | Val  Loss: 0.6427 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.7484 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.5697 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5919 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.6258 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6473 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.5558 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.5766 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.6015 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.6071 | Val  Acc: 0.9588
 Site-art_painting              (0) | Val  Loss: 1.0395 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 1.0365 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 1.0192 | Val  Acc: 0.7692
 Site-art_painting              (0) | Val  Loss: 1.0381 | Val  Acc: 0.8511
 Site-art_painting              (0) | Val  Loss: 1.0847 | Val  Acc: 0.7294
 Site-cartoon                   (3) | Val  Loss: 1.4160 | Val  Acc: 0.4286
 Site-cartoon                   (0) | Val  Loss: 1.3199 | Val  Acc: 0.5974
 Site-sketch                    (2) | Val  Loss: 1.6560 | Val  Acc: 0.3590
Average Valid Accuracy: 0.8321
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9867
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9588
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.8000
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.7692
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.8511
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.7294
 Best site-cartoon                  (3)  | Epoch:10 | Val Acc: 0.4286
 Best site-cartoon                  (0)  | Epoch:10 | Val Acc: 0.5974
 Best site-sketch                   (2)  | Epoch:10 | Val Acc: 0.3590
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 11 ============
cnt=[10, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (0) | Train Loss: 0.6492 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5763 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.6526 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.5287 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5739 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.5628 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.4899 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5135 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.5488 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.5671 | Train Acc: 0.9658
 Site-art_painting              (2) | Train Loss: 1.0229 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 1.1156 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 1.2020 | Train Acc: 0.5750
 Site-art_painting              (2) | Train Loss: 1.1468 | Train Acc: 0.7778
 Site-art_painting              (2) | Train Loss: 1.0261 | Train Acc: 0.8281
 Site-cartoon                   (3) | Train Loss: 1.0539 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.2334 | Train Acc: 0.6957
 Site-sketch                    (1) | Train Loss: 1.6046 | Train Acc: 0.3793
Average Train Accuracy: 0.8535
 Site-photo                     (0) | Val  Loss: 0.5723 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6871 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.5529 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.5585 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.5630 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.6199 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.5095 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.5107 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.5534 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.5225 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.9496 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 1.1258 | Val  Acc: 0.8000
 Site-art_painting              (2) | Val  Loss: 0.8892 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.9905 | Val  Acc: 0.7872
 Site-art_painting              (2) | Val  Loss: 0.9953 | Val  Acc: 0.8000
 Site-cartoon                   (3) | Val  Loss: 1.5612 | Val  Acc: 0.1429
 Site-cartoon                   (3) | Val  Loss: 1.3088 | Val  Acc: 0.6494
 Site-sketch                    (1) | Val  Loss: 1.6863 | Val  Acc: 0.2308
Average Valid Accuracy: 0.8175
============ Train epoch 12 ============
cnt=[5, 3, 8, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (3) | Train Loss: 0.6326 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.6145 | Train Acc: 0.8889
 Site-photo                     (2) | Train Loss: 0.6567 | Train Acc: 0.8333
 Site-photo                     (2) | Train Loss: 0.5051 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.5173 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.5357 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.3708 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.5223 | Train Acc: 0.9545
 Site-photo                     (2) | Train Loss: 0.5125 | Train Acc: 0.9646
 Site-photo                     (2) | Train Loss: 0.5442 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.9933 | Train Acc: 0.5833
 Site-art_painting              (0) | Train Loss: 1.1446 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 1.0501 | Train Acc: 0.7000
 Site-art_painting              (0) | Train Loss: 0.8822 | Train Acc: 0.7917
 Site-art_painting              (0) | Train Loss: 0.8912 | Train Acc: 0.8516
 Site-cartoon                   (1) | Train Loss: 0.9758 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 1.2172 | Train Acc: 0.6609
 Site-sketch                    (1) | Train Loss: 1.5823 | Train Acc: 0.3276
Average Train Accuracy: 0.8426
 Site-photo                     (3) | Val  Loss: 0.5867 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.6285 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.4966 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4562 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.5373 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.5902 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.4544 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.4829 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.4752 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.5025 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.9429 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 1.0215 | Val  Acc: 0.7333
 Site-art_painting              (0) | Val  Loss: 0.8263 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.9381 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.9829 | Val  Acc: 0.8118
 Site-cartoon                   (1) | Val  Loss: 1.4062 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 1.2040 | Val  Acc: 0.6753
 Site-sketch                    (1) | Val  Loss: 1.6189 | Val  Acc: 0.3590
Average Valid Accuracy: 0.8563
 Best site-photo                    (3)  | Epoch:12 | Val Acc: 0.8889
 Best site-photo                    (3)  | Epoch:12 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:12 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:12 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:12 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:12 | Val Acc: 0.9655
 Best site-photo                    (2)  | Epoch:12 | Val Acc: 0.9867
 Best site-photo                    (2)  | Epoch:12 | Val Acc: 0.9794
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.7333
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.9149
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.8118
 Best site-cartoon                  (1)  | Epoch:12 | Val Acc: 0.5714
 Best site-cartoon                  (1)  | Epoch:12 | Val Acc: 0.6753
 Best site-sketch                   (1)  | Epoch:12 | Val Acc: 0.3590
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 13 ============
cnt=[8, 3, 6, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (0) | Train Loss: 0.6119 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 0.5410 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 0.5252 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4812 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4679 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.4766 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.3559 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.4762 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.4751 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.5045 | Train Acc: 0.9726
 Site-art_painting              (1) | Train Loss: 1.0075 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.1638 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 1.0255 | Train Acc: 0.7000
 Site-art_painting              (2) | Train Loss: 0.9446 | Train Acc: 0.8056
 Site-art_painting              (2) | Train Loss: 0.8667 | Train Acc: 0.8047
 Site-cartoon                   (2) | Train Loss: 0.8770 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 1.1132 | Train Acc: 0.7304
 Site-sketch                    (3) | Train Loss: 1.4918 | Train Acc: 0.5172
Average Train Accuracy: 0.8668
 Site-photo                     (0) | Val  Loss: 0.5627 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.5202 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.4681 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.4530 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.5208 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5374 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.4515 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.4655 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.4614 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.4788 | Val  Acc: 0.9794
 Site-art_painting              (1) | Val  Loss: 0.9309 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 0.8006 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.8373 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.8850 | Val  Acc: 0.8085
 Site-art_painting              (2) | Val  Loss: 0.9085 | Val  Acc: 0.7529
 Site-cartoon                   (2) | Val  Loss: 1.1610 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 1.1789 | Val  Acc: 0.7273
 Site-sketch                    (3) | Val  Loss: 1.5688 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8663
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9794
 Best site-art_painting             (1)  | Epoch:13 | Val Acc: 0.8750
 Best site-art_painting             (2)  | Epoch:13 | Val Acc: 0.9333
 Best site-art_painting             (2)  | Epoch:13 | Val Acc: 0.8462
 Best site-art_painting             (2)  | Epoch:13 | Val Acc: 0.8085
 Best site-art_painting             (2)  | Epoch:13 | Val Acc: 0.7529
 Best site-cartoon                  (2)  | Epoch:13 | Val Acc: 0.7143
 Best site-cartoon                  (2)  | Epoch:13 | Val Acc: 0.7273
 Best site-sketch                   (3)  | Epoch:13 | Val Acc: 0.4103
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 14 ============
cnt=[3, 6, 3, 6, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (3) | Train Loss: 0.5727 | Train Acc: 0.8571
 Site-photo                     (3) | Train Loss: 0.4462 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.5618 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4203 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4300 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4116 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3125 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.4286 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.4290 | Train Acc: 0.9646
 Site-photo                     (3) | Train Loss: 0.4443 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.9995 | Train Acc: 0.7500
 Site-art_painting              (3) | Train Loss: 1.0669 | Train Acc: 0.6818
 Site-art_painting              (0) | Train Loss: 0.9528 | Train Acc: 0.8000
 Site-art_painting              (3) | Train Loss: 0.8816 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.8218 | Train Acc: 0.8203
 Site-cartoon                   (2) | Train Loss: 0.8226 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 1.0769 | Train Acc: 0.7478
 Site-sketch                    (2) | Train Loss: 1.4732 | Train Acc: 0.5000
Average Train Accuracy: 0.8755
 Site-photo                     (3) | Val  Loss: 0.5113 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.5585 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.4195 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.4445 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.4577 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5102 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.4148 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.4484 | Val  Acc: 0.9483
 Site-photo                     (1) | Val  Loss: 0.4237 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.4273 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.6983 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.8480 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.7924 | Val  Acc: 0.8462
 Site-art_painting              (3) | Val  Loss: 0.9082 | Val  Acc: 0.7660
 Site-art_painting              (3) | Val  Loss: 0.8915 | Val  Acc: 0.8353
 Site-cartoon                   (2) | Val  Loss: 1.2321 | Val  Acc: 0.5714
 Site-cartoon                   (2) | Val  Loss: 1.0953 | Val  Acc: 0.7532
 Site-sketch                    (2) | Val  Loss: 1.4698 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8714
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9483
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 0.9794
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8667
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8462
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.7660
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8353
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.5714
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.7532
 Best site-sketch                   (2)  | Epoch:14 | Val Acc: 0.3846
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 15 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.5500 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4305 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.5150 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.3928 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.4235 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.3935 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2548 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4195 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.4152 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.4369 | Train Acc: 0.9658
 Site-art_painting              (1) | Train Loss: 0.8591 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.8902 | Train Acc: 0.8636
 Site-art_painting              (1) | Train Loss: 0.9399 | Train Acc: 0.7750
 Site-art_painting              (1) | Train Loss: 0.6053 | Train Acc: 0.8194
 Site-art_painting              (1) | Train Loss: 0.7914 | Train Acc: 0.8438
 Site-cartoon                   (3) | Train Loss: 0.8311 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.0228 | Train Acc: 0.7304
 Site-sketch                    (2) | Train Loss: 1.4323 | Train Acc: 0.5345
Average Train Accuracy: 0.8848
 Site-photo                     (0) | Val  Loss: 0.4354 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.4863 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.4053 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.3993 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.4087 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4952 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.3800 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.4088 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.4008 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.3738 | Val  Acc: 0.9691
 Site-art_painting              (1) | Val  Loss: 0.7408 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.8099 | Val  Acc: 0.8000
 Site-art_painting              (1) | Val  Loss: 0.7347 | Val  Acc: 0.9231
 Site-art_painting              (1) | Val  Loss: 0.8268 | Val  Acc: 0.8298
 Site-art_painting              (1) | Val  Loss: 0.8495 | Val  Acc: 0.7765
 Site-cartoon                   (3) | Val  Loss: 1.3188 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 1.0939 | Val  Acc: 0.7662
 Site-sketch                    (2) | Val  Loss: 1.4430 | Val  Acc: 0.5128
Average Valid Accuracy: 0.8712
============ Train epoch 16 ============
cnt=[1, 8, 7, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (1) | Train Loss: 0.4705 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4137 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.4893 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.3773 | Train Acc: 0.9677
 Site-photo                     (2) | Train Loss: 0.3699 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.3622 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.3799 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3861 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.3867 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.3557 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.6893 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.9534 | Train Acc: 0.8182
 Site-art_painting              (1) | Train Loss: 0.9493 | Train Acc: 0.7750
 Site-art_painting              (1) | Train Loss: 0.6777 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.7298 | Train Acc: 0.8750
 Site-cartoon                   (3) | Train Loss: 0.7882 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 0.9777 | Train Acc: 0.7826
 Site-sketch                    (0) | Train Loss: 1.3511 | Train Acc: 0.5517
Average Train Accuracy: 0.8889
 Site-photo                     (1) | Val  Loss: 0.3669 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4339 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.3296 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3502 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.3599 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4519 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.3725 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.3720 | Val  Acc: 0.9483
 Site-photo                     (1) | Val  Loss: 0.3826 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.3399 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.6772 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 0.7424 | Val  Acc: 0.7333
 Site-art_painting              (1) | Val  Loss: 0.7273 | Val  Acc: 0.7692
 Site-art_painting              (1) | Val  Loss: 0.7952 | Val  Acc: 0.7872
 Site-art_painting              (1) | Val  Loss: 0.8080 | Val  Acc: 0.8353
 Site-cartoon                   (3) | Val  Loss: 1.1077 | Val  Acc: 0.7143
 Site-cartoon                   (3) | Val  Loss: 1.0589 | Val  Acc: 0.7532
 Site-sketch                    (0) | Val  Loss: 1.4056 | Val  Acc: 0.4615
Average Valid Accuracy: 0.8676
============ Train epoch 17 ============
cnt=[5, 2, 10, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (2) | Train Loss: 0.4559 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3381 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4521 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.3352 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3722 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.3499 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.2523 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3748 | Train Acc: 0.9318
 Site-photo                     (2) | Train Loss: 0.3411 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.3373 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.6459 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.8960 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.8985 | Train Acc: 0.6750
 Site-art_painting              (0) | Train Loss: 0.8356 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.6899 | Train Acc: 0.8281
 Site-cartoon                   (1) | Train Loss: 0.7453 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.9494 | Train Acc: 0.7739
 Site-sketch                    (3) | Train Loss: 1.2930 | Train Acc: 0.5862
Average Train Accuracy: 0.9009
 Site-photo                     (2) | Val  Loss: 0.5025 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.4684 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2967 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3585 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.3447 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4192 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.3365 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.3880 | Val  Acc: 0.9483
 Site-photo                     (2) | Val  Loss: 0.3452 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3312 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.4816 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.8605 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.5972 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.6888 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.7588 | Val  Acc: 0.8353
 Site-cartoon                   (1) | Val  Loss: 1.0951 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 1.0682 | Val  Acc: 0.7662
 Site-sketch                    (3) | Val  Loss: 1.2216 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.8889
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9483
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8667
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8723
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8353
 Best site-cartoon                  (1)  | Epoch:17 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:17 | Val Acc: 0.7662
 Best site-sketch                   (3)  | Epoch:17 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 18 ============
cnt=[13, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (0) | Train Loss: 0.4271 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3463 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.4015 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3113 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3565 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.3382 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.2983 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.3292 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.3122 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.3363 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.7987 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.8130 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 0.7794 | Train Acc: 0.8250
 Site-art_painting              (0) | Train Loss: 0.7315 | Train Acc: 0.8472
 Site-art_painting              (0) | Train Loss: 0.6335 | Train Acc: 0.8984
 Site-cartoon                   (2) | Train Loss: 0.8230 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.9293 | Train Acc: 0.7652
 Site-sketch                    (1) | Train Loss: 1.2007 | Train Acc: 0.6552
Average Train Accuracy: 0.8965
 Site-photo                     (0) | Val  Loss: 0.3178 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3451 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2996 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3280 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.3104 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3772 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.3282 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.3481 | Val  Acc: 0.9483
 Site-photo                     (0) | Val  Loss: 0.3287 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2995 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.4625 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.6903 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 0.6136 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.6677 | Val  Acc: 0.8511
 Site-art_painting              (0) | Val  Loss: 0.6556 | Val  Acc: 0.8588
 Site-cartoon                   (2) | Val  Loss: 0.9687 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.9530 | Val  Acc: 0.7662
 Site-sketch                    (1) | Val  Loss: 1.3052 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8989
============ Train epoch 19 ============
cnt=[2, 14, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (1) | Train Loss: 0.4178 | Train Acc: 0.9286
 Site-photo                     (1) | Train Loss: 0.2962 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.4106 | Train Acc: 0.9167
 Site-photo                     (1) | Train Loss: 0.2832 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3039 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.3066 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.2984 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3070 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.2860 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.2943 | Train Acc: 0.9863
 Site-art_painting              (1) | Train Loss: 0.9130 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 0.7651 | Train Acc: 0.8636
 Site-art_painting              (1) | Train Loss: 0.7363 | Train Acc: 0.7250
 Site-art_painting              (1) | Train Loss: 0.5487 | Train Acc: 0.8611
 Site-art_painting              (1) | Train Loss: 0.6473 | Train Acc: 0.8438
 Site-cartoon                   (0) | Train Loss: 0.8062 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 0.8629 | Train Acc: 0.7652
 Site-sketch                    (2) | Train Loss: 1.1164 | Train Acc: 0.6552
Average Train Accuracy: 0.8805
 Site-photo                     (1) | Val  Loss: 0.4767 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.3769 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.2999 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.3141 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.2934 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3385 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.2831 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.3000 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.2899 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.2789 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 0.6099 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 0.5915 | Val  Acc: 0.9333
 Site-art_painting              (1) | Val  Loss: 0.5904 | Val  Acc: 0.9231
 Site-art_painting              (1) | Val  Loss: 0.6855 | Val  Acc: 0.8723
 Site-art_painting              (1) | Val  Loss: 0.6482 | Val  Acc: 0.8588
 Site-cartoon                   (0) | Val  Loss: 0.8823 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.9077 | Val  Acc: 0.7792
 Site-sketch                    (2) | Val  Loss: 1.1872 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8985
============ Train epoch 20 ============
cnt=[6, 3, 4, 5, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (3) | Train Loss: 0.3337 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3239 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.3712 | Train Acc: 0.9583
 Site-photo                     (3) | Train Loss: 0.2558 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2863 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.2680 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.3415 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.3233 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.2550 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.2816 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 0.6294 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.7801 | Train Acc: 0.8636
 Site-art_painting              (2) | Train Loss: 0.7111 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 0.5633 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.6208 | Train Acc: 0.8672
 Site-cartoon                   (1) | Train Loss: 0.6680 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.8315 | Train Acc: 0.7913
 Site-sketch                    (1) | Train Loss: 1.0910 | Train Acc: 0.6897
Average Train Accuracy: 0.9103
 Site-photo                     (3) | Val  Loss: 0.4671 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.4474 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.2415 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3002 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.2923 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3287 | Val  Acc: 0.9429
 Site-photo                     (3) | Val  Loss: 0.2868 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2716 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.2475 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2850 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.4807 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.6865 | Val  Acc: 0.7333
 Site-art_painting              (2) | Val  Loss: 0.4943 | Val  Acc: 0.9615
 Site-art_painting              (2) | Val  Loss: 0.5812 | Val  Acc: 0.8723
 Site-art_painting              (2) | Val  Loss: 0.6092 | Val  Acc: 0.8941
 Site-cartoon                   (1) | Val  Loss: 0.9334 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 0.9092 | Val  Acc: 0.8312
 Site-sketch                    (1) | Val  Loss: 1.0461 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9005
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9167
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 0.9524
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9429
 Best site-photo                    (3)  | Epoch:20 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9794
 Best site-art_painting             (2)  | Epoch:20 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:20 | Val Acc: 0.7333
 Best site-art_painting             (2)  | Epoch:20 | Val Acc: 0.9615
 Best site-art_painting             (2)  | Epoch:20 | Val Acc: 0.8723
 Best site-art_painting             (2)  | Epoch:20 | Val Acc: 0.8941
 Best site-cartoon                  (1)  | Epoch:20 | Val Acc: 0.5714
 Best site-cartoon                  (1)  | Epoch:20 | Val Acc: 0.8312
 Best site-sketch                   (1)  | Epoch:20 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (1) | Train Loss: 0.3694 | Train Acc: 0.9286
 Site-photo                     (1) | Train Loss: 0.2726 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.3828 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.2459 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3002 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.2828 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.2184 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.2853 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.2604 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.3009 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.5508 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.7399 | Train Acc: 0.8182
 Site-art_painting              (3) | Train Loss: 0.7416 | Train Acc: 0.7750
 Site-art_painting              (3) | Train Loss: 0.5818 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.5402 | Train Acc: 0.8984
 Site-cartoon                   (0) | Train Loss: 0.7066 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 0.7562 | Train Acc: 0.8348
 Site-sketch                    (2) | Train Loss: 1.1069 | Train Acc: 0.6379
Average Train Accuracy: 0.9074
 Site-photo                     (1) | Val  Loss: 0.2658 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3926 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.1951 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2801 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.2382 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3021 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.2641 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.2750 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.2426 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2528 | Val  Acc: 0.9588
 Site-art_painting              (3) | Val  Loss: 0.4062 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.4413 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.4580 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.5189 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.6314 | Val  Acc: 0.8824
 Site-cartoon                   (0) | Val  Loss: 1.0576 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.8264 | Val  Acc: 0.7662
 Site-sketch                    (2) | Val  Loss: 1.1927 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9158
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9588
 Best site-art_painting             (3)  | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:21 | Val Acc: 0.9231
 Best site-art_painting             (3)  | Epoch:21 | Val Acc: 0.9149
 Best site-art_painting             (3)  | Epoch:21 | Val Acc: 0.8824
 Best site-cartoon                  (0)  | Epoch:21 | Val Acc: 0.7143
 Best site-cartoon                  (0)  | Epoch:21 | Val Acc: 0.7662
 Best site-sketch                   (2)  | Epoch:21 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 11, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (1) | Train Loss: 0.3185 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4175 | Train Acc: 0.8889
 Site-photo                     (3) | Train Loss: 0.3427 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.2574 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2960 | Train Acc: 0.9250
 Site-photo                     (1) | Train Loss: 0.2481 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1813 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3329 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.2468 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.2871 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.5787 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.7363 | Train Acc: 0.8182
 Site-art_painting              (1) | Train Loss: 0.7409 | Train Acc: 0.7750
 Site-art_painting              (1) | Train Loss: 0.5892 | Train Acc: 0.9028
 Site-art_painting              (1) | Train Loss: 0.5560 | Train Acc: 0.9141
 Site-cartoon                   (2) | Train Loss: 0.6517 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.7028 | Train Acc: 0.8348
 Site-sketch                    (2) | Train Loss: 1.0933 | Train Acc: 0.6207
Average Train Accuracy: 0.9085
 Site-photo                     (1) | Val  Loss: 0.4244 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.3899 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.2290 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2936 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.2180 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3102 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.2284 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.2526 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.2385 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2399 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.4571 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4715 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.5330 | Val  Acc: 0.9231
 Site-art_painting              (1) | Val  Loss: 0.5039 | Val  Acc: 0.8936
 Site-art_painting              (1) | Val  Loss: 0.5656 | Val  Acc: 0.8471
 Site-cartoon                   (2) | Val  Loss: 0.9882 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.7728 | Val  Acc: 0.8571
 Site-sketch                    (2) | Val  Loss: 1.0461 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9191
 Best site-photo                    (1)  | Epoch:22 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:22 | Val Acc: 0.9167
 Best site-photo                    (3)  | Epoch:22 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:22 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:22 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:22 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:22 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:22 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:22 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:22 | Val Acc: 0.9691
 Best site-art_painting             (3)  | Epoch:22 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:22 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:22 | Val Acc: 0.9231
 Best site-art_painting             (1)  | Epoch:22 | Val Acc: 0.8936
 Best site-art_painting             (1)  | Epoch:22 | Val Acc: 0.8471
 Best site-cartoon                  (2)  | Epoch:22 | Val Acc: 0.7143
 Best site-cartoon                  (2)  | Epoch:22 | Val Acc: 0.8571
 Best site-sketch                   (2)  | Epoch:22 | Val Acc: 0.7179
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 23 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (0) | Train Loss: 0.3673 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 0.2659 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3315 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.2115 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2726 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.2713 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.1395 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2719 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.2466 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.2374 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.5205 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.6966 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 0.6879 | Train Acc: 0.8000
 Site-art_painting              (2) | Train Loss: 0.4478 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.5529 | Train Acc: 0.8672
 Site-cartoon                   (1) | Train Loss: 0.5593 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.7055 | Train Acc: 0.8000
 Site-sketch                    (3) | Train Loss: 1.0268 | Train Acc: 0.7241
Average Train Accuracy: 0.9097
 Site-photo                     (0) | Val  Loss: 0.2078 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3940 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.2170 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.3093 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.2185 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2852 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.2654 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2375 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.2257 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2164 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.4078 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.5489 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.4973 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.5150 | Val  Acc: 0.9362
 Site-art_painting              (2) | Val  Loss: 0.5422 | Val  Acc: 0.8706
 Site-cartoon                   (1) | Val  Loss: 0.8869 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.7984 | Val  Acc: 0.8312
 Site-sketch                    (3) | Val  Loss: 1.0230 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9229
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:23 | Val Acc: 0.9897
 Best site-art_painting             (2)  | Epoch:23 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:23 | Val Acc: 0.9333
 Best site-art_painting             (2)  | Epoch:23 | Val Acc: 0.9231
 Best site-art_painting             (2)  | Epoch:23 | Val Acc: 0.9362
 Best site-art_painting             (2)  | Epoch:23 | Val Acc: 0.8706
 Best site-cartoon                  (1)  | Epoch:23 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:23 | Val Acc: 0.8312
 Best site-sketch                   (3)  | Epoch:23 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 24 ============
cnt=[4, 3, 2, 9, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (3) | Train Loss: 0.2661 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2227 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2835 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2135 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2519 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.2170 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1328 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2487 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.2263 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2438 | Train Acc: 0.9863
 Site-art_painting              (2) | Train Loss: 0.6018 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.6458 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.6675 | Train Acc: 0.7750
 Site-art_painting              (3) | Train Loss: 0.4324 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.5379 | Train Acc: 0.8984
 Site-cartoon                   (1) | Train Loss: 0.5702 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.6943 | Train Acc: 0.8087
 Site-sketch                    (1) | Train Loss: 1.0367 | Train Acc: 0.6552
Average Train Accuracy: 0.9170
 Site-photo                     (3) | Val  Loss: 0.2659 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2756 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.2226 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.2525 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.2238 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2658 | Val  Acc: 0.9429
 Site-photo                     (3) | Val  Loss: 0.2116 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.2354 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.2144 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.2117 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.2648 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.4770 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.3644 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.5057 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.5240 | Val  Acc: 0.8824
 Site-cartoon                   (1) | Val  Loss: 0.7958 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.7466 | Val  Acc: 0.8312
 Site-sketch                    (1) | Val  Loss: 0.9584 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9291
 Best site-photo                    (3)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9167
 Best site-photo                    (3)  | Epoch:24 | Val Acc: 0.9375
 Best site-photo                    (3)  | Epoch:24 | Val Acc: 0.9524
 Best site-photo                    (3)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9429
 Best site-photo                    (3)  | Epoch:24 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:24 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9691
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.9333
 Best site-art_painting             (3)  | Epoch:24 | Val Acc: 0.9615
 Best site-art_painting             (3)  | Epoch:24 | Val Acc: 0.9149
 Best site-art_painting             (3)  | Epoch:24 | Val Acc: 0.8824
 Best site-cartoon                  (1)  | Epoch:24 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:24 | Val Acc: 0.8312
 Best site-sketch                   (1)  | Epoch:24 | Val Acc: 0.7179
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 11, 2, 4, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (1) | Train Loss: 0.2715 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2450 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.3179 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2135 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2485 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.1780 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1574 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.2281 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.2265 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.2460 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.6001 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.6877 | Train Acc: 0.9091
 Site-art_painting              (1) | Train Loss: 0.6218 | Train Acc: 0.8500
 Site-art_painting              (1) | Train Loss: 0.5040 | Train Acc: 0.9028
 Site-art_painting              (1) | Train Loss: 0.4807 | Train Acc: 0.8906
 Site-cartoon                   (2) | Train Loss: 0.5498 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.6296 | Train Acc: 0.8522
 Site-sketch                    (0) | Train Loss: 0.8985 | Train Acc: 0.7759
Average Train Accuracy: 0.9287
 Site-photo                     (1) | Val  Loss: 0.3646 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.2592 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.1638 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2480 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.1748 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2588 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.2147 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.2123 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.1887 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1980 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.3458 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.5747 | Val  Acc: 0.8667
 Site-art_painting              (1) | Val  Loss: 0.5168 | Val  Acc: 0.9615
 Site-art_painting              (1) | Val  Loss: 0.5125 | Val  Acc: 0.9149
 Site-art_painting              (1) | Val  Loss: 0.4922 | Val  Acc: 0.9294
 Site-cartoon                   (2) | Val  Loss: 0.8753 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.7546 | Val  Acc: 0.8571
 Site-sketch                    (0) | Val  Loss: 0.8824 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9311
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 0.9167
 Best site-photo                    (3)  | Epoch:25 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:25 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:25 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:25 | Val Acc: 0.9794
 Best site-art_painting             (3)  | Epoch:25 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:25 | Val Acc: 0.8667
 Best site-art_painting             (1)  | Epoch:25 | Val Acc: 0.9615
 Best site-art_painting             (1)  | Epoch:25 | Val Acc: 0.9149
 Best site-art_painting             (1)  | Epoch:25 | Val Acc: 0.9294
 Best site-cartoon                  (2)  | Epoch:25 | Val Acc: 0.8571
 Best site-cartoon                  (2)  | Epoch:25 | Val Acc: 0.8571
 Best site-sketch                   (0)  | Epoch:25 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 26 ============
cnt=[6, 3, 1, 8, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (0) | Train Loss: 0.2067 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2453 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.2791 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1748 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2211 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.2082 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.1599 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2776 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.1936 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.2117 | Train Acc: 0.9863
 Site-art_painting              (3) | Train Loss: 0.4910 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.7943 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.6320 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.5091 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.4818 | Train Acc: 0.8828
 Site-cartoon                   (1) | Train Loss: 0.4656 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.6534 | Train Acc: 0.8522
 Site-sketch                    (1) | Train Loss: 0.8333 | Train Acc: 0.7931
Average Train Accuracy: 0.9354
 Site-photo                     (0) | Val  Loss: 0.2891 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2322 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.1597 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2571 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.1638 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2698 | Val  Acc: 0.9143
 Site-photo                     (3) | Val  Loss: 0.1963 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.2313 | Val  Acc: 0.9483
 Site-photo                     (3) | Val  Loss: 0.1735 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.2001 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.2537 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4419 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4770 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.4861 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.5115 | Val  Acc: 0.8471
 Site-cartoon                   (1) | Val  Loss: 0.8990 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.7693 | Val  Acc: 0.8182
 Site-sketch                    (1) | Val  Loss: 0.9639 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9067
============ Train epoch 27 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (2) | Train Loss: 0.2307 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3161 | Train Acc: 0.8889
 Site-photo                     (2) | Train Loss: 0.2493 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.1839 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2056 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1737 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.2179 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2115 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.1817 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1922 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.5279 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.6416 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.6317 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 0.5062 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.4247 | Train Acc: 0.9141
 Site-cartoon                   (1) | Train Loss: 0.6781 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 0.6096 | Train Acc: 0.8435
 Site-sketch                    (3) | Train Loss: 0.8300 | Train Acc: 0.7414
Average Train Accuracy: 0.9041
 Site-photo                     (2) | Val  Loss: 0.3711 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2308 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.1650 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.2586 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1603 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2074 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.2050 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2050 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.2099 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1770 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.2700 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4385 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4252 | Val  Acc: 0.8846
 Site-art_painting              (2) | Val  Loss: 0.4340 | Val  Acc: 0.9574
 Site-art_painting              (0) | Val  Loss: 0.4786 | Val  Acc: 0.8941
 Site-cartoon                   (1) | Val  Loss: 0.8587 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 0.6290 | Val  Acc: 0.8961
 Site-sketch                    (3) | Val  Loss: 0.9422 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9065
============ Train epoch 28 ============
cnt=[14, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (0) | Train Loss: 0.2293 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2072 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2481 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1500 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2124 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.2337 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.1086 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1751 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.1792 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1910 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.4442 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.7789 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.6284 | Train Acc: 0.8250
 Site-art_painting              (0) | Train Loss: 0.5023 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.4788 | Train Acc: 0.9141
 Site-cartoon                   (1) | Train Loss: 0.6257 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.5910 | Train Acc: 0.8783
 Site-sketch                    (3) | Train Loss: 0.8581 | Train Acc: 0.7414
Average Train Accuracy: 0.9248
 Site-photo                     (0) | Val  Loss: 0.4060 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.1800 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1303 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2312 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1493 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2254 | Val  Acc: 0.9143
 Site-photo                     (0) | Val  Loss: 0.2142 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1751 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1740 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1932 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.2442 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3583 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4494 | Val  Acc: 0.9615
 Site-art_painting              (0) | Val  Loss: 0.4541 | Val  Acc: 0.8936
 Site-art_painting              (0) | Val  Loss: 0.4585 | Val  Acc: 0.9059
 Site-cartoon                   (1) | Val  Loss: 0.7342 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.6895 | Val  Acc: 0.8831
 Site-sketch                    (3) | Val  Loss: 0.8609 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9375
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9143
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9691
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9615
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.8936
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9059
 Best site-cartoon                  (1)  | Epoch:28 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:28 | Val Acc: 0.8831
 Best site-sketch                   (3)  | Epoch:28 | Val Acc: 0.7949
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 29 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (0) | Train Loss: 0.2097 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1954 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.2081 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1535 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2214 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1855 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.0935 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1755 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.1637 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1737 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.4433 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.4988 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.5496 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.4933 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.4313 | Train Acc: 0.9219
 Site-cartoon                   (2) | Train Loss: 0.6045 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.6084 | Train Acc: 0.8174
 Site-sketch                    (1) | Train Loss: 0.8074 | Train Acc: 0.7241
Average Train Accuracy: 0.9279
 Site-photo                     (0) | Val  Loss: 0.1755 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1932 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1127 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2585 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1329 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2463 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.2093 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1824 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1592 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.1711 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2457 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.3717 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.4157 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.3656 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.4295 | Val  Acc: 0.8824
 Site-cartoon                   (2) | Val  Loss: 0.8867 | Val  Acc: 0.5714
 Site-cartoon                   (2) | Val  Loss: 0.7839 | Val  Acc: 0.8442
 Site-sketch                    (1) | Val  Loss: 0.8726 | Val  Acc: 0.7692
Average Valid Accuracy: 0.9170
============ Train epoch 30 ============
cnt=[7, 2, 8, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (2) | Train Loss: 0.2079 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2199 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.2107 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1441 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2090 | Train Acc: 0.9500
 Site-photo                     (2) | Train Loss: 0.2006 | Train Acc: 0.9423
 Site-photo                     (2) | Train Loss: 0.0906 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.2142 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.1608 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1701 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.4856 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.5652 | Train Acc: 0.9545
 Site-art_painting              (0) | Train Loss: 0.4745 | Train Acc: 0.9250
 Site-art_painting              (0) | Train Loss: 0.5145 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.3681 | Train Acc: 0.9297
 Site-cartoon                   (1) | Train Loss: 0.5785 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.5597 | Train Acc: 0.8609
 Site-sketch                    (3) | Train Loss: 0.7570 | Train Acc: 0.8276
Average Train Accuracy: 0.9367
 Site-photo                     (2) | Val  Loss: 0.1742 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2738 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.1248 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1724 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1335 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2213 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.1852 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.1789 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.1417 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1726 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.2574 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.6450 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.3162 | Val  Acc: 0.9615
 Site-art_painting              (0) | Val  Loss: 0.3456 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.4107 | Val  Acc: 0.9529
 Site-cartoon                   (1) | Val  Loss: 0.7625 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.6074 | Val  Acc: 0.8701
 Site-sketch                    (3) | Val  Loss: 0.8754 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9254
============ Train epoch 31 ============
cnt=[9, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (0) | Train Loss: 0.1820 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2173 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.2150 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.1439 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1967 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1491 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1314 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.1839 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.1656 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1651 | Train Acc: 0.9863
 Site-art_painting              (2) | Train Loss: 0.4175 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.5174 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.5433 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.4531 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.3999 | Train Acc: 0.9141
 Site-cartoon                   (1) | Train Loss: 0.3919 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.5018 | Train Acc: 0.8957
 Site-sketch                    (3) | Train Loss: 0.7499 | Train Acc: 0.7759
Average Train Accuracy: 0.9377
 Site-photo                     (0) | Val  Loss: 0.4498 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.1745 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1088 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2262 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.1528 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2136 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.1814 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.1828 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1577 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1753 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.3710 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3764 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.3697 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.4312 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.3763 | Val  Acc: 0.9059
 Site-cartoon                   (1) | Val  Loss: 0.6133 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.5415 | Val  Acc: 0.8961
 Site-sketch                    (3) | Val  Loss: 0.8466 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9396
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:31 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:31 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:31 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:31 | Val Acc: 0.9333
 Best site-photo                    (2)  | Epoch:31 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9691
 Best site-art_painting             (2)  | Epoch:31 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:31 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:31 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:31 | Val Acc: 0.8723
 Best site-art_painting             (0)  | Epoch:31 | Val Acc: 0.9059
 Best site-cartoon                  (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-cartoon                  (1)  | Epoch:31 | Val Acc: 0.8961
 Best site-sketch                   (3)  | Epoch:31 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 32 ============
cnt=[11, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (0) | Train Loss: 0.2176 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1596 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2196 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1263 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1941 | Train Acc: 0.9500
 Site-photo                     (2) | Train Loss: 0.1144 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1396 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1557 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.1604 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1543 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 0.5043 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.5841 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.4899 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.3913 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.3717 | Train Acc: 0.9219
 Site-cartoon                   (1) | Train Loss: 0.5499 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.5393 | Train Acc: 0.8609
 Site-sketch                    (3) | Train Loss: 0.7698 | Train Acc: 0.7586
Average Train Accuracy: 0.9310
 Site-photo                     (0) | Val  Loss: 0.3634 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.1264 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1035 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2700 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1353 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2228 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.1820 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1726 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1274 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1420 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.1554 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3936 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4372 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3653 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.4438 | Val  Acc: 0.8588
 Site-cartoon                   (1) | Val  Loss: 0.7765 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.6293 | Val  Acc: 0.8831
 Site-sketch                    (3) | Val  Loss: 0.8425 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9283
============ Train epoch 33 ============
cnt=[4, 2, 11, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (2) | Train Loss: 0.1785 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1835 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.1994 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.1507 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2009 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.1382 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.0948 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2082 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.1686 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.1475 | Train Acc: 0.9863
 Site-art_painting              (2) | Train Loss: 0.4377 | Train Acc: 1.0000
 Site-art_painting              (2) | Train Loss: 0.4935 | Train Acc: 0.8636
 Site-art_painting              (2) | Train Loss: 0.5524 | Train Acc: 0.8000
 Site-art_painting              (2) | Train Loss: 0.3509 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.4053 | Train Acc: 0.8984
 Site-cartoon                   (1) | Train Loss: 0.5467 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.5026 | Train Acc: 0.8870
 Site-sketch                    (3) | Train Loss: 0.7306 | Train Acc: 0.7586
Average Train Accuracy: 0.9298
 Site-photo                     (2) | Val  Loss: 0.2212 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2652 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.0952 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2400 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1167 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1822 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.1918 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.1823 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.1559 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1429 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.1918 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.2857 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.4354 | Val  Acc: 0.8846
 Site-art_painting              (2) | Val  Loss: 0.3532 | Val  Acc: 0.9362
 Site-art_painting              (2) | Val  Loss: 0.3903 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.6296 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.7205 | Val  Acc: 0.8571
 Site-sketch                    (3) | Val  Loss: 0.8493 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9338
============ Train epoch 34 ============
cnt=[6, 2, 1, 9, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (3) | Train Loss: 0.1813 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2420 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.2070 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1338 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1949 | Train Acc: 0.9250
 Site-photo                     (3) | Train Loss: 0.1559 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1979 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1685 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.1417 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.1258 | Train Acc: 0.9932
 Site-art_painting              (0) | Train Loss: 0.4111 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.5613 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.4287 | Train Acc: 0.9250
 Site-art_painting              (0) | Train Loss: 0.4711 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.3589 | Train Acc: 0.9219
 Site-cartoon                   (1) | Train Loss: 0.4347 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.4877 | Train Acc: 0.8957
 Site-sketch                    (2) | Train Loss: 0.7677 | Train Acc: 0.7586
Average Train Accuracy: 0.9427
 Site-photo                     (3) | Val  Loss: 0.3537 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.1778 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1220 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2211 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.0977 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1961 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1528 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1455 | Val  Acc: 0.9828
 Site-photo                     (3) | Val  Loss: 0.1367 | Val  Acc: 0.9867
 Site-photo                     (3) | Val  Loss: 0.1444 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.2767 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.5039 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.3516 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3321 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.3273 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.6545 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.6193 | Val  Acc: 0.8701
 Site-sketch                    (2) | Val  Loss: 0.7262 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9415
 Best site-photo                    (3)  | Epoch:34 | Val Acc: 0.8889
 Best site-photo                    (3)  | Epoch:34 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:34 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:34 | Val Acc: 0.9524
 Best site-photo                    (3)  | Epoch:34 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:34 | Val Acc: 0.9714
 Best site-photo                    (3)  | Epoch:34 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:34 | Val Acc: 0.9828
 Best site-photo                    (3)  | Epoch:34 | Val Acc: 0.9867
 Best site-photo                    (3)  | Epoch:34 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:34 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:34 | Val Acc: 0.8667
 Best site-art_painting             (0)  | Epoch:34 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:34 | Val Acc: 0.9574
 Best site-art_painting             (3)  | Epoch:34 | Val Acc: 0.9294
 Best site-cartoon                  (1)  | Epoch:34 | Val Acc: 1.0000
 Best site-cartoon                  (1)  | Epoch:34 | Val Acc: 0.8701
 Best site-sketch                   (2)  | Epoch:34 | Val Acc: 0.7949
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 4, 11, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (2) | Train Loss: 0.1718 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3346 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 0.1780 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1067 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1701 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.1148 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2187 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1593 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.1478 | Train Acc: 0.9823
 Site-photo                     (2) | Train Loss: 0.1592 | Train Acc: 0.9726
 Site-art_painting              (1) | Train Loss: 0.4161 | Train Acc: 0.9167
 Site-art_painting              (1) | Train Loss: 0.5603 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.5729 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 0.4937 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.3933 | Train Acc: 0.9062
 Site-cartoon                   (0) | Train Loss: 0.4760 | Train Acc: 0.8182
 Site-cartoon                   (0) | Train Loss: 0.4813 | Train Acc: 0.8870
 Site-sketch                    (3) | Train Loss: 0.7642 | Train Acc: 0.6897
Average Train Accuracy: 0.9173
 Site-photo                     (2) | Val  Loss: 0.2271 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.1955 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.0985 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2370 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.1124 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2157 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.1733 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.1533 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.1112 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.1284 | Val  Acc: 0.9794
 Site-art_painting              (1) | Val  Loss: 0.1759 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.4893 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.3044 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.3529 | Val  Acc: 0.9149
 Site-art_painting              (2) | Val  Loss: 0.3664 | Val  Acc: 0.9176
 Site-cartoon                   (0) | Val  Loss: 0.7616 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.6231 | Val  Acc: 0.8442
 Site-sketch                    (3) | Val  Loss: 0.8077 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9131
============ Train epoch 36 ============
cnt=[2, 8, 1, 7, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (1) | Train Loss: 0.1481 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1363 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1689 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1199 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1895 | Train Acc: 0.9500
 Site-photo                     (3) | Train Loss: 0.1619 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.0696 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1436 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.1647 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.1406 | Train Acc: 0.9795
 Site-art_painting              (1) | Train Loss: 0.3580 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.5354 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.4805 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.3123 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.3309 | Train Acc: 0.9141
 Site-cartoon                   (0) | Train Loss: 0.4549 | Train Acc: 0.8182
 Site-cartoon                   (0) | Train Loss: 0.4409 | Train Acc: 0.9217
 Site-sketch                    (2) | Train Loss: 0.7080 | Train Acc: 0.7931
Average Train Accuracy: 0.9279
 Site-photo                     (1) | Val  Loss: 0.0961 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1807 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.0971 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2485 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.0978 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1920 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.1686 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1393 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.1013 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1378 | Val  Acc: 0.9794
 Site-art_painting              (1) | Val  Loss: 0.2144 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2035 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.2721 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.3766 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.3520 | Val  Acc: 0.9176
 Site-cartoon                   (0) | Val  Loss: 0.6800 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.6390 | Val  Acc: 0.8701
 Site-sketch                    (2) | Val  Loss: 0.6859 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9371
============ Train epoch 37 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (0) | Train Loss: 0.1407 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1648 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1479 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.0992 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1797 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.1429 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.1224 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1480 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.1735 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1750 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.3949 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.4221 | Train Acc: 0.9545
 Site-art_painting              (3) | Train Loss: 0.5206 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.4664 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.3833 | Train Acc: 0.8672
 Site-cartoon                   (2) | Train Loss: 0.3120 | Train Acc: 1.0000
 Site-cartoon                   (2) | Train Loss: 0.4833 | Train Acc: 0.8870
 Site-sketch                    (1) | Train Loss: 0.6150 | Train Acc: 0.8276
Average Train Accuracy: 0.9397
 Site-photo                     (0) | Val  Loss: 0.1097 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1051 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0772 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1523 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1099 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1502 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.1838 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1155 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1076 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1070 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.1855 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.5152 | Val  Acc: 0.8000
 Site-art_painting              (3) | Val  Loss: 0.3586 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.3041 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.3626 | Val  Acc: 0.9059
 Site-cartoon                   (2) | Val  Loss: 0.4851 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.5614 | Val  Acc: 0.9351
 Site-sketch                    (1) | Val  Loss: 0.7246 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9447
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:37 | Val Acc: 0.8000
 Best site-art_painting             (3)  | Epoch:37 | Val Acc: 0.9231
 Best site-art_painting             (3)  | Epoch:37 | Val Acc: 0.9574
 Best site-art_painting             (3)  | Epoch:37 | Val Acc: 0.9059
 Best site-cartoon                  (2)  | Epoch:37 | Val Acc: 0.8571
 Best site-cartoon                  (2)  | Epoch:37 | Val Acc: 0.9351
 Best site-sketch                   (1)  | Epoch:37 | Val Acc: 0.8205
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 38 ============
cnt=[6, 2, 1, 9, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (3) | Train Loss: 0.1452 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1432 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2341 | Train Acc: 0.9167
 Site-photo                     (3) | Train Loss: 0.0977 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1781 | Train Acc: 0.9500
 Site-photo                     (3) | Train Loss: 0.1342 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.0932 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1438 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.1230 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.1228 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.4703 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.4489 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.4228 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3795 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.3479 | Train Acc: 0.9219
 Site-cartoon                   (1) | Train Loss: 0.6084 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.4679 | Train Acc: 0.9043
 Site-sketch                    (2) | Train Loss: 0.6467 | Train Acc: 0.7931
Average Train Accuracy: 0.9303
 Site-photo                     (3) | Val  Loss: 0.3005 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.1992 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.1000 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1869 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.1157 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1456 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1763 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1374 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.1100 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1433 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.2515 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2218 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.2010 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2814 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.3037 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.7618 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.5878 | Val  Acc: 0.9221
 Site-sketch                    (2) | Val  Loss: 0.6909 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9372
============ Train epoch 39 ============
cnt=[5, 2, 1, 10, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (3) | Train Loss: 0.1299 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1591 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.1920 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1187 | Train Acc: 0.9677
 Site-photo                     (3) | Train Loss: 0.1905 | Train Acc: 0.9250
 Site-photo                     (3) | Train Loss: 0.1179 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.0890 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1915 | Train Acc: 0.9432
 Site-photo                     (3) | Train Loss: 0.1104 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.1682 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.3195 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.5868 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 0.4896 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.3640 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.3039 | Train Acc: 0.9375
 Site-cartoon                   (1) | Train Loss: 0.4775 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 0.4619 | Train Acc: 0.9043
 Site-sketch                    (2) | Train Loss: 0.6643 | Train Acc: 0.7759
Average Train Accuracy: 0.9172
 Site-photo                     (3) | Val  Loss: 0.1087 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3189 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.0756 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2239 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.0809 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1743 | Val  Acc: 0.9429
 Site-photo                     (3) | Val  Loss: 0.1525 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1241 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.1008 | Val  Acc: 0.9867
 Site-photo                     (3) | Val  Loss: 0.1353 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.1774 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3161 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.3228 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.2856 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.2974 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.6048 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.5324 | Val  Acc: 0.8831
 Site-sketch                    (2) | Val  Loss: 0.6565 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9441
============ Train epoch 40 ============
cnt=[9, 2, 1, 6, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (0) | Train Loss: 0.1345 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2225 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1709 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.0992 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1578 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.1234 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.1098 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1185 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1474 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.1483 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.3604 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.4490 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.4077 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.2545 | Train Acc: 0.9306
 Site-art_painting              (3) | Train Loss: 0.3185 | Train Acc: 0.9219
 Site-cartoon                   (1) | Train Loss: 0.3710 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.3956 | Train Acc: 0.9304
 Site-sketch                    (2) | Train Loss: 0.7039 | Train Acc: 0.7414
Average Train Accuracy: 0.9373
 Site-photo                     (0) | Val  Loss: 0.1607 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.1050 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0793 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2160 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1029 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1551 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1605 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1459 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1015 | Val  Acc: 0.9867
 Site-photo                     (3) | Val  Loss: 0.1007 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.0975 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.5663 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.4155 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.3573 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.3078 | Val  Acc: 0.8941
 Site-cartoon                   (1) | Val  Loss: 0.6692 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.5109 | Val  Acc: 0.8961
 Site-sketch                    (2) | Val  Loss: 0.6338 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9333
 Test site-photo                     (0)| Epoch:37 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:37 | Test Acc: 0.8782
 Test site-cartoon                   (1)| Epoch:37 | Test Acc: 0.8479
 Test site-sketch                    (2)| Epoch:37 | Test Acc: 0.7281
photo: 0.9896, art_painting: 0.8782, cartoon: 0.8479, sketch: 0.7281, 
Average Test Accuracy(group): 0.8609, Average Test Accuracy(individual): 0.9284,
domain std=0.0931, cluster std=0.0918, individual std=0.0757, 
Average Test Accuracy: 0.8609
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 41 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (0) | Train Loss: 0.1412 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1142 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1893 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1026 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1405 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.0943 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1936 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1570 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.1101 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1451 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.3885 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.4360 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.4865 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.3634 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.2776 | Train Acc: 0.9375
 Site-cartoon                   (2) | Train Loss: 0.4057 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.4078 | Train Acc: 0.9043
 Site-sketch                    (1) | Train Loss: 0.5956 | Train Acc: 0.8448
Average Train Accuracy: 0.9393
 Site-photo                     (0) | Val  Loss: 0.1536 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2735 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.0619 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1548 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0987 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1536 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1493 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1331 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1137 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1308 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 0.4077 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.2398 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.2423 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.2402 | Val  Acc: 0.9787
 Site-art_painting              (3) | Val  Loss: 0.3276 | Val  Acc: 0.8824
 Site-cartoon                   (2) | Val  Loss: 0.5281 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5345 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.5963 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9430
 Test site-photo                     (0)| Epoch:40 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:40 | Test Acc: 0.8782
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.8447
 Test site-sketch                    (1)| Epoch:40 | Test Acc: 0.7306
photo: 0.9896, art_painting: 0.8782, cartoon: 0.8447, sketch: 0.7306, 
Average Test Accuracy(group): 0.8608, Average Test Accuracy(individual): 0.9281,
domain std=0.0923, cluster std=0.0923, individual std=0.0757, 
Average Test Accuracy: 0.8608
============ Train epoch 42 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (0) | Train Loss: 0.0979 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1607 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1470 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0946 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2023 | Train Acc: 0.9000
 Site-photo                     (0) | Train Loss: 0.1006 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0840 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1447 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.1410 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1130 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.3838 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.4330 | Train Acc: 0.9091
 Site-art_painting              (2) | Train Loss: 0.4638 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 0.3352 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.2601 | Train Acc: 0.9375
 Site-cartoon                   (1) | Train Loss: 0.3197 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.4307 | Train Acc: 0.9043
 Site-sketch                    (3) | Train Loss: 0.5764 | Train Acc: 0.8448
Average Train Accuracy: 0.9473
 Site-photo                     (0) | Val  Loss: 0.2672 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.1488 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.0662 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1713 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0808 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1462 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1763 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1376 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.0909 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1261 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.1619 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.4106 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.2073 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.2454 | Val  Acc: 0.9787
 Site-art_painting              (2) | Val  Loss: 0.2908 | Val  Acc: 0.9529
 Site-cartoon                   (1) | Val  Loss: 0.5291 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.5553 | Val  Acc: 0.9091
 Site-sketch                    (3) | Val  Loss: 0.6714 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9555
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.8889
 Best site-photo                    (2)  | Epoch:42 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.9794
 Best site-art_painting             (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:42 | Val Acc: 0.9333
 Best site-art_painting             (2)  | Epoch:42 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:42 | Val Acc: 0.9787
 Best site-art_painting             (2)  | Epoch:42 | Val Acc: 0.9529
 Best site-cartoon                  (1)  | Epoch:42 | Val Acc: 1.0000
 Best site-cartoon                  (1)  | Epoch:42 | Val Acc: 0.9091
 Best site-sketch                   (3)  | Epoch:42 | Val Acc: 0.7949
 Test site-photo                     (0)| Epoch:42 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:42 | Test Acc: 0.8782
 Test site-cartoon                   (1)| Epoch:42 | Test Acc: 0.8383
 Test site-sketch                    (3)| Epoch:42 | Test Acc: 0.7370
photo: 0.9896, art_painting: 0.8782, cartoon: 0.8383, sketch: 0.7370, 
Average Test Accuracy(group): 0.8608, Average Test Accuracy(individual): 0.9278,
domain std=0.0904, cluster std=0.0883, individual std=0.0756, 
Average Test Accuracy: 0.8608
============ Train epoch 43 ============
cnt=[12, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (0) | Train Loss: 0.0910 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1766 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1504 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.0930 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1412 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.0984 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1103 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1339 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.1183 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1599 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.4431 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.6301 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 0.4024 | Train Acc: 0.9000
 Site-art_painting              (3) | Train Loss: 0.3257 | Train Acc: 0.9583
 Site-art_painting              (3) | Train Loss: 0.2997 | Train Acc: 0.9297
 Site-cartoon                   (1) | Train Loss: 0.4016 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.3749 | Train Acc: 0.9391
 Site-sketch                    (2) | Train Loss: 0.5800 | Train Acc: 0.8448
Average Train Accuracy: 0.9421
 Site-photo                     (0) | Val  Loss: 0.2284 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.0916 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0698 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2337 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1650 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1730 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1395 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.0983 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1262 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.0897 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2747 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.2468 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.3078 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.2904 | Val  Acc: 0.9647
 Site-cartoon                   (1) | Val  Loss: 0.7517 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.4850 | Val  Acc: 0.9221
 Site-sketch                    (2) | Val  Loss: 0.6432 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9494
 Test site-photo                     (0)| Epoch:42 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:42 | Test Acc: 0.8721
 Test site-cartoon                   (1)| Epoch:42 | Test Acc: 0.8457
 Test site-sketch                    (2)| Epoch:42 | Test Acc: 0.7351
photo: 0.9896, art_painting: 0.8721, cartoon: 0.8457, sketch: 0.7351, 
Average Test Accuracy(group): 0.8606, Average Test Accuracy(individual): 0.9268,
domain std=0.0905, cluster std=0.0836, individual std=0.0761, 
Average Test Accuracy: 0.8606
============ Train epoch 44 ============
cnt=[11, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (0) | Train Loss: 0.1118 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1595 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1958 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.0839 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1752 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.0999 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1887 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1381 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.1073 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1112 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.3428 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.3552 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.5144 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.3434 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.2411 | Train Acc: 0.9609
 Site-cartoon                   (1) | Train Loss: 0.3549 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.3911 | Train Acc: 0.9043
 Site-sketch                    (2) | Train Loss: 0.5246 | Train Acc: 0.8793
Average Train Accuracy: 0.9470
 Site-photo                     (0) | Val  Loss: 0.1922 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.1738 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.0581 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1261 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0892 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1821 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.1670 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1131 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.0883 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1037 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 0.0783 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.1894 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.2247 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.2142 | Val  Acc: 0.9787
 Site-art_painting              (3) | Val  Loss: 0.3177 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.8713 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.4374 | Val  Acc: 0.8961
 Site-sketch                    (2) | Val  Loss: 0.5667 | Val  Acc: 0.8462
Average Valid Accuracy: 0.9416
 Test site-photo                     (0)| Epoch:42 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:42 | Test Acc: 0.8782
 Test site-cartoon                   (1)| Epoch:42 | Test Acc: 0.8436
 Test site-sketch                    (2)| Epoch:42 | Test Acc: 0.7357
photo: 0.9896, art_painting: 0.8782, cartoon: 0.8436, sketch: 0.7357, 
Average Test Accuracy(group): 0.8618, Average Test Accuracy(individual): 0.9283,
domain std=0.0906, cluster std=0.0862, individual std=0.0751, 
Average Test Accuracy: 0.8618
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 45 ============
cnt=[5, 2, 1, 10, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (3) | Train Loss: 0.0927 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1809 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.1607 | Train Acc: 0.9583
 Site-photo                     (3) | Train Loss: 0.0786 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1802 | Train Acc: 0.9250
 Site-photo                     (3) | Train Loss: 0.0806 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0815 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1801 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.1165 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.1525 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.3414 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.4136 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.3715 | Train Acc: 0.9250
 Site-art_painting              (0) | Train Loss: 0.2148 | Train Acc: 0.9444
 Site-art_painting              (0) | Train Loss: 0.2835 | Train Acc: 0.9375
 Site-cartoon                   (1) | Train Loss: 0.3014 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.3759 | Train Acc: 0.9391
 Site-sketch                    (2) | Train Loss: 0.6138 | Train Acc: 0.7931
Average Train Accuracy: 0.9455
 Site-photo                     (3) | Val  Loss: 0.2904 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.1224 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.0550 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2290 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.0913 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1778 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1430 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1374 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.0879 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1440 | Val  Acc: 0.9588
 Site-art_painting              (0) | Val  Loss: 0.1146 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3272 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.1898 | Val  Acc: 0.9615
 Site-art_painting              (0) | Val  Loss: 0.2392 | Val  Acc: 0.9574
 Site-art_painting              (0) | Val  Loss: 0.2724 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.5339 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.5431 | Val  Acc: 0.8961
 Site-sketch                    (2) | Val  Loss: 0.6161 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9337
 Test site-photo                     (3)| Epoch:44 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:44 | Test Acc: 0.8806
 Test site-cartoon                   (1)| Epoch:44 | Test Acc: 0.8404
 Test site-sketch                    (2)| Epoch:44 | Test Acc: 0.7408
photo: 0.9896, art_painting: 0.8806, cartoon: 0.8404, sketch: 0.7408, 
Average Test Accuracy(group): 0.8628, Average Test Accuracy(individual): 0.9289,
domain std=0.0891, cluster std=0.0891, individual std=0.0743, 
Average Test Accuracy: 0.8628
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 12, 1, 3, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (1) | Train Loss: 0.1189 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2084 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 0.1464 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.0852 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1655 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.0745 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1024 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1271 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.1101 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.1056 | Train Acc: 0.9863
 Site-art_painting              (1) | Train Loss: 0.4352 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.2966 | Train Acc: 0.9545
 Site-art_painting              (3) | Train Loss: 0.4387 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.2780 | Train Acc: 0.9722
 Site-art_painting              (3) | Train Loss: 0.2722 | Train Acc: 0.9531
 Site-cartoon                   (0) | Train Loss: 0.3926 | Train Acc: 0.8182
 Site-cartoon                   (0) | Train Loss: 0.3662 | Train Acc: 0.9217
 Site-sketch                    (2) | Train Loss: 0.5784 | Train Acc: 0.8276
Average Train Accuracy: 0.9371
 Site-photo                     (1) | Val  Loss: 0.3012 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.1889 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.0557 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1205 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.0869 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1218 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.1512 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1269 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.0785 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1009 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.1838 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 0.3351 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.3750 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.3033 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.2115 | Val  Acc: 0.9529
 Site-cartoon                   (0) | Val  Loss: 0.6832 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.4806 | Val  Acc: 0.9351
 Site-sketch                    (2) | Val  Loss: 0.7210 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9306
 Test site-photo                     (1)| Epoch:45 | Test Acc: 0.9881
 Test site-art_painting              (1)| Epoch:45 | Test Acc: 0.8831
 Test site-cartoon                   (0)| Epoch:45 | Test Acc: 0.8394
 Test site-sketch                    (2)| Epoch:45 | Test Acc: 0.7490
photo: 0.9881, art_painting: 0.8831, cartoon: 0.8394, sketch: 0.7490, 
Average Test Accuracy(group): 0.8649, Average Test Accuracy(individual): 0.9291,
domain std=0.0860, cluster std=0.0798, individual std=0.0722, 
Average Test Accuracy: 0.8649
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 11, 1, 4, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (1) | Train Loss: 0.0838 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2565 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.1538 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0707 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1396 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.0982 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.0739 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.1380 | Train Acc: 0.9659
 Site-photo                     (1) | Train Loss: 0.0924 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.0966 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.3998 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.5910 | Train Acc: 0.8182
 Site-art_painting              (3) | Train Loss: 0.4169 | Train Acc: 0.9250
 Site-art_painting              (3) | Train Loss: 0.3600 | Train Acc: 0.9583
 Site-art_painting              (3) | Train Loss: 0.2279 | Train Acc: 0.9688
 Site-cartoon                   (0) | Train Loss: 0.4758 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 0.3938 | Train Acc: 0.9217
 Site-sketch                    (2) | Train Loss: 0.5524 | Train Acc: 0.8103
Average Train Accuracy: 0.9312
 Site-photo                     (1) | Val  Loss: 0.1040 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0942 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0885 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0908 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.0843 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1178 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.1396 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1317 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.0731 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0958 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.2221 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 0.3545 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.1888 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.2145 | Val  Acc: 0.9787
 Site-art_painting              (3) | Val  Loss: 0.2470 | Val  Acc: 0.9412
 Site-cartoon                   (0) | Val  Loss: 0.5510 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.4571 | Val  Acc: 0.9351
 Site-sketch                    (2) | Val  Loss: 0.5915 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9442
 Test site-photo                     (1)| Epoch:46 | Test Acc: 0.9881
 Test site-art_painting              (3)| Epoch:46 | Test Acc: 0.8843
 Test site-cartoon                   (0)| Epoch:46 | Test Acc: 0.8415
 Test site-sketch                    (2)| Epoch:46 | Test Acc: 0.7503
photo: 0.9881, art_painting: 0.8843, cartoon: 0.8415, sketch: 0.7503, 
Average Test Accuracy(group): 0.8660, Average Test Accuracy(individual): 0.9297,
domain std=0.0855, cluster std=0.0821, individual std=0.0715, 
Average Test Accuracy: 0.8660
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 11, 1, 4, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (1) | Train Loss: 0.0883 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1417 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.1377 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0727 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1561 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.1129 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.1064 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1221 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.1098 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.1165 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.3330 | Train Acc: 0.9167
 Site-art_painting              (1) | Train Loss: 0.3520 | Train Acc: 0.9545
 Site-art_painting              (3) | Train Loss: 0.4573 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.2506 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.2510 | Train Acc: 0.9531
 Site-cartoon                   (0) | Train Loss: 0.3163 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 0.3703 | Train Acc: 0.8957
 Site-sketch                    (2) | Train Loss: 0.5622 | Train Acc: 0.8276
Average Train Accuracy: 0.9453
 Site-photo                     (1) | Val  Loss: 0.2219 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.2699 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.0702 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1171 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.0853 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1473 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.1441 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1308 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.0710 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1000 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 0.0928 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.1692 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.3441 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.2121 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.2546 | Val  Acc: 0.9294
 Site-cartoon                   (0) | Val  Loss: 0.4496 | Val  Acc: 1.0000
 Site-cartoon                   (0) | Val  Loss: 0.5207 | Val  Acc: 0.9091
 Site-sketch                    (2) | Val  Loss: 0.6157 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9523
 Test site-photo                     (1)| Epoch:47 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:47 | Test Acc: 0.8879
 Test site-cartoon                   (0)| Epoch:47 | Test Acc: 0.8436
 Test site-sketch                    (2)| Epoch:47 | Test Acc: 0.7427
photo: 0.9896, art_painting: 0.8879, cartoon: 0.8436, sketch: 0.7427, 
Average Test Accuracy(group): 0.8660, Average Test Accuracy(individual): 0.9314,
domain std=0.0887, cluster std=0.0855, individual std=0.0724, 
Average Test Accuracy: 0.8660
============ Train epoch 49 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (0) | Train Loss: 0.1029 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1524 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1395 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0928 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.1363 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.1121 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.0479 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1230 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.0962 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.0916 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.3037 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.3975 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.3635 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.4641 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.2322 | Train Acc: 0.9688
 Site-cartoon                   (1) | Train Loss: 0.2946 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.3510 | Train Acc: 0.9043
 Site-sketch                    (2) | Train Loss: 0.5218 | Train Acc: 0.8276
Average Train Accuracy: 0.9466
 Site-photo                     (0) | Val  Loss: 0.1274 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0847 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0678 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1256 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0918 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1279 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1771 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1284 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.0847 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1099 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.1905 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.0948 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.3189 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.2625 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.2513 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.3564 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.4550 | Val  Acc: 0.9221
 Site-sketch                    (2) | Val  Loss: 0.6102 | Val  Acc: 0.7692
Average Valid Accuracy: 0.9608
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:49 | Val Acc: 0.9691
 Best site-art_painting             (3)  | Epoch:49 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:49 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:49 | Val Acc: 0.9231
 Best site-art_painting             (3)  | Epoch:49 | Val Acc: 0.9362
 Best site-art_painting             (3)  | Epoch:49 | Val Acc: 0.9294
 Best site-cartoon                  (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-cartoon                  (1)  | Epoch:49 | Val Acc: 0.9221
 Best site-sketch                   (2)  | Epoch:49 | Val Acc: 0.7692
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (3)| Epoch:49 | Test Acc: 0.8843
 Test site-cartoon                   (1)| Epoch:49 | Test Acc: 0.8436
 Test site-sketch                    (2)| Epoch:49 | Test Acc: 0.7459
photo: 0.9896, art_painting: 0.8843, cartoon: 0.8436, sketch: 0.7459, 
Average Test Accuracy(group): 0.8658, Average Test Accuracy(individual): 0.9306,
domain std=0.0874, cluster std=0.0874, individual std=0.0725, 
Average Test Accuracy: 0.8658
===2023-08-07 11:53:16===
===2023-08-07 11:53:33===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
Loading snapshots...
 Test site-photo                     (1)| Epoch:47 | Test Acc: 0.9881
 Test site-art_painting              (3)| Epoch:47 | Test Acc: 0.8843
 Test site-cartoon                   (0)| Epoch:47 | Test Acc: 0.8415
 Test site-sketch                    (2)| Epoch:47 | Test Acc: 0.7503
photo: 0.9881, art_painting: 0.8843, cartoon: 0.8415, sketch: 0.7503, 
Average Test Accuracy(group): 0.8660, Average Test Accuracy(individual): 0.9297,
domain std=0.0855, cluster std=0.0821, individual std=0.0715, 
