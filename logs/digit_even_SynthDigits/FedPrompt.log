===2023-03-26 15:08:05===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 4
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7075 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.7119 | Train Acc: 0.5856
 Site-SVHN      | Train Loss: 2.2109 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.2292 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.6426 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 1.7072 | Train Acc: 0.7117
 Site-MNIST-M   | Train Loss: 2.1721 | Train Acc: 0.1982
 Site-MNIST-M   | Train Loss: 2.1460 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 1.7138 | Val  Acc: 0.5811
 Site-MNIST     | Val  Loss: 1.6587 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 2.2615 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.2031 | Val  Acc: 0.1892
 Site-USPS      | Val  Loss: 1.7000 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 1.6692 | Val  Acc: 0.6892
 Site-MNIST-M   | Val  Loss: 2.1409 | Val  Acc: 0.2568
 Site-MNIST-M   | Val  Loss: 2.1457 | Val  Acc: 0.1892
Average Valid Accuracy: 0.4291
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5811
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-USPS       | Epoch:0 | Val Acc: 0.6892
 Best site-USPS       | Epoch:0 | Val Acc: 0.6892
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2568
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2563 | Train Acc: 0.6937
 Site-MNIST     | Train Loss: 1.2812 | Train Acc: 0.7117
 Site-SVHN      | Train Loss: 2.1163 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.1237 | Train Acc: 0.2523
 Site-USPS      | Train Loss: 1.1756 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 1.2237 | Train Acc: 0.8198
 Site-MNIST-M   | Train Loss: 1.9734 | Train Acc: 0.3694
 Site-MNIST-M   | Train Loss: 1.9567 | Train Acc: 0.3243
 Site-MNIST     | Val  Loss: 1.2916 | Val  Acc: 0.7027
 Site-MNIST     | Val  Loss: 1.2055 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 2.1532 | Val  Acc: 0.2162
 Site-SVHN      | Val  Loss: 2.0531 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 1.2391 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 1.1976 | Val  Acc: 0.8108
 Site-MNIST-M   | Val  Loss: 1.9364 | Val  Acc: 0.3514
 Site-MNIST-M   | Val  Loss: 1.9662 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5405
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7027
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2162
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3243
 Best site-USPS       | Epoch:1 | Val Acc: 0.8108
 Best site-USPS       | Epoch:1 | Val Acc: 0.8108
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3514
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8931 | Train Acc: 0.7477
 Site-MNIST     | Train Loss: 0.9486 | Train Acc: 0.7838
 Site-SVHN      | Train Loss: 1.9974 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.9641 | Train Acc: 0.3243
 Site-USPS      | Train Loss: 0.7674 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.8223 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 1.8162 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 1.8262 | Train Acc: 0.3514
 Site-MNIST     | Val  Loss: 0.9808 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.8523 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 2.0537 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 1.8624 | Val  Acc: 0.3378
 Site-USPS      | Val  Loss: 0.8405 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.7941 | Val  Acc: 0.8919
 Site-MNIST-M   | Val  Loss: 1.8167 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 1.7658 | Val  Acc: 0.4459
Average Valid Accuracy: 0.5845
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3378
 Best site-USPS       | Epoch:2 | Val Acc: 0.8378
 Best site-USPS       | Epoch:2 | Val Acc: 0.8919
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6735 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 0.7425 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 1.8204 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.7882 | Train Acc: 0.3964
 Site-USPS      | Train Loss: 0.5278 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.5856 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 1.5177 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.5134 | Train Acc: 0.5225
 Site-MNIST     | Val  Loss: 0.7744 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 0.6668 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 1.8473 | Val  Acc: 0.3378
 Site-SVHN      | Val  Loss: 1.7341 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.6071 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.5360 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 1.4813 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.4685 | Val  Acc: 0.5946
Average Valid Accuracy: 0.6639
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4459
 Best site-USPS       | Epoch:3 | Val Acc: 0.8784
 Best site-USPS       | Epoch:3 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 20 ============
===2023-03-26 15:22:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 4
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7075 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.7119 | Train Acc: 0.5856
 Site-SVHN      | Train Loss: 2.2109 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.2292 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.6426 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 1.7072 | Train Acc: 0.7117
 Site-MNIST-M   | Train Loss: 2.1721 | Train Acc: 0.1982
 Site-MNIST-M   | Train Loss: 2.1460 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 1.7138 | Val  Acc: 0.5811
 Site-MNIST     | Val  Loss: 1.6587 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 2.2615 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.2031 | Val  Acc: 0.1892
 Site-USPS      | Val  Loss: 1.7000 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 1.6692 | Val  Acc: 0.6892
 Site-MNIST-M   | Val  Loss: 2.1409 | Val  Acc: 0.2568
 Site-MNIST-M   | Val  Loss: 2.1457 | Val  Acc: 0.1892
Average Valid Accuracy: 0.4291
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5811
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-USPS       | Epoch:0 | Val Acc: 0.6892
 Best site-USPS       | Epoch:0 | Val Acc: 0.6892
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2568
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2563 | Train Acc: 0.6937
 Site-MNIST     | Train Loss: 1.2812 | Train Acc: 0.7117
 Site-SVHN      | Train Loss: 2.1163 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.1237 | Train Acc: 0.2523
 Site-USPS      | Train Loss: 1.1756 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 1.2237 | Train Acc: 0.8198
 Site-MNIST-M   | Train Loss: 1.9734 | Train Acc: 0.3694
 Site-MNIST-M   | Train Loss: 1.9567 | Train Acc: 0.3243
 Site-MNIST     | Val  Loss: 1.2916 | Val  Acc: 0.7027
 Site-MNIST     | Val  Loss: 1.2055 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 2.1532 | Val  Acc: 0.2162
 Site-SVHN      | Val  Loss: 2.0531 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 1.2391 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 1.1976 | Val  Acc: 0.8108
 Site-MNIST-M   | Val  Loss: 1.9364 | Val  Acc: 0.3514
 Site-MNIST-M   | Val  Loss: 1.9662 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5405
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7027
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2162
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3243
 Best site-USPS       | Epoch:1 | Val Acc: 0.8108
 Best site-USPS       | Epoch:1 | Val Acc: 0.8108
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3514
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8931 | Train Acc: 0.7477
 Site-MNIST     | Train Loss: 0.9486 | Train Acc: 0.7838
 Site-SVHN      | Train Loss: 1.9974 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.9641 | Train Acc: 0.3243
 Site-USPS      | Train Loss: 0.7674 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.8223 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 1.8162 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 1.8262 | Train Acc: 0.3514
 Site-MNIST     | Val  Loss: 0.9808 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.8523 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 2.0537 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 1.8624 | Val  Acc: 0.3378
 Site-USPS      | Val  Loss: 0.8405 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.7941 | Val  Acc: 0.8919
 Site-MNIST-M   | Val  Loss: 1.8167 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 1.7658 | Val  Acc: 0.4459
Average Valid Accuracy: 0.5845
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3378
 Best site-USPS       | Epoch:2 | Val Acc: 0.8378
 Best site-USPS       | Epoch:2 | Val Acc: 0.8919
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6735 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 0.7425 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 1.8204 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.7882 | Train Acc: 0.3964
 Site-USPS      | Train Loss: 0.5278 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.5856 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 1.5177 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.5134 | Train Acc: 0.5225
 Site-MNIST     | Val  Loss: 0.7744 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 0.6668 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 1.8473 | Val  Acc: 0.3378
 Site-SVHN      | Val  Loss: 1.7341 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.6071 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.5360 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 1.4813 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.4685 | Val  Acc: 0.5946
Average Valid Accuracy: 0.6639
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4459
 Best site-USPS       | Epoch:3 | Val Acc: 0.8784
 Best site-USPS       | Epoch:3 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4347 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.5140 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 1.7871 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.7378 | Train Acc: 0.4234
 Site-USPS      | Train Loss: 0.4344 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.4798 | Train Acc: 0.8919
 Site-MNIST-M   | Train Loss: 1.3866 | Train Acc: 0.5676
 Site-MNIST-M   | Train Loss: 1.4400 | Train Acc: 0.5225
 Site-MNIST     | Val  Loss: 0.5110 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.4603 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.7702 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.7738 | Val  Acc: 0.3649
 Site-USPS      | Val  Loss: 0.5037 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.4486 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 1.3884 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.3778 | Val  Acc: 0.5811
Average Valid Accuracy: 0.6824
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3649
 Best site-USPS       | Epoch:4 | Val Acc: 0.8784
 Best site-USPS       | Epoch:4 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4636 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.5113 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.5054 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.4867 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 0.4089 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.4458 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 1.0088 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 0.9680 | Train Acc: 0.7568
 Site-MNIST     | Val  Loss: 0.5424 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.4831 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 1.5688 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.4376 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 0.4463 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.4348 | Val  Acc: 0.8649
 Site-MNIST-M   | Val  Loss: 0.9426 | Val  Acc: 0.7162
 Site-MNIST-M   | Val  Loss: 0.9216 | Val  Acc: 0.8378
Average Valid Accuracy: 0.7618
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5811
 Best site-USPS       | Epoch:5 | Val Acc: 0.8649
 Best site-USPS       | Epoch:5 | Val Acc: 0.8649
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7162
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.8378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2558 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.3034 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 1.4169 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 1.3155 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 0.2837 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3120 | Train Acc: 0.9279
 Site-MNIST-M   | Train Loss: 0.9461 | Train Acc: 0.7207
 Site-MNIST-M   | Train Loss: 1.0044 | Train Acc: 0.7027
 Site-MNIST     | Val  Loss: 0.2881 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.2917 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.3696 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 1.3338 | Val  Acc: 0.5405
 Site-USPS      | Val  Loss: 0.3193 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2988 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 0.9625 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 0.9369 | Val  Acc: 0.7838
Average Valid Accuracy: 0.8007
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5405
 Best site-USPS       | Epoch:6 | Val Acc: 0.9324
 Best site-USPS       | Epoch:6 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1881 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.2204 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 1.0440 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 1.0557 | Train Acc: 0.7387
 Site-USPS      | Train Loss: 0.1952 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2024 | Train Acc: 0.9550
 Site-MNIST-M   | Train Loss: 0.5053 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 0.5245 | Train Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.2156 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.2209 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 1.1028 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 1.0491 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 0.2060 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.1962 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 0.5094 | Val  Acc: 0.8784
 Site-MNIST-M   | Val  Loss: 0.4679 | Val  Acc: 0.9324
Average Valid Accuracy: 0.8851
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6892
 Best site-USPS       | Epoch:7 | Val Acc: 0.9595
 Best site-USPS       | Epoch:7 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8784
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1117 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1393 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.7965 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 0.7375 | Train Acc: 0.8468
 Site-USPS      | Train Loss: 0.1534 | Train Acc: 0.9550
 Site-USPS      | Train Loss: 0.1316 | Train Acc: 0.9730
 Site-MNIST-M   | Train Loss: 0.4029 | Train Acc: 0.9550
 Site-MNIST-M   | Train Loss: 0.4583 | Train Acc: 0.9099
 Site-MNIST     | Val  Loss: 0.1302 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1341 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.7748 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 0.7356 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 0.1391 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1290 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 0.4422 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.3903 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9274
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8243
 Best site-USPS       | Epoch:8 | Val Acc: 0.9730
 Best site-USPS       | Epoch:8 | Val Acc: 0.9595
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1238 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.1575 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 0.6896 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 0.6910 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.1156 | Train Acc: 0.9550
 Site-USPS      | Train Loss: 0.0889 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.2475 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.2638 | Train Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1631 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1551 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.7256 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 0.6825 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.0886 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0938 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 0.2633 | Val  Acc: 0.9730
 Site-MNIST-M   | Val  Loss: 0.2169 | Val  Acc: 0.9865
Average Valid Accuracy: 0.9426
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8378
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 0.9595
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9730
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_SynthDigits...
===2023-03-26 15:56:10===
===2023-03-26 15:56:11===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 4
Loading snapshots...
Test Accuracy of SynthDigits: 0.4350
Average Test Accuracy: 0.4350
