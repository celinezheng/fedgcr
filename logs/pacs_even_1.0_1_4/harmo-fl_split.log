===2023-08-16 16:55:56===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     | Epoch:47 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:47 | Test Acc: 0.9391
 Test site-cartoon                   | Epoch:47 | Test Acc: 0.8809
 Test site-sketch                    | Epoch:47 | Test Acc: 0.7751
photo: 0.9985, art_painting: 0.9391, cartoon: 0.8809, sketch: 0.7751, 
Average Test Accuracy(group): 0.8984, Average Test Accuracy(individual): 0.8984,
domain std=0.0824, cluster std=-1.0000, individual std=0.0824, 
===2023-08-16 17:05:17===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
===2023-08-16 17:09:21===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo-0                   | Epoch:47 | Test Acc: 1.0000
 Test site-photo-1                   | Epoch:47 | Test Acc: 0.9980
 Test site-art_painting-0            | Epoch:47 | Test Acc: 0.9415
 Test site-art_painting-1            | Epoch:47 | Test Acc: 0.9382
 Test site-cartoon-0                 | Epoch:47 | Test Acc: 0.8723
 Test site-cartoon-1                 | Epoch:47 | Test Acc: 0.8837
 Test site-sketch-0                  | Epoch:47 | Test Acc: 0.7964
 Test site-sketch-1                  | Epoch:47 | Test Acc: 0.7686
photo-0: 1.0000, photo-1: 0.9980, art_painting-0: 0.9415, art_painting-1: 0.9382, cartoon-0: 0.8723, cartoon-1: 0.8837, sketch-0: 0.7964, sketch-1: 0.7686, 
Average Test Accuracy(group): 0.8998, Average Test Accuracy(individual): 0.8998,
domain std=0.0805, cluster std=-1.0000, individual std=0.0805, 
===2023-08-17 00:14:56===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
 Site-photo-0                       | Train Loss: 0.5013 | Train Acc: 0.9800
 Site-photo-1                       | Train Loss: 0.4643 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.9857 | Train Acc: 0.8267
 Site-art_painting-1                | Train Loss: 0.9013 | Train Acc: 0.8556
 Site-cartoon-0                     | Train Loss: 1.1318 | Train Acc: 0.6933
 Site-cartoon-1                     | Train Loss: 1.1059 | Train Acc: 0.7311
 Site-sketch-0                      | Train Loss: 1.3468 | Train Acc: 0.6533
 Site-sketch-1                      | Train Loss: 1.3525 | Train Acc: 0.6022
Average Train Accuracy: 0.7914
 Best site-photo-0                   | Epoch:0 | Val Acc: 0.9800
 Best site-photo-1                   | Epoch:0 | Val Acc: 0.9889
 Best site-art_painting-0            | Epoch:0 | Val Acc: 0.8267
 Best site-art_painting-1            | Epoch:0 | Val Acc: 0.8556
 Best site-cartoon-0                 | Epoch:0 | Val Acc: 0.6933
 Best site-cartoon-1                 | Epoch:0 | Val Acc: 0.7311
 Best site-sketch-0                  | Epoch:0 | Val Acc: 0.6533
 Best site-sketch-1                  | Epoch:0 | Val Acc: 0.6022
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 1 ============
 Site-photo-0                       | Train Loss: 0.1451 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.1222 | Train Acc: 0.9956
 Site-art_painting-0                | Train Loss: 0.6559 | Train Acc: 0.8400
 Site-art_painting-1                | Train Loss: 0.5220 | Train Acc: 0.8733
 Site-cartoon-0                     | Train Loss: 0.8032 | Train Acc: 0.7267
 Site-cartoon-1                     | Train Loss: 0.7689 | Train Acc: 0.7756
 Site-sketch-0                      | Train Loss: 1.0904 | Train Acc: 0.6600
 Site-sketch-1                      | Train Loss: 1.0519 | Train Acc: 0.6511
Average Train Accuracy: 0.8136
 Best site-photo-0                   | Epoch:1 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:1 | Val Acc: 0.9956
 Best site-art_painting-0            | Epoch:1 | Val Acc: 0.8400
 Best site-art_painting-1            | Epoch:1 | Val Acc: 0.8733
 Best site-cartoon-0                 | Epoch:1 | Val Acc: 0.7267
 Best site-cartoon-1                 | Epoch:1 | Val Acc: 0.7756
 Best site-sketch-0                  | Epoch:1 | Val Acc: 0.6600
 Best site-sketch-1                  | Epoch:1 | Val Acc: 0.6511
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 2 ============
 Site-photo-0                       | Train Loss: 0.0914 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0640 | Train Acc: 0.9911
 Site-art_painting-0                | Train Loss: 0.5449 | Train Acc: 0.8533
 Site-art_painting-1                | Train Loss: 0.4019 | Train Acc: 0.8911
 Site-cartoon-0                     | Train Loss: 0.6464 | Train Acc: 0.7800
 Site-cartoon-1                     | Train Loss: 0.6037 | Train Acc: 0.8044
 Site-sketch-0                      | Train Loss: 0.9727 | Train Acc: 0.6733
 Site-sketch-1                      | Train Loss: 0.9772 | Train Acc: 0.6667
Average Train Accuracy: 0.8308
 Best site-photo-0                   | Epoch:2 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:2 | Val Acc: 0.9911
 Best site-art_painting-0            | Epoch:2 | Val Acc: 0.8533
 Best site-art_painting-1            | Epoch:2 | Val Acc: 0.8911
 Best site-cartoon-0                 | Epoch:2 | Val Acc: 0.7800
 Best site-cartoon-1                 | Epoch:2 | Val Acc: 0.8044
 Best site-sketch-0                  | Epoch:2 | Val Acc: 0.6733
 Best site-sketch-1                  | Epoch:2 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 3 ============
 Site-photo-0                       | Train Loss: 0.0603 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0370 | Train Acc: 0.9933
 Site-art_painting-0                | Train Loss: 0.4556 | Train Acc: 0.8600
 Site-art_painting-1                | Train Loss: 0.3799 | Train Acc: 0.9311
 Site-cartoon-0                     | Train Loss: 0.6242 | Train Acc: 0.8000
 Site-cartoon-1                     | Train Loss: 0.6111 | Train Acc: 0.8333
 Site-sketch-0                      | Train Loss: 0.9187 | Train Acc: 0.7400
 Site-sketch-1                      | Train Loss: 0.8627 | Train Acc: 0.6933
Average Train Accuracy: 0.8556
 Best site-photo-0                   | Epoch:3 | Val Acc: 0.9933
 Best site-photo-1                   | Epoch:3 | Val Acc: 0.9933
 Best site-art_painting-0            | Epoch:3 | Val Acc: 0.8600
 Best site-art_painting-1            | Epoch:3 | Val Acc: 0.9311
 Best site-cartoon-0                 | Epoch:3 | Val Acc: 0.8000
 Best site-cartoon-1                 | Epoch:3 | Val Acc: 0.8333
 Best site-sketch-0                  | Epoch:3 | Val Acc: 0.7400
 Best site-sketch-1                  | Epoch:3 | Val Acc: 0.6933
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 4 ============
 Site-photo-0                       | Train Loss: 0.0490 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0405 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.4428 | Train Acc: 0.8600
 Site-art_painting-1                | Train Loss: 0.3005 | Train Acc: 0.9156
 Site-cartoon-0                     | Train Loss: 0.7160 | Train Acc: 0.7133
 Site-cartoon-1                     | Train Loss: 0.5822 | Train Acc: 0.8267
 Site-sketch-0                      | Train Loss: 0.8264 | Train Acc: 0.7533
 Site-sketch-1                      | Train Loss: 0.8850 | Train Acc: 0.6978
Average Train Accuracy: 0.8428
============ Train epoch 5 ============
 Site-photo-0                       | Train Loss: 0.0513 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0348 | Train Acc: 0.9889
 Site-art_painting-0                | Train Loss: 0.4637 | Train Acc: 0.8533
 Site-art_painting-1                | Train Loss: 0.3003 | Train Acc: 0.9200
 Site-cartoon-0                     | Train Loss: 0.5818 | Train Acc: 0.8000
 Site-cartoon-1                     | Train Loss: 0.4701 | Train Acc: 0.8267
 Site-sketch-0                      | Train Loss: 0.8021 | Train Acc: 0.7067
 Site-sketch-1                      | Train Loss: 0.7395 | Train Acc: 0.7289
Average Train Accuracy: 0.8514
============ Train epoch 6 ============
 Site-photo-0                       | Train Loss: 0.0383 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0227 | Train Acc: 0.9956
 Site-art_painting-0                | Train Loss: 0.3892 | Train Acc: 0.9000
 Site-art_painting-1                | Train Loss: 0.2660 | Train Acc: 0.9244
 Site-cartoon-0                     | Train Loss: 0.4847 | Train Acc: 0.8267
 Site-cartoon-1                     | Train Loss: 0.4555 | Train Acc: 0.8622
 Site-sketch-0                      | Train Loss: 0.7853 | Train Acc: 0.7133
 Site-sketch-1                      | Train Loss: 0.7726 | Train Acc: 0.7244
Average Train Accuracy: 0.8675
 Best site-photo-0                   | Epoch:6 | Val Acc: 0.9933
 Best site-photo-1                   | Epoch:6 | Val Acc: 0.9956
 Best site-art_painting-0            | Epoch:6 | Val Acc: 0.9000
 Best site-art_painting-1            | Epoch:6 | Val Acc: 0.9244
 Best site-cartoon-0                 | Epoch:6 | Val Acc: 0.8267
 Best site-cartoon-1                 | Epoch:6 | Val Acc: 0.8622
 Best site-sketch-0                  | Epoch:6 | Val Acc: 0.7133
 Best site-sketch-1                  | Epoch:6 | Val Acc: 0.7244
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 7 ============
 Site-photo-0                       | Train Loss: 0.0444 | Train Acc: 0.9800
 Site-photo-1                       | Train Loss: 0.0185 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.3939 | Train Acc: 0.9000
 Site-art_painting-1                | Train Loss: 0.2524 | Train Acc: 0.9311
 Site-cartoon-0                     | Train Loss: 0.5233 | Train Acc: 0.8267
 Site-cartoon-1                     | Train Loss: 0.6075 | Train Acc: 0.8644
 Site-sketch-0                      | Train Loss: 0.7690 | Train Acc: 0.6867
 Site-sketch-1                      | Train Loss: 0.7004 | Train Acc: 0.7356
Average Train Accuracy: 0.8653
============ Train epoch 8 ============
 Site-photo-0                       | Train Loss: 0.0377 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0144 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.3309 | Train Acc: 0.9067
 Site-art_painting-1                | Train Loss: 0.2244 | Train Acc: 0.9467
 Site-cartoon-0                     | Train Loss: 0.5141 | Train Acc: 0.8000
 Site-cartoon-1                     | Train Loss: 0.3984 | Train Acc: 0.8756
 Site-sketch-0                      | Train Loss: 0.7358 | Train Acc: 0.7200
 Site-sketch-1                      | Train Loss: 0.7564 | Train Acc: 0.7689
Average Train Accuracy: 0.8753
 Best site-photo-0                   | Epoch:8 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:8 | Val Acc: 0.9978
 Best site-art_painting-0            | Epoch:8 | Val Acc: 0.9067
 Best site-art_painting-1            | Epoch:8 | Val Acc: 0.9467
 Best site-cartoon-0                 | Epoch:8 | Val Acc: 0.8000
 Best site-cartoon-1                 | Epoch:8 | Val Acc: 0.8756
 Best site-sketch-0                  | Epoch:8 | Val Acc: 0.7200
 Best site-sketch-1                  | Epoch:8 | Val Acc: 0.7689
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 9 ============
 Site-photo-0                       | Train Loss: 0.0335 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0126 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.3648 | Train Acc: 0.8867
 Site-art_painting-1                | Train Loss: 0.1815 | Train Acc: 0.9756
 Site-cartoon-0                     | Train Loss: 0.4538 | Train Acc: 0.8333
 Site-cartoon-1                     | Train Loss: 0.4028 | Train Acc: 0.8933
 Site-sketch-0                      | Train Loss: 0.7135 | Train Acc: 0.7267
 Site-sketch-1                      | Train Loss: 0.6684 | Train Acc: 0.7489
Average Train Accuracy: 0.8811
 Best site-photo-0                   | Epoch:9 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:9 | Val Acc: 0.9978
 Best site-art_painting-0            | Epoch:9 | Val Acc: 0.8867
 Best site-art_painting-1            | Epoch:9 | Val Acc: 0.9756
 Best site-cartoon-0                 | Epoch:9 | Val Acc: 0.8333
 Best site-cartoon-1                 | Epoch:9 | Val Acc: 0.8933
 Best site-sketch-0                  | Epoch:9 | Val Acc: 0.7267
 Best site-sketch-1                  | Epoch:9 | Val Acc: 0.7489
 Test site-photo-0                   | Epoch:9 | Test Acc: 1.0000
 Test site-photo-1                   | Epoch:9 | Test Acc: 0.9980
 Test site-art_painting-0            | Epoch:9 | Test Acc: 0.9122
 Test site-art_painting-1            | Epoch:9 | Test Acc: 0.9236
 Test site-cartoon-0                 | Epoch:9 | Test Acc: 0.8213
 Test site-cartoon-1                 | Epoch:9 | Test Acc: 0.8440
 Test site-sketch-0                  | Epoch:9 | Test Acc: 0.7812
 Test site-sketch-1                  | Epoch:9 | Test Acc: 0.7322
photo-0: 1.0000, photo-1: 0.9980, art_painting-0: 0.9122, art_painting-1: 0.9236, cartoon-0: 0.8213, cartoon-1: 0.8440, sketch-0: 0.7812, sketch-1: 0.7322, 
Average Test Accuracy(group): 0.8766, Average Test Accuracy(individual): 0.8766,
domain std=0.0919, cluster std=-1.0000, individual std=0.0919, 
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 10 ============
 Site-photo-0                       | Train Loss: 0.0402 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0192 | Train Acc: 0.9933
 Site-art_painting-0                | Train Loss: 0.3943 | Train Acc: 0.8800
 Site-art_painting-1                | Train Loss: 0.2458 | Train Acc: 0.9333
 Site-cartoon-0                     | Train Loss: 0.4672 | Train Acc: 0.8133
 Site-cartoon-1                     | Train Loss: 0.3764 | Train Acc: 0.9000
 Site-sketch-0                      | Train Loss: 0.6775 | Train Acc: 0.7667
 Site-sketch-1                      | Train Loss: 0.6998 | Train Acc: 0.7556
Average Train Accuracy: 0.8786
============ Train epoch 11 ============
 Site-photo-0                       | Train Loss: 0.0409 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0088 | Train Acc: 1.0000
 Site-art_painting-0                | Train Loss: 0.2955 | Train Acc: 0.9133
 Site-art_painting-1                | Train Loss: 0.2003 | Train Acc: 0.9378
 Site-cartoon-0                     | Train Loss: 0.4840 | Train Acc: 0.8200
 Site-cartoon-1                     | Train Loss: 0.3276 | Train Acc: 0.8956
 Site-sketch-0                      | Train Loss: 0.6893 | Train Acc: 0.7533
 Site-sketch-1                      | Train Loss: 0.6298 | Train Acc: 0.7556
Average Train Accuracy: 0.8828
 Best site-photo-0                   | Epoch:11 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:11 | Val Acc: 1.0000
 Best site-art_painting-0            | Epoch:11 | Val Acc: 0.9133
 Best site-art_painting-1            | Epoch:11 | Val Acc: 0.9378
 Best site-cartoon-0                 | Epoch:11 | Val Acc: 0.8200
 Best site-cartoon-1                 | Epoch:11 | Val Acc: 0.8956
 Best site-sketch-0                  | Epoch:11 | Val Acc: 0.7533
 Best site-sketch-1                  | Epoch:11 | Val Acc: 0.7556
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 12 ============
 Site-photo-0                       | Train Loss: 0.0386 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0171 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.2742 | Train Acc: 0.9067
 Site-art_painting-1                | Train Loss: 0.1973 | Train Acc: 0.9511
 Site-cartoon-0                     | Train Loss: 0.4907 | Train Acc: 0.8200
 Site-cartoon-1                     | Train Loss: 0.3105 | Train Acc: 0.8978
 Site-sketch-0                      | Train Loss: 0.6638 | Train Acc: 0.8267
 Site-sketch-1                      | Train Loss: 0.5748 | Train Acc: 0.7800
Average Train Accuracy: 0.8958
 Best site-photo-0                   | Epoch:12 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:12 | Val Acc: 0.9978
 Best site-art_painting-0            | Epoch:12 | Val Acc: 0.9067
 Best site-art_painting-1            | Epoch:12 | Val Acc: 0.9511
 Best site-cartoon-0                 | Epoch:12 | Val Acc: 0.8200
 Best site-cartoon-1                 | Epoch:12 | Val Acc: 0.8978
 Best site-sketch-0                  | Epoch:12 | Val Acc: 0.8267
 Best site-sketch-1                  | Epoch:12 | Val Acc: 0.7800
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 13 ============
 Site-photo-0                       | Train Loss: 0.0371 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0182 | Train Acc: 0.9956
 Site-art_painting-0                | Train Loss: 0.3112 | Train Acc: 0.9133
 Site-art_painting-1                | Train Loss: 0.1854 | Train Acc: 0.9467
 Site-cartoon-0                     | Train Loss: 0.4667 | Train Acc: 0.8400
 Site-cartoon-1                     | Train Loss: 0.3334 | Train Acc: 0.9178
 Site-sketch-0                      | Train Loss: 0.6696 | Train Acc: 0.7733
 Site-sketch-1                      | Train Loss: 0.6124 | Train Acc: 0.7756
Average Train Accuracy: 0.8936
============ Train epoch 14 ============
 Site-photo-0                       | Train Loss: 0.0322 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0098 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.3479 | Train Acc: 0.8733
 Site-art_painting-1                | Train Loss: 0.1940 | Train Acc: 0.9378
 Site-cartoon-0                     | Train Loss: 0.3948 | Train Acc: 0.8533
 Site-cartoon-1                     | Train Loss: 0.2637 | Train Acc: 0.9311
 Site-sketch-0                      | Train Loss: 0.6771 | Train Acc: 0.7533
 Site-sketch-1                      | Train Loss: 0.6200 | Train Acc: 0.7822
Average Train Accuracy: 0.8894
============ Train epoch 15 ============
 Site-photo-0                       | Train Loss: 0.0456 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0082 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.3072 | Train Acc: 0.8867
 Site-art_painting-1                | Train Loss: 0.1878 | Train Acc: 0.9467
 Site-cartoon-0                     | Train Loss: 0.4224 | Train Acc: 0.8733
 Site-cartoon-1                     | Train Loss: 0.2478 | Train Acc: 0.9356
 Site-sketch-0                      | Train Loss: 0.6128 | Train Acc: 0.7933
 Site-sketch-1                      | Train Loss: 0.6602 | Train Acc: 0.7622
Average Train Accuracy: 0.8978
 Best site-photo-0                   | Epoch:15 | Val Acc: 0.9867
 Best site-photo-1                   | Epoch:15 | Val Acc: 0.9978
 Best site-art_painting-0            | Epoch:15 | Val Acc: 0.8867
 Best site-art_painting-1            | Epoch:15 | Val Acc: 0.9467
 Best site-cartoon-0                 | Epoch:15 | Val Acc: 0.8733
 Best site-cartoon-1                 | Epoch:15 | Val Acc: 0.9356
 Best site-sketch-0                  | Epoch:15 | Val Acc: 0.7933
 Best site-sketch-1                  | Epoch:15 | Val Acc: 0.7622
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 16 ============
 Site-photo-0                       | Train Loss: 0.0396 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-art_painting-0                | Train Loss: 0.3036 | Train Acc: 0.9000
 Site-art_painting-1                | Train Loss: 0.1641 | Train Acc: 0.9511
 Site-cartoon-0                     | Train Loss: 0.4250 | Train Acc: 0.8667
 Site-cartoon-1                     | Train Loss: 0.3024 | Train Acc: 0.9178
 Site-sketch-0                      | Train Loss: 0.7052 | Train Acc: 0.7400
 Site-sketch-1                      | Train Loss: 0.5786 | Train Acc: 0.7778
Average Train Accuracy: 0.8925
============ Train epoch 17 ============
 Site-photo-0                       | Train Loss: 0.0222 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-art_painting-0                | Train Loss: 0.3562 | Train Acc: 0.8867
 Site-art_painting-1                | Train Loss: 0.1742 | Train Acc: 0.9578
 Site-cartoon-0                     | Train Loss: 0.3906 | Train Acc: 0.8800
 Site-cartoon-1                     | Train Loss: 0.2452 | Train Acc: 0.9244
 Site-sketch-0                      | Train Loss: 0.6317 | Train Acc: 0.8067
 Site-sketch-1                      | Train Loss: 0.6429 | Train Acc: 0.7844
Average Train Accuracy: 0.9042
 Best site-photo-0                   | Epoch:17 | Val Acc: 0.9933
 Best site-photo-1                   | Epoch:17 | Val Acc: 1.0000
 Best site-art_painting-0            | Epoch:17 | Val Acc: 0.8867
 Best site-art_painting-1            | Epoch:17 | Val Acc: 0.9578
 Best site-cartoon-0                 | Epoch:17 | Val Acc: 0.8800
 Best site-cartoon-1                 | Epoch:17 | Val Acc: 0.9244
 Best site-sketch-0                  | Epoch:17 | Val Acc: 0.8067
 Best site-sketch-1                  | Epoch:17 | Val Acc: 0.7844
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 18 ============
 Site-photo-0                       | Train Loss: 0.0553 | Train Acc: 0.9800
 Site-photo-1                       | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-art_painting-0                | Train Loss: 0.3661 | Train Acc: 0.8667
 Site-art_painting-1                | Train Loss: 0.1991 | Train Acc: 0.9422
 Site-cartoon-0                     | Train Loss: 0.4409 | Train Acc: 0.8467
 Site-cartoon-1                     | Train Loss: 0.2446 | Train Acc: 0.9311
 Site-sketch-0                      | Train Loss: 0.6452 | Train Acc: 0.7467
 Site-sketch-1                      | Train Loss: 0.5423 | Train Acc: 0.8000
Average Train Accuracy: 0.8892
============ Train epoch 19 ============
 Site-photo-0                       | Train Loss: 0.0385 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0137 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.3036 | Train Acc: 0.8933
 Site-art_painting-1                | Train Loss: 0.1601 | Train Acc: 0.9511
 Site-cartoon-0                     | Train Loss: 0.4022 | Train Acc: 0.8600
 Site-cartoon-1                     | Train Loss: 0.2271 | Train Acc: 0.9356
 Site-sketch-0                      | Train Loss: 0.6712 | Train Acc: 0.7667
 Site-sketch-1                      | Train Loss: 0.5696 | Train Acc: 0.7933
Average Train Accuracy: 0.8981
 Test site-photo-0                   | Epoch:17 | Test Acc: 1.0000
 Test site-photo-1                   | Epoch:17 | Test Acc: 0.9980
 Test site-art_painting-0            | Epoch:17 | Test Acc: 0.9220
 Test site-art_painting-1            | Epoch:17 | Test Acc: 0.9333
 Test site-cartoon-0                 | Epoch:17 | Test Acc: 0.8298
 Test site-cartoon-1                 | Epoch:17 | Test Acc: 0.8709
 Test site-sketch-0                  | Epoch:17 | Test Acc: 0.7735
 Test site-sketch-1                  | Epoch:17 | Test Acc: 0.7568
photo-0: 1.0000, photo-1: 0.9980, art_painting-0: 0.9220, art_painting-1: 0.9333, cartoon-0: 0.8298, cartoon-1: 0.8709, sketch-0: 0.7735, sketch-1: 0.7568, 
Average Test Accuracy(group): 0.8855, Average Test Accuracy(individual): 0.8855,
domain std=0.0879, cluster std=-1.0000, individual std=0.0879, 
============ Train epoch 20 ============
 Site-photo-0                       | Train Loss: 0.0313 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0067 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.3240 | Train Acc: 0.9133
 Site-art_painting-1                | Train Loss: 0.1599 | Train Acc: 0.9644
 Site-cartoon-0                     | Train Loss: 0.3555 | Train Acc: 0.9067
 Site-cartoon-1                     | Train Loss: 0.2475 | Train Acc: 0.9378
 Site-sketch-0                      | Train Loss: 0.5919 | Train Acc: 0.8067
 Site-sketch-1                      | Train Loss: 0.5697 | Train Acc: 0.8111
Average Train Accuracy: 0.9164
 Best site-photo-0                   | Epoch:20 | Val Acc: 0.9933
 Best site-photo-1                   | Epoch:20 | Val Acc: 0.9978
 Best site-art_painting-0            | Epoch:20 | Val Acc: 0.9133
 Best site-art_painting-1            | Epoch:20 | Val Acc: 0.9644
 Best site-cartoon-0                 | Epoch:20 | Val Acc: 0.9067
 Best site-cartoon-1                 | Epoch:20 | Val Acc: 0.9378
 Best site-sketch-0                  | Epoch:20 | Val Acc: 0.8067
 Best site-sketch-1                  | Epoch:20 | Val Acc: 0.8111
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 21 ============
 Site-photo-0                       | Train Loss: 0.0369 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-art_painting-0                | Train Loss: 0.3777 | Train Acc: 0.8800
 Site-art_painting-1                | Train Loss: 0.1716 | Train Acc: 0.9622
 Site-cartoon-0                     | Train Loss: 0.4535 | Train Acc: 0.8467
 Site-cartoon-1                     | Train Loss: 0.2436 | Train Acc: 0.9222
 Site-sketch-0                      | Train Loss: 0.6171 | Train Acc: 0.7733
 Site-sketch-1                      | Train Loss: 0.6184 | Train Acc: 0.8156
Average Train Accuracy: 0.8983
============ Train epoch 22 ============
 Site-photo-0                       | Train Loss: 0.0262 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0101 | Train Acc: 0.9956
 Site-art_painting-0                | Train Loss: 0.3389 | Train Acc: 0.8800
 Site-art_painting-1                | Train Loss: 0.1552 | Train Acc: 0.9556
 Site-cartoon-0                     | Train Loss: 0.3588 | Train Acc: 0.8800
 Site-cartoon-1                     | Train Loss: 0.2562 | Train Acc: 0.9333
 Site-sketch-0                      | Train Loss: 0.6395 | Train Acc: 0.7533
 Site-sketch-1                      | Train Loss: 0.5692 | Train Acc: 0.7911
Average Train Accuracy: 0.8978
============ Train epoch 23 ============
 Site-photo-0                       | Train Loss: 0.0203 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0103 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.2797 | Train Acc: 0.9067
 Site-art_painting-1                | Train Loss: 0.1728 | Train Acc: 0.9600
 Site-cartoon-0                     | Train Loss: 0.4266 | Train Acc: 0.8200
 Site-cartoon-1                     | Train Loss: 0.2466 | Train Acc: 0.9267
 Site-sketch-0                      | Train Loss: 0.6016 | Train Acc: 0.8067
 Site-sketch-1                      | Train Loss: 0.5535 | Train Acc: 0.7933
Average Train Accuracy: 0.9006
============ Train epoch 24 ============
 Site-photo-0                       | Train Loss: 0.0345 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0398 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.3546 | Train Acc: 0.9000
 Site-art_painting-1                | Train Loss: 0.1421 | Train Acc: 0.9622
 Site-cartoon-0                     | Train Loss: 0.4283 | Train Acc: 0.8533
 Site-cartoon-1                     | Train Loss: 0.3166 | Train Acc: 0.9444
 Site-sketch-0                      | Train Loss: 0.5933 | Train Acc: 0.7733
 Site-sketch-1                      | Train Loss: 0.6170 | Train Acc: 0.7844
Average Train Accuracy: 0.9003
============ Train epoch 25 ============
 Site-photo-0                       | Train Loss: 0.0262 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0027 | Train Acc: 1.0000
 Site-art_painting-0                | Train Loss: 0.2903 | Train Acc: 0.9200
 Site-art_painting-1                | Train Loss: 0.1523 | Train Acc: 0.9711
 Site-cartoon-0                     | Train Loss: 0.4344 | Train Acc: 0.8867
 Site-cartoon-1                     | Train Loss: 0.2420 | Train Acc: 0.9289
 Site-sketch-0                      | Train Loss: 0.6032 | Train Acc: 0.7800
 Site-sketch-1                      | Train Loss: 0.5385 | Train Acc: 0.8000
Average Train Accuracy: 0.9100
============ Train epoch 26 ============
 Site-photo-0                       | Train Loss: 0.0341 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0137 | Train Acc: 0.9956
 Site-art_painting-0                | Train Loss: 0.3042 | Train Acc: 0.8800
 Site-art_painting-1                | Train Loss: 0.1400 | Train Acc: 0.9667
 Site-cartoon-0                     | Train Loss: 0.4124 | Train Acc: 0.8600
 Site-cartoon-1                     | Train Loss: 0.2378 | Train Acc: 0.9378
 Site-sketch-0                      | Train Loss: 0.5790 | Train Acc: 0.8267
 Site-sketch-1                      | Train Loss: 0.6604 | Train Acc: 0.8022
Average Train Accuracy: 0.9069
============ Train epoch 27 ============
 Site-photo-0                       | Train Loss: 0.0281 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0174 | Train Acc: 0.9933
 Site-art_painting-0                | Train Loss: 0.2543 | Train Acc: 0.9067
 Site-art_painting-1                | Train Loss: 0.1318 | Train Acc: 0.9733
 Site-cartoon-0                     | Train Loss: 0.4270 | Train Acc: 0.8333
 Site-cartoon-1                     | Train Loss: 0.2947 | Train Acc: 0.9200
 Site-sketch-0                      | Train Loss: 0.5488 | Train Acc: 0.8133
 Site-sketch-1                      | Train Loss: 0.5552 | Train Acc: 0.7711
Average Train Accuracy: 0.8997
============ Train epoch 28 ============
 Site-photo-0                       | Train Loss: 0.0370 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-art_painting-0                | Train Loss: 0.2968 | Train Acc: 0.8867
 Site-art_painting-1                | Train Loss: 0.1378 | Train Acc: 0.9667
 Site-cartoon-0                     | Train Loss: 0.3906 | Train Acc: 0.8600
 Site-cartoon-1                     | Train Loss: 0.3483 | Train Acc: 0.9222
 Site-sketch-0                      | Train Loss: 0.5420 | Train Acc: 0.8133
 Site-sketch-1                      | Train Loss: 0.5295 | Train Acc: 0.8111
Average Train Accuracy: 0.9058
============ Train epoch 29 ============
 Site-photo-0                       | Train Loss: 0.0517 | Train Acc: 0.9733
 Site-photo-1                       | Train Loss: 0.0084 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.2821 | Train Acc: 0.9333
 Site-art_painting-1                | Train Loss: 0.1423 | Train Acc: 0.9667
 Site-cartoon-0                     | Train Loss: 0.4405 | Train Acc: 0.8333
 Site-cartoon-1                     | Train Loss: 0.2248 | Train Acc: 0.9400
 Site-sketch-0                      | Train Loss: 0.5771 | Train Acc: 0.8000
 Site-sketch-1                      | Train Loss: 0.4948 | Train Acc: 0.8022
Average Train Accuracy: 0.9058
 Test site-photo-0                   | Epoch:20 | Test Acc: 1.0000
 Test site-photo-1                   | Epoch:20 | Test Acc: 0.9980
 Test site-art_painting-0            | Epoch:20 | Test Acc: 0.9268
 Test site-art_painting-1            | Epoch:20 | Test Acc: 0.9398
 Test site-cartoon-0                 | Epoch:20 | Test Acc: 0.8553
 Test site-cartoon-1                 | Epoch:20 | Test Acc: 0.8695
 Test site-sketch-0                  | Epoch:20 | Test Acc: 0.7888
 Test site-sketch-1                  | Epoch:20 | Test Acc: 0.7678
photo-0: 1.0000, photo-1: 0.9980, art_painting-0: 0.9268, art_painting-1: 0.9398, cartoon-0: 0.8553, cartoon-1: 0.8695, sketch-0: 0.7888, sketch-1: 0.7678, 
Average Test Accuracy(group): 0.8933, Average Test Accuracy(individual): 0.8933,
domain std=0.0824, cluster std=-1.0000, individual std=0.0824, 
============ Train epoch 30 ============
 Site-photo-0                       | Train Loss: 0.0369 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0058 | Train Acc: 1.0000
 Site-art_painting-0                | Train Loss: 0.3056 | Train Acc: 0.9267
 Site-art_painting-1                | Train Loss: 0.1529 | Train Acc: 0.9533
 Site-cartoon-0                     | Train Loss: 0.4218 | Train Acc: 0.8667
 Site-cartoon-1                     | Train Loss: 0.2278 | Train Acc: 0.9467
 Site-sketch-0                      | Train Loss: 0.5750 | Train Acc: 0.8000
 Site-sketch-1                      | Train Loss: 0.5281 | Train Acc: 0.8022
Average Train Accuracy: 0.9103
============ Train epoch 31 ============
 Site-photo-0                       | Train Loss: 0.0364 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0073 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.2803 | Train Acc: 0.9067
 Site-art_painting-1                | Train Loss: 0.1320 | Train Acc: 0.9689
 Site-cartoon-0                     | Train Loss: 0.4034 | Train Acc: 0.8533
 Site-cartoon-1                     | Train Loss: 0.2336 | Train Acc: 0.9378
 Site-sketch-0                      | Train Loss: 0.5407 | Train Acc: 0.7867
 Site-sketch-1                      | Train Loss: 0.5016 | Train Acc: 0.8200
Average Train Accuracy: 0.9072
============ Train epoch 32 ============
 Site-photo-0                       | Train Loss: 0.0178 | Train Acc: 1.0000
 Site-photo-1                       | Train Loss: 0.0062 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.3448 | Train Acc: 0.8867
 Site-art_painting-1                | Train Loss: 0.1390 | Train Acc: 0.9756
 Site-cartoon-0                     | Train Loss: 0.3404 | Train Acc: 0.8933
 Site-cartoon-1                     | Train Loss: 0.2083 | Train Acc: 0.9422
 Site-sketch-0                      | Train Loss: 0.5386 | Train Acc: 0.8067
 Site-sketch-1                      | Train Loss: 0.4837 | Train Acc: 0.8444
Average Train Accuracy: 0.9183
 Best site-photo-0                   | Epoch:32 | Val Acc: 1.0000
 Best site-photo-1                   | Epoch:32 | Val Acc: 0.9978
 Best site-art_painting-0            | Epoch:32 | Val Acc: 0.8867
 Best site-art_painting-1            | Epoch:32 | Val Acc: 0.9756
 Best site-cartoon-0                 | Epoch:32 | Val Acc: 0.8933
 Best site-cartoon-1                 | Epoch:32 | Val Acc: 0.9422
 Best site-sketch-0                  | Epoch:32 | Val Acc: 0.8067
 Best site-sketch-1                  | Epoch:32 | Val Acc: 0.8444
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 33 ============
 Site-photo-0                       | Train Loss: 0.0390 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0159 | Train Acc: 0.9933
 Site-art_painting-0                | Train Loss: 0.2547 | Train Acc: 0.8867
 Site-art_painting-1                | Train Loss: 0.1212 | Train Acc: 0.9778
 Site-cartoon-0                     | Train Loss: 0.3921 | Train Acc: 0.8733
 Site-cartoon-1                     | Train Loss: 0.1931 | Train Acc: 0.9422
 Site-sketch-0                      | Train Loss: 0.5771 | Train Acc: 0.8000
 Site-sketch-1                      | Train Loss: 0.4638 | Train Acc: 0.8422
Average Train Accuracy: 0.9136
============ Train epoch 34 ============
 Site-photo-0                       | Train Loss: 0.0381 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0064 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.2868 | Train Acc: 0.9067
 Site-art_painting-1                | Train Loss: 0.1380 | Train Acc: 0.9600
 Site-cartoon-0                     | Train Loss: 0.4050 | Train Acc: 0.8800
 Site-cartoon-1                     | Train Loss: 0.2551 | Train Acc: 0.9200
 Site-sketch-0                      | Train Loss: 0.5349 | Train Acc: 0.8200
 Site-sketch-1                      | Train Loss: 0.5424 | Train Acc: 0.8467
Average Train Accuracy: 0.9156
============ Train epoch 35 ============
 Site-photo-0                       | Train Loss: 0.0166 | Train Acc: 0.9933
 Site-photo-1                       | Train Loss: 0.0153 | Train Acc: 0.9956
 Site-art_painting-0                | Train Loss: 0.2682 | Train Acc: 0.9333
 Site-art_painting-1                | Train Loss: 0.1400 | Train Acc: 0.9622
 Site-cartoon-0                     | Train Loss: 0.4050 | Train Acc: 0.8400
 Site-cartoon-1                     | Train Loss: 0.2072 | Train Acc: 0.9578
 Site-sketch-0                      | Train Loss: 0.5414 | Train Acc: 0.8133
 Site-sketch-1                      | Train Loss: 0.4913 | Train Acc: 0.8200
Average Train Accuracy: 0.9144
============ Train epoch 36 ============
 Site-photo-0                       | Train Loss: 0.0310 | Train Acc: 0.9867
 Site-photo-1                       | Train Loss: 0.0057 | Train Acc: 0.9978
 Site-art_painting-0                | Train Loss: 0.2714 | Train Acc: 0.9133
 Site-art_painting-1                | Train Loss: 0.1298 | Train Acc: 0.9733
 Site-cartoon-0                     | Train Loss: 0.3580 | Train Acc: 0.8933
 Site-cartoon-1                     | Train Loss: 0.1900 | Train Acc: 0.9511
 Site-sketch-0                      | Train Loss: 0.5752 | Train Acc: 0.7867
 Site-sketch-1                      | Train Loss: 0.5294 | Train Acc: 0.8244
Average Train Accuracy: 0.9158
============ Train epoch 37 ============
