===2023-08-16 22:10:53===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 0.5013 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.4643 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.9857 | Train Acc: 0.8267
 Site-art_painting                  | Train Loss: 0.9013 | Train Acc: 0.8556
 Site-cartoon                       | Train Loss: 1.1318 | Train Acc: 0.6933
 Site-cartoon                       | Train Loss: 1.1059 | Train Acc: 0.7311
 Site-sketch                        | Train Loss: 1.3468 | Train Acc: 0.6533
 Site-sketch                        | Train Loss: 1.3525 | Train Acc: 0.6022
Average Train Accuracy: 0.7914
 Best site-photo                     | Epoch:0 | Val Acc: 0.9800
 Best site-photo                     | Epoch:0 | Val Acc: 0.9889
 Best site-art_painting              | Epoch:0 | Val Acc: 0.8267
 Best site-art_painting              | Epoch:0 | Val Acc: 0.8556
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.6933
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.7311
 Best site-sketch                    | Epoch:0 | Val Acc: 0.6533
 Best site-sketch                    | Epoch:0 | Val Acc: 0.6022
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 0.1451 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.1222 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.6559 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.5220 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.8032 | Train Acc: 0.7267
 Site-cartoon                       | Train Loss: 0.7689 | Train Acc: 0.7756
 Site-sketch                        | Train Loss: 1.0904 | Train Acc: 0.6600
 Site-sketch                        | Train Loss: 1.0519 | Train Acc: 0.6511
Average Train Accuracy: 0.8136
 Best site-photo                     | Epoch:1 | Val Acc: 0.9867
 Best site-photo                     | Epoch:1 | Val Acc: 0.9956
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7267
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.7756
 Best site-sketch                    | Epoch:1 | Val Acc: 0.6600
 Best site-sketch                    | Epoch:1 | Val Acc: 0.6511
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 0.0914 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0640 | Train Acc: 0.9911
 Site-art_painting                  | Train Loss: 0.5449 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.4019 | Train Acc: 0.8911
 Site-cartoon                       | Train Loss: 0.6464 | Train Acc: 0.7800
 Site-cartoon                       | Train Loss: 0.6037 | Train Acc: 0.8044
 Site-sketch                        | Train Loss: 0.9727 | Train Acc: 0.6733
 Site-sketch                        | Train Loss: 0.9772 | Train Acc: 0.6667
Average Train Accuracy: 0.8308
 Best site-photo                     | Epoch:2 | Val Acc: 0.9867
 Best site-photo                     | Epoch:2 | Val Acc: 0.9911
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8533
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8911
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7800
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.8044
 Best site-sketch                    | Epoch:2 | Val Acc: 0.6733
 Best site-sketch                    | Epoch:2 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 0.0603 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0370 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.4556 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3799 | Train Acc: 0.9311
 Site-cartoon                       | Train Loss: 0.6242 | Train Acc: 0.8000
 Site-cartoon                       | Train Loss: 0.6111 | Train Acc: 0.8333
 Site-sketch                        | Train Loss: 0.9187 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.8627 | Train Acc: 0.6933
Average Train Accuracy: 0.8556
 Best site-photo                     | Epoch:3 | Val Acc: 0.9933
 Best site-photo                     | Epoch:3 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:3 | Val Acc: 0.9311
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.8333
 Best site-sketch                    | Epoch:3 | Val Acc: 0.7400
 Best site-sketch                    | Epoch:3 | Val Acc: 0.6933
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 0.0490 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0405 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.4428 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.3005 | Train Acc: 0.9156
 Site-cartoon                       | Train Loss: 0.7160 | Train Acc: 0.7133
 Site-cartoon                       | Train Loss: 0.5822 | Train Acc: 0.8267
 Site-sketch                        | Train Loss: 0.8264 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.8850 | Train Acc: 0.6978
Average Train Accuracy: 0.8428
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 0.0513 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0348 | Train Acc: 0.9889
 Site-art_painting                  | Train Loss: 0.4637 | Train Acc: 0.8533
 Site-art_painting                  | Train Loss: 0.3003 | Train Acc: 0.9200
 Site-cartoon                       | Train Loss: 0.5818 | Train Acc: 0.8000
 Site-cartoon                       | Train Loss: 0.4701 | Train Acc: 0.8267
 Site-sketch                        | Train Loss: 0.8021 | Train Acc: 0.7067
 Site-sketch                        | Train Loss: 0.7395 | Train Acc: 0.7289
Average Train Accuracy: 0.8514
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 0.0383 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0227 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3892 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2660 | Train Acc: 0.9244
 Site-cartoon                       | Train Loss: 0.4847 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.4555 | Train Acc: 0.8622
 Site-sketch                        | Train Loss: 0.7853 | Train Acc: 0.7133
 Site-sketch                        | Train Loss: 0.7726 | Train Acc: 0.7244
Average Train Accuracy: 0.8675
 Best site-photo                     | Epoch:6 | Val Acc: 0.9933
 Best site-photo                     | Epoch:6 | Val Acc: 0.9956
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9244
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8267
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8622
 Best site-sketch                    | Epoch:6 | Val Acc: 0.7133
 Best site-sketch                    | Epoch:6 | Val Acc: 0.7244
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.0444 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0185 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3939 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2524 | Train Acc: 0.9311
 Site-cartoon                       | Train Loss: 0.5233 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.6075 | Train Acc: 0.8644
 Site-sketch                        | Train Loss: 0.7690 | Train Acc: 0.6867
 Site-sketch                        | Train Loss: 0.7004 | Train Acc: 0.7356
Average Train Accuracy: 0.8653
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.0377 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0144 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3309 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.2244 | Train Acc: 0.9467
 Site-cartoon                       | Train Loss: 0.5141 | Train Acc: 0.8000
 Site-cartoon                       | Train Loss: 0.3984 | Train Acc: 0.8756
 Site-sketch                        | Train Loss: 0.7358 | Train Acc: 0.7200
 Site-sketch                        | Train Loss: 0.7564 | Train Acc: 0.7689
Average Train Accuracy: 0.8753
 Best site-photo                     | Epoch:8 | Val Acc: 0.9867
 Best site-photo                     | Epoch:8 | Val Acc: 0.9978
 Best site-art_painting              | Epoch:8 | Val Acc: 0.9067
 Best site-art_painting              | Epoch:8 | Val Acc: 0.9467
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.8756
 Best site-sketch                    | Epoch:8 | Val Acc: 0.7200
 Best site-sketch                    | Epoch:8 | Val Acc: 0.7689
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.0335 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0126 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3648 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.1815 | Train Acc: 0.9756
 Site-cartoon                       | Train Loss: 0.4538 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.4028 | Train Acc: 0.8933
 Site-sketch                        | Train Loss: 0.7135 | Train Acc: 0.7267
 Site-sketch                        | Train Loss: 0.6684 | Train Acc: 0.7489
Average Train Accuracy: 0.8811
 Best site-photo                     | Epoch:9 | Val Acc: 0.9867
 Best site-photo                     | Epoch:9 | Val Acc: 0.9978
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8867
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9756
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.8333
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.8933
 Best site-sketch                    | Epoch:9 | Val Acc: 0.7267
 Best site-sketch                    | Epoch:9 | Val Acc: 0.7489
 Test site-photo                     | Epoch:9 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:9 | Test Acc: 0.9208
 Test site-cartoon                   | Epoch:9 | Test Acc: 0.8383
 Test site-sketch                    | Epoch:9 | Test Acc: 0.7440
photo: 0.9985, art_painting: 0.9208, cartoon: 0.8383, sketch: 0.7440, 
Average Test Accuracy(group): 0.8754, Average Test Accuracy(individual): 0.8754,
domain std=0.0947, cluster std=-1.0000, individual std=0.0947, 
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.0702 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0072 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3774 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.2322 | Train Acc: 0.9333
 Site-cartoon                       | Train Loss: 0.5164 | Train Acc: 0.7867
 Site-cartoon                       | Train Loss: 0.3763 | Train Acc: 0.8844
 Site-sketch                        | Train Loss: 0.6806 | Train Acc: 0.7667
 Site-sketch                        | Train Loss: 0.6773 | Train Acc: 0.7444
Average Train Accuracy: 0.8700
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.0426 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0141 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3565 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1724 | Train Acc: 0.9511
 Site-cartoon                       | Train Loss: 0.3924 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.3125 | Train Acc: 0.8978
 Site-sketch                        | Train Loss: 0.7492 | Train Acc: 0.7467
 Site-sketch                        | Train Loss: 0.6587 | Train Acc: 0.7667
Average Train Accuracy: 0.8867
 Best site-photo                     | Epoch:11 | Val Acc: 0.9800
 Best site-photo                     | Epoch:11 | Val Acc: 0.9978
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9511
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8978
 Best site-sketch                    | Epoch:11 | Val Acc: 0.7467
 Best site-sketch                    | Epoch:11 | Val Acc: 0.7667
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.0483 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0086 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3604 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1877 | Train Acc: 0.9533
 Site-cartoon                       | Train Loss: 0.4172 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.2998 | Train Acc: 0.9111
 Site-sketch                        | Train Loss: 0.7437 | Train Acc: 0.7400
 Site-sketch                        | Train Loss: 0.6721 | Train Acc: 0.7822
Average Train Accuracy: 0.8889
 Best site-photo                     | Epoch:12 | Val Acc: 0.9800
 Best site-photo                     | Epoch:12 | Val Acc: 0.9978
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9533
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.8667
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.9111
 Best site-sketch                    | Epoch:12 | Val Acc: 0.7400
 Best site-sketch                    | Epoch:12 | Val Acc: 0.7822
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.0449 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0105 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3686 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.1869 | Train Acc: 0.9511
 Site-cartoon                       | Train Loss: 0.4575 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.2794 | Train Acc: 0.9222
 Site-sketch                        | Train Loss: 0.6061 | Train Acc: 0.8067
 Site-sketch                        | Train Loss: 0.6368 | Train Acc: 0.7800
Average Train Accuracy: 0.8972
 Best site-photo                     | Epoch:13 | Val Acc: 0.9867
 Best site-photo                     | Epoch:13 | Val Acc: 0.9978
 Best site-art_painting              | Epoch:13 | Val Acc: 0.8867
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9511
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.8467
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.9222
 Best site-sketch                    | Epoch:13 | Val Acc: 0.8067
 Best site-sketch                    | Epoch:13 | Val Acc: 0.7800
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.0288 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0097 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3525 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.1866 | Train Acc: 0.9400
 Site-cartoon                       | Train Loss: 0.3984 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.2909 | Train Acc: 0.9178
 Site-sketch                        | Train Loss: 0.6371 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.6354 | Train Acc: 0.7778
Average Train Accuracy: 0.8950
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.0446 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0162 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3153 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.1786 | Train Acc: 0.9422
 Site-cartoon                       | Train Loss: 0.4329 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.2906 | Train Acc: 0.9200
 Site-sketch                        | Train Loss: 0.6251 | Train Acc: 0.7467
 Site-sketch                        | Train Loss: 0.6164 | Train Acc: 0.7689
Average Train Accuracy: 0.8883
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.0360 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0092 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3691 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1627 | Train Acc: 0.9600
 Site-cartoon                       | Train Loss: 0.4161 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.3157 | Train Acc: 0.9111
 Site-sketch                        | Train Loss: 0.6179 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.6113 | Train Acc: 0.7711
Average Train Accuracy: 0.8900
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.0405 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0055 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3436 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1885 | Train Acc: 0.9422
 Site-cartoon                       | Train Loss: 0.4233 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.2702 | Train Acc: 0.9178
 Site-sketch                        | Train Loss: 0.6292 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.5576 | Train Acc: 0.7844
Average Train Accuracy: 0.8931
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.0366 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0176 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2521 | Train Acc: 0.9267
 Site-art_painting                  | Train Loss: 0.1868 | Train Acc: 0.9600
 Site-cartoon                       | Train Loss: 0.4918 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.3191 | Train Acc: 0.9022
 Site-sketch                        | Train Loss: 0.6604 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.5458 | Train Acc: 0.8000
Average Train Accuracy: 0.8931
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.0684 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0111 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3134 | Train Acc: 0.9267
 Site-art_painting                  | Train Loss: 0.2163 | Train Acc: 0.9400
 Site-cartoon                       | Train Loss: 0.4424 | Train Acc: 0.8267
 Site-cartoon                       | Train Loss: 0.2729 | Train Acc: 0.9200
 Site-sketch                        | Train Loss: 0.6569 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.5698 | Train Acc: 0.7978
Average Train Accuracy: 0.8928
 Test site-photo                     | Epoch:13 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:13 | Test Acc: 0.9294
 Test site-cartoon                   | Epoch:13 | Test Acc: 0.8617
 Test site-sketch                    | Epoch:13 | Test Acc: 0.7738
photo: 0.9985, art_painting: 0.9294, cartoon: 0.8617, sketch: 0.7738, 
Average Test Accuracy(group): 0.8908, Average Test Accuracy(individual): 0.8908,
domain std=0.0831, cluster std=-1.0000, individual std=0.0831, 
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.0353 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0128 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2986 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1480 | Train Acc: 0.9644
 Site-cartoon                       | Train Loss: 0.4036 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.2414 | Train Acc: 0.9422
 Site-sketch                        | Train Loss: 0.5944 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 0.5950 | Train Acc: 0.7733
Average Train Accuracy: 0.9003
 Best site-photo                     | Epoch:20 | Val Acc: 0.9800
 Best site-photo                     | Epoch:20 | Val Acc: 0.9956
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9644
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.8467
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.9422
 Best site-sketch                    | Epoch:20 | Val Acc: 0.7800
 Best site-sketch                    | Epoch:20 | Val Acc: 0.7733
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.0287 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0093 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2974 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1234 | Train Acc: 0.9778
 Site-cartoon                       | Train Loss: 0.3905 | Train Acc: 0.8333
 Site-cartoon                       | Train Loss: 0.2592 | Train Acc: 0.9311
 Site-sketch                        | Train Loss: 0.6558 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.5608 | Train Acc: 0.8133
Average Train Accuracy: 0.8997
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.0297 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0206 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2916 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1567 | Train Acc: 0.9533
 Site-cartoon                       | Train Loss: 0.3789 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.3053 | Train Acc: 0.9244
 Site-sketch                        | Train Loss: 0.5702 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.5402 | Train Acc: 0.8044
Average Train Accuracy: 0.9006
 Best site-photo                     | Epoch:22 | Val Acc: 0.9933
 Best site-photo                     | Epoch:22 | Val Acc: 0.9956
 Best site-art_painting              | Epoch:22 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:22 | Val Acc: 0.9533
 Best site-cartoon                   | Epoch:22 | Val Acc: 0.8467
 Best site-cartoon                   | Epoch:22 | Val Acc: 0.9244
 Best site-sketch                    | Epoch:22 | Val Acc: 0.7867
 Best site-sketch                    | Epoch:22 | Val Acc: 0.8044
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.0188 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0043 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3173 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1454 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.3573 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.2366 | Train Acc: 0.9267
 Site-sketch                        | Train Loss: 0.6078 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.5398 | Train Acc: 0.8022
Average Train Accuracy: 0.9031
 Best site-photo                     | Epoch:23 | Val Acc: 0.9933
 Best site-photo                     | Epoch:23 | Val Acc: 0.9978
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8933
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9711
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.8667
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.9267
 Best site-sketch                    | Epoch:23 | Val Acc: 0.7733
 Best site-sketch                    | Epoch:23 | Val Acc: 0.8022
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.0167 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0142 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3160 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1318 | Train Acc: 0.9756
 Site-cartoon                       | Train Loss: 0.3709 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.2206 | Train Acc: 0.9400
 Site-sketch                        | Train Loss: 0.6266 | Train Acc: 0.7600
 Site-sketch                        | Train Loss: 0.6459 | Train Acc: 0.8022
Average Train Accuracy: 0.9017
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.0153 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0076 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3145 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1366 | Train Acc: 0.9733
 Site-cartoon                       | Train Loss: 0.4092 | Train Acc: 0.8467
 Site-cartoon                       | Train Loss: 0.2369 | Train Acc: 0.9200
 Site-sketch                        | Train Loss: 0.6713 | Train Acc: 0.7533
 Site-sketch                        | Train Loss: 0.6316 | Train Acc: 0.7822
Average Train Accuracy: 0.8983
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.0237 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0172 | Train Acc: 0.9933
 Site-art_painting                  | Train Loss: 0.2872 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1591 | Train Acc: 0.9689
 Site-cartoon                       | Train Loss: 0.3491 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.1972 | Train Acc: 0.9467
 Site-sketch                        | Train Loss: 0.5760 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.5149 | Train Acc: 0.8044
Average Train Accuracy: 0.9067
 Best site-photo                     | Epoch:26 | Val Acc: 0.9867
 Best site-photo                     | Epoch:26 | Val Acc: 0.9933
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9689
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.9467
 Best site-sketch                    | Epoch:26 | Val Acc: 0.7733
 Best site-sketch                    | Epoch:26 | Val Acc: 0.8044
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.0351 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0080 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2217 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1890 | Train Acc: 0.9489
 Site-cartoon                       | Train Loss: 0.4383 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.2166 | Train Acc: 0.9289
 Site-sketch                        | Train Loss: 0.6132 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.5034 | Train Acc: 0.8133
Average Train Accuracy: 0.8994
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.0560 | Train Acc: 0.9800
 Site-photo                         | Train Loss: 0.0090 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2885 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1385 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.3801 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.2222 | Train Acc: 0.9311
 Site-sketch                        | Train Loss: 0.6449 | Train Acc: 0.7667
 Site-sketch                        | Train Loss: 0.6028 | Train Acc: 0.8200
Average Train Accuracy: 0.9042
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.0423 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0060 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3097 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1792 | Train Acc: 0.9733
 Site-cartoon                       | Train Loss: 0.4048 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.2201 | Train Acc: 0.9489
 Site-sketch                        | Train Loss: 0.5183 | Train Acc: 0.8200
 Site-sketch                        | Train Loss: 0.5250 | Train Acc: 0.8000
Average Train Accuracy: 0.9083
 Best site-photo                     | Epoch:29 | Val Acc: 0.9867
 Best site-photo                     | Epoch:29 | Val Acc: 0.9978
 Best site-art_painting              | Epoch:29 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:29 | Val Acc: 0.9733
 Best site-cartoon                   | Epoch:29 | Val Acc: 0.8600
 Best site-cartoon                   | Epoch:29 | Val Acc: 0.9489
 Best site-sketch                    | Epoch:29 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:29 | Val Acc: 0.8000
 Test site-photo                     | Epoch:29 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:29 | Test Acc: 0.9330
 Test site-cartoon                   | Epoch:29 | Test Acc: 0.8702
 Test site-sketch                    | Epoch:29 | Test Acc: 0.7757
photo: 0.9985, art_painting: 0.9330, cartoon: 0.8702, sketch: 0.7757, 
Average Test Accuracy(group): 0.8944, Average Test Accuracy(individual): 0.8944,
domain std=0.0822, cluster std=-1.0000, individual std=0.0822, 
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.0297 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0027 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2992 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.1421 | Train Acc: 0.9600
 Site-cartoon                       | Train Loss: 0.4105 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.1928 | Train Acc: 0.9422
 Site-sketch                        | Train Loss: 0.5967 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.4759 | Train Acc: 0.8422
Average Train Accuracy: 0.9089
 Best site-photo                     | Epoch:30 | Val Acc: 0.9867
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8867
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9600
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.9422
 Best site-sketch                    | Epoch:30 | Val Acc: 0.7733
 Best site-sketch                    | Epoch:30 | Val Acc: 0.8422
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.0248 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0105 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2630 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1472 | Train Acc: 0.9533
 Site-cartoon                       | Train Loss: 0.4390 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.2087 | Train Acc: 0.9400
 Site-sketch                        | Train Loss: 0.5708 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 0.5290 | Train Acc: 0.8333
Average Train Accuracy: 0.9111
 Best site-photo                     | Epoch:31 | Val Acc: 0.9933
 Best site-photo                     | Epoch:31 | Val Acc: 0.9956
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:31 | Val Acc: 0.9533
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8400
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.9400
 Best site-sketch                    | Epoch:31 | Val Acc: 0.8133
 Best site-sketch                    | Epoch:31 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.0270 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0091 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2226 | Train Acc: 0.9267
 Site-art_painting                  | Train Loss: 0.1301 | Train Acc: 0.9689
 Site-cartoon                       | Train Loss: 0.4420 | Train Acc: 0.8133
 Site-cartoon                       | Train Loss: 0.1969 | Train Acc: 0.9444
 Site-sketch                        | Train Loss: 0.5995 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.5051 | Train Acc: 0.8178
Average Train Accuracy: 0.9044
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.0337 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2781 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1307 | Train Acc: 0.9689
 Site-cartoon                       | Train Loss: 0.3952 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.2457 | Train Acc: 0.9467
 Site-sketch                        | Train Loss: 0.5635 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 0.4936 | Train Acc: 0.8222
Average Train Accuracy: 0.9106
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.0302 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0159 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.2805 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1391 | Train Acc: 0.9667
 Site-cartoon                       | Train Loss: 0.3295 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.2431 | Train Acc: 0.9422
 Site-sketch                        | Train Loss: 0.5647 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 0.5542 | Train Acc: 0.7911
Average Train Accuracy: 0.9086
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.0291 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2220 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.1264 | Train Acc: 0.9667
 Site-cartoon                       | Train Loss: 0.3228 | Train Acc: 0.8800
 Site-cartoon                       | Train Loss: 0.2070 | Train Acc: 0.9422
 Site-sketch                        | Train Loss: 0.5766 | Train Acc: 0.8267
 Site-sketch                        | Train Loss: 0.5079 | Train Acc: 0.7978
Average Train Accuracy: 0.9175
 Best site-photo                     | Epoch:35 | Val Acc: 0.9867
 Best site-photo                     | Epoch:35 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9400
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9667
 Best site-cartoon                   | Epoch:35 | Val Acc: 0.8800
 Best site-cartoon                   | Epoch:35 | Val Acc: 0.9422
 Best site-sketch                    | Epoch:35 | Val Acc: 0.8267
 Best site-sketch                    | Epoch:35 | Val Acc: 0.7978
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.0437 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3115 | Train Acc: 0.8867
 Site-art_painting                  | Train Loss: 0.1686 | Train Acc: 0.9622
 Site-cartoon                       | Train Loss: 0.3878 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.2098 | Train Acc: 0.9356
 Site-sketch                        | Train Loss: 0.6160 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 0.4981 | Train Acc: 0.8333
Average Train Accuracy: 0.9047
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.0176 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0058 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3038 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1357 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.3696 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.1935 | Train Acc: 0.9600
 Site-sketch                        | Train Loss: 0.5192 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 0.4907 | Train Acc: 0.8422
Average Train Accuracy: 0.9189
 Best site-photo                     | Epoch:37 | Val Acc: 0.9933
 Best site-photo                     | Epoch:37 | Val Acc: 0.9978
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9711
 Best site-cartoon                   | Epoch:37 | Val Acc: 0.8733
 Best site-cartoon                   | Epoch:37 | Val Acc: 0.9600
 Best site-sketch                    | Epoch:37 | Val Acc: 0.8133
 Best site-sketch                    | Epoch:37 | Val Acc: 0.8422
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0130 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3121 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1227 | Train Acc: 0.9756
 Site-cartoon                       | Train Loss: 0.3996 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.1833 | Train Acc: 0.9489
 Site-sketch                        | Train Loss: 0.5679 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 0.4815 | Train Acc: 0.8333
Average Train Accuracy: 0.9172
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0366 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0163 | Train Acc: 0.9956
 Site-art_painting                  | Train Loss: 0.3588 | Train Acc: 0.8933
 Site-art_painting                  | Train Loss: 0.1271 | Train Acc: 0.9778
 Site-cartoon                       | Train Loss: 0.3478 | Train Acc: 0.9067
 Site-cartoon                       | Train Loss: 0.2448 | Train Acc: 0.9422
 Site-sketch                        | Train Loss: 0.5890 | Train Acc: 0.7800
 Site-sketch                        | Train Loss: 0.4963 | Train Acc: 0.8267
Average Train Accuracy: 0.9136
 Test site-photo                     | Epoch:37 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:37 | Test Acc: 0.9367
 Test site-cartoon                   | Epoch:37 | Test Acc: 0.8638
 Test site-sketch                    | Epoch:37 | Test Acc: 0.7700
photo: 0.9985, art_painting: 0.9367, cartoon: 0.8638, sketch: 0.7700, 
Average Test Accuracy(group): 0.8923, Average Test Accuracy(individual): 0.8923,
domain std=0.0852, cluster std=-1.0000, individual std=0.0852, 
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0209 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0426 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.3379 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1849 | Train Acc: 0.9733
 Site-cartoon                       | Train Loss: 0.4150 | Train Acc: 0.8400
 Site-cartoon                       | Train Loss: 0.2440 | Train Acc: 0.9311
 Site-sketch                        | Train Loss: 0.5710 | Train Acc: 0.8067
 Site-sketch                        | Train Loss: 0.4882 | Train Acc: 0.8244
Average Train Accuracy: 0.9100
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.0159 | Train Acc: 0.9933
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2959 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1375 | Train Acc: 0.9733
 Site-cartoon                       | Train Loss: 0.3255 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.1940 | Train Acc: 0.9422
 Site-sketch                        | Train Loss: 0.6258 | Train Acc: 0.7467
 Site-sketch                        | Train Loss: 0.4994 | Train Acc: 0.8244
Average Train Accuracy: 0.9092
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.0147 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2642 | Train Acc: 0.9067
 Site-art_painting                  | Train Loss: 0.1256 | Train Acc: 0.9756
 Site-cartoon                       | Train Loss: 0.3243 | Train Acc: 0.8933
 Site-cartoon                       | Train Loss: 0.2031 | Train Acc: 0.9444
 Site-sketch                        | Train Loss: 0.5752 | Train Acc: 0.7867
 Site-sketch                        | Train Loss: 0.5715 | Train Acc: 0.7933
Average Train Accuracy: 0.9125
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.0129 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0041 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2737 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1287 | Train Acc: 0.9689
 Site-cartoon                       | Train Loss: 0.3066 | Train Acc: 0.9000
 Site-cartoon                       | Train Loss: 0.2009 | Train Acc: 0.9489
 Site-sketch                        | Train Loss: 0.5220 | Train Acc: 0.8200
 Site-sketch                        | Train Loss: 0.4613 | Train Acc: 0.8356
Average Train Accuracy: 0.9231
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 0.9978
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9133
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9689
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.9000
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.9489
 Best site-sketch                    | Epoch:43 | Val Acc: 0.8200
 Best site-sketch                    | Epoch:43 | Val Acc: 0.8356
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_even_1.0_1/harmo-fl...
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.0303 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2921 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1256 | Train Acc: 0.9711
 Site-cartoon                       | Train Loss: 0.3974 | Train Acc: 0.8733
 Site-cartoon                       | Train Loss: 0.2040 | Train Acc: 0.9378
 Site-sketch                        | Train Loss: 0.5549 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 0.5168 | Train Acc: 0.7978
Average Train Accuracy: 0.9100
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0110 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2712 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1186 | Train Acc: 0.9822
 Site-cartoon                       | Train Loss: 0.3997 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.2295 | Train Acc: 0.9400
 Site-sketch                        | Train Loss: 0.5663 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 0.4903 | Train Acc: 0.8222
Average Train Accuracy: 0.9156
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0407 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3138 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.1220 | Train Acc: 0.9689
 Site-cartoon                       | Train Loss: 0.3914 | Train Acc: 0.8600
 Site-cartoon                       | Train Loss: 0.1922 | Train Acc: 0.9556
 Site-sketch                        | Train Loss: 0.5618 | Train Acc: 0.7933
 Site-sketch                        | Train Loss: 0.4921 | Train Acc: 0.8000
Average Train Accuracy: 0.9039
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0115 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0043 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2489 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1145 | Train Acc: 0.9756
 Site-cartoon                       | Train Loss: 0.3690 | Train Acc: 0.8667
 Site-cartoon                       | Train Loss: 0.2126 | Train Acc: 0.9311
 Site-sketch                        | Train Loss: 0.6273 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 0.5073 | Train Acc: 0.8156
Average Train Accuracy: 0.9142
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0132 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0086 | Train Acc: 0.9978
 Site-art_painting                  | Train Loss: 0.2708 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1342 | Train Acc: 0.9644
 Site-cartoon                       | Train Loss: 0.4171 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.1962 | Train Acc: 0.9467
 Site-sketch                        | Train Loss: 0.5922 | Train Acc: 0.7733
 Site-sketch                        | Train Loss: 0.4916 | Train Acc: 0.8200
Average Train Accuracy: 0.9094
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0313 | Train Acc: 0.9867
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2611 | Train Acc: 0.9133
 Site-art_painting                  | Train Loss: 0.1099 | Train Acc: 0.9800
 Site-cartoon                       | Train Loss: 0.4223 | Train Acc: 0.8533
 Site-cartoon                       | Train Loss: 0.2046 | Train Acc: 0.9378
 Site-sketch                        | Train Loss: 0.5253 | Train Acc: 0.8133
 Site-sketch                        | Train Loss: 0.5005 | Train Acc: 0.8111
Average Train Accuracy: 0.9119
 Test site-photo                     | Epoch:43 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:43 | Test Acc: 0.9379
 Test site-cartoon                   | Epoch:43 | Test Acc: 0.8723
 Test site-sketch                    | Epoch:43 | Test Acc: 0.7783
photo: 0.9985, art_painting: 0.9379, cartoon: 0.8723, sketch: 0.7783, 
Average Test Accuracy(group): 0.8968, Average Test Accuracy(individual): 0.8968,
domain std=0.0817, cluster std=-1.0000, individual std=0.0817, 
===2023-08-17 00:12:47===
===2023-08-17 00:12:54===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[150,450,150,450,150,450,150,450,
client_nums=[2,2,2,2,]
len_dataset=[1000,1000,1000,1000,]
domain number = 4
Loading snapshots...
 Test site-photo                     | Epoch:43 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:43 | Test Acc: 0.9391
 Test site-cartoon                   | Epoch:43 | Test Acc: 0.8755
 Test site-sketch                    | Epoch:43 | Test Acc: 0.7802
photo: 0.9985, art_painting: 0.9391, cartoon: 0.8755, sketch: 0.7802, 
Average Test Accuracy(group): 0.8983, Average Test Accuracy(individual): 0.8983,
domain std=0.0809, cluster std=-1.0000, individual std=0.0809, 
