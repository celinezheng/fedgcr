===2023-06-15 04:51:06===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 8, 16, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.00361, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White_utk                 (0) | Train Loss: 2.1791 | Train Acc: 0.0833
 Site-White_utk                 (4) | Train Loss: 2.1892 | Train Acc: 0.1176
 Site-White_utk                 (4) | Train Loss: 2.2624 | Train Acc: 0.1154
 Site-White_utk                 (4) | Train Loss: 2.2818 | Train Acc: 0.0789
 Site-White_utk                 (4) | Train Loss: 2.2507 | Train Acc: 0.0893
 Site-White_utk                 (4) | Train Loss: 2.2254 | Train Acc: 0.1341
 Site-White_utk                 (4) | Train Loss: 2.1983 | Train Acc: 0.1240
 Site-White_utk                 (4) | Train Loss: 2.2110 | Train Acc: 0.1061
 Site-White_utk                 (4) | Train Loss: 2.2412 | Train Acc: 0.1027
 Site-White_utk                 (4) | Train Loss: 2.2068 | Train Acc: 0.1111
 Site-East_Asian                (3) | Train Loss: 1.8917 | Train Acc: 0.4815
 Site-East_Asian                (3) | Train Loss: 1.9416 | Train Acc: 0.4500
 Site-East_Asian                (2) | Train Loss: 1.9573 | Train Acc: 0.3559
 Site-East_Asian                (3) | Train Loss: 1.9491 | Train Acc: 0.3605
 Site-East_Asian                (3) | Train Loss: 1.9426 | Train Acc: 0.3937
 Site-East_Asian                (3) | Train Loss: 1.9654 | Train Acc: 0.3636
 Site-East_Asian                (3) | Train Loss: 1.8997 | Train Acc: 0.4058
 Site-Indian_utk                (5) | Train Loss: 2.0312 | Train Acc: 0.3256
 Site-Indian_utk                (4) | Train Loss: 1.9294 | Train Acc: 0.3750
 Site-Indian_utk                (4) | Train Loss: 2.0111 | Train Acc: 0.3085
 Site-Indian_utk                (4) | Train Loss: 1.9749 | Train Acc: 0.3597
 Site-Indian_utk                (4) | Train Loss: 2.0242 | Train Acc: 0.3366
 Site-Black_utk                 (4) | Train Loss: 1.9781 | Train Acc: 0.3273
 Site-Black_utk                 (4) | Train Loss: 1.9903 | Train Acc: 0.2963
 Site-Black_utk                 (4) | Train Loss: 2.0229 | Train Acc: 0.2437
 Site-Southeast_Asian           (3) | Train Loss: 2.0387 | Train Acc: 0.3333
 Site-Southeast_Asian           (3) | Train Loss: 2.0560 | Train Acc: 0.2867
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.6970 | Train Acc: 0.4709
 Site-White_ffhq                (1) | Train Loss: 1.6309 | Train Acc: 0.7692
Average Train Accuracy: 0.2864
 Site-White_utk                 (0) | Val  Loss: 2.1880 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.2854 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.2108 | Val  Acc: 0.1176
 Site-White_utk                 (4) | Val  Loss: 2.2204 | Val  Acc: 0.1600
 Site-White_utk                 (4) | Val  Loss: 2.2153 | Val  Acc: 0.1081
 Site-White_utk                 (4) | Val  Loss: 2.1810 | Val  Acc: 0.0727
 Site-White_utk                 (4) | Val  Loss: 2.1924 | Val  Acc: 0.0988
 Site-White_utk                 (4) | Val  Loss: 2.2264 | Val  Acc: 0.1008
 Site-White_utk                 (4) | Val  Loss: 2.2136 | Val  Acc: 0.1086
 Site-White_utk                 (4) | Val  Loss: 2.3069 | Val  Acc: 0.1085
 Site-East_Asian                (3) | Val  Loss: 2.1019 | Val  Acc: 0.1111
 Site-East_Asian                (3) | Val  Loss: 1.9497 | Val  Acc: 0.3846
 Site-East_Asian                (2) | Val  Loss: 1.9587 | Val  Acc: 0.3846
 Site-East_Asian                (3) | Val  Loss: 1.9246 | Val  Acc: 0.3860
 Site-East_Asian                (3) | Val  Loss: 1.9458 | Val  Acc: 0.4235
 Site-East_Asian                (3) | Val  Loss: 1.9058 | Val  Acc: 0.4240
 Site-East_Asian                (3) | Val  Loss: 1.9310 | Val  Acc: 0.3859
 Site-Indian_utk                (5) | Val  Loss: 1.9785 | Val  Acc: 0.3793
 Site-Indian_utk                (4) | Val  Loss: 2.0199 | Val  Acc: 0.3256
 Site-Indian_utk                (4) | Val  Loss: 2.0017 | Val  Acc: 0.3651
 Site-Indian_utk                (4) | Val  Loss: 2.0341 | Val  Acc: 0.2935
 Site-Indian_utk                (4) | Val  Loss: 1.9134 | Val  Acc: 0.3529
 Site-Black_utk                 (4) | Val  Loss: 1.9965 | Val  Acc: 0.3333
 Site-Black_utk                 (4) | Val  Loss: 1.9849 | Val  Acc: 0.2963
 Site-Black_utk                 (4) | Val  Loss: 1.9648 | Val  Acc: 0.3291
 Site-Southeast_Asian           (3) | Val  Loss: 2.2259 | Val  Acc: 0.2647
 Site-Southeast_Asian           (3) | Val  Loss: 2.0634 | Val  Acc: 0.3100
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.9695 | Val  Acc: 0.1652
 Site-White_ffhq                (1) | Val  Loss: 1.4914 | Val  Acc: 0.9103
Average Valid Accuracy: 0.2730
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0909
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1176
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1600
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1081
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0727
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0988
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1008
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1086
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1085
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.1111
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3846
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3846
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3860
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.4235
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.4240
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3859
 Best site-Indian_utk               (5)  | Epoch:0 | Val Acc: 0.3793
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3256
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3651
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.2935
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3529
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3333
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.2963
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3291
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2647
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3100
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:0 | Val Acc: 0.1652
 Best site-White_ffhq               (1)  | Epoch:0 | Val Acc: 0.9103
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 9, 2, 12, 4, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.01775, quan_i=2.22, quan_c=2.17
minimize weight of clients:[10, 11, 12, 13, 14, 15, 16, 17, 22, 23, 24, 25, 26, 27, 28, ]
 Site-White_utk                 (3) | Train Loss: 1.8693 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 2.1127 | Train Acc: 0.1765
 Site-White_utk                 (3) | Train Loss: 2.1200 | Train Acc: 0.1154
 Site-White_utk                 (3) | Train Loss: 2.1786 | Train Acc: 0.0526
 Site-White_utk                 (0) | Train Loss: 2.1330 | Train Acc: 0.1429
 Site-White_utk                 (3) | Train Loss: 2.1184 | Train Acc: 0.1829
 Site-White_utk                 (3) | Train Loss: 2.0904 | Train Acc: 0.1818
 Site-White_utk                 (3) | Train Loss: 2.1094 | Train Acc: 0.1564
 Site-White_utk                 (3) | Train Loss: 2.0763 | Train Acc: 0.2015
 Site-White_utk                 (3) | Train Loss: 2.1241 | Train Acc: 0.1705
 Site-East_Asian                (1) | Train Loss: 1.8924 | Train Acc: 0.4815
 Site-East_Asian                (1) | Train Loss: 1.9797 | Train Acc: 0.3750
 Site-East_Asian                (1) | Train Loss: 1.9904 | Train Acc: 0.3220
 Site-East_Asian                (1) | Train Loss: 2.0574 | Train Acc: 0.3256
 Site-East_Asian                (1) | Train Loss: 1.9918 | Train Acc: 0.3701
 Site-East_Asian                (1) | Train Loss: 1.9954 | Train Acc: 0.3048
 Site-East_Asian                (1) | Train Loss: 1.9687 | Train Acc: 0.3406
 Site-Indian_utk                (4) | Train Loss: 2.0095 | Train Acc: 0.2326
 Site-Indian_utk                (3) | Train Loss: 1.9625 | Train Acc: 0.4062
 Site-Indian_utk                (3) | Train Loss: 1.9958 | Train Acc: 0.2979
 Site-Indian_utk                (3) | Train Loss: 1.9599 | Train Acc: 0.3381
 Site-Indian_utk                (3) | Train Loss: 1.9888 | Train Acc: 0.2927
 Site-Black_utk                 (4) | Train Loss: 1.9841 | Train Acc: 0.3273
 Site-Black_utk                 (4) | Train Loss: 2.0178 | Train Acc: 0.2840
 Site-Black_utk                 (4) | Train Loss: 2.0322 | Train Acc: 0.2941
 Site-Southeast_Asian           (1) | Train Loss: 2.0211 | Train Acc: 0.3431
 Site-Southeast_Asian           (1) | Train Loss: 2.0474 | Train Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.8611 | Train Acc: 0.4593
 Site-White_ffhq                (2) | Train Loss: 1.8235 | Train Acc: 0.5897
Average Train Accuracy: 0.2889
 Site-White_utk                 (3) | Val  Loss: 2.0533 | Val  Acc: 0.3750
 Site-White_utk                 (5) | Val  Loss: 2.0789 | Val  Acc: 0.2727
 Site-White_utk                 (3) | Val  Loss: 2.0666 | Val  Acc: 0.1176
 Site-White_utk                 (3) | Val  Loss: 2.1274 | Val  Acc: 0.1600
 Site-White_utk                 (0) | Val  Loss: 2.0921 | Val  Acc: 0.1351
 Site-White_utk                 (3) | Val  Loss: 2.0912 | Val  Acc: 0.1091
 Site-White_utk                 (3) | Val  Loss: 2.1056 | Val  Acc: 0.1728
 Site-White_utk                 (3) | Val  Loss: 2.1242 | Val  Acc: 0.1261
 Site-White_utk                 (3) | Val  Loss: 2.1059 | Val  Acc: 0.1657
 Site-White_utk                 (3) | Val  Loss: 2.1523 | Val  Acc: 0.1822
 Site-East_Asian                (1) | Val  Loss: 2.0733 | Val  Acc: 0.2222
 Site-East_Asian                (1) | Val  Loss: 1.9912 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 2.0153 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.9925 | Val  Acc: 0.3158
 Site-East_Asian                (1) | Val  Loss: 2.0140 | Val  Acc: 0.3294
 Site-East_Asian                (1) | Val  Loss: 1.9618 | Val  Acc: 0.3440
 Site-East_Asian                (1) | Val  Loss: 1.9756 | Val  Acc: 0.3750
 Site-Indian_utk                (4) | Val  Loss: 1.9807 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.9771 | Val  Acc: 0.2558
 Site-Indian_utk                (3) | Val  Loss: 1.9897 | Val  Acc: 0.3175
 Site-Indian_utk                (3) | Val  Loss: 1.9864 | Val  Acc: 0.2935
 Site-Indian_utk                (3) | Val  Loss: 1.9567 | Val  Acc: 0.2794
 Site-Black_utk                 (4) | Val  Loss: 2.0241 | Val  Acc: 0.3611
 Site-Black_utk                 (4) | Val  Loss: 2.0341 | Val  Acc: 0.2222
 Site-Black_utk                 (4) | Val  Loss: 1.9941 | Val  Acc: 0.3165
 Site-Southeast_Asian           (1) | Val  Loss: 2.1287 | Val  Acc: 0.2647
 Site-Southeast_Asian           (1) | Val  Loss: 2.0711 | Val  Acc: 0.2500
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.0193 | Val  Acc: 0.2261
 Site-White_ffhq                (2) | Val  Loss: 1.7356 | Val  Acc: 0.7436
Average Valid Accuracy: 0.2745
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.3750
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.2727
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1176
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1600
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1351
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1091
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1728
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1261
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1657
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1822
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.2222
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3846
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3333
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3158
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3294
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3440
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3750
 Best site-Indian_utk               (4)  | Epoch:1 | Val Acc: 0.3103
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.2558
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3175
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.2935
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.2794
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3611
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.2222
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3165
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2647
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2500
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:1 | Val Acc: 0.2261
 Best site-White_ffhq               (2)  | Epoch:1 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 9, 2, 8, 8, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.01285, quan_i=2.08, quan_c=2.08
minimize weight of clients:[0, 10, 11, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 27, 28, ]
 Site-White_utk                 (5) | Train Loss: 1.7977 | Train Acc: 0.5000
 Site-White_utk                 (4) | Train Loss: 2.0085 | Train Acc: 0.1765
 Site-White_utk                 (4) | Train Loss: 1.9861 | Train Acc: 0.2692
 Site-White_utk                 (0) | Train Loss: 2.1436 | Train Acc: 0.1316
 Site-White_utk                 (4) | Train Loss: 2.0290 | Train Acc: 0.2321
 Site-White_utk                 (4) | Train Loss: 1.9974 | Train Acc: 0.2195
 Site-White_utk                 (4) | Train Loss: 2.0049 | Train Acc: 0.2810
 Site-White_utk                 (4) | Train Loss: 2.0486 | Train Acc: 0.2458
 Site-White_utk                 (4) | Train Loss: 1.9598 | Train Acc: 0.2548
 Site-White_utk                 (4) | Train Loss: 1.9880 | Train Acc: 0.3075
 Site-East_Asian                (1) | Train Loss: 1.8811 | Train Acc: 0.5185
 Site-East_Asian                (1) | Train Loss: 2.0260 | Train Acc: 0.3250
 Site-East_Asian                (1) | Train Loss: 1.9993 | Train Acc: 0.3220
 Site-East_Asian                (1) | Train Loss: 2.0318 | Train Acc: 0.3023
 Site-East_Asian                (1) | Train Loss: 1.9933 | Train Acc: 0.3307
 Site-East_Asian                (1) | Train Loss: 1.9999 | Train Acc: 0.3155
 Site-East_Asian                (1) | Train Loss: 1.9912 | Train Acc: 0.3406
 Site-Indian_utk                (3) | Train Loss: 1.9776 | Train Acc: 0.2326
 Site-Indian_utk                (3) | Train Loss: 1.9366 | Train Acc: 0.3594
 Site-Indian_utk                (3) | Train Loss: 1.9608 | Train Acc: 0.3298
 Site-Indian_utk                (3) | Train Loss: 1.9812 | Train Acc: 0.3237
 Site-Indian_utk                (3) | Train Loss: 1.9946 | Train Acc: 0.2780
 Site-Black_utk                 (3) | Train Loss: 1.9763 | Train Acc: 0.3636
 Site-Black_utk                 (3) | Train Loss: 2.0359 | Train Acc: 0.2469
 Site-Black_utk                 (3) | Train Loss: 2.0649 | Train Acc: 0.2101
 Site-Southeast_Asian           (1) | Train Loss: 1.9939 | Train Acc: 0.3137
 Site-Southeast_Asian           (1) | Train Loss: 2.0434 | Train Acc: 0.2800
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.9663 | Train Acc: 0.3547
 Site-White_ffhq                (2) | Train Loss: 1.9080 | Train Acc: 0.4615
Average Train Accuracy: 0.3044
 Site-White_utk                 (5) | Val  Loss: 2.0307 | Val  Acc: 0.3750
 Site-White_utk                 (4) | Val  Loss: 1.9757 | Val  Acc: 0.2727
 Site-White_utk                 (4) | Val  Loss: 1.9611 | Val  Acc: 0.1765
 Site-White_utk                 (0) | Val  Loss: 2.0456 | Val  Acc: 0.2000
 Site-White_utk                 (4) | Val  Loss: 2.0452 | Val  Acc: 0.2973
 Site-White_utk                 (4) | Val  Loss: 1.9885 | Val  Acc: 0.3636
 Site-White_utk                 (4) | Val  Loss: 2.0248 | Val  Acc: 0.3210
 Site-White_utk                 (4) | Val  Loss: 2.0450 | Val  Acc: 0.2521
 Site-White_utk                 (4) | Val  Loss: 2.0314 | Val  Acc: 0.2400
 Site-White_utk                 (4) | Val  Loss: 2.1021 | Val  Acc: 0.2519
 Site-East_Asian                (1) | Val  Loss: 2.0458 | Val  Acc: 0.2778
 Site-East_Asian                (1) | Val  Loss: 2.0080 | Val  Acc: 0.3462
 Site-East_Asian                (1) | Val  Loss: 2.0658 | Val  Acc: 0.3077
 Site-East_Asian                (1) | Val  Loss: 2.0017 | Val  Acc: 0.3509
 Site-East_Asian                (1) | Val  Loss: 1.9987 | Val  Acc: 0.2941
 Site-East_Asian                (1) | Val  Loss: 1.9528 | Val  Acc: 0.3520
 Site-East_Asian                (1) | Val  Loss: 1.9795 | Val  Acc: 0.3478
 Site-Indian_utk                (3) | Val  Loss: 1.9724 | Val  Acc: 0.3793
 Site-Indian_utk                (3) | Val  Loss: 1.9158 | Val  Acc: 0.2558
 Site-Indian_utk                (3) | Val  Loss: 1.9889 | Val  Acc: 0.2857
 Site-Indian_utk                (3) | Val  Loss: 2.0354 | Val  Acc: 0.2826
 Site-Indian_utk                (3) | Val  Loss: 1.9699 | Val  Acc: 0.3235
 Site-Black_utk                 (3) | Val  Loss: 2.0276 | Val  Acc: 0.2500
 Site-Black_utk                 (3) | Val  Loss: 2.0378 | Val  Acc: 0.2593
 Site-Black_utk                 (3) | Val  Loss: 2.0472 | Val  Acc: 0.2785
 Site-Southeast_Asian           (1) | Val  Loss: 2.1273 | Val  Acc: 0.1912
 Site-Southeast_Asian           (1) | Val  Loss: 2.0387 | Val  Acc: 0.2700
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.0761 | Val  Acc: 0.2000
 Site-White_ffhq                (2) | Val  Loss: 1.8424 | Val  Acc: 0.5000
Average Valid Accuracy: 0.2932
 Best site-White_utk                (5)  | Epoch:2 | Val Acc: 0.3750
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.2727
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.1765
 Best site-White_utk                (0)  | Epoch:2 | Val Acc: 0.2000
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.2973
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.3636
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.3210
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.2521
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.2400
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.2519
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.2778
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.3462
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.3077
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.3509
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.2941
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.3520
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.3478
 Best site-Indian_utk               (3)  | Epoch:2 | Val Acc: 0.3793
 Best site-Indian_utk               (3)  | Epoch:2 | Val Acc: 0.2558
 Best site-Indian_utk               (3)  | Epoch:2 | Val Acc: 0.2857
 Best site-Indian_utk               (3)  | Epoch:2 | Val Acc: 0.2826
 Best site-Indian_utk               (3)  | Epoch:2 | Val Acc: 0.3235
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.2500
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.2593
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.2785
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.1912
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.2700
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:2 | Val Acc: 0.2000
 Best site-White_ffhq               (2)  | Epoch:2 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 1, 11, 5, 3, 8, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.01233, quan_i=2.04, quan_c=2.01
minimize weight of clients:[0, 2, 5, 8, 9, 12, 17, 18, 19, 20, 21, 27, 28, ]
 Site-White_utk                 (2) | Train Loss: 1.8693 | Train Acc: 0.3333
 Site-White_utk                 (2) | Train Loss: 1.9938 | Train Acc: 0.2941
 Site-White_utk                 (2) | Train Loss: 2.0281 | Train Acc: 0.2308
 Site-White_utk                 (0) | Train Loss: 2.1020 | Train Acc: 0.1316
 Site-White_utk                 (2) | Train Loss: 2.0387 | Train Acc: 0.1964
 Site-White_utk                 (2) | Train Loss: 2.0359 | Train Acc: 0.2561
 Site-White_utk                 (2) | Train Loss: 1.9773 | Train Acc: 0.2314
 Site-White_utk                 (2) | Train Loss: 2.0366 | Train Acc: 0.2011
 Site-White_utk                 (2) | Train Loss: 2.0559 | Train Acc: 0.2015
 Site-White_utk                 (2) | Train Loss: 1.9162 | Train Acc: 0.2119
 Site-East_Asian                (5) | Train Loss: 1.7733 | Train Acc: 0.4074
 Site-East_Asian                (5) | Train Loss: 1.7904 | Train Acc: 0.4750
 Site-East_Asian                (1) | Train Loss: 1.8419 | Train Acc: 0.3559
 Site-East_Asian                (5) | Train Loss: 1.8692 | Train Acc: 0.3488
 Site-East_Asian                (5) | Train Loss: 1.8245 | Train Acc: 0.4016
 Site-East_Asian                (5) | Train Loss: 1.8458 | Train Acc: 0.3690
 Site-East_Asian                (5) | Train Loss: 1.7818 | Train Acc: 0.4022
 Site-Indian_utk                (3) | Train Loss: 1.8982 | Train Acc: 0.2558
 Site-Indian_utk                (3) | Train Loss: 1.7933 | Train Acc: 0.4688
 Site-Indian_utk                (3) | Train Loss: 1.8929 | Train Acc: 0.3511
 Site-Indian_utk                (3) | Train Loss: 1.8697 | Train Acc: 0.3885
 Site-Indian_utk                (3) | Train Loss: 1.8761 | Train Acc: 0.3366
 Site-Black_utk                 (4) | Train Loss: 1.8475 | Train Acc: 0.4545
 Site-Black_utk                 (4) | Train Loss: 1.8966 | Train Acc: 0.3086
 Site-Black_utk                 (4) | Train Loss: 1.9099 | Train Acc: 0.3025
 Site-Southeast_Asian           (5) | Train Loss: 1.9813 | Train Acc: 0.3333
 Site-Southeast_Asian           (5) | Train Loss: 1.9456 | Train Acc: 0.3133
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.7056 | Train Acc: 0.4709
 Site-White_ffhq                (2) | Train Loss: 1.6386 | Train Acc: 0.6325
Average Train Accuracy: 0.3333
 Site-White_utk                 (2) | Val  Loss: 1.9057 | Val  Acc: 0.2500
 Site-White_utk                 (2) | Val  Loss: 1.9583 | Val  Acc: 0.1818
 Site-White_utk                 (2) | Val  Loss: 2.0269 | Val  Acc: 0.1176
 Site-White_utk                 (0) | Val  Loss: 2.0489 | Val  Acc: 0.1200
 Site-White_utk                 (2) | Val  Loss: 2.0293 | Val  Acc: 0.2703
 Site-White_utk                 (2) | Val  Loss: 2.0199 | Val  Acc: 0.1818
 Site-White_utk                 (2) | Val  Loss: 2.0165 | Val  Acc: 0.1975
 Site-White_utk                 (2) | Val  Loss: 2.0405 | Val  Acc: 0.1933
 Site-White_utk                 (2) | Val  Loss: 2.0377 | Val  Acc: 0.2057
 Site-White_utk                 (2) | Val  Loss: 2.0523 | Val  Acc: 0.2209
 Site-East_Asian                (5) | Val  Loss: 1.9385 | Val  Acc: 0.2778
 Site-East_Asian                (5) | Val  Loss: 1.7904 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.8752 | Val  Acc: 0.3590
 Site-East_Asian                (5) | Val  Loss: 1.8192 | Val  Acc: 0.4035
 Site-East_Asian                (5) | Val  Loss: 1.8568 | Val  Acc: 0.4118
 Site-East_Asian                (5) | Val  Loss: 1.7909 | Val  Acc: 0.4240
 Site-East_Asian                (5) | Val  Loss: 1.8131 | Val  Acc: 0.3967
 Site-Indian_utk                (3) | Val  Loss: 1.8847 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.8253 | Val  Acc: 0.3721
 Site-Indian_utk                (3) | Val  Loss: 1.8698 | Val  Acc: 0.3492
 Site-Indian_utk                (3) | Val  Loss: 1.8806 | Val  Acc: 0.3261
 Site-Indian_utk                (3) | Val  Loss: 1.8094 | Val  Acc: 0.3309
 Site-Black_utk                 (4) | Val  Loss: 1.8742 | Val  Acc: 0.3333
 Site-Black_utk                 (4) | Val  Loss: 1.9130 | Val  Acc: 0.2963
 Site-Black_utk                 (4) | Val  Loss: 1.9184 | Val  Acc: 0.3165
 Site-Southeast_Asian           (5) | Val  Loss: 1.9950 | Val  Acc: 0.2647
 Site-Southeast_Asian           (5) | Val  Loss: 1.9544 | Val  Acc: 0.3000
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9361 | Val  Acc: 0.2348
 Site-White_ffhq                (2) | Val  Loss: 1.5287 | Val  Acc: 0.7949
Average Valid Accuracy: 0.3070
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.2500
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1818
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1176
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.1200
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.2703
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1818
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1975
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1933
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.2057
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.2209
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.2778
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:3 | Val Acc: 0.3590
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4035
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4118
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4240
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.3967
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3103
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3721
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3492
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3261
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3309
 Best site-Black_utk                (4)  | Epoch:3 | Val Acc: 0.3333
 Best site-Black_utk                (4)  | Epoch:3 | Val Acc: 0.2963
 Best site-Black_utk                (4)  | Epoch:3 | Val Acc: 0.3165
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.2647
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3000
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:3 | Val Acc: 0.2348
 Best site-White_ffhq               (2)  | Epoch:3 | Val Acc: 0.7949
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 9, 1, 2, 9, 7, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.01318, quan_i=1.98, quan_c=2.01
minimize weight of clients:[10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, ]
 Site-White_utk                 (4) | Train Loss: 1.6461 | Train Acc: 0.5000
 Site-White_utk                 (4) | Train Loss: 1.7626 | Train Acc: 0.2353
 Site-White_utk                 (2) | Train Loss: 1.7841 | Train Acc: 0.3846
 Site-White_utk                 (4) | Train Loss: 1.9460 | Train Acc: 0.2368
 Site-White_utk                 (4) | Train Loss: 1.8460 | Train Acc: 0.3036
 Site-White_utk                 (4) | Train Loss: 1.8935 | Train Acc: 0.3293
 Site-White_utk                 (4) | Train Loss: 1.8616 | Train Acc: 0.3058
 Site-White_utk                 (4) | Train Loss: 1.8849 | Train Acc: 0.2961
 Site-White_utk                 (4) | Train Loss: 1.8801 | Train Acc: 0.3194
 Site-White_utk                 (4) | Train Loss: 1.8392 | Train Acc: 0.3411
 Site-East_Asian                (1) | Train Loss: 1.7264 | Train Acc: 0.3704
 Site-East_Asian                (1) | Train Loss: 1.7828 | Train Acc: 0.4000
 Site-East_Asian                (1) | Train Loss: 1.9221 | Train Acc: 0.2542
 Site-East_Asian                (1) | Train Loss: 1.8286 | Train Acc: 0.3372
 Site-East_Asian                (1) | Train Loss: 1.8401 | Train Acc: 0.3150
 Site-East_Asian                (1) | Train Loss: 1.8656 | Train Acc: 0.2888
 Site-East_Asian                (1) | Train Loss: 1.8292 | Train Acc: 0.3478
 Site-Indian_utk                (0) | Train Loss: 1.8767 | Train Acc: 0.2791
 Site-Indian_utk                (5) | Train Loss: 1.8962 | Train Acc: 0.3438
 Site-Indian_utk                (5) | Train Loss: 1.9210 | Train Acc: 0.2447
 Site-Indian_utk                (5) | Train Loss: 1.8778 | Train Acc: 0.3165
 Site-Indian_utk                (5) | Train Loss: 1.9243 | Train Acc: 0.2634
 Site-Black_utk                 (5) | Train Loss: 1.8666 | Train Acc: 0.3455
 Site-Black_utk                 (5) | Train Loss: 1.9675 | Train Acc: 0.2222
 Site-Black_utk                 (5) | Train Loss: 1.9856 | Train Acc: 0.1933
 Site-Southeast_Asian           (1) | Train Loss: 1.9474 | Train Acc: 0.2353
 Site-Southeast_Asian           (1) | Train Loss: 1.9567 | Train Acc: 0.2867
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.9042 | Train Acc: 0.2791
 Site-White_ffhq                (3) | Train Loss: 2.0069 | Train Acc: 0.1624
Average Train Accuracy: 0.3013
 Site-White_utk                 (4) | Val  Loss: 1.8036 | Val  Acc: 0.2500
 Site-White_utk                 (4) | Val  Loss: 1.7639 | Val  Acc: 0.2727
 Site-White_utk                 (2) | Val  Loss: 1.8570 | Val  Acc: 0.4118
 Site-White_utk                 (4) | Val  Loss: 1.8679 | Val  Acc: 0.3200
 Site-White_utk                 (4) | Val  Loss: 1.8779 | Val  Acc: 0.3514
 Site-White_utk                 (4) | Val  Loss: 1.8527 | Val  Acc: 0.3818
 Site-White_utk                 (4) | Val  Loss: 1.9441 | Val  Acc: 0.2593
 Site-White_utk                 (4) | Val  Loss: 1.8633 | Val  Acc: 0.3109
 Site-White_utk                 (4) | Val  Loss: 1.9131 | Val  Acc: 0.2686
 Site-White_utk                 (4) | Val  Loss: 1.9128 | Val  Acc: 0.3101
 Site-East_Asian                (1) | Val  Loss: 1.8300 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.8073 | Val  Acc: 0.3846
 Site-East_Asian                (1) | Val  Loss: 1.8657 | Val  Acc: 0.2308
 Site-East_Asian                (1) | Val  Loss: 1.8571 | Val  Acc: 0.2281
 Site-East_Asian                (1) | Val  Loss: 1.8517 | Val  Acc: 0.3882
 Site-East_Asian                (1) | Val  Loss: 1.8085 | Val  Acc: 0.3280
 Site-East_Asian                (1) | Val  Loss: 1.8254 | Val  Acc: 0.3533
 Site-Indian_utk                (0) | Val  Loss: 1.8125 | Val  Acc: 0.2759
 Site-Indian_utk                (5) | Val  Loss: 1.8308 | Val  Acc: 0.2791
 Site-Indian_utk                (5) | Val  Loss: 1.9142 | Val  Acc: 0.2063
 Site-Indian_utk                (5) | Val  Loss: 1.9459 | Val  Acc: 0.2283
 Site-Indian_utk                (5) | Val  Loss: 1.8642 | Val  Acc: 0.2794
 Site-Black_utk                 (5) | Val  Loss: 1.8585 | Val  Acc: 0.2500
 Site-Black_utk                 (5) | Val  Loss: 1.9949 | Val  Acc: 0.2222
 Site-Black_utk                 (5) | Val  Loss: 1.9318 | Val  Acc: 0.2532
 Site-Southeast_Asian           (1) | Val  Loss: 1.8865 | Val  Acc: 0.1912
 Site-Southeast_Asian           (1) | Val  Loss: 1.9758 | Val  Acc: 0.2400
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.9474 | Val  Acc: 0.3043
 Site-White_ffhq                (3) | Val  Loss: 2.0124 | Val  Acc: 0.1923
Average Valid Accuracy: 0.2921
============ Train epoch 5 ============
cnt=[1, 8, 9, 9, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.01059, quan_i=1.92, quan_c=1.93
minimize weight of clients:[0, 1, 2, 4, 6, 7, 8, 9, 10, 11, 13, 14, 15, 16, ]
 Site-White_utk                 (3) | Train Loss: 1.7157 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 1.7489 | Train Acc: 0.4706
 Site-White_utk                 (3) | Train Loss: 1.8781 | Train Acc: 0.2308
 Site-White_utk                 (3) | Train Loss: 1.9401 | Train Acc: 0.2368
 Site-White_utk                 (3) | Train Loss: 1.8501 | Train Acc: 0.2321
 Site-White_utk                 (3) | Train Loss: 1.9343 | Train Acc: 0.2805
 Site-White_utk                 (3) | Train Loss: 1.8617 | Train Acc: 0.2727
 Site-White_utk                 (3) | Train Loss: 1.9160 | Train Acc: 0.2402
 Site-White_utk                 (3) | Train Loss: 1.9006 | Train Acc: 0.2586
 Site-White_utk                 (3) | Train Loss: 1.9347 | Train Acc: 0.2636
 Site-East_Asian                (2) | Train Loss: 1.5894 | Train Acc: 0.4815
 Site-East_Asian                (2) | Train Loss: 1.6091 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.7889 | Train Acc: 0.3559
 Site-East_Asian                (2) | Train Loss: 1.7739 | Train Acc: 0.3721
 Site-East_Asian                (2) | Train Loss: 1.6925 | Train Acc: 0.4488
 Site-East_Asian                (2) | Train Loss: 1.7362 | Train Acc: 0.3636
 Site-East_Asian                (2) | Train Loss: 1.6607 | Train Acc: 0.4167
 Site-Indian_utk                (1) | Train Loss: 1.7319 | Train Acc: 0.3721
 Site-Indian_utk                (1) | Train Loss: 1.6832 | Train Acc: 0.3906
 Site-Indian_utk                (1) | Train Loss: 1.7153 | Train Acc: 0.3936
 Site-Indian_utk                (1) | Train Loss: 1.7595 | Train Acc: 0.4245
 Site-Indian_utk                (1) | Train Loss: 1.7779 | Train Acc: 0.4098
 Site-Black_utk                 (1) | Train Loss: 1.6773 | Train Acc: 0.4182
 Site-Black_utk                 (1) | Train Loss: 1.7759 | Train Acc: 0.3333
 Site-Black_utk                 (1) | Train Loss: 1.8210 | Train Acc: 0.3529
 Site-Southeast_Asian           (2) | Train Loss: 1.8830 | Train Acc: 0.3235
 Site-Southeast_Asian           (2) | Train Loss: 1.8432 | Train Acc: 0.3800
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5779 | Train Acc: 0.4535
 Site-White_ffhq                (0) | Train Loss: 1.5382 | Train Acc: 0.5641
Average Train Accuracy: 0.3646
 Site-White_utk                 (3) | Val  Loss: 1.8363 | Val  Acc: 0.2500
 Site-White_utk                 (5) | Val  Loss: 1.8167 | Val  Acc: 0.3636
 Site-White_utk                 (3) | Val  Loss: 1.8358 | Val  Acc: 0.2941
 Site-White_utk                 (3) | Val  Loss: 1.8473 | Val  Acc: 0.2800
 Site-White_utk                 (3) | Val  Loss: 1.8891 | Val  Acc: 0.3243
 Site-White_utk                 (3) | Val  Loss: 1.8905 | Val  Acc: 0.2727
 Site-White_utk                 (3) | Val  Loss: 1.9404 | Val  Acc: 0.2840
 Site-White_utk                 (3) | Val  Loss: 1.9382 | Val  Acc: 0.2437
 Site-White_utk                 (3) | Val  Loss: 1.9231 | Val  Acc: 0.2400
 Site-White_utk                 (3) | Val  Loss: 1.9383 | Val  Acc: 0.2442
 Site-East_Asian                (2) | Val  Loss: 1.8640 | Val  Acc: 0.3889
 Site-East_Asian                (2) | Val  Loss: 1.6940 | Val  Acc: 0.3846
 Site-East_Asian                (2) | Val  Loss: 1.6877 | Val  Acc: 0.4359
 Site-East_Asian                (2) | Val  Loss: 1.7134 | Val  Acc: 0.4035
 Site-East_Asian                (2) | Val  Loss: 1.7655 | Val  Acc: 0.4118
 Site-East_Asian                (2) | Val  Loss: 1.6791 | Val  Acc: 0.4640
 Site-East_Asian                (2) | Val  Loss: 1.7201 | Val  Acc: 0.4293
 Site-Indian_utk                (1) | Val  Loss: 1.7188 | Val  Acc: 0.4483
 Site-Indian_utk                (1) | Val  Loss: 1.6816 | Val  Acc: 0.4186
 Site-Indian_utk                (1) | Val  Loss: 1.7008 | Val  Acc: 0.4762
 Site-Indian_utk                (1) | Val  Loss: 1.7711 | Val  Acc: 0.3913
 Site-Indian_utk                (1) | Val  Loss: 1.6083 | Val  Acc: 0.3676
 Site-Black_utk                 (1) | Val  Loss: 1.7511 | Val  Acc: 0.3889
 Site-Black_utk                 (1) | Val  Loss: 1.7890 | Val  Acc: 0.3148
 Site-Black_utk                 (1) | Val  Loss: 1.7738 | Val  Acc: 0.3418
 Site-Southeast_Asian           (2) | Val  Loss: 1.9294 | Val  Acc: 0.3088
 Site-Southeast_Asian           (2) | Val  Loss: 1.8413 | Val  Acc: 0.3500
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8469 | Val  Acc: 0.2609
 Site-White_ffhq                (0) | Val  Loss: 1.4150 | Val  Acc: 0.7051
Average Valid Accuracy: 0.3616
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2500
 Best site-White_utk                (5)  | Epoch:5 | Val Acc: 0.3636
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2941
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2800
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.3243
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2727
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2840
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2437
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2400
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2442
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3889
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3846
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4359
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4035
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4118
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4640
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4293
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.4483
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.4186
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.4762
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3913
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3676
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.3889
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.3148
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.3418
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3088
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3500
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:5 | Val Acc: 0.2609
 Best site-White_ffhq               (0)  | Epoch:5 | Val Acc: 0.7051
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 9, 14, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.01073, quan_i=1.85, quan_c=1.88
minimize weight of clients:[0, 10, 11, 12, 13, 14, 15, 16, 22, 23, 27, 28, ]
 Site-White_utk                 (0) | Train Loss: 1.5751 | Train Acc: 0.4167
 Site-White_utk                 (2) | Train Loss: 1.7054 | Train Acc: 0.2353
 Site-White_utk                 (2) | Train Loss: 1.8134 | Train Acc: 0.3077
 Site-White_utk                 (2) | Train Loss: 1.8864 | Train Acc: 0.2105
 Site-White_utk                 (2) | Train Loss: 1.7993 | Train Acc: 0.3214
 Site-White_utk                 (2) | Train Loss: 1.7936 | Train Acc: 0.3171
 Site-White_utk                 (2) | Train Loss: 1.7982 | Train Acc: 0.3058
 Site-White_utk                 (2) | Train Loss: 1.8090 | Train Acc: 0.2793
 Site-White_utk                 (2) | Train Loss: 1.8107 | Train Acc: 0.3346
 Site-White_utk                 (2) | Train Loss: 1.7816 | Train Acc: 0.3359
 Site-East_Asian                (1) | Train Loss: 1.5833 | Train Acc: 0.5185
 Site-East_Asian                (1) | Train Loss: 1.6711 | Train Acc: 0.3750
 Site-East_Asian                (1) | Train Loss: 1.7855 | Train Acc: 0.3220
 Site-East_Asian                (1) | Train Loss: 1.7555 | Train Acc: 0.3605
 Site-East_Asian                (1) | Train Loss: 1.7225 | Train Acc: 0.4331
 Site-East_Asian                (1) | Train Loss: 1.7328 | Train Acc: 0.3529
 Site-East_Asian                (1) | Train Loss: 1.6726 | Train Acc: 0.4312
 Site-Indian_utk                (2) | Train Loss: 1.7083 | Train Acc: 0.4651
 Site-Indian_utk                (2) | Train Loss: 1.6740 | Train Acc: 0.4219
 Site-Indian_utk                (2) | Train Loss: 1.7316 | Train Acc: 0.3404
 Site-Indian_utk                (2) | Train Loss: 1.6798 | Train Acc: 0.3957
 Site-Indian_utk                (2) | Train Loss: 1.7320 | Train Acc: 0.3854
 Site-Black_utk                 (3) | Train Loss: 1.6944 | Train Acc: 0.4364
 Site-Black_utk                 (5) | Train Loss: 1.7435 | Train Acc: 0.3704
 Site-Black_utk                 (5) | Train Loss: 1.7900 | Train Acc: 0.3613
 Site-Southeast_Asian           (1) | Train Loss: 1.8776 | Train Acc: 0.3235
 Site-Southeast_Asian           (1) | Train Loss: 1.8231 | Train Acc: 0.3733
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6981 | Train Acc: 0.3605
 Site-White_ffhq                (4) | Train Loss: 1.7022 | Train Acc: 0.3675
Average Train Accuracy: 0.3607
 Site-White_utk                 (0) | Val  Loss: 1.6961 | Val  Acc: 0.1250
 Site-White_utk                 (2) | Val  Loss: 1.6829 | Val  Acc: 0.2727
 Site-White_utk                 (2) | Val  Loss: 1.7524 | Val  Acc: 0.3529
 Site-White_utk                 (2) | Val  Loss: 1.8193 | Val  Acc: 0.3200
 Site-White_utk                 (2) | Val  Loss: 1.7912 | Val  Acc: 0.3243
 Site-White_utk                 (2) | Val  Loss: 1.8059 | Val  Acc: 0.3091
 Site-White_utk                 (2) | Val  Loss: 1.8661 | Val  Acc: 0.3333
 Site-White_utk                 (2) | Val  Loss: 1.7879 | Val  Acc: 0.3193
 Site-White_utk                 (2) | Val  Loss: 1.8348 | Val  Acc: 0.2914
 Site-White_utk                 (2) | Val  Loss: 1.8653 | Val  Acc: 0.3023
 Site-East_Asian                (1) | Val  Loss: 1.7913 | Val  Acc: 0.3889
 Site-East_Asian                (1) | Val  Loss: 1.7184 | Val  Acc: 0.3462
 Site-East_Asian                (1) | Val  Loss: 1.7355 | Val  Acc: 0.4103
 Site-East_Asian                (1) | Val  Loss: 1.7259 | Val  Acc: 0.4211
 Site-East_Asian                (1) | Val  Loss: 1.7483 | Val  Acc: 0.4353
 Site-East_Asian                (1) | Val  Loss: 1.6965 | Val  Acc: 0.4240
 Site-East_Asian                (1) | Val  Loss: 1.6939 | Val  Acc: 0.4783
 Site-Indian_utk                (2) | Val  Loss: 1.6998 | Val  Acc: 0.3448
 Site-Indian_utk                (2) | Val  Loss: 1.6823 | Val  Acc: 0.3721
 Site-Indian_utk                (2) | Val  Loss: 1.6642 | Val  Acc: 0.4127
 Site-Indian_utk                (2) | Val  Loss: 1.7946 | Val  Acc: 0.3804
 Site-Indian_utk                (2) | Val  Loss: 1.6062 | Val  Acc: 0.3971
 Site-Black_utk                 (3) | Val  Loss: 1.8304 | Val  Acc: 0.3611
 Site-Black_utk                 (5) | Val  Loss: 1.7755 | Val  Acc: 0.3519
 Site-Black_utk                 (5) | Val  Loss: 1.7653 | Val  Acc: 0.2911
 Site-Southeast_Asian           (1) | Val  Loss: 1.7748 | Val  Acc: 0.3235
 Site-Southeast_Asian           (1) | Val  Loss: 1.8669 | Val  Acc: 0.3400
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8638 | Val  Acc: 0.3304
 Site-White_ffhq                (4) | Val  Loss: 1.6891 | Val  Acc: 0.4359
Average Valid Accuracy: 0.3516
============ Train epoch 7 ============
cnt=[8, 1, 2, 8, 1, 9, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.00910, quan_i=1.82, quan_c=1.79
minimize weight of clients:[0, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 27, 28, ]
 Site-White_utk                 (4) | Train Loss: 1.4915 | Train Acc: 0.5000
 Site-White_utk                 (5) | Train Loss: 1.7308 | Train Acc: 0.2941
 Site-White_utk                 (5) | Train Loss: 1.6560 | Train Acc: 0.4615
 Site-White_utk                 (5) | Train Loss: 1.8012 | Train Acc: 0.3158
 Site-White_utk                 (5) | Train Loss: 1.7039 | Train Acc: 0.3214
 Site-White_utk                 (5) | Train Loss: 1.6322 | Train Acc: 0.3415
 Site-White_utk                 (5) | Train Loss: 1.7134 | Train Acc: 0.3719
 Site-White_utk                 (5) | Train Loss: 1.7755 | Train Acc: 0.3408
 Site-White_utk                 (5) | Train Loss: 1.6762 | Train Acc: 0.3764
 Site-White_utk                 (5) | Train Loss: 1.7389 | Train Acc: 0.4289
 Site-East_Asian                (1) | Train Loss: 1.5913 | Train Acc: 0.4444
 Site-East_Asian                (3) | Train Loss: 1.7141 | Train Acc: 0.3750
 Site-East_Asian                (3) | Train Loss: 1.8273 | Train Acc: 0.2881
 Site-East_Asian                (3) | Train Loss: 1.8268 | Train Acc: 0.3953
 Site-East_Asian                (3) | Train Loss: 1.7474 | Train Acc: 0.4016
 Site-East_Asian                (3) | Train Loss: 1.7608 | Train Acc: 0.3529
 Site-East_Asian                (3) | Train Loss: 1.7514 | Train Acc: 0.3877
 Site-Indian_utk                (0) | Train Loss: 1.7275 | Train Acc: 0.3953
 Site-Indian_utk                (0) | Train Loss: 1.7429 | Train Acc: 0.3594
 Site-Indian_utk                (0) | Train Loss: 1.7597 | Train Acc: 0.2447
 Site-Indian_utk                (0) | Train Loss: 1.7667 | Train Acc: 0.3381
 Site-Indian_utk                (0) | Train Loss: 1.7224 | Train Acc: 0.3902
 Site-Black_utk                 (0) | Train Loss: 1.7154 | Train Acc: 0.4182
 Site-Black_utk                 (0) | Train Loss: 1.8315 | Train Acc: 0.3704
 Site-Black_utk                 (0) | Train Loss: 1.8200 | Train Acc: 0.3361
 Site-Southeast_Asian           (3) | Train Loss: 1.8668 | Train Acc: 0.2941
 Site-Southeast_Asian           (3) | Train Loss: 1.8588 | Train Acc: 0.3400
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.9012 | Train Acc: 0.2151
 Site-White_ffhq                (2) | Train Loss: 1.9152 | Train Acc: 0.2308
Average Train Accuracy: 0.3562
 Site-White_utk                 (4) | Val  Loss: 1.6108 | Val  Acc: 0.3750
 Site-White_utk                 (5) | Val  Loss: 1.6956 | Val  Acc: 0.3636
 Site-White_utk                 (5) | Val  Loss: 1.7613 | Val  Acc: 0.2941
 Site-White_utk                 (5) | Val  Loss: 1.7474 | Val  Acc: 0.2400
 Site-White_utk                 (5) | Val  Loss: 1.6665 | Val  Acc: 0.3514
 Site-White_utk                 (5) | Val  Loss: 1.7811 | Val  Acc: 0.4000
 Site-White_utk                 (5) | Val  Loss: 1.7588 | Val  Acc: 0.4444
 Site-White_utk                 (5) | Val  Loss: 1.7371 | Val  Acc: 0.3277
 Site-White_utk                 (5) | Val  Loss: 1.7646 | Val  Acc: 0.3257
 Site-White_utk                 (5) | Val  Loss: 1.8336 | Val  Acc: 0.3643
 Site-East_Asian                (1) | Val  Loss: 1.8449 | Val  Acc: 0.3333
 Site-East_Asian                (3) | Val  Loss: 1.7340 | Val  Acc: 0.4231
 Site-East_Asian                (3) | Val  Loss: 1.7244 | Val  Acc: 0.4615
 Site-East_Asian                (3) | Val  Loss: 1.7352 | Val  Acc: 0.3333
 Site-East_Asian                (3) | Val  Loss: 1.7622 | Val  Acc: 0.3882
 Site-East_Asian                (3) | Val  Loss: 1.7108 | Val  Acc: 0.4240
 Site-East_Asian                (3) | Val  Loss: 1.7497 | Val  Acc: 0.4076
 Site-Indian_utk                (0) | Val  Loss: 1.6766 | Val  Acc: 0.3448
 Site-Indian_utk                (0) | Val  Loss: 1.6590 | Val  Acc: 0.3953
 Site-Indian_utk                (0) | Val  Loss: 1.7284 | Val  Acc: 0.3333
 Site-Indian_utk                (0) | Val  Loss: 1.7754 | Val  Acc: 0.3261
 Site-Indian_utk                (0) | Val  Loss: 1.6596 | Val  Acc: 0.3603
 Site-Black_utk                 (0) | Val  Loss: 1.8422 | Val  Acc: 0.3611
 Site-Black_utk                 (0) | Val  Loss: 1.8390 | Val  Acc: 0.3148
 Site-Black_utk                 (0) | Val  Loss: 1.7697 | Val  Acc: 0.3671
 Site-Southeast_Asian           (3) | Val  Loss: 1.7853 | Val  Acc: 0.3382
 Site-Southeast_Asian           (3) | Val  Loss: 1.8309 | Val  Acc: 0.3500
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9639 | Val  Acc: 0.2870
 Site-White_ffhq                (2) | Val  Loss: 1.9548 | Val  Acc: 0.3077
Average Valid Accuracy: 0.3567
============ Train epoch 8 ============
cnt=[5, 1, 10, 8, 2, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.00881, quan_i=1.81, quan_c=1.81
minimize weight of clients:[0, 1, 2, 4, 5, 6, 7, 8, 9, 10, 17, 18, 19, 20, 21, ]
 Site-White_utk                 (2) | Train Loss: 1.5377 | Train Acc: 0.3333
 Site-White_utk                 (2) | Train Loss: 1.6545 | Train Acc: 0.3529
 Site-White_utk                 (2) | Train Loss: 1.6997 | Train Acc: 0.3462
 Site-White_utk                 (2) | Train Loss: 1.8967 | Train Acc: 0.2895
 Site-White_utk                 (2) | Train Loss: 1.6993 | Train Acc: 0.3214
 Site-White_utk                 (2) | Train Loss: 1.7254 | Train Acc: 0.3293
 Site-White_utk                 (2) | Train Loss: 1.7508 | Train Acc: 0.2893
 Site-White_utk                 (2) | Train Loss: 1.8173 | Train Acc: 0.2458
 Site-White_utk                 (2) | Train Loss: 1.8116 | Train Acc: 0.2928
 Site-White_utk                 (2) | Train Loss: 1.7892 | Train Acc: 0.2894
 Site-East_Asian                (1) | Train Loss: 1.5067 | Train Acc: 0.4815
 Site-East_Asian                (3) | Train Loss: 1.5058 | Train Acc: 0.5000
 Site-East_Asian                (3) | Train Loss: 1.7270 | Train Acc: 0.3390
 Site-East_Asian                (3) | Train Loss: 1.6893 | Train Acc: 0.4186
 Site-East_Asian                (3) | Train Loss: 1.6285 | Train Acc: 0.4409
 Site-East_Asian                (3) | Train Loss: 1.6173 | Train Acc: 0.4118
 Site-East_Asian                (3) | Train Loss: 1.6143 | Train Acc: 0.4275
 Site-Indian_utk                (0) | Train Loss: 1.5988 | Train Acc: 0.4651
 Site-Indian_utk                (0) | Train Loss: 1.5475 | Train Acc: 0.4375
 Site-Indian_utk                (0) | Train Loss: 1.7049 | Train Acc: 0.3936
 Site-Indian_utk                (0) | Train Loss: 1.5794 | Train Acc: 0.4173
 Site-Indian_utk                (0) | Train Loss: 1.6293 | Train Acc: 0.4683
 Site-Black_utk                 (5) | Train Loss: 1.6144 | Train Acc: 0.4182
 Site-Black_utk                 (5) | Train Loss: 1.7088 | Train Acc: 0.4074
 Site-Black_utk                 (5) | Train Loss: 1.6907 | Train Acc: 0.3782
 Site-Southeast_Asian           (3) | Train Loss: 1.8133 | Train Acc: 0.3627
 Site-Southeast_Asian           (3) | Train Loss: 1.8175 | Train Acc: 0.3933
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5320 | Train Acc: 0.4302
 Site-White_ffhq                (4) | Train Loss: 1.4229 | Train Acc: 0.5983
Average Train Accuracy: 0.3889
 Site-White_utk                 (2) | Val  Loss: 1.7176 | Val  Acc: 0.2500
 Site-White_utk                 (2) | Val  Loss: 1.6678 | Val  Acc: 0.4545
 Site-White_utk                 (2) | Val  Loss: 1.8022 | Val  Acc: 0.2941
 Site-White_utk                 (2) | Val  Loss: 1.7636 | Val  Acc: 0.2800
 Site-White_utk                 (2) | Val  Loss: 1.7189 | Val  Acc: 0.3784
 Site-White_utk                 (2) | Val  Loss: 1.8094 | Val  Acc: 0.2727
 Site-White_utk                 (2) | Val  Loss: 1.8433 | Val  Acc: 0.2469
 Site-White_utk                 (2) | Val  Loss: 1.7773 | Val  Acc: 0.3109
 Site-White_utk                 (2) | Val  Loss: 1.8129 | Val  Acc: 0.3029
 Site-White_utk                 (2) | Val  Loss: 1.8361 | Val  Acc: 0.3023
 Site-East_Asian                (1) | Val  Loss: 1.7973 | Val  Acc: 0.3333
 Site-East_Asian                (3) | Val  Loss: 1.5670 | Val  Acc: 0.3846
 Site-East_Asian                (3) | Val  Loss: 1.6102 | Val  Acc: 0.4615
 Site-East_Asian                (3) | Val  Loss: 1.5990 | Val  Acc: 0.4386
 Site-East_Asian                (3) | Val  Loss: 1.6412 | Val  Acc: 0.4588
 Site-East_Asian                (3) | Val  Loss: 1.5811 | Val  Acc: 0.4560
 Site-East_Asian                (3) | Val  Loss: 1.6296 | Val  Acc: 0.4185
 Site-Indian_utk                (0) | Val  Loss: 1.6944 | Val  Acc: 0.4138
 Site-Indian_utk                (0) | Val  Loss: 1.5383 | Val  Acc: 0.4419
 Site-Indian_utk                (0) | Val  Loss: 1.6418 | Val  Acc: 0.3968
 Site-Indian_utk                (0) | Val  Loss: 1.6742 | Val  Acc: 0.4348
 Site-Indian_utk                (0) | Val  Loss: 1.5340 | Val  Acc: 0.4412
 Site-Black_utk                 (5) | Val  Loss: 1.6718 | Val  Acc: 0.4167
 Site-Black_utk                 (5) | Val  Loss: 1.6442 | Val  Acc: 0.3519
 Site-Black_utk                 (5) | Val  Loss: 1.6252 | Val  Acc: 0.3671
 Site-Southeast_Asian           (3) | Val  Loss: 1.9221 | Val  Acc: 0.3382
 Site-Southeast_Asian           (3) | Val  Loss: 1.7929 | Val  Acc: 0.3900
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8062 | Val  Acc: 0.2348
 Site-White_ffhq                (4) | Val  Loss: 1.2967 | Val  Acc: 0.7692
Average Valid Accuracy: 0.3807
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2500
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.4545
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2941
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2800
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3784
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2727
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2469
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3109
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3029
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3023
 Best site-East_Asian               (1)  | Epoch:8 | Val Acc: 0.3333
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.3846
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4615
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4386
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4588
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4560
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4185
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.4138
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.4419
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.3968
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.4348
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.4412
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.4167
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.3519
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.3671
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.3382
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.3900
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:8 | Val Acc: 0.2348
 Best site-White_ffhq               (4)  | Epoch:8 | Val Acc: 0.7692
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 9, 5, 11, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
min_w=0.00854, quan_i=1.74, quan_c=1.78
minimize weight of clients:[0, 4, 10, 11, 13, 14, 15, 16, 17, 18, 19, 20, 21, 27, 28, ]
 Site-White_utk                 (5) | Train Loss: 1.4869 | Train Acc: 0.4167
 Site-White_utk                 (4) | Train Loss: 1.6418 | Train Acc: 0.2941
 Site-White_utk                 (4) | Train Loss: 1.5722 | Train Acc: 0.3462
 Site-White_utk                 (4) | Train Loss: 1.8074 | Train Acc: 0.2895
 Site-White_utk                 (1) | Train Loss: 1.6364 | Train Acc: 0.3571
 Site-White_utk                 (4) | Train Loss: 1.7039 | Train Acc: 0.4024
 Site-White_utk                 (4) | Train Loss: 1.6610 | Train Acc: 0.3058
 Site-White_utk                 (4) | Train Loss: 1.7161 | Train Acc: 0.3520
 Site-White_utk                 (4) | Train Loss: 1.6608 | Train Acc: 0.3612
 Site-White_utk                 (4) | Train Loss: 1.6548 | Train Acc: 0.4057
 Site-East_Asian                (2) | Train Loss: 1.4586 | Train Acc: 0.5185
 Site-East_Asian                (2) | Train Loss: 1.5543 | Train Acc: 0.4750
 Site-East_Asian                (2) | Train Loss: 1.7467 | Train Acc: 0.3559
 Site-East_Asian                (2) | Train Loss: 1.6361 | Train Acc: 0.4070
 Site-East_Asian                (2) | Train Loss: 1.6473 | Train Acc: 0.4488
 Site-East_Asian                (2) | Train Loss: 1.6258 | Train Acc: 0.4011
 Site-East_Asian                (2) | Train Loss: 1.5957 | Train Acc: 0.4638
 Site-Indian_utk                (3) | Train Loss: 1.6124 | Train Acc: 0.4419
 Site-Indian_utk                (3) | Train Loss: 1.6201 | Train Acc: 0.4375
 Site-Indian_utk                (3) | Train Loss: 1.6942 | Train Acc: 0.3085
 Site-Indian_utk                (3) | Train Loss: 1.6749 | Train Acc: 0.3813
 Site-Indian_utk                (3) | Train Loss: 1.6525 | Train Acc: 0.3756
 Site-Black_utk                 (4) | Train Loss: 1.6379 | Train Acc: 0.4909
 Site-Black_utk                 (4) | Train Loss: 1.6231 | Train Acc: 0.3951
 Site-Black_utk                 (4) | Train Loss: 1.7646 | Train Acc: 0.3529
 Site-Southeast_Asian           (2) | Train Loss: 1.8059 | Train Acc: 0.4020
 Site-Southeast_Asian           (2) | Train Loss: 1.7400 | Train Acc: 0.4333
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.7646 | Train Acc: 0.3430
 Site-White_ffhq                (0) | Train Loss: 1.7611 | Train Acc: 0.3590
Average Train Accuracy: 0.3904
 Site-White_utk                 (5) | Val  Loss: 1.5850 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 1.5770 | Val  Acc: 0.3636
 Site-White_utk                 (4) | Val  Loss: 1.6661 | Val  Acc: 0.3529
 Site-White_utk                 (4) | Val  Loss: 1.6430 | Val  Acc: 0.4000
 Site-White_utk                 (1) | Val  Loss: 1.6366 | Val  Acc: 0.3243
 Site-White_utk                 (4) | Val  Loss: 1.6681 | Val  Acc: 0.4545
 Site-White_utk                 (4) | Val  Loss: 1.7541 | Val  Acc: 0.3704
 Site-White_utk                 (4) | Val  Loss: 1.6793 | Val  Acc: 0.3613
 Site-White_utk                 (4) | Val  Loss: 1.7378 | Val  Acc: 0.3257
 Site-White_utk                 (4) | Val  Loss: 1.7117 | Val  Acc: 0.3527
 Site-East_Asian                (2) | Val  Loss: 1.6551 | Val  Acc: 0.3889
 Site-East_Asian                (2) | Val  Loss: 1.6491 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.5795 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.6353 | Val  Acc: 0.4386
 Site-East_Asian                (2) | Val  Loss: 1.6559 | Val  Acc: 0.4941
 Site-East_Asian                (2) | Val  Loss: 1.6139 | Val  Acc: 0.4880
 Site-East_Asian                (2) | Val  Loss: 1.6235 | Val  Acc: 0.4620
 Site-Indian_utk                (3) | Val  Loss: 1.6457 | Val  Acc: 0.4138
 Site-Indian_utk                (3) | Val  Loss: 1.5682 | Val  Acc: 0.4651
 Site-Indian_utk                (3) | Val  Loss: 1.6392 | Val  Acc: 0.3651
 Site-Indian_utk                (3) | Val  Loss: 1.7159 | Val  Acc: 0.3478
 Site-Indian_utk                (3) | Val  Loss: 1.5887 | Val  Acc: 0.3971
 Site-Black_utk                 (4) | Val  Loss: 1.6947 | Val  Acc: 0.5278
 Site-Black_utk                 (4) | Val  Loss: 1.7507 | Val  Acc: 0.3889
 Site-Black_utk                 (4) | Val  Loss: 1.6870 | Val  Acc: 0.3671
 Site-Southeast_Asian           (2) | Val  Loss: 1.8116 | Val  Acc: 0.3676
 Site-Southeast_Asian           (2) | Val  Loss: 1.7659 | Val  Acc: 0.3800
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.8984 | Val  Acc: 0.2696
 Site-White_ffhq                (0) | Val  Loss: 1.7501 | Val  Acc: 0.4872
Average Valid Accuracy: 0.3932
 Best site-White_utk                (5)  | Epoch:9 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3636
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3529
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.4000
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.3243
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.4545
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3704
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3613
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3257
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3527
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.3889
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4615
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4615
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4386
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4941
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4880
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4620
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4138
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4651
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.3651
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.3478
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.3971
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.5278
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.3889
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.3671
 Best site-Southeast_Asian          (2)  | Epoch:9 | Val Acc: 0.3676
 Best site-Southeast_Asian          (2)  | Epoch:9 | Val Acc: 0.3800
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:9 | Val Acc: 0.2696
 Best site-White_ffhq               (0)  | Epoch:9 | Val Acc: 0.4872
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Test site-White_utk                 (5)| Epoch:9 | Test Acc: 0.3258
 Test site-East_Asian                (2)| Epoch:9 | Test Acc: 0.4249
 Test site-Indian_utk                (3)| Epoch:9 | Test Acc: 0.4250
 Test site-Black_utk                 (4)| Epoch:9 | Test Acc: 0.3367
 Test site-Southeast_Asian           (2)| Epoch:9 | Test Acc: 0.4003
 Test site-Latino_Hispanic_ffhq      (0)| Epoch:9 | Test Acc: 0.1990
 Test site-White_ffhq                (0)| Epoch:9 | Test Acc: 0.2186
White_utk: 0.3258, East_Asian: 0.4249, Indian_utk: 0.4250, Black_utk: 0.3367, Southeast_Asian: 0.4003, Latino_Hispanic_ffhq: 0.1990, White_ffhq: 0.2186, 
Average Test Accuracy(group): 0.3329, Average Test Accuracy(individual): 0.3650,
domain CV=0.2603, cluster CV=nan, individual CV=0.1705, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
===2023-06-15 05:27:27===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 6
Loading snapshots...
 Test site-White_utk                 (5)| Epoch:8 | Test Acc: 0.2950
 Test site-East_Asian                (2)| Epoch:8 | Test Acc: 0.4697
 Test site-Indian_utk                (3)| Epoch:8 | Test Acc: 0.4917
 Test site-Black_utk                 (4)| Epoch:8 | Test Acc: 0.3776
 Test site-Southeast_Asian           (2)| Epoch:8 | Test Acc: 0.4073
 Test site-Latino_Hispanic_ffhq      (0)| Epoch:8 | Test Acc: 0.2836
 Test site-White_ffhq                (0)| Epoch:8 | Test Acc: 0.2798
White_utk: 0.2950, East_Asian: 0.4697, Indian_utk: 0.4917, Black_utk: 0.3776, Southeast_Asian: 0.4073, Latino_Hispanic_ffhq: 0.2836, White_ffhq: 0.2798, 
Average Test Accuracy(group): 0.3721, Average Test Accuracy(individual): 0.3864,
domain CV=0.2211, cluster CV=nan, individual CV=0.2205, 
