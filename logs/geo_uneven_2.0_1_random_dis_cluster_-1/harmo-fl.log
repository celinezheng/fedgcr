===2023-07-28 18:18:49===
===Setting===
    dataset: geo
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[172,345,691,1382,432,864,
client_nums=[4,2,]
len_dataset=[8646,4323,]
domain number = 2
============ Train epoch 0 ============
 Site-usa                           | Train Loss: 1.0520 | Train Acc: 0.6744
 Site-usa                           | Train Loss: 1.0024 | Train Acc: 0.7130
 Site-usa                           | Train Loss: 0.9598 | Train Acc: 0.7352
 Site-usa                           | Train Loss: 1.0096 | Train Acc: 0.7279
 Site-asia                          | Train Loss: 1.5807 | Train Acc: 0.4722
 Site-asia                          | Train Loss: 1.6631 | Train Acc: 0.4363
Average Train Accuracy: 0.6265
 Site-usa                           | Val  Loss: 0.9391 | Val  Acc: 0.7043
 Site-usa                           | Val  Loss: 1.0065 | Val  Acc: 0.6957
 Site-usa                           | Val  Loss: 1.0227 | Val  Acc: 0.7310
 Site-usa                           | Val  Loss: 0.9808 | Val  Acc: 0.7364
 Site-asia                          | Val  Loss: 1.5808 | Val  Acc: 0.4653
 Site-asia                          | Val  Loss: 1.6921 | Val  Acc: 0.4149
Average Valid Accuracy: 0.6246
 Best site-usa                       | Epoch:0 | Val Acc: 0.7043
 Best site-usa                       | Epoch:0 | Val Acc: 0.6957
 Best site-usa                       | Epoch:0 | Val Acc: 0.7310
 Best site-usa                       | Epoch:0 | Val Acc: 0.7364
 Best site-asia                      | Epoch:0 | Val Acc: 0.4653
 Best site-asia                      | Epoch:0 | Val Acc: 0.4149
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 1 ============
 Site-usa                           | Train Loss: 0.7862 | Train Acc: 0.7500
 Site-usa                           | Train Loss: 0.7923 | Train Acc: 0.7536
 Site-usa                           | Train Loss: 0.7432 | Train Acc: 0.8032
 Site-usa                           | Train Loss: 0.7500 | Train Acc: 0.7902
 Site-asia                          | Train Loss: 1.3927 | Train Acc: 0.5231
 Site-asia                          | Train Loss: 1.4732 | Train Acc: 0.5162
Average Train Accuracy: 0.6894
 Site-usa                           | Val  Loss: 0.7377 | Val  Acc: 0.8174
 Site-usa                           | Val  Loss: 0.7999 | Val  Acc: 0.7609
 Site-usa                           | Val  Loss: 0.7194 | Val  Acc: 0.7918
 Site-usa                           | Val  Loss: 0.7712 | Val  Acc: 0.7842
 Site-asia                          | Val  Loss: 1.4463 | Val  Acc: 0.5139
 Site-asia                          | Val  Loss: 1.4775 | Val  Acc: 0.5052
Average Valid Accuracy: 0.6955
 Best site-usa                       | Epoch:1 | Val Acc: 0.8174
 Best site-usa                       | Epoch:1 | Val Acc: 0.7609
 Best site-usa                       | Epoch:1 | Val Acc: 0.7918
 Best site-usa                       | Epoch:1 | Val Acc: 0.7842
 Best site-asia                      | Epoch:1 | Val Acc: 0.5139
 Best site-asia                      | Epoch:1 | Val Acc: 0.5052
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 2 ============
 Site-usa                           | Train Loss: 0.7048 | Train Acc: 0.7500
 Site-usa                           | Train Loss: 0.7212 | Train Acc: 0.7739
 Site-usa                           | Train Loss: 0.6152 | Train Acc: 0.8292
 Site-usa                           | Train Loss: 0.6813 | Train Acc: 0.7945
 Site-asia                          | Train Loss: 1.2635 | Train Acc: 0.5787
 Site-asia                          | Train Loss: 1.3914 | Train Acc: 0.5347
Average Train Accuracy: 0.7102
 Site-usa                           | Val  Loss: 0.5950 | Val  Acc: 0.7913
 Site-usa                           | Val  Loss: 0.6760 | Val  Acc: 0.8087
 Site-usa                           | Val  Loss: 0.6307 | Val  Acc: 0.8243
 Site-usa                           | Val  Loss: 0.6563 | Val  Acc: 0.8004
 Site-asia                          | Val  Loss: 1.2293 | Val  Acc: 0.5868
 Site-asia                          | Val  Loss: 1.3618 | Val  Acc: 0.5365
Average Valid Accuracy: 0.7247
 Best site-usa                       | Epoch:2 | Val Acc: 0.7913
 Best site-usa                       | Epoch:2 | Val Acc: 0.8087
 Best site-usa                       | Epoch:2 | Val Acc: 0.8243
 Best site-usa                       | Epoch:2 | Val Acc: 0.8004
 Best site-asia                      | Epoch:2 | Val Acc: 0.5868
 Best site-asia                      | Epoch:2 | Val Acc: 0.5365
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 3 ============
 Site-usa                           | Train Loss: 0.6684 | Train Acc: 0.7791
 Site-usa                           | Train Loss: 0.6355 | Train Acc: 0.7826
 Site-usa                           | Train Loss: 0.5811 | Train Acc: 0.8249
 Site-usa                           | Train Loss: 0.6152 | Train Acc: 0.8119
 Site-asia                          | Train Loss: 1.2588 | Train Acc: 0.5694
 Site-asia                          | Train Loss: 1.3334 | Train Acc: 0.5590
Average Train Accuracy: 0.7212
 Site-usa                           | Val  Loss: 0.5195 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.5258 | Val  Acc: 0.8478
 Site-usa                           | Val  Loss: 0.6026 | Val  Acc: 0.8156
 Site-usa                           | Val  Loss: 0.6576 | Val  Acc: 0.7863
 Site-asia                          | Val  Loss: 1.2648 | Val  Acc: 0.5729
 Site-asia                          | Val  Loss: 1.3253 | Val  Acc: 0.5764
Average Valid Accuracy: 0.7433
 Best site-usa                       | Epoch:3 | Val Acc: 0.8609
 Best site-usa                       | Epoch:3 | Val Acc: 0.8478
 Best site-usa                       | Epoch:3 | Val Acc: 0.8156
 Best site-usa                       | Epoch:3 | Val Acc: 0.7863
 Best site-asia                      | Epoch:3 | Val Acc: 0.5729
 Best site-asia                      | Epoch:3 | Val Acc: 0.5764
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 4 ============
 Site-usa                           | Train Loss: 0.5839 | Train Acc: 0.8314
 Site-usa                           | Train Loss: 0.6237 | Train Acc: 0.8029
 Site-usa                           | Train Loss: 0.5371 | Train Acc: 0.8321
 Site-usa                           | Train Loss: 0.5469 | Train Acc: 0.8336
 Site-asia                          | Train Loss: 1.2783 | Train Acc: 0.5741
 Site-asia                          | Train Loss: 1.3189 | Train Acc: 0.5637
Average Train Accuracy: 0.7396
 Site-usa                           | Val  Loss: 0.4067 | Val  Acc: 0.8783
 Site-usa                           | Val  Loss: 0.5475 | Val  Acc: 0.8304
 Site-usa                           | Val  Loss: 0.5165 | Val  Acc: 0.8395
 Site-usa                           | Val  Loss: 0.5723 | Val  Acc: 0.8200
 Site-asia                          | Val  Loss: 1.2186 | Val  Acc: 0.6007
 Site-asia                          | Val  Loss: 1.3216 | Val  Acc: 0.5608
Average Valid Accuracy: 0.7549
 Best site-usa                       | Epoch:4 | Val Acc: 0.8783
 Best site-usa                       | Epoch:4 | Val Acc: 0.8304
 Best site-usa                       | Epoch:4 | Val Acc: 0.8395
 Best site-usa                       | Epoch:4 | Val Acc: 0.8200
 Best site-asia                      | Epoch:4 | Val Acc: 0.6007
 Best site-asia                      | Epoch:4 | Val Acc: 0.5608
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 5 ============
 Site-usa                           | Train Loss: 0.6587 | Train Acc: 0.7674
 Site-usa                           | Train Loss: 0.5852 | Train Acc: 0.8087
 Site-usa                           | Train Loss: 0.5401 | Train Acc: 0.8307
 Site-usa                           | Train Loss: 0.5148 | Train Acc: 0.8394
 Site-asia                          | Train Loss: 1.1519 | Train Acc: 0.6019
 Site-asia                          | Train Loss: 1.2107 | Train Acc: 0.6042
Average Train Accuracy: 0.7420
 Site-usa                           | Val  Loss: 0.5794 | Val  Acc: 0.8261
 Site-usa                           | Val  Loss: 0.4849 | Val  Acc: 0.8478
 Site-usa                           | Val  Loss: 0.4916 | Val  Acc: 0.8438
 Site-usa                           | Val  Loss: 0.5685 | Val  Acc: 0.8308
 Site-asia                          | Val  Loss: 1.2009 | Val  Acc: 0.5938
 Site-asia                          | Val  Loss: 1.2241 | Val  Acc: 0.6181
Average Valid Accuracy: 0.7601
 Best site-usa                       | Epoch:5 | Val Acc: 0.8261
 Best site-usa                       | Epoch:5 | Val Acc: 0.8478
 Best site-usa                       | Epoch:5 | Val Acc: 0.8438
 Best site-usa                       | Epoch:5 | Val Acc: 0.8308
 Best site-asia                      | Epoch:5 | Val Acc: 0.5938
 Best site-asia                      | Epoch:5 | Val Acc: 0.6181
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 6 ============
 Site-usa                           | Train Loss: 0.6839 | Train Acc: 0.7791
 Site-usa                           | Train Loss: 0.6185 | Train Acc: 0.7797
 Site-usa                           | Train Loss: 0.4937 | Train Acc: 0.8509
 Site-usa                           | Train Loss: 0.5456 | Train Acc: 0.8104
 Site-asia                          | Train Loss: 1.2637 | Train Acc: 0.5764
 Site-asia                          | Train Loss: 1.2322 | Train Acc: 0.5868
Average Train Accuracy: 0.7306
 Site-usa                           | Val  Loss: 0.4936 | Val  Acc: 0.8522
 Site-usa                           | Val  Loss: 0.5116 | Val  Acc: 0.8565
 Site-usa                           | Val  Loss: 0.5182 | Val  Acc: 0.8568
 Site-usa                           | Val  Loss: 0.5189 | Val  Acc: 0.8416
 Site-asia                          | Val  Loss: 1.1365 | Val  Acc: 0.6181
 Site-asia                          | Val  Loss: 1.2645 | Val  Acc: 0.5764
Average Valid Accuracy: 0.7669
 Best site-usa                       | Epoch:6 | Val Acc: 0.8522
 Best site-usa                       | Epoch:6 | Val Acc: 0.8565
 Best site-usa                       | Epoch:6 | Val Acc: 0.8568
 Best site-usa                       | Epoch:6 | Val Acc: 0.8416
 Best site-asia                      | Epoch:6 | Val Acc: 0.6181
 Best site-asia                      | Epoch:6 | Val Acc: 0.5764
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 7 ============
 Site-usa                           | Train Loss: 0.6113 | Train Acc: 0.8140
 Site-usa                           | Train Loss: 0.6519 | Train Acc: 0.8116
 Site-usa                           | Train Loss: 0.4745 | Train Acc: 0.8582
 Site-usa                           | Train Loss: 0.4705 | Train Acc: 0.8517
 Site-asia                          | Train Loss: 1.2797 | Train Acc: 0.5718
 Site-asia                          | Train Loss: 1.2673 | Train Acc: 0.5833
Average Train Accuracy: 0.7484
 Site-usa                           | Val  Loss: 0.3952 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.4229 | Val  Acc: 0.8739
 Site-usa                           | Val  Loss: 0.5012 | Val  Acc: 0.8633
 Site-usa                           | Val  Loss: 0.5258 | Val  Acc: 0.8286
 Site-asia                          | Val  Loss: 1.1205 | Val  Acc: 0.6250
 Site-asia                          | Val  Loss: 1.2439 | Val  Acc: 0.5590
Average Valid Accuracy: 0.7685
 Best site-usa                       | Epoch:7 | Val Acc: 0.8609
 Best site-usa                       | Epoch:7 | Val Acc: 0.8739
 Best site-usa                       | Epoch:7 | Val Acc: 0.8633
 Best site-usa                       | Epoch:7 | Val Acc: 0.8286
 Best site-asia                      | Epoch:7 | Val Acc: 0.6250
 Best site-asia                      | Epoch:7 | Val Acc: 0.5590
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 8 ============
 Site-usa                           | Train Loss: 0.5229 | Train Acc: 0.8663
 Site-usa                           | Train Loss: 0.6181 | Train Acc: 0.8203
 Site-usa                           | Train Loss: 0.4753 | Train Acc: 0.8654
 Site-usa                           | Train Loss: 0.4576 | Train Acc: 0.8625
 Site-asia                          | Train Loss: 1.2079 | Train Acc: 0.5718
 Site-asia                          | Train Loss: 1.2382 | Train Acc: 0.5833
Average Train Accuracy: 0.7616
 Site-usa                           | Val  Loss: 0.4080 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.4766 | Val  Acc: 0.8478
 Site-usa                           | Val  Loss: 0.4585 | Val  Acc: 0.8547
 Site-usa                           | Val  Loss: 0.5374 | Val  Acc: 0.8514
 Site-asia                          | Val  Loss: 1.1781 | Val  Acc: 0.6007
 Site-asia                          | Val  Loss: 1.1944 | Val  Acc: 0.5990
Average Valid Accuracy: 0.7734
 Best site-usa                       | Epoch:8 | Val Acc: 0.8870
 Best site-usa                       | Epoch:8 | Val Acc: 0.8478
 Best site-usa                       | Epoch:8 | Val Acc: 0.8547
 Best site-usa                       | Epoch:8 | Val Acc: 0.8514
 Best site-asia                      | Epoch:8 | Val Acc: 0.6007
 Best site-asia                      | Epoch:8 | Val Acc: 0.5990
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 9 ============
 Site-usa                           | Train Loss: 0.5802 | Train Acc: 0.7965
 Site-usa                           | Train Loss: 0.6168 | Train Acc: 0.8203
 Site-usa                           | Train Loss: 0.5033 | Train Acc: 0.8524
 Site-usa                           | Train Loss: 0.4769 | Train Acc: 0.8546
 Site-asia                          | Train Loss: 1.2139 | Train Acc: 0.5995
 Site-asia                          | Train Loss: 1.1703 | Train Acc: 0.6123
Average Train Accuracy: 0.7559
 Site-usa                           | Val  Loss: 0.4193 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.5789 | Val  Acc: 0.8304
 Site-usa                           | Val  Loss: 0.5475 | Val  Acc: 0.8416
 Site-usa                           | Val  Loss: 0.5026 | Val  Acc: 0.8514
 Site-asia                          | Val  Loss: 1.1741 | Val  Acc: 0.6076
 Site-asia                          | Val  Loss: 1.1677 | Val  Acc: 0.6198
Average Valid Accuracy: 0.7730
 Test site-usa                       | Epoch:8 | Test Acc: 0.9145
 Test site-asia                      | Epoch:8 | Test Acc: 0.8392
usa: 0.9145, asia: 0.8392, 
Average Test Accuracy(group): 0.8768, Average Test Accuracy(individual): 0.8894,
domain std=0.0376, cluster std=-1.0000, individual std=0.0355, 
============ Train epoch 10 ============
 Site-usa                           | Train Loss: 0.5882 | Train Acc: 0.7965
 Site-usa                           | Train Loss: 0.5838 | Train Acc: 0.8203
 Site-usa                           | Train Loss: 0.4949 | Train Acc: 0.8423
 Site-usa                           | Train Loss: 0.4385 | Train Acc: 0.8632
 Site-asia                          | Train Loss: 1.2031 | Train Acc: 0.5856
 Site-asia                          | Train Loss: 1.2225 | Train Acc: 0.5868
Average Train Accuracy: 0.7491
 Site-usa                           | Val  Loss: 0.4214 | Val  Acc: 0.8783
 Site-usa                           | Val  Loss: 0.4383 | Val  Acc: 0.8739
 Site-usa                           | Val  Loss: 0.4093 | Val  Acc: 0.8742
 Site-usa                           | Val  Loss: 0.5022 | Val  Acc: 0.8503
 Site-asia                          | Val  Loss: 1.2030 | Val  Acc: 0.6007
 Site-asia                          | Val  Loss: 1.2737 | Val  Acc: 0.5712
Average Valid Accuracy: 0.7748
 Best site-usa                       | Epoch:10 | Val Acc: 0.8783
 Best site-usa                       | Epoch:10 | Val Acc: 0.8739
 Best site-usa                       | Epoch:10 | Val Acc: 0.8742
 Best site-usa                       | Epoch:10 | Val Acc: 0.8503
 Best site-asia                      | Epoch:10 | Val Acc: 0.6007
 Best site-asia                      | Epoch:10 | Val Acc: 0.5712
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 11 ============
 Site-usa                           | Train Loss: 0.5507 | Train Acc: 0.8256
 Site-usa                           | Train Loss: 0.5190 | Train Acc: 0.8493
 Site-usa                           | Train Loss: 0.4945 | Train Acc: 0.8582
 Site-usa                           | Train Loss: 0.4246 | Train Acc: 0.8654
 Site-asia                          | Train Loss: 1.1800 | Train Acc: 0.5972
 Site-asia                          | Train Loss: 1.2192 | Train Acc: 0.6088
Average Train Accuracy: 0.7674
 Site-usa                           | Val  Loss: 0.3030 | Val  Acc: 0.9130
 Site-usa                           | Val  Loss: 0.5091 | Val  Acc: 0.8304
 Site-usa                           | Val  Loss: 0.3785 | Val  Acc: 0.9002
 Site-usa                           | Val  Loss: 0.4476 | Val  Acc: 0.8514
 Site-asia                          | Val  Loss: 1.1509 | Val  Acc: 0.6076
 Site-asia                          | Val  Loss: 1.2363 | Val  Acc: 0.6024
Average Valid Accuracy: 0.7842
 Best site-usa                       | Epoch:11 | Val Acc: 0.9130
 Best site-usa                       | Epoch:11 | Val Acc: 0.8304
 Best site-usa                       | Epoch:11 | Val Acc: 0.9002
 Best site-usa                       | Epoch:11 | Val Acc: 0.8514
 Best site-asia                      | Epoch:11 | Val Acc: 0.6076
 Best site-asia                      | Epoch:11 | Val Acc: 0.6024
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 12 ============
 Site-usa                           | Train Loss: 0.5895 | Train Acc: 0.8023
 Site-usa                           | Train Loss: 0.5047 | Train Acc: 0.8261
 Site-usa                           | Train Loss: 0.4732 | Train Acc: 0.8437
 Site-usa                           | Train Loss: 0.4581 | Train Acc: 0.8640
 Site-asia                          | Train Loss: 1.1448 | Train Acc: 0.6273
 Site-asia                          | Train Loss: 1.1294 | Train Acc: 0.6215
Average Train Accuracy: 0.7642
 Site-usa                           | Val  Loss: 0.4372 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.3922 | Val  Acc: 0.8913
 Site-usa                           | Val  Loss: 0.4676 | Val  Acc: 0.8677
 Site-usa                           | Val  Loss: 0.5146 | Val  Acc: 0.8492
 Site-asia                          | Val  Loss: 1.0320 | Val  Acc: 0.6215
 Site-asia                          | Val  Loss: 1.1531 | Val  Acc: 0.6128
Average Valid Accuracy: 0.7912
 Best site-usa                       | Epoch:12 | Val Acc: 0.9043
 Best site-usa                       | Epoch:12 | Val Acc: 0.8913
 Best site-usa                       | Epoch:12 | Val Acc: 0.8677
 Best site-usa                       | Epoch:12 | Val Acc: 0.8492
 Best site-asia                      | Epoch:12 | Val Acc: 0.6215
 Best site-asia                      | Epoch:12 | Val Acc: 0.6128
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 13 ============
 Site-usa                           | Train Loss: 0.5309 | Train Acc: 0.8430
 Site-usa                           | Train Loss: 0.5358 | Train Acc: 0.8145
 Site-usa                           | Train Loss: 0.4968 | Train Acc: 0.8538
 Site-usa                           | Train Loss: 0.4206 | Train Acc: 0.8632
 Site-asia                          | Train Loss: 1.1825 | Train Acc: 0.6065
 Site-asia                          | Train Loss: 1.1266 | Train Acc: 0.6308
Average Train Accuracy: 0.7686
 Site-usa                           | Val  Loss: 0.3219 | Val  Acc: 0.9130
 Site-usa                           | Val  Loss: 0.4499 | Val  Acc: 0.8652
 Site-usa                           | Val  Loss: 0.3982 | Val  Acc: 0.8829
 Site-usa                           | Val  Loss: 0.4492 | Val  Acc: 0.8688
 Site-asia                          | Val  Loss: 1.1391 | Val  Acc: 0.5833
 Site-asia                          | Val  Loss: 1.2065 | Val  Acc: 0.6042
Average Valid Accuracy: 0.7862
============ Train epoch 14 ============
 Site-usa                           | Train Loss: 0.4993 | Train Acc: 0.8372
 Site-usa                           | Train Loss: 0.5040 | Train Acc: 0.8261
 Site-usa                           | Train Loss: 0.4618 | Train Acc: 0.8726
 Site-usa                           | Train Loss: 0.4181 | Train Acc: 0.8741
 Site-asia                          | Train Loss: 1.2457 | Train Acc: 0.5833
 Site-asia                          | Train Loss: 1.2069 | Train Acc: 0.6204
Average Train Accuracy: 0.7690
 Site-usa                           | Val  Loss: 0.2596 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.3966 | Val  Acc: 0.8826
 Site-usa                           | Val  Loss: 0.4010 | Val  Acc: 0.8829
 Site-usa                           | Val  Loss: 0.4369 | Val  Acc: 0.8709
 Site-asia                          | Val  Loss: 1.1657 | Val  Acc: 0.6007
 Site-asia                          | Val  Loss: 1.2017 | Val  Acc: 0.6094
Average Valid Accuracy: 0.7918
 Best site-usa                       | Epoch:14 | Val Acc: 0.9043
 Best site-usa                       | Epoch:14 | Val Acc: 0.8826
 Best site-usa                       | Epoch:14 | Val Acc: 0.8829
 Best site-usa                       | Epoch:14 | Val Acc: 0.8709
 Best site-asia                      | Epoch:14 | Val Acc: 0.6007
 Best site-asia                      | Epoch:14 | Val Acc: 0.6094
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 15 ============
 Site-usa                           | Train Loss: 0.4833 | Train Acc: 0.8314
 Site-usa                           | Train Loss: 0.4582 | Train Acc: 0.8290
 Site-usa                           | Train Loss: 0.4699 | Train Acc: 0.8582
 Site-usa                           | Train Loss: 0.4252 | Train Acc: 0.8625
 Site-asia                          | Train Loss: 1.2396 | Train Acc: 0.5833
 Site-asia                          | Train Loss: 1.1598 | Train Acc: 0.6076
Average Train Accuracy: 0.7620
 Site-usa                           | Val  Loss: 0.3973 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.3738 | Val  Acc: 0.8739
 Site-usa                           | Val  Loss: 0.4432 | Val  Acc: 0.8764
 Site-usa                           | Val  Loss: 0.4302 | Val  Acc: 0.8633
 Site-asia                          | Val  Loss: 1.0657 | Val  Acc: 0.6389
 Site-asia                          | Val  Loss: 1.1376 | Val  Acc: 0.6267
Average Valid Accuracy: 0.7915
============ Train epoch 16 ============
 Site-usa                           | Train Loss: 0.5637 | Train Acc: 0.8081
 Site-usa                           | Train Loss: 0.4169 | Train Acc: 0.8551
 Site-usa                           | Train Loss: 0.4471 | Train Acc: 0.8640
 Site-usa                           | Train Loss: 0.3926 | Train Acc: 0.8792
 Site-asia                          | Train Loss: 1.1955 | Train Acc: 0.5903
 Site-asia                          | Train Loss: 1.0954 | Train Acc: 0.6308
Average Train Accuracy: 0.7712
 Site-usa                           | Val  Loss: 0.3258 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.3481 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.3493 | Val  Acc: 0.9046
 Site-usa                           | Val  Loss: 0.4193 | Val  Acc: 0.8655
 Site-asia                          | Val  Loss: 1.0943 | Val  Acc: 0.6285
 Site-asia                          | Val  Loss: 1.1258 | Val  Acc: 0.6302
Average Valid Accuracy: 0.7990
 Best site-usa                       | Epoch:16 | Val Acc: 0.8696
 Best site-usa                       | Epoch:16 | Val Acc: 0.8957
 Best site-usa                       | Epoch:16 | Val Acc: 0.9046
 Best site-usa                       | Epoch:16 | Val Acc: 0.8655
 Best site-asia                      | Epoch:16 | Val Acc: 0.6285
 Best site-asia                      | Epoch:16 | Val Acc: 0.6302
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 17 ============
 Site-usa                           | Train Loss: 0.6003 | Train Acc: 0.8023
 Site-usa                           | Train Loss: 0.4802 | Train Acc: 0.8522
 Site-usa                           | Train Loss: 0.4642 | Train Acc: 0.8683
 Site-usa                           | Train Loss: 0.3968 | Train Acc: 0.8792
 Site-asia                          | Train Loss: 1.1773 | Train Acc: 0.5833
 Site-asia                          | Train Loss: 1.1198 | Train Acc: 0.6273
Average Train Accuracy: 0.7688
 Site-usa                           | Val  Loss: 0.3090 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.3543 | Val  Acc: 0.9000
 Site-usa                           | Val  Loss: 0.4549 | Val  Acc: 0.8677
 Site-usa                           | Val  Loss: 0.4547 | Val  Acc: 0.8579
 Site-asia                          | Val  Loss: 1.1661 | Val  Acc: 0.6181
 Site-asia                          | Val  Loss: 1.1407 | Val  Acc: 0.6233
Average Valid Accuracy: 0.7952
============ Train epoch 18 ============
 Site-usa                           | Train Loss: 0.5733 | Train Acc: 0.8198
 Site-usa                           | Train Loss: 0.5147 | Train Acc: 0.8261
 Site-usa                           | Train Loss: 0.4341 | Train Acc: 0.8755
 Site-usa                           | Train Loss: 0.3863 | Train Acc: 0.8893
 Site-asia                          | Train Loss: 1.1539 | Train Acc: 0.6227
 Site-asia                          | Train Loss: 1.1623 | Train Acc: 0.6238
Average Train Accuracy: 0.7762
 Site-usa                           | Val  Loss: 0.2575 | Val  Acc: 0.9217
 Site-usa                           | Val  Loss: 0.4176 | Val  Acc: 0.8783
 Site-usa                           | Val  Loss: 0.3852 | Val  Acc: 0.8894
 Site-usa                           | Val  Loss: 0.4260 | Val  Acc: 0.8796
 Site-asia                          | Val  Loss: 1.1732 | Val  Acc: 0.6111
 Site-asia                          | Val  Loss: 1.1475 | Val  Acc: 0.6198
Average Valid Accuracy: 0.8000
 Best site-usa                       | Epoch:18 | Val Acc: 0.9217
 Best site-usa                       | Epoch:18 | Val Acc: 0.8783
 Best site-usa                       | Epoch:18 | Val Acc: 0.8894
 Best site-usa                       | Epoch:18 | Val Acc: 0.8796
 Best site-asia                      | Epoch:18 | Val Acc: 0.6111
 Best site-asia                      | Epoch:18 | Val Acc: 0.6198
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 19 ============
 Site-usa                           | Train Loss: 0.5395 | Train Acc: 0.8256
 Site-usa                           | Train Loss: 0.5236 | Train Acc: 0.8087
 Site-usa                           | Train Loss: 0.4090 | Train Acc: 0.8842
 Site-usa                           | Train Loss: 0.3945 | Train Acc: 0.8755
 Site-asia                          | Train Loss: 1.1350 | Train Acc: 0.6296
 Site-asia                          | Train Loss: 1.1180 | Train Acc: 0.6319
Average Train Accuracy: 0.7759
 Site-usa                           | Val  Loss: 0.3876 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.3855 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.3631 | Val  Acc: 0.8829
 Site-usa                           | Val  Loss: 0.4218 | Val  Acc: 0.8623
 Site-asia                          | Val  Loss: 1.1431 | Val  Acc: 0.6250
 Site-asia                          | Val  Loss: 1.1490 | Val  Acc: 0.6146
Average Valid Accuracy: 0.7931
 Test site-usa                       | Epoch:18 | Test Acc: 0.9090
 Test site-asia                      | Epoch:18 | Test Acc: 0.8399
usa: 0.9090, asia: 0.8399, 
Average Test Accuracy(group): 0.8744, Average Test Accuracy(individual): 0.8859,
domain std=0.0346, cluster std=-1.0000, individual std=0.0326, 
============ Train epoch 20 ============
 Site-usa                           | Train Loss: 0.5704 | Train Acc: 0.8140
 Site-usa                           | Train Loss: 0.4643 | Train Acc: 0.8435
 Site-usa                           | Train Loss: 0.4435 | Train Acc: 0.8596
 Site-usa                           | Train Loss: 0.3867 | Train Acc: 0.8748
 Site-asia                          | Train Loss: 1.1979 | Train Acc: 0.5995
 Site-asia                          | Train Loss: 1.1237 | Train Acc: 0.6273
Average Train Accuracy: 0.7698
 Site-usa                           | Val  Loss: 0.3885 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.4205 | Val  Acc: 0.8739
 Site-usa                           | Val  Loss: 0.3251 | Val  Acc: 0.8980
 Site-usa                           | Val  Loss: 0.4003 | Val  Acc: 0.8731
 Site-asia                          | Val  Loss: 1.1105 | Val  Acc: 0.6146
 Site-asia                          | Val  Loss: 1.1493 | Val  Acc: 0.6215
Average Valid Accuracy: 0.7903
============ Train epoch 21 ============
 Site-usa                           | Train Loss: 0.5002 | Train Acc: 0.8430
 Site-usa                           | Train Loss: 0.5144 | Train Acc: 0.8377
 Site-usa                           | Train Loss: 0.4215 | Train Acc: 0.8611
 Site-usa                           | Train Loss: 0.3625 | Train Acc: 0.8763
 Site-asia                          | Train Loss: 1.2231 | Train Acc: 0.5903
 Site-asia                          | Train Loss: 1.1583 | Train Acc: 0.6424
Average Train Accuracy: 0.7751
 Site-usa                           | Val  Loss: 0.3527 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.4033 | Val  Acc: 0.8783
 Site-usa                           | Val  Loss: 0.3999 | Val  Acc: 0.8698
 Site-usa                           | Val  Loss: 0.3971 | Val  Acc: 0.8731
 Site-asia                          | Val  Loss: 1.1540 | Val  Acc: 0.6076
 Site-asia                          | Val  Loss: 1.1780 | Val  Acc: 0.5903
Average Valid Accuracy: 0.7843
============ Train epoch 22 ============
 Site-usa                           | Train Loss: 0.4574 | Train Acc: 0.8372
 Site-usa                           | Train Loss: 0.4384 | Train Acc: 0.8522
 Site-usa                           | Train Loss: 0.4142 | Train Acc: 0.8582
 Site-usa                           | Train Loss: 0.3639 | Train Acc: 0.8907
 Site-asia                          | Train Loss: 1.2045 | Train Acc: 0.5995
 Site-asia                          | Train Loss: 1.1758 | Train Acc: 0.6181
Average Train Accuracy: 0.7760
 Site-usa                           | Val  Loss: 0.3630 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.4252 | Val  Acc: 0.8826
 Site-usa                           | Val  Loss: 0.3304 | Val  Acc: 0.9067
 Site-usa                           | Val  Loss: 0.4293 | Val  Acc: 0.8709
 Site-asia                          | Val  Loss: 0.9959 | Val  Acc: 0.6493
 Site-asia                          | Val  Loss: 1.1146 | Val  Acc: 0.6354
Average Valid Accuracy: 0.8010
 Best site-usa                       | Epoch:22 | Val Acc: 0.8609
 Best site-usa                       | Epoch:22 | Val Acc: 0.8826
 Best site-usa                       | Epoch:22 | Val Acc: 0.9067
 Best site-usa                       | Epoch:22 | Val Acc: 0.8709
 Best site-asia                      | Epoch:22 | Val Acc: 0.6493
 Best site-asia                      | Epoch:22 | Val Acc: 0.6354
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 23 ============
 Site-usa                           | Train Loss: 0.5485 | Train Acc: 0.8314
 Site-usa                           | Train Loss: 0.4485 | Train Acc: 0.8551
 Site-usa                           | Train Loss: 0.4347 | Train Acc: 0.8596
 Site-usa                           | Train Loss: 0.3631 | Train Acc: 0.8763
 Site-asia                          | Train Loss: 1.1770 | Train Acc: 0.6157
 Site-asia                          | Train Loss: 1.1039 | Train Acc: 0.6319
Average Train Accuracy: 0.7783
 Site-usa                           | Val  Loss: 0.2946 | Val  Acc: 0.9130
 Site-usa                           | Val  Loss: 0.3518 | Val  Acc: 0.8652
 Site-usa                           | Val  Loss: 0.4242 | Val  Acc: 0.8720
 Site-usa                           | Val  Loss: 0.4299 | Val  Acc: 0.8612
 Site-asia                          | Val  Loss: 1.1257 | Val  Acc: 0.6181
 Site-asia                          | Val  Loss: 1.1718 | Val  Acc: 0.6076
Average Valid Accuracy: 0.7895
============ Train epoch 24 ============
 Site-usa                           | Train Loss: 0.4999 | Train Acc: 0.8430
 Site-usa                           | Train Loss: 0.5150 | Train Acc: 0.8174
 Site-usa                           | Train Loss: 0.4418 | Train Acc: 0.8784
 Site-usa                           | Train Loss: 0.3704 | Train Acc: 0.8886
 Site-asia                          | Train Loss: 1.2260 | Train Acc: 0.6019
 Site-asia                          | Train Loss: 1.1288 | Train Acc: 0.6262
Average Train Accuracy: 0.7759
 Site-usa                           | Val  Loss: 0.4326 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.4003 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.3710 | Val  Acc: 0.8894
 Site-usa                           | Val  Loss: 0.3840 | Val  Acc: 0.8915
 Site-asia                          | Val  Loss: 1.0702 | Val  Acc: 0.6354
 Site-asia                          | Val  Loss: 1.1309 | Val  Acc: 0.6302
Average Valid Accuracy: 0.8020
 Best site-usa                       | Epoch:24 | Val Acc: 0.9043
 Best site-usa                       | Epoch:24 | Val Acc: 0.8609
 Best site-usa                       | Epoch:24 | Val Acc: 0.8894
 Best site-usa                       | Epoch:24 | Val Acc: 0.8915
 Best site-asia                      | Epoch:24 | Val Acc: 0.6354
 Best site-asia                      | Epoch:24 | Val Acc: 0.6302
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 25 ============
 Site-usa                           | Train Loss: 0.5673 | Train Acc: 0.7849
 Site-usa                           | Train Loss: 0.4659 | Train Acc: 0.8290
 Site-usa                           | Train Loss: 0.4137 | Train Acc: 0.8726
 Site-usa                           | Train Loss: 0.3714 | Train Acc: 0.8864
 Site-asia                          | Train Loss: 1.1457 | Train Acc: 0.6181
 Site-asia                          | Train Loss: 1.1012 | Train Acc: 0.6470
Average Train Accuracy: 0.7730
 Site-usa                           | Val  Loss: 0.3310 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.3517 | Val  Acc: 0.8913
 Site-usa                           | Val  Loss: 0.3446 | Val  Acc: 0.9002
 Site-usa                           | Val  Loss: 0.3875 | Val  Acc: 0.8894
 Site-asia                          | Val  Loss: 1.0775 | Val  Acc: 0.6146
 Site-asia                          | Val  Loss: 1.0947 | Val  Acc: 0.6354
Average Valid Accuracy: 0.8059
 Best site-usa                       | Epoch:25 | Val Acc: 0.9043
 Best site-usa                       | Epoch:25 | Val Acc: 0.8913
 Best site-usa                       | Epoch:25 | Val Acc: 0.9002
 Best site-usa                       | Epoch:25 | Val Acc: 0.8894
 Best site-asia                      | Epoch:25 | Val Acc: 0.6146
 Best site-asia                      | Epoch:25 | Val Acc: 0.6354
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 26 ============
 Site-usa                           | Train Loss: 0.5332 | Train Acc: 0.8372
 Site-usa                           | Train Loss: 0.4195 | Train Acc: 0.8551
 Site-usa                           | Train Loss: 0.4210 | Train Acc: 0.8770
 Site-usa                           | Train Loss: 0.3447 | Train Acc: 0.8951
 Site-asia                          | Train Loss: 1.1178 | Train Acc: 0.6389
 Site-asia                          | Train Loss: 1.0781 | Train Acc: 0.6597
Average Train Accuracy: 0.7938
 Site-usa                           | Val  Loss: 0.3348 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.3835 | Val  Acc: 0.8652
 Site-usa                           | Val  Loss: 0.3680 | Val  Acc: 0.9002
 Site-usa                           | Val  Loss: 0.3842 | Val  Acc: 0.8698
 Site-asia                          | Val  Loss: 1.1137 | Val  Acc: 0.6389
 Site-asia                          | Val  Loss: 1.0799 | Val  Acc: 0.6319
Average Valid Accuracy: 0.8017
============ Train epoch 27 ============
 Site-usa                           | Train Loss: 0.5243 | Train Acc: 0.8198
 Site-usa                           | Train Loss: 0.4070 | Train Acc: 0.8522
 Site-usa                           | Train Loss: 0.4509 | Train Acc: 0.8582
 Site-usa                           | Train Loss: 0.3635 | Train Acc: 0.8864
 Site-asia                          | Train Loss: 1.1115 | Train Acc: 0.6458
 Site-asia                          | Train Loss: 1.0981 | Train Acc: 0.6273
Average Train Accuracy: 0.7816
 Site-usa                           | Val  Loss: 0.2967 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.3250 | Val  Acc: 0.8826
 Site-usa                           | Val  Loss: 0.3269 | Val  Acc: 0.9089
 Site-usa                           | Val  Loss: 0.4388 | Val  Acc: 0.8644
 Site-asia                          | Val  Loss: 1.0145 | Val  Acc: 0.6528
 Site-asia                          | Val  Loss: 1.0018 | Val  Acc: 0.6597
Average Valid Accuracy: 0.8092
 Best site-usa                       | Epoch:27 | Val Acc: 0.8870
 Best site-usa                       | Epoch:27 | Val Acc: 0.8826
 Best site-usa                       | Epoch:27 | Val Acc: 0.9089
 Best site-usa                       | Epoch:27 | Val Acc: 0.8644
 Best site-asia                      | Epoch:27 | Val Acc: 0.6528
 Best site-asia                      | Epoch:27 | Val Acc: 0.6597
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 28 ============
 Site-usa                           | Train Loss: 0.4619 | Train Acc: 0.8372
 Site-usa                           | Train Loss: 0.4589 | Train Acc: 0.8580
 Site-usa                           | Train Loss: 0.3924 | Train Acc: 0.8741
 Site-usa                           | Train Loss: 0.3600 | Train Acc: 0.8936
 Site-asia                          | Train Loss: 1.1184 | Train Acc: 0.6273
 Site-asia                          | Train Loss: 1.0874 | Train Acc: 0.6516
Average Train Accuracy: 0.7903
 Site-usa                           | Val  Loss: 0.2995 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.3403 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.3421 | Val  Acc: 0.8915
 Site-usa                           | Val  Loss: 0.4032 | Val  Acc: 0.8764
 Site-asia                          | Val  Loss: 1.0012 | Val  Acc: 0.6389
 Site-asia                          | Val  Loss: 1.0694 | Val  Acc: 0.6406
Average Valid Accuracy: 0.8007
============ Train epoch 29 ============
 Site-usa                           | Train Loss: 0.4566 | Train Acc: 0.8430
 Site-usa                           | Train Loss: 0.5374 | Train Acc: 0.8290
 Site-usa                           | Train Loss: 0.4459 | Train Acc: 0.8524
 Site-usa                           | Train Loss: 0.3573 | Train Acc: 0.8922
 Site-asia                          | Train Loss: 1.2067 | Train Acc: 0.5903
 Site-asia                          | Train Loss: 1.0658 | Train Acc: 0.6597
Average Train Accuracy: 0.7778
 Site-usa                           | Val  Loss: 0.2559 | Val  Acc: 0.9130
 Site-usa                           | Val  Loss: 0.4305 | Val  Acc: 0.8391
 Site-usa                           | Val  Loss: 0.3365 | Val  Acc: 0.8959
 Site-usa                           | Val  Loss: 0.3911 | Val  Acc: 0.8731
 Site-asia                          | Val  Loss: 1.0301 | Val  Acc: 0.6597
 Site-asia                          | Val  Loss: 1.1128 | Val  Acc: 0.6337
Average Valid Accuracy: 0.8024
 Test site-usa                       | Epoch:27 | Test Acc: 0.9068
 Test site-asia                      | Epoch:27 | Test Acc: 0.8371
usa: 0.9068, asia: 0.8371, 
Average Test Accuracy(group): 0.8720, Average Test Accuracy(individual): 0.8836,
domain std=0.0348, cluster std=-1.0000, individual std=0.0328, 
============ Train epoch 30 ============
 Site-usa                           | Train Loss: 0.5992 | Train Acc: 0.7907
 Site-usa                           | Train Loss: 0.5487 | Train Acc: 0.8348
 Site-usa                           | Train Loss: 0.4043 | Train Acc: 0.8654
 Site-usa                           | Train Loss: 0.3631 | Train Acc: 0.8777
 Site-asia                          | Train Loss: 1.1700 | Train Acc: 0.6111
 Site-asia                          | Train Loss: 1.0578 | Train Acc: 0.6551
Average Train Accuracy: 0.7725
 Site-usa                           | Val  Loss: 0.3121 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.3645 | Val  Acc: 0.8826
 Site-usa                           | Val  Loss: 0.3395 | Val  Acc: 0.8872
 Site-usa                           | Val  Loss: 0.4112 | Val  Acc: 0.8601
 Site-asia                          | Val  Loss: 0.9602 | Val  Acc: 0.6667
 Site-asia                          | Val  Loss: 1.0602 | Val  Acc: 0.6476
Average Valid Accuracy: 0.8081
============ Train epoch 31 ============
 Site-usa                           | Train Loss: 0.4319 | Train Acc: 0.8488
 Site-usa                           | Train Loss: 0.4945 | Train Acc: 0.8551
 Site-usa                           | Train Loss: 0.3735 | Train Acc: 0.8755
 Site-usa                           | Train Loss: 0.3506 | Train Acc: 0.8893
 Site-asia                          | Train Loss: 1.1770 | Train Acc: 0.6157
 Site-asia                          | Train Loss: 1.0641 | Train Acc: 0.6505
Average Train Accuracy: 0.7892
 Site-usa                           | Val  Loss: 0.2988 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.4066 | Val  Acc: 0.8826
 Site-usa                           | Val  Loss: 0.3457 | Val  Acc: 0.9024
 Site-usa                           | Val  Loss: 0.3851 | Val  Acc: 0.8818
 Site-asia                          | Val  Loss: 1.0007 | Val  Acc: 0.6319
 Site-asia                          | Val  Loss: 1.0925 | Val  Acc: 0.6181
Average Valid Accuracy: 0.8035
============ Train epoch 32 ============
 Site-usa                           | Train Loss: 0.5154 | Train Acc: 0.8372
 Site-usa                           | Train Loss: 0.4880 | Train Acc: 0.8435
 Site-usa                           | Train Loss: 0.4056 | Train Acc: 0.8741
 Site-usa                           | Train Loss: 0.3325 | Train Acc: 0.8936
 Site-asia                          | Train Loss: 1.1452 | Train Acc: 0.6111
 Site-asia                          | Train Loss: 1.0113 | Train Acc: 0.6597
Average Train Accuracy: 0.7865
 Site-usa                           | Val  Loss: 0.3170 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.3328 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.3569 | Val  Acc: 0.8807
 Site-usa                           | Val  Loss: 0.3710 | Val  Acc: 0.8774
 Site-asia                          | Val  Loss: 1.0022 | Val  Acc: 0.6354
 Site-asia                          | Val  Loss: 1.0814 | Val  Acc: 0.6528
Average Valid Accuracy: 0.8077
============ Train epoch 33 ============
 Site-usa                           | Train Loss: 0.5304 | Train Acc: 0.8140
 Site-usa                           | Train Loss: 0.4127 | Train Acc: 0.8493
 Site-usa                           | Train Loss: 0.4340 | Train Acc: 0.8553
 Site-usa                           | Train Loss: 0.3637 | Train Acc: 0.8857
 Site-asia                          | Train Loss: 1.1401 | Train Acc: 0.6273
 Site-asia                          | Train Loss: 1.0286 | Train Acc: 0.6759
Average Train Accuracy: 0.7846
 Site-usa                           | Val  Loss: 0.3436 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.3674 | Val  Acc: 0.8783
 Site-usa                           | Val  Loss: 0.3376 | Val  Acc: 0.9111
 Site-usa                           | Val  Loss: 0.4097 | Val  Acc: 0.8655
 Site-asia                          | Val  Loss: 0.9905 | Val  Acc: 0.6354
 Site-asia                          | Val  Loss: 1.1037 | Val  Acc: 0.6441
Average Valid Accuracy: 0.8050
============ Train epoch 34 ============
 Site-usa                           | Train Loss: 0.6426 | Train Acc: 0.8023
 Site-usa                           | Train Loss: 0.4600 | Train Acc: 0.8493
 Site-usa                           | Train Loss: 0.4257 | Train Acc: 0.8582
 Site-usa                           | Train Loss: 0.3492 | Train Acc: 0.8842
 Site-asia                          | Train Loss: 1.1862 | Train Acc: 0.5949
 Site-asia                          | Train Loss: 1.0257 | Train Acc: 0.6562
Average Train Accuracy: 0.7742
 Site-usa                           | Val  Loss: 0.3001 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.3296 | Val  Acc: 0.9000
 Site-usa                           | Val  Loss: 0.3562 | Val  Acc: 0.8959
 Site-usa                           | Val  Loss: 0.3552 | Val  Acc: 0.8970
 Site-asia                          | Val  Loss: 1.0213 | Val  Acc: 0.6424
 Site-asia                          | Val  Loss: 1.0547 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8090
============ Train epoch 35 ============
 Site-usa                           | Train Loss: 0.5375 | Train Acc: 0.8256
 Site-usa                           | Train Loss: 0.5288 | Train Acc: 0.8493
 Site-usa                           | Train Loss: 0.4073 | Train Acc: 0.8770
 Site-usa                           | Train Loss: 0.3621 | Train Acc: 0.8886
 Site-asia                          | Train Loss: 1.0586 | Train Acc: 0.6458
 Site-asia                          | Train Loss: 1.0095 | Train Acc: 0.6655
Average Train Accuracy: 0.7920
 Site-usa                           | Val  Loss: 0.2739 | Val  Acc: 0.9217
 Site-usa                           | Val  Loss: 0.3134 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.3326 | Val  Acc: 0.9024
 Site-usa                           | Val  Loss: 0.4095 | Val  Acc: 0.8633
 Site-asia                          | Val  Loss: 0.9760 | Val  Acc: 0.6528
 Site-asia                          | Val  Loss: 1.0580 | Val  Acc: 0.6198
Average Valid Accuracy: 0.8093
 Best site-usa                       | Epoch:35 | Val Acc: 0.9217
 Best site-usa                       | Epoch:35 | Val Acc: 0.8957
 Best site-usa                       | Epoch:35 | Val Acc: 0.9024
 Best site-usa                       | Epoch:35 | Val Acc: 0.8633
 Best site-asia                      | Epoch:35 | Val Acc: 0.6528
 Best site-asia                      | Epoch:35 | Val Acc: 0.6198
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 36 ============
 Site-usa                           | Train Loss: 0.5218 | Train Acc: 0.8081
 Site-usa                           | Train Loss: 0.4171 | Train Acc: 0.8493
 Site-usa                           | Train Loss: 0.3902 | Train Acc: 0.8698
 Site-usa                           | Train Loss: 0.3464 | Train Acc: 0.8893
 Site-asia                          | Train Loss: 1.1226 | Train Acc: 0.6111
 Site-asia                          | Train Loss: 1.0616 | Train Acc: 0.6690
Average Train Accuracy: 0.7828
 Site-usa                           | Val  Loss: 0.2765 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.3559 | Val  Acc: 0.8783
 Site-usa                           | Val  Loss: 0.2981 | Val  Acc: 0.9067
 Site-usa                           | Val  Loss: 0.3757 | Val  Acc: 0.8688
 Site-asia                          | Val  Loss: 0.9727 | Val  Acc: 0.6771
 Site-asia                          | Val  Loss: 1.0058 | Val  Acc: 0.6476
Average Valid Accuracy: 0.8123
 Best site-usa                       | Epoch:36 | Val Acc: 0.8957
 Best site-usa                       | Epoch:36 | Val Acc: 0.8783
 Best site-usa                       | Epoch:36 | Val Acc: 0.9067
 Best site-usa                       | Epoch:36 | Val Acc: 0.8688
 Best site-asia                      | Epoch:36 | Val Acc: 0.6771
 Best site-asia                      | Epoch:36 | Val Acc: 0.6476
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 37 ============
 Site-usa                           | Train Loss: 0.4698 | Train Acc: 0.8140
 Site-usa                           | Train Loss: 0.4494 | Train Acc: 0.8319
 Site-usa                           | Train Loss: 0.3747 | Train Acc: 0.8871
 Site-usa                           | Train Loss: 0.3184 | Train Acc: 0.9067
 Site-asia                          | Train Loss: 1.1976 | Train Acc: 0.6111
 Site-asia                          | Train Loss: 1.0809 | Train Acc: 0.6505
Average Train Accuracy: 0.7835
 Site-usa                           | Val  Loss: 0.2978 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.3296 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.2860 | Val  Acc: 0.9197
 Site-usa                           | Val  Loss: 0.3530 | Val  Acc: 0.8861
 Site-asia                          | Val  Loss: 1.0601 | Val  Acc: 0.6458
 Site-asia                          | Val  Loss: 1.0637 | Val  Acc: 0.6458
Average Valid Accuracy: 0.8163
 Best site-usa                       | Epoch:37 | Val Acc: 0.8957
 Best site-usa                       | Epoch:37 | Val Acc: 0.9043
 Best site-usa                       | Epoch:37 | Val Acc: 0.9197
 Best site-usa                       | Epoch:37 | Val Acc: 0.8861
 Best site-asia                      | Epoch:37 | Val Acc: 0.6458
 Best site-asia                      | Epoch:37 | Val Acc: 0.6458
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 38 ============
 Site-usa                           | Train Loss: 0.5476 | Train Acc: 0.7965
 Site-usa                           | Train Loss: 0.4298 | Train Acc: 0.8522
 Site-usa                           | Train Loss: 0.3853 | Train Acc: 0.8799
 Site-usa                           | Train Loss: 0.3214 | Train Acc: 0.9067
 Site-asia                          | Train Loss: 1.1486 | Train Acc: 0.6181
 Site-asia                          | Train Loss: 1.0159 | Train Acc: 0.6690
Average Train Accuracy: 0.7870
 Site-usa                           | Val  Loss: 0.3151 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.3974 | Val  Acc: 0.8739
 Site-usa                           | Val  Loss: 0.2894 | Val  Acc: 0.9262
 Site-usa                           | Val  Loss: 0.3644 | Val  Acc: 0.8883
 Site-asia                          | Val  Loss: 1.0152 | Val  Acc: 0.6632
 Site-asia                          | Val  Loss: 1.0377 | Val  Acc: 0.6545
Average Valid Accuracy: 0.8126
============ Train epoch 39 ============
 Site-usa                           | Train Loss: 0.4924 | Train Acc: 0.8256
 Site-usa                           | Train Loss: 0.4207 | Train Acc: 0.8609
 Site-usa                           | Train Loss: 0.4019 | Train Acc: 0.8741
 Site-usa                           | Train Loss: 0.3240 | Train Acc: 0.9001
 Site-asia                          | Train Loss: 1.1157 | Train Acc: 0.6412
 Site-asia                          | Train Loss: 1.0601 | Train Acc: 0.6377
Average Train Accuracy: 0.7899
 Site-usa                           | Val  Loss: 0.2560 | Val  Acc: 0.9130
 Site-usa                           | Val  Loss: 0.3232 | Val  Acc: 0.9130
 Site-usa                           | Val  Loss: 0.3228 | Val  Acc: 0.8980
 Site-usa                           | Val  Loss: 0.3751 | Val  Acc: 0.8861
 Site-asia                          | Val  Loss: 1.0263 | Val  Acc: 0.6771
 Site-asia                          | Val  Loss: 1.0215 | Val  Acc: 0.6719
Average Valid Accuracy: 0.8265
 Best site-usa                       | Epoch:39 | Val Acc: 0.9130
 Best site-usa                       | Epoch:39 | Val Acc: 0.9130
 Best site-usa                       | Epoch:39 | Val Acc: 0.8980
 Best site-usa                       | Epoch:39 | Val Acc: 0.8861
 Best site-asia                      | Epoch:39 | Val Acc: 0.6771
 Best site-asia                      | Epoch:39 | Val Acc: 0.6719
 Test site-usa                       | Epoch:39 | Test Acc: 0.9046
 Test site-asia                      | Epoch:39 | Test Acc: 0.8247
usa: 0.9046, asia: 0.8247, 
Average Test Accuracy(group): 0.8647, Average Test Accuracy(individual): 0.8780,
domain std=0.0399, cluster std=-1.0000, individual std=0.0376, 
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/harmo-fl...
============ Train epoch 40 ============
 Site-usa                           | Train Loss: 0.4382 | Train Acc: 0.8372
 Site-usa                           | Train Loss: 0.4539 | Train Acc: 0.8551
 Site-usa                           | Train Loss: 0.4365 | Train Acc: 0.8611
 Site-usa                           | Train Loss: 0.3301 | Train Acc: 0.9001
 Site-asia                          | Train Loss: 1.2147 | Train Acc: 0.6065
 Site-asia                          | Train Loss: 1.0070 | Train Acc: 0.6806
Average Train Accuracy: 0.7901
 Site-usa                           | Val  Loss: 0.3270 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.3254 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.3072 | Val  Acc: 0.9154
 Site-usa                           | Val  Loss: 0.3809 | Val  Acc: 0.8829
 Site-asia                          | Val  Loss: 1.0503 | Val  Acc: 0.6424
 Site-asia                          | Val  Loss: 1.0740 | Val  Acc: 0.6528
Average Valid Accuracy: 0.8083
============ Train epoch 41 ============
 Site-usa                           | Train Loss: 0.5149 | Train Acc: 0.8314
 Site-usa                           | Train Loss: 0.4610 | Train Acc: 0.8551
 Site-usa                           | Train Loss: 0.3797 | Train Acc: 0.8784
 Site-usa                           | Train Loss: 0.3298 | Train Acc: 0.8958
 Site-asia                          | Train Loss: 1.1020 | Train Acc: 0.6343
 Site-asia                          | Train Loss: 1.0514 | Train Acc: 0.6539
Average Train Accuracy: 0.7915
 Site-usa                           | Val  Loss: 0.2800 | Val  Acc: 0.9304
 Site-usa                           | Val  Loss: 0.3368 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.3209 | Val  Acc: 0.9089
 Site-usa                           | Val  Loss: 0.3504 | Val  Acc: 0.8818
 Site-asia                          | Val  Loss: 1.0570 | Val  Acc: 0.6354
 Site-asia                          | Val  Loss: 1.0476 | Val  Acc: 0.6337
Average Valid Accuracy: 0.8129
============ Train epoch 42 ============
 Site-usa                           | Train Loss: 0.5319 | Train Acc: 0.8023
 Site-usa                           | Train Loss: 0.4529 | Train Acc: 0.8377
 Site-usa                           | Train Loss: 0.3508 | Train Acc: 0.8958
 Site-usa                           | Train Loss: 0.3341 | Train Acc: 0.8929
 Site-asia                          | Train Loss: 1.2088 | Train Acc: 0.6065
 Site-asia                          | Train Loss: 1.0150 | Train Acc: 0.6690
Average Train Accuracy: 0.7840
 Site-usa                           | Val  Loss: 0.3219 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.3421 | Val  Acc: 0.9174
 Site-usa                           | Val  Loss: 0.2773 | Val  Acc: 0.9219
 Site-usa                           | Val  Loss: 0.4098 | Val  Acc: 0.8633
 Site-asia                          | Val  Loss: 1.0090 | Val  Acc: 0.6424
 Site-asia                          | Val  Loss: 1.0368 | Val  Acc: 0.6406
Average Valid Accuracy: 0.8135
============ Train epoch 43 ============
 Site-usa                           | Train Loss: 0.4655 | Train Acc: 0.8430
 Site-usa                           | Train Loss: 0.4271 | Train Acc: 0.8464
 Site-usa                           | Train Loss: 0.3859 | Train Acc: 0.8755
 Site-usa                           | Train Loss: 0.3184 | Train Acc: 0.8936
 Site-asia                          | Train Loss: 1.1115 | Train Acc: 0.6157
 Site-asia                          | Train Loss: 1.0106 | Train Acc: 0.6609
Average Train Accuracy: 0.7892
 Site-usa                           | Val  Loss: 0.2429 | Val  Acc: 0.9391
 Site-usa                           | Val  Loss: 0.2777 | Val  Acc: 0.9087
 Site-usa                           | Val  Loss: 0.2786 | Val  Acc: 0.9132
 Site-usa                           | Val  Loss: 0.3913 | Val  Acc: 0.8731
 Site-asia                          | Val  Loss: 1.0024 | Val  Acc: 0.6493
 Site-asia                          | Val  Loss: 0.9907 | Val  Acc: 0.6736
Average Valid Accuracy: 0.8262
============ Train epoch 44 ============
 Site-usa                           | Train Loss: 0.5658 | Train Acc: 0.7907
 Site-usa                           | Train Loss: 0.4566 | Train Acc: 0.8464
 Site-usa                           | Train Loss: 0.4183 | Train Acc: 0.8640
 Site-usa                           | Train Loss: 0.3165 | Train Acc: 0.9009
 Site-asia                          | Train Loss: 1.1362 | Train Acc: 0.6319
 Site-asia                          | Train Loss: 1.0255 | Train Acc: 0.6574
Average Train Accuracy: 0.7819
 Site-usa                           | Val  Loss: 0.2468 | Val  Acc: 0.9130
 Site-usa                           | Val  Loss: 0.3554 | Val  Acc: 0.8739
 Site-usa                           | Val  Loss: 0.3209 | Val  Acc: 0.9046
 Site-usa                           | Val  Loss: 0.3741 | Val  Acc: 0.8731
 Site-asia                          | Val  Loss: 0.9235 | Val  Acc: 0.6806
 Site-asia                          | Val  Loss: 1.0172 | Val  Acc: 0.6701
Average Valid Accuracy: 0.8192
============ Train epoch 45 ============
 Site-usa                           | Train Loss: 0.5106 | Train Acc: 0.8140
 Site-usa                           | Train Loss: 0.4389 | Train Acc: 0.8551
 Site-usa                           | Train Loss: 0.4065 | Train Acc: 0.8712
 Site-usa                           | Train Loss: 0.3104 | Train Acc: 0.9074
 Site-asia                          | Train Loss: 1.1641 | Train Acc: 0.5949
 Site-asia                          | Train Loss: 1.0689 | Train Acc: 0.6447
Average Train Accuracy: 0.7812
 Site-usa                           | Val  Loss: 0.2543 | Val  Acc: 0.9478
 Site-usa                           | Val  Loss: 0.3527 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.3824 | Val  Acc: 0.8894
 Site-usa                           | Val  Loss: 0.3739 | Val  Acc: 0.8698
 Site-asia                          | Val  Loss: 1.0372 | Val  Acc: 0.6146
 Site-asia                          | Val  Loss: 1.0508 | Val  Acc: 0.6389
Average Valid Accuracy: 0.8094
============ Train epoch 46 ============
 Site-usa                           | Train Loss: 0.5458 | Train Acc: 0.8430
 Site-usa                           | Train Loss: 0.4715 | Train Acc: 0.8377
 Site-usa                           | Train Loss: 0.3783 | Train Acc: 0.8755
 Site-usa                           | Train Loss: 0.3305 | Train Acc: 0.8958
 Site-asia                          | Train Loss: 1.1541 | Train Acc: 0.6204
 Site-asia                          | Train Loss: 1.0313 | Train Acc: 0.6586
Average Train Accuracy: 0.7885
 Site-usa                           | Val  Loss: 0.2387 | Val  Acc: 0.9130
 Site-usa                           | Val  Loss: 0.3855 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.3425 | Val  Acc: 0.9002
 Site-usa                           | Val  Loss: 0.3410 | Val  Acc: 0.8861
 Site-asia                          | Val  Loss: 0.8866 | Val  Acc: 0.6944
 Site-asia                          | Val  Loss: 1.1284 | Val  Acc: 0.6319
Average Valid Accuracy: 0.8159
============ Train epoch 47 ============
 Site-usa                           | Train Loss: 0.5023 | Train Acc: 0.7965
 Site-usa                           | Train Loss: 0.4786 | Train Acc: 0.8406
 Site-usa                           | Train Loss: 0.4073 | Train Acc: 0.8654
 Site-usa                           | Train Loss: 0.3475 | Train Acc: 0.8900
 Site-asia                          | Train Loss: 1.1819 | Train Acc: 0.6273
 Site-asia                          | Train Loss: 1.0013 | Train Acc: 0.6771
Average Train Accuracy: 0.7828
 Site-usa                           | Val  Loss: 0.3304 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.3303 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.2722 | Val  Acc: 0.9176
 Site-usa                           | Val  Loss: 0.3646 | Val  Acc: 0.8829
 Site-asia                          | Val  Loss: 0.9736 | Val  Acc: 0.6528
 Site-asia                          | Val  Loss: 1.0145 | Val  Acc: 0.6528
Average Valid Accuracy: 0.8177
============ Train epoch 48 ============
 Site-usa                           | Train Loss: 0.5156 | Train Acc: 0.8198
 Site-usa                           | Train Loss: 0.4981 | Train Acc: 0.8232
 Site-usa                           | Train Loss: 0.3867 | Train Acc: 0.8842
 Site-usa                           | Train Loss: 0.3288 | Train Acc: 0.9009
 Site-asia                          | Train Loss: 1.0969 | Train Acc: 0.6389
 Site-asia                          | Train Loss: 1.0664 | Train Acc: 0.6516
Average Train Accuracy: 0.7864
 Site-usa                           | Val  Loss: 0.3194 | Val  Acc: 0.9130
 Site-usa                           | Val  Loss: 0.2795 | Val  Acc: 0.9261
 Site-usa                           | Val  Loss: 0.2994 | Val  Acc: 0.9089
 Site-usa                           | Val  Loss: 0.3452 | Val  Acc: 0.8905
 Site-asia                          | Val  Loss: 0.9945 | Val  Acc: 0.6562
 Site-asia                          | Val  Loss: 1.0140 | Val  Acc: 0.6493
Average Valid Accuracy: 0.8240
============ Train epoch 49 ============
 Site-usa                           | Train Loss: 0.4961 | Train Acc: 0.8314
 Site-usa                           | Train Loss: 0.4825 | Train Acc: 0.8580
 Site-usa                           | Train Loss: 0.4095 | Train Acc: 0.8669
 Site-usa                           | Train Loss: 0.3179 | Train Acc: 0.9030
 Site-asia                          | Train Loss: 1.1406 | Train Acc: 0.6065
 Site-asia                          | Train Loss: 0.9798 | Train Acc: 0.6690
Average Train Accuracy: 0.7891
 Site-usa                           | Val  Loss: 0.3338 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.3237 | Val  Acc: 0.9174
 Site-usa                           | Val  Loss: 0.3438 | Val  Acc: 0.9024
 Site-usa                           | Val  Loss: 0.3592 | Val  Acc: 0.8796
 Site-asia                          | Val  Loss: 0.9171 | Val  Acc: 0.6910
 Site-asia                          | Val  Loss: 1.0059 | Val  Acc: 0.6719
Average Valid Accuracy: 0.8205
 Test site-usa                       | Epoch:39 | Test Acc: 0.9002
 Test site-asia                      | Epoch:39 | Test Acc: 0.8179
usa: 0.9002, asia: 0.8179, 
Average Test Accuracy(group): 0.8590, Average Test Accuracy(individual): 0.8728,
domain std=0.0412, cluster std=-1.0000, individual std=0.0388, 
===2023-07-28 22:26:52===
===2023-07-28 22:27:07===
===Setting===
    dataset: geo
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[172,345,691,1382,432,864,
client_nums=[4,2,]
len_dataset=[8646,4323,]
domain number = 2
Loading snapshots...
 Test site-usa                       (1)| Epoch:39 | Test Acc: 0.9046
 Test site-asia                      (1)| Epoch:39 | Test Acc: 0.8247
usa: 0.9046, asia: 0.8247, 
Average Test Accuracy(group): 0.8647, Average Test Accuracy(individual): 0.8780,
domain std=0.0399, cluster std=0.0000, individual std=0.0376, 
