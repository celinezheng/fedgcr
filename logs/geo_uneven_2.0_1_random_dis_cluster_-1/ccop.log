===2023-07-28 14:57:14===
===Setting===
    dataset: geo
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[172,345,691,1382,432,864,
client_nums=[4,2,]
len_dataset=[8646,4323,]
domain number = 2
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 5, ]
cnt=[1, 5, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-usa                       (1) | Train Loss: 1.3473 | Train Acc: 0.5814
 Site-usa                       (1) | Train Loss: 1.3662 | Train Acc: 0.5971
 Site-usa                       (1) | Train Loss: 1.2754 | Train Acc: 0.6078
 Site-usa                       (1) | Train Loss: 1.3358 | Train Acc: 0.5781
 Site-asia                      (1) | Train Loss: 2.2066 | Train Acc: 0.2778
 Site-asia                      (0) | Train Loss: 2.2366 | Train Acc: 0.2894
Average Train Accuracy: 0.4886
 Site-usa                       (1) | Val  Loss: 1.2917 | Val  Acc: 0.6261
 Site-usa                       (1) | Val  Loss: 1.3026 | Val  Acc: 0.5957
 Site-usa                       (1) | Val  Loss: 1.3175 | Val  Acc: 0.5987
 Site-usa                       (1) | Val  Loss: 1.3346 | Val  Acc: 0.5933
 Site-asia                      (1) | Val  Loss: 2.1646 | Val  Acc: 0.3021
 Site-asia                      (0) | Val  Loss: 2.2337 | Val  Acc: 0.2778
Average Valid Accuracy: 0.4989
 Best site-usa                      (1)  | Epoch:0 | Val Acc: 0.6261
 Best site-usa                      (1)  | Epoch:0 | Val Acc: 0.5957
 Best site-usa                      (1)  | Epoch:0 | Val Acc: 0.5987
 Best site-usa                      (1)  | Epoch:0 | Val Acc: 0.5933
 Best site-asia                     (1)  | Epoch:0 | Val Acc: 0.3021
 Best site-asia                     (0)  | Epoch:0 | Val Acc: 0.2778
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 1, ]
cnt=[1, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-usa                       (0) | Train Loss: 1.2764 | Train Acc: 0.6047
 Site-usa                       (0) | Train Loss: 1.2983 | Train Acc: 0.6058
 Site-usa                       (0) | Train Loss: 1.2232 | Train Acc: 0.6440
 Site-usa                       (0) | Train Loss: 1.2870 | Train Acc: 0.6020
 Site-asia                      (1) | Train Loss: 1.3621 | Train Acc: 0.5509
 Site-asia                      (0) | Train Loss: 1.4072 | Train Acc: 0.5301
Average Train Accuracy: 0.5896
 Site-usa                       (0) | Val  Loss: 1.1475 | Val  Acc: 0.6870
 Site-usa                       (0) | Val  Loss: 1.2910 | Val  Acc: 0.6130
 Site-usa                       (0) | Val  Loss: 1.3158 | Val  Acc: 0.5965
 Site-usa                       (0) | Val  Loss: 1.2683 | Val  Acc: 0.6128
 Site-asia                      (1) | Val  Loss: 1.3601 | Val  Acc: 0.5417
 Site-asia                      (0) | Val  Loss: 1.4212 | Val  Acc: 0.5243
Average Valid Accuracy: 0.5959
 Best site-usa                      (0)  | Epoch:1 | Val Acc: 0.6870
 Best site-usa                      (0)  | Epoch:1 | Val Acc: 0.6130
 Best site-usa                      (0)  | Epoch:1 | Val Acc: 0.5965
 Best site-usa                      (0)  | Epoch:1 | Val Acc: 0.6128
 Best site-asia                     (1)  | Epoch:1 | Val Acc: 0.5417
 Best site-asia                     (0)  | Epoch:1 | Val Acc: 0.5243
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 4, ]
cnt=[1, 5, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-usa                       (1) | Train Loss: 0.8644 | Train Acc: 0.7035
 Site-usa                       (1) | Train Loss: 0.9243 | Train Acc: 0.7507
 Site-usa                       (1) | Train Loss: 0.8096 | Train Acc: 0.7627
 Site-usa                       (1) | Train Loss: 0.8289 | Train Acc: 0.7648
 Site-asia                      (0) | Train Loss: 1.5177 | Train Acc: 0.4722
 Site-asia                      (0) | Train Loss: 1.5767 | Train Acc: 0.4664
Average Train Accuracy: 0.6534
 Site-usa                       (1) | Val  Loss: 0.8018 | Val  Acc: 0.8000
 Site-usa                       (1) | Val  Loss: 0.8001 | Val  Acc: 0.7739
 Site-usa                       (1) | Val  Loss: 0.8184 | Val  Acc: 0.7701
 Site-usa                       (1) | Val  Loss: 0.8106 | Val  Acc: 0.7744
 Site-asia                      (0) | Val  Loss: 1.5109 | Val  Acc: 0.4792
 Site-asia                      (0) | Val  Loss: 1.5976 | Val  Acc: 0.4618
Average Valid Accuracy: 0.6766
 Best site-usa                      (1)  | Epoch:2 | Val Acc: 0.8000
 Best site-usa                      (1)  | Epoch:2 | Val Acc: 0.7739
 Best site-usa                      (1)  | Epoch:2 | Val Acc: 0.7701
 Best site-usa                      (1)  | Epoch:2 | Val Acc: 0.7744
 Best site-asia                     (0)  | Epoch:2 | Val Acc: 0.4792
 Best site-asia                     (0)  | Epoch:2 | Val Acc: 0.4618
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[3, 3, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-usa                       (1) | Train Loss: 0.9586 | Train Acc: 0.6977
 Site-usa                       (1) | Train Loss: 0.9634 | Train Acc: 0.7159
 Site-usa                       (0) | Train Loss: 0.8588 | Train Acc: 0.7352
 Site-usa                       (0) | Train Loss: 0.8901 | Train Acc: 0.7185
 Site-asia                      (0) | Train Loss: 1.2077 | Train Acc: 0.5926
 Site-asia                      (1) | Train Loss: 1.2196 | Train Acc: 0.6088
Average Train Accuracy: 0.6781
 Site-usa                       (1) | Val  Loss: 0.8156 | Val  Acc: 0.7652
 Site-usa                       (1) | Val  Loss: 0.9251 | Val  Acc: 0.7130
 Site-usa                       (0) | Val  Loss: 0.9092 | Val  Acc: 0.7397
 Site-usa                       (0) | Val  Loss: 0.9113 | Val  Acc: 0.7234
 Site-asia                      (0) | Val  Loss: 1.2034 | Val  Acc: 0.6007
 Site-asia                      (1) | Val  Loss: 1.2230 | Val  Acc: 0.5851
Average Valid Accuracy: 0.6879
 Best site-usa                      (1)  | Epoch:3 | Val Acc: 0.7652
 Best site-usa                      (1)  | Epoch:3 | Val Acc: 0.7130
 Best site-usa                      (0)  | Epoch:3 | Val Acc: 0.7397
 Best site-usa                      (0)  | Epoch:3 | Val Acc: 0.7234
 Best site-asia                     (0)  | Epoch:3 | Val Acc: 0.6007
 Best site-asia                     (1)  | Epoch:3 | Val Acc: 0.5851
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[3, 3, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-usa                       (0) | Train Loss: 0.8273 | Train Acc: 0.7558
 Site-usa                       (1) | Train Loss: 0.7897 | Train Acc: 0.7536
 Site-usa                       (0) | Train Loss: 0.6979 | Train Acc: 0.7945
 Site-usa                       (1) | Train Loss: 0.7409 | Train Acc: 0.7858
 Site-asia                      (1) | Train Loss: 1.2994 | Train Acc: 0.5648
 Site-asia                      (0) | Train Loss: 1.2939 | Train Acc: 0.5822
Average Train Accuracy: 0.7061
 Site-usa                       (0) | Val  Loss: 0.6476 | Val  Acc: 0.8087
 Site-usa                       (1) | Val  Loss: 0.7451 | Val  Acc: 0.7696
 Site-usa                       (0) | Val  Loss: 0.7145 | Val  Acc: 0.7896
 Site-usa                       (1) | Val  Loss: 0.7564 | Val  Acc: 0.7711
 Site-asia                      (1) | Val  Loss: 1.1953 | Val  Acc: 0.6042
 Site-asia                      (0) | Val  Loss: 1.2650 | Val  Acc: 0.5660
Average Valid Accuracy: 0.7182
 Best site-usa                      (0)  | Epoch:4 | Val Acc: 0.8087
 Best site-usa                      (1)  | Epoch:4 | Val Acc: 0.7696
 Best site-usa                      (0)  | Epoch:4 | Val Acc: 0.7896
 Best site-usa                      (1)  | Epoch:4 | Val Acc: 0.7711
 Best site-asia                     (1)  | Epoch:4 | Val Acc: 0.6042
 Best site-asia                     (0)  | Epoch:4 | Val Acc: 0.5660
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[4, 2, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-usa                       (0) | Train Loss: 0.9315 | Train Acc: 0.6802
 Site-usa                       (0) | Train Loss: 0.9697 | Train Acc: 0.6754
 Site-usa                       (0) | Train Loss: 0.7429 | Train Acc: 0.7699
 Site-usa                       (0) | Train Loss: 0.8335 | Train Acc: 0.7388
 Site-asia                      (1) | Train Loss: 1.1444 | Train Acc: 0.6296
 Site-asia                      (1) | Train Loss: 1.1211 | Train Acc: 0.6377
Average Train Accuracy: 0.6886
 Site-usa                       (0) | Val  Loss: 0.7750 | Val  Acc: 0.7217
 Site-usa                       (0) | Val  Loss: 0.8039 | Val  Acc: 0.7739
 Site-usa                       (0) | Val  Loss: 0.7675 | Val  Acc: 0.7636
 Site-usa                       (0) | Val  Loss: 0.8007 | Val  Acc: 0.7375
 Site-asia                      (1) | Val  Loss: 1.1463 | Val  Acc: 0.6007
 Site-asia                      (1) | Val  Loss: 1.1350 | Val  Acc: 0.6146
Average Valid Accuracy: 0.7020
============ Train epoch 6 ============
cnt=[2, 4, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-usa                       (0) | Train Loss: 0.7722 | Train Acc: 0.7558
 Site-usa                       (1) | Train Loss: 0.6904 | Train Acc: 0.7826
 Site-usa                       (1) | Train Loss: 0.6540 | Train Acc: 0.8075
 Site-usa                       (0) | Train Loss: 0.6521 | Train Acc: 0.7996
 Site-asia                      (1) | Train Loss: 1.2379 | Train Acc: 0.5810
 Site-asia                      (1) | Train Loss: 1.2232 | Train Acc: 0.5961
Average Train Accuracy: 0.7204
 Site-usa                       (0) | Val  Loss: 0.6436 | Val  Acc: 0.8348
 Site-usa                       (1) | Val  Loss: 0.6697 | Val  Acc: 0.8087
 Site-usa                       (1) | Val  Loss: 0.6589 | Val  Acc: 0.8200
 Site-usa                       (0) | Val  Loss: 0.6828 | Val  Acc: 0.7918
 Site-asia                      (1) | Val  Loss: 1.1920 | Val  Acc: 0.5660
 Site-asia                      (1) | Val  Loss: 1.2415 | Val  Acc: 0.5816
Average Valid Accuracy: 0.7338
 Best site-usa                      (0)  | Epoch:6 | Val Acc: 0.8348
 Best site-usa                      (1)  | Epoch:6 | Val Acc: 0.8087
 Best site-usa                      (1)  | Epoch:6 | Val Acc: 0.8200
 Best site-usa                      (0)  | Epoch:6 | Val Acc: 0.7918
 Best site-asia                     (1)  | Epoch:6 | Val Acc: 0.5660
 Best site-asia                     (1)  | Epoch:6 | Val Acc: 0.5816
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 2, ]
cnt=[1, 5, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-usa                       (1) | Train Loss: 0.7800 | Train Acc: 0.7733
 Site-usa                       (0) | Train Loss: 0.7950 | Train Acc: 0.7536
 Site-usa                       (1) | Train Loss: 0.7366 | Train Acc: 0.7713
 Site-usa                       (0) | Train Loss: 0.7225 | Train Acc: 0.7822
 Site-asia                      (0) | Train Loss: 1.0896 | Train Acc: 0.6458
 Site-asia                      (0) | Train Loss: 1.1177 | Train Acc: 0.6262
Average Train Accuracy: 0.7254
 Site-usa                       (1) | Val  Loss: 0.6516 | Val  Acc: 0.7739
 Site-usa                       (0) | Val  Loss: 0.7253 | Val  Acc: 0.7652
 Site-usa                       (1) | Val  Loss: 0.7074 | Val  Acc: 0.7809
 Site-usa                       (0) | Val  Loss: 0.7398 | Val  Acc: 0.7755
 Site-asia                      (0) | Val  Loss: 1.0420 | Val  Acc: 0.6146
 Site-asia                      (0) | Val  Loss: 1.1311 | Val  Acc: 0.6128
Average Valid Accuracy: 0.7205
============ Train epoch 8 ============
cnt=[2, 4, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-usa                       (1) | Train Loss: 0.6873 | Train Acc: 0.7558
 Site-usa                       (1) | Train Loss: 0.6770 | Train Acc: 0.7768
 Site-usa                       (0) | Train Loss: 0.6311 | Train Acc: 0.8032
 Site-usa                       (1) | Train Loss: 0.6300 | Train Acc: 0.8061
 Site-asia                      (1) | Train Loss: 1.2006 | Train Acc: 0.5903
 Site-asia                      (0) | Train Loss: 1.1722 | Train Acc: 0.5926
Average Train Accuracy: 0.7208
 Site-usa                       (1) | Val  Loss: 0.6003 | Val  Acc: 0.8261
 Site-usa                       (1) | Val  Loss: 0.6300 | Val  Acc: 0.7913
 Site-usa                       (0) | Val  Loss: 0.6671 | Val  Acc: 0.8221
 Site-usa                       (1) | Val  Loss: 0.6699 | Val  Acc: 0.7972
 Site-asia                      (1) | Val  Loss: 1.1072 | Val  Acc: 0.5938
 Site-asia                      (0) | Val  Loss: 1.1767 | Val  Acc: 0.5885
Average Valid Accuracy: 0.7365
 Best site-usa                      (1)  | Epoch:8 | Val Acc: 0.8261
 Best site-usa                      (1)  | Epoch:8 | Val Acc: 0.7913
 Best site-usa                      (0)  | Epoch:8 | Val Acc: 0.8221
 Best site-usa                      (1)  | Epoch:8 | Val Acc: 0.7972
 Best site-asia                     (1)  | Epoch:8 | Val Acc: 0.5938
 Best site-asia                     (0)  | Epoch:8 | Val Acc: 0.5885
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[5, 1, ]
cnt=[3, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-usa                       (0) | Train Loss: 0.7409 | Train Acc: 0.7616
 Site-usa                       (1) | Train Loss: 0.6809 | Train Acc: 0.7913
 Site-usa                       (0) | Train Loss: 0.6149 | Train Acc: 0.8133
 Site-usa                       (0) | Train Loss: 0.6309 | Train Acc: 0.8032
 Site-asia                      (0) | Train Loss: 1.1177 | Train Acc: 0.5995
 Site-asia                      (0) | Train Loss: 1.1021 | Train Acc: 0.6238
Average Train Accuracy: 0.7321
 Site-usa                       (0) | Val  Loss: 0.5805 | Val  Acc: 0.8087
 Site-usa                       (1) | Val  Loss: 0.6654 | Val  Acc: 0.8087
 Site-usa                       (0) | Val  Loss: 0.6059 | Val  Acc: 0.8091
 Site-usa                       (0) | Val  Loss: 0.6974 | Val  Acc: 0.7809
 Site-asia                      (0) | Val  Loss: 1.0500 | Val  Acc: 0.6076
 Site-asia                      (0) | Val  Loss: 1.0538 | Val  Acc: 0.6319
Average Valid Accuracy: 0.7412
 Best site-usa                      (0)  | Epoch:9 | Val Acc: 0.8087
 Best site-usa                      (1)  | Epoch:9 | Val Acc: 0.8087
 Best site-usa                      (0)  | Epoch:9 | Val Acc: 0.8091
 Best site-usa                      (0)  | Epoch:9 | Val Acc: 0.7809
 Best site-asia                     (0)  | Epoch:9 | Val Acc: 0.6076
 Best site-asia                     (0)  | Epoch:9 | Val Acc: 0.6319
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Test site-usa                       (0)| Epoch:9 | Test Acc: 0.8662
 Test site-asia                      (0)| Epoch:9 | Test Acc: 0.7828
usa: 0.8662, asia: 0.7828, 
Average Test Accuracy(group): 0.8245, Average Test Accuracy(individual): 0.8384,
domain std=0.0417, cluster std=0.0167, individual std=0.0393, 
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 3, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-usa                       (0) | Train Loss: 0.7336 | Train Acc: 0.7616
 Site-usa                       (0) | Train Loss: 0.6470 | Train Acc: 0.7768
 Site-usa                       (0) | Train Loss: 0.6235 | Train Acc: 0.8263
 Site-usa                       (1) | Train Loss: 0.6414 | Train Acc: 0.8068
 Site-asia                      (1) | Train Loss: 1.1478 | Train Acc: 0.6111
 Site-asia                      (1) | Train Loss: 1.0742 | Train Acc: 0.6366
Average Train Accuracy: 0.7365
 Site-usa                       (0) | Val  Loss: 0.5846 | Val  Acc: 0.8174
 Site-usa                       (0) | Val  Loss: 0.6336 | Val  Acc: 0.8174
 Site-usa                       (0) | Val  Loss: 0.5924 | Val  Acc: 0.8265
 Site-usa                       (1) | Val  Loss: 0.6738 | Val  Acc: 0.8069
 Site-asia                      (1) | Val  Loss: 1.0956 | Val  Acc: 0.6146
 Site-asia                      (1) | Val  Loss: 1.1118 | Val  Acc: 0.6233
Average Valid Accuracy: 0.7510
 Best site-usa                      (0)  | Epoch:10 | Val Acc: 0.8174
 Best site-usa                      (0)  | Epoch:10 | Val Acc: 0.8174
 Best site-usa                      (0)  | Epoch:10 | Val Acc: 0.8265
 Best site-usa                      (1)  | Epoch:10 | Val Acc: 0.8069
 Best site-asia                     (1)  | Epoch:10 | Val Acc: 0.6146
 Best site-asia                     (1)  | Epoch:10 | Val Acc: 0.6233
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 11 ============
cnt=[5, 1, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-usa                       (1) | Train Loss: 0.7029 | Train Acc: 0.7558
 Site-usa                       (0) | Train Loss: 0.6082 | Train Acc: 0.7942
 Site-usa                       (0) | Train Loss: 0.6108 | Train Acc: 0.8104
 Site-usa                       (0) | Train Loss: 0.5997 | Train Acc: 0.8097
 Site-asia                      (0) | Train Loss: 1.1573 | Train Acc: 0.6181
 Site-asia                      (0) | Train Loss: 1.1345 | Train Acc: 0.6169
Average Train Accuracy: 0.7342
 Site-usa                       (1) | Val  Loss: 0.6066 | Val  Acc: 0.8000
 Site-usa                       (0) | Val  Loss: 0.6038 | Val  Acc: 0.8043
 Site-usa                       (0) | Val  Loss: 0.5646 | Val  Acc: 0.8308
 Site-usa                       (0) | Val  Loss: 0.6002 | Val  Acc: 0.8200
 Site-asia                      (0) | Val  Loss: 1.0744 | Val  Acc: 0.6146
 Site-asia                      (0) | Val  Loss: 1.1135 | Val  Acc: 0.6198
Average Valid Accuracy: 0.7482
============ Train epoch 12 ============
cnt=[4, 2, ]
cnt=[1, 5, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-usa                       (0) | Train Loss: 0.7795 | Train Acc: 0.7616
 Site-usa                       (0) | Train Loss: 0.7627 | Train Acc: 0.7478
 Site-usa                       (0) | Train Loss: 0.6509 | Train Acc: 0.7959
 Site-usa                       (0) | Train Loss: 0.6686 | Train Acc: 0.7996
 Site-asia                      (1) | Train Loss: 1.0196 | Train Acc: 0.6296
 Site-asia                      (1) | Train Loss: 1.0061 | Train Acc: 0.6562
Average Train Accuracy: 0.7318
 Site-usa                       (0) | Val  Loss: 0.6414 | Val  Acc: 0.8087
 Site-usa                       (0) | Val  Loss: 0.7455 | Val  Acc: 0.7609
 Site-usa                       (0) | Val  Loss: 0.6792 | Val  Acc: 0.7766
 Site-usa                       (0) | Val  Loss: 0.6963 | Val  Acc: 0.7863
 Site-asia                      (1) | Val  Loss: 1.0111 | Val  Acc: 0.6319
 Site-asia                      (1) | Val  Loss: 1.0470 | Val  Acc: 0.6476
Average Valid Accuracy: 0.7353
============ Train epoch 13 ============
cnt=[4, 2, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-usa                       (1) | Train Loss: 0.6398 | Train Acc: 0.7674
 Site-usa                       (1) | Train Loss: 0.6085 | Train Acc: 0.8232
 Site-usa                       (0) | Train Loss: 0.5406 | Train Acc: 0.8191
 Site-usa                       (0) | Train Loss: 0.5617 | Train Acc: 0.8256
 Site-asia                      (0) | Train Loss: 1.1798 | Train Acc: 0.6204
 Site-asia                      (0) | Train Loss: 1.0863 | Train Acc: 0.6458
Average Train Accuracy: 0.7503
 Site-usa                       (1) | Val  Loss: 0.5529 | Val  Acc: 0.8435
 Site-usa                       (1) | Val  Loss: 0.5685 | Val  Acc: 0.8087
 Site-usa                       (0) | Val  Loss: 0.5193 | Val  Acc: 0.8308
 Site-usa                       (0) | Val  Loss: 0.5932 | Val  Acc: 0.8156
 Site-asia                      (0) | Val  Loss: 1.0926 | Val  Acc: 0.6146
 Site-asia                      (0) | Val  Loss: 1.1498 | Val  Acc: 0.5990
Average Valid Accuracy: 0.7520
 Best site-usa                      (1)  | Epoch:13 | Val Acc: 0.8435
 Best site-usa                      (1)  | Epoch:13 | Val Acc: 0.8087
 Best site-usa                      (0)  | Epoch:13 | Val Acc: 0.8308
 Best site-usa                      (0)  | Epoch:13 | Val Acc: 0.8156
 Best site-asia                     (0)  | Epoch:13 | Val Acc: 0.6146
 Best site-asia                     (0)  | Epoch:13 | Val Acc: 0.5990
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 4, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-usa                       (0) | Train Loss: 0.6724 | Train Acc: 0.7849
 Site-usa                       (1) | Train Loss: 0.6602 | Train Acc: 0.7739
 Site-usa                       (0) | Train Loss: 0.5934 | Train Acc: 0.8148
 Site-usa                       (1) | Train Loss: 0.5909 | Train Acc: 0.8300
 Site-asia                      (1) | Train Loss: 1.0783 | Train Acc: 0.6296
 Site-asia                      (1) | Train Loss: 1.0197 | Train Acc: 0.6620
Average Train Accuracy: 0.7492
 Site-usa                       (0) | Val  Loss: 0.6212 | Val  Acc: 0.8174
 Site-usa                       (1) | Val  Loss: 0.5720 | Val  Acc: 0.8348
 Site-usa                       (0) | Val  Loss: 0.5622 | Val  Acc: 0.8286
 Site-usa                       (1) | Val  Loss: 0.5716 | Val  Acc: 0.8189
 Site-asia                      (1) | Val  Loss: 0.9930 | Val  Acc: 0.6250
 Site-asia                      (1) | Val  Loss: 1.0162 | Val  Acc: 0.6528
Average Valid Accuracy: 0.7629
 Best site-usa                      (0)  | Epoch:14 | Val Acc: 0.8174
 Best site-usa                      (1)  | Epoch:14 | Val Acc: 0.8348
 Best site-usa                      (0)  | Epoch:14 | Val Acc: 0.8286
 Best site-usa                      (1)  | Epoch:14 | Val Acc: 0.8189
 Best site-asia                     (1)  | Epoch:14 | Val Acc: 0.6250
 Best site-asia                     (1)  | Epoch:14 | Val Acc: 0.6528
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 15 ============
cnt=[3, 3, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-usa                       (1) | Train Loss: 0.7104 | Train Acc: 0.7500
 Site-usa                       (1) | Train Loss: 0.6903 | Train Acc: 0.7362
 Site-usa                       (0) | Train Loss: 0.6232 | Train Acc: 0.8017
 Site-usa                       (1) | Train Loss: 0.6137 | Train Acc: 0.8169
 Site-asia                      (0) | Train Loss: 1.0465 | Train Acc: 0.6481
 Site-asia                      (0) | Train Loss: 1.0021 | Train Acc: 0.6528
Average Train Accuracy: 0.7343
 Site-usa                       (1) | Val  Loss: 0.5317 | Val  Acc: 0.8174
 Site-usa                       (1) | Val  Loss: 0.6009 | Val  Acc: 0.8174
 Site-usa                       (0) | Val  Loss: 0.6115 | Val  Acc: 0.8134
 Site-usa                       (1) | Val  Loss: 0.6323 | Val  Acc: 0.7928
 Site-asia                      (0) | Val  Loss: 0.9994 | Val  Acc: 0.6632
 Site-asia                      (0) | Val  Loss: 0.9958 | Val  Acc: 0.6719
Average Valid Accuracy: 0.7627
============ Train epoch 16 ============
cnt=[4, 2, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-usa                       (0) | Train Loss: 0.6910 | Train Acc: 0.7500
 Site-usa                       (0) | Train Loss: 0.6792 | Train Acc: 0.7797
 Site-usa                       (0) | Train Loss: 0.6111 | Train Acc: 0.8133
 Site-usa                       (0) | Train Loss: 0.5816 | Train Acc: 0.8271
 Site-asia                      (1) | Train Loss: 1.0205 | Train Acc: 0.6597
 Site-asia                      (1) | Train Loss: 0.9959 | Train Acc: 0.6562
Average Train Accuracy: 0.7477
 Site-usa                       (0) | Val  Loss: 0.6533 | Val  Acc: 0.8000
 Site-usa                       (0) | Val  Loss: 0.5432 | Val  Acc: 0.8348
 Site-usa                       (0) | Val  Loss: 0.5826 | Val  Acc: 0.8286
 Site-usa                       (0) | Val  Loss: 0.6357 | Val  Acc: 0.8037
 Site-asia                      (1) | Val  Loss: 0.9472 | Val  Acc: 0.6701
 Site-asia                      (1) | Val  Loss: 1.0276 | Val  Acc: 0.6545
Average Valid Accuracy: 0.7653
 Best site-usa                      (0)  | Epoch:16 | Val Acc: 0.8000
 Best site-usa                      (0)  | Epoch:16 | Val Acc: 0.8348
 Best site-usa                      (0)  | Epoch:16 | Val Acc: 0.8286
 Best site-usa                      (0)  | Epoch:16 | Val Acc: 0.8037
 Best site-asia                     (1)  | Epoch:16 | Val Acc: 0.6701
 Best site-asia                     (1)  | Epoch:16 | Val Acc: 0.6545
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 17 ============
cnt=[4, 2, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-usa                       (0) | Train Loss: 0.7027 | Train Acc: 0.7674
 Site-usa                       (0) | Train Loss: 0.6352 | Train Acc: 0.8116
 Site-usa                       (1) | Train Loss: 0.5906 | Train Acc: 0.8177
 Site-usa                       (1) | Train Loss: 0.6060 | Train Acc: 0.8162
 Site-asia                      (0) | Train Loss: 1.0346 | Train Acc: 0.6458
 Site-asia                      (0) | Train Loss: 0.9906 | Train Acc: 0.6586
Average Train Accuracy: 0.7529
 Site-usa                       (0) | Val  Loss: 0.6497 | Val  Acc: 0.8087
 Site-usa                       (0) | Val  Loss: 0.6256 | Val  Acc: 0.8043
 Site-usa                       (1) | Val  Loss: 0.5642 | Val  Acc: 0.8308
 Site-usa                       (1) | Val  Loss: 0.5870 | Val  Acc: 0.8232
 Site-asia                      (0) | Val  Loss: 1.0314 | Val  Acc: 0.5972
 Site-asia                      (0) | Val  Loss: 1.0503 | Val  Acc: 0.6302
Average Valid Accuracy: 0.7491
============ Train epoch 18 ============
cnt=[1, 5, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-usa                       (1) | Train Loss: 0.6772 | Train Acc: 0.7558
 Site-usa                       (1) | Train Loss: 0.5908 | Train Acc: 0.7971
 Site-usa                       (1) | Train Loss: 0.5564 | Train Acc: 0.8278
 Site-usa                       (1) | Train Loss: 0.5454 | Train Acc: 0.8365
 Site-asia                      (1) | Train Loss: 1.0381 | Train Acc: 0.6597
 Site-asia                      (0) | Train Loss: 0.9991 | Train Acc: 0.6609
Average Train Accuracy: 0.7563
 Site-usa                       (1) | Val  Loss: 0.4727 | Val  Acc: 0.8435
 Site-usa                       (1) | Val  Loss: 0.5685 | Val  Acc: 0.8261
 Site-usa                       (1) | Val  Loss: 0.5288 | Val  Acc: 0.8416
 Site-usa                       (1) | Val  Loss: 0.5743 | Val  Acc: 0.8145
 Site-asia                      (1) | Val  Loss: 1.0108 | Val  Acc: 0.6285
 Site-asia                      (0) | Val  Loss: 0.9989 | Val  Acc: 0.6597
Average Valid Accuracy: 0.7690
 Best site-usa                      (1)  | Epoch:18 | Val Acc: 0.8435
 Best site-usa                      (1)  | Epoch:18 | Val Acc: 0.8261
 Best site-usa                      (1)  | Epoch:18 | Val Acc: 0.8416
 Best site-usa                      (1)  | Epoch:18 | Val Acc: 0.8145
 Best site-asia                     (1)  | Epoch:18 | Val Acc: 0.6285
 Best site-asia                     (0)  | Epoch:18 | Val Acc: 0.6597
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 19 ============
cnt=[4, 2, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-usa                       (0) | Train Loss: 0.7581 | Train Acc: 0.7733
 Site-usa                       (0) | Train Loss: 0.7214 | Train Acc: 0.7652
 Site-usa                       (0) | Train Loss: 0.6243 | Train Acc: 0.8104
 Site-usa                       (0) | Train Loss: 0.6276 | Train Acc: 0.8039
 Site-asia                      (1) | Train Loss: 1.0048 | Train Acc: 0.6505
 Site-asia                      (1) | Train Loss: 0.9564 | Train Acc: 0.6806
Average Train Accuracy: 0.7473
 Site-usa                       (0) | Val  Loss: 0.6191 | Val  Acc: 0.8000
 Site-usa                       (0) | Val  Loss: 0.6108 | Val  Acc: 0.8000
 Site-usa                       (0) | Val  Loss: 0.6306 | Val  Acc: 0.8113
 Site-usa                       (0) | Val  Loss: 0.6778 | Val  Acc: 0.7820
 Site-asia                      (1) | Val  Loss: 0.9306 | Val  Acc: 0.6632
 Site-asia                      (1) | Val  Loss: 0.9822 | Val  Acc: 0.6736
Average Valid Accuracy: 0.7550
 Test site-usa                       (0)| Epoch:18 | Test Acc: 0.8695
 Test site-asia                      (1)| Epoch:18 | Test Acc: 0.7979
usa: 0.8695, asia: 0.7979, 
Average Test Accuracy(group): 0.8337, Average Test Accuracy(individual): 0.8457,
domain std=0.0358, cluster std=0.0358, individual std=0.0337, 
============ Train epoch 20 ============
cnt=[3, 3, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-usa                       (1) | Train Loss: 0.6098 | Train Acc: 0.8023
 Site-usa                       (1) | Train Loss: 0.6005 | Train Acc: 0.8087
 Site-usa                       (0) | Train Loss: 0.5367 | Train Acc: 0.8336
 Site-usa                       (1) | Train Loss: 0.5307 | Train Acc: 0.8336
 Site-asia                      (0) | Train Loss: 1.0610 | Train Acc: 0.6296
 Site-asia                      (0) | Train Loss: 0.9999 | Train Acc: 0.6516
Average Train Accuracy: 0.7599
 Site-usa                       (1) | Val  Loss: 0.4582 | Val  Acc: 0.8696
 Site-usa                       (1) | Val  Loss: 0.5515 | Val  Acc: 0.8174
 Site-usa                       (0) | Val  Loss: 0.5165 | Val  Acc: 0.8612
 Site-usa                       (1) | Val  Loss: 0.5335 | Val  Acc: 0.8449
 Site-asia                      (0) | Val  Loss: 0.9398 | Val  Acc: 0.6771
 Site-asia                      (0) | Val  Loss: 1.0240 | Val  Acc: 0.6406
Average Valid Accuracy: 0.7851
 Best site-usa                      (1)  | Epoch:20 | Val Acc: 0.8696
 Best site-usa                      (1)  | Epoch:20 | Val Acc: 0.8174
 Best site-usa                      (0)  | Epoch:20 | Val Acc: 0.8612
 Best site-usa                      (1)  | Epoch:20 | Val Acc: 0.8449
 Best site-asia                     (0)  | Epoch:20 | Val Acc: 0.6771
 Best site-asia                     (0)  | Epoch:20 | Val Acc: 0.6406
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 4, ]
cnt=[1, 5, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-usa                       (1) | Train Loss: 0.7117 | Train Acc: 0.7558
 Site-usa                       (1) | Train Loss: 0.7144 | Train Acc: 0.7681
 Site-usa                       (1) | Train Loss: 0.6568 | Train Acc: 0.7916
 Site-usa                       (1) | Train Loss: 0.6215 | Train Acc: 0.8097
 Site-asia                      (0) | Train Loss: 0.9283 | Train Acc: 0.6968
 Site-asia                      (0) | Train Loss: 0.9187 | Train Acc: 0.6863
Average Train Accuracy: 0.7514
 Site-usa                       (1) | Val  Loss: 0.5488 | Val  Acc: 0.8348
 Site-usa                       (1) | Val  Loss: 0.6430 | Val  Acc: 0.8043
 Site-usa                       (1) | Val  Loss: 0.5804 | Val  Acc: 0.8243
 Site-usa                       (1) | Val  Loss: 0.6727 | Val  Acc: 0.7852
 Site-asia                      (0) | Val  Loss: 0.8595 | Val  Acc: 0.6667
 Site-asia                      (0) | Val  Loss: 0.9058 | Val  Acc: 0.6823
Average Valid Accuracy: 0.7663
============ Train epoch 22 ============
cnt=[4, 2, ]
cnt=[1, 5, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-usa                       (0) | Train Loss: 0.6528 | Train Acc: 0.7965
 Site-usa                       (1) | Train Loss: 0.5586 | Train Acc: 0.8203
 Site-usa                       (0) | Train Loss: 0.5054 | Train Acc: 0.8408
 Site-usa                       (0) | Train Loss: 0.4892 | Train Acc: 0.8575
 Site-asia                      (0) | Train Loss: 1.1142 | Train Acc: 0.6343
 Site-asia                      (1) | Train Loss: 1.0129 | Train Acc: 0.6632
Average Train Accuracy: 0.7688
 Site-usa                       (0) | Val  Loss: 0.3765 | Val  Acc: 0.8609
 Site-usa                       (1) | Val  Loss: 0.4839 | Val  Acc: 0.8696
 Site-usa                       (0) | Val  Loss: 0.4313 | Val  Acc: 0.8850
 Site-usa                       (0) | Val  Loss: 0.5336 | Val  Acc: 0.8427
 Site-asia                      (0) | Val  Loss: 0.9871 | Val  Acc: 0.6493
 Site-asia                      (1) | Val  Loss: 1.0531 | Val  Acc: 0.6493
Average Valid Accuracy: 0.7928
 Best site-usa                      (0)  | Epoch:22 | Val Acc: 0.8609
 Best site-usa                      (1)  | Epoch:22 | Val Acc: 0.8696
 Best site-usa                      (0)  | Epoch:22 | Val Acc: 0.8850
 Best site-usa                      (0)  | Epoch:22 | Val Acc: 0.8427
 Best site-asia                     (0)  | Epoch:22 | Val Acc: 0.6493
 Best site-asia                     (1)  | Epoch:22 | Val Acc: 0.6493
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 23 ============
cnt=[5, 1, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-usa                       (0) | Train Loss: 0.6957 | Train Acc: 0.7674
 Site-usa                       (0) | Train Loss: 0.6283 | Train Acc: 0.8058
 Site-usa                       (0) | Train Loss: 0.5862 | Train Acc: 0.8162
 Site-usa                       (0) | Train Loss: 0.5762 | Train Acc: 0.8213
 Site-asia                      (0) | Train Loss: 0.9759 | Train Acc: 0.6528
 Site-asia                      (1) | Train Loss: 0.9051 | Train Acc: 0.6921
Average Train Accuracy: 0.7593
 Site-usa                       (0) | Val  Loss: 0.5225 | Val  Acc: 0.8435
 Site-usa                       (0) | Val  Loss: 0.5870 | Val  Acc: 0.8130
 Site-usa                       (0) | Val  Loss: 0.5040 | Val  Acc: 0.8482
 Site-usa                       (0) | Val  Loss: 0.6025 | Val  Acc: 0.8145
 Site-asia                      (0) | Val  Loss: 0.8781 | Val  Acc: 0.6979
 Site-asia                      (1) | Val  Loss: 0.9141 | Val  Acc: 0.6875
Average Valid Accuracy: 0.7841
============ Train epoch 24 ============
cnt=[2, 4, ]
cnt=[3, 3, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-usa                       (0) | Train Loss: 0.6709 | Train Acc: 0.7674
 Site-usa                       (1) | Train Loss: 0.5510 | Train Acc: 0.8174
 Site-usa                       (1) | Train Loss: 0.5195 | Train Acc: 0.8278
 Site-usa                       (1) | Train Loss: 0.5024 | Train Acc: 0.8444
 Site-asia                      (0) | Train Loss: 1.0471 | Train Acc: 0.6505
 Site-asia                      (1) | Train Loss: 0.9735 | Train Acc: 0.6852
Average Train Accuracy: 0.7654
 Site-usa                       (0) | Val  Loss: 0.4510 | Val  Acc: 0.8609
 Site-usa                       (1) | Val  Loss: 0.5024 | Val  Acc: 0.8217
 Site-usa                       (1) | Val  Loss: 0.5448 | Val  Acc: 0.8351
 Site-usa                       (1) | Val  Loss: 0.5655 | Val  Acc: 0.8243
 Site-asia                      (0) | Val  Loss: 0.9712 | Val  Acc: 0.6875
 Site-asia                      (1) | Val  Loss: 0.9541 | Val  Acc: 0.6684
Average Valid Accuracy: 0.7830
============ Train epoch 25 ============
cnt=[5, 1, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-usa                       (0) | Train Loss: 0.6357 | Train Acc: 0.8023
 Site-usa                       (0) | Train Loss: 0.6146 | Train Acc: 0.8000
 Site-usa                       (0) | Train Loss: 0.5286 | Train Acc: 0.8480
 Site-usa                       (0) | Train Loss: 0.5510 | Train Acc: 0.8357
 Site-asia                      (1) | Train Loss: 1.0184 | Train Acc: 0.6435
 Site-asia                      (0) | Train Loss: 0.9249 | Train Acc: 0.6806
Average Train Accuracy: 0.7684
 Site-usa                       (0) | Val  Loss: 0.5099 | Val  Acc: 0.8174
 Site-usa                       (0) | Val  Loss: 0.5061 | Val  Acc: 0.8217
 Site-usa                       (0) | Val  Loss: 0.5840 | Val  Acc: 0.8308
 Site-usa                       (0) | Val  Loss: 0.5542 | Val  Acc: 0.8221
 Site-asia                      (1) | Val  Loss: 0.8941 | Val  Acc: 0.7222
 Site-asia                      (0) | Val  Loss: 0.9097 | Val  Acc: 0.6684
Average Valid Accuracy: 0.7804
============ Train epoch 26 ============
cnt=[5, 1, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-usa                       (0) | Train Loss: 0.6061 | Train Acc: 0.7849
 Site-usa                       (0) | Train Loss: 0.5929 | Train Acc: 0.7739
 Site-usa                       (0) | Train Loss: 0.5472 | Train Acc: 0.8249
 Site-usa                       (1) | Train Loss: 0.5355 | Train Acc: 0.8292
 Site-asia                      (0) | Train Loss: 1.0491 | Train Acc: 0.6296
 Site-asia                      (0) | Train Loss: 0.9617 | Train Acc: 0.6690
Average Train Accuracy: 0.7519
 Site-usa                       (0) | Val  Loss: 0.4544 | Val  Acc: 0.8522
 Site-usa                       (0) | Val  Loss: 0.5045 | Val  Acc: 0.8304
 Site-usa                       (0) | Val  Loss: 0.4995 | Val  Acc: 0.8503
 Site-usa                       (1) | Val  Loss: 0.5415 | Val  Acc: 0.8297
 Site-asia                      (0) | Val  Loss: 0.8775 | Val  Acc: 0.6944
 Site-asia                      (0) | Val  Loss: 0.9554 | Val  Acc: 0.6701
Average Valid Accuracy: 0.7879
============ Train epoch 27 ============
cnt=[3, 3, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-usa                       (0) | Train Loss: 0.6355 | Train Acc: 0.7733
 Site-usa                       (0) | Train Loss: 0.6824 | Train Acc: 0.7739
 Site-usa                       (1) | Train Loss: 0.5791 | Train Acc: 0.8249
 Site-usa                       (0) | Train Loss: 0.5375 | Train Acc: 0.8307
 Site-asia                      (1) | Train Loss: 1.0042 | Train Acc: 0.6690
 Site-asia                      (1) | Train Loss: 0.8802 | Train Acc: 0.7106
Average Train Accuracy: 0.7637
 Site-usa                       (0) | Val  Loss: 0.4468 | Val  Acc: 0.8783
 Site-usa                       (0) | Val  Loss: 0.5355 | Val  Acc: 0.8087
 Site-usa                       (1) | Val  Loss: 0.5542 | Val  Acc: 0.8395
 Site-usa                       (0) | Val  Loss: 0.5779 | Val  Acc: 0.8189
 Site-asia                      (1) | Val  Loss: 0.8596 | Val  Acc: 0.7083
 Site-asia                      (1) | Val  Loss: 0.8986 | Val  Acc: 0.7170
Average Valid Accuracy: 0.7951
 Best site-usa                      (0)  | Epoch:27 | Val Acc: 0.8783
 Best site-usa                      (0)  | Epoch:27 | Val Acc: 0.8087
 Best site-usa                      (1)  | Epoch:27 | Val Acc: 0.8395
 Best site-usa                      (0)  | Epoch:27 | Val Acc: 0.8189
 Best site-asia                     (1)  | Epoch:27 | Val Acc: 0.7083
 Best site-asia                     (1)  | Epoch:27 | Val Acc: 0.7170
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 28 ============
cnt=[3, 3, ]
cnt=[1, 5, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-usa                       (1) | Train Loss: 0.6662 | Train Acc: 0.7849
 Site-usa                       (1) | Train Loss: 0.5521 | Train Acc: 0.8029
 Site-usa                       (1) | Train Loss: 0.5300 | Train Acc: 0.8292
 Site-usa                       (0) | Train Loss: 0.5129 | Train Acc: 0.8372
 Site-asia                      (0) | Train Loss: 1.0187 | Train Acc: 0.6481
 Site-asia                      (0) | Train Loss: 0.9687 | Train Acc: 0.6759
Average Train Accuracy: 0.7630
 Site-usa                       (1) | Val  Loss: 0.4846 | Val  Acc: 0.8348
 Site-usa                       (1) | Val  Loss: 0.5303 | Val  Acc: 0.8000
 Site-usa                       (1) | Val  Loss: 0.4581 | Val  Acc: 0.8460
 Site-usa                       (0) | Val  Loss: 0.5153 | Val  Acc: 0.8362
 Site-asia                      (0) | Val  Loss: 0.8997 | Val  Acc: 0.7222
 Site-asia                      (0) | Val  Loss: 0.9992 | Val  Acc: 0.6701
Average Valid Accuracy: 0.7849
============ Train epoch 29 ============
cnt=[3, 3, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-usa                       (0) | Train Loss: 0.6557 | Train Acc: 0.7384
 Site-usa                       (1) | Train Loss: 0.6151 | Train Acc: 0.7971
 Site-usa                       (0) | Train Loss: 0.5328 | Train Acc: 0.8394
 Site-usa                       (0) | Train Loss: 0.5671 | Train Acc: 0.8249
 Site-asia                      (1) | Train Loss: 0.9993 | Train Acc: 0.6690
 Site-asia                      (1) | Train Loss: 0.8707 | Train Acc: 0.7106
Average Train Accuracy: 0.7632
 Site-usa                       (0) | Val  Loss: 0.5034 | Val  Acc: 0.8609
 Site-usa                       (1) | Val  Loss: 0.6009 | Val  Acc: 0.7826
 Site-usa                       (0) | Val  Loss: 0.5449 | Val  Acc: 0.8482
 Site-usa                       (0) | Val  Loss: 0.5507 | Val  Acc: 0.8308
 Site-asia                      (1) | Val  Loss: 0.8931 | Val  Acc: 0.6979
 Site-asia                      (1) | Val  Loss: 0.8688 | Val  Acc: 0.7118
Average Valid Accuracy: 0.7887
 Test site-usa                       (0)| Epoch:27 | Test Acc: 0.8849
 Test site-asia                      (1)| Epoch:27 | Test Acc: 0.8027
usa: 0.8849, asia: 0.8027, 
Average Test Accuracy(group): 0.8438, Average Test Accuracy(individual): 0.8575,
domain std=0.0411, cluster std=0.0274, individual std=0.0387, 
============ Train epoch 30 ============
cnt=[4, 2, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-usa                       (0) | Train Loss: 0.7217 | Train Acc: 0.7849
 Site-usa                       (0) | Train Loss: 0.6400 | Train Acc: 0.7884
 Site-usa                       (0) | Train Loss: 0.5434 | Train Acc: 0.8437
 Site-usa                       (0) | Train Loss: 0.5337 | Train Acc: 0.8263
 Site-asia                      (1) | Train Loss: 1.0079 | Train Acc: 0.6389
 Site-asia                      (1) | Train Loss: 0.8774 | Train Acc: 0.7025
Average Train Accuracy: 0.7641
 Site-usa                       (0) | Val  Loss: 0.4690 | Val  Acc: 0.8609
 Site-usa                       (0) | Val  Loss: 0.5678 | Val  Acc: 0.8174
 Site-usa                       (0) | Val  Loss: 0.5035 | Val  Acc: 0.8395
 Site-usa                       (0) | Val  Loss: 0.5681 | Val  Acc: 0.8221
 Site-asia                      (1) | Val  Loss: 0.8996 | Val  Acc: 0.6944
 Site-asia                      (1) | Val  Loss: 0.9023 | Val  Acc: 0.7014
Average Valid Accuracy: 0.7893
============ Train epoch 31 ============
cnt=[3, 3, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-usa                       (1) | Train Loss: 0.5795 | Train Acc: 0.8140
 Site-usa                       (1) | Train Loss: 0.5916 | Train Acc: 0.8203
 Site-usa                       (1) | Train Loss: 0.5297 | Train Acc: 0.8350
 Site-usa                       (0) | Train Loss: 0.4691 | Train Acc: 0.8582
 Site-asia                      (0) | Train Loss: 1.0768 | Train Acc: 0.6065
 Site-asia                      (0) | Train Loss: 0.9358 | Train Acc: 0.6968
Average Train Accuracy: 0.7718
 Site-usa                       (1) | Val  Loss: 0.4349 | Val  Acc: 0.8696
 Site-usa                       (1) | Val  Loss: 0.4752 | Val  Acc: 0.8217
 Site-usa                       (1) | Val  Loss: 0.4978 | Val  Acc: 0.8416
 Site-usa                       (0) | Val  Loss: 0.4960 | Val  Acc: 0.8460
 Site-asia                      (0) | Val  Loss: 0.8628 | Val  Acc: 0.6736
 Site-asia                      (0) | Val  Loss: 0.9797 | Val  Acc: 0.6701
Average Valid Accuracy: 0.7871
============ Train epoch 32 ============
cnt=[3, 3, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-usa                       (1) | Train Loss: 0.7742 | Train Acc: 0.7267
 Site-usa                       (0) | Train Loss: 0.6897 | Train Acc: 0.7768
 Site-usa                       (0) | Train Loss: 0.6166 | Train Acc: 0.8003
 Site-usa                       (0) | Train Loss: 0.6011 | Train Acc: 0.8119
 Site-asia                      (1) | Train Loss: 0.9170 | Train Acc: 0.6690
 Site-asia                      (1) | Train Loss: 0.8262 | Train Acc: 0.7245
Average Train Accuracy: 0.7515
 Site-usa                       (1) | Val  Loss: 0.4963 | Val  Acc: 0.8435
 Site-usa                       (0) | Val  Loss: 0.6357 | Val  Acc: 0.8000
 Site-usa                       (0) | Val  Loss: 0.5455 | Val  Acc: 0.8243
 Site-usa                       (0) | Val  Loss: 0.6375 | Val  Acc: 0.7820
 Site-asia                      (1) | Val  Loss: 0.7956 | Val  Acc: 0.7222
 Site-asia                      (1) | Val  Loss: 0.8347 | Val  Acc: 0.7240
Average Valid Accuracy: 0.7827
============ Train epoch 33 ============
cnt=[2, 4, ]
cnt=[3, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-usa                       (1) | Train Loss: 0.5987 | Train Acc: 0.7849
 Site-usa                       (0) | Train Loss: 0.6006 | Train Acc: 0.8087
 Site-usa                       (1) | Train Loss: 0.4872 | Train Acc: 0.8480
 Site-usa                       (0) | Train Loss: 0.4756 | Train Acc: 0.8611
 Site-asia                      (1) | Train Loss: 1.0100 | Train Acc: 0.6597
 Site-asia                      (1) | Train Loss: 0.9461 | Train Acc: 0.6921
Average Train Accuracy: 0.7758
 Site-usa                       (1) | Val  Loss: 0.3898 | Val  Acc: 0.8870
 Site-usa                       (0) | Val  Loss: 0.4447 | Val  Acc: 0.8348
 Site-usa                       (1) | Val  Loss: 0.4272 | Val  Acc: 0.8742
 Site-usa                       (0) | Val  Loss: 0.4912 | Val  Acc: 0.8514
 Site-asia                      (1) | Val  Loss: 0.8851 | Val  Acc: 0.7014
 Site-asia                      (1) | Val  Loss: 0.9831 | Val  Acc: 0.6858
Average Valid Accuracy: 0.8057
 Best site-usa                      (1)  | Epoch:33 | Val Acc: 0.8870
 Best site-usa                      (0)  | Epoch:33 | Val Acc: 0.8348
 Best site-usa                      (1)  | Epoch:33 | Val Acc: 0.8742
 Best site-usa                      (0)  | Epoch:33 | Val Acc: 0.8514
 Best site-asia                     (1)  | Epoch:33 | Val Acc: 0.7014
 Best site-asia                     (1)  | Epoch:33 | Val Acc: 0.6858
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 5, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-usa                       (0) | Train Loss: 0.5874 | Train Acc: 0.8023
 Site-usa                       (1) | Train Loss: 0.5915 | Train Acc: 0.8174
 Site-usa                       (1) | Train Loss: 0.5059 | Train Acc: 0.8365
 Site-usa                       (1) | Train Loss: 0.4929 | Train Acc: 0.8509
 Site-asia                      (1) | Train Loss: 0.9818 | Train Acc: 0.6551
 Site-asia                      (1) | Train Loss: 0.9089 | Train Acc: 0.6944
Average Train Accuracy: 0.7761
 Site-usa                       (0) | Val  Loss: 0.3696 | Val  Acc: 0.8870
 Site-usa                       (1) | Val  Loss: 0.4719 | Val  Acc: 0.8435
 Site-usa                       (1) | Val  Loss: 0.5019 | Val  Acc: 0.8438
 Site-usa                       (1) | Val  Loss: 0.5123 | Val  Acc: 0.8395
 Site-asia                      (1) | Val  Loss: 0.9231 | Val  Acc: 0.6562
 Site-asia                      (1) | Val  Loss: 0.9145 | Val  Acc: 0.6719
Average Valid Accuracy: 0.7903
============ Train epoch 35 ============
cnt=[5, 1, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-usa                       (0) | Train Loss: 0.6623 | Train Acc: 0.7965
 Site-usa                       (0) | Train Loss: 0.5607 | Train Acc: 0.8058
 Site-usa                       (0) | Train Loss: 0.5481 | Train Acc: 0.8350
 Site-usa                       (0) | Train Loss: 0.4984 | Train Acc: 0.8423
 Site-asia                      (1) | Train Loss: 0.9673 | Train Acc: 0.6644
 Site-asia                      (0) | Train Loss: 0.9100 | Train Acc: 0.7106
Average Train Accuracy: 0.7758
 Site-usa                       (0) | Val  Loss: 0.4455 | Val  Acc: 0.8522
 Site-usa                       (0) | Val  Loss: 0.5350 | Val  Acc: 0.8130
 Site-usa                       (0) | Val  Loss: 0.5076 | Val  Acc: 0.8416
 Site-usa                       (0) | Val  Loss: 0.5378 | Val  Acc: 0.8330
 Site-asia                      (1) | Val  Loss: 0.8493 | Val  Acc: 0.6806
 Site-asia                      (0) | Val  Loss: 0.8698 | Val  Acc: 0.7118
Average Valid Accuracy: 0.7887
============ Train epoch 36 ============
cnt=[2, 4, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-usa                       (1) | Train Loss: 0.6827 | Train Acc: 0.7965
 Site-usa                       (1) | Train Loss: 0.5807 | Train Acc: 0.8116
 Site-usa                       (1) | Train Loss: 0.5516 | Train Acc: 0.8292
 Site-usa                       (1) | Train Loss: 0.5122 | Train Acc: 0.8437
 Site-asia                      (0) | Train Loss: 0.9476 | Train Acc: 0.6782
 Site-asia                      (0) | Train Loss: 0.8568 | Train Acc: 0.7176
Average Train Accuracy: 0.7795
 Site-usa                       (1) | Val  Loss: 0.4662 | Val  Acc: 0.8609
 Site-usa                       (1) | Val  Loss: 0.5839 | Val  Acc: 0.8435
 Site-usa                       (1) | Val  Loss: 0.5159 | Val  Acc: 0.8482
 Site-usa                       (1) | Val  Loss: 0.5188 | Val  Acc: 0.8351
 Site-asia                      (0) | Val  Loss: 0.7884 | Val  Acc: 0.7292
 Site-asia                      (0) | Val  Loss: 0.8599 | Val  Acc: 0.7396
Average Valid Accuracy: 0.8094
 Best site-usa                      (1)  | Epoch:36 | Val Acc: 0.8609
 Best site-usa                      (1)  | Epoch:36 | Val Acc: 0.8435
 Best site-usa                      (1)  | Epoch:36 | Val Acc: 0.8482
 Best site-usa                      (1)  | Epoch:36 | Val Acc: 0.8351
 Best site-asia                     (0)  | Epoch:36 | Val Acc: 0.7292
 Best site-asia                     (0)  | Epoch:36 | Val Acc: 0.7396
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 37 ============
cnt=[4, 2, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-usa                       (1) | Train Loss: 0.5666 | Train Acc: 0.8023
 Site-usa                       (1) | Train Loss: 0.5329 | Train Acc: 0.8232
 Site-usa                       (0) | Train Loss: 0.5089 | Train Acc: 0.8321
 Site-usa                       (0) | Train Loss: 0.4389 | Train Acc: 0.8640
 Site-asia                      (0) | Train Loss: 1.0270 | Train Acc: 0.6412
 Site-asia                      (0) | Train Loss: 0.8842 | Train Acc: 0.7118
Average Train Accuracy: 0.7791
 Site-usa                       (1) | Val  Loss: 0.4948 | Val  Acc: 0.8261
 Site-usa                       (1) | Val  Loss: 0.4465 | Val  Acc: 0.8783
 Site-usa                       (0) | Val  Loss: 0.4808 | Val  Acc: 0.8633
 Site-usa                       (0) | Val  Loss: 0.4900 | Val  Acc: 0.8514
 Site-asia                      (0) | Val  Loss: 0.8685 | Val  Acc: 0.6840
 Site-asia                      (0) | Val  Loss: 0.8942 | Val  Acc: 0.7014
Average Valid Accuracy: 0.8008
============ Train epoch 38 ============
cnt=[4, 2, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-usa                       (0) | Train Loss: 0.7422 | Train Acc: 0.7500
 Site-usa                       (0) | Train Loss: 0.6785 | Train Acc: 0.7652
 Site-usa                       (0) | Train Loss: 0.5821 | Train Acc: 0.8234
 Site-usa                       (0) | Train Loss: 0.5596 | Train Acc: 0.8307
 Site-asia                      (1) | Train Loss: 0.9483 | Train Acc: 0.6644
 Site-asia                      (1) | Train Loss: 0.7883 | Train Acc: 0.7350
Average Train Accuracy: 0.7614
 Site-usa                       (0) | Val  Loss: 0.5486 | Val  Acc: 0.8348
 Site-usa                       (0) | Val  Loss: 0.5660 | Val  Acc: 0.8217
 Site-usa                       (0) | Val  Loss: 0.5680 | Val  Acc: 0.8330
 Site-usa                       (0) | Val  Loss: 0.6059 | Val  Acc: 0.8102
 Site-asia                      (1) | Val  Loss: 0.8309 | Val  Acc: 0.7292
 Site-asia                      (1) | Val  Loss: 0.8125 | Val  Acc: 0.7153
Average Valid Accuracy: 0.7907
============ Train epoch 39 ============
cnt=[3, 3, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-usa                       (0) | Train Loss: 0.5189 | Train Acc: 0.8140
 Site-usa                       (0) | Train Loss: 0.5423 | Train Acc: 0.8464
 Site-usa                       (1) | Train Loss: 0.4402 | Train Acc: 0.8726
 Site-usa                       (0) | Train Loss: 0.4404 | Train Acc: 0.8690
 Site-asia                      (1) | Train Loss: 1.1337 | Train Acc: 0.6019
 Site-asia                      (1) | Train Loss: 0.9447 | Train Acc: 0.6875
Average Train Accuracy: 0.7819
 Site-usa                       (0) | Val  Loss: 0.3946 | Val  Acc: 0.8870
 Site-usa                       (0) | Val  Loss: 0.4222 | Val  Acc: 0.8783
 Site-usa                       (1) | Val  Loss: 0.3981 | Val  Acc: 0.8785
 Site-usa                       (0) | Val  Loss: 0.4656 | Val  Acc: 0.8492
 Site-asia                      (1) | Val  Loss: 0.8843 | Val  Acc: 0.6806
 Site-asia                      (1) | Val  Loss: 0.8732 | Val  Acc: 0.7170
Average Valid Accuracy: 0.8151
 Best site-usa                      (0)  | Epoch:39 | Val Acc: 0.8870
 Best site-usa                      (0)  | Epoch:39 | Val Acc: 0.8783
 Best site-usa                      (1)  | Epoch:39 | Val Acc: 0.8785
 Best site-usa                      (0)  | Epoch:39 | Val Acc: 0.8492
 Best site-asia                     (1)  | Epoch:39 | Val Acc: 0.6806
 Best site-asia                     (1)  | Epoch:39 | Val Acc: 0.7170
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Test site-usa                       (0)| Epoch:39 | Test Acc: 0.8827
 Test site-asia                      (1)| Epoch:39 | Test Acc: 0.8296
usa: 0.8827, asia: 0.8296, 
Average Test Accuracy(group): 0.8561, Average Test Accuracy(individual): 0.8650,
domain std=0.0266, cluster std=0.0177, individual std=0.0250, 
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 40 ============
cnt=[4, 2, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-usa                       (0) | Train Loss: 0.7939 | Train Acc: 0.7500
 Site-usa                       (0) | Train Loss: 0.7112 | Train Acc: 0.7768
 Site-usa                       (0) | Train Loss: 0.6175 | Train Acc: 0.7858
 Site-usa                       (0) | Train Loss: 0.6176 | Train Acc: 0.7952
 Site-asia                      (1) | Train Loss: 0.8791 | Train Acc: 0.6875
 Site-asia                      (1) | Train Loss: 0.7772 | Train Acc: 0.7477
Average Train Accuracy: 0.7572
 Site-usa                       (0) | Val  Loss: 0.5429 | Val  Acc: 0.8174
 Site-usa                       (0) | Val  Loss: 0.6462 | Val  Acc: 0.7696
 Site-usa                       (0) | Val  Loss: 0.6137 | Val  Acc: 0.8265
 Site-usa                       (0) | Val  Loss: 0.6210 | Val  Acc: 0.7939
 Site-asia                      (1) | Val  Loss: 0.7709 | Val  Acc: 0.7257
 Site-asia                      (1) | Val  Loss: 0.8112 | Val  Acc: 0.7309
Average Valid Accuracy: 0.7773
 Test site-usa                       (0)| Epoch:39 | Test Acc: 0.8717
 Test site-asia                      (1)| Epoch:39 | Test Acc: 0.7842
usa: 0.8717, asia: 0.7842, 
Average Test Accuracy(group): 0.8280, Average Test Accuracy(individual): 0.8425,
domain std=0.0438, cluster std=0.0438, individual std=0.0413, 
Average Test Accuracy: 0.8280
============ Train epoch 41 ============
cnt=[4, 2, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-usa                       (0) | Train Loss: 0.5665 | Train Acc: 0.7849
 Site-usa                       (0) | Train Loss: 0.5521 | Train Acc: 0.8000
 Site-usa                       (1) | Train Loss: 0.4515 | Train Acc: 0.8683
 Site-usa                       (0) | Train Loss: 0.4336 | Train Acc: 0.8632
 Site-asia                      (1) | Train Loss: 1.0549 | Train Acc: 0.6505
 Site-asia                      (0) | Train Loss: 0.9386 | Train Acc: 0.6690
Average Train Accuracy: 0.7726
 Site-usa                       (0) | Val  Loss: 0.3560 | Val  Acc: 0.8870
 Site-usa                       (0) | Val  Loss: 0.4224 | Val  Acc: 0.8826
 Site-usa                       (1) | Val  Loss: 0.3587 | Val  Acc: 0.8959
 Site-usa                       (0) | Val  Loss: 0.4778 | Val  Acc: 0.8492
 Site-asia                      (1) | Val  Loss: 0.9286 | Val  Acc: 0.6632
 Site-asia                      (0) | Val  Loss: 0.9222 | Val  Acc: 0.6858
Average Valid Accuracy: 0.8106
 Test site-usa                       (0)| Epoch:39 | Test Acc: 0.8816
 Test site-asia                      (1)| Epoch:39 | Test Acc: 0.8296
usa: 0.8816, asia: 0.8296, 
Average Test Accuracy(group): 0.8556, Average Test Accuracy(individual): 0.8642,
domain std=0.0260, cluster std=0.0065, individual std=0.0245, 
Average Test Accuracy: 0.8556
============ Train epoch 42 ============
cnt=[3, 3, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-usa                       (0) | Train Loss: 0.7298 | Train Acc: 0.7616
 Site-usa                       (1) | Train Loss: 0.6421 | Train Acc: 0.7768
 Site-usa                       (0) | Train Loss: 0.6102 | Train Acc: 0.8191
 Site-usa                       (0) | Train Loss: 0.5377 | Train Acc: 0.8357
 Site-asia                      (1) | Train Loss: 0.9410 | Train Acc: 0.6644
 Site-asia                      (1) | Train Loss: 0.8088 | Train Acc: 0.7292
Average Train Accuracy: 0.7645
 Site-usa                       (0) | Val  Loss: 0.5552 | Val  Acc: 0.8348
 Site-usa                       (1) | Val  Loss: 0.5129 | Val  Acc: 0.8217
 Site-usa                       (0) | Val  Loss: 0.4985 | Val  Acc: 0.8351
 Site-usa                       (0) | Val  Loss: 0.5721 | Val  Acc: 0.8286
 Site-asia                      (1) | Val  Loss: 0.7741 | Val  Acc: 0.7326
 Site-asia                      (1) | Val  Loss: 0.8047 | Val  Acc: 0.7413
Average Valid Accuracy: 0.7990
 Test site-usa                       (0)| Epoch:39 | Test Acc: 0.8761
 Test site-asia                      (1)| Epoch:39 | Test Acc: 0.8000
usa: 0.8761, asia: 0.8000, 
Average Test Accuracy(group): 0.8380, Average Test Accuracy(individual): 0.8507,
domain std=0.0380, cluster std=0.0254, individual std=0.0359, 
Average Test Accuracy: 0.8380
============ Train epoch 43 ============
cnt=[2, 4, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-usa                       (1) | Train Loss: 0.6411 | Train Acc: 0.7849
 Site-usa                       (0) | Train Loss: 0.6034 | Train Acc: 0.8232
 Site-usa                       (1) | Train Loss: 0.5130 | Train Acc: 0.8423
 Site-usa                       (0) | Train Loss: 0.4717 | Train Acc: 0.8560
 Site-asia                      (1) | Train Loss: 0.9712 | Train Acc: 0.6713
 Site-asia                      (1) | Train Loss: 0.8717 | Train Acc: 0.7118
Average Train Accuracy: 0.7816
 Site-usa                       (1) | Val  Loss: 0.3850 | Val  Acc: 0.9130
 Site-usa                       (0) | Val  Loss: 0.4831 | Val  Acc: 0.8478
 Site-usa                       (1) | Val  Loss: 0.4735 | Val  Acc: 0.8655
 Site-usa                       (0) | Val  Loss: 0.4983 | Val  Acc: 0.8406
 Site-asia                      (1) | Val  Loss: 0.8293 | Val  Acc: 0.7257
 Site-asia                      (1) | Val  Loss: 0.8548 | Val  Acc: 0.7014
Average Valid Accuracy: 0.8157
 Best site-usa                      (1)  | Epoch:43 | Val Acc: 0.9130
 Best site-usa                      (0)  | Epoch:43 | Val Acc: 0.8478
 Best site-usa                      (1)  | Epoch:43 | Val Acc: 0.8655
 Best site-usa                      (0)  | Epoch:43 | Val Acc: 0.8406
 Best site-asia                     (1)  | Epoch:43 | Val Acc: 0.7257
 Best site-asia                     (1)  | Epoch:43 | Val Acc: 0.7014
 Test site-usa                       (1)| Epoch:43 | Test Acc: 0.8827
 Test site-asia                      (1)| Epoch:43 | Test Acc: 0.8302
usa: 0.8827, asia: 0.8302, 
Average Test Accuracy(group): 0.8565, Average Test Accuracy(individual): 0.8652,
domain std=0.0262, cluster std=0.0131, individual std=0.0247, 
Average Test Accuracy: 0.8565
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 44 ============
cnt=[4, 2, ]
cnt=[1, 5, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-usa                       (1) | Train Loss: 0.6400 | Train Acc: 0.7965
 Site-usa                       (0) | Train Loss: 0.5722 | Train Acc: 0.8203
 Site-usa                       (0) | Train Loss: 0.5001 | Train Acc: 0.8611
 Site-usa                       (1) | Train Loss: 0.4724 | Train Acc: 0.8596
 Site-asia                      (0) | Train Loss: 0.9424 | Train Acc: 0.6620
 Site-asia                      (0) | Train Loss: 0.8428 | Train Acc: 0.7280
Average Train Accuracy: 0.7879
 Site-usa                       (1) | Val  Loss: 0.4322 | Val  Acc: 0.8783
 Site-usa                       (0) | Val  Loss: 0.5468 | Val  Acc: 0.8043
 Site-usa                       (0) | Val  Loss: 0.4227 | Val  Acc: 0.8720
 Site-usa                       (1) | Val  Loss: 0.5388 | Val  Acc: 0.8232
 Site-asia                      (0) | Val  Loss: 0.8470 | Val  Acc: 0.7222
 Site-asia                      (0) | Val  Loss: 0.8187 | Val  Acc: 0.7361
Average Valid Accuracy: 0.8060
 Test site-usa                       (1)| Epoch:43 | Test Acc: 0.8794
 Test site-asia                      (0)| Epoch:43 | Test Acc: 0.8199
usa: 0.8794, asia: 0.8199, 
Average Test Accuracy(group): 0.8497, Average Test Accuracy(individual): 0.8596,
domain std=0.0297, cluster std=0.0149, individual std=0.0280, 
Average Test Accuracy: 0.8497
============ Train epoch 45 ============
cnt=[2, 4, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-usa                       (1) | Train Loss: 0.6051 | Train Acc: 0.8081
 Site-usa                       (1) | Train Loss: 0.5892 | Train Acc: 0.8058
 Site-usa                       (1) | Train Loss: 0.5260 | Train Acc: 0.8292
 Site-usa                       (1) | Train Loss: 0.5255 | Train Acc: 0.8307
 Site-asia                      (0) | Train Loss: 0.8866 | Train Acc: 0.6968
 Site-asia                      (0) | Train Loss: 0.8071 | Train Acc: 0.7211
Average Train Accuracy: 0.7819
 Site-usa                       (1) | Val  Loss: 0.4642 | Val  Acc: 0.8348
 Site-usa                       (1) | Val  Loss: 0.4343 | Val  Acc: 0.8478
 Site-usa                       (1) | Val  Loss: 0.5105 | Val  Acc: 0.8416
 Site-usa                       (1) | Val  Loss: 0.5503 | Val  Acc: 0.8232
 Site-asia                      (0) | Val  Loss: 0.7863 | Val  Acc: 0.7431
 Site-asia                      (0) | Val  Loss: 0.8130 | Val  Acc: 0.7396
Average Valid Accuracy: 0.8050
 Test site-usa                       (1)| Epoch:43 | Test Acc: 0.8783
 Test site-asia                      (0)| Epoch:43 | Test Acc: 0.8089
usa: 0.8783, asia: 0.8089, 
Average Test Accuracy(group): 0.8436, Average Test Accuracy(individual): 0.8552,
domain std=0.0347, cluster std=0.0347, individual std=0.0327, 
Average Test Accuracy: 0.8436
============ Train epoch 46 ============
cnt=[4, 2, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-usa                       (0) | Train Loss: 0.5126 | Train Acc: 0.8372
 Site-usa                       (0) | Train Loss: 0.5220 | Train Acc: 0.8232
 Site-usa                       (0) | Train Loss: 0.4392 | Train Acc: 0.8712
 Site-usa                       (1) | Train Loss: 0.4269 | Train Acc: 0.8726
 Site-asia                      (1) | Train Loss: 1.0315 | Train Acc: 0.6551
 Site-asia                      (0) | Train Loss: 0.9008 | Train Acc: 0.6852
Average Train Accuracy: 0.7908
 Site-usa                       (0) | Val  Loss: 0.3462 | Val  Acc: 0.9043
 Site-usa                       (0) | Val  Loss: 0.4253 | Val  Acc: 0.8565
 Site-usa                       (0) | Val  Loss: 0.3866 | Val  Acc: 0.8742
 Site-usa                       (1) | Val  Loss: 0.4837 | Val  Acc: 0.8438
 Site-asia                      (1) | Val  Loss: 0.8771 | Val  Acc: 0.6875
 Site-asia                      (0) | Val  Loss: 0.9061 | Val  Acc: 0.7083
Average Valid Accuracy: 0.8125
 Test site-usa                       (0)| Epoch:43 | Test Acc: 0.8827
 Test site-asia                      (1)| Epoch:43 | Test Acc: 0.8275
usa: 0.8827, asia: 0.8275, 
Average Test Accuracy(group): 0.8551, Average Test Accuracy(individual): 0.8643,
domain std=0.0276, cluster std=0.0069, individual std=0.0260, 
Average Test Accuracy: 0.8551
============ Train epoch 47 ============
cnt=[4, 2, ]
cnt=[5, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-usa                       (0) | Train Loss: 0.7505 | Train Acc: 0.7442
 Site-usa                       (0) | Train Loss: 0.6985 | Train Acc: 0.7710
 Site-usa                       (0) | Train Loss: 0.6260 | Train Acc: 0.8032
 Site-usa                       (0) | Train Loss: 0.6036 | Train Acc: 0.8032
 Site-asia                      (1) | Train Loss: 0.8625 | Train Acc: 0.7106
 Site-asia                      (1) | Train Loss: 0.7914 | Train Acc: 0.7546
Average Train Accuracy: 0.7645
 Site-usa                       (0) | Val  Loss: 0.5467 | Val  Acc: 0.7913
 Site-usa                       (0) | Val  Loss: 0.6136 | Val  Acc: 0.8087
 Site-usa                       (0) | Val  Loss: 0.5990 | Val  Acc: 0.8069
 Site-usa                       (0) | Val  Loss: 0.6003 | Val  Acc: 0.7896
 Site-asia                      (1) | Val  Loss: 0.7568 | Val  Acc: 0.7396
 Site-asia                      (1) | Val  Loss: 0.7912 | Val  Acc: 0.7413
Average Valid Accuracy: 0.7796
 Test site-usa                       (0)| Epoch:43 | Test Acc: 0.8673
 Test site-asia                      (1)| Epoch:43 | Test Acc: 0.7918
usa: 0.8673, asia: 0.7918, 
Average Test Accuracy(group): 0.8295, Average Test Accuracy(individual): 0.8421,
domain std=0.0378, cluster std=0.0378, individual std=0.0356, 
Average Test Accuracy: 0.8295
============ Train epoch 48 ============
cnt=[3, 3, ]
cnt=[2, 4, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-usa                       (1) | Train Loss: 0.5096 | Train Acc: 0.8663
 Site-usa                       (0) | Train Loss: 0.5198 | Train Acc: 0.8203
 Site-usa                       (1) | Train Loss: 0.4408 | Train Acc: 0.8712
 Site-usa                       (0) | Train Loss: 0.4417 | Train Acc: 0.8661
 Site-asia                      (1) | Train Loss: 1.0710 | Train Acc: 0.6227
 Site-asia                      (0) | Train Loss: 0.8922 | Train Acc: 0.7049
Average Train Accuracy: 0.7919
 Site-usa                       (1) | Val  Loss: 0.3517 | Val  Acc: 0.8783
 Site-usa                       (0) | Val  Loss: 0.4067 | Val  Acc: 0.8565
 Site-usa                       (1) | Val  Loss: 0.3702 | Val  Acc: 0.8785
 Site-usa                       (0) | Val  Loss: 0.4658 | Val  Acc: 0.8568
 Site-asia                      (1) | Val  Loss: 0.8661 | Val  Acc: 0.7049
 Site-asia                      (0) | Val  Loss: 0.8833 | Val  Acc: 0.6892
Average Valid Accuracy: 0.8107
 Test site-usa                       (1)| Epoch:43 | Test Acc: 0.8838
 Test site-asia                      (1)| Epoch:43 | Test Acc: 0.8316
usa: 0.8838, asia: 0.8316, 
Average Test Accuracy(group): 0.8577, Average Test Accuracy(individual): 0.8664,
domain std=0.0261, cluster std=0.0000, individual std=0.0246, 
Average Test Accuracy: 0.8577
 Saving the gmap checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/ccop_q=1...
============ Train epoch 49 ============
cnt=[5, 1, ]
cnt=[4, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-usa                       (0) | Train Loss: 0.6500 | Train Acc: 0.7965
 Site-usa                       (0) | Train Loss: 0.6546 | Train Acc: 0.7594
 Site-usa                       (0) | Train Loss: 0.4788 | Train Acc: 0.8509
 Site-usa                       (0) | Train Loss: 0.4723 | Train Acc: 0.8459
 Site-asia                      (0) | Train Loss: 0.9384 | Train Acc: 0.7060
 Site-asia                      (1) | Train Loss: 0.8251 | Train Acc: 0.7303
Average Train Accuracy: 0.7815
 Site-usa                       (0) | Val  Loss: 0.4174 | Val  Acc: 0.8609
 Site-usa                       (0) | Val  Loss: 0.4598 | Val  Acc: 0.8435
 Site-usa                       (0) | Val  Loss: 0.4259 | Val  Acc: 0.8612
 Site-usa                       (0) | Val  Loss: 0.5038 | Val  Acc: 0.8362
 Site-asia                      (0) | Val  Loss: 0.8776 | Val  Acc: 0.6632
 Site-asia                      (1) | Val  Loss: 0.8082 | Val  Acc: 0.7604
Average Valid Accuracy: 0.8042
 Test site-usa                       (0)| Epoch:48 | Test Acc: 0.8794
 Test site-asia                      (0)| Epoch:48 | Test Acc: 0.8144
usa: 0.8794, asia: 0.8144, 
Average Test Accuracy(group): 0.8469, Average Test Accuracy(individual): 0.8577,
domain std=0.0325, cluster std=0.0260, individual std=0.0306, 
Average Test Accuracy: 0.8469
 Test site-usa                       (0)| Epoch:48 | Test Acc: 0.8794
 Test site-asia                      (0)| Epoch:48 | Test Acc: 0.8144
usa: 0.8794, asia: 0.8144, 
Average Test Accuracy(group): 0.8469, Average Test Accuracy(individual): 0.8577,
domain std=0.0325, cluster std=0.0260, individual std=0.0306, 
===2023-07-28 18:17:55===
===2023-07-28 18:18:03===
===Setting===
    dataset: geo
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[172,345,691,1382,432,864,
client_nums=[4,2,]
len_dataset=[8646,4323,]
domain number = 2
Loading snapshots...
 Test site-usa                       (1)| Epoch:48 | Test Acc: 0.8838
 Test site-asia                      (1)| Epoch:48 | Test Acc: 0.8316
usa: 0.8838, asia: 0.8316, 
Average Test Accuracy(group): 0.8577, Average Test Accuracy(individual): 0.8664,
domain std=0.0261, cluster std=0.0000, individual std=0.0246, 
