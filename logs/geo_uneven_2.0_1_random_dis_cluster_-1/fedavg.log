===2023-07-28 11:38:22===
===Setting===
    dataset: geo
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[1729,3458,2593,
client_nums=[2,1,]
len_dataset=[8646,4323,]
domain number = 2
===2023-07-28 11:38:27===
===2023-07-28 11:40:10===
===Setting===
    dataset: geo
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[345,691,1383,2766,864,1728,
client_nums=[4,2,]
len_dataset=[8646,4323,]
domain number = 2
===2023-07-28 11:40:14===
===2023-07-28 11:40:53===
===Setting===
    dataset: geo
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[69,138,276,553,172,345,
client_nums=[4,2,]
len_dataset=[8646,4323,]
domain number = 2
===2023-07-28 11:40:56===
===2023-07-28 11:42:35===
===Setting===
    dataset: geo
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[172,345,691,1382,432,864,
client_nums=[4,2,]
len_dataset=[8646,4323,]
domain number = 2
============ Train epoch 0 ============
===2023-07-28 11:42:53===
===Setting===
    dataset: geo
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[172,345,691,1382,432,864,
client_nums=[4,2,]
len_dataset=[8646,4323,]
domain number = 2
============ Train epoch 0 ============
 Site-usa                           | Train Loss: 1.9620 | Train Acc: 0.2907
 Site-usa                           | Train Loss: 1.9541 | Train Acc: 0.2986
 Site-usa                           | Train Loss: 1.9171 | Train Acc: 0.3430
 Site-usa                           | Train Loss: 1.9533 | Train Acc: 0.3343
 Site-asia                          | Train Loss: 2.1703 | Train Acc: 0.2245
 Site-asia                          | Train Loss: 2.1812 | Train Acc: 0.2257
Average Train Accuracy: 0.2861
 Site-usa                           | Val  Loss: 1.9448 | Val  Acc: 0.3478
 Site-usa                           | Val  Loss: 1.9424 | Val  Acc: 0.2913
 Site-usa                           | Val  Loss: 1.9647 | Val  Acc: 0.2972
 Site-usa                           | Val  Loss: 1.9565 | Val  Acc: 0.3069
 Site-asia                          | Val  Loss: 2.1631 | Val  Acc: 0.2465
 Site-asia                          | Val  Loss: 2.1785 | Val  Acc: 0.2118
Average Valid Accuracy: 0.2836
 Best site-usa                       | Epoch:0 | Val Acc: 0.3478
 Best site-usa                       | Epoch:0 | Val Acc: 0.2913
 Best site-usa                       | Epoch:0 | Val Acc: 0.2972
 Best site-usa                       | Epoch:0 | Val Acc: 0.3069
 Best site-asia                      | Epoch:0 | Val Acc: 0.2465
 Best site-asia                      | Epoch:0 | Val Acc: 0.2118
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 1 ============
 Site-usa                           | Train Loss: 1.7530 | Train Acc: 0.4419
 Site-usa                           | Train Loss: 1.7176 | Train Acc: 0.4580
 Site-usa                           | Train Loss: 1.6466 | Train Acc: 0.5311
 Site-usa                           | Train Loss: 1.6986 | Train Acc: 0.5036
 Site-asia                          | Train Loss: 2.0985 | Train Acc: 0.2431
 Site-asia                          | Train Loss: 2.1199 | Train Acc: 0.2488
Average Train Accuracy: 0.4044
 Site-usa                           | Val  Loss: 1.7297 | Val  Acc: 0.4870
 Site-usa                           | Val  Loss: 1.6815 | Val  Acc: 0.5174
 Site-usa                           | Val  Loss: 1.6918 | Val  Acc: 0.5163
 Site-usa                           | Val  Loss: 1.7169 | Val  Acc: 0.4902
 Site-asia                          | Val  Loss: 2.0814 | Val  Acc: 0.2569
 Site-asia                          | Val  Loss: 2.1310 | Val  Acc: 0.2222
Average Valid Accuracy: 0.4150
 Best site-usa                       | Epoch:1 | Val Acc: 0.4870
 Best site-usa                       | Epoch:1 | Val Acc: 0.5174
 Best site-usa                       | Epoch:1 | Val Acc: 0.5163
 Best site-usa                       | Epoch:1 | Val Acc: 0.4902
 Best site-asia                      | Epoch:1 | Val Acc: 0.2569
 Best site-asia                      | Epoch:1 | Val Acc: 0.2222
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 2 ============
 Site-usa                           | Train Loss: 1.5481 | Train Acc: 0.5523
 Site-usa                           | Train Loss: 1.5218 | Train Acc: 0.6203
 Site-usa                           | Train Loss: 1.4432 | Train Acc: 0.6715
 Site-usa                           | Train Loss: 1.5085 | Train Acc: 0.6056
 Site-asia                          | Train Loss: 2.0378 | Train Acc: 0.2917
 Site-asia                          | Train Loss: 2.0616 | Train Acc: 0.2789
Average Train Accuracy: 0.5034
 Site-usa                           | Val  Loss: 1.5128 | Val  Acc: 0.6087
 Site-usa                           | Val  Loss: 1.5004 | Val  Acc: 0.6130
 Site-usa                           | Val  Loss: 1.4965 | Val  Acc: 0.6117
 Site-usa                           | Val  Loss: 1.5167 | Val  Acc: 0.5987
 Site-asia                          | Val  Loss: 2.0072 | Val  Acc: 0.2847
 Site-asia                          | Val  Loss: 2.0635 | Val  Acc: 0.2656
Average Valid Accuracy: 0.4971
 Best site-usa                       | Epoch:2 | Val Acc: 0.6087
 Best site-usa                       | Epoch:2 | Val Acc: 0.6130
 Best site-usa                       | Epoch:2 | Val Acc: 0.6117
 Best site-usa                       | Epoch:2 | Val Acc: 0.5987
 Best site-asia                      | Epoch:2 | Val Acc: 0.2847
 Best site-asia                      | Epoch:2 | Val Acc: 0.2656
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 3 ============
 Site-usa                           | Train Loss: 1.3871 | Train Acc: 0.6337
 Site-usa                           | Train Loss: 1.3677 | Train Acc: 0.6754
 Site-usa                           | Train Loss: 1.2944 | Train Acc: 0.7033
 Site-usa                           | Train Loss: 1.3565 | Train Acc: 0.6722
 Site-asia                          | Train Loss: 1.9729 | Train Acc: 0.3148
 Site-asia                          | Train Loss: 2.0080 | Train Acc: 0.3056
Average Train Accuracy: 0.5508
 Site-usa                           | Val  Loss: 1.3834 | Val  Acc: 0.6609
 Site-usa                           | Val  Loss: 1.3652 | Val  Acc: 0.6565
 Site-usa                           | Val  Loss: 1.3728 | Val  Acc: 0.6833
 Site-usa                           | Val  Loss: 1.3588 | Val  Acc: 0.6746
 Site-asia                          | Val  Loss: 1.9601 | Val  Acc: 0.3403
 Site-asia                          | Val  Loss: 2.0206 | Val  Acc: 0.2778
Average Valid Accuracy: 0.5489
 Best site-usa                       | Epoch:3 | Val Acc: 0.6609
 Best site-usa                       | Epoch:3 | Val Acc: 0.6565
 Best site-usa                       | Epoch:3 | Val Acc: 0.6833
 Best site-usa                       | Epoch:3 | Val Acc: 0.6746
 Best site-asia                      | Epoch:3 | Val Acc: 0.3403
 Best site-asia                      | Epoch:3 | Val Acc: 0.2778
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 4 ============
 Site-usa                           | Train Loss: 1.2807 | Train Acc: 0.6453
 Site-usa                           | Train Loss: 1.2296 | Train Acc: 0.6986
 Site-usa                           | Train Loss: 1.1833 | Train Acc: 0.7077
 Site-usa                           | Train Loss: 1.2173 | Train Acc: 0.7221
 Site-asia                          | Train Loss: 1.9230 | Train Acc: 0.3472
 Site-asia                          | Train Loss: 1.9654 | Train Acc: 0.3264
Average Train Accuracy: 0.5746
 Site-usa                           | Val  Loss: 1.2493 | Val  Acc: 0.7217
 Site-usa                           | Val  Loss: 1.1712 | Val  Acc: 0.7652
 Site-usa                           | Val  Loss: 1.2019 | Val  Acc: 0.7310
 Site-usa                           | Val  Loss: 1.2424 | Val  Acc: 0.7028
 Site-asia                          | Val  Loss: 1.9283 | Val  Acc: 0.3472
 Site-asia                          | Val  Loss: 1.9442 | Val  Acc: 0.3351
Average Valid Accuracy: 0.6005
 Best site-usa                       | Epoch:4 | Val Acc: 0.7217
 Best site-usa                       | Epoch:4 | Val Acc: 0.7652
 Best site-usa                       | Epoch:4 | Val Acc: 0.7310
 Best site-usa                       | Epoch:4 | Val Acc: 0.7028
 Best site-asia                      | Epoch:4 | Val Acc: 0.3472
 Best site-asia                      | Epoch:4 | Val Acc: 0.3351
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 5 ============
 Site-usa                           | Train Loss: 1.1586 | Train Acc: 0.7035
 Site-usa                           | Train Loss: 1.0835 | Train Acc: 0.7304
 Site-usa                           | Train Loss: 1.0595 | Train Acc: 0.7815
 Site-usa                           | Train Loss: 1.1252 | Train Acc: 0.7482
 Site-asia                          | Train Loss: 1.8563 | Train Acc: 0.3681
 Site-asia                          | Train Loss: 1.8859 | Train Acc: 0.3785
Average Train Accuracy: 0.6184
 Site-usa                           | Val  Loss: 1.0974 | Val  Acc: 0.7739
 Site-usa                           | Val  Loss: 1.1351 | Val  Acc: 0.7652
 Site-usa                           | Val  Loss: 1.1288 | Val  Acc: 0.7267
 Site-usa                           | Val  Loss: 1.1232 | Val  Acc: 0.7310
 Site-asia                          | Val  Loss: 1.8383 | Val  Acc: 0.4028
 Site-asia                          | Val  Loss: 1.9048 | Val  Acc: 0.3490
Average Valid Accuracy: 0.6248
 Best site-usa                       | Epoch:5 | Val Acc: 0.7739
 Best site-usa                       | Epoch:5 | Val Acc: 0.7652
 Best site-usa                       | Epoch:5 | Val Acc: 0.7267
 Best site-usa                       | Epoch:5 | Val Acc: 0.7310
 Best site-asia                      | Epoch:5 | Val Acc: 0.4028
 Best site-asia                      | Epoch:5 | Val Acc: 0.3490
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 6 ============
 Site-usa                           | Train Loss: 1.1232 | Train Acc: 0.6977
 Site-usa                           | Train Loss: 1.0654 | Train Acc: 0.7275
 Site-usa                           | Train Loss: 0.9911 | Train Acc: 0.7815
 Site-usa                           | Train Loss: 1.0621 | Train Acc: 0.7446
 Site-asia                          | Train Loss: 1.7796 | Train Acc: 0.3981
 Site-asia                          | Train Loss: 1.8444 | Train Acc: 0.3912
Average Train Accuracy: 0.6234
 Site-usa                           | Val  Loss: 0.9911 | Val  Acc: 0.7913
 Site-usa                           | Val  Loss: 1.0032 | Val  Acc: 0.7826
 Site-usa                           | Val  Loss: 1.0299 | Val  Acc: 0.7831
 Site-usa                           | Val  Loss: 1.0870 | Val  Acc: 0.7516
 Site-asia                          | Val  Loss: 1.7635 | Val  Acc: 0.4375
 Site-asia                          | Val  Loss: 1.8580 | Val  Acc: 0.3767
Average Valid Accuracy: 0.6538
 Best site-usa                       | Epoch:6 | Val Acc: 0.7913
 Best site-usa                       | Epoch:6 | Val Acc: 0.7826
 Best site-usa                       | Epoch:6 | Val Acc: 0.7831
 Best site-usa                       | Epoch:6 | Val Acc: 0.7516
 Best site-asia                      | Epoch:6 | Val Acc: 0.4375
 Best site-asia                      | Epoch:6 | Val Acc: 0.3767
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 7 ============
 Site-usa                           | Train Loss: 1.0329 | Train Acc: 0.7558
 Site-usa                           | Train Loss: 0.9946 | Train Acc: 0.7594
 Site-usa                           | Train Loss: 0.9148 | Train Acc: 0.7959
 Site-usa                           | Train Loss: 0.9874 | Train Acc: 0.7742
 Site-asia                          | Train Loss: 1.7635 | Train Acc: 0.4375
 Site-asia                          | Train Loss: 1.7876 | Train Acc: 0.4016
Average Train Accuracy: 0.6541
 Site-usa                           | Val  Loss: 1.0039 | Val  Acc: 0.7739
 Site-usa                           | Val  Loss: 1.0099 | Val  Acc: 0.7391
 Site-usa                           | Val  Loss: 1.0260 | Val  Acc: 0.7679
 Site-usa                           | Val  Loss: 0.9899 | Val  Acc: 0.7603
 Site-asia                          | Val  Loss: 1.7801 | Val  Acc: 0.4271
 Site-asia                          | Val  Loss: 1.8245 | Val  Acc: 0.3837
Average Valid Accuracy: 0.6420
============ Train epoch 8 ============
 Site-usa                           | Train Loss: 1.0065 | Train Acc: 0.7442
 Site-usa                           | Train Loss: 0.9143 | Train Acc: 0.7594
 Site-usa                           | Train Loss: 0.8815 | Train Acc: 0.7902
 Site-usa                           | Train Loss: 0.9189 | Train Acc: 0.7923
 Site-asia                          | Train Loss: 1.7064 | Train Acc: 0.4282
 Site-asia                          | Train Loss: 1.7538 | Train Acc: 0.4086
Average Train Accuracy: 0.6538
 Site-usa                           | Val  Loss: 0.9132 | Val  Acc: 0.7739
 Site-usa                           | Val  Loss: 0.8730 | Val  Acc: 0.8000
 Site-usa                           | Val  Loss: 0.9514 | Val  Acc: 0.7722
 Site-usa                           | Val  Loss: 0.9558 | Val  Acc: 0.7560
 Site-asia                          | Val  Loss: 1.6580 | Val  Acc: 0.4757
 Site-asia                          | Val  Loss: 1.7451 | Val  Acc: 0.4167
Average Valid Accuracy: 0.6657
 Best site-usa                       | Epoch:8 | Val Acc: 0.7739
 Best site-usa                       | Epoch:8 | Val Acc: 0.8000
 Best site-usa                       | Epoch:8 | Val Acc: 0.7722
 Best site-usa                       | Epoch:8 | Val Acc: 0.7560
 Best site-asia                      | Epoch:8 | Val Acc: 0.4757
 Best site-asia                      | Epoch:8 | Val Acc: 0.4167
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 9 ============
 Site-usa                           | Train Loss: 0.9190 | Train Acc: 0.7849
 Site-usa                           | Train Loss: 0.8987 | Train Acc: 0.7710
 Site-usa                           | Train Loss: 0.8518 | Train Acc: 0.8046
 Site-usa                           | Train Loss: 0.8798 | Train Acc: 0.7959
 Site-asia                          | Train Loss: 1.6827 | Train Acc: 0.4444
 Site-asia                          | Train Loss: 1.7212 | Train Acc: 0.4213
Average Train Accuracy: 0.6704
 Site-usa                           | Val  Loss: 0.8620 | Val  Acc: 0.8087
 Site-usa                           | Val  Loss: 0.8861 | Val  Acc: 0.7652
 Site-usa                           | Val  Loss: 0.8568 | Val  Acc: 0.8069
 Site-usa                           | Val  Loss: 0.8984 | Val  Acc: 0.7787
 Site-asia                          | Val  Loss: 1.6454 | Val  Acc: 0.4931
 Site-asia                          | Val  Loss: 1.7363 | Val  Acc: 0.4236
Average Valid Accuracy: 0.6794
 Best site-usa                       | Epoch:9 | Val Acc: 0.8087
 Best site-usa                       | Epoch:9 | Val Acc: 0.7652
 Best site-usa                       | Epoch:9 | Val Acc: 0.8069
 Best site-usa                       | Epoch:9 | Val Acc: 0.7787
 Best site-asia                      | Epoch:9 | Val Acc: 0.4931
 Best site-asia                      | Epoch:9 | Val Acc: 0.4236
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 10 ============
 Site-usa                           | Train Loss: 0.9138 | Train Acc: 0.7674
 Site-usa                           | Train Loss: 0.8694 | Train Acc: 0.7942
 Site-usa                           | Train Loss: 0.8133 | Train Acc: 0.8032
 Site-usa                           | Train Loss: 0.8532 | Train Acc: 0.8017
 Site-asia                          | Train Loss: 1.6207 | Train Acc: 0.5000
 Site-asia                          | Train Loss: 1.6962 | Train Acc: 0.4398
Average Train Accuracy: 0.6844
 Site-usa                           | Val  Loss: 0.8500 | Val  Acc: 0.7826
 Site-usa                           | Val  Loss: 0.8461 | Val  Acc: 0.7826
 Site-usa                           | Val  Loss: 0.8522 | Val  Acc: 0.7918
 Site-usa                           | Val  Loss: 0.8695 | Val  Acc: 0.7711
 Site-asia                          | Val  Loss: 1.6256 | Val  Acc: 0.4375
 Site-asia                          | Val  Loss: 1.6785 | Val  Acc: 0.4427
Average Valid Accuracy: 0.6681
============ Train epoch 11 ============
 Site-usa                           | Train Loss: 0.8932 | Train Acc: 0.7558
 Site-usa                           | Train Loss: 0.8246 | Train Acc: 0.7710
 Site-usa                           | Train Loss: 0.7596 | Train Acc: 0.8379
 Site-usa                           | Train Loss: 0.7966 | Train Acc: 0.8025
 Site-asia                          | Train Loss: 1.5933 | Train Acc: 0.4977
 Site-asia                          | Train Loss: 1.6531 | Train Acc: 0.4549
Average Train Accuracy: 0.6866
 Site-usa                           | Val  Loss: 0.8117 | Val  Acc: 0.7913
 Site-usa                           | Val  Loss: 0.8217 | Val  Acc: 0.7826
 Site-usa                           | Val  Loss: 0.8238 | Val  Acc: 0.8091
 Site-usa                           | Val  Loss: 0.8167 | Val  Acc: 0.7885
 Site-asia                          | Val  Loss: 1.6105 | Val  Acc: 0.4444
 Site-asia                          | Val  Loss: 1.6564 | Val  Acc: 0.4410
Average Valid Accuracy: 0.6762
============ Train epoch 12 ============
 Site-usa                           | Train Loss: 0.8612 | Train Acc: 0.7500
 Site-usa                           | Train Loss: 0.7991 | Train Acc: 0.7710
 Site-usa                           | Train Loss: 0.7579 | Train Acc: 0.8119
 Site-usa                           | Train Loss: 0.7966 | Train Acc: 0.7887
 Site-asia                          | Train Loss: 1.5588 | Train Acc: 0.5023
 Site-asia                          | Train Loss: 1.6275 | Train Acc: 0.4479
Average Train Accuracy: 0.6786
 Site-usa                           | Val  Loss: 0.7213 | Val  Acc: 0.8261
 Site-usa                           | Val  Loss: 0.7996 | Val  Acc: 0.7957
 Site-usa                           | Val  Loss: 0.7434 | Val  Acc: 0.8113
 Site-usa                           | Val  Loss: 0.7921 | Val  Acc: 0.8015
 Site-asia                          | Val  Loss: 1.5791 | Val  Acc: 0.4653
 Site-asia                          | Val  Loss: 1.6627 | Val  Acc: 0.4323
Average Valid Accuracy: 0.6887
 Best site-usa                       | Epoch:12 | Val Acc: 0.8261
 Best site-usa                       | Epoch:12 | Val Acc: 0.7957
 Best site-usa                       | Epoch:12 | Val Acc: 0.8113
 Best site-usa                       | Epoch:12 | Val Acc: 0.8015
 Best site-asia                      | Epoch:12 | Val Acc: 0.4653
 Best site-asia                      | Epoch:12 | Val Acc: 0.4323
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 13 ============
 Site-usa                           | Train Loss: 0.8464 | Train Acc: 0.7500
 Site-usa                           | Train Loss: 0.7673 | Train Acc: 0.7913
 Site-usa                           | Train Loss: 0.7071 | Train Acc: 0.8307
 Site-usa                           | Train Loss: 0.7665 | Train Acc: 0.7974
 Site-asia                          | Train Loss: 1.5517 | Train Acc: 0.4884
 Site-asia                          | Train Loss: 1.6054 | Train Acc: 0.4745
Average Train Accuracy: 0.6887
 Site-usa                           | Val  Loss: 0.7241 | Val  Acc: 0.8522
 Site-usa                           | Val  Loss: 0.7547 | Val  Acc: 0.8261
 Site-usa                           | Val  Loss: 0.7939 | Val  Acc: 0.8004
 Site-usa                           | Val  Loss: 0.7647 | Val  Acc: 0.8026
 Site-asia                          | Val  Loss: 1.4963 | Val  Acc: 0.5035
 Site-asia                          | Val  Loss: 1.6086 | Val  Acc: 0.4653
Average Valid Accuracy: 0.7083
 Best site-usa                       | Epoch:13 | Val Acc: 0.8522
 Best site-usa                       | Epoch:13 | Val Acc: 0.8261
 Best site-usa                       | Epoch:13 | Val Acc: 0.8004
 Best site-usa                       | Epoch:13 | Val Acc: 0.8026
 Best site-asia                      | Epoch:13 | Val Acc: 0.5035
 Best site-asia                      | Epoch:13 | Val Acc: 0.4653
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 14 ============
 Site-usa                           | Train Loss: 0.8500 | Train Acc: 0.7558
 Site-usa                           | Train Loss: 0.7701 | Train Acc: 0.7855
 Site-usa                           | Train Loss: 0.7017 | Train Acc: 0.8234
 Site-usa                           | Train Loss: 0.7167 | Train Acc: 0.8329
 Site-asia                          | Train Loss: 1.5364 | Train Acc: 0.4815
 Site-asia                          | Train Loss: 1.5839 | Train Acc: 0.4977
Average Train Accuracy: 0.6961
 Site-usa                           | Val  Loss: 0.7618 | Val  Acc: 0.8000
 Site-usa                           | Val  Loss: 0.6986 | Val  Acc: 0.8304
 Site-usa                           | Val  Loss: 0.7083 | Val  Acc: 0.8200
 Site-usa                           | Val  Loss: 0.7484 | Val  Acc: 0.8026
 Site-asia                          | Val  Loss: 1.5483 | Val  Acc: 0.4792
 Site-asia                          | Val  Loss: 1.5755 | Val  Acc: 0.4809
Average Valid Accuracy: 0.7022
============ Train epoch 15 ============
 Site-usa                           | Train Loss: 0.8023 | Train Acc: 0.7907
 Site-usa                           | Train Loss: 0.7411 | Train Acc: 0.8116
 Site-usa                           | Train Loss: 0.7138 | Train Acc: 0.8220
 Site-usa                           | Train Loss: 0.7386 | Train Acc: 0.7988
 Site-asia                          | Train Loss: 1.5325 | Train Acc: 0.5093
 Site-asia                          | Train Loss: 1.5827 | Train Acc: 0.4826
Average Train Accuracy: 0.7025
 Site-usa                           | Val  Loss: 0.6877 | Val  Acc: 0.8348
 Site-usa                           | Val  Loss: 0.6975 | Val  Acc: 0.8217
 Site-usa                           | Val  Loss: 0.7040 | Val  Acc: 0.8308
 Site-usa                           | Val  Loss: 0.7273 | Val  Acc: 0.8059
 Site-asia                          | Val  Loss: 1.5327 | Val  Acc: 0.4931
 Site-asia                          | Val  Loss: 1.5960 | Val  Acc: 0.4653
Average Valid Accuracy: 0.7086
 Best site-usa                       | Epoch:15 | Val Acc: 0.8348
 Best site-usa                       | Epoch:15 | Val Acc: 0.8217
 Best site-usa                       | Epoch:15 | Val Acc: 0.8308
 Best site-usa                       | Epoch:15 | Val Acc: 0.8059
 Best site-asia                      | Epoch:15 | Val Acc: 0.4931
 Best site-asia                      | Epoch:15 | Val Acc: 0.4653
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 16 ============
 Site-usa                           | Train Loss: 0.7533 | Train Acc: 0.7907
 Site-usa                           | Train Loss: 0.7589 | Train Acc: 0.7971
 Site-usa                           | Train Loss: 0.6598 | Train Acc: 0.8234
 Site-usa                           | Train Loss: 0.7124 | Train Acc: 0.8220
 Site-asia                          | Train Loss: 1.5159 | Train Acc: 0.4861
 Site-asia                          | Train Loss: 1.5602 | Train Acc: 0.4780
Average Train Accuracy: 0.6996
 Site-usa                           | Val  Loss: 0.6320 | Val  Acc: 0.8261
 Site-usa                           | Val  Loss: 0.6714 | Val  Acc: 0.8478
 Site-usa                           | Val  Loss: 0.7130 | Val  Acc: 0.8113
 Site-usa                           | Val  Loss: 0.7324 | Val  Acc: 0.8124
 Site-asia                          | Val  Loss: 1.4560 | Val  Acc: 0.5521
 Site-asia                          | Val  Loss: 1.5373 | Val  Acc: 0.4965
Average Valid Accuracy: 0.7244
 Best site-usa                       | Epoch:16 | Val Acc: 0.8261
 Best site-usa                       | Epoch:16 | Val Acc: 0.8478
 Best site-usa                       | Epoch:16 | Val Acc: 0.8113
 Best site-usa                       | Epoch:16 | Val Acc: 0.8124
 Best site-asia                      | Epoch:16 | Val Acc: 0.5521
 Best site-asia                      | Epoch:16 | Val Acc: 0.4965
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 17 ============
 Site-usa                           | Train Loss: 0.6955 | Train Acc: 0.7907
 Site-usa                           | Train Loss: 0.7200 | Train Acc: 0.8000
 Site-usa                           | Train Loss: 0.6558 | Train Acc: 0.8177
 Site-usa                           | Train Loss: 0.6997 | Train Acc: 0.8148
 Site-asia                          | Train Loss: 1.4629 | Train Acc: 0.5185
 Site-asia                          | Train Loss: 1.5201 | Train Acc: 0.5197
Average Train Accuracy: 0.7102
 Site-usa                           | Val  Loss: 0.6128 | Val  Acc: 0.8435
 Site-usa                           | Val  Loss: 0.6445 | Val  Acc: 0.8348
 Site-usa                           | Val  Loss: 0.6905 | Val  Acc: 0.8134
 Site-usa                           | Val  Loss: 0.7047 | Val  Acc: 0.8037
 Site-asia                          | Val  Loss: 1.5051 | Val  Acc: 0.4861
 Site-asia                          | Val  Loss: 1.5470 | Val  Acc: 0.4774
Average Valid Accuracy: 0.7098
============ Train epoch 18 ============
 Site-usa                           | Train Loss: 0.7461 | Train Acc: 0.7791
 Site-usa                           | Train Loss: 0.6755 | Train Acc: 0.8290
 Site-usa                           | Train Loss: 0.6347 | Train Acc: 0.8234
 Site-usa                           | Train Loss: 0.6810 | Train Acc: 0.8242
 Site-asia                          | Train Loss: 1.4911 | Train Acc: 0.5023
 Site-asia                          | Train Loss: 1.5103 | Train Acc: 0.5058
Average Train Accuracy: 0.7106
 Site-usa                           | Val  Loss: 0.6234 | Val  Acc: 0.8174
 Site-usa                           | Val  Loss: 0.6260 | Val  Acc: 0.8391
 Site-usa                           | Val  Loss: 0.6590 | Val  Acc: 0.8243
 Site-usa                           | Val  Loss: 0.6806 | Val  Acc: 0.8221
 Site-asia                          | Val  Loss: 1.4672 | Val  Acc: 0.5417
 Site-asia                          | Val  Loss: 1.5461 | Val  Acc: 0.4844
Average Valid Accuracy: 0.7215
============ Train epoch 19 ============
 Site-usa                           | Train Loss: 0.7739 | Train Acc: 0.7500
 Site-usa                           | Train Loss: 0.7345 | Train Acc: 0.7971
 Site-usa                           | Train Loss: 0.6271 | Train Acc: 0.8336
 Site-usa                           | Train Loss: 0.6760 | Train Acc: 0.8111
 Site-asia                          | Train Loss: 1.4455 | Train Acc: 0.5139
 Site-asia                          | Train Loss: 1.5015 | Train Acc: 0.5035
Average Train Accuracy: 0.7015
 Site-usa                           | Val  Loss: 0.6933 | Val  Acc: 0.8087
 Site-usa                           | Val  Loss: 0.6569 | Val  Acc: 0.8217
 Site-usa                           | Val  Loss: 0.6883 | Val  Acc: 0.8243
 Site-usa                           | Val  Loss: 0.6669 | Val  Acc: 0.8200
 Site-asia                          | Val  Loss: 1.4565 | Val  Acc: 0.5382
 Site-asia                          | Val  Loss: 1.5352 | Val  Acc: 0.4931
Average Valid Accuracy: 0.7177
============ Train epoch 20 ============
 Site-usa                           | Train Loss: 0.7452 | Train Acc: 0.7616
 Site-usa                           | Train Loss: 0.6515 | Train Acc: 0.8116
 Site-usa                           | Train Loss: 0.6173 | Train Acc: 0.8408
 Site-usa                           | Train Loss: 0.6535 | Train Acc: 0.8321
 Site-asia                          | Train Loss: 1.4286 | Train Acc: 0.5046
 Site-asia                          | Train Loss: 1.4884 | Train Acc: 0.5058
Average Train Accuracy: 0.7094
 Site-usa                           | Val  Loss: 0.6228 | Val  Acc: 0.8261
 Site-usa                           | Val  Loss: 0.6365 | Val  Acc: 0.8391
 Site-usa                           | Val  Loss: 0.6156 | Val  Acc: 0.8525
 Site-usa                           | Val  Loss: 0.6588 | Val  Acc: 0.8286
 Site-asia                          | Val  Loss: 1.4348 | Val  Acc: 0.5139
 Site-asia                          | Val  Loss: 1.5195 | Val  Acc: 0.4965
Average Valid Accuracy: 0.7261
 Best site-usa                       | Epoch:20 | Val Acc: 0.8261
 Best site-usa                       | Epoch:20 | Val Acc: 0.8391
 Best site-usa                       | Epoch:20 | Val Acc: 0.8525
 Best site-usa                       | Epoch:20 | Val Acc: 0.8286
 Best site-asia                      | Epoch:20 | Val Acc: 0.5139
 Best site-asia                      | Epoch:20 | Val Acc: 0.4965
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 21 ============
 Site-usa                           | Train Loss: 0.6423 | Train Acc: 0.8023
 Site-usa                           | Train Loss: 0.6466 | Train Acc: 0.8116
 Site-usa                           | Train Loss: 0.6204 | Train Acc: 0.8379
 Site-usa                           | Train Loss: 0.6328 | Train Acc: 0.8307
 Site-asia                          | Train Loss: 1.4333 | Train Acc: 0.5208
 Site-asia                          | Train Loss: 1.4779 | Train Acc: 0.5301
Average Train Accuracy: 0.7222
 Site-usa                           | Val  Loss: 0.5888 | Val  Acc: 0.8174
 Site-usa                           | Val  Loss: 0.6007 | Val  Acc: 0.8304
 Site-usa                           | Val  Loss: 0.6381 | Val  Acc: 0.8460
 Site-usa                           | Val  Loss: 0.6538 | Val  Acc: 0.8221
 Site-asia                          | Val  Loss: 1.4231 | Val  Acc: 0.5486
 Site-asia                          | Val  Loss: 1.5032 | Val  Acc: 0.4913
Average Valid Accuracy: 0.7260
============ Train epoch 22 ============
 Site-usa                           | Train Loss: 0.6822 | Train Acc: 0.7965
 Site-usa                           | Train Loss: 0.6331 | Train Acc: 0.8232
 Site-usa                           | Train Loss: 0.6034 | Train Acc: 0.8423
 Site-usa                           | Train Loss: 0.6276 | Train Acc: 0.8292
 Site-asia                          | Train Loss: 1.4353 | Train Acc: 0.5023
 Site-asia                          | Train Loss: 1.5009 | Train Acc: 0.4907
Average Train Accuracy: 0.7140
 Site-usa                           | Val  Loss: 0.6674 | Val  Acc: 0.8087
 Site-usa                           | Val  Loss: 0.6158 | Val  Acc: 0.8087
 Site-usa                           | Val  Loss: 0.6071 | Val  Acc: 0.8482
 Site-usa                           | Val  Loss: 0.6348 | Val  Acc: 0.8167
 Site-asia                          | Val  Loss: 1.4610 | Val  Acc: 0.4688
 Site-asia                          | Val  Loss: 1.5341 | Val  Acc: 0.4896
Average Valid Accuracy: 0.7068
============ Train epoch 23 ============
 Site-usa                           | Train Loss: 0.6626 | Train Acc: 0.8023
 Site-usa                           | Train Loss: 0.6224 | Train Acc: 0.8087
 Site-usa                           | Train Loss: 0.6411 | Train Acc: 0.8292
 Site-usa                           | Train Loss: 0.6267 | Train Acc: 0.8292
 Site-asia                          | Train Loss: 1.4064 | Train Acc: 0.5139
 Site-asia                          | Train Loss: 1.4800 | Train Acc: 0.5139
Average Train Accuracy: 0.7162
 Site-usa                           | Val  Loss: 0.5602 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.6191 | Val  Acc: 0.8435
 Site-usa                           | Val  Loss: 0.6083 | Val  Acc: 0.8243
 Site-usa                           | Val  Loss: 0.6308 | Val  Acc: 0.8004
 Site-asia                          | Val  Loss: 1.3778 | Val  Acc: 0.5590
 Site-asia                          | Val  Loss: 1.4641 | Val  Acc: 0.5278
Average Valid Accuracy: 0.7360
 Best site-usa                       | Epoch:23 | Val Acc: 0.8609
 Best site-usa                       | Epoch:23 | Val Acc: 0.8435
 Best site-usa                       | Epoch:23 | Val Acc: 0.8243
 Best site-usa                       | Epoch:23 | Val Acc: 0.8004
 Best site-asia                      | Epoch:23 | Val Acc: 0.5590
 Best site-asia                      | Epoch:23 | Val Acc: 0.5278
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 24 ============
 Site-usa                           | Train Loss: 0.6586 | Train Acc: 0.8140
 Site-usa                           | Train Loss: 0.6462 | Train Acc: 0.8261
 Site-usa                           | Train Loss: 0.5826 | Train Acc: 0.8408
 Site-usa                           | Train Loss: 0.6314 | Train Acc: 0.8278
 Site-asia                          | Train Loss: 1.3855 | Train Acc: 0.5671
 Site-asia                          | Train Loss: 1.4990 | Train Acc: 0.5104
Average Train Accuracy: 0.7310
 Site-usa                           | Val  Loss: 0.5669 | Val  Acc: 0.8435
 Site-usa                           | Val  Loss: 0.5910 | Val  Acc: 0.8435
 Site-usa                           | Val  Loss: 0.6164 | Val  Acc: 0.8330
 Site-usa                           | Val  Loss: 0.6336 | Val  Acc: 0.8286
 Site-asia                          | Val  Loss: 1.4311 | Val  Acc: 0.5347
 Site-asia                          | Val  Loss: 1.4804 | Val  Acc: 0.4913
Average Valid Accuracy: 0.7291
============ Train epoch 25 ============
 Site-usa                           | Train Loss: 0.7037 | Train Acc: 0.7558
 Site-usa                           | Train Loss: 0.6043 | Train Acc: 0.8435
 Site-usa                           | Train Loss: 0.5861 | Train Acc: 0.8495
 Site-usa                           | Train Loss: 0.5966 | Train Acc: 0.8408
 Site-asia                          | Train Loss: 1.4136 | Train Acc: 0.5255
 Site-asia                          | Train Loss: 1.4576 | Train Acc: 0.5255
Average Train Accuracy: 0.7234
 Site-usa                           | Val  Loss: 0.5392 | Val  Acc: 0.8522
 Site-usa                           | Val  Loss: 0.6291 | Val  Acc: 0.8478
 Site-usa                           | Val  Loss: 0.6277 | Val  Acc: 0.8265
 Site-usa                           | Val  Loss: 0.6264 | Val  Acc: 0.8156
 Site-asia                          | Val  Loss: 1.4406 | Val  Acc: 0.5139
 Site-asia                          | Val  Loss: 1.4599 | Val  Acc: 0.5226
Average Valid Accuracy: 0.7298
============ Train epoch 26 ============
 Site-usa                           | Train Loss: 0.7182 | Train Acc: 0.7849
 Site-usa                           | Train Loss: 0.6442 | Train Acc: 0.8116
 Site-usa                           | Train Loss: 0.5913 | Train Acc: 0.8307
 Site-usa                           | Train Loss: 0.5985 | Train Acc: 0.8307
 Site-asia                          | Train Loss: 1.3787 | Train Acc: 0.5347
 Site-asia                          | Train Loss: 1.4521 | Train Acc: 0.5139
Average Train Accuracy: 0.7177
 Site-usa                           | Val  Loss: 0.5921 | Val  Acc: 0.8087
 Site-usa                           | Val  Loss: 0.5857 | Val  Acc: 0.8522
 Site-usa                           | Val  Loss: 0.5921 | Val  Acc: 0.8460
 Site-usa                           | Val  Loss: 0.6010 | Val  Acc: 0.8362
 Site-asia                          | Val  Loss: 1.3292 | Val  Acc: 0.5625
 Site-asia                          | Val  Loss: 1.4701 | Val  Acc: 0.5399
Average Valid Accuracy: 0.7409
 Best site-usa                       | Epoch:26 | Val Acc: 0.8087
 Best site-usa                       | Epoch:26 | Val Acc: 0.8522
 Best site-usa                       | Epoch:26 | Val Acc: 0.8460
 Best site-usa                       | Epoch:26 | Val Acc: 0.8362
 Best site-asia                      | Epoch:26 | Val Acc: 0.5625
 Best site-asia                      | Epoch:26 | Val Acc: 0.5399
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 27 ============
 Site-usa                           | Train Loss: 0.7753 | Train Acc: 0.7733
 Site-usa                           | Train Loss: 0.6302 | Train Acc: 0.8174
 Site-usa                           | Train Loss: 0.5739 | Train Acc: 0.8495
 Site-usa                           | Train Loss: 0.5964 | Train Acc: 0.8263
 Site-asia                          | Train Loss: 1.3629 | Train Acc: 0.5324
 Site-asia                          | Train Loss: 1.4947 | Train Acc: 0.5035
Average Train Accuracy: 0.7171
 Site-usa                           | Val  Loss: 0.5429 | Val  Acc: 0.8087
 Site-usa                           | Val  Loss: 0.5712 | Val  Acc: 0.8348
 Site-usa                           | Val  Loss: 0.5431 | Val  Acc: 0.8655
 Site-usa                           | Val  Loss: 0.6105 | Val  Acc: 0.8373
 Site-asia                          | Val  Loss: 1.3932 | Val  Acc: 0.5556
 Site-asia                          | Val  Loss: 1.4210 | Val  Acc: 0.5191
Average Valid Accuracy: 0.7368
============ Train epoch 28 ============
 Site-usa                           | Train Loss: 0.6311 | Train Acc: 0.8256
 Site-usa                           | Train Loss: 0.6096 | Train Acc: 0.8290
 Site-usa                           | Train Loss: 0.5419 | Train Acc: 0.8582
 Site-usa                           | Train Loss: 0.5682 | Train Acc: 0.8415
 Site-asia                          | Train Loss: 1.3639 | Train Acc: 0.5417
 Site-asia                          | Train Loss: 1.4400 | Train Acc: 0.5162
Average Train Accuracy: 0.7354
 Site-usa                           | Val  Loss: 0.5485 | Val  Acc: 0.8435
 Site-usa                           | Val  Loss: 0.5677 | Val  Acc: 0.8304
 Site-usa                           | Val  Loss: 0.5903 | Val  Acc: 0.8547
 Site-usa                           | Val  Loss: 0.6006 | Val  Acc: 0.8438
 Site-asia                          | Val  Loss: 1.3813 | Val  Acc: 0.5521
 Site-asia                          | Val  Loss: 1.4573 | Val  Acc: 0.5052
Average Valid Accuracy: 0.7383
============ Train epoch 29 ============
 Site-usa                           | Train Loss: 0.6653 | Train Acc: 0.7674
 Site-usa                           | Train Loss: 0.6198 | Train Acc: 0.8087
 Site-usa                           | Train Loss: 0.5512 | Train Acc: 0.8452
 Site-usa                           | Train Loss: 0.5962 | Train Acc: 0.8300
 Site-asia                          | Train Loss: 1.3762 | Train Acc: 0.5509
 Site-asia                          | Train Loss: 1.4345 | Train Acc: 0.5347
Average Train Accuracy: 0.7228
 Site-usa                           | Val  Loss: 0.5790 | Val  Acc: 0.8261
 Site-usa                           | Val  Loss: 0.6039 | Val  Acc: 0.8174
 Site-usa                           | Val  Loss: 0.5185 | Val  Acc: 0.8698
 Site-usa                           | Val  Loss: 0.5594 | Val  Acc: 0.8460
 Site-asia                          | Val  Loss: 1.3760 | Val  Acc: 0.5278
 Site-asia                          | Val  Loss: 1.4601 | Val  Acc: 0.5191
Average Valid Accuracy: 0.7344
============ Train epoch 30 ============
 Site-usa                           | Train Loss: 0.6386 | Train Acc: 0.7791
 Site-usa                           | Train Loss: 0.5634 | Train Acc: 0.8406
 Site-usa                           | Train Loss: 0.5375 | Train Acc: 0.8582
 Site-usa                           | Train Loss: 0.5465 | Train Acc: 0.8408
 Site-asia                          | Train Loss: 1.3894 | Train Acc: 0.5394
 Site-asia                          | Train Loss: 1.4571 | Train Acc: 0.5197
Average Train Accuracy: 0.7296
 Site-usa                           | Val  Loss: 0.4409 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.5430 | Val  Acc: 0.8478
 Site-usa                           | Val  Loss: 0.5355 | Val  Acc: 0.8395
 Site-usa                           | Val  Loss: 0.5938 | Val  Acc: 0.8395
 Site-asia                          | Val  Loss: 1.3934 | Val  Acc: 0.5486
 Site-asia                          | Val  Loss: 1.4147 | Val  Acc: 0.5434
Average Valid Accuracy: 0.7524
 Best site-usa                       | Epoch:30 | Val Acc: 0.8957
 Best site-usa                       | Epoch:30 | Val Acc: 0.8478
 Best site-usa                       | Epoch:30 | Val Acc: 0.8395
 Best site-usa                       | Epoch:30 | Val Acc: 0.8395
 Best site-asia                      | Epoch:30 | Val Acc: 0.5486
 Best site-asia                      | Epoch:30 | Val Acc: 0.5434
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 31 ============
 Site-usa                           | Train Loss: 0.6263 | Train Acc: 0.8023
 Site-usa                           | Train Loss: 0.6446 | Train Acc: 0.8087
 Site-usa                           | Train Loss: 0.5290 | Train Acc: 0.8524
 Site-usa                           | Train Loss: 0.5858 | Train Acc: 0.8386
 Site-asia                          | Train Loss: 1.3958 | Train Acc: 0.5255
 Site-asia                          | Train Loss: 1.4412 | Train Acc: 0.5336
Average Train Accuracy: 0.7268
 Site-usa                           | Val  Loss: 0.6288 | Val  Acc: 0.8174
 Site-usa                           | Val  Loss: 0.5759 | Val  Acc: 0.8478
 Site-usa                           | Val  Loss: 0.5452 | Val  Acc: 0.8590
 Site-usa                           | Val  Loss: 0.5769 | Val  Acc: 0.8395
 Site-asia                          | Val  Loss: 1.4463 | Val  Acc: 0.5139
 Site-asia                          | Val  Loss: 1.4439 | Val  Acc: 0.5260
Average Valid Accuracy: 0.7339
============ Train epoch 32 ============
 Site-usa                           | Train Loss: 0.5818 | Train Acc: 0.8256
 Site-usa                           | Train Loss: 0.5861 | Train Acc: 0.8145
 Site-usa                           | Train Loss: 0.5435 | Train Acc: 0.8495
 Site-usa                           | Train Loss: 0.5584 | Train Acc: 0.8408
 Site-asia                          | Train Loss: 1.3288 | Train Acc: 0.5278
 Site-asia                          | Train Loss: 1.4205 | Train Acc: 0.5451
Average Train Accuracy: 0.7339
 Site-usa                           | Val  Loss: 0.5429 | Val  Acc: 0.8348
 Site-usa                           | Val  Loss: 0.5556 | Val  Acc: 0.8565
 Site-usa                           | Val  Loss: 0.5682 | Val  Acc: 0.8308
 Site-usa                           | Val  Loss: 0.5728 | Val  Acc: 0.8286
 Site-asia                          | Val  Loss: 1.3578 | Val  Acc: 0.5764
 Site-asia                          | Val  Loss: 1.4084 | Val  Acc: 0.5260
Average Valid Accuracy: 0.7422
============ Train epoch 33 ============
 Site-usa                           | Train Loss: 0.6490 | Train Acc: 0.7907
 Site-usa                           | Train Loss: 0.6192 | Train Acc: 0.8290
 Site-usa                           | Train Loss: 0.5168 | Train Acc: 0.8553
 Site-usa                           | Train Loss: 0.5517 | Train Acc: 0.8495
 Site-asia                          | Train Loss: 1.3526 | Train Acc: 0.5509
 Site-asia                          | Train Loss: 1.4061 | Train Acc: 0.5382
Average Train Accuracy: 0.7356
 Site-usa                           | Val  Loss: 0.5996 | Val  Acc: 0.7826
 Site-usa                           | Val  Loss: 0.5705 | Val  Acc: 0.8522
 Site-usa                           | Val  Loss: 0.6006 | Val  Acc: 0.8482
 Site-usa                           | Val  Loss: 0.5448 | Val  Acc: 0.8503
 Site-asia                          | Val  Loss: 1.4034 | Val  Acc: 0.5451
 Site-asia                          | Val  Loss: 1.3652 | Val  Acc: 0.5417
Average Valid Accuracy: 0.7367
============ Train epoch 34 ============
 Site-usa                           | Train Loss: 0.6494 | Train Acc: 0.7849
 Site-usa                           | Train Loss: 0.5852 | Train Acc: 0.8145
 Site-usa                           | Train Loss: 0.5156 | Train Acc: 0.8698
 Site-usa                           | Train Loss: 0.5618 | Train Acc: 0.8415
 Site-asia                          | Train Loss: 1.3568 | Train Acc: 0.5463
 Site-asia                          | Train Loss: 1.4293 | Train Acc: 0.5405
Average Train Accuracy: 0.7329
 Site-usa                           | Val  Loss: 0.5484 | Val  Acc: 0.8348
 Site-usa                           | Val  Loss: 0.5163 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.5047 | Val  Acc: 0.8612
 Site-usa                           | Val  Loss: 0.5644 | Val  Acc: 0.8492
 Site-asia                          | Val  Loss: 1.4020 | Val  Acc: 0.5278
 Site-asia                          | Val  Loss: 1.4741 | Val  Acc: 0.4983
Average Valid Accuracy: 0.7387
============ Train epoch 35 ============
 Site-usa                           | Train Loss: 0.6231 | Train Acc: 0.8372
 Site-usa                           | Train Loss: 0.5561 | Train Acc: 0.8348
 Site-usa                           | Train Loss: 0.5328 | Train Acc: 0.8495
 Site-usa                           | Train Loss: 0.5289 | Train Acc: 0.8466
 Site-asia                          | Train Loss: 1.3492 | Train Acc: 0.5671
 Site-asia                          | Train Loss: 1.3847 | Train Acc: 0.5509
Average Train Accuracy: 0.7477
 Site-usa                           | Val  Loss: 0.5191 | Val  Acc: 0.8261
 Site-usa                           | Val  Loss: 0.5082 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.5238 | Val  Acc: 0.8612
 Site-usa                           | Val  Loss: 0.5701 | Val  Acc: 0.8373
 Site-asia                          | Val  Loss: 1.3619 | Val  Acc: 0.5243
 Site-asia                          | Val  Loss: 1.4158 | Val  Acc: 0.5434
Average Valid Accuracy: 0.7422
============ Train epoch 36 ============
 Site-usa                           | Train Loss: 0.6234 | Train Acc: 0.8081
 Site-usa                           | Train Loss: 0.5920 | Train Acc: 0.8377
 Site-usa                           | Train Loss: 0.5205 | Train Acc: 0.8611
 Site-usa                           | Train Loss: 0.5538 | Train Acc: 0.8343
 Site-asia                          | Train Loss: 1.3756 | Train Acc: 0.5324
 Site-asia                          | Train Loss: 1.3941 | Train Acc: 0.5417
Average Train Accuracy: 0.7359
 Site-usa                           | Val  Loss: 0.4529 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.5022 | Val  Acc: 0.8478
 Site-usa                           | Val  Loss: 0.5266 | Val  Acc: 0.8482
 Site-usa                           | Val  Loss: 0.5658 | Val  Acc: 0.8351
 Site-asia                          | Val  Loss: 1.2829 | Val  Acc: 0.6007
 Site-asia                          | Val  Loss: 1.3853 | Val  Acc: 0.5469
Average Valid Accuracy: 0.7609
 Best site-usa                       | Epoch:36 | Val Acc: 0.8870
 Best site-usa                       | Epoch:36 | Val Acc: 0.8478
 Best site-usa                       | Epoch:36 | Val Acc: 0.8482
 Best site-usa                       | Epoch:36 | Val Acc: 0.8351
 Best site-asia                      | Epoch:36 | Val Acc: 0.6007
 Best site-asia                      | Epoch:36 | Val Acc: 0.5469
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 37 ============
 Site-usa                           | Train Loss: 0.6386 | Train Acc: 0.8081
 Site-usa                           | Train Loss: 0.5826 | Train Acc: 0.8290
 Site-usa                           | Train Loss: 0.5017 | Train Acc: 0.8524
 Site-usa                           | Train Loss: 0.5353 | Train Acc: 0.8423
 Site-asia                          | Train Loss: 1.3173 | Train Acc: 0.5671
 Site-asia                          | Train Loss: 1.4020 | Train Acc: 0.5532
Average Train Accuracy: 0.7420
 Site-usa                           | Val  Loss: 0.4517 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.4986 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.5467 | Val  Acc: 0.8525
 Site-usa                           | Val  Loss: 0.5646 | Val  Acc: 0.8416
 Site-asia                          | Val  Loss: 1.2835 | Val  Acc: 0.5868
 Site-asia                          | Val  Loss: 1.3952 | Val  Acc: 0.5434
Average Valid Accuracy: 0.7606
============ Train epoch 38 ============
 Site-usa                           | Train Loss: 0.6056 | Train Acc: 0.8140
 Site-usa                           | Train Loss: 0.5924 | Train Acc: 0.8029
 Site-usa                           | Train Loss: 0.5219 | Train Acc: 0.8538
 Site-usa                           | Train Loss: 0.5151 | Train Acc: 0.8589
 Site-asia                          | Train Loss: 1.3170 | Train Acc: 0.5625
 Site-asia                          | Train Loss: 1.3711 | Train Acc: 0.5694
Average Train Accuracy: 0.7436
 Site-usa                           | Val  Loss: 0.4659 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.4930 | Val  Acc: 0.8652
 Site-usa                           | Val  Loss: 0.5025 | Val  Acc: 0.8286
 Site-usa                           | Val  Loss: 0.5518 | Val  Acc: 0.8438
 Site-asia                          | Val  Loss: 1.2736 | Val  Acc: 0.5764
 Site-asia                          | Val  Loss: 1.4058 | Val  Acc: 0.5312
Average Valid Accuracy: 0.7568
============ Train epoch 39 ============
 Site-usa                           | Train Loss: 0.5793 | Train Acc: 0.8314
 Site-usa                           | Train Loss: 0.5331 | Train Acc: 0.8377
 Site-usa                           | Train Loss: 0.4944 | Train Acc: 0.8611
 Site-usa                           | Train Loss: 0.5057 | Train Acc: 0.8480
 Site-asia                          | Train Loss: 1.3274 | Train Acc: 0.5602
 Site-asia                          | Train Loss: 1.4046 | Train Acc: 0.5370
Average Train Accuracy: 0.7459
 Site-usa                           | Val  Loss: 0.5028 | Val  Acc: 0.8174
 Site-usa                           | Val  Loss: 0.5554 | Val  Acc: 0.8391
 Site-usa                           | Val  Loss: 0.5142 | Val  Acc: 0.8655
 Site-usa                           | Val  Loss: 0.5452 | Val  Acc: 0.8438
 Site-asia                          | Val  Loss: 1.3211 | Val  Acc: 0.5590
 Site-asia                          | Val  Loss: 1.3686 | Val  Acc: 0.5312
Average Valid Accuracy: 0.7427
============ Train epoch 40 ============
 Site-usa                           | Train Loss: 0.5560 | Train Acc: 0.8430
 Site-usa                           | Train Loss: 0.5285 | Train Acc: 0.8319
 Site-usa                           | Train Loss: 0.5211 | Train Acc: 0.8437
 Site-usa                           | Train Loss: 0.5237 | Train Acc: 0.8480
 Site-asia                          | Train Loss: 1.3528 | Train Acc: 0.5486
 Site-asia                          | Train Loss: 1.3775 | Train Acc: 0.5613
Average Train Accuracy: 0.7461
 Site-usa                           | Val  Loss: 0.4171 | Val  Acc: 0.8783
 Site-usa                           | Val  Loss: 0.5044 | Val  Acc: 0.8652
 Site-usa                           | Val  Loss: 0.5017 | Val  Acc: 0.8677
 Site-usa                           | Val  Loss: 0.5352 | Val  Acc: 0.8492
 Site-asia                          | Val  Loss: 1.3044 | Val  Acc: 0.5833
 Site-asia                          | Val  Loss: 1.3693 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7665
 Best site-usa                       | Epoch:40 | Val Acc: 0.8783
 Best site-usa                       | Epoch:40 | Val Acc: 0.8652
 Best site-usa                       | Epoch:40 | Val Acc: 0.8677
 Best site-usa                       | Epoch:40 | Val Acc: 0.8492
 Best site-asia                      | Epoch:40 | Val Acc: 0.5833
 Best site-asia                      | Epoch:40 | Val Acc: 0.5556
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 41 ============
 Site-usa                           | Train Loss: 0.5911 | Train Acc: 0.8140
 Site-usa                           | Train Loss: 0.5999 | Train Acc: 0.7971
 Site-usa                           | Train Loss: 0.4966 | Train Acc: 0.8582
 Site-usa                           | Train Loss: 0.5131 | Train Acc: 0.8538
 Site-asia                          | Train Loss: 1.3404 | Train Acc: 0.5648
 Site-asia                          | Train Loss: 1.3408 | Train Acc: 0.5775
Average Train Accuracy: 0.7442
 Site-usa                           | Val  Loss: 0.4028 | Val  Acc: 0.8957
 Site-usa                           | Val  Loss: 0.5008 | Val  Acc: 0.8739
 Site-usa                           | Val  Loss: 0.5115 | Val  Acc: 0.8785
 Site-usa                           | Val  Loss: 0.5361 | Val  Acc: 0.8395
 Site-asia                          | Val  Loss: 1.3567 | Val  Acc: 0.5243
 Site-asia                          | Val  Loss: 1.3950 | Val  Acc: 0.5365
Average Valid Accuracy: 0.7581
============ Train epoch 42 ============
 Site-usa                           | Train Loss: 0.5876 | Train Acc: 0.8023
 Site-usa                           | Train Loss: 0.5243 | Train Acc: 0.8377
 Site-usa                           | Train Loss: 0.5152 | Train Acc: 0.8698
 Site-usa                           | Train Loss: 0.4965 | Train Acc: 0.8531
 Site-asia                          | Train Loss: 1.3249 | Train Acc: 0.5694
 Site-asia                          | Train Loss: 1.3387 | Train Acc: 0.5845
Average Train Accuracy: 0.7528
 Site-usa                           | Val  Loss: 0.5036 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.4939 | Val  Acc: 0.8783
 Site-usa                           | Val  Loss: 0.5071 | Val  Acc: 0.8482
 Site-usa                           | Val  Loss: 0.5207 | Val  Acc: 0.8557
 Site-asia                          | Val  Loss: 1.2912 | Val  Acc: 0.5451
 Site-asia                          | Val  Loss: 1.3413 | Val  Acc: 0.5590
Average Valid Accuracy: 0.7593
============ Train epoch 43 ============
 Site-usa                           | Train Loss: 0.5649 | Train Acc: 0.8314
 Site-usa                           | Train Loss: 0.5523 | Train Acc: 0.8464
 Site-usa                           | Train Loss: 0.5116 | Train Acc: 0.8611
 Site-usa                           | Train Loss: 0.5182 | Train Acc: 0.8473
 Site-asia                          | Train Loss: 1.2848 | Train Acc: 0.5648
 Site-asia                          | Train Loss: 1.3685 | Train Acc: 0.5590
Average Train Accuracy: 0.7517
 Site-usa                           | Val  Loss: 0.3861 | Val  Acc: 0.9043
 Site-usa                           | Val  Loss: 0.4718 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.4532 | Val  Acc: 0.8785
 Site-usa                           | Val  Loss: 0.5217 | Val  Acc: 0.8427
 Site-asia                          | Val  Loss: 1.2749 | Val  Acc: 0.6076
 Site-asia                          | Val  Loss: 1.3190 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7749
 Best site-usa                       | Epoch:43 | Val Acc: 0.9043
 Best site-usa                       | Epoch:43 | Val Acc: 0.8609
 Best site-usa                       | Epoch:43 | Val Acc: 0.8785
 Best site-usa                       | Epoch:43 | Val Acc: 0.8427
 Best site-asia                      | Epoch:43 | Val Acc: 0.6076
 Best site-asia                      | Epoch:43 | Val Acc: 0.5556
 Saving the local and server checkpoint to ../checkpoint/fed_geo_uneven_2.0_1/fedavg...
============ Train epoch 44 ============
 Site-usa                           | Train Loss: 0.6771 | Train Acc: 0.7849
 Site-usa                           | Train Loss: 0.5091 | Train Acc: 0.8406
 Site-usa                           | Train Loss: 0.5231 | Train Acc: 0.8480
 Site-usa                           | Train Loss: 0.4951 | Train Acc: 0.8589
 Site-asia                          | Train Loss: 1.2858 | Train Acc: 0.5671
 Site-asia                          | Train Loss: 1.3530 | Train Acc: 0.5556
Average Train Accuracy: 0.7425
 Site-usa                           | Val  Loss: 0.4378 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.5091 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.4873 | Val  Acc: 0.8633
 Site-usa                           | Val  Loss: 0.5327 | Val  Acc: 0.8265
 Site-asia                          | Val  Loss: 1.3121 | Val  Acc: 0.5903
 Site-asia                          | Val  Loss: 1.3474 | Val  Acc: 0.5417
Average Valid Accuracy: 0.7587
============ Train epoch 45 ============
 Site-usa                           | Train Loss: 0.5622 | Train Acc: 0.8198
 Site-usa                           | Train Loss: 0.6294 | Train Acc: 0.8029
 Site-usa                           | Train Loss: 0.5037 | Train Acc: 0.8538
 Site-usa                           | Train Loss: 0.5007 | Train Acc: 0.8603
 Site-asia                          | Train Loss: 1.3324 | Train Acc: 0.5625
 Site-asia                          | Train Loss: 1.3541 | Train Acc: 0.5660
Average Train Accuracy: 0.7442
 Site-usa                           | Val  Loss: 0.4408 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.5007 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.4308 | Val  Acc: 0.8850
 Site-usa                           | Val  Loss: 0.4999 | Val  Acc: 0.8503
 Site-asia                          | Val  Loss: 1.3486 | Val  Acc: 0.5694
 Site-asia                          | Val  Loss: 1.3501 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7666
============ Train epoch 46 ============
 Site-usa                           | Train Loss: 0.5983 | Train Acc: 0.8314
 Site-usa                           | Train Loss: 0.5534 | Train Acc: 0.8261
 Site-usa                           | Train Loss: 0.5007 | Train Acc: 0.8654
 Site-usa                           | Train Loss: 0.4941 | Train Acc: 0.8553
 Site-asia                          | Train Loss: 1.2606 | Train Acc: 0.5741
 Site-asia                          | Train Loss: 1.3348 | Train Acc: 0.5637
Average Train Accuracy: 0.7527
 Site-usa                           | Val  Loss: 0.5322 | Val  Acc: 0.8087
 Site-usa                           | Val  Loss: 0.5186 | Val  Acc: 0.8826
 Site-usa                           | Val  Loss: 0.5423 | Val  Acc: 0.8612
 Site-usa                           | Val  Loss: 0.4767 | Val  Acc: 0.8579
 Site-asia                          | Val  Loss: 1.2424 | Val  Acc: 0.5729
 Site-asia                          | Val  Loss: 1.3240 | Val  Acc: 0.5677
Average Valid Accuracy: 0.7585
============ Train epoch 47 ============
 Site-usa                           | Train Loss: 0.6239 | Train Acc: 0.8023
 Site-usa                           | Train Loss: 0.5574 | Train Acc: 0.8406
 Site-usa                           | Train Loss: 0.4909 | Train Acc: 0.8567
 Site-usa                           | Train Loss: 0.4846 | Train Acc: 0.8661
 Site-asia                          | Train Loss: 1.3575 | Train Acc: 0.5509
 Site-asia                          | Train Loss: 1.3335 | Train Acc: 0.5752
Average Train Accuracy: 0.7487
 Site-usa                           | Val  Loss: 0.4352 | Val  Acc: 0.8609
 Site-usa                           | Val  Loss: 0.4782 | Val  Acc: 0.8652
 Site-usa                           | Val  Loss: 0.4993 | Val  Acc: 0.8698
 Site-usa                           | Val  Loss: 0.5315 | Val  Acc: 0.8362
 Site-asia                          | Val  Loss: 1.2788 | Val  Acc: 0.5729
 Site-asia                          | Val  Loss: 1.3484 | Val  Acc: 0.5781
Average Valid Accuracy: 0.7639
============ Train epoch 48 ============
 Site-usa                           | Train Loss: 0.5682 | Train Acc: 0.8256
 Site-usa                           | Train Loss: 0.5082 | Train Acc: 0.8435
 Site-usa                           | Train Loss: 0.4808 | Train Acc: 0.8669
 Site-usa                           | Train Loss: 0.4742 | Train Acc: 0.8661
 Site-asia                          | Train Loss: 1.2835 | Train Acc: 0.5787
 Site-asia                          | Train Loss: 1.3527 | Train Acc: 0.5683
Average Train Accuracy: 0.7582
 Site-usa                           | Val  Loss: 0.3993 | Val  Acc: 0.8870
 Site-usa                           | Val  Loss: 0.4655 | Val  Acc: 0.8652
 Site-usa                           | Val  Loss: 0.4656 | Val  Acc: 0.8720
 Site-usa                           | Val  Loss: 0.5087 | Val  Acc: 0.8427
 Site-asia                          | Val  Loss: 1.2558 | Val  Acc: 0.5694
 Site-asia                          | Val  Loss: 1.3759 | Val  Acc: 0.5434
Average Valid Accuracy: 0.7633
============ Train epoch 49 ============
 Site-usa                           | Train Loss: 0.5332 | Train Acc: 0.8198
 Site-usa                           | Train Loss: 0.5501 | Train Acc: 0.8174
 Site-usa                           | Train Loss: 0.4658 | Train Acc: 0.8784
 Site-usa                           | Train Loss: 0.4835 | Train Acc: 0.8567
 Site-asia                          | Train Loss: 1.2841 | Train Acc: 0.5718
 Site-asia                          | Train Loss: 1.3224 | Train Acc: 0.5787
Average Train Accuracy: 0.7538
 Site-usa                           | Val  Loss: 0.4517 | Val  Acc: 0.8696
 Site-usa                           | Val  Loss: 0.5037 | Val  Acc: 0.8304
 Site-usa                           | Val  Loss: 0.4721 | Val  Acc: 0.8612
 Site-usa                           | Val  Loss: 0.5284 | Val  Acc: 0.8503
 Site-asia                          | Val  Loss: 1.3438 | Val  Acc: 0.5660
 Site-asia                          | Val  Loss: 1.3167 | Val  Acc: 0.5729
Average Valid Accuracy: 0.7584
===2023-07-28 13:25:00===
===2023-07-28 13:25:08===
===Setting===
    dataset: geo
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[172,345,691,1382,432,864,
client_nums=[4,2,]
len_dataset=[8646,4323,]
domain number = 2
Loading snapshots...
 Test site-usa                       | Epoch:43 | Test Acc: 0.9178
 Test site-asia                      | Epoch:43 | Test Acc: 0.8371
usa: 0.9178, asia: 0.8371, 
Average Test Accuracy(group): 0.8774, Average Test Accuracy(individual): 0.8909,
domain std=0.0403, cluster std=-1.0000, individual std=0.0380, 
