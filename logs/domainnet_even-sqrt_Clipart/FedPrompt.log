===2023-03-26 16:33:04===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Infograph | Train Loss: 2.2139 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1661 | Train Acc: 0.2698
 Site-Painting  | Train Loss: 1.9209 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.9940 | Train Acc: 0.4127
 Site-QuickDraw | Train Loss: 2.2348 | Train Acc: 0.1746
 Site-QuickDraw | Train Loss: 2.1995 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.8673 | Train Acc: 0.5397
 Site-Real      | Train Loss: 1.9516 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 1.9502 | Train Acc: 0.5556
 Site-Sketch    | Train Loss: 2.0373 | Train Acc: 0.3968
 Site-Infograph | Val  Loss: 2.2148 | Val  Acc: 0.2143
 Site-Infograph | Val  Loss: 2.1703 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.8840 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 2.0065 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 2.2143 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.2279 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9085 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.9654 | Val  Acc: 0.5714
 Site-Sketch    | Val  Loss: 1.9821 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 2.0531 | Val  Acc: 0.4524
Average Valid Accuracy: 0.3690
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-Painting   | Epoch:0 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1905
 Best site-Real       | Epoch:0 | Val Acc: 0.4524
 Best site-Real       | Epoch:0 | Val Acc: 0.5714
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Infograph | Train Loss: 2.1215 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.9877 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 1.4430 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 1.5142 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.1512 | Train Acc: 0.1905
 Site-QuickDraw | Train Loss: 2.0212 | Train Acc: 0.3810
 Site-Real      | Train Loss: 1.2679 | Train Acc: 0.8730
 Site-Real      | Train Loss: 1.3903 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.4969 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.6274 | Train Acc: 0.5873
 Site-Infograph | Val  Loss: 2.0234 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.2101 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 1.3927 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.6469 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.9569 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.0531 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.3212 | Val  Acc: 0.7619
 Site-Real      | Val  Loss: 1.4608 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.6804 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.6406 | Val  Acc: 0.5238
Average Valid Accuracy: 0.5095
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1905
 Best site-Painting   | Epoch:1 | Val Acc: 0.6667
 Best site-Painting   | Epoch:1 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3810
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Infograph | Train Loss: 1.9249 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.7899 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.0673 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 1.1081 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 1.9651 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 1.8407 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.8614 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.9387 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 1.2621 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 1.3127 | Train Acc: 0.6984
 Site-Infograph | Val  Loss: 1.7480 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9462 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.9752 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.3231 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.6937 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 1.9705 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9213 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.9242 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.3113 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.2905 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6405
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3571
 Best site-Painting   | Epoch:2 | Val Acc: 0.8333
 Best site-Painting   | Epoch:2 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3333
 Best site-Real       | Epoch:2 | Val Acc: 0.8810
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Infograph | Train Loss: 1.8276 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5635 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.8235 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.8044 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.8673 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 1.6508 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.6166 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.6468 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.8910 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9456 | Train Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4307 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7935 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.6803 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.9045 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4478 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.8678 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.5492 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.6399 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 1.0214 | Val  Acc: 0.6905
 Site-Sketch    | Val  Loss: 1.0145 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7190
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Painting   | Epoch:3 | Val Acc: 0.8810
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4286
 Best site-Real       | Epoch:3 | Val Acc: 0.9762
 Best site-Real       | Epoch:3 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6905
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Infograph | Train Loss: 1.6247 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3434 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.6416 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.6373 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.5998 | Train Acc: 0.4762
 Site-QuickDraw | Train Loss: 1.4086 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.4444 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.4106 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6998 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.7966 | Train Acc: 0.8095
 Site-Infograph | Val  Loss: 1.4459 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.6682 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.4961 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.7227 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.2475 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.6079 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3968 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.4687 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.8362 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 0.8635 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7524
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4524
 Best site-Painting   | Epoch:4 | Val Acc: 0.8810
 Best site-Painting   | Epoch:4 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5000
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Real       | Epoch:4 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Infograph | Train Loss: 1.5339 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2445 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4714 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.4665 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.5523 | Train Acc: 0.4603
 Site-QuickDraw | Train Loss: 1.3371 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.2520 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.2700 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.6195 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.6203 | Train Acc: 0.8254
 Site-Infograph | Val  Loss: 1.1558 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4722 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.3606 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5293 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.1977 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.5628 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2301 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2949 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7083 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.6790 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5476
 Best site-Painting   | Epoch:5 | Val Acc: 0.9524
 Best site-Painting   | Epoch:5 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4762
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Infograph | Train Loss: 1.1957 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.0796 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4272 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.3732 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.2598 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.0651 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.3200 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.2724 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5972 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.5122 | Train Acc: 0.8889
 Site-Infograph | Val  Loss: 0.8731 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3046 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.3384 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4976 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 0.9587 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.2777 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2370 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.3082 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4361 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4713 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-Painting   | Epoch:6 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5476
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Infograph | Train Loss: 1.1316 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.9156 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.3082 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.2792 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3722 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.1010 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.2259 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1444 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3806 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3833 | Train Acc: 0.9365
 Site-Infograph | Val  Loss: 0.9315 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1626 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.2781 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3115 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.8521 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.3972 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.1284 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1598 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4967 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4946 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4762
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Infograph | Train Loss: 1.0604 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.9197 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.2230 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2566 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.2742 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 1.0171 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.1389 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1402 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3965 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.3781 | Train Acc: 0.9206
 Site-Infograph | Val  Loss: 0.7853 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1408 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.2695 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.2701 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.7288 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.4087 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.1512 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1762 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3838 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3570 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8381
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6429
 Best site-Painting   | Epoch:8 | Val Acc: 0.9048
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5000
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Infograph | Train Loss: 0.9783 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7031 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1604 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1705 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2141 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.0469 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.1681 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1040 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2524 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2465 | Train Acc: 0.9524
 Site-Infograph | Val  Loss: 0.6227 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.8533 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.1870 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2039 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.8665 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.2654 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.0857 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1692 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2792 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2661 | Val  Acc: 0.9524
Average Valid Accuracy: 0.8595
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6905
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5238
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
===2023-03-26 17:00:25===
===2023-03-26 17:00:26===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 3
Loading snapshots...
Test Accuracy of Clipart: 0.7395
Average Test Accuracy: 0.7395
===2023-03-27 22:15:40===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Infograph | Train Loss: 2.2035 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1626 | Train Acc: 0.2698
 Site-Painting  | Train Loss: 1.8950 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.9435 | Train Acc: 0.4603
 Site-QuickDraw | Train Loss: 2.2024 | Train Acc: 0.2540
 Site-QuickDraw | Train Loss: 2.1491 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.8032 | Train Acc: 0.5556
 Site-Real      | Train Loss: 1.9015 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 1.9262 | Train Acc: 0.6190
 Site-Sketch    | Train Loss: 2.0252 | Train Acc: 0.4127
 Site-Infograph | Val  Loss: 2.2155 | Val  Acc: 0.2143
 Site-Infograph | Val  Loss: 2.1815 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.8423 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.9991 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.1838 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2177 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8708 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.8729 | Val  Acc: 0.6190
 Site-Sketch    | Val  Loss: 1.9820 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 2.0266 | Val  Acc: 0.4286
Average Valid Accuracy: 0.3857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Painting   | Epoch:0 | Val Acc: 0.4286
 Best site-Painting   | Epoch:0 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1905
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Real       | Epoch:0 | Val Acc: 0.6190
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Infograph | Train Loss: 2.1593 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.0141 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.4011 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.4408 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1227 | Train Acc: 0.2381
 Site-QuickDraw | Train Loss: 1.9943 | Train Acc: 0.3492
 Site-Real      | Train Loss: 1.2041 | Train Acc: 0.9048
 Site-Real      | Train Loss: 1.3071 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.4562 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.5508 | Train Acc: 0.6349
 Site-Infograph | Val  Loss: 2.0469 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.2744 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 1.3261 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 1.5943 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.9649 | Val  Acc: 0.2619
 Site-QuickDraw | Val  Loss: 2.0389 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.2614 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 1.3515 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.6231 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.5740 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5238
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1429
 Best site-Painting   | Epoch:1 | Val Acc: 0.7619
 Best site-Painting   | Epoch:1 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2619
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3810
 Best site-Real       | Epoch:1 | Val Acc: 0.7381
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Infograph | Train Loss: 1.8791 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.6870 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 0.9855 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 1.0525 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.8839 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 1.7825 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.8001 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.8672 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 1.1824 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 1.1969 | Train Acc: 0.7460
 Site-Infograph | Val  Loss: 1.5998 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9064 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 0.8997 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.2232 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.6832 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.8672 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.8561 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.8481 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.1761 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.2015 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6881
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3095
 Best site-Painting   | Epoch:2 | Val Acc: 0.8810
 Best site-Painting   | Epoch:2 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4524
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Infograph | Train Loss: 1.8949 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.6720 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 0.7276 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.7389 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.8578 | Train Acc: 0.3492
 Site-QuickDraw | Train Loss: 1.6201 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.5188 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.5876 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.8405 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.8624 | Train Acc: 0.7937
 Site-Infograph | Val  Loss: 1.5578 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9878 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 0.6295 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.8488 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4470 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.8910 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4831 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.5371 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.9155 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 0.9374 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6833
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Infograph | Train Loss: 1.6417 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.3197 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.5391 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.5871 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.4739 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.2910 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.3626 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.3343 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.5891 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.7178 | Train Acc: 0.8254
 Site-Infograph | Val  Loss: 1.4815 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7413 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.4202 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.6290 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.1331 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.5029 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.3202 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.4117 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.7119 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.7484 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7738
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4048
 Best site-Painting   | Epoch:4 | Val Acc: 0.9286
 Best site-Painting   | Epoch:4 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4762
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Real       | Epoch:4 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Infograph | Train Loss: 1.4275 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.1774 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.3699 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.4113 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.3968 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 1.2924 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.2321 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.2402 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5059 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5127 | Train Acc: 0.9365
 Site-Infograph | Val  Loss: 1.1347 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3495 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2952 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4289 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.1579 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.5814 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.1905 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2657 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.6099 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6410 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7857
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6190
 Best site-Painting   | Epoch:5 | Val Acc: 0.9524
 Best site-Painting   | Epoch:5 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4524
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Infograph | Train Loss: 1.1739 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 0.9326 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3182 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2922 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1550 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.0184 | Train Acc: 0.7143
 Site-Real      | Train Loss: 0.2386 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.2184 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5013 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.4420 | Train Acc: 0.9365
 Site-Infograph | Val  Loss: 0.7702 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.2091 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2513 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.4057 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.8962 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.1323 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.1658 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2695 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3610 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4261 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8548
 Best site-Infograph  | Epoch:6 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6190
 Best site-Painting   | Epoch:6 | Val Acc: 0.9762
 Best site-Painting   | Epoch:6 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6429
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Infograph | Train Loss: 1.0052 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.7669 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2160 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2118 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.1985 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.0121 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1885 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1080 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2511 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3352 | Train Acc: 0.9365
 Site-Infograph | Val  Loss: 0.7128 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9859 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.2042 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.2483 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.7593 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.3021 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1049 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1217 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3753 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4272 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8452
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Infograph | Train Loss: 0.9743 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7601 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.1363 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1770 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.1234 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 0.9059 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.0994 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1175 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2626 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3271 | Train Acc: 0.9048
 Site-Infograph | Val  Loss: 0.6989 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9255 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.1660 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2069 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.6529 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.2338 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1194 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1657 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3173 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3097 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8667
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6905
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5238
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Infograph | Train Loss: 0.9150 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.6248 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.1065 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1304 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.0767 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 0.9280 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1572 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0778 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.1727 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2346 | Train Acc: 0.9365
 Site-Infograph | Val  Loss: 0.5609 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.8018 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.1480 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.1461 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.8208 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.1564 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1155 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1589 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2221 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.2244 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8690
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7619
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5476
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Clipart...
===2023-03-27 22:42:44===
===2023-03-27 22:42:45===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of Clipart: 0.7243
Average Test Accuracy: 0.7243
