===2023-08-17 16:20:05===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 6
data_number=[6,11,17,28,45,72,116,186,298,477,18,29,46,74,119,191,306,53,85,136,217,59,95,152,73,118,120,
client_nums=[10,7,4,3,2,1,]
len_dataset=[2103,1314,821,513,320,200,]
domain number = 6
============ Train epoch 0 ============
cnt=[10, 2, 7, 1, 3, 4, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (3) | Train Loss: 2.1167 | Train Acc: 0.0000
 Site-Clipart                   (0) | Train Loss: 2.1443 | Train Acc: 0.2727
 Site-Clipart                   (0) | Train Loss: 2.0518 | Train Acc: 0.2941
 Site-Clipart                   (0) | Train Loss: 2.0777 | Train Acc: 0.2857
 Site-Clipart                   (0) | Train Loss: 2.0901 | Train Acc: 0.4444
 Site-Clipart                   (0) | Train Loss: 2.1012 | Train Acc: 0.2778
 Site-Clipart                   (0) | Train Loss: 2.0969 | Train Acc: 0.3103
 Site-Clipart                   (0) | Train Loss: 2.0803 | Train Acc: 0.3548
 Site-Clipart                   (0) | Train Loss: 2.0277 | Train Acc: 0.4329
 Site-Clipart                   (0) | Train Loss: 2.0464 | Train Acc: 0.3585
 Site-Real                      (2) | Train Loss: 2.1069 | Train Acc: 0.2778
 Site-Real                      (2) | Train Loss: 1.8940 | Train Acc: 0.5172
 Site-Real                      (2) | Train Loss: 1.9387 | Train Acc: 0.5217
 Site-Real                      (2) | Train Loss: 1.9823 | Train Acc: 0.5000
 Site-Real                      (2) | Train Loss: 1.9848 | Train Acc: 0.4538
 Site-Real                      (2) | Train Loss: 1.9565 | Train Acc: 0.4712
 Site-Real                      (2) | Train Loss: 2.0155 | Train Acc: 0.4608
 Site-Painting                  (5) | Train Loss: 2.1621 | Train Acc: 0.1887
 Site-Painting                  (5) | Train Loss: 2.0504 | Train Acc: 0.3765
 Site-Painting                  (5) | Train Loss: 2.0952 | Train Acc: 0.3529
 Site-Painting                  (5) | Train Loss: 2.1063 | Train Acc: 0.3410
 Site-Sketch                    (4) | Train Loss: 2.0514 | Train Acc: 0.4237
 Site-Sketch                    (4) | Train Loss: 2.1723 | Train Acc: 0.1895
 Site-Sketch                    (4) | Train Loss: 2.1147 | Train Acc: 0.3355
 Site-QuickDraw                 (1) | Train Loss: 2.3201 | Train Acc: 0.1096
 Site-QuickDraw                 (1) | Train Loss: 2.3248 | Train Acc: 0.1186
 Site-Infograph                 (0) | Train Loss: 2.2800 | Train Acc: 0.1833
Average Train Accuracy: 0.3279
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.0000
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.2727
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.2941
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.2857
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4444
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.2778
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3103
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3548
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4329
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3585
 Best site-Real                      | Epoch:0 | Val Acc: 0.2778
 Best site-Real                      | Epoch:0 | Val Acc: 0.5172
 Best site-Real                      | Epoch:0 | Val Acc: 0.5217
 Best site-Real                      | Epoch:0 | Val Acc: 0.5000
 Best site-Real                      | Epoch:0 | Val Acc: 0.4538
 Best site-Real                      | Epoch:0 | Val Acc: 0.4712
 Best site-Real                      | Epoch:0 | Val Acc: 0.4608
 Best site-Painting                  | Epoch:0 | Val Acc: 0.1887
 Best site-Painting                  | Epoch:0 | Val Acc: 0.3765
 Best site-Painting                  | Epoch:0 | Val Acc: 0.3529
 Best site-Painting                  | Epoch:0 | Val Acc: 0.3410
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.4237
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.1895
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.3355
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.1096
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.1186
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.1833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 1 ============
cnt=[13, 2, 6, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (3) | Train Loss: 1.8797 | Train Acc: 0.5000
 Site-Clipart                   (0) | Train Loss: 1.8792 | Train Acc: 0.2727
 Site-Clipart                   (0) | Train Loss: 1.8139 | Train Acc: 0.4706
 Site-Clipart                   (0) | Train Loss: 1.8427 | Train Acc: 0.4643
 Site-Clipart                   (0) | Train Loss: 1.8005 | Train Acc: 0.6000
 Site-Clipart                   (0) | Train Loss: 1.7282 | Train Acc: 0.5278
 Site-Clipart                   (0) | Train Loss: 1.7562 | Train Acc: 0.5431
 Site-Clipart                   (0) | Train Loss: 1.7873 | Train Acc: 0.5376
 Site-Clipart                   (0) | Train Loss: 1.7600 | Train Acc: 0.5336
 Site-Clipart                   (0) | Train Loss: 1.7403 | Train Acc: 0.5472
 Site-Real                      (5) | Train Loss: 1.7545 | Train Acc: 0.6111
 Site-Real                      (2) | Train Loss: 1.5866 | Train Acc: 0.6552
 Site-Real                      (2) | Train Loss: 1.5531 | Train Acc: 0.7609
 Site-Real                      (2) | Train Loss: 1.5925 | Train Acc: 0.7027
 Site-Real                      (2) | Train Loss: 1.5668 | Train Acc: 0.7647
 Site-Real                      (2) | Train Loss: 1.5334 | Train Acc: 0.7487
 Site-Real                      (2) | Train Loss: 1.6045 | Train Acc: 0.6732
 Site-Painting                  (4) | Train Loss: 1.8623 | Train Acc: 0.4906
 Site-Painting                  (4) | Train Loss: 1.7538 | Train Acc: 0.5647
 Site-Painting                  (4) | Train Loss: 1.8436 | Train Acc: 0.5147
 Site-Painting                  (4) | Train Loss: 1.7531 | Train Acc: 0.5438
 Site-Sketch                    (0) | Train Loss: 1.7720 | Train Acc: 0.5424
 Site-Sketch                    (0) | Train Loss: 1.9424 | Train Acc: 0.4105
 Site-Sketch                    (0) | Train Loss: 1.8188 | Train Acc: 0.5000
 Site-QuickDraw                 (1) | Train Loss: 2.2304 | Train Acc: 0.1233
 Site-QuickDraw                 (1) | Train Loss: 2.3316 | Train Acc: 0.1949
 Site-Infograph                 (0) | Train Loss: 2.2182 | Train Acc: 0.2250
Average Train Accuracy: 0.5194
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.2727
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.4706
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.4643
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6000
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5278
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5431
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5376
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5336
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.5472
 Best site-Real                      | Epoch:1 | Val Acc: 0.6111
 Best site-Real                      | Epoch:1 | Val Acc: 0.6552
 Best site-Real                      | Epoch:1 | Val Acc: 0.7609
 Best site-Real                      | Epoch:1 | Val Acc: 0.7027
 Best site-Real                      | Epoch:1 | Val Acc: 0.7647
 Best site-Real                      | Epoch:1 | Val Acc: 0.7487
 Best site-Real                      | Epoch:1 | Val Acc: 0.6732
 Best site-Painting                  | Epoch:1 | Val Acc: 0.4906
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5647
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5147
 Best site-Painting                  | Epoch:1 | Val Acc: 0.5438
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.5424
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.4105
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.5000
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.1233
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.1949
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.2250
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 2 ============
cnt=[4, 2, 7, 3, 9, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (4) | Train Loss: 1.7666 | Train Acc: 0.5000
 Site-Clipart                   (4) | Train Loss: 1.5447 | Train Acc: 0.6364
 Site-Clipart                   (4) | Train Loss: 1.4892 | Train Acc: 0.7059
 Site-Clipart                   (5) | Train Loss: 1.5785 | Train Acc: 0.5714
 Site-Clipart                   (4) | Train Loss: 1.5117 | Train Acc: 0.6889
 Site-Clipart                   (4) | Train Loss: 1.5504 | Train Acc: 0.6528
 Site-Clipart                   (4) | Train Loss: 1.5310 | Train Acc: 0.6552
 Site-Clipart                   (4) | Train Loss: 1.5461 | Train Acc: 0.6398
 Site-Clipart                   (4) | Train Loss: 1.4853 | Train Acc: 0.6711
 Site-Clipart                   (4) | Train Loss: 1.4940 | Train Acc: 0.6709
 Site-Real                      (2) | Train Loss: 1.4199 | Train Acc: 0.7222
 Site-Real                      (2) | Train Loss: 1.2739 | Train Acc: 0.7931
 Site-Real                      (2) | Train Loss: 1.2549 | Train Acc: 0.8478
 Site-Real                      (2) | Train Loss: 1.2893 | Train Acc: 0.8243
 Site-Real                      (2) | Train Loss: 1.2417 | Train Acc: 0.8403
 Site-Real                      (2) | Train Loss: 1.2273 | Train Acc: 0.8429
 Site-Real                      (2) | Train Loss: 1.3035 | Train Acc: 0.7974
 Site-Painting                  (0) | Train Loss: 1.6217 | Train Acc: 0.6981
 Site-Painting                  (0) | Train Loss: 1.4756 | Train Acc: 0.6941
 Site-Painting                  (0) | Train Loss: 1.5267 | Train Acc: 0.6544
 Site-Painting                  (0) | Train Loss: 1.4576 | Train Acc: 0.6774
 Site-Sketch                    (3) | Train Loss: 1.5069 | Train Acc: 0.6102
 Site-Sketch                    (3) | Train Loss: 1.7008 | Train Acc: 0.5684
 Site-Sketch                    (3) | Train Loss: 1.5972 | Train Acc: 0.5592
 Site-QuickDraw                 (1) | Train Loss: 2.1870 | Train Acc: 0.2329
 Site-QuickDraw                 (1) | Train Loss: 2.2264 | Train Acc: 0.2881
 Site-Infograph                 (5) | Train Loss: 2.1217 | Train Acc: 0.2750
Average Train Accuracy: 0.6414
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6364
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7059
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.5714
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6889
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6528
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6552
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6398
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6711
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6709
 Best site-Real                      | Epoch:2 | Val Acc: 0.7222
 Best site-Real                      | Epoch:2 | Val Acc: 0.7931
 Best site-Real                      | Epoch:2 | Val Acc: 0.8478
 Best site-Real                      | Epoch:2 | Val Acc: 0.8243
 Best site-Real                      | Epoch:2 | Val Acc: 0.8403
 Best site-Real                      | Epoch:2 | Val Acc: 0.8429
 Best site-Real                      | Epoch:2 | Val Acc: 0.7974
 Best site-Painting                  | Epoch:2 | Val Acc: 0.6981
 Best site-Painting                  | Epoch:2 | Val Acc: 0.6941
 Best site-Painting                  | Epoch:2 | Val Acc: 0.6544
 Best site-Painting                  | Epoch:2 | Val Acc: 0.6774
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.6102
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.5684
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.5592
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.2329
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.2881
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.2750
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 3 ============
cnt=[3, 7, 7, 2, 1, 7, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (4) | Train Loss: 1.4202 | Train Acc: 0.5000
 Site-Clipart                   (5) | Train Loss: 1.3264 | Train Acc: 0.7273
 Site-Clipart                   (0) | Train Loss: 1.2235 | Train Acc: 0.7059
 Site-Clipart                   (1) | Train Loss: 1.2498 | Train Acc: 0.7143
 Site-Clipart                   (5) | Train Loss: 1.3544 | Train Acc: 0.7111
 Site-Clipart                   (5) | Train Loss: 1.3308 | Train Acc: 0.7222
 Site-Clipart                   (0) | Train Loss: 1.2634 | Train Acc: 0.7845
 Site-Clipart                   (0) | Train Loss: 1.3267 | Train Acc: 0.7151
 Site-Clipart                   (1) | Train Loss: 1.1964 | Train Acc: 0.7483
 Site-Clipart                   (5) | Train Loss: 1.2552 | Train Acc: 0.7568
 Site-Real                      (2) | Train Loss: 1.2467 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 1.0709 | Train Acc: 0.8966
 Site-Real                      (2) | Train Loss: 1.0184 | Train Acc: 0.8913
 Site-Real                      (2) | Train Loss: 1.0621 | Train Acc: 0.8378
 Site-Real                      (2) | Train Loss: 0.9954 | Train Acc: 0.8824
 Site-Real                      (2) | Train Loss: 0.9571 | Train Acc: 0.8848
 Site-Real                      (2) | Train Loss: 1.0374 | Train Acc: 0.8497
 Site-Painting                  (1) | Train Loss: 1.3373 | Train Acc: 0.7358
 Site-Painting                  (1) | Train Loss: 1.2212 | Train Acc: 0.8118
 Site-Painting                  (1) | Train Loss: 1.2687 | Train Acc: 0.7426
 Site-Painting                  (1) | Train Loss: 1.2056 | Train Acc: 0.7742
 Site-Sketch                    (5) | Train Loss: 1.2418 | Train Acc: 0.7119
 Site-Sketch                    (5) | Train Loss: 1.4070 | Train Acc: 0.6947
 Site-Sketch                    (5) | Train Loss: 1.3233 | Train Acc: 0.6447
 Site-QuickDraw                 (3) | Train Loss: 2.3142 | Train Acc: 0.1918
 Site-QuickDraw                 (3) | Train Loss: 2.1708 | Train Acc: 0.3220
 Site-Infograph                 (1) | Train Loss: 2.0269 | Train Acc: 0.3333
Average Train Accuracy: 0.7083
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.5000
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7273
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7059
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7111
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7222
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7845
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7151
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7483
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7568
 Best site-Real                      | Epoch:3 | Val Acc: 0.8333
 Best site-Real                      | Epoch:3 | Val Acc: 0.8966
 Best site-Real                      | Epoch:3 | Val Acc: 0.8913
 Best site-Real                      | Epoch:3 | Val Acc: 0.8378
 Best site-Real                      | Epoch:3 | Val Acc: 0.8824
 Best site-Real                      | Epoch:3 | Val Acc: 0.8848
 Best site-Real                      | Epoch:3 | Val Acc: 0.8497
 Best site-Painting                  | Epoch:3 | Val Acc: 0.7358
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8118
 Best site-Painting                  | Epoch:3 | Val Acc: 0.7426
 Best site-Painting                  | Epoch:3 | Val Acc: 0.7742
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7119
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.6947
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.6447
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.1918
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.3220
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 4 ============
cnt=[7, 2, 5, 7, 5, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (5) | Train Loss: 1.2092 | Train Acc: 0.5000
 Site-Clipart                   (3) | Train Loss: 1.1794 | Train Acc: 0.7273
 Site-Clipart                   (0) | Train Loss: 0.9924 | Train Acc: 0.8235
 Site-Clipart                   (0) | Train Loss: 1.1217 | Train Acc: 0.7857
 Site-Clipart                   (0) | Train Loss: 1.1037 | Train Acc: 0.7333
 Site-Clipart                   (0) | Train Loss: 1.1834 | Train Acc: 0.7639
 Site-Clipart                   (3) | Train Loss: 1.0268 | Train Acc: 0.8190
 Site-Clipart                   (3) | Train Loss: 1.0903 | Train Acc: 0.8065
 Site-Clipart                   (0) | Train Loss: 1.0450 | Train Acc: 0.8087
 Site-Clipart                   (3) | Train Loss: 1.0364 | Train Acc: 0.8260
 Site-Real                      (2) | Train Loss: 1.0250 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.9174 | Train Acc: 0.8966
 Site-Real                      (4) | Train Loss: 0.8557 | Train Acc: 0.9565
 Site-Real                      (4) | Train Loss: 0.8991 | Train Acc: 0.8784
 Site-Real                      (2) | Train Loss: 0.7819 | Train Acc: 0.9160
 Site-Real                      (2) | Train Loss: 0.7819 | Train Acc: 0.9215
 Site-Real                      (2) | Train Loss: 0.8467 | Train Acc: 0.8824
 Site-Painting                  (0) | Train Loss: 1.2603 | Train Acc: 0.7547
 Site-Painting                  (4) | Train Loss: 1.0371 | Train Acc: 0.8118
 Site-Painting                  (4) | Train Loss: 1.0493 | Train Acc: 0.8235
 Site-Painting                  (4) | Train Loss: 1.0170 | Train Acc: 0.8249
 Site-Sketch                    (3) | Train Loss: 1.0738 | Train Acc: 0.7797
 Site-Sketch                    (3) | Train Loss: 1.2434 | Train Acc: 0.7368
 Site-Sketch                    (3) | Train Loss: 1.1893 | Train Acc: 0.7237
 Site-QuickDraw                 (1) | Train Loss: 2.1999 | Train Acc: 0.2192
 Site-QuickDraw                 (1) | Train Loss: 2.0905 | Train Acc: 0.3051
 Site-Infograph                 (0) | Train Loss: 1.8633 | Train Acc: 0.4083
Average Train Accuracy: 0.7485
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.5000
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7273
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8235
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7857
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7333
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7639
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8190
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8065
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8087
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8260
 Best site-Real                      | Epoch:4 | Val Acc: 0.7778
 Best site-Real                      | Epoch:4 | Val Acc: 0.8966
 Best site-Real                      | Epoch:4 | Val Acc: 0.9565
 Best site-Real                      | Epoch:4 | Val Acc: 0.8784
 Best site-Real                      | Epoch:4 | Val Acc: 0.9160
 Best site-Real                      | Epoch:4 | Val Acc: 0.9215
 Best site-Real                      | Epoch:4 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:4 | Val Acc: 0.7547
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8118
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8235
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8249
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7797
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7368
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7237
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.2192
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.3051
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.4083
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 5 ============
cnt=[6, 9, 2, 6, 3, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 1.1072 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.8728 | Train Acc: 0.8182
 Site-Clipart                   (3) | Train Loss: 0.7437 | Train Acc: 0.8824
 Site-Clipart                   (0) | Train Loss: 0.9908 | Train Acc: 0.7857
 Site-Clipart                   (0) | Train Loss: 0.9913 | Train Acc: 0.8000
 Site-Clipart                   (0) | Train Loss: 0.9449 | Train Acc: 0.7917
 Site-Clipart                   (3) | Train Loss: 0.8374 | Train Acc: 0.8621
 Site-Clipart                   (3) | Train Loss: 0.9494 | Train Acc: 0.8172
 Site-Clipart                   (0) | Train Loss: 0.8977 | Train Acc: 0.8255
 Site-Clipart                   (3) | Train Loss: 0.9080 | Train Acc: 0.8344
 Site-Real                      (5) | Train Loss: 0.9514 | Train Acc: 0.7778
 Site-Real                      (1) | Train Loss: 0.7546 | Train Acc: 0.8966
 Site-Real                      (1) | Train Loss: 0.6687 | Train Acc: 0.9348
 Site-Real                      (1) | Train Loss: 0.6879 | Train Acc: 0.9054
 Site-Real                      (1) | Train Loss: 0.6516 | Train Acc: 0.9244
 Site-Real                      (1) | Train Loss: 0.6371 | Train Acc: 0.9319
 Site-Real                      (1) | Train Loss: 0.6952 | Train Acc: 0.9150
 Site-Painting                  (1) | Train Loss: 1.0797 | Train Acc: 0.7358
 Site-Painting                  (0) | Train Loss: 0.8857 | Train Acc: 0.8353
 Site-Painting                  (1) | Train Loss: 0.9189 | Train Acc: 0.8456
 Site-Painting                  (1) | Train Loss: 0.8447 | Train Acc: 0.8756
 Site-Sketch                    (3) | Train Loss: 0.8893 | Train Acc: 0.8136
 Site-Sketch                    (4) | Train Loss: 1.0416 | Train Acc: 0.8000
 Site-Sketch                    (4) | Train Loss: 1.0244 | Train Acc: 0.7303
 Site-QuickDraw                 (2) | Train Loss: 2.0589 | Train Acc: 0.2603
 Site-QuickDraw                 (2) | Train Loss: 1.9885 | Train Acc: 0.3305
 Site-Infograph                 (0) | Train Loss: 1.8577 | Train Acc: 0.3917
Average Train Accuracy: 0.7773
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8000
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7917
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8621
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8172
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8255
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8344
 Best site-Real                      | Epoch:5 | Val Acc: 0.7778
 Best site-Real                      | Epoch:5 | Val Acc: 0.8966
 Best site-Real                      | Epoch:5 | Val Acc: 0.9348
 Best site-Real                      | Epoch:5 | Val Acc: 0.9054
 Best site-Real                      | Epoch:5 | Val Acc: 0.9244
 Best site-Real                      | Epoch:5 | Val Acc: 0.9319
 Best site-Real                      | Epoch:5 | Val Acc: 0.9150
 Best site-Painting                  | Epoch:5 | Val Acc: 0.7358
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8353
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8456
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8756
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8136
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8000
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7303
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.2603
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.3305
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.3917
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 6 ============
cnt=[7, 5, 2, 6, 4, 3, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (0) | Train Loss: 1.0355 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.7705 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.6842 | Train Acc: 0.8235
 Site-Clipart                   (5) | Train Loss: 0.8502 | Train Acc: 0.7857
 Site-Clipart                   (4) | Train Loss: 0.8475 | Train Acc: 0.8222
 Site-Clipart                   (0) | Train Loss: 0.7890 | Train Acc: 0.7917
 Site-Clipart                   (4) | Train Loss: 0.7785 | Train Acc: 0.8534
 Site-Clipart                   (4) | Train Loss: 0.8819 | Train Acc: 0.8226
 Site-Clipart                   (4) | Train Loss: 0.8103 | Train Acc: 0.8322
 Site-Clipart                   (0) | Train Loss: 0.8174 | Train Acc: 0.8302
 Site-Real                      (3) | Train Loss: 0.9197 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.6529 | Train Acc: 0.9655
 Site-Real                      (3) | Train Loss: 0.5185 | Train Acc: 0.9348
 Site-Real                      (1) | Train Loss: 0.6333 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.5636 | Train Acc: 0.9496
 Site-Real                      (3) | Train Loss: 0.5615 | Train Acc: 0.9372
 Site-Real                      (3) | Train Loss: 0.6196 | Train Acc: 0.9248
 Site-Painting                  (1) | Train Loss: 0.9140 | Train Acc: 0.8302
 Site-Painting                  (1) | Train Loss: 0.7595 | Train Acc: 0.8588
 Site-Painting                  (1) | Train Loss: 0.8220 | Train Acc: 0.8603
 Site-Painting                  (1) | Train Loss: 0.7511 | Train Acc: 0.8710
 Site-Sketch                    (0) | Train Loss: 0.8030 | Train Acc: 0.8475
 Site-Sketch                    (0) | Train Loss: 0.9207 | Train Acc: 0.8316
 Site-Sketch                    (0) | Train Loss: 0.9669 | Train Acc: 0.7171
 Site-QuickDraw                 (2) | Train Loss: 1.8794 | Train Acc: 0.3288
 Site-QuickDraw                 (2) | Train Loss: 1.9235 | Train Acc: 0.3305
 Site-Infograph                 (5) | Train Loss: 1.7089 | Train Acc: 0.4750
Average Train Accuracy: 0.7967
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8235
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7857
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8222
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7917
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8534
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8226
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8322
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8302
 Best site-Real                      | Epoch:6 | Val Acc: 0.7778
 Best site-Real                      | Epoch:6 | Val Acc: 0.9655
 Best site-Real                      | Epoch:6 | Val Acc: 0.9348
 Best site-Real                      | Epoch:6 | Val Acc: 0.9324
 Best site-Real                      | Epoch:6 | Val Acc: 0.9496
 Best site-Real                      | Epoch:6 | Val Acc: 0.9372
 Best site-Real                      | Epoch:6 | Val Acc: 0.9248
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8302
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8588
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8603
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8710
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8475
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8316
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.7171
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.3288
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.3305
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.4750
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 7 ============
cnt=[8, 7, 2, 2, 3, 5, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (0) | Train Loss: 1.0586 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.5558 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.6220 | Train Acc: 0.8235
 Site-Clipart                   (5) | Train Loss: 0.7654 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.7870 | Train Acc: 0.8000
 Site-Clipart                   (0) | Train Loss: 0.7320 | Train Acc: 0.8056
 Site-Clipart                   (0) | Train Loss: 0.6936 | Train Acc: 0.9138
 Site-Clipart                   (0) | Train Loss: 0.7555 | Train Acc: 0.8602
 Site-Clipart                   (5) | Train Loss: 0.6769 | Train Acc: 0.8557
 Site-Clipart                   (0) | Train Loss: 0.7384 | Train Acc: 0.8637
 Site-Real                      (3) | Train Loss: 0.8598 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.5657 | Train Acc: 0.9310
 Site-Real                      (1) | Train Loss: 0.4697 | Train Acc: 0.9565
 Site-Real                      (1) | Train Loss: 0.5520 | Train Acc: 0.9324
 Site-Real                      (1) | Train Loss: 0.4722 | Train Acc: 0.9496
 Site-Real                      (1) | Train Loss: 0.4790 | Train Acc: 0.9476
 Site-Real                      (1) | Train Loss: 0.5511 | Train Acc: 0.9020
 Site-Painting                  (5) | Train Loss: 0.9098 | Train Acc: 0.8491
 Site-Painting                  (1) | Train Loss: 0.6740 | Train Acc: 0.9059
 Site-Painting                  (1) | Train Loss: 0.7490 | Train Acc: 0.8456
 Site-Painting                  (5) | Train Loss: 0.6954 | Train Acc: 0.8618
 Site-Sketch                    (4) | Train Loss: 0.7188 | Train Acc: 0.8305
 Site-Sketch                    (4) | Train Loss: 0.8364 | Train Acc: 0.7895
 Site-Sketch                    (0) | Train Loss: 0.8273 | Train Acc: 0.7961
 Site-QuickDraw                 (2) | Train Loss: 1.8905 | Train Acc: 0.3288
 Site-QuickDraw                 (2) | Train Loss: 1.7817 | Train Acc: 0.4407
 Site-Infograph                 (5) | Train Loss: 1.6778 | Train Acc: 0.5083
Average Train Accuracy: 0.8114
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8235
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8000
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8056
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9138
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8602
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8557
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8637
 Best site-Real                      | Epoch:7 | Val Acc: 0.7778
 Best site-Real                      | Epoch:7 | Val Acc: 0.9310
 Best site-Real                      | Epoch:7 | Val Acc: 0.9565
 Best site-Real                      | Epoch:7 | Val Acc: 0.9324
 Best site-Real                      | Epoch:7 | Val Acc: 0.9496
 Best site-Real                      | Epoch:7 | Val Acc: 0.9476
 Best site-Real                      | Epoch:7 | Val Acc: 0.9020
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8491
 Best site-Painting                  | Epoch:7 | Val Acc: 0.9059
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8456
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8618
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8305
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.7895
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.7961
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.3288
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.4407
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.5083
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 8 ============
cnt=[3, 12, 2, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (1) | Train Loss: 1.0425 | Train Acc: 0.6667
 Site-Clipart                   (1) | Train Loss: 0.6212 | Train Acc: 0.8182
 Site-Clipart                   (1) | Train Loss: 0.4913 | Train Acc: 0.8824
 Site-Clipart                   (5) | Train Loss: 0.6213 | Train Acc: 0.8571
 Site-Clipart                   (1) | Train Loss: 0.7759 | Train Acc: 0.8667
 Site-Clipart                   (1) | Train Loss: 0.6626 | Train Acc: 0.8056
 Site-Clipart                   (1) | Train Loss: 0.5855 | Train Acc: 0.9052
 Site-Clipart                   (1) | Train Loss: 0.7322 | Train Acc: 0.8441
 Site-Clipart                   (1) | Train Loss: 0.6665 | Train Acc: 0.8490
 Site-Clipart                   (1) | Train Loss: 0.6750 | Train Acc: 0.8616
 Site-Real                      (2) | Train Loss: 0.7974 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.4793 | Train Acc: 0.9655
 Site-Real                      (5) | Train Loss: 0.4171 | Train Acc: 0.9348
 Site-Real                      (3) | Train Loss: 0.5043 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.4584 | Train Acc: 0.9496
 Site-Real                      (3) | Train Loss: 0.4416 | Train Acc: 0.9372
 Site-Real                      (3) | Train Loss: 0.5013 | Train Acc: 0.9281
 Site-Painting                  (0) | Train Loss: 0.7719 | Train Acc: 0.8302
 Site-Painting                  (5) | Train Loss: 0.6893 | Train Acc: 0.8706
 Site-Painting                  (5) | Train Loss: 0.6512 | Train Acc: 0.8603
 Site-Painting                  (0) | Train Loss: 0.6485 | Train Acc: 0.8618
 Site-Sketch                    (1) | Train Loss: 0.7266 | Train Acc: 0.8136
 Site-Sketch                    (1) | Train Loss: 0.7653 | Train Acc: 0.8211
 Site-Sketch                    (1) | Train Loss: 0.8378 | Train Acc: 0.7697
 Site-QuickDraw                 (4) | Train Loss: 1.6791 | Train Acc: 0.4384
 Site-QuickDraw                 (4) | Train Loss: 1.6490 | Train Acc: 0.4915
 Site-Infograph                 (0) | Train Loss: 1.6788 | Train Acc: 0.4417
Average Train Accuracy: 0.8141
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8667
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8056
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9052
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8441
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8490
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8616
 Best site-Real                      | Epoch:8 | Val Acc: 0.7778
 Best site-Real                      | Epoch:8 | Val Acc: 0.9655
 Best site-Real                      | Epoch:8 | Val Acc: 0.9348
 Best site-Real                      | Epoch:8 | Val Acc: 0.9324
 Best site-Real                      | Epoch:8 | Val Acc: 0.9496
 Best site-Real                      | Epoch:8 | Val Acc: 0.9372
 Best site-Real                      | Epoch:8 | Val Acc: 0.9281
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8302
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8706
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8603
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8618
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8136
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8211
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.7697
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.4384
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.4915
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.4417
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 9 ============
cnt=[10, 6, 3, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (5) | Train Loss: 1.1086 | Train Acc: 0.6667
 Site-Clipart                   (1) | Train Loss: 0.7045 | Train Acc: 0.8182
 Site-Clipart                   (1) | Train Loss: 0.4178 | Train Acc: 0.8824
 Site-Clipart                   (0) | Train Loss: 0.6067 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.7408 | Train Acc: 0.8000
 Site-Clipart                   (0) | Train Loss: 0.6250 | Train Acc: 0.8472
 Site-Clipart                   (5) | Train Loss: 0.5951 | Train Acc: 0.8707
 Site-Clipart                   (1) | Train Loss: 0.6478 | Train Acc: 0.8548
 Site-Clipart                   (5) | Train Loss: 0.6253 | Train Acc: 0.8557
 Site-Clipart                   (5) | Train Loss: 0.6081 | Train Acc: 0.8742
 Site-Real                      (4) | Train Loss: 0.7572 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.4582 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.3401 | Train Acc: 0.9565
 Site-Real                      (0) | Train Loss: 0.3992 | Train Acc: 0.9324
 Site-Real                      (2) | Train Loss: 0.4002 | Train Acc: 0.9496
 Site-Real                      (0) | Train Loss: 0.4282 | Train Acc: 0.9267
 Site-Real                      (0) | Train Loss: 0.4536 | Train Acc: 0.9281
 Site-Painting                  (0) | Train Loss: 0.8117 | Train Acc: 0.8679
 Site-Painting                  (0) | Train Loss: 0.5769 | Train Acc: 0.8941
 Site-Painting                  (0) | Train Loss: 0.7152 | Train Acc: 0.8750
 Site-Painting                  (0) | Train Loss: 0.5849 | Train Acc: 0.8802
 Site-Sketch                    (1) | Train Loss: 0.5956 | Train Acc: 0.8983
 Site-Sketch                    (1) | Train Loss: 0.7348 | Train Acc: 0.8211
 Site-Sketch                    (1) | Train Loss: 0.7500 | Train Acc: 0.7829
 Site-QuickDraw                 (3) | Train Loss: 1.6597 | Train Acc: 0.5068
 Site-QuickDraw                 (3) | Train Loss: 1.5482 | Train Acc: 0.5847
 Site-Infograph                 (0) | Train Loss: 1.5887 | Train Acc: 0.4750
Average Train Accuracy: 0.8265
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8824
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8000
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8472
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8707
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8548
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8557
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8742
 Best site-Real                      | Epoch:9 | Val Acc: 0.7778
 Best site-Real                      | Epoch:9 | Val Acc: 0.9310
 Best site-Real                      | Epoch:9 | Val Acc: 0.9565
 Best site-Real                      | Epoch:9 | Val Acc: 0.9324
 Best site-Real                      | Epoch:9 | Val Acc: 0.9496
 Best site-Real                      | Epoch:9 | Val Acc: 0.9267
 Best site-Real                      | Epoch:9 | Val Acc: 0.9281
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8941
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8750
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8802
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8211
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.7829
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.5068
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.5847
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.4750
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 10 ============
cnt=[4, 6, 8, 2, 2, 5, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (2) | Train Loss: 1.0005 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.4307 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.3660 | Train Acc: 0.9412
 Site-Clipart                   (1) | Train Loss: 0.7064 | Train Acc: 0.7857
 Site-Clipart                   (1) | Train Loss: 0.5629 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.6577 | Train Acc: 0.8750
 Site-Clipart                   (1) | Train Loss: 0.5273 | Train Acc: 0.9224
 Site-Clipart                   (2) | Train Loss: 0.6265 | Train Acc: 0.8441
 Site-Clipart                   (1) | Train Loss: 0.5693 | Train Acc: 0.8758
 Site-Clipart                   (2) | Train Loss: 0.5836 | Train Acc: 0.8616
 Site-Real                      (0) | Train Loss: 0.7436 | Train Acc: 0.7778
 Site-Real                      (4) | Train Loss: 0.4279 | Train Acc: 0.9310
 Site-Real                      (4) | Train Loss: 0.3757 | Train Acc: 0.9565
 Site-Real                      (5) | Train Loss: 0.5132 | Train Acc: 0.9054
 Site-Real                      (0) | Train Loss: 0.3647 | Train Acc: 0.9496
 Site-Real                      (5) | Train Loss: 0.3863 | Train Acc: 0.9581
 Site-Real                      (0) | Train Loss: 0.4276 | Train Acc: 0.9248
 Site-Painting                  (5) | Train Loss: 0.7186 | Train Acc: 0.8302
 Site-Painting                  (0) | Train Loss: 0.6033 | Train Acc: 0.8824
 Site-Painting                  (5) | Train Loss: 0.5672 | Train Acc: 0.8824
 Site-Painting                  (5) | Train Loss: 0.5181 | Train Acc: 0.8894
 Site-Sketch                    (1) | Train Loss: 0.6358 | Train Acc: 0.8644
 Site-Sketch                    (2) | Train Loss: 0.6728 | Train Acc: 0.8632
 Site-Sketch                    (2) | Train Loss: 0.7447 | Train Acc: 0.7895
 Site-QuickDraw                 (3) | Train Loss: 1.6293 | Train Acc: 0.5753
 Site-QuickDraw                 (3) | Train Loss: 1.4694 | Train Acc: 0.5339
 Site-Infograph                 (1) | Train Loss: 1.5326 | Train Acc: 0.5417
Average Train Accuracy: 0.8380
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.7857
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8750
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9224
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8441
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8758
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8616
 Best site-Real                      | Epoch:10 | Val Acc: 0.7778
 Best site-Real                      | Epoch:10 | Val Acc: 0.9310
 Best site-Real                      | Epoch:10 | Val Acc: 0.9565
 Best site-Real                      | Epoch:10 | Val Acc: 0.9054
 Best site-Real                      | Epoch:10 | Val Acc: 0.9496
 Best site-Real                      | Epoch:10 | Val Acc: 0.9581
 Best site-Real                      | Epoch:10 | Val Acc: 0.9248
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8302
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8894
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8644
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8632
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.7895
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.5753
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.5339
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.5417
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 11 ============
cnt=[8, 5, 2, 4, 2, 6, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.9778 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.4125 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.3539 | Train Acc: 0.8824
 Site-Clipart                   (5) | Train Loss: 0.6235 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.6483 | Train Acc: 0.8889
 Site-Clipart                   (0) | Train Loss: 0.5174 | Train Acc: 0.8472
 Site-Clipart                   (0) | Train Loss: 0.4789 | Train Acc: 0.8793
 Site-Clipart                   (0) | Train Loss: 0.5943 | Train Acc: 0.8602
 Site-Clipart                   (5) | Train Loss: 0.5458 | Train Acc: 0.8758
 Site-Clipart                   (3) | Train Loss: 0.5393 | Train Acc: 0.8847
 Site-Real                      (4) | Train Loss: 0.6859 | Train Acc: 0.7778
 Site-Real                      (4) | Train Loss: 0.3721 | Train Acc: 0.9310
 Site-Real                      (1) | Train Loss: 0.3419 | Train Acc: 0.9565
 Site-Real                      (1) | Train Loss: 0.4017 | Train Acc: 0.9189
 Site-Real                      (1) | Train Loss: 0.3520 | Train Acc: 0.9496
 Site-Real                      (1) | Train Loss: 0.3575 | Train Acc: 0.9424
 Site-Real                      (1) | Train Loss: 0.4112 | Train Acc: 0.9183
 Site-Painting                  (5) | Train Loss: 0.7109 | Train Acc: 0.8113
 Site-Painting                  (5) | Train Loss: 0.5609 | Train Acc: 0.8706
 Site-Painting                  (5) | Train Loss: 0.6102 | Train Acc: 0.8824
 Site-Painting                  (5) | Train Loss: 0.5058 | Train Acc: 0.8894
 Site-Sketch                    (0) | Train Loss: 0.5631 | Train Acc: 0.9153
 Site-Sketch                    (0) | Train Loss: 0.6420 | Train Acc: 0.8105
 Site-Sketch                    (0) | Train Loss: 0.7245 | Train Acc: 0.7961
 Site-QuickDraw                 (2) | Train Loss: 1.4569 | Train Acc: 0.5068
 Site-QuickDraw                 (2) | Train Loss: 1.4808 | Train Acc: 0.5169
 Site-Infograph                 (3) | Train Loss: 1.5137 | Train Acc: 0.5500
Average Train Accuracy: 0.8332
============ Train epoch 12 ============
cnt=[5, 5, 2, 4, 7, 4, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (5) | Train Loss: 0.8929 | Train Acc: 0.6667
 Site-Clipart                   (1) | Train Loss: 0.4173 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.2645 | Train Acc: 0.9412
 Site-Clipart                   (0) | Train Loss: 0.5740 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.5648 | Train Acc: 0.9111
 Site-Clipart                   (5) | Train Loss: 0.6374 | Train Acc: 0.8194
 Site-Clipart                   (5) | Train Loss: 0.5032 | Train Acc: 0.9052
 Site-Clipart                   (5) | Train Loss: 0.5743 | Train Acc: 0.8495
 Site-Clipart                   (0) | Train Loss: 0.5339 | Train Acc: 0.8523
 Site-Clipart                   (0) | Train Loss: 0.5060 | Train Acc: 0.8931
 Site-Real                      (1) | Train Loss: 0.6972 | Train Acc: 0.7778
 Site-Real                      (1) | Train Loss: 0.4152 | Train Acc: 0.9655
 Site-Real                      (1) | Train Loss: 0.2630 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.3627 | Train Acc: 0.9324
 Site-Real                      (1) | Train Loss: 0.3016 | Train Acc: 0.9496
 Site-Real                      (4) | Train Loss: 0.3393 | Train Acc: 0.9529
 Site-Real                      (4) | Train Loss: 0.3974 | Train Acc: 0.9248
 Site-Painting                  (4) | Train Loss: 0.6856 | Train Acc: 0.7925
 Site-Painting                  (4) | Train Loss: 0.5373 | Train Acc: 0.8588
 Site-Painting                  (4) | Train Loss: 0.5256 | Train Acc: 0.9044
 Site-Painting                  (4) | Train Loss: 0.4861 | Train Acc: 0.8894
 Site-Sketch                    (3) | Train Loss: 0.5681 | Train Acc: 0.8475
 Site-Sketch                    (3) | Train Loss: 0.6300 | Train Acc: 0.8105
 Site-Sketch                    (3) | Train Loss: 0.6726 | Train Acc: 0.8092
 Site-QuickDraw                 (2) | Train Loss: 1.4056 | Train Acc: 0.5616
 Site-QuickDraw                 (2) | Train Loss: 1.3951 | Train Acc: 0.5847
 Site-Infograph                 (0) | Train Loss: 1.4939 | Train Acc: 0.4833
Average Train Accuracy: 0.8389
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8194
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9052
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8495
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8523
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8931
 Best site-Real                      | Epoch:12 | Val Acc: 0.7778
 Best site-Real                      | Epoch:12 | Val Acc: 0.9655
 Best site-Real                      | Epoch:12 | Val Acc: 1.0000
 Best site-Real                      | Epoch:12 | Val Acc: 0.9324
 Best site-Real                      | Epoch:12 | Val Acc: 0.9496
 Best site-Real                      | Epoch:12 | Val Acc: 0.9529
 Best site-Real                      | Epoch:12 | Val Acc: 0.9248
 Best site-Painting                  | Epoch:12 | Val Acc: 0.7925
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8588
 Best site-Painting                  | Epoch:12 | Val Acc: 0.9044
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8894
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8475
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8105
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8092
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.5616
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.5847
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.4833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 13 ============
cnt=[7, 5, 2, 7, 2, 4, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (4) | Train Loss: 0.8658 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.4317 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.3375 | Train Acc: 0.9412
 Site-Clipart                   (0) | Train Loss: 0.5117 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.5279 | Train Acc: 0.9111
 Site-Clipart                   (0) | Train Loss: 0.4445 | Train Acc: 0.8472
 Site-Clipart                   (5) | Train Loss: 0.4464 | Train Acc: 0.8879
 Site-Clipart                   (5) | Train Loss: 0.5578 | Train Acc: 0.8602
 Site-Clipart                   (0) | Train Loss: 0.4813 | Train Acc: 0.8859
 Site-Clipart                   (0) | Train Loss: 0.4916 | Train Acc: 0.8952
 Site-Real                      (1) | Train Loss: 0.7153 | Train Acc: 0.7778
 Site-Real                      (1) | Train Loss: 0.3007 | Train Acc: 0.9310
 Site-Real                      (1) | Train Loss: 0.2752 | Train Acc: 0.9348
 Site-Real                      (3) | Train Loss: 0.3543 | Train Acc: 0.9459
 Site-Real                      (1) | Train Loss: 0.2916 | Train Acc: 0.9496
 Site-Real                      (1) | Train Loss: 0.3333 | Train Acc: 0.9424
 Site-Real                      (3) | Train Loss: 0.3661 | Train Acc: 0.9281
 Site-Painting                  (3) | Train Loss: 0.6780 | Train Acc: 0.8302
 Site-Painting                  (3) | Train Loss: 0.5200 | Train Acc: 0.8706
 Site-Painting                  (3) | Train Loss: 0.4920 | Train Acc: 0.8971
 Site-Painting                  (3) | Train Loss: 0.4422 | Train Acc: 0.8940
 Site-Sketch                    (0) | Train Loss: 0.5039 | Train Acc: 0.8814
 Site-Sketch                    (5) | Train Loss: 0.6143 | Train Acc: 0.8421
 Site-Sketch                    (5) | Train Loss: 0.7020 | Train Acc: 0.7895
 Site-QuickDraw                 (2) | Train Loss: 1.3315 | Train Acc: 0.5890
 Site-QuickDraw                 (2) | Train Loss: 1.2821 | Train Acc: 0.5763
 Site-Infograph                 (0) | Train Loss: 1.4837 | Train Acc: 0.5417
Average Train Accuracy: 0.8438
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8472
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8879
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8602
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8859
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8952
 Best site-Real                      | Epoch:13 | Val Acc: 0.7778
 Best site-Real                      | Epoch:13 | Val Acc: 0.9310
 Best site-Real                      | Epoch:13 | Val Acc: 0.9348
 Best site-Real                      | Epoch:13 | Val Acc: 0.9459
 Best site-Real                      | Epoch:13 | Val Acc: 0.9496
 Best site-Real                      | Epoch:13 | Val Acc: 0.9424
 Best site-Real                      | Epoch:13 | Val Acc: 0.9281
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8302
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8706
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8971
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8940
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8421
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.7895
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.5890
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.5763
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.5417
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 14 ============
cnt=[6, 4, 2, 10, 3, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (3) | Train Loss: 0.9001 | Train Acc: 0.6667
 Site-Clipart                   (1) | Train Loss: 0.5536 | Train Acc: 0.9091
 Site-Clipart                   (1) | Train Loss: 0.1886 | Train Acc: 1.0000
 Site-Clipart                   (3) | Train Loss: 0.5530 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.5593 | Train Acc: 0.9111
 Site-Clipart                   (3) | Train Loss: 0.6507 | Train Acc: 0.8472
 Site-Clipart                   (3) | Train Loss: 0.4433 | Train Acc: 0.9224
 Site-Clipart                   (1) | Train Loss: 0.5270 | Train Acc: 0.8763
 Site-Clipart                   (3) | Train Loss: 0.4629 | Train Acc: 0.8859
 Site-Clipart                   (3) | Train Loss: 0.4704 | Train Acc: 0.8910
 Site-Real                      (5) | Train Loss: 0.6568 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.3085 | Train Acc: 0.9310
 Site-Real                      (0) | Train Loss: 0.2186 | Train Acc: 0.9565
 Site-Real                      (0) | Train Loss: 0.3198 | Train Acc: 0.9324
 Site-Real                      (4) | Train Loss: 0.2821 | Train Acc: 0.9664
 Site-Real                      (4) | Train Loss: 0.3137 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.3372 | Train Acc: 0.9314
 Site-Painting                  (0) | Train Loss: 0.6264 | Train Acc: 0.8679
 Site-Painting                  (0) | Train Loss: 0.4647 | Train Acc: 0.8941
 Site-Painting                  (0) | Train Loss: 0.5030 | Train Acc: 0.8529
 Site-Painting                  (0) | Train Loss: 0.4494 | Train Acc: 0.9124
 Site-Sketch                    (3) | Train Loss: 0.4838 | Train Acc: 0.9153
 Site-Sketch                    (1) | Train Loss: 0.5863 | Train Acc: 0.8737
 Site-Sketch                    (3) | Train Loss: 0.6302 | Train Acc: 0.8224
 Site-QuickDraw                 (2) | Train Loss: 1.3266 | Train Acc: 0.6027
 Site-QuickDraw                 (2) | Train Loss: 1.2507 | Train Acc: 0.6102
 Site-Infograph                 (3) | Train Loss: 1.4745 | Train Acc: 0.5583
Average Train Accuracy: 0.8563
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8472
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9224
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8763
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8859
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8910
 Best site-Real                      | Epoch:14 | Val Acc: 0.7778
 Best site-Real                      | Epoch:14 | Val Acc: 0.9310
 Best site-Real                      | Epoch:14 | Val Acc: 0.9565
 Best site-Real                      | Epoch:14 | Val Acc: 0.9324
 Best site-Real                      | Epoch:14 | Val Acc: 0.9664
 Best site-Real                      | Epoch:14 | Val Acc: 0.9476
 Best site-Real                      | Epoch:14 | Val Acc: 0.9314
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8941
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8529
 Best site-Painting                  | Epoch:14 | Val Acc: 0.9124
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.9153
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8737
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8224
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.6027
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.6102
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.5583
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 15 ============
cnt=[6, 11, 2, 6, 1, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (1) | Train Loss: 1.0371 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 0.5065 | Train Acc: 0.9091
 Site-Clipart                   (1) | Train Loss: 0.1872 | Train Acc: 1.0000
 Site-Clipart                   (3) | Train Loss: 0.4538 | Train Acc: 0.8929
 Site-Clipart                   (3) | Train Loss: 0.4619 | Train Acc: 0.8889
 Site-Clipart                   (1) | Train Loss: 0.5416 | Train Acc: 0.8194
 Site-Clipart                   (1) | Train Loss: 0.3799 | Train Acc: 0.9310
 Site-Clipart                   (1) | Train Loss: 0.4830 | Train Acc: 0.8710
 Site-Clipart                   (1) | Train Loss: 0.4584 | Train Acc: 0.8926
 Site-Clipart                   (1) | Train Loss: 0.4528 | Train Acc: 0.8868
 Site-Real                      (4) | Train Loss: 0.6987 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.3075 | Train Acc: 0.9655
 Site-Real                      (0) | Train Loss: 0.2370 | Train Acc: 0.9565
 Site-Real                      (3) | Train Loss: 0.3216 | Train Acc: 0.9459
 Site-Real                      (0) | Train Loss: 0.2683 | Train Acc: 0.9664
 Site-Real                      (0) | Train Loss: 0.3114 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.3175 | Train Acc: 0.9346
 Site-Painting                  (3) | Train Loss: 0.5872 | Train Acc: 0.8679
 Site-Painting                  (3) | Train Loss: 0.4764 | Train Acc: 0.8941
 Site-Painting                  (0) | Train Loss: 0.5196 | Train Acc: 0.8750
 Site-Painting                  (3) | Train Loss: 0.4272 | Train Acc: 0.9078
 Site-Sketch                    (1) | Train Loss: 0.4611 | Train Acc: 0.9153
 Site-Sketch                    (1) | Train Loss: 0.5943 | Train Acc: 0.8211
 Site-Sketch                    (1) | Train Loss: 0.6027 | Train Acc: 0.8026
 Site-QuickDraw                 (2) | Train Loss: 1.2071 | Train Acc: 0.6575
 Site-QuickDraw                 (2) | Train Loss: 1.2251 | Train Acc: 0.6186
 Site-Infograph                 (1) | Train Loss: 1.4529 | Train Acc: 0.5333
Average Train Accuracy: 0.8573
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8194
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9310
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8710
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8926
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8868
 Best site-Real                      | Epoch:15 | Val Acc: 0.7778
 Best site-Real                      | Epoch:15 | Val Acc: 0.9655
 Best site-Real                      | Epoch:15 | Val Acc: 0.9565
 Best site-Real                      | Epoch:15 | Val Acc: 0.9459
 Best site-Real                      | Epoch:15 | Val Acc: 0.9664
 Best site-Real                      | Epoch:15 | Val Acc: 0.9476
 Best site-Real                      | Epoch:15 | Val Acc: 0.9346
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8941
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8750
 Best site-Painting                  | Epoch:15 | Val Acc: 0.9078
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.9153
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8211
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8026
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.6575
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.6186
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.5333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 16 ============
cnt=[4, 2, 9, 4, 7, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (2) | Train Loss: 0.9323 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 0.4153 | Train Acc: 0.8182
 Site-Clipart                   (2) | Train Loss: 0.3043 | Train Acc: 0.9412
 Site-Clipart                   (0) | Train Loss: 0.4733 | Train Acc: 0.8571
 Site-Clipart                   (2) | Train Loss: 0.5551 | Train Acc: 0.9111
 Site-Clipart                   (2) | Train Loss: 0.5448 | Train Acc: 0.8333
 Site-Clipart                   (2) | Train Loss: 0.3972 | Train Acc: 0.9483
 Site-Clipart                   (2) | Train Loss: 0.5025 | Train Acc: 0.8656
 Site-Clipart                   (0) | Train Loss: 0.4554 | Train Acc: 0.8758
 Site-Clipart                   (2) | Train Loss: 0.4405 | Train Acc: 0.8721
 Site-Real                      (3) | Train Loss: 0.7187 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.3282 | Train Acc: 0.9310
 Site-Real                      (3) | Train Loss: 0.2096 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.2757 | Train Acc: 0.9459
 Site-Real                      (4) | Train Loss: 0.2708 | Train Acc: 0.9664
 Site-Real                      (3) | Train Loss: 0.2945 | Train Acc: 0.9372
 Site-Real                      (4) | Train Loss: 0.3412 | Train Acc: 0.9314
 Site-Painting                  (4) | Train Loss: 0.5994 | Train Acc: 0.8302
 Site-Painting                  (0) | Train Loss: 0.5002 | Train Acc: 0.8588
 Site-Painting                  (4) | Train Loss: 0.4164 | Train Acc: 0.8971
 Site-Painting                  (4) | Train Loss: 0.4232 | Train Acc: 0.9171
 Site-Sketch                    (0) | Train Loss: 0.4377 | Train Acc: 0.8983
 Site-Sketch                    (2) | Train Loss: 0.5555 | Train Acc: 0.8316
 Site-Sketch                    (2) | Train Loss: 0.5950 | Train Acc: 0.8092
 Site-QuickDraw                 (1) | Train Loss: 1.1998 | Train Acc: 0.6164
 Site-QuickDraw                 (1) | Train Loss: 1.1827 | Train Acc: 0.6525
 Site-Infograph                 (4) | Train Loss: 1.3990 | Train Acc: 0.5500
Average Train Accuracy: 0.8496
============ Train epoch 17 ============
cnt=[2, 9, 2, 9, 3, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (4) | Train Loss: 1.0524 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.4604 | Train Acc: 0.9091
 Site-Clipart                   (1) | Train Loss: 0.1218 | Train Acc: 1.0000
 Site-Clipart                   (3) | Train Loss: 0.5057 | Train Acc: 0.8214
 Site-Clipart                   (1) | Train Loss: 0.4367 | Train Acc: 0.9111
 Site-Clipart                   (1) | Train Loss: 0.4185 | Train Acc: 0.8472
 Site-Clipart                   (1) | Train Loss: 0.3493 | Train Acc: 0.9224
 Site-Clipart                   (4) | Train Loss: 0.4835 | Train Acc: 0.8656
 Site-Clipart                   (1) | Train Loss: 0.4408 | Train Acc: 0.8792
 Site-Clipart                   (1) | Train Loss: 0.4094 | Train Acc: 0.9057
 Site-Real                      (5) | Train Loss: 0.7020 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.2949 | Train Acc: 0.9655
 Site-Real                      (3) | Train Loss: 0.1984 | Train Acc: 0.9783
 Site-Real                      (3) | Train Loss: 0.3467 | Train Acc: 0.9189
 Site-Real                      (3) | Train Loss: 0.2718 | Train Acc: 0.9580
 Site-Real                      (0) | Train Loss: 0.2823 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.3008 | Train Acc: 0.9314
 Site-Painting                  (3) | Train Loss: 0.5723 | Train Acc: 0.8302
 Site-Painting                  (3) | Train Loss: 0.4188 | Train Acc: 0.9176
 Site-Painting                  (3) | Train Loss: 0.4725 | Train Acc: 0.8897
 Site-Painting                  (3) | Train Loss: 0.3818 | Train Acc: 0.9078
 Site-Sketch                    (1) | Train Loss: 0.4398 | Train Acc: 0.8814
 Site-Sketch                    (1) | Train Loss: 0.5152 | Train Acc: 0.8632
 Site-Sketch                    (1) | Train Loss: 0.6044 | Train Acc: 0.8026
 Site-QuickDraw                 (2) | Train Loss: 1.1792 | Train Acc: 0.6849
 Site-QuickDraw                 (2) | Train Loss: 1.1297 | Train Acc: 0.6356
 Site-Infograph                 (3) | Train Loss: 1.4166 | Train Acc: 0.5750
Average Train Accuracy: 0.8590
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8214
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8472
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9224
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8656
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8792
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9057
 Best site-Real                      | Epoch:17 | Val Acc: 0.7778
 Best site-Real                      | Epoch:17 | Val Acc: 0.9655
 Best site-Real                      | Epoch:17 | Val Acc: 0.9783
 Best site-Real                      | Epoch:17 | Val Acc: 0.9189
 Best site-Real                      | Epoch:17 | Val Acc: 0.9580
 Best site-Real                      | Epoch:17 | Val Acc: 0.9476
 Best site-Real                      | Epoch:17 | Val Acc: 0.9314
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8302
 Best site-Painting                  | Epoch:17 | Val Acc: 0.9176
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8897
 Best site-Painting                  | Epoch:17 | Val Acc: 0.9078
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8632
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8026
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.6849
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.6356
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.5750
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 18 ============
cnt=[3, 2, 10, 4, 4, 4, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (5) | Train Loss: 0.9226 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.3620 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.1765 | Train Acc: 0.9412
 Site-Clipart                   (2) | Train Loss: 0.4656 | Train Acc: 0.8214
 Site-Clipart                   (5) | Train Loss: 0.3763 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.5764 | Train Acc: 0.8611
 Site-Clipart                   (2) | Train Loss: 0.4238 | Train Acc: 0.8966
 Site-Clipart                   (2) | Train Loss: 0.4509 | Train Acc: 0.9032
 Site-Clipart                   (5) | Train Loss: 0.4298 | Train Acc: 0.8893
 Site-Clipart                   (2) | Train Loss: 0.4122 | Train Acc: 0.9057
 Site-Real                      (4) | Train Loss: 0.6934 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.3020 | Train Acc: 0.9310
 Site-Real                      (4) | Train Loss: 0.2123 | Train Acc: 0.9565
 Site-Real                      (0) | Train Loss: 0.2992 | Train Acc: 0.9595
 Site-Real                      (4) | Train Loss: 0.2350 | Train Acc: 0.9580
 Site-Real                      (4) | Train Loss: 0.2769 | Train Acc: 0.9581
 Site-Real                      (0) | Train Loss: 0.3128 | Train Acc: 0.9412
 Site-Painting                  (3) | Train Loss: 0.5969 | Train Acc: 0.8491
 Site-Painting                  (3) | Train Loss: 0.4321 | Train Acc: 0.8824
 Site-Painting                  (3) | Train Loss: 0.4289 | Train Acc: 0.8824
 Site-Painting                  (3) | Train Loss: 0.4079 | Train Acc: 0.8986
 Site-Sketch                    (2) | Train Loss: 0.4628 | Train Acc: 0.8644
 Site-Sketch                    (2) | Train Loss: 0.4907 | Train Acc: 0.9158
 Site-Sketch                    (2) | Train Loss: 0.5866 | Train Acc: 0.8026
 Site-QuickDraw                 (1) | Train Loss: 1.1310 | Train Acc: 0.7534
 Site-QuickDraw                 (1) | Train Loss: 1.1036 | Train Acc: 0.6356
 Site-Infograph                 (5) | Train Loss: 1.3808 | Train Acc: 0.5667
Average Train Accuracy: 0.8599
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8214
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8611
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8966
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9032
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8893
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.9057
 Best site-Real                      | Epoch:18 | Val Acc: 0.7778
 Best site-Real                      | Epoch:18 | Val Acc: 0.9310
 Best site-Real                      | Epoch:18 | Val Acc: 0.9565
 Best site-Real                      | Epoch:18 | Val Acc: 0.9595
 Best site-Real                      | Epoch:18 | Val Acc: 0.9580
 Best site-Real                      | Epoch:18 | Val Acc: 0.9581
 Best site-Real                      | Epoch:18 | Val Acc: 0.9412
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8491
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8986
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.8644
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.9158
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.8026
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.7534
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.6356
 Best site-Infograph                 | Epoch:18 | Val Acc: 0.5667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 19 ============
cnt=[7, 6, 2, 8, 3, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (4) | Train Loss: 0.8427 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 0.5124 | Train Acc: 0.8182
 Site-Clipart                   (4) | Train Loss: 0.1245 | Train Acc: 1.0000
 Site-Clipart                   (1) | Train Loss: 0.5219 | Train Acc: 0.7857
 Site-Clipart                   (1) | Train Loss: 0.4432 | Train Acc: 0.8889
 Site-Clipart                   (3) | Train Loss: 0.4299 | Train Acc: 0.8472
 Site-Clipart                   (3) | Train Loss: 0.3556 | Train Acc: 0.9224
 Site-Clipart                   (3) | Train Loss: 0.4745 | Train Acc: 0.8441
 Site-Clipart                   (3) | Train Loss: 0.4030 | Train Acc: 0.9094
 Site-Clipart                   (4) | Train Loss: 0.3945 | Train Acc: 0.8994
 Site-Real                      (1) | Train Loss: 0.7118 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.2957 | Train Acc: 0.9310
 Site-Real                      (1) | Train Loss: 0.2133 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.2860 | Train Acc: 0.9324
 Site-Real                      (1) | Train Loss: 0.2280 | Train Acc: 0.9664
 Site-Real                      (1) | Train Loss: 0.2497 | Train Acc: 0.9634
 Site-Real                      (0) | Train Loss: 0.2812 | Train Acc: 0.9379
 Site-Painting                  (0) | Train Loss: 0.5302 | Train Acc: 0.8679
 Site-Painting                  (0) | Train Loss: 0.4540 | Train Acc: 0.8941
 Site-Painting                  (0) | Train Loss: 0.3596 | Train Acc: 0.9044
 Site-Painting                  (0) | Train Loss: 0.3986 | Train Acc: 0.9032
 Site-Sketch                    (3) | Train Loss: 0.4284 | Train Acc: 0.8814
 Site-Sketch                    (3) | Train Loss: 0.5057 | Train Acc: 0.8737
 Site-Sketch                    (3) | Train Loss: 0.5794 | Train Acc: 0.8355
 Site-QuickDraw                 (2) | Train Loss: 1.0913 | Train Acc: 0.6712
 Site-QuickDraw                 (2) | Train Loss: 1.0701 | Train Acc: 0.6525
 Site-Infograph                 (0) | Train Loss: 1.4186 | Train Acc: 0.5750
Average Train Accuracy: 0.8574
============ Train epoch 20 ============
cnt=[3, 2, 5, 5, 8, 4, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (0) | Train Loss: 0.8026 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.2520 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.1546 | Train Acc: 1.0000
 Site-Clipart                   (5) | Train Loss: 0.5170 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.5087 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.4291 | Train Acc: 0.8611
 Site-Clipart                   (4) | Train Loss: 0.3343 | Train Acc: 0.9310
 Site-Clipart                   (4) | Train Loss: 0.4430 | Train Acc: 0.8871
 Site-Clipart                   (5) | Train Loss: 0.3856 | Train Acc: 0.8960
 Site-Clipart                   (4) | Train Loss: 0.3752 | Train Acc: 0.9203
 Site-Real                      (3) | Train Loss: 0.6336 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.2657 | Train Acc: 0.9655
 Site-Real                      (3) | Train Loss: 0.2376 | Train Acc: 0.9565
 Site-Real                      (2) | Train Loss: 0.3060 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.2197 | Train Acc: 0.9580
 Site-Real                      (3) | Train Loss: 0.2461 | Train Acc: 0.9581
 Site-Real                      (2) | Train Loss: 0.2937 | Train Acc: 0.9216
 Site-Painting                  (5) | Train Loss: 0.5439 | Train Acc: 0.9057
 Site-Painting                  (2) | Train Loss: 0.3826 | Train Acc: 0.8824
 Site-Painting                  (2) | Train Loss: 0.3782 | Train Acc: 0.9265
 Site-Painting                  (2) | Train Loss: 0.3597 | Train Acc: 0.9032
 Site-Sketch                    (4) | Train Loss: 0.4939 | Train Acc: 0.8644
 Site-Sketch                    (4) | Train Loss: 0.5416 | Train Acc: 0.8632
 Site-Sketch                    (0) | Train Loss: 0.5456 | Train Acc: 0.8289
 Site-QuickDraw                 (1) | Train Loss: 1.1032 | Train Acc: 0.6438
 Site-QuickDraw                 (1) | Train Loss: 1.0300 | Train Acc: 0.6695
 Site-Infograph                 (5) | Train Loss: 1.3564 | Train Acc: 0.5333
Average Train Accuracy: 0.8633
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8611
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9310
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8871
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8960
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9203
 Best site-Real                      | Epoch:20 | Val Acc: 0.7778
 Best site-Real                      | Epoch:20 | Val Acc: 0.9655
 Best site-Real                      | Epoch:20 | Val Acc: 0.9565
 Best site-Real                      | Epoch:20 | Val Acc: 0.9324
 Best site-Real                      | Epoch:20 | Val Acc: 0.9580
 Best site-Real                      | Epoch:20 | Val Acc: 0.9581
 Best site-Real                      | Epoch:20 | Val Acc: 0.9216
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9057
 Best site-Painting                  | Epoch:20 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9265
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9032
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.8644
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.8632
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.8289
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.6438
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.6695
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.5333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 21 ============
cnt=[2, 7, 5, 5, 7, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (4) | Train Loss: 0.8848 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.4113 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.2411 | Train Acc: 0.9412
 Site-Clipart                   (4) | Train Loss: 0.4306 | Train Acc: 0.8214
 Site-Clipart                   (4) | Train Loss: 0.5036 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.4596 | Train Acc: 0.8889
 Site-Clipart                   (2) | Train Loss: 0.3721 | Train Acc: 0.9052
 Site-Clipart                   (2) | Train Loss: 0.4461 | Train Acc: 0.8817
 Site-Clipart                   (4) | Train Loss: 0.3986 | Train Acc: 0.8993
 Site-Clipart                   (4) | Train Loss: 0.3761 | Train Acc: 0.8994
 Site-Real                      (3) | Train Loss: 0.7275 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.2515 | Train Acc: 0.9310
 Site-Real                      (3) | Train Loss: 0.2226 | Train Acc: 0.9565
 Site-Real                      (1) | Train Loss: 0.3336 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.2192 | Train Acc: 0.9664
 Site-Real                      (3) | Train Loss: 0.2462 | Train Acc: 0.9476
 Site-Real                      (1) | Train Loss: 0.2720 | Train Acc: 0.9412
 Site-Painting                  (1) | Train Loss: 0.5840 | Train Acc: 0.8868
 Site-Painting                  (1) | Train Loss: 0.4693 | Train Acc: 0.8588
 Site-Painting                  (1) | Train Loss: 0.3673 | Train Acc: 0.8750
 Site-Painting                  (1) | Train Loss: 0.3628 | Train Acc: 0.9217
 Site-Sketch                    (2) | Train Loss: 0.4054 | Train Acc: 0.8983
 Site-Sketch                    (4) | Train Loss: 0.4801 | Train Acc: 0.8632
 Site-Sketch                    (2) | Train Loss: 0.5898 | Train Acc: 0.8158
 Site-QuickDraw                 (0) | Train Loss: 1.0749 | Train Acc: 0.6849
 Site-QuickDraw                 (0) | Train Loss: 0.9947 | Train Acc: 0.6695
 Site-Infograph                 (1) | Train Loss: 1.3559 | Train Acc: 0.5417
Average Train Accuracy: 0.8652
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8214
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9052
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8817
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8993
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8994
 Best site-Real                      | Epoch:21 | Val Acc: 0.7778
 Best site-Real                      | Epoch:21 | Val Acc: 0.9310
 Best site-Real                      | Epoch:21 | Val Acc: 0.9565
 Best site-Real                      | Epoch:21 | Val Acc: 0.9324
 Best site-Real                      | Epoch:21 | Val Acc: 0.9664
 Best site-Real                      | Epoch:21 | Val Acc: 0.9476
 Best site-Real                      | Epoch:21 | Val Acc: 0.9412
 Best site-Painting                  | Epoch:21 | Val Acc: 0.8868
 Best site-Painting                  | Epoch:21 | Val Acc: 0.8588
 Best site-Painting                  | Epoch:21 | Val Acc: 0.8750
 Best site-Painting                  | Epoch:21 | Val Acc: 0.9217
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.8632
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.8158
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.6849
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.6695
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.5417
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 22 ============
cnt=[4, 2, 8, 1, 7, 5, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (2) | Train Loss: 0.8137 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.3768 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.1188 | Train Acc: 1.0000
 Site-Clipart                   (4) | Train Loss: 0.4485 | Train Acc: 0.8214
 Site-Clipart                   (5) | Train Loss: 0.4979 | Train Acc: 0.8667
 Site-Clipart                   (2) | Train Loss: 0.4624 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.3062 | Train Acc: 0.9310
 Site-Clipart                   (2) | Train Loss: 0.4001 | Train Acc: 0.8978
 Site-Clipart                   (5) | Train Loss: 0.3654 | Train Acc: 0.9027
 Site-Clipart                   (2) | Train Loss: 0.3549 | Train Acc: 0.9119
 Site-Real                      (4) | Train Loss: 0.6195 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.2943 | Train Acc: 0.9310
 Site-Real                      (4) | Train Loss: 0.1684 | Train Acc: 0.9783
 Site-Real                      (4) | Train Loss: 0.2626 | Train Acc: 0.9324
 Site-Real                      (4) | Train Loss: 0.2458 | Train Acc: 0.9580
 Site-Real                      (4) | Train Loss: 0.2398 | Train Acc: 0.9581
 Site-Real                      (4) | Train Loss: 0.2701 | Train Acc: 0.9346
 Site-Painting                  (0) | Train Loss: 0.5092 | Train Acc: 0.8868
 Site-Painting                  (0) | Train Loss: 0.4042 | Train Acc: 0.8941
 Site-Painting                  (0) | Train Loss: 0.3235 | Train Acc: 0.9118
 Site-Painting                  (0) | Train Loss: 0.3574 | Train Acc: 0.8986
 Site-Sketch                    (5) | Train Loss: 0.4139 | Train Acc: 0.9153
 Site-Sketch                    (2) | Train Loss: 0.5268 | Train Acc: 0.8421
 Site-Sketch                    (2) | Train Loss: 0.5407 | Train Acc: 0.8289
 Site-QuickDraw                 (1) | Train Loss: 1.1025 | Train Acc: 0.6712
 Site-QuickDraw                 (1) | Train Loss: 0.9694 | Train Acc: 0.6949
 Site-Infograph                 (5) | Train Loss: 1.2831 | Train Acc: 0.6000
Average Train Accuracy: 0.8650
============ Train epoch 23 ============
cnt=[2, 2, 8, 1, 9, 5, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.8606 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.4343 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.1269 | Train Acc: 1.0000
 Site-Clipart                   (3) | Train Loss: 0.3900 | Train Acc: 0.8571
 Site-Clipart                   (2) | Train Loss: 0.4006 | Train Acc: 0.9333
 Site-Clipart                   (5) | Train Loss: 0.3840 | Train Acc: 0.8750
 Site-Clipart                   (2) | Train Loss: 0.2864 | Train Acc: 0.9483
 Site-Clipart                   (2) | Train Loss: 0.4165 | Train Acc: 0.8925
 Site-Clipart                   (5) | Train Loss: 0.3408 | Train Acc: 0.8960
 Site-Clipart                   (2) | Train Loss: 0.3489 | Train Acc: 0.9078
 Site-Real                      (0) | Train Loss: 0.6088 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.3028 | Train Acc: 0.9310
 Site-Real                      (4) | Train Loss: 0.1626 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.3019 | Train Acc: 0.9324
 Site-Real                      (4) | Train Loss: 0.2600 | Train Acc: 0.9496
 Site-Real                      (4) | Train Loss: 0.2556 | Train Acc: 0.9529
 Site-Real                      (4) | Train Loss: 0.2964 | Train Acc: 0.9346
 Site-Painting                  (4) | Train Loss: 0.5386 | Train Acc: 0.8679
 Site-Painting                  (4) | Train Loss: 0.4125 | Train Acc: 0.8824
 Site-Painting                  (4) | Train Loss: 0.4171 | Train Acc: 0.9191
 Site-Painting                  (4) | Train Loss: 0.3481 | Train Acc: 0.9171
 Site-Sketch                    (5) | Train Loss: 0.4788 | Train Acc: 0.8305
 Site-Sketch                    (2) | Train Loss: 0.4826 | Train Acc: 0.8632
 Site-Sketch                    (5) | Train Loss: 0.5438 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 1.0087 | Train Acc: 0.6712
 Site-QuickDraw                 (1) | Train Loss: 0.9710 | Train Acc: 0.7542
 Site-Infograph                 (5) | Train Loss: 1.3955 | Train Acc: 0.5250
Average Train Accuracy: 0.8678
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8750
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9483
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8925
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8960
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9078
 Best site-Real                      | Epoch:23 | Val Acc: 0.7778
 Best site-Real                      | Epoch:23 | Val Acc: 0.9310
 Best site-Real                      | Epoch:23 | Val Acc: 1.0000
 Best site-Real                      | Epoch:23 | Val Acc: 0.9324
 Best site-Real                      | Epoch:23 | Val Acc: 0.9496
 Best site-Real                      | Epoch:23 | Val Acc: 0.9529
 Best site-Real                      | Epoch:23 | Val Acc: 0.9346
 Best site-Painting                  | Epoch:23 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:23 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:23 | Val Acc: 0.9191
 Best site-Painting                  | Epoch:23 | Val Acc: 0.9171
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8305
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8632
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8355
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.6712
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.7542
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.5250
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 24 ============
cnt=[5, 9, 2, 7, 1, 3, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (1) | Train Loss: 0.8219 | Train Acc: 0.8333
 Site-Clipart                   (1) | Train Loss: 0.3954 | Train Acc: 0.9091
 Site-Clipart                   (1) | Train Loss: 0.1533 | Train Acc: 1.0000
 Site-Clipart                   (4) | Train Loss: 0.4830 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.3570 | Train Acc: 0.9556
 Site-Clipart                   (1) | Train Loss: 0.3824 | Train Acc: 0.8750
 Site-Clipart                   (1) | Train Loss: 0.2699 | Train Acc: 0.9569
 Site-Clipart                   (1) | Train Loss: 0.4287 | Train Acc: 0.8710
 Site-Clipart                   (5) | Train Loss: 0.3554 | Train Acc: 0.8859
 Site-Clipart                   (1) | Train Loss: 0.3466 | Train Acc: 0.9224
 Site-Real                      (0) | Train Loss: 0.6060 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.2345 | Train Acc: 0.9310
 Site-Real                      (0) | Train Loss: 0.1546 | Train Acc: 0.9783
 Site-Real                      (3) | Train Loss: 0.2886 | Train Acc: 0.9459
 Site-Real                      (0) | Train Loss: 0.2274 | Train Acc: 0.9580
 Site-Real                      (0) | Train Loss: 0.2390 | Train Acc: 0.9529
 Site-Real                      (3) | Train Loss: 0.2604 | Train Acc: 0.9444
 Site-Painting                  (3) | Train Loss: 0.4600 | Train Acc: 0.8679
 Site-Painting                  (3) | Train Loss: 0.3910 | Train Acc: 0.8588
 Site-Painting                  (3) | Train Loss: 0.4473 | Train Acc: 0.9191
 Site-Painting                  (3) | Train Loss: 0.3340 | Train Acc: 0.9171
 Site-Sketch                    (1) | Train Loss: 0.3972 | Train Acc: 0.9153
 Site-Sketch                    (5) | Train Loss: 0.4485 | Train Acc: 0.9053
 Site-Sketch                    (1) | Train Loss: 0.5019 | Train Acc: 0.8355
 Site-QuickDraw                 (2) | Train Loss: 1.0670 | Train Acc: 0.6575
 Site-QuickDraw                 (2) | Train Loss: 0.9589 | Train Acc: 0.7119
 Site-Infograph                 (3) | Train Loss: 1.3151 | Train Acc: 0.5833
Average Train Accuracy: 0.8788
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9556
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8750
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9569
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8710
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8859
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9224
 Best site-Real                      | Epoch:24 | Val Acc: 0.7778
 Best site-Real                      | Epoch:24 | Val Acc: 0.9310
 Best site-Real                      | Epoch:24 | Val Acc: 0.9783
 Best site-Real                      | Epoch:24 | Val Acc: 0.9459
 Best site-Real                      | Epoch:24 | Val Acc: 0.9580
 Best site-Real                      | Epoch:24 | Val Acc: 0.9529
 Best site-Real                      | Epoch:24 | Val Acc: 0.9444
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8588
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9191
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9171
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.9153
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.9053
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8355
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.6575
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7119
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 25 ============
cnt=[5, 2, 8, 6, 5, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (4) | Train Loss: 0.7958 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.4762 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.1666 | Train Acc: 0.9412
 Site-Clipart                   (4) | Train Loss: 0.4101 | Train Acc: 0.9286
 Site-Clipart                   (4) | Train Loss: 0.3034 | Train Acc: 0.9333
 Site-Clipart                   (2) | Train Loss: 0.4658 | Train Acc: 0.8611
 Site-Clipart                   (2) | Train Loss: 0.2840 | Train Acc: 0.9483
 Site-Clipart                   (2) | Train Loss: 0.4165 | Train Acc: 0.8763
 Site-Clipart                   (4) | Train Loss: 0.3526 | Train Acc: 0.9262
 Site-Clipart                   (2) | Train Loss: 0.3300 | Train Acc: 0.9182
 Site-Real                      (0) | Train Loss: 0.6726 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.2696 | Train Acc: 0.9310
 Site-Real                      (0) | Train Loss: 0.1507 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.2198 | Train Acc: 0.9324
 Site-Real                      (0) | Train Loss: 0.2106 | Train Acc: 0.9748
 Site-Real                      (0) | Train Loss: 0.2460 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2491 | Train Acc: 0.9379
 Site-Painting                  (3) | Train Loss: 0.5041 | Train Acc: 0.8679
 Site-Painting                  (3) | Train Loss: 0.4016 | Train Acc: 0.8706
 Site-Painting                  (3) | Train Loss: 0.3805 | Train Acc: 0.9118
 Site-Painting                  (3) | Train Loss: 0.3229 | Train Acc: 0.9217
 Site-Sketch                    (4) | Train Loss: 0.4220 | Train Acc: 0.8983
 Site-Sketch                    (2) | Train Loss: 0.4969 | Train Acc: 0.8526
 Site-Sketch                    (2) | Train Loss: 0.5568 | Train Acc: 0.8092
 Site-QuickDraw                 (1) | Train Loss: 0.9108 | Train Acc: 0.7534
 Site-QuickDraw                 (1) | Train Loss: 0.9213 | Train Acc: 0.7203
 Site-Infograph                 (3) | Train Loss: 1.2700 | Train Acc: 0.6417
Average Train Accuracy: 0.8762
============ Train epoch 26 ============
cnt=[7, 2, 10, 2, 4, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (4) | Train Loss: 0.9572 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 0.4944 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.1890 | Train Acc: 0.9412
 Site-Clipart                   (5) | Train Loss: 0.4142 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 0.3077 | Train Acc: 0.9556
 Site-Clipart                   (4) | Train Loss: 0.3314 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.3339 | Train Acc: 0.9310
 Site-Clipart                   (0) | Train Loss: 0.3757 | Train Acc: 0.9140
 Site-Clipart                   (0) | Train Loss: 0.3515 | Train Acc: 0.8960
 Site-Clipart                   (0) | Train Loss: 0.3382 | Train Acc: 0.9245
 Site-Real                      (3) | Train Loss: 0.6662 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.2378 | Train Acc: 0.9655
 Site-Real                      (2) | Train Loss: 0.1268 | Train Acc: 0.9783
 Site-Real                      (2) | Train Loss: 0.2630 | Train Acc: 0.9324
 Site-Real                      (2) | Train Loss: 0.1936 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.2167 | Train Acc: 0.9634
 Site-Real                      (2) | Train Loss: 0.2253 | Train Acc: 0.9575
 Site-Painting                  (2) | Train Loss: 0.4653 | Train Acc: 0.8491
 Site-Painting                  (2) | Train Loss: 0.3169 | Train Acc: 0.9176
 Site-Painting                  (2) | Train Loss: 0.3368 | Train Acc: 0.9191
 Site-Painting                  (2) | Train Loss: 0.3515 | Train Acc: 0.8986
 Site-Sketch                    (0) | Train Loss: 0.4127 | Train Acc: 0.8814
 Site-Sketch                    (0) | Train Loss: 0.4992 | Train Acc: 0.8737
 Site-Sketch                    (0) | Train Loss: 0.5378 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 0.9224 | Train Acc: 0.6986
 Site-QuickDraw                 (1) | Train Loss: 0.9717 | Train Acc: 0.7119
 Site-Infograph                 (2) | Train Loss: 1.3779 | Train Acc: 0.6000
Average Train Accuracy: 0.8762
============ Train epoch 27 ============
cnt=[2, 2, 8, 8, 3, 4, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (2) | Train Loss: 0.8275 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.4336 | Train Acc: 0.8182
 Site-Clipart                   (2) | Train Loss: 0.2105 | Train Acc: 0.8824
 Site-Clipart                   (5) | Train Loss: 0.3891 | Train Acc: 0.8929
 Site-Clipart                   (5) | Train Loss: 0.3548 | Train Acc: 0.9333
 Site-Clipart                   (2) | Train Loss: 0.3824 | Train Acc: 0.8611
 Site-Clipart                   (2) | Train Loss: 0.3360 | Train Acc: 0.8879
 Site-Clipart                   (2) | Train Loss: 0.3980 | Train Acc: 0.9032
 Site-Clipart                   (1) | Train Loss: 0.3305 | Train Acc: 0.9094
 Site-Clipart                   (2) | Train Loss: 0.3219 | Train Acc: 0.9203
 Site-Real                      (3) | Train Loss: 0.6361 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.2504 | Train Acc: 0.9310
 Site-Real                      (3) | Train Loss: 0.1282 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.2668 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.2056 | Train Acc: 0.9580
 Site-Real                      (3) | Train Loss: 0.2360 | Train Acc: 0.9529
 Site-Real                      (3) | Train Loss: 0.2453 | Train Acc: 0.9379
 Site-Painting                  (4) | Train Loss: 0.4611 | Train Acc: 0.9057
 Site-Painting                  (4) | Train Loss: 0.3874 | Train Acc: 0.8941
 Site-Painting                  (3) | Train Loss: 0.4113 | Train Acc: 0.9044
 Site-Painting                  (4) | Train Loss: 0.3326 | Train Acc: 0.9124
 Site-Sketch                    (2) | Train Loss: 0.4208 | Train Acc: 0.8814
 Site-Sketch                    (5) | Train Loss: 0.4082 | Train Acc: 0.8737
 Site-Sketch                    (5) | Train Loss: 0.5377 | Train Acc: 0.8289
 Site-QuickDraw                 (0) | Train Loss: 0.8957 | Train Acc: 0.7260
 Site-QuickDraw                 (0) | Train Loss: 0.9338 | Train Acc: 0.7034
 Site-Infograph                 (1) | Train Loss: 1.2540 | Train Acc: 0.5917
Average Train Accuracy: 0.8682
============ Train epoch 28 ============
cnt=[6, 2, 11, 1, 1, 6, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (4) | Train Loss: 0.8789 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.4167 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.1076 | Train Acc: 1.0000
 Site-Clipart                   (0) | Train Loss: 0.4930 | Train Acc: 0.8214
 Site-Clipart                   (0) | Train Loss: 0.3542 | Train Acc: 0.9333
 Site-Clipart                   (0) | Train Loss: 0.3136 | Train Acc: 0.9167
 Site-Clipart                   (5) | Train Loss: 0.3349 | Train Acc: 0.9224
 Site-Clipart                   (5) | Train Loss: 0.3918 | Train Acc: 0.8763
 Site-Clipart                   (0) | Train Loss: 0.3113 | Train Acc: 0.9195
 Site-Clipart                   (5) | Train Loss: 0.3163 | Train Acc: 0.9287
 Site-Real                      (2) | Train Loss: 0.6557 | Train Acc: 0.8333
 Site-Real                      (3) | Train Loss: 0.2726 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.2138 | Train Acc: 0.9565
 Site-Real                      (2) | Train Loss: 0.2383 | Train Acc: 0.9324
 Site-Real                      (2) | Train Loss: 0.1982 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.2257 | Train Acc: 0.9634
 Site-Real                      (2) | Train Loss: 0.2547 | Train Acc: 0.9412
 Site-Painting                  (2) | Train Loss: 0.4903 | Train Acc: 0.8679
 Site-Painting                  (2) | Train Loss: 0.3490 | Train Acc: 0.9294
 Site-Painting                  (2) | Train Loss: 0.3646 | Train Acc: 0.8897
 Site-Painting                  (2) | Train Loss: 0.3310 | Train Acc: 0.9171
 Site-Sketch                    (5) | Train Loss: 0.4076 | Train Acc: 0.8814
 Site-Sketch                    (5) | Train Loss: 0.4887 | Train Acc: 0.8737
 Site-Sketch                    (0) | Train Loss: 0.5236 | Train Acc: 0.8092
 Site-QuickDraw                 (1) | Train Loss: 0.8836 | Train Acc: 0.7397
 Site-QuickDraw                 (1) | Train Loss: 0.9282 | Train Acc: 0.7119
 Site-Infograph                 (2) | Train Loss: 1.3483 | Train Acc: 0.5417
Average Train Accuracy: 0.8730
============ Train epoch 29 ============
cnt=[3, 2, 10, 6, 5, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (2) | Train Loss: 0.7425 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.3177 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.0975 | Train Acc: 1.0000
 Site-Clipart                   (0) | Train Loss: 0.3695 | Train Acc: 0.8929
 Site-Clipart                   (2) | Train Loss: 0.2631 | Train Acc: 0.9556
 Site-Clipart                   (2) | Train Loss: 0.2994 | Train Acc: 0.9167
 Site-Clipart                   (2) | Train Loss: 0.3314 | Train Acc: 0.9138
 Site-Clipart                   (2) | Train Loss: 0.4397 | Train Acc: 0.8763
 Site-Clipart                   (0) | Train Loss: 0.3164 | Train Acc: 0.9094
 Site-Clipart                   (2) | Train Loss: 0.3209 | Train Acc: 0.9161
 Site-Real                      (3) | Train Loss: 0.5766 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.2728 | Train Acc: 0.9310
 Site-Real                      (3) | Train Loss: 0.1377 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.2818 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.2154 | Train Acc: 0.9580
 Site-Real                      (3) | Train Loss: 0.2115 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2539 | Train Acc: 0.9412
 Site-Painting                  (4) | Train Loss: 0.4738 | Train Acc: 0.8491
 Site-Painting                  (4) | Train Loss: 0.3782 | Train Acc: 0.8941
 Site-Painting                  (4) | Train Loss: 0.3104 | Train Acc: 0.9191
 Site-Painting                  (4) | Train Loss: 0.3110 | Train Acc: 0.9309
 Site-Sketch                    (2) | Train Loss: 0.4007 | Train Acc: 0.8644
 Site-Sketch                    (2) | Train Loss: 0.5041 | Train Acc: 0.8316
 Site-Sketch                    (2) | Train Loss: 0.4284 | Train Acc: 0.8487
 Site-QuickDraw                 (1) | Train Loss: 1.0513 | Train Acc: 0.7260
 Site-QuickDraw                 (1) | Train Loss: 0.8375 | Train Acc: 0.7881
 Site-Infograph                 (0) | Train Loss: 1.2067 | Train Acc: 0.5917
Average Train Accuracy: 0.8835
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9556
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9167
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9138
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.8763
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9094
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.9161
 Best site-Real                      | Epoch:29 | Val Acc: 0.7778
 Best site-Real                      | Epoch:29 | Val Acc: 0.9310
 Best site-Real                      | Epoch:29 | Val Acc: 1.0000
 Best site-Real                      | Epoch:29 | Val Acc: 0.9324
 Best site-Real                      | Epoch:29 | Val Acc: 0.9580
 Best site-Real                      | Epoch:29 | Val Acc: 0.9476
 Best site-Real                      | Epoch:29 | Val Acc: 0.9412
 Best site-Painting                  | Epoch:29 | Val Acc: 0.8491
 Best site-Painting                  | Epoch:29 | Val Acc: 0.8941
 Best site-Painting                  | Epoch:29 | Val Acc: 0.9191
 Best site-Painting                  | Epoch:29 | Val Acc: 0.9309
 Best site-Sketch                    | Epoch:29 | Val Acc: 0.8644
 Best site-Sketch                    | Epoch:29 | Val Acc: 0.8316
 Best site-Sketch                    | Epoch:29 | Val Acc: 0.8487
 Best site-QuickDraw                 | Epoch:29 | Val Acc: 0.7260
 Best site-QuickDraw                 | Epoch:29 | Val Acc: 0.7881
 Best site-Infograph                 | Epoch:29 | Val Acc: 0.5917
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 30 ============
cnt=[5, 2, 2, 10, 1, 7, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (4) | Train Loss: 0.7571 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.2787 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.2097 | Train Acc: 0.8824
 Site-Clipart                   (0) | Train Loss: 0.3383 | Train Acc: 0.9286
 Site-Clipart                   (0) | Train Loss: 0.3603 | Train Acc: 0.9333
 Site-Clipart                   (5) | Train Loss: 0.4821 | Train Acc: 0.8889
 Site-Clipart                   (5) | Train Loss: 0.2912 | Train Acc: 0.9483
 Site-Clipart                   (5) | Train Loss: 0.3693 | Train Acc: 0.9194
 Site-Clipart                   (5) | Train Loss: 0.3183 | Train Acc: 0.8993
 Site-Clipart                   (5) | Train Loss: 0.3069 | Train Acc: 0.9119
 Site-Real                      (2) | Train Loss: 0.6010 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.1976 | Train Acc: 0.9655
 Site-Real                      (3) | Train Loss: 0.1525 | Train Acc: 0.9783
 Site-Real                      (3) | Train Loss: 0.2241 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.1991 | Train Acc: 0.9580
 Site-Real                      (3) | Train Loss: 0.2240 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2146 | Train Acc: 0.9575
 Site-Painting                  (3) | Train Loss: 0.4342 | Train Acc: 0.8491
 Site-Painting                  (3) | Train Loss: 0.3853 | Train Acc: 0.8941
 Site-Painting                  (3) | Train Loss: 0.3347 | Train Acc: 0.9118
 Site-Painting                  (3) | Train Loss: 0.3070 | Train Acc: 0.9171
 Site-Sketch                    (0) | Train Loss: 0.4227 | Train Acc: 0.8644
 Site-Sketch                    (0) | Train Loss: 0.3703 | Train Acc: 0.9053
 Site-Sketch                    (0) | Train Loss: 0.5050 | Train Acc: 0.8224
 Site-QuickDraw                 (1) | Train Loss: 0.8439 | Train Acc: 0.7671
 Site-QuickDraw                 (1) | Train Loss: 0.8611 | Train Acc: 0.7458
 Site-Infograph                 (3) | Train Loss: 1.2187 | Train Acc: 0.6000
Average Train Accuracy: 0.8833
============ Train epoch 31 ============
cnt=[4, 2, 5, 7, 7, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (4) | Train Loss: 0.9810 | Train Acc: 0.6667
 Site-Clipart                   (4) | Train Loss: 0.4577 | Train Acc: 0.8182
 Site-Clipart                   (3) | Train Loss: 0.2283 | Train Acc: 0.8824
 Site-Clipart                   (3) | Train Loss: 0.3865 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.4363 | Train Acc: 0.9556
 Site-Clipart                   (4) | Train Loss: 0.3050 | Train Acc: 0.9028
 Site-Clipart                   (4) | Train Loss: 0.2793 | Train Acc: 0.9138
 Site-Clipart                   (3) | Train Loss: 0.3890 | Train Acc: 0.9032
 Site-Clipart                   (4) | Train Loss: 0.2991 | Train Acc: 0.9228
 Site-Clipart                   (4) | Train Loss: 0.3001 | Train Acc: 0.9287
 Site-Real                      (2) | Train Loss: 0.7096 | Train Acc: 0.8333
 Site-Real                      (2) | Train Loss: 0.2735 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.1420 | Train Acc: 0.9565
 Site-Real                      (5) | Train Loss: 0.2503 | Train Acc: 0.9324
 Site-Real                      (5) | Train Loss: 0.1821 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.2375 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2432 | Train Acc: 0.9379
 Site-Painting                  (0) | Train Loss: 0.4802 | Train Acc: 0.8491
 Site-Painting                  (0) | Train Loss: 0.3901 | Train Acc: 0.9059
 Site-Painting                  (0) | Train Loss: 0.3389 | Train Acc: 0.9265
 Site-Painting                  (0) | Train Loss: 0.3055 | Train Acc: 0.9309
 Site-Sketch                    (3) | Train Loss: 0.3226 | Train Acc: 0.9153
 Site-Sketch                    (4) | Train Loss: 0.3893 | Train Acc: 0.9158
 Site-Sketch                    (3) | Train Loss: 0.4841 | Train Acc: 0.8487
 Site-QuickDraw                 (1) | Train Loss: 0.8444 | Train Acc: 0.7808
 Site-QuickDraw                 (1) | Train Loss: 0.7970 | Train Acc: 0.8051
 Site-Infograph                 (3) | Train Loss: 1.1887 | Train Acc: 0.6750
Average Train Accuracy: 0.8815
============ Train epoch 32 ============
cnt=[4, 2, 9, 2, 6, 4, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (2) | Train Loss: 0.7889 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 0.3882 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.0583 | Train Acc: 1.0000
 Site-Clipart                   (5) | Train Loss: 0.3787 | Train Acc: 0.8929
 Site-Clipart                   (5) | Train Loss: 0.2839 | Train Acc: 0.9556
 Site-Clipart                   (2) | Train Loss: 0.3058 | Train Acc: 0.9028
 Site-Clipart                   (2) | Train Loss: 0.2851 | Train Acc: 0.9397
 Site-Clipart                   (2) | Train Loss: 0.3935 | Train Acc: 0.8925
 Site-Clipart                   (2) | Train Loss: 0.3652 | Train Acc: 0.8993
 Site-Clipart                   (2) | Train Loss: 0.3033 | Train Acc: 0.9266
 Site-Real                      (3) | Train Loss: 0.6697 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.2555 | Train Acc: 0.9655
 Site-Real                      (4) | Train Loss: 0.1378 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.3031 | Train Acc: 0.9324
 Site-Real                      (4) | Train Loss: 0.1864 | Train Acc: 0.9496
 Site-Real                      (4) | Train Loss: 0.2158 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2459 | Train Acc: 0.9379
 Site-Painting                  (0) | Train Loss: 0.4969 | Train Acc: 0.8302
 Site-Painting                  (0) | Train Loss: 0.3397 | Train Acc: 0.9059
 Site-Painting                  (0) | Train Loss: 0.3470 | Train Acc: 0.9118
 Site-Painting                  (0) | Train Loss: 0.2995 | Train Acc: 0.9263
 Site-Sketch                    (5) | Train Loss: 0.3782 | Train Acc: 0.8983
 Site-Sketch                    (2) | Train Loss: 0.4492 | Train Acc: 0.8737
 Site-Sketch                    (2) | Train Loss: 0.5324 | Train Acc: 0.8487
 Site-QuickDraw                 (1) | Train Loss: 0.8323 | Train Acc: 0.7397
 Site-QuickDraw                 (1) | Train Loss: 0.8573 | Train Acc: 0.7288
 Site-Infograph                 (4) | Train Loss: 1.1905 | Train Acc: 0.6333
Average Train Accuracy: 0.8812
============ Train epoch 33 ============
cnt=[2, 2, 4, 7, 4, 8, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (2) | Train Loss: 0.7966 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.2745 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.0743 | Train Acc: 1.0000
 Site-Clipart                   (3) | Train Loss: 0.3620 | Train Acc: 0.8929
 Site-Clipart                   (5) | Train Loss: 0.2897 | Train Acc: 0.9556
 Site-Clipart                   (2) | Train Loss: 0.3287 | Train Acc: 0.8611
 Site-Clipart                   (5) | Train Loss: 0.2720 | Train Acc: 0.9397
 Site-Clipart                   (5) | Train Loss: 0.3488 | Train Acc: 0.9140
 Site-Clipart                   (5) | Train Loss: 0.3207 | Train Acc: 0.9262
 Site-Clipart                   (5) | Train Loss: 0.2687 | Train Acc: 0.9413
 Site-Real                      (0) | Train Loss: 0.6433 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.2926 | Train Acc: 0.9310
 Site-Real                      (3) | Train Loss: 0.1121 | Train Acc: 0.9783
 Site-Real                      (3) | Train Loss: 0.2478 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.1936 | Train Acc: 0.9664
 Site-Real                      (3) | Train Loss: 0.2070 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2472 | Train Acc: 0.9477
 Site-Painting                  (4) | Train Loss: 0.4408 | Train Acc: 0.8679
 Site-Painting                  (4) | Train Loss: 0.3341 | Train Acc: 0.8941
 Site-Painting                  (4) | Train Loss: 0.3176 | Train Acc: 0.8971
 Site-Painting                  (4) | Train Loss: 0.2657 | Train Acc: 0.9309
 Site-Sketch                    (5) | Train Loss: 0.3413 | Train Acc: 0.9153
 Site-Sketch                    (5) | Train Loss: 0.4006 | Train Acc: 0.8737
 Site-Sketch                    (5) | Train Loss: 0.5097 | Train Acc: 0.8421
 Site-QuickDraw                 (1) | Train Loss: 0.7906 | Train Acc: 0.7260
 Site-QuickDraw                 (1) | Train Loss: 0.8408 | Train Acc: 0.7627
 Site-Infograph                 (3) | Train Loss: 1.2031 | Train Acc: 0.6500
Average Train Accuracy: 0.8832
============ Train epoch 34 ============
cnt=[5, 2, 9, 6, 1, 4, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (4) | Train Loss: 0.6969 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.4707 | Train Acc: 0.8182
 Site-Clipart                   (2) | Train Loss: 0.0936 | Train Acc: 1.0000
 Site-Clipart                   (2) | Train Loss: 0.3467 | Train Acc: 0.8929
 Site-Clipart                   (2) | Train Loss: 0.2515 | Train Acc: 0.9333
 Site-Clipart                   (5) | Train Loss: 0.3692 | Train Acc: 0.8472
 Site-Clipart                   (5) | Train Loss: 0.2481 | Train Acc: 0.9483
 Site-Clipart                   (5) | Train Loss: 0.3338 | Train Acc: 0.9086
 Site-Clipart                   (2) | Train Loss: 0.3149 | Train Acc: 0.9094
 Site-Clipart                   (2) | Train Loss: 0.2771 | Train Acc: 0.9287
 Site-Real                      (3) | Train Loss: 0.6470 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.2448 | Train Acc: 0.9310
 Site-Real                      (3) | Train Loss: 0.1237 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.3353 | Train Acc: 0.9189
 Site-Real                      (3) | Train Loss: 0.1943 | Train Acc: 0.9496
 Site-Real                      (3) | Train Loss: 0.2119 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2531 | Train Acc: 0.9281
 Site-Painting                  (0) | Train Loss: 0.4550 | Train Acc: 0.8679
 Site-Painting                  (0) | Train Loss: 0.3340 | Train Acc: 0.8941
 Site-Painting                  (0) | Train Loss: 0.3190 | Train Acc: 0.9338
 Site-Painting                  (0) | Train Loss: 0.2729 | Train Acc: 0.9401
 Site-Sketch                    (2) | Train Loss: 0.3719 | Train Acc: 0.8475
 Site-Sketch                    (2) | Train Loss: 0.4504 | Train Acc: 0.8947
 Site-Sketch                    (2) | Train Loss: 0.4774 | Train Acc: 0.8487
 Site-QuickDraw                 (1) | Train Loss: 0.9240 | Train Acc: 0.7260
 Site-QuickDraw                 (1) | Train Loss: 0.7817 | Train Acc: 0.7712
 Site-Infograph                 (2) | Train Loss: 1.1983 | Train Acc: 0.6250
Average Train Accuracy: 0.8823
============ Train epoch 35 ============
cnt=[2, 10, 2, 6, 3, 4, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (1) | Train Loss: 0.8327 | Train Acc: 0.6667
 Site-Clipart                   (1) | Train Loss: 0.2414 | Train Acc: 0.9091
 Site-Clipart                   (1) | Train Loss: 0.0795 | Train Acc: 1.0000
 Site-Clipart                   (4) | Train Loss: 0.3850 | Train Acc: 0.9286
 Site-Clipart                   (4) | Train Loss: 0.3743 | Train Acc: 0.9111
 Site-Clipart                   (1) | Train Loss: 0.3637 | Train Acc: 0.8611
 Site-Clipart                   (1) | Train Loss: 0.3020 | Train Acc: 0.9224
 Site-Clipart                   (1) | Train Loss: 0.3583 | Train Acc: 0.8871
 Site-Clipart                   (1) | Train Loss: 0.2970 | Train Acc: 0.9161
 Site-Clipart                   (1) | Train Loss: 0.2706 | Train Acc: 0.9413
 Site-Real                      (2) | Train Loss: 0.6389 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.3052 | Train Acc: 0.8966
 Site-Real                      (3) | Train Loss: 0.1642 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.2610 | Train Acc: 0.9324
 Site-Real                      (3) | Train Loss: 0.1766 | Train Acc: 0.9580
 Site-Real                      (3) | Train Loss: 0.2060 | Train Acc: 0.9424
 Site-Real                      (3) | Train Loss: 0.1990 | Train Acc: 0.9444
 Site-Painting                  (5) | Train Loss: 0.4163 | Train Acc: 0.9057
 Site-Painting                  (5) | Train Loss: 0.3156 | Train Acc: 0.8941
 Site-Painting                  (5) | Train Loss: 0.2850 | Train Acc: 0.9118
 Site-Painting                  (5) | Train Loss: 0.3045 | Train Acc: 0.9124
 Site-Sketch                    (4) | Train Loss: 0.3834 | Train Acc: 0.8475
 Site-Sketch                    (1) | Train Loss: 0.4198 | Train Acc: 0.8842
 Site-Sketch                    (1) | Train Loss: 0.4869 | Train Acc: 0.8224
 Site-QuickDraw                 (0) | Train Loss: 0.8915 | Train Acc: 0.7123
 Site-QuickDraw                 (0) | Train Loss: 0.7662 | Train Acc: 0.7542
 Site-Infograph                 (3) | Train Loss: 1.1459 | Train Acc: 0.6250
Average Train Accuracy: 0.8765
============ Train epoch 36 ============
cnt=[8, 2, 4, 7, 3, 3, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (0) | Train Loss: 0.8672 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 0.2775 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.2070 | Train Acc: 0.9412
 Site-Clipart                   (4) | Train Loss: 0.2897 | Train Acc: 0.9286
 Site-Clipart                   (4) | Train Loss: 0.2830 | Train Acc: 0.9556
 Site-Clipart                   (0) | Train Loss: 0.4752 | Train Acc: 0.8750
 Site-Clipart                   (0) | Train Loss: 0.2364 | Train Acc: 0.9397
 Site-Clipart                   (0) | Train Loss: 0.3245 | Train Acc: 0.9194
 Site-Clipart                   (5) | Train Loss: 0.3016 | Train Acc: 0.9128
 Site-Clipart                   (0) | Train Loss: 0.2712 | Train Acc: 0.9350
 Site-Real                      (2) | Train Loss: 0.5799 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.2851 | Train Acc: 0.9310
 Site-Real                      (3) | Train Loss: 0.1122 | Train Acc: 1.0000
 Site-Real                      (3) | Train Loss: 0.3621 | Train Acc: 0.9324
 Site-Real                      (2) | Train Loss: 0.1830 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.2139 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2169 | Train Acc: 0.9477
 Site-Painting                  (3) | Train Loss: 0.4920 | Train Acc: 0.9057
 Site-Painting                  (3) | Train Loss: 0.3345 | Train Acc: 0.9176
 Site-Painting                  (3) | Train Loss: 0.3373 | Train Acc: 0.9118
 Site-Painting                  (3) | Train Loss: 0.2909 | Train Acc: 0.9309
 Site-Sketch                    (5) | Train Loss: 0.4263 | Train Acc: 0.8475
 Site-Sketch                    (0) | Train Loss: 0.4295 | Train Acc: 0.8947
 Site-Sketch                    (0) | Train Loss: 0.4642 | Train Acc: 0.8684
 Site-QuickDraw                 (1) | Train Loss: 0.8961 | Train Acc: 0.7534
 Site-QuickDraw                 (1) | Train Loss: 0.6943 | Train Acc: 0.8559
 Site-Infograph                 (4) | Train Loss: 1.1563 | Train Acc: 0.6333
Average Train Accuracy: 0.8888
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9286
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9556
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.8750
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9397
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9194
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9128
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9350
 Best site-Real                      | Epoch:36 | Val Acc: 0.7778
 Best site-Real                      | Epoch:36 | Val Acc: 0.9310
 Best site-Real                      | Epoch:36 | Val Acc: 1.0000
 Best site-Real                      | Epoch:36 | Val Acc: 0.9324
 Best site-Real                      | Epoch:36 | Val Acc: 0.9580
 Best site-Real                      | Epoch:36 | Val Acc: 0.9476
 Best site-Real                      | Epoch:36 | Val Acc: 0.9477
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9057
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9176
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9118
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9309
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8475
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8947
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8684
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.7534
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.8559
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.6333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 37 ============
cnt=[4, 2, 6, 1, 7, 7, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (5) | Train Loss: 0.8494 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 0.4651 | Train Acc: 0.8182
 Site-Clipart                   (2) | Train Loss: 0.2186 | Train Acc: 0.8824
 Site-Clipart                   (2) | Train Loss: 0.3713 | Train Acc: 0.8929
 Site-Clipart                   (2) | Train Loss: 0.3219 | Train Acc: 0.9333
 Site-Clipart                   (5) | Train Loss: 0.4179 | Train Acc: 0.8611
 Site-Clipart                   (5) | Train Loss: 0.2622 | Train Acc: 0.9397
 Site-Clipart                   (5) | Train Loss: 0.3401 | Train Acc: 0.8925
 Site-Clipart                   (5) | Train Loss: 0.2650 | Train Acc: 0.9396
 Site-Clipart                   (5) | Train Loss: 0.2621 | Train Acc: 0.9434
 Site-Real                      (4) | Train Loss: 0.6197 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.2122 | Train Acc: 0.9655
 Site-Real                      (4) | Train Loss: 0.1190 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.1752 | Train Acc: 0.9459
 Site-Real                      (4) | Train Loss: 0.1799 | Train Acc: 0.9664
 Site-Real                      (4) | Train Loss: 0.2134 | Train Acc: 0.9424
 Site-Real                      (4) | Train Loss: 0.2123 | Train Acc: 0.9412
 Site-Painting                  (0) | Train Loss: 0.4699 | Train Acc: 0.8868
 Site-Painting                  (0) | Train Loss: 0.3154 | Train Acc: 0.8941
 Site-Painting                  (0) | Train Loss: 0.3295 | Train Acc: 0.9044
 Site-Painting                  (0) | Train Loss: 0.2814 | Train Acc: 0.9217
 Site-Sketch                    (2) | Train Loss: 0.3535 | Train Acc: 0.8814
 Site-Sketch                    (2) | Train Loss: 0.4143 | Train Acc: 0.8842
 Site-Sketch                    (2) | Train Loss: 0.4530 | Train Acc: 0.8618
 Site-QuickDraw                 (1) | Train Loss: 0.6851 | Train Acc: 0.8219
 Site-QuickDraw                 (1) | Train Loss: 0.7414 | Train Acc: 0.7627
 Site-Infograph                 (4) | Train Loss: 1.0961 | Train Acc: 0.6583
Average Train Accuracy: 0.8810
============ Train epoch 38 ============
cnt=[5, 2, 12, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (2) | Train Loss: 0.9327 | Train Acc: 0.8333
 Site-Clipart                   (2) | Train Loss: 0.4352 | Train Acc: 0.8182
 Site-Clipart                   (2) | Train Loss: 0.2547 | Train Acc: 0.9412
 Site-Clipart                   (4) | Train Loss: 0.3683 | Train Acc: 0.8929
 Site-Clipart                   (2) | Train Loss: 0.4095 | Train Acc: 0.9111
 Site-Clipart                   (2) | Train Loss: 0.2951 | Train Acc: 0.9028
 Site-Clipart                   (2) | Train Loss: 0.2788 | Train Acc: 0.9310
 Site-Clipart                   (2) | Train Loss: 0.3643 | Train Acc: 0.8925
 Site-Clipart                   (2) | Train Loss: 0.2922 | Train Acc: 0.9161
 Site-Clipart                   (2) | Train Loss: 0.2674 | Train Acc: 0.9392
 Site-Real                      (3) | Train Loss: 0.7073 | Train Acc: 0.7778
 Site-Real                      (5) | Train Loss: 0.2114 | Train Acc: 0.9310
 Site-Real                      (3) | Train Loss: 0.1581 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.2860 | Train Acc: 0.9054
 Site-Real                      (3) | Train Loss: 0.1746 | Train Acc: 0.9664
 Site-Real                      (3) | Train Loss: 0.1897 | Train Acc: 0.9634
 Site-Real                      (3) | Train Loss: 0.2305 | Train Acc: 0.9379
 Site-Painting                  (0) | Train Loss: 0.4053 | Train Acc: 0.9057
 Site-Painting                  (0) | Train Loss: 0.2965 | Train Acc: 0.9294
 Site-Painting                  (0) | Train Loss: 0.2864 | Train Acc: 0.9191
 Site-Painting                  (0) | Train Loss: 0.2859 | Train Acc: 0.9217
 Site-Sketch                    (2) | Train Loss: 0.3697 | Train Acc: 0.9153
 Site-Sketch                    (2) | Train Loss: 0.4366 | Train Acc: 0.8737
 Site-Sketch                    (2) | Train Loss: 0.5056 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 0.7491 | Train Acc: 0.7808
 Site-QuickDraw                 (1) | Train Loss: 0.7745 | Train Acc: 0.7797
 Site-Infograph                 (5) | Train Loss: 1.0881 | Train Acc: 0.6917
Average Train Accuracy: 0.8894
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.8182
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9028
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9310
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.8925
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9161
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9392
 Best site-Real                      | Epoch:38 | Val Acc: 0.7778
 Best site-Real                      | Epoch:38 | Val Acc: 0.9310
 Best site-Real                      | Epoch:38 | Val Acc: 1.0000
 Best site-Real                      | Epoch:38 | Val Acc: 0.9054
 Best site-Real                      | Epoch:38 | Val Acc: 0.9664
 Best site-Real                      | Epoch:38 | Val Acc: 0.9634
 Best site-Real                      | Epoch:38 | Val Acc: 0.9379
 Best site-Painting                  | Epoch:38 | Val Acc: 0.9057
 Best site-Painting                  | Epoch:38 | Val Acc: 0.9294
 Best site-Painting                  | Epoch:38 | Val Acc: 0.9191
 Best site-Painting                  | Epoch:38 | Val Acc: 0.9217
 Best site-Sketch                    | Epoch:38 | Val Acc: 0.9153
 Best site-Sketch                    | Epoch:38 | Val Acc: 0.8737
 Best site-Sketch                    | Epoch:38 | Val Acc: 0.8355
 Best site-QuickDraw                 | Epoch:38 | Val Acc: 0.7808
 Best site-QuickDraw                 | Epoch:38 | Val Acc: 0.7797
 Best site-Infograph                 | Epoch:38 | Val Acc: 0.6917
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 39 ============
cnt=[5, 2, 6, 6, 1, 7, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (5) | Train Loss: 0.8543 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.3861 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.1706 | Train Acc: 0.9412
 Site-Clipart                   (2) | Train Loss: 0.3219 | Train Acc: 0.9286
 Site-Clipart                   (2) | Train Loss: 0.2656 | Train Acc: 0.9556
 Site-Clipart                   (5) | Train Loss: 0.3272 | Train Acc: 0.8889
 Site-Clipart                   (5) | Train Loss: 0.2720 | Train Acc: 0.9310
 Site-Clipart                   (2) | Train Loss: 0.3539 | Train Acc: 0.9140
 Site-Clipart                   (5) | Train Loss: 0.2798 | Train Acc: 0.9161
 Site-Clipart                   (5) | Train Loss: 0.2632 | Train Acc: 0.9434
 Site-Real                      (3) | Train Loss: 0.6649 | Train Acc: 0.7778
 Site-Real                      (3) | Train Loss: 0.2549 | Train Acc: 0.9310
 Site-Real                      (3) | Train Loss: 0.1211 | Train Acc: 0.9565
 Site-Real                      (0) | Train Loss: 0.2350 | Train Acc: 0.9459
 Site-Real                      (3) | Train Loss: 0.1746 | Train Acc: 0.9580
 Site-Real                      (3) | Train Loss: 0.1922 | Train Acc: 0.9581
 Site-Real                      (3) | Train Loss: 0.2284 | Train Acc: 0.9346
 Site-Painting                  (0) | Train Loss: 0.4743 | Train Acc: 0.8679
 Site-Painting                  (0) | Train Loss: 0.3513 | Train Acc: 0.8824
 Site-Painting                  (0) | Train Loss: 0.3045 | Train Acc: 0.9265
 Site-Painting                  (0) | Train Loss: 0.2855 | Train Acc: 0.9217
 Site-Sketch                    (5) | Train Loss: 0.3581 | Train Acc: 0.8983
 Site-Sketch                    (2) | Train Loss: 0.3682 | Train Acc: 0.9053
 Site-Sketch                    (2) | Train Loss: 0.5187 | Train Acc: 0.8289
 Site-QuickDraw                 (1) | Train Loss: 0.8089 | Train Acc: 0.7671
 Site-QuickDraw                 (1) | Train Loss: 0.7567 | Train Acc: 0.7712
 Site-Infograph                 (4) | Train Loss: 1.0784 | Train Acc: 0.6500
Average Train Accuracy: 0.8905
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9286
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9556
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9310
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9140
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9161
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9434
 Best site-Real                      | Epoch:39 | Val Acc: 0.7778
 Best site-Real                      | Epoch:39 | Val Acc: 0.9310
 Best site-Real                      | Epoch:39 | Val Acc: 0.9565
 Best site-Real                      | Epoch:39 | Val Acc: 0.9459
 Best site-Real                      | Epoch:39 | Val Acc: 0.9580
 Best site-Real                      | Epoch:39 | Val Acc: 0.9581
 Best site-Real                      | Epoch:39 | Val Acc: 0.9346
 Best site-Painting                  | Epoch:39 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:39 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:39 | Val Acc: 0.9265
 Best site-Painting                  | Epoch:39 | Val Acc: 0.9217
 Best site-Sketch                    | Epoch:39 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:39 | Val Acc: 0.9053
 Best site-Sketch                    | Epoch:39 | Val Acc: 0.8289
 Best site-QuickDraw                 | Epoch:39 | Val Acc: 0.7671
 Best site-QuickDraw                 | Epoch:39 | Val Acc: 0.7712
 Best site-Infograph                 | Epoch:39 | Val Acc: 0.6500
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 40 ============
cnt=[8, 2, 4, 9, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (3) | Train Loss: 1.0208 | Train Acc: 0.6667
 Site-Clipart                   (3) | Train Loss: 0.3115 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.1848 | Train Acc: 0.9412
 Site-Clipart                   (2) | Train Loss: 0.3385 | Train Acc: 0.8571
 Site-Clipart                   (2) | Train Loss: 0.3343 | Train Acc: 0.9556
 Site-Clipart                   (3) | Train Loss: 0.3077 | Train Acc: 0.9167
 Site-Clipart                   (3) | Train Loss: 0.2577 | Train Acc: 0.9569
 Site-Clipart                   (3) | Train Loss: 0.3450 | Train Acc: 0.8978
 Site-Clipart                   (3) | Train Loss: 0.3068 | Train Acc: 0.9262
 Site-Clipart                   (3) | Train Loss: 0.2681 | Train Acc: 0.9329
 Site-Real                      (4) | Train Loss: 0.7333 | Train Acc: 0.7778
 Site-Real                      (4) | Train Loss: 0.2451 | Train Acc: 0.9310
 Site-Real                      (4) | Train Loss: 0.1219 | Train Acc: 0.9783
 Site-Real                      (0) | Train Loss: 0.2122 | Train Acc: 0.9595
 Site-Real                      (0) | Train Loss: 0.1770 | Train Acc: 0.9664
 Site-Real                      (0) | Train Loss: 0.1904 | Train Acc: 0.9529
 Site-Real                      (0) | Train Loss: 0.2335 | Train Acc: 0.9444
 Site-Painting                  (0) | Train Loss: 0.4423 | Train Acc: 0.8679
 Site-Painting                  (0) | Train Loss: 0.3258 | Train Acc: 0.8941
 Site-Painting                  (0) | Train Loss: 0.3331 | Train Acc: 0.9191
 Site-Painting                  (0) | Train Loss: 0.2604 | Train Acc: 0.9309
 Site-Sketch                    (3) | Train Loss: 0.3754 | Train Acc: 0.8983
 Site-Sketch                    (2) | Train Loss: 0.3484 | Train Acc: 0.9263
 Site-Sketch                    (2) | Train Loss: 0.4292 | Train Acc: 0.8487
 Site-QuickDraw                 (1) | Train Loss: 0.7364 | Train Acc: 0.8493
 Site-QuickDraw                 (1) | Train Loss: 0.7326 | Train Acc: 0.7966
 Site-Infograph                 (5) | Train Loss: 1.0387 | Train Acc: 0.6583
Average Train Accuracy: 0.8911
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9556
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9167
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9569
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.8978
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9262
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9329
 Best site-Real                      | Epoch:40 | Val Acc: 0.7778
 Best site-Real                      | Epoch:40 | Val Acc: 0.9310
 Best site-Real                      | Epoch:40 | Val Acc: 0.9783
 Best site-Real                      | Epoch:40 | Val Acc: 0.9595
 Best site-Real                      | Epoch:40 | Val Acc: 0.9664
 Best site-Real                      | Epoch:40 | Val Acc: 0.9529
 Best site-Real                      | Epoch:40 | Val Acc: 0.9444
 Best site-Painting                  | Epoch:40 | Val Acc: 0.8679
 Best site-Painting                  | Epoch:40 | Val Acc: 0.8941
 Best site-Painting                  | Epoch:40 | Val Acc: 0.9191
 Best site-Painting                  | Epoch:40 | Val Acc: 0.9309
 Best site-Sketch                    | Epoch:40 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:40 | Val Acc: 0.9263
 Best site-Sketch                    | Epoch:40 | Val Acc: 0.8487
 Best site-QuickDraw                 | Epoch:40 | Val Acc: 0.8493
 Best site-QuickDraw                 | Epoch:40 | Val Acc: 0.7966
 Best site-Infograph                 | Epoch:40 | Val Acc: 0.6583
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 41 ============
cnt=[6, 2, 3, 10, 5, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (3) | Train Loss: 0.8068 | Train Acc: 0.8333
 Site-Clipart                   (3) | Train Loss: 0.5465 | Train Acc: 0.8182
 Site-Clipart                   (3) | Train Loss: 0.1966 | Train Acc: 0.9412
 Site-Clipart                   (2) | Train Loss: 0.3732 | Train Acc: 0.9286
 Site-Clipart                   (2) | Train Loss: 0.3134 | Train Acc: 0.9111
 Site-Clipart                   (3) | Train Loss: 0.3450 | Train Acc: 0.8889
 Site-Clipart                   (3) | Train Loss: 0.2980 | Train Acc: 0.9397
 Site-Clipart                   (3) | Train Loss: 0.3270 | Train Acc: 0.9032
 Site-Clipart                   (3) | Train Loss: 0.2723 | Train Acc: 0.9262
 Site-Clipart                   (3) | Train Loss: 0.2711 | Train Acc: 0.9434
 Site-Real                      (0) | Train Loss: 0.6546 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.2568 | Train Acc: 0.9310
 Site-Real                      (0) | Train Loss: 0.1497 | Train Acc: 0.9565
 Site-Real                      (4) | Train Loss: 0.2391 | Train Acc: 0.9459
 Site-Real                      (0) | Train Loss: 0.1855 | Train Acc: 0.9412
 Site-Real                      (0) | Train Loss: 0.1867 | Train Acc: 0.9634
 Site-Real                      (0) | Train Loss: 0.2406 | Train Acc: 0.9314
 Site-Painting                  (4) | Train Loss: 0.3960 | Train Acc: 0.8679
 Site-Painting                  (4) | Train Loss: 0.3128 | Train Acc: 0.9059
 Site-Painting                  (4) | Train Loss: 0.3092 | Train Acc: 0.9044
 Site-Painting                  (4) | Train Loss: 0.2715 | Train Acc: 0.9309
 Site-Sketch                    (2) | Train Loss: 0.4305 | Train Acc: 0.8644
 Site-Sketch                    (3) | Train Loss: 0.3400 | Train Acc: 0.8947
 Site-Sketch                    (3) | Train Loss: 0.4915 | Train Acc: 0.8487
 Site-QuickDraw                 (1) | Train Loss: 0.7826 | Train Acc: 0.7945
 Site-QuickDraw                 (1) | Train Loss: 0.7263 | Train Acc: 0.7966
 Site-Infograph                 (5) | Train Loss: 1.0385 | Train Acc: 0.6750
Average Train Accuracy: 0.8876
============ Train epoch 42 ============
cnt=[6, 2, 5, 7, 3, 4, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (0) | Train Loss: 0.7083 | Train Acc: 0.8333
 Site-Clipart                   (0) | Train Loss: 0.3478 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.0557 | Train Acc: 1.0000
 Site-Clipart                   (3) | Train Loss: 0.2989 | Train Acc: 0.8929
 Site-Clipart                   (3) | Train Loss: 0.3846 | Train Acc: 0.9556
 Site-Clipart                   (0) | Train Loss: 0.4685 | Train Acc: 0.8611
 Site-Clipart                   (0) | Train Loss: 0.2852 | Train Acc: 0.9483
 Site-Clipart                   (3) | Train Loss: 0.3381 | Train Acc: 0.8925
 Site-Clipart                   (3) | Train Loss: 0.2658 | Train Acc: 0.9228
 Site-Clipart                   (0) | Train Loss: 0.2525 | Train Acc: 0.9350
 Site-Real                      (4) | Train Loss: 0.6467 | Train Acc: 0.7778
 Site-Real                      (4) | Train Loss: 0.2159 | Train Acc: 0.9655
 Site-Real                      (2) | Train Loss: 0.1626 | Train Acc: 0.9565
 Site-Real                      (5) | Train Loss: 0.2434 | Train Acc: 0.9189
 Site-Real                      (2) | Train Loss: 0.1580 | Train Acc: 0.9664
 Site-Real                      (2) | Train Loss: 0.2019 | Train Acc: 0.9634
 Site-Real                      (2) | Train Loss: 0.2096 | Train Acc: 0.9477
 Site-Painting                  (2) | Train Loss: 0.3996 | Train Acc: 0.9057
 Site-Painting                  (5) | Train Loss: 0.2879 | Train Acc: 0.9059
 Site-Painting                  (5) | Train Loss: 0.3927 | Train Acc: 0.8824
 Site-Painting                  (5) | Train Loss: 0.2892 | Train Acc: 0.9263
 Site-Sketch                    (3) | Train Loss: 0.3822 | Train Acc: 0.8814
 Site-Sketch                    (3) | Train Loss: 0.4252 | Train Acc: 0.9053
 Site-Sketch                    (3) | Train Loss: 0.4469 | Train Acc: 0.8421
 Site-QuickDraw                 (1) | Train Loss: 0.7363 | Train Acc: 0.8219
 Site-QuickDraw                 (1) | Train Loss: 0.7049 | Train Acc: 0.7627
 Site-Infograph                 (4) | Train Loss: 0.9792 | Train Acc: 0.7083
Average Train Accuracy: 0.8959
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:42 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9556
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.8611
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9483
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.8925
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9228
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9350
 Best site-Real                      | Epoch:42 | Val Acc: 0.7778
 Best site-Real                      | Epoch:42 | Val Acc: 0.9655
 Best site-Real                      | Epoch:42 | Val Acc: 0.9565
 Best site-Real                      | Epoch:42 | Val Acc: 0.9189
 Best site-Real                      | Epoch:42 | Val Acc: 0.9664
 Best site-Real                      | Epoch:42 | Val Acc: 0.9634
 Best site-Real                      | Epoch:42 | Val Acc: 0.9477
 Best site-Painting                  | Epoch:42 | Val Acc: 0.9057
 Best site-Painting                  | Epoch:42 | Val Acc: 0.9059
 Best site-Painting                  | Epoch:42 | Val Acc: 0.8824
 Best site-Painting                  | Epoch:42 | Val Acc: 0.9263
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.9053
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.8421
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.8219
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.7627
 Best site-Infograph                 | Epoch:42 | Val Acc: 0.7083
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 43 ============
cnt=[1, 2, 4, 9, 10, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (2) | Train Loss: 0.8714 | Train Acc: 0.8333
 Site-Clipart                   (2) | Train Loss: 0.3511 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.1536 | Train Acc: 0.9412
 Site-Clipart                   (3) | Train Loss: 0.3782 | Train Acc: 0.8929
 Site-Clipart                   (3) | Train Loss: 0.2568 | Train Acc: 0.9556
 Site-Clipart                   (2) | Train Loss: 0.2833 | Train Acc: 0.9028
 Site-Clipart                   (3) | Train Loss: 0.3049 | Train Acc: 0.9052
 Site-Clipart                   (2) | Train Loss: 0.3338 | Train Acc: 0.9086
 Site-Clipart                   (3) | Train Loss: 0.2412 | Train Acc: 0.9362
 Site-Clipart                   (3) | Train Loss: 0.2481 | Train Acc: 0.9392
 Site-Real                      (4) | Train Loss: 0.6638 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.2442 | Train Acc: 0.9655
 Site-Real                      (4) | Train Loss: 0.1295 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.2096 | Train Acc: 0.9595
 Site-Real                      (4) | Train Loss: 0.1555 | Train Acc: 0.9748
 Site-Real                      (4) | Train Loss: 0.1782 | Train Acc: 0.9581
 Site-Real                      (4) | Train Loss: 0.2156 | Train Acc: 0.9477
 Site-Painting                  (4) | Train Loss: 0.4211 | Train Acc: 0.8868
 Site-Painting                  (4) | Train Loss: 0.2941 | Train Acc: 0.9176
 Site-Painting                  (4) | Train Loss: 0.2634 | Train Acc: 0.9412
 Site-Painting                  (4) | Train Loss: 0.2837 | Train Acc: 0.9032
 Site-Sketch                    (3) | Train Loss: 0.3254 | Train Acc: 0.8814
 Site-Sketch                    (3) | Train Loss: 0.3535 | Train Acc: 0.9053
 Site-Sketch                    (3) | Train Loss: 0.4486 | Train Acc: 0.8553
 Site-QuickDraw                 (1) | Train Loss: 0.7417 | Train Acc: 0.7397
 Site-QuickDraw                 (1) | Train Loss: 0.6813 | Train Acc: 0.8390
 Site-Infograph                 (5) | Train Loss: 0.9936 | Train Acc: 0.6917
Average Train Accuracy: 0.8988
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9412
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.8929
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9556
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9028
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9052
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9086
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9362
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9392
 Best site-Real                      | Epoch:43 | Val Acc: 0.7778
 Best site-Real                      | Epoch:43 | Val Acc: 0.9655
 Best site-Real                      | Epoch:43 | Val Acc: 1.0000
 Best site-Real                      | Epoch:43 | Val Acc: 0.9595
 Best site-Real                      | Epoch:43 | Val Acc: 0.9748
 Best site-Real                      | Epoch:43 | Val Acc: 0.9581
 Best site-Real                      | Epoch:43 | Val Acc: 0.9477
 Best site-Painting                  | Epoch:43 | Val Acc: 0.8868
 Best site-Painting                  | Epoch:43 | Val Acc: 0.9176
 Best site-Painting                  | Epoch:43 | Val Acc: 0.9412
 Best site-Painting                  | Epoch:43 | Val Acc: 0.9032
 Best site-Sketch                    | Epoch:43 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:43 | Val Acc: 0.9053
 Best site-Sketch                    | Epoch:43 | Val Acc: 0.8553
 Best site-QuickDraw                 | Epoch:43 | Val Acc: 0.7397
 Best site-QuickDraw                 | Epoch:43 | Val Acc: 0.8390
 Best site-Infograph                 | Epoch:43 | Val Acc: 0.6917
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 44 ============
cnt=[11, 2, 5, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (5) | Train Loss: 0.5789 | Train Acc: 0.8333
 Site-Clipart                   (0) | Train Loss: 0.4539 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.2357 | Train Acc: 0.8824
 Site-Clipart                   (3) | Train Loss: 0.3106 | Train Acc: 0.9286
 Site-Clipart                   (0) | Train Loss: 0.3493 | Train Acc: 0.9333
 Site-Clipart                   (0) | Train Loss: 0.2921 | Train Acc: 0.9028
 Site-Clipart                   (0) | Train Loss: 0.2423 | Train Acc: 0.9397
 Site-Clipart                   (0) | Train Loss: 0.3327 | Train Acc: 0.9194
 Site-Clipart                   (0) | Train Loss: 0.2710 | Train Acc: 0.9195
 Site-Clipart                   (0) | Train Loss: 0.2479 | Train Acc: 0.9350
 Site-Real                      (2) | Train Loss: 0.6581 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.2460 | Train Acc: 0.8966
 Site-Real                      (4) | Train Loss: 0.1279 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.1507 | Train Acc: 0.9595
 Site-Real                      (2) | Train Loss: 0.1696 | Train Acc: 0.9664
 Site-Real                      (2) | Train Loss: 0.1814 | Train Acc: 0.9634
 Site-Real                      (2) | Train Loss: 0.2078 | Train Acc: 0.9412
 Site-Painting                  (4) | Train Loss: 0.4575 | Train Acc: 0.8491
 Site-Painting                  (4) | Train Loss: 0.3151 | Train Acc: 0.8824
 Site-Painting                  (4) | Train Loss: 0.2705 | Train Acc: 0.9412
 Site-Painting                  (4) | Train Loss: 0.2637 | Train Acc: 0.9309
 Site-Sketch                    (0) | Train Loss: 0.3586 | Train Acc: 0.8814
 Site-Sketch                    (0) | Train Loss: 0.3986 | Train Acc: 0.8947
 Site-Sketch                    (0) | Train Loss: 0.4581 | Train Acc: 0.8355
 Site-QuickDraw                 (1) | Train Loss: 0.7385 | Train Acc: 0.7534
 Site-QuickDraw                 (1) | Train Loss: 0.7367 | Train Acc: 0.8051
 Site-Infograph                 (3) | Train Loss: 0.9595 | Train Acc: 0.7167
Average Train Accuracy: 0.8925
============ Train epoch 45 ============
cnt=[12, 2, 6, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (0) | Train Loss: 0.8328 | Train Acc: 0.6667
 Site-Clipart                   (0) | Train Loss: 0.3772 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.0784 | Train Acc: 1.0000
 Site-Clipart                   (5) | Train Loss: 0.3126 | Train Acc: 0.9643
 Site-Clipart                   (0) | Train Loss: 0.3049 | Train Acc: 0.9556
 Site-Clipart                   (0) | Train Loss: 0.3478 | Train Acc: 0.9306
 Site-Clipart                   (0) | Train Loss: 0.2640 | Train Acc: 0.9397
 Site-Clipart                   (0) | Train Loss: 0.3192 | Train Acc: 0.9247
 Site-Clipart                   (0) | Train Loss: 0.2356 | Train Acc: 0.9295
 Site-Clipart                   (0) | Train Loss: 0.2368 | Train Acc: 0.9497
 Site-Real                      (2) | Train Loss: 0.6252 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.2398 | Train Acc: 0.9310
 Site-Real                      (2) | Train Loss: 0.1160 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.1961 | Train Acc: 0.9324
 Site-Real                      (2) | Train Loss: 0.1747 | Train Acc: 0.9580
 Site-Real                      (2) | Train Loss: 0.1846 | Train Acc: 0.9581
 Site-Real                      (2) | Train Loss: 0.2250 | Train Acc: 0.9412
 Site-Painting                  (4) | Train Loss: 0.4328 | Train Acc: 0.8491
 Site-Painting                  (4) | Train Loss: 0.2480 | Train Acc: 0.9412
 Site-Painting                  (4) | Train Loss: 0.3173 | Train Acc: 0.9118
 Site-Painting                  (4) | Train Loss: 0.2816 | Train Acc: 0.9217
 Site-Sketch                    (0) | Train Loss: 0.3651 | Train Acc: 0.8475
 Site-Sketch                    (0) | Train Loss: 0.3914 | Train Acc: 0.8632
 Site-Sketch                    (0) | Train Loss: 0.4951 | Train Acc: 0.8224
 Site-QuickDraw                 (1) | Train Loss: 0.7714 | Train Acc: 0.7534
 Site-QuickDraw                 (1) | Train Loss: 0.6808 | Train Acc: 0.7966
 Site-Infograph                 (3) | Train Loss: 0.9270 | Train Acc: 0.7250
Average Train Accuracy: 0.8926
============ Train epoch 46 ============
cnt=[2, 2, 12, 1, 2, 8, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (0) | Train Loss: 0.8385 | Train Acc: 0.6667
 Site-Clipart                   (2) | Train Loss: 0.2620 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.1690 | Train Acc: 0.9412
 Site-Clipart                   (2) | Train Loss: 0.3629 | Train Acc: 0.8929
 Site-Clipart                   (2) | Train Loss: 0.3168 | Train Acc: 0.9556
 Site-Clipart                   (2) | Train Loss: 0.3242 | Train Acc: 0.8472
 Site-Clipart                   (2) | Train Loss: 0.2459 | Train Acc: 0.9655
 Site-Clipart                   (2) | Train Loss: 0.3272 | Train Acc: 0.8925
 Site-Clipart                   (2) | Train Loss: 0.2845 | Train Acc: 0.9262
 Site-Clipart                   (2) | Train Loss: 0.2382 | Train Acc: 0.9455
 Site-Real                      (4) | Train Loss: 0.6515 | Train Acc: 0.7778
 Site-Real                      (4) | Train Loss: 0.2096 | Train Acc: 0.9310
 Site-Real                      (5) | Train Loss: 0.1191 | Train Acc: 1.0000
 Site-Real                      (5) | Train Loss: 0.2239 | Train Acc: 0.9595
 Site-Real                      (5) | Train Loss: 0.1678 | Train Acc: 0.9580
 Site-Real                      (5) | Train Loss: 0.1774 | Train Acc: 0.9686
 Site-Real                      (5) | Train Loss: 0.2000 | Train Acc: 0.9444
 Site-Painting                  (5) | Train Loss: 0.4416 | Train Acc: 0.9057
 Site-Painting                  (0) | Train Loss: 0.3108 | Train Acc: 0.8941
 Site-Painting                  (5) | Train Loss: 0.2748 | Train Acc: 0.9485
 Site-Painting                  (5) | Train Loss: 0.2613 | Train Acc: 0.9355
 Site-Sketch                    (2) | Train Loss: 0.3941 | Train Acc: 0.8814
 Site-Sketch                    (2) | Train Loss: 0.3463 | Train Acc: 0.9053
 Site-Sketch                    (2) | Train Loss: 0.4013 | Train Acc: 0.8816
 Site-QuickDraw                 (1) | Train Loss: 0.8932 | Train Acc: 0.7534
 Site-QuickDraw                 (1) | Train Loss: 0.6810 | Train Acc: 0.8136
 Site-Infograph                 (3) | Train Loss: 0.8891 | Train Acc: 0.7417
Average Train Accuracy: 0.8942
============ Train epoch 47 ============
cnt=[6, 2, 9, 1, 6, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (4) | Train Loss: 0.7979 | Train Acc: 0.6667
 Site-Clipart                   (5) | Train Loss: 0.4980 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.1706 | Train Acc: 0.9412
 Site-Clipart                   (5) | Train Loss: 0.2475 | Train Acc: 0.9286
 Site-Clipart                   (5) | Train Loss: 0.4094 | Train Acc: 0.9111
 Site-Clipart                   (2) | Train Loss: 0.2771 | Train Acc: 0.8750
 Site-Clipart                   (2) | Train Loss: 0.2561 | Train Acc: 0.9569
 Site-Clipart                   (2) | Train Loss: 0.3661 | Train Acc: 0.8817
 Site-Clipart                   (2) | Train Loss: 0.2715 | Train Acc: 0.9161
 Site-Clipart                   (2) | Train Loss: 0.2378 | Train Acc: 0.9476
 Site-Real                      (0) | Train Loss: 0.6086 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.2087 | Train Acc: 0.9655
 Site-Real                      (0) | Train Loss: 0.1244 | Train Acc: 1.0000
 Site-Real                      (4) | Train Loss: 0.1953 | Train Acc: 0.9459
 Site-Real                      (0) | Train Loss: 0.1506 | Train Acc: 0.9748
 Site-Real                      (0) | Train Loss: 0.1930 | Train Acc: 0.9581
 Site-Real                      (0) | Train Loss: 0.2086 | Train Acc: 0.9510
 Site-Painting                  (4) | Train Loss: 0.4234 | Train Acc: 0.9245
 Site-Painting                  (4) | Train Loss: 0.2694 | Train Acc: 0.9176
 Site-Painting                  (4) | Train Loss: 0.2790 | Train Acc: 0.9191
 Site-Painting                  (4) | Train Loss: 0.2488 | Train Acc: 0.9355
 Site-Sketch                    (2) | Train Loss: 0.3468 | Train Acc: 0.8475
 Site-Sketch                    (2) | Train Loss: 0.3995 | Train Acc: 0.8737
 Site-Sketch                    (2) | Train Loss: 0.4516 | Train Acc: 0.8618
 Site-QuickDraw                 (1) | Train Loss: 0.8649 | Train Acc: 0.7808
 Site-QuickDraw                 (1) | Train Loss: 0.6652 | Train Acc: 0.8644
 Site-Infograph                 (3) | Train Loss: 0.9120 | Train Acc: 0.7250
Average Train Accuracy: 0.8947
============ Train epoch 48 ============
cnt=[3, 2, 11, 1, 9, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (0) | Train Loss: 0.7052 | Train Acc: 0.8333
 Site-Clipart                   (0) | Train Loss: 0.4512 | Train Acc: 0.9091
 Site-Clipart                   (4) | Train Loss: 0.0916 | Train Acc: 1.0000
 Site-Clipart                   (5) | Train Loss: 0.3135 | Train Acc: 0.9286
 Site-Clipart                   (4) | Train Loss: 0.2961 | Train Acc: 0.9111
 Site-Clipart                   (4) | Train Loss: 0.3485 | Train Acc: 0.8750
 Site-Clipart                   (4) | Train Loss: 0.2087 | Train Acc: 0.9655
 Site-Clipart                   (4) | Train Loss: 0.3565 | Train Acc: 0.8871
 Site-Clipart                   (4) | Train Loss: 0.2541 | Train Acc: 0.9295
 Site-Clipart                   (4) | Train Loss: 0.2451 | Train Acc: 0.9287
 Site-Real                      (2) | Train Loss: 0.6619 | Train Acc: 0.7778
 Site-Real                      (2) | Train Loss: 0.2342 | Train Acc: 0.9655
 Site-Real                      (2) | Train Loss: 0.1472 | Train Acc: 0.9783
 Site-Real                      (2) | Train Loss: 0.2239 | Train Acc: 0.9595
 Site-Real                      (2) | Train Loss: 0.1422 | Train Acc: 0.9748
 Site-Real                      (2) | Train Loss: 0.1905 | Train Acc: 0.9581
 Site-Real                      (2) | Train Loss: 0.2041 | Train Acc: 0.9379
 Site-Painting                  (2) | Train Loss: 0.3725 | Train Acc: 0.8868
 Site-Painting                  (2) | Train Loss: 0.2699 | Train Acc: 0.9529
 Site-Painting                  (2) | Train Loss: 0.2933 | Train Acc: 0.9191
 Site-Painting                  (2) | Train Loss: 0.2609 | Train Acc: 0.9263
 Site-Sketch                    (4) | Train Loss: 0.3761 | Train Acc: 0.8814
 Site-Sketch                    (4) | Train Loss: 0.3747 | Train Acc: 0.9158
 Site-Sketch                    (0) | Train Loss: 0.4234 | Train Acc: 0.8684
 Site-QuickDraw                 (1) | Train Loss: 0.7346 | Train Acc: 0.8219
 Site-QuickDraw                 (1) | Train Loss: 0.6786 | Train Acc: 0.7881
 Site-Infograph                 (3) | Train Loss: 0.9138 | Train Acc: 0.7417
Average Train Accuracy: 0.9045
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9091
 Best site-Clipart                   | Epoch:48 | Val Acc: 1.0000
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9286
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9111
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.8750
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9655
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.8871
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9295
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9287
 Best site-Real                      | Epoch:48 | Val Acc: 0.7778
 Best site-Real                      | Epoch:48 | Val Acc: 0.9655
 Best site-Real                      | Epoch:48 | Val Acc: 0.9783
 Best site-Real                      | Epoch:48 | Val Acc: 0.9595
 Best site-Real                      | Epoch:48 | Val Acc: 0.9748
 Best site-Real                      | Epoch:48 | Val Acc: 0.9581
 Best site-Real                      | Epoch:48 | Val Acc: 0.9379
 Best site-Painting                  | Epoch:48 | Val Acc: 0.8868
 Best site-Painting                  | Epoch:48 | Val Acc: 0.9529
 Best site-Painting                  | Epoch:48 | Val Acc: 0.9191
 Best site-Painting                  | Epoch:48 | Val Acc: 0.9263
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.9158
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.8684
 Best site-QuickDraw                 | Epoch:48 | Val Acc: 0.8219
 Best site-QuickDraw                 | Epoch:48 | Val Acc: 0.7881
 Best site-Infograph                 | Epoch:48 | Val Acc: 0.7417
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.6_2/ccop_q=1_kmeans...
============ Train epoch 49 ============
cnt=[7, 2, 8, 1, 5, 4, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (2) | Train Loss: 0.7977 | Train Acc: 0.8333
 Site-Clipart                   (2) | Train Loss: 0.2967 | Train Acc: 0.9091
 Site-Clipart                   (2) | Train Loss: 0.2029 | Train Acc: 0.9412
 Site-Clipart                   (4) | Train Loss: 0.3725 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.3100 | Train Acc: 0.9556
 Site-Clipart                   (2) | Train Loss: 0.2386 | Train Acc: 0.9167
 Site-Clipart                   (2) | Train Loss: 0.2363 | Train Acc: 0.9569
 Site-Clipart                   (2) | Train Loss: 0.3062 | Train Acc: 0.9194
 Site-Clipart                   (2) | Train Loss: 0.2469 | Train Acc: 0.9295
 Site-Clipart                   (2) | Train Loss: 0.2433 | Train Acc: 0.9371
 Site-Real                      (0) | Train Loss: 0.6708 | Train Acc: 0.7778
 Site-Real                      (0) | Train Loss: 0.2184 | Train Acc: 0.9655
 Site-Real                      (0) | Train Loss: 0.1366 | Train Acc: 1.0000
 Site-Real                      (0) | Train Loss: 0.1937 | Train Acc: 0.9459
 Site-Real                      (0) | Train Loss: 0.1727 | Train Acc: 0.9664
 Site-Real                      (0) | Train Loss: 0.1717 | Train Acc: 0.9581
 Site-Real                      (0) | Train Loss: 0.2019 | Train Acc: 0.9444
 Site-Painting                  (5) | Train Loss: 0.3874 | Train Acc: 0.9057
 Site-Painting                  (5) | Train Loss: 0.3385 | Train Acc: 0.9059
 Site-Painting                  (5) | Train Loss: 0.2465 | Train Acc: 0.9338
 Site-Painting                  (5) | Train Loss: 0.2751 | Train Acc: 0.9171
 Site-Sketch                    (4) | Train Loss: 0.2933 | Train Acc: 0.9322
 Site-Sketch                    (4) | Train Loss: 0.3662 | Train Acc: 0.9263
 Site-Sketch                    (4) | Train Loss: 0.4279 | Train Acc: 0.8684
 Site-QuickDraw                 (1) | Train Loss: 0.8178 | Train Acc: 0.7260
 Site-QuickDraw                 (1) | Train Loss: 0.6328 | Train Acc: 0.8475
 Site-Infograph                 (3) | Train Loss: 0.8624 | Train Acc: 0.7333
Average Train Accuracy: 0.9041
 Test site-Clipart                   (2)| Epoch:48 | Test Acc: 0.9183
 Test site-Real                      (0)| Epoch:48 | Test Acc: 0.9458
 Test site-Painting                  (5)| Epoch:48 | Test Acc: 0.9321
 Test site-Sketch                    (4)| Epoch:48 | Test Acc: 0.8809
 Test site-QuickDraw                 (1)| Epoch:48 | Test Acc: 0.7310
 Test site-Infograph                 (3)| Epoch:48 | Test Acc: 0.5373
Clipart: 0.9183, Real: 0.9458, Painting: 0.9321, Sketch: 0.8809, QuickDraw: 0.7310, Infograph: 0.5373, 
Average Test Accuracy(group): 0.8242, Average Test Accuracy(individual): 0.8953,
domain std=0.1469, cluster std=0.1480, individual std=0.0885, 
===2023-08-17 19:07:07===
===2023-08-17 19:07:23===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 6
data_number=[6,11,17,28,45,72,116,186,298,477,18,29,46,74,119,191,306,53,85,136,217,59,95,152,73,118,120,
client_nums=[10,7,4,3,2,1,]
len_dataset=[2103,1314,821,513,320,200,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:48 | Test Acc: 0.9183
 Test site-Real                      (2)| Epoch:48 | Test Acc: 0.9441
 Test site-Painting                  (2)| Epoch:48 | Test Acc: 0.9321
 Test site-Sketch                    (4)| Epoch:48 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:48 | Test Acc: 0.7290
 Test site-Infograph                 (3)| Epoch:48 | Test Acc: 0.5327
Clipart: 0.9183, Real: 0.9441, Painting: 0.9321, Sketch: 0.8791, QuickDraw: 0.7290, Infograph: 0.5327, 
Average Test Accuracy(group): 0.8226, Average Test Accuracy(individual): 0.8944,
domain std=0.1483, cluster std=0.1472, individual std=0.0892, 
