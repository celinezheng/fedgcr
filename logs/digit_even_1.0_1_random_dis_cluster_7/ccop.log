===2023-08-12 12:29:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.6627 | Train Acc: 0.5849
 Site-MNIST                     (2) | Train Loss: 1.7236 | Train Acc: 0.5390
 Site-USPS                      (4) | Train Loss: 1.6203 | Train Acc: 0.6927
 Site-USPS                      (4) | Train Loss: 1.6366 | Train Acc: 0.6574
 Site-SynthDigits               (0) | Train Loss: 2.0559 | Train Acc: 0.2992
 Site-SynthDigits               (0) | Train Loss: 2.0226 | Train Acc: 0.3417
 Site-MNIST_M                   (3) | Train Loss: 2.1848 | Train Acc: 0.2210
 Site-MNIST_M                   (5) | Train Loss: 2.1833 | Train Acc: 0.2251
 Site-SVHN                      (6) | Train Loss: 2.1921 | Train Acc: 0.1995
 Site-SVHN                      (1) | Train Loss: 2.1735 | Train Acc: 0.2359
Average Train Accuracy: 0.3996
 Site-MNIST                     (2) | Val  Loss: 1.7611 | Val  Acc: 0.5109
 Site-MNIST                     (2) | Val  Loss: 1.6877 | Val  Acc: 0.5791
 Site-USPS                      (4) | Val  Loss: 1.6446 | Val  Acc: 0.6522
 Site-USPS                      (4) | Val  Loss: 1.6560 | Val  Acc: 0.6367
 Site-SynthDigits               (0) | Val  Loss: 2.0734 | Val  Acc: 0.2935
 Site-SynthDigits               (0) | Val  Loss: 2.0365 | Val  Acc: 0.3309
 Site-MNIST_M                   (3) | Val  Loss: 2.2369 | Val  Acc: 0.2283
 Site-MNIST_M                   (5) | Val  Loss: 2.1856 | Val  Acc: 0.2374
 Site-SVHN                      (6) | Val  Loss: 2.1650 | Val  Acc: 0.2935
 Site-SVHN                      (1) | Val  Loss: 2.1733 | Val  Acc: 0.2374
Average Valid Accuracy: 0.4000
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5109
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5791
 Best site-USPS                     (4)  | Epoch:0 | Val Acc: 0.6522
 Best site-USPS                     (4)  | Epoch:0 | Val Acc: 0.6367
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.2935
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.3309
 Best site-MNIST_M                  (3)  | Epoch:0 | Val Acc: 0.2283
 Best site-MNIST_M                  (5)  | Epoch:0 | Val Acc: 0.2374
 Best site-SVHN                     (6)  | Epoch:0 | Val Acc: 0.2935
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.2594 | Train Acc: 0.8059
 Site-MNIST                     (0) | Train Loss: 1.3356 | Train Acc: 0.7283
 Site-USPS                      (2) | Train Loss: 1.1660 | Train Acc: 0.8113
 Site-USPS                      (6) | Train Loss: 1.1948 | Train Acc: 0.7874
 Site-SynthDigits               (4) | Train Loss: 1.8230 | Train Acc: 0.3854
 Site-SynthDigits               (5) | Train Loss: 1.7435 | Train Acc: 0.4359
 Site-MNIST_M                   (3) | Train Loss: 1.9512 | Train Acc: 0.3612
 Site-MNIST_M                   (3) | Train Loss: 1.9764 | Train Acc: 0.3354
 Site-SVHN                      (1) | Train Loss: 2.0655 | Train Acc: 0.2668
 Site-SVHN                      (1) | Train Loss: 2.0251 | Train Acc: 0.2996
Average Train Accuracy: 0.5217
 Site-MNIST                     (0) | Val  Loss: 1.3428 | Val  Acc: 0.7174
 Site-MNIST                     (0) | Val  Loss: 1.3014 | Val  Acc: 0.7698
 Site-USPS                      (2) | Val  Loss: 1.2139 | Val  Acc: 0.7609
 Site-USPS                      (6) | Val  Loss: 1.2302 | Val  Acc: 0.7698
 Site-SynthDigits               (4) | Val  Loss: 1.7724 | Val  Acc: 0.3804
 Site-SynthDigits               (5) | Val  Loss: 1.7518 | Val  Acc: 0.3957
 Site-MNIST_M                   (3) | Val  Loss: 2.0141 | Val  Acc: 0.3261
 Site-MNIST_M                   (3) | Val  Loss: 1.9415 | Val  Acc: 0.3993
 Site-SVHN                      (1) | Val  Loss: 2.0469 | Val  Acc: 0.3152
 Site-SVHN                      (1) | Val  Loss: 2.0614 | Val  Acc: 0.3094
Average Valid Accuracy: 0.5144
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7174
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7698
 Best site-USPS                     (2)  | Epoch:1 | Val Acc: 0.7609
 Best site-USPS                     (6)  | Epoch:1 | Val Acc: 0.7698
 Best site-SynthDigits              (4)  | Epoch:1 | Val Acc: 0.3804
 Best site-SynthDigits              (5)  | Epoch:1 | Val Acc: 0.3957
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.3261
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.3993
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.3152
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.3094
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (0) | Train Loss: 1.1168 | Train Acc: 0.7736
 Site-MNIST                     (0) | Train Loss: 1.2046 | Train Acc: 0.7166
 Site-USPS                      (6) | Train Loss: 1.0022 | Train Acc: 0.8275
 Site-USPS                      (2) | Train Loss: 1.0375 | Train Acc: 0.7919
 Site-SynthDigits               (4) | Train Loss: 1.5803 | Train Acc: 0.5040
 Site-SynthDigits               (5) | Train Loss: 1.5000 | Train Acc: 0.5309
 Site-MNIST_M                   (3) | Train Loss: 1.7196 | Train Acc: 0.4582
 Site-MNIST_M                   (3) | Train Loss: 1.7794 | Train Acc: 0.4090
 Site-SVHN                      (1) | Train Loss: 1.9415 | Train Acc: 0.3423
 Site-SVHN                      (1) | Train Loss: 1.8839 | Train Acc: 0.3480
Average Train Accuracy: 0.5702
 Site-MNIST                     (0) | Val  Loss: 1.1939 | Val  Acc: 0.7283
 Site-MNIST                     (0) | Val  Loss: 1.1753 | Val  Acc: 0.7770
 Site-USPS                      (6) | Val  Loss: 1.0530 | Val  Acc: 0.7826
 Site-USPS                      (2) | Val  Loss: 1.0738 | Val  Acc: 0.7986
 Site-SynthDigits               (4) | Val  Loss: 1.5120 | Val  Acc: 0.4674
 Site-SynthDigits               (5) | Val  Loss: 1.4862 | Val  Acc: 0.5036
 Site-MNIST_M                   (3) | Val  Loss: 1.8056 | Val  Acc: 0.4130
 Site-MNIST_M                   (3) | Val  Loss: 1.7171 | Val  Acc: 0.5000
 Site-SVHN                      (1) | Val  Loss: 1.9216 | Val  Acc: 0.3261
 Site-SVHN                      (1) | Val  Loss: 1.9433 | Val  Acc: 0.3597
Average Valid Accuracy: 0.5656
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7283
 Best site-MNIST                    (0)  | Epoch:2 | Val Acc: 0.7770
 Best site-USPS                     (6)  | Epoch:2 | Val Acc: 0.7826
 Best site-USPS                     (2)  | Epoch:2 | Val Acc: 0.7986
 Best site-SynthDigits              (4)  | Epoch:2 | Val Acc: 0.4674
 Best site-SynthDigits              (5)  | Epoch:2 | Val Acc: 0.5036
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.4130
 Best site-MNIST_M                  (3)  | Epoch:2 | Val Acc: 0.5000
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3261
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.3597
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (4) | Train Loss: 0.8607 | Train Acc: 0.8652
 Site-MNIST                     (4) | Train Loss: 0.9467 | Train Acc: 0.8009
 Site-USPS                      (5) | Train Loss: 0.8117 | Train Acc: 0.8571
 Site-USPS                      (1) | Train Loss: 0.8397 | Train Acc: 0.8314
 Site-SynthDigits               (2) | Train Loss: 1.3827 | Train Acc: 0.5903
 Site-SynthDigits               (2) | Train Loss: 1.2873 | Train Acc: 0.6422
 Site-MNIST_M                   (3) | Train Loss: 1.5801 | Train Acc: 0.5067
 Site-MNIST_M                   (3) | Train Loss: 1.6134 | Train Acc: 0.4933
 Site-SVHN                      (6) | Train Loss: 1.8260 | Train Acc: 0.3908
 Site-SVHN                      (0) | Train Loss: 1.7492 | Train Acc: 0.4188
Average Train Accuracy: 0.6397
 Site-MNIST                     (4) | Val  Loss: 0.9345 | Val  Acc: 0.8152
 Site-MNIST                     (4) | Val  Loss: 0.9286 | Val  Acc: 0.8273
 Site-USPS                      (5) | Val  Loss: 0.8872 | Val  Acc: 0.7500
 Site-USPS                      (1) | Val  Loss: 0.8861 | Val  Acc: 0.8094
 Site-SynthDigits               (2) | Val  Loss: 1.3262 | Val  Acc: 0.5761
 Site-SynthDigits               (2) | Val  Loss: 1.2881 | Val  Acc: 0.5719
 Site-MNIST_M                   (3) | Val  Loss: 1.6624 | Val  Acc: 0.4348
 Site-MNIST_M                   (3) | Val  Loss: 1.5641 | Val  Acc: 0.5324
 Site-SVHN                      (6) | Val  Loss: 1.8076 | Val  Acc: 0.3587
 Site-SVHN                      (0) | Val  Loss: 1.8341 | Val  Acc: 0.3921
Average Valid Accuracy: 0.6068
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.8152
 Best site-MNIST                    (4)  | Epoch:3 | Val Acc: 0.8273
 Best site-USPS                     (5)  | Epoch:3 | Val Acc: 0.7500
 Best site-USPS                     (1)  | Epoch:3 | Val Acc: 0.8094
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5761
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5719
 Best site-MNIST_M                  (3)  | Epoch:3 | Val Acc: 0.4348
 Best site-MNIST_M                  (3)  | Epoch:3 | Val Acc: 0.5324
 Best site-SVHN                     (6)  | Epoch:3 | Val Acc: 0.3587
 Best site-SVHN                     (0)  | Epoch:3 | Val Acc: 0.3921
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (1) | Train Loss: 0.7394 | Train Acc: 0.8679
 Site-MNIST                     (1) | Train Loss: 0.8346 | Train Acc: 0.8287
 Site-USPS                      (6) | Train Loss: 0.7294 | Train Acc: 0.8544
 Site-USPS                      (3) | Train Loss: 0.7545 | Train Acc: 0.8377
 Site-SynthDigits               (4) | Train Loss: 1.2074 | Train Acc: 0.6496
 Site-SynthDigits               (4) | Train Loss: 1.1195 | Train Acc: 0.6978
 Site-MNIST_M                   (5) | Train Loss: 1.4644 | Train Acc: 0.5957
 Site-MNIST_M                   (0) | Train Loss: 1.5098 | Train Acc: 0.5435
 Site-SVHN                      (2) | Train Loss: 1.6703 | Train Acc: 0.4528
 Site-SVHN                      (2) | Train Loss: 1.5951 | Train Acc: 0.4807
Average Train Accuracy: 0.6809
 Site-MNIST                     (1) | Val  Loss: 0.7837 | Val  Acc: 0.8152
 Site-MNIST                     (1) | Val  Loss: 0.8088 | Val  Acc: 0.8345
 Site-USPS                      (6) | Val  Loss: 0.8175 | Val  Acc: 0.7717
 Site-USPS                      (3) | Val  Loss: 0.8120 | Val  Acc: 0.8201
 Site-SynthDigits               (4) | Val  Loss: 1.1443 | Val  Acc: 0.6413
 Site-SynthDigits               (4) | Val  Loss: 1.1340 | Val  Acc: 0.6331
 Site-MNIST_M                   (5) | Val  Loss: 1.5674 | Val  Acc: 0.5217
 Site-MNIST_M                   (0) | Val  Loss: 1.4633 | Val  Acc: 0.5827
 Site-SVHN                      (2) | Val  Loss: 1.6614 | Val  Acc: 0.3913
 Site-SVHN                      (2) | Val  Loss: 1.6700 | Val  Acc: 0.4640
Average Valid Accuracy: 0.6476
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8152
 Best site-MNIST                    (1)  | Epoch:4 | Val Acc: 0.8345
 Best site-USPS                     (6)  | Epoch:4 | Val Acc: 0.7717
 Best site-USPS                     (3)  | Epoch:4 | Val Acc: 0.8201
 Best site-SynthDigits              (4)  | Epoch:4 | Val Acc: 0.6413
 Best site-SynthDigits              (4)  | Epoch:4 | Val Acc: 0.6331
 Best site-MNIST_M                  (5)  | Epoch:4 | Val Acc: 0.5217
 Best site-MNIST_M                  (0)  | Epoch:4 | Val Acc: 0.5827
 Best site-SVHN                     (2)  | Epoch:4 | Val Acc: 0.3913
 Best site-SVHN                     (2)  | Epoch:4 | Val Acc: 0.4640
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (0) | Train Loss: 0.6563 | Train Acc: 0.8787
 Site-MNIST                     (0) | Train Loss: 0.7410 | Train Acc: 0.8224
 Site-USPS                      (6) | Train Loss: 0.6714 | Train Acc: 0.8464
 Site-USPS                      (2) | Train Loss: 0.6933 | Train Acc: 0.8332
 Site-SynthDigits               (4) | Train Loss: 1.1168 | Train Acc: 0.6496
 Site-SynthDigits               (4) | Train Loss: 1.0226 | Train Acc: 0.7103
 Site-MNIST_M                   (1) | Train Loss: 1.3379 | Train Acc: 0.6334
 Site-MNIST_M                   (1) | Train Loss: 1.3924 | Train Acc: 0.5892
 Site-SVHN                      (3) | Train Loss: 1.5594 | Train Acc: 0.4663
 Site-SVHN                      (5) | Train Loss: 1.4795 | Train Acc: 0.5085
Average Train Accuracy: 0.6938
 Site-MNIST                     (0) | Val  Loss: 0.6843 | Val  Acc: 0.8370
 Site-MNIST                     (0) | Val  Loss: 0.7237 | Val  Acc: 0.8525
 Site-USPS                      (6) | Val  Loss: 0.7678 | Val  Acc: 0.7717
 Site-USPS                      (2) | Val  Loss: 0.7566 | Val  Acc: 0.8129
 Site-SynthDigits               (4) | Val  Loss: 1.0415 | Val  Acc: 0.6304
 Site-SynthDigits               (4) | Val  Loss: 1.0514 | Val  Acc: 0.6223
 Site-MNIST_M                   (1) | Val  Loss: 1.4442 | Val  Acc: 0.5543
 Site-MNIST_M                   (1) | Val  Loss: 1.3432 | Val  Acc: 0.6367
 Site-SVHN                      (3) | Val  Loss: 1.5267 | Val  Acc: 0.4457
 Site-SVHN                      (5) | Val  Loss: 1.5389 | Val  Acc: 0.4820
Average Valid Accuracy: 0.6646
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8370
 Best site-MNIST                    (0)  | Epoch:5 | Val Acc: 0.8525
 Best site-USPS                     (6)  | Epoch:5 | Val Acc: 0.7717
 Best site-USPS                     (2)  | Epoch:5 | Val Acc: 0.8129
 Best site-SynthDigits              (4)  | Epoch:5 | Val Acc: 0.6304
 Best site-SynthDigits              (4)  | Epoch:5 | Val Acc: 0.6223
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.5543
 Best site-MNIST_M                  (1)  | Epoch:5 | Val Acc: 0.6367
 Best site-SVHN                     (3)  | Epoch:5 | Val Acc: 0.4457
 Best site-SVHN                     (5)  | Epoch:5 | Val Acc: 0.4820
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (0) | Train Loss: 0.5675 | Train Acc: 0.8841
 Site-MNIST                     (0) | Train Loss: 0.6616 | Train Acc: 0.8413
 Site-USPS                      (3) | Train Loss: 0.6159 | Train Acc: 0.8706
 Site-USPS                      (6) | Train Loss: 0.6349 | Train Acc: 0.8475
 Site-SynthDigits               (4) | Train Loss: 0.9797 | Train Acc: 0.7008
 Site-SynthDigits               (4) | Train Loss: 0.9008 | Train Acc: 0.7489
 Site-MNIST_M                   (5) | Train Loss: 1.2914 | Train Acc: 0.6388
 Site-MNIST_M                   (1) | Train Loss: 1.3172 | Train Acc: 0.6018
 Site-SVHN                      (2) | Train Loss: 1.4197 | Train Acc: 0.5364
 Site-SVHN                      (2) | Train Loss: 1.3341 | Train Acc: 0.5713
Average Train Accuracy: 0.7241
 Site-MNIST                     (0) | Val  Loss: 0.5973 | Val  Acc: 0.8370
 Site-MNIST                     (0) | Val  Loss: 0.6425 | Val  Acc: 0.8489
 Site-USPS                      (3) | Val  Loss: 0.7185 | Val  Acc: 0.7826
 Site-USPS                      (6) | Val  Loss: 0.6960 | Val  Acc: 0.8237
 Site-SynthDigits               (4) | Val  Loss: 0.9288 | Val  Acc: 0.6957
 Site-SynthDigits               (4) | Val  Loss: 0.9241 | Val  Acc: 0.6942
 Site-MNIST_M                   (5) | Val  Loss: 1.3766 | Val  Acc: 0.5326
 Site-MNIST_M                   (1) | Val  Loss: 1.2831 | Val  Acc: 0.6223
 Site-SVHN                      (2) | Val  Loss: 1.3637 | Val  Acc: 0.5326
 Site-SVHN                      (2) | Val  Loss: 1.3825 | Val  Acc: 0.5468
Average Valid Accuracy: 0.6916
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8370
 Best site-MNIST                    (0)  | Epoch:6 | Val Acc: 0.8489
 Best site-USPS                     (3)  | Epoch:6 | Val Acc: 0.7826
 Best site-USPS                     (6)  | Epoch:6 | Val Acc: 0.8237
 Best site-SynthDigits              (4)  | Epoch:6 | Val Acc: 0.6957
 Best site-SynthDigits              (4)  | Epoch:6 | Val Acc: 0.6942
 Best site-MNIST_M                  (5)  | Epoch:6 | Val Acc: 0.5326
 Best site-MNIST_M                  (1)  | Epoch:6 | Val Acc: 0.6223
 Best site-SVHN                     (2)  | Epoch:6 | Val Acc: 0.5326
 Best site-SVHN                     (2)  | Epoch:6 | Val Acc: 0.5468
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (4) | Train Loss: 0.5327 | Train Acc: 0.8814
 Site-MNIST                     (4) | Train Loss: 0.6166 | Train Acc: 0.8359
 Site-USPS                      (0) | Train Loss: 0.5717 | Train Acc: 0.8841
 Site-USPS                      (0) | Train Loss: 0.5969 | Train Acc: 0.8592
 Site-SynthDigits               (5) | Train Loss: 0.9315 | Train Acc: 0.7278
 Site-SynthDigits               (2) | Train Loss: 0.8394 | Train Acc: 0.7641
 Site-MNIST_M                   (1) | Train Loss: 1.1874 | Train Acc: 0.6604
 Site-MNIST_M                   (6) | Train Loss: 1.2140 | Train Acc: 0.6448
 Site-SVHN                      (3) | Train Loss: 1.3635 | Train Acc: 0.5526
 Site-SVHN                      (3) | Train Loss: 1.2926 | Train Acc: 0.5892
Average Train Accuracy: 0.7399
 Site-MNIST                     (4) | Val  Loss: 0.5422 | Val  Acc: 0.8261
 Site-MNIST                     (4) | Val  Loss: 0.6002 | Val  Acc: 0.8453
 Site-USPS                      (0) | Val  Loss: 0.6785 | Val  Acc: 0.7826
 Site-USPS                      (0) | Val  Loss: 0.6493 | Val  Acc: 0.8381
 Site-SynthDigits               (5) | Val  Loss: 0.8796 | Val  Acc: 0.6957
 Site-SynthDigits               (2) | Val  Loss: 0.8675 | Val  Acc: 0.7230
 Site-MNIST_M                   (1) | Val  Loss: 1.2693 | Val  Acc: 0.5761
 Site-MNIST_M                   (6) | Val  Loss: 1.1840 | Val  Acc: 0.6511
 Site-SVHN                      (3) | Val  Loss: 1.3091 | Val  Acc: 0.5217
 Site-SVHN                      (3) | Val  Loss: 1.3355 | Val  Acc: 0.5719
Average Valid Accuracy: 0.7032
 Best site-MNIST                    (4)  | Epoch:7 | Val Acc: 0.8261
 Best site-MNIST                    (4)  | Epoch:7 | Val Acc: 0.8453
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7826
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8381
 Best site-SynthDigits              (5)  | Epoch:7 | Val Acc: 0.6957
 Best site-SynthDigits              (2)  | Epoch:7 | Val Acc: 0.7230
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5761
 Best site-MNIST_M                  (6)  | Epoch:7 | Val Acc: 0.6511
 Best site-SVHN                     (3)  | Epoch:7 | Val Acc: 0.5217
 Best site-SVHN                     (3)  | Epoch:7 | Val Acc: 0.5719
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (0) | Train Loss: 0.4789 | Train Acc: 0.9003
 Site-MNIST                     (0) | Train Loss: 0.5694 | Train Acc: 0.8484
 Site-USPS                      (1) | Train Loss: 0.5453 | Train Acc: 0.8706
 Site-USPS                      (1) | Train Loss: 0.5634 | Train Acc: 0.8529
 Site-SynthDigits               (4) | Train Loss: 0.8423 | Train Acc: 0.7574
 Site-SynthDigits               (4) | Train Loss: 0.7618 | Train Acc: 0.7928
 Site-MNIST_M                   (5) | Train Loss: 1.1351 | Train Acc: 0.6496
 Site-MNIST_M                   (2) | Train Loss: 1.1489 | Train Acc: 0.6547
 Site-SVHN                      (6) | Train Loss: 1.3006 | Train Acc: 0.5660
 Site-SVHN                      (3) | Train Loss: 1.2401 | Train Acc: 0.5937
Average Train Accuracy: 0.7487
 Site-MNIST                     (0) | Val  Loss: 0.4882 | Val  Acc: 0.8370
 Site-MNIST                     (0) | Val  Loss: 0.5514 | Val  Acc: 0.8561
 Site-USPS                      (1) | Val  Loss: 0.6589 | Val  Acc: 0.7826
 Site-USPS                      (1) | Val  Loss: 0.6264 | Val  Acc: 0.8309
 Site-SynthDigits               (4) | Val  Loss: 0.7904 | Val  Acc: 0.7500
 Site-SynthDigits               (4) | Val  Loss: 0.7939 | Val  Acc: 0.7446
 Site-MNIST_M                   (5) | Val  Loss: 1.2133 | Val  Acc: 0.5761
 Site-MNIST_M                   (2) | Val  Loss: 1.1207 | Val  Acc: 0.6691
 Site-SVHN                      (6) | Val  Loss: 1.2828 | Val  Acc: 0.5652
 Site-SVHN                      (3) | Val  Loss: 1.2885 | Val  Acc: 0.5863
Average Valid Accuracy: 0.7198
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8370
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8561
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.7826
 Best site-USPS                     (1)  | Epoch:8 | Val Acc: 0.8309
 Best site-SynthDigits              (4)  | Epoch:8 | Val Acc: 0.7500
 Best site-SynthDigits              (4)  | Epoch:8 | Val Acc: 0.7446
 Best site-MNIST_M                  (5)  | Epoch:8 | Val Acc: 0.5761
 Best site-MNIST_M                  (2)  | Epoch:8 | Val Acc: 0.6691
 Best site-SVHN                     (6)  | Epoch:8 | Val Acc: 0.5652
 Best site-SVHN                     (3)  | Epoch:8 | Val Acc: 0.5863
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (5) | Train Loss: 0.4435 | Train Acc: 0.8949
 Site-MNIST                     (2) | Train Loss: 0.5322 | Train Acc: 0.8448
 Site-USPS                      (6) | Train Loss: 0.5210 | Train Acc: 0.8625
 Site-USPS                      (1) | Train Loss: 0.5380 | Train Acc: 0.8547
 Site-SynthDigits               (4) | Train Loss: 0.8080 | Train Acc: 0.7709
 Site-SynthDigits               (4) | Train Loss: 0.7300 | Train Acc: 0.7937
 Site-MNIST_M                   (0) | Train Loss: 1.0867 | Train Acc: 0.6577
 Site-MNIST_M                   (0) | Train Loss: 1.0982 | Train Acc: 0.6726
 Site-SVHN                      (3) | Train Loss: 1.2396 | Train Acc: 0.5849
 Site-SVHN                      (3) | Train Loss: 1.1770 | Train Acc: 0.6170
Average Train Accuracy: 0.7554
 Site-MNIST                     (5) | Val  Loss: 0.4533 | Val  Acc: 0.8370
 Site-MNIST                     (2) | Val  Loss: 0.5157 | Val  Acc: 0.8453
 Site-USPS                      (6) | Val  Loss: 0.6390 | Val  Acc: 0.7935
 Site-USPS                      (1) | Val  Loss: 0.5999 | Val  Acc: 0.8309
 Site-SynthDigits               (4) | Val  Loss: 0.7730 | Val  Acc: 0.7283
 Site-SynthDigits               (4) | Val  Loss: 0.7597 | Val  Acc: 0.7446
 Site-MNIST_M                   (0) | Val  Loss: 1.1637 | Val  Acc: 0.5870
 Site-MNIST_M                   (0) | Val  Loss: 1.0621 | Val  Acc: 0.6763
 Site-SVHN                      (3) | Val  Loss: 1.2114 | Val  Acc: 0.5978
 Site-SVHN                      (3) | Val  Loss: 1.2274 | Val  Acc: 0.6223
Average Valid Accuracy: 0.7263
 Best site-MNIST                    (5)  | Epoch:9 | Val Acc: 0.8370
 Best site-MNIST                    (2)  | Epoch:9 | Val Acc: 0.8453
 Best site-USPS                     (6)  | Epoch:9 | Val Acc: 0.7935
 Best site-USPS                     (1)  | Epoch:9 | Val Acc: 0.8309
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.7283
 Best site-SynthDigits              (4)  | Epoch:9 | Val Acc: 0.7446
 Best site-MNIST_M                  (0)  | Epoch:9 | Val Acc: 0.5870
 Best site-MNIST_M                  (0)  | Epoch:9 | Val Acc: 0.6763
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.5978
 Best site-SVHN                     (3)  | Epoch:9 | Val Acc: 0.6223
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (4) | Train Loss: 0.4268 | Train Acc: 0.8895
 Site-MNIST                     (4) | Train Loss: 0.5183 | Train Acc: 0.8448
 Site-USPS                      (3) | Train Loss: 0.5285 | Train Acc: 0.8544
 Site-USPS                      (3) | Train Loss: 0.5524 | Train Acc: 0.8520
 Site-SynthDigits               (2) | Train Loss: 0.7384 | Train Acc: 0.8005
 Site-SynthDigits               (2) | Train Loss: 0.6706 | Train Acc: 0.8063
 Site-MNIST_M                   (1) | Train Loss: 1.0262 | Train Acc: 0.6819
 Site-MNIST_M                   (5) | Train Loss: 1.0212 | Train Acc: 0.7112
 Site-SVHN                      (6) | Train Loss: 1.2339 | Train Acc: 0.5903
 Site-SVHN                      (0) | Train Loss: 1.1693 | Train Acc: 0.6188
Average Train Accuracy: 0.7650
 Site-MNIST                     (4) | Val  Loss: 0.4275 | Val  Acc: 0.8587
 Site-MNIST                     (4) | Val  Loss: 0.5057 | Val  Acc: 0.8525
 Site-USPS                      (3) | Val  Loss: 0.6434 | Val  Acc: 0.7826
 Site-USPS                      (3) | Val  Loss: 0.6090 | Val  Acc: 0.8273
 Site-SynthDigits               (2) | Val  Loss: 0.6851 | Val  Acc: 0.7500
 Site-SynthDigits               (2) | Val  Loss: 0.7035 | Val  Acc: 0.7590
 Site-MNIST_M                   (1) | Val  Loss: 1.0885 | Val  Acc: 0.6196
 Site-MNIST_M                   (5) | Val  Loss: 0.9988 | Val  Acc: 0.6978
 Site-SVHN                      (6) | Val  Loss: 1.1984 | Val  Acc: 0.5870
 Site-SVHN                      (0) | Val  Loss: 1.2055 | Val  Acc: 0.6043
Average Valid Accuracy: 0.7339
 Best site-MNIST                    (4)  | Epoch:10 | Val Acc: 0.8587
 Best site-MNIST                    (4)  | Epoch:10 | Val Acc: 0.8525
 Best site-USPS                     (3)  | Epoch:10 | Val Acc: 0.7826
 Best site-USPS                     (3)  | Epoch:10 | Val Acc: 0.8273
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.7500
 Best site-SynthDigits              (2)  | Epoch:10 | Val Acc: 0.7590
 Best site-MNIST_M                  (1)  | Epoch:10 | Val Acc: 0.6196
 Best site-MNIST_M                  (5)  | Epoch:10 | Val Acc: 0.6978
 Best site-SVHN                     (6)  | Epoch:10 | Val Acc: 0.5870
 Best site-SVHN                     (0)  | Epoch:10 | Val Acc: 0.6043
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (2) | Train Loss: 0.4036 | Train Acc: 0.8949
 Site-MNIST                     (2) | Train Loss: 0.4973 | Train Acc: 0.8493
 Site-USPS                      (4) | Train Loss: 0.4713 | Train Acc: 0.8544
 Site-USPS                      (6) | Train Loss: 0.5027 | Train Acc: 0.8682
 Site-SynthDigits               (0) | Train Loss: 0.7139 | Train Acc: 0.7978
 Site-SynthDigits               (0) | Train Loss: 0.6434 | Train Acc: 0.8135
 Site-MNIST_M                   (1) | Train Loss: 0.9980 | Train Acc: 0.6819
 Site-MNIST_M                   (5) | Train Loss: 0.9931 | Train Acc: 0.7067
 Site-SVHN                      (3) | Train Loss: 1.1715 | Train Acc: 0.5930
 Site-SVHN                      (3) | Train Loss: 1.0802 | Train Acc: 0.6538
Average Train Accuracy: 0.7714
 Site-MNIST                     (2) | Val  Loss: 0.4072 | Val  Acc: 0.8478
 Site-MNIST                     (2) | Val  Loss: 0.4801 | Val  Acc: 0.8633
 Site-USPS                      (4) | Val  Loss: 0.5945 | Val  Acc: 0.8043
 Site-USPS                      (6) | Val  Loss: 0.5548 | Val  Acc: 0.8345
 Site-SynthDigits               (0) | Val  Loss: 0.6761 | Val  Acc: 0.7500
 Site-SynthDigits               (0) | Val  Loss: 0.6740 | Val  Acc: 0.7518
 Site-MNIST_M                   (1) | Val  Loss: 1.0603 | Val  Acc: 0.6413
 Site-MNIST_M                   (5) | Val  Loss: 0.9687 | Val  Acc: 0.7122
 Site-SVHN                      (3) | Val  Loss: 1.1066 | Val  Acc: 0.6304
 Site-SVHN                      (3) | Val  Loss: 1.1314 | Val  Acc: 0.6511
Average Valid Accuracy: 0.7487
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8478
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8633
 Best site-USPS                     (4)  | Epoch:11 | Val Acc: 0.8043
 Best site-USPS                     (6)  | Epoch:11 | Val Acc: 0.8345
 Best site-SynthDigits              (0)  | Epoch:11 | Val Acc: 0.7500
 Best site-SynthDigits              (0)  | Epoch:11 | Val Acc: 0.7518
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.6413
 Best site-MNIST_M                  (5)  | Epoch:11 | Val Acc: 0.7122
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.6304
 Best site-SVHN                     (3)  | Epoch:11 | Val Acc: 0.6511
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 12 ============
cnt=[1, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (6) | Train Loss: 0.3781 | Train Acc: 0.8949
 Site-MNIST                     (0) | Train Loss: 0.4633 | Train Acc: 0.8547
 Site-USPS                      (4) | Train Loss: 0.4706 | Train Acc: 0.8571
 Site-USPS                      (4) | Train Loss: 0.4912 | Train Acc: 0.8592
 Site-SynthDigits               (1) | Train Loss: 0.6640 | Train Acc: 0.8140
 Site-SynthDigits               (1) | Train Loss: 0.5894 | Train Acc: 0.8233
 Site-MNIST_M                   (3) | Train Loss: 0.9587 | Train Acc: 0.6981
 Site-MNIST_M                   (5) | Train Loss: 0.9345 | Train Acc: 0.7300
 Site-SVHN                      (2) | Train Loss: 1.1274 | Train Acc: 0.6092
 Site-SVHN                      (2) | Train Loss: 1.0468 | Train Acc: 0.6565
Average Train Accuracy: 0.7797
 Site-MNIST                     (6) | Val  Loss: 0.3831 | Val  Acc: 0.8478
 Site-MNIST                     (0) | Val  Loss: 0.4575 | Val  Acc: 0.8597
 Site-USPS                      (4) | Val  Loss: 0.5902 | Val  Acc: 0.7935
 Site-USPS                      (4) | Val  Loss: 0.5501 | Val  Acc: 0.8417
 Site-SynthDigits               (1) | Val  Loss: 0.6249 | Val  Acc: 0.7826
 Site-SynthDigits               (1) | Val  Loss: 0.6304 | Val  Acc: 0.7842
 Site-MNIST_M                   (3) | Val  Loss: 1.0152 | Val  Acc: 0.6630
 Site-MNIST_M                   (5) | Val  Loss: 0.9196 | Val  Acc: 0.7230
 Site-SVHN                      (2) | Val  Loss: 1.0941 | Val  Acc: 0.5870
 Site-SVHN                      (2) | Val  Loss: 1.0989 | Val  Acc: 0.6511
Average Valid Accuracy: 0.7534
 Best site-MNIST                    (6)  | Epoch:12 | Val Acc: 0.8478
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8597
 Best site-USPS                     (4)  | Epoch:12 | Val Acc: 0.7935
 Best site-USPS                     (4)  | Epoch:12 | Val Acc: 0.8417
 Best site-SynthDigits              (1)  | Epoch:12 | Val Acc: 0.7826
 Best site-SynthDigits              (1)  | Epoch:12 | Val Acc: 0.7842
 Best site-MNIST_M                  (3)  | Epoch:12 | Val Acc: 0.6630
 Best site-MNIST_M                  (5)  | Epoch:12 | Val Acc: 0.7230
 Best site-SVHN                     (2)  | Epoch:12 | Val Acc: 0.5870
 Best site-SVHN                     (2)  | Epoch:12 | Val Acc: 0.6511
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (2) | Train Loss: 0.3534 | Train Acc: 0.9003
 Site-MNIST                     (2) | Train Loss: 0.4365 | Train Acc: 0.8691
 Site-USPS                      (4) | Train Loss: 0.4354 | Train Acc: 0.8679
 Site-USPS                      (4) | Train Loss: 0.4524 | Train Acc: 0.8673
 Site-SynthDigits               (3) | Train Loss: 0.6394 | Train Acc: 0.8302
 Site-SynthDigits               (3) | Train Loss: 0.5675 | Train Acc: 0.8350
 Site-MNIST_M                   (1) | Train Loss: 0.9126 | Train Acc: 0.7224
 Site-MNIST_M                   (5) | Train Loss: 0.9001 | Train Acc: 0.7390
 Site-SVHN                      (0) | Train Loss: 1.1144 | Train Acc: 0.6119
 Site-SVHN                      (6) | Train Loss: 1.0206 | Train Acc: 0.6673
Average Train Accuracy: 0.7910
 Site-MNIST                     (2) | Val  Loss: 0.3477 | Val  Acc: 0.8587
 Site-MNIST                     (2) | Val  Loss: 0.4285 | Val  Acc: 0.8741
 Site-USPS                      (4) | Val  Loss: 0.5639 | Val  Acc: 0.8152
 Site-USPS                      (4) | Val  Loss: 0.5169 | Val  Acc: 0.8417
 Site-SynthDigits               (3) | Val  Loss: 0.6073 | Val  Acc: 0.7826
 Site-SynthDigits               (3) | Val  Loss: 0.6063 | Val  Acc: 0.7914
 Site-MNIST_M                   (1) | Val  Loss: 0.9696 | Val  Acc: 0.6957
 Site-MNIST_M                   (5) | Val  Loss: 0.8771 | Val  Acc: 0.7374
 Site-SVHN                      (0) | Val  Loss: 1.0530 | Val  Acc: 0.6522
 Site-SVHN                      (6) | Val  Loss: 1.0741 | Val  Acc: 0.6691
Average Valid Accuracy: 0.7718
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8587
 Best site-MNIST                    (2)  | Epoch:13 | Val Acc: 0.8741
 Best site-USPS                     (4)  | Epoch:13 | Val Acc: 0.8152
 Best site-USPS                     (4)  | Epoch:13 | Val Acc: 0.8417
 Best site-SynthDigits              (3)  | Epoch:13 | Val Acc: 0.7826
 Best site-SynthDigits              (3)  | Epoch:13 | Val Acc: 0.7914
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.6957
 Best site-MNIST_M                  (5)  | Epoch:13 | Val Acc: 0.7374
 Best site-SVHN                     (0)  | Epoch:13 | Val Acc: 0.6522
 Best site-SVHN                     (6)  | Epoch:13 | Val Acc: 0.6691
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (2) | Train Loss: 0.3270 | Train Acc: 0.9030
 Site-MNIST                     (2) | Train Loss: 0.4073 | Train Acc: 0.8834
 Site-USPS                      (4) | Train Loss: 0.4324 | Train Acc: 0.8652
 Site-USPS                      (4) | Train Loss: 0.4482 | Train Acc: 0.8664
 Site-SynthDigits               (0) | Train Loss: 0.6082 | Train Acc: 0.8356
 Site-SynthDigits               (6) | Train Loss: 0.5416 | Train Acc: 0.8565
 Site-MNIST_M                   (5) | Train Loss: 0.8768 | Train Acc: 0.7358
 Site-MNIST_M                   (1) | Train Loss: 0.8586 | Train Acc: 0.7596
 Site-SVHN                      (3) | Train Loss: 1.0697 | Train Acc: 0.6361
 Site-SVHN                      (3) | Train Loss: 0.9889 | Train Acc: 0.6834
Average Train Accuracy: 0.8025
 Site-MNIST                     (2) | Val  Loss: 0.3244 | Val  Acc: 0.8804
 Site-MNIST                     (2) | Val  Loss: 0.4036 | Val  Acc: 0.8849
 Site-USPS                      (4) | Val  Loss: 0.5620 | Val  Acc: 0.8043
 Site-USPS                      (4) | Val  Loss: 0.5087 | Val  Acc: 0.8309
 Site-SynthDigits               (0) | Val  Loss: 0.5739 | Val  Acc: 0.8370
 Site-SynthDigits               (6) | Val  Loss: 0.5719 | Val  Acc: 0.8237
 Site-MNIST_M                   (5) | Val  Loss: 0.9203 | Val  Acc: 0.7065
 Site-MNIST_M                   (1) | Val  Loss: 0.8304 | Val  Acc: 0.7626
 Site-SVHN                      (3) | Val  Loss: 1.0315 | Val  Acc: 0.6848
 Site-SVHN                      (3) | Val  Loss: 1.0397 | Val  Acc: 0.6835
Average Valid Accuracy: 0.7899
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8804
 Best site-MNIST                    (2)  | Epoch:14 | Val Acc: 0.8849
 Best site-USPS                     (4)  | Epoch:14 | Val Acc: 0.8043
 Best site-USPS                     (4)  | Epoch:14 | Val Acc: 0.8309
 Best site-SynthDigits              (0)  | Epoch:14 | Val Acc: 0.8370
 Best site-SynthDigits              (6)  | Epoch:14 | Val Acc: 0.8237
 Best site-MNIST_M                  (5)  | Epoch:14 | Val Acc: 0.7065
 Best site-MNIST_M                  (1)  | Epoch:14 | Val Acc: 0.7626
 Best site-SVHN                     (3)  | Epoch:14 | Val Acc: 0.6848
 Best site-SVHN                     (3)  | Epoch:14 | Val Acc: 0.6835
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (2) | Train Loss: 0.3216 | Train Acc: 0.9057
 Site-MNIST                     (6) | Train Loss: 0.3976 | Train Acc: 0.8825
 Site-USPS                      (4) | Train Loss: 0.4326 | Train Acc: 0.8652
 Site-USPS                      (4) | Train Loss: 0.4429 | Train Acc: 0.8673
 Site-SynthDigits               (0) | Train Loss: 0.5822 | Train Acc: 0.8356
 Site-SynthDigits               (5) | Train Loss: 0.5257 | Train Acc: 0.8556
 Site-MNIST_M                   (1) | Train Loss: 0.8269 | Train Acc: 0.7466
 Site-MNIST_M                   (1) | Train Loss: 0.8072 | Train Acc: 0.7776
 Site-SVHN                      (3) | Train Loss: 1.0563 | Train Acc: 0.6361
 Site-SVHN                      (3) | Train Loss: 0.9879 | Train Acc: 0.6753
Average Train Accuracy: 0.8048
 Site-MNIST                     (2) | Val  Loss: 0.3154 | Val  Acc: 0.8696
 Site-MNIST                     (6) | Val  Loss: 0.3937 | Val  Acc: 0.8921
 Site-USPS                      (4) | Val  Loss: 0.5463 | Val  Acc: 0.8043
 Site-USPS                      (4) | Val  Loss: 0.5006 | Val  Acc: 0.8453
 Site-SynthDigits               (0) | Val  Loss: 0.5492 | Val  Acc: 0.8152
 Site-SynthDigits               (5) | Val  Loss: 0.5557 | Val  Acc: 0.8129
 Site-MNIST_M                   (1) | Val  Loss: 0.8818 | Val  Acc: 0.6957
 Site-MNIST_M                   (1) | Val  Loss: 0.7842 | Val  Acc: 0.7770
 Site-SVHN                      (3) | Val  Loss: 1.0426 | Val  Acc: 0.6630
 Site-SVHN                      (3) | Val  Loss: 1.0267 | Val  Acc: 0.6799
Average Valid Accuracy: 0.7855
============ Train epoch 16 ============
cnt=[1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (2) | Train Loss: 0.3074 | Train Acc: 0.9057
 Site-MNIST                     (2) | Train Loss: 0.3877 | Train Acc: 0.8870
 Site-USPS                      (3) | Train Loss: 0.4105 | Train Acc: 0.8706
 Site-USPS                      (3) | Train Loss: 0.4278 | Train Acc: 0.8771
 Site-SynthDigits               (5) | Train Loss: 0.5728 | Train Acc: 0.8356
 Site-SynthDigits               (4) | Train Loss: 0.5178 | Train Acc: 0.8628
 Site-MNIST_M                   (1) | Train Loss: 0.8195 | Train Acc: 0.7358
 Site-MNIST_M                   (1) | Train Loss: 0.7907 | Train Acc: 0.7839
 Site-SVHN                      (0) | Train Loss: 1.0159 | Train Acc: 0.6550
 Site-SVHN                      (6) | Train Loss: 0.9207 | Train Acc: 0.7103
Average Train Accuracy: 0.8124
 Site-MNIST                     (2) | Val  Loss: 0.2998 | Val  Acc: 0.8913
 Site-MNIST                     (2) | Val  Loss: 0.3806 | Val  Acc: 0.8849
 Site-USPS                      (3) | Val  Loss: 0.5342 | Val  Acc: 0.8043
 Site-USPS                      (3) | Val  Loss: 0.4772 | Val  Acc: 0.8381
 Site-SynthDigits               (5) | Val  Loss: 0.5482 | Val  Acc: 0.8370
 Site-SynthDigits               (4) | Val  Loss: 0.5413 | Val  Acc: 0.8273
 Site-MNIST_M                   (1) | Val  Loss: 0.8608 | Val  Acc: 0.7174
 Site-MNIST_M                   (1) | Val  Loss: 0.7714 | Val  Acc: 0.7698
 Site-SVHN                      (0) | Val  Loss: 0.9569 | Val  Acc: 0.7391
 Site-SVHN                      (6) | Val  Loss: 0.9699 | Val  Acc: 0.7194
Average Valid Accuracy: 0.8029
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.8913
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.8849
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8043
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8381
 Best site-SynthDigits              (5)  | Epoch:16 | Val Acc: 0.8370
 Best site-SynthDigits              (4)  | Epoch:16 | Val Acc: 0.8273
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7174
 Best site-MNIST_M                  (1)  | Epoch:16 | Val Acc: 0.7698
 Best site-SVHN                     (0)  | Epoch:16 | Val Acc: 0.7391
 Best site-SVHN                     (6)  | Epoch:16 | Val Acc: 0.7194
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (2) | Train Loss: 0.2903 | Train Acc: 0.9084
 Site-MNIST                     (2) | Train Loss: 0.3640 | Train Acc: 0.8933
 Site-USPS                      (0) | Train Loss: 0.3816 | Train Acc: 0.8733
 Site-USPS                      (0) | Train Loss: 0.3996 | Train Acc: 0.8843
 Site-SynthDigits               (4) | Train Loss: 0.5681 | Train Acc: 0.8356
 Site-SynthDigits               (4) | Train Loss: 0.5134 | Train Acc: 0.8610
 Site-MNIST_M                   (6) | Train Loss: 0.7848 | Train Acc: 0.7439
 Site-MNIST_M                   (1) | Train Loss: 0.7570 | Train Acc: 0.7848
 Site-SVHN                      (3) | Train Loss: 1.0018 | Train Acc: 0.6577
 Site-SVHN                      (5) | Train Loss: 0.8954 | Train Acc: 0.7103
Average Train Accuracy: 0.8153
 Site-MNIST                     (2) | Val  Loss: 0.2854 | Val  Acc: 0.9022
 Site-MNIST                     (2) | Val  Loss: 0.3654 | Val  Acc: 0.8993
 Site-USPS                      (0) | Val  Loss: 0.5147 | Val  Acc: 0.8043
 Site-USPS                      (0) | Val  Loss: 0.4563 | Val  Acc: 0.8489
 Site-SynthDigits               (4) | Val  Loss: 0.5461 | Val  Acc: 0.8370
 Site-SynthDigits               (4) | Val  Loss: 0.5367 | Val  Acc: 0.8165
 Site-MNIST_M                   (6) | Val  Loss: 0.8356 | Val  Acc: 0.7391
 Site-MNIST_M                   (1) | Val  Loss: 0.7506 | Val  Acc: 0.7770
 Site-SVHN                      (3) | Val  Loss: 0.9329 | Val  Acc: 0.7391
 Site-SVHN                      (5) | Val  Loss: 0.9461 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8079
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.9022
 Best site-MNIST                    (2)  | Epoch:17 | Val Acc: 0.8993
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8043
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8489
 Best site-SynthDigits              (4)  | Epoch:17 | Val Acc: 0.8370
 Best site-SynthDigits              (4)  | Epoch:17 | Val Acc: 0.8165
 Best site-MNIST_M                  (6)  | Epoch:17 | Val Acc: 0.7391
 Best site-MNIST_M                  (1)  | Epoch:17 | Val Acc: 0.7770
 Best site-SVHN                     (3)  | Epoch:17 | Val Acc: 0.7391
 Best site-SVHN                     (5)  | Epoch:17 | Val Acc: 0.7158
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (1) | Train Loss: 0.2878 | Train Acc: 0.9084
 Site-MNIST                     (6) | Train Loss: 0.3576 | Train Acc: 0.8924
 Site-USPS                      (3) | Train Loss: 0.3881 | Train Acc: 0.8760
 Site-USPS                      (3) | Train Loss: 0.3900 | Train Acc: 0.8870
 Site-SynthDigits               (4) | Train Loss: 0.5367 | Train Acc: 0.8518
 Site-SynthDigits               (4) | Train Loss: 0.4819 | Train Acc: 0.8744
 Site-MNIST_M                   (2) | Train Loss: 0.7601 | Train Acc: 0.7601
 Site-MNIST_M                   (5) | Train Loss: 0.7206 | Train Acc: 0.8054
 Site-SVHN                      (0) | Train Loss: 0.9769 | Train Acc: 0.6631
 Site-SVHN                      (0) | Train Loss: 0.8902 | Train Acc: 0.7148
Average Train Accuracy: 0.8233
 Site-MNIST                     (1) | Val  Loss: 0.2769 | Val  Acc: 0.9022
 Site-MNIST                     (6) | Val  Loss: 0.3589 | Val  Acc: 0.9029
 Site-USPS                      (3) | Val  Loss: 0.5067 | Val  Acc: 0.8043
 Site-USPS                      (3) | Val  Loss: 0.4505 | Val  Acc: 0.8381
 Site-SynthDigits               (4) | Val  Loss: 0.5076 | Val  Acc: 0.8261
 Site-SynthDigits               (4) | Val  Loss: 0.5016 | Val  Acc: 0.8417
 Site-MNIST_M                   (2) | Val  Loss: 0.7968 | Val  Acc: 0.7609
 Site-MNIST_M                   (5) | Val  Loss: 0.7184 | Val  Acc: 0.7842
 Site-SVHN                      (0) | Val  Loss: 0.9275 | Val  Acc: 0.7391
 Site-SVHN                      (0) | Val  Loss: 0.9305 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8115
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9022
 Best site-MNIST                    (6)  | Epoch:18 | Val Acc: 0.9029
 Best site-USPS                     (3)  | Epoch:18 | Val Acc: 0.8043
 Best site-USPS                     (3)  | Epoch:18 | Val Acc: 0.8381
 Best site-SynthDigits              (4)  | Epoch:18 | Val Acc: 0.8261
 Best site-SynthDigits              (4)  | Epoch:18 | Val Acc: 0.8417
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7609
 Best site-MNIST_M                  (5)  | Epoch:18 | Val Acc: 0.7842
 Best site-SVHN                     (0)  | Epoch:18 | Val Acc: 0.7391
 Best site-SVHN                     (0)  | Epoch:18 | Val Acc: 0.7158
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (0) | Train Loss: 0.2756 | Train Acc: 0.9111
 Site-MNIST                     (0) | Train Loss: 0.3520 | Train Acc: 0.8906
 Site-USPS                      (4) | Train Loss: 0.3742 | Train Acc: 0.8706
 Site-USPS                      (4) | Train Loss: 0.3899 | Train Acc: 0.8825
 Site-SynthDigits               (1) | Train Loss: 0.5297 | Train Acc: 0.8491
 Site-SynthDigits               (1) | Train Loss: 0.4816 | Train Acc: 0.8691
 Site-MNIST_M                   (2) | Train Loss: 0.7405 | Train Acc: 0.7628
 Site-MNIST_M                   (5) | Train Loss: 0.7137 | Train Acc: 0.8018
 Site-SVHN                      (6) | Train Loss: 0.9798 | Train Acc: 0.6792
 Site-SVHN                      (3) | Train Loss: 0.8862 | Train Acc: 0.7094
Average Train Accuracy: 0.8226
 Site-MNIST                     (0) | Val  Loss: 0.2763 | Val  Acc: 0.8913
 Site-MNIST                     (0) | Val  Loss: 0.3554 | Val  Acc: 0.8921
 Site-USPS                      (4) | Val  Loss: 0.4983 | Val  Acc: 0.7935
 Site-USPS                      (4) | Val  Loss: 0.4444 | Val  Acc: 0.8453
 Site-SynthDigits               (1) | Val  Loss: 0.4999 | Val  Acc: 0.8261
 Site-SynthDigits               (1) | Val  Loss: 0.5015 | Val  Acc: 0.8309
 Site-MNIST_M                   (2) | Val  Loss: 0.7798 | Val  Acc: 0.7391
 Site-MNIST_M                   (5) | Val  Loss: 0.6956 | Val  Acc: 0.8022
 Site-SVHN                      (6) | Val  Loss: 0.9113 | Val  Acc: 0.7391
 Site-SVHN                      (3) | Val  Loss: 0.9250 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8075
============ Train epoch 20 ============
cnt=[1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (2) | Train Loss: 0.2680 | Train Acc: 0.9137
 Site-MNIST                     (2) | Train Loss: 0.3451 | Train Acc: 0.8888
 Site-USPS                      (5) | Train Loss: 0.3688 | Train Acc: 0.8841
 Site-USPS                      (1) | Train Loss: 0.3694 | Train Acc: 0.8897
 Site-SynthDigits               (4) | Train Loss: 0.5221 | Train Acc: 0.8491
 Site-SynthDigits               (4) | Train Loss: 0.4723 | Train Acc: 0.8646
 Site-MNIST_M                   (6) | Train Loss: 0.7230 | Train Acc: 0.7628
 Site-MNIST_M                   (0) | Train Loss: 0.6920 | Train Acc: 0.8072
 Site-SVHN                      (3) | Train Loss: 0.9493 | Train Acc: 0.6685
 Site-SVHN                      (3) | Train Loss: 0.8435 | Train Acc: 0.7309
Average Train Accuracy: 0.8259
 Site-MNIST                     (2) | Val  Loss: 0.2684 | Val  Acc: 0.9022
 Site-MNIST                     (2) | Val  Loss: 0.3463 | Val  Acc: 0.8921
 Site-USPS                      (5) | Val  Loss: 0.4804 | Val  Acc: 0.8152
 Site-USPS                      (1) | Val  Loss: 0.4284 | Val  Acc: 0.8561
 Site-SynthDigits               (4) | Val  Loss: 0.4998 | Val  Acc: 0.8370
 Site-SynthDigits               (4) | Val  Loss: 0.4877 | Val  Acc: 0.8417
 Site-MNIST_M                   (6) | Val  Loss: 0.7724 | Val  Acc: 0.7500
 Site-MNIST_M                   (0) | Val  Loss: 0.6856 | Val  Acc: 0.8022
 Site-SVHN                      (3) | Val  Loss: 0.8707 | Val  Acc: 0.7391
 Site-SVHN                      (3) | Val  Loss: 0.8957 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8151
 Best site-MNIST                    (2)  | Epoch:20 | Val Acc: 0.9022
 Best site-MNIST                    (2)  | Epoch:20 | Val Acc: 0.8921
 Best site-USPS                     (5)  | Epoch:20 | Val Acc: 0.8152
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.8561
 Best site-SynthDigits              (4)  | Epoch:20 | Val Acc: 0.8370
 Best site-SynthDigits              (4)  | Epoch:20 | Val Acc: 0.8417
 Best site-MNIST_M                  (6)  | Epoch:20 | Val Acc: 0.7500
 Best site-MNIST_M                  (0)  | Epoch:20 | Val Acc: 0.8022
 Best site-SVHN                     (3)  | Epoch:20 | Val Acc: 0.7391
 Best site-SVHN                     (3)  | Epoch:20 | Val Acc: 0.7158
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 21 ============
cnt=[1, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (2) | Train Loss: 0.2624 | Train Acc: 0.9218
 Site-MNIST                     (2) | Train Loss: 0.3279 | Train Acc: 0.8996
 Site-USPS                      (0) | Train Loss: 0.3669 | Train Acc: 0.8760
 Site-USPS                      (6) | Train Loss: 0.3817 | Train Acc: 0.8888
 Site-SynthDigits               (4) | Train Loss: 0.4939 | Train Acc: 0.8598
 Site-SynthDigits               (4) | Train Loss: 0.4529 | Train Acc: 0.8807
 Site-MNIST_M                   (1) | Train Loss: 0.7138 | Train Acc: 0.7655
 Site-MNIST_M                   (1) | Train Loss: 0.6669 | Train Acc: 0.8108
 Site-SVHN                      (3) | Train Loss: 0.9410 | Train Acc: 0.6765
 Site-SVHN                      (5) | Train Loss: 0.8382 | Train Acc: 0.7283
Average Train Accuracy: 0.8308
 Site-MNIST                     (2) | Val  Loss: 0.2537 | Val  Acc: 0.9130
 Site-MNIST                     (2) | Val  Loss: 0.3370 | Val  Acc: 0.9065
 Site-USPS                      (0) | Val  Loss: 0.4870 | Val  Acc: 0.8152
 Site-USPS                      (6) | Val  Loss: 0.4321 | Val  Acc: 0.8597
 Site-SynthDigits               (4) | Val  Loss: 0.4708 | Val  Acc: 0.8478
 Site-SynthDigits               (4) | Val  Loss: 0.4663 | Val  Acc: 0.8525
 Site-MNIST_M                   (1) | Val  Loss: 0.7443 | Val  Acc: 0.7717
 Site-MNIST_M                   (1) | Val  Loss: 0.6601 | Val  Acc: 0.8022
 Site-SVHN                      (3) | Val  Loss: 0.8715 | Val  Acc: 0.7500
 Site-SVHN                      (5) | Val  Loss: 0.8831 | Val  Acc: 0.7158
Average Valid Accuracy: 0.8235
 Best site-MNIST                    (2)  | Epoch:21 | Val Acc: 0.9130
 Best site-MNIST                    (2)  | Epoch:21 | Val Acc: 0.9065
 Best site-USPS                     (0)  | Epoch:21 | Val Acc: 0.8152
 Best site-USPS                     (6)  | Epoch:21 | Val Acc: 0.8597
 Best site-SynthDigits              (4)  | Epoch:21 | Val Acc: 0.8478
 Best site-SynthDigits              (4)  | Epoch:21 | Val Acc: 0.8525
 Best site-MNIST_M                  (1)  | Epoch:21 | Val Acc: 0.7717
 Best site-MNIST_M                  (1)  | Epoch:21 | Val Acc: 0.8022
 Best site-SVHN                     (3)  | Epoch:21 | Val Acc: 0.7500
 Best site-SVHN                     (5)  | Epoch:21 | Val Acc: 0.7158
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (6) | Train Loss: 0.2605 | Train Acc: 0.9164
 Site-MNIST                     (2) | Train Loss: 0.3248 | Train Acc: 0.8996
 Site-USPS                      (4) | Train Loss: 0.3571 | Train Acc: 0.8841
 Site-USPS                      (5) | Train Loss: 0.3595 | Train Acc: 0.8897
 Site-SynthDigits               (1) | Train Loss: 0.4804 | Train Acc: 0.8625
 Site-SynthDigits               (1) | Train Loss: 0.4305 | Train Acc: 0.8834
 Site-MNIST_M                   (0) | Train Loss: 0.6889 | Train Acc: 0.7790
 Site-MNIST_M                   (0) | Train Loss: 0.6511 | Train Acc: 0.8197
 Site-SVHN                      (3) | Train Loss: 0.9435 | Train Acc: 0.6765
 Site-SVHN                      (3) | Train Loss: 0.8551 | Train Acc: 0.7211
Average Train Accuracy: 0.8332
 Site-MNIST                     (6) | Val  Loss: 0.2504 | Val  Acc: 0.9239
 Site-MNIST                     (2) | Val  Loss: 0.3299 | Val  Acc: 0.9137
 Site-USPS                      (4) | Val  Loss: 0.4630 | Val  Acc: 0.8043
 Site-USPS                      (5) | Val  Loss: 0.4129 | Val  Acc: 0.8525
 Site-SynthDigits               (1) | Val  Loss: 0.4482 | Val  Acc: 0.8261
 Site-SynthDigits               (1) | Val  Loss: 0.4529 | Val  Acc: 0.8453
 Site-MNIST_M                   (0) | Val  Loss: 0.7169 | Val  Acc: 0.7717
 Site-MNIST_M                   (0) | Val  Loss: 0.6394 | Val  Acc: 0.8201
 Site-SVHN                      (3) | Val  Loss: 0.8678 | Val  Acc: 0.7391
 Site-SVHN                      (3) | Val  Loss: 0.8896 | Val  Acc: 0.7230
Average Valid Accuracy: 0.8220
============ Train epoch 23 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (0) | Train Loss: 0.2436 | Train Acc: 0.9272
 Site-MNIST                     (0) | Train Loss: 0.3091 | Train Acc: 0.9094
 Site-USPS                      (3) | Train Loss: 0.3429 | Train Acc: 0.8895
 Site-USPS                      (3) | Train Loss: 0.3439 | Train Acc: 0.8951
 Site-SynthDigits               (4) | Train Loss: 0.4897 | Train Acc: 0.8652
 Site-SynthDigits               (4) | Train Loss: 0.4377 | Train Acc: 0.8816
 Site-MNIST_M                   (2) | Train Loss: 0.7034 | Train Acc: 0.7655
 Site-MNIST_M                   (5) | Train Loss: 0.6681 | Train Acc: 0.8081
 Site-SVHN                      (1) | Train Loss: 0.9192 | Train Acc: 0.6927
 Site-SVHN                      (6) | Train Loss: 0.7948 | Train Acc: 0.7462
Average Train Accuracy: 0.8381
 Site-MNIST                     (0) | Val  Loss: 0.2315 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.3172 | Val  Acc: 0.9317
 Site-USPS                      (3) | Val  Loss: 0.4526 | Val  Acc: 0.8152
 Site-USPS                      (3) | Val  Loss: 0.3977 | Val  Acc: 0.8597
 Site-SynthDigits               (4) | Val  Loss: 0.4591 | Val  Acc: 0.8478
 Site-SynthDigits               (4) | Val  Loss: 0.4496 | Val  Acc: 0.8489
 Site-MNIST_M                   (2) | Val  Loss: 0.7295 | Val  Acc: 0.7609
 Site-MNIST_M                   (5) | Val  Loss: 0.6557 | Val  Acc: 0.8129
 Site-SVHN                      (1) | Val  Loss: 0.8229 | Val  Acc: 0.7283
 Site-SVHN                      (6) | Val  Loss: 0.8496 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8270
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9348
 Best site-MNIST                    (0)  | Epoch:23 | Val Acc: 0.9317
 Best site-USPS                     (3)  | Epoch:23 | Val Acc: 0.8152
 Best site-USPS                     (3)  | Epoch:23 | Val Acc: 0.8597
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8478
 Best site-SynthDigits              (4)  | Epoch:23 | Val Acc: 0.8489
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.7609
 Best site-MNIST_M                  (5)  | Epoch:23 | Val Acc: 0.8129
 Best site-SVHN                     (1)  | Epoch:23 | Val Acc: 0.7283
 Best site-SVHN                     (6)  | Epoch:23 | Val Acc: 0.7302
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (1) | Train Loss: 0.2439 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.3112 | Train Acc: 0.9067
 Site-USPS                      (4) | Train Loss: 0.3327 | Train Acc: 0.9030
 Site-USPS                      (4) | Train Loss: 0.3351 | Train Acc: 0.9004
 Site-SynthDigits               (3) | Train Loss: 0.4614 | Train Acc: 0.8733
 Site-SynthDigits               (3) | Train Loss: 0.4151 | Train Acc: 0.8906
 Site-MNIST_M                   (2) | Train Loss: 0.6777 | Train Acc: 0.7682
 Site-MNIST_M                   (5) | Train Loss: 0.6317 | Train Acc: 0.8188
 Site-SVHN                      (6) | Train Loss: 0.9239 | Train Acc: 0.6927
 Site-SVHN                      (0) | Train Loss: 0.7985 | Train Acc: 0.7381
Average Train Accuracy: 0.8414
 Site-MNIST                     (1) | Val  Loss: 0.2298 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.3104 | Val  Acc: 0.9317
 Site-USPS                      (4) | Val  Loss: 0.4371 | Val  Acc: 0.8370
 Site-USPS                      (4) | Val  Loss: 0.3862 | Val  Acc: 0.8633
 Site-SynthDigits               (3) | Val  Loss: 0.4341 | Val  Acc: 0.8478
 Site-SynthDigits               (3) | Val  Loss: 0.4256 | Val  Acc: 0.8561
 Site-MNIST_M                   (2) | Val  Loss: 0.6986 | Val  Acc: 0.7717
 Site-MNIST_M                   (5) | Val  Loss: 0.6269 | Val  Acc: 0.8165
 Site-SVHN                      (6) | Val  Loss: 0.8379 | Val  Acc: 0.7174
 Site-SVHN                      (0) | Val  Loss: 0.8530 | Val  Acc: 0.7266
Average Valid Accuracy: 0.8292
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9239
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9317
 Best site-USPS                     (4)  | Epoch:24 | Val Acc: 0.8370
 Best site-USPS                     (4)  | Epoch:24 | Val Acc: 0.8633
 Best site-SynthDigits              (3)  | Epoch:24 | Val Acc: 0.8478
 Best site-SynthDigits              (3)  | Epoch:24 | Val Acc: 0.8561
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7717
 Best site-MNIST_M                  (5)  | Epoch:24 | Val Acc: 0.8165
 Best site-SVHN                     (6)  | Epoch:24 | Val Acc: 0.7174
 Best site-SVHN                     (0)  | Epoch:24 | Val Acc: 0.7266
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (2) | Train Loss: 0.2341 | Train Acc: 0.9272
 Site-MNIST                     (2) | Train Loss: 0.2991 | Train Acc: 0.9103
 Site-USPS                      (3) | Train Loss: 0.3324 | Train Acc: 0.8841
 Site-USPS                      (3) | Train Loss: 0.3352 | Train Acc: 0.9004
 Site-SynthDigits               (5) | Train Loss: 0.4587 | Train Acc: 0.8706
 Site-SynthDigits               (4) | Train Loss: 0.4149 | Train Acc: 0.8888
 Site-MNIST_M                   (6) | Train Loss: 0.6679 | Train Acc: 0.7736
 Site-MNIST_M                   (1) | Train Loss: 0.6292 | Train Acc: 0.8179
 Site-SVHN                      (0) | Train Loss: 0.9025 | Train Acc: 0.6954
 Site-SVHN                      (0) | Train Loss: 0.7764 | Train Acc: 0.7543
Average Train Accuracy: 0.8423
 Site-MNIST                     (2) | Val  Loss: 0.2243 | Val  Acc: 0.9239
 Site-MNIST                     (2) | Val  Loss: 0.3018 | Val  Acc: 0.9173
 Site-USPS                      (3) | Val  Loss: 0.4381 | Val  Acc: 0.8370
 Site-USPS                      (3) | Val  Loss: 0.3829 | Val  Acc: 0.8633
 Site-SynthDigits               (5) | Val  Loss: 0.4363 | Val  Acc: 0.8478
 Site-SynthDigits               (4) | Val  Loss: 0.4291 | Val  Acc: 0.8525
 Site-MNIST_M                   (6) | Val  Loss: 0.6939 | Val  Acc: 0.7935
 Site-MNIST_M                   (1) | Val  Loss: 0.6172 | Val  Acc: 0.8094
 Site-SVHN                      (0) | Val  Loss: 0.8190 | Val  Acc: 0.7609
 Site-SVHN                      (0) | Val  Loss: 0.8358 | Val  Acc: 0.7374
Average Valid Accuracy: 0.8343
 Best site-MNIST                    (2)  | Epoch:25 | Val Acc: 0.9239
 Best site-MNIST                    (2)  | Epoch:25 | Val Acc: 0.9173
 Best site-USPS                     (3)  | Epoch:25 | Val Acc: 0.8370
 Best site-USPS                     (3)  | Epoch:25 | Val Acc: 0.8633
 Best site-SynthDigits              (5)  | Epoch:25 | Val Acc: 0.8478
 Best site-SynthDigits              (4)  | Epoch:25 | Val Acc: 0.8525
 Best site-MNIST_M                  (6)  | Epoch:25 | Val Acc: 0.7935
 Best site-MNIST_M                  (1)  | Epoch:25 | Val Acc: 0.8094
 Best site-SVHN                     (0)  | Epoch:25 | Val Acc: 0.7609
 Best site-SVHN                     (0)  | Epoch:25 | Val Acc: 0.7374
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 26 ============
cnt=[1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (3) | Train Loss: 0.2351 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2998 | Train Acc: 0.9121
 Site-USPS                      (5) | Train Loss: 0.3135 | Train Acc: 0.9084
 Site-USPS                      (0) | Train Loss: 0.3168 | Train Acc: 0.9049
 Site-SynthDigits               (6) | Train Loss: 0.4630 | Train Acc: 0.8679
 Site-SynthDigits               (4) | Train Loss: 0.4146 | Train Acc: 0.8888
 Site-MNIST_M                   (1) | Train Loss: 0.6613 | Train Acc: 0.7736
 Site-MNIST_M                   (1) | Train Loss: 0.6124 | Train Acc: 0.8242
 Site-SVHN                      (2) | Train Loss: 0.9042 | Train Acc: 0.6819
 Site-SVHN                      (2) | Train Loss: 0.7793 | Train Acc: 0.7561
Average Train Accuracy: 0.8451
 Site-MNIST                     (3) | Val  Loss: 0.2239 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.3019 | Val  Acc: 0.9245
 Site-USPS                      (5) | Val  Loss: 0.4260 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.3652 | Val  Acc: 0.8705
 Site-SynthDigits               (6) | Val  Loss: 0.4286 | Val  Acc: 0.8478
 Site-SynthDigits               (4) | Val  Loss: 0.4236 | Val  Acc: 0.8633
 Site-MNIST_M                   (1) | Val  Loss: 0.6693 | Val  Acc: 0.8043
 Site-MNIST_M                   (1) | Val  Loss: 0.6040 | Val  Acc: 0.8094
 Site-SVHN                      (2) | Val  Loss: 0.8036 | Val  Acc: 0.7609
 Site-SVHN                      (2) | Val  Loss: 0.8270 | Val  Acc: 0.7338
Average Valid Accuracy: 0.8386
 Best site-MNIST                    (3)  | Epoch:26 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:26 | Val Acc: 0.9245
 Best site-USPS                     (5)  | Epoch:26 | Val Acc: 0.8261
 Best site-USPS                     (0)  | Epoch:26 | Val Acc: 0.8705
 Best site-SynthDigits              (6)  | Epoch:26 | Val Acc: 0.8478
 Best site-SynthDigits              (4)  | Epoch:26 | Val Acc: 0.8633
 Best site-MNIST_M                  (1)  | Epoch:26 | Val Acc: 0.8043
 Best site-MNIST_M                  (1)  | Epoch:26 | Val Acc: 0.8094
 Best site-SVHN                     (2)  | Epoch:26 | Val Acc: 0.7609
 Best site-SVHN                     (2)  | Epoch:26 | Val Acc: 0.7338
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (1) | Train Loss: 0.2410 | Train Acc: 0.9353
 Site-MNIST                     (1) | Train Loss: 0.2933 | Train Acc: 0.9121
 Site-USPS                      (4) | Train Loss: 0.3167 | Train Acc: 0.8976
 Site-USPS                      (4) | Train Loss: 0.3164 | Train Acc: 0.9076
 Site-SynthDigits               (5) | Train Loss: 0.4430 | Train Acc: 0.8652
 Site-SynthDigits               (0) | Train Loss: 0.3994 | Train Acc: 0.8933
 Site-MNIST_M                   (2) | Train Loss: 0.6516 | Train Acc: 0.7844
 Site-MNIST_M                   (6) | Train Loss: 0.6017 | Train Acc: 0.8359
 Site-SVHN                      (3) | Train Loss: 0.8966 | Train Acc: 0.7035
 Site-SVHN                      (3) | Train Loss: 0.7521 | Train Acc: 0.7704
Average Train Accuracy: 0.8505
 Site-MNIST                     (1) | Val  Loss: 0.2215 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.3021 | Val  Acc: 0.9317
 Site-USPS                      (4) | Val  Loss: 0.4212 | Val  Acc: 0.8370
 Site-USPS                      (4) | Val  Loss: 0.3650 | Val  Acc: 0.8705
 Site-SynthDigits               (5) | Val  Loss: 0.4205 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.4061 | Val  Acc: 0.8633
 Site-MNIST_M                   (2) | Val  Loss: 0.6763 | Val  Acc: 0.8043
 Site-MNIST_M                   (6) | Val  Loss: 0.6017 | Val  Acc: 0.8094
 Site-SVHN                      (3) | Val  Loss: 0.7836 | Val  Acc: 0.7935
 Site-SVHN                      (3) | Val  Loss: 0.8077 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8484
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9317
 Best site-USPS                     (4)  | Epoch:27 | Val Acc: 0.8370
 Best site-USPS                     (4)  | Epoch:27 | Val Acc: 0.8705
 Best site-SynthDigits              (5)  | Epoch:27 | Val Acc: 0.8696
 Best site-SynthDigits              (0)  | Epoch:27 | Val Acc: 0.8633
 Best site-MNIST_M                  (2)  | Epoch:27 | Val Acc: 0.8043
 Best site-MNIST_M                  (6)  | Epoch:27 | Val Acc: 0.8094
 Best site-SVHN                     (3)  | Epoch:27 | Val Acc: 0.7935
 Best site-SVHN                     (3)  | Epoch:27 | Val Acc: 0.7590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 28 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.2374 | Train Acc: 0.9245
 Site-MNIST                     (1) | Train Loss: 0.2978 | Train Acc: 0.9103
 Site-USPS                      (2) | Train Loss: 0.3160 | Train Acc: 0.8949
 Site-USPS                      (6) | Train Loss: 0.3180 | Train Acc: 0.9067
 Site-SynthDigits               (4) | Train Loss: 0.4198 | Train Acc: 0.8760
 Site-SynthDigits               (4) | Train Loss: 0.3776 | Train Acc: 0.8996
 Site-MNIST_M                   (3) | Train Loss: 0.6370 | Train Acc: 0.7925
 Site-MNIST_M                   (3) | Train Loss: 0.5835 | Train Acc: 0.8413
 Site-SVHN                      (5) | Train Loss: 0.8804 | Train Acc: 0.7089
 Site-SVHN                      (0) | Train Loss: 0.7553 | Train Acc: 0.7650
Average Train Accuracy: 0.8520
 Site-MNIST                     (1) | Val  Loss: 0.2220 | Val  Acc: 0.9239
 Site-MNIST                     (1) | Val  Loss: 0.3076 | Val  Acc: 0.9173
 Site-USPS                      (2) | Val  Loss: 0.4266 | Val  Acc: 0.8478
 Site-USPS                      (6) | Val  Loss: 0.3729 | Val  Acc: 0.8741
 Site-SynthDigits               (4) | Val  Loss: 0.3923 | Val  Acc: 0.8696
 Site-SynthDigits               (4) | Val  Loss: 0.3917 | Val  Acc: 0.8705
 Site-MNIST_M                   (3) | Val  Loss: 0.6553 | Val  Acc: 0.8152
 Site-MNIST_M                   (3) | Val  Loss: 0.5909 | Val  Acc: 0.8201
 Site-SVHN                      (5) | Val  Loss: 0.7924 | Val  Acc: 0.7935
 Site-SVHN                      (0) | Val  Loss: 0.8000 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8487
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9239
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9173
 Best site-USPS                     (2)  | Epoch:28 | Val Acc: 0.8478
 Best site-USPS                     (6)  | Epoch:28 | Val Acc: 0.8741
 Best site-SynthDigits              (4)  | Epoch:28 | Val Acc: 0.8696
 Best site-SynthDigits              (4)  | Epoch:28 | Val Acc: 0.8705
 Best site-MNIST_M                  (3)  | Epoch:28 | Val Acc: 0.8152
 Best site-MNIST_M                  (3)  | Epoch:28 | Val Acc: 0.8201
 Best site-SVHN                     (5)  | Epoch:28 | Val Acc: 0.7935
 Best site-SVHN                     (0)  | Epoch:28 | Val Acc: 0.7554
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 29 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (1) | Train Loss: 0.2330 | Train Acc: 0.9380
 Site-MNIST                     (1) | Train Loss: 0.2912 | Train Acc: 0.9103
 Site-USPS                      (4) | Train Loss: 0.3112 | Train Acc: 0.8868
 Site-USPS                      (4) | Train Loss: 0.3006 | Train Acc: 0.9031
 Site-SynthDigits               (3) | Train Loss: 0.4338 | Train Acc: 0.8625
 Site-SynthDigits               (3) | Train Loss: 0.3855 | Train Acc: 0.8951
 Site-MNIST_M                   (6) | Train Loss: 0.6260 | Train Acc: 0.7978
 Site-MNIST_M                   (2) | Train Loss: 0.5773 | Train Acc: 0.8287
 Site-SVHN                      (5) | Train Loss: 0.8693 | Train Acc: 0.7143
 Site-SVHN                      (0) | Train Loss: 0.7478 | Train Acc: 0.7704
Average Train Accuracy: 0.8507
 Site-MNIST                     (1) | Val  Loss: 0.2246 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.3029 | Val  Acc: 0.9173
 Site-USPS                      (4) | Val  Loss: 0.4080 | Val  Acc: 0.8478
 Site-USPS                      (4) | Val  Loss: 0.3522 | Val  Acc: 0.8705
 Site-SynthDigits               (3) | Val  Loss: 0.4114 | Val  Acc: 0.8587
 Site-SynthDigits               (3) | Val  Loss: 0.3967 | Val  Acc: 0.8633
 Site-MNIST_M                   (6) | Val  Loss: 0.6451 | Val  Acc: 0.8152
 Site-MNIST_M                   (2) | Val  Loss: 0.5735 | Val  Acc: 0.8273
 Site-SVHN                      (5) | Val  Loss: 0.7721 | Val  Acc: 0.7717
 Site-SVHN                      (0) | Val  Loss: 0.7932 | Val  Acc: 0.7662
Average Valid Accuracy: 0.8473
============ Train epoch 30 ============
cnt=[2, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.2335 | Train Acc: 0.9353
 Site-MNIST                     (1) | Train Loss: 0.2868 | Train Acc: 0.9148
 Site-USPS                      (3) | Train Loss: 0.2978 | Train Acc: 0.8976
 Site-USPS                      (6) | Train Loss: 0.3004 | Train Acc: 0.9076
 Site-SynthDigits               (4) | Train Loss: 0.4344 | Train Acc: 0.8598
 Site-SynthDigits               (4) | Train Loss: 0.3813 | Train Acc: 0.9013
 Site-MNIST_M                   (2) | Train Loss: 0.6289 | Train Acc: 0.7898
 Site-MNIST_M                   (5) | Train Loss: 0.5876 | Train Acc: 0.8341
 Site-SVHN                      (0) | Train Loss: 0.8667 | Train Acc: 0.7062
 Site-SVHN                      (0) | Train Loss: 0.7343 | Train Acc: 0.7767
Average Train Accuracy: 0.8523
 Site-MNIST                     (1) | Val  Loss: 0.2220 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.3022 | Val  Acc: 0.9245
 Site-USPS                      (3) | Val  Loss: 0.3969 | Val  Acc: 0.8478
 Site-USPS                      (6) | Val  Loss: 0.3442 | Val  Acc: 0.8705
 Site-SynthDigits               (4) | Val  Loss: 0.4081 | Val  Acc: 0.8696
 Site-SynthDigits               (4) | Val  Loss: 0.3917 | Val  Acc: 0.8741
 Site-MNIST_M                   (2) | Val  Loss: 0.6430 | Val  Acc: 0.8370
 Site-MNIST_M                   (5) | Val  Loss: 0.5779 | Val  Acc: 0.8309
 Site-SVHN                      (0) | Val  Loss: 0.7582 | Val  Acc: 0.7717
 Site-SVHN                      (0) | Val  Loss: 0.7830 | Val  Acc: 0.7662
Average Valid Accuracy: 0.8538
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9245
 Best site-USPS                     (3)  | Epoch:30 | Val Acc: 0.8478
 Best site-USPS                     (6)  | Epoch:30 | Val Acc: 0.8705
 Best site-SynthDigits              (4)  | Epoch:30 | Val Acc: 0.8696
 Best site-SynthDigits              (4)  | Epoch:30 | Val Acc: 0.8741
 Best site-MNIST_M                  (2)  | Epoch:30 | Val Acc: 0.8370
 Best site-MNIST_M                  (5)  | Epoch:30 | Val Acc: 0.8309
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.7717
 Best site-SVHN                     (0)  | Epoch:30 | Val Acc: 0.7662
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (0) | Train Loss: 0.2188 | Train Acc: 0.9353
 Site-MNIST                     (0) | Train Loss: 0.2791 | Train Acc: 0.9175
 Site-USPS                      (5) | Train Loss: 0.2993 | Train Acc: 0.9084
 Site-USPS                      (4) | Train Loss: 0.2897 | Train Acc: 0.9076
 Site-SynthDigits               (1) | Train Loss: 0.4287 | Train Acc: 0.8706
 Site-SynthDigits               (1) | Train Loss: 0.3763 | Train Acc: 0.8987
 Site-MNIST_M                   (6) | Train Loss: 0.6166 | Train Acc: 0.8032
 Site-MNIST_M                   (2) | Train Loss: 0.5619 | Train Acc: 0.8395
 Site-SVHN                      (3) | Train Loss: 0.8554 | Train Acc: 0.7116
 Site-SVHN                      (3) | Train Loss: 0.7255 | Train Acc: 0.7758
Average Train Accuracy: 0.8568
 Site-MNIST                     (0) | Val  Loss: 0.2018 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.2821 | Val  Acc: 0.9281
 Site-USPS                      (5) | Val  Loss: 0.3918 | Val  Acc: 0.8478
 Site-USPS                      (4) | Val  Loss: 0.3360 | Val  Acc: 0.8777
 Site-SynthDigits               (1) | Val  Loss: 0.3993 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3864 | Val  Acc: 0.8741
 Site-MNIST_M                   (6) | Val  Loss: 0.6200 | Val  Acc: 0.8370
 Site-MNIST_M                   (2) | Val  Loss: 0.5625 | Val  Acc: 0.8345
 Site-SVHN                      (3) | Val  Loss: 0.7597 | Val  Acc: 0.7717
 Site-SVHN                      (3) | Val  Loss: 0.7768 | Val  Acc: 0.7662
Average Valid Accuracy: 0.8541
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.9348
 Best site-MNIST                    (0)  | Epoch:31 | Val Acc: 0.9281
 Best site-USPS                     (5)  | Epoch:31 | Val Acc: 0.8478
 Best site-USPS                     (4)  | Epoch:31 | Val Acc: 0.8777
 Best site-SynthDigits              (1)  | Epoch:31 | Val Acc: 0.8696
 Best site-SynthDigits              (1)  | Epoch:31 | Val Acc: 0.8741
 Best site-MNIST_M                  (6)  | Epoch:31 | Val Acc: 0.8370
 Best site-MNIST_M                  (2)  | Epoch:31 | Val Acc: 0.8345
 Best site-SVHN                     (3)  | Epoch:31 | Val Acc: 0.7717
 Best site-SVHN                     (3)  | Epoch:31 | Val Acc: 0.7662
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 32 ============
cnt=[1, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (1) | Train Loss: 0.2164 | Train Acc: 0.9353
 Site-MNIST                     (1) | Train Loss: 0.2610 | Train Acc: 0.9220
 Site-USPS                      (4) | Train Loss: 0.2949 | Train Acc: 0.9057
 Site-USPS                      (4) | Train Loss: 0.2930 | Train Acc: 0.9112
 Site-SynthDigits               (6) | Train Loss: 0.4116 | Train Acc: 0.8706
 Site-SynthDigits               (3) | Train Loss: 0.3672 | Train Acc: 0.9004
 Site-MNIST_M                   (2) | Train Loss: 0.5944 | Train Acc: 0.8032
 Site-MNIST_M                   (2) | Train Loss: 0.5503 | Train Acc: 0.8430
 Site-SVHN                      (5) | Train Loss: 0.8452 | Train Acc: 0.7170
 Site-SVHN                      (0) | Train Loss: 0.7081 | Train Acc: 0.7776
Average Train Accuracy: 0.8586
 Site-MNIST                     (1) | Val  Loss: 0.1919 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2725 | Val  Acc: 0.9281
 Site-USPS                      (4) | Val  Loss: 0.3924 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.3337 | Val  Acc: 0.8813
 Site-SynthDigits               (6) | Val  Loss: 0.3963 | Val  Acc: 0.8696
 Site-SynthDigits               (3) | Val  Loss: 0.3744 | Val  Acc: 0.8705
 Site-MNIST_M                   (2) | Val  Loss: 0.6034 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.5488 | Val  Acc: 0.8345
 Site-SVHN                      (5) | Val  Loss: 0.7469 | Val  Acc: 0.7826
 Site-SVHN                      (0) | Val  Loss: 0.7608 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8603
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:32 | Val Acc: 0.9281
 Best site-USPS                     (4)  | Epoch:32 | Val Acc: 0.8587
 Best site-USPS                     (4)  | Epoch:32 | Val Acc: 0.8813
 Best site-SynthDigits              (6)  | Epoch:32 | Val Acc: 0.8696
 Best site-SynthDigits              (3)  | Epoch:32 | Val Acc: 0.8705
 Best site-MNIST_M                  (2)  | Epoch:32 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:32 | Val Acc: 0.8345
 Best site-SVHN                     (5)  | Epoch:32 | Val Acc: 0.7826
 Best site-SVHN                     (0)  | Epoch:32 | Val Acc: 0.7734
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (0) | Train Loss: 0.2099 | Train Acc: 0.9380
 Site-MNIST                     (0) | Train Loss: 0.2630 | Train Acc: 0.9202
 Site-USPS                      (4) | Train Loss: 0.2866 | Train Acc: 0.8976
 Site-USPS                      (4) | Train Loss: 0.2788 | Train Acc: 0.9094
 Site-SynthDigits               (6) | Train Loss: 0.4121 | Train Acc: 0.8733
 Site-SynthDigits               (2) | Train Loss: 0.3656 | Train Acc: 0.9013
 Site-MNIST_M                   (3) | Train Loss: 0.5890 | Train Acc: 0.8032
 Site-MNIST_M                   (3) | Train Loss: 0.5460 | Train Acc: 0.8466
 Site-SVHN                      (5) | Train Loss: 0.8269 | Train Acc: 0.7170
 Site-SVHN                      (1) | Train Loss: 0.6980 | Train Acc: 0.7883
Average Train Accuracy: 0.8595
 Site-MNIST                     (0) | Val  Loss: 0.1911 | Val  Acc: 0.9348
 Site-MNIST                     (0) | Val  Loss: 0.2724 | Val  Acc: 0.9281
 Site-USPS                      (4) | Val  Loss: 0.3869 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.3280 | Val  Acc: 0.8813
 Site-SynthDigits               (6) | Val  Loss: 0.3920 | Val  Acc: 0.8696
 Site-SynthDigits               (2) | Val  Loss: 0.3773 | Val  Acc: 0.8705
 Site-MNIST_M                   (3) | Val  Loss: 0.6074 | Val  Acc: 0.8478
 Site-MNIST_M                   (3) | Val  Loss: 0.5454 | Val  Acc: 0.8309
 Site-SVHN                      (5) | Val  Loss: 0.7400 | Val  Acc: 0.7935
 Site-SVHN                      (1) | Val  Loss: 0.7473 | Val  Acc: 0.7770
Average Valid Accuracy: 0.8592
============ Train epoch 34 ============
cnt=[1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (2) | Train Loss: 0.2014 | Train Acc: 0.9407
 Site-MNIST                     (2) | Train Loss: 0.2583 | Train Acc: 0.9220
 Site-USPS                      (4) | Train Loss: 0.2715 | Train Acc: 0.9218
 Site-USPS                      (4) | Train Loss: 0.2675 | Train Acc: 0.9202
 Site-SynthDigits               (5) | Train Loss: 0.4033 | Train Acc: 0.8733
 Site-SynthDigits               (0) | Train Loss: 0.3536 | Train Acc: 0.9022
 Site-MNIST_M                   (1) | Train Loss: 0.5847 | Train Acc: 0.7898
 Site-MNIST_M                   (6) | Train Loss: 0.5304 | Train Acc: 0.8475
 Site-SVHN                      (3) | Train Loss: 0.8341 | Train Acc: 0.7332
 Site-SVHN                      (3) | Train Loss: 0.6910 | Train Acc: 0.7964
Average Train Accuracy: 0.8647
 Site-MNIST                     (2) | Val  Loss: 0.1818 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.2678 | Val  Acc: 0.9281
 Site-USPS                      (4) | Val  Loss: 0.3771 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.3163 | Val  Acc: 0.8921
 Site-SynthDigits               (5) | Val  Loss: 0.3809 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3640 | Val  Acc: 0.8705
 Site-MNIST_M                   (1) | Val  Loss: 0.6014 | Val  Acc: 0.8587
 Site-MNIST_M                   (6) | Val  Loss: 0.5377 | Val  Acc: 0.8345
 Site-SVHN                      (3) | Val  Loss: 0.7377 | Val  Acc: 0.8043
 Site-SVHN                      (3) | Val  Loss: 0.7459 | Val  Acc: 0.7770
Average Valid Accuracy: 0.8628
 Best site-MNIST                    (2)  | Epoch:34 | Val Acc: 0.9348
 Best site-MNIST                    (2)  | Epoch:34 | Val Acc: 0.9281
 Best site-USPS                     (4)  | Epoch:34 | Val Acc: 0.8587
 Best site-USPS                     (4)  | Epoch:34 | Val Acc: 0.8921
 Best site-SynthDigits              (5)  | Epoch:34 | Val Acc: 0.8696
 Best site-SynthDigits              (0)  | Epoch:34 | Val Acc: 0.8705
 Best site-MNIST_M                  (1)  | Epoch:34 | Val Acc: 0.8587
 Best site-MNIST_M                  (6)  | Epoch:34 | Val Acc: 0.8345
 Best site-SVHN                     (3)  | Epoch:34 | Val Acc: 0.8043
 Best site-SVHN                     (3)  | Epoch:34 | Val Acc: 0.7770
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (2) | Train Loss: 0.2032 | Train Acc: 0.9407
 Site-MNIST                     (2) | Train Loss: 0.2513 | Train Acc: 0.9283
 Site-USPS                      (4) | Train Loss: 0.2779 | Train Acc: 0.9218
 Site-USPS                      (5) | Train Loss: 0.2762 | Train Acc: 0.9193
 Site-SynthDigits               (0) | Train Loss: 0.3889 | Train Acc: 0.8760
 Site-SynthDigits               (0) | Train Loss: 0.3489 | Train Acc: 0.9049
 Site-MNIST_M                   (1) | Train Loss: 0.5788 | Train Acc: 0.8086
 Site-MNIST_M                   (1) | Train Loss: 0.5308 | Train Acc: 0.8475
 Site-SVHN                      (3) | Train Loss: 0.8123 | Train Acc: 0.7224
 Site-SVHN                      (6) | Train Loss: 0.6747 | Train Acc: 0.8000
Average Train Accuracy: 0.8670
 Site-MNIST                     (2) | Val  Loss: 0.1784 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.2670 | Val  Acc: 0.9317
 Site-USPS                      (4) | Val  Loss: 0.3745 | Val  Acc: 0.8696
 Site-USPS                      (5) | Val  Loss: 0.3147 | Val  Acc: 0.8921
 Site-SynthDigits               (0) | Val  Loss: 0.3761 | Val  Acc: 0.8696
 Site-SynthDigits               (0) | Val  Loss: 0.3524 | Val  Acc: 0.8849
 Site-MNIST_M                   (1) | Val  Loss: 0.5868 | Val  Acc: 0.8478
 Site-MNIST_M                   (1) | Val  Loss: 0.5264 | Val  Acc: 0.8345
 Site-SVHN                      (3) | Val  Loss: 0.7111 | Val  Acc: 0.8152
 Site-SVHN                      (6) | Val  Loss: 0.7260 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8671
 Best site-MNIST                    (2)  | Epoch:35 | Val Acc: 0.9348
 Best site-MNIST                    (2)  | Epoch:35 | Val Acc: 0.9317
 Best site-USPS                     (4)  | Epoch:35 | Val Acc: 0.8696
 Best site-USPS                     (5)  | Epoch:35 | Val Acc: 0.8921
 Best site-SynthDigits              (0)  | Epoch:35 | Val Acc: 0.8696
 Best site-SynthDigits              (0)  | Epoch:35 | Val Acc: 0.8849
 Best site-MNIST_M                  (1)  | Epoch:35 | Val Acc: 0.8478
 Best site-MNIST_M                  (1)  | Epoch:35 | Val Acc: 0.8345
 Best site-SVHN                     (3)  | Epoch:35 | Val Acc: 0.8152
 Best site-SVHN                     (6)  | Epoch:35 | Val Acc: 0.7914
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (3) | Train Loss: 0.1987 | Train Acc: 0.9407
 Site-MNIST                     (3) | Train Loss: 0.2510 | Train Acc: 0.9309
 Site-USPS                      (0) | Train Loss: 0.2704 | Train Acc: 0.9164
 Site-USPS                      (0) | Train Loss: 0.2677 | Train Acc: 0.9220
 Site-SynthDigits               (4) | Train Loss: 0.4039 | Train Acc: 0.8814
 Site-SynthDigits               (6) | Train Loss: 0.3525 | Train Acc: 0.9040
 Site-MNIST_M                   (1) | Train Loss: 0.5792 | Train Acc: 0.8140
 Site-MNIST_M                   (1) | Train Loss: 0.5197 | Train Acc: 0.8538
 Site-SVHN                      (2) | Train Loss: 0.8251 | Train Acc: 0.7197
 Site-SVHN                      (5) | Train Loss: 0.6768 | Train Acc: 0.7982
Average Train Accuracy: 0.8681
 Site-MNIST                     (3) | Val  Loss: 0.1737 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2618 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.3782 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.3147 | Val  Acc: 0.8885
 Site-SynthDigits               (4) | Val  Loss: 0.3814 | Val  Acc: 0.8804
 Site-SynthDigits               (6) | Val  Loss: 0.3602 | Val  Acc: 0.8813
 Site-MNIST_M                   (1) | Val  Loss: 0.5824 | Val  Acc: 0.8696
 Site-MNIST_M                   (1) | Val  Loss: 0.5242 | Val  Acc: 0.8417
 Site-SVHN                      (2) | Val  Loss: 0.7124 | Val  Acc: 0.7935
 Site-SVHN                      (5) | Val  Loss: 0.7288 | Val  Acc: 0.7806
Average Valid Accuracy: 0.8682
 Best site-MNIST                    (3)  | Epoch:36 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:36 | Val Acc: 0.9317
 Best site-USPS                     (0)  | Epoch:36 | Val Acc: 0.8696
 Best site-USPS                     (0)  | Epoch:36 | Val Acc: 0.8885
 Best site-SynthDigits              (4)  | Epoch:36 | Val Acc: 0.8804
 Best site-SynthDigits              (6)  | Epoch:36 | Val Acc: 0.8813
 Best site-MNIST_M                  (1)  | Epoch:36 | Val Acc: 0.8696
 Best site-MNIST_M                  (1)  | Epoch:36 | Val Acc: 0.8417
 Best site-SVHN                     (2)  | Epoch:36 | Val Acc: 0.7935
 Best site-SVHN                     (5)  | Epoch:36 | Val Acc: 0.7806
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 37 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.1959 | Train Acc: 0.9380
 Site-MNIST                     (3) | Train Loss: 0.2506 | Train Acc: 0.9336
 Site-USPS                      (1) | Train Loss: 0.2608 | Train Acc: 0.9272
 Site-USPS                      (1) | Train Loss: 0.2607 | Train Acc: 0.9247
 Site-SynthDigits               (4) | Train Loss: 0.3792 | Train Acc: 0.8868
 Site-SynthDigits               (4) | Train Loss: 0.3390 | Train Acc: 0.9040
 Site-MNIST_M                   (0) | Train Loss: 0.5718 | Train Acc: 0.8086
 Site-MNIST_M                   (6) | Train Loss: 0.5170 | Train Acc: 0.8565
 Site-SVHN                      (5) | Train Loss: 0.8108 | Train Acc: 0.7412
 Site-SVHN                      (2) | Train Loss: 0.6646 | Train Acc: 0.7937
Average Train Accuracy: 0.8714
 Site-MNIST                     (3) | Val  Loss: 0.1677 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2544 | Val  Acc: 0.9353
 Site-USPS                      (1) | Val  Loss: 0.3619 | Val  Acc: 0.8696
 Site-USPS                      (1) | Val  Loss: 0.3042 | Val  Acc: 0.9029
 Site-SynthDigits               (4) | Val  Loss: 0.3512 | Val  Acc: 0.8696
 Site-SynthDigits               (4) | Val  Loss: 0.3449 | Val  Acc: 0.8885
 Site-MNIST_M                   (0) | Val  Loss: 0.5700 | Val  Acc: 0.8696
 Site-MNIST_M                   (6) | Val  Loss: 0.5156 | Val  Acc: 0.8453
 Site-SVHN                      (5) | Val  Loss: 0.7101 | Val  Acc: 0.7826
 Site-SVHN                      (2) | Val  Loss: 0.7171 | Val  Acc: 0.7878
Average Valid Accuracy: 0.8697
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9353
 Best site-USPS                     (1)  | Epoch:37 | Val Acc: 0.8696
 Best site-USPS                     (1)  | Epoch:37 | Val Acc: 0.9029
 Best site-SynthDigits              (4)  | Epoch:37 | Val Acc: 0.8696
 Best site-SynthDigits              (4)  | Epoch:37 | Val Acc: 0.8885
 Best site-MNIST_M                  (0)  | Epoch:37 | Val Acc: 0.8696
 Best site-MNIST_M                  (6)  | Epoch:37 | Val Acc: 0.8453
 Best site-SVHN                     (5)  | Epoch:37 | Val Acc: 0.7826
 Best site-SVHN                     (2)  | Epoch:37 | Val Acc: 0.7878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 38 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (3) | Train Loss: 0.1997 | Train Acc: 0.9326
 Site-MNIST                     (3) | Train Loss: 0.2517 | Train Acc: 0.9336
 Site-USPS                      (6) | Train Loss: 0.2687 | Train Acc: 0.9299
 Site-USPS                      (0) | Train Loss: 0.2639 | Train Acc: 0.9211
 Site-SynthDigits               (4) | Train Loss: 0.3741 | Train Acc: 0.8814
 Site-SynthDigits               (4) | Train Loss: 0.3351 | Train Acc: 0.9049
 Site-MNIST_M                   (1) | Train Loss: 0.5555 | Train Acc: 0.8059
 Site-MNIST_M                   (1) | Train Loss: 0.5044 | Train Acc: 0.8547
 Site-SVHN                      (2) | Train Loss: 0.8044 | Train Acc: 0.7305
 Site-SVHN                      (5) | Train Loss: 0.6650 | Train Acc: 0.7982
Average Train Accuracy: 0.8693
 Site-MNIST                     (3) | Val  Loss: 0.1667 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2568 | Val  Acc: 0.9353
 Site-USPS                      (6) | Val  Loss: 0.3608 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.3053 | Val  Acc: 0.9029
 Site-SynthDigits               (4) | Val  Loss: 0.3573 | Val  Acc: 0.8804
 Site-SynthDigits               (4) | Val  Loss: 0.3421 | Val  Acc: 0.8921
 Site-MNIST_M                   (1) | Val  Loss: 0.5659 | Val  Acc: 0.8696
 Site-MNIST_M                   (1) | Val  Loss: 0.5113 | Val  Acc: 0.8345
 Site-SVHN                      (2) | Val  Loss: 0.6936 | Val  Acc: 0.8043
 Site-SVHN                      (5) | Val  Loss: 0.7036 | Val  Acc: 0.7878
Average Valid Accuracy: 0.8722
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:38 | Val Acc: 0.9353
 Best site-USPS                     (6)  | Epoch:38 | Val Acc: 0.8587
 Best site-USPS                     (0)  | Epoch:38 | Val Acc: 0.9029
 Best site-SynthDigits              (4)  | Epoch:38 | Val Acc: 0.8804
 Best site-SynthDigits              (4)  | Epoch:38 | Val Acc: 0.8921
 Best site-MNIST_M                  (1)  | Epoch:38 | Val Acc: 0.8696
 Best site-MNIST_M                  (1)  | Epoch:38 | Val Acc: 0.8345
 Best site-SVHN                     (2)  | Epoch:38 | Val Acc: 0.8043
 Best site-SVHN                     (5)  | Epoch:38 | Val Acc: 0.7878
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 39 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (3) | Train Loss: 0.1973 | Train Acc: 0.9407
 Site-MNIST                     (3) | Train Loss: 0.2436 | Train Acc: 0.9265
 Site-USPS                      (5) | Train Loss: 0.2679 | Train Acc: 0.9353
 Site-USPS                      (0) | Train Loss: 0.2628 | Train Acc: 0.9175
 Site-SynthDigits               (4) | Train Loss: 0.3710 | Train Acc: 0.8841
 Site-SynthDigits               (4) | Train Loss: 0.3236 | Train Acc: 0.9103
 Site-MNIST_M                   (1) | Train Loss: 0.5573 | Train Acc: 0.8167
 Site-MNIST_M                   (1) | Train Loss: 0.4956 | Train Acc: 0.8601
 Site-SVHN                      (6) | Train Loss: 0.7896 | Train Acc: 0.7278
 Site-SVHN                      (2) | Train Loss: 0.6501 | Train Acc: 0.7982
Average Train Accuracy: 0.8717
 Site-MNIST                     (3) | Val  Loss: 0.1662 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2547 | Val  Acc: 0.9353
 Site-USPS                      (5) | Val  Loss: 0.3524 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.3040 | Val  Acc: 0.9101
 Site-SynthDigits               (4) | Val  Loss: 0.3388 | Val  Acc: 0.8804
 Site-SynthDigits               (4) | Val  Loss: 0.3358 | Val  Acc: 0.8849
 Site-MNIST_M                   (1) | Val  Loss: 0.5558 | Val  Acc: 0.8587
 Site-MNIST_M                   (1) | Val  Loss: 0.5053 | Val  Acc: 0.8453
 Site-SVHN                      (6) | Val  Loss: 0.6891 | Val  Acc: 0.8152
 Site-SVHN                      (2) | Val  Loss: 0.6932 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8740
 Best site-MNIST                    (3)  | Epoch:39 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:39 | Val Acc: 0.9353
 Best site-USPS                     (5)  | Epoch:39 | Val Acc: 0.8696
 Best site-USPS                     (0)  | Epoch:39 | Val Acc: 0.9101
 Best site-SynthDigits              (4)  | Epoch:39 | Val Acc: 0.8804
 Best site-SynthDigits              (4)  | Epoch:39 | Val Acc: 0.8849
 Best site-MNIST_M                  (1)  | Epoch:39 | Val Acc: 0.8587
 Best site-MNIST_M                  (1)  | Epoch:39 | Val Acc: 0.8453
 Best site-SVHN                     (6)  | Epoch:39 | Val Acc: 0.8152
 Best site-SVHN                     (2)  | Epoch:39 | Val Acc: 0.7950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.1863 | Train Acc: 0.9407
 Site-MNIST                     (1) | Train Loss: 0.2389 | Train Acc: 0.9291
 Site-USPS                      (4) | Train Loss: 0.2721 | Train Acc: 0.9218
 Site-USPS                      (6) | Train Loss: 0.2603 | Train Acc: 0.9256
 Site-SynthDigits               (3) | Train Loss: 0.3629 | Train Acc: 0.8841
 Site-SynthDigits               (3) | Train Loss: 0.3242 | Train Acc: 0.9049
 Site-MNIST_M                   (5) | Train Loss: 0.5562 | Train Acc: 0.8032
 Site-MNIST_M                   (2) | Train Loss: 0.4933 | Train Acc: 0.8547
 Site-SVHN                      (0) | Train Loss: 0.7864 | Train Acc: 0.7439
 Site-SVHN                      (0) | Train Loss: 0.6394 | Train Acc: 0.8117
Average Train Accuracy: 0.8720
 Site-MNIST                     (1) | Val  Loss: 0.1585 | Val  Acc: 0.9565
 Site-MNIST                     (1) | Val  Loss: 0.2451 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3505 | Val  Acc: 0.8804
 Site-USPS                      (6) | Val  Loss: 0.2931 | Val  Acc: 0.9065
 Site-SynthDigits               (3) | Val  Loss: 0.3393 | Val  Acc: 0.8804
 Site-SynthDigits               (3) | Val  Loss: 0.3262 | Val  Acc: 0.8957
 Site-MNIST_M                   (5) | Val  Loss: 0.5387 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.4940 | Val  Acc: 0.8381
 Site-SVHN                      (0) | Val  Loss: 0.6871 | Val  Acc: 0.8043
 Site-SVHN                      (0) | Val  Loss: 0.6864 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8758
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9565
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9388
 Best site-USPS                     (4)  | Epoch:40 | Val Acc: 0.8804
 Best site-USPS                     (6)  | Epoch:40 | Val Acc: 0.9065
 Best site-SynthDigits              (3)  | Epoch:40 | Val Acc: 0.8804
 Best site-SynthDigits              (3)  | Epoch:40 | Val Acc: 0.8957
 Best site-MNIST_M                  (5)  | Epoch:40 | Val Acc: 0.8587
 Best site-MNIST_M                  (2)  | Epoch:40 | Val Acc: 0.8381
 Best site-SVHN                     (0)  | Epoch:40 | Val Acc: 0.8043
 Best site-SVHN                     (0)  | Epoch:40 | Val Acc: 0.7986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (0) | Train Loss: 0.1868 | Train Acc: 0.9299
 Site-MNIST                     (0) | Train Loss: 0.2410 | Train Acc: 0.9327
 Site-USPS                      (4) | Train Loss: 0.2549 | Train Acc: 0.9326
 Site-USPS                      (4) | Train Loss: 0.2446 | Train Acc: 0.9238
 Site-SynthDigits               (1) | Train Loss: 0.3688 | Train Acc: 0.8787
 Site-SynthDigits               (1) | Train Loss: 0.3268 | Train Acc: 0.9121
 Site-MNIST_M                   (2) | Train Loss: 0.5339 | Train Acc: 0.8194
 Site-MNIST_M                   (5) | Train Loss: 0.4869 | Train Acc: 0.8619
 Site-SVHN                      (3) | Train Loss: 0.7833 | Train Acc: 0.7332
 Site-SVHN                      (6) | Train Loss: 0.6314 | Train Acc: 0.8036
Average Train Accuracy: 0.8728
 Site-MNIST                     (0) | Val  Loss: 0.1646 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2458 | Val  Acc: 0.9353
 Site-USPS                      (4) | Val  Loss: 0.3404 | Val  Acc: 0.8696
 Site-USPS                      (4) | Val  Loss: 0.2865 | Val  Acc: 0.9065
 Site-SynthDigits               (1) | Val  Loss: 0.3490 | Val  Acc: 0.8696
 Site-SynthDigits               (1) | Val  Loss: 0.3312 | Val  Acc: 0.8813
 Site-MNIST_M                   (2) | Val  Loss: 0.5291 | Val  Acc: 0.8696
 Site-MNIST_M                   (5) | Val  Loss: 0.4894 | Val  Acc: 0.8453
 Site-SVHN                      (3) | Val  Loss: 0.6807 | Val  Acc: 0.7935
 Site-SVHN                      (6) | Val  Loss: 0.6869 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8711
============ Train epoch 42 ============
cnt=[1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (3) | Train Loss: 0.1926 | Train Acc: 0.9434
 Site-MNIST                     (3) | Train Loss: 0.2354 | Train Acc: 0.9309
 Site-USPS                      (1) | Train Loss: 0.2508 | Train Acc: 0.9353
 Site-USPS                      (1) | Train Loss: 0.2514 | Train Acc: 0.9274
 Site-SynthDigits               (6) | Train Loss: 0.3533 | Train Acc: 0.8922
 Site-SynthDigits               (4) | Train Loss: 0.3099 | Train Acc: 0.9175
 Site-MNIST_M                   (5) | Train Loss: 0.5405 | Train Acc: 0.8275
 Site-MNIST_M                   (0) | Train Loss: 0.4835 | Train Acc: 0.8655
 Site-SVHN                      (2) | Train Loss: 0.7824 | Train Acc: 0.7332
 Site-SVHN                      (2) | Train Loss: 0.6241 | Train Acc: 0.8108
Average Train Accuracy: 0.8784
 Site-MNIST                     (3) | Val  Loss: 0.1600 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2460 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.3453 | Val  Acc: 0.8804
 Site-USPS                      (1) | Val  Loss: 0.2838 | Val  Acc: 0.9065
 Site-SynthDigits               (6) | Val  Loss: 0.3287 | Val  Acc: 0.8804
 Site-SynthDigits               (4) | Val  Loss: 0.3146 | Val  Acc: 0.8957
 Site-MNIST_M                   (5) | Val  Loss: 0.5159 | Val  Acc: 0.8587
 Site-MNIST_M                   (0) | Val  Loss: 0.4813 | Val  Acc: 0.8417
 Site-SVHN                      (2) | Val  Loss: 0.6774 | Val  Acc: 0.8043
 Site-SVHN                      (2) | Val  Loss: 0.6846 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8747
============ Train epoch 43 ============
cnt=[1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (3) | Train Loss: 0.2015 | Train Acc: 0.9299
 Site-MNIST                     (3) | Train Loss: 0.2484 | Train Acc: 0.9229
 Site-USPS                      (1) | Train Loss: 0.2404 | Train Acc: 0.9326
 Site-USPS                      (1) | Train Loss: 0.2459 | Train Acc: 0.9274
 Site-SynthDigits               (6) | Train Loss: 0.3474 | Train Acc: 0.8922
 Site-SynthDigits               (4) | Train Loss: 0.3197 | Train Acc: 0.9121
 Site-MNIST_M                   (2) | Train Loss: 0.5301 | Train Acc: 0.8248
 Site-MNIST_M                   (2) | Train Loss: 0.4713 | Train Acc: 0.8700
 Site-SVHN                      (5) | Train Loss: 0.7766 | Train Acc: 0.7385
 Site-SVHN                      (0) | Train Loss: 0.6138 | Train Acc: 0.8099
Average Train Accuracy: 0.8760
 Site-MNIST                     (3) | Val  Loss: 0.1731 | Val  Acc: 0.9348
 Site-MNIST                     (3) | Val  Loss: 0.2527 | Val  Acc: 0.9317
 Site-USPS                      (1) | Val  Loss: 0.3290 | Val  Acc: 0.8696
 Site-USPS                      (1) | Val  Loss: 0.2742 | Val  Acc: 0.9065
 Site-SynthDigits               (6) | Val  Loss: 0.3333 | Val  Acc: 0.8913
 Site-SynthDigits               (4) | Val  Loss: 0.3143 | Val  Acc: 0.8957
 Site-MNIST_M                   (2) | Val  Loss: 0.5157 | Val  Acc: 0.8587
 Site-MNIST_M                   (2) | Val  Loss: 0.4750 | Val  Acc: 0.8489
 Site-SVHN                      (5) | Val  Loss: 0.6650 | Val  Acc: 0.8152
 Site-SVHN                      (0) | Val  Loss: 0.6697 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8751
============ Train epoch 44 ============
cnt=[1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (4) | Train Loss: 0.2011 | Train Acc: 0.9245
 Site-MNIST                     (4) | Train Loss: 0.2400 | Train Acc: 0.9274
 Site-USPS                      (6) | Train Loss: 0.2451 | Train Acc: 0.9407
 Site-USPS                      (0) | Train Loss: 0.2431 | Train Acc: 0.9309
 Site-SynthDigits               (3) | Train Loss: 0.3438 | Train Acc: 0.8976
 Site-SynthDigits               (3) | Train Loss: 0.3050 | Train Acc: 0.9139
 Site-MNIST_M                   (1) | Train Loss: 0.5258 | Train Acc: 0.8383
 Site-MNIST_M                   (1) | Train Loss: 0.4716 | Train Acc: 0.8601
 Site-SVHN                      (2) | Train Loss: 0.7669 | Train Acc: 0.7601
 Site-SVHN                      (5) | Train Loss: 0.6171 | Train Acc: 0.8143
Average Train Accuracy: 0.8808
 Site-MNIST                     (4) | Val  Loss: 0.1771 | Val  Acc: 0.9239
 Site-MNIST                     (4) | Val  Loss: 0.2508 | Val  Acc: 0.9353
 Site-USPS                      (6) | Val  Loss: 0.3205 | Val  Acc: 0.8913
 Site-USPS                      (0) | Val  Loss: 0.2702 | Val  Acc: 0.9137
 Site-SynthDigits               (3) | Val  Loss: 0.3179 | Val  Acc: 0.9022
 Site-SynthDigits               (3) | Val  Loss: 0.3052 | Val  Acc: 0.8993
 Site-MNIST_M                   (1) | Val  Loss: 0.5081 | Val  Acc: 0.8587
 Site-MNIST_M                   (1) | Val  Loss: 0.4718 | Val  Acc: 0.8489
 Site-SVHN                      (2) | Val  Loss: 0.6550 | Val  Acc: 0.8043
 Site-SVHN                      (5) | Val  Loss: 0.6600 | Val  Acc: 0.8058
Average Valid Accuracy: 0.8783
 Best site-MNIST                    (4)  | Epoch:44 | Val Acc: 0.9239
 Best site-MNIST                    (4)  | Epoch:44 | Val Acc: 0.9353
 Best site-USPS                     (6)  | Epoch:44 | Val Acc: 0.8913
 Best site-USPS                     (0)  | Epoch:44 | Val Acc: 0.9137
 Best site-SynthDigits              (3)  | Epoch:44 | Val Acc: 0.9022
 Best site-SynthDigits              (3)  | Epoch:44 | Val Acc: 0.8993
 Best site-MNIST_M                  (1)  | Epoch:44 | Val Acc: 0.8587
 Best site-MNIST_M                  (1)  | Epoch:44 | Val Acc: 0.8489
 Best site-SVHN                     (2)  | Epoch:44 | Val Acc: 0.8043
 Best site-SVHN                     (5)  | Epoch:44 | Val Acc: 0.8058
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 45 ============
cnt=[2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (3) | Train Loss: 0.1866 | Train Acc: 0.9407
 Site-MNIST                     (3) | Train Loss: 0.2371 | Train Acc: 0.9327
 Site-USPS                      (0) | Train Loss: 0.2407 | Train Acc: 0.9353
 Site-USPS                      (0) | Train Loss: 0.2358 | Train Acc: 0.9265
 Site-SynthDigits               (4) | Train Loss: 0.3468 | Train Acc: 0.8922
 Site-SynthDigits               (4) | Train Loss: 0.3028 | Train Acc: 0.9148
 Site-MNIST_M                   (6) | Train Loss: 0.5210 | Train Acc: 0.8275
 Site-MNIST_M                   (1) | Train Loss: 0.4717 | Train Acc: 0.8565
 Site-SVHN                      (5) | Train Loss: 0.7689 | Train Acc: 0.7493
 Site-SVHN                      (2) | Train Loss: 0.6169 | Train Acc: 0.8152
Average Train Accuracy: 0.8791
 Site-MNIST                     (3) | Val  Loss: 0.1673 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2371 | Val  Acc: 0.9388
 Site-USPS                      (0) | Val  Loss: 0.3201 | Val  Acc: 0.8804
 Site-USPS                      (0) | Val  Loss: 0.2709 | Val  Acc: 0.9137
 Site-SynthDigits               (4) | Val  Loss: 0.3152 | Val  Acc: 0.8913
 Site-SynthDigits               (4) | Val  Loss: 0.3047 | Val  Acc: 0.9029
 Site-MNIST_M                   (6) | Val  Loss: 0.4999 | Val  Acc: 0.8587
 Site-MNIST_M                   (1) | Val  Loss: 0.4610 | Val  Acc: 0.8525
 Site-SVHN                      (5) | Val  Loss: 0.6624 | Val  Acc: 0.8261
 Site-SVHN                      (2) | Val  Loss: 0.6533 | Val  Acc: 0.8058
Average Valid Accuracy: 0.8827
 Best site-MNIST                    (3)  | Epoch:45 | Val Acc: 0.9565
 Best site-MNIST                    (3)  | Epoch:45 | Val Acc: 0.9388
 Best site-USPS                     (0)  | Epoch:45 | Val Acc: 0.8804
 Best site-USPS                     (0)  | Epoch:45 | Val Acc: 0.9137
 Best site-SynthDigits              (4)  | Epoch:45 | Val Acc: 0.8913
 Best site-SynthDigits              (4)  | Epoch:45 | Val Acc: 0.9029
 Best site-MNIST_M                  (6)  | Epoch:45 | Val Acc: 0.8587
 Best site-MNIST_M                  (1)  | Epoch:45 | Val Acc: 0.8525
 Best site-SVHN                     (5)  | Epoch:45 | Val Acc: 0.8261
 Best site-SVHN                     (2)  | Epoch:45 | Val Acc: 0.8058
 Test site-MNIST                     (3)| Epoch:45 | Test Acc: 0.9377
 Test site-USPS                      (0)| Epoch:45 | Test Acc: 0.9344
 Test site-SynthDigits               (4)| Epoch:45 | Test Acc: 0.8999
 Test site-MNIST_M                   (6)| Epoch:45 | Test Acc: 0.7733
 Test site-SVHN                      (5)| Epoch:45 | Test Acc: 0.7341
MNIST: 0.9377, USPS: 0.9344, SynthDigits: 0.8999, MNIST_M: 0.7733, SVHN: 0.7341, 
Average Test Accuracy(group): 0.8559, Average Test Accuracy(individual): 0.8559,
domain std=0.0854, cluster std=0.0863, individual std=0.0854, 
Average Test Accuracy: 0.8559
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (0) | Train Loss: 0.1849 | Train Acc: 0.9434
 Site-MNIST                     (0) | Train Loss: 0.2283 | Train Acc: 0.9345
 Site-USPS                      (4) | Train Loss: 0.2445 | Train Acc: 0.9299
 Site-USPS                      (4) | Train Loss: 0.2403 | Train Acc: 0.9274
 Site-SynthDigits               (3) | Train Loss: 0.3411 | Train Acc: 0.8949
 Site-SynthDigits               (6) | Train Loss: 0.3026 | Train Acc: 0.9175
 Site-MNIST_M                   (2) | Train Loss: 0.5282 | Train Acc: 0.8329
 Site-MNIST_M                   (2) | Train Loss: 0.4679 | Train Acc: 0.8592
 Site-SVHN                      (1) | Train Loss: 0.7488 | Train Acc: 0.7520
 Site-SVHN                      (5) | Train Loss: 0.6023 | Train Acc: 0.8126
Average Train Accuracy: 0.8804
 Site-MNIST                     (0) | Val  Loss: 0.1632 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2360 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3223 | Val  Acc: 0.8696
 Site-USPS                      (4) | Val  Loss: 0.2755 | Val  Acc: 0.9029
 Site-SynthDigits               (3) | Val  Loss: 0.3092 | Val  Acc: 0.8804
 Site-SynthDigits               (6) | Val  Loss: 0.3039 | Val  Acc: 0.8993
 Site-MNIST_M                   (2) | Val  Loss: 0.5039 | Val  Acc: 0.8696
 Site-MNIST_M                   (2) | Val  Loss: 0.4683 | Val  Acc: 0.8597
 Site-SVHN                      (1) | Val  Loss: 0.6412 | Val  Acc: 0.8043
 Site-SVHN                      (5) | Val  Loss: 0.6439 | Val  Acc: 0.8058
Average Valid Accuracy: 0.8787
 Test site-MNIST                     (0)| Epoch:45 | Test Acc: 0.9367
 Test site-USPS                      (4)| Epoch:45 | Test Acc: 0.9312
 Test site-SynthDigits               (3)| Epoch:45 | Test Acc: 0.9008
 Test site-MNIST_M                   (2)| Epoch:45 | Test Acc: 0.7726
 Test site-SVHN                      (1)| Epoch:45 | Test Acc: 0.7332
MNIST: 0.9367, USPS: 0.9312, SynthDigits: 0.9008, MNIST_M: 0.7726, SVHN: 0.7332, 
Average Test Accuracy(group): 0.8549, Average Test Accuracy(individual): 0.8549,
domain std=0.0851, cluster std=0.0864, individual std=0.0851, 
Average Test Accuracy: 0.8549
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (1) | Train Loss: 0.1745 | Train Acc: 0.9434
 Site-MNIST                     (1) | Train Loss: 0.2285 | Train Acc: 0.9336
 Site-USPS                      (2) | Train Loss: 0.2500 | Train Acc: 0.9326
 Site-USPS                      (6) | Train Loss: 0.2412 | Train Acc: 0.9256
 Site-SynthDigits               (4) | Train Loss: 0.3345 | Train Acc: 0.8922
 Site-SynthDigits               (4) | Train Loss: 0.2936 | Train Acc: 0.9157
 Site-MNIST_M                   (3) | Train Loss: 0.5171 | Train Acc: 0.8275
 Site-MNIST_M                   (5) | Train Loss: 0.4628 | Train Acc: 0.8664
 Site-SVHN                      (0) | Train Loss: 0.7449 | Train Acc: 0.7493
 Site-SVHN                      (0) | Train Loss: 0.6021 | Train Acc: 0.8206
Average Train Accuracy: 0.8807
 Site-MNIST                     (1) | Val  Loss: 0.1570 | Val  Acc: 0.9565
 Site-MNIST                     (1) | Val  Loss: 0.2320 | Val  Acc: 0.9353
 Site-USPS                      (2) | Val  Loss: 0.3261 | Val  Acc: 0.8696
 Site-USPS                      (6) | Val  Loss: 0.2801 | Val  Acc: 0.9065
 Site-SynthDigits               (4) | Val  Loss: 0.2968 | Val  Acc: 0.9022
 Site-SynthDigits               (4) | Val  Loss: 0.2992 | Val  Acc: 0.9029
 Site-MNIST_M                   (3) | Val  Loss: 0.4910 | Val  Acc: 0.8804
 Site-MNIST_M                   (5) | Val  Loss: 0.4579 | Val  Acc: 0.8597
 Site-SVHN                      (0) | Val  Loss: 0.6417 | Val  Acc: 0.8043
 Site-SVHN                      (0) | Val  Loss: 0.6379 | Val  Acc: 0.8022
Average Valid Accuracy: 0.8820
 Test site-MNIST                     (1)| Epoch:46 | Test Acc: 0.9384
 Test site-USPS                      (2)| Epoch:46 | Test Acc: 0.9301
 Test site-SynthDigits               (4)| Epoch:46 | Test Acc: 0.9039
 Test site-MNIST_M                   (3)| Epoch:46 | Test Acc: 0.7719
 Test site-SVHN                      (0)| Epoch:46 | Test Acc: 0.7366
MNIST: 0.9384, USPS: 0.9301, SynthDigits: 0.9039, MNIST_M: 0.7719, SVHN: 0.7366, 
Average Test Accuracy(group): 0.8562, Average Test Accuracy(individual): 0.8562,
domain std=0.0848, cluster std=0.0832, individual std=0.0848, 
Average Test Accuracy: 0.8562
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (0) | Train Loss: 0.1692 | Train Acc: 0.9434
 Site-MNIST                     (0) | Train Loss: 0.2118 | Train Acc: 0.9354
 Site-USPS                      (4) | Train Loss: 0.2457 | Train Acc: 0.9326
 Site-USPS                      (4) | Train Loss: 0.2341 | Train Acc: 0.9309
 Site-SynthDigits               (6) | Train Loss: 0.3370 | Train Acc: 0.9003
 Site-SynthDigits               (1) | Train Loss: 0.3000 | Train Acc: 0.9211
 Site-MNIST_M                   (5) | Train Loss: 0.5168 | Train Acc: 0.8275
 Site-MNIST_M                   (3) | Train Loss: 0.4590 | Train Acc: 0.8619
 Site-SVHN                      (2) | Train Loss: 0.7494 | Train Acc: 0.7520
 Site-SVHN                      (2) | Train Loss: 0.5843 | Train Acc: 0.8206
Average Train Accuracy: 0.8826
 Site-MNIST                     (0) | Val  Loss: 0.1512 | Val  Acc: 0.9565
 Site-MNIST                     (0) | Val  Loss: 0.2258 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.3164 | Val  Acc: 0.8804
 Site-USPS                      (4) | Val  Loss: 0.2674 | Val  Acc: 0.9173
 Site-SynthDigits               (6) | Val  Loss: 0.3126 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.2953 | Val  Acc: 0.9065
 Site-MNIST_M                   (5) | Val  Loss: 0.4952 | Val  Acc: 0.8804
 Site-MNIST_M                   (3) | Val  Loss: 0.4574 | Val  Acc: 0.8525
 Site-SVHN                      (2) | Val  Loss: 0.6091 | Val  Acc: 0.8587
 Site-SVHN                      (2) | Val  Loss: 0.6277 | Val  Acc: 0.8201
Average Valid Accuracy: 0.8892
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9565
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9388
 Best site-USPS                     (4)  | Epoch:48 | Val Acc: 0.8804
 Best site-USPS                     (4)  | Epoch:48 | Val Acc: 0.9173
 Best site-SynthDigits              (6)  | Epoch:48 | Val Acc: 0.8804
 Best site-SynthDigits              (1)  | Epoch:48 | Val Acc: 0.9065
 Best site-MNIST_M                  (5)  | Epoch:48 | Val Acc: 0.8804
 Best site-MNIST_M                  (3)  | Epoch:48 | Val Acc: 0.8525
 Best site-SVHN                     (2)  | Epoch:48 | Val Acc: 0.8587
 Best site-SVHN                     (2)  | Epoch:48 | Val Acc: 0.8201
 Test site-MNIST                     (0)| Epoch:48 | Test Acc: 0.9386
 Test site-USPS                      (4)| Epoch:48 | Test Acc: 0.9344
 Test site-SynthDigits               (6)| Epoch:48 | Test Acc: 0.9009
 Test site-MNIST_M                   (5)| Epoch:48 | Test Acc: 0.7694
 Test site-SVHN                      (2)| Epoch:48 | Test Acc: 0.7384
MNIST: 0.9386, USPS: 0.9344, SynthDigits: 0.9009, MNIST_M: 0.7694, SVHN: 0.7384, 
Average Test Accuracy(group): 0.8563, Average Test Accuracy(individual): 0.8563,
domain std=0.0852, cluster std=0.0807, individual std=0.0852, 
Average Test Accuracy: 0.8563
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (2) | Train Loss: 0.1661 | Train Acc: 0.9434
 Site-MNIST                     (2) | Train Loss: 0.2162 | Train Acc: 0.9345
 Site-USPS                      (6) | Train Loss: 0.2308 | Train Acc: 0.9407
 Site-USPS                      (4) | Train Loss: 0.2243 | Train Acc: 0.9300
 Site-SynthDigits               (1) | Train Loss: 0.3366 | Train Acc: 0.9003
 Site-SynthDigits               (1) | Train Loss: 0.2949 | Train Acc: 0.9166
 Site-MNIST_M                   (0) | Train Loss: 0.5066 | Train Acc: 0.8302
 Site-MNIST_M                   (0) | Train Loss: 0.4552 | Train Acc: 0.8673
 Site-SVHN                      (3) | Train Loss: 0.7364 | Train Acc: 0.7628
 Site-SVHN                      (5) | Train Loss: 0.5765 | Train Acc: 0.8305
Average Train Accuracy: 0.8856
 Site-MNIST                     (2) | Val  Loss: 0.1469 | Val  Acc: 0.9565
 Site-MNIST                     (2) | Val  Loss: 0.2197 | Val  Acc: 0.9388
 Site-USPS                      (6) | Val  Loss: 0.3101 | Val  Acc: 0.8913
 Site-USPS                      (4) | Val  Loss: 0.2595 | Val  Acc: 0.9245
 Site-SynthDigits               (1) | Val  Loss: 0.3099 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.2927 | Val  Acc: 0.9101
 Site-MNIST_M                   (0) | Val  Loss: 0.4910 | Val  Acc: 0.8804
 Site-MNIST_M                   (0) | Val  Loss: 0.4511 | Val  Acc: 0.8597
 Site-SVHN                      (3) | Val  Loss: 0.6178 | Val  Acc: 0.8152
 Site-SVHN                      (5) | Val  Loss: 0.6212 | Val  Acc: 0.8165
Average Valid Accuracy: 0.8874
 Test site-MNIST                     (2)| Epoch:48 | Test Acc: 0.9409
 Test site-USPS                      (6)| Epoch:48 | Test Acc: 0.9366
 Test site-SynthDigits               (1)| Epoch:48 | Test Acc: 0.9010
 Test site-MNIST_M                   (0)| Epoch:48 | Test Acc: 0.7713
 Test site-SVHN                      (3)| Epoch:48 | Test Acc: 0.7406
MNIST: 0.9409, USPS: 0.9366, SynthDigits: 0.9010, MNIST_M: 0.7713, SVHN: 0.7406, 
Average Test Accuracy(group): 0.8580, Average Test Accuracy(individual): 0.8580,
domain std=0.0851, cluster std=0.0894, individual std=0.0851, 
Average Test Accuracy: 0.8580
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cluster_7/ccop_q=1...
===2023-08-12 17:27:54===
===2023-08-12 17:28:08===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 7
Loading snapshots...
 Test site-MNIST                     (2)| Epoch:49 | Test Acc: 0.9409
 Test site-USPS                      (6)| Epoch:49 | Test Acc: 0.9366
 Test site-SynthDigits               (1)| Epoch:49 | Test Acc: 0.9010
 Test site-MNIST_M                   (0)| Epoch:49 | Test Acc: 0.7713
 Test site-SVHN                      (3)| Epoch:49 | Test Acc: 0.7406
MNIST: 0.9409, USPS: 0.9366, SynthDigits: 0.9010, MNIST_M: 0.7713, SVHN: 0.7406, 
Average Test Accuracy(group): 0.8580, Average Test Accuracy(individual): 0.8580,
domain std=0.0851, cluster std=0.0894, individual std=0.0851, 
