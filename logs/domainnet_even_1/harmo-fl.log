===2023-04-23 00:47:46===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 1.4369 | Train Acc: 0.7857
 Site-Clipart   | Train Loss: 1.4396 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 2.0716 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0826 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.6173 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.5815 | Train Acc: 0.7931
 Site-QuickDraw | Train Loss: 2.1143 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 2.1312 | Train Acc: 0.2656
 Site-Real      | Train Loss: 1.4644 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.4265 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.4274 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.5679 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.3618 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.4018 | Val  Acc: 0.9018
 Site-Infograph | Val  Loss: 2.0570 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0914 | Val  Acc: 0.3659
 Site-Painting  | Val  Loss: 1.5757 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.7157 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0210 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1224 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.4844 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 1.3729 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.5003 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.5904 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6624
 Best site-Clipart    | Epoch:0 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:0 | Val Acc: 0.9018
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3659
 Best site-Painting   | Epoch:0 | Val Acc: 0.6842
 Best site-Painting   | Epoch:0 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2857
 Best site-Real       | Epoch:0 | Val Acc: 0.8400
 Best site-Real       | Epoch:0 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:0 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:0 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 0.9966 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.8978 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 2.0024 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9109 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.1575 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.1888 | Train Acc: 0.7414
 Site-QuickDraw | Train Loss: 2.0485 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.9268 | Train Acc: 0.3906
 Site-Real      | Train Loss: 0.9905 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.9134 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 0.7993 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.0590 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.8897 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 0.8690 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 1.9757 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.7933 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 1.1279 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.3411 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 1.8366 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.9588 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9535 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.8160 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.0957 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.1177 | Val  Acc: 0.8261
Average Valid Accuracy: 0.6846
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9464
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9196
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.5122
 Best site-Painting   | Epoch:1 | Val Acc: 0.6316
 Best site-Painting   | Epoch:1 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3333
 Best site-Real       | Epoch:1 | Val Acc: 0.8800
 Best site-Real       | Epoch:1 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:1 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 0.7954 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.6364 | Train Acc: 0.9345
 Site-Infograph | Train Loss: 1.9156 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7715 | Train Acc: 0.4032
 Site-Painting  | Train Loss: 0.8544 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.8873 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 2.0662 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 1.7762 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.6552 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6080 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 0.6821 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.8108 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5449 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.5954 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 1.7151 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7904 | Val  Acc: 0.3902
 Site-Painting  | Val  Loss: 0.8014 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.0886 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.6449 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.9252 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6383 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5473 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 0.8603 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 0.8975 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7052
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9196
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3902
 Best site-Painting   | Epoch:2 | Val Acc: 0.6842
 Best site-Painting   | Epoch:2 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3333
 Best site-Real       | Epoch:2 | Val Acc: 0.9200
 Best site-Real       | Epoch:2 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 0.5675 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 0.4759 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.9539 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.6974 | Train Acc: 0.4677
 Site-Painting  | Train Loss: 0.8149 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.7767 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.0130 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.7108 | Train Acc: 0.5312
 Site-Real      | Train Loss: 0.5144 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.4744 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 0.7225 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.7060 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.3964 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.4713 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.4779 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.6710 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.7644 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 0.9737 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.8136 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.7638 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.4471 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.3740 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.7326 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.7782 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7291
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4634
 Best site-Painting   | Epoch:3 | Val Acc: 0.6842
 Best site-Painting   | Epoch:3 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4762
 Best site-Real       | Epoch:3 | Val Acc: 0.9200
 Best site-Real       | Epoch:3 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 0.5035 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4151 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 1.9503 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.6169 | Train Acc: 0.4677
 Site-Painting  | Train Loss: 0.7541 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 0.7642 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.9310 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.6209 | Train Acc: 0.5156
 Site-Real      | Train Loss: 0.3765 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.3761 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.5784 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.6055 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3552 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.3674 | Val  Acc: 0.9554
 Site-Infograph | Val  Loss: 1.7156 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.5281 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.6880 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 0.8927 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.6620 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.6733 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3733 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.2735 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.6753 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.7171 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7383
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9643
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9554
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5122
 Best site-Painting   | Epoch:4 | Val Acc: 0.6842
 Best site-Painting   | Epoch:4 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5000
 Best site-Real       | Epoch:4 | Val Acc: 0.8800
 Best site-Real       | Epoch:4 | Val Acc: 0.9608
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 0.3972 | Train Acc: 0.9286
 Site-Clipart   | Train Loss: 0.3151 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 1.9637 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.5271 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.7278 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.6304 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.7652 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.5473 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.4002 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.3345 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.6464 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.5289 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.3040 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 0.3130 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.4684 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5040 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 0.5559 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.8759 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.4061 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.7238 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3436 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.2762 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.5075 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.5562 | Val  Acc: 0.8913
Average Valid Accuracy: 0.7548
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9464
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5366
 Best site-Painting   | Epoch:5 | Val Acc: 0.7368
 Best site-Painting   | Epoch:5 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4286
 Best site-Real       | Epoch:5 | Val Acc: 0.9200
 Best site-Real       | Epoch:5 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 0.3929 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.2555 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9337 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.5699 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.8233 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.5525 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.8187 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.5412 | Train Acc: 0.4844
 Site-Real      | Train Loss: 0.3295 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.3037 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.5711 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.5599 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.2072 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.2646 | Val  Acc: 0.9554
 Site-Infograph | Val  Loss: 1.4736 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.4649 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.4530 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.7690 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3801 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.5418 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3164 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.2106 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.5522 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.5973 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7707
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9554
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5122
 Best site-Painting   | Epoch:6 | Val Acc: 0.7895
 Best site-Painting   | Epoch:6 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5000
 Best site-Real       | Epoch:6 | Val Acc: 0.9200
 Best site-Real       | Epoch:6 | Val Acc: 0.9608
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 0.3120 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.2268 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.8525 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.5382 | Train Acc: 0.5645
 Site-Painting  | Train Loss: 0.6418 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.6815 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.8822 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.4982 | Train Acc: 0.5312
 Site-Real      | Train Loss: 0.3106 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.2809 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.7139 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.4597 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2110 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.1947 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.4466 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.4445 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 0.5725 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.6776 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4323 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.5219 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2838 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.1577 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.5265 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.5839 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7745
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9643
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4878
 Best site-Painting   | Epoch:7 | Val Acc: 0.7895
 Best site-Painting   | Epoch:7 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5000
 Best site-Real       | Epoch:7 | Val Acc: 0.9600
 Best site-Real       | Epoch:7 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 0.2801 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.2116 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 1.9692 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.4859 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 0.7421 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.5585 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.7651 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.4347 | Train Acc: 0.5469
 Site-Real      | Train Loss: 0.3687 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.2390 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.5339 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.5014 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.1607 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.2002 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.6044 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.4058 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.4640 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.7142 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.5362 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.5186 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2896 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.1632 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.4664 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.5433 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7826
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6585
 Best site-Painting   | Epoch:8 | Val Acc: 0.7895
 Best site-Painting   | Epoch:8 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5000
 Best site-Real       | Epoch:8 | Val Acc: 0.9200
 Best site-Real       | Epoch:8 | Val Acc: 0.9608
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 0.2759 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1828 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8791 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.4373 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.5863 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.4099 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.8048 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.4657 | Train Acc: 0.5156
 Site-Real      | Train Loss: 0.2655 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.1930 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.5489 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.4626 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.1890 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.1488 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.2541 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.3117 | Val  Acc: 0.5854
 Site-Painting  | Val  Loss: 0.4696 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.6456 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.2620 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.6093 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.2435 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.1498 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.4790 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.5086 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7704
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 0.3105 | Train Acc: 0.9286
 Site-Clipart   | Train Loss: 0.1591 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9076 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3707 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.5052 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.3987 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.6975 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.4036 | Train Acc: 0.5312
 Site-Real      | Train Loss: 0.3164 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1870 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 0.4640 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3749 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.1237 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.1403 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.2464 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.3879 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 0.3704 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.6731 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.1483 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.5165 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2494 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.1201 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.4244 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.4495 | Val  Acc: 0.9348
Average Valid Accuracy: 0.7962
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9643
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9821
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5366
 Best site-Painting   | Epoch:10 | Val Acc: 0.7895
 Best site-Painting   | Epoch:10 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.5000
 Best site-Real       | Epoch:10 | Val Acc: 0.9600
 Best site-Real       | Epoch:10 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:10 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 0.2607 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.1319 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8592 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.4032 | Train Acc: 0.6290
 Site-Painting  | Train Loss: 0.5952 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.3954 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.7532 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.3769 | Train Acc: 0.5469
 Site-Real      | Train Loss: 0.3861 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.2043 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 0.2881 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.4151 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0955 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1215 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.2805 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.3514 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.4419 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.6515 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.1419 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.4559 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.1891 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.1166 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.2985 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4198 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8078
 Best site-Clipart    | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:11 | Val Acc: 0.6098
 Best site-Painting   | Epoch:11 | Val Acc: 0.7895
 Best site-Painting   | Epoch:11 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.5000
 Best site-Real       | Epoch:11 | Val Acc: 0.9600
 Best site-Real       | Epoch:11 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:11 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:11 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 0.2139 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.1114 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9722 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3933 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.6532 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.4546 | Train Acc: 0.7931
 Site-QuickDraw | Train Loss: 1.6489 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.2906 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.3177 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1481 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 0.4260 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3548 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0999 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.1268 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.3009 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.4256 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.4175 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.5993 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.0756 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.4466 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.2108 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.1073 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.4471 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3198 | Val  Acc: 0.9348
Average Valid Accuracy: 0.7897
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 0.3062 | Train Acc: 0.9286
 Site-Clipart   | Train Loss: 0.1121 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 2.0358 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.3625 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.5878 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.3856 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.6944 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.3110 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.2868 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1347 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.3140 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.4097 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0888 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1060 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.2317 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.2647 | Val  Acc: 0.5854
 Site-Painting  | Val  Loss: 0.3159 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.5975 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.1906 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.3049 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1933 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.0892 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.2719 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.4227 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8116
 Best site-Clipart    | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5854
 Best site-Painting   | Epoch:13 | Val Acc: 0.7895
 Best site-Painting   | Epoch:13 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.5476
 Best site-Real       | Epoch:13 | Val Acc: 0.9600
 Best site-Real       | Epoch:13 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:13 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:13 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 0.2261 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.1076 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9465 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.3647 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.6896 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 0.4540 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.6030 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.2661 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.2985 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1301 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 0.6111 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.4408 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.0844 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1085 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.2223 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.2374 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.3163 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.5448 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.2292 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.4166 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.1919 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.1019 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3317 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.4038 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8203
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:14 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:14 | Val Acc: 0.6098
 Best site-Painting   | Epoch:14 | Val Acc: 0.7895
 Best site-Painting   | Epoch:14 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.6190
 Best site-Real       | Epoch:14 | Val Acc: 0.9600
 Best site-Real       | Epoch:14 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:14 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:14 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 0.1767 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0933 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9558 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.2516 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.5304 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.3964 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.4942 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.3173 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.2528 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.1133 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 0.3895 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3900 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0760 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0795 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.2797 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.2280 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.3359 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.5286 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3409 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.5038 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.1783 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.0938 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.3666 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.3285 | Val  Acc: 0.8913
Average Valid Accuracy: 0.7827
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 0.2375 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.1008 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8407 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.2493 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.5489 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.3699 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.5208 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.1852 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.2399 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0997 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.3834 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.5013 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.1181 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.0746 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.2652 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.2044 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.4474 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.4783 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 0.9805 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.3268 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1578 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.0760 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3392 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3214 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8195
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 0.1886 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.0695 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9716 | Train Acc: 0.1935
 Site-Infograph | Train Loss: 1.2614 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.5676 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.3501 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.4657 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.1606 | Train Acc: 0.5469
 Site-Real      | Train Loss: 0.2188 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0943 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4953 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.3637 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.1313 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.0777 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.2590 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.2325 | Val  Acc: 0.5854
 Site-Painting  | Val  Loss: 0.3263 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.4143 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0282 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.1590 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1257 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0661 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3491 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.4094 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8140
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 0.1583 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0869 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8418 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.2623 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.5590 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.3874 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.7230 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.2474 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.2436 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0829 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.3330 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2868 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1085 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0767 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.5148 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.1037 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.2951 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.4145 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.0641 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.2831 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.1339 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0760 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2835 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3475 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8284
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:18 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:18 | Val Acc: 0.6341
 Best site-Painting   | Epoch:18 | Val Acc: 0.8421
 Best site-Painting   | Epoch:18 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.6429
 Best site-Real       | Epoch:18 | Val Acc: 1.0000
 Best site-Real       | Epoch:18 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:18 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.1657 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0761 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9929 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.1135 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.5854 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.3140 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.6600 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.1993 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.2338 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0878 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5874 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3129 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0593 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0757 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.0128 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.1455 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.2547 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.5756 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0241 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2088 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.1280 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.0716 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2927 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3547 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8362
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6585
 Best site-Painting   | Epoch:19 | Val Acc: 0.7895
 Best site-Painting   | Epoch:19 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.6667
 Best site-Real       | Epoch:19 | Val Acc: 0.9600
 Best site-Real       | Epoch:19 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:19 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:19 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 0.1543 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.0678 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 1.9677 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.1167 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.4688 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.3203 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.5202 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.1774 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.1701 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0818 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3120 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2589 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0662 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0477 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.0599 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.0704 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.3203 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.5375 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0972 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2767 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1112 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0575 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2693 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2037 | Val  Acc: 0.9783
Average Valid Accuracy: 0.8369
 Best site-Clipart    | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:20 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:20 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:20 | Val Acc: 0.6829
 Best site-Painting   | Epoch:20 | Val Acc: 0.7368
 Best site-Painting   | Epoch:20 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.5714
 Best site-Real       | Epoch:20 | Val Acc: 1.0000
 Best site-Real       | Epoch:20 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:20 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:20 | Val Acc: 0.9783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 0.1162 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.0631 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.7967 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.1803 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.5752 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.3212 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.4009 | Train Acc: 0.5938
 Site-QuickDraw | Train Loss: 1.0715 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.2305 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0917 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2836 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3238 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0477 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0658 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.1447 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.0587 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.2551 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.4257 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.2507 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.2312 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1013 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0629 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2885 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3337 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8306
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.1136 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0466 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8552 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.0563 | Train Acc: 0.7258
 Site-Painting  | Train Loss: 0.6433 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2703 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.4162 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 1.1393 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.1953 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0728 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2799 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2406 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0390 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0507 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.2345 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.1353 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.3038 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.3317 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.1623 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.0908 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0736 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0512 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3409 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.2938 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8434
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:22 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:22 | Val Acc: 0.6829
 Best site-Painting   | Epoch:22 | Val Acc: 0.8421
 Best site-Painting   | Epoch:22 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.6190
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:22 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.1104 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0716 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8323 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.1035 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.6508 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.3043 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.4361 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.0424 | Train Acc: 0.7344
 Site-Real      | Train Loss: 0.2896 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0661 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4080 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3412 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.0279 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0441 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.0371 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.1263 | Val  Acc: 0.7561
 Site-Painting  | Val  Loss: 0.2387 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.3695 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.1081 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.1016 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0587 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0400 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3058 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.2791 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8549
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:23 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:23 | Val Acc: 0.7561
 Best site-Painting   | Epoch:23 | Val Acc: 0.9474
 Best site-Painting   | Epoch:23 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.5952
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.1396 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.0438 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8712 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.1164 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.5144 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2686 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.3418 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 0.9813 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.2866 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0679 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5111 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2981 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0529 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0431 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.1540 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.1141 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.2496 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.3690 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.0097 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.1183 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.0618 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0483 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2539 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2370 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8465
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.1193 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.0605 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9230 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 0.9993 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.4577 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2482 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.4973 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.0251 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.1826 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0402 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7036 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.2514 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0455 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0526 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.1344 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.0020 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.2046 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.3617 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 0.9277 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.1844 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0649 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0374 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2639 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.2587 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8395
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.1571 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0462 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9615 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.1127 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5365 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.2405 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.4143 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 1.0530 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.1929 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0574 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2997 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2198 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0451 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0518 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.0407 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.0507 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.2773 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.3392 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.1436 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.1633 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0631 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0375 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1958 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3225 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8454
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.1129 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0431 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9326 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.0626 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5156 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.2408 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.3930 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.0160 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.3324 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0497 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3356 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.1954 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0182 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0487 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.0458 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.0252 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.2909 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.3702 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 0.9484 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.0252 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.0564 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0296 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2226 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2256 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8772
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:27 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7073
 Best site-Painting   | Epoch:27 | Val Acc: 0.8421
 Best site-Painting   | Epoch:27 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.6905
 Best site-Real       | Epoch:27 | Val Acc: 1.0000
 Best site-Real       | Epoch:27 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:27 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:27 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.0846 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0415 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9155 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.0576 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5346 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2391 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.5997 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.0280 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.2215 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0420 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5468 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2184 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0988 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0500 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.0722 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 0.9371 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.2002 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.2930 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 0.9112 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 0.9717 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.0497 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0311 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2104 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2737 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8595
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.1324 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0309 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8175 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.0301 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.5068 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.2447 | Train Acc: 0.9483
 Site-QuickDraw | Train Loss: 1.3679 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 0.9468 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.1831 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0542 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.2653 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.1965 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0345 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0364 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 0.8654 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 0.9846 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.2487 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.3140 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 0.9627 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.1269 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0541 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0305 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2097 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.1867 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8576
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.0939 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0445 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8591 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.0867 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.4609 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.1558 | Train Acc: 0.9655
 Site-QuickDraw | Train Loss: 1.4145 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 0.9381 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.3263 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0400 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2308 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2382 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0343 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.0803 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.0593 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.2198 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.3509 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 0.9453 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 0.8957 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.0341 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1738 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.1873 | Val  Acc: 0.9783
Average Valid Accuracy: 0.8734
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.0556 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0311 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8151 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 0.9734 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.4561 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2684 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.4292 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 0.9869 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.1951 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0510 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2656 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.1825 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0202 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.0578 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.0059 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.2357 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.2952 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 0.8331 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.0386 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0607 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0291 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2349 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2442 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8538
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.0735 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0398 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7874 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 0.9153 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.6261 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2503 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.5158 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.0460 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.1754 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0326 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3772 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.2438 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0282 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0304 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.0532 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 0.9129 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.2998 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.3339 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 0.8870 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.0973 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0374 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0325 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2226 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2172 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8602
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.0644 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0369 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9866 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 0.9890 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.5966 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2529 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.2999 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.0037 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.2369 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0530 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2401 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2136 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0186 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0252 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.0437 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 0.9098 | Val  Acc: 0.7317
 Site-Painting  | Val  Loss: 0.1807 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.2764 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 0.9830 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.9975 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0636 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2158 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2921 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8699
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.0565 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0326 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8480 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 0.9405 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.4990 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.2493 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.2905 | Train Acc: 0.5938
 Site-QuickDraw | Train Loss: 0.9988 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.1977 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0330 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2829 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.1755 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0185 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0254 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.9281 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 0.8622 | Val  Acc: 0.7317
 Site-Painting  | Val  Loss: 0.2703 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.2879 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 0.8452 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.8897 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.0464 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1975 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2325 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8700
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.0631 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0429 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8891 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 0.9526 | Train Acc: 0.7581
 Site-Painting  | Train Loss: 0.4874 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.1737 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.4799 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 0.9908 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.1662 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0378 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.1882 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.2393 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0219 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0207 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.1164 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 0.9332 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.2204 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.3112 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 0.8102 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 0.9133 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.0350 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0317 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1747 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.2392 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8568
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.0743 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0292 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9573 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 0.8949 | Train Acc: 0.7258
 Site-Painting  | Train Loss: 0.4509 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.1545 | Train Acc: 0.9828
 Site-QuickDraw | Train Loss: 1.3848 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 0.9384 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.1983 | Train Acc: 0.9737
 Site-Real      | Train Loss: 0.0381 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2847 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.1942 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0203 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8118 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 0.9817 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.1934 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.3446 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 0.8974 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.0002 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.0447 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0235 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2513 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.1978 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8954
 Best site-Clipart    | Epoch:36 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:36 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:36 | Val Acc: 0.8000
 Best site-Infograph  | Epoch:36 | Val Acc: 0.6829
 Best site-Painting   | Epoch:36 | Val Acc: 0.9474
 Best site-Painting   | Epoch:36 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.6905
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:36 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:36 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.0579 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0319 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 2.0583 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 0.9008 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.4522 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.1912 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.2894 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.0526 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.1565 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0442 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2444 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.1492 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0233 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.9966 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 0.9194 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.1379 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.2235 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 0.6806 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.9437 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0216 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1093 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1908 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8946
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.0794 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0244 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9267 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 0.8894 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.5001 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.1595 | Train Acc: 0.9483
 Site-QuickDraw | Train Loss: 1.4951 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.0057 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.1367 | Train Acc: 0.9737
 Site-Real      | Train Loss: 0.0319 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2164 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.1556 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0205 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.2543 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 0.9557 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.1577 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.3655 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 0.8546 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.9748 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.0507 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2448 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.2065 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8674
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.0669 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0229 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8803 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 0.8011 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.5455 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.1835 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.1547 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 0.9766 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.1902 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0259 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2282 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.2055 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0183 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.2225 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 0.9142 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.2527 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.3198 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 0.8678 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 0.9312 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0277 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1862 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2576 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8682
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.0587 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0351 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9564 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 0.8988 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.4140 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.1704 | Train Acc: 0.9655
 Site-QuickDraw | Train Loss: 1.3439 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 0.8920 | Train Acc: 0.7031
 Site-Real      | Train Loss: 0.1423 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0368 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.1983 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.1183 | Train Acc: 0.9857
 Site-Clipart   | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0283 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.0612 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 0.9859 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.2138 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3052 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 0.8144 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 0.8998 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.0468 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0179 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1466 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.1746 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8668
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.0868 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0253 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8200 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 0.9451 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.5035 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.1896 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.6383 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 0.9878 | Train Acc: 0.7031
 Site-Real      | Train Loss: 0.1412 | Train Acc: 0.9737
 Site-Real      | Train Loss: 0.0379 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3487 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.2457 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0245 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8427 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 0.9292 | Val  Acc: 0.7317
 Site-Painting  | Val  Loss: 0.2181 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.2274 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.9593 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.0430 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0249 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0329 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1790 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.1781 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8568
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.0752 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0278 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8306 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 0.9152 | Train Acc: 0.7581
 Site-Painting  | Train Loss: 0.4421 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.1581 | Train Acc: 0.9655
 Site-QuickDraw | Train Loss: 1.3612 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 0.8151 | Train Acc: 0.7656
 Site-Real      | Train Loss: 0.1806 | Train Acc: 0.9737
 Site-Real      | Train Loss: 0.0321 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2976 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.1602 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0186 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.9750 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 0.8860 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.2014 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.2394 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 0.9629 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 0.9123 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.0243 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1667 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.1980 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8783
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.0459 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0302 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9395 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 0.9067 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.4497 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.2400 | Train Acc: 0.9655
 Site-QuickDraw | Train Loss: 1.3773 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 0.9443 | Train Acc: 0.7031
 Site-Real      | Train Loss: 0.1442 | Train Acc: 0.9737
 Site-Real      | Train Loss: 0.0383 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2615 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.1837 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0234 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 0.8868 | Val  Acc: 0.8500
 Site-Infograph | Val  Loss: 0.9584 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.1500 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2887 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 0.8568 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.0909 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0261 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1682 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.1808 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8955
 Best site-Clipart    | Epoch:43 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:43 | Val Acc: 0.8500
 Best site-Infograph  | Epoch:43 | Val Acc: 0.7073
 Best site-Painting   | Epoch:43 | Val Acc: 1.0000
 Best site-Painting   | Epoch:43 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:43 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:43 | Val Acc: 0.5952
 Best site-Real       | Epoch:43 | Val Acc: 1.0000
 Best site-Real       | Epoch:43 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:43 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:43 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.0564 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0294 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7937 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 0.8739 | Train Acc: 0.7581
 Site-Painting  | Train Loss: 0.4915 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.1550 | Train Acc: 0.9828
 Site-QuickDraw | Train Loss: 1.3211 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 0.9220 | Train Acc: 0.7031
 Site-Real      | Train Loss: 0.2000 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0196 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2728 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.1501 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0165 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7800 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 0.8473 | Val  Acc: 0.7317
 Site-Painting  | Val  Loss: 0.1699 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.2378 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 0.9026 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.9600 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.0293 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1747 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2176 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8811
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.0469 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0195 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 2.1143 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 0.8635 | Train Acc: 0.7258
 Site-Painting  | Train Loss: 0.3630 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.1948 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.3253 | Train Acc: 0.5938
 Site-QuickDraw | Train Loss: 0.8281 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.3179 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0399 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5004 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.1990 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0194 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0286 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8867 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 0.9667 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.1394 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2099 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 0.8877 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 0.9622 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.0169 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1828 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1549 | Val  Acc: 0.9783
Average Valid Accuracy: 0.8909
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.0674 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0251 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.7571 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 0.8606 | Train Acc: 0.7903
 Site-Painting  | Train Loss: 0.3727 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.1971 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.0999 | Train Acc: 0.7188
 Site-QuickDraw | Train Loss: 0.8972 | Train Acc: 0.7656
 Site-Real      | Train Loss: 0.1886 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0314 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4265 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.1327 | Train Acc: 0.9857
 Site-Clipart   | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0174 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.0299 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 0.8882 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.1401 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.2050 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 0.8098 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 0.8523 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2017 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2134 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8792
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.0333 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0195 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.7941 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 0.8875 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.3413 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.1603 | Train Acc: 0.9655
 Site-QuickDraw | Train Loss: 1.2453 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 0.9189 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.2094 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0197 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2291 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2051 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0274 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.1002 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 0.9128 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.1215 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2708 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 0.8318 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 0.8536 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.0276 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1002 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1685 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8860
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.0379 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0192 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.7717 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 0.9125 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.5844 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.1812 | Train Acc: 0.9828
 Site-QuickDraw | Train Loss: 1.2885 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 0.8639 | Train Acc: 0.7031
 Site-Real      | Train Loss: 0.1619 | Train Acc: 0.9737
 Site-Real      | Train Loss: 0.0338 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4555 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.1556 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7392 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 0.8532 | Val  Acc: 0.7805
 Site-Painting  | Val  Loss: 0.1820 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.2737 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 0.9779 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 0.9100 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.0281 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0268 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1995 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.1774 | Val  Acc: 0.9783
Average Valid Accuracy: 0.8977
 Best site-Clipart    | Epoch:48 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:48 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:48 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:48 | Val Acc: 0.7805
 Best site-Painting   | Epoch:48 | Val Acc: 0.9474
 Best site-Painting   | Epoch:48 | Val Acc: 0.9744
 Best site-QuickDraw  | Epoch:48 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:48 | Val Acc: 0.7143
 Best site-Real       | Epoch:48 | Val Acc: 1.0000
 Best site-Real       | Epoch:48 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:48 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:48 | Val Acc: 0.9783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.0658 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0223 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8906 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 0.8813 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.5182 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.1718 | Train Acc: 0.9655
 Site-QuickDraw | Train Loss: 1.3216 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 0.8656 | Train Acc: 0.7656
 Site-Real      | Train Loss: 0.2547 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0292 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2346 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.1734 | Train Acc: 0.9857
 Site-Clipart   | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.9840 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 0.9055 | Val  Acc: 0.7317
 Site-Painting  | Val  Loss: 0.1765 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.2192 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 0.7969 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 0.8891 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1334 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.0996 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8922
===2023-04-23 01:45:46===
===2023-04-23 01:45:47===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:48 | Test Acc: 0.9087
 Test site-Infograph | Epoch:48 | Test Acc: 0.5190
 Test site-Painting  | Epoch:48 | Test Acc: 0.8982
 Test site-QuickDraw | Epoch:48 | Test Acc: 0.5920
 Test site-Real      | Epoch:48 | Test Acc: 0.9507
 Test site-Sketch    | Epoch:48 | Test Acc: 0.8845
Average Test Accuracy: 0.7922
===2023-04-23 12:08:41===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 1.4670 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.4821 | Train Acc: 0.8274
 Site-Infograph | Train Loss: 2.0953 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1017 | Train Acc: 0.2742
 Site-Painting  | Train Loss: 1.6545 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.6454 | Train Acc: 0.7414
 Site-QuickDraw | Train Loss: 2.1443 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.1202 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.5374 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.4727 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.5508 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.6020 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.4880 | Val  Acc: 0.8214
 Site-Clipart   | Val  Loss: 1.4650 | Val  Acc: 0.8482
 Site-Infograph | Val  Loss: 2.0934 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0555 | Val  Acc: 0.3659
 Site-Painting  | Val  Loss: 1.6634 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.7515 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0277 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1137 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.4849 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.4644 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.5105 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.6212 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6471
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8214
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8482
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3659
 Best site-Painting   | Epoch:0 | Val Acc: 0.6842
 Best site-Painting   | Epoch:0 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.3095
 Best site-Real       | Epoch:0 | Val Acc: 0.9600
 Best site-Real       | Epoch:0 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:0 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:0 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 0.9991 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 1.0163 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.9784 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.8622 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.2230 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.1182 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 2.0335 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.9227 | Train Acc: 0.4688
 Site-Real      | Train Loss: 1.0368 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.9252 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.2443 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.1900 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.8925 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.9452 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 1.8097 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.8804 | Val  Acc: 0.4146
 Site-Painting  | Val  Loss: 1.1289 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.3505 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 1.9216 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.9471 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.9400 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.8401 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 1.0972 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.1986 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6896
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9375
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4146
 Best site-Painting   | Epoch:1 | Val Acc: 0.5789
 Best site-Painting   | Epoch:1 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4762
 Best site-Real       | Epoch:1 | Val Acc: 0.9200
 Best site-Real       | Epoch:1 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 0.8238 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 0.6746 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.9746 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7680 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.9634 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.9177 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 2.0843 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 1.8572 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.6990 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6552 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 1.0926 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.9355 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.6533 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6576 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 1.7264 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.8376 | Val  Acc: 0.3902
 Site-Painting  | Val  Loss: 0.7718 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.0494 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.7678 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.8496 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6334 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.5756 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.8797 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.9713 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7113
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9375
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3902
 Best site-Painting   | Epoch:2 | Val Acc: 0.7368
 Best site-Painting   | Epoch:2 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3810
 Best site-Real       | Epoch:2 | Val Acc: 0.9600
 Best site-Real       | Epoch:2 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:2 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 0.6819 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.5138 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 1.8961 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.6723 | Train Acc: 0.4355
 Site-Painting  | Train Loss: 0.9173 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.7084 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 2.0017 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.7421 | Train Acc: 0.5312
 Site-Real      | Train Loss: 0.6419 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.4883 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.7664 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.8168 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.4780 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.5076 | Val  Acc: 0.9554
 Site-Infograph | Val  Loss: 1.6093 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6750 | Val  Acc: 0.4390
 Site-Painting  | Val  Loss: 0.7748 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 0.9909 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.7695 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.8724 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.4879 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.4082 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.7257 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.8469 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7216
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9554
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4390
 Best site-Painting   | Epoch:3 | Val Acc: 0.6316
 Best site-Painting   | Epoch:3 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4762
 Best site-Real       | Epoch:3 | Val Acc: 0.8800
 Best site-Real       | Epoch:3 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 0.6630 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.4327 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.9547 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6662 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.8458 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 0.7442 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 2.0023 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.6624 | Train Acc: 0.4844
 Site-Real      | Train Loss: 0.4398 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.3972 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.6731 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.6027 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.4587 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4130 | Val  Acc: 0.9554
 Site-Infograph | Val  Loss: 1.6478 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.6266 | Val  Acc: 0.4390
 Site-Painting  | Val  Loss: 0.6306 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 0.8671 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7595 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.7768 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3776 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2919 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6844 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.7075 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7364
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9554
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4390
 Best site-Painting   | Epoch:4 | Val Acc: 0.6842
 Best site-Painting   | Epoch:4 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5000
 Best site-Real       | Epoch:4 | Val Acc: 1.0000
 Best site-Real       | Epoch:4 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 0.4137 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.3827 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.8391 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6006 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.7639 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.7331 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.9830 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.6541 | Train Acc: 0.4844
 Site-Real      | Train Loss: 0.5105 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.3381 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.7548 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.6156 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3139 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.3486 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.4013 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.5490 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.5702 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.8845 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.6045 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.7762 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3353 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.2327 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.6785 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.6551 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7586
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9643
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9643
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4634
 Best site-Painting   | Epoch:5 | Val Acc: 0.7895
 Best site-Painting   | Epoch:5 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4286
 Best site-Real       | Epoch:5 | Val Acc: 0.9600
 Best site-Real       | Epoch:5 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 0.4421 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.3151 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8482 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.5508 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 0.7754 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.6052 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.9167 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.5897 | Train Acc: 0.5469
 Site-Real      | Train Loss: 0.3752 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.3018 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 0.6008 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.6057 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.3101 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.2683 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.3286 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.4377 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 0.5710 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 0.8256 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.5876 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.7133 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.2462 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1764 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5955 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.7588 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7776
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9643
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4878
 Best site-Painting   | Epoch:6 | Val Acc: 0.6842
 Best site-Painting   | Epoch:6 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 0.3527 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2802 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.9084 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5207 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.6311 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.6598 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.8611 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.5752 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.3428 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.2732 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.5351 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.6803 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.2145 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.2495 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.4415 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 1.4567 | Val  Acc: 0.4146
 Site-Painting  | Val  Loss: 0.4952 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.6268 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4939 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.6371 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2522 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.1690 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5880 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.6121 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7603
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 0.3104 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.2370 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9389 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.4051 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.7636 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.5258 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.9517 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 1.4935 | Train Acc: 0.5312
 Site-Real      | Train Loss: 0.2907 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.2308 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.5425 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.5615 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2036 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.2341 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.5668 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.4687 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.5812 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.7147 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.4968 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.6177 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2105 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.1688 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.5308 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.6222 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7635
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 0.3316 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.2058 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9171 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.4673 | Train Acc: 0.4677
 Site-Painting  | Train Loss: 0.7283 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.4688 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.8303 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.5725 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.3553 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1966 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.6770 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.4945 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1883 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.1900 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.4409 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.4124 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.3662 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.7125 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.2744 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.6852 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2043 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1423 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.5432 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.5664 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7752
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 0.2616 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.2034 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 1.9496 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.3556 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.6796 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.4434 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.9112 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.5118 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.2490 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1956 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.7474 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.4644 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.1988 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2093 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.2599 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.3359 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 0.3836 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.5688 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3980 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.6226 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.1888 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1305 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4851 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.6505 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7833
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:10 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5366
 Best site-Painting   | Epoch:10 | Val Acc: 0.7895
 Best site-Painting   | Epoch:10 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.4524
 Best site-Real       | Epoch:10 | Val Acc: 1.0000
 Best site-Real       | Epoch:10 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 0.2862 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.1877 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9249 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.3533 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.7170 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 0.5453 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.7001 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.5208 | Train Acc: 0.4844
 Site-Real      | Train Loss: 0.2534 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1479 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4379 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.4870 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.1436 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.1716 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.3733 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.3939 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.3686 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.6772 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.4253 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.6672 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.1980 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1353 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.4762 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.5302 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7784
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 0.1915 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.1552 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9964 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.3864 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 0.7483 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.4411 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.8593 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.4104 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.3638 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1575 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4411 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.5318 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.1945 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.1421 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.3776 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.3677 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.4482 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.6900 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.4292 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.5360 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2021 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1105 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5026 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.4635 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7752
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 0.2427 | Train Acc: 0.9286
 Site-Clipart   | Train Loss: 0.1459 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9182 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3655 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.8330 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.3530 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.7041 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.4495 | Train Acc: 0.5312
 Site-Real      | Train Loss: 0.2898 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1413 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6085 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 0.4263 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1244 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.1474 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.5517 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.2863 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.4129 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.6372 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.5073 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.6250 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.1709 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0830 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3885 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.4886 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7802
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 0.2641 | Train Acc: 0.9286
 Site-Clipart   | Train Loss: 0.1393 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9002 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3748 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.6605 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.3665 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.8520 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.4197 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.2886 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1315 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4288 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 0.3915 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.1174 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.1323 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.4143 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.3089 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.3408 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.5966 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4577 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.5564 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.1376 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0844 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4909 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.5051 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7879
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:14 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:14 | Val Acc: 0.6098
 Best site-Painting   | Epoch:14 | Val Acc: 0.8421
 Best site-Painting   | Epoch:14 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.5000
 Best site-Real       | Epoch:14 | Val Acc: 1.0000
 Best site-Real       | Epoch:14 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:14 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:14 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 0.2254 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.1424 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8811 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.2393 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.6367 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.4575 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.8379 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.2612 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.3318 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1060 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4516 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 0.3484 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1589 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.1286 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.1299 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.2153 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.4597 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.4964 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.3696 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.5916 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.1323 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0957 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4312 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.5605 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7905
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9643
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5610
 Best site-Painting   | Epoch:15 | Val Acc: 0.8421
 Best site-Painting   | Epoch:15 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.4762
 Best site-Real       | Epoch:15 | Val Acc: 1.0000
 Best site-Real       | Epoch:15 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:15 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:15 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 0.1975 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1358 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9165 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.2815 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.5970 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.3505 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.8467 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.3619 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.2276 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1170 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3963 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.5482 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1464 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.1305 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.2053 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.2566 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.3151 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.5403 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.2323 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.5414 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1113 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0801 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4763 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.4710 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8004
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9821
 Best site-Infograph  | Epoch:16 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:16 | Val Acc: 0.6098
 Best site-Painting   | Epoch:16 | Val Acc: 0.7895
 Best site-Painting   | Epoch:16 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.5476
 Best site-Real       | Epoch:16 | Val Acc: 1.0000
 Best site-Real       | Epoch:16 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 0.2017 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1113 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8313 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.2374 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.6761 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.3915 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.6983 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.4254 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.2570 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1362 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6263 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.5624 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1322 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.1290 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.3237 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.2774 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.3717 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.5211 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.1829 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.4559 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1259 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.0867 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4295 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.4830 | Val  Acc: 0.8043
Average Valid Accuracy: 0.8010
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9643
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6098
 Best site-Painting   | Epoch:17 | Val Acc: 0.8421
 Best site-Painting   | Epoch:17 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.5238
 Best site-Real       | Epoch:17 | Val Acc: 0.9600
 Best site-Real       | Epoch:17 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:17 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:17 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 0.1729 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.0935 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8988 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.2315 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.7389 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.3400 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.7403 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.3648 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.2490 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1150 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.3267 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.3782 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.1305 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0767 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.1678 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.2136 | Val  Acc: 0.5854
 Site-Painting  | Val  Loss: 0.3194 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.5235 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.4470 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.5578 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.1343 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0687 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4140 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4489 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8184
 Best site-Clipart    | Epoch:18 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:18 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:18 | Val Acc: 0.5854
 Best site-Painting   | Epoch:18 | Val Acc: 0.8421
 Best site-Painting   | Epoch:18 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.5000
 Best site-Real       | Epoch:18 | Val Acc: 1.0000
 Best site-Real       | Epoch:18 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:18 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.1656 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.0956 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9158 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.2413 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.6082 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.2971 | Train Acc: 0.9483
 Site-QuickDraw | Train Loss: 1.6392 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.1884 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.3283 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1010 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7113 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.4683 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.1249 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0982 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.2189 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.2233 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.4389 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.5909 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.4521 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.4017 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1249 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0710 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4132 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.4667 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7825
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 0.1522 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.0874 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 2.0053 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.2060 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.5066 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.3878 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.6881 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.3411 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.1999 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.1021 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.7028 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.4208 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.1423 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.0915 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.2730 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.1944 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.3644 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.4548 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.4327 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.5385 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1256 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0548 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3767 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.4406 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8023
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 0.1995 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.0903 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.8608 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.2687 | Train Acc: 0.5645
 Site-Painting  | Train Loss: 0.5586 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.4005 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.4697 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.3023 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.3020 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0840 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2906 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3608 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.1423 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 0.0827 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.1920 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.2481 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.4101 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.5620 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4395 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.4476 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.1251 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0630 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3295 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4427 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8049
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.1300 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.0953 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 1.9910 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.0576 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.6400 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.3389 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.6529 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.3259 | Train Acc: 0.5469
 Site-Real      | Train Loss: 0.2648 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0817 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3231 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.4410 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0822 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0979 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 0.9550 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.1362 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.3189 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.4456 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.3841 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.4615 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.0910 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0639 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3967 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.4140 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8194
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:22 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:22 | Val Acc: 0.6829
 Best site-Painting   | Epoch:22 | Val Acc: 0.7895
 Best site-Painting   | Epoch:22 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.5714
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:22 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.1495 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.0891 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 2.0439 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.1543 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.6917 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.3078 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.7607 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.2139 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.1908 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0790 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2948 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.3112 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.0725 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0858 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.1206 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.0350 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.3509 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.3837 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.5460 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.3909 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.0883 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0479 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3524 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.4123 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8081
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.1235 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.0698 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 2.0569 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.1542 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.5381 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.3612 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.6621 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.2305 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.2933 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0667 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3404 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3755 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.0653 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0678 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.0715 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.1206 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.2541 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.4493 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.4306 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.3628 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.0786 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0548 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3999 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.3989 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8158
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.1510 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.0786 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9800 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.1274 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.6187 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 0.3151 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.6708 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.2864 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.2269 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0583 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4651 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.3226 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.0633 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0810 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.1570 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.0946 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.1931 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.4285 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.1464 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.4143 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0762 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0502 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3276 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3200 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8370
 Best site-Clipart    | Epoch:25 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:25 | Val Acc: 0.9821
 Best site-Infograph  | Epoch:25 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:25 | Val Acc: 0.6341
 Best site-Painting   | Epoch:25 | Val Acc: 0.9474
 Best site-Painting   | Epoch:25 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:25 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:25 | Val Acc: 0.5952
 Best site-Real       | Epoch:25 | Val Acc: 1.0000
 Best site-Real       | Epoch:25 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:25 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:25 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.1237 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0712 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9201 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.1331 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.5914 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.2901 | Train Acc: 0.9483
 Site-QuickDraw | Train Loss: 1.7545 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.2482 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.2676 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0501 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4324 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.3983 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.0566 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0600 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 0.9380 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.1002 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.2514 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.4017 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.2270 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.3586 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0889 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0591 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3336 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3681 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8101
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.1654 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.0636 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9813 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.1630 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.6196 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2977 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.5292 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.2660 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.2097 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0752 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4151 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2688 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0700 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0701 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.3602 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.1438 | Val  Acc: 0.5854
 Site-Painting  | Val  Loss: 0.3169 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.4330 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.3092 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.3024 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.0756 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0544 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.3904 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3407 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8000
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.1054 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0515 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.8874 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.1849 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.5383 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2959 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.6821 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.2331 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.3273 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0581 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6341 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.2709 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.0456 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0487 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.1998 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.0118 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.3129 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.4508 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5059 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.4195 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0868 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0420 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3623 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.4676 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8322
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.1368 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.0759 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 2.0754 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.1620 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.5769 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.4071 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.5532 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.2079 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.2602 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0672 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.9232 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3356 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0383 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0501 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.0043 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.0488 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.4102 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 0.4045 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.3744 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.2683 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.0630 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0540 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3865 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.4064 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8176
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.1238 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0615 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9015 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.1443 | Train Acc: 0.6290
 Site-Painting  | Train Loss: 0.6189 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2146 | Train Acc: 0.9483
 Site-QuickDraw | Train Loss: 1.5011 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.1225 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.1933 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0517 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4958 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.3997 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0375 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0587 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.2430 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.1179 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.3081 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.4098 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.3198 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.2255 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.1037 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0473 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3660 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.3626 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8238
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.0948 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0523 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0701 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.0914 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.5634 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.3610 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.5288 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.1487 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.1568 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0558 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2692 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3475 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0457 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0525 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.2660 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.0058 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.2127 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.4053 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.3024 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.3546 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0701 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3319 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3184 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8324
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.1409 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.0655 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9486 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.0058 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.5836 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.2326 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.3439 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.2196 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.1750 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0493 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5657 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2536 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0860 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0509 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.1077 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.0143 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.2690 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.2945 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.0844 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.1789 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0522 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0614 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3972 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.3286 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8370
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.0978 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0603 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0892 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 0.9200 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.5287 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.2697 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.5753 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.1944 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.1752 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0554 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5327 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3338 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.0683 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0693 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 0.9716 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.0975 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.3185 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.3756 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.2758 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.2855 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0902 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0371 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3319 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.3346 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8289
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.0789 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0437 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9752 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.0807 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.6299 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.3669 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.5649 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.1103 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.1937 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0508 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5125 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2550 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0406 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0477 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.2471 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.0066 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.3497 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.4269 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.4197 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.2305 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.0532 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0314 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3199 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.4056 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8174
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.0823 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0484 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9275 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.0420 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.5086 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.3189 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.4509 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.1409 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.1730 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0388 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3584 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2967 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0429 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0324 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.2304 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.0381 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.3808 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 0.3972 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.1084 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.3256 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0722 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3384 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3093 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8261
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.0822 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0606 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9122 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 0.9958 | Train Acc: 0.7258
 Site-Painting  | Train Loss: 0.5808 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2444 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.3939 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 1.1836 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.1820 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0404 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7815 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2866 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0331 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0414 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 0.8885 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 0.9232 | Val  Acc: 0.7317
 Site-Painting  | Val  Loss: 0.2592 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.3091 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.1957 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.2694 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0673 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0269 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3167 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.2959 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8558
 Best site-Clipart    | Epoch:36 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:36 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:36 | Val Acc: 0.7317
 Best site-Painting   | Epoch:36 | Val Acc: 0.8947
 Best site-Painting   | Epoch:36 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.6429
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:36 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:36 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.0891 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0491 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.1043 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.0149 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.5136 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.2483 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.6553 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.1807 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.1933 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0406 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.8176 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2827 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0389 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0373 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 0.9628 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.0072 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.2372 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.2963 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.4881 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.3682 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0749 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0356 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3321 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.2619 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8376
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.0863 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0562 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9865 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.0434 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.6834 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.1875 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.6219 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.1064 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.3149 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0464 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2587 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3763 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0461 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 0.9087 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 0.9344 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.2474 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.3766 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.2444 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.3674 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0347 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0358 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2122 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2959 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8480
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.0960 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0352 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9876 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 0.9609 | Train Acc: 0.7258
 Site-Painting  | Train Loss: 0.4251 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.2520 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.3346 | Train Acc: 0.5938
 Site-QuickDraw | Train Loss: 1.0861 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.2055 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0424 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3346 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3103 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.0226 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0503 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 0.8841 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.0476 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.2637 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.3765 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.1298 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.1572 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0710 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0231 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2171 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3846 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8356
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.1117 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.0617 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0005 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.0086 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.4715 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.2254 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.4150 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 1.0467 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.2003 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0461 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6945 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.2871 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8825 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 0.8873 | Val  Acc: 0.7561
 Site-Painting  | Val  Loss: 0.1358 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2714 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.1477 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.3403 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0441 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0451 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2673 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2793 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8706
 Best site-Clipart    | Epoch:40 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:40 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:40 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:40 | Val Acc: 0.7561
 Best site-Painting   | Epoch:40 | Val Acc: 1.0000
 Best site-Painting   | Epoch:40 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:40 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:40 | Val Acc: 0.6190
 Best site-Real       | Epoch:40 | Val Acc: 1.0000
 Best site-Real       | Epoch:40 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:40 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:40 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.0731 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0498 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8671 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 0.9404 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.5395 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2560 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.5535 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.1740 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.1879 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0392 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2954 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2769 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0309 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0442 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.1420 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 0.8979 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.1771 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.3040 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.2536 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.2268 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.0512 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0420 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3460 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.3464 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8459
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.0758 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0340 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.6943 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 0.9141 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.4993 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.2294 | Train Acc: 0.9483
 Site-QuickDraw | Train Loss: 1.6490 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 0.9550 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.1545 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0347 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4257 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2680 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0579 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0403 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.0814 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.0574 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.2059 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.3843 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.0727 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.2532 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0729 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2915 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3020 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8490
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.0890 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0415 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8350 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 0.8917 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.6369 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.2220 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.2441 | Train Acc: 0.6562
 Site-QuickDraw | Train Loss: 1.1071 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.2058 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0371 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6093 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2335 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0258 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0310 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.9203 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 1.0078 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.2179 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.3531 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.2123 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.2265 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0530 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2546 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3490 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8506
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.0748 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0520 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0851 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 0.9512 | Train Acc: 0.7258
 Site-Painting  | Train Loss: 0.4995 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.2274 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.4967 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.1002 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.1590 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0380 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2934 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2605 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.9244 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 0.9787 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.1412 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3238 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.2478 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2824 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0837 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3090 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3326 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8619
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.0997 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0477 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9818 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 0.9463 | Train Acc: 0.7258
 Site-Painting  | Train Loss: 0.5697 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.2289 | Train Acc: 0.9655
 Site-QuickDraw | Train Loss: 1.4781 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.1152 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.3103 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0386 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3639 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2373 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0486 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.0527 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.2486 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 0.8755 | Val  Acc: 0.7317
 Site-Painting  | Val  Loss: 0.2170 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.2383 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.1519 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.3023 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0578 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0277 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2773 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.2727 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8555
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.0734 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0418 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0875 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 0.9295 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.5221 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.2248 | Train Acc: 0.9483
 Site-QuickDraw | Train Loss: 1.4683 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.1217 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.2054 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0459 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.2641 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2114 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0205 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0459 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 0.8818 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 0.9264 | Val  Acc: 0.7317
 Site-Painting  | Val  Loss: 0.2361 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.2533 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.3186 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.3198 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.0562 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2365 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3240 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8640
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.0766 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.0366 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9821 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 0.9261 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.5292 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.2375 | Train Acc: 0.9483
 Site-QuickDraw | Train Loss: 1.5090 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.1251 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.1874 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0345 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3052 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2484 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0312 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0261 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 1.3140 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 0.9079 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.2259 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.3848 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.0667 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.1852 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0581 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0278 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1872 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2393 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8568
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.1504 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.0313 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 2.0389 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 0.8878 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.6460 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.1381 | Train Acc: 0.9655
 Site-QuickDraw | Train Loss: 1.4718 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.1061 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.1572 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.0239 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3083 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.2913 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0201 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0302 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7603 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 0.9281 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.1822 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.2238 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.1587 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2042 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0586 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0202 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2430 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2620 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8771
 Best site-Clipart    | Epoch:48 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:48 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:48 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:48 | Val Acc: 0.6829
 Best site-Painting   | Epoch:48 | Val Acc: 0.8947
 Best site-Painting   | Epoch:48 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:48 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:48 | Val Acc: 0.6429
 Best site-Real       | Epoch:48 | Val Acc: 1.0000
 Best site-Real       | Epoch:48 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:48 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:48 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.0951 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0335 | Train Acc: 0.9940
 Site-Infograph | Train Loss: 1.9604 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 0.9129 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.4044 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.1945 | Train Acc: 0.9655
 Site-QuickDraw | Train Loss: 1.5159 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.0759 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.4747 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.0371 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3166 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2095 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0195 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0230 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8157 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 0.9651 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.1986 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.2031 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.2100 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2846 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0424 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0180 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2670 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3051 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8597
===2023-04-23 12:57:38===
===2023-04-23 12:57:39===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:48 | Test Acc: 0.8954
 Test site-Infograph | Epoch:48 | Test Acc: 0.5114
 Test site-Painting  | Epoch:48 | Test Acc: 0.8853
 Test site-QuickDraw | Epoch:48 | Test Acc: 0.5530
 Test site-Real      | Epoch:48 | Test Acc: 0.9491
 Test site-Sketch    | Epoch:48 | Test Acc: 0.8574
Average Test Accuracy: 0.7753
===2023-04-23 19:13:10===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: True
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
===2023-04-23 19:13:18===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
===2023-04-23 19:14:20===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: True
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
===2023-04-23 19:14:28===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:48 | Test Acc: 0.8954
 Test site-Infograph | Epoch:48 | Test Acc: 0.5114
===2023-04-23 19:15:46===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: True
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
===2023-04-23 19:16:56===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: True
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
===2023-04-23 19:17:24===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: True
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 2.2805 | Train Acc: 0.1310
 Site-Clipart   | Train Loss: 2.2803 | Train Acc: 0.1548
 Site-Infograph | Train Loss: 2.2931 | Train Acc: 0.1935
 Site-Infograph | Train Loss: 2.3130 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2805 | Train Acc: 0.1724
 Site-Painting  | Train Loss: 2.2741 | Train Acc: 0.1379
 Site-QuickDraw | Train Loss: 2.3031 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.2811 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.2914 | Train Acc: 0.1316
 Site-Real      | Train Loss: 2.2626 | Train Acc: 0.2338
 Site-Sketch    | Train Loss: 2.3036 | Train Acc: 0.1429
 Site-Sketch    | Train Loss: 2.2759 | Train Acc: 0.1857
 Site-Clipart   | Val  Loss: 2.2817 | Val  Acc: 0.1071
 Site-Clipart   | Val  Loss: 2.2815 | Val  Acc: 0.1339
 Site-Infograph | Val  Loss: 2.3011 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.2906 | Val  Acc: 0.1220
 Site-Painting  | Val  Loss: 2.2702 | Val  Acc: 0.2105
 Site-Painting  | Val  Loss: 2.2722 | Val  Acc: 0.1282
 Site-QuickDraw | Val  Loss: 2.2777 | Val  Acc: 0.0952
 Site-QuickDraw | Val  Loss: 2.2926 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 2.2572 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 2.2698 | Val  Acc: 0.1961
 Site-Sketch    | Val  Loss: 2.2854 | Val  Acc: 0.2174
 Site-Sketch    | Val  Loss: 2.2783 | Val  Acc: 0.2826
Average Valid Accuracy: 0.1756
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1071
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1339
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1220
 Best site-Painting   | Epoch:0 | Val Acc: 0.2105
 Best site-Painting   | Epoch:0 | Val Acc: 0.1282
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2143
 Best site-Real       | Epoch:0 | Val Acc: 0.2000
 Best site-Real       | Epoch:0 | Val Acc: 0.1961
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2174
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.2439 | Train Acc: 0.2976
 Site-Clipart   | Train Loss: 2.2465 | Train Acc: 0.2500
 Site-Infograph | Train Loss: 2.2943 | Train Acc: 0.1290
 Site-Infograph | Train Loss: 2.2954 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.2399 | Train Acc: 0.2414
 Site-Painting  | Train Loss: 2.2389 | Train Acc: 0.2759
 Site-QuickDraw | Train Loss: 2.2759 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.2779 | Train Acc: 0.2188
 Site-Real      | Train Loss: 2.2265 | Train Acc: 0.2368
 Site-Real      | Train Loss: 2.2272 | Train Acc: 0.2987
 Site-Sketch    | Train Loss: 2.2685 | Train Acc: 0.1714
 Site-Sketch    | Train Loss: 2.2513 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.2432 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.2430 | Val  Acc: 0.2232
 Site-Infograph | Val  Loss: 2.3054 | Val  Acc: 0.1500
 Site-Infograph | Val  Loss: 2.2994 | Val  Acc: 0.0976
 Site-Painting  | Val  Loss: 2.2489 | Val  Acc: 0.2105
 Site-Painting  | Val  Loss: 2.2404 | Val  Acc: 0.2051
 Site-QuickDraw | Val  Loss: 2.2837 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.2695 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 2.2255 | Val  Acc: 0.2800
 Site-Real      | Val  Loss: 2.2279 | Val  Acc: 0.2157
 Site-Sketch    | Val  Loss: 2.2293 | Val  Acc: 0.2609
 Site-Sketch    | Val  Loss: 2.2529 | Val  Acc: 0.2391
Average Valid Accuracy: 0.2074
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2232
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1500
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0976
 Best site-Painting   | Epoch:1 | Val Acc: 0.2105
 Best site-Painting   | Epoch:1 | Val Acc: 0.2051
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.2800
 Best site-Real       | Epoch:1 | Val Acc: 0.2157
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2609
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 2.2049 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 2.1946 | Train Acc: 0.3869
 Site-Infograph | Train Loss: 2.2804 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.2869 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.2146 | Train Acc: 0.3448
 Site-Painting  | Train Loss: 2.2128 | Train Acc: 0.4310
 Site-QuickDraw | Train Loss: 2.3053 | Train Acc: 0.0938
 Site-QuickDraw | Train Loss: 2.2732 | Train Acc: 0.2656
 Site-Real      | Train Loss: 2.1965 | Train Acc: 0.3684
 Site-Real      | Train Loss: 2.1892 | Train Acc: 0.4416
 Site-Sketch    | Train Loss: 2.2324 | Train Acc: 0.3714
 Site-Sketch    | Train Loss: 2.2149 | Train Acc: 0.3286
 Site-Clipart   | Val  Loss: 2.2035 | Val  Acc: 0.3929
 Site-Clipart   | Val  Loss: 2.2020 | Val  Acc: 0.3929
 Site-Infograph | Val  Loss: 2.2767 | Val  Acc: 0.1500
 Site-Infograph | Val  Loss: 2.2909 | Val  Acc: 0.1220
 Site-Painting  | Val  Loss: 2.2140 | Val  Acc: 0.4211
 Site-Painting  | Val  Loss: 2.2093 | Val  Acc: 0.4359
 Site-QuickDraw | Val  Loss: 2.2642 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.2485 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 2.1763 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 2.2040 | Val  Acc: 0.3922
 Site-Sketch    | Val  Loss: 2.2124 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 2.2039 | Val  Acc: 0.4130
Average Valid Accuracy: 0.3306
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3929
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3929
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1220
 Best site-Painting   | Epoch:2 | Val Acc: 0.4211
 Best site-Painting   | Epoch:2 | Val Acc: 0.4359
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3571
 Best site-Real       | Epoch:2 | Val Acc: 0.4000
 Best site-Real       | Epoch:2 | Val Acc: 0.3922
 Best site-Sketch     | Epoch:2 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:2 | Val Acc: 0.4130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 2.1682 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 2.1685 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 2.2493 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.2919 | Train Acc: 0.1452
 Site-Painting  | Train Loss: 2.2029 | Train Acc: 0.3448
 Site-Painting  | Train Loss: 2.1830 | Train Acc: 0.5172
 Site-QuickDraw | Train Loss: 2.2760 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.2550 | Train Acc: 0.2812
 Site-Real      | Train Loss: 2.1823 | Train Acc: 0.3158
 Site-Real      | Train Loss: 2.1556 | Train Acc: 0.5455
 Site-Sketch    | Train Loss: 2.1887 | Train Acc: 0.3429
 Site-Sketch    | Train Loss: 2.1832 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1651 | Val  Acc: 0.4107
 Site-Clipart   | Val  Loss: 2.1592 | Val  Acc: 0.4732
 Site-Infograph | Val  Loss: 2.2732 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.2740 | Val  Acc: 0.1463
 Site-Painting  | Val  Loss: 2.1926 | Val  Acc: 0.3158
 Site-Painting  | Val  Loss: 2.1962 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 2.2361 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2615 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 2.1556 | Val  Acc: 0.5200
 Site-Real      | Val  Loss: 2.1706 | Val  Acc: 0.4510
 Site-Sketch    | Val  Loss: 2.1690 | Val  Acc: 0.3913
 Site-Sketch    | Val  Loss: 2.1908 | Val  Acc: 0.3478
Average Valid Accuracy: 0.3599
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4107
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4732
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.1463
 Best site-Painting   | Epoch:3 | Val Acc: 0.3158
 Best site-Painting   | Epoch:3 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.5200
 Best site-Real       | Epoch:3 | Val Acc: 0.4510
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3913
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.1403 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 2.1249 | Train Acc: 0.5774
 Site-Infograph | Train Loss: 2.2645 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.2821 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1689 | Train Acc: 0.3793
 Site-Painting  | Train Loss: 2.1496 | Train Acc: 0.6034
 Site-QuickDraw | Train Loss: 2.2692 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.2415 | Train Acc: 0.2812
 Site-Real      | Train Loss: 2.1281 | Train Acc: 0.6053
 Site-Real      | Train Loss: 2.1165 | Train Acc: 0.6104
 Site-Sketch    | Train Loss: 2.1562 | Train Acc: 0.4286
 Site-Sketch    | Train Loss: 2.1442 | Train Acc: 0.4429
 Site-Clipart   | Val  Loss: 2.1265 | Val  Acc: 0.5179
 Site-Clipart   | Val  Loss: 2.1212 | Val  Acc: 0.6071
 Site-Infograph | Val  Loss: 2.2756 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2820 | Val  Acc: 0.1220
 Site-Painting  | Val  Loss: 2.1768 | Val  Acc: 0.4211
 Site-Painting  | Val  Loss: 2.1715 | Val  Acc: 0.5128
 Site-QuickDraw | Val  Loss: 2.2408 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2564 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 2.1153 | Val  Acc: 0.7200
 Site-Real      | Val  Loss: 2.1295 | Val  Acc: 0.6275
 Site-Sketch    | Val  Loss: 2.1312 | Val  Acc: 0.5217
 Site-Sketch    | Val  Loss: 2.1425 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4437
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5179
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6071
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:4 | Val Acc: 0.1220
 Best site-Painting   | Epoch:4 | Val Acc: 0.4211
 Best site-Painting   | Epoch:4 | Val Acc: 0.5128
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2857
 Best site-Real       | Epoch:4 | Val Acc: 0.7200
 Best site-Real       | Epoch:4 | Val Acc: 0.6275
 Best site-Sketch     | Epoch:4 | Val Acc: 0.5217
 Best site-Sketch     | Epoch:4 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 2.0902 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 2.0985 | Train Acc: 0.5774
 Site-Infograph | Train Loss: 2.2428 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.2682 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.1493 | Train Acc: 0.4483
 Site-Painting  | Train Loss: 2.1385 | Train Acc: 0.5517
 Site-QuickDraw | Train Loss: 2.2754 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.2331 | Train Acc: 0.2812
 Site-Real      | Train Loss: 2.1171 | Train Acc: 0.5526
 Site-Real      | Train Loss: 2.0925 | Train Acc: 0.6104
 Site-Sketch    | Train Loss: 2.1396 | Train Acc: 0.4571
 Site-Sketch    | Train Loss: 2.1339 | Train Acc: 0.4714
 Site-Clipart   | Val  Loss: 2.0870 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 2.0854 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2454 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.2611 | Val  Acc: 0.1951
 Site-Painting  | Val  Loss: 2.1687 | Val  Acc: 0.4737
 Site-Painting  | Val  Loss: 2.1695 | Val  Acc: 0.5897
 Site-QuickDraw | Val  Loss: 2.2212 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2395 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 2.0811 | Val  Acc: 0.7200
 Site-Real      | Val  Loss: 2.0957 | Val  Acc: 0.6471
 Site-Sketch    | Val  Loss: 2.1063 | Val  Acc: 0.5217
 Site-Sketch    | Val  Loss: 2.1023 | Val  Acc: 0.5652
Average Valid Accuracy: 0.4813
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.1951
 Best site-Painting   | Epoch:5 | Val Acc: 0.4737
 Best site-Painting   | Epoch:5 | Val Acc: 0.5897
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2857
 Best site-Real       | Epoch:5 | Val Acc: 0.7200
 Best site-Real       | Epoch:5 | Val Acc: 0.6471
 Best site-Sketch     | Epoch:5 | Val Acc: 0.5217
 Best site-Sketch     | Epoch:5 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 2.0697 | Train Acc: 0.6548
 Site-Clipart   | Train Loss: 2.0579 | Train Acc: 0.7024
 Site-Infograph | Train Loss: 2.2340 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.2722 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1025 | Train Acc: 0.5862
 Site-Painting  | Train Loss: 2.1095 | Train Acc: 0.5690
 Site-QuickDraw | Train Loss: 2.2634 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.2314 | Train Acc: 0.2969
 Site-Real      | Train Loss: 2.0481 | Train Acc: 0.6316
 Site-Real      | Train Loss: 2.0605 | Train Acc: 0.6753
 Site-Sketch    | Train Loss: 2.0761 | Train Acc: 0.5429
 Site-Sketch    | Train Loss: 2.1116 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0584 | Val  Acc: 0.6071
 Site-Clipart   | Val  Loss: 2.0392 | Val  Acc: 0.7054
 Site-Infograph | Val  Loss: 2.2467 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.2528 | Val  Acc: 0.1951
 Site-Painting  | Val  Loss: 2.1184 | Val  Acc: 0.4737
 Site-Painting  | Val  Loss: 2.1323 | Val  Acc: 0.6154
 Site-QuickDraw | Val  Loss: 2.2219 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.2319 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.0493 | Val  Acc: 0.8000
 Site-Real      | Val  Loss: 2.0683 | Val  Acc: 0.7647
 Site-Sketch    | Val  Loss: 2.0735 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1114 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5002
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6071
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7054
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.1951
 Best site-Painting   | Epoch:6 | Val Acc: 0.4737
 Best site-Painting   | Epoch:6 | Val Acc: 0.6154
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.1905
 Best site-Real       | Epoch:6 | Val Acc: 0.8000
 Best site-Real       | Epoch:6 | Val Acc: 0.7647
 Best site-Sketch     | Epoch:6 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:6 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 2.0477 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 2.0236 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 2.2332 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.2570 | Train Acc: 0.1452
 Site-Painting  | Train Loss: 2.0918 | Train Acc: 0.5517
 Site-Painting  | Train Loss: 2.0812 | Train Acc: 0.5862
 Site-QuickDraw | Train Loss: 2.2478 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.2275 | Train Acc: 0.2656
 Site-Real      | Train Loss: 2.0449 | Train Acc: 0.7368
 Site-Real      | Train Loss: 2.0245 | Train Acc: 0.7662
 Site-Sketch    | Train Loss: 2.0227 | Train Acc: 0.6286
 Site-Sketch    | Train Loss: 2.0652 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 2.0116 | Val  Acc: 0.7321
 Site-Clipart   | Val  Loss: 2.0063 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2525 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.2484 | Val  Acc: 0.1951
 Site-Painting  | Val  Loss: 2.0890 | Val  Acc: 0.4737
 Site-Painting  | Val  Loss: 2.0840 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.2058 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2402 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 2.0305 | Val  Acc: 0.8000
 Site-Real      | Val  Loss: 2.0345 | Val  Acc: 0.8039
 Site-Sketch    | Val  Loss: 2.0175 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.0679 | Val  Acc: 0.5870
Average Valid Accuracy: 0.5159
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7321
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.1951
 Best site-Painting   | Epoch:7 | Val Acc: 0.4737
 Best site-Painting   | Epoch:7 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2143
 Best site-Real       | Epoch:7 | Val Acc: 0.8000
 Best site-Real       | Epoch:7 | Val Acc: 0.8039
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5870
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 1.9821 | Train Acc: 0.6429
 Site-Clipart   | Train Loss: 1.9824 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.2435 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.2473 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.0846 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 2.0554 | Train Acc: 0.5690
 Site-QuickDraw | Train Loss: 2.2593 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.2112 | Train Acc: 0.2344
 Site-Real      | Train Loss: 2.0074 | Train Acc: 0.7368
 Site-Real      | Train Loss: 1.9961 | Train Acc: 0.7403
 Site-Sketch    | Train Loss: 2.0027 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 2.0403 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.9769 | Val  Acc: 0.7679
 Site-Clipart   | Val  Loss: 1.9885 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2450 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2491 | Val  Acc: 0.2195
 Site-Painting  | Val  Loss: 2.0913 | Val  Acc: 0.5263
 Site-Painting  | Val  Loss: 2.0972 | Val  Acc: 0.5897
 Site-QuickDraw | Val  Loss: 2.1907 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.2103 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.9854 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 2.0077 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.9889 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 2.0319 | Val  Acc: 0.5870
Average Valid Accuracy: 0.5495
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7679
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:8 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:8 | Val Acc: 0.2195
 Best site-Painting   | Epoch:8 | Val Acc: 0.5263
 Best site-Painting   | Epoch:8 | Val Acc: 0.5897
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2619
 Best site-Real       | Epoch:8 | Val Acc: 0.9200
 Best site-Real       | Epoch:8 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:8 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:8 | Val Acc: 0.5870
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.9727 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.9551 | Train Acc: 0.7679
 Site-Infograph | Train Loss: 2.2229 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.2331 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0294 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 2.0207 | Train Acc: 0.6207
 Site-QuickDraw | Train Loss: 2.2401 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.2234 | Train Acc: 0.2344
 Site-Real      | Train Loss: 1.9716 | Train Acc: 0.7632
 Site-Real      | Train Loss: 1.9607 | Train Acc: 0.8312
 Site-Sketch    | Train Loss: 2.0348 | Train Acc: 0.6857
 Site-Sketch    | Train Loss: 1.9982 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.9671 | Val  Acc: 0.6964
 Site-Clipart   | Val  Loss: 1.9387 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 2.2392 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2404 | Val  Acc: 0.1463
 Site-Painting  | Val  Loss: 2.0364 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 2.0653 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 2.1672 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2055 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9679 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.9610 | Val  Acc: 0.8431
 Site-Sketch    | Val  Loss: 1.9532 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0145 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5609
 Best site-Clipart    | Epoch:9 | Val Acc: 0.6964
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:9 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:9 | Val Acc: 0.1463
 Best site-Painting   | Epoch:9 | Val Acc: 0.7368
 Best site-Painting   | Epoch:9 | Val Acc: 0.6410
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2381
 Best site-Real       | Epoch:9 | Val Acc: 0.9200
 Best site-Real       | Epoch:9 | Val Acc: 0.8431
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:9 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 1.9342 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.9238 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.2253 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.2406 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0128 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.9816 | Train Acc: 0.6897
 Site-QuickDraw | Train Loss: 2.2462 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.1949 | Train Acc: 0.2969
 Site-Real      | Train Loss: 1.9202 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.9363 | Train Acc: 0.8312
 Site-Sketch    | Train Loss: 2.0263 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 1.9825 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.9220 | Val  Acc: 0.7321
 Site-Clipart   | Val  Loss: 1.9168 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 2.1976 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.2186 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 2.0029 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 2.0385 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1701 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.2144 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.9347 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.9397 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.9185 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 2.0023 | Val  Acc: 0.6304
Average Valid Accuracy: 0.5883
 Best site-Clipart    | Epoch:10 | Val Acc: 0.7321
 Best site-Clipart    | Epoch:10 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:10 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:10 | Val Acc: 0.2439
 Best site-Painting   | Epoch:10 | Val Acc: 0.6316
 Best site-Painting   | Epoch:10 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.2143
 Best site-Real       | Epoch:10 | Val Acc: 0.9200
 Best site-Real       | Epoch:10 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:10 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:10 | Val Acc: 0.6304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 1.8975 | Train Acc: 0.6786
 Site-Clipart   | Train Loss: 1.9027 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.2046 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.2242 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.9908 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.9992 | Train Acc: 0.6379
 Site-QuickDraw | Train Loss: 2.2123 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.2032 | Train Acc: 0.2344
 Site-Real      | Train Loss: 1.9261 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.8979 | Train Acc: 0.8312
 Site-Sketch    | Train Loss: 1.9466 | Train Acc: 0.6857
 Site-Sketch    | Train Loss: 1.9487 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.8978 | Val  Acc: 0.8036
 Site-Clipart   | Val  Loss: 1.8831 | Val  Acc: 0.8125
 Site-Infograph | Val  Loss: 2.2071 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.2276 | Val  Acc: 0.2195
 Site-Painting  | Val  Loss: 2.0035 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 2.0390 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 2.1682 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.1959 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9056 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.9067 | Val  Acc: 0.8235
 Site-Sketch    | Val  Loss: 1.9009 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.9600 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5745
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 1.8782 | Train Acc: 0.7262
 Site-Clipart   | Train Loss: 1.8522 | Train Acc: 0.8036
 Site-Infograph | Train Loss: 2.2067 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.2074 | Train Acc: 0.2742
 Site-Painting  | Train Loss: 1.9713 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.9347 | Train Acc: 0.6552
 Site-QuickDraw | Train Loss: 2.2235 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.1731 | Train Acc: 0.2969
 Site-Real      | Train Loss: 1.9298 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.8738 | Train Acc: 0.8701
 Site-Sketch    | Train Loss: 1.9336 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 1.9429 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.8577 | Val  Acc: 0.8036
 Site-Clipart   | Val  Loss: 1.8266 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 2.2062 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2009 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 1.9960 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 2.0185 | Val  Acc: 0.6154
 Site-QuickDraw | Val  Loss: 2.1514 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.1803 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.9062 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.8782 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.8884 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 1.9336 | Val  Acc: 0.5435
Average Valid Accuracy: 0.5708
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 1.8439 | Train Acc: 0.7262
 Site-Clipart   | Train Loss: 1.8306 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1793 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.2242 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.9760 | Train Acc: 0.5862
 Site-Painting  | Train Loss: 1.9118 | Train Acc: 0.7069
 Site-QuickDraw | Train Loss: 2.2050 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.1758 | Train Acc: 0.3281
 Site-Real      | Train Loss: 1.8914 | Train Acc: 0.8684
 Site-Real      | Train Loss: 1.8345 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.9013 | Train Acc: 0.6286
 Site-Sketch    | Train Loss: 1.9311 | Train Acc: 0.6714
 Site-Clipart   | Val  Loss: 1.8075 | Val  Acc: 0.8214
 Site-Clipart   | Val  Loss: 1.8258 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 2.2314 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.1920 | Val  Acc: 0.2683
 Site-Painting  | Val  Loss: 1.9367 | Val  Acc: 0.4737
 Site-Painting  | Val  Loss: 1.9928 | Val  Acc: 0.6154
 Site-QuickDraw | Val  Loss: 2.1665 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.1840 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.8511 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.8668 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.8417 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.9126 | Val  Acc: 0.6522
Average Valid Accuracy: 0.5716
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.8262 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.8057 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1878 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 2.2113 | Train Acc: 0.2097
 Site-Painting  | Train Loss: 1.9311 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.8963 | Train Acc: 0.7069
 Site-QuickDraw | Train Loss: 2.2309 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.1848 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.8593 | Train Acc: 0.8421
 Site-Real      | Train Loss: 1.8087 | Train Acc: 0.8442
 Site-Sketch    | Train Loss: 1.8101 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.8877 | Train Acc: 0.6714
 Site-Clipart   | Val  Loss: 1.7624 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.7740 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 2.2047 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1907 | Val  Acc: 0.2195
 Site-Painting  | Val  Loss: 1.8844 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.9682 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1413 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1920 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.8381 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.8220 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.8391 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 1.8784 | Val  Acc: 0.6739
Average Valid Accuracy: 0.6042
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8839
 Best site-Infograph  | Epoch:14 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:14 | Val Acc: 0.2195
 Best site-Painting   | Epoch:14 | Val Acc: 0.5789
 Best site-Painting   | Epoch:14 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.2143
 Best site-Real       | Epoch:14 | Val Acc: 0.9600
 Best site-Real       | Epoch:14 | Val Acc: 0.8824
 Best site-Sketch     | Epoch:14 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:14 | Val Acc: 0.6739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 1.8301 | Train Acc: 0.7024
 Site-Clipart   | Train Loss: 1.7827 | Train Acc: 0.7917
 Site-Infograph | Train Loss: 2.1940 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1997 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8990 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.8846 | Train Acc: 0.6897
 Site-QuickDraw | Train Loss: 2.2215 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.1597 | Train Acc: 0.2969
 Site-Real      | Train Loss: 1.8205 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.7768 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.7998 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 1.8301 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.7685 | Val  Acc: 0.8036
 Site-Clipart   | Val  Loss: 1.7671 | Val  Acc: 0.8661
 Site-Infograph | Val  Loss: 2.1613 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1697 | Val  Acc: 0.2927
 Site-Painting  | Val  Loss: 1.9626 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.9359 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1509 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.1853 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.8000 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.7854 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.8090 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8902 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5965
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 1.7640 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.7583 | Train Acc: 0.8393
 Site-Infograph | Train Loss: 2.1702 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1889 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8437 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.8643 | Train Acc: 0.6897
 Site-QuickDraw | Train Loss: 2.2203 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.1572 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.7658 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.7501 | Train Acc: 0.8312
 Site-Sketch    | Train Loss: 1.8259 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.8241 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.7074 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.7326 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 2.1605 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1905 | Val  Acc: 0.2195
 Site-Painting  | Val  Loss: 1.8620 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.9504 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1045 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1743 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.7736 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.7487 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.7599 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.8373 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6011
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 1.7968 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.7110 | Train Acc: 0.8512
 Site-Infograph | Train Loss: 2.1653 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1890 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8719 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.8618 | Train Acc: 0.6724
 Site-QuickDraw | Train Loss: 2.2098 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.1566 | Train Acc: 0.2969
 Site-Real      | Train Loss: 1.7933 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.7463 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.8162 | Train Acc: 0.6857
 Site-Sketch    | Train Loss: 1.8504 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.6784 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 1.7133 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 2.1805 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.1781 | Val  Acc: 0.2683
 Site-Painting  | Val  Loss: 1.8910 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.9320 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.1066 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.1538 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.7418 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.7344 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.7600 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.7907 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6456
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:17 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:17 | Val Acc: 0.2683
 Best site-Painting   | Epoch:17 | Val Acc: 0.6316
 Best site-Painting   | Epoch:17 | Val Acc: 0.6923
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.2857
 Best site-Real       | Epoch:17 | Val Acc: 0.9600
 Best site-Real       | Epoch:17 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:17 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:17 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 1.7298 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.6852 | Train Acc: 0.8393
 Site-Infograph | Train Loss: 2.1716 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.1814 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8844 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.8302 | Train Acc: 0.7069
 Site-QuickDraw | Train Loss: 2.1973 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.1631 | Train Acc: 0.2656
 Site-Real      | Train Loss: 1.7836 | Train Acc: 0.8421
 Site-Real      | Train Loss: 1.7159 | Train Acc: 0.8442
 Site-Sketch    | Train Loss: 1.6712 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 1.7910 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.6753 | Val  Acc: 0.8393
 Site-Clipart   | Val  Loss: 1.6584 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 2.1651 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1672 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 1.8383 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.9154 | Val  Acc: 0.6154
 Site-QuickDraw | Val  Loss: 2.1305 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1489 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.7177 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.7149 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.6989 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.8036 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6219
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.6990 | Train Acc: 0.7262
 Site-Clipart   | Train Loss: 1.6709 | Train Acc: 0.8512
 Site-Infograph | Train Loss: 2.1713 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1764 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8537 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.7796 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 2.1946 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.1344 | Train Acc: 0.3281
 Site-Real      | Train Loss: 1.7146 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.6755 | Train Acc: 0.8701
 Site-Sketch    | Train Loss: 1.7775 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.7836 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.6443 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.6585 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.1763 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1595 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 1.8504 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.8968 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.1163 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.1424 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.6679 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.6718 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.7097 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.7914 | Val  Acc: 0.6522
Average Valid Accuracy: 0.5987
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 1.6602 | Train Acc: 0.7381
 Site-Clipart   | Train Loss: 1.6517 | Train Acc: 0.8214
 Site-Infograph | Train Loss: 2.1569 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1624 | Train Acc: 0.2742
 Site-Painting  | Train Loss: 1.7819 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.7934 | Train Acc: 0.7586
 Site-QuickDraw | Train Loss: 2.1823 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.1565 | Train Acc: 0.2969
 Site-Real      | Train Loss: 1.7022 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.6489 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.8141 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.7566 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.6330 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.6266 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 2.0615 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.1596 | Val  Acc: 0.2683
 Site-Painting  | Val  Loss: 1.7881 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.8488 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0938 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.1588 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.6666 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.6482 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.6765 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.7696 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6195
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 1.7153 | Train Acc: 0.7381
 Site-Clipart   | Train Loss: 1.6067 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 2.1730 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.1634 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.7758 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.7892 | Train Acc: 0.7414
 Site-QuickDraw | Train Loss: 2.1653 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.1401 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.7064 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.6117 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 1.5594 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.7263 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.5854 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.5925 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.1292 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1701 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 1.7828 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.8757 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0885 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1335 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.6808 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.6109 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.6260 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7348 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6455
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 1.6583 | Train Acc: 0.7262
 Site-Clipart   | Train Loss: 1.5900 | Train Acc: 0.8631
 Site-Infograph | Train Loss: 2.1687 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1389 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.7942 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.7702 | Train Acc: 0.7241
 Site-QuickDraw | Train Loss: 2.1642 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 2.1251 | Train Acc: 0.3594
 Site-Real      | Train Loss: 1.6463 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.6104 | Train Acc: 0.8701
 Site-Sketch    | Train Loss: 1.6392 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.7135 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.5745 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 1.5908 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 2.1074 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1319 | Val  Acc: 0.3415
 Site-Painting  | Val  Loss: 1.7538 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.8397 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.0756 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1453 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.6363 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.6005 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.6337 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.7030 | Val  Acc: 0.7609
Average Valid Accuracy: 0.6452
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 1.6472 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.5645 | Train Acc: 0.8274
 Site-Infograph | Train Loss: 2.1614 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1439 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.7850 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.6762 | Train Acc: 0.7759
 Site-QuickDraw | Train Loss: 2.2018 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.1037 | Train Acc: 0.3906
 Site-Real      | Train Loss: 1.6218 | Train Acc: 0.8684
 Site-Real      | Train Loss: 1.5736 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 1.5292 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.7141 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.5234 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 1.5436 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 2.1235 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 2.1122 | Val  Acc: 0.2683
 Site-Painting  | Val  Loss: 1.7910 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.8011 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0887 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.1233 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.6238 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.5630 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.6059 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.6875 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6446
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.5391 | Train Acc: 0.7857
 Site-Clipart   | Train Loss: 1.5327 | Train Acc: 0.8512
 Site-Infograph | Train Loss: 2.1727 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1268 | Train Acc: 0.3065
 Site-Painting  | Train Loss: 1.7135 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.7009 | Train Acc: 0.7414
 Site-QuickDraw | Train Loss: 2.1708 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.1015 | Train Acc: 0.3594
 Site-Real      | Train Loss: 1.5790 | Train Acc: 0.8684
 Site-Real      | Train Loss: 1.5593 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.6818 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.6514 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.5333 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 1.5358 | Val  Acc: 0.9018
 Site-Infograph | Val  Loss: 2.1000 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1286 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.7160 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.7897 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0866 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1249 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.5726 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.5480 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.5759 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.6537 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6550
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9018
 Best site-Infograph  | Epoch:24 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:24 | Val Acc: 0.3171
 Best site-Painting   | Epoch:24 | Val Acc: 0.6316
 Best site-Painting   | Epoch:24 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.3810
 Best site-Real       | Epoch:24 | Val Acc: 0.9200
 Best site-Real       | Epoch:24 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:24 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:24 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 1.5878 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.5294 | Train Acc: 0.8631
 Site-Infograph | Train Loss: 2.1514 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1064 | Train Acc: 0.3065
 Site-Painting  | Train Loss: 1.6955 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.7201 | Train Acc: 0.7241
 Site-QuickDraw | Train Loss: 2.1790 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.0977 | Train Acc: 0.3594
 Site-Real      | Train Loss: 1.5865 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.5396 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 1.7034 | Train Acc: 0.6857
 Site-Sketch    | Train Loss: 1.6383 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.5084 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.5202 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 2.1166 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1059 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 1.6446 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.7932 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 2.0533 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1074 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.5474 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.5115 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.5596 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.6740 | Val  Acc: 0.7609
Average Valid Accuracy: 0.6398
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 1.5748 | Train Acc: 0.7857
 Site-Clipart   | Train Loss: 1.5154 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 2.1551 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.1159 | Train Acc: 0.2742
 Site-Painting  | Train Loss: 1.7097 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.6334 | Train Acc: 0.7586
 Site-QuickDraw | Train Loss: 2.1767 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.1108 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.6388 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.4967 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.5994 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.6420 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.4696 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 1.4694 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.1290 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1302 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 1.6220 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.7651 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0745 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1064 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.5160 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.5093 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.5138 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.6497 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6510
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 1.5580 | Train Acc: 0.7738
 Site-Clipart   | Train Loss: 1.4545 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 2.1163 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.1028 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.7026 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.6770 | Train Acc: 0.7586
 Site-QuickDraw | Train Loss: 2.1517 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 2.0934 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.4998 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.5162 | Train Acc: 0.8442
 Site-Sketch    | Train Loss: 1.6058 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.5551 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.4567 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.4544 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.1394 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1121 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.6401 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.7575 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0292 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1018 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.4840 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.4638 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.5666 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.6304 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6372
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 1.5751 | Train Acc: 0.7381
 Site-Clipart   | Train Loss: 1.4511 | Train Acc: 0.8869
 Site-Infograph | Train Loss: 2.1210 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.1138 | Train Acc: 0.2742
 Site-Painting  | Train Loss: 1.6608 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.6413 | Train Acc: 0.7414
 Site-QuickDraw | Train Loss: 2.1625 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.1007 | Train Acc: 0.3594
 Site-Real      | Train Loss: 1.4894 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.4784 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 1.5013 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.5757 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.4462 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 1.4157 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 2.1314 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.0917 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.6227 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.7417 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0614 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.1167 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.4748 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.4440 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.5436 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.6320 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6539
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.4680 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.4496 | Train Acc: 0.8274
 Site-Infograph | Train Loss: 2.1348 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0981 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.6427 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.6356 | Train Acc: 0.6724
 Site-QuickDraw | Train Loss: 2.1641 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.0678 | Train Acc: 0.4062
 Site-Real      | Train Loss: 1.5040 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.4433 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.7049 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.5428 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3772 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.4063 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.0577 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0869 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.6534 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.7590 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.0547 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.0773 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.4440 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.4145 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.5319 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.5651 | Val  Acc: 0.7609
Average Valid Accuracy: 0.6611
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8929
 Best site-Infograph  | Epoch:29 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:29 | Val Acc: 0.3171
 Best site-Painting   | Epoch:29 | Val Acc: 0.5789
 Best site-Painting   | Epoch:29 | Val Acc: 0.6923
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.3571
 Best site-Real       | Epoch:29 | Val Acc: 0.9200
 Best site-Real       | Epoch:29 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:29 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:29 | Val Acc: 0.7609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8517
 Test site-Infograph | Epoch:29 | Test Acc: 0.4399
 Test site-Painting  | Epoch:29 | Test Acc: 0.8045
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3810
 Test site-Real      | Epoch:29 | Test Acc: 0.9154
 Test site-Sketch    | Epoch:29 | Test Acc: 0.7563
Average Test Accuracy: 0.6915
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 1.4937 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.4272 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.0864 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1008 | Train Acc: 0.2742
 Site-Painting  | Train Loss: 1.6283 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.5891 | Train Acc: 0.7759
 Site-QuickDraw | Train Loss: 2.1246 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.0646 | Train Acc: 0.4062
 Site-Real      | Train Loss: 1.5035 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.4399 | Train Acc: 0.8701
 Site-Sketch    | Train Loss: 1.5835 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.5738 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.3982 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 1.4154 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 2.1069 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0790 | Val  Acc: 0.2927
 Site-Painting  | Val  Loss: 1.5942 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.7373 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0322 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.1033 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.4719 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.4035 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.4770 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.5599 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6553
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 1.4551 | Train Acc: 0.7738
 Site-Clipart   | Train Loss: 1.3957 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 2.1023 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0893 | Train Acc: 0.2742
 Site-Painting  | Train Loss: 1.6222 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.5953 | Train Acc: 0.7586
 Site-QuickDraw | Train Loss: 2.1464 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 2.0675 | Train Acc: 0.3906
 Site-Real      | Train Loss: 1.4701 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.4156 | Train Acc: 0.8701
 Site-Sketch    | Train Loss: 1.5784 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.5560 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.3893 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 1.3821 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.0626 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.0922 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.5823 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.6778 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 2.0339 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.0943 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.4396 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.3929 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.4720 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.5688 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6638
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8929
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:31 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:31 | Val Acc: 0.3171
 Best site-Painting   | Epoch:31 | Val Acc: 0.6842
 Best site-Painting   | Epoch:31 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.3095
 Best site-Real       | Epoch:31 | Val Acc: 0.9200
 Best site-Real       | Epoch:31 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:31 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:31 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 1.3887 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.3730 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 2.1212 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0567 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.6370 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.5847 | Train Acc: 0.7414
 Site-QuickDraw | Train Loss: 2.1538 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.0632 | Train Acc: 0.3906
 Site-Real      | Train Loss: 1.4870 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.4049 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.6341 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.5494 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.3470 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 1.3998 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 2.0413 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0629 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.5384 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.7357 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 1.9839 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.0677 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.3936 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.3618 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.4571 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.5234 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6734
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9464
 Best site-Clipart    | Epoch:32 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:32 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:32 | Val Acc: 0.3171
 Best site-Painting   | Epoch:32 | Val Acc: 0.6316
 Best site-Painting   | Epoch:32 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.3810
 Best site-Real       | Epoch:32 | Val Acc: 0.9200
 Best site-Real       | Epoch:32 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:32 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:32 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 1.4548 | Train Acc: 0.7738
 Site-Clipart   | Train Loss: 1.3621 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.1237 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0479 | Train Acc: 0.3710
 Site-Painting  | Train Loss: 1.5796 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.5779 | Train Acc: 0.7414
 Site-QuickDraw | Train Loss: 2.1181 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.0451 | Train Acc: 0.4219
 Site-Real      | Train Loss: 1.4278 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.3686 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.5681 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.4763 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 1.2981 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 1.3803 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 2.0706 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0515 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.5611 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.6767 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0509 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.1073 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.3874 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.3348 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.4704 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.4988 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6632
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.4621 | Train Acc: 0.7857
 Site-Clipart   | Train Loss: 1.3358 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.0877 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0620 | Train Acc: 0.3065
 Site-Painting  | Train Loss: 1.5835 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.5905 | Train Acc: 0.7241
 Site-QuickDraw | Train Loss: 2.1374 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 2.0376 | Train Acc: 0.4062
 Site-Real      | Train Loss: 1.3762 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.3743 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 1.7080 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.5442 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.3336 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.3249 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.0365 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0788 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 1.5435 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.6532 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 2.0082 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 2.0375 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 1.3580 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.3071 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.4022 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.4904 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6800
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:34 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:34 | Val Acc: 0.2439
 Best site-Painting   | Epoch:34 | Val Acc: 0.7368
 Best site-Painting   | Epoch:34 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.4048
 Best site-Real       | Epoch:34 | Val Acc: 0.9600
 Best site-Real       | Epoch:34 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:34 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:34 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 1.3369 | Train Acc: 0.7976
 Site-Clipart   | Train Loss: 1.3077 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 2.1063 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.0677 | Train Acc: 0.3387
 Site-Painting  | Train Loss: 1.5626 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.5172 | Train Acc: 0.7586
 Site-QuickDraw | Train Loss: 2.1482 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.0534 | Train Acc: 0.4062
 Site-Real      | Train Loss: 1.4229 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.3513 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.2657 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.5374 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.2710 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 1.2987 | Val  Acc: 0.9018
 Site-Infograph | Val  Loss: 2.0269 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0597 | Val  Acc: 0.2683
 Site-Painting  | Val  Loss: 1.5027 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.6405 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 2.0036 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.0707 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.3349 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.3004 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.4601 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.5087 | Val  Acc: 0.8261
Average Valid Accuracy: 0.6602
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 1.3514 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.3248 | Train Acc: 0.8988
 Site-Infograph | Train Loss: 2.0887 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0344 | Train Acc: 0.3387
 Site-Painting  | Train Loss: 1.5199 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.5164 | Train Acc: 0.7586
 Site-QuickDraw | Train Loss: 2.1638 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.0566 | Train Acc: 0.3906
 Site-Real      | Train Loss: 1.4227 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.3092 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.6324 | Train Acc: 0.6857
 Site-Sketch    | Train Loss: 1.5023 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.2945 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 1.2688 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 2.0477 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0680 | Val  Acc: 0.3415
 Site-Painting  | Val  Loss: 1.5304 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.6089 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0264 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.0446 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.3232 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.2676 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.3773 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.4399 | Val  Acc: 0.8043
Average Valid Accuracy: 0.6714
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 1.4445 | Train Acc: 0.7857
 Site-Clipart   | Train Loss: 1.2752 | Train Acc: 0.8988
 Site-Infograph | Train Loss: 2.1211 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0202 | Train Acc: 0.3710
 Site-Painting  | Train Loss: 1.5207 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.5327 | Train Acc: 0.7759
 Site-QuickDraw | Train Loss: 2.1727 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.0170 | Train Acc: 0.4688
 Site-Real      | Train Loss: 1.4481 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.2998 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 1.5062 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.4719 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.2374 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.2620 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.1255 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0032 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.4209 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.6196 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 2.0238 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 2.0764 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.3248 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.2726 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.3749 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.4767 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6684
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 1.3657 | Train Acc: 0.7976
 Site-Clipart   | Train Loss: 1.2868 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 2.0942 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.0507 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.4858 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.4349 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.1404 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 2.0334 | Train Acc: 0.4375
 Site-Real      | Train Loss: 1.3215 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.2866 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 1.4759 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.4482 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.2580 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.2497 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.0685 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0501 | Val  Acc: 0.2683
 Site-Painting  | Val  Loss: 1.4410 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.6601 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0085 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.0729 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.3004 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.2572 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.3617 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.4852 | Val  Acc: 0.7609
Average Valid Accuracy: 0.6686
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.3115 | Train Acc: 0.7976
 Site-Clipart   | Train Loss: 1.2560 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 2.0726 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0254 | Train Acc: 0.3387
 Site-Painting  | Train Loss: 1.4784 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.4700 | Train Acc: 0.7931
 Site-QuickDraw | Train Loss: 2.1361 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.0290 | Train Acc: 0.4688
 Site-Real      | Train Loss: 1.3512 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.2813 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 1.4164 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.4239 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.2154 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 1.2341 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.0134 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0385 | Val  Acc: 0.2927
 Site-Painting  | Val  Loss: 1.4760 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.6206 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0167 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.0168 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.3015 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.2071 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.3529 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.4505 | Val  Acc: 0.8043
Average Valid Accuracy: 0.6844
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9464
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:39 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:39 | Val Acc: 0.2927
 Best site-Painting   | Epoch:39 | Val Acc: 0.6316
 Best site-Painting   | Epoch:39 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.5000
 Best site-Real       | Epoch:39 | Val Acc: 0.9200
 Best site-Real       | Epoch:39 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:39 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:39 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8593
 Test site-Infograph | Epoch:39 | Test Acc: 0.4566
 Test site-Painting  | Epoch:39 | Test Acc: 0.8255
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.4130
 Test site-Real      | Epoch:39 | Test Acc: 0.9285
 Test site-Sketch    | Epoch:39 | Test Acc: 0.7744
Average Test Accuracy: 0.7096
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 1.3062 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.2553 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.0911 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0127 | Train Acc: 0.3387
 Site-Painting  | Train Loss: 1.5034 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.4345 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 2.1415 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 2.0214 | Train Acc: 0.4062
 Site-Real      | Train Loss: 1.3310 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.2465 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.3486 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.4112 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.2194 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.2198 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 1.9587 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 2.0043 | Val  Acc: 0.3659
 Site-Painting  | Val  Loss: 1.4702 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.4905 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.9291 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 2.0727 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.2736 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.2370 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.3446 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.4053 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7064
 Best site-Clipart    | Epoch:40 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:40 | Val Acc: 0.8839
 Best site-Infograph  | Epoch:40 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:40 | Val Acc: 0.3659
 Best site-Painting   | Epoch:40 | Val Acc: 0.6842
 Best site-Painting   | Epoch:40 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:40 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:40 | Val Acc: 0.3333
 Best site-Real       | Epoch:40 | Val Acc: 0.9200
 Best site-Real       | Epoch:40 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:40 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:40 | Val Acc: 0.7609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 1.2799 | Train Acc: 0.8214
 Site-Clipart   | Train Loss: 1.2370 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.1091 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0204 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.4958 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.4687 | Train Acc: 0.7931
 Site-QuickDraw | Train Loss: 2.1066 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 2.0411 | Train Acc: 0.4219
 Site-Real      | Train Loss: 1.2592 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.2416 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.4015 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.3891 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.1857 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.2021 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 2.0174 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0212 | Val  Acc: 0.3659
 Site-Painting  | Val  Loss: 1.3990 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.5078 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9320 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 2.0350 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.2784 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.1856 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.3229 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.4210 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6943
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 1.2924 | Train Acc: 0.7738
 Site-Clipart   | Train Loss: 1.2305 | Train Acc: 0.8869
 Site-Infograph | Train Loss: 2.0743 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0076 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.4478 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.4679 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.1258 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 1.9867 | Train Acc: 0.4844
 Site-Real      | Train Loss: 1.2258 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.2387 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 1.4706 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.3948 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 1.2044 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 1.1922 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.0699 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0124 | Val  Acc: 0.3902
 Site-Painting  | Val  Loss: 1.4871 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.5686 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9830 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.0037 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.2450 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.1753 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.2963 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.4074 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6963
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 1.2664 | Train Acc: 0.7857
 Site-Clipart   | Train Loss: 1.2101 | Train Acc: 0.8869
 Site-Infograph | Train Loss: 2.0819 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.9861 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.4476 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.3916 | Train Acc: 0.7759
 Site-QuickDraw | Train Loss: 2.0928 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.0196 | Train Acc: 0.3906
 Site-Real      | Train Loss: 1.3077 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.2207 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 1.2815 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.3799 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.1570 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 1.1467 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9338 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0422 | Val  Acc: 0.2927
 Site-Painting  | Val  Loss: 1.3899 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.5477 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9693 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 2.0027 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 1.2008 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.1567 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.2807 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.3761 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6890
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.2508 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.1886 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.0692 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9960 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.4690 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.4323 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.1346 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 2.0040 | Train Acc: 0.4375
 Site-Real      | Train Loss: 1.2184 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.1893 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 1.3728 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.3669 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.1442 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 1.1424 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 1.9316 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 2.0260 | Val  Acc: 0.2927
 Site-Painting  | Val  Loss: 1.3807 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.5610 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9816 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.0155 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 1.1901 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.1478 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.1896 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.4346 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6995
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 1.2532 | Train Acc: 0.7738
 Site-Clipart   | Train Loss: 1.1654 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 2.0819 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9453 | Train Acc: 0.3710
 Site-Painting  | Train Loss: 1.3859 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.3721 | Train Acc: 0.7931
 Site-QuickDraw | Train Loss: 2.0872 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.9595 | Train Acc: 0.4688
 Site-Real      | Train Loss: 1.1679 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.1483 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.3531 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.4286 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.1319 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 1.1271 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 1.9828 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9976 | Val  Acc: 0.2927
 Site-Painting  | Val  Loss: 1.3744 | Val  Acc: 0.5263
 Site-Painting  | Val  Loss: 1.4550 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.9898 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.0162 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.1856 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.1456 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.2963 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.4058 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7046
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 1.2891 | Train Acc: 0.7738
 Site-Clipart   | Train Loss: 1.1865 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.0434 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.0010 | Train Acc: 0.3387
 Site-Painting  | Train Loss: 1.4268 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.3414 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 2.1487 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 1.9868 | Train Acc: 0.4062
 Site-Real      | Train Loss: 1.2093 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.1578 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 1.3570 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.3829 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.1017 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 1.1404 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 1.9495 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9596 | Val  Acc: 0.3659
 Site-Painting  | Val  Loss: 1.2805 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.4883 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9760 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.0250 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.1681 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.0912 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.2771 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.3960 | Val  Acc: 0.8043
Average Valid Accuracy: 0.6973
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 1.2324 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.1146 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 2.0356 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.9795 | Train Acc: 0.3387
 Site-Painting  | Train Loss: 1.3886 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.3736 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.0872 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.9802 | Train Acc: 0.4219
 Site-Real      | Train Loss: 1.2971 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.1478 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 1.2789 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.3398 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 1.1704 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 1.0973 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.9955 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 1.9994 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.3262 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.4877 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.9620 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.9951 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.1605 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.1050 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.2848 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.3827 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6739
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 1.2763 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.1604 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 2.0799 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.9729 | Train Acc: 0.3387
 Site-Painting  | Train Loss: 1.4228 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.3186 | Train Acc: 0.7759
 Site-QuickDraw | Train Loss: 2.0865 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.9920 | Train Acc: 0.4219
 Site-Real      | Train Loss: 1.2118 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.1507 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.1869 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.3217 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.1290 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.0734 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 2.0349 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0019 | Val  Acc: 0.3659
 Site-Painting  | Val  Loss: 1.2241 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.5080 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9711 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.0166 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.1166 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.0852 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.2111 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.3249 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7119
 Best site-Clipart    | Epoch:48 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:48 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:48 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:48 | Val Acc: 0.3659
 Best site-Painting   | Epoch:48 | Val Acc: 0.7368
 Best site-Painting   | Epoch:48 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:48 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:48 | Val Acc: 0.4286
 Best site-Real       | Epoch:48 | Val Acc: 0.9200
 Best site-Real       | Epoch:48 | Val Acc: 0.9608
 Best site-Sketch     | Epoch:48 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:48 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 1.2193 | Train Acc: 0.7738
 Site-Clipart   | Train Loss: 1.1062 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 2.0388 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9464 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.3392 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.3513 | Train Acc: 0.7586
 Site-QuickDraw | Train Loss: 2.0963 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.9700 | Train Acc: 0.4531
 Site-Real      | Train Loss: 1.1506 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.1310 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.2536 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.2818 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0903 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.0820 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9518 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9886 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.2930 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.4722 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9302 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.0208 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.0831 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.0708 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.2378 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.3781 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7186
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:49 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:49 | Val Acc: 0.3171
 Best site-Painting   | Epoch:49 | Val Acc: 0.7895
 Best site-Painting   | Epoch:49 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.4286
 Best site-Real       | Epoch:49 | Val Acc: 0.9600
 Best site-Real       | Epoch:49 | Val Acc: 0.9608
 Best site-Sketch     | Epoch:49 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:49 | Val Acc: 0.7174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/harmo-fl...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8688
 Test site-Infograph | Epoch:49 | Test Acc: 0.4703
 Test site-Painting  | Epoch:49 | Test Acc: 0.8401
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.4490
 Test site-Real      | Epoch:49 | Test Acc: 0.9302
 Test site-Sketch    | Epoch:49 | Test Acc: 0.7870
Average Test Accuracy: 0.7242
===2023-04-23 20:12:25===
===2023-04-23 20:12:26===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8688
 Test site-Infograph | Epoch:49 | Test Acc: 0.4703
 Test site-Painting  | Epoch:49 | Test Acc: 0.8401
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.4490
 Test site-Real      | Epoch:49 | Test Acc: 0.9302
 Test site-Sketch    | Epoch:49 | Test Acc: 0.7870
Average Test Accuracy: 0.7242
