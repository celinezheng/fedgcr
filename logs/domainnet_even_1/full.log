===2023-04-21 07:54:59===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 2.2738 | Train Acc: 0.1310
 Site-Clipart   | Train Loss: 2.2691 | Train Acc: 0.1488
 Site-Infograph | Train Loss: 2.2978 | Train Acc: 0.0645
 Site-Infograph | Train Loss: 2.3130 | Train Acc: 0.1452
 Site-Painting  | Train Loss: 2.2768 | Train Acc: 0.1724
 Site-Painting  | Train Loss: 2.2710 | Train Acc: 0.1552
 Site-QuickDraw | Train Loss: 2.3076 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.2884 | Train Acc: 0.1406
 Site-Real      | Train Loss: 2.2727 | Train Acc: 0.1316
 Site-Real      | Train Loss: 2.2602 | Train Acc: 0.2208
 Site-Sketch    | Train Loss: 2.2890 | Train Acc: 0.1429
 Site-Sketch    | Train Loss: 2.2782 | Train Acc: 0.1714
 Site-Clipart   | Val  Loss: 2.2817 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.2718 | Val  Acc: 0.1429
 Site-Infograph | Val  Loss: 2.2934 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.3030 | Val  Acc: 0.1707
 Site-Painting  | Val  Loss: 2.2751 | Val  Acc: 0.0526
 Site-Painting  | Val  Loss: 2.2714 | Val  Acc: 0.1795
 Site-QuickDraw | Val  Loss: 2.2885 | Val  Acc: 0.0476
 Site-QuickDraw | Val  Loss: 2.3040 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 2.2718 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 2.2593 | Val  Acc: 0.1765
 Site-Sketch    | Val  Loss: 2.2821 | Val  Acc: 0.2174
 Site-Sketch    | Val  Loss: 2.2711 | Val  Acc: 0.3261
Average Valid Accuracy: 0.1772
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1429
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1707
 Best site-Painting   | Epoch:0 | Val Acc: 0.0526
 Best site-Painting   | Epoch:0 | Val Acc: 0.1795
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0476
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.2000
 Best site-Real       | Epoch:0 | Val Acc: 0.1765
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2174
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.2248 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.2220 | Train Acc: 0.2976
 Site-Infograph | Train Loss: 2.2988 | Train Acc: 0.0645
 Site-Infograph | Train Loss: 2.2912 | Train Acc: 0.1452
 Site-Painting  | Train Loss: 2.2430 | Train Acc: 0.3103
 Site-Painting  | Train Loss: 2.2118 | Train Acc: 0.3276
 Site-QuickDraw | Train Loss: 2.2823 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.2790 | Train Acc: 0.2031
 Site-Real      | Train Loss: 2.2246 | Train Acc: 0.2368
 Site-Real      | Train Loss: 2.2215 | Train Acc: 0.2987
 Site-Sketch    | Train Loss: 2.2468 | Train Acc: 0.2857
 Site-Sketch    | Train Loss: 2.2346 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.2278 | Val  Acc: 0.2321
 Site-Clipart   | Val  Loss: 2.2181 | Val  Acc: 0.3125
 Site-Infograph | Val  Loss: 2.2807 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.3054 | Val  Acc: 0.0976
 Site-Painting  | Val  Loss: 2.2388 | Val  Acc: 0.1579
 Site-Painting  | Val  Loss: 2.2308 | Val  Acc: 0.2564
 Site-QuickDraw | Val  Loss: 2.2918 | Val  Acc: 0.0476
 Site-QuickDraw | Val  Loss: 2.2680 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 2.2391 | Val  Acc: 0.2400
 Site-Real      | Val  Loss: 2.2257 | Val  Acc: 0.2745
 Site-Sketch    | Val  Loss: 2.2242 | Val  Acc: 0.2609
 Site-Sketch    | Val  Loss: 2.2362 | Val  Acc: 0.3261
Average Valid Accuracy: 0.2104
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2321
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3125
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0976
 Best site-Painting   | Epoch:1 | Val Acc: 0.1579
 Best site-Painting   | Epoch:1 | Val Acc: 0.2564
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1190
 Best site-Real       | Epoch:1 | Val Acc: 0.2400
 Best site-Real       | Epoch:1 | Val Acc: 0.2745
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2609
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 2.1832 | Train Acc: 0.4286
 Site-Clipart   | Train Loss: 2.1575 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 2.2759 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.2742 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1991 | Train Acc: 0.4138
 Site-Painting  | Train Loss: 2.1920 | Train Acc: 0.4655
 Site-QuickDraw | Train Loss: 2.2982 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.2718 | Train Acc: 0.1719
 Site-Real      | Train Loss: 2.1832 | Train Acc: 0.3421
 Site-Real      | Train Loss: 2.1746 | Train Acc: 0.4935
 Site-Sketch    | Train Loss: 2.1958 | Train Acc: 0.4857
 Site-Sketch    | Train Loss: 2.1976 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1773 | Val  Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1662 | Val  Acc: 0.4375
 Site-Infograph | Val  Loss: 2.2606 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.2891 | Val  Acc: 0.1707
 Site-Painting  | Val  Loss: 2.1986 | Val  Acc: 0.4737
 Site-Painting  | Val  Loss: 2.1880 | Val  Acc: 0.4615
 Site-QuickDraw | Val  Loss: 2.2638 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.2296 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 2.2000 | Val  Acc: 0.4400
 Site-Real      | Val  Loss: 2.1900 | Val  Acc: 0.4706
 Site-Sketch    | Val  Loss: 2.1928 | Val  Acc: 0.4348
 Site-Sketch    | Val  Loss: 2.1831 | Val  Acc: 0.4130
Average Valid Accuracy: 0.3593
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4286
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4375
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1707
 Best site-Painting   | Epoch:2 | Val Acc: 0.4737
 Best site-Painting   | Epoch:2 | Val Acc: 0.4615
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2381
 Best site-Real       | Epoch:2 | Val Acc: 0.4400
 Best site-Real       | Epoch:2 | Val Acc: 0.4706
 Best site-Sketch     | Epoch:2 | Val Acc: 0.4348
 Best site-Sketch     | Epoch:2 | Val Acc: 0.4130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 2.1304 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 2.1131 | Train Acc: 0.5833
 Site-Infograph | Train Loss: 2.2421 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.2706 | Train Acc: 0.2097
 Site-Painting  | Train Loss: 2.1670 | Train Acc: 0.4483
 Site-Painting  | Train Loss: 2.1180 | Train Acc: 0.6034
 Site-QuickDraw | Train Loss: 2.2707 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.2496 | Train Acc: 0.2344
 Site-Real      | Train Loss: 2.1640 | Train Acc: 0.4474
 Site-Real      | Train Loss: 2.1402 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 2.1500 | Train Acc: 0.4857
 Site-Sketch    | Train Loss: 2.1517 | Train Acc: 0.4714
 Site-Clipart   | Val  Loss: 2.1206 | Val  Acc: 0.5357
 Site-Clipart   | Val  Loss: 2.1123 | Val  Acc: 0.6071
 Site-Infograph | Val  Loss: 2.2441 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.2650 | Val  Acc: 0.2195
 Site-Painting  | Val  Loss: 2.1822 | Val  Acc: 0.4737
 Site-Painting  | Val  Loss: 2.1601 | Val  Acc: 0.6154
 Site-QuickDraw | Val  Loss: 2.2437 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2252 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.1543 | Val  Acc: 0.5600
 Site-Real      | Val  Loss: 2.1487 | Val  Acc: 0.5686
 Site-Sketch    | Val  Loss: 2.1409 | Val  Acc: 0.4783
 Site-Sketch    | Val  Loss: 2.1554 | Val  Acc: 0.5217
Average Valid Accuracy: 0.4321
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5357
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6071
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2195
 Best site-Painting   | Epoch:3 | Val Acc: 0.4737
 Best site-Painting   | Epoch:3 | Val Acc: 0.6154
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1667
 Best site-Real       | Epoch:3 | Val Acc: 0.5600
 Best site-Real       | Epoch:3 | Val Acc: 0.5686
 Best site-Sketch     | Epoch:3 | Val Acc: 0.4783
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0860 | Train Acc: 0.6786
 Site-Clipart   | Train Loss: 2.0554 | Train Acc: 0.7083
 Site-Infograph | Train Loss: 2.2499 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.2546 | Train Acc: 0.2419
 Site-Painting  | Train Loss: 2.1455 | Train Acc: 0.5517
 Site-Painting  | Train Loss: 2.0997 | Train Acc: 0.6379
 Site-QuickDraw | Train Loss: 2.2505 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.2234 | Train Acc: 0.2344
 Site-Real      | Train Loss: 2.1019 | Train Acc: 0.5789
 Site-Real      | Train Loss: 2.0907 | Train Acc: 0.6364
 Site-Sketch    | Train Loss: 2.0990 | Train Acc: 0.5143
 Site-Sketch    | Train Loss: 2.1052 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0597 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 2.0558 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.2258 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2600 | Val  Acc: 0.1707
 Site-Painting  | Val  Loss: 2.1522 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 2.1135 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.2165 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.2074 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 2.1131 | Val  Acc: 0.6400
 Site-Real      | Val  Loss: 2.1013 | Val  Acc: 0.6471
 Site-Sketch    | Val  Loss: 2.1084 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1018 | Val  Acc: 0.5652
Average Valid Accuracy: 0.4934
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7321
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:4 | Val Acc: 0.1707
 Best site-Painting   | Epoch:4 | Val Acc: 0.5789
 Best site-Painting   | Epoch:4 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2381
 Best site-Real       | Epoch:4 | Val Acc: 0.6400
 Best site-Real       | Epoch:4 | Val Acc: 0.6471
 Best site-Sketch     | Epoch:4 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:4 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 2.0290 | Train Acc: 0.6786
 Site-Clipart   | Train Loss: 2.0139 | Train Acc: 0.7321
 Site-Infograph | Train Loss: 2.2244 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.2448 | Train Acc: 0.1774
 Site-Painting  | Train Loss: 2.0993 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 2.1008 | Train Acc: 0.6379
 Site-QuickDraw | Train Loss: 2.2567 | Train Acc: 0.0938
 Site-QuickDraw | Train Loss: 2.2060 | Train Acc: 0.2344
 Site-Real      | Train Loss: 2.0651 | Train Acc: 0.7368
 Site-Real      | Train Loss: 2.0517 | Train Acc: 0.6883
 Site-Sketch    | Train Loss: 2.0672 | Train Acc: 0.6000
 Site-Sketch    | Train Loss: 2.0780 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 1.9968 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.9962 | Val  Acc: 0.7589
 Site-Infograph | Val  Loss: 2.2057 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2371 | Val  Acc: 0.1951
 Site-Painting  | Val  Loss: 2.1072 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 2.1079 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.1831 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.1844 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 2.0721 | Val  Acc: 0.6400
 Site-Real      | Val  Loss: 2.0557 | Val  Acc: 0.6863
 Site-Sketch    | Val  Loss: 2.0524 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 2.0449 | Val  Acc: 0.6522
Average Valid Accuracy: 0.5358
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7589
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:5 | Val Acc: 0.1951
 Best site-Painting   | Epoch:5 | Val Acc: 0.6842
 Best site-Painting   | Epoch:5 | Val Acc: 0.6923
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3095
 Best site-Real       | Epoch:5 | Val Acc: 0.6400
 Best site-Real       | Epoch:5 | Val Acc: 0.6863
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 1.9811 | Train Acc: 0.7024
 Site-Clipart   | Train Loss: 1.9511 | Train Acc: 0.8036
 Site-Infograph | Train Loss: 2.2174 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.2347 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.0299 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 2.0169 | Train Acc: 0.6724
 Site-QuickDraw | Train Loss: 2.2287 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.1963 | Train Acc: 0.2500
 Site-Real      | Train Loss: 2.0124 | Train Acc: 0.7105
 Site-Real      | Train Loss: 2.0146 | Train Acc: 0.7662
 Site-Sketch    | Train Loss: 1.9950 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.0284 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.9461 | Val  Acc: 0.8393
 Site-Clipart   | Val  Loss: 1.9288 | Val  Acc: 0.8661
 Site-Infograph | Val  Loss: 2.1740 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.2112 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 2.0832 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 2.0500 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1713 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.1708 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 2.0061 | Val  Acc: 0.8000
 Site-Real      | Val  Loss: 2.0100 | Val  Acc: 0.8039
 Site-Sketch    | Val  Loss: 2.0136 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 2.0271 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5846
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8393
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8661
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3171
 Best site-Painting   | Epoch:6 | Val Acc: 0.6316
 Best site-Painting   | Epoch:6 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2381
 Best site-Real       | Epoch:6 | Val Acc: 0.8000
 Best site-Real       | Epoch:6 | Val Acc: 0.8039
 Best site-Sketch     | Epoch:6 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:6 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 1.9418 | Train Acc: 0.6905
 Site-Clipart   | Train Loss: 1.8951 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1973 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.2085 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0149 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.9701 | Train Acc: 0.7069
 Site-QuickDraw | Train Loss: 2.2111 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 2.1797 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.9752 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.9568 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 1.9418 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.9656 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.8828 | Val  Acc: 0.8036
 Site-Clipart   | Val  Loss: 1.8706 | Val  Acc: 0.8661
 Site-Infograph | Val  Loss: 2.1741 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2019 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 2.0280 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 2.0023 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 2.1542 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.1687 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.9736 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.9792 | Val  Acc: 0.8235
 Site-Sketch    | Val  Loss: 1.9319 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.9548 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6031
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8036
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8661
 Best site-Infograph  | Epoch:7 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:7 | Val Acc: 0.2439
 Best site-Painting   | Epoch:7 | Val Acc: 0.7368
 Best site-Painting   | Epoch:7 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2857
 Best site-Real       | Epoch:7 | Val Acc: 0.8800
 Best site-Real       | Epoch:7 | Val Acc: 0.8235
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 1.8529 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.8310 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 2.1881 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1699 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.9700 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.9233 | Train Acc: 0.7069
 Site-QuickDraw | Train Loss: 2.1995 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.1487 | Train Acc: 0.2969
 Site-Real      | Train Loss: 1.9194 | Train Acc: 0.8684
 Site-Real      | Train Loss: 1.9173 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.8984 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.9166 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.8149 | Val  Acc: 0.8393
 Site-Clipart   | Val  Loss: 1.8283 | Val  Acc: 0.8661
 Site-Infograph | Val  Loss: 2.1380 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1873 | Val  Acc: 0.2683
 Site-Painting  | Val  Loss: 2.0207 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.9807 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.1320 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.1090 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.9337 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.9258 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.8921 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.9235 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6234
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8393
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8661
 Best site-Infograph  | Epoch:8 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.2683
 Best site-Painting   | Epoch:8 | Val Acc: 0.6842
 Best site-Painting   | Epoch:8 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2619
 Best site-Real       | Epoch:8 | Val Acc: 0.9600
 Best site-Real       | Epoch:8 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:8 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.8181 | Train Acc: 0.7976
 Site-Clipart   | Train Loss: 1.7637 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.1623 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1468 | Train Acc: 0.3387
 Site-Painting  | Train Loss: 1.9466 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.8412 | Train Acc: 0.7586
 Site-QuickDraw | Train Loss: 2.1811 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.1368 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.8770 | Train Acc: 0.8421
 Site-Real      | Train Loss: 1.8633 | Train Acc: 0.8442
 Site-Sketch    | Train Loss: 1.8487 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.8570 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.7713 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.7502 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 2.1405 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.1595 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 1.9416 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.9247 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 2.0852 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.0860 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.8838 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.8700 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.8075 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.8714 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6531
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8839
 Best site-Infograph  | Epoch:9 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:9 | Val Acc: 0.2439
 Best site-Painting   | Epoch:9 | Val Acc: 0.7368
 Best site-Painting   | Epoch:9 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3333
 Best site-Real       | Epoch:9 | Val Acc: 0.9600
 Best site-Real       | Epoch:9 | Val Acc: 0.8824
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8099
 Test site-Infograph | Epoch:9 | Test Acc: 0.4125
 Test site-Painting  | Epoch:9 | Test Acc: 0.7900
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.3060
 Test site-Real      | Epoch:9 | Test Acc: 0.8414
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7130
Average Test Accuracy: 0.6455
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 1.7755 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.7116 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 2.1661 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.1287 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.8834 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.8198 | Train Acc: 0.7759
 Site-QuickDraw | Train Loss: 2.1671 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 2.1190 | Train Acc: 0.2969
 Site-Real      | Train Loss: 1.8442 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.8025 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.7640 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.7899 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.6866 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 1.6874 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.1167 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1258 | Val  Acc: 0.3415
 Site-Painting  | Val  Loss: 1.8722 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.8772 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 2.0280 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.0786 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.8208 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.8198 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.7721 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8134 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6724
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8929
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:10 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:10 | Val Acc: 0.3415
 Best site-Painting   | Epoch:10 | Val Acc: 0.7368
 Best site-Painting   | Epoch:10 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.2857
 Best site-Real       | Epoch:10 | Val Acc: 0.9600
 Best site-Real       | Epoch:10 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:10 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:10 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 1.6911 | Train Acc: 0.8214
 Site-Clipart   | Train Loss: 1.6358 | Train Acc: 0.9107
 Site-Infograph | Train Loss: 2.1526 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.1131 | Train Acc: 0.3387
 Site-Painting  | Train Loss: 1.8590 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.8002 | Train Acc: 0.7759
 Site-QuickDraw | Train Loss: 2.1479 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.0780 | Train Acc: 0.3281
 Site-Real      | Train Loss: 1.7799 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.7585 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.7587 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.7347 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.6161 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 1.6168 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.0714 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1340 | Val  Acc: 0.2683
 Site-Painting  | Val  Loss: 1.8321 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.8451 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 1.9774 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 2.0378 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.7794 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.7746 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.7004 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.7711 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6754
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:11 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:11 | Val Acc: 0.2683
 Best site-Painting   | Epoch:11 | Val Acc: 0.7368
 Best site-Painting   | Epoch:11 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.3571
 Best site-Real       | Epoch:11 | Val Acc: 0.9600
 Best site-Real       | Epoch:11 | Val Acc: 0.9608
 Best site-Sketch     | Epoch:11 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:11 | Val Acc: 0.7174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 1.6506 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.5715 | Train Acc: 0.9107
 Site-Infograph | Train Loss: 2.1483 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0850 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.8002 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.7137 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 2.1438 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.0457 | Train Acc: 0.4062
 Site-Real      | Train Loss: 1.7287 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.6995 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 1.6462 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.6989 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.5261 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 1.5456 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 2.0508 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.1067 | Val  Acc: 0.3415
 Site-Painting  | Val  Loss: 1.8129 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.7845 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9959 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.0192 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.7015 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.7081 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.6639 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.6974 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6991
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9464
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9375
 Best site-Infograph  | Epoch:12 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:12 | Val Acc: 0.3415
 Best site-Painting   | Epoch:12 | Val Acc: 0.7895
 Best site-Painting   | Epoch:12 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.3571
 Best site-Real       | Epoch:12 | Val Acc: 1.0000
 Best site-Real       | Epoch:12 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:12 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:12 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 1.5821 | Train Acc: 0.7738
 Site-Clipart   | Train Loss: 1.5175 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 2.1017 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0419 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.7284 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.6528 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 2.1384 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.0068 | Train Acc: 0.3594
 Site-Real      | Train Loss: 1.6569 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.6548 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.6395 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.6148 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 1.4576 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.4835 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.0432 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0904 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.7362 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.7378 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.9856 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.9670 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 1.6594 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6606 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.5485 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.6299 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7084
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:13 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:13 | Val Acc: 0.3171
 Best site-Painting   | Epoch:13 | Val Acc: 0.7895
 Best site-Painting   | Epoch:13 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.4048
 Best site-Real       | Epoch:13 | Val Acc: 1.0000
 Best site-Real       | Epoch:13 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:13 | Val Acc: 0.7609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.5104 | Train Acc: 0.7976
 Site-Clipart   | Train Loss: 1.4422 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 2.0980 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0669 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.6674 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.6526 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.1322 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 1.9724 | Train Acc: 0.3906
 Site-Real      | Train Loss: 1.6224 | Train Acc: 0.8947
 Site-Real      | Train Loss: 1.5933 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 1.6239 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.5643 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.3988 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 1.4141 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9869 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 2.0317 | Val  Acc: 0.3415
 Site-Painting  | Val  Loss: 1.6858 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.6683 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.9156 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.9441 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.6080 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.5818 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.5121 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.5864 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7192
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9643
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:14 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:14 | Val Acc: 0.3415
 Best site-Painting   | Epoch:14 | Val Acc: 0.7368
 Best site-Painting   | Epoch:14 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.3810
 Best site-Real       | Epoch:14 | Val Acc: 0.9600
 Best site-Real       | Epoch:14 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:14 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:14 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 1.4426 | Train Acc: 0.7976
 Site-Clipart   | Train Loss: 1.3783 | Train Acc: 0.9107
 Site-Infograph | Train Loss: 2.0925 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0027 | Train Acc: 0.3710
 Site-Painting  | Train Loss: 1.6403 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.6749 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 2.0554 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.9530 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.5434 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.5418 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 1.4785 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.5041 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 1.3231 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 1.3373 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 2.0494 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0166 | Val  Acc: 0.3659
 Site-Painting  | Val  Loss: 1.6841 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.6300 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9162 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.8982 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.5250 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.5354 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.4634 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.5180 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7138
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 1.3553 | Train Acc: 0.8452
 Site-Clipart   | Train Loss: 1.2959 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 2.0679 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0183 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.5890 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.5177 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.0666 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.9036 | Train Acc: 0.4375
 Site-Real      | Train Loss: 1.4860 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.4675 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 1.4163 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.4259 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.2745 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.2689 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.9644 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 2.0250 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.5563 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.6208 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.8756 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.8996 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.4704 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.4714 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 1.3699 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.4443 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7281
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:16 | Val Acc: 0.3171
 Best site-Painting   | Epoch:16 | Val Acc: 0.8421
 Best site-Painting   | Epoch:16 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.3810
 Best site-Real       | Epoch:16 | Val Acc: 1.0000
 Best site-Real       | Epoch:16 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 1.2965 | Train Acc: 0.8452
 Site-Clipart   | Train Loss: 1.2286 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.9977 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.9503 | Train Acc: 0.4032
 Site-Painting  | Train Loss: 1.5389 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.4528 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 2.0382 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.8840 | Train Acc: 0.3906
 Site-Real      | Train Loss: 1.4541 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.4232 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 1.4310 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.3611 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.1912 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 1.2070 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9636 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.9978 | Val  Acc: 0.3415
 Site-Painting  | Val  Loss: 1.5382 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.5089 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.7417 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.8313 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.3973 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.4058 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.3213 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.4060 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7330
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9464
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:17 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:17 | Val Acc: 0.3415
 Best site-Painting   | Epoch:17 | Val Acc: 0.7895
 Best site-Painting   | Epoch:17 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.3810
 Best site-Real       | Epoch:17 | Val Acc: 1.0000
 Best site-Real       | Epoch:17 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:17 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:17 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 1.2180 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 1.1649 | Train Acc: 0.9226
 Site-Infograph | Train Loss: 1.9823 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.9070 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.4712 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.3742 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 1.9658 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.8162 | Train Acc: 0.4375
 Site-Real      | Train Loss: 1.3804 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.3592 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 1.2937 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.3118 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 1.1188 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 1.1291 | Val  Acc: 0.9554
 Site-Infograph | Val  Loss: 1.9943 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 1.9772 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.4564 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.4997 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.7163 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.7877 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.3471 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.3514 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 1.2667 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.3699 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7359
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9464
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9554
 Best site-Infograph  | Epoch:18 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:18 | Val Acc: 0.3171
 Best site-Painting   | Epoch:18 | Val Acc: 0.7895
 Best site-Painting   | Epoch:18 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.5000
 Best site-Real       | Epoch:18 | Val Acc: 1.0000
 Best site-Real       | Epoch:18 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.1844 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 1.1147 | Train Acc: 0.9226
 Site-Infograph | Train Loss: 1.9285 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.9082 | Train Acc: 0.4032
 Site-Painting  | Train Loss: 1.4291 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.3286 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 2.0646 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 1.7960 | Train Acc: 0.4531
 Site-Real      | Train Loss: 1.3106 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.2833 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 1.2784 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 1.2342 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0679 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 1.0766 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8649 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.9611 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.4143 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.4292 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.7056 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.7388 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.2833 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.2824 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.2033 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.2818 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7317
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 1.1162 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 1.0668 | Train Acc: 0.9226
 Site-Infograph | Train Loss: 1.9388 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7984 | Train Acc: 0.4677
 Site-Painting  | Train Loss: 1.4154 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.2938 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.8864 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.7151 | Train Acc: 0.5156
 Site-Real      | Train Loss: 1.2524 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.2244 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 1.2015 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.1934 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 1.0059 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 1.0156 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8322 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.8809 | Val  Acc: 0.4390
 Site-Painting  | Val  Loss: 1.3414 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.3361 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.6655 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.7131 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.2070 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.2249 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 1.1555 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 1.2243 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7615
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9643
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4390
 Best site-Painting   | Epoch:20 | Val Acc: 0.8421
 Best site-Painting   | Epoch:20 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.4286
 Best site-Real       | Epoch:20 | Val Acc: 1.0000
 Best site-Real       | Epoch:20 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:20 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:20 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 1.0617 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.9890 | Train Acc: 0.9345
 Site-Infograph | Train Loss: 1.9079 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.7895 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.3408 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.3080 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.8658 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.6610 | Train Acc: 0.5469
 Site-Real      | Train Loss: 1.1866 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.1699 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 1.1934 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.1183 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.9303 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.9375 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8280 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 1.8854 | Val  Acc: 0.3659
 Site-Painting  | Val  Loss: 1.2599 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.3234 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5897 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.7526 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.1406 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.1595 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.1321 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 1.1359 | Val  Acc: 0.9130
Average Valid Accuracy: 0.7598
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.9780 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 0.9383 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.8291 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.7795 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.2811 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.2049 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.8860 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.6551 | Train Acc: 0.5000
 Site-Real      | Train Loss: 1.1688 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.1284 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 1.1153 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.0722 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.8543 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.8819 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.7877 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.8634 | Val  Acc: 0.3902
 Site-Painting  | Val  Loss: 1.1872 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.2727 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5324 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.6761 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.0849 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.1121 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.0551 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 1.0789 | Val  Acc: 0.8913
Average Valid Accuracy: 0.7679
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:22 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:22 | Val Acc: 0.3902
 Best site-Painting   | Epoch:22 | Val Acc: 0.8421
 Best site-Painting   | Epoch:22 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.4524
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:22 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.9513 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8699 | Train Acc: 0.9345
 Site-Infograph | Train Loss: 1.9349 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7006 | Train Acc: 0.4677
 Site-Painting  | Train Loss: 1.2971 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.1082 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.7403 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.5883 | Train Acc: 0.5938
 Site-Real      | Train Loss: 1.0865 | Train Acc: 0.9211
 Site-Real      | Train Loss: 1.0746 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 1.0962 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9972 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.8203 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8246 | Val  Acc: 0.9554
 Site-Infograph | Val  Loss: 1.7682 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.8002 | Val  Acc: 0.4146
 Site-Painting  | Val  Loss: 1.1558 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.2170 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.4853 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.6400 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.9975 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.0308 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.0120 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 1.0417 | Val  Acc: 0.8913
Average Valid Accuracy: 0.7720
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9554
 Best site-Infograph  | Epoch:23 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:23 | Val Acc: 0.4146
 Best site-Painting   | Epoch:23 | Val Acc: 0.8421
 Best site-Painting   | Epoch:23 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.4524
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:23 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.9149 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.8166 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.9012 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7454 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.2378 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.1371 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.8032 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.5274 | Train Acc: 0.5938
 Site-Real      | Train Loss: 1.0676 | Train Acc: 0.9474
 Site-Real      | Train Loss: 1.0016 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 1.0422 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9498 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.7617 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.7739 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.7855 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.7163 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 1.1410 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.1696 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4774 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.5961 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.9836 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.9937 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.9734 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.9682 | Val  Acc: 0.9130
Average Valid Accuracy: 0.7761
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9821
 Best site-Infograph  | Epoch:24 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:24 | Val Acc: 0.4634
 Best site-Painting   | Epoch:24 | Val Acc: 0.8421
 Best site-Painting   | Epoch:24 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.4524
 Best site-Real       | Epoch:24 | Val Acc: 0.9600
 Best site-Real       | Epoch:24 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:24 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:24 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.8155 | Train Acc: 0.9286
 Site-Clipart   | Train Loss: 0.7587 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.8095 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.6953 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.1828 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.0540 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.6980 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.4811 | Train Acc: 0.6250
 Site-Real      | Train Loss: 1.0125 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.9629 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 1.0160 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.8894 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.7286 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 0.7234 | Val  Acc: 0.9554
 Site-Infograph | Val  Loss: 1.7278 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.7312 | Val  Acc: 0.4146
 Site-Painting  | Val  Loss: 1.0441 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.1237 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4891 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.5294 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.9072 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.9256 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.8921 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.9807 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7627
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.8082 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.7083 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.7485 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6583 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.1692 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.9549 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.7374 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.4676 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.9964 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.9013 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.9285 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.8264 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.6673 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.6751 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.6741 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7276 | Val  Acc: 0.4146
 Site-Painting  | Val  Loss: 1.0035 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.0807 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.4225 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.4874 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.8310 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.8612 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.8806 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.9056 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7794
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:26 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:26 | Val Acc: 0.4146
 Best site-Painting   | Epoch:26 | Val Acc: 0.8421
 Best site-Painting   | Epoch:26 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.5238
 Best site-Real       | Epoch:26 | Val Acc: 0.9600
 Best site-Real       | Epoch:26 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:26 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:26 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.7436 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6687 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 1.7595 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6272 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.0625 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.9699 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.5752 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.4315 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.9383 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.8646 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.8785 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.8028 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6264 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.6357 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.6449 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.7231 | Val  Acc: 0.4390
 Site-Painting  | Val  Loss: 0.9923 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.0573 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.2961 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.4889 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.7838 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.8282 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.8524 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.8662 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7865
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:27 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:27 | Val Acc: 0.4390
 Best site-Painting   | Epoch:27 | Val Acc: 0.8421
 Best site-Painting   | Epoch:27 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.5000
 Best site-Real       | Epoch:27 | Val Acc: 1.0000
 Best site-Real       | Epoch:27 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:27 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:27 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.7047 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6436 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.7747 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5889 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.0195 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.8769 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.5695 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.3450 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.8751 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.8088 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.8863 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.7705 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5761 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6121 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.6678 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6772 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.9241 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.0074 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3012 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.3954 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.7694 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.7730 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.8233 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.8088 | Val  Acc: 0.9130
Average Valid Accuracy: 0.7951
 Best site-Clipart    | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9643
 Best site-Infograph  | Epoch:28 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:28 | Val Acc: 0.4634
 Best site-Painting   | Epoch:28 | Val Acc: 0.8421
 Best site-Painting   | Epoch:28 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.5714
 Best site-Real       | Epoch:28 | Val Acc: 1.0000
 Best site-Real       | Epoch:28 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:28 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:28 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6798 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.5965 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 1.7505 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.6010 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.0362 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.9857 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.6211 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.2978 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.8482 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.7637 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.8188 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.7087 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.5350 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5650 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.6058 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5676 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.8537 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.9485 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.3552 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.3476 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.7133 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.7333 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 0.7729 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.7760 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7937
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.6218 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5531 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.7311 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.4996 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.0185 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.8401 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.4722 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.3021 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.8194 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.7331 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.8547 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.6501 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.4963 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5258 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.6006 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5925 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.7959 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.9429 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.2422 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.3942 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.6637 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.6767 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7131 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.7282 | Val  Acc: 0.9130
Average Valid Accuracy: 0.7948
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.5789 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.5150 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.7464 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4768 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 0.9558 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.7857 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.4652 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.2254 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.7585 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.6782 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.8704 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.6412 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.4646 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.4779 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.5802 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5496 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.8262 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8758 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.1915 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.3106 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.6232 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.6343 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7291 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.7371 | Val  Acc: 0.8913
Average Valid Accuracy: 0.7951
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.5359 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.4832 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.7309 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.4898 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.9513 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.7360 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.4491 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.2049 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.7567 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.6530 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.8850 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.5853 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.4451 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.4624 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.5491 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5019 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 0.7637 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8545 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.1691 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.2347 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.5623 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.6103 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6804 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.6508 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8039
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9643
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9821
 Best site-Infograph  | Epoch:32 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:32 | Val Acc: 0.4878
 Best site-Painting   | Epoch:32 | Val Acc: 0.8421
 Best site-Painting   | Epoch:32 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.5714
 Best site-Real       | Epoch:32 | Val Acc: 1.0000
 Best site-Real       | Epoch:32 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:32 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:32 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.5317 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.4511 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.7842 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4260 | Train Acc: 0.5645
 Site-Painting  | Train Loss: 0.8363 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.7269 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.3962 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 1.1302 | Train Acc: 0.7031
 Site-Real      | Train Loss: 0.7114 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.6091 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7324 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.5810 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3956 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4326 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.4259 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.5158 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.7550 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8038 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0793 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.1922 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.5555 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.5780 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6493 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.6433 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8137
 Best site-Clipart    | Epoch:33 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:33 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:33 | Val Acc: 0.4634
 Best site-Painting   | Epoch:33 | Val Acc: 0.8421
 Best site-Painting   | Epoch:33 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.5238
 Best site-Real       | Epoch:33 | Val Acc: 1.0000
 Best site-Real       | Epoch:33 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:33 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:33 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5126 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.4398 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.6580 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.4192 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 0.8153 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.6792 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.4076 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.1690 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.6848 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.5791 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.8017 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.5564 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.3750 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4089 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.5598 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.4322 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 0.7274 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.7782 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.0496 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.1573 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.5390 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.5262 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6157 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.6101 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8110
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.4498 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.4054 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.7386 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.4171 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.8224 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.6400 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.4145 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.0524 | Train Acc: 0.7031
 Site-Real      | Train Loss: 0.6622 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.5499 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6308 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.5289 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.3594 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.3823 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.4531 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.4042 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.7102 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.7293 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 0.9659 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.1621 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.4769 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4937 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5884 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.5949 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8266
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9821
 Best site-Infograph  | Epoch:35 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:35 | Val Acc: 0.5122
 Best site-Painting   | Epoch:35 | Val Acc: 0.8421
 Best site-Painting   | Epoch:35 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:35 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:35 | Val Acc: 0.5714
 Best site-Real       | Epoch:35 | Val Acc: 1.0000
 Best site-Real       | Epoch:35 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:35 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:35 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.4818 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3824 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.6854 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.4146 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 0.8260 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.6746 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.3142 | Train Acc: 0.5938
 Site-QuickDraw | Train Loss: 1.1212 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.6415 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.5009 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6613 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.4693 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.3273 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.3500 | Val  Acc: 0.9732
 Site-Infograph | Val  Loss: 1.3661 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.3080 | Val  Acc: 0.5854
 Site-Painting  | Val  Loss: 0.6421 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.7104 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.0415 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.1234 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.4529 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4764 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5720 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.5474 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8365
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9732
 Best site-Infograph  | Epoch:36 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:36 | Val Acc: 0.5854
 Best site-Painting   | Epoch:36 | Val Acc: 0.8947
 Best site-Painting   | Epoch:36 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.5714
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:36 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:36 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.4125 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.3457 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.6023 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.3283 | Train Acc: 0.5645
 Site-Painting  | Train Loss: 0.7257 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.5852 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.3858 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 0.9974 | Train Acc: 0.7031
 Site-Real      | Train Loss: 0.6181 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.5029 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.5928 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.4486 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.3179 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3254 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.4802 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.3797 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.6466 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.6765 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.0748 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.0739 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.4146 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4608 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5682 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.5173 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8243
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.4114 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.3250 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.6616 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.3604 | Train Acc: 0.5645
 Site-Painting  | Train Loss: 0.7710 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.5545 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.2573 | Train Acc: 0.6250
 Site-QuickDraw | Train Loss: 1.0241 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.5598 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.4675 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5223 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.4409 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2824 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2955 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.5154 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.3328 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.6387 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.6877 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 0.7912 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.0460 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.4166 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4250 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5157 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.4621 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8211
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.3871 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3124 | Train Acc: 0.9702
 Site-Infograph | Train Loss: 1.7756 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.3144 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.6831 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.6591 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.2948 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 0.9936 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.5553 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.4332 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5364 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.4117 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.2700 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.2905 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.4042 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.3125 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.5949 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.7092 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 0.8544 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.9792 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.3888 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3851 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4468 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.4442 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8390
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:39 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:39 | Val Acc: 0.5610
 Best site-Painting   | Epoch:39 | Val Acc: 0.8421
 Best site-Painting   | Epoch:39 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.5952
 Best site-Real       | Epoch:39 | Val Acc: 1.0000
 Best site-Real       | Epoch:39 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:39 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:39 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.9316
 Test site-Infograph | Epoch:39 | Test Acc: 0.5403
 Test site-Painting  | Epoch:39 | Test Acc: 0.9160
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.6030
 Test site-Real      | Epoch:39 | Test Acc: 0.9540
 Test site-Sketch    | Epoch:39 | Test Acc: 0.8899
Average Test Accuracy: 0.8058
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.3463 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.2923 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 1.5930 | Train Acc: 0.5484
 Site-Infograph | Train Loss: 1.2342 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.7546 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.5446 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.1289 | Train Acc: 0.6250
 Site-QuickDraw | Train Loss: 0.9615 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.5597 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.4224 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4507 | Train Acc: 0.9714
 Site-Sketch    | Train Loss: 0.3818 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.2534 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2697 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.4558 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.2274 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.6135 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.6362 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 0.8774 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.0007 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.3840 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3827 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4333 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4471 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8311
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.3291 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.2776 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.6198 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.1553 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.7054 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.5158 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.1387 | Train Acc: 0.6562
 Site-QuickDraw | Train Loss: 0.9184 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.5173 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.3942 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4612 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.3696 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2434 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2552 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.2379 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.2622 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.5684 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.5919 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.0233 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 0.9875 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.3512 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3555 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5028 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.4715 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8250
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.3364 | Train Acc: 0.9643
 Site-Clipart   | Train Loss: 0.2633 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 1.6190 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.2493 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.7026 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.6180 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.1273 | Train Acc: 0.5938
 Site-QuickDraw | Train Loss: 0.9038 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.4930 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.3704 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5455 | Train Acc: 0.9714
 Site-Sketch    | Train Loss: 0.3550 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2279 | Val  Acc: 0.9821
 Site-Clipart   | Val  Loss: 0.2473 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.3606 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.2263 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.5597 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.6003 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 0.7824 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.9658 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.3418 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3495 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3820 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3734 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8475
 Best site-Clipart    | Epoch:42 | Val Acc: 0.9821
 Best site-Clipart    | Epoch:42 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:42 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:42 | Val Acc: 0.5610
 Best site-Painting   | Epoch:42 | Val Acc: 0.8421
 Best site-Painting   | Epoch:42 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:42 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:42 | Val Acc: 0.6190
 Best site-Real       | Epoch:42 | Val Acc: 1.0000
 Best site-Real       | Epoch:42 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:42 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:42 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.3061 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.2508 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.6884 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.2203 | Train Acc: 0.6290
 Site-Painting  | Train Loss: 0.8080 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.4608 | Train Acc: 0.9483
 Site-QuickDraw | Train Loss: 1.2266 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 0.8677 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.4909 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.3516 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4870 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.3250 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.2089 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2233 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.2747 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.2005 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.5553 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.6039 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 0.7896 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 0.9107 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.3161 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3258 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4161 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3750 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8449
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2858 | Train Acc: 0.9762
 Site-Clipart   | Train Loss: 0.2355 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 1.5612 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.2180 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.7098 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 0.4615 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.1250 | Train Acc: 0.6250
 Site-QuickDraw | Train Loss: 0.7884 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.5135 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.3373 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4746 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.3234 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.2013 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2139 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.1894 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.2060 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.5370 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.5736 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 0.8824 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 0.9065 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.3017 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3024 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3863 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3584 | Val  Acc: 0.9783
Average Valid Accuracy: 0.8464
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.2713 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2257 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 1.6588 | Train Acc: 0.5484
 Site-Infograph | Train Loss: 1.1911 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.7021 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.4249 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.0754 | Train Acc: 0.6250
 Site-QuickDraw | Train Loss: 0.8934 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.4629 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.3029 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4371 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.2906 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.1859 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2097 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.3900 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.2683 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 0.5084 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.5673 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 0.9193 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.9682 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.2946 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2885 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3243 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3608 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8279
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.2553 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.2114 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 1.5655 | Train Acc: 0.5484
 Site-Infograph | Train Loss: 1.1652 | Train Acc: 0.6290
 Site-Painting  | Train Loss: 0.5833 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.3869 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.1160 | Train Acc: 0.7188
 Site-QuickDraw | Train Loss: 0.8030 | Train Acc: 0.7344
 Site-Real      | Train Loss: 0.4485 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.3144 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4785 | Train Acc: 0.9714
 Site-Sketch    | Train Loss: 0.2905 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.1681 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1921 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.3286 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.1445 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.5070 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.5257 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 0.6613 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.8487 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2715 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2677 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3557 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3150 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8511
 Best site-Clipart    | Epoch:46 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:46 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:46 | Val Acc: 0.6098
 Best site-Painting   | Epoch:46 | Val Acc: 0.8421
 Best site-Painting   | Epoch:46 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:46 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:46 | Val Acc: 0.6190
 Best site-Real       | Epoch:46 | Val Acc: 1.0000
 Best site-Real       | Epoch:46 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:46 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:46 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.2400 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.1962 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.4769 | Train Acc: 0.5806
 Site-Infograph | Train Loss: 1.1200 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.5422 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.4197 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 0.9080 | Train Acc: 0.7500
 Site-QuickDraw | Train Loss: 0.7785 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.4853 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.3106 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3552 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.2780 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.1691 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1921 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.3304 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.1023 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.5051 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.5635 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 0.9471 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 0.8495 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.2788 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2673 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3000 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3032 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8499
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.2507 | Train Acc: 0.9881
 Site-Clipart   | Train Loss: 0.1868 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 1.5601 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.1042 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.6614 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.5275 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 0.8783 | Train Acc: 0.7188
 Site-QuickDraw | Train Loss: 0.7511 | Train Acc: 0.7344
 Site-Real      | Train Loss: 0.4415 | Train Acc: 0.9737
 Site-Real      | Train Loss: 0.2913 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3894 | Train Acc: 0.9714
 Site-Sketch    | Train Loss: 0.2568 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.1615 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1684 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.3795 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.1135 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.4651 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.5135 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 0.7482 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 0.9266 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2686 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2367 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2784 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2736 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8509
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2219 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1849 | Train Acc: 0.9821
 Site-Infograph | Train Loss: 1.5569 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.0411 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.5684 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.4204 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.0173 | Train Acc: 0.6562
 Site-QuickDraw | Train Loss: 0.7916 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.3983 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.2934 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3226 | Train Acc: 0.9714
 Site-Sketch    | Train Loss: 0.2164 | Train Acc: 0.9857
 Site-Clipart   | Val  Loss: 0.1463 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1618 | Val  Acc: 0.9911
 Site-Infograph | Val  Loss: 1.1916 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.0317 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.4368 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.5261 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 0.7252 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.8073 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.2457 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2315 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2420 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2941 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8727
 Best site-Clipart    | Epoch:49 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9911
 Best site-Infograph  | Epoch:49 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:49 | Val Acc: 0.6585
 Best site-Painting   | Epoch:49 | Val Acc: 0.8421
 Best site-Painting   | Epoch:49 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.6905
 Best site-Real       | Epoch:49 | Val Acc: 1.0000
 Best site-Real       | Epoch:49 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:49 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:49 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/full...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.9297
 Test site-Infograph | Epoch:49 | Test Acc: 0.5479
 Test site-Painting  | Epoch:49 | Test Acc: 0.9241
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.6390
 Test site-Real      | Epoch:49 | Test Acc: 0.9548
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8953
Average Test Accuracy: 0.8151
===2023-04-21 08:29:27===
===2023-04-21 08:29:28===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.9297
 Test site-Infograph | Epoch:49 | Test Acc: 0.5479
 Test site-Painting  | Epoch:49 | Test Acc: 0.9241
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.6390
 Test site-Real      | Epoch:49 | Test Acc: 0.9548
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8953
Average Test Accuracy: 0.8151
