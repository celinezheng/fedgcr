===2023-04-06 06:37:19===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0879 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 2.0039 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 2.1907 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1905 | Train Acc: 0.2381
 Site-Painting  | Train Loss: 2.0168 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 2.0835 | Train Acc: 0.3492
 Site-QuickDraw | Train Loss: 2.2693 | Train Acc: 0.1429
 Site-QuickDraw | Train Loss: 2.2236 | Train Acc: 0.1905
 Site-Real      | Train Loss: 1.9600 | Train Acc: 0.4127
 Site-Real      | Train Loss: 2.0357 | Train Acc: 0.3175
 Site-Sketch    | Train Loss: 1.9576 | Train Acc: 0.4603
 Site-Sketch    | Train Loss: 1.9614 | Train Acc: 0.4762
 Site-Clipart   | Val  Loss: 2.0149 | Val  Acc: 0.3810
 Site-Clipart   | Val  Loss: 2.0702 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1700 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1757 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.9998 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 2.1616 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.1881 | Val  Acc: 0.2143
 Site-QuickDraw | Val  Loss: 2.1907 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.9757 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 2.0410 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 1.9540 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.0087 | Val  Acc: 0.3333
Average Valid Accuracy: 0.3274
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-Painting   | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2143
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2619
 Best site-Real       | Epoch:0 | Val Acc: 0.3810
 Best site-Real       | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.8021 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.7291 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.1082 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.0463 | Train Acc: 0.3810
 Site-Painting  | Train Loss: 1.6948 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 1.7652 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 2.2137 | Train Acc: 0.2222
 Site-QuickDraw | Train Loss: 2.0713 | Train Acc: 0.3810
 Site-Real      | Train Loss: 1.6084 | Train Acc: 0.6825
 Site-Real      | Train Loss: 1.6807 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.6786 | Train Acc: 0.6032
 Site-Sketch    | Train Loss: 1.7130 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.7245 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.7527 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 2.0262 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1358 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.6776 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 1.8808 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 2.0865 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.1898 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.6291 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 1.7016 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.6784 | Val  Acc: 0.6429
 Site-Sketch    | Val  Loss: 1.7869 | Val  Acc: 0.5952
Average Valid Accuracy: 0.5159
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2143
 Best site-Painting   | Epoch:1 | Val Acc: 0.5952
 Best site-Painting   | Epoch:1 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2619
 Best site-Real       | Epoch:1 | Val Acc: 0.7143
 Best site-Real       | Epoch:1 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.5440 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.5740 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.0164 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.8938 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.4491 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 1.4798 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.1172 | Train Acc: 0.2540
 Site-QuickDraw | Train Loss: 1.9879 | Train Acc: 0.3492
 Site-Real      | Train Loss: 1.3229 | Train Acc: 0.8413
 Site-Real      | Train Loss: 1.3780 | Train Acc: 0.7937
 Site-Sketch    | Train Loss: 1.4581 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.5053 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.5528 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.5534 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8707 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0204 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.4116 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 1.6381 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.9665 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.0527 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.3273 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 1.3993 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.4749 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.5988 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6032
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.7381
 Best site-Painting   | Epoch:2 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3095
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Real       | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.3652 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.3255 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.9302 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.8350 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.2325 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 1.2963 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 2.0244 | Train Acc: 0.2857
 Site-QuickDraw | Train Loss: 1.9242 | Train Acc: 0.3651
 Site-Real      | Train Loss: 1.0609 | Train Acc: 0.8889
 Site-Real      | Train Loss: 1.1183 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 1.2009 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.2738 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.3858 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3195 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7708 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8760 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.1872 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 1.4251 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.8658 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 1.9852 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.0962 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 1.1641 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.2402 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.3185 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6250
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.7857
 Best site-Painting   | Epoch:3 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3095
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Real       | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.2269 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.2016 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.8572 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.7128 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.0669 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 1.1462 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 1.9301 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 1.8266 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.8989 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.9153 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 1.1293 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.2053 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.1725 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1721 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6685 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8086 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.9915 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 1.1839 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.7894 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.9243 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.9242 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.9721 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1558 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.2596 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6667
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4762
 Best site-Painting   | Epoch:4 | Val Acc: 0.8333
 Best site-Painting   | Epoch:4 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2857
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Real       | Epoch:4 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.1439 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.0846 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.8087 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5991 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.9417 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 1.0300 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.8676 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 1.7322 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.7761 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.7531 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.9531 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.0439 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 1.1414 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1187 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.5556 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.8163 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.9044 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 1.1173 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.6296 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.8648 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7762 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.7979 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0403 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.0907 | Val  Acc: 0.7857
Average Valid Accuracy: 0.6944
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.8095
 Best site-Painting   | Epoch:5 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3810
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Real       | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.0618 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.0207 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.7882 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.5526 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.8741 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.9018 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.7854 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 1.6645 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.6083 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.6475 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.8604 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.0179 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0239 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0284 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.4884 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7230 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.8515 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.0490 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.5640 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.7836 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.6429 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.7208 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9539 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.0386 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7282
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4762
 Best site-Painting   | Epoch:6 | Val Acc: 0.8571
 Best site-Painting   | Epoch:6 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4524
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Real       | Epoch:6 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.8996 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9108 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.7629 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5040 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.6971 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.8044 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.6855 | Train Acc: 0.4921
 Site-QuickDraw | Train Loss: 1.5847 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.5735 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.6161 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.7893 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.8975 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.9006 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 1.0423 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.4177 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.6554 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.7316 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.9129 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.4352 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.6488 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.5157 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.6122 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.9533 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 0.9973 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7381
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8571
 Best site-Painting   | Epoch:7 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5238
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.8669 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8960 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.6748 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.4370 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.7002 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.7474 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.6212 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.4779 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.5270 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.4976 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.7348 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.8420 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.9359 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9111 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3417 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5759 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.6588 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.8147 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.3636 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.5529 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.5394 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.4969 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7658 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.8867 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7817
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5476
 Best site-Painting   | Epoch:8 | Val Acc: 0.9048
 Best site-Painting   | Epoch:8 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5714
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.8527 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.7639 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.6363 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4169 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.6017 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.6796 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.6124 | Train Acc: 0.4762
 Site-QuickDraw | Train Loss: 1.4498 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.4559 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.4482 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6858 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7861 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.7568 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.7886 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3602 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.5464 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.5255 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.7755 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.2976 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.5247 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.4307 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.4426 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7841 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8287 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7817
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-Clipart   | Train Loss: 0.7487 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7252 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.6189 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3522 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.5941 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.6677 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.4131 | Train Acc: 0.6349
 Site-QuickDraw | Train Loss: 1.3720 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.4524 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.3884 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.6715 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.7189 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.7737 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7945 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3154 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5071 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.5719 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.7219 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.2627 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.5384 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.3717 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.4058 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7256 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7232 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7937
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:10 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:10 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5476
 Best site-Painting   | Epoch:10 | Val Acc: 0.9286
 Best site-Painting   | Epoch:10 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.5714
 Best site-Real       | Epoch:10 | Val Acc: 0.9524
 Best site-Real       | Epoch:10 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:10 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-Clipart   | Train Loss: 0.6704 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7849 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.5942 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2981 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.5440 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.5957 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.4839 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.3030 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.3761 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.3728 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.6222 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6517 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.7522 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7121 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3294 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4415 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.4798 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.6765 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.2228 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.4434 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.3568 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3931 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6470 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7620 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8016
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5952
 Best site-Painting   | Epoch:11 | Val Acc: 0.9286
 Best site-Painting   | Epoch:11 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.7381
 Best site-Real       | Epoch:11 | Val Acc: 0.9762
 Best site-Real       | Epoch:11 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:11 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:11 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-Clipart   | Train Loss: 0.6727 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6694 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.5362 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2855 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.5317 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.5797 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.4541 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 1.2682 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.3596 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.3379 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5917 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.6473 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6616 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6381 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.2639 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.4796 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.4508 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.7525 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.2071 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.4666 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.3270 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.3520 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6130 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.6351 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8016
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-Clipart   | Train Loss: 0.7108 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6388 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.5732 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1938 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.4633 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.5752 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.3491 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.2247 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.3123 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.2998 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5672 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.6400 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.6198 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6013 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.2318 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.4007 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.4381 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.6232 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.0831 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.2994 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2809 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3201 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5829 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7761 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8254
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6667
 Best site-Painting   | Epoch:13 | Val Acc: 0.9762
 Best site-Painting   | Epoch:13 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.6190
 Best site-Real       | Epoch:13 | Val Acc: 0.9762
 Best site-Real       | Epoch:13 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-Clipart   | Train Loss: 0.6146 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.6210 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.4662 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.2038 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.4985 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.5013 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.3010 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.1987 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.2896 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.3189 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5632 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5890 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.7287 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6914 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1349 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3287 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.4417 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5455 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.0770 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.3152 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.2739 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2975 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5932 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.5509 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8254
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-Clipart   | Train Loss: 0.5441 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5960 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.6119 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.1527 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4473 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.4580 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.2537 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 1.1617 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.2859 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.2729 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4646 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5267 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6219 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6089 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1207 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3858 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.3895 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.5177 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.0281 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2704 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2673 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3172 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5737 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7233 | Val  Acc: 0.7619
Average Valid Accuracy: 0.8194
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-Clipart   | Train Loss: 0.6353 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.5578 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.4503 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.1126 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4042 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.4531 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.2031 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.1236 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.2776 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.2665 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5433 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.5753 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.6255 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6334 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0571 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3591 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.3516 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5104 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.0329 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.2374 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.2819 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3067 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5794 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.6645 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8353
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:16 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:16 | Val Acc: 0.6190
 Best site-Painting   | Epoch:16 | Val Acc: 0.9524
 Best site-Painting   | Epoch:16 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.6905
 Best site-Real       | Epoch:16 | Val Acc: 0.9762
 Best site-Real       | Epoch:16 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-Clipart   | Train Loss: 0.5187 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5242 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.4561 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1421 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.3913 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.4321 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.2404 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.0783 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.2088 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.2231 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5110 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.5347 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.4944 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6006 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1268 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2868 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.3899 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.4810 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 0.9812 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.1736 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.2360 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2959 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5796 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.5133 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8294
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-Clipart   | Train Loss: 0.5374 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.5242 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.4978 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1483 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.3849 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.3752 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.2276 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.0716 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.2155 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1954 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4286 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.4547 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.5510 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5633 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0746 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2246 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.3234 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.4189 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 0.9676 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.1725 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.2396 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2498 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5101 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6463 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8373
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:18 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:18 | Val Acc: 0.7143
 Best site-Painting   | Epoch:18 | Val Acc: 0.9762
 Best site-Painting   | Epoch:18 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.6667
 Best site-Real       | Epoch:18 | Val Acc: 0.9762
 Best site-Real       | Epoch:18 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:18 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-Clipart   | Train Loss: 0.5288 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.5417 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.3956 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0625 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.3410 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3730 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.2548 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.1576 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1918 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1998 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4168 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.5357 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.6133 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5524 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1033 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2282 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.3815 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.4441 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 0.9503 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.2705 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.1993 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2273 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4757 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.4323 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8214
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-Clipart   | Train Loss: 0.4988 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.4611 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.4062 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0462 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.3638 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.4067 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.1167 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 1.0902 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.2210 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.2214 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3849 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4971 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5617 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4630 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.0283 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1566 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.2412 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3608 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.9223 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.1064 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.1849 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2515 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5363 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.6047 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8631
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:20 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:20 | Val Acc: 0.7381
 Best site-Painting   | Epoch:20 | Val Acc: 1.0000
 Best site-Painting   | Epoch:20 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.7381
 Best site-Real       | Epoch:20 | Val Acc: 0.9524
 Best site-Real       | Epoch:20 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:20 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:20 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-Clipart   | Train Loss: 0.4752 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4739 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.3614 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0094 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.3159 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3881 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.0742 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 0.9432 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.2012 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.2170 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.4143 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4790 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.4886 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5246 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9873 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1757 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.3105 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4060 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.8634 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2091 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.1950 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2057 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4449 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.5679 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8492
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-Clipart   | Train Loss: 0.4703 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4401 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.3865 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 0.9949 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.3277 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.3414 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.0495 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 0.8967 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1863 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1896 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3512 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4486 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4773 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4691 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0098 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1894 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.2720 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3740 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.8238 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.0278 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.1996 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2098 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4048 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.4402 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8631
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-Clipart   | Train Loss: 0.5150 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4192 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.3415 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9860 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.3211 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.3116 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.0642 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 0.9594 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1791 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1918 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4229 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.4838 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4816 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5271 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9655 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1057 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.2582 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3944 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.7926 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.9722 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.1572 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1717 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4027 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.4987 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8690
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:23 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:23 | Val Acc: 0.7381
 Best site-Painting   | Epoch:23 | Val Acc: 1.0000
 Best site-Painting   | Epoch:23 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.7143
 Best site-Real       | Epoch:23 | Val Acc: 0.9762
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:23 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-Clipart   | Train Loss: 0.5137 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4700 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.2901 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9039 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.2977 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2783 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.0917 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 0.9262 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.1497 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1573 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3694 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4361 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5003 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4513 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9636 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1071 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.2715 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3551 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.8420 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 0.9651 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 0.1827 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1508 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3871 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.3539 | Val  Acc: 0.9524
Average Valid Accuracy: 0.8889
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:24 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:24 | Val Acc: 0.7619
 Best site-Painting   | Epoch:24 | Val Acc: 1.0000
 Best site-Painting   | Epoch:24 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.8095
 Best site-Real       | Epoch:24 | Val Acc: 1.0000
 Best site-Real       | Epoch:24 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:24 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:24 | Val Acc: 0.9524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-Clipart   | Train Loss: 0.4621 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.4396 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.2345 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9442 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2752 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3697 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.0160 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 0.8785 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1672 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1401 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3439 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4487 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.4695 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4462 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9649 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1404 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.2354 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2792 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.8742 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.0327 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.1206 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1440 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4232 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4060 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8750
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-Clipart   | Train Loss: 0.4010 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4156 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.3215 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 0.9003 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.2869 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2579 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9650 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 0.8048 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.1641 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1511 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3614 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3456 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.4760 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4056 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9095 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0768 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.1900 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3861 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.7175 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 0.9221 | Val  Acc: 0.7857
 Site-Real      | Val  Loss: 0.1558 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1853 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3960 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.5078 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8869
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-Clipart   | Train Loss: 0.4280 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4171 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.2690 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.9184 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.3089 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2779 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 0.9401 | Train Acc: 0.7619
 Site-QuickDraw | Train Loss: 0.7805 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.1260 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1367 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3226 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3710 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4499 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4541 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9269 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1093 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.1976 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2719 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.7932 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 0.7551 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.1302 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1254 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3462 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4316 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8909
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:27 | Val Acc: 0.6905
 Best site-Painting   | Epoch:27 | Val Acc: 1.0000
 Best site-Painting   | Epoch:27 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.9048
 Best site-Real       | Epoch:27 | Val Acc: 1.0000
 Best site-Real       | Epoch:27 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:27 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:27 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-Clipart   | Train Loss: 0.4198 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3854 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.2707 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.8766 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.2471 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2453 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9117 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 0.8601 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.1406 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1440 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3349 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3795 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.4644 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4061 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7976 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0037 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.1841 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2782 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.8424 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 0.8829 | Val  Acc: 0.7857
 Site-Real      | Val  Loss: 0.1616 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.2310 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3453 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5111 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8849
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-Clipart   | Train Loss: 0.4545 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.4197 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.1918 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.8445 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2685 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.3111 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 0.9931 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 0.7740 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.1253 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1305 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3413 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3470 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.4138 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4497 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.7870 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9633 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 0.1665 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2937 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 0.7749 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 0.7828 | Val  Acc: 0.8333
 Site-Real      | Val  Loss: 0.1292 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1960 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3891 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.4136 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8889
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-Clipart   | Train Loss: 0.4133 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.3881 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.2228 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.8766 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.2270 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2823 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 0.9780 | Train Acc: 0.7619
 Site-QuickDraw | Train Loss: 0.8087 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.1262 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1162 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2715 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3083 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.4418 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3371 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8687 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9828 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.2206 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2341 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.8326 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 0.8917 | Val  Acc: 0.7857
 Site-Real      | Val  Loss: 0.1108 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1222 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3214 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5160 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8869
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-Clipart   | Train Loss: 0.3536 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4461 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.1196 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8535 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.2456 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2402 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9521 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 0.7093 | Train Acc: 0.8413
 Site-Real      | Train Loss: 0.1213 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1300 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3215 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3573 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.4526 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3868 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7970 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9640 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.1705 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2549 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.7366 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 0.8327 | Val  Acc: 0.7619
 Site-Real      | Val  Loss: 0.1014 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1283 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3433 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5340 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8988
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:31 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:31 | Val Acc: 0.7619
 Best site-Painting   | Epoch:31 | Val Acc: 0.9762
 Best site-Painting   | Epoch:31 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.7619
 Best site-Real       | Epoch:31 | Val Acc: 1.0000
 Best site-Real       | Epoch:31 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:31 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:31 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-Clipart   | Train Loss: 0.3839 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3468 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.2595 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.7866 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.1909 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.2095 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.8692 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 0.8998 | Train Acc: 0.7937
 Site-Real      | Train Loss: 0.1085 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1268 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2879 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3154 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3771 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4393 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.8105 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0245 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.1506 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2111 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.8276 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.8174 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 0.1689 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2052 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.2482 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3639 | Val  Acc: 0.9524
Average Valid Accuracy: 0.8929
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-Clipart   | Train Loss: 0.3272 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3805 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.1478 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8264 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.2135 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2123 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.8391 | Train Acc: 0.7619
 Site-QuickDraw | Train Loss: 0.7055 | Train Acc: 0.8254
 Site-Real      | Train Loss: 0.0979 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1225 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3009 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3582 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.4107 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3986 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8076 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.9359 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.2008 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2415 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.6515 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 0.6864 | Val  Acc: 0.8333
 Site-Real      | Val  Loss: 0.1137 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1153 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3287 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4116 | Val  Acc: 0.8810
Average Valid Accuracy: 0.9087
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:33 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:33 | Val Acc: 0.8571
 Best site-Painting   | Epoch:33 | Val Acc: 1.0000
 Best site-Painting   | Epoch:33 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.8333
 Best site-Real       | Epoch:33 | Val Acc: 1.0000
 Best site-Real       | Epoch:33 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:33 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:33 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-Clipart   | Train Loss: 0.3085 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3887 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.1548 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.8149 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.2082 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.2253 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 0.8948 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 0.6965 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.1102 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1229 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3113 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2814 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.4003 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3878 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7513 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9870 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 0.1978 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.1917 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.5999 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 0.8148 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 0.1033 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1614 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2872 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4596 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9087
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-Clipart   | Train Loss: 0.3082 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3652 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0347 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.7683 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.2298 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1848 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.7455 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 0.6517 | Train Acc: 0.8413
 Site-Real      | Train Loss: 0.0968 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1292 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2542 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3371 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3433 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3718 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.7160 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9705 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.1721 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2456 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.6657 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 0.6518 | Val  Acc: 0.8810
 Site-Real      | Val  Loss: 0.1074 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1108 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3056 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4040 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9167
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:35 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:35 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:35 | Val Acc: 0.7619
 Best site-Painting   | Epoch:35 | Val Acc: 1.0000
 Best site-Painting   | Epoch:35 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:35 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:35 | Val Acc: 0.8810
 Best site-Real       | Epoch:35 | Val Acc: 0.9762
 Best site-Real       | Epoch:35 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:35 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:35 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-Clipart   | Train Loss: 0.2958 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2964 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.1247 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.7341 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.1814 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1670 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.9401 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 0.6940 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.1216 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0989 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2681 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.2901 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3430 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3551 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.6759 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9236 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 0.1033 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2093 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.6416 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 0.7809 | Val  Acc: 0.8333
 Site-Real      | Val  Loss: 0.1138 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1277 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3031 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4343 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9167
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-Clipart   | Train Loss: 0.2359 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3219 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0822 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7269 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.2041 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1640 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.7999 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 0.6827 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.0958 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1077 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2933 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3118 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.4596 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3446 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.6374 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.8861 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.1316 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2202 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.6648 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 0.7387 | Val  Acc: 0.8095
 Site-Real      | Val  Loss: 0.1069 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1639 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.2023 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3391 | Val  Acc: 0.9524
Average Valid Accuracy: 0.9067
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-Clipart   | Train Loss: 0.3128 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2981 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.0695 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.7296 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.1647 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1754 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 0.7725 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 0.7183 | Train Acc: 0.7937
 Site-Real      | Train Loss: 0.0995 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0951 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2243 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3279 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3239 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3121 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.6249 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.8485 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.1194 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2021 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.6122 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 0.6090 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.0832 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1363 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2910 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3229 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9266
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:38 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:38 | Val Acc: 0.8333
 Best site-Painting   | Epoch:38 | Val Acc: 1.0000
 Best site-Painting   | Epoch:38 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.9286
 Best site-Real       | Epoch:38 | Val Acc: 1.0000
 Best site-Real       | Epoch:38 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:38 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:38 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-Clipart   | Train Loss: 0.3501 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.2894 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.1205 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.7516 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.1522 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1607 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.8655 | Train Acc: 0.7619
 Site-QuickDraw | Train Loss: 0.6159 | Train Acc: 0.8571
 Site-Real      | Train Loss: 0.0725 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0793 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2447 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2863 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.2980 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2612 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7102 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.8329 | Val  Acc: 0.8333
 Site-Painting  | Val  Loss: 0.1139 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1509 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 0.5468 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 0.6609 | Val  Acc: 0.8333
 Site-Real      | Val  Loss: 0.0850 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0775 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2438 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.2853 | Val  Acc: 0.9524
Average Valid Accuracy: 0.9345
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:39 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:39 | Val Acc: 0.8333
 Best site-Painting   | Epoch:39 | Val Acc: 1.0000
 Best site-Painting   | Epoch:39 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.8333
 Best site-Real       | Epoch:39 | Val Acc: 1.0000
 Best site-Real       | Epoch:39 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:39 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:39 | Val Acc: 0.9524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/DoPrompt...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8574
 Test site-Infograph | Epoch:39 | Test Acc: 0.5129
 Test site-Painting  | Epoch:39 | Test Acc: 0.8837
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.6650
 Test site-Real      | Epoch:39 | Test Acc: 0.9343
 Test site-Sketch    | Epoch:39 | Test Acc: 0.8520
Average Test Accuracy: 0.7842
===2023-04-06 08:49:27===
===2023-04-06 08:49:28===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8574
 Test site-Infograph | Epoch:39 | Test Acc: 0.5129
 Test site-Painting  | Epoch:39 | Test Acc: 0.8837
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.6650
 Test site-Real      | Epoch:39 | Test Acc: 0.9343
 Test site-Sketch    | Epoch:39 | Test Acc: 0.8520
Average Test Accuracy: 0.7842
