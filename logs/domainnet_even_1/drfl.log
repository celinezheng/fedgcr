===2023-04-18 22:42:31===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 2.2057 | Train Acc: 0.1905
 Site-Clipart   | Train Loss: 2.2009 | Train Acc: 0.1845
 Site-Infograph | Train Loss: 2.2647 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2896 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.3188 | Train Acc: 0.1724
 Site-Painting  | Train Loss: 2.2585 | Train Acc: 0.1724
 Site-QuickDraw | Train Loss: 2.3485 | Train Acc: 0.0312
 Site-QuickDraw | Train Loss: 2.3174 | Train Acc: 0.1094
 Site-Real      | Train Loss: 2.2917 | Train Acc: 0.1579
 Site-Real      | Train Loss: 2.3043 | Train Acc: 0.1299
 Site-Sketch    | Train Loss: 2.1525 | Train Acc: 0.1714
 Site-Sketch    | Train Loss: 2.2822 | Train Acc: 0.1857
 Site-Clipart   | Val  Loss: 2.1675 | Val  Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.1748 | Val  Acc: 0.2411
 Site-Infograph | Val  Loss: 2.3060 | Val  Acc: 0.1000
 Site-Infograph | Val  Loss: 2.1903 | Val  Acc: 0.2683
 Site-Painting  | Val  Loss: 2.2894 | Val  Acc: 0.2632
 Site-Painting  | Val  Loss: 2.3030 | Val  Acc: 0.1538
 Site-QuickDraw | Val  Loss: 1.9743 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.2690 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 2.3232 | Val  Acc: 0.0400
 Site-Real      | Val  Loss: 2.2851 | Val  Acc: 0.0784
 Site-Sketch    | Val  Loss: 2.2677 | Val  Acc: 0.2174
 Site-Sketch    | Val  Loss: 2.3045 | Val  Acc: 0.1522
Average Valid Accuracy: 0.1718
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2857
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2411
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2683
 Best site-Painting   | Epoch:0 | Val Acc: 0.2632
 Best site-Painting   | Epoch:0 | Val Acc: 0.1538
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.0400
 Best site-Real       | Epoch:0 | Val Acc: 0.0784
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2174
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.0908 | Train Acc: 0.3452
 Site-Clipart   | Train Loss: 2.0706 | Train Acc: 0.3690
 Site-Infograph | Train Loss: 2.2280 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.2441 | Train Acc: 0.2097
 Site-Painting  | Train Loss: 2.1564 | Train Acc: 0.2759
 Site-Painting  | Train Loss: 2.1912 | Train Acc: 0.2241
 Site-QuickDraw | Train Loss: 2.3733 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.2959 | Train Acc: 0.1562
 Site-Real      | Train Loss: 2.1398 | Train Acc: 0.2632
 Site-Real      | Train Loss: 2.1839 | Train Acc: 0.1818
 Site-Sketch    | Train Loss: 2.0186 | Train Acc: 0.3429
 Site-Sketch    | Train Loss: 2.1808 | Train Acc: 0.3857
 Site-Clipart   | Val  Loss: 2.0284 | Val  Acc: 0.4643
 Site-Clipart   | Val  Loss: 2.0815 | Val  Acc: 0.3393
 Site-Infograph | Val  Loss: 2.2312 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.2031 | Val  Acc: 0.1220
 Site-Painting  | Val  Loss: 2.2810 | Val  Acc: 0.1579
 Site-Painting  | Val  Loss: 2.2107 | Val  Acc: 0.1795
 Site-QuickDraw | Val  Loss: 1.9591 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2422 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.2448 | Val  Acc: 0.0800
 Site-Real      | Val  Loss: 2.1796 | Val  Acc: 0.1569
 Site-Sketch    | Val  Loss: 2.1771 | Val  Acc: 0.1739
 Site-Sketch    | Val  Loss: 2.1971 | Val  Acc: 0.3043
Average Valid Accuracy: 0.2132
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4643
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3393
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1220
 Best site-Painting   | Epoch:1 | Val Acc: 0.1579
 Best site-Painting   | Epoch:1 | Val Acc: 0.1795
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1429
 Best site-Real       | Epoch:1 | Val Acc: 0.0800
 Best site-Real       | Epoch:1 | Val Acc: 0.1569
 Best site-Sketch     | Epoch:1 | Val Acc: 0.1739
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 2.0613 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9863 | Train Acc: 0.3988
 Site-Infograph | Train Loss: 2.2594 | Train Acc: 0.1290
 Site-Infograph | Train Loss: 2.2133 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1046 | Train Acc: 0.3448
 Site-Painting  | Train Loss: 2.0873 | Train Acc: 0.2759
 Site-QuickDraw | Train Loss: 2.3398 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.2409 | Train Acc: 0.1094
 Site-Real      | Train Loss: 2.0569 | Train Acc: 0.2895
 Site-Real      | Train Loss: 2.0606 | Train Acc: 0.3896
 Site-Sketch    | Train Loss: 1.9247 | Train Acc: 0.4571
 Site-Sketch    | Train Loss: 2.0656 | Train Acc: 0.3857
 Site-Clipart   | Val  Loss: 1.9217 | Val  Acc: 0.5179
 Site-Clipart   | Val  Loss: 1.9371 | Val  Acc: 0.4643
 Site-Infograph | Val  Loss: 2.1793 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2327 | Val  Acc: 0.0976
 Site-Painting  | Val  Loss: 2.2181 | Val  Acc: 0.1579
 Site-Painting  | Val  Loss: 2.1059 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.9809 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.2170 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.1444 | Val  Acc: 0.0800
 Site-Real      | Val  Loss: 2.1323 | Val  Acc: 0.2549
 Site-Sketch    | Val  Loss: 2.0145 | Val  Acc: 0.4348
 Site-Sketch    | Val  Loss: 2.0742 | Val  Acc: 0.4348
Average Valid Accuracy: 0.2858
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5179
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4643
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.0976
 Best site-Painting   | Epoch:2 | Val Acc: 0.1579
 Best site-Painting   | Epoch:2 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1667
 Best site-Real       | Epoch:2 | Val Acc: 0.0800
 Best site-Real       | Epoch:2 | Val Acc: 0.2549
 Best site-Sketch     | Epoch:2 | Val Acc: 0.4348
 Best site-Sketch     | Epoch:2 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 1.9442 | Train Acc: 0.4524
 Site-Clipart   | Train Loss: 1.8717 | Train Acc: 0.4226
 Site-Infograph | Train Loss: 2.2577 | Train Acc: 0.1290
 Site-Infograph | Train Loss: 2.1653 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0259 | Train Acc: 0.4138
 Site-Painting  | Train Loss: 2.0463 | Train Acc: 0.3448
 Site-QuickDraw | Train Loss: 2.2713 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.2165 | Train Acc: 0.1406
 Site-Real      | Train Loss: 1.8738 | Train Acc: 0.4737
 Site-Real      | Train Loss: 1.9907 | Train Acc: 0.4026
 Site-Sketch    | Train Loss: 1.9325 | Train Acc: 0.4286
 Site-Sketch    | Train Loss: 1.9649 | Train Acc: 0.4714
 Site-Clipart   | Val  Loss: 1.8279 | Val  Acc: 0.4643
 Site-Clipart   | Val  Loss: 1.8340 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.1724 | Val  Acc: 0.1500
 Site-Infograph | Val  Loss: 2.1568 | Val  Acc: 0.2683
 Site-Painting  | Val  Loss: 2.1299 | Val  Acc: 0.2632
 Site-Painting  | Val  Loss: 2.0509 | Val  Acc: 0.3590
 Site-QuickDraw | Val  Loss: 1.9444 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.1685 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.0286 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 2.0303 | Val  Acc: 0.3725
 Site-Sketch    | Val  Loss: 1.9789 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 1.9722 | Val  Acc: 0.4783
Average Valid Accuracy: 0.3360
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4643
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.1500
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2683
 Best site-Painting   | Epoch:3 | Val Acc: 0.2632
 Best site-Painting   | Epoch:3 | Val Acc: 0.3590
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1905
 Best site-Real       | Epoch:3 | Val Acc: 0.4000
 Best site-Real       | Epoch:3 | Val Acc: 0.3725
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:3 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.8410 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.7451 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 2.2205 | Train Acc: 0.1290
 Site-Infograph | Train Loss: 2.1317 | Train Acc: 0.2419
 Site-Painting  | Train Loss: 1.9335 | Train Acc: 0.4138
 Site-Painting  | Train Loss: 1.9994 | Train Acc: 0.3793
 Site-QuickDraw | Train Loss: 2.2631 | Train Acc: 0.0938
 Site-QuickDraw | Train Loss: 2.1830 | Train Acc: 0.1719
 Site-Real      | Train Loss: 1.8268 | Train Acc: 0.5000
 Site-Real      | Train Loss: 1.8537 | Train Acc: 0.5195
 Site-Sketch    | Train Loss: 1.6663 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 1.8654 | Train Acc: 0.4714
 Site-Clipart   | Val  Loss: 1.7094 | Val  Acc: 0.5357
 Site-Clipart   | Val  Loss: 1.7275 | Val  Acc: 0.5446
 Site-Infograph | Val  Loss: 2.0695 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.1303 | Val  Acc: 0.2927
 Site-Painting  | Val  Loss: 1.9730 | Val  Acc: 0.3684
 Site-Painting  | Val  Loss: 2.0023 | Val  Acc: 0.4103
 Site-QuickDraw | Val  Loss: 1.9330 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.1908 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9250 | Val  Acc: 0.4400
 Site-Real      | Val  Loss: 1.9008 | Val  Acc: 0.4706
 Site-Sketch    | Val  Loss: 1.9121 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 1.9497 | Val  Acc: 0.4348
Average Valid Accuracy: 0.3688
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5357
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5446
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2927
 Best site-Painting   | Epoch:4 | Val Acc: 0.3684
 Best site-Painting   | Epoch:4 | Val Acc: 0.4103
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1429
 Best site-Real       | Epoch:4 | Val Acc: 0.4400
 Best site-Real       | Epoch:4 | Val Acc: 0.4706
 Best site-Sketch     | Epoch:4 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:4 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 1.7425 | Train Acc: 0.5119
 Site-Clipart   | Train Loss: 1.6286 | Train Acc: 0.6905
 Site-Infograph | Train Loss: 2.1624 | Train Acc: 0.1935
 Site-Infograph | Train Loss: 2.0637 | Train Acc: 0.3065
 Site-Painting  | Train Loss: 1.8433 | Train Acc: 0.5517
 Site-Painting  | Train Loss: 1.8639 | Train Acc: 0.4828
 Site-QuickDraw | Train Loss: 2.2631 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.1517 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7111 | Train Acc: 0.6316
 Site-Real      | Train Loss: 1.7589 | Train Acc: 0.5584
 Site-Sketch    | Train Loss: 1.5702 | Train Acc: 0.4857
 Site-Sketch    | Train Loss: 1.8041 | Train Acc: 0.5571
 Site-Clipart   | Val  Loss: 1.6225 | Val  Acc: 0.6607
 Site-Clipart   | Val  Loss: 1.6215 | Val  Acc: 0.5982
 Site-Infograph | Val  Loss: 1.9546 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 2.0865 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.8143 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.9582 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 1.9201 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.1562 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9121 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.7629 | Val  Acc: 0.6275
 Site-Sketch    | Val  Loss: 1.8166 | Val  Acc: 0.4783
 Site-Sketch    | Val  Loss: 1.8306 | Val  Acc: 0.5435
Average Valid Accuracy: 0.4605
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6607
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5982
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3171
 Best site-Painting   | Epoch:5 | Val Acc: 0.5789
 Best site-Painting   | Epoch:5 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.1905
 Best site-Real       | Epoch:5 | Val Acc: 0.4000
 Best site-Real       | Epoch:5 | Val Acc: 0.6275
 Best site-Sketch     | Epoch:5 | Val Acc: 0.4783
 Best site-Sketch     | Epoch:5 | Val Acc: 0.5435
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 1.6392 | Train Acc: 0.6548
 Site-Clipart   | Train Loss: 1.5689 | Train Acc: 0.7083
 Site-Infograph | Train Loss: 2.2192 | Train Acc: 0.1290
 Site-Infograph | Train Loss: 2.0471 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.7822 | Train Acc: 0.5862
 Site-Painting  | Train Loss: 1.7984 | Train Acc: 0.6034
 Site-QuickDraw | Train Loss: 2.1953 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.1560 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7230 | Train Acc: 0.6316
 Site-Real      | Train Loss: 1.6907 | Train Acc: 0.6234
 Site-Sketch    | Train Loss: 1.5524 | Train Acc: 0.6000
 Site-Sketch    | Train Loss: 1.6969 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5007 | Val  Acc: 0.7321
 Site-Clipart   | Val  Loss: 1.5326 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.9751 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0436 | Val  Acc: 0.3659
 Site-Painting  | Val  Loss: 1.8391 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.9104 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 1.8638 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.1377 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.7355 | Val  Acc: 0.6000
 Site-Real      | Val  Loss: 1.6743 | Val  Acc: 0.6275
 Site-Sketch    | Val  Loss: 1.7218 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 1.7591 | Val  Acc: 0.5435
Average Valid Accuracy: 0.5230
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7321
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3659
 Best site-Painting   | Epoch:6 | Val Acc: 0.6842
 Best site-Painting   | Epoch:6 | Val Acc: 0.6410
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.1905
 Best site-Real       | Epoch:6 | Val Acc: 0.6000
 Best site-Real       | Epoch:6 | Val Acc: 0.6275
 Best site-Sketch     | Epoch:6 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:6 | Val Acc: 0.5435
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 1.5377 | Train Acc: 0.6548
 Site-Clipart   | Train Loss: 1.4637 | Train Acc: 0.7679
 Site-Infograph | Train Loss: 2.1765 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.0104 | Train Acc: 0.4032
 Site-Painting  | Train Loss: 1.7039 | Train Acc: 0.5862
 Site-Painting  | Train Loss: 1.7376 | Train Acc: 0.6207
 Site-QuickDraw | Train Loss: 2.2104 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.0938 | Train Acc: 0.2656
 Site-Real      | Train Loss: 1.5752 | Train Acc: 0.6842
 Site-Real      | Train Loss: 1.6037 | Train Acc: 0.7273
 Site-Sketch    | Train Loss: 1.3948 | Train Acc: 0.6000
 Site-Sketch    | Train Loss: 1.6925 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.4323 | Val  Acc: 0.6786
 Site-Clipart   | Val  Loss: 1.4155 | Val  Acc: 0.7768
 Site-Infograph | Val  Loss: 1.9682 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9929 | Val  Acc: 0.3902
 Site-Painting  | Val  Loss: 1.6578 | Val  Acc: 0.5263
 Site-Painting  | Val  Loss: 1.7921 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 1.9427 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.0856 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.6332 | Val  Acc: 0.6400
 Site-Real      | Val  Loss: 1.6199 | Val  Acc: 0.7059
 Site-Sketch    | Val  Loss: 1.5878 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.6867 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5367
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6786
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7768
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3902
 Best site-Painting   | Epoch:7 | Val Acc: 0.5263
 Best site-Painting   | Epoch:7 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2381
 Best site-Real       | Epoch:7 | Val Acc: 0.6400
 Best site-Real       | Epoch:7 | Val Acc: 0.7059
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 1.4511 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.4054 | Train Acc: 0.7738
 Site-Infograph | Train Loss: 2.1150 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.9672 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.6352 | Train Acc: 0.5172
 Site-Painting  | Train Loss: 1.6388 | Train Acc: 0.6207
 Site-QuickDraw | Train Loss: 2.1923 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.0535 | Train Acc: 0.2656
 Site-Real      | Train Loss: 1.5468 | Train Acc: 0.7368
 Site-Real      | Train Loss: 1.5135 | Train Acc: 0.7403
 Site-Sketch    | Train Loss: 1.4540 | Train Acc: 0.5429
 Site-Sketch    | Train Loss: 1.5755 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.3207 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.3356 | Val  Acc: 0.7768
 Site-Infograph | Val  Loss: 1.8572 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 2.0003 | Val  Acc: 0.3415
 Site-Painting  | Val  Loss: 1.6110 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.7880 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 1.9193 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.0836 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.5808 | Val  Acc: 0.7200
 Site-Real      | Val  Loss: 1.5710 | Val  Acc: 0.7647
 Site-Sketch    | Val  Loss: 1.5794 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.5901 | Val  Acc: 0.6304
Average Valid Accuracy: 0.5765
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7768
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:8 | Val Acc: 0.3415
 Best site-Painting   | Epoch:8 | Val Acc: 0.6316
 Best site-Painting   | Epoch:8 | Val Acc: 0.6410
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2381
 Best site-Real       | Epoch:8 | Val Acc: 0.7200
 Best site-Real       | Epoch:8 | Val Acc: 0.7647
 Best site-Sketch     | Epoch:8 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:8 | Val Acc: 0.6304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.3913 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.3222 | Train Acc: 0.8155
 Site-Infograph | Train Loss: 2.1364 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 1.9312 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.5740 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.5506 | Train Acc: 0.7069
 Site-QuickDraw | Train Loss: 2.2117 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.0581 | Train Acc: 0.3594
 Site-Real      | Train Loss: 1.4943 | Train Acc: 0.7895
 Site-Real      | Train Loss: 1.4424 | Train Acc: 0.7662
 Site-Sketch    | Train Loss: 1.3437 | Train Acc: 0.6286
 Site-Sketch    | Train Loss: 1.4512 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2655 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.3085 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 1.8799 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.9617 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 1.5350 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.7065 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 1.8437 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.0164 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.5253 | Val  Acc: 0.7200
 Site-Real      | Val  Loss: 1.4607 | Val  Acc: 0.7255
 Site-Sketch    | Val  Loss: 1.5518 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 1.5331 | Val  Acc: 0.6522
Average Valid Accuracy: 0.5848
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7679
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4634
 Best site-Painting   | Epoch:9 | Val Acc: 0.6316
 Best site-Painting   | Epoch:9 | Val Acc: 0.6410
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2857
 Best site-Real       | Epoch:9 | Val Acc: 0.7200
 Best site-Real       | Epoch:9 | Val Acc: 0.7255
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7186
 Test site-Infograph | Epoch:9 | Test Acc: 0.3653
 Test site-Painting  | Epoch:9 | Test Acc: 0.7254
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2580
 Test site-Real      | Epoch:9 | Test Acc: 0.7798
 Test site-Sketch    | Epoch:9 | Test Acc: 0.6552
Average Test Accuracy: 0.5837
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 1.3642 | Train Acc: 0.7262
 Site-Clipart   | Train Loss: 1.2792 | Train Acc: 0.7798
 Site-Infograph | Train Loss: 2.1521 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.9049 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.4630 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.4810 | Train Acc: 0.6724
 Site-QuickDraw | Train Loss: 2.1737 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 2.0014 | Train Acc: 0.3281
 Site-Real      | Train Loss: 1.3704 | Train Acc: 0.7632
 Site-Real      | Train Loss: 1.3612 | Train Acc: 0.7792
 Site-Sketch    | Train Loss: 1.2812 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.3894 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2198 | Val  Acc: 0.8393
 Site-Clipart   | Val  Loss: 1.2266 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.8237 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.8836 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 1.4611 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.5706 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.8978 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.0474 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.5168 | Val  Acc: 0.6800
 Site-Real      | Val  Loss: 1.3477 | Val  Acc: 0.7843
 Site-Sketch    | Val  Loss: 1.4343 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.4711 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6445
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8393
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:10 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5122
 Best site-Painting   | Epoch:10 | Val Acc: 0.7368
 Best site-Painting   | Epoch:10 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.2381
 Best site-Real       | Epoch:10 | Val Acc: 0.6800
 Best site-Real       | Epoch:10 | Val Acc: 0.7843
 Best site-Sketch     | Epoch:10 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:10 | Val Acc: 0.7174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 1.3402 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.2205 | Train Acc: 0.8036
 Site-Infograph | Train Loss: 2.0630 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8644 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 1.4530 | Train Acc: 0.7241
 Site-Painting  | Train Loss: 1.3802 | Train Acc: 0.7586
 Site-QuickDraw | Train Loss: 2.1473 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 1.9874 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.2759 | Train Acc: 0.8421
 Site-Real      | Train Loss: 1.2868 | Train Acc: 0.8052
 Site-Sketch    | Train Loss: 1.3566 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.3369 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1592 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.1841 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.8091 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.8900 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 1.3497 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.6111 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.9721 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 1.9874 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.4099 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 1.2541 | Val  Acc: 0.8431
 Site-Sketch    | Val  Loss: 1.3800 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.4245 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6389
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 1.2475 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.1501 | Train Acc: 0.8274
 Site-Infograph | Train Loss: 1.9743 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.8311 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 1.3763 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.4023 | Train Acc: 0.7759
 Site-QuickDraw | Train Loss: 2.1538 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 1.9146 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.2768 | Train Acc: 0.7895
 Site-Real      | Train Loss: 1.2033 | Train Acc: 0.8312
 Site-Sketch    | Train Loss: 1.3055 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.4023 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.0850 | Val  Acc: 0.8036
 Site-Clipart   | Val  Loss: 1.1346 | Val  Acc: 0.8482
 Site-Infograph | Val  Loss: 1.8032 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8706 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 1.3775 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.5787 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 1.8455 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.0070 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.2802 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.2033 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.3470 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.4460 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6490
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8036
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8482
 Best site-Infograph  | Epoch:12 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:12 | Val Acc: 0.5122
 Best site-Painting   | Epoch:12 | Val Acc: 0.6316
 Best site-Painting   | Epoch:12 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.3333
 Best site-Real       | Epoch:12 | Val Acc: 0.8800
 Best site-Real       | Epoch:12 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:12 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:12 | Val Acc: 0.7174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 1.1171 | Train Acc: 0.7857
 Site-Clipart   | Train Loss: 1.0902 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 2.0575 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.8396 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.3136 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.3620 | Train Acc: 0.7586
 Site-QuickDraw | Train Loss: 2.0816 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.8985 | Train Acc: 0.4375
 Site-Real      | Train Loss: 1.2009 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.1695 | Train Acc: 0.8701
 Site-Sketch    | Train Loss: 1.2972 | Train Acc: 0.6857
 Site-Sketch    | Train Loss: 1.2697 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.0664 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0567 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 1.8693 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.8645 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 1.2944 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.4968 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 1.8462 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.9878 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.3001 | Val  Acc: 0.7600
 Site-Real      | Val  Loss: 1.1526 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.2847 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.3780 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6868
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8839
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5366
 Best site-Painting   | Epoch:13 | Val Acc: 0.7895
 Best site-Painting   | Epoch:13 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.3333
 Best site-Real       | Epoch:13 | Val Acc: 0.7600
 Best site-Real       | Epoch:13 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:13 | Val Acc: 0.7174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.1782 | Train Acc: 0.7738
 Site-Clipart   | Train Loss: 1.0595 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 2.0068 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.7873 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 1.2573 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.2957 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 2.0292 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.8697 | Train Acc: 0.3906
 Site-Real      | Train Loss: 1.1178 | Train Acc: 0.8684
 Site-Real      | Train Loss: 1.1276 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.1670 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.2681 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.0206 | Val  Acc: 0.8214
 Site-Clipart   | Val  Loss: 1.0280 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.7216 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.7805 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 1.3347 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.4546 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.8238 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.9828 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.2339 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.1309 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.3796 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.3188 | Val  Acc: 0.7609
Average Valid Accuracy: 0.6880
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8214
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:14 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:14 | Val Acc: 0.5610
 Best site-Painting   | Epoch:14 | Val Acc: 0.7895
 Best site-Painting   | Epoch:14 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.3571
 Best site-Real       | Epoch:14 | Val Acc: 0.8800
 Best site-Real       | Epoch:14 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:14 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:14 | Val Acc: 0.7609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 1.0953 | Train Acc: 0.8214
 Site-Clipart   | Train Loss: 1.0559 | Train Acc: 0.8512
 Site-Infograph | Train Loss: 2.0053 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.8029 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 1.2746 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.2780 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 2.0926 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.8520 | Train Acc: 0.4531
 Site-Real      | Train Loss: 1.1259 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.0695 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.0566 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.2217 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 0.9764 | Val  Acc: 0.8214
 Site-Clipart   | Val  Loss: 1.0098 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 1.6075 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.7555 | Val  Acc: 0.5854
 Site-Painting  | Val  Loss: 1.1472 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.3611 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.8030 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.9357 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.1435 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 1.0426 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.1687 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.2742 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7200
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8214
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8839
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5854
 Best site-Painting   | Epoch:15 | Val Acc: 0.7895
 Best site-Painting   | Epoch:15 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.3810
 Best site-Real       | Epoch:15 | Val Acc: 0.8400
 Best site-Real       | Epoch:15 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:15 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 1.1612 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9961 | Train Acc: 0.8869
 Site-Infograph | Train Loss: 1.9684 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7423 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 1.2322 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.2212 | Train Acc: 0.7931
 Site-QuickDraw | Train Loss: 2.0685 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.7614 | Train Acc: 0.4688
 Site-Real      | Train Loss: 1.0502 | Train Acc: 0.7895
 Site-Real      | Train Loss: 1.0309 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.1193 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.2840 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.9436 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9410 | Val  Acc: 0.9018
 Site-Infograph | Val  Loss: 1.7653 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.8141 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 1.1935 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.3705 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.7992 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.8877 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.1323 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 1.0678 | Val  Acc: 0.8431
 Site-Sketch    | Val  Loss: 1.2524 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.2361 | Val  Acc: 0.8043
Average Valid Accuracy: 0.6984
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 1.0047 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 0.9406 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.9685 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.7263 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 1.1995 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.2285 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.0395 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.8089 | Train Acc: 0.4531
 Site-Real      | Train Loss: 1.0144 | Train Acc: 0.8684
 Site-Real      | Train Loss: 1.0043 | Train Acc: 0.8442
 Site-Sketch    | Train Loss: 1.1493 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.1654 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.8707 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.8702 | Val  Acc: 0.9018
 Site-Infograph | Val  Loss: 1.6081 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.7810 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 1.1885 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.3723 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.7683 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.8731 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.0720 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.9370 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.2117 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.2596 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7136
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 1.0859 | Train Acc: 0.7976
 Site-Clipart   | Train Loss: 0.9286 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 1.9854 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.7015 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 1.2007 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.1158 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.9796 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.7500 | Train Acc: 0.4844
 Site-Real      | Train Loss: 0.8817 | Train Acc: 0.8421
 Site-Real      | Train Loss: 0.9534 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 0.9226 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.0847 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8307 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.9029 | Val  Acc: 0.8661
 Site-Infograph | Val  Loss: 1.6374 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7293 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 1.0329 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.2806 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.7534 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.8118 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.0174 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.9539 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.1959 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.2183 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7414
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8929
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8661
 Best site-Infograph  | Epoch:18 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:18 | Val Acc: 0.5610
 Best site-Painting   | Epoch:18 | Val Acc: 0.8421
 Best site-Painting   | Epoch:18 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.4524
 Best site-Real       | Epoch:18 | Val Acc: 0.9200
 Best site-Real       | Epoch:18 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:18 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:18 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0093 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.9167 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.9177 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6697 | Train Acc: 0.5645
 Site-Painting  | Train Loss: 1.1677 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.1181 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 1.9470 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.7294 | Train Acc: 0.4844
 Site-Real      | Train Loss: 0.9662 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.9546 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.2143 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.1354 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.8501 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 0.8407 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 1.6174 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.7556 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 1.1024 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.2853 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.7601 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.8168 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 1.0143 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 0.9128 | Val  Acc: 0.8235
 Site-Sketch    | Val  Loss: 1.0856 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.0903 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7309
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 1.0103 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.8851 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 1.9505 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6598 | Train Acc: 0.5645
 Site-Painting  | Train Loss: 1.1114 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.1878 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 1.9665 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 1.7091 | Train Acc: 0.4688
 Site-Real      | Train Loss: 1.0288 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.9043 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 1.0119 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.1514 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.7884 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8141 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 1.6255 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.7064 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 1.0492 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.2491 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.7419 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.8005 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.0079 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 0.8761 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.0655 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.1872 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7398
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 0.9449 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8766 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.8960 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6450 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 1.1590 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.0975 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 1.9308 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.7164 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.9128 | Train Acc: 0.8421
 Site-Real      | Train Loss: 0.8852 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 0.9538 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.0326 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.8013 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.8007 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 1.5258 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.6974 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.9868 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.2040 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.7680 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.7482 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.9800 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 0.9022 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.0019 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.1350 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7281
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.9046 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.8207 | Train Acc: 0.8869
 Site-Infograph | Train Loss: 1.8743 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6476 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.9820 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.0061 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.9005 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.6631 | Train Acc: 0.4844
 Site-Real      | Train Loss: 0.8903 | Train Acc: 0.8421
 Site-Real      | Train Loss: 0.8807 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.0790 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.0583 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7694 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.7778 | Val  Acc: 0.9018
 Site-Infograph | Val  Loss: 1.4753 | Val  Acc: 0.8000
 Site-Infograph | Val  Loss: 1.6076 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 1.0169 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.1457 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.6621 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.7585 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.8999 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.7989 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.0355 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.0979 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7534
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9018
 Best site-Infograph  | Epoch:22 | Val Acc: 0.8000
 Best site-Infograph  | Epoch:22 | Val Acc: 0.5366
 Best site-Painting   | Epoch:22 | Val Acc: 0.8947
 Best site-Painting   | Epoch:22 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.4286
 Best site-Real       | Epoch:22 | Val Acc: 0.8800
 Best site-Real       | Epoch:22 | Val Acc: 0.8824
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:22 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.8863 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 0.7993 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.9099 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6214 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 1.0212 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 1.0885 | Train Acc: 0.7931
 Site-QuickDraw | Train Loss: 1.9082 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.6534 | Train Acc: 0.5469
 Site-Real      | Train Loss: 0.8877 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.8739 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.7176 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.0097 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.7300 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.7839 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.4873 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.6602 | Val  Acc: 0.5854
 Site-Painting  | Val  Loss: 0.9519 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.1954 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7339 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.7288 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.9357 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.7717 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 0.9728 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.1097 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7384
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8549 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 0.7795 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.8698 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.5749 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 1.0469 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.9992 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.8794 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.5708 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.8720 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.8055 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.7881 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.9478 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7590 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.7461 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 1.5235 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.6193 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.9572 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.1050 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.6133 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.7059 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.9174 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.7974 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 0.9630 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.1392 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7560
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9196
 Best site-Infograph  | Epoch:24 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:24 | Val Acc: 0.5610
 Best site-Painting   | Epoch:24 | Val Acc: 0.8421
 Best site-Painting   | Epoch:24 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.4524
 Best site-Real       | Epoch:24 | Val Acc: 0.8800
 Best site-Real       | Epoch:24 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:24 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:24 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.8521 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.7571 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.8781 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.5746 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 1.0430 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.9545 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 1.9155 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.5931 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.9338 | Train Acc: 0.8421
 Site-Real      | Train Loss: 0.7962 | Train Acc: 0.8701
 Site-Sketch    | Train Loss: 0.9105 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.0925 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.6803 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.7259 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.6527 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5816 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.9082 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.0544 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.5864 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.6525 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.9424 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 0.7820 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.0051 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.0552 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7499
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.9048 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7170 | Train Acc: 0.8869
 Site-Infograph | Train Loss: 1.9014 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.5391 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 1.0094 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.9077 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.8041 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.5587 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.8466 | Train Acc: 0.8421
 Site-Real      | Train Loss: 0.7814 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.8161 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9946 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7144 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6880 | Val  Acc: 0.9018
 Site-Infograph | Val  Loss: 1.4299 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.5593 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.7847 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.0772 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.6250 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.6634 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.8372 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.7633 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 0.8957 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.0553 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7719
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9018
 Best site-Infograph  | Epoch:26 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:26 | Val Acc: 0.6585
 Best site-Painting   | Epoch:26 | Val Acc: 0.8421
 Best site-Painting   | Epoch:26 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.5000
 Best site-Real       | Epoch:26 | Val Acc: 0.8800
 Best site-Real       | Epoch:26 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:26 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:26 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.8074 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.7510 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.8738 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.5895 | Train Acc: 0.6290
 Site-Painting  | Train Loss: 0.9779 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.9055 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.8359 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.5671 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.7472 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.7414 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 0.7934 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 0.9498 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.6669 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.7049 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.4384 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5056 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.8158 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.0555 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.6333 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.6515 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.8089 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.6893 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.9075 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.0616 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7568
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.7683 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6791 | Train Acc: 0.9107
 Site-Infograph | Train Loss: 1.8009 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4845 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.9297 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.8868 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.7520 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.5427 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.8072 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.7441 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 0.9275 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.9624 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7256 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6551 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.4375 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.5764 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.8178 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.0200 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.5258 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.5638 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.7751 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.6910 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.9608 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 0.9476 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7774
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:28 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:28 | Val Acc: 0.6098
 Best site-Painting   | Epoch:28 | Val Acc: 0.8421
 Best site-Painting   | Epoch:28 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.5714
 Best site-Real       | Epoch:28 | Val Acc: 0.8800
 Best site-Real       | Epoch:28 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:28 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:28 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.7053 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.6909 | Train Acc: 0.9107
 Site-Infograph | Train Loss: 1.8713 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4841 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.9626 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.8987 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.8074 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.4855 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.7771 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.7101 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.7668 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 0.9206 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.5807 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6786 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.3778 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.5097 | Val  Acc: 0.6098
 Site-Painting  | Val  Loss: 0.7274 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.0591 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.6107 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.6287 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.8374 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 0.7222 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 0.8799 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.0396 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7675
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.7425 | Train Acc: 0.9286
 Site-Clipart   | Train Loss: 0.6886 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.8615 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.4761 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.9209 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.8918 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.6560 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 1.4829 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.8259 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.7327 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 0.6750 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.0209 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6877 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.6353 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.3373 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.5051 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.8323 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.0502 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.5527 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.5470 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.7812 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.6311 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.9234 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.0093 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7823
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:30 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:30 | Val Acc: 0.6341
 Best site-Painting   | Epoch:30 | Val Acc: 0.7895
 Best site-Painting   | Epoch:30 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.6190
 Best site-Real       | Epoch:30 | Val Acc: 0.9200
 Best site-Real       | Epoch:30 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:30 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:30 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.7335 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.6423 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.7463 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.4420 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.8574 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.8456 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.7309 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.4773 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.8831 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.7037 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.8684 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 0.8947 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.5779 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.6156 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.2466 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.4628 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.8342 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.0456 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5212 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.5572 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.7126 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.6363 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 0.8772 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.9503 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7921
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:31 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:31 | Val Acc: 0.7073
 Best site-Painting   | Epoch:31 | Val Acc: 0.7895
 Best site-Painting   | Epoch:31 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.5714
 Best site-Real       | Epoch:31 | Val Acc: 0.9200
 Best site-Real       | Epoch:31 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:31 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:31 | Val Acc: 0.7609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.7363 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 0.6407 | Train Acc: 0.8988
 Site-Infograph | Train Loss: 1.8008 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4622 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.8685 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.7933 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.7448 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.4504 | Train Acc: 0.6094
 Site-Real      | Train Loss: 0.6563 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.7149 | Train Acc: 0.8701
 Site-Sketch    | Train Loss: 0.6361 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.8844 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.6474 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6230 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.3963 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.4948 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.6920 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.9703 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.4588 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.5603 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.7145 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.6284 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 0.9351 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.9974 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7653
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.6962 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.6259 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.7575 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4366 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.9006 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.8593 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.6898 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.4369 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.6615 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6692 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.8097 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9211 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.5787 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.5792 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 1.3256 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.4677 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.6332 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.9529 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.4625 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.4870 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.7408 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.6449 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.8771 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.9503 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7961
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:33 | Val Acc: 0.9196
 Best site-Infograph  | Epoch:33 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:33 | Val Acc: 0.6585
 Best site-Painting   | Epoch:33 | Val Acc: 0.8947
 Best site-Painting   | Epoch:33 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.5952
 Best site-Real       | Epoch:33 | Val Acc: 0.8800
 Best site-Real       | Epoch:33 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:33 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:33 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.8035 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6387 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.7520 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4410 | Train Acc: 0.6290
 Site-Painting  | Train Loss: 0.8326 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.8049 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.6685 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.4420 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.6481 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6496 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 0.8281 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.7962 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.5693 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.5940 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.3040 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.4164 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.8255 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.9536 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5495 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.4747 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.7437 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.6143 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 0.8585 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 0.9396 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7786
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.7043 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6279 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.6960 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4077 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.8420 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.8244 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.6254 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.3828 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.6598 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6718 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 1.0341 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.8834 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.5892 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.6072 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.2077 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.4175 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.6695 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.9361 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5358 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.4939 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.7546 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.5759 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 0.9041 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 0.9566 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7636
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.8000 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 0.6308 | Train Acc: 0.9107
 Site-Infograph | Train Loss: 1.7440 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4400 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.8626 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.8080 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.6369 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.4019 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.7899 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6294 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 0.5637 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.8381 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.5579 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.5468 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.2473 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.4113 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.7073 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.9447 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.3085 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.4833 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.6943 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5611 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.8385 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.9037 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8055
 Best site-Clipart    | Epoch:36 | Val Acc: 0.8929
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:36 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:36 | Val Acc: 0.7073
 Best site-Painting   | Epoch:36 | Val Acc: 0.8421
 Best site-Painting   | Epoch:36 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.6190
 Best site-Real       | Epoch:36 | Val Acc: 0.9200
 Best site-Real       | Epoch:36 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:36 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:36 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.6683 | Train Acc: 0.9286
 Site-Clipart   | Train Loss: 0.5812 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.7349 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.3962 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.8299 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.7978 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.6101 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.4156 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.6520 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6215 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 0.8651 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.8351 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5544 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.5551 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2681 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.4542 | Val  Acc: 0.5854
 Site-Painting  | Val  Loss: 0.6624 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8718 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.4327 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.4633 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.6662 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5709 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.7001 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.8369 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7968
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.6214 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.5642 | Train Acc: 0.9226
 Site-Infograph | Train Loss: 1.7632 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.3321 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.8015 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.7975 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.5618 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 1.3914 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.6738 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.6193 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.5797 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.7109 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.5498 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.5508 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.3522 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.3859 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.5680 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8413 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3978 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.3966 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.6520 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.5278 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.7519 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.8826 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7958
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.6633 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.5714 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.7479 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.3633 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.8383 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.7101 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.6835 | Train Acc: 0.4688
 Site-QuickDraw | Train Loss: 1.3456 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.7765 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6045 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.6519 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 0.8053 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.6056 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.5379 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 1.2510 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.3257 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.7230 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8282 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.3838 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.3602 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.7111 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5677 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.7350 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.9164 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7974
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.6256 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.5788 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.7402 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.3191 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.7731 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.7025 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.5882 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.3208 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.6308 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5975 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 0.8601 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.7512 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.5470 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.5207 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2313 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.3808 | Val  Acc: 0.7073
 Site-Painting  | Val  Loss: 0.6346 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8218 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.3620 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.3799 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.6235 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5252 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.8289 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.8104 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8124
 Best site-Clipart    | Epoch:40 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:40 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:40 | Val Acc: 0.6500
 Best site-Infograph  | Epoch:40 | Val Acc: 0.7073
 Best site-Painting   | Epoch:40 | Val Acc: 0.8421
 Best site-Painting   | Epoch:40 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:40 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:40 | Val Acc: 0.5714
 Best site-Real       | Epoch:40 | Val Acc: 0.9200
 Best site-Real       | Epoch:40 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:40 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:40 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.6284 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.5733 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.6539 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.3037 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.8348 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.6966 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.5317 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.3405 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.6696 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5674 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.8177 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.8000 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.5404 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.5178 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.2553 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.3428 | Val  Acc: 0.6585
 Site-Painting  | Val  Loss: 0.5012 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.8209 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.3871 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.3808 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.6118 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5774 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 0.8372 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 0.8161 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7953
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.6275 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5470 | Train Acc: 0.9107
 Site-Infograph | Train Loss: 1.6122 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.2884 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.7659 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.7668 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.6474 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.2918 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.6146 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.5826 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 0.8614 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.8121 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.5140 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 0.5117 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.3417 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.2979 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.6311 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8305 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.2848 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.3715 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.6386 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5267 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 0.7426 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.7659 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8168
 Best site-Clipart    | Epoch:42 | Val Acc: 0.9464
 Best site-Clipart    | Epoch:42 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:42 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:42 | Val Acc: 0.6829
 Best site-Painting   | Epoch:42 | Val Acc: 0.8421
 Best site-Painting   | Epoch:42 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:42 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:42 | Val Acc: 0.6905
 Best site-Real       | Epoch:42 | Val Acc: 0.9200
 Best site-Real       | Epoch:42 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:42 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:42 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.6211 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.5292 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.5867 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.3233 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.7289 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.6605 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.5476 | Train Acc: 0.5625
 Site-QuickDraw | Train Loss: 1.2279 | Train Acc: 0.7656
 Site-Real      | Train Loss: 0.6325 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.5718 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.5120 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.7720 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4657 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.4837 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 1.1621 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.3227 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.6784 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8668 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.2799 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.3114 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.5488 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.4893 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.7462 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.8264 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8061
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.5847 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.5256 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.6425 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.2521 | Train Acc: 0.7258
 Site-Painting  | Train Loss: 0.7449 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.6467 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.4912 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.2409 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.6733 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5792 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 0.7360 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 0.7259 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.4583 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.4984 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.0906 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.3287 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.6425 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.8472 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.3108 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.3560 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.5847 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.4798 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.7267 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.7807 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7914
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.5587 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.5058 | Train Acc: 0.9226
 Site-Infograph | Train Loss: 1.6696 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.2917 | Train Acc: 0.6613
 Site-Painting  | Train Loss: 0.7549 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.6834 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.5038 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.2981 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.5972 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6006 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.8605 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.7952 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.4400 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 0.4739 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.1845 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.2530 | Val  Acc: 0.7317
 Site-Painting  | Val  Loss: 0.5901 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.7533 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.1893 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.3507 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.5609 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.5002 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.7320 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.7359 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8450
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9464
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:45 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:45 | Val Acc: 0.7317
 Best site-Painting   | Epoch:45 | Val Acc: 0.8947
 Best site-Painting   | Epoch:45 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:45 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:45 | Val Acc: 0.6905
 Best site-Real       | Epoch:45 | Val Acc: 0.8800
 Best site-Real       | Epoch:45 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:45 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:45 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/drfl...
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.5737 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.5295 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.6683 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.2676 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.6853 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.6506 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.4108 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.2395 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.6204 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.5722 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.5463 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.7055 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.4399 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.4901 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.1255 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.2721 | Val  Acc: 0.6829
 Site-Painting  | Val  Loss: 0.4822 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.7405 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.2897 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.2950 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.5814 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.4727 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 0.8246 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.8312 | Val  Acc: 0.8043
Average Valid Accuracy: 0.8363
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.6348 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.4919 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.6528 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.1591 | Train Acc: 0.7581
 Site-Painting  | Train Loss: 0.6549 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.6048 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.5255 | Train Acc: 0.5312
 Site-QuickDraw | Train Loss: 1.2287 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.5235 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5279 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.5980 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.7818 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.4509 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 0.4886 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.1848 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.2289 | Val  Acc: 0.7317
 Site-Painting  | Val  Loss: 0.4833 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.7962 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.1945 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.2512 | Val  Acc: 0.7381
 Site-Real      | Val  Loss: 0.5706 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.4843 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 0.7149 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.7769 | Val  Acc: 0.8043
Average Valid Accuracy: 0.8303
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.6047 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.4886 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.6337 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.2831 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.6391 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.6258 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.4738 | Train Acc: 0.6250
 Site-QuickDraw | Train Loss: 1.2073 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.5559 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.5030 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.7598 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 0.6625 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.4920 | Val  Acc: 0.9643
 Site-Clipart   | Val  Loss: 0.4791 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 1.2175 | Val  Acc: 0.6500
 Site-Infograph | Val  Loss: 1.2592 | Val  Acc: 0.6341
 Site-Painting  | Val  Loss: 0.6068 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.7807 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.3918 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.2663 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.4958 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.4792 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.6824 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.7927 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8108
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.5490 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.5048 | Train Acc: 0.9226
 Site-Infograph | Train Loss: 1.6689 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.2138 | Train Acc: 0.6935
 Site-Painting  | Train Loss: 0.6200 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.6724 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.4949 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 1.2384 | Train Acc: 0.6719
 Site-Real      | Train Loss: 0.5373 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.5439 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 0.7543 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.7537 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.4782 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.4684 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.1268 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.2155 | Val  Acc: 0.7561
 Site-Painting  | Val  Loss: 0.5660 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.7527 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.1604 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.2752 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.5275 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.4400 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.7698 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.7516 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8381
===2023-04-18 23:34:33===
===2023-04-18 23:34:35===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8555
 Test site-Infograph | Epoch:45 | Test Acc: 0.4810
 Test site-Painting  | Epoch:45 | Test Acc: 0.8740
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.5520
 Test site-Real      | Epoch:45 | Test Acc: 0.9203
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8267
Average Test Accuracy: 0.7516
