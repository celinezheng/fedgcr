===2023-04-16 22:18:55===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
=================================
 ==== model type: cocoop ====
=================================
============ Train epoch 0 ============
denominator: 67029.4765625
 Site-Clipart   | Train Loss: 2.2566 | Train Acc: 0.1071
 Site-Clipart   | Train Loss: 2.2537 | Train Acc: 0.1607
 Site-Infograph | Train Loss: 2.2789 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.2808 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.3285 | Train Acc: 0.1379
 Site-Painting  | Train Loss: 2.3169 | Train Acc: 0.1552
 Site-QuickDraw | Train Loss: 2.3569 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.3353 | Train Acc: 0.1094
 Site-Real      | Train Loss: 2.2979 | Train Acc: 0.0789
 Site-Real      | Train Loss: 2.3447 | Train Acc: 0.0909
 Site-Sketch    | Train Loss: 2.1942 | Train Acc: 0.1714
 Site-Sketch    | Train Loss: 2.3080 | Train Acc: 0.1714
 Site-Clipart   | Val  Loss: 2.2548 | Val  Acc: 0.2321
 Site-Clipart   | Val  Loss: 2.2329 | Val  Acc: 0.1696
 Site-Infograph | Val  Loss: 2.2753 | Val  Acc: 0.1500
 Site-Infograph | Val  Loss: 2.1676 | Val  Acc: 0.1707
 Site-Painting  | Val  Loss: 2.3596 | Val  Acc: 0.2105
 Site-Painting  | Val  Loss: 2.3371 | Val  Acc: 0.1538
 Site-QuickDraw | Val  Loss: 1.9850 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.2814 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 2.3883 | Val  Acc: 0.0800
 Site-Real      | Val  Loss: 2.3298 | Val  Acc: 0.0588
 Site-Sketch    | Val  Loss: 2.2951 | Val  Acc: 0.1739
 Site-Sketch    | Val  Loss: 2.3326 | Val  Acc: 0.1522
Average Valid Accuracy: 0.1511
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2321
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1696
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1500
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1707
 Best site-Painting   | Epoch:0 | Val Acc: 0.2105
 Best site-Painting   | Epoch:0 | Val Acc: 0.1538
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.0800
 Best site-Real       | Epoch:0 | Val Acc: 0.0588
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1739
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 1 ============
denominator: 61788.125
 Site-Clipart   | Train Loss: 2.1522 | Train Acc: 0.2143
 Site-Clipart   | Train Loss: 2.1650 | Train Acc: 0.2976
 Site-Infograph | Train Loss: 2.2526 | Train Acc: 0.1290
 Site-Infograph | Train Loss: 2.2368 | Train Acc: 0.2097
 Site-Painting  | Train Loss: 2.2333 | Train Acc: 0.1379
 Site-Painting  | Train Loss: 2.2733 | Train Acc: 0.1897
 Site-QuickDraw | Train Loss: 2.3487 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.3232 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.1832 | Train Acc: 0.1842
 Site-Real      | Train Loss: 2.2656 | Train Acc: 0.1818
 Site-Sketch    | Train Loss: 2.0807 | Train Acc: 0.2286
 Site-Sketch    | Train Loss: 2.2500 | Train Acc: 0.1714
 Site-Clipart   | Val  Loss: 2.1449 | Val  Acc: 0.3214
 Site-Clipart   | Val  Loss: 2.1773 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2151 | Val  Acc: 0.1000
 Site-Infograph | Val  Loss: 2.2033 | Val  Acc: 0.1951
 Site-Painting  | Val  Loss: 2.3756 | Val  Acc: 0.1053
 Site-Painting  | Val  Loss: 2.2590 | Val  Acc: 0.2051
 Site-QuickDraw | Val  Loss: 1.9942 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.2559 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.3040 | Val  Acc: 0.0800
 Site-Real      | Val  Loss: 2.2384 | Val  Acc: 0.1176
 Site-Sketch    | Val  Loss: 2.2757 | Val  Acc: 0.1304
 Site-Sketch    | Val  Loss: 2.2547 | Val  Acc: 0.3043
Average Valid Accuracy: 0.1865
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3214
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1951
 Best site-Painting   | Epoch:1 | Val Acc: 0.1053
 Best site-Painting   | Epoch:1 | Val Acc: 0.2051
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1429
 Best site-Real       | Epoch:1 | Val Acc: 0.0800
 Best site-Real       | Epoch:1 | Val Acc: 0.1176
 Best site-Sketch     | Epoch:1 | Val Acc: 0.1304
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 2 ============
denominator: 59541.53125
 Site-Clipart   | Train Loss: 2.1956 | Train Acc: 0.1905
 Site-Clipart   | Train Loss: 2.1297 | Train Acc: 0.2738
 Site-Infograph | Train Loss: 2.2979 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.1869 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.1754 | Train Acc: 0.2069
 Site-Painting  | Train Loss: 2.2220 | Train Acc: 0.2414
 Site-QuickDraw | Train Loss: 2.3351 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.2786 | Train Acc: 0.1406
 Site-Real      | Train Loss: 2.1682 | Train Acc: 0.2368
 Site-Real      | Train Loss: 2.1726 | Train Acc: 0.2727
 Site-Sketch    | Train Loss: 2.0219 | Train Acc: 0.3714
 Site-Sketch    | Train Loss: 2.1692 | Train Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.0803 | Val  Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.0997 | Val  Acc: 0.2946
 Site-Infograph | Val  Loss: 2.1496 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.2289 | Val  Acc: 0.1707
 Site-Painting  | Val  Loss: 2.3164 | Val  Acc: 0.1579
 Site-Painting  | Val  Loss: 2.1465 | Val  Acc: 0.2821
 Site-QuickDraw | Val  Loss: 2.0186 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.1966 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.2184 | Val  Acc: 0.0400
 Site-Real      | Val  Loss: 2.2498 | Val  Acc: 0.1765
 Site-Sketch    | Val  Loss: 2.1493 | Val  Acc: 0.3043
 Site-Sketch    | Val  Loss: 2.1810 | Val  Acc: 0.2826
Average Valid Accuracy: 0.2231
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2946
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1707
 Best site-Painting   | Epoch:2 | Val Acc: 0.1579
 Best site-Painting   | Epoch:2 | Val Acc: 0.2821
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1429
 Best site-Real       | Epoch:2 | Val Acc: 0.0400
 Best site-Real       | Epoch:2 | Val Acc: 0.1765
 Best site-Sketch     | Epoch:2 | Val Acc: 0.3043
 Best site-Sketch     | Epoch:2 | Val Acc: 0.2826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 3 ============
denominator: 57620.3359375
 Site-Clipart   | Train Loss: 2.0896 | Train Acc: 0.2976
 Site-Clipart   | Train Loss: 2.0756 | Train Acc: 0.3036
 Site-Infograph | Train Loss: 2.2552 | Train Acc: 0.1290
 Site-Infograph | Train Loss: 2.1808 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.1005 | Train Acc: 0.3448
 Site-Painting  | Train Loss: 2.1537 | Train Acc: 0.2759
 Site-QuickDraw | Train Loss: 2.2300 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.2651 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.0340 | Train Acc: 0.4211
 Site-Real      | Train Loss: 2.1247 | Train Acc: 0.3117
 Site-Sketch    | Train Loss: 2.0499 | Train Acc: 0.3143
 Site-Sketch    | Train Loss: 2.0758 | Train Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.0295 | Val  Acc: 0.3929
 Site-Clipart   | Val  Loss: 2.0456 | Val  Acc: 0.3304
 Site-Infograph | Val  Loss: 2.1764 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.1882 | Val  Acc: 0.1951
 Site-Painting  | Val  Loss: 2.1987 | Val  Acc: 0.1579
 Site-Painting  | Val  Loss: 2.1640 | Val  Acc: 0.3077
 Site-QuickDraw | Val  Loss: 1.9687 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.1674 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1299 | Val  Acc: 0.3200
 Site-Real      | Val  Loss: 2.1549 | Val  Acc: 0.3137
 Site-Sketch    | Val  Loss: 2.1319 | Val  Acc: 0.3043
 Site-Sketch    | Val  Loss: 2.1300 | Val  Acc: 0.3261
Average Valid Accuracy: 0.2693
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3929
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3304
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:3 | Val Acc: 0.1951
 Best site-Painting   | Epoch:3 | Val Acc: 0.1579
 Best site-Painting   | Epoch:3 | Val Acc: 0.3077
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1429
 Best site-Real       | Epoch:3 | Val Acc: 0.3200
 Best site-Real       | Epoch:3 | Val Acc: 0.3137
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3043
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 4 ============
denominator: 56182.890625
 Site-Clipart   | Train Loss: 2.0417 | Train Acc: 0.4048
===2023-04-16 23:39:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
=================================
 ==== model type: cocoop ====
=================================
============ Train epoch 4 ============
denominator: 62141.40625
 Site-Clipart   | Train Loss: 2.0059 | Train Acc: 0.4048
 Site-Clipart   | Train Loss: 2.0277 | Train Acc: 0.3512
 Site-Infograph | Train Loss: 2.2026 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.2281 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1173 | Train Acc: 0.2759
 Site-Painting  | Train Loss: 2.1065 | Train Acc: 0.3621
 Site-QuickDraw | Train Loss: 2.2959 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.2288 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.0115 | Train Acc: 0.4211
 Site-Real      | Train Loss: 2.0660 | Train Acc: 0.3377
 Site-Sketch    | Train Loss: 1.9753 | Train Acc: 0.4000
 Site-Sketch    | Train Loss: 2.0833 | Train Acc: 0.3143
 Site-Clipart   | Val  Loss: 2.0162 | Val  Acc: 0.4107
 Site-Clipart   | Val  Loss: 2.0004 | Val  Acc: 0.4018
 Site-Infograph | Val  Loss: 2.1918 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.1240 | Val  Acc: 0.2927
 Site-Painting  | Val  Loss: 2.1822 | Val  Acc: 0.1579
 Site-Painting  | Val  Loss: 2.1701 | Val  Acc: 0.2821
 Site-QuickDraw | Val  Loss: 1.9468 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.1780 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.1284 | Val  Acc: 0.2800
 Site-Real      | Val  Loss: 2.0804 | Val  Acc: 0.3137
 Site-Sketch    | Val  Loss: 2.0727 | Val  Acc: 0.3043
 Site-Sketch    | Val  Loss: 2.1176 | Val  Acc: 0.3478
Average Valid Accuracy: 0.2790
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4107
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4018
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2927
 Best site-Painting   | Epoch:4 | Val Acc: 0.1579
 Best site-Painting   | Epoch:4 | Val Acc: 0.2821
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1667
 Best site-Real       | Epoch:4 | Val Acc: 0.2800
 Best site-Real       | Epoch:4 | Val Acc: 0.3137
 Best site-Sketch     | Epoch:4 | Val Acc: 0.3043
 Best site-Sketch     | Epoch:4 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 5 ============
denominator: 57296.59765625
 Site-Clipart   | Train Loss: 1.9350 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 1.9458 | Train Acc: 0.4226
 Site-Infograph | Train Loss: 2.2239 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.1682 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.0002 | Train Acc: 0.3448
 Site-Painting  | Train Loss: 2.0720 | Train Acc: 0.2586
 Site-QuickDraw | Train Loss: 2.2959 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.2287 | Train Acc: 0.1406
 Site-Real      | Train Loss: 1.9298 | Train Acc: 0.3421
 Site-Real      | Train Loss: 2.0022 | Train Acc: 0.3636
 Site-Sketch    | Train Loss: 1.8111 | Train Acc: 0.3714
 Site-Sketch    | Train Loss: 2.0699 | Train Acc: 0.3857
 Site-Clipart   | Val  Loss: 1.9263 | Val  Acc: 0.4107
 Site-Clipart   | Val  Loss: 1.9565 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1310 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.1451 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 2.1255 | Val  Acc: 0.2632
 Site-Painting  | Val  Loss: 2.0882 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.9717 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.1853 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.0687 | Val  Acc: 0.2800
 Site-Real      | Val  Loss: 2.0184 | Val  Acc: 0.3529
 Site-Sketch    | Val  Loss: 2.0830 | Val  Acc: 0.2609
 Site-Sketch    | Val  Loss: 2.0409 | Val  Acc: 0.3261
Average Valid Accuracy: 0.2863
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4107
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2439
 Best site-Painting   | Epoch:5 | Val Acc: 0.2632
 Best site-Painting   | Epoch:5 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.1667
 Best site-Real       | Epoch:5 | Val Acc: 0.2800
 Best site-Real       | Epoch:5 | Val Acc: 0.3529
 Best site-Sketch     | Epoch:5 | Val Acc: 0.2609
 Best site-Sketch     | Epoch:5 | Val Acc: 0.3261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 6 ============
denominator: 55147.546875
 Site-Clipart   | Train Loss: 1.9816 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9201 | Train Acc: 0.4345
 Site-Infograph | Train Loss: 2.1903 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.1224 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9725 | Train Acc: 0.3103
 Site-Painting  | Train Loss: 2.0131 | Train Acc: 0.3448
 Site-QuickDraw | Train Loss: 2.2714 | Train Acc: 0.0625
 Site-QuickDraw | Train Loss: 2.1939 | Train Acc: 0.1406
 Site-Real      | Train Loss: 1.9365 | Train Acc: 0.3947
 Site-Real      | Train Loss: 1.9242 | Train Acc: 0.4545
 Site-Sketch    | Train Loss: 1.7931 | Train Acc: 0.5143
 Site-Sketch    | Train Loss: 1.9679 | Train Acc: 0.4143
 Site-Clipart   | Val  Loss: 1.8366 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.8701 | Val  Acc: 0.4821
 Site-Infograph | Val  Loss: 2.0830 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 2.1646 | Val  Acc: 0.2439
 Site-Painting  | Val  Loss: 2.1013 | Val  Acc: 0.2632
 Site-Painting  | Val  Loss: 1.9922 | Val  Acc: 0.3846
 Site-QuickDraw | Val  Loss: 1.9718 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.1665 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.9994 | Val  Acc: 0.3600
 Site-Real      | Val  Loss: 2.0219 | Val  Acc: 0.3529
 Site-Sketch    | Val  Loss: 1.9015 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 1.9793 | Val  Acc: 0.3913
Average Valid Accuracy: 0.3319
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4821
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:6 | Val Acc: 0.2439
 Best site-Painting   | Epoch:6 | Val Acc: 0.2632
 Best site-Painting   | Epoch:6 | Val Acc: 0.3846
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.1667
 Best site-Real       | Epoch:6 | Val Acc: 0.3600
 Best site-Real       | Epoch:6 | Val Acc: 0.3529
 Best site-Sketch     | Epoch:6 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:6 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 7 ============
denominator: 53322.4765625
 Site-Clipart   | Train Loss: 1.8824 | Train Acc: 0.4643
 Site-Clipart   | Train Loss: 1.8581 | Train Acc: 0.4583
 Site-Infograph | Train Loss: 2.2024 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.0908 | Train Acc: 0.3710
 Site-Painting  | Train Loss: 1.8659 | Train Acc: 0.5517
 Site-Painting  | Train Loss: 1.9499 | Train Acc: 0.4483
 Site-QuickDraw | Train Loss: 2.1918 | Train Acc: 0.0938
 Site-QuickDraw | Train Loss: 2.1747 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.7922 | Train Acc: 0.5263
 Site-Real      | Train Loss: 1.8666 | Train Acc: 0.4545
 Site-Sketch    | Train Loss: 1.8276 | Train Acc: 0.4857
 Site-Sketch    | Train Loss: 1.8699 | Train Acc: 0.4714
 Site-Clipart   | Val  Loss: 1.7931 | Val  Acc: 0.4643
 Site-Clipart   | Val  Loss: 1.8170 | Val  Acc: 0.4911
 Site-Infograph | Val  Loss: 2.1189 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.0971 | Val  Acc: 0.3171
 Site-Painting  | Val  Loss: 1.9770 | Val  Acc: 0.3158
 Site-Painting  | Val  Loss: 1.9491 | Val  Acc: 0.4872
 Site-QuickDraw | Val  Loss: 1.9465 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.1248 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8995 | Val  Acc: 0.4800
 Site-Real      | Val  Loss: 1.9040 | Val  Acc: 0.4510
 Site-Sketch    | Val  Loss: 1.8940 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 1.9046 | Val  Acc: 0.4783
Average Valid Accuracy: 0.3718
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4643
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4911
 Best site-Infograph  | Epoch:7 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3171
 Best site-Painting   | Epoch:7 | Val Acc: 0.3158
 Best site-Painting   | Epoch:7 | Val Acc: 0.4872
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1905
 Best site-Real       | Epoch:7 | Val Acc: 0.4800
 Best site-Real       | Epoch:7 | Val Acc: 0.4510
 Best site-Sketch     | Epoch:7 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:7 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 8 ============
denominator: 51866.234375
 Site-Clipart   | Train Loss: 1.8235 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.7638 | Train Acc: 0.5774
 Site-Infograph | Train Loss: 2.1579 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.0621 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.8286 | Train Acc: 0.4828
 Site-Painting  | Train Loss: 1.9021 | Train Acc: 0.4655
 Site-QuickDraw | Train Loss: 2.2026 | Train Acc: 0.0312
 Site-QuickDraw | Train Loss: 2.1461 | Train Acc: 0.1719
 Site-Real      | Train Loss: 1.7637 | Train Acc: 0.5526
 Site-Real      | Train Loss: 1.7867 | Train Acc: 0.5065
 Site-Sketch    | Train Loss: 1.6180 | Train Acc: 0.6286
 Site-Sketch    | Train Loss: 1.8205 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 1.7163 | Val  Acc: 0.5357
 Site-Clipart   | Val  Loss: 1.7532 | Val  Acc: 0.5625
 Site-Infograph | Val  Loss: 2.0364 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.0722 | Val  Acc: 0.3415
 Site-Painting  | Val  Loss: 1.8530 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.9122 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 1.9404 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.1557 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.8607 | Val  Acc: 0.4400
 Site-Real      | Val  Loss: 1.8405 | Val  Acc: 0.5490
 Site-Sketch    | Val  Loss: 1.8598 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 1.9103 | Val  Acc: 0.4565
Average Valid Accuracy: 0.4173
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5357
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5625
 Best site-Infograph  | Epoch:8 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.3415
 Best site-Painting   | Epoch:8 | Val Acc: 0.6316
 Best site-Painting   | Epoch:8 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.1667
 Best site-Real       | Epoch:8 | Val Acc: 0.4400
 Best site-Real       | Epoch:8 | Val Acc: 0.5490
 Best site-Sketch     | Epoch:8 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:8 | Val Acc: 0.4565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 9 ============
denominator: 50942.859375
 Site-Clipart   | Train Loss: 1.7845 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.6953 | Train Acc: 0.6250
 Site-Infograph | Train Loss: 2.1095 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.0583 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.7831 | Train Acc: 0.5517
 Site-Painting  | Train Loss: 1.8350 | Train Acc: 0.4655
 Site-QuickDraw | Train Loss: 2.2037 | Train Acc: 0.0938
 Site-QuickDraw | Train Loss: 2.1292 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.6552 | Train Acc: 0.6842
 Site-Real      | Train Loss: 1.7533 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 1.5685 | Train Acc: 0.5143
 Site-Sketch    | Train Loss: 1.7921 | Train Acc: 0.5286
 Site-Clipart   | Val  Loss: 1.6744 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6774 | Val  Acc: 0.5804
 Site-Infograph | Val  Loss: 1.9244 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 2.0778 | Val  Acc: 0.3659
 Site-Painting  | Val  Loss: 1.7841 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.8965 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 1.9186 | Val  Acc: 0.1429
 Site-QuickDraw | Val  Loss: 2.1373 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8511 | Val  Acc: 0.4800
 Site-Real      | Val  Loss: 1.7354 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.7884 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 1.8002 | Val  Acc: 0.5652
Average Valid Accuracy: 0.4705
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5804
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.3659
 Best site-Painting   | Epoch:9 | Val Acc: 0.5789
 Best site-Painting   | Epoch:9 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.1429
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.1905
 Best site-Real       | Epoch:9 | Val Acc: 0.4800
 Best site-Real       | Epoch:9 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:9 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:9 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.5304
 Test site-Infograph | Epoch:9 | Test Acc: 0.3044
 Test site-Painting  | Epoch:9 | Test Acc: 0.5654
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.1890
 Test site-Real      | Epoch:9 | Test Acc: 0.6163
 Test site-Sketch    | Epoch:9 | Test Acc: 0.5379
Average Test Accuracy: 0.4572
============ Train epoch 10 ============
denominator: 49755.5859375
 Site-Clipart   | Train Loss: 1.7641 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.6661 | Train Acc: 0.6488
 Site-Infograph | Train Loss: 2.1645 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.0388 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.7313 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.7482 | Train Acc: 0.5862
 Site-QuickDraw | Train Loss: 2.2079 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.1139 | Train Acc: 0.2344
 Site-Real      | Train Loss: 1.6120 | Train Acc: 0.6579
 Site-Real      | Train Loss: 1.6844 | Train Acc: 0.6364
 Site-Sketch    | Train Loss: 1.5088 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 1.7201 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.6368 | Val  Acc: 0.6071
 Site-Clipart   | Val  Loss: 1.6440 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 1.9774 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 2.0080 | Val  Acc: 0.3415
 Site-Painting  | Val  Loss: 1.7031 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.8586 | Val  Acc: 0.6154
 Site-QuickDraw | Val  Loss: 1.9150 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.1025 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.7302 | Val  Acc: 0.6000
 Site-Real      | Val  Loss: 1.7081 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.7363 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 1.7583 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5075
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6071
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6607
 Best site-Infograph  | Epoch:10 | Val Acc: 0.3500
 Best site-Infograph  | Epoch:10 | Val Acc: 0.3415
 Best site-Painting   | Epoch:10 | Val Acc: 0.7368
 Best site-Painting   | Epoch:10 | Val Acc: 0.6154
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.1905
 Best site-Real       | Epoch:10 | Val Acc: 0.6000
 Best site-Real       | Epoch:10 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:10 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:10 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 11 ============
denominator: 48046.8125
 Site-Clipart   | Train Loss: 1.5512 | Train Acc: 0.6548
 Site-Clipart   | Train Loss: 1.5779 | Train Acc: 0.7024
 Site-Infograph | Train Loss: 2.1347 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.0089 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.6680 | Train Acc: 0.5517
 Site-Painting  | Train Loss: 1.7023 | Train Acc: 0.6207
 Site-QuickDraw | Train Loss: 2.2080 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.0941 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.5210 | Train Acc: 0.7105
 Site-Real      | Train Loss: 1.6123 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.5976 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 1.6840 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 1.5722 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.5710 | Val  Acc: 0.6696
 Site-Infograph | Val  Loss: 1.8755 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.9640 | Val  Acc: 0.3902
 Site-Painting  | Val  Loss: 1.5471 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.8230 | Val  Acc: 0.5897
 Site-QuickDraw | Val  Loss: 1.9325 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.1306 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 1.6921 | Val  Acc: 0.6400
 Site-Real      | Val  Loss: 1.6566 | Val  Acc: 0.6863
 Site-Sketch    | Val  Loss: 1.6021 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 1.6577 | Val  Acc: 0.6304
Average Valid Accuracy: 0.5414
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6696
 Best site-Infograph  | Epoch:11 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:11 | Val Acc: 0.3902
 Best site-Painting   | Epoch:11 | Val Acc: 0.7368
 Best site-Painting   | Epoch:11 | Val Acc: 0.5897
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.1667
 Best site-Real       | Epoch:11 | Val Acc: 0.6400
 Best site-Real       | Epoch:11 | Val Acc: 0.6863
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 12 ============
denominator: 46742.82421875
 Site-Clipart   | Train Loss: 1.5797 | Train Acc: 0.6786
 Site-Clipart   | Train Loss: 1.5569 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 2.0814 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.9797 | Train Acc: 0.4032
 Site-Painting  | Train Loss: 1.6342 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.6370 | Train Acc: 0.6552
 Site-QuickDraw | Train Loss: 2.1812 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.0573 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.5206 | Train Acc: 0.6579
 Site-Real      | Train Loss: 1.5347 | Train Acc: 0.6623
 Site-Sketch    | Train Loss: 1.4072 | Train Acc: 0.6000
 Site-Sketch    | Train Loss: 1.6159 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.5146 | Val  Acc: 0.6786
 Site-Clipart   | Val  Loss: 1.5365 | Val  Acc: 0.6696
 Site-Infograph | Val  Loss: 1.8651 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.9574 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 1.4998 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.7128 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9382 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.0769 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.5846 | Val  Acc: 0.7200
 Site-Real      | Val  Loss: 1.5458 | Val  Acc: 0.7647
 Site-Sketch    | Val  Loss: 1.6112 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 1.6597 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5823
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6786
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6696
 Best site-Infograph  | Epoch:12 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:12 | Val Acc: 0.4634
 Best site-Painting   | Epoch:12 | Val Acc: 0.6842
 Best site-Painting   | Epoch:12 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.3095
 Best site-Real       | Epoch:12 | Val Acc: 0.7200
 Best site-Real       | Epoch:12 | Val Acc: 0.7647
 Best site-Sketch     | Epoch:12 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:12 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 13 ============
denominator: 45782.6484375
 Site-Clipart   | Train Loss: 1.5033 | Train Acc: 0.6548
 Site-Clipart   | Train Loss: 1.4986 | Train Acc: 0.7440
 Site-Infograph | Train Loss: 2.0979 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 1.9874 | Train Acc: 0.3710
 Site-Painting  | Train Loss: 1.5803 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.5940 | Train Acc: 0.6379
 Site-QuickDraw | Train Loss: 2.1209 | Train Acc: 0.1562
 Site-QuickDraw | Train Loss: 2.0582 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.4338 | Train Acc: 0.7632
 Site-Real      | Train Loss: 1.4928 | Train Acc: 0.7403
 Site-Sketch    | Train Loss: 1.4572 | Train Acc: 0.6857
===2023-04-17 00:47:50===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
=================================
 ==== model type: cocoop ====
=================================
============ Train epoch 13 ============
denominator: 52658.9296875
 Site-Clipart   | Train Loss: 1.4785 | Train Acc: 0.7024
 Site-Clipart   | Train Loss: 1.5013 | Train Acc: 0.7381
 Site-Infograph | Train Loss: 2.0769 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9821 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.6462 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.5920 | Train Acc: 0.7241
 Site-QuickDraw | Train Loss: 2.2012 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.0518 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.4289 | Train Acc: 0.7632
 Site-Real      | Train Loss: 1.5133 | Train Acc: 0.7403
 Site-Sketch    | Train Loss: 1.3935 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.5348 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 1.4536 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.4510 | Val  Acc: 0.7054
 Site-Infograph | Val  Loss: 1.9248 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.9327 | Val  Acc: 0.4146
 Site-Painting  | Val  Loss: 1.5365 | Val  Acc: 0.5263
 Site-Painting  | Val  Loss: 1.6938 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 1.8895 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.0671 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.5746 | Val  Acc: 0.7200
 Site-Real      | Val  Loss: 1.5220 | Val  Acc: 0.7059
 Site-Sketch    | Val  Loss: 1.5727 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.6506 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5749
============ Train epoch 14 ============
denominator: 48099.44140625
 Site-Clipart   | Train Loss: 1.4277 | Train Acc: 0.6905
 Site-Clipart   | Train Loss: 1.4770 | Train Acc: 0.7321
 Site-Infograph | Train Loss: 2.0553 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9359 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 1.4969 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.5360 | Train Acc: 0.6897
 Site-QuickDraw | Train Loss: 2.1620 | Train Acc: 0.1250
 Site-QuickDraw | Train Loss: 2.0629 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.3307 | Train Acc: 0.7895
 Site-Real      | Train Loss: 1.4187 | Train Acc: 0.8182
 Site-Sketch    | Train Loss: 1.2919 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.5769 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.3678 | Val  Acc: 0.8036
 Site-Clipart   | Val  Loss: 1.4444 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 1.9435 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9295 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 1.4740 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.5798 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 1.8901 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.0862 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.5327 | Val  Acc: 0.7600
 Site-Real      | Val  Loss: 1.4182 | Val  Acc: 0.7255
 Site-Sketch    | Val  Loss: 1.5334 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.5739 | Val  Acc: 0.6739
Average Valid Accuracy: 0.5957
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8036
 Best site-Clipart    | Epoch:14 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:14 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:14 | Val Acc: 0.4634
 Best site-Painting   | Epoch:14 | Val Acc: 0.6316
 Best site-Painting   | Epoch:14 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.2381
 Best site-Real       | Epoch:14 | Val Acc: 0.7600
 Best site-Real       | Epoch:14 | Val Acc: 0.7255
 Best site-Sketch     | Epoch:14 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:14 | Val Acc: 0.6739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 15 ============
denominator: 45593.6953125
 Site-Clipart   | Train Loss: 1.4825 | Train Acc: 0.6905
 Site-Clipart   | Train Loss: 1.3998 | Train Acc: 0.7917
 Site-Infograph | Train Loss: 2.0430 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9144 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.4479 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.4578 | Train Acc: 0.7241
 Site-QuickDraw | Train Loss: 2.1631 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 1.9969 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.4321 | Train Acc: 0.7632
 Site-Real      | Train Loss: 1.3660 | Train Acc: 0.7662
 Site-Sketch    | Train Loss: 1.3555 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.4485 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.3593 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3371 | Val  Acc: 0.8125
 Site-Infograph | Val  Loss: 1.8714 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.9509 | Val  Acc: 0.4390
 Site-Painting  | Val  Loss: 1.3871 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.5645 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.8920 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.0713 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.4445 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 1.4174 | Val  Acc: 0.8431
 Site-Sketch    | Val  Loss: 1.3979 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.5069 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6261
 Best site-Clipart    | Epoch:15 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8125
 Best site-Infograph  | Epoch:15 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:15 | Val Acc: 0.4390
 Best site-Painting   | Epoch:15 | Val Acc: 0.6316
 Best site-Painting   | Epoch:15 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2619
 Best site-Real       | Epoch:15 | Val Acc: 0.8400
 Best site-Real       | Epoch:15 | Val Acc: 0.8431
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 16 ============
denominator: 43860.421875
 Site-Clipart   | Train Loss: 1.4072 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.3626 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.0550 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8922 | Train Acc: 0.4677
 Site-Painting  | Train Loss: 1.3838 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.4418 | Train Acc: 0.7069
 Site-QuickDraw | Train Loss: 2.0895 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.9690 | Train Acc: 0.3906
 Site-Real      | Train Loss: 1.2881 | Train Acc: 0.7895
 Site-Real      | Train Loss: 1.3194 | Train Acc: 0.8312
 Site-Sketch    | Train Loss: 1.3087 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.4073 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3246 | Val  Acc: 0.7679
 Site-Clipart   | Val  Loss: 1.3250 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.9597 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.9457 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 1.3381 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.4466 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.9254 | Val  Acc: 0.2381
 Site-QuickDraw | Val  Loss: 2.0080 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.3185 | Val  Acc: 0.7600
 Site-Real      | Val  Loss: 1.3468 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.4378 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.4710 | Val  Acc: 0.6739
Average Valid Accuracy: 0.6265
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7679
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4878
 Best site-Painting   | Epoch:16 | Val Acc: 0.7368
 Best site-Painting   | Epoch:16 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.2381
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.3333
 Best site-Real       | Epoch:16 | Val Acc: 0.7600
 Best site-Real       | Epoch:16 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:16 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:16 | Val Acc: 0.6739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 17 ============
denominator: 43152.6875
 Site-Clipart   | Train Loss: 1.3733 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.3066 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.0240 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8877 | Train Acc: 0.4355
 Site-Painting  | Train Loss: 1.3566 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.4054 | Train Acc: 0.7414
 Site-QuickDraw | Train Loss: 2.0761 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.9642 | Train Acc: 0.3594
 Site-Real      | Train Loss: 1.3103 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.2337 | Train Acc: 0.8312
 Site-Sketch    | Train Loss: 1.0761 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.3614 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.2828 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.2825 | Val  Acc: 0.7411
 Site-Infograph | Val  Loss: 1.8440 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.9116 | Val  Acc: 0.4390
 Site-Painting  | Val  Loss: 1.2312 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.4351 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.9038 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.0429 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.2956 | Val  Acc: 0.8000
 Site-Real      | Val  Loss: 1.2421 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.4179 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.4943 | Val  Acc: 0.6304
Average Valid Accuracy: 0.6402
 Best site-Clipart    | Epoch:17 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:17 | Val Acc: 0.7411
 Best site-Infograph  | Epoch:17 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:17 | Val Acc: 0.4390
 Best site-Painting   | Epoch:17 | Val Acc: 0.8421
 Best site-Painting   | Epoch:17 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.2857
 Best site-Real       | Epoch:17 | Val Acc: 0.8000
 Best site-Real       | Epoch:17 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:17 | Val Acc: 0.6304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 18 ============
denominator: 42733.67578125
 Site-Clipart   | Train Loss: 1.2866 | Train Acc: 0.7381
 Site-Clipart   | Train Loss: 1.2661 | Train Acc: 0.7917
 Site-Infograph | Train Loss: 1.9502 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.8416 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 1.3293 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.3171 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 2.0829 | Train Acc: 0.2188
 Site-QuickDraw | Train Loss: 1.9611 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.1787 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.2145 | Train Acc: 0.8442
 Site-Sketch    | Train Loss: 1.1028 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.3608 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2477 | Val  Acc: 0.7679
 Site-Clipart   | Val  Loss: 1.2317 | Val  Acc: 0.7768
 Site-Infograph | Val  Loss: 1.7629 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8899 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 1.2155 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.4110 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.8926 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.0305 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.3182 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 1.1660 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.3939 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.4014 | Val  Acc: 0.6739
Average Valid Accuracy: 0.6502
 Best site-Clipart    | Epoch:18 | Val Acc: 0.7679
 Best site-Clipart    | Epoch:18 | Val Acc: 0.7768
 Best site-Infograph  | Epoch:18 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:18 | Val Acc: 0.4878
 Best site-Painting   | Epoch:18 | Val Acc: 0.8421
 Best site-Painting   | Epoch:18 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.2619
 Best site-Real       | Epoch:18 | Val Acc: 0.8400
 Best site-Real       | Epoch:18 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:18 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:18 | Val Acc: 0.6739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 19 ============
denominator: 42031.66015625
 Site-Clipart   | Train Loss: 1.2650 | Train Acc: 0.7738
 Site-Clipart   | Train Loss: 1.2449 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.0591 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.8749 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.2921 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.3226 | Train Acc: 0.7931
 Site-QuickDraw | Train Loss: 2.0398 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.9691 | Train Acc: 0.4219
 Site-Real      | Train Loss: 1.2128 | Train Acc: 0.7895
 Site-Real      | Train Loss: 1.1805 | Train Acc: 0.8312
 Site-Sketch    | Train Loss: 1.1075 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.2833 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1591 | Val  Acc: 0.8214
 Site-Clipart   | Val  Loss: 1.1943 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.7912 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.8735 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 1.2323 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.4183 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.8178 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.0191 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.2190 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 1.1347 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 1.3091 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.3786 | Val  Acc: 0.6739
Average Valid Accuracy: 0.6484
============ Train epoch 20 ============
denominator: 40465.06640625
 Site-Clipart   | Train Loss: 1.1904 | Train Acc: 0.7976
 Site-Clipart   | Train Loss: 1.1936 | Train Acc: 0.8512
 Site-Infograph | Train Loss: 1.9704 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.8419 | Train Acc: 0.4677
 Site-Painting  | Train Loss: 1.2283 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.2880 | Train Acc: 0.7759
 Site-QuickDraw | Train Loss: 2.0661 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 1.9320 | Train Acc: 0.3906
 Site-Real      | Train Loss: 1.1264 | Train Acc: 0.7895
 Site-Real      | Train Loss: 1.1362 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9957 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.3465 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.1423 | Val  Acc: 0.8214
 Site-Clipart   | Val  Loss: 1.1247 | Val  Acc: 0.8482
 Site-Infograph | Val  Loss: 1.7948 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.8401 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 1.0289 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.3814 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.9124 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.9784 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.1726 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.1158 | Val  Acc: 0.8431
 Site-Sketch    | Val  Loss: 1.2098 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.3588 | Val  Acc: 0.7609
Average Valid Accuracy: 0.6713
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8214
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8482
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4634
 Best site-Painting   | Epoch:20 | Val Acc: 0.7895
 Best site-Painting   | Epoch:20 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.3095
 Best site-Real       | Epoch:20 | Val Acc: 0.8800
 Best site-Real       | Epoch:20 | Val Acc: 0.8431
 Best site-Sketch     | Epoch:20 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:20 | Val Acc: 0.7609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 21 ============
denominator: 39782.5390625
 Site-Clipart   | Train Loss: 1.1603 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.1714 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 1.9301 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.8333 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 1.2589 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.2499 | Train Acc: 0.7759
 Site-QuickDraw | Train Loss: 2.0561 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 1.9194 | Train Acc: 0.4062
 Site-Real      | Train Loss: 1.1267 | Train Acc: 0.7895
 Site-Real      | Train Loss: 1.0842 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 1.1368 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.2305 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0871 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1260 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.7528 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8855 | Val  Acc: 0.4390
 Site-Painting  | Val  Loss: 1.1298 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.3587 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.9067 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 1.9875 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.1274 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.1357 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.2433 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.2635 | Val  Acc: 0.7391
Average Valid Accuracy: 0.6722
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:21 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:21 | Val Acc: 0.4390
 Best site-Painting   | Epoch:21 | Val Acc: 0.7895
 Best site-Painting   | Epoch:21 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.2619
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Real       | Epoch:21 | Val Acc: 0.8824
 Best site-Sketch     | Epoch:21 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:21 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 22 ============
denominator: 39518.91015625
 Site-Clipart   | Train Loss: 1.1300 | Train Acc: 0.7857
 Site-Clipart   | Train Loss: 1.1323 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 1.9728 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.8133 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 1.2253 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.2038 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 2.0867 | Train Acc: 0.1875
 Site-QuickDraw | Train Loss: 1.9339 | Train Acc: 0.4219
 Site-Real      | Train Loss: 1.1133 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.0575 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 0.9990 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.1346 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0710 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.1236 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.7910 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.8673 | Val  Acc: 0.4390
 Site-Painting  | Val  Loss: 1.1441 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.3789 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 1.7907 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 1.9150 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.1175 | Val  Acc: 0.8400
 Site-Real      | Val  Loss: 1.0521 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.2708 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.2253 | Val  Acc: 0.7609
Average Valid Accuracy: 0.6573
============ Train epoch 23 ============
denominator: 38705.453125
 Site-Clipart   | Train Loss: 1.1669 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.1182 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 1.9318 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.8148 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 1.1792 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.1146 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.0419 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.8841 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.1206 | Train Acc: 0.8158
 Site-Real      | Train Loss: 0.9991 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.9208 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.1924 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.0170 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0536 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.6921 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7987 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 1.0151 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.2653 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.8707 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.9690 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.0863 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.0051 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.1736 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.2358 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7140
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8393
 Best site-Infograph  | Epoch:23 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:23 | Val Acc: 0.5366
 Best site-Painting   | Epoch:23 | Val Acc: 0.8421
 Best site-Painting   | Epoch:23 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.3571
 Best site-Real       | Epoch:23 | Val Acc: 0.8800
 Best site-Real       | Epoch:23 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:23 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 24 ============
denominator: 38392.51171875
 Site-Clipart   | Train Loss: 1.0946 | Train Acc: 0.7857
 Site-Clipart   | Train Loss: 1.0791 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 1.9096 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.7679 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.0990 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.1130 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 2.0332 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.8763 | Train Acc: 0.4219
 Site-Real      | Train Loss: 0.9196 | Train Acc: 0.8421
 Site-Real      | Train Loss: 0.9902 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 0.8771 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.1891 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0289 | Val  Acc: 0.8036
 Site-Clipart   | Val  Loss: 1.0644 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.7746 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.8524 | Val  Acc: 0.4390
 Site-Painting  | Val  Loss: 0.9990 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.2274 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.8168 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.9175 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 1.0310 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.9517 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.1821 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.1189 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6882
============ Train epoch 25 ============
denominator: 38079.71875
 Site-Clipart   | Train Loss: 1.0985 | Train Acc: 0.8214
 Site-Clipart   | Train Loss: 1.0792 | Train Acc: 0.8393
 Site-Infograph | Train Loss: 1.9925 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.8463 | Train Acc: 0.4677
 Site-Painting  | Train Loss: 1.0824 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.1168 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.0419 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.8626 | Train Acc: 0.3594
 Site-Real      | Train Loss: 0.9564 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.9549 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 0.9197 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 1.0510 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.9757 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0076 | Val  Acc: 0.8304
 Site-Infograph | Val  Loss: 1.6663 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.8321 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 1.0297 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.1853 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.8911 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.9106 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.9925 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.9114 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.0421 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.1897 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7019
============ Train epoch 26 ============
denominator: 37679.83984375
 Site-Clipart   | Train Loss: 1.0315 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.0434 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 1.8810 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.7632 | Train Acc: 0.4677
 Site-Painting  | Train Loss: 1.0345 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 1.0467 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 2.0384 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.8916 | Train Acc: 0.4062
 Site-Real      | Train Loss: 0.8392 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.9237 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 0.9048 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.0308 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 0.9299 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0007 | Val  Acc: 0.8482
 Site-Infograph | Val  Loss: 1.6640 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7451 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.9220 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.1649 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.7747 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.9225 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.9753 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.8971 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.0962 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.1310 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7232
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8482
 Best site-Infograph  | Epoch:26 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:26 | Val Acc: 0.5122
 Best site-Painting   | Epoch:26 | Val Acc: 0.8947
 Best site-Painting   | Epoch:26 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.3571
 Best site-Real       | Epoch:26 | Val Acc: 0.8800
 Best site-Real       | Epoch:26 | Val Acc: 0.9020
 Best site-Sketch     | Epoch:26 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:26 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 27 ============
denominator: 36968.953125
 Site-Clipart   | Train Loss: 1.0288 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 1.0077 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 1.8284 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.7298 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 1.0064 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 1.0837 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.0226 | Train Acc: 0.2500
 Site-QuickDraw | Train Loss: 1.8644 | Train Acc: 0.3906
 Site-Real      | Train Loss: 0.8091 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.8646 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 1.1455 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.9797 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.9414 | Val  Acc: 0.8393
 Site-Clipart   | Val  Loss: 0.9522 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 1.7206 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.8225 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 0.9204 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.1872 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.8318 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.9508 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.9662 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.8417 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.0300 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.1623 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7094
============ Train epoch 28 ============
denominator: 36413.81640625
 Site-Clipart   | Train Loss: 1.0183 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.9766 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 1.9202 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.7259 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 1.0482 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 1.0333 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.9842 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.8577 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.0014 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.8554 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 1.1259 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.0490 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.8781 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.9657 | Val  Acc: 0.7946
 Site-Infograph | Val  Loss: 1.7800 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7416 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.8943 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.1649 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.7562 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.9247 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.9812 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.8411 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.9512 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.0780 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7067
============ Train epoch 29 ============
denominator: 35469.91796875
 Site-Clipart   | Train Loss: 0.9954 | Train Acc: 0.8452
 Site-Clipart   | Train Loss: 0.9688 | Train Acc: 0.8631
 Site-Infograph | Train Loss: 1.8738 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7098 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.9995 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.9703 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.9336 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.8135 | Train Acc: 0.4844
 Site-Real      | Train Loss: 0.8673 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.8332 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.7979 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.9985 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 0.9102 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.8856 | Val  Acc: 0.8304
 Site-Infograph | Val  Loss: 1.6673 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7214 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 0.8998 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.1189 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.9279 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.9404 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8955 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.7741 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.0082 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.1349 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7305
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8304
 Best site-Infograph  | Epoch:29 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:29 | Val Acc: 0.4878
 Best site-Painting   | Epoch:29 | Val Acc: 0.8421
 Best site-Painting   | Epoch:29 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.3333
 Best site-Real       | Epoch:29 | Val Acc: 0.9200
 Best site-Real       | Epoch:29 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8118
 Test site-Infograph | Epoch:29 | Test Acc: 0.4505
 Test site-Painting  | Epoch:29 | Test Acc: 0.8465
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3750
 Test site-Real      | Epoch:29 | Test Acc: 0.9129
 Test site-Sketch    | Epoch:29 | Test Acc: 0.7798
Average Test Accuracy: 0.6961
============ Train epoch 30 ============
denominator: 35196.11328125
 Site-Clipart   | Train Loss: 0.9118 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9145 | Train Acc: 0.8512
 Site-Infograph | Train Loss: 1.8641 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.7075 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 0.9717 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.0146 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 1.9922 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.8334 | Train Acc: 0.4219
 Site-Real      | Train Loss: 0.7917 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.8306 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.9420 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.0076 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.8386 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8418 | Val  Acc: 0.8661
 Site-Infograph | Val  Loss: 1.6239 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.7892 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 0.9107 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.1315 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7754 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.9168 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.8345 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.7565 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.0164 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.1010 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7269
============ Train epoch 31 ============
denominator: 34569.7890625
 Site-Clipart   | Train Loss: 1.0169 | Train Acc: 0.8214
 Site-Clipart   | Train Loss: 0.9192 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.8859 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6943 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.9855 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.8963 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.9676 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.7865 | Train Acc: 0.4531
 Site-Real      | Train Loss: 0.6869 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.7820 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 0.7564 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.9242 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8199 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8937 | Val  Acc: 0.8661
 Site-Infograph | Val  Loss: 1.6870 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7437 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 0.8073 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.0425 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.7796 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.8439 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.8130 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.7548 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.0138 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.0631 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7271
============ Train epoch 32 ============
denominator: 34852.07421875
 Site-Clipart   | Train Loss: 0.9527 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 0.8999 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.8162 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6854 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.9389 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.9021 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.9579 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.7858 | Train Acc: 0.4531
 Site-Real      | Train Loss: 0.7544 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.7757 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.9873 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.9764 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.8513 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.8283 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.6612 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.7850 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.8197 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.0546 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.7812 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.8620 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7670 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.7269 | Val  Acc: 0.8627
 Site-Sketch    | Val  Loss: 0.9136 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.9559 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7339
 Best site-Clipart    | Epoch:32 | Val Acc: 0.8929
 Best site-Clipart    | Epoch:32 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:32 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:32 | Val Acc: 0.5122
 Best site-Painting   | Epoch:32 | Val Acc: 0.7895
 Best site-Painting   | Epoch:32 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.3810
 Best site-Real       | Epoch:32 | Val Acc: 0.9200
 Best site-Real       | Epoch:32 | Val Acc: 0.8627
 Best site-Sketch     | Epoch:32 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:32 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 33 ============
denominator: 34448.13671875
 Site-Clipart   | Train Loss: 0.9535 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.8787 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.8431 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6792 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.9032 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.9704 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.9874 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.7705 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.8092 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.7472 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.8782 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.9993 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.7770 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.8097 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.6836 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.7558 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.8143 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.0335 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7756 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.8688 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.8031 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.7028 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.9213 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.0400 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7259
============ Train epoch 34 ============
denominator: 33833.65234375
 Site-Clipart   | Train Loss: 0.9084 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 0.8842 | Train Acc: 0.8512
 Site-Infograph | Train Loss: 1.8086 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.6839 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 0.9751 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.8895 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.9753 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.7750 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.7093 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.7262 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.7980 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9065 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.7989 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.8019 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.5891 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.7559 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.7858 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.9892 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.8034 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.8349 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7721 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.7306 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.8619 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.0044 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7342
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:34 | Val Acc: 0.4500
 Best site-Infograph  | Epoch:34 | Val Acc: 0.4634
 Best site-Painting   | Epoch:34 | Val Acc: 0.8947
 Best site-Painting   | Epoch:34 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.3810
 Best site-Real       | Epoch:34 | Val Acc: 0.9200
 Best site-Real       | Epoch:34 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:34 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:34 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 35 ============
denominator: 34149.84375
 Site-Clipart   | Train Loss: 0.8560 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.8374 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 1.8219 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.7117 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.8335 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.8357 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.9447 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.7460 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.7120 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.7288 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.9211 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.9310 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.7687 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.7919 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.5636 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6613 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.8122 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.9699 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.7201 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.8548 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.7103 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.6420 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.8853 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.9873 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7268
============ Train epoch 36 ============
denominator: 33504.859375
 Site-Clipart   | Train Loss: 0.8506 | Train Acc: 0.8690
 Site-Clipart   | Train Loss: 0.8095 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 1.8191 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.6660 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 0.8433 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.9202 | Train Acc: 0.8103
 Site-QuickDraw | Train Loss: 1.9473 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.7547 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.6927 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.7151 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.5985 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.9033 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7464 | Val  Acc: 0.8929
 Site-Clipart   | Val  Loss: 0.8181 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.5887 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.7099 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 0.6991 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.0008 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.7952 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.8515 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7368 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.6226 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.8385 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.9731 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7301
============ Train epoch 37 ============
denominator: 32932.0546875
 Site-Clipart   | Train Loss: 0.8222 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.8134 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 1.7914 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6399 | Train Acc: 0.5323
 Site-Painting  | Train Loss: 0.8741 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.8119 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.9536 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.6869 | Train Acc: 0.5156
 Site-Real      | Train Loss: 0.6988 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.6665 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.6953 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.8307 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.7869 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.7786 | Val  Acc: 0.8482
 Site-Infograph | Val  Loss: 1.6058 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.6876 | Val  Acc: 0.4390
 Site-Painting  | Val  Loss: 0.7797 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.9484 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.6846 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.8293 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.7527 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.6301 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.8317 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.0007 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7393
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:37 | Val Acc: 0.8482
 Best site-Infograph  | Epoch:37 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:37 | Val Acc: 0.4390
 Best site-Painting   | Epoch:37 | Val Acc: 0.8421
 Best site-Painting   | Epoch:37 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.4048
 Best site-Real       | Epoch:37 | Val Acc: 0.9200
 Best site-Real       | Epoch:37 | Val Acc: 0.9608
 Best site-Sketch     | Epoch:37 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:37 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 38 ============
denominator: 32785.26171875
 Site-Clipart   | Train Loss: 0.8375 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.7924 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 1.8332 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6342 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.8482 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.7986 | Train Acc: 0.8448
 Site-QuickDraw | Train Loss: 1.9880 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.7202 | Train Acc: 0.4062
 Site-Real      | Train Loss: 0.7612 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6696 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 0.7726 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9910 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.7029 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.7680 | Val  Acc: 0.8482
 Site-Infograph | Val  Loss: 1.7610 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.6793 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 0.7145 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.8892 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.6594 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.8015 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.7694 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 0.6450 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.8484 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.9691 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7467
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9107
 Best site-Clipart    | Epoch:38 | Val Acc: 0.8482
 Best site-Infograph  | Epoch:38 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:38 | Val Acc: 0.5366
 Best site-Painting   | Epoch:38 | Val Acc: 0.7895
 Best site-Painting   | Epoch:38 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.4286
 Best site-Real       | Epoch:38 | Val Acc: 0.8800
 Best site-Real       | Epoch:38 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:38 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:38 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
============ Train epoch 39 ============
denominator: 32216.75390625
 Site-Clipart   | Train Loss: 0.8542 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.7461 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.8369 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.6186 | Train Acc: 0.5645
 Site-Painting  | Train Loss: 0.8267 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.7601 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.8970 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.6889 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.6774 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.6507 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 0.7225 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.8924 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.7263 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.7329 | Val  Acc: 0.8661
 Site-Infograph | Val  Loss: 1.5237 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.6447 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.6265 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8935 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.7188 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.8206 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.6409 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.6348 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.7661 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.9341 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7582
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8661
 Best site-Infograph  | Epoch:39 | Val Acc: 0.5500
 Best site-Infograph  | Epoch:39 | Val Acc: 0.4634
 Best site-Painting   | Epoch:39 | Val Acc: 0.8421
 Best site-Painting   | Epoch:39 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.4048
 Best site-Real       | Epoch:39 | Val Acc: 0.9200
 Best site-Real       | Epoch:39 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:39 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:39 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1/q-FFL...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8441
 Test site-Infograph | Epoch:39 | Test Acc: 0.4718
 Test site-Painting  | Epoch:39 | Test Acc: 0.8659
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.4010
 Test site-Real      | Epoch:39 | Test Acc: 0.9244
 Test site-Sketch    | Epoch:39 | Test Acc: 0.7942
Average Test Accuracy: 0.7169
============ Train epoch 40 ============
denominator: 32408.15234375
 Site-Clipart   | Train Loss: 0.8987 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.7520 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.7797 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6500 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.8349 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.7220 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 1.9427 | Train Acc: 0.2812
 Site-QuickDraw | Train Loss: 1.6777 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.6680 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5994 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.8797 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.8429 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6373 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.7846 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.6223 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.6013 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 0.6899 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.8931 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.6431 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.7488 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.6990 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5739 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.8715 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.8498 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7427
============ Train epoch 41 ============
denominator: 32071.42578125
 Site-Clipart   | Train Loss: 0.7262 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.7462 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.7177 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6251 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.7257 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.7528 | Train Acc: 0.8793
 Site-QuickDraw | Train Loss: 2.0247 | Train Acc: 0.3125
 Site-QuickDraw | Train Loss: 1.7070 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.6640 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5958 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.6290 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.9230 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.6885 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7021 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 1.4979 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6546 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.5563 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8699 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7014 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.8356 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.6066 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5345 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.9258 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.8730 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7411
============ Train epoch 42 ============
denominator: 31845.1484375
 Site-Clipart   | Train Loss: 0.7210 | Train Acc: 0.8214
 Site-Clipart   | Train Loss: 0.7577 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.7838 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.5967 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.7622 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.7486 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.9241 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.6846 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.6470 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5949 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 0.5849 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.7546 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6919 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6607 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 1.4486 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.6823 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.6467 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.9094 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.7125 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.8441 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6438 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5500 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.7867 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.9608 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7471
============ Train epoch 43 ============
denominator: 31373.6484375
 Site-Clipart   | Train Loss: 0.6966 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6888 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.7321 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.6309 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.7064 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.7119 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 1.8403 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.6769 | Train Acc: 0.4531
 Site-Real      | Train Loss: 0.5862 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6239 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 0.6929 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.8873 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6727 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6768 | Val  Acc: 0.9018
 Site-Infograph | Val  Loss: 1.5696 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.5804 | Val  Acc: 0.4634
 Site-Painting  | Val  Loss: 0.5657 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.8976 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.7313 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.7353 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.6615 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5648 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.7577 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.8730 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7434
============ Train epoch 44 ============
denominator: 31192.94921875
 Site-Clipart   | Train Loss: 0.7141 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.7485 | Train Acc: 0.8869
 Site-Infograph | Train Loss: 1.7606 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.5509 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.7404 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.7481 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.8925 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.6583 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.5624 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6172 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.6276 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.8828 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6904 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6510 | Val  Acc: 0.9018
 Site-Infograph | Val  Loss: 1.4251 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.6831 | Val  Acc: 0.5366
 Site-Painting  | Val  Loss: 0.6528 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8342 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6886 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.8171 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.5898 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5143 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.7683 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.8160 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7498
============ Train epoch 45 ============
denominator: 31241.33984375
 Site-Clipart   | Train Loss: 0.7226 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.6847 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.7237 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.5742 | Train Acc: 0.5968
 Site-Painting  | Train Loss: 0.7735 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.6911 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 1.8138 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.7133 | Train Acc: 0.4219
 Site-Real      | Train Loss: 0.5626 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.5380 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.6453 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.7493 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6181 | Val  Acc: 0.9107
 Site-Clipart   | Val  Loss: 0.6618 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.5018 | Val  Acc: 0.4500
 Site-Infograph | Val  Loss: 1.5837 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.5537 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.7983 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5957 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.7916 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.6024 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5222 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.6505 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.8578 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7528
============ Train epoch 46 ============
denominator: 31038.57421875
 Site-Clipart   | Train Loss: 0.7025 | Train Acc: 0.8810
 Site-Clipart   | Train Loss: 0.6849 | Train Acc: 0.8988
 Site-Infograph | Train Loss: 1.7341 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5499 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.6754 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.6895 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.8698 | Train Acc: 0.3438
 Site-QuickDraw | Train Loss: 1.6342 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.5665 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.5756 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.5482 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.7479 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.6560 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6793 | Val  Acc: 0.9196
 Site-Infograph | Val  Loss: 1.5796 | Val  Acc: 0.3500
 Site-Infograph | Val  Loss: 1.6160 | Val  Acc: 0.5122
 Site-Painting  | Val  Loss: 0.5351 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.7846 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.7115 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.7700 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.6202 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.4560 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.7473 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.8287 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7373
============ Train epoch 47 ============
denominator: 29964.546875
 Site-Clipart   | Train Loss: 0.6899 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.6605 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.6507 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.5478 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.6978 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.7800 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 1.8164 | Train Acc: 0.4062
 Site-QuickDraw | Train Loss: 1.6191 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.5979 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.5485 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.5948 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.7279 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.5756 | Val  Acc: 0.9464
 Site-Clipart   | Val  Loss: 0.6487 | Val  Acc: 0.9018
 Site-Infograph | Val  Loss: 1.5218 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6242 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.6222 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 0.8256 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.7120 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.7674 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.5383 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.4564 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.7337 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.7835 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7559
============ Train epoch 48 ============
denominator: 29963.87890625
 Site-Clipart   | Train Loss: 0.7020 | Train Acc: 0.8929
 Site-Clipart   | Train Loss: 0.6699 | Train Acc: 0.8869
 Site-Infograph | Train Loss: 1.7619 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.5640 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.6450 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.6441 | Train Acc: 0.9138
 Site-QuickDraw | Train Loss: 1.8552 | Train Acc: 0.4375
 Site-QuickDraw | Train Loss: 1.6053 | Train Acc: 0.5469
 Site-Real      | Train Loss: 0.4609 | Train Acc: 0.9737
 Site-Real      | Train Loss: 0.5546 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 0.6856 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.7527 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6172 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6464 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.5781 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5560 | Val  Acc: 0.4878
 Site-Painting  | Val  Loss: 0.5551 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8146 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.7565 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.7380 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.5323 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.4373 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 0.7948 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.7413 | Val  Acc: 0.8478
Average Valid Accuracy: 0.7477
============ Train epoch 49 ============
denominator: 29157.56640625
 Site-Clipart   | Train Loss: 0.7300 | Train Acc: 0.9405
 Site-Clipart   | Train Loss: 0.6597 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.7241 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.5816 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.7419 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.6515 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 1.8338 | Train Acc: 0.3750
 Site-QuickDraw | Train Loss: 1.5990 | Train Acc: 0.4844
 Site-Real      | Train Loss: 0.4339 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5303 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.6668 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.7294 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6835 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6435 | Val  Acc: 0.8839
 Site-Infograph | Val  Loss: 1.4489 | Val  Acc: 0.5500
 Site-Infograph | Val  Loss: 1.6200 | Val  Acc: 0.5610
 Site-Painting  | Val  Loss: 0.6168 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.7955 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.5413 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.7595 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.5329 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.4624 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.7012 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.7620 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7577
===2023-04-17 01:26:31===
===2023-04-17 01:26:32===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[84,168,31,62,29,58,32,64,38,77,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
=================================
 ==== model type: cocoop ====
=================================
Loading snapshots...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8441
 Test site-Infograph | Epoch:39 | Test Acc: 0.4718
 Test site-Painting  | Epoch:39 | Test Acc: 0.8659
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.4010
 Test site-Real      | Epoch:39 | Test Acc: 0.9244
 Test site-Sketch    | Epoch:39 | Test Acc: 0.7942
Average Test Accuracy: 0.7169
