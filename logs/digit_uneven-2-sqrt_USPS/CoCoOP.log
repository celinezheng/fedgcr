===2023-03-30 13:15:36===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8145 | Train Acc: 0.5238
 Site-MNIST     | Train Loss: 1.7009 | Train Acc: 0.6984
 Site-MNIST     | Train Loss: 1.7399 | Train Acc: 0.5079
 Site-MNIST     | Train Loss: 1.7658 | Train Acc: 0.5714
 Site-MNIST     | Train Loss: 1.6353 | Train Acc: 0.5556
 Site-MNIST     | Train Loss: 1.7438 | Train Acc: 0.6032
 Site-MNIST     | Train Loss: 1.7276 | Train Acc: 0.6349
 Site-SVHN      | Train Loss: 2.2145 | Train Acc: 0.1905
 Site-SynthDigits| Train Loss: 2.1853 | Train Acc: 0.2540
 Site-MNIST-M   | Train Loss: 2.2267 | Train Acc: 0.1905
 Site-MNIST     | Val  Loss: 1.6931 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6757 | Val  Acc: 0.5238
 Site-MNIST     | Val  Loss: 1.7413 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.8085 | Val  Acc: 0.4524
 Site-MNIST     | Val  Loss: 1.7188 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6247 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.8743 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 2.2724 | Val  Acc: 0.1190
 Site-SynthDigits| Val  Loss: 2.1952 | Val  Acc: 0.3095
 Site-MNIST-M   | Val  Loss: 2.2637 | Val  Acc: 0.1190
Average Valid Accuracy: 0.4524
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5238
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4524
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1190
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3095
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1190
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_USPS...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4155 | Train Acc: 0.6825
 Site-MNIST     | Train Loss: 1.3005 | Train Acc: 0.7619
 Site-MNIST     | Train Loss: 1.3557 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.3805 | Train Acc: 0.7302
 Site-MNIST     | Train Loss: 1.2424 | Train Acc: 0.7302
 Site-MNIST     | Train Loss: 1.3349 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 1.3347 | Train Acc: 0.7143
 Site-SVHN      | Train Loss: 2.1524 | Train Acc: 0.2540
 Site-SynthDigits| Train Loss: 2.0387 | Train Acc: 0.2540
 Site-MNIST-M   | Train Loss: 2.1101 | Train Acc: 0.2857
 Site-MNIST     | Val  Loss: 1.2892 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.2840 | Val  Acc: 0.7381
 Site-MNIST     | Val  Loss: 1.3430 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.4351 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.3197 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.2354 | Val  Acc: 0.7857
 Site-MNIST     | Val  Loss: 1.4678 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 2.2438 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 2.0698 | Val  Acc: 0.2857
 Site-MNIST-M   | Val  Loss: 2.1956 | Val  Acc: 0.1190
Average Valid Accuracy: 0.5619
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7381
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7857
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2857
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1190
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_USPS...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1276 | Train Acc: 0.7778
 Site-MNIST     | Train Loss: 1.0157 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 1.0930 | Train Acc: 0.7619
 Site-MNIST     | Train Loss: 1.0796 | Train Acc: 0.7778
 Site-MNIST     | Train Loss: 0.9757 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 1.0414 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 1.0516 | Train Acc: 0.7619
 Site-SVHN      | Train Loss: 2.0763 | Train Acc: 0.3016
 Site-SynthDigits| Train Loss: 1.9263 | Train Acc: 0.3333
 Site-MNIST-M   | Train Loss: 2.0240 | Train Acc: 0.2698
 Site-MNIST     | Val  Loss: 0.9990 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 1.0107 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 1.0458 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 1.1640 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.0574 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.9649 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.1672 | Val  Acc: 0.7381
 Site-SVHN      | Val  Loss: 2.2097 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 1.9751 | Val  Acc: 0.3095
 Site-MNIST-M   | Val  Loss: 2.1327 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6238
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7381
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3095
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_USPS...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9066 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 0.8185 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 0.9002 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 0.8709 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.7839 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.8276 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.8440 | Train Acc: 0.8254
 Site-SVHN      | Train Loss: 2.0326 | Train Acc: 0.2698
 Site-SynthDigits| Train Loss: 1.8392 | Train Acc: 0.3810
 Site-MNIST-M   | Train Loss: 1.9305 | Train Acc: 0.3651
 Site-MNIST     | Val  Loss: 0.7968 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.8069 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.8317 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.9445 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.8651 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.7747 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.9486 | Val  Acc: 0.7381
 Site-SVHN      | Val  Loss: 2.1879 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 1.9077 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 2.0811 | Val  Acc: 0.2381
Average Valid Accuracy: 0.6690
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7381
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_USPS...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7531 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.6855 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.7565 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.7222 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.6477 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.6810 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.7075 | Train Acc: 0.8413
 Site-SVHN      | Train Loss: 1.9842 | Train Acc: 0.2857
 Site-SynthDigits| Train Loss: 1.7598 | Train Acc: 0.4286
 Site-MNIST-M   | Train Loss: 1.8427 | Train Acc: 0.3492
 Site-MNIST     | Val  Loss: 0.6583 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.6573 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.6894 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.7964 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.7254 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.6434 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7974 | Val  Acc: 0.7857
 Site-SVHN      | Val  Loss: 2.1664 | Val  Acc: 0.1905
 Site-SynthDigits| Val  Loss: 1.8436 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 2.0212 | Val  Acc: 0.2143
Average Valid Accuracy: 0.6905
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7857
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1905
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_USPS...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6406 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.5854 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.6476 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.6143 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.5441 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.5798 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.6075 | Train Acc: 0.8730
 Site-SVHN      | Train Loss: 1.9445 | Train Acc: 0.2698
 Site-SynthDigits| Train Loss: 1.6939 | Train Acc: 0.4444
 Site-MNIST-M   | Train Loss: 1.7703 | Train Acc: 0.4127
 Site-MNIST     | Val  Loss: 0.5530 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.5481 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5815 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.6821 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.6227 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.5510 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.6887 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 2.1551 | Val  Acc: 0.1905
 Site-SynthDigits| Val  Loss: 1.7928 | Val  Acc: 0.3571
 Site-MNIST-M   | Val  Loss: 1.9759 | Val  Acc: 0.2619
Average Valid Accuracy: 0.7143
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1905
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3571
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_USPS...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5550 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.5162 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.5588 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.5323 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.4596 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.4976 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.5367 | Train Acc: 0.9048
 Site-SVHN      | Train Loss: 1.9142 | Train Acc: 0.2698
 Site-SynthDigits| Train Loss: 1.6308 | Train Acc: 0.4444
 Site-MNIST-M   | Train Loss: 1.6934 | Train Acc: 0.4762
 Site-MNIST     | Val  Loss: 0.4672 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4600 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4993 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.5887 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.5406 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.4774 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.6075 | Val  Acc: 0.8571
 Site-SVHN      | Val  Loss: 2.1433 | Val  Acc: 0.2143
 Site-SynthDigits| Val  Loss: 1.7546 | Val  Acc: 0.3810
 Site-MNIST-M   | Val  Loss: 1.9383 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8571
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2143
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3810
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_USPS...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4861 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.4566 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.4852 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.4689 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.3924 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4271 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.4599 | Train Acc: 0.9206
 Site-SVHN      | Train Loss: 1.8818 | Train Acc: 0.2698
 Site-SynthDigits| Train Loss: 1.5770 | Train Acc: 0.4762
 Site-MNIST-M   | Train Loss: 1.6197 | Train Acc: 0.4762
 Site-MNIST     | Val  Loss: 0.3986 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3893 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4350 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.5166 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4691 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4183 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5418 | Val  Acc: 0.8810
 Site-SVHN      | Val  Loss: 2.1322 | Val  Acc: 0.2143
 Site-SynthDigits| Val  Loss: 1.7142 | Val  Acc: 0.4286
 Site-MNIST-M   | Val  Loss: 1.9049 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7452
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8810
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2143
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4286
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_USPS...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4289 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.4055 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.4285 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.4175 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.3445 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3757 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.4069 | Train Acc: 0.9365
 Site-SVHN      | Train Loss: 1.8630 | Train Acc: 0.3016
 Site-SynthDigits| Train Loss: 1.5195 | Train Acc: 0.4603
 Site-MNIST-M   | Train Loss: 1.5392 | Train Acc: 0.5238
 Site-MNIST     | Val  Loss: 0.3441 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3402 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3836 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4543 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4139 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3709 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4880 | Val  Acc: 0.9048
 Site-SVHN      | Val  Loss: 2.1257 | Val  Acc: 0.2381
 Site-SynthDigits| Val  Loss: 1.6917 | Val  Acc: 0.3810
 Site-MNIST-M   | Val  Loss: 1.8744 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7476
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9048
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2381
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3810
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_USPS...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3814 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.3773 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.3695 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.3755 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3108 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3300 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3625 | Train Acc: 0.9365
 Site-SVHN      | Train Loss: 1.8399 | Train Acc: 0.3492
 Site-SynthDigits| Train Loss: 1.4787 | Train Acc: 0.4921
 Site-MNIST-M   | Train Loss: 1.4491 | Train Acc: 0.5873
 Site-MNIST     | Val  Loss: 0.3042 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3033 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3420 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4050 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3565 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3407 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4479 | Val  Acc: 0.9048
 Site-SVHN      | Val  Loss: 2.1120 | Val  Acc: 0.2857
 Site-SynthDigits| Val  Loss: 1.6668 | Val  Acc: 0.3810
 Site-MNIST-M   | Val  Loss: 1.8180 | Val  Acc: 0.3095
Average Valid Accuracy: 0.7571
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9048
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2857
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3810
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_USPS...
===2023-03-30 13:39:05===
===2023-03-30 13:39:06===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of USPS: 0.8118
Average Test Accuracy: 0.8118
