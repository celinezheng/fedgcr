===2023-03-30 06:20:57===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7608 | Train Acc: 0.5238
 Site-MNIST     | Train Loss: 1.6477 | Train Acc: 0.6508
 Site-MNIST     | Train Loss: 1.6940 | Train Acc: 0.5397
 Site-MNIST     | Train Loss: 1.7099 | Train Acc: 0.5397
 Site-MNIST     | Train Loss: 1.5873 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.6897 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.6824 | Train Acc: 0.6190
 Site-SVHN      | Train Loss: 2.2323 | Train Acc: 0.1905
 Site-SynthDigits| Train Loss: 2.1834 | Train Acc: 0.2063
 Site-MNIST-M   | Train Loss: 2.2215 | Train Acc: 0.1905
 Site-MNIST     | Val  Loss: 1.6401 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6266 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6899 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7432 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.6717 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.5677 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8276 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 2.2958 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 2.1992 | Val  Acc: 0.2381
 Site-MNIST-M   | Val  Loss: 2.2753 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4500
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2381
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
===2023-03-30 06:23:27===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
===2023-03-30 10:57:50===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
===2023-03-30 10:58:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7608 | Train Acc: 0.5238
 Site-MNIST     | Train Loss: 1.6477 | Train Acc: 0.6508
 Site-MNIST     | Train Loss: 1.6940 | Train Acc: 0.5397
 Site-MNIST     | Train Loss: 1.7099 | Train Acc: 0.5397
 Site-MNIST     | Train Loss: 1.5873 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.6897 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.6824 | Train Acc: 0.6190
 Site-SVHN      | Train Loss: 2.2323 | Train Acc: 0.1905
 Site-SynthDigits| Train Loss: 2.1834 | Train Acc: 0.2063
 Site-MNIST-M   | Train Loss: 2.2215 | Train Acc: 0.1905
 Site-MNIST     | Val  Loss: 1.6401 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6266 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6899 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7432 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.6717 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.5677 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8276 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 2.2958 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 2.1992 | Val  Acc: 0.2381
 Site-MNIST-M   | Val  Loss: 2.2753 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4500
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2381
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
===2023-03-30 11:01:08===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
===2023-03-30 11:05:00===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7608 | Train Acc: 0.5238
 Site-MNIST     | Train Loss: 1.6477 | Train Acc: 0.6508
 Site-MNIST     | Train Loss: 1.6940 | Train Acc: 0.5397
 Site-MNIST     | Train Loss: 1.7099 | Train Acc: 0.5397
 Site-MNIST     | Train Loss: 1.5873 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.6897 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.6824 | Train Acc: 0.6190
 Site-SVHN      | Train Loss: 2.2323 | Train Acc: 0.1905
 Site-SynthDigits| Train Loss: 2.1834 | Train Acc: 0.2063
 Site-MNIST-M   | Train Loss: 2.2215 | Train Acc: 0.1905
 Site-MNIST     | Val  Loss: 1.6401 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6266 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6899 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7432 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.6717 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.5677 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8276 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 2.2958 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 2.1992 | Val  Acc: 0.2381
 Site-MNIST-M   | Val  Loss: 2.2753 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4500
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2381
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3115 | Train Acc: 0.6190
 Site-MNIST     | Train Loss: 1.1524 | Train Acc: 0.6984
 Site-MNIST     | Train Loss: 1.2424 | Train Acc: 0.6190
 Site-MNIST     | Train Loss: 1.2573 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.1119 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.2007 | Train Acc: 0.7619
 Site-MNIST     | Train Loss: 1.2277 | Train Acc: 0.6508
 Site-SVHN      | Train Loss: 2.1790 | Train Acc: 0.2222
 Site-SynthDigits| Train Loss: 2.0095 | Train Acc: 0.3175
 Site-MNIST-M   | Train Loss: 2.1093 | Train Acc: 0.2540
 Site-MNIST     | Val  Loss: 1.1351 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.1773 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.2330 | Val  Acc: 0.7381
 Site-MNIST     | Val  Loss: 1.2816 | Val  Acc: 0.6429
 Site-MNIST     | Val  Loss: 1.2134 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.1085 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.3322 | Val  Acc: 0.6429
 Site-SVHN      | Val  Loss: 2.3277 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 2.1125 | Val  Acc: 0.1905
 Site-MNIST-M   | Val  Loss: 2.2308 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5286
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7381
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6429
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6429
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1905
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
============ Train epoch 10 ============
============ Train epoch 11 ============
===2023-03-30 11:11:13===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7608 | Train Acc: 0.5238
 Site-MNIST     | Train Loss: 1.6477 | Train Acc: 0.6508
 Site-MNIST     | Train Loss: 1.6940 | Train Acc: 0.5397
 Site-MNIST     | Train Loss: 1.7099 | Train Acc: 0.5397
 Site-MNIST     | Train Loss: 1.5873 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.6897 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.6824 | Train Acc: 0.6190
 Site-SVHN      | Train Loss: 2.2323 | Train Acc: 0.1905
 Site-SynthDigits| Train Loss: 2.1834 | Train Acc: 0.2063
 Site-MNIST-M   | Train Loss: 2.2215 | Train Acc: 0.1905
 Site-MNIST     | Val  Loss: 1.6401 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6266 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6899 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7432 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.6717 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.5677 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8276 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 2.2958 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 2.1992 | Val  Acc: 0.2381
 Site-MNIST-M   | Val  Loss: 2.2753 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4500
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2381
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3115 | Train Acc: 0.6190
 Site-MNIST     | Train Loss: 1.1524 | Train Acc: 0.6984
 Site-MNIST     | Train Loss: 1.2424 | Train Acc: 0.6190
 Site-MNIST     | Train Loss: 1.2573 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.1119 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.2007 | Train Acc: 0.7619
 Site-MNIST     | Train Loss: 1.2277 | Train Acc: 0.6508
 Site-SVHN      | Train Loss: 2.1790 | Train Acc: 0.2222
 Site-SynthDigits| Train Loss: 2.0095 | Train Acc: 0.3175
 Site-MNIST-M   | Train Loss: 2.1093 | Train Acc: 0.2540
 Site-MNIST     | Val  Loss: 1.1351 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.1773 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.2330 | Val  Acc: 0.7381
 Site-MNIST     | Val  Loss: 1.2816 | Val  Acc: 0.6429
 Site-MNIST     | Val  Loss: 1.2134 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.1085 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.3322 | Val  Acc: 0.6429
 Site-SVHN      | Val  Loss: 2.3277 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 2.1125 | Val  Acc: 0.1905
 Site-MNIST-M   | Val  Loss: 2.2308 | Val  Acc: 0.1429
Average Valid Accuracy: 0.5286
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7381
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6429
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6429
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1905
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8916 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 0.7628 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 0.8469 | Train Acc: 0.7619
 Site-MNIST     | Train Loss: 0.8241 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.7082 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.7736 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 0.8381 | Train Acc: 0.7937
 Site-SVHN      | Train Loss: 2.0694 | Train Acc: 0.2381
 Site-SynthDigits| Train Loss: 1.8001 | Train Acc: 0.4286
 Site-MNIST-M   | Train Loss: 1.8905 | Train Acc: 0.3810
 Site-MNIST     | Val  Loss: 0.7199 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.7582 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.8068 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.8607 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 0.8455 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 0.7350 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.9202 | Val  Acc: 0.6905
 Site-SVHN      | Val  Loss: 2.3120 | Val  Acc: 0.1429
 Site-SynthDigits| Val  Loss: 1.9596 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 2.1274 | Val  Acc: 0.1905
Average Valid Accuracy: 0.6286
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6905
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1429
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5249 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.4668 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 0.5005 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4855 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4037 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4335 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.5174 | Train Acc: 0.8571
 Site-SVHN      | Train Loss: 1.9847 | Train Acc: 0.2540
 Site-SynthDigits| Train Loss: 1.6155 | Train Acc: 0.4603
 Site-MNIST-M   | Train Loss: 1.6956 | Train Acc: 0.4127
 Site-MNIST     | Val  Loss: 0.4023 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4186 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4774 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.5024 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.4963 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.4621 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.5488 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 2.2796 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 1.8938 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 2.0335 | Val  Acc: 0.2143
Average Valid Accuracy: 0.7000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3180 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.2889 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.3013 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.2666 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.2157 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.2274 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.2970 | Train Acc: 0.9524
 Site-SVHN      | Train Loss: 1.8302 | Train Acc: 0.2698
 Site-SynthDigits| Train Loss: 1.3777 | Train Acc: 0.5079
 Site-MNIST-M   | Train Loss: 1.4088 | Train Acc: 0.5397
 Site-MNIST     | Val  Loss: 0.2063 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.2313 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.2481 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.3009 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2880 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2927 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3262 | Val  Acc: 0.8810
 Site-SVHN      | Val  Loss: 2.2240 | Val  Acc: 0.1905
 Site-SynthDigits| Val  Loss: 1.7469 | Val  Acc: 0.3571
 Site-MNIST-M   | Val  Loss: 1.8929 | Val  Acc: 0.3095
Average Valid Accuracy: 0.7524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8810
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1905
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3571
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2083 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.2123 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.2001 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1748 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.1224 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1416 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.1968 | Train Acc: 0.9683
 Site-SVHN      | Train Loss: 1.6411 | Train Acc: 0.3810
 Site-SynthDigits| Train Loss: 1.1807 | Train Acc: 0.5714
 Site-MNIST-M   | Train Loss: 1.1391 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.1308 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1313 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1615 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2066 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1841 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.2174 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2131 | Val  Acc: 0.9286
 Site-SVHN      | Val  Loss: 2.1409 | Val  Acc: 0.2381
 Site-SynthDigits| Val  Loss: 1.6433 | Val  Acc: 0.4524
 Site-MNIST-M   | Val  Loss: 1.7793 | Val  Acc: 0.4048
Average Valid Accuracy: 0.7881
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2381
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4524
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4048
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1529 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.1456 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1466 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1162 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0868 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0912 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1249 | Train Acc: 0.9683
 Site-SVHN      | Train Loss: 1.4990 | Train Acc: 0.5238
 Site-SynthDigits| Train Loss: 0.9188 | Train Acc: 0.6984
 Site-MNIST-M   | Train Loss: 0.9508 | Train Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.0856 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0875 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1107 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1410 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1313 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1484 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1608 | Val  Acc: 0.9524
 Site-SVHN      | Val  Loss: 2.1240 | Val  Acc: 0.3333
 Site-SynthDigits| Val  Loss: 1.6075 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 1.7390 | Val  Acc: 0.4524
Average Valid Accuracy: 0.8143
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9524
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3333
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0892 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.1073 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.0996 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0988 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0566 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0590 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0989 | Train Acc: 0.9841
 Site-SVHN      | Train Loss: 1.3330 | Train Acc: 0.5873
 Site-SynthDigits| Train Loss: 0.7850 | Train Acc: 0.8254
 Site-MNIST-M   | Train Loss: 0.7435 | Train Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.0552 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0575 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0925 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1004 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0897 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1117 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.0912 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 2.0346 | Val  Acc: 0.3333
 Site-SynthDigits| Val  Loss: 1.4987 | Val  Acc: 0.5952
 Site-MNIST-M   | Val  Loss: 1.6682 | Val  Acc: 0.5238
Average Valid Accuracy: 0.8381
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3333
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5952
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0708 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0782 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0951 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.0680 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0504 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0511 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0703 | Train Acc: 0.9841
 Site-SVHN      | Train Loss: 1.2257 | Train Acc: 0.6032
 Site-SynthDigits| Train Loss: 0.7834 | Train Acc: 0.7619
 Site-MNIST-M   | Train Loss: 0.6062 | Train Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.0508 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0485 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0639 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0880 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0828 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0747 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0761 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 2.0744 | Val  Acc: 0.3333
 Site-SynthDigits| Val  Loss: 1.6081 | Val  Acc: 0.5476
 Site-MNIST-M   | Val  Loss: 1.6093 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8310
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0641 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0782 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0753 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0627 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0372 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0386 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0638 | Train Acc: 0.9841
 Site-SVHN      | Train Loss: 0.8216 | Train Acc: 0.8095
 Site-SynthDigits| Train Loss: 0.4923 | Train Acc: 0.9365
 Site-MNIST-M   | Train Loss: 0.4616 | Train Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0375 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0594 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0726 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0664 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0813 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0723 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.7771 | Val  Acc: 0.4524
 Site-SynthDigits| Val  Loss: 1.3803 | Val  Acc: 0.5952
 Site-MNIST-M   | Val  Loss: 1.4902 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8571
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4524
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5952
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_USPS...
===2023-03-30 11:35:36===
===2023-03-30 11:35:38===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of USPS: 0.7366
Average Test Accuracy: 0.7366
