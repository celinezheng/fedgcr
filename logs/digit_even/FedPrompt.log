===2023-03-28 23:03:13===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8751 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.8078 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 2.2208 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1854 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.7787 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 1.8094 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 2.1216 | Train Acc: 0.2614
 Site-SynthDigits| Train Loss: 2.1292 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.2240 | Train Acc: 0.1477
 Site-MNIST-M   | Train Loss: 2.1436 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 1.8422 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7942 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 2.1874 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2211 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.8406 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 1.7792 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.1365 | Val  Acc: 0.1864
 Site-SynthDigits| Val  Loss: 2.1046 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.1446 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1936 | Val  Acc: 0.1695
Average Valid Accuracy: 0.3424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.5593
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1864
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.5320 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.4157 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 2.1400 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0977 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.3441 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 1.3830 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.9093 | Train Acc: 0.3523
 Site-SynthDigits| Train Loss: 1.8984 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 2.0889 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.0077 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.4793 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.4146 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 2.1019 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.1034 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 1.4097 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.3636 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.9431 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.8605 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.9930 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0626 | Val  Acc: 0.2203
Average Valid Accuracy: 0.4746
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-USPS       | Epoch:1 | Val Acc: 0.7797
 Best site-USPS       | Epoch:1 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1139 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 0.9860 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0318 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8837 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 0.9578 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.9760 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.6587 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.6055 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.9720 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 1.8740 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.0556 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.9704 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 1.9025 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9615 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.0019 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.9619 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.6548 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.6580 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.8762 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 1.9272 | Val  Acc: 0.3729
Average Valid Accuracy: 0.5542
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-USPS       | Epoch:2 | Val Acc: 0.8305
 Best site-USPS       | Epoch:2 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8185 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 0.7278 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 1.8354 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8202 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.6374 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.5723 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.4139 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.3334 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.7187 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 1.5601 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.7697 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.6603 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.8264 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8276 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.6236 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.5478 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.3850 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.4110 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.4985 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6242 | Val  Acc: 0.4576
Average Valid Accuracy: 0.6068
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2881
 Best site-USPS       | Epoch:3 | Val Acc: 0.8814
 Best site-USPS       | Epoch:3 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.6138 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.5446 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 1.7493 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.5833 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.4629 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.4792 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.2162 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.0667 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.6521 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.5148 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.6239 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.5261 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.5712 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.7168 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.4985 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.3973 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.1114 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.2215 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.4565 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.5191 | Val  Acc: 0.4746
Average Valid Accuracy: 0.6373
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3390
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3984 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4084 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.4347 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.3651 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.3144 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.2978 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.9244 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 0.8263 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 1.3460 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.0461 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.4628 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.3419 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.4150 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.4533 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.3260 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.2536 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.8812 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 0.9407 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.0351 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 1.1284 | Val  Acc: 0.6441
Average Valid Accuracy: 0.7271
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4237
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-USPS       | Epoch:5 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2574 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2866 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.2950 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 1.2752 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.2343 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.2151 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.7869 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 0.7076 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.0818 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 0.9737 | Train Acc: 0.6591
 Site-MNIST     | Val  Loss: 0.3227 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2343 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.3033 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.2750 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.2294 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.1925 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.7024 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 0.8201 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 0.9657 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.0018 | Val  Acc: 0.6610
Average Valid Accuracy: 0.7610
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5085
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6610
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2235 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2321 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 0.9558 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 0.9487 | Train Acc: 0.6477
 Site-USPS      | Train Loss: 0.2496 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.1612 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.5643 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.5194 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.9063 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 0.6005 | Train Acc: 0.8636
 Site-MNIST     | Val  Loss: 0.2459 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2015 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.0466 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 0.9788 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 0.1673 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1706 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.4770 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.6231 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.6364 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.7131 | Val  Acc: 0.8136
Average Valid Accuracy: 0.8475
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6441
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-USPS       | Epoch:7 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8136
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1766 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1806 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 0.8944 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 0.8616 | Train Acc: 0.7273
 Site-USPS      | Train Loss: 0.1882 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.1267 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3886 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.3439 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.6434 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.4881 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.2061 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1677 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.8701 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 0.8013 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.1362 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1420 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.3230 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.4689 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.4803 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.5245 | Val  Acc: 0.8814
Average Valid Accuracy: 0.8847
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7458
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8814
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1259 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1035 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.6249 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 0.7357 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 0.1248 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.0750 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.3397 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.2831 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.4924 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.2441 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1112 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1109 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.7334 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.6281 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.0779 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1055 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.2798 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.3784 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.2769 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.3384 | Val  Acc: 0.9492
Average Valid Accuracy: 0.9237
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7966
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9492
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt...
===2023-03-28 23:37:05===
===2023-03-28 23:37:06===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8379
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3617
 Test site-USPS      | Epoch:9 | Test Acc: 0.8871
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6371
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3779
Average Test Accuracy: 0.6203
