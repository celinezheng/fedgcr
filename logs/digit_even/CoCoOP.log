===2023-03-28 19:21:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.9166 | Train Acc: 0.4318
 Site-MNIST     | Train Loss: 1.8103 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 2.2334 | Train Acc: 0.1591
 Site-SVHN      | Train Loss: 2.2159 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.8068 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 1.8330 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 2.1285 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 2.1300 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2190 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.1669 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 1.8488 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.8171 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 2.2072 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2274 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.8720 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 1.8174 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.1387 | Val  Acc: 0.2542
 Site-SynthDigits| Val  Loss: 2.1136 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1484 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1952 | Val  Acc: 0.1186
Average Valid Accuracy: 0.3356
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2034
 Best site-USPS       | Epoch:0 | Val Acc: 0.4915
 Best site-USPS       | Epoch:0 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2542
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.5740 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.4591 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.1506 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0875 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.4478 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.5056 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 1.9588 | Train Acc: 0.3295
 Site-SynthDigits| Train Loss: 1.9115 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.1233 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.0274 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.5274 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.4380 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.1036 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.1175 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.5233 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.4653 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.9730 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.9200 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0076 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.0594 | Val  Acc: 0.2542
Average Valid Accuracy: 0.4475
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-USPS       | Epoch:1 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.3171 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.2071 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 2.0633 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0079 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 1.1849 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 1.2336 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.8071 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 1.7583 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 2.0100 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 1.9219 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.2885 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.1754 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.0295 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 2.0366 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 1.2493 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.1958 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.8361 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.7758 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.8843 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 1.9435 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5186
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2542
 Best site-USPS       | Epoch:2 | Val Acc: 0.8305
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 1.0745 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.0147 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 1.9942 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.9487 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.9789 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 1.0377 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6897 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.6796 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9125 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 1.7939 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 1.1081 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 0.9786 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.9757 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9495 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.0442 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.9891 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7281 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.6473 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7755 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.8472 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5627
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3051
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.9231 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 0.8949 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 1.9440 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8985 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.8182 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.8916 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.5731 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.5980 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.8122 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.7086 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.9714 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.8363 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9419 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8828 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.8886 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.8359 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6333 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.5474 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6615 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7447 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5966
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3220
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.8089 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.7975 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9458 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8329 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 0.7102 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7666 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.5129 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.4723 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.6950 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.5958 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.8580 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.7219 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9003 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8092 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.7675 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.7157 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5491 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.4508 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.5604 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6558 | Val  Acc: 0.5424
Average Valid Accuracy: 0.6153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3220
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-USPS       | Epoch:5 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.6955 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.6710 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.8581 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.7874 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.6636 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6425 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.4380 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.4143 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.6061 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.5048 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.7624 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.6371 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.8570 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7452 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.6634 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.6124 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.4554 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.3701 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.4689 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.5698 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6390
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:6 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3559
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.6331 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6613 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 1.8252 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.7139 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.5193 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.5952 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 1.3610 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.3298 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.5697 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.3919 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.6930 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.5769 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.7883 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.6919 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.5916 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.5360 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.3597 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.2943 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.3907 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4918 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6610
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:7 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3729
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.5635 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6022 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 1.7121 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.6656 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.4678 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5007 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.2957 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.2053 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.4819 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.3654 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.6270 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5315 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.7434 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6353 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.5355 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.4755 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.2527 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.2481 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.3294 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.4206 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6746
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3729
 Best site-USPS       | Epoch:8 | Val Acc: 0.8983
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.5135 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5036 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.6665 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.5976 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.4186 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.4953 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.2221 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 1.1696 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.3949 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.3017 | Train Acc: 0.6591
 Site-MNIST     | Val  Loss: 0.5586 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4776 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.6887 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.5757 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.4867 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.4307 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.1679 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 1.2132 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.2732 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.3350 | Val  Acc: 0.6780
Average Valid Accuracy: 0.7051
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4237
 Best site-USPS       | Epoch:9 | Val Acc: 0.8983
 Best site-USPS       | Epoch:9 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6780
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/CoCoOP...
===2023-03-28 19:53:41===
===2023-03-28 19:53:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.7993
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3723
 Test site-USPS      | Epoch:9 | Test Acc: 0.8763
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5475
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4479
Average Test Accuracy: 0.6087
