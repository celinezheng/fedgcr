===2023-03-28 21:10:44===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.9134 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.7888 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 2.2402 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1890 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.7903 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 1.8122 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1311 | Train Acc: 0.2841
 Site-SynthDigits| Train Loss: 2.1146 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2162 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.1677 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.8474 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.8052 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.2113 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2230 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.8482 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 1.7869 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.1313 | Val  Acc: 0.2203
 Site-SynthDigits| Val  Loss: 2.1094 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1597 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1791 | Val  Acc: 0.1864
Average Valid Accuracy: 0.3559
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.5763
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2203
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.5537 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.4877 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 2.1468 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1038 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.4379 | Train Acc: 0.7273
 Site-USPS      | Train Loss: 1.4779 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.9790 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 1.9445 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 2.1003 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.0323 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.5245 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.4413 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.1282 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1273 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.5075 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.4458 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.9798 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.9238 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0263 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.0476 | Val  Acc: 0.2203
Average Valid Accuracy: 0.4593
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-USPS       | Epoch:1 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.3206 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.2317 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 2.1067 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0470 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1533 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.2213 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.8372 | Train Acc: 0.3977
 Site-SynthDigits| Train Loss: 1.8154 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 2.0065 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 1.8962 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.3036 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.1996 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.0785 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0619 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.2511 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.1908 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8670 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.7803 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.9182 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.9378 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5169
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2203
 Best site-USPS       | Epoch:2 | Val Acc: 0.7966
 Best site-USPS       | Epoch:2 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 1.1167 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.0468 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0383 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.9639 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.0372 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.0417 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.7280 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.7158 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.9166 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.8183 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 1.1224 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 0.9984 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.0348 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0044 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 1.0682 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.0157 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7739 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.6697 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.8207 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.8390 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5559
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2373
 Best site-USPS       | Epoch:3 | Val Acc: 0.8136
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.9231 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.8997 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9955 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.9233 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 0.8730 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.8878 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.6441 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.6370 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.8107 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.7330 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.9660 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.8139 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9892 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9530 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.9101 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.8549 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.6832 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.5727 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7404 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.7506 | Val  Acc: 0.5085
Average Valid Accuracy: 0.5966
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2712
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-USPS       | Epoch:4 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.8283 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.7580 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 1.9822 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8890 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 0.7567 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.8085 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.5779 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.5294 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.7595 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.6554 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.8385 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.6941 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9615 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9099 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.8161 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.7534 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5765 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.4906 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6550 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.6585 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-USPS       | Epoch:5 | Val Acc: 0.8644
 Best site-USPS       | Epoch:5 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.7143 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.6879 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.9112 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.8600 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.6838 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.7029 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.4907 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.4483 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.6654 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.5678 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.7446 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.6005 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.8985 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.8776 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.7202 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6633 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.5078 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.4123 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.5808 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.5810 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6424
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3051
 Best site-USPS       | Epoch:6 | Val Acc: 0.8814
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.6417 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6145 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.9216 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8302 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.6148 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6445 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.3900 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.3874 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.5759 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.4645 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.6745 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5391 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.8995 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8487 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.6767 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6067 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.4315 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.3576 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.4802 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.4875 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6559
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2881
 Best site-USPS       | Epoch:7 | Val Acc: 0.8814
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.5527 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5107 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.8506 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.7928 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.5652 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6023 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.3418 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.3114 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.5848 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.4433 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.5957 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4636 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.8617 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.8202 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.6039 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.5425 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.3532 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.2978 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4513 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4476 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6814
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3390
 Best site-USPS       | Epoch:8 | Val Acc: 0.8814
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.5479 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4983 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.8255 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7463 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.5480 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5657 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.2846 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.2183 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.4742 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.3036 | Train Acc: 0.6477
 Site-MNIST     | Val  Loss: 0.5799 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.4481 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.8384 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8017 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.5967 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5223 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.2607 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.2271 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.3384 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.3392 | Val  Acc: 0.6780
Average Valid Accuracy: 0.6712
===2023-03-28 21:44:15===
===2023-03-28 21:44:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:8 | Test Acc: 0.8007
 Test site-SVHN      | Epoch:8 | Test Acc: 0.2962
 Test site-USPS      | Epoch:8 | Test Acc: 0.8656
 Test site-SynthDigits| Epoch:8 | Test Acc: 0.4814
 Test site-MNIST-M   | Epoch:8 | Test Acc: 0.3550
Average Test Accuracy: 0.5598
