===2023-06-07 13:15:13===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 6, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White                    | Train Loss: 1.8556 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.7778 | Train Acc: 0.3597
 Site-Latino_Hispanic          | Train Loss: 1.9453 | Train Acc: 0.2734
 Site-Latino_Hispanic          | Train Loss: 1.8561 | Train Acc: 0.2806
 Site-Black                    | Train Loss: 1.9840 | Train Acc: 0.2590
 Site-Black                    | Train Loss: 1.8977 | Train Acc: 0.2590
 Site-East_Asian               | Train Loss: 1.7582 | Train Acc: 0.3669
 Site-East_Asian               | Train Loss: 1.7534 | Train Acc: 0.3885
 Site-Indian                   | Train Loss: 2.0882 | Train Acc: 0.2302
 Site-Indian                   | Train Loss: 2.1331 | Train Acc: 0.2326
 Site-Southeast_Asian          | Train Loss: 2.0045 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 2.0809 | Train Acc: 0.3046
 Site-Middle_Eastern           | Train Loss: 1.9397 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 1.9335 | Train Acc: 0.2446
 Site-White                     (3) | Val  Loss: 1.8929 | Val  Acc: 0.2935
 Site-White                     (5) | Val  Loss: 1.8203 | Val  Acc: 0.3525
 Site-Latino_Hispanic           (2) | Val  Loss: 1.9414 | Val  Acc: 0.3152
 Site-Latino_Hispanic           (3) | Val  Loss: 1.9087 | Val  Acc: 0.2770
 Site-Black                     (6) | Val  Loss: 1.8988 | Val  Acc: 0.2935
 Site-Black                     (0) | Val  Loss: 1.9466 | Val  Acc: 0.2554
 Site-East_Asian                (3) | Val  Loss: 1.6986 | Val  Acc: 0.4457
 Site-East_Asian                (3) | Val  Loss: 1.7968 | Val  Acc: 0.3813
 Site-Indian                    (4) | Val  Loss: 2.0585 | Val  Acc: 0.2283
 Site-Indian                    (4) | Val  Loss: 2.0407 | Val  Acc: 0.2410
 Site-Southeast_Asian           (3) | Val  Loss: 1.9876 | Val  Acc: 0.3152
 Site-Southeast_Asian           (3) | Val  Loss: 1.9845 | Val  Acc: 0.3058
 Site-Middle_Eastern            (1) | Val  Loss: 1.9264 | Val  Acc: 0.3152
 Site-Middle_Eastern            (1) | Val  Loss: 1.9616 | Val  Acc: 0.2554
Average Valid Accuracy: 0.3053
 Best site-White                    (3)  | Epoch:0 | Val Acc: 0.2935
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.3525
 Best site-Latino_Hispanic          (2)  | Epoch:0 | Val Acc: 0.3152
 Best site-Latino_Hispanic          (3)  | Epoch:0 | Val Acc: 0.2770
 Best site-Black                    (6)  | Epoch:0 | Val Acc: 0.2935
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.2554
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.4457
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3813
 Best site-Indian                   (4)  | Epoch:0 | Val Acc: 0.2283
 Best site-Indian                   (4)  | Epoch:0 | Val Acc: 0.2410
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3152
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3058
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.3152
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.2554
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 1 ============
cnt=[1, 4, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White                    | Train Loss: 1.7853 | Train Acc: 0.3237
 Site-White                    | Train Loss: 1.7202 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.8684 | Train Acc: 0.2662
 Site-Latino_Hispanic          | Train Loss: 1.8380 | Train Acc: 0.2854
 Site-Black                    | Train Loss: 1.9653 | Train Acc: 0.1871
 Site-Black                    | Train Loss: 1.9240 | Train Acc: 0.2638
 Site-East_Asian               | Train Loss: 1.7385 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.7504 | Train Acc: 0.3933
 Site-Indian                   | Train Loss: 1.9255 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 1.9310 | Train Acc: 0.2494
 Site-Southeast_Asian          | Train Loss: 1.9043 | Train Acc: 0.3309
 Site-Southeast_Asian          | Train Loss: 1.8780 | Train Acc: 0.3141
 Site-Middle_Eastern           | Train Loss: 1.8795 | Train Acc: 0.2446
 Site-Middle_Eastern           | Train Loss: 1.9130 | Train Acc: 0.2830
 Site-White                     (0) | Val  Loss: 1.8577 | Val  Acc: 0.2935
 Site-White                     (6) | Val  Loss: 1.7802 | Val  Acc: 0.3489
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8630 | Val  Acc: 0.3152
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8535 | Val  Acc: 0.2806
 Site-Black                     (3) | Val  Loss: 1.8534 | Val  Acc: 0.3370
 Site-Black                     (3) | Val  Loss: 1.8987 | Val  Acc: 0.2950
 Site-East_Asian                (1) | Val  Loss: 1.6682 | Val  Acc: 0.4239
 Site-East_Asian                (1) | Val  Loss: 1.7396 | Val  Acc: 0.3993
 Site-Indian                    (4) | Val  Loss: 1.9608 | Val  Acc: 0.2283
 Site-Indian                    (4) | Val  Loss: 1.9657 | Val  Acc: 0.2338
 Site-Southeast_Asian           (1) | Val  Loss: 1.8926 | Val  Acc: 0.3152
 Site-Southeast_Asian           (1) | Val  Loss: 1.9075 | Val  Acc: 0.3129
 Site-Middle_Eastern            (2) | Val  Loss: 1.8584 | Val  Acc: 0.2717
 Site-Middle_Eastern            (2) | Val  Loss: 1.8851 | Val  Acc: 0.2662
Average Valid Accuracy: 0.3087
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.2935
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3489
 Best site-Latino_Hispanic          (5)  | Epoch:1 | Val Acc: 0.3152
 Best site-Latino_Hispanic          (5)  | Epoch:1 | Val Acc: 0.2806
 Best site-Black                    (3)  | Epoch:1 | Val Acc: 0.3370
 Best site-Black                    (3)  | Epoch:1 | Val Acc: 0.2950
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4239
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3993
 Best site-Indian                   (4)  | Epoch:1 | Val Acc: 0.2283
 Best site-Indian                   (4)  | Epoch:1 | Val Acc: 0.2338
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.3152
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.3129
 Best site-Middle_Eastern           (2)  | Epoch:1 | Val Acc: 0.2717
 Best site-Middle_Eastern           (2)  | Epoch:1 | Val Acc: 0.2662
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 2 ============
cnt=[2, 2, 3, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White                    | Train Loss: 1.7781 | Train Acc: 0.3813
 Site-White                    | Train Loss: 1.7587 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.8350 | Train Acc: 0.3022
 Site-Latino_Hispanic          | Train Loss: 1.8581 | Train Acc: 0.3165
 Site-Black                    | Train Loss: 1.9087 | Train Acc: 0.2446
 Site-Black                    | Train Loss: 1.8428 | Train Acc: 0.2758
 Site-East_Asian               | Train Loss: 1.6647 | Train Acc: 0.3957
 Site-East_Asian               | Train Loss: 1.6514 | Train Acc: 0.4125
 Site-Indian                   | Train Loss: 1.8458 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 1.9003 | Train Acc: 0.2662
 Site-Southeast_Asian          | Train Loss: 1.8332 | Train Acc: 0.3669
 Site-Southeast_Asian          | Train Loss: 1.7989 | Train Acc: 0.3429
 Site-Middle_Eastern           | Train Loss: 1.7932 | Train Acc: 0.3237
 Site-Middle_Eastern           | Train Loss: 1.7845 | Train Acc: 0.3477
 Site-White                     (0) | Val  Loss: 1.7424 | Val  Acc: 0.3370
 Site-White                     (0) | Val  Loss: 1.7026 | Val  Acc: 0.3813
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8242 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7912 | Val  Acc: 0.3237
 Site-Black                     (5) | Val  Loss: 1.7785 | Val  Acc: 0.4022
 Site-Black                     (2) | Val  Loss: 1.8312 | Val  Acc: 0.3129
 Site-East_Asian                (6) | Val  Loss: 1.6025 | Val  Acc: 0.4565
 Site-East_Asian                (6) | Val  Loss: 1.6624 | Val  Acc: 0.4209
 Site-Indian                    (2) | Val  Loss: 1.8958 | Val  Acc: 0.2391
 Site-Indian                    (2) | Val  Loss: 1.8640 | Val  Acc: 0.2518
 Site-Southeast_Asian           (1) | Val  Loss: 1.8087 | Val  Acc: 0.3043
 Site-Southeast_Asian           (1) | Val  Loss: 1.7863 | Val  Acc: 0.3525
 Site-Middle_Eastern            (3) | Val  Loss: 1.7628 | Val  Acc: 0.3370
 Site-Middle_Eastern            (3) | Val  Loss: 1.7935 | Val  Acc: 0.3165
Average Valid Accuracy: 0.3401
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.3370
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.3813
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.3237
 Best site-Black                    (5)  | Epoch:2 | Val Acc: 0.4022
 Best site-Black                    (2)  | Epoch:2 | Val Acc: 0.3129
 Best site-East_Asian               (6)  | Epoch:2 | Val Acc: 0.4565
 Best site-East_Asian               (6)  | Epoch:2 | Val Acc: 0.4209
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2391
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2518
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.3043
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.3525
 Best site-Middle_Eastern           (3)  | Epoch:2 | Val Acc: 0.3370
 Best site-Middle_Eastern           (3)  | Epoch:2 | Val Acc: 0.3165
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 3 ============
cnt=[4, 2, 1, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White                    | Train Loss: 1.6542 | Train Acc: 0.4029
 Site-White                    | Train Loss: 1.6641 | Train Acc: 0.3981
 Site-Latino_Hispanic          | Train Loss: 1.7627 | Train Acc: 0.3165
 Site-Latino_Hispanic          | Train Loss: 1.6909 | Train Acc: 0.3477
 Site-Black                    | Train Loss: 1.8417 | Train Acc: 0.2734
 Site-Black                    | Train Loss: 1.8662 | Train Acc: 0.3094
 Site-East_Asian               | Train Loss: 1.5442 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.5240 | Train Acc: 0.4508
 Site-Indian                   | Train Loss: 1.7070 | Train Acc: 0.3453
 Site-Indian                   | Train Loss: 1.7101 | Train Acc: 0.3261
 Site-Southeast_Asian          | Train Loss: 1.6815 | Train Acc: 0.3741
 Site-Southeast_Asian          | Train Loss: 1.7033 | Train Acc: 0.3957
 Site-Middle_Eastern           | Train Loss: 1.7240 | Train Acc: 0.3741
 Site-Middle_Eastern           | Train Loss: 1.6778 | Train Acc: 0.4053
 Site-White                     (4) | Val  Loss: 1.6445 | Val  Acc: 0.3804
 Site-White                     (5) | Val  Loss: 1.6398 | Val  Acc: 0.3957
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7571 | Val  Acc: 0.3478
 Site-Latino_Hispanic           (0) | Val  Loss: 1.7270 | Val  Acc: 0.3453
 Site-Black                     (6) | Val  Loss: 1.7293 | Val  Acc: 0.3696
 Site-Black                     (2) | Val  Loss: 1.8106 | Val  Acc: 0.3201
 Site-East_Asian                (3) | Val  Loss: 1.5061 | Val  Acc: 0.4891
 Site-East_Asian                (3) | Val  Loss: 1.5682 | Val  Acc: 0.4568
 Site-Indian                    (0) | Val  Loss: 1.7962 | Val  Acc: 0.2391
 Site-Indian                    (0) | Val  Loss: 1.7406 | Val  Acc: 0.3345
 Site-Southeast_Asian           (3) | Val  Loss: 1.6814 | Val  Acc: 0.4022
 Site-Southeast_Asian           (0) | Val  Loss: 1.6691 | Val  Acc: 0.4029
 Site-Middle_Eastern            (1) | Val  Loss: 1.6592 | Val  Acc: 0.4348
 Site-Middle_Eastern            (1) | Val  Loss: 1.6724 | Val  Acc: 0.3813
Average Valid Accuracy: 0.3786
 Best site-White                    (4)  | Epoch:3 | Val Acc: 0.3804
 Best site-White                    (5)  | Epoch:3 | Val Acc: 0.3957
 Best site-Latino_Hispanic          (4)  | Epoch:3 | Val Acc: 0.3478
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.3453
 Best site-Black                    (6)  | Epoch:3 | Val Acc: 0.3696
 Best site-Black                    (2)  | Epoch:3 | Val Acc: 0.3201
 Best site-East_Asian               (3)  | Epoch:3 | Val Acc: 0.4891
 Best site-East_Asian               (3)  | Epoch:3 | Val Acc: 0.4568
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2391
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.3345
 Best site-Southeast_Asian          (3)  | Epoch:3 | Val Acc: 0.4022
 Best site-Southeast_Asian          (0)  | Epoch:3 | Val Acc: 0.4029
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.4348
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.3813
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 4 ============
cnt=[4, 1, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White                    | Train Loss: 1.6226 | Train Acc: 0.3957
 Site-White                    | Train Loss: 1.5432 | Train Acc: 0.4053
 Site-Latino_Hispanic          | Train Loss: 1.7404 | Train Acc: 0.3094
 Site-Latino_Hispanic          | Train Loss: 1.6513 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.8183 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.6908 | Train Acc: 0.3429
 Site-East_Asian               | Train Loss: 1.5661 | Train Acc: 0.3885
 Site-East_Asian               | Train Loss: 1.6003 | Train Acc: 0.4436
 Site-Indian                   | Train Loss: 1.6319 | Train Acc: 0.3741
 Site-Indian                   | Train Loss: 1.7275 | Train Acc: 0.3669
 Site-Southeast_Asian          | Train Loss: 1.6363 | Train Acc: 0.3741
 Site-Southeast_Asian          | Train Loss: 1.7496 | Train Acc: 0.3789
 Site-Middle_Eastern           | Train Loss: 1.6039 | Train Acc: 0.3813
 Site-Middle_Eastern           | Train Loss: 1.6247 | Train Acc: 0.4005
 Site-White                     (6) | Val  Loss: 1.6211 | Val  Acc: 0.4022
 Site-White                     (0) | Val  Loss: 1.6061 | Val  Acc: 0.3849
 Site-Latino_Hispanic           (6) | Val  Loss: 1.6985 | Val  Acc: 0.3696
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6866 | Val  Acc: 0.3669
 Site-Black                     (1) | Val  Loss: 1.6494 | Val  Acc: 0.4457
 Site-Black                     (5) | Val  Loss: 1.7650 | Val  Acc: 0.3058
 Site-East_Asian                (0) | Val  Loss: 1.4652 | Val  Acc: 0.5000
 Site-East_Asian                (0) | Val  Loss: 1.5098 | Val  Acc: 0.4424
 Site-Indian                    (3) | Val  Loss: 1.7266 | Val  Acc: 0.2826
 Site-Indian                    (3) | Val  Loss: 1.7040 | Val  Acc: 0.3094
 Site-Southeast_Asian           (4) | Val  Loss: 1.6356 | Val  Acc: 0.4239
 Site-Southeast_Asian           (4) | Val  Loss: 1.6309 | Val  Acc: 0.4065
 Site-Middle_Eastern            (2) | Val  Loss: 1.6082 | Val  Acc: 0.4783
 Site-Middle_Eastern            (2) | Val  Loss: 1.6357 | Val  Acc: 0.3813
Average Valid Accuracy: 0.3928
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.4022
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3849
 Best site-Latino_Hispanic          (6)  | Epoch:4 | Val Acc: 0.3696
 Best site-Latino_Hispanic          (0)  | Epoch:4 | Val Acc: 0.3669
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.4457
 Best site-Black                    (5)  | Epoch:4 | Val Acc: 0.3058
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.5000
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.4424
 Best site-Indian                   (3)  | Epoch:4 | Val Acc: 0.2826
 Best site-Indian                   (3)  | Epoch:4 | Val Acc: 0.3094
 Best site-Southeast_Asian          (4)  | Epoch:4 | Val Acc: 0.4239
 Best site-Southeast_Asian          (4)  | Epoch:4 | Val Acc: 0.4065
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.4783
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.3813
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 5 ============
cnt=[3, 2, 2, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White                    | Train Loss: 1.5506 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.5820 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.6761 | Train Acc: 0.3453
 Site-Latino_Hispanic          | Train Loss: 1.6761 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.8089 | Train Acc: 0.3094
 Site-Black                    | Train Loss: 1.7216 | Train Acc: 0.3213
 Site-East_Asian               | Train Loss: 1.5170 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.4393 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.6120 | Train Acc: 0.4101
 Site-Indian                   | Train Loss: 1.6341 | Train Acc: 0.3645
 Site-Southeast_Asian          | Train Loss: 1.6202 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.6153 | Train Acc: 0.4053
 Site-Middle_Eastern           | Train Loss: 1.6396 | Train Acc: 0.3597
 Site-Middle_Eastern           | Train Loss: 1.5233 | Train Acc: 0.4293
 Site-White                     (0) | Val  Loss: 1.5985 | Val  Acc: 0.3696
 Site-White                     (0) | Val  Loss: 1.5594 | Val  Acc: 0.4065
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6618 | Val  Acc: 0.3804
 Site-Latino_Hispanic           (5) | Val  Loss: 1.6420 | Val  Acc: 0.3597
 Site-Black                     (6) | Val  Loss: 1.5648 | Val  Acc: 0.5000
 Site-Black                     (4) | Val  Loss: 1.6830 | Val  Acc: 0.3777
 Site-East_Asian                (3) | Val  Loss: 1.3911 | Val  Acc: 0.5217
 Site-East_Asian                (3) | Val  Loss: 1.4687 | Val  Acc: 0.4748
 Site-Indian                    (2) | Val  Loss: 1.7130 | Val  Acc: 0.3043
 Site-Indian                    (2) | Val  Loss: 1.6491 | Val  Acc: 0.3417
 Site-Southeast_Asian           (1) | Val  Loss: 1.6304 | Val  Acc: 0.3804
 Site-Southeast_Asian           (1) | Val  Loss: 1.5876 | Val  Acc: 0.4245
 Site-Middle_Eastern            (5) | Val  Loss: 1.5386 | Val  Acc: 0.5109
 Site-Middle_Eastern            (5) | Val  Loss: 1.5885 | Val  Acc: 0.4137
Average Valid Accuracy: 0.4119
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.3696
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.4065
 Best site-Latino_Hispanic          (0)  | Epoch:5 | Val Acc: 0.3804
 Best site-Latino_Hispanic          (5)  | Epoch:5 | Val Acc: 0.3597
 Best site-Black                    (6)  | Epoch:5 | Val Acc: 0.5000
 Best site-Black                    (4)  | Epoch:5 | Val Acc: 0.3777
 Best site-East_Asian               (3)  | Epoch:5 | Val Acc: 0.5217
 Best site-East_Asian               (3)  | Epoch:5 | Val Acc: 0.4748
 Best site-Indian                   (2)  | Epoch:5 | Val Acc: 0.3043
 Best site-Indian                   (2)  | Epoch:5 | Val Acc: 0.3417
 Best site-Southeast_Asian          (1)  | Epoch:5 | Val Acc: 0.3804
 Best site-Southeast_Asian          (1)  | Epoch:5 | Val Acc: 0.4245
 Best site-Middle_Eastern           (5)  | Epoch:5 | Val Acc: 0.5109
 Best site-Middle_Eastern           (5)  | Epoch:5 | Val Acc: 0.4137
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 6 ============
cnt=[1, 3, 2, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White                    | Train Loss: 1.5126 | Train Acc: 0.4173
 Site-White                    | Train Loss: 1.5303 | Train Acc: 0.4149
 Site-Latino_Hispanic          | Train Loss: 1.6611 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.7456 | Train Acc: 0.3429
 Site-Black                    | Train Loss: 1.7487 | Train Acc: 0.3165
 Site-Black                    | Train Loss: 1.7800 | Train Acc: 0.3285
 Site-East_Asian               | Train Loss: 1.4932 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.4955 | Train Acc: 0.4628
 Site-Indian                   | Train Loss: 1.5468 | Train Acc: 0.3669
 Site-Indian                   | Train Loss: 1.5937 | Train Acc: 0.3597
 Site-Southeast_Asian          | Train Loss: 1.5737 | Train Acc: 0.4245
 Site-Southeast_Asian          | Train Loss: 1.6301 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.6199 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.5461 | Train Acc: 0.4293
 Site-White                     (4) | Val  Loss: 1.5713 | Val  Acc: 0.3913
 Site-White                     (0) | Val  Loss: 1.5462 | Val  Acc: 0.3921
 Site-Latino_Hispanic           (4) | Val  Loss: 1.6143 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (1) | Val  Loss: 1.6093 | Val  Acc: 0.3741
 Site-Black                     (6) | Val  Loss: 1.5719 | Val  Acc: 0.4457
 Site-Black                     (6) | Val  Loss: 1.6806 | Val  Acc: 0.3201
 Site-East_Asian                (5) | Val  Loss: 1.4211 | Val  Acc: 0.4783
 Site-East_Asian                (3) | Val  Loss: 1.4627 | Val  Acc: 0.4820
 Site-Indian                    (1) | Val  Loss: 1.6497 | Val  Acc: 0.3152
 Site-Indian                    (1) | Val  Loss: 1.6299 | Val  Acc: 0.3417
 Site-Southeast_Asian           (5) | Val  Loss: 1.5799 | Val  Acc: 0.3913
 Site-Southeast_Asian           (5) | Val  Loss: 1.5592 | Val  Acc: 0.4317
 Site-Middle_Eastern            (2) | Val  Loss: 1.5289 | Val  Acc: 0.4565
 Site-Middle_Eastern            (2) | Val  Loss: 1.5492 | Val  Acc: 0.4065
Average Valid Accuracy: 0.4020
============ Train epoch 7 ============
cnt=[1, 2, 2, 2, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White                    | Train Loss: 1.4962 | Train Acc: 0.4460
 Site-White                    | Train Loss: 1.5611 | Train Acc: 0.4053
 Site-Latino_Hispanic          | Train Loss: 1.6869 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.5801 | Train Acc: 0.3789
 Site-Black                    | Train Loss: 1.7433 | Train Acc: 0.2950
 Site-Black                    | Train Loss: 1.6761 | Train Acc: 0.3285
 Site-East_Asian               | Train Loss: 1.4578 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.4779 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.5106 | Train Acc: 0.3885
 Site-Indian                   | Train Loss: 1.5675 | Train Acc: 0.3741
 Site-Southeast_Asian          | Train Loss: 1.5719 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.5024 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.5567 | Train Acc: 0.3957
 Site-Middle_Eastern           | Train Loss: 1.4519 | Train Acc: 0.4556
 Site-White                     (4) | Val  Loss: 1.5775 | Val  Acc: 0.3804
 Site-White                     (5) | Val  Loss: 1.5406 | Val  Acc: 0.4209
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5814 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6099 | Val  Acc: 0.3777
 Site-Black                     (3) | Val  Loss: 1.5179 | Val  Acc: 0.4239
 Site-Black                     (3) | Val  Loss: 1.6821 | Val  Acc: 0.3345
 Site-East_Asian                (1) | Val  Loss: 1.3826 | Val  Acc: 0.5652
 Site-East_Asian                (1) | Val  Loss: 1.4462 | Val  Acc: 0.4784
 Site-Indian                    (2) | Val  Loss: 1.6535 | Val  Acc: 0.3152
 Site-Indian                    (2) | Val  Loss: 1.6248 | Val  Acc: 0.3453
 Site-Southeast_Asian           (6) | Val  Loss: 1.5824 | Val  Acc: 0.4130
 Site-Southeast_Asian           (6) | Val  Loss: 1.5449 | Val  Acc: 0.3885
 Site-Middle_Eastern            (5) | Val  Loss: 1.5096 | Val  Acc: 0.4565
 Site-Middle_Eastern            (5) | Val  Loss: 1.5135 | Val  Acc: 0.4424
Average Valid Accuracy: 0.4126
 Best site-White                    (4)  | Epoch:7 | Val Acc: 0.3804
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.4209
 Best site-Latino_Hispanic          (4)  | Epoch:7 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (0)  | Epoch:7 | Val Acc: 0.3777
 Best site-Black                    (3)  | Epoch:7 | Val Acc: 0.4239
 Best site-Black                    (3)  | Epoch:7 | Val Acc: 0.3345
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.5652
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.4784
 Best site-Indian                   (2)  | Epoch:7 | Val Acc: 0.3152
 Best site-Indian                   (2)  | Epoch:7 | Val Acc: 0.3453
 Best site-Southeast_Asian          (6)  | Epoch:7 | Val Acc: 0.4130
 Best site-Southeast_Asian          (6)  | Epoch:7 | Val Acc: 0.3885
 Best site-Middle_Eastern           (5)  | Epoch:7 | Val Acc: 0.4565
 Best site-Middle_Eastern           (5)  | Epoch:7 | Val Acc: 0.4424
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 8 ============
cnt=[1, 2, 1, 5, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White                    | Train Loss: 1.4929 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.4402 | Train Acc: 0.4221
 Site-Latino_Hispanic          | Train Loss: 1.6630 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.5589 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.7270 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.6528 | Train Acc: 0.3237
 Site-East_Asian               | Train Loss: 1.4964 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.5024 | Train Acc: 0.4628
 Site-Indian                   | Train Loss: 1.5480 | Train Acc: 0.3957
 Site-Indian                   | Train Loss: 1.7744 | Train Acc: 0.3597
 Site-Southeast_Asian          | Train Loss: 1.5326 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.5848 | Train Acc: 0.4436
 Site-Middle_Eastern           | Train Loss: 1.4689 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.4870 | Train Acc: 0.4245
 Site-White                     (0) | Val  Loss: 1.5263 | Val  Acc: 0.4130
 Site-White                     (6) | Val  Loss: 1.4972 | Val  Acc: 0.4209
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5982 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5742 | Val  Acc: 0.4245
 Site-Black                     (2) | Val  Loss: 1.4981 | Val  Acc: 0.4891
 Site-Black                     (5) | Val  Loss: 1.6548 | Val  Acc: 0.3417
 Site-East_Asian                (3) | Val  Loss: 1.3856 | Val  Acc: 0.5326
 Site-East_Asian                (3) | Val  Loss: 1.4360 | Val  Acc: 0.4640
 Site-Indian                    (4) | Val  Loss: 1.6656 | Val  Acc: 0.2935
 Site-Indian                    (4) | Val  Loss: 1.6009 | Val  Acc: 0.3561
 Site-Southeast_Asian           (3) | Val  Loss: 1.5307 | Val  Acc: 0.4348
 Site-Southeast_Asian           (3) | Val  Loss: 1.5207 | Val  Acc: 0.4065
 Site-Middle_Eastern            (1) | Val  Loss: 1.4893 | Val  Acc: 0.4565
 Site-Middle_Eastern            (1) | Val  Loss: 1.5120 | Val  Acc: 0.4353
Average Valid Accuracy: 0.4209
 Best site-White                    (0)  | Epoch:8 | Val Acc: 0.4130
 Best site-White                    (6)  | Epoch:8 | Val Acc: 0.4209
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.4239
 Best site-Latino_Hispanic          (3)  | Epoch:8 | Val Acc: 0.4245
 Best site-Black                    (2)  | Epoch:8 | Val Acc: 0.4891
 Best site-Black                    (5)  | Epoch:8 | Val Acc: 0.3417
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.5326
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4640
 Best site-Indian                   (4)  | Epoch:8 | Val Acc: 0.2935
 Best site-Indian                   (4)  | Epoch:8 | Val Acc: 0.3561
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.4348
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.4065
 Best site-Middle_Eastern           (1)  | Epoch:8 | Val Acc: 0.4565
 Best site-Middle_Eastern           (1)  | Epoch:8 | Val Acc: 0.4353
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 9 ============
cnt=[4, 2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White                    | Train Loss: 1.4431 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.4503 | Train Acc: 0.4628
 Site-Latino_Hispanic          | Train Loss: 1.6441 | Train Acc: 0.3453
 Site-Latino_Hispanic          | Train Loss: 1.5477 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.6600 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.6720 | Train Acc: 0.3333
 Site-East_Asian               | Train Loss: 1.4458 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3899 | Train Acc: 0.4556
 Site-Indian                   | Train Loss: 1.4931 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.5567 | Train Acc: 0.4005
 Site-Southeast_Asian          | Train Loss: 1.5281 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.6432 | Train Acc: 0.4293
 Site-Middle_Eastern           | Train Loss: 1.5098 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.4360 | Train Acc: 0.4460
 Site-White                     (4) | Val  Loss: 1.5546 | Val  Acc: 0.4348
 Site-White                     (5) | Val  Loss: 1.4689 | Val  Acc: 0.4532
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5629 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5674 | Val  Acc: 0.3849
 Site-Black                     (1) | Val  Loss: 1.5047 | Val  Acc: 0.4891
 Site-Black                     (1) | Val  Loss: 1.6460 | Val  Acc: 0.3525
 Site-East_Asian                (0) | Val  Loss: 1.3391 | Val  Acc: 0.4891
 Site-East_Asian                (0) | Val  Loss: 1.4196 | Val  Acc: 0.4964
 Site-Indian                    (2) | Val  Loss: 1.6197 | Val  Acc: 0.3152
 Site-Indian                    (2) | Val  Loss: 1.5564 | Val  Acc: 0.3957
 Site-Southeast_Asian           (0) | Val  Loss: 1.4952 | Val  Acc: 0.4783
 Site-Southeast_Asian           (0) | Val  Loss: 1.5134 | Val  Acc: 0.4460
 Site-Middle_Eastern            (3) | Val  Loss: 1.4472 | Val  Acc: 0.5000
 Site-Middle_Eastern            (3) | Val  Loss: 1.4977 | Val  Acc: 0.4209
Average Valid Accuracy: 0.4327
 Best site-White                    (4)  | Epoch:9 | Val Acc: 0.4348
 Best site-White                    (5)  | Epoch:9 | Val Acc: 0.4532
 Best site-Latino_Hispanic          (6)  | Epoch:9 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (4)  | Epoch:9 | Val Acc: 0.3849
 Best site-Black                    (1)  | Epoch:9 | Val Acc: 0.4891
 Best site-Black                    (1)  | Epoch:9 | Val Acc: 0.3525
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.4891
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.4964
 Best site-Indian                   (2)  | Epoch:9 | Val Acc: 0.3152
 Best site-Indian                   (2)  | Epoch:9 | Val Acc: 0.3957
 Best site-Southeast_Asian          (0)  | Epoch:9 | Val Acc: 0.4783
 Best site-Southeast_Asian          (0)  | Epoch:9 | Val Acc: 0.4460
 Best site-Middle_Eastern           (3)  | Epoch:9 | Val Acc: 0.5000
 Best site-Middle_Eastern           (3)  | Epoch:9 | Val Acc: 0.4209
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
 Test site-White                     (4)| Epoch:9 | Test Acc: 0.4305
 Test site-Latino_Hispanic           (6)| Epoch:9 | Test Acc: 0.3544
 Test site-Black                     (1)| Epoch:9 | Test Acc: 0.2812
 Test site-East_Asian                (0)| Epoch:9 | Test Acc: 0.4740
 Test site-Indian                    (2)| Epoch:9 | Test Acc: 0.3325
 Test site-Southeast_Asian           (0)| Epoch:9 | Test Acc: 0.4333
 Test site-Middle_Eastern            (3)| Epoch:9 | Test Acc: 0.3918
White: 0.4305, Latino_Hispanic: 0.3544, Black: 0.2812, East_Asian: 0.4740, Indian: 0.3325, Southeast_Asian: 0.4333, Middle_Eastern: 0.3918, 
Average Test Accuracy: 0.3854, domain std=0.0619, cluster std=nan, individual std=0.0619, 
============ Train epoch 10 ============
cnt=[2, 3, 1, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-White                    | Train Loss: 1.5336 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.3976 | Train Acc: 0.4412
 Site-Latino_Hispanic          | Train Loss: 1.6322 | Train Acc: 0.3597
 Site-Latino_Hispanic          | Train Loss: 1.4553 | Train Acc: 0.4005
 Site-Black                    | Train Loss: 1.7145 | Train Acc: 0.3237
 Site-Black                    | Train Loss: 1.6675 | Train Acc: 0.3333
 Site-East_Asian               | Train Loss: 1.4529 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.4027 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.5451 | Train Acc: 0.4101
 Site-Indian                   | Train Loss: 1.5695 | Train Acc: 0.3981
 Site-Southeast_Asian          | Train Loss: 1.4864 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.5328 | Train Acc: 0.4053
 Site-Middle_Eastern           | Train Loss: 1.4676 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.4715 | Train Acc: 0.4436
 Site-White                     (6) | Val  Loss: 1.5040 | Val  Acc: 0.3913
 Site-White                     (6) | Val  Loss: 1.4572 | Val  Acc: 0.4460
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5604 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5397 | Val  Acc: 0.4029
 Site-Black                     (5) | Val  Loss: 1.4610 | Val  Acc: 0.4674
 Site-Black                     (5) | Val  Loss: 1.6293 | Val  Acc: 0.3489
 Site-East_Asian                (1) | Val  Loss: 1.3412 | Val  Acc: 0.5435
 Site-East_Asian                (1) | Val  Loss: 1.4042 | Val  Acc: 0.4712
 Site-Indian                    (3) | Val  Loss: 1.6254 | Val  Acc: 0.2609
 Site-Indian                    (0) | Val  Loss: 1.5646 | Val  Acc: 0.3597
 Site-Southeast_Asian           (0) | Val  Loss: 1.4758 | Val  Acc: 0.4022
 Site-Southeast_Asian           (1) | Val  Loss: 1.4772 | Val  Acc: 0.4496
 Site-Middle_Eastern            (2) | Val  Loss: 1.5030 | Val  Acc: 0.4783
 Site-Middle_Eastern            (6) | Val  Loss: 1.4876 | Val  Acc: 0.4532
Average Valid Accuracy: 0.4214
============ Train epoch 11 ============
cnt=[4, 1, 2, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-White                    | Train Loss: 1.4970 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.5299 | Train Acc: 0.4341
 Site-Latino_Hispanic          | Train Loss: 1.6372 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4905 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.7320 | Train Acc: 0.3309
 Site-Black                    | Train Loss: 1.6092 | Train Acc: 0.3549
 Site-East_Asian               | Train Loss: 1.4235 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.5344 | Train Acc: 0.4580
 Site-Indian                   | Train Loss: 1.4869 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.5021 | Train Acc: 0.3909
 Site-Southeast_Asian          | Train Loss: 1.4650 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.6035 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.5500 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.5436 | Train Acc: 0.4532
 Site-White                     (4) | Val  Loss: 1.5526 | Val  Acc: 0.4130
 Site-White                     (1) | Val  Loss: 1.4622 | Val  Acc: 0.4137
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5336 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5474 | Val  Acc: 0.4137
 Site-Black                     (2) | Val  Loss: 1.3974 | Val  Acc: 0.5000
 Site-Black                     (2) | Val  Loss: 1.5957 | Val  Acc: 0.3561
 Site-East_Asian                (0) | Val  Loss: 1.3116 | Val  Acc: 0.5435
 Site-East_Asian                (0) | Val  Loss: 1.3829 | Val  Acc: 0.5000
 Site-Indian                    (3) | Val  Loss: 1.6055 | Val  Acc: 0.3587
 Site-Indian                    (3) | Val  Loss: 1.5391 | Val  Acc: 0.3849
 Site-Southeast_Asian           (0) | Val  Loss: 1.5026 | Val  Acc: 0.4130
 Site-Southeast_Asian           (0) | Val  Loss: 1.4512 | Val  Acc: 0.4496
 Site-Middle_Eastern            (5) | Val  Loss: 1.4364 | Val  Acc: 0.5109
 Site-Middle_Eastern            (5) | Val  Loss: 1.4823 | Val  Acc: 0.4568
Average Valid Accuracy: 0.4369
 Best site-White                    (4)  | Epoch:11 | Val Acc: 0.4130
 Best site-White                    (1)  | Epoch:11 | Val Acc: 0.4137
 Best site-Latino_Hispanic          (6)  | Epoch:11 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (3)  | Epoch:11 | Val Acc: 0.4137
 Best site-Black                    (2)  | Epoch:11 | Val Acc: 0.5000
 Best site-Black                    (2)  | Epoch:11 | Val Acc: 0.3561
 Best site-East_Asian               (0)  | Epoch:11 | Val Acc: 0.5435
 Best site-East_Asian               (0)  | Epoch:11 | Val Acc: 0.5000
 Best site-Indian                   (3)  | Epoch:11 | Val Acc: 0.3587
 Best site-Indian                   (3)  | Epoch:11 | Val Acc: 0.3849
 Best site-Southeast_Asian          (0)  | Epoch:11 | Val Acc: 0.4130
 Best site-Southeast_Asian          (0)  | Epoch:11 | Val Acc: 0.4496
 Best site-Middle_Eastern           (5)  | Epoch:11 | Val Acc: 0.5109
 Best site-Middle_Eastern           (5)  | Epoch:11 | Val Acc: 0.4568
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 12 ============
cnt=[2, 1, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-White                    | Train Loss: 1.4741 | Train Acc: 0.4029
 Site-White                    | Train Loss: 1.4150 | Train Acc: 0.4341
 Site-Latino_Hispanic          | Train Loss: 1.5621 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.5739 | Train Acc: 0.4149
 Site-Black                    | Train Loss: 1.7901 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.6094 | Train Acc: 0.3477
 Site-East_Asian               | Train Loss: 1.4951 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3174 | Train Acc: 0.4844
 Site-Indian                   | Train Loss: 1.4244 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.5123 | Train Acc: 0.3909
 Site-Southeast_Asian          | Train Loss: 1.5539 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.4826 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.4671 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.4127 | Train Acc: 0.4604
 Site-White                     (5) | Val  Loss: 1.5094 | Val  Acc: 0.4457
 Site-White                     (2) | Val  Loss: 1.4703 | Val  Acc: 0.4317
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5953 | Val  Acc: 0.3804
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5199 | Val  Acc: 0.3849
 Site-Black                     (1) | Val  Loss: 1.4200 | Val  Acc: 0.5435
 Site-Black                     (3) | Val  Loss: 1.6175 | Val  Acc: 0.3669
 Site-East_Asian                (6) | Val  Loss: 1.3282 | Val  Acc: 0.4891
 Site-East_Asian                (6) | Val  Loss: 1.3881 | Val  Acc: 0.5216
 Site-Indian                    (4) | Val  Loss: 1.5805 | Val  Acc: 0.3043
 Site-Indian                    (4) | Val  Loss: 1.5102 | Val  Acc: 0.4317
 Site-Southeast_Asian           (0) | Val  Loss: 1.4729 | Val  Acc: 0.4674
 Site-Southeast_Asian           (0) | Val  Loss: 1.4654 | Val  Acc: 0.4676
 Site-Middle_Eastern            (2) | Val  Loss: 1.4525 | Val  Acc: 0.4783
 Site-Middle_Eastern            (2) | Val  Loss: 1.4795 | Val  Acc: 0.4209
Average Valid Accuracy: 0.4381
 Best site-White                    (5)  | Epoch:12 | Val Acc: 0.4457
 Best site-White                    (2)  | Epoch:12 | Val Acc: 0.4317
 Best site-Latino_Hispanic          (4)  | Epoch:12 | Val Acc: 0.3804
 Best site-Latino_Hispanic          (4)  | Epoch:12 | Val Acc: 0.3849
 Best site-Black                    (1)  | Epoch:12 | Val Acc: 0.5435
 Best site-Black                    (3)  | Epoch:12 | Val Acc: 0.3669
 Best site-East_Asian               (6)  | Epoch:12 | Val Acc: 0.4891
 Best site-East_Asian               (6)  | Epoch:12 | Val Acc: 0.5216
 Best site-Indian                   (4)  | Epoch:12 | Val Acc: 0.3043
 Best site-Indian                   (4)  | Epoch:12 | Val Acc: 0.4317
 Best site-Southeast_Asian          (0)  | Epoch:12 | Val Acc: 0.4674
 Best site-Southeast_Asian          (0)  | Epoch:12 | Val Acc: 0.4676
 Best site-Middle_Eastern           (2)  | Epoch:12 | Val Acc: 0.4783
 Best site-Middle_Eastern           (2)  | Epoch:12 | Val Acc: 0.4209
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 13 ============
cnt=[3, 2, 1, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-White                    | Train Loss: 1.4858 | Train Acc: 0.4173
 Site-White                    | Train Loss: 1.4621 | Train Acc: 0.4652
 Site-Latino_Hispanic          | Train Loss: 1.6404 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.6424 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.6688 | Train Acc: 0.3237
 Site-Black                    | Train Loss: 1.6548 | Train Acc: 0.3549
 Site-East_Asian               | Train Loss: 1.4979 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.3767 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4913 | Train Acc: 0.4317
 Site-Indian                   | Train Loss: 1.5201 | Train Acc: 0.3885
 Site-Southeast_Asian          | Train Loss: 1.4756 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.4838 | Train Acc: 0.4436
 Site-Middle_Eastern           | Train Loss: 1.4850 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.4802 | Train Acc: 0.4460
 Site-White                     (1) | Val  Loss: 1.4783 | Val  Acc: 0.4348
 Site-White                     (1) | Val  Loss: 1.4491 | Val  Acc: 0.4353
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5393 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5260 | Val  Acc: 0.4137
 Site-Black                     (3) | Val  Loss: 1.4159 | Val  Acc: 0.5000
 Site-Black                     (3) | Val  Loss: 1.6013 | Val  Acc: 0.3597
 Site-East_Asian                (6) | Val  Loss: 1.3394 | Val  Acc: 0.5217
 Site-East_Asian                (2) | Val  Loss: 1.3657 | Val  Acc: 0.5036
 Site-Indian                    (0) | Val  Loss: 1.5508 | Val  Acc: 0.3696
 Site-Indian                    (0) | Val  Loss: 1.5041 | Val  Acc: 0.4245
 Site-Southeast_Asian           (6) | Val  Loss: 1.5158 | Val  Acc: 0.4022
 Site-Southeast_Asian           (6) | Val  Loss: 1.4627 | Val  Acc: 0.4353
 Site-Middle_Eastern            (4) | Val  Loss: 1.4200 | Val  Acc: 0.4891
 Site-Middle_Eastern            (4) | Val  Loss: 1.4810 | Val  Acc: 0.4209
Average Valid Accuracy: 0.4397
 Best site-White                    (1)  | Epoch:13 | Val Acc: 0.4348
 Best site-White                    (1)  | Epoch:13 | Val Acc: 0.4353
 Best site-Latino_Hispanic          (5)  | Epoch:13 | Val Acc: 0.4457
 Best site-Latino_Hispanic          (0)  | Epoch:13 | Val Acc: 0.4137
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.5000
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.3597
 Best site-East_Asian               (6)  | Epoch:13 | Val Acc: 0.5217
 Best site-East_Asian               (2)  | Epoch:13 | Val Acc: 0.5036
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.3696
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.4245
 Best site-Southeast_Asian          (6)  | Epoch:13 | Val Acc: 0.4022
 Best site-Southeast_Asian          (6)  | Epoch:13 | Val Acc: 0.4353
 Best site-Middle_Eastern           (4)  | Epoch:13 | Val Acc: 0.4891
 Best site-Middle_Eastern           (4)  | Epoch:13 | Val Acc: 0.4209
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 14 ============
cnt=[3, 2, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-White                    | Train Loss: 1.4629 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.3711 | Train Acc: 0.4484
 Site-Latino_Hispanic          | Train Loss: 1.5795 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.5313 | Train Acc: 0.4005
 Site-Black                    | Train Loss: 1.6924 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.5833 | Train Acc: 0.3693
 Site-East_Asian               | Train Loss: 1.4593 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3535 | Train Acc: 0.4940
 Site-Indian                   | Train Loss: 1.4271 | Train Acc: 0.4317
 Site-Indian                   | Train Loss: 1.5300 | Train Acc: 0.4077
 Site-Southeast_Asian          | Train Loss: 1.5396 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.5924 | Train Acc: 0.4149
 Site-Middle_Eastern           | Train Loss: 1.4376 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.4237 | Train Acc: 0.4484
 Site-White                     (4) | Val  Loss: 1.4912 | Val  Acc: 0.4457
 Site-White                     (6) | Val  Loss: 1.4303 | Val  Acc: 0.4245
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4981 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5245 | Val  Acc: 0.3777
 Site-Black                     (3) | Val  Loss: 1.4613 | Val  Acc: 0.4783
 Site-Black                     (3) | Val  Loss: 1.6051 | Val  Acc: 0.3597
 Site-East_Asian                (5) | Val  Loss: 1.2916 | Val  Acc: 0.5543
 Site-East_Asian                (5) | Val  Loss: 1.3447 | Val  Acc: 0.4892
 Site-Indian                    (0) | Val  Loss: 1.5892 | Val  Acc: 0.3043
 Site-Indian                    (0) | Val  Loss: 1.5231 | Val  Acc: 0.4317
 Site-Southeast_Asian           (1) | Val  Loss: 1.4802 | Val  Acc: 0.4022
 Site-Southeast_Asian           (1) | Val  Loss: 1.4612 | Val  Acc: 0.4281
 Site-Middle_Eastern            (2) | Val  Loss: 1.4226 | Val  Acc: 0.5217
 Site-Middle_Eastern            (2) | Val  Loss: 1.4465 | Val  Acc: 0.4460
Average Valid Accuracy: 0.4333
============ Train epoch 15 ============
cnt=[2, 2, 2, 3, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-White                    | Train Loss: 1.4375 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.4409 | Train Acc: 0.4556
 Site-Latino_Hispanic          | Train Loss: 1.6628 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.4939 | Train Acc: 0.4077
 Site-Black                    | Train Loss: 1.7009 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.7110 | Train Acc: 0.3597
 Site-East_Asian               | Train Loss: 1.4386 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3176 | Train Acc: 0.4988
 Site-Indian                   | Train Loss: 1.4675 | Train Acc: 0.4317
 Site-Indian                   | Train Loss: 1.4705 | Train Acc: 0.4293
 Site-Southeast_Asian          | Train Loss: 1.4371 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.5582 | Train Acc: 0.4508
 Site-Middle_Eastern           | Train Loss: 1.4964 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.4171 | Train Acc: 0.4676
 Site-White                     (3) | Val  Loss: 1.3973 | Val  Acc: 0.4783
 Site-White                     (3) | Val  Loss: 1.4090 | Val  Acc: 0.4640
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5034 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5298 | Val  Acc: 0.3957
 Site-Black                     (2) | Val  Loss: 1.4644 | Val  Acc: 0.4565
 Site-Black                     (2) | Val  Loss: 1.6007 | Val  Acc: 0.3957
 Site-East_Asian                (0) | Val  Loss: 1.2873 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.3405 | Val  Acc: 0.5036
 Site-Indian                    (5) | Val  Loss: 1.5705 | Val  Acc: 0.3370
 Site-Indian                    (5) | Val  Loss: 1.5100 | Val  Acc: 0.4173
 Site-Southeast_Asian           (6) | Val  Loss: 1.4220 | Val  Acc: 0.4457
 Site-Southeast_Asian           (6) | Val  Loss: 1.4603 | Val  Acc: 0.4388
 Site-Middle_Eastern            (1) | Val  Loss: 1.3992 | Val  Acc: 0.5000
 Site-Middle_Eastern            (1) | Val  Loss: 1.4536 | Val  Acc: 0.4640
Average Valid Accuracy: 0.4482
 Best site-White                    (3)  | Epoch:15 | Val Acc: 0.4783
 Best site-White                    (3)  | Epoch:15 | Val Acc: 0.4640
 Best site-Latino_Hispanic          (3)  | Epoch:15 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (4)  | Epoch:15 | Val Acc: 0.3957
 Best site-Black                    (2)  | Epoch:15 | Val Acc: 0.4565
 Best site-Black                    (2)  | Epoch:15 | Val Acc: 0.3957
 Best site-East_Asian               (0)  | Epoch:15 | Val Acc: 0.5652
 Best site-East_Asian               (0)  | Epoch:15 | Val Acc: 0.5036
 Best site-Indian                   (5)  | Epoch:15 | Val Acc: 0.3370
 Best site-Indian                   (5)  | Epoch:15 | Val Acc: 0.4173
 Best site-Southeast_Asian          (6)  | Epoch:15 | Val Acc: 0.4457
 Best site-Southeast_Asian          (6)  | Epoch:15 | Val Acc: 0.4388
 Best site-Middle_Eastern           (1)  | Epoch:15 | Val Acc: 0.5000
 Best site-Middle_Eastern           (1)  | Epoch:15 | Val Acc: 0.4640
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 16 ============
cnt=[1, 1, 4, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-White                    | Train Loss: 1.5067 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.3483 | Train Acc: 0.4700
 Site-Latino_Hispanic          | Train Loss: 1.5808 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4214 | Train Acc: 0.4005
 Site-Black                    | Train Loss: 1.6687 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.5287 | Train Acc: 0.3789
 Site-East_Asian               | Train Loss: 1.3408 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3605 | Train Acc: 0.4844
 Site-Indian                   | Train Loss: 1.4341 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.5461 | Train Acc: 0.3981
 Site-Southeast_Asian          | Train Loss: 1.4572 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.6543 | Train Acc: 0.4508
 Site-Middle_Eastern           | Train Loss: 1.4740 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.4222 | Train Acc: 0.4628
 Site-White                     (4) | Val  Loss: 1.4531 | Val  Acc: 0.4565
 Site-White                     (4) | Val  Loss: 1.4087 | Val  Acc: 0.4640
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4987 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4877 | Val  Acc: 0.4281
 Site-Black                     (3) | Val  Loss: 1.4042 | Val  Acc: 0.5652
 Site-Black                     (3) | Val  Loss: 1.5597 | Val  Acc: 0.4065
 Site-East_Asian                (2) | Val  Loss: 1.3301 | Val  Acc: 0.5543
 Site-East_Asian                (2) | Val  Loss: 1.3611 | Val  Acc: 0.4964
 Site-Indian                    (6) | Val  Loss: 1.5941 | Val  Acc: 0.3587
 Site-Indian                    (6) | Val  Loss: 1.4901 | Val  Acc: 0.4029
 Site-Southeast_Asian           (2) | Val  Loss: 1.4608 | Val  Acc: 0.4457
 Site-Southeast_Asian           (2) | Val  Loss: 1.4516 | Val  Acc: 0.4460
 Site-Middle_Eastern            (5) | Val  Loss: 1.4171 | Val  Acc: 0.4783
 Site-Middle_Eastern            (0) | Val  Loss: 1.4304 | Val  Acc: 0.4532
Average Valid Accuracy: 0.4565
 Best site-White                    (4)  | Epoch:16 | Val Acc: 0.4565
 Best site-White                    (4)  | Epoch:16 | Val Acc: 0.4640
 Best site-Latino_Hispanic          (1)  | Epoch:16 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (6)  | Epoch:16 | Val Acc: 0.4281
 Best site-Black                    (3)  | Epoch:16 | Val Acc: 0.5652
 Best site-Black                    (3)  | Epoch:16 | Val Acc: 0.4065
 Best site-East_Asian               (2)  | Epoch:16 | Val Acc: 0.5543
 Best site-East_Asian               (2)  | Epoch:16 | Val Acc: 0.4964
 Best site-Indian                   (6)  | Epoch:16 | Val Acc: 0.3587
 Best site-Indian                   (6)  | Epoch:16 | Val Acc: 0.4029
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.4457
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.4460
 Best site-Middle_Eastern           (5)  | Epoch:16 | Val Acc: 0.4783
 Best site-Middle_Eastern           (0)  | Epoch:16 | Val Acc: 0.4532
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 17 ============
cnt=[3, 1, 4, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-White                    | Train Loss: 1.4186 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.3008 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.6059 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.5090 | Train Acc: 0.4149
 Site-Black                    | Train Loss: 1.6162 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.6881 | Train Acc: 0.3765
 Site-East_Asian               | Train Loss: 1.4438 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.3040 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.4579 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4867 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.5286 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.4727 | Train Acc: 0.4724
 Site-Middle_Eastern           | Train Loss: 1.4850 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3322 | Train Acc: 0.4484
 Site-White                     (3) | Val  Loss: 1.4544 | Val  Acc: 0.4130
 Site-White                     (6) | Val  Loss: 1.3981 | Val  Acc: 0.4712
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4865 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (2) | Val  Loss: 1.5154 | Val  Acc: 0.4245
 Site-Black                     (1) | Val  Loss: 1.4522 | Val  Acc: 0.4565
 Site-Black                     (5) | Val  Loss: 1.5587 | Val  Acc: 0.3885
 Site-East_Asian                (0) | Val  Loss: 1.3036 | Val  Acc: 0.5326
 Site-East_Asian                (0) | Val  Loss: 1.3207 | Val  Acc: 0.5108
 Site-Indian                    (2) | Val  Loss: 1.5372 | Val  Acc: 0.3696
 Site-Indian                    (2) | Val  Loss: 1.4922 | Val  Acc: 0.4137
 Site-Southeast_Asian           (0) | Val  Loss: 1.4233 | Val  Acc: 0.4239
 Site-Southeast_Asian           (2) | Val  Loss: 1.4267 | Val  Acc: 0.4353
 Site-Middle_Eastern            (4) | Val  Loss: 1.4473 | Val  Acc: 0.4891
 Site-Middle_Eastern            (4) | Val  Loss: 1.4304 | Val  Acc: 0.4568
Average Valid Accuracy: 0.4428
============ Train epoch 18 ============
cnt=[3, 1, 4, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-White                    | Train Loss: 1.4306 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.3362 | Train Acc: 0.4628
 Site-Latino_Hispanic          | Train Loss: 1.5605 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.3833 | Train Acc: 0.4245
 Site-Black                    | Train Loss: 1.7293 | Train Acc: 0.3309
 Site-Black                    | Train Loss: 1.5452 | Train Acc: 0.3621
 Site-East_Asian               | Train Loss: 1.4128 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.2872 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4139 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.5030 | Train Acc: 0.4197
 Site-Southeast_Asian          | Train Loss: 1.4770 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.4386 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.5074 | Train Acc: 0.3957
 Site-Middle_Eastern           | Train Loss: 1.4726 | Train Acc: 0.4676
 Site-White                     (6) | Val  Loss: 1.4368 | Val  Acc: 0.4348
 Site-White                     (0) | Val  Loss: 1.4111 | Val  Acc: 0.4388
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4796 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4816 | Val  Acc: 0.4137
 Site-Black                     (4) | Val  Loss: 1.3972 | Val  Acc: 0.4457
 Site-Black                     (4) | Val  Loss: 1.5943 | Val  Acc: 0.3669
 Site-East_Asian                (5) | Val  Loss: 1.3034 | Val  Acc: 0.5761
 Site-East_Asian                (5) | Val  Loss: 1.3372 | Val  Acc: 0.5000
 Site-Indian                    (3) | Val  Loss: 1.5396 | Val  Acc: 0.3152
 Site-Indian                    (1) | Val  Loss: 1.4979 | Val  Acc: 0.4137
 Site-Southeast_Asian           (2) | Val  Loss: 1.4349 | Val  Acc: 0.4457
 Site-Southeast_Asian           (2) | Val  Loss: 1.4122 | Val  Acc: 0.4676
 Site-Middle_Eastern            (0) | Val  Loss: 1.4085 | Val  Acc: 0.4891
 Site-Middle_Eastern            (0) | Val  Loss: 1.4504 | Val  Acc: 0.4137
Average Valid Accuracy: 0.4412
============ Train epoch 19 ============
cnt=[1, 2, 4, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-White                    | Train Loss: 1.4137 | Train Acc: 0.4388
 Site-White                    | Train Loss: 1.3757 | Train Acc: 0.4748
 Site-Latino_Hispanic          | Train Loss: 1.5623 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.4549 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.7013 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.6122 | Train Acc: 0.3909
 Site-East_Asian               | Train Loss: 1.3703 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.4117 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.3696 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.5332 | Train Acc: 0.4341
 Site-Southeast_Asian          | Train Loss: 1.4668 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.5244 | Train Acc: 0.4652
 Site-Middle_Eastern           | Train Loss: 1.4753 | Train Acc: 0.3885
 Site-Middle_Eastern           | Train Loss: 1.3241 | Train Acc: 0.4796
 Site-White                     (5) | Val  Loss: 1.4046 | Val  Acc: 0.4457
 Site-White                     (5) | Val  Loss: 1.4287 | Val  Acc: 0.4712
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4906 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4772 | Val  Acc: 0.4317
 Site-Black                     (1) | Val  Loss: 1.4309 | Val  Acc: 0.4130
 Site-Black                     (1) | Val  Loss: 1.5625 | Val  Acc: 0.4065
 Site-East_Asian                (2) | Val  Loss: 1.2705 | Val  Acc: 0.5435
 Site-East_Asian                (0) | Val  Loss: 1.3376 | Val  Acc: 0.5324
 Site-Indian                    (6) | Val  Loss: 1.5012 | Val  Acc: 0.3478
 Site-Indian                    (2) | Val  Loss: 1.4860 | Val  Acc: 0.4065
 Site-Southeast_Asian           (2) | Val  Loss: 1.4565 | Val  Acc: 0.4674
 Site-Southeast_Asian           (2) | Val  Loss: 1.4312 | Val  Acc: 0.4568
 Site-Middle_Eastern            (3) | Val  Loss: 1.3926 | Val  Acc: 0.5435
 Site-Middle_Eastern            (3) | Val  Loss: 1.4069 | Val  Acc: 0.4496
Average Valid Accuracy: 0.4520
============ Train epoch 20 ============
cnt=[2, 3, 4, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-White                    | Train Loss: 1.3621 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.4061 | Train Acc: 0.4772
 Site-Latino_Hispanic          | Train Loss: 1.5824 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.4937 | Train Acc: 0.4029
 Site-Black                    | Train Loss: 1.6856 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.5927 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.3651 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.3275 | Train Acc: 0.5012
 Site-Indian                   | Train Loss: 1.4337 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.4295 | Train Acc: 0.4484
 Site-Southeast_Asian          | Train Loss: 1.4639 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.3580 | Train Acc: 0.4844
 Site-Middle_Eastern           | Train Loss: 1.4465 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.3315 | Train Acc: 0.4844
 Site-White                     (3) | Val  Loss: 1.4259 | Val  Acc: 0.5000
 Site-White                     (3) | Val  Loss: 1.4253 | Val  Acc: 0.4604
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4987 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4637 | Val  Acc: 0.4137
 Site-Black                     (4) | Val  Loss: 1.3920 | Val  Acc: 0.5326
 Site-Black                     (6) | Val  Loss: 1.5173 | Val  Acc: 0.4353
 Site-East_Asian                (2) | Val  Loss: 1.2957 | Val  Acc: 0.5652
 Site-East_Asian                (2) | Val  Loss: 1.3359 | Val  Acc: 0.5036
 Site-Indian                    (1) | Val  Loss: 1.5201 | Val  Acc: 0.3152
 Site-Indian                    (1) | Val  Loss: 1.4530 | Val  Acc: 0.4353
 Site-Southeast_Asian           (2) | Val  Loss: 1.4347 | Val  Acc: 0.4239
 Site-Southeast_Asian           (2) | Val  Loss: 1.4239 | Val  Acc: 0.4568
 Site-Middle_Eastern            (0) | Val  Loss: 1.4176 | Val  Acc: 0.5000
 Site-Middle_Eastern            (0) | Val  Loss: 1.3882 | Val  Acc: 0.4928
Average Valid Accuracy: 0.4606
 Best site-White                    (3)  | Epoch:20 | Val Acc: 0.5000
 Best site-White                    (3)  | Epoch:20 | Val Acc: 0.4604
 Best site-Latino_Hispanic          (1)  | Epoch:20 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (5)  | Epoch:20 | Val Acc: 0.4137
 Best site-Black                    (4)  | Epoch:20 | Val Acc: 0.5326
 Best site-Black                    (6)  | Epoch:20 | Val Acc: 0.4353
 Best site-East_Asian               (2)  | Epoch:20 | Val Acc: 0.5652
 Best site-East_Asian               (2)  | Epoch:20 | Val Acc: 0.5036
 Best site-Indian                   (1)  | Epoch:20 | Val Acc: 0.3152
 Best site-Indian                   (1)  | Epoch:20 | Val Acc: 0.4353
 Best site-Southeast_Asian          (2)  | Epoch:20 | Val Acc: 0.4239
 Best site-Southeast_Asian          (2)  | Epoch:20 | Val Acc: 0.4568
 Best site-Middle_Eastern           (0)  | Epoch:20 | Val Acc: 0.5000
 Best site-Middle_Eastern           (0)  | Epoch:20 | Val Acc: 0.4928
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 21 ============
cnt=[2, 2, 2, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-White                    | Train Loss: 1.3902 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.3071 | Train Acc: 0.4892
 Site-Latino_Hispanic          | Train Loss: 1.5431 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.4412 | Train Acc: 0.4365
 Site-Black                    | Train Loss: 1.6105 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.5873 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.4345 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3204 | Train Acc: 0.4844
 Site-Indian                   | Train Loss: 1.4042 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.5009 | Train Acc: 0.4293
 Site-Southeast_Asian          | Train Loss: 1.4203 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4024 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.4216 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3202 | Train Acc: 0.4676
 Site-White                     (2) | Val  Loss: 1.3879 | Val  Acc: 0.4674
 Site-White                     (6) | Val  Loss: 1.3838 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4759 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4794 | Val  Acc: 0.4101
 Site-Black                     (5) | Val  Loss: 1.3717 | Val  Acc: 0.5326
 Site-Black                     (5) | Val  Loss: 1.5056 | Val  Acc: 0.4029
 Site-East_Asian                (3) | Val  Loss: 1.2738 | Val  Acc: 0.5652
 Site-East_Asian                (3) | Val  Loss: 1.3205 | Val  Acc: 0.5144
 Site-Indian                    (1) | Val  Loss: 1.5459 | Val  Acc: 0.3043
 Site-Indian                    (1) | Val  Loss: 1.4855 | Val  Acc: 0.3921
 Site-Southeast_Asian           (4) | Val  Loss: 1.4657 | Val  Acc: 0.4457
 Site-Southeast_Asian           (4) | Val  Loss: 1.3952 | Val  Acc: 0.4676
 Site-Middle_Eastern            (0) | Val  Loss: 1.4106 | Val  Acc: 0.4783
 Site-Middle_Eastern            (0) | Val  Loss: 1.4029 | Val  Acc: 0.4640
Average Valid Accuracy: 0.4541
============ Train epoch 22 ============
cnt=[1, 2, 2, 3, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-White                    | Train Loss: 1.3144 | Train Acc: 0.5108
 Site-White                    | Train Loss: 1.3542 | Train Acc: 0.4724
 Site-Latino_Hispanic          | Train Loss: 1.5287 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.3867 | Train Acc: 0.4221
 Site-Black                    | Train Loss: 1.6302 | Train Acc: 0.3165
 Site-Black                    | Train Loss: 1.5516 | Train Acc: 0.3933
 Site-East_Asian               | Train Loss: 1.3727 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3763 | Train Acc: 0.4700
 Site-Indian                   | Train Loss: 1.3633 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.6259 | Train Acc: 0.4436
 Site-Southeast_Asian          | Train Loss: 1.4282 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3908 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3793 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3246 | Train Acc: 0.4748
 Site-White                     (3) | Val  Loss: 1.3619 | Val  Acc: 0.4239
 Site-White                     (0) | Val  Loss: 1.3658 | Val  Acc: 0.4784
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4167 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4740 | Val  Acc: 0.4245
 Site-Black                     (1) | Val  Loss: 1.3471 | Val  Acc: 0.4891
 Site-Black                     (1) | Val  Loss: 1.5168 | Val  Acc: 0.3993
 Site-East_Asian                (6) | Val  Loss: 1.2783 | Val  Acc: 0.5435
 Site-East_Asian                (6) | Val  Loss: 1.3301 | Val  Acc: 0.5000
 Site-Indian                    (4) | Val  Loss: 1.5295 | Val  Acc: 0.3804
 Site-Indian                    (4) | Val  Loss: 1.4517 | Val  Acc: 0.4424
 Site-Southeast_Asian           (2) | Val  Loss: 1.3557 | Val  Acc: 0.4783
 Site-Southeast_Asian           (2) | Val  Loss: 1.4236 | Val  Acc: 0.4676
 Site-Middle_Eastern            (3) | Val  Loss: 1.3817 | Val  Acc: 0.5326
 Site-Middle_Eastern            (3) | Val  Loss: 1.4095 | Val  Acc: 0.4640
Average Valid Accuracy: 0.4645
 Best site-White                    (3)  | Epoch:22 | Val Acc: 0.4239
 Best site-White                    (0)  | Epoch:22 | Val Acc: 0.4784
 Best site-Latino_Hispanic          (5)  | Epoch:22 | Val Acc: 0.4783
 Best site-Latino_Hispanic          (5)  | Epoch:22 | Val Acc: 0.4245
 Best site-Black                    (1)  | Epoch:22 | Val Acc: 0.4891
 Best site-Black                    (1)  | Epoch:22 | Val Acc: 0.3993
 Best site-East_Asian               (6)  | Epoch:22 | Val Acc: 0.5435
 Best site-East_Asian               (6)  | Epoch:22 | Val Acc: 0.5000
 Best site-Indian                   (4)  | Epoch:22 | Val Acc: 0.3804
 Best site-Indian                   (4)  | Epoch:22 | Val Acc: 0.4424
 Best site-Southeast_Asian          (2)  | Epoch:22 | Val Acc: 0.4783
 Best site-Southeast_Asian          (2)  | Epoch:22 | Val Acc: 0.4676
 Best site-Middle_Eastern           (3)  | Epoch:22 | Val Acc: 0.5326
 Best site-Middle_Eastern           (3)  | Epoch:22 | Val Acc: 0.4640
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 23 ============
cnt=[1, 2, 2, 3, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-White                    | Train Loss: 1.4548 | Train Acc: 0.4460
 Site-White                    | Train Loss: 1.3701 | Train Acc: 0.4940
 Site-Latino_Hispanic          | Train Loss: 1.5239 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.5380 | Train Acc: 0.4197
 Site-Black                    | Train Loss: 1.5684 | Train Acc: 0.4029
 Site-Black                    | Train Loss: 1.4880 | Train Acc: 0.3909
 Site-East_Asian               | Train Loss: 1.4470 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.3511 | Train Acc: 0.4772
 Site-Indian                   | Train Loss: 1.3857 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.4870 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.4262 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4341 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.4286 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.4984 | Train Acc: 0.4892
 Site-White                     (6) | Val  Loss: 1.4131 | Val  Acc: 0.4130
 Site-White                     (6) | Val  Loss: 1.3737 | Val  Acc: 0.4748
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4691 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4545 | Val  Acc: 0.4209
 Site-Black                     (1) | Val  Loss: 1.3409 | Val  Acc: 0.5543
 Site-Black                     (1) | Val  Loss: 1.5310 | Val  Acc: 0.4245
 Site-East_Asian                (5) | Val  Loss: 1.2604 | Val  Acc: 0.5543
 Site-East_Asian                (5) | Val  Loss: 1.3157 | Val  Acc: 0.5180
 Site-Indian                    (2) | Val  Loss: 1.5419 | Val  Acc: 0.3913
 Site-Indian                    (2) | Val  Loss: 1.4498 | Val  Acc: 0.4065
 Site-Southeast_Asian           (3) | Val  Loss: 1.4154 | Val  Acc: 0.5000
 Site-Southeast_Asian           (3) | Val  Loss: 1.4257 | Val  Acc: 0.4964
 Site-Middle_Eastern            (4) | Val  Loss: 1.3850 | Val  Acc: 0.4891
 Site-Middle_Eastern            (4) | Val  Loss: 1.3745 | Val  Acc: 0.4928
Average Valid Accuracy: 0.4686
 Best site-White                    (6)  | Epoch:23 | Val Acc: 0.4130
 Best site-White                    (6)  | Epoch:23 | Val Acc: 0.4748
 Best site-Latino_Hispanic          (0)  | Epoch:23 | Val Acc: 0.4239
 Best site-Latino_Hispanic          (3)  | Epoch:23 | Val Acc: 0.4209
 Best site-Black                    (1)  | Epoch:23 | Val Acc: 0.5543
 Best site-Black                    (1)  | Epoch:23 | Val Acc: 0.4245
 Best site-East_Asian               (5)  | Epoch:23 | Val Acc: 0.5543
 Best site-East_Asian               (5)  | Epoch:23 | Val Acc: 0.5180
 Best site-Indian                   (2)  | Epoch:23 | Val Acc: 0.3913
 Best site-Indian                   (2)  | Epoch:23 | Val Acc: 0.4065
 Best site-Southeast_Asian          (3)  | Epoch:23 | Val Acc: 0.5000
 Best site-Southeast_Asian          (3)  | Epoch:23 | Val Acc: 0.4964
 Best site-Middle_Eastern           (4)  | Epoch:23 | Val Acc: 0.4891
 Best site-Middle_Eastern           (4)  | Epoch:23 | Val Acc: 0.4928
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 24 ============
cnt=[1, 4, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-White                    | Train Loss: 1.3906 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.4120 | Train Acc: 0.4844
 Site-Latino_Hispanic          | Train Loss: 1.5274 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.4131 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.6328 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.5061 | Train Acc: 0.4197
 Site-East_Asian               | Train Loss: 1.3365 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.4147 | Train Acc: 0.4844
 Site-Indian                   | Train Loss: 1.3380 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.4302 | Train Acc: 0.4293
 Site-Southeast_Asian          | Train Loss: 1.4365 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3770 | Train Acc: 0.4652
 Site-Middle_Eastern           | Train Loss: 1.4248 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.3345 | Train Acc: 0.4796
 Site-White                     (2) | Val  Loss: 1.3850 | Val  Acc: 0.4783
 Site-White                     (2) | Val  Loss: 1.3487 | Val  Acc: 0.4856
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4540 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4772 | Val  Acc: 0.4424
 Site-Black                     (5) | Val  Loss: 1.3459 | Val  Acc: 0.5109
 Site-Black                     (5) | Val  Loss: 1.5373 | Val  Acc: 0.4137
 Site-East_Asian                (1) | Val  Loss: 1.2693 | Val  Acc: 0.5326
 Site-East_Asian                (1) | Val  Loss: 1.3054 | Val  Acc: 0.5216
 Site-Indian                    (3) | Val  Loss: 1.4828 | Val  Acc: 0.4239
 Site-Indian                    (3) | Val  Loss: 1.4296 | Val  Acc: 0.4568
 Site-Southeast_Asian           (1) | Val  Loss: 1.4034 | Val  Acc: 0.4239
 Site-Southeast_Asian           (1) | Val  Loss: 1.3676 | Val  Acc: 0.4676
 Site-Middle_Eastern            (4) | Val  Loss: 1.3631 | Val  Acc: 0.5000
 Site-Middle_Eastern            (4) | Val  Loss: 1.3859 | Val  Acc: 0.4640
Average Valid Accuracy: 0.4683
============ Train epoch 25 ============
cnt=[2, 2, 4, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-White                    | Train Loss: 1.3784 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.5428 | Train Acc: 0.4868
 Site-Latino_Hispanic          | Train Loss: 1.6184 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.3853 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.5847 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.5315 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.3500 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.4284 | Train Acc: 0.4988
 Site-Indian                   | Train Loss: 1.4059 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.5368 | Train Acc: 0.4293
 Site-Southeast_Asian          | Train Loss: 1.3974 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.5013 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.4766 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.2618 | Train Acc: 0.4988
 Site-White                     (0) | Val  Loss: 1.3548 | Val  Acc: 0.4783
 Site-White                     (0) | Val  Loss: 1.3436 | Val  Acc: 0.5108
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4482 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4541 | Val  Acc: 0.4173
 Site-Black                     (5) | Val  Loss: 1.2904 | Val  Acc: 0.5761
 Site-Black                     (5) | Val  Loss: 1.5178 | Val  Acc: 0.4245
 Site-East_Asian                (2) | Val  Loss: 1.2220 | Val  Acc: 0.5652
 Site-East_Asian                (2) | Val  Loss: 1.3150 | Val  Acc: 0.5216
 Site-Indian                    (1) | Val  Loss: 1.4884 | Val  Acc: 0.3804
 Site-Indian                    (1) | Val  Loss: 1.4483 | Val  Acc: 0.4209
 Site-Southeast_Asian           (2) | Val  Loss: 1.3702 | Val  Acc: 0.4674
 Site-Southeast_Asian           (2) | Val  Loss: 1.3741 | Val  Acc: 0.5036
 Site-Middle_Eastern            (3) | Val  Loss: 1.3826 | Val  Acc: 0.5000
 Site-Middle_Eastern            (3) | Val  Loss: 1.4014 | Val  Acc: 0.4424
Average Valid Accuracy: 0.4745
 Best site-White                    (0)  | Epoch:25 | Val Acc: 0.4783
 Best site-White                    (0)  | Epoch:25 | Val Acc: 0.5108
 Best site-Latino_Hispanic          (6)  | Epoch:25 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (4)  | Epoch:25 | Val Acc: 0.4173
 Best site-Black                    (5)  | Epoch:25 | Val Acc: 0.5761
 Best site-Black                    (5)  | Epoch:25 | Val Acc: 0.4245
 Best site-East_Asian               (2)  | Epoch:25 | Val Acc: 0.5652
 Best site-East_Asian               (2)  | Epoch:25 | Val Acc: 0.5216
 Best site-Indian                   (1)  | Epoch:25 | Val Acc: 0.3804
 Best site-Indian                   (1)  | Epoch:25 | Val Acc: 0.4209
 Best site-Southeast_Asian          (2)  | Epoch:25 | Val Acc: 0.4674
 Best site-Southeast_Asian          (2)  | Epoch:25 | Val Acc: 0.5036
 Best site-Middle_Eastern           (3)  | Epoch:25 | Val Acc: 0.5000
 Best site-Middle_Eastern           (3)  | Epoch:25 | Val Acc: 0.4424
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 26 ============
cnt=[2, 2, 3, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-White                    | Train Loss: 1.4427 | Train Acc: 0.5108
 Site-White                    | Train Loss: 1.3282 | Train Acc: 0.4820
 Site-Latino_Hispanic          | Train Loss: 1.5428 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.4310 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.6589 | Train Acc: 0.4245
 Site-Black                    | Train Loss: 1.5724 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.4042 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.3299 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.3590 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.4482 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4522 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.3505 | Train Acc: 0.4700
 Site-Middle_Eastern           | Train Loss: 1.4106 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.3043 | Train Acc: 0.4748
 Site-White                     (2) | Val  Loss: 1.3840 | Val  Acc: 0.4565
 Site-White                     (2) | Val  Loss: 1.3611 | Val  Acc: 0.4784
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4294 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4335 | Val  Acc: 0.4137
 Site-Black                     (3) | Val  Loss: 1.2748 | Val  Acc: 0.5652
 Site-Black                     (5) | Val  Loss: 1.4981 | Val  Acc: 0.4173
 Site-East_Asian                (0) | Val  Loss: 1.2470 | Val  Acc: 0.5435
 Site-East_Asian                (0) | Val  Loss: 1.3043 | Val  Acc: 0.5000
 Site-Indian                    (1) | Val  Loss: 1.4616 | Val  Acc: 0.4130
 Site-Indian                    (1) | Val  Loss: 1.4192 | Val  Acc: 0.4424
 Site-Southeast_Asian           (6) | Val  Loss: 1.3569 | Val  Acc: 0.4891
 Site-Southeast_Asian           (6) | Val  Loss: 1.3735 | Val  Acc: 0.4820
 Site-Middle_Eastern            (4) | Val  Loss: 1.4277 | Val  Acc: 0.4457
 Site-Middle_Eastern            (4) | Val  Loss: 1.3724 | Val  Acc: 0.4892
Average Valid Accuracy: 0.4717
============ Train epoch 27 ============
cnt=[2, 1, 2, 2, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-White                    | Train Loss: 1.4349 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.2642 | Train Acc: 0.5084
 Site-Latino_Hispanic          | Train Loss: 1.4925 | Train Acc: 0.4532
 Site-Latino_Hispanic          | Train Loss: 1.4278 | Train Acc: 0.4077
 Site-Black                    | Train Loss: 1.6038 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.5545 | Train Acc: 0.4221
 Site-East_Asian               | Train Loss: 1.4337 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.3143 | Train Acc: 0.4916
 Site-Indian                   | Train Loss: 1.3196 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.4594 | Train Acc: 0.4508
 Site-Southeast_Asian          | Train Loss: 1.4342 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4829 | Train Acc: 0.4796
 Site-Middle_Eastern           | Train Loss: 1.4060 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3406 | Train Acc: 0.4892
 Site-White                     (5) | Val  Loss: 1.3170 | Val  Acc: 0.4457
 Site-White                     (1) | Val  Loss: 1.3380 | Val  Acc: 0.4856
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4369 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4478 | Val  Acc: 0.4317
 Site-Black                     (3) | Val  Loss: 1.3489 | Val  Acc: 0.5326
 Site-Black                     (3) | Val  Loss: 1.4909 | Val  Acc: 0.4353
 Site-East_Asian                (4) | Val  Loss: 1.2350 | Val  Acc: 0.5326
 Site-East_Asian                (6) | Val  Loss: 1.3234 | Val  Acc: 0.5108
 Site-Indian                    (0) | Val  Loss: 1.4901 | Val  Acc: 0.4130
 Site-Indian                    (0) | Val  Loss: 1.4488 | Val  Acc: 0.4317
 Site-Southeast_Asian           (4) | Val  Loss: 1.4373 | Val  Acc: 0.4674
 Site-Southeast_Asian           (4) | Val  Loss: 1.3674 | Val  Acc: 0.4820
 Site-Middle_Eastern            (2) | Val  Loss: 1.3352 | Val  Acc: 0.5326
 Site-Middle_Eastern            (2) | Val  Loss: 1.3850 | Val  Acc: 0.4856
Average Valid Accuracy: 0.4729
============ Train epoch 28 ============
cnt=[1, 4, 3, 1, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-White                    | Train Loss: 1.3682 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.2967 | Train Acc: 0.4796
 Site-Latino_Hispanic          | Train Loss: 1.6361 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.4079 | Train Acc: 0.4388
 Site-Black                    | Train Loss: 1.5740 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.4811 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.3561 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3550 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3455 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4257 | Train Acc: 0.4700
 Site-Southeast_Asian          | Train Loss: 1.4466 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3724 | Train Acc: 0.4628
 Site-Middle_Eastern           | Train Loss: 1.4646 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.3768 | Train Acc: 0.4940
 Site-White                     (3) | Val  Loss: 1.3450 | Val  Acc: 0.4457
 Site-White                     (2) | Val  Loss: 1.3531 | Val  Acc: 0.4748
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4100 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4243 | Val  Acc: 0.4317
 Site-Black                     (0) | Val  Loss: 1.3304 | Val  Acc: 0.5435
 Site-Black                     (4) | Val  Loss: 1.4926 | Val  Acc: 0.4317
 Site-East_Asian                (6) | Val  Loss: 1.2448 | Val  Acc: 0.5217
 Site-East_Asian                (6) | Val  Loss: 1.2938 | Val  Acc: 0.5288
 Site-Indian                    (5) | Val  Loss: 1.4528 | Val  Acc: 0.4348
 Site-Indian                    (5) | Val  Loss: 1.4127 | Val  Acc: 0.4173
 Site-Southeast_Asian           (1) | Val  Loss: 1.3956 | Val  Acc: 0.4783
 Site-Southeast_Asian           (1) | Val  Loss: 1.3626 | Val  Acc: 0.5072
 Site-Middle_Eastern            (2) | Val  Loss: 1.3610 | Val  Acc: 0.5217
 Site-Middle_Eastern            (2) | Val  Loss: 1.3558 | Val  Acc: 0.4748
Average Valid Accuracy: 0.4732
============ Train epoch 29 ============
cnt=[4, 3, 1, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-White                    | Train Loss: 1.4004 | Train Acc: 0.5180
 Site-White                    | Train Loss: 1.2717 | Train Acc: 0.5036
 Site-Latino_Hispanic          | Train Loss: 1.5208 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.3836 | Train Acc: 0.4484
 Site-Black                    | Train Loss: 1.6197 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.4651 | Train Acc: 0.4365
 Site-East_Asian               | Train Loss: 1.3263 | Train Acc: 0.5036
 Site-East_Asian               | Train Loss: 1.4548 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.3233 | Train Acc: 0.5612
 Site-Indian                   | Train Loss: 1.4083 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.5020 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3372 | Train Acc: 0.4868
 Site-Middle_Eastern           | Train Loss: 1.4303 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.3019 | Train Acc: 0.4892
 Site-White                     (3) | Val  Loss: 1.3849 | Val  Acc: 0.4565
 Site-White                     (2) | Val  Loss: 1.3233 | Val  Acc: 0.4712
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4418 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4112 | Val  Acc: 0.4137
 Site-Black                     (1) | Val  Loss: 1.3060 | Val  Acc: 0.5435
 Site-Black                     (5) | Val  Loss: 1.4657 | Val  Acc: 0.4568
 Site-East_Asian                (0) | Val  Loss: 1.2485 | Val  Acc: 0.5870
 Site-East_Asian                (0) | Val  Loss: 1.3077 | Val  Acc: 0.5396
 Site-Indian                    (1) | Val  Loss: 1.5223 | Val  Acc: 0.3587
 Site-Indian                    (1) | Val  Loss: 1.4051 | Val  Acc: 0.4317
 Site-Southeast_Asian           (0) | Val  Loss: 1.4119 | Val  Acc: 0.4891
 Site-Southeast_Asian           (0) | Val  Loss: 1.3555 | Val  Acc: 0.5072
 Site-Middle_Eastern            (4) | Val  Loss: 1.3764 | Val  Acc: 0.4674
 Site-Middle_Eastern            (4) | Val  Loss: 1.3781 | Val  Acc: 0.4604
Average Valid Accuracy: 0.4711
============ Train epoch 30 ============
cnt=[3, 3, 2, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-White                    | Train Loss: 1.3291 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.3038 | Train Acc: 0.5156
 Site-Latino_Hispanic          | Train Loss: 1.5467 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4190 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.6435 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.5247 | Train Acc: 0.4221
 Site-East_Asian               | Train Loss: 1.3532 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2938 | Train Acc: 0.5156
 Site-Indian                   | Train Loss: 1.3718 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.5039 | Train Acc: 0.4436
 Site-Southeast_Asian          | Train Loss: 1.3990 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3591 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.4096 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.3323 | Train Acc: 0.4988
 Site-White                     (5) | Val  Loss: 1.3913 | Val  Acc: 0.4348
 Site-White                     (3) | Val  Loss: 1.3294 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3962 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4163 | Val  Acc: 0.4424
 Site-Black                     (2) | Val  Loss: 1.3093 | Val  Acc: 0.5543
 Site-Black                     (2) | Val  Loss: 1.4809 | Val  Acc: 0.4137
 Site-East_Asian                (6) | Val  Loss: 1.2309 | Val  Acc: 0.5435
 Site-East_Asian                (4) | Val  Loss: 1.3028 | Val  Acc: 0.5216
 Site-Indian                    (0) | Val  Loss: 1.5180 | Val  Acc: 0.3478
 Site-Indian                    (0) | Val  Loss: 1.4073 | Val  Acc: 0.4496
 Site-Southeast_Asian           (1) | Val  Loss: 1.4182 | Val  Acc: 0.4674
 Site-Southeast_Asian           (1) | Val  Loss: 1.3525 | Val  Acc: 0.4964
 Site-Middle_Eastern            (3) | Val  Loss: 1.3618 | Val  Acc: 0.4891
 Site-Middle_Eastern            (3) | Val  Loss: 1.3554 | Val  Acc: 0.4820
Average Valid Accuracy: 0.4706
============ Train epoch 31 ============
cnt=[1, 3, 2, 1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-White                    | Train Loss: 1.3791 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.2590 | Train Acc: 0.4796
 Site-Latino_Hispanic          | Train Loss: 1.5373 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.4679 | Train Acc: 0.4412
 Site-Black                    | Train Loss: 1.6544 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.4234 | Train Acc: 0.4293
 Site-East_Asian               | Train Loss: 1.3719 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3691 | Train Acc: 0.5012
 Site-Indian                   | Train Loss: 1.2876 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.3691 | Train Acc: 0.4365
 Site-Southeast_Asian          | Train Loss: 1.4167 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.4209 | Train Acc: 0.4868
 Site-Middle_Eastern           | Train Loss: 1.4351 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.3307 | Train Acc: 0.5180
 Site-White                     (1) | Val  Loss: 1.3533 | Val  Acc: 0.4891
 Site-White                     (1) | Val  Loss: 1.3299 | Val  Acc: 0.4676
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3982 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4107 | Val  Acc: 0.4137
 Site-Black                     (6) | Val  Loss: 1.2862 | Val  Acc: 0.5435
 Site-Black                     (0) | Val  Loss: 1.4634 | Val  Acc: 0.4388
 Site-East_Asian                (4) | Val  Loss: 1.2564 | Val  Acc: 0.5543
 Site-East_Asian                (4) | Val  Loss: 1.3047 | Val  Acc: 0.5216
 Site-Indian                    (2) | Val  Loss: 1.4500 | Val  Acc: 0.4022
 Site-Indian                    (2) | Val  Loss: 1.3878 | Val  Acc: 0.4640
 Site-Southeast_Asian           (4) | Val  Loss: 1.3550 | Val  Acc: 0.5109
 Site-Southeast_Asian           (4) | Val  Loss: 1.3681 | Val  Acc: 0.5036
 Site-Middle_Eastern            (5) | Val  Loss: 1.3596 | Val  Acc: 0.4891
 Site-Middle_Eastern            (5) | Val  Loss: 1.3603 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4810
 Best site-White                    (1)  | Epoch:31 | Val Acc: 0.4891
 Best site-White                    (1)  | Epoch:31 | Val Acc: 0.4676
 Best site-Latino_Hispanic          (1)  | Epoch:31 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (3)  | Epoch:31 | Val Acc: 0.4137
 Best site-Black                    (6)  | Epoch:31 | Val Acc: 0.5435
 Best site-Black                    (0)  | Epoch:31 | Val Acc: 0.4388
 Best site-East_Asian               (4)  | Epoch:31 | Val Acc: 0.5543
 Best site-East_Asian               (4)  | Epoch:31 | Val Acc: 0.5216
 Best site-Indian                   (2)  | Epoch:31 | Val Acc: 0.4022
 Best site-Indian                   (2)  | Epoch:31 | Val Acc: 0.4640
 Best site-Southeast_Asian          (4)  | Epoch:31 | Val Acc: 0.5109
 Best site-Southeast_Asian          (4)  | Epoch:31 | Val Acc: 0.5036
 Best site-Middle_Eastern           (5)  | Epoch:31 | Val Acc: 0.4891
 Best site-Middle_Eastern           (5)  | Epoch:31 | Val Acc: 0.4784
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 32 ============
cnt=[3, 2, 1, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-White                    | Train Loss: 1.3891 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.2633 | Train Acc: 0.4964
 Site-Latino_Hispanic          | Train Loss: 1.5288 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.3100 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.5910 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4841 | Train Acc: 0.4077
 Site-East_Asian               | Train Loss: 1.3702 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3124 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3350 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.4047 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4736 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.3743 | Train Acc: 0.4796
 Site-Middle_Eastern           | Train Loss: 1.3742 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3533 | Train Acc: 0.4940
 Site-White                     (4) | Val  Loss: 1.3457 | Val  Acc: 0.4565
 Site-White                     (0) | Val  Loss: 1.3164 | Val  Acc: 0.4820
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4559 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4244 | Val  Acc: 0.4209
 Site-Black                     (6) | Val  Loss: 1.3033 | Val  Acc: 0.5217
 Site-Black                     (2) | Val  Loss: 1.4698 | Val  Acc: 0.4173
 Site-East_Asian                (3) | Val  Loss: 1.1943 | Val  Acc: 0.5652
 Site-East_Asian                (3) | Val  Loss: 1.3041 | Val  Acc: 0.5144
 Site-Indian                    (5) | Val  Loss: 1.4939 | Val  Acc: 0.3804
 Site-Indian                    (5) | Val  Loss: 1.4241 | Val  Acc: 0.4568
 Site-Southeast_Asian           (3) | Val  Loss: 1.4089 | Val  Acc: 0.4022
 Site-Southeast_Asian           (3) | Val  Loss: 1.3451 | Val  Acc: 0.5072
 Site-Middle_Eastern            (0) | Val  Loss: 1.3707 | Val  Acc: 0.5109
 Site-Middle_Eastern            (0) | Val  Loss: 1.3425 | Val  Acc: 0.4676
Average Valid Accuracy: 0.4647
============ Train epoch 33 ============
cnt=[1, 2, 4, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-White                    | Train Loss: 1.4247 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.3823 | Train Acc: 0.5132
 Site-Latino_Hispanic          | Train Loss: 1.5656 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.4096 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.5783 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.4375 | Train Acc: 0.4197
 Site-East_Asian               | Train Loss: 1.3594 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.4099 | Train Acc: 0.5276
 Site-Indian                   | Train Loss: 1.2975 | Train Acc: 0.5036
 Site-Indian                   | Train Loss: 1.3706 | Train Acc: 0.4628
 Site-Southeast_Asian          | Train Loss: 1.4154 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.3903 | Train Acc: 0.4796
 Site-Middle_Eastern           | Train Loss: 1.3454 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3307 | Train Acc: 0.5012
 Site-White                     (1) | Val  Loss: 1.3398 | Val  Acc: 0.4783
 Site-White                     (1) | Val  Loss: 1.3327 | Val  Acc: 0.4820
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3851 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4114 | Val  Acc: 0.4353
 Site-Black                     (6) | Val  Loss: 1.2771 | Val  Acc: 0.6196
 Site-Black                     (0) | Val  Loss: 1.4639 | Val  Acc: 0.4388
 Site-East_Asian                (5) | Val  Loss: 1.1970 | Val  Acc: 0.5326
 Site-East_Asian                (5) | Val  Loss: 1.2827 | Val  Acc: 0.5216
 Site-Indian                    (2) | Val  Loss: 1.4601 | Val  Acc: 0.3913
 Site-Indian                    (2) | Val  Loss: 1.4140 | Val  Acc: 0.4317
 Site-Southeast_Asian           (2) | Val  Loss: 1.3973 | Val  Acc: 0.4891
 Site-Southeast_Asian           (2) | Val  Loss: 1.3750 | Val  Acc: 0.4568
 Site-Middle_Eastern            (3) | Val  Loss: 1.3432 | Val  Acc: 0.4783
 Site-Middle_Eastern            (3) | Val  Loss: 1.3418 | Val  Acc: 0.4892
Average Valid Accuracy: 0.4763
============ Train epoch 34 ============
cnt=[4, 3, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-White                    | Train Loss: 1.3257 | Train Acc: 0.5036
 Site-White                    | Train Loss: 1.2871 | Train Acc: 0.5036
 Site-Latino_Hispanic          | Train Loss: 1.4647 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.3243 | Train Acc: 0.4317
 Site-Black                    | Train Loss: 1.5752 | Train Acc: 0.4245
 Site-Black                    | Train Loss: 1.5971 | Train Acc: 0.4053
 Site-East_Asian               | Train Loss: 1.3443 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.2394 | Train Acc: 0.5300
 Site-Indian                   | Train Loss: 1.3802 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.3667 | Train Acc: 0.4508
 Site-Southeast_Asian          | Train Loss: 1.4145 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.3499 | Train Acc: 0.4844
 Site-Middle_Eastern           | Train Loss: 1.3938 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.2284 | Train Acc: 0.5036
 Site-White                     (2) | Val  Loss: 1.3478 | Val  Acc: 0.4565
 Site-White                     (2) | Val  Loss: 1.3061 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4351 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4101 | Val  Acc: 0.4245
 Site-Black                     (3) | Val  Loss: 1.2992 | Val  Acc: 0.5435
 Site-Black                     (5) | Val  Loss: 1.4622 | Val  Acc: 0.4748
 Site-East_Asian                (0) | Val  Loss: 1.1958 | Val  Acc: 0.5870
 Site-East_Asian                (0) | Val  Loss: 1.2838 | Val  Acc: 0.5468
 Site-Indian                    (1) | Val  Loss: 1.4470 | Val  Acc: 0.4239
 Site-Indian                    (1) | Val  Loss: 1.3806 | Val  Acc: 0.4424
 Site-Southeast_Asian           (0) | Val  Loss: 1.4248 | Val  Acc: 0.4239
 Site-Southeast_Asian           (0) | Val  Loss: 1.3483 | Val  Acc: 0.4820
 Site-Middle_Eastern            (4) | Val  Loss: 1.3497 | Val  Acc: 0.5217
 Site-Middle_Eastern            (4) | Val  Loss: 1.3423 | Val  Acc: 0.4532
Average Valid Accuracy: 0.4797
============ Train epoch 35 ============
cnt=[2, 2, 2, 2, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-White                    | Train Loss: 1.3873 | Train Acc: 0.5036
 Site-White                    | Train Loss: 1.3565 | Train Acc: 0.5060
 Site-Latino_Hispanic          | Train Loss: 1.5877 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.4566 | Train Acc: 0.4269
 Site-Black                    | Train Loss: 1.6223 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.4403 | Train Acc: 0.4484
 Site-East_Asian               | Train Loss: 1.3577 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3592 | Train Acc: 0.5060
 Site-Indian                   | Train Loss: 1.2847 | Train Acc: 0.5540
 Site-Indian                   | Train Loss: 1.3388 | Train Acc: 0.4484
 Site-Southeast_Asian          | Train Loss: 1.5223 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.5258 | Train Acc: 0.4724
 Site-Middle_Eastern           | Train Loss: 1.3446 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.2280 | Train Acc: 0.5012
 Site-White                     (6) | Val  Loss: 1.3196 | Val  Acc: 0.4457
 Site-White                     (6) | Val  Loss: 1.3183 | Val  Acc: 0.4928
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3892 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4058 | Val  Acc: 0.4209
 Site-Black                     (4) | Val  Loss: 1.2701 | Val  Acc: 0.5978
 Site-Black                     (5) | Val  Loss: 1.4196 | Val  Acc: 0.4532
 Site-East_Asian                (0) | Val  Loss: 1.2464 | Val  Acc: 0.5217
 Site-East_Asian                (0) | Val  Loss: 1.2764 | Val  Acc: 0.5324
 Site-Indian                    (1) | Val  Loss: 1.4251 | Val  Acc: 0.3913
 Site-Indian                    (1) | Val  Loss: 1.3614 | Val  Acc: 0.4748
 Site-Southeast_Asian           (3) | Val  Loss: 1.3856 | Val  Acc: 0.4674
 Site-Southeast_Asian           (3) | Val  Loss: 1.3503 | Val  Acc: 0.4676
 Site-Middle_Eastern            (2) | Val  Loss: 1.3532 | Val  Acc: 0.4674
 Site-Middle_Eastern            (2) | Val  Loss: 1.3348 | Val  Acc: 0.4820
Average Valid Accuracy: 0.4773
============ Train epoch 36 ============
cnt=[2, 1, 2, 2, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-White                    | Train Loss: 1.3047 | Train Acc: 0.5324
 Site-White                    | Train Loss: 1.2916 | Train Acc: 0.5036
 Site-Latino_Hispanic          | Train Loss: 1.5285 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.3458 | Train Acc: 0.4365
 Site-Black                    | Train Loss: 1.6186 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.5671 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.3941 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3936 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.2768 | Train Acc: 0.5468
 Site-Indian                   | Train Loss: 1.3229 | Train Acc: 0.4796
 Site-Southeast_Asian          | Train Loss: 1.3622 | Train Acc: 0.5036
 Site-Southeast_Asian          | Train Loss: 1.3615 | Train Acc: 0.5180
 Site-Middle_Eastern           | Train Loss: 1.3321 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3046 | Train Acc: 0.4940
 Site-White                     (4) | Val  Loss: 1.3396 | Val  Acc: 0.4348
 Site-White                     (4) | Val  Loss: 1.3063 | Val  Acc: 0.4856
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4257 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4022 | Val  Acc: 0.4460
 Site-Black                     (2) | Val  Loss: 1.3595 | Val  Acc: 0.5217
 Site-Black                     (2) | Val  Loss: 1.4524 | Val  Acc: 0.4317
 Site-East_Asian                (5) | Val  Loss: 1.2110 | Val  Acc: 0.5761
 Site-East_Asian                (6) | Val  Loss: 1.2856 | Val  Acc: 0.5108
 Site-Indian                    (3) | Val  Loss: 1.4354 | Val  Acc: 0.4783
 Site-Indian                    (3) | Val  Loss: 1.3698 | Val  Acc: 0.4712
 Site-Southeast_Asian           (1) | Val  Loss: 1.3694 | Val  Acc: 0.4783
 Site-Southeast_Asian           (5) | Val  Loss: 1.3134 | Val  Acc: 0.4892
 Site-Middle_Eastern            (0) | Val  Loss: 1.3666 | Val  Acc: 0.4674
 Site-Middle_Eastern            (0) | Val  Loss: 1.3320 | Val  Acc: 0.5144
Average Valid Accuracy: 0.4822
 Best site-White                    (4)  | Epoch:36 | Val Acc: 0.4348
 Best site-White                    (4)  | Epoch:36 | Val Acc: 0.4856
 Best site-Latino_Hispanic          (4)  | Epoch:36 | Val Acc: 0.4457
 Best site-Latino_Hispanic          (5)  | Epoch:36 | Val Acc: 0.4460
 Best site-Black                    (2)  | Epoch:36 | Val Acc: 0.5217
 Best site-Black                    (2)  | Epoch:36 | Val Acc: 0.4317
 Best site-East_Asian               (5)  | Epoch:36 | Val Acc: 0.5761
 Best site-East_Asian               (6)  | Epoch:36 | Val Acc: 0.5108
 Best site-Indian                   (3)  | Epoch:36 | Val Acc: 0.4783
 Best site-Indian                   (3)  | Epoch:36 | Val Acc: 0.4712
 Best site-Southeast_Asian          (1)  | Epoch:36 | Val Acc: 0.4783
 Best site-Southeast_Asian          (5)  | Epoch:36 | Val Acc: 0.4892
 Best site-Middle_Eastern           (0)  | Epoch:36 | Val Acc: 0.4674
 Best site-Middle_Eastern           (0)  | Epoch:36 | Val Acc: 0.5144
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 37 ============
cnt=[1, 4, 4, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-White                    | Train Loss: 1.3697 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.3011 | Train Acc: 0.4772
 Site-Latino_Hispanic          | Train Loss: 1.5943 | Train Acc: 0.4748
 Site-Latino_Hispanic          | Train Loss: 1.4594 | Train Acc: 0.4604
 Site-Black                    | Train Loss: 1.6099 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.4523 | Train Acc: 0.4221
 Site-East_Asian               | Train Loss: 1.4238 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2677 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.2942 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.4070 | Train Acc: 0.4436
 Site-Southeast_Asian          | Train Loss: 1.4275 | Train Acc: 0.4101
 Site-Southeast_Asian          | Train Loss: 1.3739 | Train Acc: 0.5132
 Site-Middle_Eastern           | Train Loss: 1.4107 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.2948 | Train Acc: 0.5180
 Site-White                     (6) | Val  Loss: 1.2960 | Val  Acc: 0.4783
 Site-White                     (5) | Val  Loss: 1.3062 | Val  Acc: 0.5144
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3367 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3938 | Val  Acc: 0.4317
 Site-Black                     (2) | Val  Loss: 1.3053 | Val  Acc: 0.5435
 Site-Black                     (3) | Val  Loss: 1.4641 | Val  Acc: 0.4281
 Site-East_Asian                (1) | Val  Loss: 1.2440 | Val  Acc: 0.5543
 Site-East_Asian                (1) | Val  Loss: 1.2770 | Val  Acc: 0.5576
 Site-Indian                    (2) | Val  Loss: 1.4161 | Val  Acc: 0.4348
 Site-Indian                    (2) | Val  Loss: 1.3665 | Val  Acc: 0.4748
 Site-Southeast_Asian           (1) | Val  Loss: 1.3115 | Val  Acc: 0.5326
 Site-Southeast_Asian           (1) | Val  Loss: 1.3345 | Val  Acc: 0.4892
 Site-Middle_Eastern            (4) | Val  Loss: 1.3654 | Val  Acc: 0.4565
 Site-Middle_Eastern            (4) | Val  Loss: 1.3280 | Val  Acc: 0.4856
Average Valid Accuracy: 0.4892
 Best site-White                    (6)  | Epoch:37 | Val Acc: 0.4783
 Best site-White                    (5)  | Epoch:37 | Val Acc: 0.5144
 Best site-Latino_Hispanic          (2)  | Epoch:37 | Val Acc: 0.4674
 Best site-Latino_Hispanic          (0)  | Epoch:37 | Val Acc: 0.4317
 Best site-Black                    (2)  | Epoch:37 | Val Acc: 0.5435
 Best site-Black                    (3)  | Epoch:37 | Val Acc: 0.4281
 Best site-East_Asian               (1)  | Epoch:37 | Val Acc: 0.5543
 Best site-East_Asian               (1)  | Epoch:37 | Val Acc: 0.5576
 Best site-Indian                   (2)  | Epoch:37 | Val Acc: 0.4348
 Best site-Indian                   (2)  | Epoch:37 | Val Acc: 0.4748
 Best site-Southeast_Asian          (1)  | Epoch:37 | Val Acc: 0.5326
 Best site-Southeast_Asian          (1)  | Epoch:37 | Val Acc: 0.4892
 Best site-Middle_Eastern           (4)  | Epoch:37 | Val Acc: 0.4565
 Best site-Middle_Eastern           (4)  | Epoch:37 | Val Acc: 0.4856
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 38 ============
cnt=[3, 1, 3, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-White                    | Train Loss: 1.3220 | Train Acc: 0.5180
 Site-White                    | Train Loss: 1.2711 | Train Acc: 0.4964
 Site-Latino_Hispanic          | Train Loss: 1.5140 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3781 | Train Acc: 0.4556
 Site-Black                    | Train Loss: 1.5945 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.4121 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3614 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.4102 | Train Acc: 0.5156
 Site-Indian                   | Train Loss: 1.3429 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.5041 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.4101 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.3202 | Train Acc: 0.4868
 Site-Middle_Eastern           | Train Loss: 1.3399 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.3964 | Train Acc: 0.5348
 Site-White                     (4) | Val  Loss: 1.3358 | Val  Acc: 0.4891
 Site-White                     (3) | Val  Loss: 1.3027 | Val  Acc: 0.5072
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3983 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3846 | Val  Acc: 0.4245
 Site-Black                     (6) | Val  Loss: 1.2371 | Val  Acc: 0.5870
 Site-Black                     (1) | Val  Loss: 1.3939 | Val  Acc: 0.4748
 Site-East_Asian                (0) | Val  Loss: 1.2148 | Val  Acc: 0.5326
 Site-East_Asian                (0) | Val  Loss: 1.2927 | Val  Acc: 0.5144
 Site-Indian                    (5) | Val  Loss: 1.4644 | Val  Acc: 0.4130
 Site-Indian                    (5) | Val  Loss: 1.3753 | Val  Acc: 0.4424
 Site-Southeast_Asian           (0) | Val  Loss: 1.3566 | Val  Acc: 0.4891
 Site-Southeast_Asian           (2) | Val  Loss: 1.3248 | Val  Acc: 0.4928
 Site-Middle_Eastern            (4) | Val  Loss: 1.3619 | Val  Acc: 0.4565
 Site-Middle_Eastern            (4) | Val  Loss: 1.3398 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4843
============ Train epoch 39 ============
cnt=[2, 3, 4, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-White                    | Train Loss: 1.3561 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.2751 | Train Acc: 0.4988
 Site-Latino_Hispanic          | Train Loss: 1.4577 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.3561 | Train Acc: 0.4293
 Site-Black                    | Train Loss: 1.6555 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4470 | Train Acc: 0.4436
 Site-East_Asian               | Train Loss: 1.2758 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3394 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3000 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3766 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3678 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.3480 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.4772 | Train Acc: 0.4101
 Site-Middle_Eastern           | Train Loss: 1.2222 | Train Acc: 0.4916
 Site-White                     (3) | Val  Loss: 1.2912 | Val  Acc: 0.5435
 Site-White                     (1) | Val  Loss: 1.2956 | Val  Acc: 0.5324
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3912 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4026 | Val  Acc: 0.4496
 Site-Black                     (2) | Val  Loss: 1.2764 | Val  Acc: 0.5435
 Site-Black                     (2) | Val  Loss: 1.4507 | Val  Acc: 0.4532
 Site-East_Asian                (0) | Val  Loss: 1.1719 | Val  Acc: 0.5326
 Site-East_Asian                (0) | Val  Loss: 1.2349 | Val  Acc: 0.5504
 Site-Indian                    (2) | Val  Loss: 1.4200 | Val  Acc: 0.3587
 Site-Indian                    (2) | Val  Loss: 1.3932 | Val  Acc: 0.4496
 Site-Southeast_Asian           (5) | Val  Loss: 1.3085 | Val  Acc: 0.5217
 Site-Southeast_Asian           (5) | Val  Loss: 1.3349 | Val  Acc: 0.4964
 Site-Middle_Eastern            (1) | Val  Loss: 1.3095 | Val  Acc: 0.5000
 Site-Middle_Eastern            (1) | Val  Loss: 1.3522 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4936
 Best site-White                    (3)  | Epoch:39 | Val Acc: 0.5435
 Best site-White                    (1)  | Epoch:39 | Val Acc: 0.5324
 Best site-Latino_Hispanic          (4)  | Epoch:39 | Val Acc: 0.5000
 Best site-Latino_Hispanic          (6)  | Epoch:39 | Val Acc: 0.4496
 Best site-Black                    (2)  | Epoch:39 | Val Acc: 0.5435
 Best site-Black                    (2)  | Epoch:39 | Val Acc: 0.4532
 Best site-East_Asian               (0)  | Epoch:39 | Val Acc: 0.5326
 Best site-East_Asian               (0)  | Epoch:39 | Val Acc: 0.5504
 Best site-Indian                   (2)  | Epoch:39 | Val Acc: 0.3587
 Best site-Indian                   (2)  | Epoch:39 | Val Acc: 0.4496
 Best site-Southeast_Asian          (5)  | Epoch:39 | Val Acc: 0.5217
 Best site-Southeast_Asian          (5)  | Epoch:39 | Val Acc: 0.4964
 Best site-Middle_Eastern           (1)  | Epoch:39 | Val Acc: 0.5000
 Best site-Middle_Eastern           (1)  | Epoch:39 | Val Acc: 0.4784
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
 Test site-White                     (3)| Epoch:39 | Test Acc: 0.4385
 Test site-Latino_Hispanic           (4)| Epoch:39 | Test Acc: 0.3481
 Test site-Black                     (2)| Epoch:39 | Test Acc: 0.3750
 Test site-East_Asian                (0)| Epoch:39 | Test Acc: 0.5097
 Test site-Indian                    (2)| Epoch:39 | Test Acc: 0.3421
 Test site-Southeast_Asian           (5)| Epoch:39 | Test Acc: 0.4556
 Test site-Middle_Eastern            (1)| Epoch:39 | Test Acc: 0.4201
White: 0.4385, Latino_Hispanic: 0.3481, Black: 0.3750, East_Asian: 0.5097, Indian: 0.3421, Southeast_Asian: 0.4556, Middle_Eastern: 0.4201, 
Average Test Accuracy: 0.4127, domain std=0.0568, cluster std=nan, individual std=0.0568, 
============ Train epoch 40 ============
cnt=[1, 3, 3, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-White                    | Train Loss: 1.2891 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.3159 | Train Acc: 0.5132
 Site-Latino_Hispanic          | Train Loss: 1.4922 | Train Acc: 0.4748
 Site-Latino_Hispanic          | Train Loss: 1.3645 | Train Acc: 0.4388
 Site-Black                    | Train Loss: 1.6200 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.4689 | Train Acc: 0.4700
 Site-East_Asian               | Train Loss: 1.3137 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2912 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.2316 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3238 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.4420 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.3884 | Train Acc: 0.4628
 Site-Middle_Eastern           | Train Loss: 1.3514 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.1654 | Train Acc: 0.5108
 Site-White                     (1) | Val  Loss: 1.2854 | Val  Acc: 0.5435
 Site-White                     (1) | Val  Loss: 1.2889 | Val  Acc: 0.5396
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3463 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3849 | Val  Acc: 0.4317
 Site-Black                     (0) | Val  Loss: 1.2735 | Val  Acc: 0.5761
 Site-Black                     (5) | Val  Loss: 1.4105 | Val  Acc: 0.4856
 Site-East_Asian                (3) | Val  Loss: 1.1615 | Val  Acc: 0.5761
 Site-East_Asian                (3) | Val  Loss: 1.2512 | Val  Acc: 0.5216
 Site-Indian                    (6) | Val  Loss: 1.3664 | Val  Acc: 0.4565
 Site-Indian                    (6) | Val  Loss: 1.3757 | Val  Acc: 0.4317
 Site-Southeast_Asian           (2) | Val  Loss: 1.3510 | Val  Acc: 0.4783
 Site-Southeast_Asian           (2) | Val  Loss: 1.3290 | Val  Acc: 0.4964
 Site-Middle_Eastern            (4) | Val  Loss: 1.3324 | Val  Acc: 0.5000
 Site-Middle_Eastern            (4) | Val  Loss: 1.3292 | Val  Acc: 0.4856
Average Valid Accuracy: 0.4970
 Best site-White                    (1)  | Epoch:40 | Val Acc: 0.5435
 Best site-White                    (1)  | Epoch:40 | Val Acc: 0.5396
 Best site-Latino_Hispanic          (2)  | Epoch:40 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (1)  | Epoch:40 | Val Acc: 0.4317
 Best site-Black                    (0)  | Epoch:40 | Val Acc: 0.5761
 Best site-Black                    (5)  | Epoch:40 | Val Acc: 0.4856
 Best site-East_Asian               (3)  | Epoch:40 | Val Acc: 0.5761
 Best site-East_Asian               (3)  | Epoch:40 | Val Acc: 0.5216
 Best site-Indian                   (6)  | Epoch:40 | Val Acc: 0.4565
 Best site-Indian                   (6)  | Epoch:40 | Val Acc: 0.4317
 Best site-Southeast_Asian          (2)  | Epoch:40 | Val Acc: 0.4783
 Best site-Southeast_Asian          (2)  | Epoch:40 | Val Acc: 0.4964
 Best site-Middle_Eastern           (4)  | Epoch:40 | Val Acc: 0.5000
 Best site-Middle_Eastern           (4)  | Epoch:40 | Val Acc: 0.4856
 Test site-White                     (1)| Epoch:40 | Test Acc: 0.4171
 Test site-Latino_Hispanic           (2)| Epoch:40 | Test Acc: 0.3544
 Test site-Black                     (0)| Epoch:40 | Test Acc: 0.3531
 Test site-East_Asian                (3)| Epoch:40 | Test Acc: 0.5032
 Test site-Indian                    (6)| Epoch:40 | Test Acc: 0.3565
 Test site-Southeast_Asian           (2)| Epoch:40 | Test Acc: 0.4593
 Test site-Middle_Eastern            (4)| Epoch:40 | Test Acc: 0.4021
White: 0.4171, Latino_Hispanic: 0.3544, Black: 0.3531, East_Asian: 0.5032, Indian: 0.3565, Southeast_Asian: 0.4593, Middle_Eastern: 0.4021, 
Average Test Accuracy: 0.4065, domain std=0.0539, cluster std=nan, individual std=0.0539, 
Average Test Accuracy: 0.4065
============ Train epoch 41 ============
cnt=[4, 1, 3, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-White                    | Train Loss: 1.3652 | Train Acc: 0.5108
 Site-White                    | Train Loss: 1.2336 | Train Acc: 0.5084
 Site-Latino_Hispanic          | Train Loss: 1.5409 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.3600 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.6159 | Train Acc: 0.4245
 Site-Black                    | Train Loss: 1.4738 | Train Acc: 0.4556
 Site-East_Asian               | Train Loss: 1.3159 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.3037 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3040 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3420 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3744 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.2755 | Train Acc: 0.4940
 Site-Middle_Eastern           | Train Loss: 1.3883 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.2865 | Train Acc: 0.5036
 Site-White                     (0) | Val  Loss: 1.3053 | Val  Acc: 0.4891
 Site-White                     (2) | Val  Loss: 1.2750 | Val  Acc: 0.5252
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3697 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3884 | Val  Acc: 0.4604
 Site-Black                     (1) | Val  Loss: 1.2810 | Val  Acc: 0.5978
 Site-Black                     (6) | Val  Loss: 1.4274 | Val  Acc: 0.4784
 Site-East_Asian                (4) | Val  Loss: 1.1750 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.2520 | Val  Acc: 0.5252
 Site-Indian                    (3) | Val  Loss: 1.3915 | Val  Acc: 0.4457
 Site-Indian                    (5) | Val  Loss: 1.3931 | Val  Acc: 0.4496
 Site-Southeast_Asian           (4) | Val  Loss: 1.3264 | Val  Acc: 0.4457
 Site-Southeast_Asian           (4) | Val  Loss: 1.3183 | Val  Acc: 0.5144
 Site-Middle_Eastern            (2) | Val  Loss: 1.3507 | Val  Acc: 0.5109
 Site-Middle_Eastern            (2) | Val  Loss: 1.3365 | Val  Acc: 0.4964
Average Valid Accuracy: 0.4949
 Test site-White                     (0)| Epoch:40 | Test Acc: 0.4251
 Test site-Latino_Hispanic           (0)| Epoch:40 | Test Acc: 0.3639
 Test site-Black                     (1)| Epoch:40 | Test Acc: 0.3563
 Test site-East_Asian                (4)| Epoch:40 | Test Acc: 0.5162
 Test site-Indian                    (3)| Epoch:40 | Test Acc: 0.3397
 Test site-Southeast_Asian           (4)| Epoch:40 | Test Acc: 0.4667
 Test site-Middle_Eastern            (2)| Epoch:40 | Test Acc: 0.3995
White: 0.4251, Latino_Hispanic: 0.3639, Black: 0.3563, East_Asian: 0.5162, Indian: 0.3397, Southeast_Asian: 0.4667, Middle_Eastern: 0.3995, 
Average Test Accuracy: 0.4096, domain std=0.0595, cluster std=nan, individual std=0.0595, 
Average Test Accuracy: 0.4096
============ Train epoch 42 ============
cnt=[3, 3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-White                    | Train Loss: 1.3049 | Train Acc: 0.5108
 Site-White                    | Train Loss: 1.2314 | Train Acc: 0.5084
 Site-Latino_Hispanic          | Train Loss: 1.5322 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.3303 | Train Acc: 0.4484
 Site-Black                    | Train Loss: 1.5874 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.4370 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3443 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3441 | Train Acc: 0.5204
 Site-Indian                   | Train Loss: 1.3374 | Train Acc: 0.4532
 Site-Indian                   | Train Loss: 1.3939 | Train Acc: 0.4652
 Site-Southeast_Asian          | Train Loss: 1.4499 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.3952 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3637 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.2675 | Train Acc: 0.4940
 Site-White                     (1) | Val  Loss: 1.3152 | Val  Acc: 0.5435
 Site-White                     (6) | Val  Loss: 1.2900 | Val  Acc: 0.4928
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4310 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3638 | Val  Acc: 0.4460
 Site-Black                     (4) | Val  Loss: 1.2926 | Val  Acc: 0.5761
 Site-Black                     (2) | Val  Loss: 1.4054 | Val  Acc: 0.4568
 Site-East_Asian                (0) | Val  Loss: 1.1989 | Val  Acc: 0.5000
 Site-East_Asian                (5) | Val  Loss: 1.2299 | Val  Acc: 0.5540
 Site-Indian                    (4) | Val  Loss: 1.4313 | Val  Acc: 0.4130
 Site-Indian                    (4) | Val  Loss: 1.3613 | Val  Acc: 0.4424
 Site-Southeast_Asian           (0) | Val  Loss: 1.3283 | Val  Acc: 0.4783
 Site-Southeast_Asian           (0) | Val  Loss: 1.3120 | Val  Acc: 0.4820
 Site-Middle_Eastern            (1) | Val  Loss: 1.3952 | Val  Acc: 0.4565
 Site-Middle_Eastern            (1) | Val  Loss: 1.3104 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4863
 Test site-White                     (1)| Epoch:40 | Test Acc: 0.4305
 Test site-Latino_Hispanic           (3)| Epoch:40 | Test Acc: 0.3671
 Test site-Black                     (4)| Epoch:40 | Test Acc: 0.3406
 Test site-East_Asian                (0)| Epoch:40 | Test Acc: 0.5162
 Test site-Indian                    (4)| Epoch:40 | Test Acc: 0.3565
 Test site-Southeast_Asian           (0)| Epoch:40 | Test Acc: 0.4667
 Test site-Middle_Eastern            (1)| Epoch:40 | Test Acc: 0.4072
White: 0.4305, Latino_Hispanic: 0.3671, Black: 0.3406, East_Asian: 0.5162, Indian: 0.3565, Southeast_Asian: 0.4667, Middle_Eastern: 0.4072, 
Average Test Accuracy: 0.4121, domain std=0.0591, cluster std=nan, individual std=0.0591, 
Average Test Accuracy: 0.4121
============ Train epoch 43 ============
cnt=[2, 2, 2, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-White                    | Train Loss: 1.3611 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.3234 | Train Acc: 0.5348
 Site-Latino_Hispanic          | Train Loss: 1.4486 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.4056 | Train Acc: 0.4508
 Site-Black                    | Train Loss: 1.5741 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.4579 | Train Acc: 0.4269
 Site-East_Asian               | Train Loss: 1.3340 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2515 | Train Acc: 0.5156
 Site-Indian                   | Train Loss: 1.3585 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.3285 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.4565 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3683 | Train Acc: 0.4988
 Site-Middle_Eastern           | Train Loss: 1.4325 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.1973 | Train Acc: 0.5132
 Site-White                     (5) | Val  Loss: 1.2750 | Val  Acc: 0.5435
 Site-White                     (5) | Val  Loss: 1.2849 | Val  Acc: 0.5396
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4467 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3703 | Val  Acc: 0.4676
 Site-Black                     (2) | Val  Loss: 1.2926 | Val  Acc: 0.5435
 Site-Black                     (2) | Val  Loss: 1.4339 | Val  Acc: 0.4568
 Site-East_Asian                (4) | Val  Loss: 1.1358 | Val  Acc: 0.5870
 Site-East_Asian                (4) | Val  Loss: 1.2368 | Val  Acc: 0.5647
 Site-Indian                    (3) | Val  Loss: 1.3674 | Val  Acc: 0.3913
 Site-Indian                    (3) | Val  Loss: 1.3531 | Val  Acc: 0.4676
 Site-Southeast_Asian           (1) | Val  Loss: 1.3223 | Val  Acc: 0.5109
 Site-Southeast_Asian           (1) | Val  Loss: 1.3183 | Val  Acc: 0.5252
 Site-Middle_Eastern            (0) | Val  Loss: 1.3305 | Val  Acc: 0.5109
 Site-Middle_Eastern            (0) | Val  Loss: 1.3043 | Val  Acc: 0.5108
Average Valid Accuracy: 0.5046
 Best site-White                    (5)  | Epoch:43 | Val Acc: 0.5435
 Best site-White                    (5)  | Epoch:43 | Val Acc: 0.5396
 Best site-Latino_Hispanic          (6)  | Epoch:43 | Val Acc: 0.4457
 Best site-Latino_Hispanic          (3)  | Epoch:43 | Val Acc: 0.4676
 Best site-Black                    (2)  | Epoch:43 | Val Acc: 0.5435
 Best site-Black                    (2)  | Epoch:43 | Val Acc: 0.4568
 Best site-East_Asian               (4)  | Epoch:43 | Val Acc: 0.5870
 Best site-East_Asian               (4)  | Epoch:43 | Val Acc: 0.5647
 Best site-Indian                   (3)  | Epoch:43 | Val Acc: 0.3913
 Best site-Indian                   (3)  | Epoch:43 | Val Acc: 0.4676
 Best site-Southeast_Asian          (1)  | Epoch:43 | Val Acc: 0.5109
 Best site-Southeast_Asian          (1)  | Epoch:43 | Val Acc: 0.5252
 Best site-Middle_Eastern           (0)  | Epoch:43 | Val Acc: 0.5109
 Best site-Middle_Eastern           (0)  | Epoch:43 | Val Acc: 0.5108
 Test site-White                     (5)| Epoch:43 | Test Acc: 0.4278
 Test site-Latino_Hispanic           (6)| Epoch:43 | Test Acc: 0.3418
 Test site-Black                     (2)| Epoch:43 | Test Acc: 0.3312
 Test site-East_Asian                (4)| Epoch:43 | Test Acc: 0.5065
 Test site-Indian                    (3)| Epoch:43 | Test Acc: 0.3517
 Test site-Southeast_Asian           (1)| Epoch:43 | Test Acc: 0.4704
 Test site-Middle_Eastern            (0)| Epoch:43 | Test Acc: 0.4175
White: 0.4278, Latino_Hispanic: 0.3418, Black: 0.3312, East_Asian: 0.5065, Indian: 0.3517, Southeast_Asian: 0.4704, Middle_Eastern: 0.4175, 
Average Test Accuracy: 0.4067, domain std=0.0627, cluster std=0.0627, individual std=0.0627, 
Average Test Accuracy: 0.4067
============ Train epoch 44 ============
cnt=[2, 3, 1, 4, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-White                    | Train Loss: 1.3354 | Train Acc: 0.5324
 Site-White                    | Train Loss: 1.2335 | Train Acc: 0.4988
 Site-Latino_Hispanic          | Train Loss: 1.5477 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.3500 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.5722 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.4011 | Train Acc: 0.4652
 Site-East_Asian               | Train Loss: 1.4424 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.2664 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.2734 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.3663 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.3949 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.3965 | Train Acc: 0.5108
 Site-Middle_Eastern           | Train Loss: 1.2869 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3015 | Train Acc: 0.5228
 Site-White                     (3) | Val  Loss: 1.3164 | Val  Acc: 0.4783
 Site-White                     (2) | Val  Loss: 1.2647 | Val  Acc: 0.5324
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3766 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3791 | Val  Acc: 0.4496
 Site-Black                     (1) | Val  Loss: 1.2510 | Val  Acc: 0.5326
 Site-Black                     (5) | Val  Loss: 1.3596 | Val  Acc: 0.4928
 Site-East_Asian                (4) | Val  Loss: 1.1889 | Val  Acc: 0.5326
 Site-East_Asian                (3) | Val  Loss: 1.2314 | Val  Acc: 0.5540
 Site-Indian                    (1) | Val  Loss: 1.4071 | Val  Acc: 0.4348
 Site-Indian                    (1) | Val  Loss: 1.3659 | Val  Acc: 0.4281
 Site-Southeast_Asian           (0) | Val  Loss: 1.3283 | Val  Acc: 0.4783
 Site-Southeast_Asian           (0) | Val  Loss: 1.3187 | Val  Acc: 0.5000
 Site-Middle_Eastern            (3) | Val  Loss: 1.3452 | Val  Acc: 0.4891
 Site-Middle_Eastern            (3) | Val  Loss: 1.3227 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4887
 Test site-White                     (3)| Epoch:43 | Test Acc: 0.4225
 Test site-Latino_Hispanic           (6)| Epoch:43 | Test Acc: 0.3639
 Test site-Black                     (1)| Epoch:43 | Test Acc: 0.3563
 Test site-East_Asian                (4)| Epoch:43 | Test Acc: 0.5000
 Test site-Indian                    (1)| Epoch:43 | Test Acc: 0.3589
 Test site-Southeast_Asian           (0)| Epoch:43 | Test Acc: 0.4407
 Test site-Middle_Eastern            (3)| Epoch:43 | Test Acc: 0.4356
White: 0.4225, Latino_Hispanic: 0.3639, Black: 0.3563, East_Asian: 0.5000, Indian: 0.3589, Southeast_Asian: 0.4407, Middle_Eastern: 0.4356, 
Average Test Accuracy: 0.4111, domain std=0.0500, cluster std=nan, individual std=0.0500, 
Average Test Accuracy: 0.4111
============ Train epoch 45 ============
cnt=[2, 2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-White                    | Train Loss: 1.4010 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.3093 | Train Acc: 0.5012
 Site-Latino_Hispanic          | Train Loss: 1.4719 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.3624 | Train Acc: 0.4484
 Site-Black                    | Train Loss: 1.6089 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.5659 | Train Acc: 0.4700
 Site-East_Asian               | Train Loss: 1.3219 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2404 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.3558 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3514 | Train Acc: 0.4700
 Site-Southeast_Asian          | Train Loss: 1.4495 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.3672 | Train Acc: 0.5108
 Site-Middle_Eastern           | Train Loss: 1.3679 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.2855 | Train Acc: 0.5036
 Site-White                     (5) | Val  Loss: 1.2786 | Val  Acc: 0.4783
 Site-White                     (5) | Val  Loss: 1.2786 | Val  Acc: 0.5036
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3216 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3562 | Val  Acc: 0.4712
 Site-Black                     (1) | Val  Loss: 1.2477 | Val  Acc: 0.5652
 Site-Black                     (1) | Val  Loss: 1.4128 | Val  Acc: 0.4532
 Site-East_Asian                (2) | Val  Loss: 1.2104 | Val  Acc: 0.5435
 Site-East_Asian                (2) | Val  Loss: 1.2279 | Val  Acc: 0.5504
 Site-Indian                    (6) | Val  Loss: 1.4289 | Val  Acc: 0.5000
 Site-Indian                    (6) | Val  Loss: 1.3621 | Val  Acc: 0.4640
 Site-Southeast_Asian           (0) | Val  Loss: 1.3231 | Val  Acc: 0.4674
 Site-Southeast_Asian           (0) | Val  Loss: 1.2842 | Val  Acc: 0.5396
 Site-Middle_Eastern            (4) | Val  Loss: 1.3880 | Val  Acc: 0.5000
 Site-Middle_Eastern            (4) | Val  Loss: 1.3245 | Val  Acc: 0.4784
Average Valid Accuracy: 0.5011
 Test site-White                     (5)| Epoch:43 | Test Acc: 0.4332
 Test site-Latino_Hispanic           (3)| Epoch:43 | Test Acc: 0.3766
 Test site-Black                     (1)| Epoch:43 | Test Acc: 0.3438
 Test site-East_Asian                (2)| Epoch:43 | Test Acc: 0.5162
 Test site-Indian                    (6)| Epoch:43 | Test Acc: 0.3589
 Test site-Southeast_Asian           (0)| Epoch:43 | Test Acc: 0.4556
 Test site-Middle_Eastern            (4)| Epoch:43 | Test Acc: 0.4253
White: 0.4332, Latino_Hispanic: 0.3766, Black: 0.3438, East_Asian: 0.5162, Indian: 0.3589, Southeast_Asian: 0.4556, Middle_Eastern: 0.4253, 
Average Test Accuracy: 0.4156, domain std=0.0561, cluster std=0.0561, individual std=0.0561, 
Average Test Accuracy: 0.4156
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-quan-q0.5-lrm0.01_1.0_1_random_dis_cluster_7/ccop_q=0.5...
============ Train epoch 46 ============
cnt=[2, 3, 3, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-White                    | Train Loss: 1.3267 | Train Acc: 0.5468
 Site-White                    | Train Loss: 1.2312 | Train Acc: 0.4988
 Site-Latino_Hispanic          | Train Loss: 1.4537 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.4092 | Train Acc: 0.4532
 Site-Black                    | Train Loss: 1.5905 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.4314 | Train Acc: 0.4868
 Site-East_Asian               | Train Loss: 1.3276 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.3304 | Train Acc: 0.5132
 Site-Indian                   | Train Loss: 1.3379 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4120 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3893 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3017 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.4111 | Train Acc: 0.5180
 Site-Middle_Eastern           | Train Loss: 1.2384 | Train Acc: 0.5156
 Site-White                     (1) | Val  Loss: 1.2797 | Val  Acc: 0.4783
 Site-White                     (2) | Val  Loss: 1.2822 | Val  Acc: 0.4964
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3472 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3703 | Val  Acc: 0.4928
 Site-Black                     (5) | Val  Loss: 1.2468 | Val  Acc: 0.5652
 Site-Black                     (6) | Val  Loss: 1.3873 | Val  Acc: 0.4964
 Site-East_Asian                (3) | Val  Loss: 1.1855 | Val  Acc: 0.5652
 Site-East_Asian                (4) | Val  Loss: 1.2476 | Val  Acc: 0.5324
 Site-Indian                    (0) | Val  Loss: 1.4368 | Val  Acc: 0.4565
 Site-Indian                    (0) | Val  Loss: 1.3529 | Val  Acc: 0.4604
 Site-Southeast_Asian           (4) | Val  Loss: 1.3815 | Val  Acc: 0.5000
 Site-Southeast_Asian           (4) | Val  Loss: 1.2826 | Val  Acc: 0.5540
 Site-Middle_Eastern            (2) | Val  Loss: 1.3241 | Val  Acc: 0.5326
 Site-Middle_Eastern            (2) | Val  Loss: 1.3168 | Val  Acc: 0.5036
Average Valid Accuracy: 0.5057
 Best site-White                    (1)  | Epoch:46 | Val Acc: 0.4783
 Best site-White                    (2)  | Epoch:46 | Val Acc: 0.4964
 Best site-Latino_Hispanic          (1)  | Epoch:46 | Val Acc: 0.4457
 Best site-Latino_Hispanic          (1)  | Epoch:46 | Val Acc: 0.4928
 Best site-Black                    (5)  | Epoch:46 | Val Acc: 0.5652
 Best site-Black                    (6)  | Epoch:46 | Val Acc: 0.4964
 Best site-East_Asian               (3)  | Epoch:46 | Val Acc: 0.5652
 Best site-East_Asian               (4)  | Epoch:46 | Val Acc: 0.5324
 Best site-Indian                   (0)  | Epoch:46 | Val Acc: 0.4565
 Best site-Indian                   (0)  | Epoch:46 | Val Acc: 0.4604
 Best site-Southeast_Asian          (4)  | Epoch:46 | Val Acc: 0.5000
 Best site-Southeast_Asian          (4)  | Epoch:46 | Val Acc: 0.5540
 Best site-Middle_Eastern           (2)  | Epoch:46 | Val Acc: 0.5326
 Best site-Middle_Eastern           (2)  | Epoch:46 | Val Acc: 0.5036
 Test site-White                     (1)| Epoch:46 | Test Acc: 0.4225
 Test site-Latino_Hispanic           (1)| Epoch:46 | Test Acc: 0.3639
 Test site-Black                     (5)| Epoch:46 | Test Acc: 0.3594
 Test site-East_Asian                (3)| Epoch:46 | Test Acc: 0.5162
 Test site-Indian                    (0)| Epoch:46 | Test Acc: 0.3517
 Test site-Southeast_Asian           (4)| Epoch:46 | Test Acc: 0.4556
 Test site-Middle_Eastern            (2)| Epoch:46 | Test Acc: 0.4227
White: 0.4225, Latino_Hispanic: 0.3639, Black: 0.3594, East_Asian: 0.5162, Indian: 0.3517, Southeast_Asian: 0.4556, Middle_Eastern: 0.4227, 
Average Test Accuracy: 0.4131, domain std=0.0557, cluster std=nan, individual std=0.0557, 
Average Test Accuracy: 0.4131
============ Train epoch 47 ============
cnt=[3, 1, 3, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-White                    | Train Loss: 1.2949 | Train Acc: 0.5036
 Site-White                    | Train Loss: 1.2025 | Train Acc: 0.5396
 Site-Latino_Hispanic          | Train Loss: 1.4686 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.3802 | Train Acc: 0.4676
 Site-Black                    | Train Loss: 1.5412 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.4442 | Train Acc: 0.4652
 Site-East_Asian               | Train Loss: 1.3698 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.2655 | Train Acc: 0.5084
 Site-Indian                   | Train Loss: 1.3248 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.3399 | Train Acc: 0.4868
 Site-Southeast_Asian          | Train Loss: 1.3706 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.4520 | Train Acc: 0.5156
 Site-Middle_Eastern           | Train Loss: 1.3984 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.2221 | Train Acc: 0.5132
 Site-White                     (2) | Val  Loss: 1.3010 | Val  Acc: 0.5217
 Site-White                     (2) | Val  Loss: 1.2652 | Val  Acc: 0.4892
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3651 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3590 | Val  Acc: 0.4640
 Site-Black                     (6) | Val  Loss: 1.2337 | Val  Acc: 0.5978
 Site-Black                     (1) | Val  Loss: 1.3589 | Val  Acc: 0.4856
 Site-East_Asian                (4) | Val  Loss: 1.2238 | Val  Acc: 0.5217
 Site-East_Asian                (0) | Val  Loss: 1.2477 | Val  Acc: 0.5324
 Site-Indian                    (3) | Val  Loss: 1.3614 | Val  Acc: 0.4348
 Site-Indian                    (3) | Val  Loss: 1.3303 | Val  Acc: 0.4784
 Site-Southeast_Asian           (0) | Val  Loss: 1.3389 | Val  Acc: 0.5000
 Site-Southeast_Asian           (0) | Val  Loss: 1.3012 | Val  Acc: 0.4964
 Site-Middle_Eastern            (5) | Val  Loss: 1.3843 | Val  Acc: 0.4783
 Site-Middle_Eastern            (5) | Val  Loss: 1.3010 | Val  Acc: 0.4964
Average Valid Accuracy: 0.4982
 Test site-White                     (2)| Epoch:46 | Test Acc: 0.4225
 Test site-Latino_Hispanic           (2)| Epoch:46 | Test Acc: 0.3703
 Test site-Black                     (6)| Epoch:46 | Test Acc: 0.3594
 Test site-East_Asian                (4)| Epoch:46 | Test Acc: 0.5292
 Test site-Indian                    (3)| Epoch:46 | Test Acc: 0.3517
 Test site-Southeast_Asian           (0)| Epoch:46 | Test Acc: 0.4556
 Test site-Middle_Eastern            (5)| Epoch:46 | Test Acc: 0.4149
White: 0.4225, Latino_Hispanic: 0.3703, Black: 0.3594, East_Asian: 0.5292, Indian: 0.3517, Southeast_Asian: 0.4556, Middle_Eastern: 0.4149, 
Average Test Accuracy: 0.4148, domain std=0.0584, cluster std=nan, individual std=0.0584, 
Average Test Accuracy: 0.4148
============ Train epoch 48 ============
cnt=[4, 2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-White                    | Train Loss: 1.3373 | Train Acc: 0.5180
 Site-White                    | Train Loss: 1.2710 | Train Acc: 0.5180
 Site-Latino_Hispanic          | Train Loss: 1.5522 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.3218 | Train Acc: 0.4844
 Site-Black                    | Train Loss: 1.5016 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.6057 | Train Acc: 0.4796
 Site-East_Asian               | Train Loss: 1.4219 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.4403 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.3031 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3578 | Train Acc: 0.4580
 Site-Southeast_Asian          | Train Loss: 1.3220 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.3411 | Train Acc: 0.4724
 Site-Middle_Eastern           | Train Loss: 1.4106 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.2851 | Train Acc: 0.4964
 Site-White                     (5) | Val  Loss: 1.3010 | Val  Acc: 0.4565
 Site-White                     (6) | Val  Loss: 1.2634 | Val  Acc: 0.5396
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3292 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3709 | Val  Acc: 0.4604
 Site-Black                     (3) | Val  Loss: 1.2285 | Val  Acc: 0.6196
 Site-Black                     (3) | Val  Loss: 1.3655 | Val  Acc: 0.5144
 Site-East_Asian                (2) | Val  Loss: 1.2331 | Val  Acc: 0.5435
 Site-East_Asian                (4) | Val  Loss: 1.2477 | Val  Acc: 0.5036
 Site-Indian                    (0) | Val  Loss: 1.3713 | Val  Acc: 0.4565
 Site-Indian                    (0) | Val  Loss: 1.3211 | Val  Acc: 0.4820
 Site-Southeast_Asian           (2) | Val  Loss: 1.3180 | Val  Acc: 0.4565
 Site-Southeast_Asian           (4) | Val  Loss: 1.3036 | Val  Acc: 0.5000
 Site-Middle_Eastern            (1) | Val  Loss: 1.3559 | Val  Acc: 0.4674
 Site-Middle_Eastern            (1) | Val  Loss: 1.3004 | Val  Acc: 0.4964
Average Valid Accuracy: 0.4943
 Test site-White                     (5)| Epoch:46 | Test Acc: 0.4171
 Test site-Latino_Hispanic           (0)| Epoch:46 | Test Acc: 0.3608
 Test site-Black                     (3)| Epoch:46 | Test Acc: 0.3625
 Test site-East_Asian                (2)| Epoch:46 | Test Acc: 0.5000
 Test site-Indian                    (0)| Epoch:46 | Test Acc: 0.3517
 Test site-Southeast_Asian           (2)| Epoch:46 | Test Acc: 0.4481
 Test site-Middle_Eastern            (1)| Epoch:46 | Test Acc: 0.4278
White: 0.4171, Latino_Hispanic: 0.3608, Black: 0.3625, East_Asian: 0.5000, Indian: 0.3517, Southeast_Asian: 0.4481, Middle_Eastern: 0.4278, 
Average Test Accuracy: 0.4097, domain std=0.0507, cluster std=nan, individual std=0.0507, 
Average Test Accuracy: 0.4097
============ Train epoch 49 ============
cnt=[3, 2, 2, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-White                    | Train Loss: 1.3926 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.3262 | Train Acc: 0.5180
 Site-Latino_Hispanic          | Train Loss: 1.5330 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.3541 | Train Acc: 0.4508
 Site-Black                    | Train Loss: 1.6362 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.3494 | Train Acc: 0.4940
 Site-East_Asian               | Train Loss: 1.3453 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2629 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.2945 | Train Acc: 0.5396
 Site-Indian                   | Train Loss: 1.3511 | Train Acc: 0.4484
 Site-Southeast_Asian          | Train Loss: 1.3713 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3375 | Train Acc: 0.4916
 Site-Middle_Eastern           | Train Loss: 1.3792 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.2319 | Train Acc: 0.5084
 Site-White                     (0) | Val  Loss: 1.2241 | Val  Acc: 0.5870
 Site-White                     (5) | Val  Loss: 1.2846 | Val  Acc: 0.4964
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3388 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3623 | Val  Acc: 0.4209
 Site-Black                     (3) | Val  Loss: 1.2288 | Val  Acc: 0.5870
 Site-Black                     (3) | Val  Loss: 1.4089 | Val  Acc: 0.4820
 Site-East_Asian                (1) | Val  Loss: 1.2094 | Val  Acc: 0.5543
 Site-East_Asian                (1) | Val  Loss: 1.2231 | Val  Acc: 0.5432
 Site-Indian                    (2) | Val  Loss: 1.3737 | Val  Acc: 0.5000
 Site-Indian                    (2) | Val  Loss: 1.3346 | Val  Acc: 0.4820
 Site-Southeast_Asian           (4) | Val  Loss: 1.3262 | Val  Acc: 0.4783
 Site-Southeast_Asian           (4) | Val  Loss: 1.2831 | Val  Acc: 0.5180
 Site-Middle_Eastern            (6) | Val  Loss: 1.3263 | Val  Acc: 0.5000
 Site-Middle_Eastern            (6) | Val  Loss: 1.3146 | Val  Acc: 0.5036
Average Valid Accuracy: 0.5070
 Best site-White                    (0)  | Epoch:49 | Val Acc: 0.5870
 Best site-White                    (5)  | Epoch:49 | Val Acc: 0.4964
 Best site-Latino_Hispanic          (0)  | Epoch:49 | Val Acc: 0.4457
 Best site-Latino_Hispanic          (0)  | Epoch:49 | Val Acc: 0.4209
 Best site-Black                    (3)  | Epoch:49 | Val Acc: 0.5870
 Best site-Black                    (3)  | Epoch:49 | Val Acc: 0.4820
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.5543
 Best site-East_Asian               (1)  | Epoch:49 | Val Acc: 0.5432
 Best site-Indian                   (2)  | Epoch:49 | Val Acc: 0.5000
 Best site-Indian                   (2)  | Epoch:49 | Val Acc: 0.4820
 Best site-Southeast_Asian          (4)  | Epoch:49 | Val Acc: 0.4783
 Best site-Southeast_Asian          (4)  | Epoch:49 | Val Acc: 0.5180
 Best site-Middle_Eastern           (6)  | Epoch:49 | Val Acc: 0.5000
 Best site-Middle_Eastern           (6)  | Epoch:49 | Val Acc: 0.5036
 Test site-White                     (0)| Epoch:49 | Test Acc: 0.4251
 Test site-Latino_Hispanic           (0)| Epoch:49 | Test Acc: 0.3576
 Test site-Black                     (3)| Epoch:49 | Test Acc: 0.3563
 Test site-East_Asian                (1)| Epoch:49 | Test Acc: 0.5097
 Test site-Indian                    (2)| Epoch:49 | Test Acc: 0.3493
 Test site-Southeast_Asian           (4)| Epoch:49 | Test Acc: 0.4370
 Test site-Middle_Eastern            (6)| Epoch:49 | Test Acc: 0.4304
White: 0.4251, Latino_Hispanic: 0.3576, Black: 0.3563, East_Asian: 0.5097, Indian: 0.3493, Southeast_Asian: 0.4370, Middle_Eastern: 0.4304, 
Average Test Accuracy: 0.4094, domain std=0.0543, cluster std=nan, individual std=0.0543, 
Average Test Accuracy: 0.4094
===2023-06-07 15:43:47===
