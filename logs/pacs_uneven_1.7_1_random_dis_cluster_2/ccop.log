===2023-08-10 14:02:09===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 2
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (0) | Train Loss: 1.6736 | Train Acc: 0.4667
 Site-photo                     (0) | Train Loss: 1.7515 | Train Acc: 0.4559
 Site-photo                     (0) | Train Loss: 1.6947 | Train Acc: 0.5000
 Site-photo                     (0) | Train Loss: 1.6159 | Train Acc: 0.5686
 Site-photo                     (0) | Train Loss: 1.6908 | Train Acc: 0.5022
 Site-art_painting              (0) | Train Loss: 1.8027 | Train Acc: 0.3095
 Site-art_painting              (0) | Train Loss: 1.9024 | Train Acc: 0.2526
 Site-art_painting              (0) | Train Loss: 1.7673 | Train Acc: 0.3239
 Site-cartoon                   (0) | Train Loss: 1.8389 | Train Acc: 0.1765
 Site-cartoon                   (0) | Train Loss: 1.8759 | Train Acc: 0.2558
 Site-sketch                    (1) | Train Loss: 1.8480 | Train Acc: 0.1901
Average Train Accuracy: 0.3638
 Site-photo                     (0) | Val  Loss: 1.6976 | Val  Acc: 0.5000
 Site-photo                     (0) | Val  Loss: 1.7470 | Val  Acc: 0.5111
 Site-photo                     (0) | Val  Loss: 1.6030 | Val  Acc: 0.5147
 Site-photo                     (0) | Val  Loss: 1.6918 | Val  Acc: 0.5000
 Site-photo                     (0) | Val  Loss: 1.6341 | Val  Acc: 0.5066
 Site-art_painting              (0) | Val  Loss: 1.9434 | Val  Acc: 0.2143
 Site-art_painting              (0) | Val  Loss: 1.7397 | Val  Acc: 0.4127
 Site-art_painting              (0) | Val  Loss: 1.8255 | Val  Acc: 0.2887
 Site-cartoon                   (0) | Val  Loss: 1.9569 | Val  Acc: 0.3913
 Site-cartoon                   (0) | Val  Loss: 1.8854 | Val  Acc: 0.2348
 Site-sketch                    (1) | Val  Loss: 1.7826 | Val  Acc: 0.2750
Average Valid Accuracy: 0.3954
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.5111
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.5147
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.5066
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2143
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.4127
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2887
 Best site-cartoon                  (0)  | Epoch:0 | Val Acc: 0.3913
 Best site-cartoon                  (0)  | Epoch:0 | Val Acc: 0.2348
 Best site-sketch                   (1)  | Epoch:0 | Val Acc: 0.2750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 1 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (0) | Train Loss: 1.5583 | Train Acc: 0.5556
 Site-photo                     (0) | Train Loss: 1.4499 | Train Acc: 0.5735
 Site-photo                     (0) | Train Loss: 1.4470 | Train Acc: 0.6373
 Site-photo                     (0) | Train Loss: 1.4140 | Train Acc: 0.6667
 Site-photo                     (0) | Train Loss: 1.4953 | Train Acc: 0.6332
 Site-art_painting              (0) | Train Loss: 1.6246 | Train Acc: 0.5476
 Site-art_painting              (0) | Train Loss: 1.8050 | Train Acc: 0.3474
 Site-art_painting              (0) | Train Loss: 1.6439 | Train Acc: 0.4038
 Site-cartoon                   (0) | Train Loss: 1.7338 | Train Acc: 0.2647
 Site-cartoon                   (0) | Train Loss: 1.7923 | Train Acc: 0.3198
 Site-sketch                    (1) | Train Loss: 1.9151 | Train Acc: 0.2397
Average Train Accuracy: 0.4717
 Site-photo                     (0) | Val  Loss: 1.4970 | Val  Acc: 0.6000
 Site-photo                     (0) | Val  Loss: 1.5386 | Val  Acc: 0.6000
 Site-photo                     (0) | Val  Loss: 1.3858 | Val  Acc: 0.6471
 Site-photo                     (0) | Val  Loss: 1.4720 | Val  Acc: 0.6373
 Site-photo                     (0) | Val  Loss: 1.4069 | Val  Acc: 0.7171
 Site-art_painting              (0) | Val  Loss: 1.7182 | Val  Acc: 0.3929
 Site-art_painting              (0) | Val  Loss: 1.6351 | Val  Acc: 0.4286
 Site-art_painting              (0) | Val  Loss: 1.6792 | Val  Acc: 0.4155
 Site-cartoon                   (0) | Val  Loss: 1.8512 | Val  Acc: 0.2174
 Site-cartoon                   (0) | Val  Loss: 1.7569 | Val  Acc: 0.3217
 Site-sketch                    (1) | Val  Loss: 1.8269 | Val  Acc: 0.2625
Average Valid Accuracy: 0.4764
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.6000
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.6000
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.6471
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.6373
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.7171
 Best site-art_painting             (0)  | Epoch:1 | Val Acc: 0.3929
 Best site-art_painting             (0)  | Epoch:1 | Val Acc: 0.4286
 Best site-art_painting             (0)  | Epoch:1 | Val Acc: 0.4155
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.2174
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.3217
 Best site-sketch                   (1)  | Epoch:1 | Val Acc: 0.2625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 2 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (0) | Train Loss: 1.3236 | Train Acc: 0.7556
 Site-photo                     (0) | Train Loss: 1.1821 | Train Acc: 0.7941
 Site-photo                     (0) | Train Loss: 1.1936 | Train Acc: 0.8431
 Site-photo                     (0) | Train Loss: 1.2146 | Train Acc: 0.8758
 Site-photo                     (0) | Train Loss: 1.2808 | Train Acc: 0.8122
 Site-art_painting              (0) | Train Loss: 1.6091 | Train Acc: 0.5000
 Site-art_painting              (0) | Train Loss: 1.6055 | Train Acc: 0.4316
 Site-art_painting              (0) | Train Loss: 1.5427 | Train Acc: 0.5070
 Site-cartoon                   (0) | Train Loss: 1.7182 | Train Acc: 0.2941
 Site-cartoon                   (0) | Train Loss: 1.6791 | Train Acc: 0.3605
 Site-sketch                    (1) | Train Loss: 1.8188 | Train Acc: 0.2397
Average Train Accuracy: 0.5831
 Site-photo                     (0) | Val  Loss: 1.2536 | Val  Acc: 0.8000
 Site-photo                     (0) | Val  Loss: 1.2985 | Val  Acc: 0.7333
 Site-photo                     (0) | Val  Loss: 1.2477 | Val  Acc: 0.8235
 Site-photo                     (0) | Val  Loss: 1.2664 | Val  Acc: 0.8627
 Site-photo                     (0) | Val  Loss: 1.1907 | Val  Acc: 0.8618
 Site-art_painting              (0) | Val  Loss: 1.5338 | Val  Acc: 0.5714
 Site-art_painting              (0) | Val  Loss: 1.5065 | Val  Acc: 0.6032
 Site-art_painting              (0) | Val  Loss: 1.5789 | Val  Acc: 0.5141
 Site-cartoon                   (0) | Val  Loss: 1.8159 | Val  Acc: 0.1739
 Site-cartoon                   (0) | Val  Loss: 1.6549 | Val  Acc: 0.4087
 Site-sketch                    (1) | Val  Loss: 1.7340 | Val  Acc: 0.2375
Average Valid Accuracy: 0.5991
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8000
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7333
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8235
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8627
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8618
 Best site-art_painting             (0)  | Epoch:2 | Val Acc: 0.5714
 Best site-art_painting             (0)  | Epoch:2 | Val Acc: 0.6032
 Best site-art_painting             (0)  | Epoch:2 | Val Acc: 0.5141
 Best site-cartoon                  (0)  | Epoch:2 | Val Acc: 0.1739
 Best site-cartoon                  (0)  | Epoch:2 | Val Acc: 0.4087
 Best site-sketch                   (1)  | Epoch:2 | Val Acc: 0.2375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 3 ============
cnt=[3, 8, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (1) | Train Loss: 1.1050 | Train Acc: 0.8444
 Site-photo                     (1) | Train Loss: 1.1807 | Train Acc: 0.8529
 Site-photo                     (1) | Train Loss: 1.0171 | Train Acc: 0.9510
 Site-photo                     (1) | Train Loss: 1.0109 | Train Acc: 0.9281
 Site-photo                     (1) | Train Loss: 1.0547 | Train Acc: 0.8821
 Site-art_painting              (1) | Train Loss: 1.3714 | Train Acc: 0.6429
 Site-art_painting              (1) | Train Loss: 1.4580 | Train Acc: 0.6105
 Site-art_painting              (1) | Train Loss: 1.3850 | Train Acc: 0.6385
 Site-cartoon                   (0) | Train Loss: 1.6079 | Train Acc: 0.4118
 Site-cartoon                   (0) | Train Loss: 1.5584 | Train Acc: 0.4593
 Site-sketch                    (0) | Train Loss: 1.7679 | Train Acc: 0.2975
Average Train Accuracy: 0.6835
 Site-photo                     (1) | Val  Loss: 1.0212 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 1.1070 | Val  Acc: 0.8667
 Site-photo                     (1) | Val  Loss: 1.0578 | Val  Acc: 0.9118
 Site-photo                     (1) | Val  Loss: 1.0378 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.9700 | Val  Acc: 0.9276
 Site-art_painting              (1) | Val  Loss: 1.3637 | Val  Acc: 0.6429
 Site-art_painting              (1) | Val  Loss: 1.3443 | Val  Acc: 0.7143
 Site-art_painting              (1) | Val  Loss: 1.4558 | Val  Acc: 0.6127
 Site-cartoon                   (0) | Val  Loss: 1.6306 | Val  Acc: 0.3913
 Site-cartoon                   (0) | Val  Loss: 1.5365 | Val  Acc: 0.4522
 Site-sketch                    (0) | Val  Loss: 1.6775 | Val  Acc: 0.3250
Average Valid Accuracy: 0.7026
 Best site-photo                    (1)  | Epoch:3 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:3 | Val Acc: 0.8667
 Best site-photo                    (1)  | Epoch:3 | Val Acc: 0.9118
 Best site-photo                    (1)  | Epoch:3 | Val Acc: 0.9510
 Best site-photo                    (1)  | Epoch:3 | Val Acc: 0.9276
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.6429
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.7143
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.6127
 Best site-cartoon                  (0)  | Epoch:3 | Val Acc: 0.3913
 Best site-cartoon                  (0)  | Epoch:3 | Val Acc: 0.4522
 Best site-sketch                   (0)  | Epoch:3 | Val Acc: 0.3250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 4 ============
cnt=[8, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (0) | Train Loss: 0.9243 | Train Acc: 0.8667
 Site-photo                     (0) | Train Loss: 0.7371 | Train Acc: 0.9118
 Site-photo                     (0) | Train Loss: 0.8044 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.8343 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.8756 | Train Acc: 0.9476
 Site-art_painting              (0) | Train Loss: 1.3142 | Train Acc: 0.7143
 Site-art_painting              (0) | Train Loss: 1.3740 | Train Acc: 0.5684
 Site-art_painting              (0) | Train Loss: 1.2329 | Train Acc: 0.7371
 Site-cartoon                   (1) | Train Loss: 1.5836 | Train Acc: 0.3824
 Site-cartoon                   (1) | Train Loss: 1.4624 | Train Acc: 0.5174
 Site-sketch                    (1) | Train Loss: 1.7193 | Train Acc: 0.2810
Average Train Accuracy: 0.7144
 Site-photo                     (0) | Val  Loss: 0.8499 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.8853 | Val  Acc: 0.9111
 Site-photo                     (0) | Val  Loss: 0.8554 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.8627 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.7800 | Val  Acc: 0.9671
 Site-art_painting              (0) | Val  Loss: 1.2195 | Val  Acc: 0.7143
 Site-art_painting              (0) | Val  Loss: 1.2445 | Val  Acc: 0.7778
 Site-art_painting              (0) | Val  Loss: 1.3038 | Val  Acc: 0.7254
 Site-cartoon                   (1) | Val  Loss: 1.5192 | Val  Acc: 0.3913
 Site-cartoon                   (1) | Val  Loss: 1.4346 | Val  Acc: 0.5217
 Site-sketch                    (1) | Val  Loss: 1.6611 | Val  Acc: 0.3500
Average Valid Accuracy: 0.7484
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9111
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9671
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.7143
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.7778
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.7254
 Best site-cartoon                  (1)  | Epoch:4 | Val Acc: 0.3913
 Best site-cartoon                  (1)  | Epoch:4 | Val Acc: 0.5217
 Best site-sketch                   (1)  | Epoch:4 | Val Acc: 0.3500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 8, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (1) | Train Loss: 0.7931 | Train Acc: 0.9556
 Site-photo                     (1) | Train Loss: 0.9052 | Train Acc: 0.9118
 Site-photo                     (1) | Train Loss: 0.7026 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.7048 | Train Acc: 0.9477
 Site-photo                     (1) | Train Loss: 0.7375 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 1.2453 | Train Acc: 0.6667
 Site-art_painting              (1) | Train Loss: 1.2637 | Train Acc: 0.6316
 Site-art_painting              (1) | Train Loss: 1.1221 | Train Acc: 0.7746
 Site-cartoon                   (0) | Train Loss: 1.4431 | Train Acc: 0.5882
 Site-cartoon                   (0) | Train Loss: 1.3573 | Train Acc: 0.5872
 Site-sketch                    (0) | Train Loss: 1.6459 | Train Acc: 0.3636
Average Train Accuracy: 0.7607
 Site-photo                     (1) | Val  Loss: 0.7458 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.7076 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.7547 | Val  Acc: 0.9118
 Site-photo                     (1) | Val  Loss: 0.7431 | Val  Acc: 0.9412
 Site-photo                     (1) | Val  Loss: 0.6609 | Val  Acc: 0.9539
 Site-art_painting              (1) | Val  Loss: 1.1357 | Val  Acc: 0.7857
 Site-art_painting              (1) | Val  Loss: 1.1435 | Val  Acc: 0.8095
 Site-art_painting              (1) | Val  Loss: 1.2557 | Val  Acc: 0.7324
 Site-cartoon                   (0) | Val  Loss: 1.3772 | Val  Acc: 0.6522
 Site-cartoon                   (0) | Val  Loss: 1.3581 | Val  Acc: 0.5739
 Site-sketch                    (0) | Val  Loss: 1.5936 | Val  Acc: 0.4375
Average Valid Accuracy: 0.7917
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9778
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9118
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9412
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9539
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.7857
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.8095
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.7324
 Best site-cartoon                  (0)  | Epoch:5 | Val Acc: 0.6522
 Best site-cartoon                  (0)  | Epoch:5 | Val Acc: 0.5739
 Best site-sketch                   (0)  | Epoch:5 | Val Acc: 0.4375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 8, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (1) | Train Loss: 0.7186 | Train Acc: 0.9333
 Site-photo                     (1) | Train Loss: 0.6861 | Train Acc: 0.9265
 Site-photo                     (1) | Train Loss: 0.6119 | Train Acc: 0.9510
 Site-photo                     (1) | Train Loss: 0.6348 | Train Acc: 0.9542
 Site-photo                     (1) | Train Loss: 0.6137 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 1.0923 | Train Acc: 0.7857
 Site-art_painting              (1) | Train Loss: 1.1493 | Train Acc: 0.7158
 Site-art_painting              (1) | Train Loss: 1.0521 | Train Acc: 0.8122
 Site-cartoon                   (0) | Train Loss: 1.3186 | Train Acc: 0.6765
 Site-cartoon                   (0) | Train Loss: 1.2762 | Train Acc: 0.6047
 Site-sketch                    (0) | Train Loss: 1.5983 | Train Acc: 0.3802
Average Train Accuracy: 0.7910
 Site-photo                     (1) | Val  Loss: 0.6150 | Val  Acc: 0.9667
 Site-photo                     (1) | Val  Loss: 0.6582 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.6549 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.6440 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.5782 | Val  Acc: 0.9671
 Site-art_painting              (1) | Val  Loss: 0.9701 | Val  Acc: 0.8571
 Site-art_painting              (1) | Val  Loss: 0.9500 | Val  Acc: 0.8889
 Site-art_painting              (1) | Val  Loss: 1.0875 | Val  Acc: 0.8521
 Site-cartoon                   (0) | Val  Loss: 1.3707 | Val  Acc: 0.6087
 Site-cartoon                   (0) | Val  Loss: 1.2113 | Val  Acc: 0.6870
 Site-sketch                    (0) | Val  Loss: 1.5663 | Val  Acc: 0.4125
Average Valid Accuracy: 0.8275
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9667
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9559
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9510
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9671
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.8571
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.8889
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.8521
 Best site-cartoon                  (0)  | Epoch:6 | Val Acc: 0.6087
 Best site-cartoon                  (0)  | Epoch:6 | Val Acc: 0.6870
 Best site-sketch                   (0)  | Epoch:6 | Val Acc: 0.4125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 7 ============
cnt=[8, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (0) | Train Loss: 0.6229 | Train Acc: 0.9333
 Site-photo                     (0) | Train Loss: 0.7864 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.5288 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.5532 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.5596 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.9782 | Train Acc: 0.7857
 Site-art_painting              (0) | Train Loss: 1.0445 | Train Acc: 0.6842
 Site-art_painting              (0) | Train Loss: 0.9071 | Train Acc: 0.8451
 Site-cartoon                   (1) | Train Loss: 1.1987 | Train Acc: 0.7353
 Site-cartoon                   (1) | Train Loss: 1.1527 | Train Acc: 0.6919
 Site-sketch                    (1) | Train Loss: 1.4994 | Train Acc: 0.5124
Average Train Accuracy: 0.8214
 Site-photo                     (0) | Val  Loss: 0.5810 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.5786 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.5872 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.5855 | Val  Acc: 0.9314
 Site-photo                     (0) | Val  Loss: 0.5080 | Val  Acc: 0.9605
 Site-art_painting              (0) | Val  Loss: 0.9149 | Val  Acc: 0.8214
 Site-art_painting              (0) | Val  Loss: 0.8762 | Val  Acc: 0.8571
 Site-art_painting              (0) | Val  Loss: 0.9743 | Val  Acc: 0.8169
 Site-cartoon                   (1) | Val  Loss: 1.2048 | Val  Acc: 0.5652
 Site-cartoon                   (1) | Val  Loss: 1.1011 | Val  Acc: 0.7130
 Site-sketch                    (1) | Val  Loss: 1.4914 | Val  Acc: 0.4625
Average Valid Accuracy: 0.8107
============ Train epoch 8 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (0) | Train Loss: 0.5470 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.6669 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.4509 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.5074 | Train Acc: 0.9542
 Site-photo                     (0) | Train Loss: 0.5096 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 0.9426 | Train Acc: 0.7619
 Site-art_painting              (0) | Train Loss: 0.9479 | Train Acc: 0.7579
 Site-art_painting              (0) | Train Loss: 0.8588 | Train Acc: 0.8592
 Site-cartoon                   (0) | Train Loss: 1.1172 | Train Acc: 0.7059
 Site-cartoon                   (0) | Train Loss: 1.0650 | Train Acc: 0.7035
 Site-sketch                    (1) | Train Loss: 1.4025 | Train Acc: 0.5041
Average Train Accuracy: 0.8306
 Site-photo                     (0) | Val  Loss: 0.4950 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.5112 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.5151 | Val  Acc: 0.9265
 Site-photo                     (0) | Val  Loss: 0.5199 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.4530 | Val  Acc: 0.9605
 Site-art_painting              (0) | Val  Loss: 0.7495 | Val  Acc: 0.8571
 Site-art_painting              (0) | Val  Loss: 0.7587 | Val  Acc: 0.9365
 Site-art_painting              (0) | Val  Loss: 0.9246 | Val  Acc: 0.8169
 Site-cartoon                   (0) | Val  Loss: 1.0963 | Val  Acc: 0.6087
 Site-cartoon                   (0) | Val  Loss: 1.0463 | Val  Acc: 0.7478
 Site-sketch                    (1) | Val  Loss: 1.4432 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8330
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9265
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:8 | Val Acc: 0.9605
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.8571
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.9365
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.8169
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.6087
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.7478
 Best site-sketch                   (1)  | Epoch:8 | Val Acc: 0.4500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 9 ============
cnt=[3, 8, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (1) | Train Loss: 0.4976 | Train Acc: 0.9556
 Site-photo                     (1) | Train Loss: 0.5822 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.4073 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.4814 | Train Acc: 0.9542
 Site-photo                     (1) | Train Loss: 0.4559 | Train Acc: 0.9694
 Site-art_painting              (1) | Train Loss: 0.8815 | Train Acc: 0.8095
 Site-art_painting              (1) | Train Loss: 0.8321 | Train Acc: 0.8211
 Site-art_painting              (1) | Train Loss: 0.7855 | Train Acc: 0.8310
 Site-cartoon                   (0) | Train Loss: 1.0376 | Train Acc: 0.7353
 Site-cartoon                   (0) | Train Loss: 0.9878 | Train Acc: 0.7209
 Site-sketch                    (0) | Train Loss: 1.2539 | Train Acc: 0.6033
Average Train Accuracy: 0.8488
 Site-photo                     (1) | Val  Loss: 0.4643 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.4365 | Val  Acc: 0.9111
 Site-photo                     (1) | Val  Loss: 0.4475 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.4743 | Val  Acc: 0.9412
 Site-photo                     (1) | Val  Loss: 0.3961 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.7042 | Val  Acc: 0.8214
 Site-art_painting              (1) | Val  Loss: 0.7478 | Val  Acc: 0.9048
 Site-art_painting              (1) | Val  Loss: 0.7994 | Val  Acc: 0.8732
 Site-cartoon                   (0) | Val  Loss: 0.9641 | Val  Acc: 0.7826
 Site-cartoon                   (0) | Val  Loss: 0.9290 | Val  Acc: 0.7913
 Site-sketch                    (0) | Val  Loss: 1.3723 | Val  Acc: 0.4500
Average Valid Accuracy: 0.8496
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9111
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9559
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9412
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9803
 Best site-art_painting             (1)  | Epoch:9 | Val Acc: 0.8214
 Best site-art_painting             (1)  | Epoch:9 | Val Acc: 0.9048
 Best site-art_painting             (1)  | Epoch:9 | Val Acc: 0.8732
 Best site-cartoon                  (0)  | Epoch:9 | Val Acc: 0.7826
 Best site-cartoon                  (0)  | Epoch:9 | Val Acc: 0.7913
 Best site-sketch                   (0)  | Epoch:9 | Val Acc: 0.4500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 8, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (1) | Train Loss: 0.4694 | Train Acc: 0.9556
 Site-photo                     (1) | Train Loss: 0.5097 | Train Acc: 0.9412
 Site-photo                     (1) | Train Loss: 0.3347 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.4241 | Train Acc: 0.9477
 Site-photo                     (1) | Train Loss: 0.4008 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.8241 | Train Acc: 0.8095
 Site-art_painting              (1) | Train Loss: 0.7554 | Train Acc: 0.8316
 Site-art_painting              (1) | Train Loss: 0.6740 | Train Acc: 0.8920
 Site-cartoon                   (0) | Train Loss: 0.8744 | Train Acc: 0.7647
 Site-cartoon                   (0) | Train Loss: 0.8929 | Train Acc: 0.8081
 Site-sketch                    (0) | Train Loss: 1.1813 | Train Acc: 0.6446
Average Train Accuracy: 0.8669
 Site-photo                     (1) | Val  Loss: 0.3999 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.4066 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.4004 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.4068 | Val  Acc: 0.9412
 Site-photo                     (1) | Val  Loss: 0.3528 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.6324 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.6687 | Val  Acc: 0.8889
 Site-art_painting              (1) | Val  Loss: 0.8191 | Val  Acc: 0.8310
 Site-cartoon                   (0) | Val  Loss: 0.9056 | Val  Acc: 0.8261
 Site-cartoon                   (0) | Val  Loss: 0.8366 | Val  Acc: 0.8261
 Site-sketch                    (0) | Val  Loss: 1.3282 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8691
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9559
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9412
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9737
 Best site-art_painting             (1)  | Epoch:10 | Val Acc: 0.9286
 Best site-art_painting             (1)  | Epoch:10 | Val Acc: 0.8889
 Best site-art_painting             (1)  | Epoch:10 | Val Acc: 0.8310
 Best site-cartoon                  (0)  | Epoch:10 | Val Acc: 0.8261
 Best site-cartoon                  (0)  | Epoch:10 | Val Acc: 0.8261
 Best site-sketch                   (0)  | Epoch:10 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 10, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (1) | Train Loss: 0.4190 | Train Acc: 0.9556
 Site-photo                     (1) | Train Loss: 0.3108 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.3225 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.3623 | Train Acc: 0.9608
 Site-photo                     (1) | Train Loss: 0.3592 | Train Acc: 0.9651
 Site-art_painting              (1) | Train Loss: 0.7735 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.7221 | Train Acc: 0.8105
 Site-art_painting              (1) | Train Loss: 0.6460 | Train Acc: 0.8873
 Site-cartoon                   (1) | Train Loss: 0.9058 | Train Acc: 0.7353
 Site-cartoon                   (1) | Train Loss: 0.8379 | Train Acc: 0.7965
 Site-sketch                    (0) | Train Loss: 1.0725 | Train Acc: 0.6446
Average Train Accuracy: 0.8677
 Site-photo                     (1) | Val  Loss: 0.3801 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.3807 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.3551 | Val  Acc: 0.9412
 Site-photo                     (1) | Val  Loss: 0.3579 | Val  Acc: 0.9412
 Site-photo                     (1) | Val  Loss: 0.3078 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.4990 | Val  Acc: 0.9643
 Site-art_painting              (1) | Val  Loss: 0.5950 | Val  Acc: 0.9048
 Site-art_painting              (1) | Val  Loss: 0.7835 | Val  Acc: 0.8592
 Site-cartoon                   (1) | Val  Loss: 0.8723 | Val  Acc: 0.7826
 Site-cartoon                   (1) | Val  Loss: 0.8058 | Val  Acc: 0.8522
 Site-sketch                    (0) | Val  Loss: 1.1560 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8825
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.9412
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.9412
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.9737
 Best site-art_painting             (1)  | Epoch:11 | Val Acc: 0.9643
 Best site-art_painting             (1)  | Epoch:11 | Val Acc: 0.9048
 Best site-art_painting             (1)  | Epoch:11 | Val Acc: 0.8592
 Best site-cartoon                  (1)  | Epoch:11 | Val Acc: 0.7826
 Best site-cartoon                  (1)  | Epoch:11 | Val Acc: 0.8522
 Best site-sketch                   (0)  | Epoch:11 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 12 ============
cnt=[1, 10, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (1) | Train Loss: 0.3581 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3479 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.2660 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.3082 | Train Acc: 0.9608
 Site-photo                     (1) | Train Loss: 0.3176 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.6687 | Train Acc: 0.9048
 Site-art_painting              (1) | Train Loss: 0.6433 | Train Acc: 0.8632
 Site-art_painting              (1) | Train Loss: 0.5630 | Train Acc: 0.9014
 Site-cartoon                   (1) | Train Loss: 0.8296 | Train Acc: 0.7941
 Site-cartoon                   (1) | Train Loss: 0.8624 | Train Acc: 0.7907
 Site-sketch                    (0) | Train Loss: 1.0447 | Train Acc: 0.6446
Average Train Accuracy: 0.8881
 Site-photo                     (1) | Val  Loss: 0.3815 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.3146 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.3232 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.3280 | Val  Acc: 0.9412
 Site-photo                     (1) | Val  Loss: 0.2835 | Val  Acc: 0.9737
 Site-art_painting              (1) | Val  Loss: 0.6081 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.5189 | Val  Acc: 0.9206
 Site-art_painting              (1) | Val  Loss: 0.6808 | Val  Acc: 0.8732
 Site-cartoon                   (1) | Val  Loss: 0.8718 | Val  Acc: 0.8261
 Site-cartoon                   (1) | Val  Loss: 0.7642 | Val  Acc: 0.8261
 Site-sketch                    (0) | Val  Loss: 1.2307 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8837
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9778
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9559
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9412
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9737
 Best site-art_painting             (1)  | Epoch:12 | Val Acc: 0.8929
 Best site-art_painting             (1)  | Epoch:12 | Val Acc: 0.9206
 Best site-art_painting             (1)  | Epoch:12 | Val Acc: 0.8732
 Best site-cartoon                  (1)  | Epoch:12 | Val Acc: 0.8261
 Best site-cartoon                  (1)  | Epoch:12 | Val Acc: 0.8261
 Best site-sketch                   (0)  | Epoch:12 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 8, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (1) | Train Loss: 0.3318 | Train Acc: 0.9556
 Site-photo                     (1) | Train Loss: 0.2242 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.2714 | Train Acc: 0.9804
 Site-photo                     (1) | Train Loss: 0.3018 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.3151 | Train Acc: 0.9607
 Site-art_painting              (1) | Train Loss: 0.6841 | Train Acc: 0.8095
 Site-art_painting              (1) | Train Loss: 0.7226 | Train Acc: 0.8105
 Site-art_painting              (1) | Train Loss: 0.5881 | Train Acc: 0.8920
 Site-cartoon                   (0) | Train Loss: 0.7056 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.7601 | Train Acc: 0.8023
 Site-sketch                    (0) | Train Loss: 0.9488 | Train Acc: 0.6612
Average Train Accuracy: 0.8771
 Site-photo                     (1) | Val  Loss: 0.3534 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.3636 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.3085 | Val  Acc: 0.9412
 Site-photo                     (1) | Val  Loss: 0.3224 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.2690 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.5190 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.4955 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.6980 | Val  Acc: 0.8662
 Site-cartoon                   (0) | Val  Loss: 0.7040 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.7135 | Val  Acc: 0.8435
 Site-sketch                    (0) | Val  Loss: 1.1141 | Val  Acc: 0.6375
Average Valid Accuracy: 0.8910
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9412
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9510
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9803
 Best site-art_painting             (1)  | Epoch:13 | Val Acc: 0.8929
 Best site-art_painting             (1)  | Epoch:13 | Val Acc: 0.9524
 Best site-art_painting             (1)  | Epoch:13 | Val Acc: 0.8662
 Best site-cartoon                  (0)  | Epoch:13 | Val Acc: 0.8696
 Best site-cartoon                  (0)  | Epoch:13 | Val Acc: 0.8435
 Best site-sketch                   (0)  | Epoch:13 | Val Acc: 0.6375
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 14 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (0) | Train Loss: 0.2775 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2288 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.2188 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2633 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2809 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.6023 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.6613 | Train Acc: 0.8526
 Site-art_painting              (0) | Train Loss: 0.5074 | Train Acc: 0.9108
 Site-cartoon                   (0) | Train Loss: 0.7165 | Train Acc: 0.7941
 Site-cartoon                   (0) | Train Loss: 0.7159 | Train Acc: 0.8372
 Site-sketch                    (1) | Train Loss: 0.9336 | Train Acc: 0.7190
Average Train Accuracy: 0.8945
 Site-photo                     (0) | Val  Loss: 0.3303 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2809 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2672 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.2789 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.2587 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.5956 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.4998 | Val  Acc: 0.9048
 Site-art_painting              (0) | Val  Loss: 0.6427 | Val  Acc: 0.8873
 Site-cartoon                   (0) | Val  Loss: 0.7036 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.6761 | Val  Acc: 0.8261
 Site-sketch                    (1) | Val  Loss: 1.0853 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8955
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9737
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8929
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.9048
 Best site-art_painting             (0)  | Epoch:14 | Val Acc: 0.8873
 Best site-cartoon                  (0)  | Epoch:14 | Val Acc: 0.8696
 Best site-cartoon                  (0)  | Epoch:14 | Val Acc: 0.8261
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 15 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.2748 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2354 | Train Acc: 0.9412
 Site-photo                     (0) | Train Loss: 0.2283 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.2687 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.2379 | Train Acc: 0.9782
 Site-art_painting              (0) | Train Loss: 0.6428 | Train Acc: 0.7857
 Site-art_painting              (0) | Train Loss: 0.6358 | Train Acc: 0.8421
 Site-art_painting              (0) | Train Loss: 0.4740 | Train Acc: 0.9061
 Site-cartoon                   (0) | Train Loss: 0.7094 | Train Acc: 0.7647
 Site-cartoon                   (0) | Train Loss: 0.7090 | Train Acc: 0.8372
 Site-sketch                    (1) | Train Loss: 0.8354 | Train Acc: 0.7603
Average Train Accuracy: 0.8858
 Site-photo                     (0) | Val  Loss: 0.3404 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2573 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2485 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.2731 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.2317 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.3707 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.4350 | Val  Acc: 0.9365
 Site-art_painting              (0) | Val  Loss: 0.6370 | Val  Acc: 0.8803
 Site-cartoon                   (0) | Val  Loss: 0.6985 | Val  Acc: 0.8261
 Site-cartoon                   (0) | Val  Loss: 0.6316 | Val  Acc: 0.8522
 Site-sketch                    (1) | Val  Loss: 0.9714 | Val  Acc: 0.7125
Average Valid Accuracy: 0.9049
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.9643
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.9365
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.8803
 Best site-cartoon                  (0)  | Epoch:15 | Val Acc: 0.8261
 Best site-cartoon                  (0)  | Epoch:15 | Val Acc: 0.8522
 Best site-sketch                   (1)  | Epoch:15 | Val Acc: 0.7125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 8, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (1) | Train Loss: 0.2472 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2217 | Train Acc: 0.9265
 Site-photo                     (1) | Train Loss: 0.1947 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.2302 | Train Acc: 0.9739
 Site-photo                     (1) | Train Loss: 0.2257 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.6219 | Train Acc: 0.8571
 Site-art_painting              (1) | Train Loss: 0.5433 | Train Acc: 0.8316
 Site-art_painting              (1) | Train Loss: 0.4936 | Train Acc: 0.8967
 Site-cartoon                   (0) | Train Loss: 0.6300 | Train Acc: 0.8529
 Site-cartoon                   (0) | Train Loss: 0.6173 | Train Acc: 0.8488
 Site-sketch                    (0) | Train Loss: 0.8186 | Train Acc: 0.7025
Average Train Accuracy: 0.8940
 Site-photo                     (1) | Val  Loss: 0.2815 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.2928 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.2241 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.2440 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.2148 | Val  Acc: 0.9803
 Site-art_painting              (1) | Val  Loss: 0.4872 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.3640 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.6265 | Val  Acc: 0.8803
 Site-cartoon                   (0) | Val  Loss: 0.6655 | Val  Acc: 0.8261
 Site-cartoon                   (0) | Val  Loss: 0.5940 | Val  Acc: 0.8435
 Site-sketch                    (0) | Val  Loss: 1.0151 | Val  Acc: 0.6750
Average Valid Accuracy: 0.8964
============ Train epoch 17 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (0) | Train Loss: 0.2644 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1769 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1879 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2234 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2089 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.5611 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.4659 | Train Acc: 0.8842
 Site-art_painting              (0) | Train Loss: 0.4476 | Train Acc: 0.9202
 Site-cartoon                   (0) | Train Loss: 0.6448 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.6332 | Train Acc: 0.8140
 Site-sketch                    (1) | Train Loss: 0.7689 | Train Acc: 0.7355
Average Train Accuracy: 0.8992
 Site-photo                     (0) | Val  Loss: 0.2271 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2642 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2098 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.2394 | Val  Acc: 0.9412
 Site-photo                     (0) | Val  Loss: 0.1983 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.5366 | Val  Acc: 0.8571
 Site-art_painting              (0) | Val  Loss: 0.3658 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.5684 | Val  Acc: 0.8944
 Site-cartoon                   (0) | Val  Loss: 0.6452 | Val  Acc: 0.8261
 Site-cartoon                   (0) | Val  Loss: 0.5570 | Val  Acc: 0.8609
 Site-sketch                    (1) | Val  Loss: 1.0975 | Val  Acc: 0.6875
Average Valid Accuracy: 0.8963
============ Train epoch 18 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (0) | Train Loss: 0.2327 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1570 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1510 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1872 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.2196 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.5343 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.5710 | Train Acc: 0.8526
 Site-art_painting              (0) | Train Loss: 0.4145 | Train Acc: 0.8967
 Site-cartoon                   (0) | Train Loss: 0.6234 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.6338 | Train Acc: 0.8372
 Site-sketch                    (1) | Train Loss: 0.7568 | Train Acc: 0.7521
Average Train Accuracy: 0.8999
 Site-photo                     (0) | Val  Loss: 0.3117 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2088 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1950 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.2301 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1846 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.4305 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.3448 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.4959 | Val  Acc: 0.9085
 Site-cartoon                   (0) | Val  Loss: 0.6255 | Val  Acc: 0.9130
 Site-cartoon                   (0) | Val  Loss: 0.5415 | Val  Acc: 0.8696
 Site-sketch                    (1) | Val  Loss: 1.0317 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9135
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9510
 Best site-photo                    (0)  | Epoch:18 | Val Acc: 0.9803
 Best site-art_painting             (0)  | Epoch:18 | Val Acc: 0.9286
 Best site-art_painting             (0)  | Epoch:18 | Val Acc: 0.9524
 Best site-art_painting             (0)  | Epoch:18 | Val Acc: 0.9085
 Best site-cartoon                  (0)  | Epoch:18 | Val Acc: 0.9130
 Best site-cartoon                  (0)  | Epoch:18 | Val Acc: 0.8696
 Best site-sketch                   (1)  | Epoch:18 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 19 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (0) | Train Loss: 0.2097 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.3222 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1588 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1909 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1894 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.5453 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.4692 | Train Acc: 0.8526
 Site-art_painting              (0) | Train Loss: 0.4616 | Train Acc: 0.9108
 Site-cartoon                   (0) | Train Loss: 0.6062 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.5860 | Train Acc: 0.8488
 Site-sketch                    (1) | Train Loss: 0.7242 | Train Acc: 0.7603
Average Train Accuracy: 0.8965
 Site-photo                     (0) | Val  Loss: 0.2697 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1831 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1867 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1784 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1790 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.3367 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.4212 | Val  Acc: 0.8730
 Site-art_painting              (0) | Val  Loss: 0.4758 | Val  Acc: 0.9014
 Site-cartoon                   (0) | Val  Loss: 0.6498 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.5162 | Val  Acc: 0.8957
 Site-sketch                    (1) | Val  Loss: 0.8954 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9089
============ Train epoch 20 ============
cnt=[8, 3, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (0) | Train Loss: 0.1748 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1361 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1414 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.2137 | Train Acc: 0.9608
 Site-photo                     (0) | Train Loss: 0.1980 | Train Acc: 0.9607
 Site-art_painting              (0) | Train Loss: 0.4863 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.4041 | Train Acc: 0.8842
 Site-art_painting              (0) | Train Loss: 0.3694 | Train Acc: 0.9202
 Site-cartoon                   (1) | Train Loss: 0.5661 | Train Acc: 0.8235
 Site-cartoon                   (1) | Train Loss: 0.5433 | Train Acc: 0.8430
 Site-sketch                    (1) | Train Loss: 0.7604 | Train Acc: 0.7438
Average Train Accuracy: 0.9049
 Site-photo                     (0) | Val  Loss: 0.2711 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.2041 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1469 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1716 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1448 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.4319 | Val  Acc: 0.8571
 Site-art_painting              (0) | Val  Loss: 0.3989 | Val  Acc: 0.8889
 Site-art_painting              (0) | Val  Loss: 0.5013 | Val  Acc: 0.9085
 Site-cartoon                   (1) | Val  Loss: 0.5030 | Val  Acc: 0.9130
 Site-cartoon                   (1) | Val  Loss: 0.5162 | Val  Acc: 0.8696
 Site-sketch                    (1) | Val  Loss: 0.8780 | Val  Acc: 0.7250
Average Valid Accuracy: 0.9018
============ Train epoch 21 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (0) | Train Loss: 0.2113 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1551 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1214 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1659 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1758 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.5238 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.4750 | Train Acc: 0.8632
 Site-art_painting              (0) | Train Loss: 0.3566 | Train Acc: 0.9155
 Site-cartoon                   (0) | Train Loss: 0.5751 | Train Acc: 0.7941
 Site-cartoon                   (0) | Train Loss: 0.5463 | Train Acc: 0.8721
 Site-sketch                    (1) | Train Loss: 0.6640 | Train Acc: 0.7769
Average Train Accuracy: 0.9070
 Site-photo                     (0) | Val  Loss: 0.2798 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1890 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1467 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1602 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1504 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.3456 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.3247 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.4926 | Val  Acc: 0.9155
 Site-cartoon                   (0) | Val  Loss: 0.5616 | Val  Acc: 0.9130
 Site-cartoon                   (0) | Val  Loss: 0.4927 | Val  Acc: 0.8957
 Site-sketch                    (1) | Val  Loss: 0.9122 | Val  Acc: 0.6625
Average Valid Accuracy: 0.9201
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9803
 Best site-art_painting             (0)  | Epoch:21 | Val Acc: 0.9643
 Best site-art_painting             (0)  | Epoch:21 | Val Acc: 0.9524
 Best site-art_painting             (0)  | Epoch:21 | Val Acc: 0.9155
 Best site-cartoon                  (0)  | Epoch:21 | Val Acc: 0.9130
 Best site-cartoon                  (0)  | Epoch:21 | Val Acc: 0.8957
 Best site-sketch                   (1)  | Epoch:21 | Val Acc: 0.6625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 22 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (0) | Train Loss: 0.1621 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.1336 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1155 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1551 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1633 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.5012 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.4285 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.3264 | Train Acc: 0.9296
 Site-cartoon                   (0) | Train Loss: 0.6865 | Train Acc: 0.7647
 Site-cartoon                   (0) | Train Loss: 0.5960 | Train Acc: 0.8081
 Site-sketch                    (1) | Train Loss: 0.6311 | Train Acc: 0.8099
Average Train Accuracy: 0.9062
 Site-photo                     (0) | Val  Loss: 0.1800 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2139 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1505 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1718 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1426 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2786 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.3315 | Val  Acc: 0.8889
 Site-art_painting              (0) | Val  Loss: 0.4046 | Val  Acc: 0.9437
 Site-cartoon                   (0) | Val  Loss: 0.5397 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.4836 | Val  Acc: 0.8783
 Site-sketch                    (1) | Val  Loss: 0.9365 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9092
============ Train epoch 23 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (0) | Train Loss: 0.1546 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1880 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1310 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1475 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1431 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4681 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.4386 | Train Acc: 0.9263
 Site-art_painting              (0) | Train Loss: 0.3440 | Train Acc: 0.9343
 Site-cartoon                   (0) | Train Loss: 0.6373 | Train Acc: 0.8529
 Site-cartoon                   (0) | Train Loss: 0.5210 | Train Acc: 0.8895
 Site-sketch                    (1) | Train Loss: 0.6328 | Train Acc: 0.7934
Average Train Accuracy: 0.9240
 Site-photo                     (0) | Val  Loss: 0.2156 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1906 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1426 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1429 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1277 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.3591 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.3097 | Val  Acc: 0.9206
 Site-art_painting              (0) | Val  Loss: 0.4532 | Val  Acc: 0.9014
 Site-cartoon                   (0) | Val  Loss: 0.5820 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.4909 | Val  Acc: 0.8783
 Site-sketch                    (1) | Val  Loss: 0.8987 | Val  Acc: 0.7000
Average Valid Accuracy: 0.9089
============ Train epoch 24 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (0) | Train Loss: 0.1712 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.2248 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.1268 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1295 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1507 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4693 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.3785 | Train Acc: 0.8947
 Site-art_painting              (0) | Train Loss: 0.3372 | Train Acc: 0.9108
 Site-cartoon                   (0) | Train Loss: 0.5493 | Train Acc: 0.7941
 Site-cartoon                   (0) | Train Loss: 0.4885 | Train Acc: 0.8837
 Site-sketch                    (1) | Train Loss: 0.5969 | Train Acc: 0.8099
Average Train Accuracy: 0.9074
 Site-photo                     (0) | Val  Loss: 0.1691 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.2468 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1223 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1528 | Val  Acc: 0.9510
 Site-photo                     (0) | Val  Loss: 0.1198 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.3461 | Val  Acc: 0.8571
 Site-art_painting              (0) | Val  Loss: 0.2737 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.4510 | Val  Acc: 0.9225
 Site-cartoon                   (0) | Val  Loss: 0.5750 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.4331 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.8485 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9197
============ Train epoch 25 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (0) | Train Loss: 0.1467 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1000 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1167 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1435 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1473 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.4920 | Train Acc: 0.8571
 Site-art_painting              (0) | Train Loss: 0.4098 | Train Acc: 0.8947
 Site-art_painting              (0) | Train Loss: 0.3580 | Train Acc: 0.8967
 Site-cartoon                   (0) | Train Loss: 0.4897 | Train Acc: 0.8824
 Site-cartoon                   (0) | Train Loss: 0.4616 | Train Acc: 0.8779
 Site-sketch                    (1) | Train Loss: 0.6502 | Train Acc: 0.8182
Average Train Accuracy: 0.9184
 Site-photo                     (0) | Val  Loss: 0.2290 | Val  Acc: 0.9000
 Site-photo                     (0) | Val  Loss: 0.2076 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1304 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1482 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1385 | Val  Acc: 0.9737
 Site-art_painting              (0) | Val  Loss: 0.2159 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2367 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.3593 | Val  Acc: 0.9577
 Site-cartoon                   (0) | Val  Loss: 0.5215 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.4094 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.9219 | Val  Acc: 0.6750
Average Valid Accuracy: 0.9217
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9000
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9559
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9608
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9737
 Best site-art_painting             (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:25 | Val Acc: 0.9683
 Best site-art_painting             (0)  | Epoch:25 | Val Acc: 0.9577
 Best site-cartoon                  (0)  | Epoch:25 | Val Acc: 0.8696
 Best site-cartoon                  (0)  | Epoch:25 | Val Acc: 0.9217
 Best site-sketch                   (1)  | Epoch:25 | Val Acc: 0.6750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 26 ============
cnt=[1, 10, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (1) | Train Loss: 0.1210 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1492 | Train Acc: 0.9559
 Site-photo                     (1) | Train Loss: 0.0893 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1254 | Train Acc: 0.9542
 Site-photo                     (1) | Train Loss: 0.1398 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.3407 | Train Acc: 0.8810
 Site-art_painting              (1) | Train Loss: 0.4082 | Train Acc: 0.9158
 Site-art_painting              (1) | Train Loss: 0.2884 | Train Acc: 0.9249
 Site-cartoon                   (1) | Train Loss: 0.5050 | Train Acc: 0.9118
 Site-cartoon                   (1) | Train Loss: 0.4756 | Train Acc: 0.8895
 Site-sketch                    (0) | Train Loss: 0.6139 | Train Acc: 0.7769
Average Train Accuracy: 0.9249
 Site-photo                     (1) | Val  Loss: 0.2685 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.2099 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1207 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1393 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.1210 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.2060 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.2662 | Val  Acc: 0.9365
 Site-art_painting              (1) | Val  Loss: 0.4090 | Val  Acc: 0.9225
 Site-cartoon                   (1) | Val  Loss: 0.4787 | Val  Acc: 0.8696
 Site-cartoon                   (1) | Val  Loss: 0.4412 | Val  Acc: 0.8870
 Site-sketch                    (0) | Val  Loss: 0.8841 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9239
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9706
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9510
 Best site-photo                    (1)  | Epoch:26 | Val Acc: 0.9868
 Best site-art_painting             (1)  | Epoch:26 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:26 | Val Acc: 0.9365
 Best site-art_painting             (1)  | Epoch:26 | Val Acc: 0.9225
 Best site-cartoon                  (1)  | Epoch:26 | Val Acc: 0.8696
 Best site-cartoon                  (1)  | Epoch:26 | Val Acc: 0.8870
 Best site-sketch                   (0)  | Epoch:26 | Val Acc: 0.7500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 10, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (1) | Train Loss: 0.1325 | Train Acc: 0.9778
 Site-photo                     (1) | Train Loss: 0.0933 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.0928 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1468 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.1438 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.5360 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.3748 | Train Acc: 0.9053
 Site-art_painting              (1) | Train Loss: 0.2829 | Train Acc: 0.9296
 Site-cartoon                   (1) | Train Loss: 0.4949 | Train Acc: 0.8824
 Site-cartoon                   (1) | Train Loss: 0.4813 | Train Acc: 0.8430
 Site-sketch                    (0) | Train Loss: 0.6176 | Train Acc: 0.7934
Average Train Accuracy: 0.9151
 Site-photo                     (1) | Val  Loss: 0.1656 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.1745 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1113 | Val  Acc: 0.9559
 Site-photo                     (1) | Val  Loss: 0.1360 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1156 | Val  Acc: 0.9934
 Site-art_painting              (1) | Val  Loss: 0.2514 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.2291 | Val  Acc: 0.9524
 Site-art_painting              (1) | Val  Loss: 0.3408 | Val  Acc: 0.9366
 Site-cartoon                   (1) | Val  Loss: 0.5811 | Val  Acc: 0.8261
 Site-cartoon                   (1) | Val  Loss: 0.4526 | Val  Acc: 0.8609
 Site-sketch                    (0) | Val  Loss: 0.8085 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9148
============ Train epoch 28 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (0) | Train Loss: 0.1232 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1268 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0978 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1512 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.1242 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.5033 | Train Acc: 0.8095
 Site-art_painting              (0) | Train Loss: 0.3367 | Train Acc: 0.9263
 Site-art_painting              (0) | Train Loss: 0.2826 | Train Acc: 0.9202
 Site-cartoon                   (0) | Train Loss: 0.5611 | Train Acc: 0.7647
 Site-cartoon                   (0) | Train Loss: 0.4608 | Train Acc: 0.8721
 Site-sketch                    (1) | Train Loss: 0.5323 | Train Acc: 0.8347
Average Train Accuracy: 0.9118
 Site-photo                     (0) | Val  Loss: 0.2102 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2142 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1159 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1477 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1023 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2456 | Val  Acc: 0.8929
 Site-art_painting              (0) | Val  Loss: 0.2133 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.2994 | Val  Acc: 0.9437
 Site-cartoon                   (0) | Val  Loss: 0.5015 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.4128 | Val  Acc: 0.9130
 Site-sketch                    (1) | Val  Loss: 0.8828 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9259
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9608
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.8929
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9841
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9437
 Best site-cartoon                  (0)  | Epoch:28 | Val Acc: 0.8696
 Best site-cartoon                  (0)  | Epoch:28 | Val Acc: 0.9130
 Best site-sketch                   (1)  | Epoch:28 | Val Acc: 0.7750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 29 ============
cnt=[1, 10, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (1) | Train Loss: 0.1133 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0740 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.1073 | Train Acc: 0.9902
 Site-photo                     (1) | Train Loss: 0.1191 | Train Acc: 0.9673
 Site-photo                     (1) | Train Loss: 0.1348 | Train Acc: 0.9782
 Site-art_painting              (1) | Train Loss: 0.4632 | Train Acc: 0.8095
 Site-art_painting              (1) | Train Loss: 0.4217 | Train Acc: 0.8842
 Site-art_painting              (1) | Train Loss: 0.2895 | Train Acc: 0.9296
 Site-cartoon                   (1) | Train Loss: 0.4796 | Train Acc: 0.8824
 Site-cartoon                   (1) | Train Loss: 0.4715 | Train Acc: 0.8779
 Site-sketch                    (0) | Train Loss: 0.5498 | Train Acc: 0.7769
Average Train Accuracy: 0.9152
 Site-photo                     (1) | Val  Loss: 0.1752 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.1671 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1033 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1295 | Val  Acc: 0.9510
 Site-photo                     (1) | Val  Loss: 0.1066 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.2577 | Val  Acc: 0.8929
 Site-art_painting              (1) | Val  Loss: 0.2010 | Val  Acc: 0.9683
 Site-art_painting              (1) | Val  Loss: 0.4247 | Val  Acc: 0.9225
 Site-cartoon                   (1) | Val  Loss: 0.4760 | Val  Acc: 0.9130
 Site-cartoon                   (1) | Val  Loss: 0.3881 | Val  Acc: 0.9217
 Site-sketch                    (0) | Val  Loss: 0.8213 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9253
============ Train epoch 30 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (0) | Train Loss: 0.1280 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1113 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.0780 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1090 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1332 | Train Acc: 0.9651
 Site-art_painting              (0) | Train Loss: 0.3746 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.3016 | Train Acc: 0.9263
 Site-art_painting              (0) | Train Loss: 0.2606 | Train Acc: 0.9484
 Site-cartoon                   (0) | Train Loss: 0.5141 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.4542 | Train Acc: 0.8721
 Site-sketch                    (1) | Train Loss: 0.5247 | Train Acc: 0.8347
Average Train Accuracy: 0.9226
 Site-photo                     (0) | Val  Loss: 0.1686 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1436 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0976 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1122 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.1077 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.2290 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.1946 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3483 | Val  Acc: 0.9296
 Site-cartoon                   (0) | Val  Loss: 0.5271 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.3816 | Val  Acc: 0.9304
 Site-sketch                    (1) | Val  Loss: 0.8639 | Val  Acc: 0.7125
Average Valid Accuracy: 0.9315
 Best site-photo                    (0)  | Epoch:30 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:30 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:30 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:30 | Val Acc: 0.9608
 Best site-photo                    (0)  | Epoch:30 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:30 | Val Acc: 0.9643
 Best site-art_painting             (0)  | Epoch:30 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:30 | Val Acc: 0.9296
 Best site-cartoon                  (0)  | Epoch:30 | Val Acc: 0.8696
 Best site-cartoon                  (0)  | Epoch:30 | Val Acc: 0.9304
 Best site-sketch                   (1)  | Epoch:30 | Val Acc: 0.7125
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 31 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (0) | Train Loss: 0.1201 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4968 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.0780 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1264 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1147 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4274 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3556 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.2714 | Train Acc: 0.9390
 Site-cartoon                   (0) | Train Loss: 0.5642 | Train Acc: 0.8529
 Site-cartoon                   (0) | Train Loss: 0.4374 | Train Acc: 0.8663
 Site-sketch                    (1) | Train Loss: 0.4725 | Train Acc: 0.8760
Average Train Accuracy: 0.9257
 Site-photo                     (0) | Val  Loss: 0.2226 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1843 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0891 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1257 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1084 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.1974 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2721 | Val  Acc: 0.9365
 Site-art_painting              (0) | Val  Loss: 0.3856 | Val  Acc: 0.9296
 Site-cartoon                   (0) | Val  Loss: 0.4559 | Val  Acc: 0.9130
 Site-cartoon                   (0) | Val  Loss: 0.3651 | Val  Acc: 0.9391
 Site-sketch                    (1) | Val  Loss: 0.7153 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9313
============ Train epoch 32 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (0) | Train Loss: 0.0998 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4028 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0859 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1109 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1192 | Train Acc: 0.9825
 Site-art_painting              (0) | Train Loss: 0.4721 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3441 | Train Acc: 0.8947
 Site-art_painting              (0) | Train Loss: 0.2656 | Train Acc: 0.9155
 Site-cartoon                   (0) | Train Loss: 0.5488 | Train Acc: 0.7941
 Site-cartoon                   (0) | Train Loss: 0.4142 | Train Acc: 0.8779
 Site-sketch                    (1) | Train Loss: 0.5173 | Train Acc: 0.8182
Average Train Accuracy: 0.9137
 Site-photo                     (0) | Val  Loss: 0.1499 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.2021 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1152 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1213 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1078 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.2034 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.1859 | Val  Acc: 0.9841
 Site-art_painting              (0) | Val  Loss: 0.3382 | Val  Acc: 0.9296
 Site-cartoon                   (0) | Val  Loss: 0.4672 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.3769 | Val  Acc: 0.8957
 Site-sketch                    (1) | Val  Loss: 0.8451 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9295
============ Train epoch 33 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (0) | Train Loss: 0.1751 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.0962 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.0903 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.0964 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1306 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.4050 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.2984 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2671 | Train Acc: 0.9155
 Site-cartoon                   (0) | Train Loss: 0.4650 | Train Acc: 0.8529
 Site-cartoon                   (0) | Train Loss: 0.4283 | Train Acc: 0.8721
 Site-sketch                    (1) | Train Loss: 0.5321 | Train Acc: 0.8182
Average Train Accuracy: 0.9238
 Site-photo                     (0) | Val  Loss: 0.1061 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1045 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.0776 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1211 | Val  Acc: 0.9608
 Site-photo                     (0) | Val  Loss: 0.0805 | Val  Acc: 0.9934
 Site-art_painting              (0) | Val  Loss: 0.2487 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2213 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.3047 | Val  Acc: 0.9225
 Site-cartoon                   (0) | Val  Loss: 0.5333 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.3748 | Val  Acc: 0.9478
 Site-sketch                    (1) | Val  Loss: 0.7763 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9335
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9608
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9934
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9286
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9683
 Best site-art_painting             (0)  | Epoch:33 | Val Acc: 0.9225
 Best site-cartoon                  (0)  | Epoch:33 | Val Acc: 0.8696
 Best site-cartoon                  (0)  | Epoch:33 | Val Acc: 0.9478
 Best site-sketch                   (1)  | Epoch:33 | Val Acc: 0.7625
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 34 ============
cnt=[3, 8, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (1) | Train Loss: 0.1693 | Train Acc: 0.9556
 Site-photo                     (1) | Train Loss: 0.1382 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.0739 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1081 | Train Acc: 0.9739
 Site-photo                     (1) | Train Loss: 0.1314 | Train Acc: 0.9738
 Site-art_painting              (1) | Train Loss: 0.4321 | Train Acc: 0.8571
 Site-art_painting              (1) | Train Loss: 0.4049 | Train Acc: 0.8947
 Site-art_painting              (1) | Train Loss: 0.2542 | Train Acc: 0.9390
 Site-cartoon                   (0) | Train Loss: 0.4432 | Train Acc: 0.8824
 Site-cartoon                   (0) | Train Loss: 0.3700 | Train Acc: 0.9128
 Site-sketch                    (0) | Train Loss: 0.5612 | Train Acc: 0.7934
Average Train Accuracy: 0.9244
 Site-photo                     (1) | Val  Loss: 0.1516 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.2143 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1038 | Val  Acc: 0.9706
 Site-photo                     (1) | Val  Loss: 0.1085 | Val  Acc: 0.9804
 Site-photo                     (1) | Val  Loss: 0.1054 | Val  Acc: 0.9868
 Site-art_painting              (1) | Val  Loss: 0.2616 | Val  Acc: 0.9286
 Site-art_painting              (1) | Val  Loss: 0.2658 | Val  Acc: 0.9206
 Site-art_painting              (1) | Val  Loss: 0.3076 | Val  Acc: 0.9437
 Site-cartoon                   (0) | Val  Loss: 0.3702 | Val  Acc: 0.9130
 Site-cartoon                   (0) | Val  Loss: 0.3455 | Val  Acc: 0.9043
 Site-sketch                    (0) | Val  Loss: 0.8306 | Val  Acc: 0.7750
Average Valid Accuracy: 0.9284
============ Train epoch 35 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (0) | Train Loss: 0.1211 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1407 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0878 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1198 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.1124 | Train Acc: 0.9694
 Site-art_painting              (0) | Train Loss: 0.3213 | Train Acc: 0.9524
 Site-art_painting              (0) | Train Loss: 0.3610 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.2460 | Train Acc: 0.9343
 Site-cartoon                   (0) | Train Loss: 0.4383 | Train Acc: 0.8824
 Site-cartoon                   (0) | Train Loss: 0.4194 | Train Acc: 0.8953
 Site-sketch                    (1) | Train Loss: 0.4655 | Train Acc: 0.8430
Average Train Accuracy: 0.9359
 Site-photo                     (0) | Val  Loss: 0.1426 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1540 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0881 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1379 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1006 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.1428 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.1682 | Val  Acc: 0.9683
 Site-art_painting              (0) | Val  Loss: 0.3488 | Val  Acc: 0.9225
 Site-cartoon                   (0) | Val  Loss: 0.3637 | Val  Acc: 0.9565
 Site-cartoon                   (0) | Val  Loss: 0.3468 | Val  Acc: 0.9130
 Site-sketch                    (1) | Val  Loss: 0.6803 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9419
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9667
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9706
 Best site-photo                    (0)  | Epoch:35 | Val Acc: 0.9868
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 0.9683
 Best site-art_painting             (0)  | Epoch:35 | Val Acc: 0.9225
 Best site-cartoon                  (0)  | Epoch:35 | Val Acc: 0.9565
 Best site-cartoon                  (0)  | Epoch:35 | Val Acc: 0.9130
 Best site-sketch                   (1)  | Epoch:35 | Val Acc: 0.7500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_1.7_1_cluster_2/ccop_q=1...
============ Train epoch 36 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (0) | Train Loss: 0.1475 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.0954 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.0863 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1260 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.0835 | Train Acc: 0.9869
 Site-art_painting              (0) | Train Loss: 0.3969 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.2993 | Train Acc: 0.9263
 Site-art_painting              (0) | Train Loss: 0.2651 | Train Acc: 0.9155
 Site-cartoon                   (0) | Train Loss: 0.5182 | Train Acc: 0.8235
 Site-cartoon                   (0) | Train Loss: 0.3804 | Train Acc: 0.9070
 Site-sketch                    (1) | Train Loss: 0.4915 | Train Acc: 0.8430
Average Train Accuracy: 0.9282
 Site-photo                     (0) | Val  Loss: 0.1335 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1424 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0997 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1207 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.0883 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.1485 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.2129 | Val  Acc: 0.9365
 Site-art_painting              (0) | Val  Loss: 0.2886 | Val  Acc: 0.9155
 Site-cartoon                   (0) | Val  Loss: 0.3466 | Val  Acc: 0.8696
 Site-cartoon                   (0) | Val  Loss: 0.3582 | Val  Acc: 0.8957
 Site-sketch                    (1) | Val  Loss: 0.6499 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9260
============ Train epoch 37 ============
cnt=[8, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (0) | Train Loss: 0.1085 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1157 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0919 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1235 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.0954 | Train Acc: 0.9782
 Site-art_painting              (0) | Train Loss: 0.4354 | Train Acc: 0.9048
 Site-art_painting              (0) | Train Loss: 0.3348 | Train Acc: 0.9158
 Site-art_painting              (0) | Train Loss: 0.2365 | Train Acc: 0.9484
 Site-cartoon                   (1) | Train Loss: 0.3930 | Train Acc: 0.8824
 Site-cartoon                   (1) | Train Loss: 0.3128 | Train Acc: 0.9477
 Site-sketch                    (1) | Train Loss: 0.4499 | Train Acc: 0.8347
Average Train Accuracy: 0.9383
 Site-photo                     (0) | Val  Loss: 0.1068 | Val  Acc: 0.9667
 Site-photo                     (0) | Val  Loss: 0.1306 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0848 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1040 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1013 | Val  Acc: 0.9934
 Site-art_painting              (0) | Val  Loss: 0.1919 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.2041 | Val  Acc: 0.9365
 Site-art_painting              (0) | Val  Loss: 0.3202 | Val  Acc: 0.9225
 Site-cartoon                   (1) | Val  Loss: 0.4295 | Val  Acc: 0.9565
 Site-cartoon                   (1) | Val  Loss: 0.3106 | Val  Acc: 0.9217
 Site-sketch                    (1) | Val  Loss: 0.7857 | Val  Acc: 0.7875
Average Valid Accuracy: 0.9405
============ Train epoch 38 ============
cnt=[8, 3, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (0) | Train Loss: 0.1355 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.1198 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0763 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1427 | Train Acc: 0.9739
 Site-photo                     (0) | Train Loss: 0.0952 | Train Acc: 0.9782
 Site-art_painting              (0) | Train Loss: 0.4258 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.2965 | Train Acc: 0.9053
 Site-art_painting              (0) | Train Loss: 0.2389 | Train Acc: 0.9390
 Site-cartoon                   (1) | Train Loss: 0.4275 | Train Acc: 0.8824
 Site-cartoon                   (1) | Train Loss: 0.3566 | Train Acc: 0.9128
 Site-sketch                    (1) | Train Loss: 0.4618 | Train Acc: 0.8430
Average Train Accuracy: 0.9322
 Site-photo                     (0) | Val  Loss: 0.2004 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1429 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0839 | Val  Acc: 0.9853
 Site-photo                     (0) | Val  Loss: 0.0947 | Val  Acc: 0.9804
 Site-photo                     (0) | Val  Loss: 0.0876 | Val  Acc: 0.9803
 Site-art_painting              (0) | Val  Loss: 0.2161 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2345 | Val  Acc: 0.9206
 Site-art_painting              (0) | Val  Loss: 0.3283 | Val  Acc: 0.9155
 Site-cartoon                   (1) | Val  Loss: 0.3007 | Val  Acc: 0.9565
 Site-cartoon                   (1) | Val  Loss: 0.3052 | Val  Acc: 0.9304
 Site-sketch                    (1) | Val  Loss: 0.8035 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9317
============ Train epoch 39 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (0) | Train Loss: 0.0935 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.0997 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0582 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1188 | Train Acc: 0.9804
 Site-photo                     (0) | Train Loss: 0.1012 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.4107 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3045 | Train Acc: 0.9263
 Site-art_painting              (0) | Train Loss: 0.2137 | Train Acc: 0.9390
 Site-cartoon                   (0) | Train Loss: 0.4191 | Train Acc: 0.9118
 Site-cartoon                   (0) | Train Loss: 0.3505 | Train Acc: 0.9128
 Site-sketch                    (1) | Train Loss: 0.5182 | Train Acc: 0.8430
Average Train Accuracy: 0.9326
 Site-photo                     (0) | Val  Loss: 0.1359 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1225 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.0839 | Val  Acc: 0.9706
 Site-photo                     (0) | Val  Loss: 0.1092 | Val  Acc: 0.9804
 Site-photo                     (0) | Val  Loss: 0.0821 | Val  Acc: 0.9868
 Site-art_painting              (0) | Val  Loss: 0.1606 | Val  Acc: 0.9643
 Site-art_painting              (0) | Val  Loss: 0.1973 | Val  Acc: 0.9524
 Site-art_painting              (0) | Val  Loss: 0.3840 | Val  Acc: 0.9296
 Site-cartoon                   (0) | Val  Loss: 0.3827 | Val  Acc: 0.9130
 Site-cartoon                   (0) | Val  Loss: 0.3344 | Val  Acc: 0.9130
 Site-sketch                    (1) | Val  Loss: 0.7646 | Val  Acc: 0.7625
Average Valid Accuracy: 0.9329
============ Train epoch 40 ============
cnt=[10, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (0) | Train Loss: 0.0970 | Train Acc: 0.9778
 Site-photo                     (0) | Train Loss: 0.0571 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.0689 | Train Acc: 0.9902
 Site-photo                     (0) | Train Loss: 0.1258 | Train Acc: 0.9673
 Site-photo                     (0) | Train Loss: 0.0969 | Train Acc: 0.9738
 Site-art_painting              (0) | Train Loss: 0.3936 | Train Acc: 0.8810
 Site-art_painting              (0) | Train Loss: 0.2482 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2306 | Train Acc: 0.9249
 Site-cartoon                   (0) | Train Loss: 0.4434 | Train Acc: 0.8824
 Site-cartoon                   (0) | Train Loss: 0.3452 | Train Acc: 0.9186
 Site-sketch                    (1) | Train Loss: 0.4254 | Train Acc: 0.8760
Average Train Accuracy: 0.9386
 Site-photo                     (0) | Val  Loss: 0.0745 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1259 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.0812 | Val  Acc: 0.9559
 Site-photo                     (0) | Val  Loss: 0.1051 | Val  Acc: 0.9804
 Site-photo                     (0) | Val  Loss: 0.1004 | Val  Acc: 0.9934
 Site-art_painting              (0) | Val  Loss: 0.2003 | Val  Acc: 0.9286
 Site-art_painting              (0) | Val  Loss: 0.2310 | Val  Acc: 0.9206
 Site-art_painting              (0) | Val  Loss: 0.3121 | Val  Acc: 0.9437
 Site-cartoon                   (0) | Val  Loss: 0.3007 | Val  Acc: 0.9565
 Site-cartoon                   (0) | Val  Loss: 0.3142 | Val  Acc: 0.8957
 Site-sketch                    (1) | Val  Loss: 0.7314 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9366
 Test site-photo                     (0)| Epoch:35 | Test Acc: 0.9925
 Test site-art_painting              (0)| Epoch:35 | Test Acc: 0.9062
 Test site-cartoon                   (0)| Epoch:35 | Test Acc: 0.8628
 Test site-sketch                    (1)| Epoch:35 | Test Acc: 0.8107
photo: 0.9925, art_painting: 0.9062, cartoon: 0.8628, sketch: 0.8107, 
Average Test Accuracy(group): 0.8930, Average Test Accuracy(individual): 0.9289,
domain std=0.0667, cluster std=0.0650, individual std=0.0636, 
===2023-08-10 15:01:00===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 2
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[45,68,102,153,229,42,95,213,34,172,121,
client_nums=[5,3,2,1,]
len_dataset=[1000,588,345,202,]
domain number = 2
Loading snapshots...
 Test site-photo                     (0)| Epoch:35 | Test Acc: 0.9940
 Test site-art_painting              (0)| Epoch:35 | Test Acc: 0.9001
 Test site-cartoon                   (0)| Epoch:35 | Test Acc: 0.8638
 Test site-sketch                    (1)| Epoch:35 | Test Acc: 0.7980
photo: 0.9940, art_painting: 0.9001, cartoon: 0.8638, sketch: 0.7980, 
Average Test Accuracy(group): 0.8890, Average Test Accuracy(individual): 0.9269,
domain std=0.0708, cluster std=0.0709, individual std=0.0669, 
