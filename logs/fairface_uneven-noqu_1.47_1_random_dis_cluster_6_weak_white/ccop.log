===2023-06-15 10:57:26===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 1, 8, 16, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (0) | Train Loss: 2.1791 | Train Acc: 0.0833
 Site-White_utk                 (4) | Train Loss: 2.1892 | Train Acc: 0.1176
 Site-White_utk                 (4) | Train Loss: 2.2624 | Train Acc: 0.1154
 Site-White_utk                 (4) | Train Loss: 2.2818 | Train Acc: 0.0789
 Site-White_utk                 (4) | Train Loss: 2.2507 | Train Acc: 0.0893
 Site-White_utk                 (4) | Train Loss: 2.2254 | Train Acc: 0.1341
 Site-White_utk                 (4) | Train Loss: 2.1983 | Train Acc: 0.1240
 Site-White_utk                 (4) | Train Loss: 2.2110 | Train Acc: 0.1061
 Site-White_utk                 (4) | Train Loss: 2.2412 | Train Acc: 0.1027
 Site-White_utk                 (4) | Train Loss: 2.2068 | Train Acc: 0.1111
 Site-East_Asian                (3) | Train Loss: 1.8917 | Train Acc: 0.4815
 Site-East_Asian                (3) | Train Loss: 1.9416 | Train Acc: 0.4500
 Site-East_Asian                (2) | Train Loss: 1.9573 | Train Acc: 0.3559
 Site-East_Asian                (3) | Train Loss: 1.9491 | Train Acc: 0.3605
 Site-East_Asian                (3) | Train Loss: 1.9426 | Train Acc: 0.3937
 Site-East_Asian                (3) | Train Loss: 1.9654 | Train Acc: 0.3636
 Site-East_Asian                (3) | Train Loss: 1.8997 | Train Acc: 0.4058
 Site-Indian_utk                (5) | Train Loss: 2.0312 | Train Acc: 0.3256
 Site-Indian_utk                (4) | Train Loss: 1.9294 | Train Acc: 0.3750
 Site-Indian_utk                (4) | Train Loss: 2.0111 | Train Acc: 0.3085
 Site-Indian_utk                (4) | Train Loss: 1.9749 | Train Acc: 0.3597
 Site-Indian_utk                (4) | Train Loss: 2.0242 | Train Acc: 0.3366
 Site-Black_utk                 (4) | Train Loss: 1.9781 | Train Acc: 0.3273
 Site-Black_utk                 (4) | Train Loss: 1.9903 | Train Acc: 0.2963
 Site-Black_utk                 (4) | Train Loss: 2.0229 | Train Acc: 0.2437
 Site-Southeast_Asian           (3) | Train Loss: 2.0387 | Train Acc: 0.3333
 Site-Southeast_Asian           (3) | Train Loss: 2.0560 | Train Acc: 0.2867
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.6970 | Train Acc: 0.4709
 Site-White_ffhq                (1) | Train Loss: 1.6309 | Train Acc: 0.7692
Average Train Accuracy: 0.2864
 Site-White_utk                 (0) | Val  Loss: 2.1880 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.2854 | Val  Acc: 0.0909
 Site-White_utk                 (4) | Val  Loss: 2.2108 | Val  Acc: 0.1176
 Site-White_utk                 (4) | Val  Loss: 2.2204 | Val  Acc: 0.1600
 Site-White_utk                 (4) | Val  Loss: 2.2153 | Val  Acc: 0.1081
 Site-White_utk                 (4) | Val  Loss: 2.1810 | Val  Acc: 0.0727
 Site-White_utk                 (4) | Val  Loss: 2.1924 | Val  Acc: 0.0988
 Site-White_utk                 (4) | Val  Loss: 2.2264 | Val  Acc: 0.1008
 Site-White_utk                 (4) | Val  Loss: 2.2136 | Val  Acc: 0.1086
 Site-White_utk                 (4) | Val  Loss: 2.3069 | Val  Acc: 0.1085
 Site-East_Asian                (3) | Val  Loss: 2.1019 | Val  Acc: 0.1111
 Site-East_Asian                (3) | Val  Loss: 1.9497 | Val  Acc: 0.3846
 Site-East_Asian                (2) | Val  Loss: 1.9587 | Val  Acc: 0.3846
 Site-East_Asian                (3) | Val  Loss: 1.9246 | Val  Acc: 0.3860
 Site-East_Asian                (3) | Val  Loss: 1.9458 | Val  Acc: 0.4235
 Site-East_Asian                (3) | Val  Loss: 1.9058 | Val  Acc: 0.4240
 Site-East_Asian                (3) | Val  Loss: 1.9310 | Val  Acc: 0.3859
 Site-Indian_utk                (5) | Val  Loss: 1.9785 | Val  Acc: 0.3793
 Site-Indian_utk                (4) | Val  Loss: 2.0199 | Val  Acc: 0.3256
 Site-Indian_utk                (4) | Val  Loss: 2.0017 | Val  Acc: 0.3651
 Site-Indian_utk                (4) | Val  Loss: 2.0341 | Val  Acc: 0.2935
 Site-Indian_utk                (4) | Val  Loss: 1.9134 | Val  Acc: 0.3529
 Site-Black_utk                 (4) | Val  Loss: 1.9965 | Val  Acc: 0.3333
 Site-Black_utk                 (4) | Val  Loss: 1.9849 | Val  Acc: 0.2963
 Site-Black_utk                 (4) | Val  Loss: 1.9648 | Val  Acc: 0.3291
 Site-Southeast_Asian           (3) | Val  Loss: 2.2259 | Val  Acc: 0.2647
 Site-Southeast_Asian           (3) | Val  Loss: 2.0634 | Val  Acc: 0.3100
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.9695 | Val  Acc: 0.1652
 Site-White_ffhq                (1) | Val  Loss: 1.4914 | Val  Acc: 0.9103
Average Valid Accuracy: 0.2730
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0909
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1176
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1600
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1081
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0727
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.0988
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1008
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1086
 Best site-White_utk                (4)  | Epoch:0 | Val Acc: 0.1085
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.1111
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3846
 Best site-East_Asian               (2)  | Epoch:0 | Val Acc: 0.3846
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3860
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.4235
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.4240
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3859
 Best site-Indian_utk               (5)  | Epoch:0 | Val Acc: 0.3793
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3256
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3651
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.2935
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3529
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3333
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.2963
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.3291
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2647
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3100
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:0 | Val Acc: 0.1652
 Best site-White_ffhq               (1)  | Epoch:0 | Val Acc: 0.9103
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 9, 2, 12, 4, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (3) | Train Loss: 1.9829 | Train Acc: 0.0833
 Site-White_utk                 (5) | Train Loss: 2.1891 | Train Acc: 0.1176
 Site-White_utk                 (3) | Train Loss: 2.2104 | Train Acc: 0.1154
 Site-White_utk                 (3) | Train Loss: 2.2566 | Train Acc: 0.1053
 Site-White_utk                 (0) | Train Loss: 2.2113 | Train Acc: 0.0893
 Site-White_utk                 (3) | Train Loss: 2.2225 | Train Acc: 0.1098
 Site-White_utk                 (3) | Train Loss: 2.1917 | Train Acc: 0.1240
 Site-White_utk                 (3) | Train Loss: 2.1925 | Train Acc: 0.1173
 Site-White_utk                 (3) | Train Loss: 2.1195 | Train Acc: 0.1141
 Site-White_utk                 (3) | Train Loss: 2.2315 | Train Acc: 0.1163
 Site-East_Asian                (1) | Train Loss: 1.7956 | Train Acc: 0.3704
 Site-East_Asian                (1) | Train Loss: 1.8231 | Train Acc: 0.4750
 Site-East_Asian                (1) | Train Loss: 1.8584 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.9787 | Train Acc: 0.3372
 Site-East_Asian                (1) | Train Loss: 1.8641 | Train Acc: 0.3937
 Site-East_Asian                (1) | Train Loss: 1.8837 | Train Acc: 0.3690
 Site-East_Asian                (1) | Train Loss: 1.8203 | Train Acc: 0.3913
 Site-Indian_utk                (4) | Train Loss: 1.9488 | Train Acc: 0.3023
 Site-Indian_utk                (3) | Train Loss: 1.8839 | Train Acc: 0.3906
 Site-Indian_utk                (3) | Train Loss: 1.9533 | Train Acc: 0.3404
 Site-Indian_utk                (3) | Train Loss: 1.8831 | Train Acc: 0.3237
 Site-Indian_utk                (3) | Train Loss: 1.9291 | Train Acc: 0.3366
 Site-Black_utk                 (4) | Train Loss: 1.8776 | Train Acc: 0.3273
 Site-Black_utk                 (4) | Train Loss: 1.9912 | Train Acc: 0.3333
 Site-Black_utk                 (4) | Train Loss: 1.9416 | Train Acc: 0.3193
 Site-Southeast_Asian           (1) | Train Loss: 1.9690 | Train Acc: 0.3235
 Site-Southeast_Asian           (1) | Train Loss: 2.0023 | Train Acc: 0.3000
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6070 | Train Acc: 0.4593
 Site-White_ffhq                (2) | Train Loss: 1.5321 | Train Acc: 0.7949
Average Train Accuracy: 0.2880
 Site-White_utk                 (3) | Val  Loss: 2.1217 | Val  Acc: 0.2500
 Site-White_utk                 (5) | Val  Loss: 2.1907 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.1611 | Val  Acc: 0.1176
 Site-White_utk                 (3) | Val  Loss: 2.2129 | Val  Acc: 0.1200
 Site-White_utk                 (0) | Val  Loss: 2.1763 | Val  Acc: 0.1081
 Site-White_utk                 (3) | Val  Loss: 2.1793 | Val  Acc: 0.0909
 Site-White_utk                 (3) | Val  Loss: 2.1853 | Val  Acc: 0.0988
 Site-White_utk                 (3) | Val  Loss: 2.2022 | Val  Acc: 0.1008
 Site-White_utk                 (3) | Val  Loss: 2.1897 | Val  Acc: 0.1029
 Site-White_utk                 (3) | Val  Loss: 2.2533 | Val  Acc: 0.1124
 Site-East_Asian                (1) | Val  Loss: 2.0569 | Val  Acc: 0.2222
 Site-East_Asian                (1) | Val  Loss: 1.8814 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.8873 | Val  Acc: 0.4103
 Site-East_Asian                (1) | Val  Loss: 1.8508 | Val  Acc: 0.3860
 Site-East_Asian                (1) | Val  Loss: 1.8906 | Val  Acc: 0.4118
 Site-East_Asian                (1) | Val  Loss: 1.8304 | Val  Acc: 0.4080
 Site-East_Asian                (1) | Val  Loss: 1.8570 | Val  Acc: 0.3804
 Site-Indian_utk                (4) | Val  Loss: 1.9331 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.9293 | Val  Acc: 0.3721
 Site-Indian_utk                (3) | Val  Loss: 1.9257 | Val  Acc: 0.3651
 Site-Indian_utk                (3) | Val  Loss: 1.9254 | Val  Acc: 0.3478
 Site-Indian_utk                (3) | Val  Loss: 1.8537 | Val  Acc: 0.3603
 Site-Black_utk                 (4) | Val  Loss: 1.9281 | Val  Acc: 0.3611
 Site-Black_utk                 (4) | Val  Loss: 1.9217 | Val  Acc: 0.3704
 Site-Black_utk                 (4) | Val  Loss: 1.9161 | Val  Acc: 0.3544
 Site-Southeast_Asian           (1) | Val  Loss: 2.1772 | Val  Acc: 0.2941
 Site-Southeast_Asian           (1) | Val  Loss: 2.0296 | Val  Acc: 0.2900
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9187 | Val  Acc: 0.1652
 Site-White_ffhq                (2) | Val  Loss: 1.3651 | Val  Acc: 0.9615
Average Valid Accuracy: 0.2892
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2500
 Best site-White_utk                (5)  | Epoch:1 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1176
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1200
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1081
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0909
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0988
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1008
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1029
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1124
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.2222
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4103
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3860
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4118
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.4080
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3804
 Best site-Indian_utk               (4)  | Epoch:1 | Val Acc: 0.3103
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3721
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3651
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3478
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3603
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3611
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3704
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.3544
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2941
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2900
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:1 | Val Acc: 0.1652
 Best site-White_ffhq               (2)  | Epoch:1 | Val Acc: 0.9615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 9, 1, 8, 9, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk                 (5) | Train Loss: 1.9379 | Train Acc: 0.2500
 Site-White_utk                 (4) | Train Loss: 2.1153 | Train Acc: 0.1765
 Site-White_utk                 (2) | Train Loss: 2.0925 | Train Acc: 0.1154
 Site-White_utk                 (0) | Train Loss: 2.2315 | Train Acc: 0.1316
 Site-White_utk                 (4) | Train Loss: 2.1126 | Train Acc: 0.1429
 Site-White_utk                 (4) | Train Loss: 2.0759 | Train Acc: 0.1463
 Site-White_utk                 (4) | Train Loss: 2.1225 | Train Acc: 0.1157
 Site-White_utk                 (4) | Train Loss: 2.1504 | Train Acc: 0.1285
 Site-White_utk                 (4) | Train Loss: 2.0921 | Train Acc: 0.1293
 Site-White_utk                 (4) | Train Loss: 2.0987 | Train Acc: 0.1395
 Site-East_Asian                (1) | Train Loss: 1.7614 | Train Acc: 0.4074
 Site-East_Asian                (1) | Train Loss: 1.8301 | Train Acc: 0.4750
 Site-East_Asian                (1) | Train Loss: 1.8484 | Train Acc: 0.3559
 Site-East_Asian                (1) | Train Loss: 1.8941 | Train Acc: 0.3488
 Site-East_Asian                (1) | Train Loss: 1.8395 | Train Acc: 0.3937
 Site-East_Asian                (1) | Train Loss: 1.8565 | Train Acc: 0.3797
 Site-East_Asian                (1) | Train Loss: 1.8227 | Train Acc: 0.4022
 Site-Indian_utk                (3) | Train Loss: 1.8988 | Train Acc: 0.3256
 Site-Indian_utk                (3) | Train Loss: 1.8370 | Train Acc: 0.4062
 Site-Indian_utk                (3) | Train Loss: 1.9207 | Train Acc: 0.3617
 Site-Indian_utk                (3) | Train Loss: 1.9122 | Train Acc: 0.3669
 Site-Indian_utk                (3) | Train Loss: 1.9038 | Train Acc: 0.3512
 Site-Black_utk                 (3) | Train Loss: 1.8476 | Train Acc: 0.3636
 Site-Black_utk                 (3) | Train Loss: 2.0016 | Train Acc: 0.2963
 Site-Black_utk                 (3) | Train Loss: 1.9560 | Train Acc: 0.2773
 Site-Southeast_Asian           (1) | Train Loss: 1.9157 | Train Acc: 0.3235
 Site-Southeast_Asian           (1) | Train Loss: 1.9667 | Train Acc: 0.2933
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6260 | Train Acc: 0.4826
 Site-White_ffhq                (4) | Train Loss: 1.5283 | Train Acc: 0.7863
Average Train Accuracy: 0.3060
 Site-White_utk                 (5) | Val  Loss: 2.1135 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 2.1193 | Val  Acc: 0.0909
 Site-White_utk                 (2) | Val  Loss: 2.0636 | Val  Acc: 0.1765
 Site-White_utk                 (0) | Val  Loss: 2.1464 | Val  Acc: 0.1200
 Site-White_utk                 (4) | Val  Loss: 2.1534 | Val  Acc: 0.1081
 Site-White_utk                 (4) | Val  Loss: 2.0897 | Val  Acc: 0.1455
 Site-White_utk                 (4) | Val  Loss: 2.1188 | Val  Acc: 0.1481
 Site-White_utk                 (4) | Val  Loss: 2.1478 | Val  Acc: 0.1176
 Site-White_utk                 (4) | Val  Loss: 2.1399 | Val  Acc: 0.1200
 Site-White_utk                 (4) | Val  Loss: 2.2158 | Val  Acc: 0.1395
 Site-East_Asian                (1) | Val  Loss: 2.0191 | Val  Acc: 0.2222
 Site-East_Asian                (1) | Val  Loss: 1.8528 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.8991 | Val  Acc: 0.4103
 Site-East_Asian                (1) | Val  Loss: 1.8179 | Val  Acc: 0.4211
 Site-East_Asian                (1) | Val  Loss: 1.8414 | Val  Acc: 0.4353
 Site-East_Asian                (1) | Val  Loss: 1.7901 | Val  Acc: 0.4160
 Site-East_Asian                (1) | Val  Loss: 1.8321 | Val  Acc: 0.3859
 Site-Indian_utk                (3) | Val  Loss: 1.9057 | Val  Acc: 0.3103
 Site-Indian_utk                (3) | Val  Loss: 1.8506 | Val  Acc: 0.3488
 Site-Indian_utk                (3) | Val  Loss: 1.8971 | Val  Acc: 0.3810
 Site-Indian_utk                (3) | Val  Loss: 1.9481 | Val  Acc: 0.3370
 Site-Indian_utk                (3) | Val  Loss: 1.8396 | Val  Acc: 0.3456
 Site-Black_utk                 (3) | Val  Loss: 1.9048 | Val  Acc: 0.3056
 Site-Black_utk                 (3) | Val  Loss: 1.9154 | Val  Acc: 0.3148
 Site-Black_utk                 (3) | Val  Loss: 1.9317 | Val  Acc: 0.3544
 Site-Southeast_Asian           (1) | Val  Loss: 2.2096 | Val  Acc: 0.2941
 Site-Southeast_Asian           (1) | Val  Loss: 1.9786 | Val  Acc: 0.3000
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.9293 | Val  Acc: 0.1739
 Site-White_ffhq                (4) | Val  Loss: 1.3548 | Val  Acc: 0.9615
Average Valid Accuracy: 0.2908
 Best site-White_utk                (5)  | Epoch:2 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.0909
 Best site-White_utk                (2)  | Epoch:2 | Val Acc: 0.1765
 Best site-White_utk                (0)  | Epoch:2 | Val Acc: 0.1200
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.1081
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.1455
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.1481
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.1176
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.1200
 Best site-White_utk                (4)  | Epoch:2 | Val Acc: 0.1395
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.2222
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.4103
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.4211
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.4353
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.4160
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.3859
 Best site-Indian_utk               (3)  | Epoch:2 | Val Acc: 0.3103
 Best site-Indian_utk               (3)  | Epoch:2 | Val Acc: 0.3488
 Best site-Indian_utk               (3)  | Epoch:2 | Val Acc: 0.3810
 Best site-Indian_utk               (3)  | Epoch:2 | Val Acc: 0.3370
 Best site-Indian_utk               (3)  | Epoch:2 | Val Acc: 0.3456
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.3056
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.3148
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.3544
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.2941
 Best site-Southeast_Asian          (1)  | Epoch:2 | Val Acc: 0.3000
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:2 | Val Acc: 0.1739
 Best site-White_ffhq               (4)  | Epoch:2 | Val Acc: 0.9615
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 1, 11, 5, 3, 8, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White_utk                 (2) | Train Loss: 1.9169 | Train Acc: 0.3333
 Site-White_utk                 (2) | Train Loss: 2.0367 | Train Acc: 0.2353
 Site-White_utk                 (2) | Train Loss: 2.0636 | Train Acc: 0.1538
 Site-White_utk                 (0) | Train Loss: 2.1400 | Train Acc: 0.0789
 Site-White_utk                 (2) | Train Loss: 2.0824 | Train Acc: 0.1786
 Site-White_utk                 (2) | Train Loss: 2.0704 | Train Acc: 0.1951
 Site-White_utk                 (2) | Train Loss: 2.0256 | Train Acc: 0.1983
 Site-White_utk                 (2) | Train Loss: 2.0906 | Train Acc: 0.1788
 Site-White_utk                 (2) | Train Loss: 2.0983 | Train Acc: 0.1483
 Site-White_utk                 (2) | Train Loss: 1.9583 | Train Acc: 0.1809
 Site-East_Asian                (5) | Train Loss: 1.7629 | Train Acc: 0.4074
 Site-East_Asian                (5) | Train Loss: 1.7585 | Train Acc: 0.4750
 Site-East_Asian                (1) | Train Loss: 1.8225 | Train Acc: 0.3390
 Site-East_Asian                (5) | Train Loss: 1.8667 | Train Acc: 0.3488
 Site-East_Asian                (5) | Train Loss: 1.7996 | Train Acc: 0.4016
 Site-East_Asian                (5) | Train Loss: 1.8269 | Train Acc: 0.3690
 Site-East_Asian                (5) | Train Loss: 1.7518 | Train Acc: 0.4130
 Site-Indian_utk                (3) | Train Loss: 1.8842 | Train Acc: 0.3256
 Site-Indian_utk                (3) | Train Loss: 1.7764 | Train Acc: 0.4375
 Site-Indian_utk                (3) | Train Loss: 1.8924 | Train Acc: 0.3191
 Site-Indian_utk                (3) | Train Loss: 1.8474 | Train Acc: 0.3741
 Site-Indian_utk                (3) | Train Loss: 1.8645 | Train Acc: 0.3610
 Site-Black_utk                 (4) | Train Loss: 1.8254 | Train Acc: 0.4545
 Site-Black_utk                 (4) | Train Loss: 1.8961 | Train Acc: 0.2963
 Site-Black_utk                 (4) | Train Loss: 1.8867 | Train Acc: 0.3445
 Site-Southeast_Asian           (5) | Train Loss: 1.9668 | Train Acc: 0.3137
 Site-Southeast_Asian           (5) | Train Loss: 1.9474 | Train Acc: 0.3133
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6169 | Train Acc: 0.4709
 Site-White_ffhq                (2) | Train Loss: 1.5249 | Train Acc: 0.7607
Average Train Accuracy: 0.3244
 Site-White_utk                 (2) | Val  Loss: 1.9451 | Val  Acc: 0.2500
 Site-White_utk                 (2) | Val  Loss: 2.0247 | Val  Acc: 0.1818
 Site-White_utk                 (2) | Val  Loss: 2.0609 | Val  Acc: 0.1176
 Site-White_utk                 (0) | Val  Loss: 2.0930 | Val  Acc: 0.0800
 Site-White_utk                 (2) | Val  Loss: 2.0721 | Val  Acc: 0.1892
 Site-White_utk                 (2) | Val  Loss: 2.0605 | Val  Acc: 0.1636
 Site-White_utk                 (2) | Val  Loss: 2.0562 | Val  Acc: 0.1481
 Site-White_utk                 (2) | Val  Loss: 2.0848 | Val  Acc: 0.1597
 Site-White_utk                 (2) | Val  Loss: 2.0802 | Val  Acc: 0.1657
 Site-White_utk                 (2) | Val  Loss: 2.0927 | Val  Acc: 0.1783
 Site-East_Asian                (5) | Val  Loss: 1.9425 | Val  Acc: 0.2222
 Site-East_Asian                (5) | Val  Loss: 1.7683 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.8587 | Val  Acc: 0.4103
 Site-East_Asian                (5) | Val  Loss: 1.7872 | Val  Acc: 0.3860
 Site-East_Asian                (5) | Val  Loss: 1.8345 | Val  Acc: 0.4353
 Site-East_Asian                (5) | Val  Loss: 1.7680 | Val  Acc: 0.4160
 Site-East_Asian                (5) | Val  Loss: 1.7966 | Val  Acc: 0.3967
 Site-Indian_utk                (3) | Val  Loss: 1.8785 | Val  Acc: 0.3448
 Site-Indian_utk                (3) | Val  Loss: 1.8135 | Val  Acc: 0.4186
 Site-Indian_utk                (3) | Val  Loss: 1.8526 | Val  Acc: 0.3651
 Site-Indian_utk                (3) | Val  Loss: 1.8653 | Val  Acc: 0.3261
 Site-Indian_utk                (3) | Val  Loss: 1.7885 | Val  Acc: 0.3603
 Site-Black_utk                 (4) | Val  Loss: 1.8528 | Val  Acc: 0.3056
 Site-Black_utk                 (4) | Val  Loss: 1.8904 | Val  Acc: 0.2778
 Site-Black_utk                 (4) | Val  Loss: 1.8977 | Val  Acc: 0.3291
 Site-Southeast_Asian           (5) | Val  Loss: 2.0408 | Val  Acc: 0.3235
 Site-Southeast_Asian           (5) | Val  Loss: 1.9499 | Val  Acc: 0.3300
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9036 | Val  Acc: 0.1913
 Site-White_ffhq                (2) | Val  Loss: 1.3934 | Val  Acc: 0.8333
Average Valid Accuracy: 0.3010
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.2500
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1818
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1176
 Best site-White_utk                (0)  | Epoch:3 | Val Acc: 0.0800
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1892
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1636
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1481
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1597
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1657
 Best site-White_utk                (2)  | Epoch:3 | Val Acc: 0.1783
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.2222
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:3 | Val Acc: 0.4103
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.3860
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4353
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.4160
 Best site-East_Asian               (5)  | Epoch:3 | Val Acc: 0.3967
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3448
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.4186
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3651
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3261
 Best site-Indian_utk               (3)  | Epoch:3 | Val Acc: 0.3603
 Best site-Black_utk                (4)  | Epoch:3 | Val Acc: 0.3056
 Best site-Black_utk                (4)  | Epoch:3 | Val Acc: 0.2778
 Best site-Black_utk                (4)  | Epoch:3 | Val Acc: 0.3291
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3235
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3300
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:3 | Val Acc: 0.1913
 Best site-White_ffhq               (2)  | Epoch:3 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 9, 1, 2, 9, 7, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White_utk                 (4) | Train Loss: 1.7432 | Train Acc: 0.4167
 Site-White_utk                 (4) | Train Loss: 1.8670 | Train Acc: 0.2941
 Site-White_utk                 (2) | Train Loss: 1.8682 | Train Acc: 0.3077
 Site-White_utk                 (4) | Train Loss: 2.0270 | Train Acc: 0.1842
 Site-White_utk                 (4) | Train Loss: 1.9143 | Train Acc: 0.2500
 Site-White_utk                 (4) | Train Loss: 1.9483 | Train Acc: 0.2927
 Site-White_utk                 (4) | Train Loss: 1.9303 | Train Acc: 0.2562
 Site-White_utk                 (4) | Train Loss: 1.9462 | Train Acc: 0.2849
 Site-White_utk                 (4) | Train Loss: 1.9632 | Train Acc: 0.2548
 Site-White_utk                 (4) | Train Loss: 1.9173 | Train Acc: 0.2868
 Site-East_Asian                (1) | Train Loss: 1.6605 | Train Acc: 0.4815
 Site-East_Asian                (1) | Train Loss: 1.6843 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.8287 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.7672 | Train Acc: 0.3488
 Site-East_Asian                (1) | Train Loss: 1.7575 | Train Acc: 0.4173
 Site-East_Asian                (1) | Train Loss: 1.7866 | Train Acc: 0.3583
 Site-East_Asian                (1) | Train Loss: 1.7334 | Train Acc: 0.4167
 Site-Indian_utk                (0) | Train Loss: 1.7987 | Train Acc: 0.3488
 Site-Indian_utk                (5) | Train Loss: 1.7939 | Train Acc: 0.4531
 Site-Indian_utk                (5) | Train Loss: 1.8404 | Train Acc: 0.3085
 Site-Indian_utk                (5) | Train Loss: 1.8042 | Train Acc: 0.3885
 Site-Indian_utk                (5) | Train Loss: 1.8513 | Train Acc: 0.3659
 Site-Black_utk                 (5) | Train Loss: 1.7744 | Train Acc: 0.4909
 Site-Black_utk                 (5) | Train Loss: 1.8947 | Train Acc: 0.2593
 Site-Black_utk                 (5) | Train Loss: 1.8884 | Train Acc: 0.2857
 Site-Southeast_Asian           (1) | Train Loss: 1.8942 | Train Acc: 0.3333
 Site-Southeast_Asian           (1) | Train Loss: 1.9256 | Train Acc: 0.3200
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.6528 | Train Acc: 0.4535
 Site-White_ffhq                (3) | Train Loss: 1.6568 | Train Acc: 0.5128
Average Train Accuracy: 0.3532
 Site-White_utk                 (4) | Val  Loss: 1.8903 | Val  Acc: 0.2500
 Site-White_utk                 (4) | Val  Loss: 1.8374 | Val  Acc: 0.2727
 Site-White_utk                 (2) | Val  Loss: 1.9385 | Val  Acc: 0.2353
 Site-White_utk                 (4) | Val  Loss: 1.9583 | Val  Acc: 0.2800
 Site-White_utk                 (4) | Val  Loss: 1.9501 | Val  Acc: 0.2973
 Site-White_utk                 (4) | Val  Loss: 1.9136 | Val  Acc: 0.2727
 Site-White_utk                 (4) | Val  Loss: 2.0078 | Val  Acc: 0.2099
 Site-White_utk                 (4) | Val  Loss: 1.9348 | Val  Acc: 0.2689
 Site-White_utk                 (4) | Val  Loss: 1.9821 | Val  Acc: 0.2286
 Site-White_utk                 (4) | Val  Loss: 2.0019 | Val  Acc: 0.2403
 Site-East_Asian                (1) | Val  Loss: 1.8157 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.7364 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.7740 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.7462 | Val  Acc: 0.3860
 Site-East_Asian                (1) | Val  Loss: 1.7693 | Val  Acc: 0.3882
 Site-East_Asian                (1) | Val  Loss: 1.7185 | Val  Acc: 0.4320
 Site-East_Asian                (1) | Val  Loss: 1.7483 | Val  Acc: 0.4565
 Site-Indian_utk                (0) | Val  Loss: 1.7620 | Val  Acc: 0.3103
 Site-Indian_utk                (5) | Val  Loss: 1.7582 | Val  Acc: 0.3256
 Site-Indian_utk                (5) | Val  Loss: 1.8225 | Val  Acc: 0.3810
 Site-Indian_utk                (5) | Val  Loss: 1.8577 | Val  Acc: 0.3587
 Site-Indian_utk                (5) | Val  Loss: 1.7591 | Val  Acc: 0.3750
 Site-Black_utk                 (5) | Val  Loss: 1.7638 | Val  Acc: 0.5556
 Site-Black_utk                 (5) | Val  Loss: 1.8773 | Val  Acc: 0.3148
 Site-Black_utk                 (5) | Val  Loss: 1.8483 | Val  Acc: 0.3418
 Site-Southeast_Asian           (1) | Val  Loss: 1.9512 | Val  Acc: 0.2794
 Site-Southeast_Asian           (1) | Val  Loss: 1.9454 | Val  Acc: 0.2600
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.8536 | Val  Acc: 0.2957
 Site-White_ffhq                (3) | Val  Loss: 1.5831 | Val  Acc: 0.6026
Average Valid Accuracy: 0.3405
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.2500
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.2727
 Best site-White_utk                (2)  | Epoch:4 | Val Acc: 0.2353
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.2800
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.2973
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.2727
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.2099
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.2689
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.2286
 Best site-White_utk                (4)  | Epoch:4 | Val Acc: 0.2403
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.3333
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.3860
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.3882
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4320
 Best site-East_Asian               (1)  | Epoch:4 | Val Acc: 0.4565
 Best site-Indian_utk               (0)  | Epoch:4 | Val Acc: 0.3103
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.3256
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.3810
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.3587
 Best site-Indian_utk               (5)  | Epoch:4 | Val Acc: 0.3750
 Best site-Black_utk                (5)  | Epoch:4 | Val Acc: 0.5556
 Best site-Black_utk                (5)  | Epoch:4 | Val Acc: 0.3148
 Best site-Black_utk                (5)  | Epoch:4 | Val Acc: 0.3418
 Best site-Southeast_Asian          (1)  | Epoch:4 | Val Acc: 0.2794
 Best site-Southeast_Asian          (1)  | Epoch:4 | Val Acc: 0.2600
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:4 | Val Acc: 0.2957
 Best site-White_ffhq               (3)  | Epoch:4 | Val Acc: 0.6026
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 8, 9, 9, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White_utk                 (3) | Train Loss: 1.7222 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 1.7390 | Train Acc: 0.4706
 Site-White_utk                 (3) | Train Loss: 1.8533 | Train Acc: 0.2308
 Site-White_utk                 (3) | Train Loss: 1.9212 | Train Acc: 0.1842
 Site-White_utk                 (3) | Train Loss: 1.8519 | Train Acc: 0.2321
 Site-White_utk                 (3) | Train Loss: 1.9202 | Train Acc: 0.2805
 Site-White_utk                 (3) | Train Loss: 1.8500 | Train Acc: 0.2645
 Site-White_utk                 (3) | Train Loss: 1.9045 | Train Acc: 0.2682
 Site-White_utk                 (3) | Train Loss: 1.8839 | Train Acc: 0.2700
 Site-White_utk                 (3) | Train Loss: 1.9179 | Train Acc: 0.2946
 Site-East_Asian                (2) | Train Loss: 1.5908 | Train Acc: 0.4444
 Site-East_Asian                (2) | Train Loss: 1.5970 | Train Acc: 0.5250
 Site-East_Asian                (2) | Train Loss: 1.7924 | Train Acc: 0.3220
 Site-East_Asian                (2) | Train Loss: 1.7667 | Train Acc: 0.3953
 Site-East_Asian                (2) | Train Loss: 1.6926 | Train Acc: 0.4409
 Site-East_Asian                (2) | Train Loss: 1.7255 | Train Acc: 0.3636
 Site-East_Asian                (2) | Train Loss: 1.6477 | Train Acc: 0.4022
 Site-Indian_utk                (1) | Train Loss: 1.7656 | Train Acc: 0.3721
 Site-Indian_utk                (1) | Train Loss: 1.7223 | Train Acc: 0.4062
 Site-Indian_utk                (1) | Train Loss: 1.7383 | Train Acc: 0.3723
 Site-Indian_utk                (1) | Train Loss: 1.7823 | Train Acc: 0.3957
 Site-Indian_utk                (1) | Train Loss: 1.7907 | Train Acc: 0.4049
 Site-Black_utk                 (1) | Train Loss: 1.7086 | Train Acc: 0.4364
 Site-Black_utk                 (1) | Train Loss: 1.8149 | Train Acc: 0.3086
 Site-Black_utk                 (1) | Train Loss: 1.8531 | Train Acc: 0.3613
 Site-Southeast_Asian           (2) | Train Loss: 1.8836 | Train Acc: 0.3529
 Site-Southeast_Asian           (2) | Train Loss: 1.8507 | Train Acc: 0.3467
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6235 | Train Acc: 0.4186
 Site-White_ffhq                (0) | Train Loss: 1.6285 | Train Acc: 0.4444
Average Train Accuracy: 0.3566
 Site-White_utk                 (3) | Val  Loss: 1.8214 | Val  Acc: 0.1250
 Site-White_utk                 (5) | Val  Loss: 1.8122 | Val  Acc: 0.3636
 Site-White_utk                 (3) | Val  Loss: 1.8345 | Val  Acc: 0.3529
 Site-White_utk                 (3) | Val  Loss: 1.8331 | Val  Acc: 0.3600
 Site-White_utk                 (3) | Val  Loss: 1.8823 | Val  Acc: 0.3514
 Site-White_utk                 (3) | Val  Loss: 1.8690 | Val  Acc: 0.2727
 Site-White_utk                 (3) | Val  Loss: 1.9159 | Val  Acc: 0.3086
 Site-White_utk                 (3) | Val  Loss: 1.9250 | Val  Acc: 0.2605
 Site-White_utk                 (3) | Val  Loss: 1.9086 | Val  Acc: 0.2743
 Site-White_utk                 (3) | Val  Loss: 1.9186 | Val  Acc: 0.2791
 Site-East_Asian                (2) | Val  Loss: 1.8195 | Val  Acc: 0.4444
 Site-East_Asian                (2) | Val  Loss: 1.6788 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.6898 | Val  Acc: 0.4872
 Site-East_Asian                (2) | Val  Loss: 1.7113 | Val  Acc: 0.3860
 Site-East_Asian                (2) | Val  Loss: 1.7622 | Val  Acc: 0.4118
 Site-East_Asian                (2) | Val  Loss: 1.6791 | Val  Acc: 0.4320
 Site-East_Asian                (2) | Val  Loss: 1.7160 | Val  Acc: 0.4674
 Site-Indian_utk                (1) | Val  Loss: 1.7359 | Val  Acc: 0.4138
 Site-Indian_utk                (1) | Val  Loss: 1.7011 | Val  Acc: 0.3721
 Site-Indian_utk                (1) | Val  Loss: 1.7223 | Val  Acc: 0.4444
 Site-Indian_utk                (1) | Val  Loss: 1.7921 | Val  Acc: 0.4457
 Site-Indian_utk                (1) | Val  Loss: 1.6476 | Val  Acc: 0.3897
 Site-Black_utk                 (1) | Val  Loss: 1.7788 | Val  Acc: 0.3889
 Site-Black_utk                 (1) | Val  Loss: 1.8283 | Val  Acc: 0.3148
 Site-Black_utk                 (1) | Val  Loss: 1.8014 | Val  Acc: 0.3291
 Site-Southeast_Asian           (2) | Val  Loss: 1.8976 | Val  Acc: 0.2647
 Site-Southeast_Asian           (2) | Val  Loss: 1.8452 | Val  Acc: 0.3200
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8363 | Val  Acc: 0.2783
 Site-White_ffhq                (0) | Val  Loss: 1.5185 | Val  Acc: 0.5769
Average Valid Accuracy: 0.3647
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.1250
 Best site-White_utk                (5)  | Epoch:5 | Val Acc: 0.3636
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.3529
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.3600
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.3514
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2727
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.3086
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2605
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2743
 Best site-White_utk                (3)  | Epoch:5 | Val Acc: 0.2791
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4444
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4615
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4872
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3860
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4118
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4320
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.4674
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.4138
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3721
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.4444
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.4457
 Best site-Indian_utk               (1)  | Epoch:5 | Val Acc: 0.3897
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.3889
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.3148
 Best site-Black_utk                (1)  | Epoch:5 | Val Acc: 0.3291
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.2647
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3200
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:5 | Val Acc: 0.2783
 Best site-White_ffhq               (0)  | Epoch:5 | Val Acc: 0.5769
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 9, 14, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White_utk                 (0) | Train Loss: 1.6072 | Train Acc: 0.3333
 Site-White_utk                 (2) | Train Loss: 1.7286 | Train Acc: 0.2353
 Site-White_utk                 (2) | Train Loss: 1.8445 | Train Acc: 0.2692
 Site-White_utk                 (2) | Train Loss: 1.9103 | Train Acc: 0.2895
 Site-White_utk                 (2) | Train Loss: 1.8197 | Train Acc: 0.3036
 Site-White_utk                 (2) | Train Loss: 1.8227 | Train Acc: 0.2927
 Site-White_utk                 (2) | Train Loss: 1.8347 | Train Acc: 0.2562
 Site-White_utk                 (2) | Train Loss: 1.8441 | Train Acc: 0.2626
 Site-White_utk                 (2) | Train Loss: 1.8325 | Train Acc: 0.2852
 Site-White_utk                 (2) | Train Loss: 1.8062 | Train Acc: 0.3023
 Site-East_Asian                (1) | Train Loss: 1.5407 | Train Acc: 0.4815
 Site-East_Asian                (1) | Train Loss: 1.5801 | Train Acc: 0.4000
 Site-East_Asian                (1) | Train Loss: 1.7417 | Train Acc: 0.3729
 Site-East_Asian                (1) | Train Loss: 1.6895 | Train Acc: 0.3953
 Site-East_Asian                (1) | Train Loss: 1.6686 | Train Acc: 0.4488
 Site-East_Asian                (1) | Train Loss: 1.6799 | Train Acc: 0.4064
 Site-East_Asian                (1) | Train Loss: 1.5931 | Train Acc: 0.4457
 Site-Indian_utk                (2) | Train Loss: 1.6946 | Train Acc: 0.4419
 Site-Indian_utk                (2) | Train Loss: 1.6454 | Train Acc: 0.3906
 Site-Indian_utk                (2) | Train Loss: 1.7108 | Train Acc: 0.3191
 Site-Indian_utk                (2) | Train Loss: 1.6626 | Train Acc: 0.3813
 Site-Indian_utk                (2) | Train Loss: 1.7140 | Train Acc: 0.4244
 Site-Black_utk                 (3) | Train Loss: 1.6629 | Train Acc: 0.4545
 Site-Black_utk                 (5) | Train Loss: 1.7435 | Train Acc: 0.3704
 Site-Black_utk                 (5) | Train Loss: 1.7675 | Train Acc: 0.3697
 Site-Southeast_Asian           (1) | Train Loss: 1.8563 | Train Acc: 0.3529
 Site-Southeast_Asian           (1) | Train Loss: 1.8130 | Train Acc: 0.3600
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5805 | Train Acc: 0.4419
 Site-White_ffhq                (4) | Train Loss: 1.5429 | Train Acc: 0.5128
Average Train Accuracy: 0.3655
 Site-White_utk                 (0) | Val  Loss: 1.7007 | Val  Acc: 0.1250
 Site-White_utk                 (2) | Val  Loss: 1.7294 | Val  Acc: 0.2727
 Site-White_utk                 (2) | Val  Loss: 1.7908 | Val  Acc: 0.3529
 Site-White_utk                 (2) | Val  Loss: 1.8694 | Val  Acc: 0.2800
 Site-White_utk                 (2) | Val  Loss: 1.8211 | Val  Acc: 0.2973
 Site-White_utk                 (2) | Val  Loss: 1.8281 | Val  Acc: 0.3091
 Site-White_utk                 (2) | Val  Loss: 1.9047 | Val  Acc: 0.2840
 Site-White_utk                 (2) | Val  Loss: 1.8287 | Val  Acc: 0.2689
 Site-White_utk                 (2) | Val  Loss: 1.8692 | Val  Acc: 0.2514
 Site-White_utk                 (2) | Val  Loss: 1.8922 | Val  Acc: 0.2713
 Site-East_Asian                (1) | Val  Loss: 1.7675 | Val  Acc: 0.4444
 Site-East_Asian                (1) | Val  Loss: 1.6489 | Val  Acc: 0.4231
 Site-East_Asian                (1) | Val  Loss: 1.6634 | Val  Acc: 0.4615
 Site-East_Asian                (1) | Val  Loss: 1.6647 | Val  Acc: 0.4211
 Site-East_Asian                (1) | Val  Loss: 1.6888 | Val  Acc: 0.4353
 Site-East_Asian                (1) | Val  Loss: 1.6399 | Val  Acc: 0.4320
 Site-East_Asian                (1) | Val  Loss: 1.6307 | Val  Acc: 0.4674
 Site-Indian_utk                (2) | Val  Loss: 1.6853 | Val  Acc: 0.4138
 Site-Indian_utk                (2) | Val  Loss: 1.6713 | Val  Acc: 0.3953
 Site-Indian_utk                (2) | Val  Loss: 1.6436 | Val  Acc: 0.4286
 Site-Indian_utk                (2) | Val  Loss: 1.7696 | Val  Acc: 0.3478
 Site-Indian_utk                (2) | Val  Loss: 1.5723 | Val  Acc: 0.4191
 Site-Black_utk                 (3) | Val  Loss: 1.8035 | Val  Acc: 0.4444
 Site-Black_utk                 (5) | Val  Loss: 1.7428 | Val  Acc: 0.3704
 Site-Black_utk                 (5) | Val  Loss: 1.7364 | Val  Acc: 0.3038
 Site-Southeast_Asian           (1) | Val  Loss: 1.7923 | Val  Acc: 0.3676
 Site-Southeast_Asian           (1) | Val  Loss: 1.8615 | Val  Acc: 0.3500
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8078 | Val  Acc: 0.3217
 Site-White_ffhq                (4) | Val  Loss: 1.4838 | Val  Acc: 0.6410
Average Valid Accuracy: 0.3656
 Best site-White_utk                (0)  | Epoch:6 | Val Acc: 0.1250
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2727
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.3529
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2800
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2973
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.3091
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2840
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2689
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2514
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2713
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.4444
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.4231
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.4615
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.4211
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.4353
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.4320
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.4674
 Best site-Indian_utk               (2)  | Epoch:6 | Val Acc: 0.4138
 Best site-Indian_utk               (2)  | Epoch:6 | Val Acc: 0.3953
 Best site-Indian_utk               (2)  | Epoch:6 | Val Acc: 0.4286
 Best site-Indian_utk               (2)  | Epoch:6 | Val Acc: 0.3478
 Best site-Indian_utk               (2)  | Epoch:6 | Val Acc: 0.4191
 Best site-Black_utk                (3)  | Epoch:6 | Val Acc: 0.4444
 Best site-Black_utk                (5)  | Epoch:6 | Val Acc: 0.3704
 Best site-Black_utk                (5)  | Epoch:6 | Val Acc: 0.3038
 Best site-Southeast_Asian          (1)  | Epoch:6 | Val Acc: 0.3676
 Best site-Southeast_Asian          (1)  | Epoch:6 | Val Acc: 0.3500
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:6 | Val Acc: 0.3217
 Best site-White_ffhq               (4)  | Epoch:6 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 7 ============
cnt=[8, 1, 2, 8, 1, 9, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White_utk                 (4) | Train Loss: 1.5625 | Train Acc: 0.3333
 Site-White_utk                 (5) | Train Loss: 1.7687 | Train Acc: 0.1765
 Site-White_utk                 (5) | Train Loss: 1.7164 | Train Acc: 0.3077
 Site-White_utk                 (5) | Train Loss: 1.8647 | Train Acc: 0.2895
 Site-White_utk                 (5) | Train Loss: 1.7371 | Train Acc: 0.3571
 Site-White_utk                 (5) | Train Loss: 1.6911 | Train Acc: 0.3171
 Site-White_utk                 (5) | Train Loss: 1.7833 | Train Acc: 0.2810
 Site-White_utk                 (5) | Train Loss: 1.8411 | Train Acc: 0.2793
 Site-White_utk                 (5) | Train Loss: 1.7014 | Train Acc: 0.2890
 Site-White_utk                 (5) | Train Loss: 1.8202 | Train Acc: 0.3463
 Site-East_Asian                (1) | Train Loss: 1.5030 | Train Acc: 0.4444
 Site-East_Asian                (3) | Train Loss: 1.5449 | Train Acc: 0.4250
 Site-East_Asian                (3) | Train Loss: 1.7308 | Train Acc: 0.2712
 Site-East_Asian                (3) | Train Loss: 1.7664 | Train Acc: 0.4070
 Site-East_Asian                (3) | Train Loss: 1.6242 | Train Acc: 0.4567
 Site-East_Asian                (3) | Train Loss: 1.6488 | Train Acc: 0.4171
 Site-East_Asian                (3) | Train Loss: 1.6093 | Train Acc: 0.4312
 Site-Indian_utk                (0) | Train Loss: 1.6612 | Train Acc: 0.3953
 Site-Indian_utk                (0) | Train Loss: 1.6538 | Train Acc: 0.4375
 Site-Indian_utk                (0) | Train Loss: 1.6835 | Train Acc: 0.3723
 Site-Indian_utk                (0) | Train Loss: 1.6924 | Train Acc: 0.4245
 Site-Indian_utk                (0) | Train Loss: 1.6363 | Train Acc: 0.4341
 Site-Black_utk                 (0) | Train Loss: 1.6018 | Train Acc: 0.4545
 Site-Black_utk                 (0) | Train Loss: 1.7422 | Train Acc: 0.4074
 Site-Black_utk                 (0) | Train Loss: 1.7292 | Train Acc: 0.4034
 Site-Southeast_Asian           (3) | Train Loss: 1.8366 | Train Acc: 0.3627
 Site-Southeast_Asian           (3) | Train Loss: 1.8096 | Train Acc: 0.3600
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5761 | Train Acc: 0.4535
 Site-White_ffhq                (2) | Train Loss: 1.5333 | Train Acc: 0.5299
Average Train Accuracy: 0.3746
 Site-White_utk                 (4) | Val  Loss: 1.6171 | Val  Acc: 0.2500
 Site-White_utk                 (5) | Val  Loss: 1.7640 | Val  Acc: 0.3636
 Site-White_utk                 (5) | Val  Loss: 1.8159 | Val  Acc: 0.2353
 Site-White_utk                 (5) | Val  Loss: 1.8126 | Val  Acc: 0.2800
 Site-White_utk                 (5) | Val  Loss: 1.7202 | Val  Acc: 0.3784
 Site-White_utk                 (5) | Val  Loss: 1.8246 | Val  Acc: 0.2909
 Site-White_utk                 (5) | Val  Loss: 1.8275 | Val  Acc: 0.3086
 Site-White_utk                 (5) | Val  Loss: 1.8053 | Val  Acc: 0.3109
 Site-White_utk                 (5) | Val  Loss: 1.8361 | Val  Acc: 0.2400
 Site-White_utk                 (5) | Val  Loss: 1.9022 | Val  Acc: 0.2907
 Site-East_Asian                (1) | Val  Loss: 1.7943 | Val  Acc: 0.3889
 Site-East_Asian                (3) | Val  Loss: 1.6034 | Val  Acc: 0.3846
 Site-East_Asian                (3) | Val  Loss: 1.6010 | Val  Acc: 0.4359
 Site-East_Asian                (3) | Val  Loss: 1.5865 | Val  Acc: 0.4386
 Site-East_Asian                (3) | Val  Loss: 1.6578 | Val  Acc: 0.4588
 Site-East_Asian                (3) | Val  Loss: 1.5732 | Val  Acc: 0.4720
 Site-East_Asian                (3) | Val  Loss: 1.6265 | Val  Acc: 0.4239
 Site-Indian_utk                (0) | Val  Loss: 1.6254 | Val  Acc: 0.5172
 Site-Indian_utk                (0) | Val  Loss: 1.5895 | Val  Acc: 0.5116
 Site-Indian_utk                (0) | Val  Loss: 1.6391 | Val  Acc: 0.4286
 Site-Indian_utk                (0) | Val  Loss: 1.6803 | Val  Acc: 0.3913
 Site-Indian_utk                (0) | Val  Loss: 1.5350 | Val  Acc: 0.4265
 Site-Black_utk                 (0) | Val  Loss: 1.7479 | Val  Acc: 0.5000
 Site-Black_utk                 (0) | Val  Loss: 1.7462 | Val  Acc: 0.3889
 Site-Black_utk                 (0) | Val  Loss: 1.6808 | Val  Acc: 0.3418
 Site-Southeast_Asian           (3) | Val  Loss: 1.8647 | Val  Acc: 0.3235
 Site-Southeast_Asian           (3) | Val  Loss: 1.8082 | Val  Acc: 0.3800
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8056 | Val  Acc: 0.2783
 Site-White_ffhq                (2) | Val  Loss: 1.4586 | Val  Acc: 0.6410
Average Valid Accuracy: 0.3821
 Best site-White_utk                (4)  | Epoch:7 | Val Acc: 0.2500
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.3636
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2353
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2800
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.3784
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2909
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.3086
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.3109
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2400
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2907
 Best site-East_Asian               (1)  | Epoch:7 | Val Acc: 0.3889
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.3846
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4359
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4386
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4588
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4720
 Best site-East_Asian               (3)  | Epoch:7 | Val Acc: 0.4239
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.5172
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.5116
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.4286
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.3913
 Best site-Indian_utk               (0)  | Epoch:7 | Val Acc: 0.4265
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.5000
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3889
 Best site-Black_utk                (0)  | Epoch:7 | Val Acc: 0.3418
 Best site-Southeast_Asian          (3)  | Epoch:7 | Val Acc: 0.3235
 Best site-Southeast_Asian          (3)  | Epoch:7 | Val Acc: 0.3800
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:7 | Val Acc: 0.2783
 Best site-White_ffhq               (2)  | Epoch:7 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 1, 10, 8, 2, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White_utk                 (2) | Train Loss: 1.4937 | Train Acc: 0.4167
 Site-White_utk                 (2) | Train Loss: 1.6379 | Train Acc: 0.2941
 Site-White_utk                 (2) | Train Loss: 1.6485 | Train Acc: 0.2692
 Site-White_utk                 (2) | Train Loss: 1.8360 | Train Acc: 0.2895
 Site-White_utk                 (2) | Train Loss: 1.6841 | Train Acc: 0.4286
 Site-White_utk                 (2) | Train Loss: 1.6844 | Train Acc: 0.3537
 Site-White_utk                 (2) | Train Loss: 1.7124 | Train Acc: 0.2893
 Site-White_utk                 (2) | Train Loss: 1.7775 | Train Acc: 0.2961
 Site-White_utk                 (2) | Train Loss: 1.7828 | Train Acc: 0.3384
 Site-White_utk                 (2) | Train Loss: 1.7338 | Train Acc: 0.3514
 Site-East_Asian                (1) | Train Loss: 1.4897 | Train Acc: 0.5185
 Site-East_Asian                (3) | Train Loss: 1.5122 | Train Acc: 0.5250
 Site-East_Asian                (3) | Train Loss: 1.7286 | Train Acc: 0.3559
 Site-East_Asian                (3) | Train Loss: 1.6654 | Train Acc: 0.4419
 Site-East_Asian                (3) | Train Loss: 1.6289 | Train Acc: 0.4803
 Site-East_Asian                (3) | Train Loss: 1.5975 | Train Acc: 0.4011
 Site-East_Asian                (3) | Train Loss: 1.5921 | Train Acc: 0.4384
 Site-Indian_utk                (0) | Train Loss: 1.6544 | Train Acc: 0.3953
 Site-Indian_utk                (0) | Train Loss: 1.6096 | Train Acc: 0.4375
 Site-Indian_utk                (0) | Train Loss: 1.7407 | Train Acc: 0.3404
 Site-Indian_utk                (0) | Train Loss: 1.6162 | Train Acc: 0.4029
 Site-Indian_utk                (0) | Train Loss: 1.6607 | Train Acc: 0.4341
 Site-Black_utk                 (5) | Train Loss: 1.6845 | Train Acc: 0.4182
 Site-Black_utk                 (5) | Train Loss: 1.7249 | Train Acc: 0.4074
 Site-Black_utk                 (5) | Train Loss: 1.7488 | Train Acc: 0.3277
 Site-Southeast_Asian           (3) | Train Loss: 1.8037 | Train Acc: 0.3627
 Site-Southeast_Asian           (3) | Train Loss: 1.7926 | Train Acc: 0.3667
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.6711 | Train Acc: 0.3895
 Site-White_ffhq                (4) | Train Loss: 1.6611 | Train Acc: 0.4188
Average Train Accuracy: 0.3858
 Site-White_utk                 (2) | Val  Loss: 1.7039 | Val  Acc: 0.2500
 Site-White_utk                 (2) | Val  Loss: 1.6279 | Val  Acc: 0.4545
 Site-White_utk                 (2) | Val  Loss: 1.7682 | Val  Acc: 0.1765
 Site-White_utk                 (2) | Val  Loss: 1.7206 | Val  Acc: 0.2400
 Site-White_utk                 (2) | Val  Loss: 1.6759 | Val  Acc: 0.4865
 Site-White_utk                 (2) | Val  Loss: 1.7653 | Val  Acc: 0.4182
 Site-White_utk                 (2) | Val  Loss: 1.8017 | Val  Acc: 0.3086
 Site-White_utk                 (2) | Val  Loss: 1.7355 | Val  Acc: 0.3445
 Site-White_utk                 (2) | Val  Loss: 1.7725 | Val  Acc: 0.3086
 Site-White_utk                 (2) | Val  Loss: 1.7880 | Val  Acc: 0.2984
 Site-East_Asian                (1) | Val  Loss: 1.6982 | Val  Acc: 0.4444
 Site-East_Asian                (3) | Val  Loss: 1.5431 | Val  Acc: 0.4231
 Site-East_Asian                (3) | Val  Loss: 1.6026 | Val  Acc: 0.4359
 Site-East_Asian                (3) | Val  Loss: 1.5885 | Val  Acc: 0.4035
 Site-East_Asian                (3) | Val  Loss: 1.6240 | Val  Acc: 0.4824
 Site-East_Asian                (3) | Val  Loss: 1.5776 | Val  Acc: 0.4640
 Site-East_Asian                (3) | Val  Loss: 1.6215 | Val  Acc: 0.4674
 Site-Indian_utk                (0) | Val  Loss: 1.7118 | Val  Acc: 0.4138
 Site-Indian_utk                (0) | Val  Loss: 1.5695 | Val  Acc: 0.4651
 Site-Indian_utk                (0) | Val  Loss: 1.6751 | Val  Acc: 0.3333
 Site-Indian_utk                (0) | Val  Loss: 1.7096 | Val  Acc: 0.3913
 Site-Indian_utk                (0) | Val  Loss: 1.6024 | Val  Acc: 0.4191
 Site-Black_utk                 (5) | Val  Loss: 1.7280 | Val  Acc: 0.4444
 Site-Black_utk                 (5) | Val  Loss: 1.7066 | Val  Acc: 0.3889
 Site-Black_utk                 (5) | Val  Loss: 1.6826 | Val  Acc: 0.3291
 Site-Southeast_Asian           (3) | Val  Loss: 1.8304 | Val  Acc: 0.3382
 Site-Southeast_Asian           (3) | Val  Loss: 1.7764 | Val  Acc: 0.4000
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8102 | Val  Acc: 0.3478
 Site-White_ffhq                (4) | Val  Loss: 1.5772 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3885
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2500
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.4545
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.1765
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2400
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.4865
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.4182
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3086
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3445
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.3086
 Best site-White_utk                (2)  | Epoch:8 | Val Acc: 0.2984
 Best site-East_Asian               (1)  | Epoch:8 | Val Acc: 0.4444
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4231
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4359
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4035
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4824
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4640
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4674
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.4138
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.4651
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.3333
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.3913
 Best site-Indian_utk               (0)  | Epoch:8 | Val Acc: 0.4191
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.4444
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.3889
 Best site-Black_utk                (5)  | Epoch:8 | Val Acc: 0.3291
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.3382
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.4000
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:8 | Val Acc: 0.3478
 Best site-White_ffhq               (4)  | Epoch:8 | Val Acc: 0.5897
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 9, 5, 11, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White_utk                 (5) | Train Loss: 1.5189 | Train Acc: 0.4167
 Site-White_utk                 (4) | Train Loss: 1.6588 | Train Acc: 0.2941
 Site-White_utk                 (4) | Train Loss: 1.6005 | Train Acc: 0.3077
 Site-White_utk                 (4) | Train Loss: 1.8368 | Train Acc: 0.2368
 Site-White_utk                 (1) | Train Loss: 1.6456 | Train Acc: 0.3214
 Site-White_utk                 (4) | Train Loss: 1.7436 | Train Acc: 0.4024
 Site-White_utk                 (4) | Train Loss: 1.6951 | Train Acc: 0.2893
 Site-White_utk                 (4) | Train Loss: 1.7586 | Train Acc: 0.3240
 Site-White_utk                 (4) | Train Loss: 1.6974 | Train Acc: 0.3156
 Site-White_utk                 (4) | Train Loss: 1.6892 | Train Acc: 0.3773
 Site-East_Asian                (2) | Train Loss: 1.4253 | Train Acc: 0.5185
 Site-East_Asian                (2) | Train Loss: 1.4888 | Train Acc: 0.4750
 Site-East_Asian                (2) | Train Loss: 1.7105 | Train Acc: 0.3559
 Site-East_Asian                (2) | Train Loss: 1.5974 | Train Acc: 0.4186
 Site-East_Asian                (2) | Train Loss: 1.5976 | Train Acc: 0.4882
 Site-East_Asian                (2) | Train Loss: 1.5823 | Train Acc: 0.3957
 Site-East_Asian                (2) | Train Loss: 1.5303 | Train Acc: 0.4783
 Site-Indian_utk                (3) | Train Loss: 1.5904 | Train Acc: 0.4884
 Site-Indian_utk                (3) | Train Loss: 1.5684 | Train Acc: 0.4531
 Site-Indian_utk                (3) | Train Loss: 1.6629 | Train Acc: 0.3617
 Site-Indian_utk                (3) | Train Loss: 1.6093 | Train Acc: 0.4317
 Site-Indian_utk                (3) | Train Loss: 1.5991 | Train Acc: 0.4488
 Site-Black_utk                 (4) | Train Loss: 1.5816 | Train Acc: 0.4909
 Site-Black_utk                 (4) | Train Loss: 1.6109 | Train Acc: 0.4074
 Site-Black_utk                 (4) | Train Loss: 1.7267 | Train Acc: 0.4034
 Site-Southeast_Asian           (2) | Train Loss: 1.8009 | Train Acc: 0.3824
 Site-Southeast_Asian           (2) | Train Loss: 1.7406 | Train Acc: 0.3933
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.6170 | Train Acc: 0.3721
 Site-White_ffhq                (0) | Train Loss: 1.5954 | Train Acc: 0.4615
Average Train Accuracy: 0.3969
 Site-White_utk                 (5) | Val  Loss: 1.5790 | Val  Acc: 0.1250
 Site-White_utk                 (4) | Val  Loss: 1.6219 | Val  Acc: 0.4545
 Site-White_utk                 (4) | Val  Loss: 1.7056 | Val  Acc: 0.3529
 Site-White_utk                 (4) | Val  Loss: 1.6664 | Val  Acc: 0.3200
 Site-White_utk                 (1) | Val  Loss: 1.6579 | Val  Acc: 0.3243
 Site-White_utk                 (4) | Val  Loss: 1.6971 | Val  Acc: 0.4000
 Site-White_utk                 (4) | Val  Loss: 1.7954 | Val  Acc: 0.2840
 Site-White_utk                 (4) | Val  Loss: 1.7169 | Val  Acc: 0.3193
 Site-White_utk                 (4) | Val  Loss: 1.7721 | Val  Acc: 0.3200
 Site-White_utk                 (4) | Val  Loss: 1.7492 | Val  Acc: 0.3178
 Site-East_Asian                (2) | Val  Loss: 1.6042 | Val  Acc: 0.5556
 Site-East_Asian                (2) | Val  Loss: 1.5967 | Val  Acc: 0.4615
 Site-East_Asian                (2) | Val  Loss: 1.5209 | Val  Acc: 0.4872
 Site-East_Asian                (2) | Val  Loss: 1.5836 | Val  Acc: 0.4035
 Site-East_Asian                (2) | Val  Loss: 1.6116 | Val  Acc: 0.4706
 Site-East_Asian                (2) | Val  Loss: 1.5593 | Val  Acc: 0.4960
 Site-East_Asian                (2) | Val  Loss: 1.5677 | Val  Acc: 0.4728
 Site-Indian_utk                (3) | Val  Loss: 1.6029 | Val  Acc: 0.4828
 Site-Indian_utk                (3) | Val  Loss: 1.5277 | Val  Acc: 0.4884
 Site-Indian_utk                (3) | Val  Loss: 1.5935 | Val  Acc: 0.3968
 Site-Indian_utk                (3) | Val  Loss: 1.6683 | Val  Acc: 0.3913
 Site-Indian_utk                (3) | Val  Loss: 1.5391 | Val  Acc: 0.3971
 Site-Black_utk                 (4) | Val  Loss: 1.6679 | Val  Acc: 0.5000
 Site-Black_utk                 (4) | Val  Loss: 1.7089 | Val  Acc: 0.3889
 Site-Black_utk                 (4) | Val  Loss: 1.6494 | Val  Acc: 0.4177
 Site-Southeast_Asian           (2) | Val  Loss: 1.8734 | Val  Acc: 0.3235
 Site-Southeast_Asian           (2) | Val  Loss: 1.7716 | Val  Acc: 0.3700
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.8203 | Val  Acc: 0.2783
 Site-White_ffhq                (0) | Val  Loss: 1.5436 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3988
 Best site-White_utk                (5)  | Epoch:9 | Val Acc: 0.1250
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.4545
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3529
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3200
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.3243
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.4000
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.2840
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3193
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3200
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3178
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.5556
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4615
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4872
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4035
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4706
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4960
 Best site-East_Asian               (2)  | Epoch:9 | Val Acc: 0.4728
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4828
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4884
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.3968
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.3913
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.3971
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.5000
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.3889
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.4177
 Best site-Southeast_Asian          (2)  | Epoch:9 | Val Acc: 0.3235
 Best site-Southeast_Asian          (2)  | Epoch:9 | Val Acc: 0.3700
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:9 | Val Acc: 0.2783
 Best site-White_ffhq               (0)  | Epoch:9 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1_gmap...
 Test site-White_utk                 (5)| Epoch:9 | Test Acc: 0.3186
 Test site-East_Asian                (2)| Epoch:9 | Test Acc: 0.4567
 Test site-Indian_utk                (3)| Epoch:9 | Test Acc: 0.4646
 Test site-Black_utk                 (4)| Epoch:9 | Test Acc: 0.3316
 Test site-Southeast_Asian           (2)| Epoch:9 | Test Acc: 0.4090
 Test site-Latino_Hispanic_ffhq      (0)| Epoch:9 | Test Acc: 0.2488
 Test site-White_ffhq                (0)| Epoch:9 | Test Acc: 0.2639
White_utk: 0.3186, East_Asian: 0.4567, Indian_utk: 0.4646, Black_utk: 0.3316, Southeast_Asian: 0.4090, Latino_Hispanic_ffhq: 0.2488, White_ffhq: 0.2639, 
Average Test Accuracy(group): 0.3562, Average Test Accuracy(individual): 0.3804,
domain CV=0.2294, cluster CV=nan, individual CV=0.1916, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-noqu_1.47_1_random_dis_cluster_6_weak_white/ccop_q=1...
===2023-06-15 11:37:28===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 6
Loading snapshots...
 Test site-White_utk                 (5)| Epoch:8 | Test Acc: 0.3155
 Test site-East_Asian                (2)| Epoch:8 | Test Acc: 0.4517
 Test site-Indian_utk                (3)| Epoch:8 | Test Acc: 0.4313
 Test site-Black_utk                 (4)| Epoch:8 | Test Acc: 0.3214
 Test site-Southeast_Asian           (2)| Epoch:8 | Test Acc: 0.3899
 Test site-Latino_Hispanic_ffhq      (0)| Epoch:8 | Test Acc: 0.2338
 Test site-White_ffhq                (0)| Epoch:8 | Test Acc: 0.2530
White_utk: 0.3155, East_Asian: 0.4517, Indian_utk: 0.4313, Black_utk: 0.3214, Southeast_Asian: 0.3899, Latino_Hispanic_ffhq: 0.2338, White_ffhq: 0.2530, 
Average Test Accuracy(group): 0.3424, Average Test Accuracy(individual): 0.3691,
domain CV=0.2290, cluster CV=nan, individual CV=0.1850, 
