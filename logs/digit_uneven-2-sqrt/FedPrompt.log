===2023-03-25 17:41:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7115 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.6156 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.6272 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.5477 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.6637 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 2.2363 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1877 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.7038 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 2.1169 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2103 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.5439 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.5727 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.6330 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6746 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.6057 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.1855 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2295 | Val  Acc: 0.1186
 Site-USPS      | Val  Loss: 1.7326 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 2.1061 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2228 | Val  Acc: 0.1356
Average Valid Accuracy: 0.4729
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1186
 Best site-USPS       | Epoch:0 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2288 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.1466 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 1.2019 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.0487 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 1.1708 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 2.1829 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0574 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.3275 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8712 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 2.0790 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 1.0291 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 1.0657 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.2081 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.2133 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1070 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0984 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.1367 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.2993 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.8860 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 2.1163 | Val  Acc: 0.1695
Average Valid Accuracy: 0.6000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7826 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.7416 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.7448 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6460 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.7693 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 2.1243 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 1.9955 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 0.9595 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.7453 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.9769 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 0.6024 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6507 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.7510 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.7921 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.7061 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0186 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0310 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.9991 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.7574 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0311 | Val  Acc: 0.2712
Average Valid Accuracy: 0.6203
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2203
 Best site-USPS       | Epoch:2 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6058 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.5359 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.5677 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4510 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.5268 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 2.0613 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.8155 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.7073 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.4981 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.7704 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 0.4460 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4499 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.5775 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5640 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5193 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.8871 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8514 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.7293 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.5907 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.8281 | Val  Acc: 0.3729
Average Valid Accuracy: 0.6847
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3597 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.3321 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3178 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2508 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.3711 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.8519 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7303 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 0.5504 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.4244 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.5995 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 0.2567 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2568 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3362 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3512 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3501 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.7987 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.7630 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.5740 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.5463 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7464 | Val  Acc: 0.4068
Average Valid Accuracy: 0.7220
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3559
 Best site-USPS       | Epoch:4 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3008 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2891 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2729 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2093 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2598 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.5967 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.6054 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.4814 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.3140 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.3667 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.2036 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2152 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2986 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2918 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2836 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.6523 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.5703 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.4735 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.5109 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.5686 | Val  Acc: 0.4746
Average Valid Accuracy: 0.7441
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4237
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2128 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.1879 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1847 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1174 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1613 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.5867 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.4276 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.3960 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.0249 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.1299 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.1219 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1338 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2008 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1951 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2057 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.5545 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.4358 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.4167 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.2878 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.4431 | Val  Acc: 0.5254
Average Valid Accuracy: 0.7780
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4746
 Best site-USPS       | Epoch:6 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1588 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1308 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1417 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0798 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1185 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.2570 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.3390 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.3110 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.9557 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.9579 | Train Acc: 0.7159
 Site-MNIST     | Val  Loss: 0.0799 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0970 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1548 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1336 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1492 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.4250 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.2758 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.3630 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2798 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.3377 | Val  Acc: 0.6102
Average Valid Accuracy: 0.8034
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4915
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1038 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0891 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0901 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0440 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0740 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.0320 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 1.0107 | Train Acc: 0.6591
 Site-USPS      | Train Loss: 0.3218 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.7779 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.7183 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.0457 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0586 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1040 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0873 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1023 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.0917 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 0.9929 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 0.3388 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.1124 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.2343 | Val  Acc: 0.6271
Average Valid Accuracy: 0.8458
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6949
 Best site-USPS       | Epoch:8 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0805 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0643 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0824 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0327 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0539 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.8589 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 0.8972 | Train Acc: 0.6705
 Site-USPS      | Train Loss: 0.2533 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.5930 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.5635 | Train Acc: 0.8636
 Site-MNIST     | Val  Loss: 0.0328 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0450 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0857 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0636 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0820 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.9541 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 0.8685 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.2791 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.9991 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.1556 | Val  Acc: 0.6271
Average Valid Accuracy: 0.8542
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7458
 Best site-USPS       | Epoch:9 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt...
===2023-03-25 18:15:55===
===2023-03-25 18:15:57===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8907
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3204
 Test site-USPS      | Epoch:9 | Test Acc: 0.8280
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5223
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3643
Average Test Accuracy: 0.5851
===2023-03-30 18:57:50===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
===2023-03-30 18:58:41===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
