===2023-03-25 18:19:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7516 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.6463 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.6637 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.5769 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.6694 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 2.2300 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.1996 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.7488 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1157 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2295 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.5834 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.6110 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.6622 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.6954 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.6413 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.1972 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2315 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.7605 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 2.1250 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.2107 | Val  Acc: 0.1695
Average Valid Accuracy: 0.4542
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3174 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.2673 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.2694 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.1921 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.2701 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 2.1571 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.1345 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.3721 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 1.9754 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.1238 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 1.1651 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 1.2230 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.2728 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.3152 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.2222 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.1302 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.1500 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.4298 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 1.9520 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1064 | Val  Acc: 0.1695
Average Valid Accuracy: 0.5475
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0384 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.0276 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.0191 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.9265 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 1.0443 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.1166 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0482 | Train Acc: 0.2386
 Site-USPS      | Train Loss: 1.1952 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.8548 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.0191 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 0.9093 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.9723 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 1.0329 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.0733 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.9716 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.0845 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.0948 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.2033 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.8290 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0326 | Val  Acc: 0.2034
Average Valid Accuracy: 0.6034
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2034
 Best site-USPS       | Epoch:2 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8789 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.8614 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.8665 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.7739 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.8760 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 2.0772 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.0447 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.0231 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7729 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.9511 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 0.7406 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.8026 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.8647 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9027 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7998 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0469 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0466 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 1.0522 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.7452 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.9710 | Val  Acc: 0.2373
Average Valid Accuracy: 0.6407
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2373
 Best site-USPS       | Epoch:3 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7280 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.7359 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.7276 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.6285 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.7326 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 2.0427 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.9921 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 0.9153 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7150 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.8614 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 0.6167 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.6734 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.7242 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.7707 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6703 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0119 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9961 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.9517 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.6817 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.9131 | Val  Acc: 0.2542
Average Valid Accuracy: 0.6610
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-USPS       | Epoch:4 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6196 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6211 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.6316 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5528 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.6556 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.9877 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.9194 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 0.8578 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.6814 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.7869 | Train Acc: 0.3409
 Site-MNIST     | Val  Loss: 0.5298 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5836 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.6295 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6760 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5777 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.9770 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9502 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.8808 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.6252 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.8579 | Val  Acc: 0.3220
Average Valid Accuracy: 0.6864
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2881
 Best site-USPS       | Epoch:5 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5687 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.5740 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5773 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4842 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.5896 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.9668 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8852 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 0.7858 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.5984 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.7176 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 0.4699 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5129 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5684 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6007 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5116 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.9405 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9142 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.8097 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.5653 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8143 | Val  Acc: 0.3898
Average Valid Accuracy: 0.7051
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2881
 Best site-USPS       | Epoch:6 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5148 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.5061 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5210 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4198 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.5048 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.9240 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8557 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 0.7163 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.5333 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.6758 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.4200 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4544 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5036 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.5362 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4565 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.9092 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8758 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.7605 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.5186 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7697 | Val  Acc: 0.4407
Average Valid Accuracy: 0.7186
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2881
 Best site-USPS       | Epoch:7 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4681 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4813 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4638 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3837 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.4511 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.9197 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8074 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 0.7196 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.4672 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.6281 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.3838 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4169 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4573 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4879 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4192 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.8870 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8420 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.7139 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.4760 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7249 | Val  Acc: 0.4576
Average Valid Accuracy: 0.7237
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3051
 Best site-USPS       | Epoch:8 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4087 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4375 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4371 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3471 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.4533 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.9024 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7883 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 0.6623 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.4276 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.5615 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.3510 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3794 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4159 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4453 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3832 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.8607 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8104 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.6784 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.4272 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6853 | Val  Acc: 0.4576
Average Valid Accuracy: 0.7254
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3051
 Best site-USPS       | Epoch:9 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/DoPrompt...
===2023-03-25 18:53:36===
===2023-03-25 18:53:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8464
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2751
 Test site-USPS      | Epoch:9 | Test Acc: 0.8333
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4510
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3643
Average Test Accuracy: 0.5540
