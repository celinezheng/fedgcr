===2023-05-14 10:45:03===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[82,247,82,247,82,247,82,247,82,247,82,247,82,247,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1100,1100,1100,1100,1100,1100,1100,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
============ Train epoch 0 ============
 Site-White           | Train Loss: 1.9508 | Train Acc: 0.3293
 Site-White           | Train Loss: 1.9217 | Train Acc: 0.3198
 Site-Latino_Hispanic | Train Loss: 2.0316 | Train Acc: 0.2683
 Site-Latino_Hispanic | Train Loss: 2.0040 | Train Acc: 0.2672
 Site-Black           | Train Loss: 2.1029 | Train Acc: 0.2439
 Site-Black           | Train Loss: 1.9751 | Train Acc: 0.2874
 Site-East_Asian      | Train Loss: 1.9590 | Train Acc: 0.3780
 Site-East_Asian      | Train Loss: 1.9346 | Train Acc: 0.3239
 Site-Indian          | Train Loss: 2.0756 | Train Acc: 0.2317
 Site-Indian          | Train Loss: 2.1854 | Train Acc: 0.2308
 Site-Southeast_Asian | Train Loss: 2.1611 | Train Acc: 0.3049
 Site-Southeast_Asian | Train Loss: 2.1020 | Train Acc: 0.3036
 Site-Middle_Eastern  | Train Loss: 1.7844 | Train Acc: 0.3415
 Site-Middle_Eastern  | Train Loss: 1.9066 | Train Acc: 0.3603
 Site-White           | Val  Loss: 1.9854 | Val  Acc: 0.3273
 Site-White           | Val  Loss: 1.9566 | Val  Acc: 0.3152
 Site-Latino_Hispanic | Val  Loss: 2.0055 | Val  Acc: 0.2909
 Site-Latino_Hispanic | Val  Loss: 2.0115 | Val  Acc: 0.2667
 Site-Black           | Val  Loss: 2.2427 | Val  Acc: 0.1818
 Site-Black           | Val  Loss: 1.9521 | Val  Acc: 0.2970
 Site-East_Asian      | Val  Loss: 1.9060 | Val  Acc: 0.3091
 Site-East_Asian      | Val  Loss: 1.9263 | Val  Acc: 0.3515
 Site-Indian          | Val  Loss: 2.1978 | Val  Acc: 0.2182
 Site-Indian          | Val  Loss: 2.1970 | Val  Acc: 0.2242
 Site-Southeast_Asian | Val  Loss: 2.1247 | Val  Acc: 0.2909
 Site-Southeast_Asian | Val  Loss: 2.0952 | Val  Acc: 0.3030
 Site-Middle_Eastern  | Val  Loss: 2.0251 | Val  Acc: 0.3273
 Site-Middle_Eastern  | Val  Loss: 1.9621 | Val  Acc: 0.3273
Average Valid Accuracy: 0.2879
 Best site-White            | Epoch:0 | Val Acc: 0.3273
 Best site-White            | Epoch:0 | Val Acc: 0.3152
 Best site-Latino_Hispanic  | Epoch:0 | Val Acc: 0.2909
 Best site-Latino_Hispanic  | Epoch:0 | Val Acc: 0.2667
 Best site-Black            | Epoch:0 | Val Acc: 0.1818
 Best site-Black            | Epoch:0 | Val Acc: 0.2970
 Best site-East_Asian       | Epoch:0 | Val Acc: 0.3091
 Best site-East_Asian       | Epoch:0 | Val Acc: 0.3515
 Best site-Indian           | Epoch:0 | Val Acc: 0.2182
 Best site-Indian           | Epoch:0 | Val Acc: 0.2242
 Best site-Southeast_Asian  | Epoch:0 | Val Acc: 0.2909
 Best site-Southeast_Asian  | Epoch:0 | Val Acc: 0.3030
 Best site-Middle_Eastern   | Epoch:0 | Val Acc: 0.3273
 Best site-Middle_Eastern   | Epoch:0 | Val Acc: 0.3273
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 1 ============
 Site-White           | Train Loss: 1.9060 | Train Acc: 0.3049
 Site-White           | Train Loss: 1.9156 | Train Acc: 0.3401
 Site-Latino_Hispanic | Train Loss: 1.8893 | Train Acc: 0.3049
 Site-Latino_Hispanic | Train Loss: 1.9250 | Train Acc: 0.2348
 Site-Black           | Train Loss: 1.9598 | Train Acc: 0.2195
 Site-Black           | Train Loss: 1.8873 | Train Acc: 0.2834
 Site-East_Asian      | Train Loss: 1.7721 | Train Acc: 0.3415
 Site-East_Asian      | Train Loss: 1.8904 | Train Acc: 0.2874
 Site-Indian          | Train Loss: 2.0069 | Train Acc: 0.2195
 Site-Indian          | Train Loss: 2.0971 | Train Acc: 0.2146
 Site-Southeast_Asian | Train Loss: 2.1754 | Train Acc: 0.2561
 Site-Southeast_Asian | Train Loss: 2.0993 | Train Acc: 0.2915
 Site-Middle_Eastern  | Train Loss: 1.9733 | Train Acc: 0.3049
 Site-Middle_Eastern  | Train Loss: 1.8626 | Train Acc: 0.3522
 Site-White           | Val  Loss: 2.0185 | Val  Acc: 0.2727
 Site-White           | Val  Loss: 1.9628 | Val  Acc: 0.3030
 Site-Latino_Hispanic | Val  Loss: 1.8839 | Val  Acc: 0.2727
 Site-Latino_Hispanic | Val  Loss: 1.9328 | Val  Acc: 0.2242
 Site-Black           | Val  Loss: 2.0989 | Val  Acc: 0.1636
 Site-Black           | Val  Loss: 1.8704 | Val  Acc: 0.2909
 Site-East_Asian      | Val  Loss: 1.8499 | Val  Acc: 0.3636
 Site-East_Asian      | Val  Loss: 1.8738 | Val  Acc: 0.3152
 Site-Indian          | Val  Loss: 2.0790 | Val  Acc: 0.2182
 Site-Indian          | Val  Loss: 2.1032 | Val  Acc: 0.2121
 Site-Southeast_Asian | Val  Loss: 2.1400 | Val  Acc: 0.2909
 Site-Southeast_Asian | Val  Loss: 2.0888 | Val  Acc: 0.2848
 Site-Middle_Eastern  | Val  Loss: 1.9704 | Val  Acc: 0.2727
 Site-Middle_Eastern  | Val  Loss: 1.9179 | Val  Acc: 0.2848
Average Valid Accuracy: 0.2693
============ Train epoch 2 ============
 Site-White           | Train Loss: 1.8193 | Train Acc: 0.3415
 Site-White           | Train Loss: 1.8952 | Train Acc: 0.3320
 Site-Latino_Hispanic | Train Loss: 1.8361 | Train Acc: 0.2805
 Site-Latino_Hispanic | Train Loss: 1.9049 | Train Acc: 0.2753
 Site-Black           | Train Loss: 1.9540 | Train Acc: 0.2561
 Site-Black           | Train Loss: 1.8579 | Train Acc: 0.2510
 Site-East_Asian      | Train Loss: 1.7811 | Train Acc: 0.3659
 Site-East_Asian      | Train Loss: 1.8653 | Train Acc: 0.2915
 Site-Indian          | Train Loss: 1.9319 | Train Acc: 0.1951
 Site-Indian          | Train Loss: 2.0772 | Train Acc: 0.2308
 Site-Southeast_Asian | Train Loss: 1.9887 | Train Acc: 0.2683
 Site-Southeast_Asian | Train Loss: 2.0495 | Train Acc: 0.3036
 Site-Middle_Eastern  | Train Loss: 1.7944 | Train Acc: 0.3415
 Site-Middle_Eastern  | Train Loss: 1.8428 | Train Acc: 0.3117
 Site-White           | Val  Loss: 1.9488 | Val  Acc: 0.2909
 Site-White           | Val  Loss: 1.9207 | Val  Acc: 0.3212
 Site-Latino_Hispanic | Val  Loss: 1.8668 | Val  Acc: 0.3273
 Site-Latino_Hispanic | Val  Loss: 1.9082 | Val  Acc: 0.2667
 Site-Black           | Val  Loss: 2.0505 | Val  Acc: 0.1818
 Site-Black           | Val  Loss: 1.8492 | Val  Acc: 0.2667
 Site-East_Asian      | Val  Loss: 1.8502 | Val  Acc: 0.3091
 Site-East_Asian      | Val  Loss: 1.8604 | Val  Acc: 0.3091
 Site-Indian          | Val  Loss: 2.0236 | Val  Acc: 0.2545
 Site-Indian          | Val  Loss: 2.0388 | Val  Acc: 0.2303
 Site-Southeast_Asian | Val  Loss: 2.0920 | Val  Acc: 0.2727
 Site-Southeast_Asian | Val  Loss: 2.0495 | Val  Acc: 0.2909
 Site-Middle_Eastern  | Val  Loss: 1.9289 | Val  Acc: 0.3273
 Site-Middle_Eastern  | Val  Loss: 1.8895 | Val  Acc: 0.2970
Average Valid Accuracy: 0.2818
============ Train epoch 3 ============
 Site-White           | Train Loss: 1.8254 | Train Acc: 0.3293
 Site-White           | Train Loss: 1.8841 | Train Acc: 0.3360
 Site-Latino_Hispanic | Train Loss: 1.8277 | Train Acc: 0.2805
 Site-Latino_Hispanic | Train Loss: 1.8684 | Train Acc: 0.2794
 Site-Black           | Train Loss: 1.8773 | Train Acc: 0.2561
 Site-Black           | Train Loss: 1.8410 | Train Acc: 0.2713
 Site-East_Asian      | Train Loss: 1.8309 | Train Acc: 0.3780
 Site-East_Asian      | Train Loss: 1.8423 | Train Acc: 0.3117
 Site-Indian          | Train Loss: 1.9206 | Train Acc: 0.3049
 Site-Indian          | Train Loss: 2.0156 | Train Acc: 0.2267
 Site-Southeast_Asian | Train Loss: 2.1349 | Train Acc: 0.2805
 Site-Southeast_Asian | Train Loss: 2.0071 | Train Acc: 0.2996
 Site-Middle_Eastern  | Train Loss: 1.7668 | Train Acc: 0.3659
 Site-Middle_Eastern  | Train Loss: 1.8150 | Train Acc: 0.3563
 Site-White           | Val  Loss: 1.9552 | Val  Acc: 0.3273
 Site-White           | Val  Loss: 1.9207 | Val  Acc: 0.3091
 Site-Latino_Hispanic | Val  Loss: 1.8601 | Val  Acc: 0.3091
 Site-Latino_Hispanic | Val  Loss: 1.8797 | Val  Acc: 0.2788
 Site-Black           | Val  Loss: 2.0257 | Val  Acc: 0.1455
 Site-Black           | Val  Loss: 1.8275 | Val  Acc: 0.2909
 Site-East_Asian      | Val  Loss: 1.8727 | Val  Acc: 0.2727
 Site-East_Asian      | Val  Loss: 1.8353 | Val  Acc: 0.3576
 Site-Indian          | Val  Loss: 1.9744 | Val  Acc: 0.2364
 Site-Indian          | Val  Loss: 2.0209 | Val  Acc: 0.2545
 Site-Southeast_Asian | Val  Loss: 2.0336 | Val  Acc: 0.3091
 Site-Southeast_Asian | Val  Loss: 2.0115 | Val  Acc: 0.2727
 Site-Middle_Eastern  | Val  Loss: 1.9085 | Val  Acc: 0.3273
 Site-Middle_Eastern  | Val  Loss: 1.8687 | Val  Acc: 0.3212
Average Valid Accuracy: 0.2866
============ Train epoch 4 ============
 Site-White           | Train Loss: 1.8205 | Train Acc: 0.3171
 Site-White           | Train Loss: 1.8496 | Train Acc: 0.3401
 Site-Latino_Hispanic | Train Loss: 1.7600 | Train Acc: 0.3049
 Site-Latino_Hispanic | Train Loss: 1.8561 | Train Acc: 0.2470
 Site-Black           | Train Loss: 1.8562 | Train Acc: 0.2317
 Site-Black           | Train Loss: 1.8292 | Train Acc: 0.2834
 Site-East_Asian      | Train Loss: 1.6429 | Train Acc: 0.3780
 Site-East_Asian      | Train Loss: 1.8150 | Train Acc: 0.3320
 Site-Indian          | Train Loss: 1.9448 | Train Acc: 0.2805
 Site-Indian          | Train Loss: 2.0003 | Train Acc: 0.2267
 Site-Southeast_Asian | Train Loss: 1.9314 | Train Acc: 0.3171
 Site-Southeast_Asian | Train Loss: 1.9739 | Train Acc: 0.2955
 Site-Middle_Eastern  | Train Loss: 1.8050 | Train Acc: 0.3171
 Site-Middle_Eastern  | Train Loss: 1.8052 | Train Acc: 0.3441
 Site-White           | Val  Loss: 1.9402 | Val  Acc: 0.2727
 Site-White           | Val  Loss: 1.8780 | Val  Acc: 0.3455
 Site-Latino_Hispanic | Val  Loss: 1.8302 | Val  Acc: 0.2727
 Site-Latino_Hispanic | Val  Loss: 1.8711 | Val  Acc: 0.2606
 Site-Black           | Val  Loss: 1.9857 | Val  Acc: 0.2000
 Site-Black           | Val  Loss: 1.8095 | Val  Acc: 0.2970
 Site-East_Asian      | Val  Loss: 1.8417 | Val  Acc: 0.2909
 Site-East_Asian      | Val  Loss: 1.7994 | Val  Acc: 0.3515
 Site-Indian          | Val  Loss: 1.9517 | Val  Acc: 0.2364
 Site-Indian          | Val  Loss: 1.9845 | Val  Acc: 0.2303
 Site-Southeast_Asian | Val  Loss: 2.0132 | Val  Acc: 0.3273
 Site-Southeast_Asian | Val  Loss: 1.9605 | Val  Acc: 0.3030
 Site-Middle_Eastern  | Val  Loss: 1.8727 | Val  Acc: 0.3636
 Site-Middle_Eastern  | Val  Loss: 1.8351 | Val  Acc: 0.3273
Average Valid Accuracy: 0.2913
 Best site-White            | Epoch:4 | Val Acc: 0.2727
 Best site-White            | Epoch:4 | Val Acc: 0.3455
 Best site-Latino_Hispanic  | Epoch:4 | Val Acc: 0.2727
 Best site-Latino_Hispanic  | Epoch:4 | Val Acc: 0.2606
 Best site-Black            | Epoch:4 | Val Acc: 0.2000
 Best site-Black            | Epoch:4 | Val Acc: 0.2970
 Best site-East_Asian       | Epoch:4 | Val Acc: 0.2909
 Best site-East_Asian       | Epoch:4 | Val Acc: 0.3515
 Best site-Indian           | Epoch:4 | Val Acc: 0.2364
 Best site-Indian           | Epoch:4 | Val Acc: 0.2303
 Best site-Southeast_Asian  | Epoch:4 | Val Acc: 0.3273
 Best site-Southeast_Asian  | Epoch:4 | Val Acc: 0.3030
 Best site-Middle_Eastern   | Epoch:4 | Val Acc: 0.3636
 Best site-Middle_Eastern   | Epoch:4 | Val Acc: 0.3273
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 5 ============
 Site-White           | Train Loss: 1.8023 | Train Acc: 0.3049
 Site-White           | Train Loss: 1.8198 | Train Acc: 0.3401
 Site-Latino_Hispanic | Train Loss: 1.8446 | Train Acc: 0.2927
 Site-Latino_Hispanic | Train Loss: 1.8298 | Train Acc: 0.2470
 Site-Black           | Train Loss: 1.8182 | Train Acc: 0.2561
 Site-Black           | Train Loss: 1.8292 | Train Acc: 0.2632
 Site-East_Asian      | Train Loss: 1.7518 | Train Acc: 0.3659
 Site-East_Asian      | Train Loss: 1.7804 | Train Acc: 0.3482
 Site-Indian          | Train Loss: 1.8565 | Train Acc: 0.3049
 Site-Indian          | Train Loss: 1.9518 | Train Acc: 0.2389
 Site-Southeast_Asian | Train Loss: 2.0419 | Train Acc: 0.2927
 Site-Southeast_Asian | Train Loss: 1.9248 | Train Acc: 0.3077
 Site-Middle_Eastern  | Train Loss: 1.7268 | Train Acc: 0.3537
 Site-Middle_Eastern  | Train Loss: 1.7693 | Train Acc: 0.3563
 Site-White           | Val  Loss: 1.9142 | Val  Acc: 0.3273
 Site-White           | Val  Loss: 1.8647 | Val  Acc: 0.3212
 Site-Latino_Hispanic | Val  Loss: 1.8187 | Val  Acc: 0.2727
 Site-Latino_Hispanic | Val  Loss: 1.8376 | Val  Acc: 0.2545
 Site-Black           | Val  Loss: 1.9462 | Val  Acc: 0.1636
 Site-Black           | Val  Loss: 1.8211 | Val  Acc: 0.2848
 Site-East_Asian      | Val  Loss: 1.7896 | Val  Acc: 0.3455
 Site-East_Asian      | Val  Loss: 1.7799 | Val  Acc: 0.3576
 Site-Indian          | Val  Loss: 1.8703 | Val  Acc: 0.3091
 Site-Indian          | Val  Loss: 1.9375 | Val  Acc: 0.2485
 Site-Southeast_Asian | Val  Loss: 1.9568 | Val  Acc: 0.3091
 Site-Southeast_Asian | Val  Loss: 1.9159 | Val  Acc: 0.3212
 Site-Middle_Eastern  | Val  Loss: 1.8322 | Val  Acc: 0.3273
 Site-Middle_Eastern  | Val  Loss: 1.8189 | Val  Acc: 0.3455
Average Valid Accuracy: 0.2991
 Best site-White            | Epoch:5 | Val Acc: 0.3273
 Best site-White            | Epoch:5 | Val Acc: 0.3212
 Best site-Latino_Hispanic  | Epoch:5 | Val Acc: 0.2727
 Best site-Latino_Hispanic  | Epoch:5 | Val Acc: 0.2545
 Best site-Black            | Epoch:5 | Val Acc: 0.1636
 Best site-Black            | Epoch:5 | Val Acc: 0.2848
 Best site-East_Asian       | Epoch:5 | Val Acc: 0.3455
 Best site-East_Asian       | Epoch:5 | Val Acc: 0.3576
 Best site-Indian           | Epoch:5 | Val Acc: 0.3091
 Best site-Indian           | Epoch:5 | Val Acc: 0.2485
 Best site-Southeast_Asian  | Epoch:5 | Val Acc: 0.3091
 Best site-Southeast_Asian  | Epoch:5 | Val Acc: 0.3212
 Best site-Middle_Eastern   | Epoch:5 | Val Acc: 0.3273
 Best site-Middle_Eastern   | Epoch:5 | Val Acc: 0.3455
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 6 ============
 Site-White           | Train Loss: 1.7664 | Train Acc: 0.2927
 Site-White           | Train Loss: 1.7985 | Train Acc: 0.3401
 Site-Latino_Hispanic | Train Loss: 1.7602 | Train Acc: 0.2805
 Site-Latino_Hispanic | Train Loss: 1.8183 | Train Acc: 0.2672
 Site-Black           | Train Loss: 1.7712 | Train Acc: 0.2317
 Site-Black           | Train Loss: 1.8099 | Train Acc: 0.2915
 Site-East_Asian      | Train Loss: 1.7700 | Train Acc: 0.4024
 Site-East_Asian      | Train Loss: 1.7492 | Train Acc: 0.3725
 Site-Indian          | Train Loss: 1.8871 | Train Acc: 0.2683
 Site-Indian          | Train Loss: 1.9050 | Train Acc: 0.2429
 Site-Southeast_Asian | Train Loss: 1.9213 | Train Acc: 0.3537
 Site-Southeast_Asian | Train Loss: 1.8970 | Train Acc: 0.2955
 Site-Middle_Eastern  | Train Loss: 1.7858 | Train Acc: 0.3902
 Site-Middle_Eastern  | Train Loss: 1.7579 | Train Acc: 0.3765
 Site-White           | Val  Loss: 1.9035 | Val  Acc: 0.2909
 Site-White           | Val  Loss: 1.8235 | Val  Acc: 0.3455
 Site-Latino_Hispanic | Val  Loss: 1.7932 | Val  Acc: 0.2909
 Site-Latino_Hispanic | Val  Loss: 1.8110 | Val  Acc: 0.2909
 Site-Black           | Val  Loss: 1.9434 | Val  Acc: 0.2182
 Site-Black           | Val  Loss: 1.7734 | Val  Acc: 0.3394
 Site-East_Asian      | Val  Loss: 1.7699 | Val  Acc: 0.3636
 Site-East_Asian      | Val  Loss: 1.7647 | Val  Acc: 0.3758
 Site-Indian          | Val  Loss: 1.8030 | Val  Acc: 0.2909
 Site-Indian          | Val  Loss: 1.8759 | Val  Acc: 0.2424
 Site-Southeast_Asian | Val  Loss: 1.9390 | Val  Acc: 0.3455
 Site-Southeast_Asian | Val  Loss: 1.8570 | Val  Acc: 0.3576
 Site-Middle_Eastern  | Val  Loss: 1.8264 | Val  Acc: 0.4000
 Site-Middle_Eastern  | Val  Loss: 1.7805 | Val  Acc: 0.3697
Average Valid Accuracy: 0.3229
 Best site-White            | Epoch:6 | Val Acc: 0.2909
 Best site-White            | Epoch:6 | Val Acc: 0.3455
 Best site-Latino_Hispanic  | Epoch:6 | Val Acc: 0.2909
 Best site-Latino_Hispanic  | Epoch:6 | Val Acc: 0.2909
 Best site-Black            | Epoch:6 | Val Acc: 0.2182
 Best site-Black            | Epoch:6 | Val Acc: 0.3394
 Best site-East_Asian       | Epoch:6 | Val Acc: 0.3636
 Best site-East_Asian       | Epoch:6 | Val Acc: 0.3758
 Best site-Indian           | Epoch:6 | Val Acc: 0.2909
 Best site-Indian           | Epoch:6 | Val Acc: 0.2424
 Best site-Southeast_Asian  | Epoch:6 | Val Acc: 0.3455
 Best site-Southeast_Asian  | Epoch:6 | Val Acc: 0.3576
 Best site-Middle_Eastern   | Epoch:6 | Val Acc: 0.4000
 Best site-Middle_Eastern   | Epoch:6 | Val Acc: 0.3697
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 7 ============
 Site-White           | Train Loss: 1.7395 | Train Acc: 0.3659
 Site-White           | Train Loss: 1.7738 | Train Acc: 0.3522
 Site-Latino_Hispanic | Train Loss: 1.6962 | Train Acc: 0.3415
 Site-Latino_Hispanic | Train Loss: 1.7696 | Train Acc: 0.2915
 Site-Black           | Train Loss: 1.8313 | Train Acc: 0.3293
 Site-Black           | Train Loss: 1.7815 | Train Acc: 0.3117
 Site-East_Asian      | Train Loss: 1.6306 | Train Acc: 0.4634
 Site-East_Asian      | Train Loss: 1.7138 | Train Acc: 0.3725
 Site-Indian          | Train Loss: 1.7650 | Train Acc: 0.2927
 Site-Indian          | Train Loss: 1.8705 | Train Acc: 0.2753
 Site-Southeast_Asian | Train Loss: 1.9014 | Train Acc: 0.3049
 Site-Southeast_Asian | Train Loss: 1.8308 | Train Acc: 0.3320
 Site-Middle_Eastern  | Train Loss: 1.7328 | Train Acc: 0.4268
 Site-Middle_Eastern  | Train Loss: 1.7260 | Train Acc: 0.3603
 Site-White           | Val  Loss: 1.8540 | Val  Acc: 0.2909
 Site-White           | Val  Loss: 1.8231 | Val  Acc: 0.3455
 Site-Latino_Hispanic | Val  Loss: 1.7562 | Val  Acc: 0.2909
 Site-Latino_Hispanic | Val  Loss: 1.7684 | Val  Acc: 0.3152
 Site-Black           | Val  Loss: 1.9085 | Val  Acc: 0.2000
 Site-Black           | Val  Loss: 1.7661 | Val  Acc: 0.3576
 Site-East_Asian      | Val  Loss: 1.7357 | Val  Acc: 0.4000
 Site-East_Asian      | Val  Loss: 1.6972 | Val  Acc: 0.4000
 Site-Indian          | Val  Loss: 1.7607 | Val  Acc: 0.4000
 Site-Indian          | Val  Loss: 1.8553 | Val  Acc: 0.2727
 Site-Southeast_Asian | Val  Loss: 1.8872 | Val  Acc: 0.3273
 Site-Southeast_Asian | Val  Loss: 1.8260 | Val  Acc: 0.3273
 Site-Middle_Eastern  | Val  Loss: 1.7934 | Val  Acc: 0.3455
 Site-Middle_Eastern  | Val  Loss: 1.7391 | Val  Acc: 0.3818
Average Valid Accuracy: 0.3325
 Best site-White            | Epoch:7 | Val Acc: 0.2909
 Best site-White            | Epoch:7 | Val Acc: 0.3455
 Best site-Latino_Hispanic  | Epoch:7 | Val Acc: 0.2909
 Best site-Latino_Hispanic  | Epoch:7 | Val Acc: 0.3152
 Best site-Black            | Epoch:7 | Val Acc: 0.2000
 Best site-Black            | Epoch:7 | Val Acc: 0.3576
 Best site-East_Asian       | Epoch:7 | Val Acc: 0.4000
 Best site-East_Asian       | Epoch:7 | Val Acc: 0.4000
 Best site-Indian           | Epoch:7 | Val Acc: 0.4000
 Best site-Indian           | Epoch:7 | Val Acc: 0.2727
 Best site-Southeast_Asian  | Epoch:7 | Val Acc: 0.3273
 Best site-Southeast_Asian  | Epoch:7 | Val Acc: 0.3273
 Best site-Middle_Eastern   | Epoch:7 | Val Acc: 0.3455
 Best site-Middle_Eastern   | Epoch:7 | Val Acc: 0.3818
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 8 ============
 Site-White           | Train Loss: 1.6762 | Train Acc: 0.3780
 Site-White           | Train Loss: 1.7224 | Train Acc: 0.3522
 Site-Latino_Hispanic | Train Loss: 1.7763 | Train Acc: 0.3171
 Site-Latino_Hispanic | Train Loss: 1.7550 | Train Acc: 0.3077
 Site-Black           | Train Loss: 1.8434 | Train Acc: 0.2805
 Site-Black           | Train Loss: 1.7591 | Train Acc: 0.3198
 Site-East_Asian      | Train Loss: 1.5505 | Train Acc: 0.4390
 Site-East_Asian      | Train Loss: 1.6821 | Train Acc: 0.3968
 Site-Indian          | Train Loss: 1.8494 | Train Acc: 0.3415
 Site-Indian          | Train Loss: 1.8404 | Train Acc: 0.2915
 Site-Southeast_Asian | Train Loss: 1.8206 | Train Acc: 0.3049
 Site-Southeast_Asian | Train Loss: 1.7976 | Train Acc: 0.3522
 Site-Middle_Eastern  | Train Loss: 1.6745 | Train Acc: 0.4146
 Site-Middle_Eastern  | Train Loss: 1.6858 | Train Acc: 0.3765
 Site-White           | Val  Loss: 1.8494 | Val  Acc: 0.2545
 Site-White           | Val  Loss: 1.7510 | Val  Acc: 0.3515
 Site-Latino_Hispanic | Val  Loss: 1.7409 | Val  Acc: 0.3091
 Site-Latino_Hispanic | Val  Loss: 1.7623 | Val  Acc: 0.3091
 Site-Black           | Val  Loss: 1.9110 | Val  Acc: 0.2364
 Site-Black           | Val  Loss: 1.7303 | Val  Acc: 0.3212
 Site-East_Asian      | Val  Loss: 1.7100 | Val  Acc: 0.4000
 Site-East_Asian      | Val  Loss: 1.6522 | Val  Acc: 0.4182
 Site-Indian          | Val  Loss: 1.7681 | Val  Acc: 0.4000
 Site-Indian          | Val  Loss: 1.7956 | Val  Acc: 0.3091
 Site-Southeast_Asian | Val  Loss: 1.8188 | Val  Acc: 0.3818
 Site-Southeast_Asian | Val  Loss: 1.7653 | Val  Acc: 0.3636
 Site-Middle_Eastern  | Val  Loss: 1.7446 | Val  Acc: 0.3636
 Site-Middle_Eastern  | Val  Loss: 1.7019 | Val  Acc: 0.3455
Average Valid Accuracy: 0.3403
 Best site-White            | Epoch:8 | Val Acc: 0.2545
 Best site-White            | Epoch:8 | Val Acc: 0.3515
 Best site-Latino_Hispanic  | Epoch:8 | Val Acc: 0.3091
 Best site-Latino_Hispanic  | Epoch:8 | Val Acc: 0.3091
 Best site-Black            | Epoch:8 | Val Acc: 0.2364
 Best site-Black            | Epoch:8 | Val Acc: 0.3212
 Best site-East_Asian       | Epoch:8 | Val Acc: 0.4000
 Best site-East_Asian       | Epoch:8 | Val Acc: 0.4182
 Best site-Indian           | Epoch:8 | Val Acc: 0.4000
 Best site-Indian           | Epoch:8 | Val Acc: 0.3091
 Best site-Southeast_Asian  | Epoch:8 | Val Acc: 0.3818
 Best site-Southeast_Asian  | Epoch:8 | Val Acc: 0.3636
 Best site-Middle_Eastern   | Epoch:8 | Val Acc: 0.3636
 Best site-Middle_Eastern   | Epoch:8 | Val Acc: 0.3455
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 9 ============
 Site-White           | Train Loss: 1.6891 | Train Acc: 0.3537
 Site-White           | Train Loss: 1.7197 | Train Acc: 0.3401
 Site-Latino_Hispanic | Train Loss: 1.7854 | Train Acc: 0.2805
 Site-Latino_Hispanic | Train Loss: 1.7144 | Train Acc: 0.2915
 Site-Black           | Train Loss: 1.7779 | Train Acc: 0.2805
 Site-Black           | Train Loss: 1.7317 | Train Acc: 0.3441
 Site-East_Asian      | Train Loss: 1.5830 | Train Acc: 0.4756
 Site-East_Asian      | Train Loss: 1.6519 | Train Acc: 0.3846
 Site-Indian          | Train Loss: 1.7635 | Train Acc: 0.2805
 Site-Indian          | Train Loss: 1.7892 | Train Acc: 0.2834
 Site-Southeast_Asian | Train Loss: 1.7801 | Train Acc: 0.3415
 Site-Southeast_Asian | Train Loss: 1.7789 | Train Acc: 0.3684
 Site-Middle_Eastern  | Train Loss: 1.6345 | Train Acc: 0.4146
 Site-Middle_Eastern  | Train Loss: 1.6333 | Train Acc: 0.3846
 Site-White           | Val  Loss: 1.7958 | Val  Acc: 0.2909
 Site-White           | Val  Loss: 1.7456 | Val  Acc: 0.3333
 Site-Latino_Hispanic | Val  Loss: 1.6998 | Val  Acc: 0.2909
 Site-Latino_Hispanic | Val  Loss: 1.7061 | Val  Acc: 0.3091
 Site-Black           | Val  Loss: 1.8291 | Val  Acc: 0.2909
 Site-Black           | Val  Loss: 1.7133 | Val  Acc: 0.3333
 Site-East_Asian      | Val  Loss: 1.7367 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.6618 | Val  Acc: 0.4061
 Site-Indian          | Val  Loss: 1.7138 | Val  Acc: 0.3636
 Site-Indian          | Val  Loss: 1.7716 | Val  Acc: 0.3152
 Site-Southeast_Asian | Val  Loss: 1.8191 | Val  Acc: 0.3636
 Site-Southeast_Asian | Val  Loss: 1.7485 | Val  Acc: 0.3758
 Site-Middle_Eastern  | Val  Loss: 1.6887 | Val  Acc: 0.4000
 Site-Middle_Eastern  | Val  Loss: 1.6765 | Val  Acc: 0.3636
Average Valid Accuracy: 0.3442
 Best site-White            | Epoch:9 | Val Acc: 0.2909
 Best site-White            | Epoch:9 | Val Acc: 0.3333
 Best site-Latino_Hispanic  | Epoch:9 | Val Acc: 0.2909
 Best site-Latino_Hispanic  | Epoch:9 | Val Acc: 0.3091
 Best site-Black            | Epoch:9 | Val Acc: 0.2909
 Best site-Black            | Epoch:9 | Val Acc: 0.3333
 Best site-East_Asian       | Epoch:9 | Val Acc: 0.3818
 Best site-East_Asian       | Epoch:9 | Val Acc: 0.4061
 Best site-Indian           | Epoch:9 | Val Acc: 0.3636
 Best site-Indian           | Epoch:9 | Val Acc: 0.3152
 Best site-Southeast_Asian  | Epoch:9 | Val Acc: 0.3636
 Best site-Southeast_Asian  | Epoch:9 | Val Acc: 0.3758
 Best site-Middle_Eastern   | Epoch:9 | Val Acc: 0.4000
 Best site-Middle_Eastern   | Epoch:9 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
 Test site-White           | Epoch:9 | Test Acc: 0.3386
 Test site-Latino_Hispanic | Epoch:9 | Test Acc: 0.3013
 Test site-Black           | Epoch:9 | Test Acc: 0.2860
 Test site-East_Asian      | Epoch:9 | Test Acc: 0.4729
 Test site-Indian          | Epoch:9 | Test Acc: 0.2955
 Test site-Southeast_Asian | Epoch:9 | Test Acc: 0.3802
 Test site-Middle_Eastern  | Epoch:9 | Test Acc: 0.3226
Average Test Accuracy: 0.3424
============ Train epoch 10 ============
 Site-White           | Train Loss: 1.7013 | Train Acc: 0.3537
 Site-White           | Train Loss: 1.6750 | Train Acc: 0.3765
 Site-Latino_Hispanic | Train Loss: 1.6512 | Train Acc: 0.3659
 Site-Latino_Hispanic | Train Loss: 1.6797 | Train Acc: 0.3360
 Site-Black           | Train Loss: 1.7003 | Train Acc: 0.2927
 Site-Black           | Train Loss: 1.6923 | Train Acc: 0.3563
 Site-East_Asian      | Train Loss: 1.4440 | Train Acc: 0.4756
 Site-East_Asian      | Train Loss: 1.6259 | Train Acc: 0.4049
 Site-Indian          | Train Loss: 1.7352 | Train Acc: 0.3415
 Site-Indian          | Train Loss: 1.7820 | Train Acc: 0.3239
 Site-Southeast_Asian | Train Loss: 1.8358 | Train Acc: 0.3659
 Site-Southeast_Asian | Train Loss: 1.7681 | Train Acc: 0.3644
 Site-Middle_Eastern  | Train Loss: 1.5542 | Train Acc: 0.3902
 Site-Middle_Eastern  | Train Loss: 1.5946 | Train Acc: 0.3968
 Site-White           | Val  Loss: 1.8630 | Val  Acc: 0.2545
 Site-White           | Val  Loss: 1.7405 | Val  Acc: 0.3333
 Site-Latino_Hispanic | Val  Loss: 1.6786 | Val  Acc: 0.3091
 Site-Latino_Hispanic | Val  Loss: 1.6908 | Val  Acc: 0.3455
 Site-Black           | Val  Loss: 1.8739 | Val  Acc: 0.2727
 Site-Black           | Val  Loss: 1.6818 | Val  Acc: 0.3576
 Site-East_Asian      | Val  Loss: 1.7327 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.5952 | Val  Acc: 0.4788
 Site-Indian          | Val  Loss: 1.7033 | Val  Acc: 0.3818
 Site-Indian          | Val  Loss: 1.7463 | Val  Acc: 0.3030
 Site-Southeast_Asian | Val  Loss: 1.8038 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.7101 | Val  Acc: 0.3879
 Site-Middle_Eastern  | Val  Loss: 1.6541 | Val  Acc: 0.4182
 Site-Middle_Eastern  | Val  Loss: 1.6320 | Val  Acc: 0.3758
Average Valid Accuracy: 0.3610
 Best site-White            | Epoch:10 | Val Acc: 0.2545
 Best site-White            | Epoch:10 | Val Acc: 0.3333
 Best site-Latino_Hispanic  | Epoch:10 | Val Acc: 0.3091
 Best site-Latino_Hispanic  | Epoch:10 | Val Acc: 0.3455
 Best site-Black            | Epoch:10 | Val Acc: 0.2727
 Best site-Black            | Epoch:10 | Val Acc: 0.3576
 Best site-East_Asian       | Epoch:10 | Val Acc: 0.3818
 Best site-East_Asian       | Epoch:10 | Val Acc: 0.4788
 Best site-Indian           | Epoch:10 | Val Acc: 0.3818
 Best site-Indian           | Epoch:10 | Val Acc: 0.3030
 Best site-Southeast_Asian  | Epoch:10 | Val Acc: 0.4545
 Best site-Southeast_Asian  | Epoch:10 | Val Acc: 0.3879
 Best site-Middle_Eastern   | Epoch:10 | Val Acc: 0.4182
 Best site-Middle_Eastern   | Epoch:10 | Val Acc: 0.3758
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 11 ============
 Site-White           | Train Loss: 1.6399 | Train Acc: 0.4634
 Site-White           | Train Loss: 1.6511 | Train Acc: 0.3603
 Site-Latino_Hispanic | Train Loss: 1.6521 | Train Acc: 0.3415
 Site-Latino_Hispanic | Train Loss: 1.6604 | Train Acc: 0.3441
 Site-Black           | Train Loss: 1.7049 | Train Acc: 0.2805
 Site-Black           | Train Loss: 1.6808 | Train Acc: 0.3644
 Site-East_Asian      | Train Loss: 1.5924 | Train Acc: 0.4390
 Site-East_Asian      | Train Loss: 1.6112 | Train Acc: 0.4251
 Site-Indian          | Train Loss: 1.6369 | Train Acc: 0.3293
 Site-Indian          | Train Loss: 1.7306 | Train Acc: 0.3198
 Site-Southeast_Asian | Train Loss: 1.8526 | Train Acc: 0.4146
 Site-Southeast_Asian | Train Loss: 1.6990 | Train Acc: 0.3725
 Site-Middle_Eastern  | Train Loss: 1.6269 | Train Acc: 0.3902
 Site-Middle_Eastern  | Train Loss: 1.5926 | Train Acc: 0.4130
 Site-White           | Val  Loss: 1.7868 | Val  Acc: 0.2727
 Site-White           | Val  Loss: 1.6913 | Val  Acc: 0.3818
 Site-Latino_Hispanic | Val  Loss: 1.6740 | Val  Acc: 0.3091
 Site-Latino_Hispanic | Val  Loss: 1.6570 | Val  Acc: 0.3636
 Site-Black           | Val  Loss: 1.8538 | Val  Acc: 0.2182
 Site-Black           | Val  Loss: 1.6739 | Val  Acc: 0.4000
 Site-East_Asian      | Val  Loss: 1.6779 | Val  Acc: 0.4000
 Site-East_Asian      | Val  Loss: 1.5792 | Val  Acc: 0.4606
 Site-Indian          | Val  Loss: 1.6991 | Val  Acc: 0.3273
 Site-Indian          | Val  Loss: 1.7136 | Val  Acc: 0.3091
 Site-Southeast_Asian | Val  Loss: 1.8213 | Val  Acc: 0.3636
 Site-Southeast_Asian | Val  Loss: 1.6707 | Val  Acc: 0.3879
 Site-Middle_Eastern  | Val  Loss: 1.6513 | Val  Acc: 0.3818
 Site-Middle_Eastern  | Val  Loss: 1.6075 | Val  Acc: 0.4121
Average Valid Accuracy: 0.3563
============ Train epoch 12 ============
 Site-White           | Train Loss: 1.6003 | Train Acc: 0.4024
 Site-White           | Train Loss: 1.6249 | Train Acc: 0.3644
 Site-Latino_Hispanic | Train Loss: 1.7226 | Train Acc: 0.3049
 Site-Latino_Hispanic | Train Loss: 1.6454 | Train Acc: 0.3360
 Site-Black           | Train Loss: 1.6701 | Train Acc: 0.3049
 Site-Black           | Train Loss: 1.6547 | Train Acc: 0.3887
 Site-East_Asian      | Train Loss: 1.6392 | Train Acc: 0.5122
 Site-East_Asian      | Train Loss: 1.5753 | Train Acc: 0.4130
 Site-Indian          | Train Loss: 1.7104 | Train Acc: 0.3780
 Site-Indian          | Train Loss: 1.7181 | Train Acc: 0.3158
 Site-Southeast_Asian | Train Loss: 1.7148 | Train Acc: 0.4268
 Site-Southeast_Asian | Train Loss: 1.6733 | Train Acc: 0.4251
 Site-Middle_Eastern  | Train Loss: 1.5707 | Train Acc: 0.4146
 Site-Middle_Eastern  | Train Loss: 1.5550 | Train Acc: 0.4332
 Site-White           | Val  Loss: 1.7577 | Val  Acc: 0.3455
 Site-White           | Val  Loss: 1.6642 | Val  Acc: 0.3576
 Site-Latino_Hispanic | Val  Loss: 1.6018 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.6419 | Val  Acc: 0.3394
 Site-Black           | Val  Loss: 1.7945 | Val  Acc: 0.2909
 Site-Black           | Val  Loss: 1.6664 | Val  Acc: 0.3758
 Site-East_Asian      | Val  Loss: 1.6770 | Val  Acc: 0.3636
 Site-East_Asian      | Val  Loss: 1.5726 | Val  Acc: 0.4121
 Site-Indian          | Val  Loss: 1.5593 | Val  Acc: 0.4000
 Site-Indian          | Val  Loss: 1.6665 | Val  Acc: 0.3455
 Site-Southeast_Asian | Val  Loss: 1.7701 | Val  Acc: 0.4000
 Site-Southeast_Asian | Val  Loss: 1.6585 | Val  Acc: 0.3939
 Site-Middle_Eastern  | Val  Loss: 1.6360 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.5848 | Val  Acc: 0.4182
Average Valid Accuracy: 0.3784
 Best site-White            | Epoch:12 | Val Acc: 0.3455
 Best site-White            | Epoch:12 | Val Acc: 0.3576
 Best site-Latino_Hispanic  | Epoch:12 | Val Acc: 0.4000
 Best site-Latino_Hispanic  | Epoch:12 | Val Acc: 0.3394
 Best site-Black            | Epoch:12 | Val Acc: 0.2909
 Best site-Black            | Epoch:12 | Val Acc: 0.3758
 Best site-East_Asian       | Epoch:12 | Val Acc: 0.3636
 Best site-East_Asian       | Epoch:12 | Val Acc: 0.4121
 Best site-Indian           | Epoch:12 | Val Acc: 0.4000
 Best site-Indian           | Epoch:12 | Val Acc: 0.3455
 Best site-Southeast_Asian  | Epoch:12 | Val Acc: 0.4000
 Best site-Southeast_Asian  | Epoch:12 | Val Acc: 0.3939
 Best site-Middle_Eastern   | Epoch:12 | Val Acc: 0.4545
 Best site-Middle_Eastern   | Epoch:12 | Val Acc: 0.4182
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 13 ============
 Site-White           | Train Loss: 1.5794 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.6080 | Train Acc: 0.3806
 Site-Latino_Hispanic | Train Loss: 1.6782 | Train Acc: 0.3293
 Site-Latino_Hispanic | Train Loss: 1.6400 | Train Acc: 0.3441
 Site-Black           | Train Loss: 1.7334 | Train Acc: 0.2927
 Site-Black           | Train Loss: 1.6494 | Train Acc: 0.3887
 Site-East_Asian      | Train Loss: 1.5310 | Train Acc: 0.5000
 Site-East_Asian      | Train Loss: 1.5553 | Train Acc: 0.4413
 Site-Indian          | Train Loss: 1.7426 | Train Acc: 0.4390
 Site-Indian          | Train Loss: 1.6764 | Train Acc: 0.3279
 Site-Southeast_Asian | Train Loss: 1.7846 | Train Acc: 0.4146
 Site-Southeast_Asian | Train Loss: 1.6399 | Train Acc: 0.3968
 Site-Middle_Eastern  | Train Loss: 1.5075 | Train Acc: 0.4268
 Site-Middle_Eastern  | Train Loss: 1.5443 | Train Acc: 0.4615
 Site-White           | Val  Loss: 1.7186 | Val  Acc: 0.3273
 Site-White           | Val  Loss: 1.6195 | Val  Acc: 0.4364
 Site-Latino_Hispanic | Val  Loss: 1.6412 | Val  Acc: 0.3818
 Site-Latino_Hispanic | Val  Loss: 1.6317 | Val  Acc: 0.3818
 Site-Black           | Val  Loss: 1.7456 | Val  Acc: 0.3091
 Site-Black           | Val  Loss: 1.6568 | Val  Acc: 0.4061
 Site-East_Asian      | Val  Loss: 1.6742 | Val  Acc: 0.3636
 Site-East_Asian      | Val  Loss: 1.5518 | Val  Acc: 0.4424
 Site-Indian          | Val  Loss: 1.5991 | Val  Acc: 0.3818
 Site-Indian          | Val  Loss: 1.6461 | Val  Acc: 0.3515
 Site-Southeast_Asian | Val  Loss: 1.7655 | Val  Acc: 0.4000
 Site-Southeast_Asian | Val  Loss: 1.6410 | Val  Acc: 0.4000
 Site-Middle_Eastern  | Val  Loss: 1.6456 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.5677 | Val  Acc: 0.4242
Average Valid Accuracy: 0.3900
 Best site-White            | Epoch:13 | Val Acc: 0.3273
 Best site-White            | Epoch:13 | Val Acc: 0.4364
 Best site-Latino_Hispanic  | Epoch:13 | Val Acc: 0.3818
 Best site-Latino_Hispanic  | Epoch:13 | Val Acc: 0.3818
 Best site-Black            | Epoch:13 | Val Acc: 0.3091
 Best site-Black            | Epoch:13 | Val Acc: 0.4061
 Best site-East_Asian       | Epoch:13 | Val Acc: 0.3636
 Best site-East_Asian       | Epoch:13 | Val Acc: 0.4424
 Best site-Indian           | Epoch:13 | Val Acc: 0.3818
 Best site-Indian           | Epoch:13 | Val Acc: 0.3515
 Best site-Southeast_Asian  | Epoch:13 | Val Acc: 0.4000
 Best site-Southeast_Asian  | Epoch:13 | Val Acc: 0.4000
 Best site-Middle_Eastern   | Epoch:13 | Val Acc: 0.4545
 Best site-Middle_Eastern   | Epoch:13 | Val Acc: 0.4242
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 14 ============
 Site-White           | Train Loss: 1.5756 | Train Acc: 0.4024
 Site-White           | Train Loss: 1.5985 | Train Acc: 0.3887
 Site-Latino_Hispanic | Train Loss: 1.6280 | Train Acc: 0.3659
 Site-Latino_Hispanic | Train Loss: 1.6321 | Train Acc: 0.3320
 Site-Black           | Train Loss: 1.7646 | Train Acc: 0.2927
 Site-Black           | Train Loss: 1.6525 | Train Acc: 0.4089
 Site-East_Asian      | Train Loss: 1.5021 | Train Acc: 0.4634
 Site-East_Asian      | Train Loss: 1.5350 | Train Acc: 0.4291
 Site-Indian          | Train Loss: 1.6453 | Train Acc: 0.3537
 Site-Indian          | Train Loss: 1.6715 | Train Acc: 0.3360
 Site-Southeast_Asian | Train Loss: 1.6255 | Train Acc: 0.4024
 Site-Southeast_Asian | Train Loss: 1.6125 | Train Acc: 0.4130
 Site-Middle_Eastern  | Train Loss: 1.6370 | Train Acc: 0.4512
 Site-Middle_Eastern  | Train Loss: 1.5422 | Train Acc: 0.4251
 Site-White           | Val  Loss: 1.7169 | Val  Acc: 0.3091
 Site-White           | Val  Loss: 1.6011 | Val  Acc: 0.3879
 Site-Latino_Hispanic | Val  Loss: 1.6040 | Val  Acc: 0.4182
 Site-Latino_Hispanic | Val  Loss: 1.5961 | Val  Acc: 0.3939
 Site-Black           | Val  Loss: 1.7447 | Val  Acc: 0.3273
 Site-Black           | Val  Loss: 1.6429 | Val  Acc: 0.4061
 Site-East_Asian      | Val  Loss: 1.6583 | Val  Acc: 0.3636
 Site-East_Asian      | Val  Loss: 1.5189 | Val  Acc: 0.4364
 Site-Indian          | Val  Loss: 1.5660 | Val  Acc: 0.3818
 Site-Indian          | Val  Loss: 1.6238 | Val  Acc: 0.3636
 Site-Southeast_Asian | Val  Loss: 1.7004 | Val  Acc: 0.4182
 Site-Southeast_Asian | Val  Loss: 1.6272 | Val  Acc: 0.3939
 Site-Middle_Eastern  | Val  Loss: 1.6112 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.5656 | Val  Acc: 0.4182
Average Valid Accuracy: 0.3909
 Best site-White            | Epoch:14 | Val Acc: 0.3091
 Best site-White            | Epoch:14 | Val Acc: 0.3879
 Best site-Latino_Hispanic  | Epoch:14 | Val Acc: 0.4182
 Best site-Latino_Hispanic  | Epoch:14 | Val Acc: 0.3939
 Best site-Black            | Epoch:14 | Val Acc: 0.3273
 Best site-Black            | Epoch:14 | Val Acc: 0.4061
 Best site-East_Asian       | Epoch:14 | Val Acc: 0.3636
 Best site-East_Asian       | Epoch:14 | Val Acc: 0.4364
 Best site-Indian           | Epoch:14 | Val Acc: 0.3818
 Best site-Indian           | Epoch:14 | Val Acc: 0.3636
 Best site-Southeast_Asian  | Epoch:14 | Val Acc: 0.4182
 Best site-Southeast_Asian  | Epoch:14 | Val Acc: 0.3939
 Best site-Middle_Eastern   | Epoch:14 | Val Acc: 0.4545
 Best site-Middle_Eastern   | Epoch:14 | Val Acc: 0.4182
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 15 ============
 Site-White           | Train Loss: 1.5128 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.5652 | Train Acc: 0.4089
 Site-Latino_Hispanic | Train Loss: 1.7649 | Train Acc: 0.3659
 Site-Latino_Hispanic | Train Loss: 1.6103 | Train Acc: 0.3441
 Site-Black           | Train Loss: 1.6417 | Train Acc: 0.2927
 Site-Black           | Train Loss: 1.6460 | Train Acc: 0.4008
 Site-East_Asian      | Train Loss: 1.5389 | Train Acc: 0.4512
 Site-East_Asian      | Train Loss: 1.4912 | Train Acc: 0.4130
 Site-Indian          | Train Loss: 1.6128 | Train Acc: 0.3659
 Site-Indian          | Train Loss: 1.6383 | Train Acc: 0.3320
 Site-Southeast_Asian | Train Loss: 1.5593 | Train Acc: 0.4512
 Site-Southeast_Asian | Train Loss: 1.6123 | Train Acc: 0.4089
 Site-Middle_Eastern  | Train Loss: 1.5173 | Train Acc: 0.4146
 Site-Middle_Eastern  | Train Loss: 1.5016 | Train Acc: 0.4494
 Site-White           | Val  Loss: 1.6997 | Val  Acc: 0.2909
 Site-White           | Val  Loss: 1.6150 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.5973 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.5863 | Val  Acc: 0.3636
 Site-Black           | Val  Loss: 1.8036 | Val  Acc: 0.3091
 Site-Black           | Val  Loss: 1.6382 | Val  Acc: 0.3758
 Site-East_Asian      | Val  Loss: 1.6162 | Val  Acc: 0.4000
 Site-East_Asian      | Val  Loss: 1.4642 | Val  Acc: 0.4485
 Site-Indian          | Val  Loss: 1.5475 | Val  Acc: 0.3455
 Site-Indian          | Val  Loss: 1.6362 | Val  Acc: 0.3515
 Site-Southeast_Asian | Val  Loss: 1.7295 | Val  Acc: 0.4909
 Site-Southeast_Asian | Val  Loss: 1.5980 | Val  Acc: 0.4242
 Site-Middle_Eastern  | Val  Loss: 1.6016 | Val  Acc: 0.4364
 Site-Middle_Eastern  | Val  Loss: 1.5385 | Val  Acc: 0.4182
Average Valid Accuracy: 0.3896
============ Train epoch 16 ============
 Site-White           | Train Loss: 1.5047 | Train Acc: 0.4756
 Site-White           | Train Loss: 1.5408 | Train Acc: 0.3968
 Site-Latino_Hispanic | Train Loss: 1.6753 | Train Acc: 0.3780
 Site-Latino_Hispanic | Train Loss: 1.5629 | Train Acc: 0.3927
 Site-Black           | Train Loss: 1.6238 | Train Acc: 0.3171
 Site-Black           | Train Loss: 1.5899 | Train Acc: 0.4332
 Site-East_Asian      | Train Loss: 1.4662 | Train Acc: 0.4390
 Site-East_Asian      | Train Loss: 1.5112 | Train Acc: 0.4332
 Site-Indian          | Train Loss: 1.5682 | Train Acc: 0.3659
 Site-Indian          | Train Loss: 1.6203 | Train Acc: 0.2955
 Site-Southeast_Asian | Train Loss: 1.6580 | Train Acc: 0.4024
 Site-Southeast_Asian | Train Loss: 1.6021 | Train Acc: 0.4291
 Site-Middle_Eastern  | Train Loss: 1.5735 | Train Acc: 0.4390
 Site-Middle_Eastern  | Train Loss: 1.4973 | Train Acc: 0.4615
 Site-White           | Val  Loss: 1.7223 | Val  Acc: 0.3273
 Site-White           | Val  Loss: 1.6110 | Val  Acc: 0.3939
 Site-Latino_Hispanic | Val  Loss: 1.5606 | Val  Acc: 0.3636
 Site-Latino_Hispanic | Val  Loss: 1.5791 | Val  Acc: 0.3576
 Site-Black           | Val  Loss: 1.7376 | Val  Acc: 0.2909
 Site-Black           | Val  Loss: 1.6446 | Val  Acc: 0.3697
 Site-East_Asian      | Val  Loss: 1.6668 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.4920 | Val  Acc: 0.4606
 Site-Indian          | Val  Loss: 1.5734 | Val  Acc: 0.3636
 Site-Indian          | Val  Loss: 1.6041 | Val  Acc: 0.3818
 Site-Southeast_Asian | Val  Loss: 1.7167 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.5694 | Val  Acc: 0.4242
 Site-Middle_Eastern  | Val  Loss: 1.5947 | Val  Acc: 0.4364
 Site-Middle_Eastern  | Val  Loss: 1.5008 | Val  Acc: 0.4424
Average Valid Accuracy: 0.3892
============ Train epoch 17 ============
 Site-White           | Train Loss: 1.4847 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.5394 | Train Acc: 0.3765
 Site-Latino_Hispanic | Train Loss: 1.5732 | Train Acc: 0.3293
 Site-Latino_Hispanic | Train Loss: 1.5720 | Train Acc: 0.3603
 Site-Black           | Train Loss: 1.6359 | Train Acc: 0.3415
 Site-Black           | Train Loss: 1.6368 | Train Acc: 0.4170
 Site-East_Asian      | Train Loss: 1.3645 | Train Acc: 0.4390
 Site-East_Asian      | Train Loss: 1.5338 | Train Acc: 0.4372
 Site-Indian          | Train Loss: 1.5099 | Train Acc: 0.3780
 Site-Indian          | Train Loss: 1.5997 | Train Acc: 0.3806
 Site-Southeast_Asian | Train Loss: 1.7558 | Train Acc: 0.4512
 Site-Southeast_Asian | Train Loss: 1.5899 | Train Acc: 0.4089
 Site-Middle_Eastern  | Train Loss: 1.3868 | Train Acc: 0.4634
 Site-Middle_Eastern  | Train Loss: 1.4591 | Train Acc: 0.4372
 Site-White           | Val  Loss: 1.6935 | Val  Acc: 0.3091
 Site-White           | Val  Loss: 1.5516 | Val  Acc: 0.4242
 Site-Latino_Hispanic | Val  Loss: 1.5918 | Val  Acc: 0.3455
 Site-Latino_Hispanic | Val  Loss: 1.5509 | Val  Acc: 0.3939
 Site-Black           | Val  Loss: 1.7377 | Val  Acc: 0.2909
 Site-Black           | Val  Loss: 1.6216 | Val  Acc: 0.3697
 Site-East_Asian      | Val  Loss: 1.6168 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.4982 | Val  Acc: 0.4182
 Site-Indian          | Val  Loss: 1.5183 | Val  Acc: 0.3818
 Site-Indian          | Val  Loss: 1.5953 | Val  Acc: 0.3697
 Site-Southeast_Asian | Val  Loss: 1.6631 | Val  Acc: 0.4182
 Site-Southeast_Asian | Val  Loss: 1.5780 | Val  Acc: 0.4485
 Site-Middle_Eastern  | Val  Loss: 1.5187 | Val  Acc: 0.4727
 Site-Middle_Eastern  | Val  Loss: 1.4990 | Val  Acc: 0.4424
Average Valid Accuracy: 0.3931
 Best site-White            | Epoch:17 | Val Acc: 0.3091
 Best site-White            | Epoch:17 | Val Acc: 0.4242
 Best site-Latino_Hispanic  | Epoch:17 | Val Acc: 0.3455
 Best site-Latino_Hispanic  | Epoch:17 | Val Acc: 0.3939
 Best site-Black            | Epoch:17 | Val Acc: 0.2909
 Best site-Black            | Epoch:17 | Val Acc: 0.3697
 Best site-East_Asian       | Epoch:17 | Val Acc: 0.4182
 Best site-East_Asian       | Epoch:17 | Val Acc: 0.4182
 Best site-Indian           | Epoch:17 | Val Acc: 0.3818
 Best site-Indian           | Epoch:17 | Val Acc: 0.3697
 Best site-Southeast_Asian  | Epoch:17 | Val Acc: 0.4182
 Best site-Southeast_Asian  | Epoch:17 | Val Acc: 0.4485
 Best site-Middle_Eastern   | Epoch:17 | Val Acc: 0.4727
 Best site-Middle_Eastern   | Epoch:17 | Val Acc: 0.4424
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 18 ============
 Site-White           | Train Loss: 1.5840 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.5010 | Train Acc: 0.4453
 Site-Latino_Hispanic | Train Loss: 1.6262 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.5651 | Train Acc: 0.3846
 Site-Black           | Train Loss: 1.6757 | Train Acc: 0.3171
 Site-Black           | Train Loss: 1.6308 | Train Acc: 0.3927
 Site-East_Asian      | Train Loss: 1.3744 | Train Acc: 0.4512
 Site-East_Asian      | Train Loss: 1.5067 | Train Acc: 0.3927
 Site-Indian          | Train Loss: 1.5277 | Train Acc: 0.3780
 Site-Indian          | Train Loss: 1.6101 | Train Acc: 0.3644
 Site-Southeast_Asian | Train Loss: 1.6369 | Train Acc: 0.4268
 Site-Southeast_Asian | Train Loss: 1.5943 | Train Acc: 0.4008
 Site-Middle_Eastern  | Train Loss: 1.4992 | Train Acc: 0.4268
 Site-Middle_Eastern  | Train Loss: 1.4467 | Train Acc: 0.4777
 Site-White           | Val  Loss: 1.6833 | Val  Acc: 0.3091
 Site-White           | Val  Loss: 1.5404 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.5426 | Val  Acc: 0.3636
 Site-Latino_Hispanic | Val  Loss: 1.5753 | Val  Acc: 0.3939
 Site-Black           | Val  Loss: 1.7276 | Val  Acc: 0.3455
 Site-Black           | Val  Loss: 1.6343 | Val  Acc: 0.3879
 Site-East_Asian      | Val  Loss: 1.5904 | Val  Acc: 0.3636
 Site-East_Asian      | Val  Loss: 1.4866 | Val  Acc: 0.4424
 Site-Indian          | Val  Loss: 1.5567 | Val  Acc: 0.3818
 Site-Indian          | Val  Loss: 1.5496 | Val  Acc: 0.3636
 Site-Southeast_Asian | Val  Loss: 1.6601 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.5904 | Val  Acc: 0.4061
 Site-Middle_Eastern  | Val  Loss: 1.5417 | Val  Acc: 0.4364
 Site-Middle_Eastern  | Val  Loss: 1.4793 | Val  Acc: 0.4364
Average Valid Accuracy: 0.3918
============ Train epoch 19 ============
 Site-White           | Train Loss: 1.3970 | Train Acc: 0.4024
 Site-White           | Train Loss: 1.4751 | Train Acc: 0.4372
 Site-Latino_Hispanic | Train Loss: 1.6798 | Train Acc: 0.3659
 Site-Latino_Hispanic | Train Loss: 1.5457 | Train Acc: 0.3968
 Site-Black           | Train Loss: 1.6371 | Train Acc: 0.2927
 Site-Black           | Train Loss: 1.5999 | Train Acc: 0.4049
 Site-East_Asian      | Train Loss: 1.4777 | Train Acc: 0.4146
 Site-East_Asian      | Train Loss: 1.4973 | Train Acc: 0.4453
 Site-Indian          | Train Loss: 1.5522 | Train Acc: 0.3659
 Site-Indian          | Train Loss: 1.5950 | Train Acc: 0.3563
 Site-Southeast_Asian | Train Loss: 1.6371 | Train Acc: 0.4146
 Site-Southeast_Asian | Train Loss: 1.5738 | Train Acc: 0.4453
 Site-Middle_Eastern  | Train Loss: 1.4569 | Train Acc: 0.4634
 Site-Middle_Eastern  | Train Loss: 1.4568 | Train Acc: 0.4453
 Site-White           | Val  Loss: 1.6151 | Val  Acc: 0.4000
 Site-White           | Val  Loss: 1.5363 | Val  Acc: 0.4121
 Site-Latino_Hispanic | Val  Loss: 1.5995 | Val  Acc: 0.3636
 Site-Latino_Hispanic | Val  Loss: 1.5390 | Val  Acc: 0.4242
 Site-Black           | Val  Loss: 1.7089 | Val  Acc: 0.3818
 Site-Black           | Val  Loss: 1.6122 | Val  Acc: 0.3758
 Site-East_Asian      | Val  Loss: 1.5798 | Val  Acc: 0.3636
 Site-East_Asian      | Val  Loss: 1.4519 | Val  Acc: 0.4606
 Site-Indian          | Val  Loss: 1.5006 | Val  Acc: 0.4000
 Site-Indian          | Val  Loss: 1.5912 | Val  Acc: 0.3576
 Site-Southeast_Asian | Val  Loss: 1.6415 | Val  Acc: 0.4000
 Site-Southeast_Asian | Val  Loss: 1.5661 | Val  Acc: 0.4242
 Site-Middle_Eastern  | Val  Loss: 1.5460 | Val  Acc: 0.4909
 Site-Middle_Eastern  | Val  Loss: 1.4842 | Val  Acc: 0.4061
Average Valid Accuracy: 0.4043
 Best site-White            | Epoch:19 | Val Acc: 0.4000
 Best site-White            | Epoch:19 | Val Acc: 0.4121
 Best site-Latino_Hispanic  | Epoch:19 | Val Acc: 0.3636
 Best site-Latino_Hispanic  | Epoch:19 | Val Acc: 0.4242
 Best site-Black            | Epoch:19 | Val Acc: 0.3818
 Best site-Black            | Epoch:19 | Val Acc: 0.3758
 Best site-East_Asian       | Epoch:19 | Val Acc: 0.3636
 Best site-East_Asian       | Epoch:19 | Val Acc: 0.4606
 Best site-Indian           | Epoch:19 | Val Acc: 0.4000
 Best site-Indian           | Epoch:19 | Val Acc: 0.3576
 Best site-Southeast_Asian  | Epoch:19 | Val Acc: 0.4000
 Best site-Southeast_Asian  | Epoch:19 | Val Acc: 0.4242
 Best site-Middle_Eastern   | Epoch:19 | Val Acc: 0.4909
 Best site-Middle_Eastern   | Epoch:19 | Val Acc: 0.4061
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
 Test site-White           | Epoch:19 | Test Acc: 0.3707
 Test site-Latino_Hispanic | Epoch:19 | Test Acc: 0.3247
 Test site-Black           | Epoch:19 | Test Acc: 0.3226
 Test site-East_Asian      | Epoch:19 | Test Acc: 0.4645
 Test site-Indian          | Epoch:19 | Test Acc: 0.3259
 Test site-Southeast_Asian | Epoch:19 | Test Acc: 0.4042
 Test site-Middle_Eastern  | Epoch:19 | Test Acc: 0.3639
Average Test Accuracy: 0.3681
============ Train epoch 20 ============
 Site-White           | Train Loss: 1.4629 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.5078 | Train Acc: 0.4089
 Site-Latino_Hispanic | Train Loss: 1.5858 | Train Acc: 0.3171
 Site-Latino_Hispanic | Train Loss: 1.5755 | Train Acc: 0.3563
 Site-Black           | Train Loss: 1.6469 | Train Acc: 0.3537
 Site-Black           | Train Loss: 1.6197 | Train Acc: 0.3968
 Site-East_Asian      | Train Loss: 1.4088 | Train Acc: 0.4634
 Site-East_Asian      | Train Loss: 1.4870 | Train Acc: 0.4332
 Site-Indian          | Train Loss: 1.6057 | Train Acc: 0.4146
 Site-Indian          | Train Loss: 1.5943 | Train Acc: 0.3563
 Site-Southeast_Asian | Train Loss: 1.6509 | Train Acc: 0.4146
 Site-Southeast_Asian | Train Loss: 1.5657 | Train Acc: 0.4049
 Site-Middle_Eastern  | Train Loss: 1.4576 | Train Acc: 0.4268
 Site-Middle_Eastern  | Train Loss: 1.4330 | Train Acc: 0.4534
 Site-White           | Val  Loss: 1.6821 | Val  Acc: 0.3273
 Site-White           | Val  Loss: 1.5043 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.5437 | Val  Acc: 0.4182
 Site-Latino_Hispanic | Val  Loss: 1.5066 | Val  Acc: 0.3939
 Site-Black           | Val  Loss: 1.6763 | Val  Acc: 0.3818
 Site-Black           | Val  Loss: 1.6207 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.5868 | Val  Acc: 0.3636
 Site-East_Asian      | Val  Loss: 1.4703 | Val  Acc: 0.4485
 Site-Indian          | Val  Loss: 1.4847 | Val  Acc: 0.3818
 Site-Indian          | Val  Loss: 1.5457 | Val  Acc: 0.3576
 Site-Southeast_Asian | Val  Loss: 1.6187 | Val  Acc: 0.4364
 Site-Southeast_Asian | Val  Loss: 1.5343 | Val  Acc: 0.4242
 Site-Middle_Eastern  | Val  Loss: 1.5533 | Val  Acc: 0.4000
 Site-Middle_Eastern  | Val  Loss: 1.4638 | Val  Acc: 0.4182
Average Valid Accuracy: 0.3952
============ Train epoch 21 ============
 Site-White           | Train Loss: 1.4862 | Train Acc: 0.3659
 Site-White           | Train Loss: 1.4794 | Train Acc: 0.4332
 Site-Latino_Hispanic | Train Loss: 1.7151 | Train Acc: 0.3293
 Site-Latino_Hispanic | Train Loss: 1.5552 | Train Acc: 0.3603
 Site-Black           | Train Loss: 1.6369 | Train Acc: 0.2805
 Site-Black           | Train Loss: 1.6015 | Train Acc: 0.3968
 Site-East_Asian      | Train Loss: 1.5977 | Train Acc: 0.4756
 Site-East_Asian      | Train Loss: 1.4653 | Train Acc: 0.4534
 Site-Indian          | Train Loss: 1.5213 | Train Acc: 0.4146
 Site-Indian          | Train Loss: 1.5738 | Train Acc: 0.3806
 Site-Southeast_Asian | Train Loss: 1.4759 | Train Acc: 0.4756
 Site-Southeast_Asian | Train Loss: 1.5516 | Train Acc: 0.4211
 Site-Middle_Eastern  | Train Loss: 1.3816 | Train Acc: 0.4390
 Site-Middle_Eastern  | Train Loss: 1.4302 | Train Acc: 0.4656
 Site-White           | Val  Loss: 1.6438 | Val  Acc: 0.2909
 Site-White           | Val  Loss: 1.5107 | Val  Acc: 0.3939
 Site-Latino_Hispanic | Val  Loss: 1.5575 | Val  Acc: 0.3636
 Site-Latino_Hispanic | Val  Loss: 1.5178 | Val  Acc: 0.3939
 Site-Black           | Val  Loss: 1.7219 | Val  Acc: 0.3636
 Site-Black           | Val  Loss: 1.5711 | Val  Acc: 0.4000
 Site-East_Asian      | Val  Loss: 1.5844 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.4445 | Val  Acc: 0.4727
 Site-Indian          | Val  Loss: 1.4607 | Val  Acc: 0.4364
 Site-Indian          | Val  Loss: 1.5211 | Val  Acc: 0.3576
 Site-Southeast_Asian | Val  Loss: 1.6720 | Val  Acc: 0.4727
 Site-Southeast_Asian | Val  Loss: 1.5362 | Val  Acc: 0.4061
 Site-Middle_Eastern  | Val  Loss: 1.5122 | Val  Acc: 0.4727
 Site-Middle_Eastern  | Val  Loss: 1.4435 | Val  Acc: 0.4545
Average Valid Accuracy: 0.4043
============ Train epoch 22 ============
 Site-White           | Train Loss: 1.4382 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.5036 | Train Acc: 0.4130
 Site-Latino_Hispanic | Train Loss: 1.6759 | Train Acc: 0.3902
 Site-Latino_Hispanic | Train Loss: 1.5390 | Train Acc: 0.3806
 Site-Black           | Train Loss: 1.5599 | Train Acc: 0.3537
 Site-Black           | Train Loss: 1.5887 | Train Acc: 0.4332
 Site-East_Asian      | Train Loss: 1.4321 | Train Acc: 0.4756
 Site-East_Asian      | Train Loss: 1.4438 | Train Acc: 0.4899
 Site-Indian          | Train Loss: 1.5707 | Train Acc: 0.3537
 Site-Indian          | Train Loss: 1.5674 | Train Acc: 0.3806
 Site-Southeast_Asian | Train Loss: 1.6421 | Train Acc: 0.4268
 Site-Southeast_Asian | Train Loss: 1.5535 | Train Acc: 0.4575
 Site-Middle_Eastern  | Train Loss: 1.5010 | Train Acc: 0.4146
 Site-Middle_Eastern  | Train Loss: 1.4037 | Train Acc: 0.4696
 Site-White           | Val  Loss: 1.6081 | Val  Acc: 0.3636
 Site-White           | Val  Loss: 1.5069 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.5059 | Val  Acc: 0.4182
 Site-Latino_Hispanic | Val  Loss: 1.5161 | Val  Acc: 0.3939
 Site-Black           | Val  Loss: 1.7317 | Val  Acc: 0.3818
 Site-Black           | Val  Loss: 1.6344 | Val  Acc: 0.4242
 Site-East_Asian      | Val  Loss: 1.6222 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.4495 | Val  Acc: 0.4848
 Site-Indian          | Val  Loss: 1.5017 | Val  Acc: 0.4364
 Site-Indian          | Val  Loss: 1.5641 | Val  Acc: 0.3455
 Site-Southeast_Asian | Val  Loss: 1.6601 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.5459 | Val  Acc: 0.4121
 Site-Middle_Eastern  | Val  Loss: 1.5223 | Val  Acc: 0.4364
 Site-Middle_Eastern  | Val  Loss: 1.4513 | Val  Acc: 0.4727
Average Valid Accuracy: 0.4173
 Best site-White            | Epoch:22 | Val Acc: 0.3636
 Best site-White            | Epoch:22 | Val Acc: 0.4000
 Best site-Latino_Hispanic  | Epoch:22 | Val Acc: 0.4182
 Best site-Latino_Hispanic  | Epoch:22 | Val Acc: 0.3939
 Best site-Black            | Epoch:22 | Val Acc: 0.3818
 Best site-Black            | Epoch:22 | Val Acc: 0.4242
 Best site-East_Asian       | Epoch:22 | Val Acc: 0.4182
 Best site-East_Asian       | Epoch:22 | Val Acc: 0.4848
 Best site-Indian           | Epoch:22 | Val Acc: 0.4364
 Best site-Indian           | Epoch:22 | Val Acc: 0.3455
 Best site-Southeast_Asian  | Epoch:22 | Val Acc: 0.4545
 Best site-Southeast_Asian  | Epoch:22 | Val Acc: 0.4121
 Best site-Middle_Eastern   | Epoch:22 | Val Acc: 0.4364
 Best site-Middle_Eastern   | Epoch:22 | Val Acc: 0.4727
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 23 ============
 Site-White           | Train Loss: 1.6343 | Train Acc: 0.3537
 Site-White           | Train Loss: 1.4597 | Train Acc: 0.4453
 Site-Latino_Hispanic | Train Loss: 1.6122 | Train Acc: 0.3659
 Site-Latino_Hispanic | Train Loss: 1.5232 | Train Acc: 0.4089
 Site-Black           | Train Loss: 1.6080 | Train Acc: 0.3049
 Site-Black           | Train Loss: 1.6147 | Train Acc: 0.4130
 Site-East_Asian      | Train Loss: 1.5122 | Train Acc: 0.4390
 Site-East_Asian      | Train Loss: 1.4606 | Train Acc: 0.4656
 Site-Indian          | Train Loss: 1.5809 | Train Acc: 0.4024
 Site-Indian          | Train Loss: 1.5596 | Train Acc: 0.3806
 Site-Southeast_Asian | Train Loss: 1.5232 | Train Acc: 0.4512
 Site-Southeast_Asian | Train Loss: 1.5379 | Train Acc: 0.4291
 Site-Middle_Eastern  | Train Loss: 1.4762 | Train Acc: 0.4878
 Site-Middle_Eastern  | Train Loss: 1.4046 | Train Acc: 0.4656
 Site-White           | Val  Loss: 1.6542 | Val  Acc: 0.3455
 Site-White           | Val  Loss: 1.4597 | Val  Acc: 0.4242
 Site-Latino_Hispanic | Val  Loss: 1.4670 | Val  Acc: 0.4182
 Site-Latino_Hispanic | Val  Loss: 1.5076 | Val  Acc: 0.4303
 Site-Black           | Val  Loss: 1.6770 | Val  Acc: 0.3818
 Site-Black           | Val  Loss: 1.6383 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.5852 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.4257 | Val  Acc: 0.4545
 Site-Indian          | Val  Loss: 1.4557 | Val  Acc: 0.4364
 Site-Indian          | Val  Loss: 1.5282 | Val  Acc: 0.3818
 Site-Southeast_Asian | Val  Loss: 1.6041 | Val  Acc: 0.5091
 Site-Southeast_Asian | Val  Loss: 1.5041 | Val  Acc: 0.4485
 Site-Middle_Eastern  | Val  Loss: 1.5099 | Val  Acc: 0.4727
 Site-Middle_Eastern  | Val  Loss: 1.4186 | Val  Acc: 0.4606
Average Valid Accuracy: 0.4260
 Best site-White            | Epoch:23 | Val Acc: 0.3455
 Best site-White            | Epoch:23 | Val Acc: 0.4242
 Best site-Latino_Hispanic  | Epoch:23 | Val Acc: 0.4182
 Best site-Latino_Hispanic  | Epoch:23 | Val Acc: 0.4303
 Best site-Black            | Epoch:23 | Val Acc: 0.3818
 Best site-Black            | Epoch:23 | Val Acc: 0.3818
 Best site-East_Asian       | Epoch:23 | Val Acc: 0.4182
 Best site-East_Asian       | Epoch:23 | Val Acc: 0.4545
 Best site-Indian           | Epoch:23 | Val Acc: 0.4364
 Best site-Indian           | Epoch:23 | Val Acc: 0.3818
 Best site-Southeast_Asian  | Epoch:23 | Val Acc: 0.5091
 Best site-Southeast_Asian  | Epoch:23 | Val Acc: 0.4485
 Best site-Middle_Eastern   | Epoch:23 | Val Acc: 0.4727
 Best site-Middle_Eastern   | Epoch:23 | Val Acc: 0.4606
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 24 ============
 Site-White           | Train Loss: 1.4163 | Train Acc: 0.4024
 Site-White           | Train Loss: 1.4355 | Train Acc: 0.4372
 Site-Latino_Hispanic | Train Loss: 1.6673 | Train Acc: 0.3659
 Site-Latino_Hispanic | Train Loss: 1.5191 | Train Acc: 0.3887
 Site-Black           | Train Loss: 1.6261 | Train Acc: 0.3537
 Site-Black           | Train Loss: 1.5444 | Train Acc: 0.4494
 Site-East_Asian      | Train Loss: 1.4409 | Train Acc: 0.4024
 Site-East_Asian      | Train Loss: 1.4560 | Train Acc: 0.4575
 Site-Indian          | Train Loss: 1.5501 | Train Acc: 0.4390
 Site-Indian          | Train Loss: 1.5565 | Train Acc: 0.3725
 Site-Southeast_Asian | Train Loss: 1.6655 | Train Acc: 0.4390
 Site-Southeast_Asian | Train Loss: 1.5241 | Train Acc: 0.4575
 Site-Middle_Eastern  | Train Loss: 1.4538 | Train Acc: 0.4390
 Site-Middle_Eastern  | Train Loss: 1.3943 | Train Acc: 0.4858
 Site-White           | Val  Loss: 1.5439 | Val  Acc: 0.4364
 Site-White           | Val  Loss: 1.4901 | Val  Acc: 0.3576
 Site-Latino_Hispanic | Val  Loss: 1.4809 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.5224 | Val  Acc: 0.3758
 Site-Black           | Val  Loss: 1.6483 | Val  Acc: 0.4000
 Site-Black           | Val  Loss: 1.6036 | Val  Acc: 0.3879
 Site-East_Asian      | Val  Loss: 1.6313 | Val  Acc: 0.3091
 Site-East_Asian      | Val  Loss: 1.4538 | Val  Acc: 0.4545
 Site-Indian          | Val  Loss: 1.4623 | Val  Acc: 0.4000
 Site-Indian          | Val  Loss: 1.5213 | Val  Acc: 0.3636
 Site-Southeast_Asian | Val  Loss: 1.6301 | Val  Acc: 0.4000
 Site-Southeast_Asian | Val  Loss: 1.5049 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.5064 | Val  Acc: 0.5091
 Site-Middle_Eastern  | Val  Loss: 1.4303 | Val  Acc: 0.4667
Average Valid Accuracy: 0.4082
============ Train epoch 25 ============
 Site-White           | Train Loss: 1.4199 | Train Acc: 0.4268
 Site-White           | Train Loss: 1.4479 | Train Acc: 0.4615
 Site-Latino_Hispanic | Train Loss: 1.5259 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.4687 | Train Acc: 0.4008
 Site-Black           | Train Loss: 1.6370 | Train Acc: 0.3415
 Site-Black           | Train Loss: 1.5673 | Train Acc: 0.4130
 Site-East_Asian      | Train Loss: 1.5645 | Train Acc: 0.4390
 Site-East_Asian      | Train Loss: 1.4680 | Train Acc: 0.4413
 Site-Indian          | Train Loss: 1.4745 | Train Acc: 0.4512
 Site-Indian          | Train Loss: 1.5157 | Train Acc: 0.4089
 Site-Southeast_Asian | Train Loss: 1.5640 | Train Acc: 0.4146
 Site-Southeast_Asian | Train Loss: 1.5217 | Train Acc: 0.4575
 Site-Middle_Eastern  | Train Loss: 1.4210 | Train Acc: 0.4634
 Site-Middle_Eastern  | Train Loss: 1.4012 | Train Acc: 0.4818
 Site-White           | Val  Loss: 1.5523 | Val  Acc: 0.3636
 Site-White           | Val  Loss: 1.4666 | Val  Acc: 0.4424
 Site-Latino_Hispanic | Val  Loss: 1.5283 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.4726 | Val  Acc: 0.4182
 Site-Black           | Val  Loss: 1.6767 | Val  Acc: 0.2909
 Site-Black           | Val  Loss: 1.6361 | Val  Acc: 0.4121
 Site-East_Asian      | Val  Loss: 1.5942 | Val  Acc: 0.3273
 Site-East_Asian      | Val  Loss: 1.4311 | Val  Acc: 0.4424
 Site-Indian          | Val  Loss: 1.4626 | Val  Acc: 0.4364
 Site-Indian          | Val  Loss: 1.5208 | Val  Acc: 0.4121
 Site-Southeast_Asian | Val  Loss: 1.6248 | Val  Acc: 0.4000
 Site-Southeast_Asian | Val  Loss: 1.4784 | Val  Acc: 0.4424
 Site-Middle_Eastern  | Val  Loss: 1.4721 | Val  Acc: 0.4364
 Site-Middle_Eastern  | Val  Loss: 1.4473 | Val  Acc: 0.4606
Average Valid Accuracy: 0.4061
============ Train epoch 26 ============
 Site-White           | Train Loss: 1.4899 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.4396 | Train Acc: 0.4494
 Site-Latino_Hispanic | Train Loss: 1.6284 | Train Acc: 0.3780
 Site-Latino_Hispanic | Train Loss: 1.5166 | Train Acc: 0.3887
 Site-Black           | Train Loss: 1.6267 | Train Acc: 0.3049
 Site-Black           | Train Loss: 1.5653 | Train Acc: 0.4251
 Site-East_Asian      | Train Loss: 1.3584 | Train Acc: 0.4512
 Site-East_Asian      | Train Loss: 1.4744 | Train Acc: 0.4170
 Site-Indian          | Train Loss: 1.6727 | Train Acc: 0.4146
 Site-Indian          | Train Loss: 1.5538 | Train Acc: 0.4008
 Site-Southeast_Asian | Train Loss: 1.5840 | Train Acc: 0.4512
 Site-Southeast_Asian | Train Loss: 1.4990 | Train Acc: 0.4372
 Site-Middle_Eastern  | Train Loss: 1.5353 | Train Acc: 0.4756
 Site-Middle_Eastern  | Train Loss: 1.3721 | Train Acc: 0.4939
 Site-White           | Val  Loss: 1.6021 | Val  Acc: 0.3455
 Site-White           | Val  Loss: 1.4531 | Val  Acc: 0.4061
 Site-Latino_Hispanic | Val  Loss: 1.4932 | Val  Acc: 0.3636
 Site-Latino_Hispanic | Val  Loss: 1.5047 | Val  Acc: 0.3939
 Site-Black           | Val  Loss: 1.6541 | Val  Acc: 0.2545
 Site-Black           | Val  Loss: 1.6104 | Val  Acc: 0.4061
 Site-East_Asian      | Val  Loss: 1.5145 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.4112 | Val  Acc: 0.4909
 Site-Indian          | Val  Loss: 1.4553 | Val  Acc: 0.4000
 Site-Indian          | Val  Loss: 1.5053 | Val  Acc: 0.3939
 Site-Southeast_Asian | Val  Loss: 1.6473 | Val  Acc: 0.4182
 Site-Southeast_Asian | Val  Loss: 1.4789 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.4474 | Val  Acc: 0.4182
 Site-Middle_Eastern  | Val  Loss: 1.4297 | Val  Acc: 0.4303
Average Valid Accuracy: 0.3996
============ Train epoch 27 ============
 Site-White           | Train Loss: 1.4377 | Train Acc: 0.4512
 Site-White           | Train Loss: 1.4474 | Train Acc: 0.4534
 Site-Latino_Hispanic | Train Loss: 1.6379 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.4775 | Train Acc: 0.3684
 Site-Black           | Train Loss: 1.6232 | Train Acc: 0.3659
 Site-Black           | Train Loss: 1.5578 | Train Acc: 0.4372
 Site-East_Asian      | Train Loss: 1.4210 | Train Acc: 0.4146
 Site-East_Asian      | Train Loss: 1.4195 | Train Acc: 0.4615
 Site-Indian          | Train Loss: 1.4266 | Train Acc: 0.4390
 Site-Indian          | Train Loss: 1.5192 | Train Acc: 0.4211
 Site-Southeast_Asian | Train Loss: 1.7658 | Train Acc: 0.3902
 Site-Southeast_Asian | Train Loss: 1.5421 | Train Acc: 0.4372
 Site-Middle_Eastern  | Train Loss: 1.4038 | Train Acc: 0.4512
 Site-Middle_Eastern  | Train Loss: 1.3736 | Train Acc: 0.4777
 Site-White           | Val  Loss: 1.5792 | Val  Acc: 0.3455
 Site-White           | Val  Loss: 1.4614 | Val  Acc: 0.4182
 Site-Latino_Hispanic | Val  Loss: 1.5232 | Val  Acc: 0.3273
 Site-Latino_Hispanic | Val  Loss: 1.4679 | Val  Acc: 0.4182
 Site-Black           | Val  Loss: 1.7214 | Val  Acc: 0.3636
 Site-Black           | Val  Loss: 1.6222 | Val  Acc: 0.4121
 Site-East_Asian      | Val  Loss: 1.5907 | Val  Acc: 0.4545
 Site-East_Asian      | Val  Loss: 1.4146 | Val  Acc: 0.4606
 Site-Indian          | Val  Loss: 1.4525 | Val  Acc: 0.4182
 Site-Indian          | Val  Loss: 1.4895 | Val  Acc: 0.4485
 Site-Southeast_Asian | Val  Loss: 1.6193 | Val  Acc: 0.4000
 Site-Southeast_Asian | Val  Loss: 1.4722 | Val  Acc: 0.4364
 Site-Middle_Eastern  | Val  Loss: 1.5223 | Val  Acc: 0.4727
 Site-Middle_Eastern  | Val  Loss: 1.4123 | Val  Acc: 0.4545
Average Valid Accuracy: 0.4165
============ Train epoch 28 ============
 Site-White           | Train Loss: 1.4098 | Train Acc: 0.4024
 Site-White           | Train Loss: 1.4295 | Train Acc: 0.4615
 Site-Latino_Hispanic | Train Loss: 1.5730 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.4583 | Train Acc: 0.4008
 Site-Black           | Train Loss: 1.5031 | Train Acc: 0.4146
 Site-Black           | Train Loss: 1.5961 | Train Acc: 0.4008
 Site-East_Asian      | Train Loss: 1.4842 | Train Acc: 0.4268
 Site-East_Asian      | Train Loss: 1.4506 | Train Acc: 0.4615
 Site-Indian          | Train Loss: 1.5285 | Train Acc: 0.4146
 Site-Indian          | Train Loss: 1.5070 | Train Acc: 0.4089
 Site-Southeast_Asian | Train Loss: 1.5701 | Train Acc: 0.4756
 Site-Southeast_Asian | Train Loss: 1.5214 | Train Acc: 0.4453
 Site-Middle_Eastern  | Train Loss: 1.5997 | Train Acc: 0.4756
 Site-Middle_Eastern  | Train Loss: 1.3753 | Train Acc: 0.4575
 Site-White           | Val  Loss: 1.5365 | Val  Acc: 0.3636
 Site-White           | Val  Loss: 1.4516 | Val  Acc: 0.4121
 Site-Latino_Hispanic | Val  Loss: 1.4108 | Val  Acc: 0.4182
 Site-Latino_Hispanic | Val  Loss: 1.5113 | Val  Acc: 0.3758
 Site-Black           | Val  Loss: 1.6365 | Val  Acc: 0.3818
 Site-Black           | Val  Loss: 1.6024 | Val  Acc: 0.4121
 Site-East_Asian      | Val  Loss: 1.5331 | Val  Acc: 0.3273
 Site-East_Asian      | Val  Loss: 1.4224 | Val  Acc: 0.4364
 Site-Indian          | Val  Loss: 1.4482 | Val  Acc: 0.4364
 Site-Indian          | Val  Loss: 1.4858 | Val  Acc: 0.3758
 Site-Southeast_Asian | Val  Loss: 1.5670 | Val  Acc: 0.4364
 Site-Southeast_Asian | Val  Loss: 1.4622 | Val  Acc: 0.4303
 Site-Middle_Eastern  | Val  Loss: 1.4572 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.3831 | Val  Acc: 0.4788
Average Valid Accuracy: 0.4100
============ Train epoch 29 ============
 Site-White           | Train Loss: 1.3814 | Train Acc: 0.3902
 Site-White           | Train Loss: 1.4126 | Train Acc: 0.4332
 Site-Latino_Hispanic | Train Loss: 1.6225 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.5045 | Train Acc: 0.3725
 Site-Black           | Train Loss: 1.5598 | Train Acc: 0.3293
 Site-Black           | Train Loss: 1.5516 | Train Acc: 0.4332
 Site-East_Asian      | Train Loss: 1.3849 | Train Acc: 0.4512
 Site-East_Asian      | Train Loss: 1.4271 | Train Acc: 0.4291
 Site-Indian          | Train Loss: 1.4862 | Train Acc: 0.4268
 Site-Indian          | Train Loss: 1.5137 | Train Acc: 0.3765
 Site-Southeast_Asian | Train Loss: 1.5825 | Train Acc: 0.4268
 Site-Southeast_Asian | Train Loss: 1.4909 | Train Acc: 0.4696
 Site-Middle_Eastern  | Train Loss: 1.5788 | Train Acc: 0.5244
 Site-Middle_Eastern  | Train Loss: 1.3699 | Train Acc: 0.4656
 Site-White           | Val  Loss: 1.5691 | Val  Acc: 0.3818
 Site-White           | Val  Loss: 1.4541 | Val  Acc: 0.4424
 Site-Latino_Hispanic | Val  Loss: 1.4847 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.4889 | Val  Acc: 0.3636
 Site-Black           | Val  Loss: 1.7401 | Val  Acc: 0.3273
 Site-Black           | Val  Loss: 1.5668 | Val  Acc: 0.4000
 Site-East_Asian      | Val  Loss: 1.5478 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.3867 | Val  Acc: 0.4909
 Site-Indian          | Val  Loss: 1.4528 | Val  Acc: 0.4364
 Site-Indian          | Val  Loss: 1.4758 | Val  Acc: 0.3818
 Site-Southeast_Asian | Val  Loss: 1.5696 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.4591 | Val  Acc: 0.4364
 Site-Middle_Eastern  | Val  Loss: 1.4152 | Val  Acc: 0.4727
 Site-Middle_Eastern  | Val  Loss: 1.3980 | Val  Acc: 0.4727
Average Valid Accuracy: 0.4173
============ Train epoch 30 ============
 Site-White           | Train Loss: 1.3505 | Train Acc: 0.4268
 Site-White           | Train Loss: 1.4321 | Train Acc: 0.4413
 Site-Latino_Hispanic | Train Loss: 1.5935 | Train Acc: 0.3780
 Site-Latino_Hispanic | Train Loss: 1.4743 | Train Acc: 0.3968
 Site-Black           | Train Loss: 1.6859 | Train Acc: 0.2927
 Site-Black           | Train Loss: 1.5335 | Train Acc: 0.4656
 Site-East_Asian      | Train Loss: 1.4944 | Train Acc: 0.4634
 Site-East_Asian      | Train Loss: 1.4170 | Train Acc: 0.4534
 Site-Indian          | Train Loss: 1.5335 | Train Acc: 0.4512
 Site-Indian          | Train Loss: 1.4828 | Train Acc: 0.4170
 Site-Southeast_Asian | Train Loss: 1.5853 | Train Acc: 0.4756
 Site-Southeast_Asian | Train Loss: 1.4766 | Train Acc: 0.4494
 Site-Middle_Eastern  | Train Loss: 1.4223 | Train Acc: 0.4390
 Site-Middle_Eastern  | Train Loss: 1.3799 | Train Acc: 0.4656
 Site-White           | Val  Loss: 1.5157 | Val  Acc: 0.4000
 Site-White           | Val  Loss: 1.4062 | Val  Acc: 0.4242
 Site-Latino_Hispanic | Val  Loss: 1.4589 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.4646 | Val  Acc: 0.4182
 Site-Black           | Val  Loss: 1.6966 | Val  Acc: 0.4182
 Site-Black           | Val  Loss: 1.5662 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.5039 | Val  Acc: 0.3636
 Site-East_Asian      | Val  Loss: 1.3997 | Val  Acc: 0.4485
 Site-Indian          | Val  Loss: 1.4752 | Val  Acc: 0.4182
 Site-Indian          | Val  Loss: 1.4800 | Val  Acc: 0.3939
 Site-Southeast_Asian | Val  Loss: 1.6072 | Val  Acc: 0.4909
 Site-Southeast_Asian | Val  Loss: 1.4832 | Val  Acc: 0.4606
 Site-Middle_Eastern  | Val  Loss: 1.4669 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.3718 | Val  Acc: 0.4788
Average Valid Accuracy: 0.4277
 Best site-White            | Epoch:30 | Val Acc: 0.4000
 Best site-White            | Epoch:30 | Val Acc: 0.4242
 Best site-Latino_Hispanic  | Epoch:30 | Val Acc: 0.4000
 Best site-Latino_Hispanic  | Epoch:30 | Val Acc: 0.4182
 Best site-Black            | Epoch:30 | Val Acc: 0.4182
 Best site-Black            | Epoch:30 | Val Acc: 0.4182
 Best site-East_Asian       | Epoch:30 | Val Acc: 0.3636
 Best site-East_Asian       | Epoch:30 | Val Acc: 0.4485
 Best site-Indian           | Epoch:30 | Val Acc: 0.4182
 Best site-Indian           | Epoch:30 | Val Acc: 0.3939
 Best site-Southeast_Asian  | Epoch:30 | Val Acc: 0.4909
 Best site-Southeast_Asian  | Epoch:30 | Val Acc: 0.4606
 Best site-Middle_Eastern   | Epoch:30 | Val Acc: 0.4545
 Best site-Middle_Eastern   | Epoch:30 | Val Acc: 0.4788
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 31 ============
 Site-White           | Train Loss: 1.5437 | Train Acc: 0.4390
 Site-White           | Train Loss: 1.4132 | Train Acc: 0.4453
 Site-Latino_Hispanic | Train Loss: 1.5550 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.4676 | Train Acc: 0.3927
 Site-Black           | Train Loss: 1.5098 | Train Acc: 0.3659
 Site-Black           | Train Loss: 1.5449 | Train Acc: 0.4534
 Site-East_Asian      | Train Loss: 1.4557 | Train Acc: 0.4634
 Site-East_Asian      | Train Loss: 1.4343 | Train Acc: 0.4494
 Site-Indian          | Train Loss: 1.5012 | Train Acc: 0.3902
 Site-Indian          | Train Loss: 1.4962 | Train Acc: 0.4332
 Site-Southeast_Asian | Train Loss: 1.5823 | Train Acc: 0.4146
 Site-Southeast_Asian | Train Loss: 1.5185 | Train Acc: 0.4534
 Site-Middle_Eastern  | Train Loss: 1.3819 | Train Acc: 0.4634
 Site-Middle_Eastern  | Train Loss: 1.3358 | Train Acc: 0.4656
 Site-White           | Val  Loss: 1.5322 | Val  Acc: 0.4545
 Site-White           | Val  Loss: 1.4311 | Val  Acc: 0.4182
 Site-Latino_Hispanic | Val  Loss: 1.4641 | Val  Acc: 0.3818
 Site-Latino_Hispanic | Val  Loss: 1.4404 | Val  Acc: 0.4485
 Site-Black           | Val  Loss: 1.7000 | Val  Acc: 0.3455
 Site-Black           | Val  Loss: 1.6057 | Val  Acc: 0.4242
 Site-East_Asian      | Val  Loss: 1.5984 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.3793 | Val  Acc: 0.4485
 Site-Indian          | Val  Loss: 1.4301 | Val  Acc: 0.4182
 Site-Indian          | Val  Loss: 1.4632 | Val  Acc: 0.4182
 Site-Southeast_Asian | Val  Loss: 1.6001 | Val  Acc: 0.4182
 Site-Southeast_Asian | Val  Loss: 1.4769 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.4549 | Val  Acc: 0.4364
 Site-Middle_Eastern  | Val  Loss: 1.3877 | Val  Acc: 0.4667
Average Valid Accuracy: 0.4251
============ Train epoch 32 ============
 Site-White           | Train Loss: 1.4948 | Train Acc: 0.4024
 Site-White           | Train Loss: 1.4059 | Train Acc: 0.4534
 Site-Latino_Hispanic | Train Loss: 1.7024 | Train Acc: 0.3659
 Site-Latino_Hispanic | Train Loss: 1.4597 | Train Acc: 0.4170
 Site-Black           | Train Loss: 1.6775 | Train Acc: 0.3049
 Site-Black           | Train Loss: 1.5770 | Train Acc: 0.4291
 Site-East_Asian      | Train Loss: 1.3615 | Train Acc: 0.4756
 Site-East_Asian      | Train Loss: 1.4360 | Train Acc: 0.4332
 Site-Indian          | Train Loss: 1.4930 | Train Acc: 0.3415
 Site-Indian          | Train Loss: 1.4732 | Train Acc: 0.4130
 Site-Southeast_Asian | Train Loss: 1.6255 | Train Acc: 0.4390
 Site-Southeast_Asian | Train Loss: 1.4911 | Train Acc: 0.4534
 Site-Middle_Eastern  | Train Loss: 1.4094 | Train Acc: 0.4390
 Site-Middle_Eastern  | Train Loss: 1.3333 | Train Acc: 0.4858
 Site-White           | Val  Loss: 1.5996 | Val  Acc: 0.3636
 Site-White           | Val  Loss: 1.4240 | Val  Acc: 0.4545
 Site-Latino_Hispanic | Val  Loss: 1.4408 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.4680 | Val  Acc: 0.4364
 Site-Black           | Val  Loss: 1.6615 | Val  Acc: 0.3636
 Site-Black           | Val  Loss: 1.5514 | Val  Acc: 0.4303
 Site-East_Asian      | Val  Loss: 1.5678 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.3728 | Val  Acc: 0.4909
 Site-Indian          | Val  Loss: 1.4278 | Val  Acc: 0.4545
 Site-Indian          | Val  Loss: 1.4849 | Val  Acc: 0.4000
 Site-Southeast_Asian | Val  Loss: 1.5456 | Val  Acc: 0.4364
 Site-Southeast_Asian | Val  Loss: 1.4124 | Val  Acc: 0.4667
 Site-Middle_Eastern  | Val  Loss: 1.4016 | Val  Acc: 0.4909
 Site-Middle_Eastern  | Val  Loss: 1.4094 | Val  Acc: 0.4545
Average Valid Accuracy: 0.4303
 Best site-White            | Epoch:32 | Val Acc: 0.3636
 Best site-White            | Epoch:32 | Val Acc: 0.4545
 Best site-Latino_Hispanic  | Epoch:32 | Val Acc: 0.4000
 Best site-Latino_Hispanic  | Epoch:32 | Val Acc: 0.4364
 Best site-Black            | Epoch:32 | Val Acc: 0.3636
 Best site-Black            | Epoch:32 | Val Acc: 0.4303
 Best site-East_Asian       | Epoch:32 | Val Acc: 0.3818
 Best site-East_Asian       | Epoch:32 | Val Acc: 0.4909
 Best site-Indian           | Epoch:32 | Val Acc: 0.4545
 Best site-Indian           | Epoch:32 | Val Acc: 0.4000
 Best site-Southeast_Asian  | Epoch:32 | Val Acc: 0.4364
 Best site-Southeast_Asian  | Epoch:32 | Val Acc: 0.4667
 Best site-Middle_Eastern   | Epoch:32 | Val Acc: 0.4909
 Best site-Middle_Eastern   | Epoch:32 | Val Acc: 0.4545
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 33 ============
 Site-White           | Train Loss: 1.4541 | Train Acc: 0.4512
 Site-White           | Train Loss: 1.4015 | Train Acc: 0.4899
 Site-Latino_Hispanic | Train Loss: 1.5802 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.4799 | Train Acc: 0.3887
 Site-Black           | Train Loss: 1.5409 | Train Acc: 0.3902
 Site-Black           | Train Loss: 1.5424 | Train Acc: 0.4211
 Site-East_Asian      | Train Loss: 1.3432 | Train Acc: 0.4878
 Site-East_Asian      | Train Loss: 1.4240 | Train Acc: 0.4534
 Site-Indian          | Train Loss: 1.4802 | Train Acc: 0.4146
 Site-Indian          | Train Loss: 1.4963 | Train Acc: 0.4372
 Site-Southeast_Asian | Train Loss: 1.4638 | Train Acc: 0.4268
 Site-Southeast_Asian | Train Loss: 1.4592 | Train Acc: 0.4575
 Site-Middle_Eastern  | Train Loss: 1.4021 | Train Acc: 0.4390
 Site-Middle_Eastern  | Train Loss: 1.3383 | Train Acc: 0.4858
 Site-White           | Val  Loss: 1.5094 | Val  Acc: 0.3636
 Site-White           | Val  Loss: 1.3754 | Val  Acc: 0.4606
 Site-Latino_Hispanic | Val  Loss: 1.4449 | Val  Acc: 0.4545
 Site-Latino_Hispanic | Val  Loss: 1.4607 | Val  Acc: 0.4242
 Site-Black           | Val  Loss: 1.6286 | Val  Acc: 0.4000
 Site-Black           | Val  Loss: 1.5649 | Val  Acc: 0.4121
 Site-East_Asian      | Val  Loss: 1.5135 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.3756 | Val  Acc: 0.4485
 Site-Indian          | Val  Loss: 1.4688 | Val  Acc: 0.4000
 Site-Indian          | Val  Loss: 1.4431 | Val  Acc: 0.4061
 Site-Southeast_Asian | Val  Loss: 1.5193 | Val  Acc: 0.4909
 Site-Southeast_Asian | Val  Loss: 1.4784 | Val  Acc: 0.4364
 Site-Middle_Eastern  | Val  Loss: 1.4409 | Val  Acc: 0.4909
 Site-Middle_Eastern  | Val  Loss: 1.3738 | Val  Acc: 0.4727
Average Valid Accuracy: 0.4342
 Best site-White            | Epoch:33 | Val Acc: 0.3636
 Best site-White            | Epoch:33 | Val Acc: 0.4606
 Best site-Latino_Hispanic  | Epoch:33 | Val Acc: 0.4545
 Best site-Latino_Hispanic  | Epoch:33 | Val Acc: 0.4242
 Best site-Black            | Epoch:33 | Val Acc: 0.4000
 Best site-Black            | Epoch:33 | Val Acc: 0.4121
 Best site-East_Asian       | Epoch:33 | Val Acc: 0.4182
 Best site-East_Asian       | Epoch:33 | Val Acc: 0.4485
 Best site-Indian           | Epoch:33 | Val Acc: 0.4000
 Best site-Indian           | Epoch:33 | Val Acc: 0.4061
 Best site-Southeast_Asian  | Epoch:33 | Val Acc: 0.4909
 Best site-Southeast_Asian  | Epoch:33 | Val Acc: 0.4364
 Best site-Middle_Eastern   | Epoch:33 | Val Acc: 0.4909
 Best site-Middle_Eastern   | Epoch:33 | Val Acc: 0.4727
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 34 ============
 Site-White           | Train Loss: 1.3976 | Train Acc: 0.4756
 Site-White           | Train Loss: 1.3696 | Train Acc: 0.4737
 Site-Latino_Hispanic | Train Loss: 1.4638 | Train Acc: 0.3902
 Site-Latino_Hispanic | Train Loss: 1.4558 | Train Acc: 0.4008
 Site-Black           | Train Loss: 1.6032 | Train Acc: 0.3537
 Site-Black           | Train Loss: 1.5532 | Train Acc: 0.4453
 Site-East_Asian      | Train Loss: 1.4642 | Train Acc: 0.4268
 Site-East_Asian      | Train Loss: 1.4105 | Train Acc: 0.4656
 Site-Indian          | Train Loss: 1.4914 | Train Acc: 0.4268
 Site-Indian          | Train Loss: 1.4697 | Train Acc: 0.4251
 Site-Southeast_Asian | Train Loss: 1.4079 | Train Acc: 0.4268
 Site-Southeast_Asian | Train Loss: 1.4766 | Train Acc: 0.4939
 Site-Middle_Eastern  | Train Loss: 1.3439 | Train Acc: 0.4512
 Site-Middle_Eastern  | Train Loss: 1.3352 | Train Acc: 0.4980
 Site-White           | Val  Loss: 1.4889 | Val  Acc: 0.4000
 Site-White           | Val  Loss: 1.3900 | Val  Acc: 0.4182
 Site-Latino_Hispanic | Val  Loss: 1.3769 | Val  Acc: 0.4182
 Site-Latino_Hispanic | Val  Loss: 1.4747 | Val  Acc: 0.4242
 Site-Black           | Val  Loss: 1.7032 | Val  Acc: 0.3091
 Site-Black           | Val  Loss: 1.5781 | Val  Acc: 0.4061
 Site-East_Asian      | Val  Loss: 1.5168 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.3681 | Val  Acc: 0.4606
 Site-Indian          | Val  Loss: 1.3619 | Val  Acc: 0.5091
 Site-Indian          | Val  Loss: 1.4461 | Val  Acc: 0.4061
 Site-Southeast_Asian | Val  Loss: 1.5641 | Val  Acc: 0.4364
 Site-Southeast_Asian | Val  Loss: 1.4504 | Val  Acc: 0.4424
 Site-Middle_Eastern  | Val  Loss: 1.4167 | Val  Acc: 0.4364
 Site-Middle_Eastern  | Val  Loss: 1.3587 | Val  Acc: 0.4909
Average Valid Accuracy: 0.4268
============ Train epoch 35 ============
 Site-White           | Train Loss: 1.4607 | Train Acc: 0.4268
 Site-White           | Train Loss: 1.3845 | Train Acc: 0.4777
 Site-Latino_Hispanic | Train Loss: 1.6076 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.4568 | Train Acc: 0.3887
 Site-Black           | Train Loss: 1.6095 | Train Acc: 0.3659
 Site-Black           | Train Loss: 1.5286 | Train Acc: 0.4453
 Site-East_Asian      | Train Loss: 1.5256 | Train Acc: 0.4024
 Site-East_Asian      | Train Loss: 1.4202 | Train Acc: 0.4656
 Site-Indian          | Train Loss: 1.4579 | Train Acc: 0.4634
 Site-Indian          | Train Loss: 1.4505 | Train Acc: 0.4413
 Site-Southeast_Asian | Train Loss: 1.5244 | Train Acc: 0.4756
 Site-Southeast_Asian | Train Loss: 1.4789 | Train Acc: 0.4737
 Site-Middle_Eastern  | Train Loss: 1.2658 | Train Acc: 0.4390
 Site-Middle_Eastern  | Train Loss: 1.3307 | Train Acc: 0.5061
 Site-White           | Val  Loss: 1.4608 | Val  Acc: 0.3818
 Site-White           | Val  Loss: 1.3810 | Val  Acc: 0.4485
 Site-Latino_Hispanic | Val  Loss: 1.4475 | Val  Acc: 0.3636
 Site-Latino_Hispanic | Val  Loss: 1.4324 | Val  Acc: 0.4303
 Site-Black           | Val  Loss: 1.6420 | Val  Acc: 0.3273
 Site-Black           | Val  Loss: 1.5269 | Val  Acc: 0.4303
 Site-East_Asian      | Val  Loss: 1.5629 | Val  Acc: 0.4909
 Site-East_Asian      | Val  Loss: 1.3853 | Val  Acc: 0.5030
 Site-Indian          | Val  Loss: 1.3918 | Val  Acc: 0.5273
 Site-Indian          | Val  Loss: 1.4652 | Val  Acc: 0.4121
 Site-Southeast_Asian | Val  Loss: 1.6400 | Val  Acc: 0.4000
 Site-Southeast_Asian | Val  Loss: 1.4356 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.4230 | Val  Acc: 0.4727
 Site-Middle_Eastern  | Val  Loss: 1.3901 | Val  Acc: 0.4424
Average Valid Accuracy: 0.4346
 Best site-White            | Epoch:35 | Val Acc: 0.3818
 Best site-White            | Epoch:35 | Val Acc: 0.4485
 Best site-Latino_Hispanic  | Epoch:35 | Val Acc: 0.3636
 Best site-Latino_Hispanic  | Epoch:35 | Val Acc: 0.4303
 Best site-Black            | Epoch:35 | Val Acc: 0.3273
 Best site-Black            | Epoch:35 | Val Acc: 0.4303
 Best site-East_Asian       | Epoch:35 | Val Acc: 0.4909
 Best site-East_Asian       | Epoch:35 | Val Acc: 0.5030
 Best site-Indian           | Epoch:35 | Val Acc: 0.5273
 Best site-Indian           | Epoch:35 | Val Acc: 0.4121
 Best site-Southeast_Asian  | Epoch:35 | Val Acc: 0.4000
 Best site-Southeast_Asian  | Epoch:35 | Val Acc: 0.4545
 Best site-Middle_Eastern   | Epoch:35 | Val Acc: 0.4727
 Best site-Middle_Eastern   | Epoch:35 | Val Acc: 0.4424
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 36 ============
 Site-White           | Train Loss: 1.4422 | Train Acc: 0.4268
 Site-White           | Train Loss: 1.3731 | Train Acc: 0.4899
 Site-Latino_Hispanic | Train Loss: 1.6125 | Train Acc: 0.4146
 Site-Latino_Hispanic | Train Loss: 1.4344 | Train Acc: 0.4332
 Site-Black           | Train Loss: 1.6442 | Train Acc: 0.3415
 Site-Black           | Train Loss: 1.5147 | Train Acc: 0.4777
 Site-East_Asian      | Train Loss: 1.4495 | Train Acc: 0.4146
 Site-East_Asian      | Train Loss: 1.4070 | Train Acc: 0.4818
 Site-Indian          | Train Loss: 1.5607 | Train Acc: 0.4512
 Site-Indian          | Train Loss: 1.4440 | Train Acc: 0.4372
 Site-Southeast_Asian | Train Loss: 1.5120 | Train Acc: 0.3780
 Site-Southeast_Asian | Train Loss: 1.4735 | Train Acc: 0.4737
 Site-Middle_Eastern  | Train Loss: 1.3358 | Train Acc: 0.4878
 Site-Middle_Eastern  | Train Loss: 1.3500 | Train Acc: 0.4818
 Site-White           | Val  Loss: 1.4639 | Val  Acc: 0.3636
 Site-White           | Val  Loss: 1.4037 | Val  Acc: 0.4848
 Site-Latino_Hispanic | Val  Loss: 1.4756 | Val  Acc: 0.4182
 Site-Latino_Hispanic | Val  Loss: 1.4465 | Val  Acc: 0.4364
 Site-Black           | Val  Loss: 1.5789 | Val  Acc: 0.4000
 Site-Black           | Val  Loss: 1.5571 | Val  Acc: 0.4000
 Site-East_Asian      | Val  Loss: 1.5681 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.3880 | Val  Acc: 0.5152
 Site-Indian          | Val  Loss: 1.4642 | Val  Acc: 0.4182
 Site-Indian          | Val  Loss: 1.3993 | Val  Acc: 0.4303
 Site-Southeast_Asian | Val  Loss: 1.5064 | Val  Acc: 0.4909
 Site-Southeast_Asian | Val  Loss: 1.4313 | Val  Acc: 0.5152
 Site-Middle_Eastern  | Val  Loss: 1.4725 | Val  Acc: 0.4727
 Site-Middle_Eastern  | Val  Loss: 1.3500 | Val  Acc: 0.5152
Average Valid Accuracy: 0.4485
 Best site-White            | Epoch:36 | Val Acc: 0.3636
 Best site-White            | Epoch:36 | Val Acc: 0.4848
 Best site-Latino_Hispanic  | Epoch:36 | Val Acc: 0.4182
 Best site-Latino_Hispanic  | Epoch:36 | Val Acc: 0.4364
 Best site-Black            | Epoch:36 | Val Acc: 0.4000
 Best site-Black            | Epoch:36 | Val Acc: 0.4000
 Best site-East_Asian       | Epoch:36 | Val Acc: 0.4182
 Best site-East_Asian       | Epoch:36 | Val Acc: 0.5152
 Best site-Indian           | Epoch:36 | Val Acc: 0.4182
 Best site-Indian           | Epoch:36 | Val Acc: 0.4303
 Best site-Southeast_Asian  | Epoch:36 | Val Acc: 0.4909
 Best site-Southeast_Asian  | Epoch:36 | Val Acc: 0.5152
 Best site-Middle_Eastern   | Epoch:36 | Val Acc: 0.4727
 Best site-Middle_Eastern   | Epoch:36 | Val Acc: 0.5152
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 37 ============
 Site-White           | Train Loss: 1.4779 | Train Acc: 0.4390
 Site-White           | Train Loss: 1.3880 | Train Acc: 0.5020
 Site-Latino_Hispanic | Train Loss: 1.5699 | Train Acc: 0.3659
 Site-Latino_Hispanic | Train Loss: 1.4553 | Train Acc: 0.4170
 Site-Black           | Train Loss: 1.6216 | Train Acc: 0.3780
 Site-Black           | Train Loss: 1.5275 | Train Acc: 0.4453
 Site-East_Asian      | Train Loss: 1.4071 | Train Acc: 0.4390
 Site-East_Asian      | Train Loss: 1.3926 | Train Acc: 0.4615
 Site-Indian          | Train Loss: 1.3854 | Train Acc: 0.3780
 Site-Indian          | Train Loss: 1.4640 | Train Acc: 0.4413
 Site-Southeast_Asian | Train Loss: 1.5100 | Train Acc: 0.4390
 Site-Southeast_Asian | Train Loss: 1.4416 | Train Acc: 0.4899
 Site-Middle_Eastern  | Train Loss: 1.3632 | Train Acc: 0.4878
 Site-Middle_Eastern  | Train Loss: 1.3018 | Train Acc: 0.5142
 Site-White           | Val  Loss: 1.4954 | Val  Acc: 0.3455
 Site-White           | Val  Loss: 1.4100 | Val  Acc: 0.4485
 Site-Latino_Hispanic | Val  Loss: 1.4384 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.4548 | Val  Acc: 0.4242
 Site-Black           | Val  Loss: 1.6340 | Val  Acc: 0.4182
 Site-Black           | Val  Loss: 1.5756 | Val  Acc: 0.4061
 Site-East_Asian      | Val  Loss: 1.5435 | Val  Acc: 0.4364
 Site-East_Asian      | Val  Loss: 1.3741 | Val  Acc: 0.4727
 Site-Indian          | Val  Loss: 1.3694 | Val  Acc: 0.4545
 Site-Indian          | Val  Loss: 1.4532 | Val  Acc: 0.4485
 Site-Southeast_Asian | Val  Loss: 1.5577 | Val  Acc: 0.4909
 Site-Southeast_Asian | Val  Loss: 1.4474 | Val  Acc: 0.4848
 Site-Middle_Eastern  | Val  Loss: 1.3838 | Val  Acc: 0.5455
 Site-Middle_Eastern  | Val  Loss: 1.3519 | Val  Acc: 0.4788
Average Valid Accuracy: 0.4468
============ Train epoch 38 ============
 Site-White           | Train Loss: 1.4054 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.3494 | Train Acc: 0.4899
 Site-Latino_Hispanic | Train Loss: 1.8158 | Train Acc: 0.3659
 Site-Latino_Hispanic | Train Loss: 1.4675 | Train Acc: 0.3806
 Site-Black           | Train Loss: 1.5637 | Train Acc: 0.3902
 Site-Black           | Train Loss: 1.5219 | Train Acc: 0.4453
 Site-East_Asian      | Train Loss: 1.3896 | Train Acc: 0.3537
 Site-East_Asian      | Train Loss: 1.3944 | Train Acc: 0.4696
 Site-Indian          | Train Loss: 1.5094 | Train Acc: 0.3780
 Site-Indian          | Train Loss: 1.4503 | Train Acc: 0.4494
 Site-Southeast_Asian | Train Loss: 1.5982 | Train Acc: 0.4268
 Site-Southeast_Asian | Train Loss: 1.4296 | Train Acc: 0.4939
 Site-Middle_Eastern  | Train Loss: 1.3355 | Train Acc: 0.4634
 Site-Middle_Eastern  | Train Loss: 1.3329 | Train Acc: 0.4777
 Site-White           | Val  Loss: 1.4730 | Val  Acc: 0.4000
 Site-White           | Val  Loss: 1.3879 | Val  Acc: 0.4424
 Site-Latino_Hispanic | Val  Loss: 1.4345 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.4508 | Val  Acc: 0.4242
 Site-Black           | Val  Loss: 1.5934 | Val  Acc: 0.4000
 Site-Black           | Val  Loss: 1.5575 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.4909 | Val  Acc: 0.4727
 Site-East_Asian      | Val  Loss: 1.3802 | Val  Acc: 0.4364
 Site-Indian          | Val  Loss: 1.4214 | Val  Acc: 0.4364
 Site-Indian          | Val  Loss: 1.4542 | Val  Acc: 0.4424
 Site-Southeast_Asian | Val  Loss: 1.5019 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.4445 | Val  Acc: 0.4788
 Site-Middle_Eastern  | Val  Loss: 1.4034 | Val  Acc: 0.3818
 Site-Middle_Eastern  | Val  Loss: 1.3323 | Val  Acc: 0.4970
Average Valid Accuracy: 0.4346
============ Train epoch 39 ============
 Site-White           | Train Loss: 1.4222 | Train Acc: 0.4634
 Site-White           | Train Loss: 1.3571 | Train Acc: 0.4737
 Site-Latino_Hispanic | Train Loss: 1.5310 | Train Acc: 0.4146
 Site-Latino_Hispanic | Train Loss: 1.4528 | Train Acc: 0.3725
 Site-Black           | Train Loss: 1.6012 | Train Acc: 0.3537
 Site-Black           | Train Loss: 1.5204 | Train Acc: 0.4615
 Site-East_Asian      | Train Loss: 1.2878 | Train Acc: 0.4512
 Site-East_Asian      | Train Loss: 1.3877 | Train Acc: 0.4696
 Site-Indian          | Train Loss: 1.4366 | Train Acc: 0.4512
 Site-Indian          | Train Loss: 1.4576 | Train Acc: 0.4291
 Site-Southeast_Asian | Train Loss: 1.4665 | Train Acc: 0.4512
 Site-Southeast_Asian | Train Loss: 1.4529 | Train Acc: 0.4858
 Site-Middle_Eastern  | Train Loss: 1.4928 | Train Acc: 0.4390
 Site-Middle_Eastern  | Train Loss: 1.3049 | Train Acc: 0.4939
 Site-White           | Val  Loss: 1.4968 | Val  Acc: 0.4000
 Site-White           | Val  Loss: 1.3721 | Val  Acc: 0.4667
 Site-Latino_Hispanic | Val  Loss: 1.3977 | Val  Acc: 0.4364
 Site-Latino_Hispanic | Val  Loss: 1.4340 | Val  Acc: 0.4061
 Site-Black           | Val  Loss: 1.5815 | Val  Acc: 0.4364
 Site-Black           | Val  Loss: 1.5255 | Val  Acc: 0.4303
 Site-East_Asian      | Val  Loss: 1.5282 | Val  Acc: 0.4545
 Site-East_Asian      | Val  Loss: 1.3488 | Val  Acc: 0.4909
 Site-Indian          | Val  Loss: 1.3907 | Val  Acc: 0.4182
 Site-Indian          | Val  Loss: 1.4141 | Val  Acc: 0.4606
 Site-Southeast_Asian | Val  Loss: 1.5570 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.4240 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.4262 | Val  Acc: 0.5091
 Site-Middle_Eastern  | Val  Loss: 1.3477 | Val  Acc: 0.4848
Average Valid Accuracy: 0.4502
 Best site-White            | Epoch:39 | Val Acc: 0.4000
 Best site-White            | Epoch:39 | Val Acc: 0.4667
 Best site-Latino_Hispanic  | Epoch:39 | Val Acc: 0.4364
 Best site-Latino_Hispanic  | Epoch:39 | Val Acc: 0.4061
 Best site-Black            | Epoch:39 | Val Acc: 0.4364
 Best site-Black            | Epoch:39 | Val Acc: 0.4303
 Best site-East_Asian       | Epoch:39 | Val Acc: 0.4545
 Best site-East_Asian       | Epoch:39 | Val Acc: 0.4909
 Best site-Indian           | Epoch:39 | Val Acc: 0.4182
 Best site-Indian           | Epoch:39 | Val Acc: 0.4606
 Best site-Southeast_Asian  | Epoch:39 | Val Acc: 0.4545
 Best site-Southeast_Asian  | Epoch:39 | Val Acc: 0.4545
 Best site-Middle_Eastern   | Epoch:39 | Val Acc: 0.5091
 Best site-Middle_Eastern   | Epoch:39 | Val Acc: 0.4848
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
 Test site-White           | Epoch:39 | Test Acc: 0.3659
 Test site-Latino_Hispanic | Epoch:39 | Test Acc: 0.3346
 Test site-Black           | Epoch:39 | Test Acc: 0.3342
 Test site-East_Asian      | Epoch:39 | Test Acc: 0.4542
 Test site-Indian          | Epoch:39 | Test Acc: 0.3212
 Test site-Southeast_Asian | Epoch:39 | Test Acc: 0.3951
 Test site-Middle_Eastern  | Epoch:39 | Test Acc: 0.3714
Average Test Accuracy: 0.3681
============ Train epoch 40 ============
 Site-White           | Train Loss: 1.3483 | Train Acc: 0.4634
 Site-White           | Train Loss: 1.3465 | Train Acc: 0.5142
 Site-Latino_Hispanic | Train Loss: 1.6497 | Train Acc: 0.3902
 Site-Latino_Hispanic | Train Loss: 1.4438 | Train Acc: 0.3887
 Site-Black           | Train Loss: 1.5760 | Train Acc: 0.3659
 Site-Black           | Train Loss: 1.4874 | Train Acc: 0.4494
 Site-East_Asian      | Train Loss: 1.4124 | Train Acc: 0.4634
 Site-East_Asian      | Train Loss: 1.3966 | Train Acc: 0.4656
 Site-Indian          | Train Loss: 1.3689 | Train Acc: 0.4146
 Site-Indian          | Train Loss: 1.4515 | Train Acc: 0.4413
 Site-Southeast_Asian | Train Loss: 1.4177 | Train Acc: 0.4024
 Site-Southeast_Asian | Train Loss: 1.4570 | Train Acc: 0.4656
 Site-Middle_Eastern  | Train Loss: 1.4156 | Train Acc: 0.4878
 Site-Middle_Eastern  | Train Loss: 1.3010 | Train Acc: 0.5020
 Site-White           | Val  Loss: 1.5096 | Val  Acc: 0.3636
 Site-White           | Val  Loss: 1.4020 | Val  Acc: 0.4545
 Site-Latino_Hispanic | Val  Loss: 1.3680 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.4542 | Val  Acc: 0.4000
 Site-Black           | Val  Loss: 1.6358 | Val  Acc: 0.4182
 Site-Black           | Val  Loss: 1.5228 | Val  Acc: 0.4545
 Site-East_Asian      | Val  Loss: 1.4957 | Val  Acc: 0.4364
 Site-East_Asian      | Val  Loss: 1.3685 | Val  Acc: 0.5030
 Site-Indian          | Val  Loss: 1.4255 | Val  Acc: 0.3818
 Site-Indian          | Val  Loss: 1.4072 | Val  Acc: 0.4848
 Site-Southeast_Asian | Val  Loss: 1.5895 | Val  Acc: 0.4727
 Site-Southeast_Asian | Val  Loss: 1.4594 | Val  Acc: 0.4424
 Site-Middle_Eastern  | Val  Loss: 1.4522 | Val  Acc: 0.4909
 Site-Middle_Eastern  | Val  Loss: 1.3391 | Val  Acc: 0.4909
Average Valid Accuracy: 0.4424
============ Train epoch 41 ============
 Site-White           | Train Loss: 1.4831 | Train Acc: 0.4390
 Site-White           | Train Loss: 1.3582 | Train Acc: 0.4615
 Site-Latino_Hispanic | Train Loss: 1.4768 | Train Acc: 0.3902
 Site-Latino_Hispanic | Train Loss: 1.4463 | Train Acc: 0.4130
 Site-Black           | Train Loss: 1.5358 | Train Acc: 0.3415
 Site-Black           | Train Loss: 1.4895 | Train Acc: 0.4534
 Site-East_Asian      | Train Loss: 1.4480 | Train Acc: 0.4268
 Site-East_Asian      | Train Loss: 1.3968 | Train Acc: 0.4575
 Site-Indian          | Train Loss: 1.5313 | Train Acc: 0.4512
 Site-Indian          | Train Loss: 1.4371 | Train Acc: 0.4130
 Site-Southeast_Asian | Train Loss: 1.5261 | Train Acc: 0.4024
 Site-Southeast_Asian | Train Loss: 1.4526 | Train Acc: 0.5061
 Site-Middle_Eastern  | Train Loss: 1.3517 | Train Acc: 0.4756
 Site-Middle_Eastern  | Train Loss: 1.3129 | Train Acc: 0.4818
 Site-White           | Val  Loss: 1.4132 | Val  Acc: 0.4182
 Site-White           | Val  Loss: 1.3538 | Val  Acc: 0.4727
 Site-Latino_Hispanic | Val  Loss: 1.4409 | Val  Acc: 0.4364
 Site-Latino_Hispanic | Val  Loss: 1.4041 | Val  Acc: 0.4242
 Site-Black           | Val  Loss: 1.5731 | Val  Acc: 0.3455
 Site-Black           | Val  Loss: 1.5412 | Val  Acc: 0.4303
 Site-East_Asian      | Val  Loss: 1.5926 | Val  Acc: 0.4364
 Site-East_Asian      | Val  Loss: 1.3163 | Val  Acc: 0.4970
 Site-Indian          | Val  Loss: 1.3457 | Val  Acc: 0.4545
 Site-Indian          | Val  Loss: 1.4427 | Val  Acc: 0.4364
 Site-Southeast_Asian | Val  Loss: 1.5752 | Val  Acc: 0.4182
 Site-Southeast_Asian | Val  Loss: 1.4192 | Val  Acc: 0.4788
 Site-Middle_Eastern  | Val  Loss: 1.3839 | Val  Acc: 0.4545
 Site-Middle_Eastern  | Val  Loss: 1.3277 | Val  Acc: 0.4788
Average Valid Accuracy: 0.4416
============ Train epoch 42 ============
 Site-White           | Train Loss: 1.5029 | Train Acc: 0.4390
 Site-White           | Train Loss: 1.3535 | Train Acc: 0.5182
 Site-Latino_Hispanic | Train Loss: 1.6449 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.4226 | Train Acc: 0.4130
 Site-Black           | Train Loss: 1.5283 | Train Acc: 0.4024
 Site-Black           | Train Loss: 1.5189 | Train Acc: 0.4453
 Site-East_Asian      | Train Loss: 1.4216 | Train Acc: 0.4146
 Site-East_Asian      | Train Loss: 1.3798 | Train Acc: 0.4939
 Site-Indian          | Train Loss: 1.4414 | Train Acc: 0.4390
 Site-Indian          | Train Loss: 1.4423 | Train Acc: 0.4251
 Site-Southeast_Asian | Train Loss: 1.6264 | Train Acc: 0.3902
 Site-Southeast_Asian | Train Loss: 1.4270 | Train Acc: 0.4696
 Site-Middle_Eastern  | Train Loss: 1.4318 | Train Acc: 0.5000
 Site-Middle_Eastern  | Train Loss: 1.3024 | Train Acc: 0.5304
 Site-White           | Val  Loss: 1.4466 | Val  Acc: 0.4000
 Site-White           | Val  Loss: 1.3569 | Val  Acc: 0.4364
 Site-Latino_Hispanic | Val  Loss: 1.4860 | Val  Acc: 0.2909
 Site-Latino_Hispanic | Val  Loss: 1.4003 | Val  Acc: 0.4242
 Site-Black           | Val  Loss: 1.6464 | Val  Acc: 0.4000
 Site-Black           | Val  Loss: 1.5340 | Val  Acc: 0.4000
 Site-East_Asian      | Val  Loss: 1.5208 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.3581 | Val  Acc: 0.4909
 Site-Indian          | Val  Loss: 1.3602 | Val  Acc: 0.4909
 Site-Indian          | Val  Loss: 1.4141 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.4277 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.4019 | Val  Acc: 0.4727
 Site-Middle_Eastern  | Val  Loss: 1.3978 | Val  Acc: 0.4909
 Site-Middle_Eastern  | Val  Loss: 1.3225 | Val  Acc: 0.4970
Average Valid Accuracy: 0.4346
============ Train epoch 43 ============
 Site-White           | Train Loss: 1.4249 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.3453 | Train Acc: 0.4696
 Site-Latino_Hispanic | Train Loss: 1.6398 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.4196 | Train Acc: 0.4413
 Site-Black           | Train Loss: 1.6941 | Train Acc: 0.3415
 Site-Black           | Train Loss: 1.5132 | Train Acc: 0.4615
 Site-East_Asian      | Train Loss: 1.5354 | Train Acc: 0.4512
 Site-East_Asian      | Train Loss: 1.3782 | Train Acc: 0.4696
 Site-Indian          | Train Loss: 1.3641 | Train Acc: 0.4146
 Site-Indian          | Train Loss: 1.4544 | Train Acc: 0.4372
 Site-Southeast_Asian | Train Loss: 1.4677 | Train Acc: 0.4268
 Site-Southeast_Asian | Train Loss: 1.4182 | Train Acc: 0.4696
 Site-Middle_Eastern  | Train Loss: 1.3284 | Train Acc: 0.4878
 Site-Middle_Eastern  | Train Loss: 1.2759 | Train Acc: 0.5101
 Site-White           | Val  Loss: 1.4523 | Val  Acc: 0.4182
 Site-White           | Val  Loss: 1.3844 | Val  Acc: 0.4485
 Site-Latino_Hispanic | Val  Loss: 1.3976 | Val  Acc: 0.4727
 Site-Latino_Hispanic | Val  Loss: 1.3927 | Val  Acc: 0.4364
 Site-Black           | Val  Loss: 1.6245 | Val  Acc: 0.3636
 Site-Black           | Val  Loss: 1.5516 | Val  Acc: 0.4545
 Site-East_Asian      | Val  Loss: 1.4438 | Val  Acc: 0.4727
 Site-East_Asian      | Val  Loss: 1.3185 | Val  Acc: 0.5030
 Site-Indian          | Val  Loss: 1.4137 | Val  Acc: 0.4000
 Site-Indian          | Val  Loss: 1.4234 | Val  Acc: 0.4485
 Site-Southeast_Asian | Val  Loss: 1.5255 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.4179 | Val  Acc: 0.4303
 Site-Middle_Eastern  | Val  Loss: 1.3765 | Val  Acc: 0.5091
 Site-Middle_Eastern  | Val  Loss: 1.3309 | Val  Acc: 0.5212
Average Valid Accuracy: 0.4524
 Best site-White            | Epoch:43 | Val Acc: 0.4182
 Best site-White            | Epoch:43 | Val Acc: 0.4485
 Best site-Latino_Hispanic  | Epoch:43 | Val Acc: 0.4727
 Best site-Latino_Hispanic  | Epoch:43 | Val Acc: 0.4364
 Best site-Black            | Epoch:43 | Val Acc: 0.3636
 Best site-Black            | Epoch:43 | Val Acc: 0.4545
 Best site-East_Asian       | Epoch:43 | Val Acc: 0.4727
 Best site-East_Asian       | Epoch:43 | Val Acc: 0.5030
 Best site-Indian           | Epoch:43 | Val Acc: 0.4000
 Best site-Indian           | Epoch:43 | Val Acc: 0.4485
 Best site-Southeast_Asian  | Epoch:43 | Val Acc: 0.4545
 Best site-Southeast_Asian  | Epoch:43 | Val Acc: 0.4303
 Best site-Middle_Eastern   | Epoch:43 | Val Acc: 0.5091
 Best site-Middle_Eastern   | Epoch:43 | Val Acc: 0.5212
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 44 ============
 Site-White           | Train Loss: 1.4502 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.3424 | Train Acc: 0.5061
 Site-Latino_Hispanic | Train Loss: 1.6047 | Train Acc: 0.3537
 Site-Latino_Hispanic | Train Loss: 1.4400 | Train Acc: 0.4251
 Site-Black           | Train Loss: 1.6227 | Train Acc: 0.3171
 Site-Black           | Train Loss: 1.4999 | Train Acc: 0.4656
 Site-East_Asian      | Train Loss: 1.5101 | Train Acc: 0.4756
 Site-East_Asian      | Train Loss: 1.3857 | Train Acc: 0.4696
 Site-Indian          | Train Loss: 1.4893 | Train Acc: 0.4390
 Site-Indian          | Train Loss: 1.4230 | Train Acc: 0.4534
 Site-Southeast_Asian | Train Loss: 1.6254 | Train Acc: 0.4024
 Site-Southeast_Asian | Train Loss: 1.4209 | Train Acc: 0.4818
 Site-Middle_Eastern  | Train Loss: 1.2846 | Train Acc: 0.4756
 Site-Middle_Eastern  | Train Loss: 1.2810 | Train Acc: 0.5223
 Site-White           | Val  Loss: 1.4708 | Val  Acc: 0.4364
 Site-White           | Val  Loss: 1.3268 | Val  Acc: 0.4788
 Site-Latino_Hispanic | Val  Loss: 1.4784 | Val  Acc: 0.3273
 Site-Latino_Hispanic | Val  Loss: 1.3975 | Val  Acc: 0.4182
 Site-Black           | Val  Loss: 1.5719 | Val  Acc: 0.3818
 Site-Black           | Val  Loss: 1.5785 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.4582 | Val  Acc: 0.5091
 Site-East_Asian      | Val  Loss: 1.3357 | Val  Acc: 0.5091
 Site-Indian          | Val  Loss: 1.4104 | Val  Acc: 0.4727
 Site-Indian          | Val  Loss: 1.4377 | Val  Acc: 0.4242
 Site-Southeast_Asian | Val  Loss: 1.5241 | Val  Acc: 0.4364
 Site-Southeast_Asian | Val  Loss: 1.4089 | Val  Acc: 0.4848
 Site-Middle_Eastern  | Val  Loss: 1.3779 | Val  Acc: 0.4727
 Site-Middle_Eastern  | Val  Loss: 1.3367 | Val  Acc: 0.4848
Average Valid Accuracy: 0.4442
============ Train epoch 45 ============
 Site-White           | Train Loss: 1.3314 | Train Acc: 0.5000
 Site-White           | Train Loss: 1.3741 | Train Acc: 0.5020
 Site-Latino_Hispanic | Train Loss: 1.5201 | Train Acc: 0.4268
 Site-Latino_Hispanic | Train Loss: 1.3995 | Train Acc: 0.4170
 Site-Black           | Train Loss: 1.5912 | Train Acc: 0.3415
 Site-Black           | Train Loss: 1.4875 | Train Acc: 0.4453
 Site-East_Asian      | Train Loss: 1.3986 | Train Acc: 0.4268
 Site-East_Asian      | Train Loss: 1.3605 | Train Acc: 0.4777
 Site-Indian          | Train Loss: 1.4823 | Train Acc: 0.4634
 Site-Indian          | Train Loss: 1.4488 | Train Acc: 0.4332
 Site-Southeast_Asian | Train Loss: 1.6470 | Train Acc: 0.4268
 Site-Southeast_Asian | Train Loss: 1.4293 | Train Acc: 0.4453
 Site-Middle_Eastern  | Train Loss: 1.3481 | Train Acc: 0.5000
 Site-Middle_Eastern  | Train Loss: 1.2822 | Train Acc: 0.5142
 Site-White           | Val  Loss: 1.4452 | Val  Acc: 0.4545
 Site-White           | Val  Loss: 1.3325 | Val  Acc: 0.4909
 Site-Latino_Hispanic | Val  Loss: 1.4294 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.4042 | Val  Acc: 0.4667
 Site-Black           | Val  Loss: 1.6462 | Val  Acc: 0.4000
 Site-Black           | Val  Loss: 1.5218 | Val  Acc: 0.4667
 Site-East_Asian      | Val  Loss: 1.5001 | Val  Acc: 0.3818
 Site-East_Asian      | Val  Loss: 1.3658 | Val  Acc: 0.4788
 Site-Indian          | Val  Loss: 1.3291 | Val  Acc: 0.4909
 Site-Indian          | Val  Loss: 1.4108 | Val  Acc: 0.4485
 Site-Southeast_Asian | Val  Loss: 1.5472 | Val  Acc: 0.4364
 Site-Southeast_Asian | Val  Loss: 1.3821 | Val  Acc: 0.4970
 Site-Middle_Eastern  | Val  Loss: 1.4110 | Val  Acc: 0.5273
 Site-Middle_Eastern  | Val  Loss: 1.3500 | Val  Acc: 0.4788
Average Valid Accuracy: 0.4584
 Best site-White            | Epoch:45 | Val Acc: 0.4545
 Best site-White            | Epoch:45 | Val Acc: 0.4909
 Best site-Latino_Hispanic  | Epoch:45 | Val Acc: 0.4000
 Best site-Latino_Hispanic  | Epoch:45 | Val Acc: 0.4667
 Best site-Black            | Epoch:45 | Val Acc: 0.4000
 Best site-Black            | Epoch:45 | Val Acc: 0.4667
 Best site-East_Asian       | Epoch:45 | Val Acc: 0.3818
 Best site-East_Asian       | Epoch:45 | Val Acc: 0.4788
 Best site-Indian           | Epoch:45 | Val Acc: 0.4909
 Best site-Indian           | Epoch:45 | Val Acc: 0.4485
 Best site-Southeast_Asian  | Epoch:45 | Val Acc: 0.4364
 Best site-Southeast_Asian  | Epoch:45 | Val Acc: 0.4970
 Best site-Middle_Eastern   | Epoch:45 | Val Acc: 0.5273
 Best site-Middle_Eastern   | Epoch:45 | Val Acc: 0.4788
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 46 ============
 Site-White           | Train Loss: 1.4340 | Train Acc: 0.4146
 Site-White           | Train Loss: 1.3477 | Train Acc: 0.4980
 Site-Latino_Hispanic | Train Loss: 1.5127 | Train Acc: 0.3902
 Site-Latino_Hispanic | Train Loss: 1.4186 | Train Acc: 0.4130
 Site-Black           | Train Loss: 1.4742 | Train Acc: 0.3415
 Site-Black           | Train Loss: 1.4632 | Train Acc: 0.4575
 Site-East_Asian      | Train Loss: 1.4760 | Train Acc: 0.4390
 Site-East_Asian      | Train Loss: 1.3488 | Train Acc: 0.4858
 Site-Indian          | Train Loss: 1.5293 | Train Acc: 0.3780
 Site-Indian          | Train Loss: 1.4418 | Train Acc: 0.4372
 Site-Southeast_Asian | Train Loss: 1.5465 | Train Acc: 0.4512
 Site-Southeast_Asian | Train Loss: 1.4183 | Train Acc: 0.4777
 Site-Middle_Eastern  | Train Loss: 1.3747 | Train Acc: 0.4878
 Site-Middle_Eastern  | Train Loss: 1.2720 | Train Acc: 0.5223
 Site-White           | Val  Loss: 1.4455 | Val  Acc: 0.4000
 Site-White           | Val  Loss: 1.3796 | Val  Acc: 0.4727
 Site-Latino_Hispanic | Val  Loss: 1.4181 | Val  Acc: 0.4000
 Site-Latino_Hispanic | Val  Loss: 1.3984 | Val  Acc: 0.4485
 Site-Black           | Val  Loss: 1.6264 | Val  Acc: 0.3455
 Site-Black           | Val  Loss: 1.5240 | Val  Acc: 0.4545
 Site-East_Asian      | Val  Loss: 1.4966 | Val  Acc: 0.4182
 Site-East_Asian      | Val  Loss: 1.3195 | Val  Acc: 0.4970
 Site-Indian          | Val  Loss: 1.4215 | Val  Acc: 0.4545
 Site-Indian          | Val  Loss: 1.3968 | Val  Acc: 0.4909
 Site-Southeast_Asian | Val  Loss: 1.4958 | Val  Acc: 0.5455
 Site-Southeast_Asian | Val  Loss: 1.4007 | Val  Acc: 0.5030
 Site-Middle_Eastern  | Val  Loss: 1.3687 | Val  Acc: 0.5455
 Site-Middle_Eastern  | Val  Loss: 1.3290 | Val  Acc: 0.5030
Average Valid Accuracy: 0.4628
 Best site-White            | Epoch:46 | Val Acc: 0.4000
 Best site-White            | Epoch:46 | Val Acc: 0.4727
 Best site-Latino_Hispanic  | Epoch:46 | Val Acc: 0.4000
 Best site-Latino_Hispanic  | Epoch:46 | Val Acc: 0.4485
 Best site-Black            | Epoch:46 | Val Acc: 0.3455
 Best site-Black            | Epoch:46 | Val Acc: 0.4545
 Best site-East_Asian       | Epoch:46 | Val Acc: 0.4182
 Best site-East_Asian       | Epoch:46 | Val Acc: 0.4970
 Best site-Indian           | Epoch:46 | Val Acc: 0.4545
 Best site-Indian           | Epoch:46 | Val Acc: 0.4909
 Best site-Southeast_Asian  | Epoch:46 | Val Acc: 0.5455
 Best site-Southeast_Asian  | Epoch:46 | Val Acc: 0.5030
 Best site-Middle_Eastern   | Epoch:46 | Val Acc: 0.5455
 Best site-Middle_Eastern   | Epoch:46 | Val Acc: 0.5030
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 47 ============
 Site-White           | Train Loss: 1.3773 | Train Acc: 0.4634
 Site-White           | Train Loss: 1.3136 | Train Acc: 0.5182
 Site-Latino_Hispanic | Train Loss: 1.7053 | Train Acc: 0.3780
 Site-Latino_Hispanic | Train Loss: 1.4239 | Train Acc: 0.4332
 Site-Black           | Train Loss: 1.5797 | Train Acc: 0.3415
 Site-Black           | Train Loss: 1.5320 | Train Acc: 0.4777
 Site-East_Asian      | Train Loss: 1.5349 | Train Acc: 0.4512
 Site-East_Asian      | Train Loss: 1.3324 | Train Acc: 0.4818
 Site-Indian          | Train Loss: 1.4829 | Train Acc: 0.4024
 Site-Indian          | Train Loss: 1.4130 | Train Acc: 0.4615
 Site-Southeast_Asian | Train Loss: 1.4967 | Train Acc: 0.4756
 Site-Southeast_Asian | Train Loss: 1.3936 | Train Acc: 0.5223
 Site-Middle_Eastern  | Train Loss: 1.3161 | Train Acc: 0.4878
 Site-Middle_Eastern  | Train Loss: 1.2847 | Train Acc: 0.5142
 Site-White           | Val  Loss: 1.4339 | Val  Acc: 0.3636
 Site-White           | Val  Loss: 1.3313 | Val  Acc: 0.5030
 Site-Latino_Hispanic | Val  Loss: 1.4031 | Val  Acc: 0.3636
 Site-Latino_Hispanic | Val  Loss: 1.3823 | Val  Acc: 0.4303
 Site-Black           | Val  Loss: 1.6383 | Val  Acc: 0.3636
 Site-Black           | Val  Loss: 1.5297 | Val  Acc: 0.4121
 Site-East_Asian      | Val  Loss: 1.5619 | Val  Acc: 0.4545
 Site-East_Asian      | Val  Loss: 1.3635 | Val  Acc: 0.4667
 Site-Indian          | Val  Loss: 1.3651 | Val  Acc: 0.4545
 Site-Indian          | Val  Loss: 1.4159 | Val  Acc: 0.4727
 Site-Southeast_Asian | Val  Loss: 1.4541 | Val  Acc: 0.4727
 Site-Southeast_Asian | Val  Loss: 1.3943 | Val  Acc: 0.5030
 Site-Middle_Eastern  | Val  Loss: 1.3568 | Val  Acc: 0.5273
 Site-Middle_Eastern  | Val  Loss: 1.3120 | Val  Acc: 0.5091
Average Valid Accuracy: 0.4498
============ Train epoch 48 ============
 Site-White           | Train Loss: 1.4099 | Train Acc: 0.4268
 Site-White           | Train Loss: 1.3158 | Train Acc: 0.4980
 Site-Latino_Hispanic | Train Loss: 1.5788 | Train Acc: 0.4146
 Site-Latino_Hispanic | Train Loss: 1.3833 | Train Acc: 0.4332
 Site-Black           | Train Loss: 1.5735 | Train Acc: 0.3537
 Site-Black           | Train Loss: 1.4946 | Train Acc: 0.4818
 Site-East_Asian      | Train Loss: 1.3922 | Train Acc: 0.4390
 Site-East_Asian      | Train Loss: 1.3300 | Train Acc: 0.4696
 Site-Indian          | Train Loss: 1.4862 | Train Acc: 0.4390
 Site-Indian          | Train Loss: 1.3945 | Train Acc: 0.4534
 Site-Southeast_Asian | Train Loss: 1.4957 | Train Acc: 0.4634
 Site-Southeast_Asian | Train Loss: 1.4023 | Train Acc: 0.4939
 Site-Middle_Eastern  | Train Loss: 1.3897 | Train Acc: 0.4634
 Site-Middle_Eastern  | Train Loss: 1.2933 | Train Acc: 0.5101
 Site-White           | Val  Loss: 1.4557 | Val  Acc: 0.3818
 Site-White           | Val  Loss: 1.3466 | Val  Acc: 0.4788
 Site-Latino_Hispanic | Val  Loss: 1.4135 | Val  Acc: 0.3636
 Site-Latino_Hispanic | Val  Loss: 1.3711 | Val  Acc: 0.4545
 Site-Black           | Val  Loss: 1.5663 | Val  Acc: 0.4364
 Site-Black           | Val  Loss: 1.5213 | Val  Acc: 0.4424
 Site-East_Asian      | Val  Loss: 1.5306 | Val  Acc: 0.4364
 Site-East_Asian      | Val  Loss: 1.3363 | Val  Acc: 0.5152
 Site-Indian          | Val  Loss: 1.3539 | Val  Acc: 0.4545
 Site-Indian          | Val  Loss: 1.3779 | Val  Acc: 0.4667
 Site-Southeast_Asian | Val  Loss: 1.4779 | Val  Acc: 0.4545
 Site-Southeast_Asian | Val  Loss: 1.4007 | Val  Acc: 0.4970
 Site-Middle_Eastern  | Val  Loss: 1.3150 | Val  Acc: 0.4909
 Site-Middle_Eastern  | Val  Loss: 1.2998 | Val  Acc: 0.5030
Average Valid Accuracy: 0.4554
============ Train epoch 49 ============
 Site-White           | Train Loss: 1.3746 | Train Acc: 0.4512
 Site-White           | Train Loss: 1.3042 | Train Acc: 0.5182
 Site-Latino_Hispanic | Train Loss: 1.6838 | Train Acc: 0.3659
 Site-Latino_Hispanic | Train Loss: 1.3945 | Train Acc: 0.4453
 Site-Black           | Train Loss: 1.5549 | Train Acc: 0.4146
 Site-Black           | Train Loss: 1.4775 | Train Acc: 0.4534
 Site-East_Asian      | Train Loss: 1.5003 | Train Acc: 0.4634
 Site-East_Asian      | Train Loss: 1.3288 | Train Acc: 0.5223
 Site-Indian          | Train Loss: 1.5619 | Train Acc: 0.4634
 Site-Indian          | Train Loss: 1.3927 | Train Acc: 0.4656
 Site-Southeast_Asian | Train Loss: 1.5731 | Train Acc: 0.3659
 Site-Southeast_Asian | Train Loss: 1.3967 | Train Acc: 0.4737
 Site-Middle_Eastern  | Train Loss: 1.4257 | Train Acc: 0.4878
 Site-Middle_Eastern  | Train Loss: 1.2869 | Train Acc: 0.5385
 Site-White           | Val  Loss: 1.3909 | Val  Acc: 0.4727
 Site-White           | Val  Loss: 1.3340 | Val  Acc: 0.4788
 Site-Latino_Hispanic | Val  Loss: 1.3785 | Val  Acc: 0.3818
 Site-Latino_Hispanic | Val  Loss: 1.3744 | Val  Acc: 0.4788
 Site-Black           | Val  Loss: 1.5831 | Val  Acc: 0.3818
 Site-Black           | Val  Loss: 1.5056 | Val  Acc: 0.4242
 Site-East_Asian      | Val  Loss: 1.5156 | Val  Acc: 0.4000
 Site-East_Asian      | Val  Loss: 1.3382 | Val  Acc: 0.4909
 Site-Indian          | Val  Loss: 1.3438 | Val  Acc: 0.4545
 Site-Indian          | Val  Loss: 1.3904 | Val  Acc: 0.4788
 Site-Southeast_Asian | Val  Loss: 1.5356 | Val  Acc: 0.4727
 Site-Southeast_Asian | Val  Loss: 1.3905 | Val  Acc: 0.5212
 Site-Middle_Eastern  | Val  Loss: 1.3908 | Val  Acc: 0.5273
 Site-Middle_Eastern  | Val  Loss: 1.2971 | Val  Acc: 0.4848
Average Valid Accuracy: 0.4606
===2023-05-14 12:02:39===
===2023-05-14 12:02:56===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[82,247,82,247,82,247,82,247,82,247,82,247,82,247,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1100,1100,1100,1100,1100,1100,1100,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
Loading snapshots...
 Test site-White           | Epoch:46 | Test Acc: 0.3727
 Test site-Latino_Hispanic | Epoch:46 | Test Acc: 0.3358
 Test site-Black           | Epoch:46 | Test Acc: 0.3361
 Test site-East_Asian      | Epoch:46 | Test Acc: 0.4523
 Test site-Indian          | Epoch:46 | Test Acc: 0.3219
 Test site-Southeast_Asian | Epoch:46 | Test Acc: 0.4042
 Test site-Middle_Eastern  | Epoch:46 | Test Acc: 0.3755
Average Test Accuracy: 0.3712
===2023-05-24 17:56:26===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[82,247,82,247,82,247,82,247,82,247,82,247,82,247,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1100,1100,1100,1100,1100,1100,1100,]
domain number = 7
============ Train epoch 0 ============
 Site-White                    | Train Loss: 1.9143 | Train Acc: 0.3293
 Site-White                    | Train Loss: 1.8749 | Train Acc: 0.3158
 Site-Latino_Hispanic          | Train Loss: 1.9712 | Train Acc: 0.2439
 Site-Latino_Hispanic          | Train Loss: 1.9204 | Train Acc: 0.2672
 Site-Black                    | Train Loss: 1.8785 | Train Acc: 0.2805
 Site-Black                    | Train Loss: 1.8942 | Train Acc: 0.2632
 Site-East_Asian               | Train Loss: 1.8520 | Train Acc: 0.3780
 Site-East_Asian               | Train Loss: 1.8540 | Train Acc: 0.3320
 Site-Indian                   | Train Loss: 2.1328 | Train Acc: 0.2317
 Site-Indian                   | Train Loss: 2.0765 | Train Acc: 0.2348
 Site-Southeast_Asian          | Train Loss: 2.0399 | Train Acc: 0.3049
 Site-Southeast_Asian          | Train Loss: 2.0348 | Train Acc: 0.2996
 Site-Middle_Eastern           | Train Loss: 1.7979 | Train Acc: 0.3415
 Site-Middle_Eastern           | Train Loss: 1.8038 | Train Acc: 0.3603
 Site-White                         | Val  Loss: 1.8217 | Val  Acc: 0.3455
 Site-White                         | Val  Loss: 1.8510 | Val  Acc: 0.3152
 Site-Latino_Hispanic               | Val  Loss: 1.7838 | Val  Acc: 0.3091
 Site-Latino_Hispanic               | Val  Loss: 1.9136 | Val  Acc: 0.2667
 Site-Black                         | Val  Loss: 2.1109 | Val  Acc: 0.1818
 Site-Black                         | Val  Loss: 1.8337 | Val  Acc: 0.3212
 Site-East_Asian                    | Val  Loss: 1.8857 | Val  Acc: 0.3091
 Site-East_Asian                    | Val  Loss: 1.7950 | Val  Acc: 0.3515
 Site-Indian                        | Val  Loss: 2.1160 | Val  Acc: 0.2364
 Site-Indian                        | Val  Loss: 2.0486 | Val  Acc: 0.2364
 Site-Southeast_Asian               | Val  Loss: 2.1062 | Val  Acc: 0.2909
 Site-Southeast_Asian               | Val  Loss: 2.0243 | Val  Acc: 0.2909
 Site-Middle_Eastern                | Val  Loss: 2.0164 | Val  Acc: 0.3273
 Site-Middle_Eastern                | Val  Loss: 1.8891 | Val  Acc: 0.3212
Average Valid Accuracy: 0.2931
 Best site-White                     | Epoch:0 | Val Acc: 0.3455
 Best site-White                     | Epoch:0 | Val Acc: 0.3152
 Best site-Latino_Hispanic           | Epoch:0 | Val Acc: 0.3091
 Best site-Latino_Hispanic           | Epoch:0 | Val Acc: 0.2667
 Best site-Black                     | Epoch:0 | Val Acc: 0.1818
 Best site-Black                     | Epoch:0 | Val Acc: 0.3212
 Best site-East_Asian                | Epoch:0 | Val Acc: 0.3091
 Best site-East_Asian                | Epoch:0 | Val Acc: 0.3515
 Best site-Indian                    | Epoch:0 | Val Acc: 0.2364
 Best site-Indian                    | Epoch:0 | Val Acc: 0.2364
 Best site-Southeast_Asian           | Epoch:0 | Val Acc: 0.2909
 Best site-Southeast_Asian           | Epoch:0 | Val Acc: 0.2909
 Best site-Middle_Eastern            | Epoch:0 | Val Acc: 0.3273
 Best site-Middle_Eastern            | Epoch:0 | Val Acc: 0.3212
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 1 ============
 Site-White                    | Train Loss: 2.0058 | Train Acc: 0.3049
 Site-White                    | Train Loss: 1.8182 | Train Acc: 0.3239
 Site-Latino_Hispanic          | Train Loss: 1.8592 | Train Acc: 0.2317
 Site-Latino_Hispanic          | Train Loss: 1.8336 | Train Acc: 0.2874
 Site-Black                    | Train Loss: 1.9172 | Train Acc: 0.2561
 Site-Black                    | Train Loss: 1.8297 | Train Acc: 0.2915
 Site-East_Asian               | Train Loss: 1.6739 | Train Acc: 0.4024
 Site-East_Asian               | Train Loss: 1.7834 | Train Acc: 0.3320
 Site-Indian                   | Train Loss: 1.8644 | Train Acc: 0.2195
 Site-Indian                   | Train Loss: 1.9259 | Train Acc: 0.2551
 Site-Southeast_Asian          | Train Loss: 1.9218 | Train Acc: 0.3049
 Site-Southeast_Asian          | Train Loss: 1.9418 | Train Acc: 0.3036
 Site-Middle_Eastern           | Train Loss: 1.8562 | Train Acc: 0.3049
 Site-Middle_Eastern           | Train Loss: 1.7539 | Train Acc: 0.3765
 Site-White                         | Val  Loss: 1.7996 | Val  Acc: 0.3818
 Site-White                         | Val  Loss: 1.7734 | Val  Acc: 0.3636
 Site-Latino_Hispanic               | Val  Loss: 1.7370 | Val  Acc: 0.2909
 Site-Latino_Hispanic               | Val  Loss: 1.8324 | Val  Acc: 0.2545
 Site-Black                         | Val  Loss: 2.0287 | Val  Acc: 0.1636
 Site-Black                         | Val  Loss: 1.8007 | Val  Acc: 0.3091
 Site-East_Asian                    | Val  Loss: 1.8131 | Val  Acc: 0.3455
 Site-East_Asian                    | Val  Loss: 1.7464 | Val  Acc: 0.3758
 Site-Indian                        | Val  Loss: 1.9720 | Val  Acc: 0.2364
 Site-Indian                        | Val  Loss: 1.9277 | Val  Acc: 0.2485
 Site-Southeast_Asian               | Val  Loss: 2.0229 | Val  Acc: 0.2909
 Site-Southeast_Asian               | Val  Loss: 1.9434 | Val  Acc: 0.2970
 Site-Middle_Eastern                | Val  Loss: 1.9183 | Val  Acc: 0.3091
 Site-Middle_Eastern                | Val  Loss: 1.7983 | Val  Acc: 0.3455
Average Valid Accuracy: 0.3009
 Best site-White                     | Epoch:1 | Val Acc: 0.3818
 Best site-White                     | Epoch:1 | Val Acc: 0.3636
 Best site-Latino_Hispanic           | Epoch:1 | Val Acc: 0.2909
 Best site-Latino_Hispanic           | Epoch:1 | Val Acc: 0.2545
 Best site-Black                     | Epoch:1 | Val Acc: 0.1636
 Best site-Black                     | Epoch:1 | Val Acc: 0.3091
 Best site-East_Asian                | Epoch:1 | Val Acc: 0.3455
 Best site-East_Asian                | Epoch:1 | Val Acc: 0.3758
 Best site-Indian                    | Epoch:1 | Val Acc: 0.2364
 Best site-Indian                    | Epoch:1 | Val Acc: 0.2485
 Best site-Southeast_Asian           | Epoch:1 | Val Acc: 0.2909
 Best site-Southeast_Asian           | Epoch:1 | Val Acc: 0.2970
 Best site-Middle_Eastern            | Epoch:1 | Val Acc: 0.3091
 Best site-Middle_Eastern            | Epoch:1 | Val Acc: 0.3455
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 2 ============
 Site-White                    | Train Loss: 1.7982 | Train Acc: 0.3415
 Site-White                    | Train Loss: 1.7181 | Train Acc: 0.3563
 Site-Latino_Hispanic          | Train Loss: 1.7724 | Train Acc: 0.2195
 Site-Latino_Hispanic          | Train Loss: 1.7735 | Train Acc: 0.2915
 Site-Black                    | Train Loss: 1.7382 | Train Acc: 0.2805
 Site-Black                    | Train Loss: 1.8063 | Train Acc: 0.2915
 Site-East_Asian               | Train Loss: 1.5396 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.6912 | Train Acc: 0.3927
 Site-Indian                   | Train Loss: 1.8475 | Train Acc: 0.2683
 Site-Indian                   | Train Loss: 1.8185 | Train Acc: 0.3077
 Site-Southeast_Asian          | Train Loss: 1.8228 | Train Acc: 0.3537
 Site-Southeast_Asian          | Train Loss: 1.8292 | Train Acc: 0.3320
 Site-Middle_Eastern           | Train Loss: 1.8501 | Train Acc: 0.3659
 Site-Middle_Eastern           | Train Loss: 1.6843 | Train Acc: 0.3968
 Site-White                         | Val  Loss: 1.7528 | Val  Acc: 0.3818
 Site-White                         | Val  Loss: 1.6949 | Val  Acc: 0.3394
 Site-Latino_Hispanic               | Val  Loss: 1.6658 | Val  Acc: 0.2909
 Site-Latino_Hispanic               | Val  Loss: 1.7795 | Val  Acc: 0.3030
 Site-Black                         | Val  Loss: 1.9690 | Val  Acc: 0.2182
 Site-Black                         | Val  Loss: 1.7971 | Val  Acc: 0.3333
 Site-East_Asian                    | Val  Loss: 1.7834 | Val  Acc: 0.3455
 Site-East_Asian                    | Val  Loss: 1.6450 | Val  Acc: 0.4182
 Site-Indian                        | Val  Loss: 1.7589 | Val  Acc: 0.4000
 Site-Indian                        | Val  Loss: 1.7883 | Val  Acc: 0.2909
 Site-Southeast_Asian               | Val  Loss: 1.8733 | Val  Acc: 0.4000
 Site-Southeast_Asian               | Val  Loss: 1.7972 | Val  Acc: 0.3939
 Site-Middle_Eastern                | Val  Loss: 1.8285 | Val  Acc: 0.4000
 Site-Middle_Eastern                | Val  Loss: 1.6924 | Val  Acc: 0.4364
Average Valid Accuracy: 0.3537
 Best site-White                     | Epoch:2 | Val Acc: 0.3818
 Best site-White                     | Epoch:2 | Val Acc: 0.3394
 Best site-Latino_Hispanic           | Epoch:2 | Val Acc: 0.2909
 Best site-Latino_Hispanic           | Epoch:2 | Val Acc: 0.3030
 Best site-Black                     | Epoch:2 | Val Acc: 0.2182
 Best site-Black                     | Epoch:2 | Val Acc: 0.3333
 Best site-East_Asian                | Epoch:2 | Val Acc: 0.3455
 Best site-East_Asian                | Epoch:2 | Val Acc: 0.4182
 Best site-Indian                    | Epoch:2 | Val Acc: 0.4000
 Best site-Indian                    | Epoch:2 | Val Acc: 0.2909
 Best site-Southeast_Asian           | Epoch:2 | Val Acc: 0.4000
 Best site-Southeast_Asian           | Epoch:2 | Val Acc: 0.3939
 Best site-Middle_Eastern            | Epoch:2 | Val Acc: 0.4000
 Best site-Middle_Eastern            | Epoch:2 | Val Acc: 0.4364
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 3 ============
 Site-White                    | Train Loss: 1.7202 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.6830 | Train Acc: 0.4089
 Site-Latino_Hispanic          | Train Loss: 1.7885 | Train Acc: 0.2561
 Site-Latino_Hispanic          | Train Loss: 1.7195 | Train Acc: 0.3158
 Site-Black                    | Train Loss: 1.7792 | Train Acc: 0.2927
 Site-Black                    | Train Loss: 1.7728 | Train Acc: 0.3482
 Site-East_Asian               | Train Loss: 1.4747 | Train Acc: 0.4634
 Site-East_Asian               | Train Loss: 1.6087 | Train Acc: 0.3765
 Site-Indian                   | Train Loss: 1.7105 | Train Acc: 0.2561
 Site-Indian                   | Train Loss: 1.7493 | Train Acc: 0.3320
 Site-Southeast_Asian          | Train Loss: 1.9291 | Train Acc: 0.3415
 Site-Southeast_Asian          | Train Loss: 1.7529 | Train Acc: 0.3806
 Site-Middle_Eastern           | Train Loss: 1.6831 | Train Acc: 0.4146
 Site-Middle_Eastern           | Train Loss: 1.6062 | Train Acc: 0.4615
 Site-White                         | Val  Loss: 1.7370 | Val  Acc: 0.3455
 Site-White                         | Val  Loss: 1.6421 | Val  Acc: 0.4121
 Site-Latino_Hispanic               | Val  Loss: 1.6108 | Val  Acc: 0.2909
 Site-Latino_Hispanic               | Val  Loss: 1.7111 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.9137 | Val  Acc: 0.2727
 Site-Black                         | Val  Loss: 1.7582 | Val  Acc: 0.3030
 Site-East_Asian                    | Val  Loss: 1.7928 | Val  Acc: 0.4000
 Site-East_Asian                    | Val  Loss: 1.6056 | Val  Acc: 0.4303
 Site-Indian                        | Val  Loss: 1.6806 | Val  Acc: 0.4182
 Site-Indian                        | Val  Loss: 1.6909 | Val  Acc: 0.3455
 Site-Southeast_Asian               | Val  Loss: 1.7991 | Val  Acc: 0.4000
 Site-Southeast_Asian               | Val  Loss: 1.7380 | Val  Acc: 0.3697
 Site-Middle_Eastern                | Val  Loss: 1.7388 | Val  Acc: 0.4545
 Site-Middle_Eastern                | Val  Loss: 1.6304 | Val  Acc: 0.4303
Average Valid Accuracy: 0.3727
 Best site-White                     | Epoch:3 | Val Acc: 0.3455
 Best site-White                     | Epoch:3 | Val Acc: 0.4121
 Best site-Latino_Hispanic           | Epoch:3 | Val Acc: 0.2909
 Best site-Latino_Hispanic           | Epoch:3 | Val Acc: 0.3455
 Best site-Black                     | Epoch:3 | Val Acc: 0.2727
 Best site-Black                     | Epoch:3 | Val Acc: 0.3030
 Best site-East_Asian                | Epoch:3 | Val Acc: 0.4000
 Best site-East_Asian                | Epoch:3 | Val Acc: 0.4303
 Best site-Indian                    | Epoch:3 | Val Acc: 0.4182
 Best site-Indian                    | Epoch:3 | Val Acc: 0.3455
 Best site-Southeast_Asian           | Epoch:3 | Val Acc: 0.4000
 Best site-Southeast_Asian           | Epoch:3 | Val Acc: 0.3697
 Best site-Middle_Eastern            | Epoch:3 | Val Acc: 0.4545
 Best site-Middle_Eastern            | Epoch:3 | Val Acc: 0.4303
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 4 ============
 Site-White                    | Train Loss: 1.6308 | Train Acc: 0.3415
 Site-White                    | Train Loss: 1.6265 | Train Acc: 0.3806
 Site-Latino_Hispanic          | Train Loss: 1.8780 | Train Acc: 0.2561
 Site-Latino_Hispanic          | Train Loss: 1.6984 | Train Acc: 0.3279
 Site-Black                    | Train Loss: 1.6576 | Train Acc: 0.2927
 Site-Black                    | Train Loss: 1.7131 | Train Acc: 0.3644
 Site-East_Asian               | Train Loss: 1.5002 | Train Acc: 0.5244
 Site-East_Asian               | Train Loss: 1.5694 | Train Acc: 0.4291
 Site-Indian                   | Train Loss: 1.7009 | Train Acc: 0.2683
 Site-Indian                   | Train Loss: 1.6989 | Train Acc: 0.3158
 Site-Southeast_Asian          | Train Loss: 1.7177 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.6830 | Train Acc: 0.4130
 Site-Middle_Eastern           | Train Loss: 1.5480 | Train Acc: 0.3659
 Site-Middle_Eastern           | Train Loss: 1.5475 | Train Acc: 0.4615
 Site-White                         | Val  Loss: 1.6779 | Val  Acc: 0.3455
 Site-White                         | Val  Loss: 1.5661 | Val  Acc: 0.3758
 Site-Latino_Hispanic               | Val  Loss: 1.5785 | Val  Acc: 0.3273
 Site-Latino_Hispanic               | Val  Loss: 1.6751 | Val  Acc: 0.3212
 Site-Black                         | Val  Loss: 1.8285 | Val  Acc: 0.2727
 Site-Black                         | Val  Loss: 1.6907 | Val  Acc: 0.3576
 Site-East_Asian                    | Val  Loss: 1.7677 | Val  Acc: 0.4182
 Site-East_Asian                    | Val  Loss: 1.5378 | Val  Acc: 0.4667
 Site-Indian                        | Val  Loss: 1.6514 | Val  Acc: 0.4000
 Site-Indian                        | Val  Loss: 1.6068 | Val  Acc: 0.3818
 Site-Southeast_Asian               | Val  Loss: 1.7635 | Val  Acc: 0.3818
 Site-Southeast_Asian               | Val  Loss: 1.6933 | Val  Acc: 0.4121
 Site-Middle_Eastern                | Val  Loss: 1.6823 | Val  Acc: 0.4182
 Site-Middle_Eastern                | Val  Loss: 1.5783 | Val  Acc: 0.4485
Average Valid Accuracy: 0.3805
 Best site-White                     | Epoch:4 | Val Acc: 0.3455
 Best site-White                     | Epoch:4 | Val Acc: 0.3758
 Best site-Latino_Hispanic           | Epoch:4 | Val Acc: 0.3273
 Best site-Latino_Hispanic           | Epoch:4 | Val Acc: 0.3212
 Best site-Black                     | Epoch:4 | Val Acc: 0.2727
 Best site-Black                     | Epoch:4 | Val Acc: 0.3576
 Best site-East_Asian                | Epoch:4 | Val Acc: 0.4182
 Best site-East_Asian                | Epoch:4 | Val Acc: 0.4667
 Best site-Indian                    | Epoch:4 | Val Acc: 0.4000
 Best site-Indian                    | Epoch:4 | Val Acc: 0.3818
 Best site-Southeast_Asian           | Epoch:4 | Val Acc: 0.3818
 Best site-Southeast_Asian           | Epoch:4 | Val Acc: 0.4121
 Best site-Middle_Eastern            | Epoch:4 | Val Acc: 0.4182
 Best site-Middle_Eastern            | Epoch:4 | Val Acc: 0.4485
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 5 ============
 Site-White                    | Train Loss: 1.6317 | Train Acc: 0.3780
 Site-White                    | Train Loss: 1.5453 | Train Acc: 0.4049
 Site-Latino_Hispanic          | Train Loss: 1.8601 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.6196 | Train Acc: 0.3360
 Site-Black                    | Train Loss: 1.6730 | Train Acc: 0.2439
 Site-Black                    | Train Loss: 1.6782 | Train Acc: 0.3968
 Site-East_Asian               | Train Loss: 1.5086 | Train Acc: 0.5122
 Site-East_Asian               | Train Loss: 1.5572 | Train Acc: 0.4453
 Site-Indian                   | Train Loss: 1.7759 | Train Acc: 0.3415
 Site-Indian                   | Train Loss: 1.6638 | Train Acc: 0.3522
 Site-Southeast_Asian          | Train Loss: 1.6879 | Train Acc: 0.3902
 Site-Southeast_Asian          | Train Loss: 1.6376 | Train Acc: 0.4170
 Site-Middle_Eastern           | Train Loss: 1.6436 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.4832 | Train Acc: 0.4777
 Site-White                         | Val  Loss: 1.6615 | Val  Acc: 0.3455
 Site-White                         | Val  Loss: 1.5716 | Val  Acc: 0.3879
 Site-Latino_Hispanic               | Val  Loss: 1.5132 | Val  Acc: 0.3455
 Site-Latino_Hispanic               | Val  Loss: 1.6482 | Val  Acc: 0.3333
 Site-Black                         | Val  Loss: 1.8296 | Val  Acc: 0.2727
 Site-Black                         | Val  Loss: 1.6659 | Val  Acc: 0.3636
 Site-East_Asian                    | Val  Loss: 1.7021 | Val  Acc: 0.3636
 Site-East_Asian                    | Val  Loss: 1.4855 | Val  Acc: 0.4727
 Site-Indian                        | Val  Loss: 1.5839 | Val  Acc: 0.4182
 Site-Indian                        | Val  Loss: 1.5847 | Val  Acc: 0.3576
 Site-Southeast_Asian               | Val  Loss: 1.7192 | Val  Acc: 0.4000
 Site-Southeast_Asian               | Val  Loss: 1.6224 | Val  Acc: 0.4303
 Site-Middle_Eastern                | Val  Loss: 1.6435 | Val  Acc: 0.3818
 Site-Middle_Eastern                | Val  Loss: 1.5236 | Val  Acc: 0.4364
Average Valid Accuracy: 0.3792
============ Train epoch 6 ============
 Site-White                    | Train Loss: 1.5589 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.5393 | Train Acc: 0.3968
 Site-Latino_Hispanic          | Train Loss: 1.7720 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.6091 | Train Acc: 0.3725
 Site-Black                    | Train Loss: 1.7237 | Train Acc: 0.2805
 Site-Black                    | Train Loss: 1.6502 | Train Acc: 0.4130
 Site-East_Asian               | Train Loss: 1.3787 | Train Acc: 0.5000
 Site-East_Asian               | Train Loss: 1.5327 | Train Acc: 0.4211
 Site-Indian                   | Train Loss: 1.6878 | Train Acc: 0.3171
 Site-Indian                   | Train Loss: 1.6108 | Train Acc: 0.3927
 Site-Southeast_Asian          | Train Loss: 1.5195 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.6483 | Train Acc: 0.4130
 Site-Middle_Eastern           | Train Loss: 1.4335 | Train Acc: 0.4146
 Site-Middle_Eastern           | Train Loss: 1.4523 | Train Acc: 0.4737
 Site-White                         | Val  Loss: 1.6462 | Val  Acc: 0.3636
 Site-White                         | Val  Loss: 1.5257 | Val  Acc: 0.4000
 Site-Latino_Hispanic               | Val  Loss: 1.4021 | Val  Acc: 0.4182
 Site-Latino_Hispanic               | Val  Loss: 1.5954 | Val  Acc: 0.3636
 Site-Black                         | Val  Loss: 1.7695 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.6413 | Val  Acc: 0.3758
 Site-East_Asian                    | Val  Loss: 1.6926 | Val  Acc: 0.4000
 Site-East_Asian                    | Val  Loss: 1.4983 | Val  Acc: 0.4667
 Site-Indian                        | Val  Loss: 1.5694 | Val  Acc: 0.4182
 Site-Indian                        | Val  Loss: 1.5632 | Val  Acc: 0.3758
 Site-Southeast_Asian               | Val  Loss: 1.7356 | Val  Acc: 0.3636
 Site-Southeast_Asian               | Val  Loss: 1.6067 | Val  Acc: 0.4182
 Site-Middle_Eastern                | Val  Loss: 1.5797 | Val  Acc: 0.4545
 Site-Middle_Eastern                | Val  Loss: 1.4932 | Val  Acc: 0.4667
Average Valid Accuracy: 0.4022
 Best site-White                     | Epoch:6 | Val Acc: 0.3636
 Best site-White                     | Epoch:6 | Val Acc: 0.4000
 Best site-Latino_Hispanic           | Epoch:6 | Val Acc: 0.4182
 Best site-Latino_Hispanic           | Epoch:6 | Val Acc: 0.3636
 Best site-Black                     | Epoch:6 | Val Acc: 0.3455
 Best site-Black                     | Epoch:6 | Val Acc: 0.3758
 Best site-East_Asian                | Epoch:6 | Val Acc: 0.4000
 Best site-East_Asian                | Epoch:6 | Val Acc: 0.4667
 Best site-Indian                    | Epoch:6 | Val Acc: 0.4182
 Best site-Indian                    | Epoch:6 | Val Acc: 0.3758
 Best site-Southeast_Asian           | Epoch:6 | Val Acc: 0.3636
 Best site-Southeast_Asian           | Epoch:6 | Val Acc: 0.4182
 Best site-Middle_Eastern            | Epoch:6 | Val Acc: 0.4545
 Best site-Middle_Eastern            | Epoch:6 | Val Acc: 0.4667
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 7 ============
 Site-White                    | Train Loss: 1.6281 | Train Acc: 0.3780
 Site-White                    | Train Loss: 1.5107 | Train Acc: 0.4615
 Site-Latino_Hispanic          | Train Loss: 1.6736 | Train Acc: 0.2805
 Site-Latino_Hispanic          | Train Loss: 1.5769 | Train Acc: 0.3806
 Site-Black                    | Train Loss: 1.6226 | Train Acc: 0.3415
 Site-Black                    | Train Loss: 1.6499 | Train Acc: 0.4008
 Site-East_Asian               | Train Loss: 1.3483 | Train Acc: 0.5244
 Site-East_Asian               | Train Loss: 1.4862 | Train Acc: 0.4575
 Site-Indian                   | Train Loss: 1.6438 | Train Acc: 0.3171
 Site-Indian                   | Train Loss: 1.5942 | Train Acc: 0.3887
 Site-Southeast_Asian          | Train Loss: 1.6612 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.5821 | Train Acc: 0.4413
 Site-Middle_Eastern           | Train Loss: 1.4767 | Train Acc: 0.4390
 Site-Middle_Eastern           | Train Loss: 1.4549 | Train Acc: 0.4656
 Site-White                         | Val  Loss: 1.5891 | Val  Acc: 0.3636
 Site-White                         | Val  Loss: 1.4657 | Val  Acc: 0.4242
 Site-Latino_Hispanic               | Val  Loss: 1.4511 | Val  Acc: 0.3455
 Site-Latino_Hispanic               | Val  Loss: 1.6124 | Val  Acc: 0.3697
 Site-Black                         | Val  Loss: 1.7624 | Val  Acc: 0.3091
 Site-Black                         | Val  Loss: 1.6365 | Val  Acc: 0.4242
 Site-East_Asian                    | Val  Loss: 1.6987 | Val  Acc: 0.4000
 Site-East_Asian                    | Val  Loss: 1.4523 | Val  Acc: 0.4788
 Site-Indian                        | Val  Loss: 1.6147 | Val  Acc: 0.4000
 Site-Indian                        | Val  Loss: 1.5589 | Val  Acc: 0.3818
 Site-Southeast_Asian               | Val  Loss: 1.7036 | Val  Acc: 0.4182
 Site-Southeast_Asian               | Val  Loss: 1.5923 | Val  Acc: 0.4182
 Site-Middle_Eastern                | Val  Loss: 1.6094 | Val  Acc: 0.4182
 Site-Middle_Eastern                | Val  Loss: 1.4705 | Val  Acc: 0.4303
Average Valid Accuracy: 0.3987
============ Train epoch 8 ============
 Site-White                    | Train Loss: 1.4383 | Train Acc: 0.3902
 Site-White                    | Train Loss: 1.5061 | Train Acc: 0.4453
 Site-Latino_Hispanic          | Train Loss: 1.6336 | Train Acc: 0.3293
 Site-Latino_Hispanic          | Train Loss: 1.5341 | Train Acc: 0.3684
 Site-Black                    | Train Loss: 1.6618 | Train Acc: 0.3537
 Site-Black                    | Train Loss: 1.6222 | Train Acc: 0.4049
 Site-East_Asian               | Train Loss: 1.3815 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.4927 | Train Acc: 0.4494
 Site-Indian                   | Train Loss: 1.6348 | Train Acc: 0.3537
 Site-Indian                   | Train Loss: 1.5566 | Train Acc: 0.3968
 Site-Southeast_Asian          | Train Loss: 1.7223 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.5661 | Train Acc: 0.4453
 Site-Middle_Eastern           | Train Loss: 1.5732 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.4448 | Train Acc: 0.4615
 Site-White                         | Val  Loss: 1.5689 | Val  Acc: 0.3818
 Site-White                         | Val  Loss: 1.4913 | Val  Acc: 0.4121
 Site-Latino_Hispanic               | Val  Loss: 1.4549 | Val  Acc: 0.3455
 Site-Latino_Hispanic               | Val  Loss: 1.5628 | Val  Acc: 0.3273
 Site-Black                         | Val  Loss: 1.7677 | Val  Acc: 0.3636
 Site-Black                         | Val  Loss: 1.6547 | Val  Acc: 0.3879
 Site-East_Asian                    | Val  Loss: 1.6694 | Val  Acc: 0.3818
 Site-East_Asian                    | Val  Loss: 1.4801 | Val  Acc: 0.4424
 Site-Indian                        | Val  Loss: 1.4876 | Val  Acc: 0.4000
 Site-Indian                        | Val  Loss: 1.5275 | Val  Acc: 0.4182
 Site-Southeast_Asian               | Val  Loss: 1.6206 | Val  Acc: 0.3818
 Site-Southeast_Asian               | Val  Loss: 1.5558 | Val  Acc: 0.4303
 Site-Middle_Eastern                | Val  Loss: 1.5942 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.4600 | Val  Acc: 0.4485
Average Valid Accuracy: 0.3996
============ Train epoch 9 ============
 Site-White                    | Train Loss: 1.4283 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.4570 | Train Acc: 0.4413
 Site-Latino_Hispanic          | Train Loss: 1.5900 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.5220 | Train Acc: 0.3887
 Site-Black                    | Train Loss: 1.6470 | Train Acc: 0.3537
 Site-Black                    | Train Loss: 1.6299 | Train Acc: 0.4049
 Site-East_Asian               | Train Loss: 1.4302 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.5141 | Train Acc: 0.4211
 Site-Indian                   | Train Loss: 1.5719 | Train Acc: 0.3537
 Site-Indian                   | Train Loss: 1.5446 | Train Acc: 0.3765
 Site-Southeast_Asian          | Train Loss: 1.4950 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.5448 | Train Acc: 0.4251
 Site-Middle_Eastern           | Train Loss: 1.5142 | Train Acc: 0.4390
 Site-Middle_Eastern           | Train Loss: 1.4244 | Train Acc: 0.4818
 Site-White                         | Val  Loss: 1.5458 | Val  Acc: 0.3455
 Site-White                         | Val  Loss: 1.4767 | Val  Acc: 0.4303
 Site-Latino_Hispanic               | Val  Loss: 1.4504 | Val  Acc: 0.3636
 Site-Latino_Hispanic               | Val  Loss: 1.5634 | Val  Acc: 0.3818
 Site-Black                         | Val  Loss: 1.7625 | Val  Acc: 0.2364
 Site-Black                         | Val  Loss: 1.6055 | Val  Acc: 0.4061
 Site-East_Asian                    | Val  Loss: 1.6752 | Val  Acc: 0.4182
 Site-East_Asian                    | Val  Loss: 1.4530 | Val  Acc: 0.4909
 Site-Indian                        | Val  Loss: 1.4977 | Val  Acc: 0.4364
 Site-Indian                        | Val  Loss: 1.5068 | Val  Acc: 0.4182
 Site-Southeast_Asian               | Val  Loss: 1.5698 | Val  Acc: 0.4727
 Site-Southeast_Asian               | Val  Loss: 1.5288 | Val  Acc: 0.4303
 Site-Middle_Eastern                | Val  Loss: 1.5209 | Val  Acc: 0.4909
 Site-Middle_Eastern                | Val  Loss: 1.4176 | Val  Acc: 0.4788
Average Valid Accuracy: 0.4143
 Best site-White                     | Epoch:9 | Val Acc: 0.3455
 Best site-White                     | Epoch:9 | Val Acc: 0.4303
 Best site-Latino_Hispanic           | Epoch:9 | Val Acc: 0.3636
 Best site-Latino_Hispanic           | Epoch:9 | Val Acc: 0.3818
 Best site-Black                     | Epoch:9 | Val Acc: 0.2364
 Best site-Black                     | Epoch:9 | Val Acc: 0.4061
 Best site-East_Asian                | Epoch:9 | Val Acc: 0.4182
 Best site-East_Asian                | Epoch:9 | Val Acc: 0.4909
 Best site-Indian                    | Epoch:9 | Val Acc: 0.4364
 Best site-Indian                    | Epoch:9 | Val Acc: 0.4182
 Best site-Southeast_Asian           | Epoch:9 | Val Acc: 0.4727
 Best site-Southeast_Asian           | Epoch:9 | Val Acc: 0.4303
 Best site-Middle_Eastern            | Epoch:9 | Val Acc: 0.4909
 Best site-Middle_Eastern            | Epoch:9 | Val Acc: 0.4788
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
 Test site-White                    | Epoch:9 | Test Acc: 0.3650
 Test site-Latino_Hispanic          | Epoch:9 | Test Acc: 0.3420
 Test site-Black                    | Epoch:9 | Test Acc: 0.3361
 Test site-East_Asian               | Epoch:9 | Test Acc: 0.4639
 Test site-Indian                   | Epoch:9 | Test Acc: 0.3259
 Test site-Southeast_Asian          | Epoch:9 | Test Acc: 0.3922
 Test site-Middle_Eastern           | Epoch:9 | Test Acc: 0.3466
Average Test Accuracy: 0.3674, domain std=0.0443, individual std=0.0443
============ Train epoch 10 ============
 Site-White                    | Train Loss: 1.4905 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.4285 | Train Acc: 0.4858
 Site-Latino_Hispanic          | Train Loss: 1.6757 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.5226 | Train Acc: 0.3887
 Site-Black                    | Train Loss: 1.5779 | Train Acc: 0.4024
 Site-Black                    | Train Loss: 1.6438 | Train Acc: 0.3887
 Site-East_Asian               | Train Loss: 1.3308 | Train Acc: 0.4878
 Site-East_Asian               | Train Loss: 1.4458 | Train Acc: 0.4494
 Site-Indian                   | Train Loss: 1.6220 | Train Acc: 0.3780
 Site-Indian                   | Train Loss: 1.5343 | Train Acc: 0.4008
 Site-Southeast_Asian          | Train Loss: 1.5968 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.5338 | Train Acc: 0.4656
 Site-Middle_Eastern           | Train Loss: 1.6251 | Train Acc: 0.4146
 Site-Middle_Eastern           | Train Loss: 1.3647 | Train Acc: 0.4939
 Site-White                         | Val  Loss: 1.4722 | Val  Acc: 0.4000
 Site-White                         | Val  Loss: 1.4308 | Val  Acc: 0.4182
 Site-Latino_Hispanic               | Val  Loss: 1.3965 | Val  Acc: 0.3636
 Site-Latino_Hispanic               | Val  Loss: 1.5391 | Val  Acc: 0.3515
 Site-Black                         | Val  Loss: 1.7667 | Val  Acc: 0.3273
 Site-Black                         | Val  Loss: 1.6417 | Val  Acc: 0.3636
 Site-East_Asian                    | Val  Loss: 1.7595 | Val  Acc: 0.4182
 Site-East_Asian                    | Val  Loss: 1.4397 | Val  Acc: 0.5030
 Site-Indian                        | Val  Loss: 1.5015 | Val  Acc: 0.4182
 Site-Indian                        | Val  Loss: 1.4835 | Val  Acc: 0.3939
 Site-Southeast_Asian               | Val  Loss: 1.6884 | Val  Acc: 0.4545
 Site-Southeast_Asian               | Val  Loss: 1.4996 | Val  Acc: 0.4182
 Site-Middle_Eastern                | Val  Loss: 1.5440 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.4153 | Val  Acc: 0.4606
Average Valid Accuracy: 0.4117
============ Train epoch 11 ============
 Site-White                    | Train Loss: 1.5219 | Train Acc: 0.3537
 Site-White                    | Train Loss: 1.4400 | Train Acc: 0.4372
 Site-Latino_Hispanic          | Train Loss: 1.6812 | Train Acc: 0.3293
 Site-Latino_Hispanic          | Train Loss: 1.5063 | Train Acc: 0.3927
 Site-Black                    | Train Loss: 1.5581 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.5972 | Train Acc: 0.4130
 Site-East_Asian               | Train Loss: 1.4627 | Train Acc: 0.4878
 Site-East_Asian               | Train Loss: 1.4568 | Train Acc: 0.4899
 Site-Indian                   | Train Loss: 1.4448 | Train Acc: 0.4146
 Site-Indian                   | Train Loss: 1.5057 | Train Acc: 0.4291
 Site-Southeast_Asian          | Train Loss: 1.6079 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.4912 | Train Acc: 0.4656
 Site-Middle_Eastern           | Train Loss: 1.5803 | Train Acc: 0.4268
 Site-Middle_Eastern           | Train Loss: 1.3877 | Train Acc: 0.5061
 Site-White                         | Val  Loss: 1.4865 | Val  Acc: 0.4364
 Site-White                         | Val  Loss: 1.3933 | Val  Acc: 0.4667
 Site-Latino_Hispanic               | Val  Loss: 1.3339 | Val  Acc: 0.4182
 Site-Latino_Hispanic               | Val  Loss: 1.5079 | Val  Acc: 0.4121
 Site-Black                         | Val  Loss: 1.7821 | Val  Acc: 0.3091
 Site-Black                         | Val  Loss: 1.5768 | Val  Acc: 0.4364
 Site-East_Asian                    | Val  Loss: 1.6192 | Val  Acc: 0.4545
 Site-East_Asian                    | Val  Loss: 1.4053 | Val  Acc: 0.5030
 Site-Indian                        | Val  Loss: 1.4590 | Val  Acc: 0.4000
 Site-Indian                        | Val  Loss: 1.4612 | Val  Acc: 0.3939
 Site-Southeast_Asian               | Val  Loss: 1.5285 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.4919 | Val  Acc: 0.4970
 Site-Middle_Eastern                | Val  Loss: 1.4354 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.4042 | Val  Acc: 0.4485
Average Valid Accuracy: 0.4385
 Best site-White                     | Epoch:11 | Val Acc: 0.4364
 Best site-White                     | Epoch:11 | Val Acc: 0.4667
 Best site-Latino_Hispanic           | Epoch:11 | Val Acc: 0.4182
 Best site-Latino_Hispanic           | Epoch:11 | Val Acc: 0.4121
 Best site-Black                     | Epoch:11 | Val Acc: 0.3091
 Best site-Black                     | Epoch:11 | Val Acc: 0.4364
 Best site-East_Asian                | Epoch:11 | Val Acc: 0.4545
 Best site-East_Asian                | Epoch:11 | Val Acc: 0.5030
 Best site-Indian                    | Epoch:11 | Val Acc: 0.4000
 Best site-Indian                    | Epoch:11 | Val Acc: 0.3939
 Best site-Southeast_Asian           | Epoch:11 | Val Acc: 0.4909
 Best site-Southeast_Asian           | Epoch:11 | Val Acc: 0.4970
 Best site-Middle_Eastern            | Epoch:11 | Val Acc: 0.4727
 Best site-Middle_Eastern            | Epoch:11 | Val Acc: 0.4485
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 12 ============
 Site-White                    | Train Loss: 1.4463 | Train Acc: 0.3780
 Site-White                    | Train Loss: 1.4283 | Train Acc: 0.4696
 Site-Latino_Hispanic          | Train Loss: 1.6392 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.4905 | Train Acc: 0.4089
 Site-Black                    | Train Loss: 1.6295 | Train Acc: 0.3415
 Site-Black                    | Train Loss: 1.5917 | Train Acc: 0.4211
 Site-East_Asian               | Train Loss: 1.4665 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.4347 | Train Acc: 0.4413
 Site-Indian                   | Train Loss: 1.4924 | Train Acc: 0.3902
 Site-Indian                   | Train Loss: 1.5066 | Train Acc: 0.4089
 Site-Southeast_Asian          | Train Loss: 1.4374 | Train Acc: 0.5122
 Site-Southeast_Asian          | Train Loss: 1.5313 | Train Acc: 0.4413
 Site-Middle_Eastern           | Train Loss: 1.5246 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.3975 | Train Acc: 0.4453
 Site-White                         | Val  Loss: 1.4529 | Val  Acc: 0.4364
 Site-White                         | Val  Loss: 1.3833 | Val  Acc: 0.4545
 Site-Latino_Hispanic               | Val  Loss: 1.3996 | Val  Acc: 0.3636
 Site-Latino_Hispanic               | Val  Loss: 1.5143 | Val  Acc: 0.3758
 Site-Black                         | Val  Loss: 1.7312 | Val  Acc: 0.3273
 Site-Black                         | Val  Loss: 1.5910 | Val  Acc: 0.3636
 Site-East_Asian                    | Val  Loss: 1.6548 | Val  Acc: 0.4727
 Site-East_Asian                    | Val  Loss: 1.4072 | Val  Acc: 0.5091
 Site-Indian                        | Val  Loss: 1.4519 | Val  Acc: 0.4000
 Site-Indian                        | Val  Loss: 1.4530 | Val  Acc: 0.4424
 Site-Southeast_Asian               | Val  Loss: 1.6047 | Val  Acc: 0.4182
 Site-Southeast_Asian               | Val  Loss: 1.5042 | Val  Acc: 0.4424
 Site-Middle_Eastern                | Val  Loss: 1.4915 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.3868 | Val  Acc: 0.4667
Average Valid Accuracy: 0.4247
============ Train epoch 13 ============
 Site-White                    | Train Loss: 1.4384 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.4007 | Train Acc: 0.4818
 Site-Latino_Hispanic          | Train Loss: 1.9059 | Train Acc: 0.3293
 Site-Latino_Hispanic          | Train Loss: 1.4898 | Train Acc: 0.3725
 Site-Black                    | Train Loss: 1.6014 | Train Acc: 0.3293
 Site-Black                    | Train Loss: 1.5989 | Train Acc: 0.3927
 Site-East_Asian               | Train Loss: 1.3391 | Train Acc: 0.5000
 Site-East_Asian               | Train Loss: 1.4326 | Train Acc: 0.4615
 Site-Indian                   | Train Loss: 1.5167 | Train Acc: 0.3902
 Site-Indian                   | Train Loss: 1.5037 | Train Acc: 0.4332
 Site-Southeast_Asian          | Train Loss: 1.6115 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.4473 | Train Acc: 0.4737
 Site-Middle_Eastern           | Train Loss: 1.4296 | Train Acc: 0.4268
 Site-Middle_Eastern           | Train Loss: 1.3702 | Train Acc: 0.5223
 Site-White                         | Val  Loss: 1.4842 | Val  Acc: 0.4727
 Site-White                         | Val  Loss: 1.4140 | Val  Acc: 0.4182
 Site-Latino_Hispanic               | Val  Loss: 1.3345 | Val  Acc: 0.3636
 Site-Latino_Hispanic               | Val  Loss: 1.5163 | Val  Acc: 0.3758
 Site-Black                         | Val  Loss: 1.6862 | Val  Acc: 0.4182
 Site-Black                         | Val  Loss: 1.5975 | Val  Acc: 0.3818
 Site-East_Asian                    | Val  Loss: 1.7179 | Val  Acc: 0.4364
 Site-East_Asian                    | Val  Loss: 1.3604 | Val  Acc: 0.5091
 Site-Indian                        | Val  Loss: 1.4793 | Val  Acc: 0.4545
 Site-Indian                        | Val  Loss: 1.4189 | Val  Acc: 0.4545
 Site-Southeast_Asian               | Val  Loss: 1.5015 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.4674 | Val  Acc: 0.5091
 Site-Middle_Eastern                | Val  Loss: 1.4405 | Val  Acc: 0.5273
 Site-Middle_Eastern                | Val  Loss: 1.3658 | Val  Acc: 0.5030
Average Valid Accuracy: 0.4511
 Best site-White                     | Epoch:13 | Val Acc: 0.4727
 Best site-White                     | Epoch:13 | Val Acc: 0.4182
 Best site-Latino_Hispanic           | Epoch:13 | Val Acc: 0.3636
 Best site-Latino_Hispanic           | Epoch:13 | Val Acc: 0.3758
 Best site-Black                     | Epoch:13 | Val Acc: 0.4182
 Best site-Black                     | Epoch:13 | Val Acc: 0.3818
 Best site-East_Asian                | Epoch:13 | Val Acc: 0.4364
 Best site-East_Asian                | Epoch:13 | Val Acc: 0.5091
 Best site-Indian                    | Epoch:13 | Val Acc: 0.4545
 Best site-Indian                    | Epoch:13 | Val Acc: 0.4545
 Best site-Southeast_Asian           | Epoch:13 | Val Acc: 0.4909
 Best site-Southeast_Asian           | Epoch:13 | Val Acc: 0.5091
 Best site-Middle_Eastern            | Epoch:13 | Val Acc: 0.5273
 Best site-Middle_Eastern            | Epoch:13 | Val Acc: 0.5030
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 14 ============
 Site-White                    | Train Loss: 1.4167 | Train Acc: 0.4634
 Site-White                    | Train Loss: 1.3836 | Train Acc: 0.4818
 Site-Latino_Hispanic          | Train Loss: 1.7513 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.4507 | Train Acc: 0.3927
 Site-Black                    | Train Loss: 1.4437 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.5782 | Train Acc: 0.4170
 Site-East_Asian               | Train Loss: 1.3855 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.4094 | Train Acc: 0.4575
 Site-Indian                   | Train Loss: 1.5153 | Train Acc: 0.3780
 Site-Indian                   | Train Loss: 1.4879 | Train Acc: 0.4049
 Site-Southeast_Asian          | Train Loss: 1.7374 | Train Acc: 0.3902
 Site-Southeast_Asian          | Train Loss: 1.5120 | Train Acc: 0.4453
 Site-Middle_Eastern           | Train Loss: 1.5537 | Train Acc: 0.5000
 Site-Middle_Eastern           | Train Loss: 1.3787 | Train Acc: 0.4818
 Site-White                         | Val  Loss: 1.4219 | Val  Acc: 0.3818
 Site-White                         | Val  Loss: 1.3634 | Val  Acc: 0.4606
 Site-Latino_Hispanic               | Val  Loss: 1.3814 | Val  Acc: 0.3636
 Site-Latino_Hispanic               | Val  Loss: 1.4773 | Val  Acc: 0.4182
 Site-Black                         | Val  Loss: 1.6791 | Val  Acc: 0.3091
 Site-Black                         | Val  Loss: 1.5566 | Val  Acc: 0.4424
 Site-East_Asian                    | Val  Loss: 1.6052 | Val  Acc: 0.4727
 Site-East_Asian                    | Val  Loss: 1.4113 | Val  Acc: 0.5030
 Site-Indian                        | Val  Loss: 1.4528 | Val  Acc: 0.4909
 Site-Indian                        | Val  Loss: 1.4312 | Val  Acc: 0.4424
 Site-Southeast_Asian               | Val  Loss: 1.4975 | Val  Acc: 0.4545
 Site-Southeast_Asian               | Val  Loss: 1.4754 | Val  Acc: 0.4788
 Site-Middle_Eastern                | Val  Loss: 1.4990 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.3565 | Val  Acc: 0.4727
Average Valid Accuracy: 0.4403
============ Train epoch 15 ============
 Site-White                    | Train Loss: 1.6115 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.3666 | Train Acc: 0.5061
 Site-Latino_Hispanic          | Train Loss: 1.5658 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.4296 | Train Acc: 0.4049
 Site-Black                    | Train Loss: 1.5451 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.5185 | Train Acc: 0.4413
 Site-East_Asian               | Train Loss: 1.4064 | Train Acc: 0.4268
 Site-East_Asian               | Train Loss: 1.4244 | Train Acc: 0.4818
 Site-Indian                   | Train Loss: 1.4071 | Train Acc: 0.3780
 Site-Indian                   | Train Loss: 1.4870 | Train Acc: 0.4130
 Site-Southeast_Asian          | Train Loss: 1.6410 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.4785 | Train Acc: 0.4656
 Site-Middle_Eastern           | Train Loss: 1.5975 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.3441 | Train Acc: 0.4737
 Site-White                         | Val  Loss: 1.4389 | Val  Acc: 0.4182
 Site-White                         | Val  Loss: 1.3729 | Val  Acc: 0.4424
 Site-Latino_Hispanic               | Val  Loss: 1.3493 | Val  Acc: 0.3818
 Site-Latino_Hispanic               | Val  Loss: 1.4533 | Val  Acc: 0.4303
 Site-Black                         | Val  Loss: 1.7318 | Val  Acc: 0.3818
 Site-Black                         | Val  Loss: 1.5291 | Val  Acc: 0.4364
 Site-East_Asian                    | Val  Loss: 1.5886 | Val  Acc: 0.4545
 Site-East_Asian                    | Val  Loss: 1.3938 | Val  Acc: 0.4970
 Site-Indian                        | Val  Loss: 1.3837 | Val  Acc: 0.4727
 Site-Indian                        | Val  Loss: 1.4346 | Val  Acc: 0.4364
 Site-Southeast_Asian               | Val  Loss: 1.4168 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.4682 | Val  Acc: 0.4848
 Site-Middle_Eastern                | Val  Loss: 1.4180 | Val  Acc: 0.5455
 Site-Middle_Eastern                | Val  Loss: 1.3481 | Val  Acc: 0.4909
Average Valid Accuracy: 0.4558
 Best site-White                     | Epoch:15 | Val Acc: 0.4182
 Best site-White                     | Epoch:15 | Val Acc: 0.4424
 Best site-Latino_Hispanic           | Epoch:15 | Val Acc: 0.3818
 Best site-Latino_Hispanic           | Epoch:15 | Val Acc: 0.4303
 Best site-Black                     | Epoch:15 | Val Acc: 0.3818
 Best site-Black                     | Epoch:15 | Val Acc: 0.4364
 Best site-East_Asian                | Epoch:15 | Val Acc: 0.4545
 Best site-East_Asian                | Epoch:15 | Val Acc: 0.4970
 Best site-Indian                    | Epoch:15 | Val Acc: 0.4727
 Best site-Indian                    | Epoch:15 | Val Acc: 0.4364
 Best site-Southeast_Asian           | Epoch:15 | Val Acc: 0.5091
 Best site-Southeast_Asian           | Epoch:15 | Val Acc: 0.4848
 Best site-Middle_Eastern            | Epoch:15 | Val Acc: 0.5455
 Best site-Middle_Eastern            | Epoch:15 | Val Acc: 0.4909
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 16 ============
 Site-White                    | Train Loss: 1.4070 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.3563 | Train Acc: 0.4777
 Site-Latino_Hispanic          | Train Loss: 1.6140 | Train Acc: 0.3049
 Site-Latino_Hispanic          | Train Loss: 1.4568 | Train Acc: 0.4089
 Site-Black                    | Train Loss: 1.5398 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.4942 | Train Acc: 0.4453
 Site-East_Asian               | Train Loss: 1.3509 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.3743 | Train Acc: 0.4899
 Site-Indian                   | Train Loss: 1.4650 | Train Acc: 0.3780
 Site-Indian                   | Train Loss: 1.4639 | Train Acc: 0.4494
 Site-Southeast_Asian          | Train Loss: 1.5452 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.4376 | Train Acc: 0.4858
 Site-Middle_Eastern           | Train Loss: 1.5625 | Train Acc: 0.4390
 Site-Middle_Eastern           | Train Loss: 1.2940 | Train Acc: 0.5020
 Site-White                         | Val  Loss: 1.4139 | Val  Acc: 0.4364
 Site-White                         | Val  Loss: 1.3083 | Val  Acc: 0.5515
 Site-Latino_Hispanic               | Val  Loss: 1.3393 | Val  Acc: 0.4000
 Site-Latino_Hispanic               | Val  Loss: 1.4518 | Val  Acc: 0.3879
 Site-Black                         | Val  Loss: 1.6210 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.5754 | Val  Acc: 0.4061
 Site-East_Asian                    | Val  Loss: 1.6089 | Val  Acc: 0.4545
 Site-East_Asian                    | Val  Loss: 1.3430 | Val  Acc: 0.5152
 Site-Indian                        | Val  Loss: 1.4073 | Val  Acc: 0.4727
 Site-Indian                        | Val  Loss: 1.4011 | Val  Acc: 0.3939
 Site-Southeast_Asian               | Val  Loss: 1.5753 | Val  Acc: 0.4364
 Site-Southeast_Asian               | Val  Loss: 1.4295 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.4640 | Val  Acc: 0.4364
 Site-Middle_Eastern                | Val  Loss: 1.3463 | Val  Acc: 0.4848
Average Valid Accuracy: 0.4424
============ Train epoch 17 ============
 Site-White                    | Train Loss: 1.5882 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.3463 | Train Acc: 0.5223
 Site-Latino_Hispanic          | Train Loss: 1.6773 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.4336 | Train Acc: 0.4251
 Site-Black                    | Train Loss: 1.5861 | Train Acc: 0.2927
 Site-Black                    | Train Loss: 1.5403 | Train Acc: 0.3684
 Site-East_Asian               | Train Loss: 1.4085 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.3967 | Train Acc: 0.4858
 Site-Indian                   | Train Loss: 1.6328 | Train Acc: 0.3902
 Site-Indian                   | Train Loss: 1.4366 | Train Acc: 0.4615
 Site-Southeast_Asian          | Train Loss: 1.4265 | Train Acc: 0.4756
 Site-Southeast_Asian          | Train Loss: 1.4137 | Train Acc: 0.4939
 Site-Middle_Eastern           | Train Loss: 1.3954 | Train Acc: 0.4756
 Site-Middle_Eastern           | Train Loss: 1.2855 | Train Acc: 0.5101
 Site-White                         | Val  Loss: 1.4137 | Val  Acc: 0.4545
 Site-White                         | Val  Loss: 1.3648 | Val  Acc: 0.4848
 Site-Latino_Hispanic               | Val  Loss: 1.3678 | Val  Acc: 0.3455
 Site-Latino_Hispanic               | Val  Loss: 1.4488 | Val  Acc: 0.4061
 Site-Black                         | Val  Loss: 1.7180 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.5620 | Val  Acc: 0.4364
 Site-East_Asian                    | Val  Loss: 1.6214 | Val  Acc: 0.4545
 Site-East_Asian                    | Val  Loss: 1.3213 | Val  Acc: 0.5030
 Site-Indian                        | Val  Loss: 1.3922 | Val  Acc: 0.4909
 Site-Indian                        | Val  Loss: 1.3727 | Val  Acc: 0.4606
 Site-Southeast_Asian               | Val  Loss: 1.5019 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.4522 | Val  Acc: 0.4909
 Site-Middle_Eastern                | Val  Loss: 1.3760 | Val  Acc: 0.5455
 Site-Middle_Eastern                | Val  Loss: 1.3269 | Val  Acc: 0.4788
Average Valid Accuracy: 0.4563
 Best site-White                     | Epoch:17 | Val Acc: 0.4545
 Best site-White                     | Epoch:17 | Val Acc: 0.4848
 Best site-Latino_Hispanic           | Epoch:17 | Val Acc: 0.3455
 Best site-Latino_Hispanic           | Epoch:17 | Val Acc: 0.4061
 Best site-Black                     | Epoch:17 | Val Acc: 0.3455
 Best site-Black                     | Epoch:17 | Val Acc: 0.4364
 Best site-East_Asian                | Epoch:17 | Val Acc: 0.4545
 Best site-East_Asian                | Epoch:17 | Val Acc: 0.5030
 Best site-Indian                    | Epoch:17 | Val Acc: 0.4909
 Best site-Indian                    | Epoch:17 | Val Acc: 0.4606
 Best site-Southeast_Asian           | Epoch:17 | Val Acc: 0.4909
 Best site-Southeast_Asian           | Epoch:17 | Val Acc: 0.4909
 Best site-Middle_Eastern            | Epoch:17 | Val Acc: 0.5455
 Best site-Middle_Eastern            | Epoch:17 | Val Acc: 0.4788
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 18 ============
 Site-White                    | Train Loss: 1.3326 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.3405 | Train Acc: 0.5020
 Site-Latino_Hispanic          | Train Loss: 1.5598 | Train Acc: 0.2805
 Site-Latino_Hispanic          | Train Loss: 1.4422 | Train Acc: 0.4049
 Site-Black                    | Train Loss: 1.5285 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.5077 | Train Acc: 0.4494
 Site-East_Asian               | Train Loss: 1.3735 | Train Acc: 0.4268
 Site-East_Asian               | Train Loss: 1.4151 | Train Acc: 0.4899
 Site-Indian                   | Train Loss: 1.5591 | Train Acc: 0.3902
 Site-Indian                   | Train Loss: 1.4426 | Train Acc: 0.4413
 Site-Southeast_Asian          | Train Loss: 1.4388 | Train Acc: 0.3659
 Site-Southeast_Asian          | Train Loss: 1.4362 | Train Acc: 0.4858
 Site-Middle_Eastern           | Train Loss: 1.3423 | Train Acc: 0.5366
 Site-Middle_Eastern           | Train Loss: 1.2971 | Train Acc: 0.5020
 Site-White                         | Val  Loss: 1.4134 | Val  Acc: 0.4545
 Site-White                         | Val  Loss: 1.3333 | Val  Acc: 0.4606
 Site-Latino_Hispanic               | Val  Loss: 1.3252 | Val  Acc: 0.3273
 Site-Latino_Hispanic               | Val  Loss: 1.4332 | Val  Acc: 0.4121
 Site-Black                         | Val  Loss: 1.6631 | Val  Acc: 0.3273
 Site-Black                         | Val  Loss: 1.5095 | Val  Acc: 0.4545
 Site-East_Asian                    | Val  Loss: 1.5914 | Val  Acc: 0.4545
 Site-East_Asian                    | Val  Loss: 1.3518 | Val  Acc: 0.5212
 Site-Indian                        | Val  Loss: 1.3907 | Val  Acc: 0.4727
 Site-Indian                        | Val  Loss: 1.3879 | Val  Acc: 0.4788
 Site-Southeast_Asian               | Val  Loss: 1.5131 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.4234 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.3896 | Val  Acc: 0.5636
 Site-Middle_Eastern                | Val  Loss: 1.3044 | Val  Acc: 0.4848
Average Valid Accuracy: 0.4567
 Best site-White                     | Epoch:18 | Val Acc: 0.4545
 Best site-White                     | Epoch:18 | Val Acc: 0.4606
 Best site-Latino_Hispanic           | Epoch:18 | Val Acc: 0.3273
 Best site-Latino_Hispanic           | Epoch:18 | Val Acc: 0.4121
 Best site-Black                     | Epoch:18 | Val Acc: 0.3273
 Best site-Black                     | Epoch:18 | Val Acc: 0.4545
 Best site-East_Asian                | Epoch:18 | Val Acc: 0.4545
 Best site-East_Asian                | Epoch:18 | Val Acc: 0.5212
 Best site-Indian                    | Epoch:18 | Val Acc: 0.4727
 Best site-Indian                    | Epoch:18 | Val Acc: 0.4788
 Best site-Southeast_Asian           | Epoch:18 | Val Acc: 0.5091
 Best site-Southeast_Asian           | Epoch:18 | Val Acc: 0.4727
 Best site-Middle_Eastern            | Epoch:18 | Val Acc: 0.5636
 Best site-Middle_Eastern            | Epoch:18 | Val Acc: 0.4848
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 19 ============
 Site-White                    | Train Loss: 1.3188 | Train Acc: 0.3780
 Site-White                    | Train Loss: 1.3476 | Train Acc: 0.4899
 Site-Latino_Hispanic          | Train Loss: 1.6894 | Train Acc: 0.3049
 Site-Latino_Hispanic          | Train Loss: 1.4197 | Train Acc: 0.4413
 Site-Black                    | Train Loss: 1.5746 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.4817 | Train Acc: 0.4575
 Site-East_Asian               | Train Loss: 1.3968 | Train Acc: 0.4146
 Site-East_Asian               | Train Loss: 1.3962 | Train Acc: 0.4737
 Site-Indian                   | Train Loss: 1.5666 | Train Acc: 0.3902
 Site-Indian                   | Train Loss: 1.4252 | Train Acc: 0.4777
 Site-Southeast_Asian          | Train Loss: 1.5394 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.4155 | Train Acc: 0.4899
 Site-Middle_Eastern           | Train Loss: 1.4143 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.2917 | Train Acc: 0.5182
 Site-White                         | Val  Loss: 1.4219 | Val  Acc: 0.4182
 Site-White                         | Val  Loss: 1.3492 | Val  Acc: 0.4788
 Site-Latino_Hispanic               | Val  Loss: 1.2757 | Val  Acc: 0.4000
 Site-Latino_Hispanic               | Val  Loss: 1.4001 | Val  Acc: 0.4788
 Site-Black                         | Val  Loss: 1.7045 | Val  Acc: 0.3273
 Site-Black                         | Val  Loss: 1.5072 | Val  Acc: 0.4788
 Site-East_Asian                    | Val  Loss: 1.5945 | Val  Acc: 0.5091
 Site-East_Asian                    | Val  Loss: 1.3376 | Val  Acc: 0.5333
 Site-Indian                        | Val  Loss: 1.3283 | Val  Acc: 0.4182
 Site-Indian                        | Val  Loss: 1.3909 | Val  Acc: 0.4970
 Site-Southeast_Asian               | Val  Loss: 1.5395 | Val  Acc: 0.4727
 Site-Southeast_Asian               | Val  Loss: 1.4167 | Val  Acc: 0.4848
 Site-Middle_Eastern                | Val  Loss: 1.3906 | Val  Acc: 0.5818
 Site-Middle_Eastern                | Val  Loss: 1.2916 | Val  Acc: 0.4848
Average Valid Accuracy: 0.4688
 Best site-White                     | Epoch:19 | Val Acc: 0.4182
 Best site-White                     | Epoch:19 | Val Acc: 0.4788
 Best site-Latino_Hispanic           | Epoch:19 | Val Acc: 0.4000
 Best site-Latino_Hispanic           | Epoch:19 | Val Acc: 0.4788
 Best site-Black                     | Epoch:19 | Val Acc: 0.3273
 Best site-Black                     | Epoch:19 | Val Acc: 0.4788
 Best site-East_Asian                | Epoch:19 | Val Acc: 0.5091
 Best site-East_Asian                | Epoch:19 | Val Acc: 0.5333
 Best site-Indian                    | Epoch:19 | Val Acc: 0.4182
 Best site-Indian                    | Epoch:19 | Val Acc: 0.4970
 Best site-Southeast_Asian           | Epoch:19 | Val Acc: 0.4727
 Best site-Southeast_Asian           | Epoch:19 | Val Acc: 0.4848
 Best site-Middle_Eastern            | Epoch:19 | Val Acc: 0.5818
 Best site-Middle_Eastern            | Epoch:19 | Val Acc: 0.4848
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
 Test site-White                    | Epoch:19 | Test Acc: 0.3746
 Test site-Latino_Hispanic          | Epoch:19 | Test Acc: 0.3401
 Test site-Black                    | Epoch:19 | Test Acc: 0.3387
 Test site-East_Asian               | Epoch:19 | Test Acc: 0.4445
 Test site-Indian                   | Epoch:19 | Test Acc: 0.3344
 Test site-Southeast_Asian          | Epoch:19 | Test Acc: 0.3901
 Test site-Middle_Eastern           | Epoch:19 | Test Acc: 0.3515
Average Test Accuracy: 0.3677, domain std=0.0367, individual std=0.0367
============ Train epoch 20 ============
 Site-White                    | Train Loss: 1.4869 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.2766 | Train Acc: 0.5223
 Site-Latino_Hispanic          | Train Loss: 1.6428 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.4349 | Train Acc: 0.4332
 Site-Black                    | Train Loss: 1.5918 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.5009 | Train Acc: 0.4615
 Site-East_Asian               | Train Loss: 1.2866 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.3515 | Train Acc: 0.4980
 Site-Indian                   | Train Loss: 1.5205 | Train Acc: 0.4268
 Site-Indian                   | Train Loss: 1.4396 | Train Acc: 0.4332
 Site-Southeast_Asian          | Train Loss: 1.4923 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.4216 | Train Acc: 0.4939
 Site-Middle_Eastern           | Train Loss: 1.5191 | Train Acc: 0.4878
 Site-Middle_Eastern           | Train Loss: 1.2694 | Train Acc: 0.5385
 Site-White                         | Val  Loss: 1.3672 | Val  Acc: 0.4182
 Site-White                         | Val  Loss: 1.3270 | Val  Acc: 0.4303
 Site-Latino_Hispanic               | Val  Loss: 1.3743 | Val  Acc: 0.3636
 Site-Latino_Hispanic               | Val  Loss: 1.4133 | Val  Acc: 0.4303
 Site-Black                         | Val  Loss: 1.6672 | Val  Acc: 0.3091
 Site-Black                         | Val  Loss: 1.5240 | Val  Acc: 0.4364
 Site-East_Asian                    | Val  Loss: 1.5510 | Val  Acc: 0.4545
 Site-East_Asian                    | Val  Loss: 1.2938 | Val  Acc: 0.5212
 Site-Indian                        | Val  Loss: 1.3892 | Val  Acc: 0.4545
 Site-Indian                        | Val  Loss: 1.3438 | Val  Acc: 0.4727
 Site-Southeast_Asian               | Val  Loss: 1.4679 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.4130 | Val  Acc: 0.4848
 Site-Middle_Eastern                | Val  Loss: 1.3087 | Val  Acc: 0.5818
 Site-Middle_Eastern                | Val  Loss: 1.3015 | Val  Acc: 0.4909
Average Valid Accuracy: 0.4541
============ Train epoch 21 ============
 Site-White                    | Train Loss: 1.5377 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.3236 | Train Acc: 0.5385
 Site-Latino_Hispanic          | Train Loss: 1.6160 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.3713 | Train Acc: 0.4453
 Site-Black                    | Train Loss: 1.5794 | Train Acc: 0.3537
 Site-Black                    | Train Loss: 1.5392 | Train Acc: 0.4251
 Site-East_Asian               | Train Loss: 1.4105 | Train Acc: 0.3902
 Site-East_Asian               | Train Loss: 1.3351 | Train Acc: 0.4899
 Site-Indian                   | Train Loss: 1.4643 | Train Acc: 0.3415
 Site-Indian                   | Train Loss: 1.4141 | Train Acc: 0.4980
 Site-Southeast_Asian          | Train Loss: 1.6276 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.3958 | Train Acc: 0.4737
 Site-Middle_Eastern           | Train Loss: 1.5219 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.2683 | Train Acc: 0.5182
 Site-White                         | Val  Loss: 1.4043 | Val  Acc: 0.4545
 Site-White                         | Val  Loss: 1.2738 | Val  Acc: 0.4970
 Site-Latino_Hispanic               | Val  Loss: 1.2491 | Val  Acc: 0.3455
 Site-Latino_Hispanic               | Val  Loss: 1.4045 | Val  Acc: 0.4242
 Site-Black                         | Val  Loss: 1.6830 | Val  Acc: 0.2909
 Site-Black                         | Val  Loss: 1.5424 | Val  Acc: 0.4000
 Site-East_Asian                    | Val  Loss: 1.6445 | Val  Acc: 0.4364
 Site-East_Asian                    | Val  Loss: 1.3448 | Val  Acc: 0.4970
 Site-Indian                        | Val  Loss: 1.4707 | Val  Acc: 0.4727
 Site-Indian                        | Val  Loss: 1.3896 | Val  Acc: 0.4848
 Site-Southeast_Asian               | Val  Loss: 1.5157 | Val  Acc: 0.4545
 Site-Southeast_Asian               | Val  Loss: 1.4367 | Val  Acc: 0.4485
 Site-Middle_Eastern                | Val  Loss: 1.3560 | Val  Acc: 0.4909
 Site-Middle_Eastern                | Val  Loss: 1.2880 | Val  Acc: 0.5212
Average Valid Accuracy: 0.4442
============ Train epoch 22 ============
 Site-White                    | Train Loss: 1.3979 | Train Acc: 0.3537
 Site-White                    | Train Loss: 1.2916 | Train Acc: 0.5385
 Site-Latino_Hispanic          | Train Loss: 1.5846 | Train Acc: 0.3902
 Site-Latino_Hispanic          | Train Loss: 1.3868 | Train Acc: 0.4615
 Site-Black                    | Train Loss: 1.4435 | Train Acc: 0.4024
 Site-Black                    | Train Loss: 1.5111 | Train Acc: 0.4413
 Site-East_Asian               | Train Loss: 1.3654 | Train Acc: 0.4634
 Site-East_Asian               | Train Loss: 1.3457 | Train Acc: 0.5223
 Site-Indian                   | Train Loss: 1.5478 | Train Acc: 0.3537
 Site-Indian                   | Train Loss: 1.3962 | Train Acc: 0.5061
 Site-Southeast_Asian          | Train Loss: 1.5589 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.3984 | Train Acc: 0.4980
 Site-Middle_Eastern           | Train Loss: 1.4994 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.2739 | Train Acc: 0.5385
 Site-White                         | Val  Loss: 1.3477 | Val  Acc: 0.4727
 Site-White                         | Val  Loss: 1.3197 | Val  Acc: 0.4909
 Site-Latino_Hispanic               | Val  Loss: 1.3177 | Val  Acc: 0.3636
 Site-Latino_Hispanic               | Val  Loss: 1.3722 | Val  Acc: 0.4667
 Site-Black                         | Val  Loss: 1.7005 | Val  Acc: 0.3273
 Site-Black                         | Val  Loss: 1.5242 | Val  Acc: 0.4364
 Site-East_Asian                    | Val  Loss: 1.5639 | Val  Acc: 0.4727
 Site-East_Asian                    | Val  Loss: 1.2888 | Val  Acc: 0.5273
 Site-Indian                        | Val  Loss: 1.3886 | Val  Acc: 0.4909
 Site-Indian                        | Val  Loss: 1.3733 | Val  Acc: 0.4727
 Site-Southeast_Asian               | Val  Loss: 1.4766 | Val  Acc: 0.4545
 Site-Southeast_Asian               | Val  Loss: 1.4091 | Val  Acc: 0.5091
 Site-Middle_Eastern                | Val  Loss: 1.3161 | Val  Acc: 0.5818
 Site-Middle_Eastern                | Val  Loss: 1.2964 | Val  Acc: 0.5333
Average Valid Accuracy: 0.4714
 Best site-White                     | Epoch:22 | Val Acc: 0.4727
 Best site-White                     | Epoch:22 | Val Acc: 0.4909
 Best site-Latino_Hispanic           | Epoch:22 | Val Acc: 0.3636
 Best site-Latino_Hispanic           | Epoch:22 | Val Acc: 0.4667
 Best site-Black                     | Epoch:22 | Val Acc: 0.3273
 Best site-Black                     | Epoch:22 | Val Acc: 0.4364
 Best site-East_Asian                | Epoch:22 | Val Acc: 0.4727
 Best site-East_Asian                | Epoch:22 | Val Acc: 0.5273
 Best site-Indian                    | Epoch:22 | Val Acc: 0.4909
 Best site-Indian                    | Epoch:22 | Val Acc: 0.4727
 Best site-Southeast_Asian           | Epoch:22 | Val Acc: 0.4545
 Best site-Southeast_Asian           | Epoch:22 | Val Acc: 0.5091
 Best site-Middle_Eastern            | Epoch:22 | Val Acc: 0.5818
 Best site-Middle_Eastern            | Epoch:22 | Val Acc: 0.5333
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 23 ============
 Site-White                    | Train Loss: 1.4408 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.2942 | Train Acc: 0.5385
 Site-Latino_Hispanic          | Train Loss: 1.7331 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.4257 | Train Acc: 0.3927
 Site-Black                    | Train Loss: 1.6506 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.4929 | Train Acc: 0.4251
 Site-East_Asian               | Train Loss: 1.3264 | Train Acc: 0.4268
 Site-East_Asian               | Train Loss: 1.3213 | Train Acc: 0.4939
 Site-Indian                   | Train Loss: 1.6340 | Train Acc: 0.3659
 Site-Indian                   | Train Loss: 1.3976 | Train Acc: 0.4615
 Site-Southeast_Asian          | Train Loss: 1.5882 | Train Acc: 0.4634
 Site-Southeast_Asian          | Train Loss: 1.3977 | Train Acc: 0.4899
 Site-Middle_Eastern           | Train Loss: 1.3836 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.2520 | Train Acc: 0.5223
 Site-White                         | Val  Loss: 1.3154 | Val  Acc: 0.4364
 Site-White                         | Val  Loss: 1.2809 | Val  Acc: 0.4909
 Site-Latino_Hispanic               | Val  Loss: 1.3089 | Val  Acc: 0.4000
 Site-Latino_Hispanic               | Val  Loss: 1.3805 | Val  Acc: 0.4485
 Site-Black                         | Val  Loss: 1.6222 | Val  Acc: 0.4545
 Site-Black                         | Val  Loss: 1.5314 | Val  Acc: 0.4606
 Site-East_Asian                    | Val  Loss: 1.5656 | Val  Acc: 0.5091
 Site-East_Asian                    | Val  Loss: 1.3603 | Val  Acc: 0.4909
 Site-Indian                        | Val  Loss: 1.3783 | Val  Acc: 0.4727
 Site-Indian                        | Val  Loss: 1.3456 | Val  Acc: 0.4667
 Site-Southeast_Asian               | Val  Loss: 1.4240 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.4004 | Val  Acc: 0.5030
 Site-Middle_Eastern                | Val  Loss: 1.4089 | Val  Acc: 0.5091
 Site-Middle_Eastern                | Val  Loss: 1.2652 | Val  Acc: 0.5273
Average Valid Accuracy: 0.4771
 Best site-White                     | Epoch:23 | Val Acc: 0.4364
 Best site-White                     | Epoch:23 | Val Acc: 0.4909
 Best site-Latino_Hispanic           | Epoch:23 | Val Acc: 0.4000
 Best site-Latino_Hispanic           | Epoch:23 | Val Acc: 0.4485
 Best site-Black                     | Epoch:23 | Val Acc: 0.4545
 Best site-Black                     | Epoch:23 | Val Acc: 0.4606
 Best site-East_Asian                | Epoch:23 | Val Acc: 0.5091
 Best site-East_Asian                | Epoch:23 | Val Acc: 0.4909
 Best site-Indian                    | Epoch:23 | Val Acc: 0.4727
 Best site-Indian                    | Epoch:23 | Val Acc: 0.4667
 Best site-Southeast_Asian           | Epoch:23 | Val Acc: 0.5091
 Best site-Southeast_Asian           | Epoch:23 | Val Acc: 0.5030
 Best site-Middle_Eastern            | Epoch:23 | Val Acc: 0.5091
 Best site-Middle_Eastern            | Epoch:23 | Val Acc: 0.5273
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 24 ============
 Site-White                    | Train Loss: 1.3164 | Train Acc: 0.4634
 Site-White                    | Train Loss: 1.2768 | Train Acc: 0.5385
 Site-Latino_Hispanic          | Train Loss: 1.9463 | Train Acc: 0.3293
 Site-Latino_Hispanic          | Train Loss: 1.3735 | Train Acc: 0.4372
 Site-Black                    | Train Loss: 1.5679 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.4694 | Train Acc: 0.4656
 Site-East_Asian               | Train Loss: 1.3072 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.3444 | Train Acc: 0.5142
 Site-Indian                   | Train Loss: 1.7310 | Train Acc: 0.4024
 Site-Indian                   | Train Loss: 1.3597 | Train Acc: 0.4615
 Site-Southeast_Asian          | Train Loss: 1.5381 | Train Acc: 0.4390
 Site-Southeast_Asian          | Train Loss: 1.3895 | Train Acc: 0.5101
 Site-Middle_Eastern           | Train Loss: 1.5323 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.2846 | Train Acc: 0.5466
 Site-White                         | Val  Loss: 1.3448 | Val  Acc: 0.5273
 Site-White                         | Val  Loss: 1.2644 | Val  Acc: 0.5212
 Site-Latino_Hispanic               | Val  Loss: 1.3139 | Val  Acc: 0.3818
 Site-Latino_Hispanic               | Val  Loss: 1.3532 | Val  Acc: 0.4788
 Site-Black                         | Val  Loss: 1.6810 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.4787 | Val  Acc: 0.4424
 Site-East_Asian                    | Val  Loss: 1.5637 | Val  Acc: 0.5455
 Site-East_Asian                    | Val  Loss: 1.3361 | Val  Acc: 0.4848
 Site-Indian                        | Val  Loss: 1.3598 | Val  Acc: 0.5455
 Site-Indian                        | Val  Loss: 1.3587 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.4345 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.4040 | Val  Acc: 0.4909
 Site-Middle_Eastern                | Val  Loss: 1.3309 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.2504 | Val  Acc: 0.4848
Average Valid Accuracy: 0.4801
 Best site-White                     | Epoch:24 | Val Acc: 0.5273
 Best site-White                     | Epoch:24 | Val Acc: 0.5212
 Best site-Latino_Hispanic           | Epoch:24 | Val Acc: 0.3818
 Best site-Latino_Hispanic           | Epoch:24 | Val Acc: 0.4788
 Best site-Black                     | Epoch:24 | Val Acc: 0.3455
 Best site-Black                     | Epoch:24 | Val Acc: 0.4424
 Best site-East_Asian                | Epoch:24 | Val Acc: 0.5455
 Best site-East_Asian                | Epoch:24 | Val Acc: 0.4848
 Best site-Indian                    | Epoch:24 | Val Acc: 0.5455
 Best site-Indian                    | Epoch:24 | Val Acc: 0.4909
 Best site-Southeast_Asian           | Epoch:24 | Val Acc: 0.5091
 Best site-Southeast_Asian           | Epoch:24 | Val Acc: 0.4909
 Best site-Middle_Eastern            | Epoch:24 | Val Acc: 0.4727
 Best site-Middle_Eastern            | Epoch:24 | Val Acc: 0.4848
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 25 ============
 Site-White                    | Train Loss: 1.3888 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.2515 | Train Acc: 0.5142
 Site-Latino_Hispanic          | Train Loss: 1.6609 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.3841 | Train Acc: 0.4332
 Site-Black                    | Train Loss: 1.4711 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.4756 | Train Acc: 0.4251
 Site-East_Asian               | Train Loss: 1.5395 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.3182 | Train Acc: 0.4980
 Site-Indian                   | Train Loss: 1.6354 | Train Acc: 0.4024
 Site-Indian                   | Train Loss: 1.3559 | Train Acc: 0.4777
 Site-Southeast_Asian          | Train Loss: 1.5254 | Train Acc: 0.4634
 Site-Southeast_Asian          | Train Loss: 1.3754 | Train Acc: 0.5142
 Site-Middle_Eastern           | Train Loss: 1.2586 | Train Acc: 0.5122
 Site-Middle_Eastern           | Train Loss: 1.2241 | Train Acc: 0.5466
 Site-White                         | Val  Loss: 1.3961 | Val  Acc: 0.4182
 Site-White                         | Val  Loss: 1.2528 | Val  Acc: 0.4909
 Site-Latino_Hispanic               | Val  Loss: 1.2489 | Val  Acc: 0.4182
 Site-Latino_Hispanic               | Val  Loss: 1.4173 | Val  Acc: 0.4121
 Site-Black                         | Val  Loss: 1.6245 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.4488 | Val  Acc: 0.4545
 Site-East_Asian                    | Val  Loss: 1.5184 | Val  Acc: 0.4727
 Site-East_Asian                    | Val  Loss: 1.3261 | Val  Acc: 0.5212
 Site-Indian                        | Val  Loss: 1.3421 | Val  Acc: 0.5636
 Site-Indian                        | Val  Loss: 1.3412 | Val  Acc: 0.4606
 Site-Southeast_Asian               | Val  Loss: 1.4533 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.3737 | Val  Acc: 0.5091
 Site-Middle_Eastern                | Val  Loss: 1.3200 | Val  Acc: 0.6000
 Site-Middle_Eastern                | Val  Loss: 1.2763 | Val  Acc: 0.5152
Average Valid Accuracy: 0.4766
============ Train epoch 26 ============
 Site-White                    | Train Loss: 1.3584 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.2439 | Train Acc: 0.5628
 Site-Latino_Hispanic          | Train Loss: 1.5643 | Train Acc: 0.3902
 Site-Latino_Hispanic          | Train Loss: 1.3544 | Train Acc: 0.4291
 Site-Black                    | Train Loss: 1.5722 | Train Acc: 0.3537
 Site-Black                    | Train Loss: 1.4385 | Train Acc: 0.4575
 Site-East_Asian               | Train Loss: 1.3538 | Train Acc: 0.4146
 Site-East_Asian               | Train Loss: 1.3489 | Train Acc: 0.5101
 Site-Indian                   | Train Loss: 1.4020 | Train Acc: 0.4390
 Site-Indian                   | Train Loss: 1.3656 | Train Acc: 0.4777
 Site-Southeast_Asian          | Train Loss: 1.4564 | Train Acc: 0.3780
 Site-Southeast_Asian          | Train Loss: 1.3791 | Train Acc: 0.4737
 Site-Middle_Eastern           | Train Loss: 1.4427 | Train Acc: 0.5000
 Site-Middle_Eastern           | Train Loss: 1.2682 | Train Acc: 0.5466
 Site-White                         | Val  Loss: 1.3671 | Val  Acc: 0.4909
 Site-White                         | Val  Loss: 1.2501 | Val  Acc: 0.4909
 Site-Latino_Hispanic               | Val  Loss: 1.2376 | Val  Acc: 0.4909
 Site-Latino_Hispanic               | Val  Loss: 1.3568 | Val  Acc: 0.4727
 Site-Black                         | Val  Loss: 1.7028 | Val  Acc: 0.3273
 Site-Black                         | Val  Loss: 1.5249 | Val  Acc: 0.4121
 Site-East_Asian                    | Val  Loss: 1.5388 | Val  Acc: 0.5273
 Site-East_Asian                    | Val  Loss: 1.3014 | Val  Acc: 0.5212
 Site-Indian                        | Val  Loss: 1.3506 | Val  Acc: 0.4545
 Site-Indian                        | Val  Loss: 1.3245 | Val  Acc: 0.5212
 Site-Southeast_Asian               | Val  Loss: 1.4346 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.3510 | Val  Acc: 0.5333
 Site-Middle_Eastern                | Val  Loss: 1.3737 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.2840 | Val  Acc: 0.5212
Average Valid Accuracy: 0.4818
 Best site-White                     | Epoch:26 | Val Acc: 0.4909
 Best site-White                     | Epoch:26 | Val Acc: 0.4909
 Best site-Latino_Hispanic           | Epoch:26 | Val Acc: 0.4909
 Best site-Latino_Hispanic           | Epoch:26 | Val Acc: 0.4727
 Best site-Black                     | Epoch:26 | Val Acc: 0.3273
 Best site-Black                     | Epoch:26 | Val Acc: 0.4121
 Best site-East_Asian                | Epoch:26 | Val Acc: 0.5273
 Best site-East_Asian                | Epoch:26 | Val Acc: 0.5212
 Best site-Indian                    | Epoch:26 | Val Acc: 0.4545
 Best site-Indian                    | Epoch:26 | Val Acc: 0.5212
 Best site-Southeast_Asian           | Epoch:26 | Val Acc: 0.5091
 Best site-Southeast_Asian           | Epoch:26 | Val Acc: 0.5333
 Best site-Middle_Eastern            | Epoch:26 | Val Acc: 0.4727
 Best site-Middle_Eastern            | Epoch:26 | Val Acc: 0.5212
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 27 ============
 Site-White                    | Train Loss: 1.5195 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.2258 | Train Acc: 0.5506
 Site-Latino_Hispanic          | Train Loss: 1.6928 | Train Acc: 0.4268
 Site-Latino_Hispanic          | Train Loss: 1.3162 | Train Acc: 0.4575
 Site-Black                    | Train Loss: 1.5623 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.4410 | Train Acc: 0.5020
 Site-East_Asian               | Train Loss: 1.4080 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.3188 | Train Acc: 0.5142
 Site-Indian                   | Train Loss: 1.4199 | Train Acc: 0.4024
 Site-Indian                   | Train Loss: 1.3410 | Train Acc: 0.4939
 Site-Southeast_Asian          | Train Loss: 1.3971 | Train Acc: 0.4390
 Site-Southeast_Asian          | Train Loss: 1.3272 | Train Acc: 0.4899
 Site-Middle_Eastern           | Train Loss: 1.4629 | Train Acc: 0.4878
 Site-Middle_Eastern           | Train Loss: 1.2126 | Train Acc: 0.5223
 Site-White                         | Val  Loss: 1.3331 | Val  Acc: 0.4545
 Site-White                         | Val  Loss: 1.2240 | Val  Acc: 0.5152
 Site-Latino_Hispanic               | Val  Loss: 1.2521 | Val  Acc: 0.4545
 Site-Latino_Hispanic               | Val  Loss: 1.3639 | Val  Acc: 0.4242
 Site-Black                         | Val  Loss: 1.6184 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.4652 | Val  Acc: 0.4242
 Site-East_Asian                    | Val  Loss: 1.6123 | Val  Acc: 0.4909
 Site-East_Asian                    | Val  Loss: 1.2996 | Val  Acc: 0.5152
 Site-Indian                        | Val  Loss: 1.3195 | Val  Acc: 0.5091
 Site-Indian                        | Val  Loss: 1.3217 | Val  Acc: 0.4788
 Site-Southeast_Asian               | Val  Loss: 1.4291 | Val  Acc: 0.5636
 Site-Southeast_Asian               | Val  Loss: 1.3735 | Val  Acc: 0.5030
 Site-Middle_Eastern                | Val  Loss: 1.3345 | Val  Acc: 0.5273
 Site-Middle_Eastern                | Val  Loss: 1.2833 | Val  Acc: 0.4970
Average Valid Accuracy: 0.4788
============ Train epoch 28 ============
 Site-White                    | Train Loss: 1.3788 | Train Acc: 0.3902
 Site-White                    | Train Loss: 1.2340 | Train Acc: 0.5425
 Site-Latino_Hispanic          | Train Loss: 1.5478 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.3429 | Train Acc: 0.4575
 Site-Black                    | Train Loss: 1.4294 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.4262 | Train Acc: 0.4696
 Site-East_Asian               | Train Loss: 1.4664 | Train Acc: 0.5488
 Site-East_Asian               | Train Loss: 1.3135 | Train Acc: 0.4858
 Site-Indian                   | Train Loss: 1.5154 | Train Acc: 0.3780
 Site-Indian                   | Train Loss: 1.3377 | Train Acc: 0.4696
 Site-Southeast_Asian          | Train Loss: 1.5921 | Train Acc: 0.4390
 Site-Southeast_Asian          | Train Loss: 1.3143 | Train Acc: 0.5101
 Site-Middle_Eastern           | Train Loss: 1.4270 | Train Acc: 0.5122
 Site-Middle_Eastern           | Train Loss: 1.2065 | Train Acc: 0.5182
 Site-White                         | Val  Loss: 1.2965 | Val  Acc: 0.5091
 Site-White                         | Val  Loss: 1.2367 | Val  Acc: 0.4909
 Site-Latino_Hispanic               | Val  Loss: 1.2505 | Val  Acc: 0.4182
 Site-Latino_Hispanic               | Val  Loss: 1.3584 | Val  Acc: 0.4485
 Site-Black                         | Val  Loss: 1.4828 | Val  Acc: 0.4364
 Site-Black                         | Val  Loss: 1.4485 | Val  Acc: 0.4606
 Site-East_Asian                    | Val  Loss: 1.6142 | Val  Acc: 0.5273
 Site-East_Asian                    | Val  Loss: 1.2547 | Val  Acc: 0.5333
 Site-Indian                        | Val  Loss: 1.2484 | Val  Acc: 0.5818
 Site-Indian                        | Val  Loss: 1.3471 | Val  Acc: 0.5030
 Site-Southeast_Asian               | Val  Loss: 1.4183 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.3597 | Val  Acc: 0.5273
 Site-Middle_Eastern                | Val  Loss: 1.3025 | Val  Acc: 0.5273
 Site-Middle_Eastern                | Val  Loss: 1.2791 | Val  Acc: 0.5091
Average Valid Accuracy: 0.4987
 Best site-White                     | Epoch:28 | Val Acc: 0.5091
 Best site-White                     | Epoch:28 | Val Acc: 0.4909
 Best site-Latino_Hispanic           | Epoch:28 | Val Acc: 0.4182
 Best site-Latino_Hispanic           | Epoch:28 | Val Acc: 0.4485
 Best site-Black                     | Epoch:28 | Val Acc: 0.4364
 Best site-Black                     | Epoch:28 | Val Acc: 0.4606
 Best site-East_Asian                | Epoch:28 | Val Acc: 0.5273
 Best site-East_Asian                | Epoch:28 | Val Acc: 0.5333
 Best site-Indian                    | Epoch:28 | Val Acc: 0.5818
 Best site-Indian                    | Epoch:28 | Val Acc: 0.5030
 Best site-Southeast_Asian           | Epoch:28 | Val Acc: 0.5091
 Best site-Southeast_Asian           | Epoch:28 | Val Acc: 0.5273
 Best site-Middle_Eastern            | Epoch:28 | Val Acc: 0.5273
 Best site-Middle_Eastern            | Epoch:28 | Val Acc: 0.5091
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 29 ============
 Site-White                    | Train Loss: 1.4736 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.2198 | Train Acc: 0.5425
 Site-Latino_Hispanic          | Train Loss: 1.6059 | Train Acc: 0.2927
 Site-Latino_Hispanic          | Train Loss: 1.3396 | Train Acc: 0.4534
 Site-Black                    | Train Loss: 1.4899 | Train Acc: 0.4268
 Site-Black                    | Train Loss: 1.4007 | Train Acc: 0.4899
 Site-East_Asian               | Train Loss: 1.3625 | Train Acc: 0.4878
 Site-East_Asian               | Train Loss: 1.3175 | Train Acc: 0.5142
 Site-Indian                   | Train Loss: 1.4336 | Train Acc: 0.4390
 Site-Indian                   | Train Loss: 1.3427 | Train Acc: 0.4453
 Site-Southeast_Asian          | Train Loss: 1.5527 | Train Acc: 0.4512
 Site-Southeast_Asian          | Train Loss: 1.3547 | Train Acc: 0.5223
 Site-Middle_Eastern           | Train Loss: 1.3289 | Train Acc: 0.5122
 Site-Middle_Eastern           | Train Loss: 1.2168 | Train Acc: 0.5425
 Site-White                         | Val  Loss: 1.2794 | Val  Acc: 0.4727
 Site-White                         | Val  Loss: 1.2138 | Val  Acc: 0.5394
 Site-Latino_Hispanic               | Val  Loss: 1.2625 | Val  Acc: 0.3818
 Site-Latino_Hispanic               | Val  Loss: 1.3515 | Val  Acc: 0.4606
 Site-Black                         | Val  Loss: 1.5841 | Val  Acc: 0.4364
 Site-Black                         | Val  Loss: 1.4828 | Val  Acc: 0.4606
 Site-East_Asian                    | Val  Loss: 1.5677 | Val  Acc: 0.5091
 Site-East_Asian                    | Val  Loss: 1.2881 | Val  Acc: 0.4970
 Site-Indian                        | Val  Loss: 1.3268 | Val  Acc: 0.5273
 Site-Indian                        | Val  Loss: 1.2990 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.3913 | Val  Acc: 0.5636
 Site-Southeast_Asian               | Val  Loss: 1.3804 | Val  Acc: 0.5212
 Site-Middle_Eastern                | Val  Loss: 1.3141 | Val  Acc: 0.5636
 Site-Middle_Eastern                | Val  Loss: 1.2491 | Val  Acc: 0.5152
Average Valid Accuracy: 0.4957
============ Train epoch 30 ============
 Site-White                    | Train Loss: 1.4707 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.2659 | Train Acc: 0.5506
 Site-Latino_Hispanic          | Train Loss: 1.6528 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.3513 | Train Acc: 0.4696
 Site-Black                    | Train Loss: 1.5726 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.4505 | Train Acc: 0.4575
 Site-East_Asian               | Train Loss: 1.3677 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.2893 | Train Acc: 0.5142
 Site-Indian                   | Train Loss: 1.5245 | Train Acc: 0.4024
 Site-Indian                   | Train Loss: 1.3387 | Train Acc: 0.4899
 Site-Southeast_Asian          | Train Loss: 1.5829 | Train Acc: 0.3537
 Site-Southeast_Asian          | Train Loss: 1.3707 | Train Acc: 0.4939
 Site-Middle_Eastern           | Train Loss: 1.3044 | Train Acc: 0.4268
 Site-Middle_Eastern           | Train Loss: 1.2432 | Train Acc: 0.5466
 Site-White                         | Val  Loss: 1.2473 | Val  Acc: 0.5455
 Site-White                         | Val  Loss: 1.2201 | Val  Acc: 0.5333
 Site-Latino_Hispanic               | Val  Loss: 1.2638 | Val  Acc: 0.3455
 Site-Latino_Hispanic               | Val  Loss: 1.3249 | Val  Acc: 0.4485
 Site-Black                         | Val  Loss: 1.5413 | Val  Acc: 0.4727
 Site-Black                         | Val  Loss: 1.4634 | Val  Acc: 0.4667
 Site-East_Asian                    | Val  Loss: 1.5621 | Val  Acc: 0.4909
 Site-East_Asian                    | Val  Loss: 1.2548 | Val  Acc: 0.5697
 Site-Indian                        | Val  Loss: 1.3109 | Val  Acc: 0.5273
 Site-Indian                        | Val  Loss: 1.2856 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.4280 | Val  Acc: 0.5273
 Site-Southeast_Asian               | Val  Loss: 1.3487 | Val  Acc: 0.5091
 Site-Middle_Eastern                | Val  Loss: 1.3002 | Val  Acc: 0.5455
 Site-Middle_Eastern                | Val  Loss: 1.2359 | Val  Acc: 0.5091
Average Valid Accuracy: 0.4987
============ Train epoch 31 ============
 Site-White                    | Train Loss: 1.3438 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.2178 | Train Acc: 0.5506
 Site-Latino_Hispanic          | Train Loss: 1.6900 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.3089 | Train Acc: 0.4899
 Site-Black                    | Train Loss: 1.5359 | Train Acc: 0.4268
 Site-Black                    | Train Loss: 1.4024 | Train Acc: 0.4494
 Site-East_Asian               | Train Loss: 1.3300 | Train Acc: 0.4756
 Site-East_Asian               | Train Loss: 1.3029 | Train Acc: 0.5304
 Site-Indian                   | Train Loss: 1.4876 | Train Acc: 0.4024
 Site-Indian                   | Train Loss: 1.3235 | Train Acc: 0.4899
 Site-Southeast_Asian          | Train Loss: 1.5079 | Train Acc: 0.4756
 Site-Southeast_Asian          | Train Loss: 1.3400 | Train Acc: 0.5020
 Site-Middle_Eastern           | Train Loss: 1.5692 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.2037 | Train Acc: 0.5385
 Site-White                         | Val  Loss: 1.2918 | Val  Acc: 0.5273
 Site-White                         | Val  Loss: 1.2338 | Val  Acc: 0.5333
 Site-Latino_Hispanic               | Val  Loss: 1.2580 | Val  Acc: 0.4545
 Site-Latino_Hispanic               | Val  Loss: 1.3287 | Val  Acc: 0.4727
 Site-Black                         | Val  Loss: 1.6376 | Val  Acc: 0.2545
 Site-Black                         | Val  Loss: 1.4316 | Val  Acc: 0.4909
 Site-East_Asian                    | Val  Loss: 1.4948 | Val  Acc: 0.5091
 Site-East_Asian                    | Val  Loss: 1.2728 | Val  Acc: 0.5576
 Site-Indian                        | Val  Loss: 1.2928 | Val  Acc: 0.5273
 Site-Indian                        | Val  Loss: 1.3078 | Val  Acc: 0.4848
 Site-Southeast_Asian               | Val  Loss: 1.4229 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.3541 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.2498 | Val  Acc: 0.6000
 Site-Middle_Eastern                | Val  Loss: 1.2394 | Val  Acc: 0.5455
Average Valid Accuracy: 0.4957
============ Train epoch 32 ============
 Site-White                    | Train Loss: 1.4522 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.2334 | Train Acc: 0.5547
 Site-Latino_Hispanic          | Train Loss: 1.5810 | Train Acc: 0.3049
 Site-Latino_Hispanic          | Train Loss: 1.2851 | Train Acc: 0.4737
 Site-Black                    | Train Loss: 1.4652 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.4104 | Train Acc: 0.4656
 Site-East_Asian               | Train Loss: 1.4150 | Train Acc: 0.4878
 Site-East_Asian               | Train Loss: 1.2784 | Train Acc: 0.5425
 Site-Indian                   | Train Loss: 1.3904 | Train Acc: 0.4268
 Site-Indian                   | Train Loss: 1.3627 | Train Acc: 0.4737
 Site-Southeast_Asian          | Train Loss: 1.3837 | Train Acc: 0.4756
 Site-Southeast_Asian          | Train Loss: 1.3448 | Train Acc: 0.5020
 Site-Middle_Eastern           | Train Loss: 1.3278 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.2237 | Train Acc: 0.5628
 Site-White                         | Val  Loss: 1.3001 | Val  Acc: 0.4727
 Site-White                         | Val  Loss: 1.2246 | Val  Acc: 0.5394
 Site-Latino_Hispanic               | Val  Loss: 1.2724 | Val  Acc: 0.4727
 Site-Latino_Hispanic               | Val  Loss: 1.3465 | Val  Acc: 0.4303
 Site-Black                         | Val  Loss: 1.5566 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.4582 | Val  Acc: 0.4909
 Site-East_Asian                    | Val  Loss: 1.5081 | Val  Acc: 0.4909
 Site-East_Asian                    | Val  Loss: 1.2855 | Val  Acc: 0.5091
 Site-Indian                        | Val  Loss: 1.2693 | Val  Acc: 0.4727
 Site-Indian                        | Val  Loss: 1.2927 | Val  Acc: 0.5333
 Site-Southeast_Asian               | Val  Loss: 1.3345 | Val  Acc: 0.5455
 Site-Southeast_Asian               | Val  Loss: 1.3011 | Val  Acc: 0.5333
 Site-Middle_Eastern                | Val  Loss: 1.3625 | Val  Acc: 0.5273
 Site-Middle_Eastern                | Val  Loss: 1.2367 | Val  Acc: 0.5152
Average Valid Accuracy: 0.4913
============ Train epoch 33 ============
 Site-White                    | Train Loss: 1.4892 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.2169 | Train Acc: 0.5425
 Site-Latino_Hispanic          | Train Loss: 1.8355 | Train Acc: 0.3293
 Site-Latino_Hispanic          | Train Loss: 1.2914 | Train Acc: 0.4737
 Site-Black                    | Train Loss: 1.5632 | Train Acc: 0.3780
 Site-Black                    | Train Loss: 1.4158 | Train Acc: 0.4615
 Site-East_Asian               | Train Loss: 1.5066 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.2782 | Train Acc: 0.4980
 Site-Indian                   | Train Loss: 1.5012 | Train Acc: 0.4146
 Site-Indian                   | Train Loss: 1.3458 | Train Acc: 0.4858
 Site-Southeast_Asian          | Train Loss: 1.5222 | Train Acc: 0.3659
 Site-Southeast_Asian          | Train Loss: 1.3240 | Train Acc: 0.5020
 Site-Middle_Eastern           | Train Loss: 1.5167 | Train Acc: 0.5610
 Site-Middle_Eastern           | Train Loss: 1.1850 | Train Acc: 0.5425
 Site-White                         | Val  Loss: 1.1939 | Val  Acc: 0.6000
 Site-White                         | Val  Loss: 1.2014 | Val  Acc: 0.5333
 Site-Latino_Hispanic               | Val  Loss: 1.2061 | Val  Acc: 0.4909
 Site-Latino_Hispanic               | Val  Loss: 1.3084 | Val  Acc: 0.4909
 Site-Black                         | Val  Loss: 1.5756 | Val  Acc: 0.3818
 Site-Black                         | Val  Loss: 1.4361 | Val  Acc: 0.4424
 Site-East_Asian                    | Val  Loss: 1.4867 | Val  Acc: 0.5273
 Site-East_Asian                    | Val  Loss: 1.2652 | Val  Acc: 0.5394
 Site-Indian                        | Val  Loss: 1.3185 | Val  Acc: 0.4909
 Site-Indian                        | Val  Loss: 1.3160 | Val  Acc: 0.5212
 Site-Southeast_Asian               | Val  Loss: 1.3639 | Val  Acc: 0.5273
 Site-Southeast_Asian               | Val  Loss: 1.3520 | Val  Acc: 0.5152
 Site-Middle_Eastern                | Val  Loss: 1.2759 | Val  Acc: 0.5818
 Site-Middle_Eastern                | Val  Loss: 1.2232 | Val  Acc: 0.5394
Average Valid Accuracy: 0.5130
 Best site-White                     | Epoch:33 | Val Acc: 0.6000
 Best site-White                     | Epoch:33 | Val Acc: 0.5333
 Best site-Latino_Hispanic           | Epoch:33 | Val Acc: 0.4909
 Best site-Latino_Hispanic           | Epoch:33 | Val Acc: 0.4909
 Best site-Black                     | Epoch:33 | Val Acc: 0.3818
 Best site-Black                     | Epoch:33 | Val Acc: 0.4424
 Best site-East_Asian                | Epoch:33 | Val Acc: 0.5273
 Best site-East_Asian                | Epoch:33 | Val Acc: 0.5394
 Best site-Indian                    | Epoch:33 | Val Acc: 0.4909
 Best site-Indian                    | Epoch:33 | Val Acc: 0.5212
 Best site-Southeast_Asian           | Epoch:33 | Val Acc: 0.5273
 Best site-Southeast_Asian           | Epoch:33 | Val Acc: 0.5152
 Best site-Middle_Eastern            | Epoch:33 | Val Acc: 0.5818
 Best site-Middle_Eastern            | Epoch:33 | Val Acc: 0.5394
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 34 ============
 Site-White                    | Train Loss: 1.4862 | Train Acc: 0.4512
 Site-White                    | Train Loss: 1.2047 | Train Acc: 0.5749
 Site-Latino_Hispanic          | Train Loss: 1.4605 | Train Acc: 0.3780
 Site-Latino_Hispanic          | Train Loss: 1.2676 | Train Acc: 0.4818
 Site-Black                    | Train Loss: 1.4577 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.4018 | Train Acc: 0.4858
 Site-East_Asian               | Train Loss: 1.3357 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.3172 | Train Acc: 0.5182
 Site-Indian                   | Train Loss: 1.3962 | Train Acc: 0.4512
 Site-Indian                   | Train Loss: 1.3306 | Train Acc: 0.5142
 Site-Southeast_Asian          | Train Loss: 1.4667 | Train Acc: 0.4268
 Site-Southeast_Asian          | Train Loss: 1.2863 | Train Acc: 0.5263
 Site-Middle_Eastern           | Train Loss: 1.3718 | Train Acc: 0.4878
 Site-Middle_Eastern           | Train Loss: 1.2026 | Train Acc: 0.5668
 Site-White                         | Val  Loss: 1.2720 | Val  Acc: 0.4727
 Site-White                         | Val  Loss: 1.1672 | Val  Acc: 0.5576
 Site-Latino_Hispanic               | Val  Loss: 1.2247 | Val  Acc: 0.4000
 Site-Latino_Hispanic               | Val  Loss: 1.2846 | Val  Acc: 0.5091
 Site-Black                         | Val  Loss: 1.5528 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.4600 | Val  Acc: 0.4182
 Site-East_Asian                    | Val  Loss: 1.5238 | Val  Acc: 0.5636
 Site-East_Asian                    | Val  Loss: 1.2676 | Val  Acc: 0.5273
 Site-Indian                        | Val  Loss: 1.2578 | Val  Acc: 0.4364
 Site-Indian                        | Val  Loss: 1.3081 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.3677 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.3301 | Val  Acc: 0.5455
 Site-Middle_Eastern                | Val  Loss: 1.3305 | Val  Acc: 0.5818
 Site-Middle_Eastern                | Val  Loss: 1.1974 | Val  Acc: 0.5333
Average Valid Accuracy: 0.4909
============ Train epoch 35 ============
 Site-White                    | Train Loss: 1.4802 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.1965 | Train Acc: 0.5587
 Site-Latino_Hispanic          | Train Loss: 1.7360 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.3070 | Train Acc: 0.4737
 Site-Black                    | Train Loss: 1.5184 | Train Acc: 0.4390
 Site-Black                    | Train Loss: 1.3940 | Train Acc: 0.4858
 Site-East_Asian               | Train Loss: 1.4085 | Train Acc: 0.5244
 Site-East_Asian               | Train Loss: 1.2590 | Train Acc: 0.5263
 Site-Indian                   | Train Loss: 1.5587 | Train Acc: 0.4390
 Site-Indian                   | Train Loss: 1.2940 | Train Acc: 0.5142
 Site-Southeast_Asian          | Train Loss: 1.5886 | Train Acc: 0.3537
 Site-Southeast_Asian          | Train Loss: 1.3098 | Train Acc: 0.5061
 Site-Middle_Eastern           | Train Loss: 1.3354 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.1509 | Train Acc: 0.5668
 Site-White                         | Val  Loss: 1.2583 | Val  Acc: 0.5091
 Site-White                         | Val  Loss: 1.2089 | Val  Acc: 0.5333
 Site-Latino_Hispanic               | Val  Loss: 1.1956 | Val  Acc: 0.4545
 Site-Latino_Hispanic               | Val  Loss: 1.3213 | Val  Acc: 0.4485
 Site-Black                         | Val  Loss: 1.5334 | Val  Acc: 0.4909
 Site-Black                         | Val  Loss: 1.4244 | Val  Acc: 0.4364
 Site-East_Asian                    | Val  Loss: 1.5325 | Val  Acc: 0.4545
 Site-East_Asian                    | Val  Loss: 1.2745 | Val  Acc: 0.5091
 Site-Indian                        | Val  Loss: 1.2668 | Val  Acc: 0.5091
 Site-Indian                        | Val  Loss: 1.2775 | Val  Acc: 0.4788
 Site-Southeast_Asian               | Val  Loss: 1.3741 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.2784 | Val  Acc: 0.5394
 Site-Middle_Eastern                | Val  Loss: 1.2937 | Val  Acc: 0.5455
 Site-Middle_Eastern                | Val  Loss: 1.2187 | Val  Acc: 0.5273
Average Valid Accuracy: 0.4948
============ Train epoch 36 ============
 Site-White                    | Train Loss: 1.3624 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.2093 | Train Acc: 0.5709
 Site-Latino_Hispanic          | Train Loss: 1.5047 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.2649 | Train Acc: 0.4939
 Site-Black                    | Train Loss: 1.5798 | Train Acc: 0.4268
 Site-Black                    | Train Loss: 1.3774 | Train Acc: 0.4939
 Site-East_Asian               | Train Loss: 1.2678 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.2530 | Train Acc: 0.5142
 Site-Indian                   | Train Loss: 1.5278 | Train Acc: 0.3902
 Site-Indian                   | Train Loss: 1.2796 | Train Acc: 0.4980
 Site-Southeast_Asian          | Train Loss: 1.4602 | Train Acc: 0.4512
 Site-Southeast_Asian          | Train Loss: 1.2908 | Train Acc: 0.5547
 Site-Middle_Eastern           | Train Loss: 1.6044 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.1980 | Train Acc: 0.5385
 Site-White                         | Val  Loss: 1.1716 | Val  Acc: 0.6545
 Site-White                         | Val  Loss: 1.1806 | Val  Acc: 0.5576
 Site-Latino_Hispanic               | Val  Loss: 1.2214 | Val  Acc: 0.5091
 Site-Latino_Hispanic               | Val  Loss: 1.3047 | Val  Acc: 0.4909
 Site-Black                         | Val  Loss: 1.5396 | Val  Acc: 0.4364
 Site-Black                         | Val  Loss: 1.3781 | Val  Acc: 0.4909
 Site-East_Asian                    | Val  Loss: 1.5540 | Val  Acc: 0.5636
 Site-East_Asian                    | Val  Loss: 1.2828 | Val  Acc: 0.5152
 Site-Indian                        | Val  Loss: 1.2708 | Val  Acc: 0.6000
 Site-Indian                        | Val  Loss: 1.2593 | Val  Acc: 0.5273
 Site-Southeast_Asian               | Val  Loss: 1.3737 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.3103 | Val  Acc: 0.5636
 Site-Middle_Eastern                | Val  Loss: 1.2815 | Val  Acc: 0.6000
 Site-Middle_Eastern                | Val  Loss: 1.1865 | Val  Acc: 0.5455
Average Valid Accuracy: 0.5390
 Best site-White                     | Epoch:36 | Val Acc: 0.6545
 Best site-White                     | Epoch:36 | Val Acc: 0.5576
 Best site-Latino_Hispanic           | Epoch:36 | Val Acc: 0.5091
 Best site-Latino_Hispanic           | Epoch:36 | Val Acc: 0.4909
 Best site-Black                     | Epoch:36 | Val Acc: 0.4364
 Best site-Black                     | Epoch:36 | Val Acc: 0.4909
 Best site-East_Asian                | Epoch:36 | Val Acc: 0.5636
 Best site-East_Asian                | Epoch:36 | Val Acc: 0.5152
 Best site-Indian                    | Epoch:36 | Val Acc: 0.6000
 Best site-Indian                    | Epoch:36 | Val Acc: 0.5273
 Best site-Southeast_Asian           | Epoch:36 | Val Acc: 0.4909
 Best site-Southeast_Asian           | Epoch:36 | Val Acc: 0.5636
 Best site-Middle_Eastern            | Epoch:36 | Val Acc: 0.6000
 Best site-Middle_Eastern            | Epoch:36 | Val Acc: 0.5455
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
============ Train epoch 37 ============
 Site-White                    | Train Loss: 1.3501 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.1848 | Train Acc: 0.5709
 Site-Latino_Hispanic          | Train Loss: 1.4815 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.3540 | Train Acc: 0.4372
 Site-Black                    | Train Loss: 1.6209 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.3980 | Train Acc: 0.4858
 Site-East_Asian               | Train Loss: 1.3566 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.2248 | Train Acc: 0.5385
 Site-Indian                   | Train Loss: 1.4253 | Train Acc: 0.4634
 Site-Indian                   | Train Loss: 1.3397 | Train Acc: 0.4615
 Site-Southeast_Asian          | Train Loss: 1.4960 | Train Acc: 0.3659
 Site-Southeast_Asian          | Train Loss: 1.2944 | Train Acc: 0.5628
 Site-Middle_Eastern           | Train Loss: 1.4164 | Train Acc: 0.4756
 Site-Middle_Eastern           | Train Loss: 1.1756 | Train Acc: 0.5466
 Site-White                         | Val  Loss: 1.2761 | Val  Acc: 0.4909
 Site-White                         | Val  Loss: 1.1840 | Val  Acc: 0.5030
 Site-Latino_Hispanic               | Val  Loss: 1.1981 | Val  Acc: 0.4364
 Site-Latino_Hispanic               | Val  Loss: 1.2771 | Val  Acc: 0.4909
 Site-Black                         | Val  Loss: 1.5520 | Val  Acc: 0.4182
 Site-Black                         | Val  Loss: 1.4409 | Val  Acc: 0.4909
 Site-East_Asian                    | Val  Loss: 1.5093 | Val  Acc: 0.4727
 Site-East_Asian                    | Val  Loss: 1.2902 | Val  Acc: 0.5152
 Site-Indian                        | Val  Loss: 1.2203 | Val  Acc: 0.5455
 Site-Indian                        | Val  Loss: 1.3031 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.3563 | Val  Acc: 0.5455
 Site-Southeast_Asian               | Val  Loss: 1.2610 | Val  Acc: 0.5576
 Site-Middle_Eastern                | Val  Loss: 1.3043 | Val  Acc: 0.5273
 Site-Middle_Eastern                | Val  Loss: 1.2450 | Val  Acc: 0.5394
Average Valid Accuracy: 0.5017
============ Train epoch 38 ============
 Site-White                    | Train Loss: 1.2910 | Train Acc: 0.4024
 Site-White                    | Train Loss: 1.1933 | Train Acc: 0.5830
 Site-Latino_Hispanic          | Train Loss: 1.6212 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.2764 | Train Acc: 0.4534
 Site-Black                    | Train Loss: 1.5106 | Train Acc: 0.4390
 Site-Black                    | Train Loss: 1.4077 | Train Acc: 0.4939
 Site-East_Asian               | Train Loss: 1.4294 | Train Acc: 0.4268
 Site-East_Asian               | Train Loss: 1.2792 | Train Acc: 0.5587
 Site-Indian                   | Train Loss: 1.5073 | Train Acc: 0.4024
 Site-Indian                   | Train Loss: 1.3201 | Train Acc: 0.4696
 Site-Southeast_Asian          | Train Loss: 1.4919 | Train Acc: 0.4390
 Site-Southeast_Asian          | Train Loss: 1.3110 | Train Acc: 0.5101
 Site-Middle_Eastern           | Train Loss: 1.5143 | Train Acc: 0.5122
 Site-Middle_Eastern           | Train Loss: 1.1917 | Train Acc: 0.5668
 Site-White                         | Val  Loss: 1.2171 | Val  Acc: 0.5273
 Site-White                         | Val  Loss: 1.1558 | Val  Acc: 0.5636
 Site-Latino_Hispanic               | Val  Loss: 1.2238 | Val  Acc: 0.4364
 Site-Latino_Hispanic               | Val  Loss: 1.3021 | Val  Acc: 0.5152
 Site-Black                         | Val  Loss: 1.5172 | Val  Acc: 0.4182
 Site-Black                         | Val  Loss: 1.3663 | Val  Acc: 0.5394
 Site-East_Asian                    | Val  Loss: 1.5180 | Val  Acc: 0.5636
 Site-East_Asian                    | Val  Loss: 1.2368 | Val  Acc: 0.5879
 Site-Indian                        | Val  Loss: 1.3237 | Val  Acc: 0.4909
 Site-Indian                        | Val  Loss: 1.2911 | Val  Acc: 0.4970
 Site-Southeast_Asian               | Val  Loss: 1.3461 | Val  Acc: 0.5636
 Site-Southeast_Asian               | Val  Loss: 1.2769 | Val  Acc: 0.5455
 Site-Middle_Eastern                | Val  Loss: 1.2913 | Val  Acc: 0.4727
 Site-Middle_Eastern                | Val  Loss: 1.1751 | Val  Acc: 0.5697
Average Valid Accuracy: 0.5208
============ Train epoch 39 ============
 Site-White                    | Train Loss: 1.2737 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.1711 | Train Acc: 0.5668
 Site-Latino_Hispanic          | Train Loss: 1.5882 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.2937 | Train Acc: 0.4494
 Site-Black                    | Train Loss: 1.3542 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.3972 | Train Acc: 0.5061
 Site-East_Asian               | Train Loss: 1.4150 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.2473 | Train Acc: 0.5709
 Site-Indian                   | Train Loss: 1.4082 | Train Acc: 0.4878
 Site-Indian                   | Train Loss: 1.3275 | Train Acc: 0.4818
 Site-Southeast_Asian          | Train Loss: 1.4788 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.2778 | Train Acc: 0.5709
 Site-Middle_Eastern           | Train Loss: 1.7455 | Train Acc: 0.4878
 Site-Middle_Eastern           | Train Loss: 1.2121 | Train Acc: 0.5182
 Site-White                         | Val  Loss: 1.1838 | Val  Acc: 0.5818
 Site-White                         | Val  Loss: 1.1643 | Val  Acc: 0.5636
 Site-Latino_Hispanic               | Val  Loss: 1.1719 | Val  Acc: 0.5455
 Site-Latino_Hispanic               | Val  Loss: 1.3130 | Val  Acc: 0.4606
 Site-Black                         | Val  Loss: 1.4762 | Val  Acc: 0.4727
 Site-Black                         | Val  Loss: 1.4111 | Val  Acc: 0.4545
 Site-East_Asian                    | Val  Loss: 1.5410 | Val  Acc: 0.5636
 Site-East_Asian                    | Val  Loss: 1.2572 | Val  Acc: 0.5758
 Site-Indian                        | Val  Loss: 1.2471 | Val  Acc: 0.5636
 Site-Indian                        | Val  Loss: 1.2846 | Val  Acc: 0.5030
 Site-Southeast_Asian               | Val  Loss: 1.3158 | Val  Acc: 0.6000
 Site-Southeast_Asian               | Val  Loss: 1.2860 | Val  Acc: 0.5273
 Site-Middle_Eastern                | Val  Loss: 1.2590 | Val  Acc: 0.5636
 Site-Middle_Eastern                | Val  Loss: 1.2286 | Val  Acc: 0.5212
Average Valid Accuracy: 0.5355
============ Train epoch 40 ============
 Site-White                    | Train Loss: 1.4269 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.1744 | Train Acc: 0.5628
 Site-Latino_Hispanic          | Train Loss: 1.5678 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.2830 | Train Acc: 0.5020
 Site-Black                    | Train Loss: 1.5597 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.3810 | Train Acc: 0.4818
 Site-East_Asian               | Train Loss: 1.3432 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.2325 | Train Acc: 0.5547
 Site-Indian                   | Train Loss: 1.4165 | Train Acc: 0.4024
 Site-Indian                   | Train Loss: 1.3345 | Train Acc: 0.5061
 Site-Southeast_Asian          | Train Loss: 1.5300 | Train Acc: 0.3537
 Site-Southeast_Asian          | Train Loss: 1.2895 | Train Acc: 0.5223
 Site-Middle_Eastern           | Train Loss: 1.2585 | Train Acc: 0.4878
 Site-Middle_Eastern           | Train Loss: 1.1593 | Train Acc: 0.5749
 Site-White                         | Val  Loss: 1.2087 | Val  Acc: 0.5636
 Site-White                         | Val  Loss: 1.1744 | Val  Acc: 0.5576
 Site-Latino_Hispanic               | Val  Loss: 1.2611 | Val  Acc: 0.4364
 Site-Latino_Hispanic               | Val  Loss: 1.2725 | Val  Acc: 0.4848
 Site-Black                         | Val  Loss: 1.6006 | Val  Acc: 0.4364
 Site-Black                         | Val  Loss: 1.3420 | Val  Acc: 0.5515
 Site-East_Asian                    | Val  Loss: 1.5398 | Val  Acc: 0.6000
 Site-East_Asian                    | Val  Loss: 1.2510 | Val  Acc: 0.5394
 Site-Indian                        | Val  Loss: 1.2574 | Val  Acc: 0.4909
 Site-Indian                        | Val  Loss: 1.2608 | Val  Acc: 0.5515
 Site-Southeast_Asian               | Val  Loss: 1.3514 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.3085 | Val  Acc: 0.5273
 Site-Middle_Eastern                | Val  Loss: 1.2122 | Val  Acc: 0.5455
 Site-Middle_Eastern                | Val  Loss: 1.1819 | Val  Acc: 0.5515
Average Valid Accuracy: 0.5247
============ Train epoch 41 ============
 Site-White                    | Train Loss: 1.3198 | Train Acc: 0.4634
 Site-White                    | Train Loss: 1.1827 | Train Acc: 0.5425
 Site-Latino_Hispanic          | Train Loss: 1.5290 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.2684 | Train Acc: 0.4939
 Site-Black                    | Train Loss: 1.5551 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.3370 | Train Acc: 0.5182
 Site-East_Asian               | Train Loss: 1.3612 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.2665 | Train Acc: 0.5385
 Site-Indian                   | Train Loss: 1.5808 | Train Acc: 0.4878
 Site-Indian                   | Train Loss: 1.3271 | Train Acc: 0.4939
 Site-Southeast_Asian          | Train Loss: 1.5917 | Train Acc: 0.3537
 Site-Southeast_Asian          | Train Loss: 1.2862 | Train Acc: 0.5385
 Site-Middle_Eastern           | Train Loss: 1.3213 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.1532 | Train Acc: 0.5587
 Site-White                         | Val  Loss: 1.1829 | Val  Acc: 0.6364
 Site-White                         | Val  Loss: 1.1680 | Val  Acc: 0.5636
 Site-Latino_Hispanic               | Val  Loss: 1.2036 | Val  Acc: 0.4545
 Site-Latino_Hispanic               | Val  Loss: 1.2734 | Val  Acc: 0.5091
 Site-Black                         | Val  Loss: 1.4187 | Val  Acc: 0.4000
 Site-Black                         | Val  Loss: 1.3802 | Val  Acc: 0.5091
 Site-East_Asian                    | Val  Loss: 1.5715 | Val  Acc: 0.5636
 Site-East_Asian                    | Val  Loss: 1.2244 | Val  Acc: 0.5333
 Site-Indian                        | Val  Loss: 1.2949 | Val  Acc: 0.4909
 Site-Indian                        | Val  Loss: 1.2873 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.2465 | Val  Acc: 0.6000
 Site-Southeast_Asian               | Val  Loss: 1.3162 | Val  Acc: 0.5273
 Site-Middle_Eastern                | Val  Loss: 1.2530 | Val  Acc: 0.5636
 Site-Middle_Eastern                | Val  Loss: 1.1809 | Val  Acc: 0.5273
Average Valid Accuracy: 0.5277
============ Train epoch 42 ============
 Site-White                    | Train Loss: 1.4200 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.1442 | Train Acc: 0.5587
 Site-Latino_Hispanic          | Train Loss: 1.5904 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.2729 | Train Acc: 0.4575
 Site-Black                    | Train Loss: 1.4780 | Train Acc: 0.4390
 Site-Black                    | Train Loss: 1.3862 | Train Acc: 0.4980
 Site-East_Asian               | Train Loss: 1.4107 | Train Acc: 0.4512
 Site-East_Asian               | Train Loss: 1.2179 | Train Acc: 0.5709
 Site-Indian                   | Train Loss: 1.4789 | Train Acc: 0.3659
 Site-Indian                   | Train Loss: 1.2923 | Train Acc: 0.4980
 Site-Southeast_Asian          | Train Loss: 1.6467 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.2659 | Train Acc: 0.5587
 Site-Middle_Eastern           | Train Loss: 1.3497 | Train Acc: 0.4390
 Site-Middle_Eastern           | Train Loss: 1.1523 | Train Acc: 0.5749
 Site-White                         | Val  Loss: 1.2158 | Val  Acc: 0.5455
 Site-White                         | Val  Loss: 1.1590 | Val  Acc: 0.5818
 Site-Latino_Hispanic               | Val  Loss: 1.1924 | Val  Acc: 0.4545
 Site-Latino_Hispanic               | Val  Loss: 1.2795 | Val  Acc: 0.4909
 Site-Black                         | Val  Loss: 1.4297 | Val  Acc: 0.4727
 Site-Black                         | Val  Loss: 1.3985 | Val  Acc: 0.4970
 Site-East_Asian                    | Val  Loss: 1.4893 | Val  Acc: 0.5455
 Site-East_Asian                    | Val  Loss: 1.1828 | Val  Acc: 0.5879
 Site-Indian                        | Val  Loss: 1.2205 | Val  Acc: 0.5636
 Site-Indian                        | Val  Loss: 1.2417 | Val  Acc: 0.5030
 Site-Southeast_Asian               | Val  Loss: 1.3145 | Val  Acc: 0.5455
 Site-Southeast_Asian               | Val  Loss: 1.2450 | Val  Acc: 0.5515
 Site-Middle_Eastern                | Val  Loss: 1.2801 | Val  Acc: 0.5636
 Site-Middle_Eastern                | Val  Loss: 1.1976 | Val  Acc: 0.4970
Average Valid Accuracy: 0.5286
============ Train epoch 43 ============
 Site-White                    | Train Loss: 1.2883 | Train Acc: 0.4512
 Site-White                    | Train Loss: 1.1456 | Train Acc: 0.5911
 Site-Latino_Hispanic          | Train Loss: 1.6078 | Train Acc: 0.4268
 Site-Latino_Hispanic          | Train Loss: 1.2735 | Train Acc: 0.4737
 Site-Black                    | Train Loss: 1.5113 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.3450 | Train Acc: 0.5061
 Site-East_Asian               | Train Loss: 1.3717 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.2037 | Train Acc: 0.5587
 Site-Indian                   | Train Loss: 1.3049 | Train Acc: 0.4512
 Site-Indian                   | Train Loss: 1.2200 | Train Acc: 0.5466
 Site-Southeast_Asian          | Train Loss: 1.9263 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.2641 | Train Acc: 0.5506
 Site-Middle_Eastern           | Train Loss: 1.3498 | Train Acc: 0.5488
 Site-Middle_Eastern           | Train Loss: 1.1502 | Train Acc: 0.5749
 Site-White                         | Val  Loss: 1.1852 | Val  Acc: 0.5455
 Site-White                         | Val  Loss: 1.1262 | Val  Acc: 0.5636
 Site-Latino_Hispanic               | Val  Loss: 1.1881 | Val  Acc: 0.5091
 Site-Latino_Hispanic               | Val  Loss: 1.3200 | Val  Acc: 0.4727
 Site-Black                         | Val  Loss: 1.5273 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.4097 | Val  Acc: 0.5030
 Site-East_Asian                    | Val  Loss: 1.5376 | Val  Acc: 0.5455
 Site-East_Asian                    | Val  Loss: 1.2259 | Val  Acc: 0.5818
 Site-Indian                        | Val  Loss: 1.2859 | Val  Acc: 0.4545
 Site-Indian                        | Val  Loss: 1.2488 | Val  Acc: 0.5333
 Site-Southeast_Asian               | Val  Loss: 1.3227 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.2883 | Val  Acc: 0.5394
 Site-Middle_Eastern                | Val  Loss: 1.2223 | Val  Acc: 0.6000
 Site-Middle_Eastern                | Val  Loss: 1.1655 | Val  Acc: 0.5152
Average Valid Accuracy: 0.5156
============ Train epoch 44 ============
 Site-White                    | Train Loss: 1.2882 | Train Acc: 0.4634
 Site-White                    | Train Loss: 1.1788 | Train Acc: 0.5506
 Site-Latino_Hispanic          | Train Loss: 1.5431 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.2599 | Train Acc: 0.4980
 Site-Black                    | Train Loss: 1.4360 | Train Acc: 0.4512
 Site-Black                    | Train Loss: 1.3407 | Train Acc: 0.5385
 Site-East_Asian               | Train Loss: 1.6241 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.2303 | Train Acc: 0.5425
 Site-Indian                   | Train Loss: 1.2951 | Train Acc: 0.4390
 Site-Indian                   | Train Loss: 1.2767 | Train Acc: 0.5223
 Site-Southeast_Asian          | Train Loss: 1.5425 | Train Acc: 0.4024
 Site-Southeast_Asian          | Train Loss: 1.2675 | Train Acc: 0.5506
 Site-Middle_Eastern           | Train Loss: 1.2075 | Train Acc: 0.5000
 Site-Middle_Eastern           | Train Loss: 1.1314 | Train Acc: 0.5749
 Site-White                         | Val  Loss: 1.1848 | Val  Acc: 0.5455
 Site-White                         | Val  Loss: 1.1605 | Val  Acc: 0.5818
 Site-Latino_Hispanic               | Val  Loss: 1.1492 | Val  Acc: 0.4364
 Site-Latino_Hispanic               | Val  Loss: 1.2900 | Val  Acc: 0.4788
 Site-Black                         | Val  Loss: 1.4960 | Val  Acc: 0.4364
 Site-Black                         | Val  Loss: 1.3526 | Val  Acc: 0.5212
 Site-East_Asian                    | Val  Loss: 1.4941 | Val  Acc: 0.5636
 Site-East_Asian                    | Val  Loss: 1.1619 | Val  Acc: 0.6000
 Site-Indian                        | Val  Loss: 1.2290 | Val  Acc: 0.5091
 Site-Indian                        | Val  Loss: 1.2458 | Val  Acc: 0.5212
 Site-Southeast_Asian               | Val  Loss: 1.2975 | Val  Acc: 0.4909
 Site-Southeast_Asian               | Val  Loss: 1.2983 | Val  Acc: 0.5455
 Site-Middle_Eastern                | Val  Loss: 1.2560 | Val  Acc: 0.6000
 Site-Middle_Eastern                | Val  Loss: 1.1568 | Val  Acc: 0.5515
Average Valid Accuracy: 0.5273
============ Train epoch 45 ============
 Site-White                    | Train Loss: 1.3732 | Train Acc: 0.4268
 Site-White                    | Train Loss: 1.1419 | Train Acc: 0.5911
 Site-Latino_Hispanic          | Train Loss: 1.6771 | Train Acc: 0.3537
 Site-Latino_Hispanic          | Train Loss: 1.2537 | Train Acc: 0.4899
 Site-Black                    | Train Loss: 1.5713 | Train Acc: 0.4268
 Site-Black                    | Train Loss: 1.3640 | Train Acc: 0.4980
 Site-East_Asian               | Train Loss: 1.3952 | Train Acc: 0.4146
 Site-East_Asian               | Train Loss: 1.2436 | Train Acc: 0.5142
 Site-Indian                   | Train Loss: 1.2957 | Train Acc: 0.4512
 Site-Indian                   | Train Loss: 1.2859 | Train Acc: 0.5344
 Site-Southeast_Asian          | Train Loss: 1.4581 | Train Acc: 0.3902
 Site-Southeast_Asian          | Train Loss: 1.2577 | Train Acc: 0.5951
 Site-Middle_Eastern           | Train Loss: 1.4439 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.1200 | Train Acc: 0.6032
 Site-White                         | Val  Loss: 1.2032 | Val  Acc: 0.5091
 Site-White                         | Val  Loss: 1.1395 | Val  Acc: 0.5636
 Site-Latino_Hispanic               | Val  Loss: 1.2302 | Val  Acc: 0.4545
 Site-Latino_Hispanic               | Val  Loss: 1.2628 | Val  Acc: 0.4970
 Site-Black                         | Val  Loss: 1.3739 | Val  Acc: 0.4364
 Site-Black                         | Val  Loss: 1.3701 | Val  Acc: 0.4788
 Site-East_Asian                    | Val  Loss: 1.4465 | Val  Acc: 0.5273
 Site-East_Asian                    | Val  Loss: 1.2138 | Val  Acc: 0.5636
 Site-Indian                        | Val  Loss: 1.2051 | Val  Acc: 0.5818
 Site-Indian                        | Val  Loss: 1.2055 | Val  Acc: 0.6000
 Site-Southeast_Asian               | Val  Loss: 1.2969 | Val  Acc: 0.5636
 Site-Southeast_Asian               | Val  Loss: 1.2378 | Val  Acc: 0.5879
 Site-Middle_Eastern                | Val  Loss: 1.2496 | Val  Acc: 0.6000
 Site-Middle_Eastern                | Val  Loss: 1.1308 | Val  Acc: 0.5758
Average Valid Accuracy: 0.5385
============ Train epoch 46 ============
 Site-White                    | Train Loss: 1.4578 | Train Acc: 0.4146
 Site-White                    | Train Loss: 1.1418 | Train Acc: 0.6073
 Site-Latino_Hispanic          | Train Loss: 1.7456 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.2450 | Train Acc: 0.5101
 Site-Black                    | Train Loss: 1.5231 | Train Acc: 0.3902
 Site-Black                    | Train Loss: 1.3574 | Train Acc: 0.4939
 Site-East_Asian               | Train Loss: 1.3185 | Train Acc: 0.4390
 Site-East_Asian               | Train Loss: 1.2140 | Train Acc: 0.5466
 Site-Indian                   | Train Loss: 1.4550 | Train Acc: 0.4634
 Site-Indian                   | Train Loss: 1.2187 | Train Acc: 0.5425
 Site-Southeast_Asian          | Train Loss: 1.6905 | Train Acc: 0.3780
 Site-Southeast_Asian          | Train Loss: 1.2571 | Train Acc: 0.5466
 Site-Middle_Eastern           | Train Loss: 1.4212 | Train Acc: 0.4634
 Site-Middle_Eastern           | Train Loss: 1.1573 | Train Acc: 0.5668
 Site-White                         | Val  Loss: 1.1879 | Val  Acc: 0.5091
 Site-White                         | Val  Loss: 1.1502 | Val  Acc: 0.5455
 Site-Latino_Hispanic               | Val  Loss: 1.1235 | Val  Acc: 0.5636
 Site-Latino_Hispanic               | Val  Loss: 1.2933 | Val  Acc: 0.4970
 Site-Black                         | Val  Loss: 1.4769 | Val  Acc: 0.3455
 Site-Black                         | Val  Loss: 1.3554 | Val  Acc: 0.5030
 Site-East_Asian                    | Val  Loss: 1.5004 | Val  Acc: 0.5091
 Site-East_Asian                    | Val  Loss: 1.2041 | Val  Acc: 0.5576
 Site-Indian                        | Val  Loss: 1.1418 | Val  Acc: 0.5818
 Site-Indian                        | Val  Loss: 1.2399 | Val  Acc: 0.5030
 Site-Southeast_Asian               | Val  Loss: 1.2421 | Val  Acc: 0.6000
 Site-Southeast_Asian               | Val  Loss: 1.2334 | Val  Acc: 0.5515
 Site-Middle_Eastern                | Val  Loss: 1.2171 | Val  Acc: 0.5636
 Site-Middle_Eastern                | Val  Loss: 1.1236 | Val  Acc: 0.5515
Average Valid Accuracy: 0.5273
============ Train epoch 47 ============
 Site-White                    | Train Loss: 1.2718 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.1131 | Train Acc: 0.6032
 Site-Latino_Hispanic          | Train Loss: 1.5172 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.2480 | Train Acc: 0.4939
 Site-Black                    | Train Loss: 1.4962 | Train Acc: 0.4512
 Site-Black                    | Train Loss: 1.3674 | Train Acc: 0.4899
 Site-East_Asian               | Train Loss: 1.5336 | Train Acc: 0.4146
 Site-East_Asian               | Train Loss: 1.2604 | Train Acc: 0.5344
 Site-Indian                   | Train Loss: 1.3405 | Train Acc: 0.4756
 Site-Indian                   | Train Loss: 1.2817 | Train Acc: 0.5263
 Site-Southeast_Asian          | Train Loss: 1.3748 | Train Acc: 0.4390
 Site-Southeast_Asian          | Train Loss: 1.2340 | Train Acc: 0.5668
 Site-Middle_Eastern           | Train Loss: 1.3147 | Train Acc: 0.5244
 Site-Middle_Eastern           | Train Loss: 1.1491 | Train Acc: 0.5668
 Site-White                         | Val  Loss: 1.1183 | Val  Acc: 0.5636
 Site-White                         | Val  Loss: 1.1505 | Val  Acc: 0.4909
 Site-Latino_Hispanic               | Val  Loss: 1.1933 | Val  Acc: 0.4182
 Site-Latino_Hispanic               | Val  Loss: 1.2469 | Val  Acc: 0.5152
 Site-Black                         | Val  Loss: 1.3850 | Val  Acc: 0.4727
 Site-Black                         | Val  Loss: 1.4038 | Val  Acc: 0.4606
 Site-East_Asian                    | Val  Loss: 1.4833 | Val  Acc: 0.5455
 Site-East_Asian                    | Val  Loss: 1.1860 | Val  Acc: 0.5576
 Site-Indian                        | Val  Loss: 1.1942 | Val  Acc: 0.5091
 Site-Indian                        | Val  Loss: 1.2294 | Val  Acc: 0.5636
 Site-Southeast_Asian               | Val  Loss: 1.3463 | Val  Acc: 0.5091
 Site-Southeast_Asian               | Val  Loss: 1.2629 | Val  Acc: 0.5455
 Site-Middle_Eastern                | Val  Loss: 1.1988 | Val  Acc: 0.6000
 Site-Middle_Eastern                | Val  Loss: 1.1885 | Val  Acc: 0.5576
Average Valid Accuracy: 0.5221
============ Train epoch 48 ============
 Site-White                    | Train Loss: 1.3956 | Train Acc: 0.4390
 Site-White                    | Train Loss: 1.1325 | Train Acc: 0.5992
 Site-Latino_Hispanic          | Train Loss: 1.6519 | Train Acc: 0.4024
 Site-Latino_Hispanic          | Train Loss: 1.2657 | Train Acc: 0.4777
 Site-Black                    | Train Loss: 1.5089 | Train Acc: 0.4146
 Site-Black                    | Train Loss: 1.3686 | Train Acc: 0.5142
 Site-East_Asian               | Train Loss: 1.4292 | Train Acc: 0.4634
 Site-East_Asian               | Train Loss: 1.2094 | Train Acc: 0.5304
 Site-Indian                   | Train Loss: 1.2504 | Train Acc: 0.5244
 Site-Indian                   | Train Loss: 1.2984 | Train Acc: 0.5263
 Site-Southeast_Asian          | Train Loss: 1.6176 | Train Acc: 0.4390
 Site-Southeast_Asian          | Train Loss: 1.2001 | Train Acc: 0.5830
 Site-Middle_Eastern           | Train Loss: 1.4353 | Train Acc: 0.4512
 Site-Middle_Eastern           | Train Loss: 1.1576 | Train Acc: 0.5506
 Site-White                         | Val  Loss: 1.1709 | Val  Acc: 0.6000
 Site-White                         | Val  Loss: 1.1137 | Val  Acc: 0.5758
 Site-Latino_Hispanic               | Val  Loss: 1.1851 | Val  Acc: 0.4182
 Site-Latino_Hispanic               | Val  Loss: 1.2606 | Val  Acc: 0.4970
 Site-Black                         | Val  Loss: 1.4057 | Val  Acc: 0.4727
 Site-Black                         | Val  Loss: 1.3730 | Val  Acc: 0.4970
 Site-East_Asian                    | Val  Loss: 1.4931 | Val  Acc: 0.5636
 Site-East_Asian                    | Val  Loss: 1.2203 | Val  Acc: 0.5273
 Site-Indian                        | Val  Loss: 1.2195 | Val  Acc: 0.5636
 Site-Indian                        | Val  Loss: 1.2325 | Val  Acc: 0.5212
 Site-Southeast_Asian               | Val  Loss: 1.2617 | Val  Acc: 0.5818
 Site-Southeast_Asian               | Val  Loss: 1.2197 | Val  Acc: 0.5697
 Site-Middle_Eastern                | Val  Loss: 1.2041 | Val  Acc: 0.5455
 Site-Middle_Eastern                | Val  Loss: 1.1613 | Val  Acc: 0.5394
Average Valid Accuracy: 0.5338
============ Train epoch 49 ============
 Site-White                    | Train Loss: 1.2144 | Train Acc: 0.4634
 Site-White                    | Train Loss: 1.1545 | Train Acc: 0.5789
 Site-Latino_Hispanic          | Train Loss: 1.5368 | Train Acc: 0.3171
 Site-Latino_Hispanic          | Train Loss: 1.2502 | Train Acc: 0.4737
 Site-Black                    | Train Loss: 1.8019 | Train Acc: 0.3659
 Site-Black                    | Train Loss: 1.2780 | Train Acc: 0.5506
 Site-East_Asian               | Train Loss: 1.6459 | Train Acc: 0.4146
 Site-East_Asian               | Train Loss: 1.2202 | Train Acc: 0.5223
 Site-Indian                   | Train Loss: 1.4128 | Train Acc: 0.4512
 Site-Indian                   | Train Loss: 1.2733 | Train Acc: 0.5223
 Site-Southeast_Asian          | Train Loss: 1.4006 | Train Acc: 0.4146
 Site-Southeast_Asian          | Train Loss: 1.2164 | Train Acc: 0.5870
 Site-Middle_Eastern           | Train Loss: 1.3047 | Train Acc: 0.4878
 Site-Middle_Eastern           | Train Loss: 1.0865 | Train Acc: 0.5870
 Site-White                         | Val  Loss: 1.2123 | Val  Acc: 0.5636
 Site-White                         | Val  Loss: 1.1160 | Val  Acc: 0.6061
 Site-Latino_Hispanic               | Val  Loss: 1.1576 | Val  Acc: 0.4909
 Site-Latino_Hispanic               | Val  Loss: 1.2782 | Val  Acc: 0.5152
 Site-Black                         | Val  Loss: 1.4569 | Val  Acc: 0.4182
 Site-Black                         | Val  Loss: 1.3317 | Val  Acc: 0.5091
 Site-East_Asian                    | Val  Loss: 1.4163 | Val  Acc: 0.5818
 Site-East_Asian                    | Val  Loss: 1.1909 | Val  Acc: 0.5636
 Site-Indian                        | Val  Loss: 1.3295 | Val  Acc: 0.4727
 Site-Indian                        | Val  Loss: 1.2411 | Val  Acc: 0.5455
 Site-Southeast_Asian               | Val  Loss: 1.3025 | Val  Acc: 0.5455
 Site-Southeast_Asian               | Val  Loss: 1.2495 | Val  Acc: 0.5576
 Site-Middle_Eastern                | Val  Loss: 1.2472 | Val  Acc: 0.6364
 Site-Middle_Eastern                | Val  Loss: 1.1477 | Val  Acc: 0.5455
Average Valid Accuracy: 0.5394
 Best site-White                     | Epoch:49 | Val Acc: 0.5636
 Best site-White                     | Epoch:49 | Val Acc: 0.6061
 Best site-Latino_Hispanic           | Epoch:49 | Val Acc: 0.4909
 Best site-Latino_Hispanic           | Epoch:49 | Val Acc: 0.5152
 Best site-Black                     | Epoch:49 | Val Acc: 0.4182
 Best site-Black                     | Epoch:49 | Val Acc: 0.5091
 Best site-East_Asian                | Epoch:49 | Val Acc: 0.5818
 Best site-East_Asian                | Epoch:49 | Val Acc: 0.5636
 Best site-Indian                    | Epoch:49 | Val Acc: 0.4727
 Best site-Indian                    | Epoch:49 | Val Acc: 0.5455
 Best site-Southeast_Asian           | Epoch:49 | Val Acc: 0.5455
 Best site-Southeast_Asian           | Epoch:49 | Val Acc: 0.5576
 Best site-Middle_Eastern            | Epoch:49 | Val Acc: 0.6364
 Best site-Middle_Eastern            | Epoch:49 | Val Acc: 0.5455
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1/CoCoOP...
 Test site-White                    | Epoch:49 | Test Acc: 0.3837
 Test site-Latino_Hispanic          | Epoch:49 | Test Acc: 0.3364
 Test site-Black                    | Epoch:49 | Test Acc: 0.3483
 Test site-East_Asian               | Epoch:49 | Test Acc: 0.4329
 Test site-Indian                   | Epoch:49 | Test Acc: 0.3430
 Test site-Southeast_Asian          | Epoch:49 | Test Acc: 0.3958
 Test site-Middle_Eastern           | Epoch:49 | Test Acc: 0.3639
Average Test Accuracy: 0.3720, domain std=0.0319, individual std=0.0319
===2023-05-24 20:20:31===
===2023-05-24 20:20:33===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[82,247,82,247,82,247,82,247,82,247,82,247,82,247,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1100,1100,1100,1100,1100,1100,1100,]
domain number = 7
Loading snapshots...
 Test site-White                    | Epoch:49 | Test Acc: 0.3837
 Test site-Latino_Hispanic          | Epoch:49 | Test Acc: 0.3364
 Test site-Black                    | Epoch:49 | Test Acc: 0.3483
 Test site-East_Asian               | Epoch:49 | Test Acc: 0.4329
 Test site-Indian                   | Epoch:49 | Test Acc: 0.3430
 Test site-Southeast_Asian          | Epoch:49 | Test Acc: 0.3958
 Test site-Middle_Eastern           | Epoch:49 | Test Acc: 0.3639
Average Test Accuracy: 0.3720, domain std=0.0319, individual std=0.0319
