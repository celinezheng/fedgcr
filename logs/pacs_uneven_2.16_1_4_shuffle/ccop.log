===2023-08-17 02:56:27===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
===2023-08-17 07:02:03===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[18,23,30,38,50,64,83,107,139,180,15,28,49,88,157,14,142,72,
client_nums=[10,5,2,1,]
len_dataset=[1227,568,262,121,]
domain number = 4
============ Train epoch 0 ============
cnt=[11, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-art_painting              (0) | Train Loss: 1.6412 | Train Acc: 0.5556
 Site-art_painting              (0) | Train Loss: 1.8483 | Train Acc: 0.2609
 Site-art_painting              (0) | Train Loss: 1.8056 | Train Acc: 0.3000
 Site-art_painting              (0) | Train Loss: 1.7855 | Train Acc: 0.3947
 Site-art_painting              (0) | Train Loss: 1.8755 | Train Acc: 0.2000
 Site-art_painting              (0) | Train Loss: 1.7331 | Train Acc: 0.4375
 Site-art_painting              (0) | Train Loss: 1.8868 | Train Acc: 0.2169
 Site-art_painting              (0) | Train Loss: 1.7356 | Train Acc: 0.3645
 Site-art_painting              (0) | Train Loss: 1.7458 | Train Acc: 0.4029
 Site-art_painting              (0) | Train Loss: 1.7841 | Train Acc: 0.3556
 Site-photo                     (2) | Train Loss: 1.8029 | Train Acc: 0.4667
 Site-photo                     (3) | Train Loss: 1.7075 | Train Acc: 0.5357
 Site-photo                     (3) | Train Loss: 1.7321 | Train Acc: 0.5714
 Site-photo                     (3) | Train Loss: 1.7335 | Train Acc: 0.5114
 Site-photo                     (3) | Train Loss: 1.6818 | Train Acc: 0.5414
 Site-sketch                    (1) | Train Loss: 1.8764 | Train Acc: 0.1429
 Site-sketch                    (1) | Train Loss: 1.8041 | Train Acc: 0.2817
 Site-cartoon                   (0) | Train Loss: 1.8821 | Train Acc: 0.2917
Average Train Accuracy: 0.3795
 Best site-art_painting              | Epoch:0 | Val Acc: 0.5556
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2609
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3000
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3947
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2000
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4375
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2169
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3645
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4029
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3556
 Best site-photo                     | Epoch:0 | Val Acc: 0.4667
 Best site-photo                     | Epoch:0 | Val Acc: 0.5357
 Best site-photo                     | Epoch:0 | Val Acc: 0.5714
 Best site-photo                     | Epoch:0 | Val Acc: 0.5114
 Best site-photo                     | Epoch:0 | Val Acc: 0.5414
 Best site-sketch                    | Epoch:0 | Val Acc: 0.1429
 Best site-sketch                    | Epoch:0 | Val Acc: 0.2817
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.2917
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 2, 5, 10, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-art_painting              (3) | Train Loss: 1.4227 | Train Acc: 0.6667
 Site-art_painting              (3) | Train Loss: 1.7186 | Train Acc: 0.3913
 Site-art_painting              (3) | Train Loss: 1.8857 | Train Acc: 0.2000
 Site-art_painting              (3) | Train Loss: 1.5686 | Train Acc: 0.2895
 Site-art_painting              (0) | Train Loss: 1.6257 | Train Acc: 0.4000
 Site-art_painting              (3) | Train Loss: 1.5463 | Train Acc: 0.4375
 Site-art_painting              (3) | Train Loss: 1.6848 | Train Acc: 0.4096
 Site-art_painting              (3) | Train Loss: 1.6197 | Train Acc: 0.4393
 Site-art_painting              (3) | Train Loss: 1.6177 | Train Acc: 0.4892
 Site-art_painting              (3) | Train Loss: 1.6216 | Train Acc: 0.4556
 Site-photo                     (2) | Train Loss: 1.7130 | Train Acc: 0.3333
 Site-photo                     (2) | Train Loss: 1.4252 | Train Acc: 0.6429
 Site-photo                     (2) | Train Loss: 1.5012 | Train Acc: 0.5918
 Site-photo                     (2) | Train Loss: 1.5002 | Train Acc: 0.6136
 Site-photo                     (2) | Train Loss: 1.4413 | Train Acc: 0.6369
 Site-sketch                    (1) | Train Loss: 1.7064 | Train Acc: 0.2143
 Site-sketch                    (1) | Train Loss: 1.8074 | Train Acc: 0.2606
 Site-cartoon                   (3) | Train Loss: 1.7951 | Train Acc: 0.2778
Average Train Accuracy: 0.4305
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:1 | Val Acc: 0.3913
 Best site-art_painting              | Epoch:1 | Val Acc: 0.2000
 Best site-art_painting              | Epoch:1 | Val Acc: 0.2895
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4000
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4375
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4096
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4393
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4892
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4556
 Best site-photo                     | Epoch:1 | Val Acc: 0.3333
 Best site-photo                     | Epoch:1 | Val Acc: 0.6429
 Best site-photo                     | Epoch:1 | Val Acc: 0.5918
 Best site-photo                     | Epoch:1 | Val Acc: 0.6136
 Best site-photo                     | Epoch:1 | Val Acc: 0.6369
 Best site-sketch                    | Epoch:1 | Val Acc: 0.2143
 Best site-sketch                    | Epoch:1 | Val Acc: 0.2606
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.2778
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 11, 5, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-art_painting              (1) | Train Loss: 1.4205 | Train Acc: 0.6111
 Site-art_painting              (1) | Train Loss: 1.5562 | Train Acc: 0.4783
 Site-art_painting              (1) | Train Loss: 1.6300 | Train Acc: 0.3667
 Site-art_painting              (1) | Train Loss: 1.4007 | Train Acc: 0.5789
 Site-art_painting              (1) | Train Loss: 1.5265 | Train Acc: 0.4800
 Site-art_painting              (1) | Train Loss: 1.4905 | Train Acc: 0.5781
 Site-art_painting              (1) | Train Loss: 1.5820 | Train Acc: 0.5301
 Site-art_painting              (1) | Train Loss: 1.4466 | Train Acc: 0.6075
 Site-art_painting              (1) | Train Loss: 1.4656 | Train Acc: 0.6115
 Site-art_painting              (1) | Train Loss: 1.4781 | Train Acc: 0.5944
 Site-photo                     (2) | Train Loss: 1.5193 | Train Acc: 0.6667
 Site-photo                     (2) | Train Loss: 1.2504 | Train Acc: 0.7857
 Site-photo                     (2) | Train Loss: 1.3820 | Train Acc: 0.7551
 Site-photo                     (2) | Train Loss: 1.3290 | Train Acc: 0.7500
 Site-photo                     (2) | Train Loss: 1.2914 | Train Acc: 0.8217
 Site-sketch                    (0) | Train Loss: 1.6715 | Train Acc: 0.2143
 Site-sketch                    (3) | Train Loss: 1.7221 | Train Acc: 0.2887
 Site-cartoon                   (1) | Train Loss: 1.7419 | Train Acc: 0.2917
Average Train Accuracy: 0.5561
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6111
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4783
 Best site-art_painting              | Epoch:2 | Val Acc: 0.3667
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5789
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4800
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5781
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5301
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6075
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6115
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5944
 Best site-photo                     | Epoch:2 | Val Acc: 0.6667
 Best site-photo                     | Epoch:2 | Val Acc: 0.7857
 Best site-photo                     | Epoch:2 | Val Acc: 0.7551
 Best site-photo                     | Epoch:2 | Val Acc: 0.7500
 Best site-photo                     | Epoch:2 | Val Acc: 0.8217
 Best site-sketch                    | Epoch:2 | Val Acc: 0.2143
 Best site-sketch                    | Epoch:2 | Val Acc: 0.2887
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.2917
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 3 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-art_painting              (0) | Train Loss: 1.3282 | Train Acc: 0.7222
 Site-art_painting              (0) | Train Loss: 1.4351 | Train Acc: 0.5217
 Site-art_painting              (0) | Train Loss: 1.5091 | Train Acc: 0.5333
 Site-art_painting              (0) | Train Loss: 1.2271 | Train Acc: 0.6579
 Site-art_painting              (0) | Train Loss: 1.3616 | Train Acc: 0.6400
 Site-art_painting              (0) | Train Loss: 1.2664 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 1.3660 | Train Acc: 0.6265
 Site-art_painting              (0) | Train Loss: 1.3013 | Train Acc: 0.6822
 Site-art_painting              (0) | Train Loss: 1.2395 | Train Acc: 0.6906
 Site-art_painting              (0) | Train Loss: 1.2874 | Train Acc: 0.7167
 Site-photo                     (2) | Train Loss: 1.3064 | Train Acc: 0.8667
 Site-photo                     (2) | Train Loss: 1.0662 | Train Acc: 0.8929
 Site-photo                     (2) | Train Loss: 1.1214 | Train Acc: 0.8163
 Site-photo                     (2) | Train Loss: 1.1401 | Train Acc: 0.8636
 Site-photo                     (2) | Train Loss: 1.0929 | Train Acc: 0.8981
 Site-sketch                    (1) | Train Loss: 1.7508 | Train Acc: 0.2143
 Site-sketch                    (1) | Train Loss: 1.7183 | Train Acc: 0.3310
 Site-cartoon                   (3) | Train Loss: 1.5987 | Train Acc: 0.4167
Average Train Accuracy: 0.6578
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7222
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5217
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5333
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6579
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6400
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6265
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6822
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6906
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7167
 Best site-photo                     | Epoch:3 | Val Acc: 0.8667
 Best site-photo                     | Epoch:3 | Val Acc: 0.8929
 Best site-photo                     | Epoch:3 | Val Acc: 0.8163
 Best site-photo                     | Epoch:3 | Val Acc: 0.8636
 Best site-photo                     | Epoch:3 | Val Acc: 0.8981
 Best site-sketch                    | Epoch:3 | Val Acc: 0.2143
 Best site-sketch                    | Epoch:3 | Val Acc: 0.3310
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.4167
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 10, 5, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-art_painting              (1) | Train Loss: 1.1153 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 1.2928 | Train Acc: 0.6087
 Site-art_painting              (1) | Train Loss: 1.3242 | Train Acc: 0.5333
 Site-art_painting              (1) | Train Loss: 1.1074 | Train Acc: 0.7368
 Site-art_painting              (1) | Train Loss: 1.2745 | Train Acc: 0.6200
 Site-art_painting              (1) | Train Loss: 1.1412 | Train Acc: 0.7188
 Site-art_painting              (1) | Train Loss: 1.2022 | Train Acc: 0.7108
 Site-art_painting              (1) | Train Loss: 1.1022 | Train Acc: 0.7383
 Site-art_painting              (1) | Train Loss: 1.1590 | Train Acc: 0.7194
 Site-art_painting              (1) | Train Loss: 1.1392 | Train Acc: 0.7611
 Site-photo                     (2) | Train Loss: 1.1166 | Train Acc: 0.8000
 Site-photo                     (2) | Train Loss: 0.9099 | Train Acc: 0.8571
 Site-photo                     (2) | Train Loss: 0.9528 | Train Acc: 0.8571
 Site-photo                     (2) | Train Loss: 0.9500 | Train Acc: 0.8977
 Site-photo                     (2) | Train Loss: 0.9126 | Train Acc: 0.8981
 Site-sketch                    (0) | Train Loss: 1.7964 | Train Acc: 0.2143
 Site-sketch                    (0) | Train Loss: 1.6761 | Train Acc: 0.3310
 Site-cartoon                   (3) | Train Loss: 1.5830 | Train Acc: 0.4722
Average Train Accuracy: 0.6838
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6087
 Best site-art_painting              | Epoch:4 | Val Acc: 0.5333
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7368
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6200
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7188
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7108
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7383
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7194
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7611
 Best site-photo                     | Epoch:4 | Val Acc: 0.8000
 Best site-photo                     | Epoch:4 | Val Acc: 0.8571
 Best site-photo                     | Epoch:4 | Val Acc: 0.8571
 Best site-photo                     | Epoch:4 | Val Acc: 0.8977
 Best site-photo                     | Epoch:4 | Val Acc: 0.8981
 Best site-sketch                    | Epoch:4 | Val Acc: 0.2143
 Best site-sketch                    | Epoch:4 | Val Acc: 0.3310
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.4722
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 5 ============
cnt=[5, 2, 10, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-art_painting              (2) | Train Loss: 0.9248 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 1.2886 | Train Acc: 0.5217
 Site-art_painting              (2) | Train Loss: 1.1991 | Train Acc: 0.6000
 Site-art_painting              (2) | Train Loss: 1.0337 | Train Acc: 0.7105
 Site-art_painting              (2) | Train Loss: 1.1587 | Train Acc: 0.6800
 Site-art_painting              (2) | Train Loss: 0.9566 | Train Acc: 0.8281
 Site-art_painting              (2) | Train Loss: 1.1106 | Train Acc: 0.7590
 Site-art_painting              (2) | Train Loss: 1.0424 | Train Acc: 0.7664
 Site-art_painting              (2) | Train Loss: 1.0014 | Train Acc: 0.7770
 Site-art_painting              (2) | Train Loss: 1.0172 | Train Acc: 0.8000
 Site-photo                     (0) | Train Loss: 0.9443 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7682 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 0.8474 | Train Acc: 0.8980
 Site-photo                     (0) | Train Loss: 0.8160 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.7537 | Train Acc: 0.9427
 Site-sketch                    (1) | Train Loss: 1.6384 | Train Acc: 0.2143
 Site-sketch                    (1) | Train Loss: 1.5805 | Train Acc: 0.3521
 Site-cartoon                   (3) | Train Loss: 1.4407 | Train Acc: 0.4722
Average Train Accuracy: 0.7268
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:5 | Val Acc: 0.5217
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6000
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7105
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6800
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8281
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7590
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7664
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7770
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8000
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9286
 Best site-photo                     | Epoch:5 | Val Acc: 0.8980
 Best site-photo                     | Epoch:5 | Val Acc: 0.9432
 Best site-photo                     | Epoch:5 | Val Acc: 0.9427
 Best site-sketch                    | Epoch:5 | Val Acc: 0.2143
 Best site-sketch                    | Epoch:5 | Val Acc: 0.3521
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.4722
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 6 ============
cnt=[9, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-art_painting              (2) | Train Loss: 0.8753 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 1.0556 | Train Acc: 0.7391
 Site-art_painting              (0) | Train Loss: 1.1112 | Train Acc: 0.7333
 Site-art_painting              (0) | Train Loss: 0.9074 | Train Acc: 0.7632
 Site-art_painting              (0) | Train Loss: 0.9780 | Train Acc: 0.8200
 Site-art_painting              (0) | Train Loss: 0.8578 | Train Acc: 0.8438
 Site-art_painting              (0) | Train Loss: 0.9515 | Train Acc: 0.7952
 Site-art_painting              (0) | Train Loss: 0.9785 | Train Acc: 0.8224
 Site-art_painting              (0) | Train Loss: 0.9226 | Train Acc: 0.8058
 Site-art_painting              (0) | Train Loss: 0.9302 | Train Acc: 0.8056
 Site-photo                     (2) | Train Loss: 0.9081 | Train Acc: 0.9333
 Site-photo                     (2) | Train Loss: 0.6281 | Train Acc: 0.9643
 Site-photo                     (2) | Train Loss: 0.7439 | Train Acc: 0.8980
 Site-photo                     (2) | Train Loss: 0.6821 | Train Acc: 0.9545
 Site-photo                     (2) | Train Loss: 0.6740 | Train Acc: 0.9427
 Site-sketch                    (1) | Train Loss: 1.4153 | Train Acc: 0.2857
 Site-sketch                    (1) | Train Loss: 1.5082 | Train Acc: 0.4155
 Site-cartoon                   (3) | Train Loss: 1.2872 | Train Acc: 0.5556
Average Train Accuracy: 0.7759
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7391
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7632
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8438
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7952
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8224
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8058
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8056
 Best site-photo                     | Epoch:6 | Val Acc: 0.9333
 Best site-photo                     | Epoch:6 | Val Acc: 0.9643
 Best site-photo                     | Epoch:6 | Val Acc: 0.8980
 Best site-photo                     | Epoch:6 | Val Acc: 0.9545
 Best site-photo                     | Epoch:6 | Val Acc: 0.9427
 Best site-sketch                    | Epoch:6 | Val Acc: 0.2857
 Best site-sketch                    | Epoch:6 | Val Acc: 0.4155
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.5556
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 2, 5, 8, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-art_painting              (0) | Train Loss: 0.7249 | Train Acc: 0.9444
 Site-art_painting              (3) | Train Loss: 0.9344 | Train Acc: 0.7826
 Site-art_painting              (0) | Train Loss: 1.0117 | Train Acc: 0.7000
 Site-art_painting              (3) | Train Loss: 0.8739 | Train Acc: 0.7895
 Site-art_painting              (3) | Train Loss: 0.8717 | Train Acc: 0.7800
 Site-art_painting              (0) | Train Loss: 0.7482 | Train Acc: 0.8438
 Site-art_painting              (3) | Train Loss: 0.8102 | Train Acc: 0.8434
 Site-art_painting              (3) | Train Loss: 0.8410 | Train Acc: 0.8318
 Site-art_painting              (3) | Train Loss: 0.7768 | Train Acc: 0.8417
 Site-art_painting              (3) | Train Loss: 0.7845 | Train Acc: 0.8333
 Site-photo                     (2) | Train Loss: 0.7350 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.5211 | Train Acc: 0.9286
 Site-photo                     (2) | Train Loss: 0.6857 | Train Acc: 0.9592
 Site-photo                     (2) | Train Loss: 0.6022 | Train Acc: 0.9545
 Site-photo                     (2) | Train Loss: 0.5971 | Train Acc: 0.9490
 Site-sketch                    (1) | Train Loss: 1.3493 | Train Acc: 0.3571
 Site-sketch                    (1) | Train Loss: 1.3432 | Train Acc: 0.5141
 Site-cartoon                   (2) | Train Loss: 1.3981 | Train Acc: 0.5833
Average Train Accuracy: 0.8020
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7826
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7000
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7895
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7800
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8438
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8434
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8318
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8417
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8333
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 0.9286
 Best site-photo                     | Epoch:7 | Val Acc: 0.9592
 Best site-photo                     | Epoch:7 | Val Acc: 0.9545
 Best site-photo                     | Epoch:7 | Val Acc: 0.9490
 Best site-sketch                    | Epoch:7 | Val Acc: 0.3571
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5141
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 9, 5, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-art_painting              (0) | Train Loss: 0.6878 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.9872 | Train Acc: 0.8261
 Site-art_painting              (2) | Train Loss: 0.9256 | Train Acc: 0.8000
 Site-art_painting              (2) | Train Loss: 0.7466 | Train Acc: 0.8158
 Site-art_painting              (2) | Train Loss: 0.8075 | Train Acc: 0.8400
 Site-art_painting              (2) | Train Loss: 0.7657 | Train Acc: 0.8281
 Site-art_painting              (2) | Train Loss: 0.7770 | Train Acc: 0.8434
 Site-art_painting              (2) | Train Loss: 0.7215 | Train Acc: 0.8692
 Site-art_painting              (2) | Train Loss: 0.7562 | Train Acc: 0.8417
 Site-art_painting              (2) | Train Loss: 0.7252 | Train Acc: 0.8722
 Site-photo                     (3) | Train Loss: 0.7192 | Train Acc: 0.9333
 Site-photo                     (3) | Train Loss: 0.4750 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.5963 | Train Acc: 0.9592
 Site-photo                     (3) | Train Loss: 0.5348 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.5427 | Train Acc: 0.9427
 Site-sketch                    (1) | Train Loss: 1.0878 | Train Acc: 0.6429
 Site-sketch                    (1) | Train Loss: 1.2145 | Train Acc: 0.6479
 Site-cartoon                   (0) | Train Loss: 1.1531 | Train Acc: 0.6389
Average Train Accuracy: 0.8363
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8158
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8281
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8434
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8692
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8417
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8722
 Best site-photo                     | Epoch:8 | Val Acc: 0.9333
 Best site-photo                     | Epoch:8 | Val Acc: 0.9643
 Best site-photo                     | Epoch:8 | Val Acc: 0.9592
 Best site-photo                     | Epoch:8 | Val Acc: 0.9545
 Best site-photo                     | Epoch:8 | Val Acc: 0.9427
 Best site-sketch                    | Epoch:8 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:8 | Val Acc: 0.6479
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.6389
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 9 ============
cnt=[12, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-art_painting              (0) | Train Loss: 0.7602 | Train Acc: 0.7778
 Site-art_painting              (0) | Train Loss: 0.8385 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.8285 | Train Acc: 0.7333
 Site-art_painting              (0) | Train Loss: 0.6496 | Train Acc: 0.8421
 Site-art_painting              (0) | Train Loss: 0.6980 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.6908 | Train Acc: 0.8438
 Site-art_painting              (0) | Train Loss: 0.6514 | Train Acc: 0.8675
 Site-art_painting              (0) | Train Loss: 0.6577 | Train Acc: 0.8785
 Site-art_painting              (0) | Train Loss: 0.6988 | Train Acc: 0.8489
 Site-art_painting              (0) | Train Loss: 0.6366 | Train Acc: 0.9056
 Site-photo                     (0) | Train Loss: 0.6156 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4028 | Train Acc: 0.9643
 Site-photo                     (2) | Train Loss: 0.5175 | Train Acc: 0.9592
 Site-photo                     (2) | Train Loss: 0.4692 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.4744 | Train Acc: 0.9554
 Site-sketch                    (3) | Train Loss: 1.0576 | Train Acc: 0.5714
 Site-sketch                    (1) | Train Loss: 1.0281 | Train Acc: 0.7042
 Site-cartoon                   (2) | Train Loss: 1.0288 | Train Acc: 0.6111
Average Train Accuracy: 0.8437
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8421
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8438
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8675
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8785
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8489
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9056
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 0.9643
 Best site-photo                     | Epoch:9 | Val Acc: 0.9592
 Best site-photo                     | Epoch:9 | Val Acc: 0.9545
 Best site-photo                     | Epoch:9 | Val Acc: 0.9554
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5714
 Best site-sketch                    | Epoch:9 | Val Acc: 0.7042
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.6111
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 10 ============
cnt=[6, 1, 10, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-art_painting              (2) | Train Loss: 0.5296 | Train Acc: 0.9444
 Site-art_painting              (2) | Train Loss: 0.7449 | Train Acc: 0.7391
 Site-art_painting              (2) | Train Loss: 0.8021 | Train Acc: 0.7333
 Site-art_painting              (2) | Train Loss: 0.7193 | Train Acc: 0.8158
 Site-art_painting              (2) | Train Loss: 0.5692 | Train Acc: 0.9000
 Site-art_painting              (2) | Train Loss: 0.5357 | Train Acc: 0.9219
 Site-art_painting              (2) | Train Loss: 0.5965 | Train Acc: 0.8795
 Site-art_painting              (2) | Train Loss: 0.5400 | Train Acc: 0.9065
 Site-art_painting              (2) | Train Loss: 0.6075 | Train Acc: 0.8705
 Site-art_painting              (2) | Train Loss: 0.5432 | Train Acc: 0.9000
 Site-photo                     (0) | Train Loss: 0.5236 | Train Acc: 0.9333
 Site-photo                     (0) | Train Loss: 0.4052 | Train Acc: 0.9643
 Site-photo                     (0) | Train Loss: 0.4541 | Train Acc: 0.9388
 Site-photo                     (0) | Train Loss: 0.3976 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.4199 | Train Acc: 0.9490
 Site-sketch                    (1) | Train Loss: 0.9657 | Train Acc: 0.6429
 Site-sketch                    (3) | Train Loss: 0.9847 | Train Acc: 0.6690
 Site-cartoon                   (0) | Train Loss: 1.0824 | Train Acc: 0.6250
Average Train Accuracy: 0.8506
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7391
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8158
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8795
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9065
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8705
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9333
 Best site-photo                     | Epoch:10 | Val Acc: 0.9643
 Best site-photo                     | Epoch:10 | Val Acc: 0.9388
 Best site-photo                     | Epoch:10 | Val Acc: 0.9773
 Best site-photo                     | Epoch:10 | Val Acc: 0.9490
 Best site-sketch                    | Epoch:10 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:10 | Val Acc: 0.6690
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.6250
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 11 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-art_painting              (0) | Train Loss: 0.5886 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.6899 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.6844 | Train Acc: 0.8000
 Site-art_painting              (0) | Train Loss: 0.6211 | Train Acc: 0.8158
 Site-art_painting              (0) | Train Loss: 0.5242 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.4688 | Train Acc: 0.9531
 Site-art_painting              (0) | Train Loss: 0.5935 | Train Acc: 0.8554
 Site-art_painting              (0) | Train Loss: 0.5381 | Train Acc: 0.9065
 Site-art_painting              (0) | Train Loss: 0.5925 | Train Acc: 0.8849
 Site-art_painting              (0) | Train Loss: 0.5356 | Train Acc: 0.8944
 Site-photo                     (3) | Train Loss: 0.4603 | Train Acc: 0.9333
 Site-photo                     (3) | Train Loss: 0.3661 | Train Acc: 0.9286
 Site-photo                     (3) | Train Loss: 0.4004 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.3691 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.3665 | Train Acc: 0.9618
 Site-sketch                    (2) | Train Loss: 0.8797 | Train Acc: 0.7143
 Site-sketch                    (2) | Train Loss: 0.9649 | Train Acc: 0.7113
 Site-cartoon                   (1) | Train Loss: 0.9529 | Train Acc: 0.6389
Average Train Accuracy: 0.8631
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8158
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9531
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8554
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9065
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8849
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8944
 Best site-photo                     | Epoch:11 | Val Acc: 0.9333
 Best site-photo                     | Epoch:11 | Val Acc: 0.9286
 Best site-photo                     | Epoch:11 | Val Acc: 0.9796
 Best site-photo                     | Epoch:11 | Val Acc: 0.9545
 Best site-photo                     | Epoch:11 | Val Acc: 0.9618
 Best site-sketch                    | Epoch:11 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:11 | Val Acc: 0.7113
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.6389
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 12 ============
cnt=[3, 2, 3, 10, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-art_painting              (3) | Train Loss: 0.4919 | Train Acc: 0.9444
 Site-art_painting              (3) | Train Loss: 0.7298 | Train Acc: 0.8261
 Site-art_painting              (3) | Train Loss: 0.5637 | Train Acc: 0.8667
 Site-art_painting              (3) | Train Loss: 0.4012 | Train Acc: 0.8947
 Site-art_painting              (3) | Train Loss: 0.4958 | Train Acc: 0.9200
 Site-art_painting              (3) | Train Loss: 0.4753 | Train Acc: 0.9062
 Site-art_painting              (3) | Train Loss: 0.4998 | Train Acc: 0.8916
 Site-art_painting              (3) | Train Loss: 0.5014 | Train Acc: 0.8879
 Site-art_painting              (3) | Train Loss: 0.5225 | Train Acc: 0.8849
 Site-art_painting              (3) | Train Loss: 0.4374 | Train Acc: 0.9222
 Site-photo                     (2) | Train Loss: 0.4088 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3436 | Train Acc: 0.9643
 Site-photo                     (2) | Train Loss: 0.3623 | Train Acc: 0.9796
 Site-photo                     (0) | Train Loss: 0.3321 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.3420 | Train Acc: 0.9427
 Site-sketch                    (1) | Train Loss: 0.9041 | Train Acc: 0.7143
 Site-sketch                    (1) | Train Loss: 0.8269 | Train Acc: 0.7676
 Site-cartoon                   (2) | Train Loss: 0.9733 | Train Acc: 0.7083
Average Train Accuracy: 0.8888
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9062
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8916
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8879
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8849
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9222
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 0.9643
 Best site-photo                     | Epoch:12 | Val Acc: 0.9796
 Best site-photo                     | Epoch:12 | Val Acc: 0.9773
 Best site-photo                     | Epoch:12 | Val Acc: 0.9427
 Best site-sketch                    | Epoch:12 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:12 | Val Acc: 0.7676
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.7083
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 13 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-art_painting              (0) | Train Loss: 0.5105 | Train Acc: 0.9444
 Site-art_painting              (0) | Train Loss: 0.6883 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.6435 | Train Acc: 0.7667
 Site-art_painting              (0) | Train Loss: 0.4202 | Train Acc: 0.9211
 Site-art_painting              (0) | Train Loss: 0.4756 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.4758 | Train Acc: 0.9062
 Site-art_painting              (0) | Train Loss: 0.4642 | Train Acc: 0.8795
 Site-art_painting              (0) | Train Loss: 0.4248 | Train Acc: 0.8972
 Site-art_painting              (0) | Train Loss: 0.4881 | Train Acc: 0.8921
 Site-art_painting              (0) | Train Loss: 0.4452 | Train Acc: 0.9056
 Site-photo                     (2) | Train Loss: 0.3740 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2779 | Train Acc: 0.9643
 Site-photo                     (2) | Train Loss: 0.3515 | Train Acc: 0.9796
 Site-photo                     (2) | Train Loss: 0.3218 | Train Acc: 0.9773
 Site-photo                     (2) | Train Loss: 0.3010 | Train Acc: 0.9682
 Site-sketch                    (1) | Train Loss: 0.7488 | Train Acc: 0.7857
 Site-sketch                    (1) | Train Loss: 0.8708 | Train Acc: 0.7324
 Site-cartoon                   (3) | Train Loss: 1.0536 | Train Acc: 0.6806
Average Train Accuracy: 0.8872
============ Train epoch 14 ============
cnt=[5, 2, 8, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-art_painting              (2) | Train Loss: 0.4768 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.5793 | Train Acc: 0.9130
 Site-art_painting              (2) | Train Loss: 0.5599 | Train Acc: 0.9000
 Site-art_painting              (2) | Train Loss: 0.4552 | Train Acc: 0.8684
 Site-art_painting              (2) | Train Loss: 0.4857 | Train Acc: 0.9200
 Site-art_painting              (2) | Train Loss: 0.3767 | Train Acc: 0.9531
 Site-art_painting              (3) | Train Loss: 0.5163 | Train Acc: 0.8072
 Site-art_painting              (2) | Train Loss: 0.4222 | Train Acc: 0.8785
 Site-art_painting              (3) | Train Loss: 0.4328 | Train Acc: 0.9065
 Site-art_painting              (2) | Train Loss: 0.4556 | Train Acc: 0.8944
 Site-photo                     (0) | Train Loss: 0.2948 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2656 | Train Acc: 0.9643
 Site-photo                     (0) | Train Loss: 0.2844 | Train Acc: 0.9796
 Site-photo                     (0) | Train Loss: 0.2866 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.2901 | Train Acc: 0.9618
 Site-sketch                    (1) | Train Loss: 0.8348 | Train Acc: 0.7143
 Site-sketch                    (1) | Train Loss: 0.7949 | Train Acc: 0.7394
 Site-cartoon                   (0) | Train Loss: 0.7695 | Train Acc: 0.7083
Average Train Accuracy: 0.8869
============ Train epoch 15 ============
cnt=[12, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-art_painting              (0) | Train Loss: 0.3929 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.6224 | Train Acc: 0.8261
 Site-art_painting              (0) | Train Loss: 0.5815 | Train Acc: 0.7667
 Site-art_painting              (0) | Train Loss: 0.5724 | Train Acc: 0.8421
 Site-art_painting              (0) | Train Loss: 0.5178 | Train Acc: 0.8800
 Site-art_painting              (0) | Train Loss: 0.4439 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.4866 | Train Acc: 0.8795
 Site-art_painting              (0) | Train Loss: 0.3608 | Train Acc: 0.9346
 Site-art_painting              (0) | Train Loss: 0.4806 | Train Acc: 0.8705
 Site-art_painting              (0) | Train Loss: 0.4242 | Train Acc: 0.9167
 Site-photo                     (2) | Train Loss: 0.3066 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2551 | Train Acc: 0.9643
 Site-photo                     (2) | Train Loss: 0.2970 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2543 | Train Acc: 0.9773
 Site-photo                     (2) | Train Loss: 0.2645 | Train Acc: 0.9745
 Site-sketch                    (1) | Train Loss: 0.8851 | Train Acc: 0.6429
 Site-sketch                    (1) | Train Loss: 0.6646 | Train Acc: 0.7887
 Site-cartoon                   (3) | Train Loss: 0.9355 | Train Acc: 0.6944
Average Train Accuracy: 0.8735
============ Train epoch 16 ============
cnt=[1, 9, 2, 6, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-art_painting              (3) | Train Loss: 0.4520 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.6607 | Train Acc: 0.7826
 Site-art_painting              (1) | Train Loss: 0.6280 | Train Acc: 0.7333
 Site-art_painting              (1) | Train Loss: 0.3980 | Train Acc: 0.8684
 Site-art_painting              (1) | Train Loss: 0.4558 | Train Acc: 0.9200
 Site-art_painting              (1) | Train Loss: 0.3930 | Train Acc: 0.9375
 Site-art_painting              (1) | Train Loss: 0.4284 | Train Acc: 0.8916
 Site-art_painting              (1) | Train Loss: 0.4454 | Train Acc: 0.9065
 Site-art_painting              (1) | Train Loss: 0.4192 | Train Acc: 0.8777
 Site-art_painting              (1) | Train Loss: 0.3780 | Train Acc: 0.9222
 Site-photo                     (3) | Train Loss: 0.2633 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1990 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2457 | Train Acc: 0.9592
 Site-photo                     (3) | Train Loss: 0.2420 | Train Acc: 0.9659
 Site-photo                     (3) | Train Loss: 0.2614 | Train Acc: 0.9618
 Site-sketch                    (2) | Train Loss: 0.8718 | Train Acc: 0.5000
 Site-sketch                    (2) | Train Loss: 0.7052 | Train Acc: 0.7817
 Site-cartoon                   (0) | Train Loss: 0.6405 | Train Acc: 0.7778
Average Train Accuracy: 0.8708
============ Train epoch 17 ============
cnt=[6, 2, 9, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-art_painting              (0) | Train Loss: 0.4218 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.5630 | Train Acc: 0.8696
 Site-art_painting              (2) | Train Loss: 0.5220 | Train Acc: 0.8667
 Site-art_painting              (2) | Train Loss: 0.5013 | Train Acc: 0.9474
 Site-art_painting              (2) | Train Loss: 0.4417 | Train Acc: 0.8800
 Site-art_painting              (2) | Train Loss: 0.3091 | Train Acc: 0.9375
 Site-art_painting              (2) | Train Loss: 0.4369 | Train Acc: 0.8554
 Site-art_painting              (2) | Train Loss: 0.3056 | Train Acc: 0.9626
 Site-art_painting              (2) | Train Loss: 0.3728 | Train Acc: 0.8849
 Site-art_painting              (2) | Train Loss: 0.3775 | Train Acc: 0.9111
 Site-photo                     (0) | Train Loss: 0.2235 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2009 | Train Acc: 0.9643
 Site-photo                     (0) | Train Loss: 0.2681 | Train Acc: 0.9388
 Site-photo                     (0) | Train Loss: 0.2263 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.2377 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.8202 | Train Acc: 0.6429
 Site-sketch                    (1) | Train Loss: 0.6499 | Train Acc: 0.8169
 Site-cartoon                   (3) | Train Loss: 0.9495 | Train Acc: 0.7917
Average Train Accuracy: 0.8947
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8554
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9626
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8849
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9111
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 0.9643
 Best site-photo                     | Epoch:17 | Val Acc: 0.9388
 Best site-photo                     | Epoch:17 | Val Acc: 0.9659
 Best site-photo                     | Epoch:17 | Val Acc: 0.9809
 Best site-sketch                    | Epoch:17 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:17 | Val Acc: 0.8169
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.7917
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 18 ============
cnt=[9, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-art_painting              (2) | Train Loss: 0.4161 | Train Acc: 0.9444
 Site-art_painting              (0) | Train Loss: 0.5783 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.4764 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.3899 | Train Acc: 0.8947
 Site-art_painting              (0) | Train Loss: 0.3736 | Train Acc: 0.9200
 Site-art_painting              (0) | Train Loss: 0.3449 | Train Acc: 0.9375
 Site-art_painting              (0) | Train Loss: 0.3816 | Train Acc: 0.9157
 Site-art_painting              (0) | Train Loss: 0.3339 | Train Acc: 0.9346
 Site-art_painting              (0) | Train Loss: 0.4273 | Train Acc: 0.8777
 Site-art_painting              (0) | Train Loss: 0.3929 | Train Acc: 0.8889
 Site-photo                     (2) | Train Loss: 0.2646 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1848 | Train Acc: 0.9643
 Site-photo                     (2) | Train Loss: 0.2316 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1868 | Train Acc: 0.9886
 Site-photo                     (2) | Train Loss: 0.2320 | Train Acc: 0.9554
 Site-sketch                    (1) | Train Loss: 0.7297 | Train Acc: 0.7143
 Site-sketch                    (1) | Train Loss: 0.6361 | Train Acc: 0.8169
 Site-cartoon                   (3) | Train Loss: 0.7095 | Train Acc: 0.7361
Average Train Accuracy: 0.8996
 Best site-art_painting              | Epoch:18 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:18 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:18 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:18 | Val Acc: 0.9157
 Best site-art_painting              | Epoch:18 | Val Acc: 0.9346
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8777
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8889
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 0.9643
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 0.9886
 Best site-photo                     | Epoch:18 | Val Acc: 0.9554
 Best site-sketch                    | Epoch:18 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:18 | Val Acc: 0.8169
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.7361
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-art_painting              (3) | Train Loss: 0.3973 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.6027 | Train Acc: 0.7826
 Site-art_painting              (1) | Train Loss: 0.5748 | Train Acc: 0.7667
 Site-art_painting              (1) | Train Loss: 0.5716 | Train Acc: 0.8684
 Site-art_painting              (1) | Train Loss: 0.3611 | Train Acc: 0.9400
 Site-art_painting              (1) | Train Loss: 0.3376 | Train Acc: 0.8906
 Site-art_painting              (1) | Train Loss: 0.4001 | Train Acc: 0.8554
 Site-art_painting              (1) | Train Loss: 0.3056 | Train Acc: 0.9533
 Site-art_painting              (1) | Train Loss: 0.3788 | Train Acc: 0.8921
 Site-art_painting              (1) | Train Loss: 0.3479 | Train Acc: 0.9278
 Site-photo                     (3) | Train Loss: 0.2226 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1998 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.2533 | Train Acc: 0.9592
 Site-photo                     (3) | Train Loss: 0.1841 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.2076 | Train Acc: 0.9682
 Site-sketch                    (0) | Train Loss: 0.7926 | Train Acc: 0.7143
 Site-sketch                    (0) | Train Loss: 0.5563 | Train Acc: 0.8521
 Site-cartoon                   (2) | Train Loss: 0.8063 | Train Acc: 0.7500
Average Train Accuracy: 0.8868
============ Train epoch 20 ============
cnt=[9, 2, 1, 6, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-art_painting              (3) | Train Loss: 0.3189 | Train Acc: 0.9444
 Site-art_painting              (0) | Train Loss: 0.5424 | Train Acc: 0.8696
 Site-art_painting              (3) | Train Loss: 0.3943 | Train Acc: 0.8667
 Site-art_painting              (0) | Train Loss: 0.2708 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.3152 | Train Acc: 0.9600
 Site-art_painting              (0) | Train Loss: 0.3661 | Train Acc: 0.8906
 Site-art_painting              (0) | Train Loss: 0.3818 | Train Acc: 0.9036
 Site-art_painting              (0) | Train Loss: 0.3257 | Train Acc: 0.9159
 Site-art_painting              (0) | Train Loss: 0.3806 | Train Acc: 0.8849
 Site-art_painting              (0) | Train Loss: 0.3154 | Train Acc: 0.9389
 Site-photo                     (0) | Train Loss: 0.2569 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2381 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.2018 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1932 | Train Acc: 0.9432
 Site-photo                     (3) | Train Loss: 0.1921 | Train Acc: 0.9745
 Site-sketch                    (1) | Train Loss: 0.7263 | Train Acc: 0.7143
 Site-sketch                    (1) | Train Loss: 0.5918 | Train Acc: 0.8521
 Site-cartoon                   (2) | Train Loss: 0.7361 | Train Acc: 0.7500
Average Train Accuracy: 0.9056
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:20 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:20 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:20 | Val Acc: 0.8906
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9036
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9159
 Best site-art_painting              | Epoch:20 | Val Acc: 0.8849
 Best site-art_painting              | Epoch:20 | Val Acc: 0.9389
 Best site-photo                     | Epoch:20 | Val Acc: 1.0000
 Best site-photo                     | Epoch:20 | Val Acc: 0.9643
 Best site-photo                     | Epoch:20 | Val Acc: 0.9796
 Best site-photo                     | Epoch:20 | Val Acc: 0.9432
 Best site-photo                     | Epoch:20 | Val Acc: 0.9745
 Best site-sketch                    | Epoch:20 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:20 | Val Acc: 0.8521
 Best site-cartoon                   | Epoch:20 | Val Acc: 0.7500
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 9, 6, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-art_painting              (2) | Train Loss: 0.3854 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.5956 | Train Acc: 0.8261
 Site-art_painting              (1) | Train Loss: 0.4179 | Train Acc: 0.8667
 Site-art_painting              (1) | Train Loss: 0.3661 | Train Acc: 0.8421
 Site-art_painting              (1) | Train Loss: 0.2891 | Train Acc: 0.9000
 Site-art_painting              (1) | Train Loss: 0.3063 | Train Acc: 0.9062
 Site-art_painting              (1) | Train Loss: 0.3738 | Train Acc: 0.8675
 Site-art_painting              (1) | Train Loss: 0.3509 | Train Acc: 0.9439
 Site-art_painting              (1) | Train Loss: 0.3550 | Train Acc: 0.8705
 Site-art_painting              (1) | Train Loss: 0.2917 | Train Acc: 0.9389
 Site-photo                     (2) | Train Loss: 0.1845 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2298 | Train Acc: 0.9286
 Site-photo                     (2) | Train Loss: 0.1730 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1809 | Train Acc: 0.9773
 Site-photo                     (2) | Train Loss: 0.2009 | Train Acc: 0.9682
 Site-sketch                    (0) | Train Loss: 0.8079 | Train Acc: 0.7143
 Site-sketch                    (0) | Train Loss: 0.6033 | Train Acc: 0.8451
 Site-cartoon                   (3) | Train Loss: 0.6117 | Train Acc: 0.8056
Average Train Accuracy: 0.8939
============ Train epoch 22 ============
cnt=[9, 2, 1, 6, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-art_painting              (3) | Train Loss: 0.3891 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.5999 | Train Acc: 0.8261
 Site-art_painting              (0) | Train Loss: 0.4035 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.2198 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.3251 | Train Acc: 0.9200
 Site-art_painting              (0) | Train Loss: 0.3282 | Train Acc: 0.9219
 Site-art_painting              (0) | Train Loss: 0.3519 | Train Acc: 0.8795
 Site-art_painting              (0) | Train Loss: 0.2707 | Train Acc: 0.9439
 Site-art_painting              (0) | Train Loss: 0.3557 | Train Acc: 0.8921
 Site-art_painting              (0) | Train Loss: 0.3100 | Train Acc: 0.9222
 Site-photo                     (3) | Train Loss: 0.2036 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1954 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.1753 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1838 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.1828 | Train Acc: 0.9745
 Site-sketch                    (1) | Train Loss: 0.5212 | Train Acc: 0.7857
 Site-sketch                    (1) | Train Loss: 0.5353 | Train Acc: 0.8310
 Site-cartoon                   (2) | Train Loss: 0.5529 | Train Acc: 0.8611
Average Train Accuracy: 0.9120
 Best site-art_painting              | Epoch:22 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:22 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:22 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:22 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:22 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:22 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:22 | Val Acc: 0.8795
 Best site-art_painting              | Epoch:22 | Val Acc: 0.9439
 Best site-art_painting              | Epoch:22 | Val Acc: 0.8921
 Best site-art_painting              | Epoch:22 | Val Acc: 0.9222
 Best site-photo                     | Epoch:22 | Val Acc: 1.0000
 Best site-photo                     | Epoch:22 | Val Acc: 0.9643
 Best site-photo                     | Epoch:22 | Val Acc: 0.9796
 Best site-photo                     | Epoch:22 | Val Acc: 0.9773
 Best site-photo                     | Epoch:22 | Val Acc: 0.9745
 Best site-sketch                    | Epoch:22 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:22 | Val Acc: 0.8310
 Best site-cartoon                   | Epoch:22 | Val Acc: 0.8611
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 23 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-art_painting              (0) | Train Loss: 0.3278 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.4236 | Train Acc: 0.8261
 Site-art_painting              (0) | Train Loss: 0.5203 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.2837 | Train Acc: 0.9211
 Site-art_painting              (0) | Train Loss: 0.3543 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3452 | Train Acc: 0.8906
 Site-art_painting              (0) | Train Loss: 0.3943 | Train Acc: 0.8795
 Site-art_painting              (0) | Train Loss: 0.2628 | Train Acc: 0.9252
 Site-art_painting              (0) | Train Loss: 0.3631 | Train Acc: 0.8993
 Site-art_painting              (0) | Train Loss: 0.2821 | Train Acc: 0.9500
 Site-photo                     (2) | Train Loss: 0.1880 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1683 | Train Acc: 0.9643
 Site-photo                     (2) | Train Loss: 0.1595 | Train Acc: 0.9796
 Site-photo                     (2) | Train Loss: 0.1603 | Train Acc: 0.9659
 Site-photo                     (2) | Train Loss: 0.1727 | Train Acc: 0.9745
 Site-sketch                    (1) | Train Loss: 0.7277 | Train Acc: 0.6429
 Site-sketch                    (1) | Train Loss: 0.5436 | Train Acc: 0.8310
 Site-cartoon                   (3) | Train Loss: 0.5579 | Train Acc: 0.7639
Average Train Accuracy: 0.8909
============ Train epoch 24 ============
cnt=[8, 2, 1, 7, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-art_painting              (3) | Train Loss: 0.4159 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.4380 | Train Acc: 0.8261
 Site-art_painting              (0) | Train Loss: 0.3521 | Train Acc: 0.9333
 Site-art_painting              (0) | Train Loss: 0.3539 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2562 | Train Acc: 0.9600
 Site-art_painting              (0) | Train Loss: 0.2979 | Train Acc: 0.9375
 Site-art_painting              (0) | Train Loss: 0.4152 | Train Acc: 0.8795
 Site-art_painting              (0) | Train Loss: 0.3307 | Train Acc: 0.9346
 Site-art_painting              (0) | Train Loss: 0.3176 | Train Acc: 0.9065
 Site-art_painting              (3) | Train Loss: 0.2345 | Train Acc: 0.9833
 Site-photo                     (3) | Train Loss: 0.1929 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1424 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1576 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1569 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1834 | Train Acc: 0.9745
 Site-sketch                    (1) | Train Loss: 0.6675 | Train Acc: 0.6429
 Site-sketch                    (1) | Train Loss: 0.5094 | Train Acc: 0.8521
 Site-cartoon                   (2) | Train Loss: 0.5123 | Train Acc: 0.8611
Average Train Accuracy: 0.9164
 Best site-art_painting              | Epoch:24 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:24 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:24 | Val Acc: 0.8795
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9346
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9065
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9833
 Best site-photo                     | Epoch:24 | Val Acc: 1.0000
 Best site-photo                     | Epoch:24 | Val Acc: 1.0000
 Best site-photo                     | Epoch:24 | Val Acc: 0.9796
 Best site-photo                     | Epoch:24 | Val Acc: 0.9886
 Best site-photo                     | Epoch:24 | Val Acc: 0.9745
 Best site-sketch                    | Epoch:24 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:24 | Val Acc: 0.8521
 Best site-cartoon                   | Epoch:24 | Val Acc: 0.8611
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 10, 2, 5, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-art_painting              (1) | Train Loss: 0.4141 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.4985 | Train Acc: 0.7826
 Site-art_painting              (1) | Train Loss: 0.3658 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.2875 | Train Acc: 0.9211
 Site-art_painting              (1) | Train Loss: 0.3222 | Train Acc: 0.9000
 Site-art_painting              (1) | Train Loss: 0.3408 | Train Acc: 0.8750
 Site-art_painting              (1) | Train Loss: 0.3576 | Train Acc: 0.8916
 Site-art_painting              (1) | Train Loss: 0.2261 | Train Acc: 0.9346
 Site-art_painting              (1) | Train Loss: 0.2985 | Train Acc: 0.9281
 Site-art_painting              (1) | Train Loss: 0.2839 | Train Acc: 0.9333
 Site-photo                     (3) | Train Loss: 0.1470 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1792 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.1724 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1425 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1647 | Train Acc: 0.9745
 Site-sketch                    (2) | Train Loss: 0.6685 | Train Acc: 0.6429
 Site-sketch                    (2) | Train Loss: 0.5362 | Train Acc: 0.8099
 Site-cartoon                   (0) | Train Loss: 0.6517 | Train Acc: 0.8194
Average Train Accuracy: 0.8926
============ Train epoch 26 ============
cnt=[9, 2, 1, 6, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-art_painting              (3) | Train Loss: 0.3605 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.5009 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.3886 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.5336 | Train Acc: 0.8947
 Site-art_painting              (0) | Train Loss: 0.2749 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.2539 | Train Acc: 0.9375
 Site-art_painting              (0) | Train Loss: 0.3103 | Train Acc: 0.9036
 Site-art_painting              (0) | Train Loss: 0.3112 | Train Acc: 0.9439
 Site-art_painting              (0) | Train Loss: 0.3285 | Train Acc: 0.8849
 Site-art_painting              (0) | Train Loss: 0.2833 | Train Acc: 0.9278
 Site-photo                     (3) | Train Loss: 0.1791 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1569 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.1532 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1619 | Train Acc: 0.9659
 Site-photo                     (3) | Train Loss: 0.1751 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.6826 | Train Acc: 0.7143
 Site-sketch                    (1) | Train Loss: 0.5136 | Train Acc: 0.8521
 Site-cartoon                   (2) | Train Loss: 0.6157 | Train Acc: 0.8194
Average Train Accuracy: 0.9071
============ Train epoch 27 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-art_painting              (0) | Train Loss: 0.3973 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.5675 | Train Acc: 0.7826
 Site-art_painting              (0) | Train Loss: 0.4197 | Train Acc: 0.8667
 Site-art_painting              (0) | Train Loss: 0.3355 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2299 | Train Acc: 0.9400
 Site-art_painting              (0) | Train Loss: 0.3263 | Train Acc: 0.9062
 Site-art_painting              (0) | Train Loss: 0.2847 | Train Acc: 0.9277
 Site-art_painting              (0) | Train Loss: 0.2891 | Train Acc: 0.9439
 Site-art_painting              (0) | Train Loss: 0.3831 | Train Acc: 0.9065
 Site-art_painting              (0) | Train Loss: 0.2397 | Train Acc: 0.9389
 Site-photo                     (3) | Train Loss: 0.1609 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1616 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.1729 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1623 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.1543 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.7596 | Train Acc: 0.7143
 Site-sketch                    (1) | Train Loss: 0.5114 | Train Acc: 0.8592
 Site-cartoon                   (2) | Train Loss: 0.5371 | Train Acc: 0.8194
Average Train Accuracy: 0.9080
============ Train epoch 28 ============
cnt=[9, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-art_painting              (2) | Train Loss: 0.3748 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.5433 | Train Acc: 0.8261
 Site-art_painting              (0) | Train Loss: 0.3140 | Train Acc: 0.9333
 Site-art_painting              (0) | Train Loss: 0.2209 | Train Acc: 0.9211
 Site-art_painting              (0) | Train Loss: 0.2468 | Train Acc: 0.9600
 Site-art_painting              (0) | Train Loss: 0.2656 | Train Acc: 0.9375
 Site-art_painting              (0) | Train Loss: 0.3372 | Train Acc: 0.8795
 Site-art_painting              (0) | Train Loss: 0.3452 | Train Acc: 0.9252
 Site-art_painting              (0) | Train Loss: 0.2847 | Train Acc: 0.9137
 Site-art_painting              (0) | Train Loss: 0.2311 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.2000 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2350 | Train Acc: 0.9643
 Site-photo                     (2) | Train Loss: 0.1632 | Train Acc: 0.9796
 Site-photo                     (2) | Train Loss: 0.1547 | Train Acc: 0.9773
 Site-photo                     (2) | Train Loss: 0.1498 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.7551 | Train Acc: 0.6429
 Site-sketch                    (1) | Train Loss: 0.5457 | Train Acc: 0.8099
 Site-cartoon                   (3) | Train Loss: 0.5497 | Train Acc: 0.7917
Average Train Accuracy: 0.9042
============ Train epoch 29 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-art_painting              (3) | Train Loss: 0.3765 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.3724 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.3384 | Train Acc: 0.9333
 Site-art_painting              (0) | Train Loss: 0.3040 | Train Acc: 0.8158
 Site-art_painting              (0) | Train Loss: 0.2214 | Train Acc: 0.9400
 Site-art_painting              (0) | Train Loss: 0.2598 | Train Acc: 0.9375
 Site-art_painting              (0) | Train Loss: 0.3182 | Train Acc: 0.9157
 Site-art_painting              (0) | Train Loss: 0.2037 | Train Acc: 0.9720
 Site-art_painting              (0) | Train Loss: 0.3465 | Train Acc: 0.9065
 Site-art_painting              (0) | Train Loss: 0.2259 | Train Acc: 0.9500
 Site-photo                     (3) | Train Loss: 0.1325 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1053 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1333 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1583 | Train Acc: 0.9659
 Site-photo                     (3) | Train Loss: 0.1506 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.9320 | Train Acc: 0.5714
 Site-sketch                    (1) | Train Loss: 0.5150 | Train Acc: 0.8521
 Site-cartoon                   (2) | Train Loss: 0.5102 | Train Acc: 0.8472
Average Train Accuracy: 0.9070
============ Train epoch 30 ============
cnt=[8, 2, 1, 7, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-art_painting              (3) | Train Loss: 0.2241 | Train Acc: 0.9444
 Site-art_painting              (0) | Train Loss: 0.3838 | Train Acc: 0.9130
 Site-art_painting              (0) | Train Loss: 0.3979 | Train Acc: 0.9333
 Site-art_painting              (3) | Train Loss: 0.4209 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2268 | Train Acc: 0.9600
 Site-art_painting              (0) | Train Loss: 0.3121 | Train Acc: 0.9062
 Site-art_painting              (0) | Train Loss: 0.3469 | Train Acc: 0.8916
 Site-art_painting              (0) | Train Loss: 0.1971 | Train Acc: 0.9626
 Site-art_painting              (0) | Train Loss: 0.2680 | Train Acc: 0.9065
 Site-art_painting              (0) | Train Loss: 0.2200 | Train Acc: 0.9333
 Site-photo                     (3) | Train Loss: 0.1178 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1690 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.1295 | Train Acc: 0.9592
 Site-photo                     (3) | Train Loss: 0.1284 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.1395 | Train Acc: 0.9745
 Site-sketch                    (1) | Train Loss: 0.6841 | Train Acc: 0.7143
 Site-sketch                    (1) | Train Loss: 0.4784 | Train Acc: 0.8310
 Site-cartoon                   (2) | Train Loss: 0.4751 | Train Acc: 0.8194
Average Train Accuracy: 0.9188
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9130
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9062
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8916
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9626
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9065
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9333
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-photo                     | Epoch:30 | Val Acc: 0.9643
 Best site-photo                     | Epoch:30 | Val Acc: 0.9592
 Best site-photo                     | Epoch:30 | Val Acc: 0.9773
 Best site-photo                     | Epoch:30 | Val Acc: 0.9745
 Best site-sketch                    | Epoch:30 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:30 | Val Acc: 0.8310
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.8194
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 31 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-art_painting              (0) | Train Loss: 0.2917 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.4956 | Train Acc: 0.9130
 Site-art_painting              (0) | Train Loss: 0.3344 | Train Acc: 0.9333
 Site-art_painting              (0) | Train Loss: 0.3506 | Train Acc: 0.9211
 Site-art_painting              (0) | Train Loss: 0.2551 | Train Acc: 0.9400
 Site-art_painting              (0) | Train Loss: 0.2525 | Train Acc: 0.9062
 Site-art_painting              (0) | Train Loss: 0.3056 | Train Acc: 0.9157
 Site-art_painting              (0) | Train Loss: 0.2840 | Train Acc: 0.8972
 Site-art_painting              (0) | Train Loss: 0.2854 | Train Acc: 0.9281
 Site-art_painting              (0) | Train Loss: 0.2298 | Train Acc: 0.9389
 Site-photo                     (2) | Train Loss: 0.1335 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1137 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1490 | Train Acc: 0.9796
 Site-photo                     (2) | Train Loss: 0.1188 | Train Acc: 0.9773
 Site-photo                     (2) | Train Loss: 0.1470 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.9632 | Train Acc: 0.5000
 Site-sketch                    (1) | Train Loss: 0.4604 | Train Acc: 0.8521
 Site-cartoon                   (3) | Train Loss: 0.5912 | Train Acc: 0.8889
Average Train Accuracy: 0.9090
============ Train epoch 32 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-art_painting              (0) | Train Loss: 0.3334 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.4974 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.3611 | Train Acc: 0.8667
 Site-art_painting              (0) | Train Loss: 0.2486 | Train Acc: 0.9211
 Site-art_painting              (0) | Train Loss: 0.2635 | Train Acc: 0.9400
 Site-art_painting              (0) | Train Loss: 0.2334 | Train Acc: 0.9375
 Site-art_painting              (0) | Train Loss: 0.3602 | Train Acc: 0.9036
 Site-art_painting              (0) | Train Loss: 0.1825 | Train Acc: 0.9626
 Site-art_painting              (0) | Train Loss: 0.2662 | Train Acc: 0.8993
 Site-art_painting              (0) | Train Loss: 0.2426 | Train Acc: 0.9556
 Site-photo                     (3) | Train Loss: 0.1270 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1782 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.1212 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1363 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.1331 | Train Acc: 0.9745
 Site-sketch                    (1) | Train Loss: 0.5147 | Train Acc: 0.7143
 Site-sketch                    (1) | Train Loss: 0.5019 | Train Acc: 0.8521
 Site-cartoon                   (2) | Train Loss: 0.4711 | Train Acc: 0.8056
Average Train Accuracy: 0.9129
============ Train epoch 33 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-art_painting              (0) | Train Loss: 0.2625 | Train Acc: 0.9444
 Site-art_painting              (0) | Train Loss: 0.3834 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.3412 | Train Acc: 0.9333
 Site-art_painting              (0) | Train Loss: 0.1714 | Train Acc: 0.9737
 Site-art_painting              (0) | Train Loss: 0.2687 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.2150 | Train Acc: 0.9375
 Site-art_painting              (0) | Train Loss: 0.3072 | Train Acc: 0.9277
 Site-art_painting              (0) | Train Loss: 0.2498 | Train Acc: 0.9346
 Site-art_painting              (0) | Train Loss: 0.3302 | Train Acc: 0.8705
 Site-art_painting              (0) | Train Loss: 0.2414 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1554 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1332 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.1375 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1242 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1190 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.5276 | Train Acc: 0.7857
 Site-sketch                    (1) | Train Loss: 0.5081 | Train Acc: 0.8169
 Site-cartoon                   (2) | Train Loss: 0.4017 | Train Acc: 0.8750
Average Train Accuracy: 0.9249
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9277
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9346
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8705
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9667
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 0.9643
 Best site-photo                     | Epoch:33 | Val Acc: 0.9796
 Best site-photo                     | Epoch:33 | Val Acc: 0.9886
 Best site-photo                     | Epoch:33 | Val Acc: 0.9809
 Best site-sketch                    | Epoch:33 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:33 | Val Acc: 0.8169
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.8750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 34 ============
cnt=[5, 2, 1, 10, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-art_painting              (3) | Train Loss: 0.3771 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.4326 | Train Acc: 0.9130
 Site-art_painting              (3) | Train Loss: 0.3173 | Train Acc: 0.9333
 Site-art_painting              (3) | Train Loss: 0.4207 | Train Acc: 0.9474
 Site-art_painting              (3) | Train Loss: 0.3602 | Train Acc: 0.8800
 Site-art_painting              (3) | Train Loss: 0.3227 | Train Acc: 0.8906
 Site-art_painting              (3) | Train Loss: 0.2507 | Train Acc: 0.9036
 Site-art_painting              (3) | Train Loss: 0.2771 | Train Acc: 0.9346
 Site-art_painting              (3) | Train Loss: 0.2569 | Train Acc: 0.9353
 Site-art_painting              (3) | Train Loss: 0.2177 | Train Acc: 0.9278
 Site-photo                     (0) | Train Loss: 0.1110 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1528 | Train Acc: 0.9643
 Site-photo                     (0) | Train Loss: 0.1320 | Train Acc: 0.9592
 Site-photo                     (0) | Train Loss: 0.1205 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.1422 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.6681 | Train Acc: 0.7857
 Site-sketch                    (1) | Train Loss: 0.4280 | Train Acc: 0.8803
 Site-cartoon                   (2) | Train Loss: 0.5017 | Train Acc: 0.8333
Average Train Accuracy: 0.9193
============ Train epoch 35 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-art_painting              (1) | Train Loss: 0.2591 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.2942 | Train Acc: 0.9565
 Site-art_painting              (1) | Train Loss: 0.2828 | Train Acc: 0.9667
 Site-art_painting              (1) | Train Loss: 0.1829 | Train Acc: 0.9474
 Site-art_painting              (1) | Train Loss: 0.2427 | Train Acc: 0.9200
 Site-art_painting              (1) | Train Loss: 0.2716 | Train Acc: 0.8906
 Site-art_painting              (1) | Train Loss: 0.2789 | Train Acc: 0.9036
 Site-art_painting              (1) | Train Loss: 0.1917 | Train Acc: 0.9533
 Site-art_painting              (1) | Train Loss: 0.2944 | Train Acc: 0.9281
 Site-art_painting              (1) | Train Loss: 0.2225 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.1043 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1400 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.1144 | Train Acc: 0.9592
 Site-photo                     (3) | Train Loss: 0.1033 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1415 | Train Acc: 0.9809
 Site-sketch                    (0) | Train Loss: 0.6597 | Train Acc: 0.7857
 Site-sketch                    (0) | Train Loss: 0.4083 | Train Acc: 0.8803
 Site-cartoon                   (2) | Train Loss: 0.5508 | Train Acc: 0.8194
Average Train Accuracy: 0.9265
 Best site-art_painting              | Epoch:35 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9565
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9667
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:35 | Val Acc: 0.8906
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9036
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9533
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9281
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9444
 Best site-photo                     | Epoch:35 | Val Acc: 1.0000
 Best site-photo                     | Epoch:35 | Val Acc: 0.9643
 Best site-photo                     | Epoch:35 | Val Acc: 0.9592
 Best site-photo                     | Epoch:35 | Val Acc: 0.9886
 Best site-photo                     | Epoch:35 | Val Acc: 0.9809
 Best site-sketch                    | Epoch:35 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:35 | Val Acc: 0.8803
 Best site-cartoon                   | Epoch:35 | Val Acc: 0.8194
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-art_painting              (1) | Train Loss: 0.3961 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.3255 | Train Acc: 0.9130
 Site-art_painting              (1) | Train Loss: 0.2838 | Train Acc: 1.0000
 Site-art_painting              (1) | Train Loss: 0.2380 | Train Acc: 0.8684
 Site-art_painting              (1) | Train Loss: 0.1900 | Train Acc: 0.9600
 Site-art_painting              (1) | Train Loss: 0.2529 | Train Acc: 0.9219
 Site-art_painting              (1) | Train Loss: 0.2255 | Train Acc: 0.9277
 Site-art_painting              (1) | Train Loss: 0.1875 | Train Acc: 0.9533
 Site-art_painting              (1) | Train Loss: 0.2353 | Train Acc: 0.9209
 Site-art_painting              (1) | Train Loss: 0.2092 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1351 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1773 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.1182 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1240 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.1415 | Train Acc: 0.9745
 Site-sketch                    (0) | Train Loss: 0.8394 | Train Acc: 0.6429
 Site-sketch                    (0) | Train Loss: 0.3895 | Train Acc: 0.8944
 Site-cartoon                   (2) | Train Loss: 0.4507 | Train Acc: 0.8750
Average Train Accuracy: 0.9238
============ Train epoch 37 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-art_painting              (0) | Train Loss: 0.3247 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.4009 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.3176 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.2092 | Train Acc: 0.9211
 Site-art_painting              (0) | Train Loss: 0.2347 | Train Acc: 0.9600
 Site-art_painting              (0) | Train Loss: 0.2303 | Train Acc: 0.9531
 Site-art_painting              (0) | Train Loss: 0.2302 | Train Acc: 0.9398
 Site-art_painting              (0) | Train Loss: 0.1792 | Train Acc: 0.9720
 Site-art_painting              (0) | Train Loss: 0.2585 | Train Acc: 0.9281
 Site-art_painting              (0) | Train Loss: 0.2135 | Train Acc: 0.9333
 Site-photo                     (3) | Train Loss: 0.1417 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1112 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1046 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1460 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.1436 | Train Acc: 0.9745
 Site-sketch                    (1) | Train Loss: 0.6092 | Train Acc: 0.7857
 Site-sketch                    (1) | Train Loss: 0.4362 | Train Acc: 0.8732
 Site-cartoon                   (2) | Train Loss: 0.4462 | Train Acc: 0.8750
Average Train Accuracy: 0.9295
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9531
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9398
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9720
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9281
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9333
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 0.9796
 Best site-photo                     | Epoch:37 | Val Acc: 0.9773
 Best site-photo                     | Epoch:37 | Val Acc: 0.9745
 Best site-sketch                    | Epoch:37 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:37 | Val Acc: 0.8732
 Best site-cartoon                   | Epoch:37 | Val Acc: 0.8750
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 38 ============
cnt=[5, 2, 10, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-art_painting              (2) | Train Loss: 0.2930 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.2901 | Train Acc: 0.8696
 Site-art_painting              (2) | Train Loss: 0.2935 | Train Acc: 0.9333
 Site-art_painting              (2) | Train Loss: 0.3049 | Train Acc: 0.8684
 Site-art_painting              (2) | Train Loss: 0.1953 | Train Acc: 0.9400
 Site-art_painting              (2) | Train Loss: 0.2243 | Train Acc: 0.9219
 Site-art_painting              (2) | Train Loss: 0.2832 | Train Acc: 0.9157
 Site-art_painting              (2) | Train Loss: 0.2814 | Train Acc: 0.9533
 Site-art_painting              (2) | Train Loss: 0.2875 | Train Acc: 0.9209
 Site-art_painting              (2) | Train Loss: 0.1916 | Train Acc: 0.9556
 Site-photo                     (0) | Train Loss: 0.0981 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1085 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0947 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1279 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.1140 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.5546 | Train Acc: 0.7857
 Site-sketch                    (1) | Train Loss: 0.3989 | Train Acc: 0.8873
 Site-cartoon                   (3) | Train Loss: 0.4346 | Train Acc: 0.8889
Average Train Accuracy: 0.9277
============ Train epoch 39 ============
cnt=[6, 2, 1, 9, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-art_painting              (0) | Train Loss: 0.2948 | Train Acc: 0.9444
 Site-art_painting              (3) | Train Loss: 0.4065 | Train Acc: 0.8261
 Site-art_painting              (3) | Train Loss: 0.3375 | Train Acc: 0.8667
 Site-art_painting              (3) | Train Loss: 0.2962 | Train Acc: 0.9474
 Site-art_painting              (3) | Train Loss: 0.3095 | Train Acc: 0.9400
 Site-art_painting              (3) | Train Loss: 0.2842 | Train Acc: 0.9219
 Site-art_painting              (3) | Train Loss: 0.2696 | Train Acc: 0.9036
 Site-art_painting              (3) | Train Loss: 0.2218 | Train Acc: 0.9439
 Site-art_painting              (3) | Train Loss: 0.2718 | Train Acc: 0.9137
 Site-art_painting              (3) | Train Loss: 0.1598 | Train Acc: 0.9889
 Site-photo                     (0) | Train Loss: 0.1030 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0942 | Train Acc: 0.9643
 Site-photo                     (0) | Train Loss: 0.1513 | Train Acc: 0.9796
 Site-photo                     (0) | Train Loss: 0.1348 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1379 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.9938 | Train Acc: 0.5714
 Site-sketch                    (1) | Train Loss: 0.4058 | Train Acc: 0.8592
 Site-cartoon                   (2) | Train Loss: 0.4015 | Train Acc: 0.9028
Average Train Accuracy: 0.9129
============ Train epoch 40 ============
cnt=[5, 2, 1, 10, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-art_painting              (3) | Train Loss: 0.3659 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.3919 | Train Acc: 0.8696
 Site-art_painting              (3) | Train Loss: 0.2515 | Train Acc: 0.9333
 Site-art_painting              (3) | Train Loss: 0.2368 | Train Acc: 0.9737
 Site-art_painting              (3) | Train Loss: 0.1916 | Train Acc: 0.9200
 Site-art_painting              (3) | Train Loss: 0.2824 | Train Acc: 0.9062
 Site-art_painting              (3) | Train Loss: 0.2752 | Train Acc: 0.9157
 Site-art_painting              (3) | Train Loss: 0.1701 | Train Acc: 0.9626
 Site-art_painting              (3) | Train Loss: 0.2538 | Train Acc: 0.9281
 Site-art_painting              (3) | Train Loss: 0.1829 | Train Acc: 0.9667
 Site-photo                     (0) | Train Loss: 0.0806 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1653 | Train Acc: 0.9643
 Site-photo                     (0) | Train Loss: 0.1145 | Train Acc: 0.9796
 Site-photo                     (0) | Train Loss: 0.1439 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1180 | Train Acc: 0.9873
 Site-sketch                    (1) | Train Loss: 0.4995 | Train Acc: 0.7857
 Site-sketch                    (1) | Train Loss: 0.4278 | Train Acc: 0.8732
 Site-cartoon                   (2) | Train Loss: 0.4408 | Train Acc: 0.9028
Average Train Accuracy: 0.9297
 Best site-art_painting              | Epoch:40 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:40 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9062
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9157
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9626
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9281
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9667
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 0.9643
 Best site-photo                     | Epoch:40 | Val Acc: 0.9796
 Best site-photo                     | Epoch:40 | Val Acc: 0.9773
 Best site-photo                     | Epoch:40 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:40 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:40 | Val Acc: 0.8732
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.9028
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 41 ============
cnt=[9, 2, 1, 6, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-art_painting              (3) | Train Loss: 0.3161 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.4961 | Train Acc: 0.8261
 Site-art_painting              (0) | Train Loss: 0.2494 | Train Acc: 0.9667
 Site-art_painting              (0) | Train Loss: 0.2011 | Train Acc: 0.9211
 Site-art_painting              (0) | Train Loss: 0.2644 | Train Acc: 0.9600
 Site-art_painting              (0) | Train Loss: 0.1978 | Train Acc: 0.9688
 Site-art_painting              (0) | Train Loss: 0.2541 | Train Acc: 0.9157
 Site-art_painting              (0) | Train Loss: 0.1843 | Train Acc: 0.9533
 Site-art_painting              (0) | Train Loss: 0.2336 | Train Acc: 0.9424
 Site-art_painting              (0) | Train Loss: 0.1666 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.0848 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1009 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.1037 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1110 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.0973 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.7356 | Train Acc: 0.6429
 Site-sketch                    (1) | Train Loss: 0.4379 | Train Acc: 0.8873
 Site-cartoon                   (2) | Train Loss: 0.5017 | Train Acc: 0.9167
Average Train Accuracy: 0.9241
============ Train epoch 42 ============
cnt=[6, 2, 1, 9, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-art_painting              (0) | Train Loss: 0.2766 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.4456 | Train Acc: 0.9130
 Site-art_painting              (3) | Train Loss: 0.3245 | Train Acc: 0.9667
 Site-art_painting              (3) | Train Loss: 0.1658 | Train Acc: 0.8947
 Site-art_painting              (3) | Train Loss: 0.2881 | Train Acc: 0.9400
 Site-art_painting              (3) | Train Loss: 0.2163 | Train Acc: 0.9375
 Site-art_painting              (3) | Train Loss: 0.2447 | Train Acc: 0.8916
 Site-art_painting              (3) | Train Loss: 0.1728 | Train Acc: 0.9533
 Site-art_painting              (3) | Train Loss: 0.2035 | Train Acc: 0.9424
 Site-art_painting              (3) | Train Loss: 0.1814 | Train Acc: 0.9611
 Site-photo                     (0) | Train Loss: 0.0820 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1021 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0905 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1374 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1186 | Train Acc: 0.9745
 Site-sketch                    (1) | Train Loss: 0.7115 | Train Acc: 0.7857
 Site-sketch                    (1) | Train Loss: 0.3812 | Train Acc: 0.8732
 Site-cartoon                   (2) | Train Loss: 0.3448 | Train Acc: 0.8889
Average Train Accuracy: 0.9327
 Best site-art_painting              | Epoch:42 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9130
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9667
 Best site-art_painting              | Epoch:42 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9400
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:42 | Val Acc: 0.8916
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9533
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9424
 Best site-art_painting              | Epoch:42 | Val Acc: 0.9611
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 1.0000
 Best site-photo                     | Epoch:42 | Val Acc: 0.9773
 Best site-photo                     | Epoch:42 | Val Acc: 0.9745
 Best site-sketch                    | Epoch:42 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:42 | Val Acc: 0.8732
 Best site-cartoon                   | Epoch:42 | Val Acc: 0.8889
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/ccop_q=1...
============ Train epoch 43 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-art_painting              (0) | Train Loss: 0.2805 | Train Acc: 0.9444
 Site-art_painting              (0) | Train Loss: 0.3386 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.2715 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3991 | Train Acc: 0.9211
 Site-art_painting              (0) | Train Loss: 0.1770 | Train Acc: 0.9400
 Site-art_painting              (0) | Train Loss: 0.3193 | Train Acc: 0.8906
 Site-art_painting              (0) | Train Loss: 0.2502 | Train Acc: 0.9398
 Site-art_painting              (0) | Train Loss: 0.2440 | Train Acc: 0.9626
 Site-art_painting              (0) | Train Loss: 0.2234 | Train Acc: 0.9353
 Site-art_painting              (0) | Train Loss: 0.2058 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.0761 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1294 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.0900 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1196 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.0958 | Train Acc: 0.9873
 Site-sketch                    (1) | Train Loss: 0.4120 | Train Acc: 0.8571
 Site-sketch                    (1) | Train Loss: 0.4200 | Train Acc: 0.8592
 Site-cartoon                   (2) | Train Loss: 0.4124 | Train Acc: 0.8472
Average Train Accuracy: 0.9289
============ Train epoch 44 ============
cnt=[9, 2, 1, 6, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-art_painting              (3) | Train Loss: 0.3162 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.3064 | Train Acc: 0.9130
 Site-art_painting              (0) | Train Loss: 0.3070 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.2273 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.1763 | Train Acc: 0.9600
 Site-art_painting              (0) | Train Loss: 0.2441 | Train Acc: 0.9375
 Site-art_painting              (0) | Train Loss: 0.2119 | Train Acc: 0.9518
 Site-art_painting              (0) | Train Loss: 0.1981 | Train Acc: 0.9439
 Site-art_painting              (0) | Train Loss: 0.2411 | Train Acc: 0.9353
 Site-art_painting              (0) | Train Loss: 0.1735 | Train Acc: 0.9667
 Site-photo                     (3) | Train Loss: 0.1018 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0814 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1001 | Train Acc: 0.9592
 Site-photo                     (3) | Train Loss: 0.0892 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1152 | Train Acc: 0.9682
 Site-sketch                    (1) | Train Loss: 0.6318 | Train Acc: 0.7143
 Site-sketch                    (1) | Train Loss: 0.3749 | Train Acc: 0.9014
 Site-cartoon                   (2) | Train Loss: 0.4078 | Train Acc: 0.8472
Average Train Accuracy: 0.9291
============ Train epoch 45 ============
cnt=[5, 2, 10, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-art_painting              (2) | Train Loss: 0.2794 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.4422 | Train Acc: 0.8696
 Site-art_painting              (2) | Train Loss: 0.2309 | Train Acc: 0.9333
 Site-art_painting              (2) | Train Loss: 0.2870 | Train Acc: 0.8947
 Site-art_painting              (2) | Train Loss: 0.1917 | Train Acc: 0.9200
 Site-art_painting              (2) | Train Loss: 0.2389 | Train Acc: 0.9531
 Site-art_painting              (2) | Train Loss: 0.2318 | Train Acc: 0.9277
 Site-art_painting              (2) | Train Loss: 0.1954 | Train Acc: 0.9346
 Site-art_painting              (2) | Train Loss: 0.2491 | Train Acc: 0.9281
 Site-art_painting              (2) | Train Loss: 0.2002 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.0885 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1077 | Train Acc: 0.9643
 Site-photo                     (0) | Train Loss: 0.1167 | Train Acc: 0.9592
 Site-photo                     (0) | Train Loss: 0.1306 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1070 | Train Acc: 0.9745
 Site-sketch                    (1) | Train Loss: 0.3558 | Train Acc: 0.9286
 Site-sketch                    (1) | Train Loss: 0.4031 | Train Acc: 0.8873
 Site-cartoon                   (3) | Train Loss: 0.3933 | Train Acc: 0.8889
Average Train Accuracy: 0.9322
============ Train epoch 46 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-art_painting              (1) | Train Loss: 0.2937 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.3372 | Train Acc: 0.9130
 Site-art_painting              (1) | Train Loss: 0.2721 | Train Acc: 0.9333
 Site-art_painting              (1) | Train Loss: 0.3504 | Train Acc: 0.9474
 Site-art_painting              (1) | Train Loss: 0.2465 | Train Acc: 0.9200
 Site-art_painting              (1) | Train Loss: 0.1740 | Train Acc: 0.9688
 Site-art_painting              (1) | Train Loss: 0.2502 | Train Acc: 0.8916
 Site-art_painting              (1) | Train Loss: 0.2464 | Train Acc: 0.9346
 Site-art_painting              (1) | Train Loss: 0.2223 | Train Acc: 0.9281
 Site-art_painting              (1) | Train Loss: 0.1750 | Train Acc: 0.9611
 Site-photo                     (3) | Train Loss: 0.0958 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1251 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.0876 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1335 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.1049 | Train Acc: 0.9745
 Site-sketch                    (0) | Train Loss: 0.6389 | Train Acc: 0.5714
 Site-sketch                    (0) | Train Loss: 0.3643 | Train Acc: 0.9014
 Site-cartoon                   (2) | Train Loss: 0.4305 | Train Acc: 0.9306
Average Train Accuracy: 0.9214
============ Train epoch 47 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-art_painting              (1) | Train Loss: 0.2664 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.3036 | Train Acc: 0.9130
 Site-art_painting              (1) | Train Loss: 0.3332 | Train Acc: 0.9000
 Site-art_painting              (1) | Train Loss: 0.4483 | Train Acc: 0.9211
 Site-art_painting              (1) | Train Loss: 0.2214 | Train Acc: 0.9000
 Site-art_painting              (1) | Train Loss: 0.2230 | Train Acc: 0.9375
 Site-art_painting              (1) | Train Loss: 0.2811 | Train Acc: 0.9036
 Site-art_painting              (1) | Train Loss: 0.1680 | Train Acc: 0.9533
 Site-art_painting              (1) | Train Loss: 0.2275 | Train Acc: 0.9137
 Site-art_painting              (1) | Train Loss: 0.1737 | Train Acc: 0.9556
 Site-photo                     (3) | Train Loss: 0.0590 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0981 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0912 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.0893 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1230 | Train Acc: 0.9682
 Site-sketch                    (0) | Train Loss: 0.6759 | Train Acc: 0.7143
 Site-sketch                    (0) | Train Loss: 0.3777 | Train Acc: 0.8944
 Site-cartoon                   (2) | Train Loss: 0.4404 | Train Acc: 0.8750
Average Train Accuracy: 0.9226
============ Train epoch 48 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-art_painting              (1) | Train Loss: 0.3902 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.4127 | Train Acc: 0.9130
 Site-art_painting              (1) | Train Loss: 0.2485 | Train Acc: 0.9000
 Site-art_painting              (1) | Train Loss: 0.3224 | Train Acc: 0.9211
 Site-art_painting              (1) | Train Loss: 0.2268 | Train Acc: 0.9600
 Site-art_painting              (1) | Train Loss: 0.2491 | Train Acc: 0.9219
 Site-art_painting              (1) | Train Loss: 0.2231 | Train Acc: 0.9157
 Site-art_painting              (1) | Train Loss: 0.2315 | Train Acc: 0.9533
 Site-art_painting              (1) | Train Loss: 0.2530 | Train Acc: 0.9209
 Site-art_painting              (1) | Train Loss: 0.1854 | Train Acc: 0.9722
 Site-photo                     (3) | Train Loss: 0.0917 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0709 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0665 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.0994 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1019 | Train Acc: 0.9873
 Site-sketch                    (0) | Train Loss: 0.5816 | Train Acc: 0.7857
 Site-sketch                    (0) | Train Loss: 0.3580 | Train Acc: 0.9155
 Site-cartoon                   (2) | Train Loss: 0.4432 | Train Acc: 0.8472
Average Train Accuracy: 0.9317
============ Train epoch 49 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-art_painting              (0) | Train Loss: 0.2052 | Train Acc: 0.9444
 Site-art_painting              (0) | Train Loss: 0.4018 | Train Acc: 0.8696
 Site-art_painting              (0) | Train Loss: 0.2956 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.1714 | Train Acc: 0.9474
 Site-art_painting              (0) | Train Loss: 0.2394 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.2706 | Train Acc: 0.9062
 Site-art_painting              (0) | Train Loss: 0.2401 | Train Acc: 0.9036
 Site-art_painting              (0) | Train Loss: 0.1561 | Train Acc: 0.9533
 Site-art_painting              (0) | Train Loss: 0.1742 | Train Acc: 0.9568
 Site-art_painting              (0) | Train Loss: 0.2133 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.0714 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1537 | Train Acc: 0.9643
 Site-photo                     (3) | Train Loss: 0.0850 | Train Acc: 0.9796
 Site-photo                     (3) | Train Loss: 0.1147 | Train Acc: 0.9773
 Site-photo                     (3) | Train Loss: 0.1000 | Train Acc: 0.9809
 Site-sketch                    (1) | Train Loss: 0.5314 | Train Acc: 0.7857
 Site-sketch                    (1) | Train Loss: 0.4280 | Train Acc: 0.9085
 Site-cartoon                   (2) | Train Loss: 0.3508 | Train Acc: 0.9167
Average Train Accuracy: 0.9299
 Test site-art_painting              (0)| Epoch:42 | Test Acc: 0.9257
 Test site-photo                     (3)| Epoch:42 | Test Acc: 0.9940
 Test site-sketch                    (1)| Epoch:42 | Test Acc: 0.8088
 Test site-cartoon                   (2)| Epoch:42 | Test Acc: 0.8213
art_painting: 0.9257, photo: 0.9940, sketch: 0.8088, cartoon: 0.8213, 
Average Test Accuracy(group): 0.8874, Average Test Accuracy(individual): 0.9259,
domain std=0.0765, cluster std=0.0765, individual std=0.0585, 
===2023-08-17 08:07:46===
===2023-08-17 08:08:01===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[18,23,30,38,50,64,83,107,139,180,15,28,49,88,157,14,142,72,
client_nums=[10,5,2,1,]
len_dataset=[1227,568,262,121,]
domain number = 4
Loading snapshots...
 Test site-art_painting              (0)| Epoch:42 | Test Acc: 0.9220
 Test site-photo                     (0)| Epoch:42 | Test Acc: 0.9910
 Test site-sketch                    (1)| Epoch:42 | Test Acc: 0.8113
 Test site-cartoon                   (2)| Epoch:42 | Test Acc: 0.8160
art_painting: 0.9220, photo: 0.9910, sketch: 0.8113, cartoon: 0.8160, 
Average Test Accuracy(group): 0.8851, Average Test Accuracy(individual): 0.9230,
domain std=0.0755, cluster std=0.0715, individual std=0.0575, 
