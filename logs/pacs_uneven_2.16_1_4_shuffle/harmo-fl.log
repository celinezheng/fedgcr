===2023-08-17 02:56:14===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
===2023-08-17 02:56:16===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
===2023-08-17 04:42:02===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[18,23,30,38,50,64,83,107,139,180,15,28,49,88,157,14,142,72,
client_nums=[10,5,2,1,]
len_dataset=[1227,568,262,121,]
domain number = 4
============ Train epoch 0 ============
 Site-art_painting                  | Train Loss: 1.3586 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.4391 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.4305 | Train Acc: 0.6333
 Site-art_painting                  | Train Loss: 1.3335 | Train Acc: 0.8421
 Site-art_painting                  | Train Loss: 1.4408 | Train Acc: 0.6400
 Site-art_painting                  | Train Loss: 1.2821 | Train Acc: 0.8438
 Site-art_painting                  | Train Loss: 1.3635 | Train Acc: 0.7590
 Site-art_painting                  | Train Loss: 1.3650 | Train Acc: 0.7850
 Site-art_painting                  | Train Loss: 1.3580 | Train Acc: 0.7698
 Site-art_painting                  | Train Loss: 1.3499 | Train Acc: 0.7889
 Site-photo                         | Train Loss: 1.0976 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1948 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1146 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.2096 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 1.1076 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.7525 | Train Acc: 0.3571
 Site-sketch                        | Train Loss: 1.7711 | Train Acc: 0.3873
 Site-cartoon                       | Train Loss: 1.5561 | Train Acc: 0.5139
Average Train Accuracy: 0.7630
 Best site-art_painting              | Epoch:0 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:0 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:0 | Val Acc: 0.6333
 Best site-art_painting              | Epoch:0 | Val Acc: 0.8421
 Best site-art_painting              | Epoch:0 | Val Acc: 0.6400
 Best site-art_painting              | Epoch:0 | Val Acc: 0.8438
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7590
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7850
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7698
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7889
 Best site-photo                     | Epoch:0 | Val Acc: 1.0000
 Best site-photo                     | Epoch:0 | Val Acc: 1.0000
 Best site-photo                     | Epoch:0 | Val Acc: 0.9796
 Best site-photo                     | Epoch:0 | Val Acc: 0.9545
 Best site-photo                     | Epoch:0 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:0 | Val Acc: 0.3571
 Best site-sketch                    | Epoch:0 | Val Acc: 0.3873
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.5139
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 1 ============
 Site-art_painting                  | Train Loss: 0.9503 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.0927 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.1081 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8845 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 1.1007 | Train Acc: 0.7200
 Site-art_painting                  | Train Loss: 0.8714 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 1.0089 | Train Acc: 0.8313
 Site-art_painting                  | Train Loss: 1.0243 | Train Acc: 0.8598
 Site-art_painting                  | Train Loss: 1.0089 | Train Acc: 0.7914
 Site-art_painting                  | Train Loss: 0.9868 | Train Acc: 0.8167
 Site-photo                         | Train Loss: 0.5747 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6889 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6536 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.6833 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 0.5850 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.4378 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.5634 | Train Acc: 0.5493
 Site-cartoon                       | Train Loss: 1.3590 | Train Acc: 0.6111
Average Train Accuracy: 0.8319
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:1 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:1 | Val Acc: 0.7200
 Best site-art_painting              | Epoch:1 | Val Acc: 0.9062
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8313
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8598
 Best site-art_painting              | Epoch:1 | Val Acc: 0.7914
 Best site-art_painting              | Epoch:1 | Val Acc: 0.8167
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 0.9796
 Best site-photo                     | Epoch:1 | Val Acc: 0.9545
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:1 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:1 | Val Acc: 0.5493
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.6111
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 2 ============
 Site-art_painting                  | Train Loss: 0.7336 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9532 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 0.8401 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.6636 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.8613 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.6597 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.7607 | Train Acc: 0.8795
 Site-art_painting                  | Train Loss: 0.7040 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.7659 | Train Acc: 0.8489
 Site-art_painting                  | Train Loss: 0.7490 | Train Acc: 0.8722
 Site-photo                         | Train Loss: 0.2851 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4050 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3708 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.4308 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 0.3163 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.3690 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.4374 | Train Acc: 0.6127
 Site-cartoon                       | Train Loss: 1.2156 | Train Acc: 0.6528
Average Train Accuracy: 0.8461
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:2 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7800
 Best site-art_painting              | Epoch:2 | Val Acc: 0.9062
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8795
 Best site-art_painting              | Epoch:2 | Val Acc: 0.9065
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8489
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8722
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 0.9796
 Best site-photo                     | Epoch:2 | Val Acc: 0.9545
 Best site-photo                     | Epoch:2 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:2 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:2 | Val Acc: 0.6127
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.6528
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 3 ============
 Site-art_painting                  | Train Loss: 0.6108 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.6916 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.7441 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.4026 | Train Acc: 0.8684
 Site-art_painting                  | Train Loss: 0.7133 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5177 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.5896 | Train Acc: 0.8916
 Site-art_painting                  | Train Loss: 0.5923 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.6021 | Train Acc: 0.8705
 Site-art_painting                  | Train Loss: 0.5923 | Train Acc: 0.9000
 Site-photo                         | Train Loss: 0.1567 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2300 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2061 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2546 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.1678 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.2504 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.3019 | Train Acc: 0.6056
 Site-cartoon                       | Train Loss: 1.1084 | Train Acc: 0.5972
Average Train Accuracy: 0.8678
 Best site-art_painting              | Epoch:3 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8684
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8906
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8916
 Best site-art_painting              | Epoch:3 | Val Acc: 0.9065
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8705
 Best site-art_painting              | Epoch:3 | Val Acc: 0.9000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 0.9659
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:3 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:3 | Val Acc: 0.6056
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.5972
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 4 ============
 Site-art_painting                  | Train Loss: 0.5858 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.7560 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 0.6355 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2699 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.6032 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4395 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.4885 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.4415 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.5123 | Train Acc: 0.8705
 Site-art_painting                  | Train Loss: 0.4656 | Train Acc: 0.9222
 Site-photo                         | Train Loss: 0.0754 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1464 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1144 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2093 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.1100 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.3762 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.2154 | Train Acc: 0.5634
 Site-cartoon                       | Train Loss: 1.1045 | Train Acc: 0.5972
Average Train Accuracy: 0.8647
============ Train epoch 5 ============
 Site-art_painting                  | Train Loss: 0.5438 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.6805 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.5544 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.3610 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.5667 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4074 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.4210 | Train Acc: 0.9157
 Site-art_painting                  | Train Loss: 0.3980 | Train Acc: 0.9439
 Site-art_painting                  | Train Loss: 0.4406 | Train Acc: 0.8777
 Site-art_painting                  | Train Loss: 0.4111 | Train Acc: 0.9278
 Site-photo                         | Train Loss: 0.0440 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1355 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0815 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1642 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0633 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.0270 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.1585 | Train Acc: 0.6127
 Site-cartoon                       | Train Loss: 1.0282 | Train Acc: 0.6111
Average Train Accuracy: 0.8771
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7826
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9062
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9157
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9439
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8777
 Best site-art_painting              | Epoch:5 | Val Acc: 0.9278
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9659
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:5 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:5 | Val Acc: 0.6127
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.6111
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 6 ============
 Site-art_painting                  | Train Loss: 0.4086 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.5078 | Train Acc: 0.9130
 Site-art_painting                  | Train Loss: 0.4735 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.6638 | Train Acc: 0.8684
 Site-art_painting                  | Train Loss: 0.5985 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.3359 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.3853 | Train Acc: 0.9398
 Site-art_painting                  | Train Loss: 0.3891 | Train Acc: 0.9159
 Site-art_painting                  | Train Loss: 0.3738 | Train Acc: 0.9424
 Site-art_painting                  | Train Loss: 0.3748 | Train Acc: 0.9056
 Site-photo                         | Train Loss: 0.0296 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0707 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1333 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0643 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.0143 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 1.1637 | Train Acc: 0.5775
 Site-cartoon                       | Train Loss: 0.9319 | Train Acc: 0.6389
Average Train Accuracy: 0.8937
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9130
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8684
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9398
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9159
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9424
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9056
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 0.9659
 Best site-photo                     | Epoch:6 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:6 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5775
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.6389
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 7 ============
 Site-art_painting                  | Train Loss: 0.3614 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.6447 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.5407 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.1829 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.4897 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.3149 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.3447 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.2717 | Train Acc: 0.9346
 Site-art_painting                  | Train Loss: 0.3043 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.3546 | Train Acc: 0.9278
 Site-photo                         | Train Loss: 0.0190 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0614 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0538 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1316 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0305 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.9717 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.1139 | Train Acc: 0.6127
 Site-cartoon                       | Train Loss: 1.0156 | Train Acc: 0.6528
Average Train Accuracy: 0.8812
============ Train epoch 8 ============
 Site-art_painting                  | Train Loss: 0.4553 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.6794 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 0.5038 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.2703 | Train Acc: 0.8421
 Site-art_painting                  | Train Loss: 0.5549 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.2673 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.3468 | Train Acc: 0.8916
 Site-art_painting                  | Train Loss: 0.3638 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.3027 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.3045 | Train Acc: 0.9278
 Site-photo                         | Train Loss: 0.0170 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0564 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0577 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.1179 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0250 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.0332 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.0122 | Train Acc: 0.6549
 Site-cartoon                       | Train Loss: 1.0416 | Train Acc: 0.6389
Average Train Accuracy: 0.8615
============ Train epoch 9 ============
 Site-art_painting                  | Train Loss: 0.3998 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.5959 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.4369 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.2090 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.4521 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2538 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.3245 | Train Acc: 0.9398
 Site-art_painting                  | Train Loss: 0.3247 | Train Acc: 0.9159
 Site-art_painting                  | Train Loss: 0.2559 | Train Acc: 0.9496
 Site-art_painting                  | Train Loss: 0.2648 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0139 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0509 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0716 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.0890 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0215 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.9230 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.0227 | Train Acc: 0.6408
 Site-cartoon                       | Train Loss: 0.9766 | Train Acc: 0.6389
Average Train Accuracy: 0.8963
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9398
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9159
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9496
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9556
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 0.9796
 Best site-photo                     | Epoch:9 | Val Acc: 0.9659
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:9 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:9 | Val Acc: 0.6408
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.6389
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 10 ============
 Site-art_painting                  | Train Loss: 0.2954 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.5978 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.5140 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1366 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.3349 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.2478 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.3659 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.2294 | Train Acc: 0.9439
 Site-art_painting                  | Train Loss: 0.2548 | Train Acc: 0.9137
 Site-art_painting                  | Train Loss: 0.2755 | Train Acc: 0.9333
 Site-photo                         | Train Loss: 0.0109 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0270 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0630 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.1204 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0178 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8821 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.9442 | Train Acc: 0.6690
 Site-cartoon                       | Train Loss: 1.1984 | Train Acc: 0.6389
Average Train Accuracy: 0.8993
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9277
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9439
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9137
 Best site-art_painting              | Epoch:10 | Val Acc: 0.9333
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9796
 Best site-photo                     | Epoch:10 | Val Acc: 0.9659
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:10 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:10 | Val Acc: 0.6690
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.6389
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 11 ============
 Site-art_painting                  | Train Loss: 0.4063 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.5199 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.5127 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.2602 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.5067 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.2495 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.3432 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.3085 | Train Acc: 0.9159
 Site-art_painting                  | Train Loss: 0.2851 | Train Acc: 0.9496
 Site-art_painting                  | Train Loss: 0.2305 | Train Acc: 0.9611
 Site-photo                         | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0271 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0416 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.0954 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0233 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.0092 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.8839 | Train Acc: 0.7324
 Site-cartoon                       | Train Loss: 0.9774 | Train Acc: 0.6528
Average Train Accuracy: 0.8907
============ Train epoch 12 ============
 Site-art_painting                  | Train Loss: 0.4343 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.5759 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.4333 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1476 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.3503 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.2774 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.3593 | Train Acc: 0.9157
 Site-art_painting                  | Train Loss: 0.2715 | Train Acc: 0.9439
 Site-art_painting                  | Train Loss: 0.2378 | Train Acc: 0.9424
 Site-art_painting                  | Train Loss: 0.2478 | Train Acc: 0.9389
 Site-photo                         | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0477 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0571 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 0.1179 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0155 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7777 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.9163 | Train Acc: 0.6972
 Site-cartoon                       | Train Loss: 0.8541 | Train Acc: 0.6667
Average Train Accuracy: 0.9001
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9062
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9157
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9439
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9424
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9389
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 0.9592
 Best site-photo                     | Epoch:12 | Val Acc: 0.9659
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:12 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:12 | Val Acc: 0.6972
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 13 ============
 Site-art_painting                  | Train Loss: 0.3271 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.4887 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.4437 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2778 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.3453 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.2570 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.2411 | Train Acc: 0.9639
 Site-art_painting                  | Train Loss: 0.2367 | Train Acc: 0.9346
 Site-art_painting                  | Train Loss: 0.1742 | Train Acc: 0.9712
 Site-art_painting                  | Train Loss: 0.2326 | Train Acc: 0.9389
 Site-photo                         | Train Loss: 0.0039 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0496 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.0183 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0739 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0110 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8093 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.8915 | Train Acc: 0.6690
 Site-cartoon                       | Train Loss: 0.8884 | Train Acc: 0.6667
Average Train Accuracy: 0.9067
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:13 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:13 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9531
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9639
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9346
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9712
 Best site-art_painting              | Epoch:13 | Val Acc: 0.9389
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 0.9643
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 0.9886
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:13 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:13 | Val Acc: 0.6690
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 14 ============
 Site-art_painting                  | Train Loss: 0.3733 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.4025 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.5498 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.1358 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.3282 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.2043 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.2520 | Train Acc: 0.9639
 Site-art_painting                  | Train Loss: 0.2498 | Train Acc: 0.9252
 Site-art_painting                  | Train Loss: 0.1894 | Train Acc: 0.9928
 Site-art_painting                  | Train Loss: 0.2090 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0469 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0368 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.1237 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7799 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.8462 | Train Acc: 0.7676
 Site-cartoon                       | Train Loss: 0.9468 | Train Acc: 0.6389
Average Train Accuracy: 0.9099
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9688
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9639
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9252
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9928
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9556
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 0.9796
 Best site-photo                     | Epoch:14 | Val Acc: 0.9773
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:14 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:14 | Val Acc: 0.7676
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.6389
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 15 ============
 Site-art_painting                  | Train Loss: 0.3096 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.3954 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.5907 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.2019 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.3935 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.2006 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.3039 | Train Acc: 0.9157
 Site-art_painting                  | Train Loss: 0.1662 | Train Acc: 0.9626
 Site-art_painting                  | Train Loss: 0.2359 | Train Acc: 0.9209
 Site-art_painting                  | Train Loss: 0.1907 | Train Acc: 0.9722
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0415 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0204 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0823 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7836 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.8351 | Train Acc: 0.6831
 Site-cartoon                       | Train Loss: 0.6894 | Train Acc: 0.7639
Average Train Accuracy: 0.9083
============ Train epoch 16 ============
 Site-art_painting                  | Train Loss: 0.3202 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.5279 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.3131 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1124 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.2791 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.2204 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.2449 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.2446 | Train Acc: 0.9252
 Site-art_painting                  | Train Loss: 0.1939 | Train Acc: 0.9496
 Site-art_painting                  | Train Loss: 0.2201 | Train Acc: 0.9611
 Site-photo                         | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0292 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0078 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1057 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.9544 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.7657 | Train Acc: 0.7394
 Site-cartoon                       | Train Loss: 0.9506 | Train Acc: 0.7083
Average Train Accuracy: 0.9088
============ Train epoch 17 ============
 Site-art_painting                  | Train Loss: 0.3260 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.4577 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.3825 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.0836 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.3088 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1584 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.2637 | Train Acc: 0.9398
 Site-art_painting                  | Train Loss: 0.2209 | Train Acc: 0.9626
 Site-art_painting                  | Train Loss: 0.2201 | Train Acc: 0.9424
 Site-art_painting                  | Train Loss: 0.1919 | Train Acc: 0.9500
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0302 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0090 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0251 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0306 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 0.9382 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 0.8162 | Train Acc: 0.7113
 Site-cartoon                       | Train Loss: 0.8173 | Train Acc: 0.7083
Average Train Accuracy: 0.9109
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9688
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9398
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9626
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9424
 Best site-art_painting              | Epoch:17 | Val Acc: 0.9500
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 0.9886
 Best site-photo                     | Epoch:17 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:17 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:17 | Val Acc: 0.7113
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.7083
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 18 ============
 Site-art_painting                  | Train Loss: 0.3047 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3619 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.3722 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1665 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.2491 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.2534 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.2725 | Train Acc: 0.9639
 Site-art_painting                  | Train Loss: 0.2319 | Train Acc: 0.9252
 Site-art_painting                  | Train Loss: 0.1975 | Train Acc: 0.9496
 Site-art_painting                  | Train Loss: 0.2006 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0308 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0479 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.0490 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0096 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8128 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 0.7947 | Train Acc: 0.7394
 Site-cartoon                       | Train Loss: 0.9372 | Train Acc: 0.6944
Average Train Accuracy: 0.9041
============ Train epoch 19 ============
 Site-art_painting                  | Train Loss: 0.3055 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.2955 | Train Acc: 0.9565
 Site-art_painting                  | Train Loss: 0.3709 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1860 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.2997 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1598 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.1903 | Train Acc: 0.9639
 Site-art_painting                  | Train Loss: 0.2211 | Train Acc: 0.9346
 Site-art_painting                  | Train Loss: 0.2194 | Train Acc: 0.9424
 Site-art_painting                  | Train Loss: 0.1616 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0384 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0184 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0759 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8675 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.7700 | Train Acc: 0.7606
 Site-cartoon                       | Train Loss: 1.0797 | Train Acc: 0.6528
Average Train Accuracy: 0.9164
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9565
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9639
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9346
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9424
 Best site-art_painting              | Epoch:19 | Val Acc: 0.9444
 Best site-photo                     | Epoch:19 | Val Acc: 1.0000
 Best site-photo                     | Epoch:19 | Val Acc: 1.0000
 Best site-photo                     | Epoch:19 | Val Acc: 1.0000
 Best site-photo                     | Epoch:19 | Val Acc: 0.9773
 Best site-photo                     | Epoch:19 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:19 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:19 | Val Acc: 0.7606
 Best site-cartoon                   | Epoch:19 | Val Acc: 0.6528
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 20 ============
 Site-art_painting                  | Train Loss: 0.3607 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.5439 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.4562 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.1570 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.2464 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.2500 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.2592 | Train Acc: 0.9398
 Site-art_painting                  | Train Loss: 0.1725 | Train Acc: 0.9533
 Site-art_painting                  | Train Loss: 0.1755 | Train Acc: 0.9784
 Site-art_painting                  | Train Loss: 0.2175 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0122 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1103 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8212 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.7677 | Train Acc: 0.7324
 Site-cartoon                       | Train Loss: 0.8184 | Train Acc: 0.6806
Average Train Accuracy: 0.9106
============ Train epoch 21 ============
 Site-art_painting                  | Train Loss: 0.3800 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3525 | Train Acc: 0.9130
 Site-art_painting                  | Train Loss: 0.3100 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.1446 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2999 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.1898 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.2680 | Train Acc: 0.9518
 Site-art_painting                  | Train Loss: 0.1548 | Train Acc: 0.9720
 Site-art_painting                  | Train Loss: 0.1523 | Train Acc: 0.9640
 Site-art_painting                  | Train Loss: 0.1473 | Train Acc: 0.9722
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0361 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0340 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0603 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8741 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 0.8824 | Train Acc: 0.6972
 Site-cartoon                       | Train Loss: 0.8652 | Train Acc: 0.7083
Average Train Accuracy: 0.9166
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9130
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9400
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9518
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9720
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9640
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9722
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 0.9773
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:21 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:21 | Val Acc: 0.6972
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.7083
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 22 ============
 Site-art_painting                  | Train Loss: 0.3458 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.4964 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.3476 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.3327 | Train Acc: 0.8684
 Site-art_painting                  | Train Loss: 0.1931 | Train Acc: 0.9800
 Site-art_painting                  | Train Loss: 0.2109 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.3179 | Train Acc: 0.8916
 Site-art_painting                  | Train Loss: 0.1773 | Train Acc: 0.9626
 Site-art_painting                  | Train Loss: 0.1587 | Train Acc: 0.9784
 Site-art_painting                  | Train Loss: 0.1446 | Train Acc: 0.9722
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0675 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0110 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0850 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8226 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.7202 | Train Acc: 0.8169
 Site-cartoon                       | Train Loss: 0.8617 | Train Acc: 0.6806
Average Train Accuracy: 0.9106
============ Train epoch 23 ============
 Site-art_painting                  | Train Loss: 0.3211 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.4682 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.4187 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.0564 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.2874 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.1395 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.1862 | Train Acc: 0.9639
 Site-art_painting                  | Train Loss: 0.1528 | Train Acc: 0.9533
 Site-art_painting                  | Train Loss: 0.1566 | Train Acc: 0.9640
 Site-art_painting                  | Train Loss: 0.1455 | Train Acc: 0.9944
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0171 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0140 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1192 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.6373 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.7477 | Train Acc: 0.7535
 Site-cartoon                       | Train Loss: 0.7288 | Train Acc: 0.6806
Average Train Accuracy: 0.9175
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8800
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9844
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9639
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9533
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9640
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9944
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-photo                     | Epoch:23 | Val Acc: 0.9659
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:23 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:23 | Val Acc: 0.7535
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.6806
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 24 ============
 Site-art_painting                  | Train Loss: 0.2296 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.3798 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.5076 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.3016 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.2365 | Train Acc: 0.9600
 Site-art_painting                  | Train Loss: 0.1548 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.2221 | Train Acc: 0.9759
 Site-art_painting                  | Train Loss: 0.1640 | Train Acc: 0.9439
 Site-art_painting                  | Train Loss: 0.1586 | Train Acc: 0.9496
 Site-art_painting                  | Train Loss: 0.1277 | Train Acc: 0.9889
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0443 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.0040 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1147 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0097 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 0.7977 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 0.7624 | Train Acc: 0.7746
 Site-cartoon                       | Train Loss: 0.7461 | Train Acc: 0.7083
Average Train Accuracy: 0.9134
============ Train epoch 25 ============
 Site-art_painting                  | Train Loss: 0.3567 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.3977 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.3636 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.0619 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1805 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.1964 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.2878 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.2180 | Train Acc: 0.9626
 Site-art_painting                  | Train Loss: 0.1442 | Train Acc: 0.9712
 Site-art_painting                  | Train Loss: 0.1552 | Train Acc: 0.9611
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0368 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0429 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0119 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 0.7581 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.7367 | Train Acc: 0.7324
 Site-cartoon                       | Train Loss: 0.7442 | Train Acc: 0.6944
Average Train Accuracy: 0.9175
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:25 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9400
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9036
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9626
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9712
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9611
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 0.9773
 Best site-photo                     | Epoch:25 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:25 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:25 | Val Acc: 0.7324
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.6944
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 26 ============
 Site-art_painting                  | Train Loss: 0.3082 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3236 | Train Acc: 0.9130
 Site-art_painting                  | Train Loss: 0.2798 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.0573 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2195 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1371 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.1747 | Train Acc: 0.9639
 Site-art_painting                  | Train Loss: 0.2036 | Train Acc: 0.9439
 Site-art_painting                  | Train Loss: 0.1545 | Train Acc: 0.9784
 Site-art_painting                  | Train Loss: 0.1738 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0256 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1097 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8641 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.7206 | Train Acc: 0.7465
 Site-cartoon                       | Train Loss: 0.8276 | Train Acc: 0.7083
Average Train Accuracy: 0.9250
 Best site-art_painting              | Epoch:26 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9130
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:26 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9200
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9688
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9639
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9439
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9784
 Best site-art_painting              | Epoch:26 | Val Acc: 0.9667
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 0.9659
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:26 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:26 | Val Acc: 0.7465
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.7083
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 27 ============
 Site-art_painting                  | Train Loss: 0.3922 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.4661 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.2870 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.5397 | Train Acc: 0.8684
 Site-art_painting                  | Train Loss: 0.3654 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1246 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.1799 | Train Acc: 0.9518
 Site-art_painting                  | Train Loss: 0.2288 | Train Acc: 0.9439
 Site-art_painting                  | Train Loss: 0.1680 | Train Acc: 0.9496
 Site-art_painting                  | Train Loss: 0.1531 | Train Acc: 0.9611
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0174 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0087 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0889 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0027 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8210 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 0.7374 | Train Acc: 0.7606
 Site-cartoon                       | Train Loss: 0.8690 | Train Acc: 0.7083
Average Train Accuracy: 0.9081
============ Train epoch 28 ============
 Site-art_painting                  | Train Loss: 0.2377 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.4326 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.3038 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.0926 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.2615 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1673 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.1760 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.1235 | Train Acc: 0.9720
 Site-art_painting                  | Train Loss: 0.2108 | Train Acc: 0.9568
 Site-art_painting                  | Train Loss: 0.1146 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0192 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0087 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0470 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0097 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 0.8478 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.7829 | Train Acc: 0.7324
 Site-cartoon                       | Train Loss: 0.7156 | Train Acc: 0.7500
Average Train Accuracy: 0.9183
============ Train epoch 29 ============
 Site-art_painting                  | Train Loss: 0.3409 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.2809 | Train Acc: 0.9565
 Site-art_painting                  | Train Loss: 0.5791 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.1815 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.2430 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.2462 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.2074 | Train Acc: 0.9639
 Site-art_painting                  | Train Loss: 0.1333 | Train Acc: 0.9533
 Site-art_painting                  | Train Loss: 0.1762 | Train Acc: 0.9568
 Site-art_painting                  | Train Loss: 0.1313 | Train Acc: 0.9833
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0049 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0477 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.6845 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.7033 | Train Acc: 0.7746
 Site-cartoon                       | Train Loss: 0.6081 | Train Acc: 0.6667
Average Train Accuracy: 0.9198
============ Train epoch 30 ============
 Site-art_painting                  | Train Loss: 0.3849 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.4703 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.3003 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.3842 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.3017 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1863 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.2236 | Train Acc: 0.9398
 Site-art_painting                  | Train Loss: 0.1665 | Train Acc: 0.9533
 Site-art_painting                  | Train Loss: 0.1445 | Train Acc: 0.9784
 Site-art_painting                  | Train Loss: 0.1123 | Train Acc: 0.9944
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0304 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0899 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7007 | Train Acc: 0.8571
 Site-sketch                        | Train Loss: 0.7955 | Train Acc: 0.6901
 Site-cartoon                       | Train Loss: 0.6534 | Train Acc: 0.7361
Average Train Accuracy: 0.9178
============ Train epoch 31 ============
 Site-art_painting                  | Train Loss: 0.2414 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.4074 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.2732 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.0941 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.2377 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1426 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.2018 | Train Acc: 0.9639
 Site-art_painting                  | Train Loss: 0.1159 | Train Acc: 0.9626
 Site-art_painting                  | Train Loss: 0.1463 | Train Acc: 0.9568
 Site-art_painting                  | Train Loss: 0.1332 | Train Acc: 0.9667
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0085 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0120 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0968 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7981 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.7313 | Train Acc: 0.7394
 Site-cartoon                       | Train Loss: 0.6780 | Train Acc: 0.7222
Average Train Accuracy: 0.9221
============ Train epoch 32 ============
 Site-art_painting                  | Train Loss: 0.3405 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3796 | Train Acc: 0.9130
 Site-art_painting                  | Train Loss: 0.3407 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1678 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.2554 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.2094 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.2672 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.1261 | Train Acc: 0.9533
 Site-art_painting                  | Train Loss: 0.1152 | Train Acc: 0.9784
 Site-art_painting                  | Train Loss: 0.1165 | Train Acc: 0.9722
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0215 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0107 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0683 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8450 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 0.6467 | Train Acc: 0.7958
 Site-cartoon                       | Train Loss: 0.7917 | Train Acc: 0.7639
Average Train Accuracy: 0.9175
============ Train epoch 33 ============
 Site-art_painting                  | Train Loss: 0.1955 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.4322 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.3340 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.5024 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.2899 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1506 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.2332 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.1124 | Train Acc: 0.9907
 Site-art_painting                  | Train Loss: 0.1655 | Train Acc: 0.9712
 Site-art_painting                  | Train Loss: 0.1331 | Train Acc: 0.9722
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0403 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0893 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8098 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.6649 | Train Acc: 0.7465
 Site-cartoon                       | Train Loss: 0.8369 | Train Acc: 0.7500
Average Train Accuracy: 0.9227
============ Train epoch 34 ============
 Site-art_painting                  | Train Loss: 0.3356 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.6015 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.2516 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.2302 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.1547 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1620 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.1996 | Train Acc: 0.9398
 Site-art_painting                  | Train Loss: 0.1416 | Train Acc: 0.9907
 Site-art_painting                  | Train Loss: 0.1442 | Train Acc: 0.9712
 Site-art_painting                  | Train Loss: 0.1371 | Train Acc: 0.9833
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0208 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0531 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7229 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.7124 | Train Acc: 0.7394
 Site-cartoon                       | Train Loss: 0.7231 | Train Acc: 0.7639
Average Train Accuracy: 0.9193
============ Train epoch 35 ============
 Site-art_painting                  | Train Loss: 0.3249 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.2657 | Train Acc: 0.9130
 Site-art_painting                  | Train Loss: 0.4139 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.0967 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.2999 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.1729 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.2371 | Train Acc: 0.9518
 Site-art_painting                  | Train Loss: 0.1185 | Train Acc: 0.9720
 Site-art_painting                  | Train Loss: 0.1113 | Train Acc: 0.9856
 Site-art_painting                  | Train Loss: 0.1604 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0381 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0164 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0919 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0103 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 0.7783 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.6984 | Train Acc: 0.7746
 Site-cartoon                       | Train Loss: 0.7999 | Train Acc: 0.6806
Average Train Accuracy: 0.9185
============ Train epoch 36 ============
 Site-art_painting                  | Train Loss: 0.2054 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.3696 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.2913 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1108 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.2653 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1383 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.2521 | Train Acc: 0.9398
 Site-art_painting                  | Train Loss: 0.1394 | Train Acc: 0.9439
 Site-art_painting                  | Train Loss: 0.1370 | Train Acc: 0.9712
 Site-art_painting                  | Train Loss: 0.1315 | Train Acc: 0.9722
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0295 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0075 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0893 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0392 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 0.7353 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 0.6987 | Train Acc: 0.7746
 Site-cartoon                       | Train Loss: 0.9872 | Train Acc: 0.7222
Average Train Accuracy: 0.9155
============ Train epoch 37 ============
 Site-art_painting                  | Train Loss: 0.3019 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3336 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.3933 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.0731 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.2010 | Train Acc: 0.9600
 Site-art_painting                  | Train Loss: 0.1501 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.1773 | Train Acc: 0.9639
 Site-art_painting                  | Train Loss: 0.1481 | Train Acc: 0.9626
 Site-art_painting                  | Train Loss: 0.1361 | Train Acc: 0.9856
 Site-art_painting                  | Train Loss: 0.1073 | Train Acc: 0.9889
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0155 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0039 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0573 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7882 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.6847 | Train Acc: 0.7958
 Site-cartoon                       | Train Loss: 0.7335 | Train Acc: 0.7222
Average Train Accuracy: 0.9256
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8696
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9737
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9531
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9639
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9626
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9856
 Best site-art_painting              | Epoch:37 | Val Acc: 0.9889
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 0.9773
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:37 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:37 | Val Acc: 0.7958
 Best site-cartoon                   | Epoch:37 | Val Acc: 0.7222
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 38 ============
 Site-art_painting                  | Train Loss: 0.2141 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.3109 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.2844 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.1116 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.3356 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.1548 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.2280 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.1432 | Train Acc: 0.9813
 Site-art_painting                  | Train Loss: 0.1349 | Train Acc: 0.9784
 Site-art_painting                  | Train Loss: 0.1196 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0078 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0224 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0596 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.6563 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 0.7033 | Train Acc: 0.7746
 Site-cartoon                       | Train Loss: 0.7801 | Train Acc: 0.7778
Average Train Accuracy: 0.9201
============ Train epoch 39 ============
 Site-art_painting                  | Train Loss: 0.3129 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.5505 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.2880 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1401 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.2178 | Train Acc: 0.9200
 Site-art_painting                  | Train Loss: 0.2377 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.2550 | Train Acc: 0.9518
 Site-art_painting                  | Train Loss: 0.1336 | Train Acc: 0.9533
 Site-art_painting                  | Train Loss: 0.1242 | Train Acc: 0.9784
 Site-art_painting                  | Train Loss: 0.1256 | Train Acc: 0.9778
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0085 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0792 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8103 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.6743 | Train Acc: 0.7746
 Site-cartoon                       | Train Loss: 0.6843 | Train Acc: 0.7500
Average Train Accuracy: 0.9156
============ Train epoch 40 ============
 Site-art_painting                  | Train Loss: 0.2711 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.5242 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.2608 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.0579 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2608 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.1885 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.1628 | Train Acc: 0.9518
 Site-art_painting                  | Train Loss: 0.1389 | Train Acc: 0.9720
 Site-art_painting                  | Train Loss: 0.1305 | Train Acc: 0.9712
 Site-art_painting                  | Train Loss: 0.1059 | Train Acc: 0.9944
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0069 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0177 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.1000 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8839 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 0.6500 | Train Acc: 0.8099
 Site-cartoon                       | Train Loss: 0.7337 | Train Acc: 0.6528
Average Train Accuracy: 0.9082
============ Train epoch 41 ============
 Site-art_painting                  | Train Loss: 0.2467 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.3960 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.4346 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1672 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.2266 | Train Acc: 0.9600
 Site-art_painting                  | Train Loss: 0.1234 | Train Acc: 0.9844
 Site-art_painting                  | Train Loss: 0.1394 | Train Acc: 0.9759
 Site-art_painting                  | Train Loss: 0.1528 | Train Acc: 0.9533
 Site-art_painting                  | Train Loss: 0.1280 | Train Acc: 0.9568
 Site-art_painting                  | Train Loss: 0.1356 | Train Acc: 0.9556
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0321 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0027 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7713 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.7144 | Train Acc: 0.7606
 Site-cartoon                       | Train Loss: 0.7785 | Train Acc: 0.7083
Average Train Accuracy: 0.9218
============ Train epoch 42 ============
 Site-art_painting                  | Train Loss: 0.2947 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.2757 | Train Acc: 0.9130
 Site-art_painting                  | Train Loss: 0.3616 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.1416 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.2617 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1419 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.1749 | Train Acc: 0.9639
 Site-art_painting                  | Train Loss: 0.1091 | Train Acc: 0.9720
 Site-art_painting                  | Train Loss: 0.1505 | Train Acc: 0.9640
 Site-art_painting                  | Train Loss: 0.0921 | Train Acc: 0.9944
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0256 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0249 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.0735 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8242 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.6146 | Train Acc: 0.7887
 Site-cartoon                       | Train Loss: 0.7854 | Train Acc: 0.7222
Average Train Accuracy: 0.9252
============ Train epoch 43 ============
 Site-art_painting                  | Train Loss: 0.2525 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.3103 | Train Acc: 0.9130
 Site-art_painting                  | Train Loss: 0.5138 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.0883 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.1740 | Train Acc: 0.9600
 Site-art_painting                  | Train Loss: 0.1210 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.3004 | Train Acc: 0.9518
 Site-art_painting                  | Train Loss: 0.1286 | Train Acc: 0.9626
 Site-art_painting                  | Train Loss: 0.1638 | Train Acc: 0.9496
 Site-art_painting                  | Train Loss: 0.1475 | Train Acc: 0.9722
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0612 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7484 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.7154 | Train Acc: 0.7606
 Site-cartoon                       | Train Loss: 0.5957 | Train Acc: 0.7361
Average Train Accuracy: 0.9261
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9130
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9600
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9688
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9518
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9626
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9496
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9722
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 0.9886
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:43 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:43 | Val Acc: 0.7606
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.7361
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 44 ============
 Site-art_painting                  | Train Loss: 0.2261 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.5851 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.2356 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.2945 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.2306 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.1279 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.2138 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.1452 | Train Acc: 0.9533
 Site-art_painting                  | Train Loss: 0.1363 | Train Acc: 0.9712
 Site-art_painting                  | Train Loss: 0.1183 | Train Acc: 0.9889
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0089 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0625 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8541 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.5687 | Train Acc: 0.8662
 Site-cartoon                       | Train Loss: 0.5517 | Train Acc: 0.7639
Average Train Accuracy: 0.9212
============ Train epoch 45 ============
 Site-art_painting                  | Train Loss: 0.3464 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.4717 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.2925 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.4577 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.1498 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.1579 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.1918 | Train Acc: 0.9398
 Site-art_painting                  | Train Loss: 0.1086 | Train Acc: 0.9720
 Site-art_painting                  | Train Loss: 0.1138 | Train Acc: 0.9640
 Site-art_painting                  | Train Loss: 0.0886 | Train Acc: 0.9889
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0229 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0144 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0197 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0280 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 0.7363 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.6955 | Train Acc: 0.7958
 Site-cartoon                       | Train Loss: 0.8125 | Train Acc: 0.7639
Average Train Accuracy: 0.9248
============ Train epoch 46 ============
 Site-art_painting                  | Train Loss: 0.3373 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3065 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.4319 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1178 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.3003 | Train Acc: 0.9400
 Site-art_painting                  | Train Loss: 0.1515 | Train Acc: 0.9688
 Site-art_painting                  | Train Loss: 0.2046 | Train Acc: 0.9759
 Site-art_painting                  | Train Loss: 0.1204 | Train Acc: 0.9813
 Site-art_painting                  | Train Loss: 0.1117 | Train Acc: 0.9712
 Site-art_painting                  | Train Loss: 0.1220 | Train Acc: 0.9722
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0511 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0511 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7463 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.6183 | Train Acc: 0.8239
 Site-cartoon                       | Train Loss: 0.7730 | Train Acc: 0.7222
Average Train Accuracy: 0.9214
============ Train epoch 47 ============
 Site-art_painting                  | Train Loss: 0.2675 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3141 | Train Acc: 0.9130
 Site-art_painting                  | Train Loss: 0.3398 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1190 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.1214 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1818 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.1946 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.1799 | Train Acc: 0.9720
 Site-art_painting                  | Train Loss: 0.0894 | Train Acc: 0.9928
 Site-art_painting                  | Train Loss: 0.1302 | Train Acc: 0.9833
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0084 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0064 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0266 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0063 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.8605 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.6339 | Train Acc: 0.7676
 Site-cartoon                       | Train Loss: 0.6438 | Train Acc: 0.7639
Average Train Accuracy: 0.9285
 Best site-art_painting              | Epoch:47 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9130
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:47 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9531
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9277
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9720
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9928
 Best site-art_painting              | Epoch:47 | Val Acc: 0.9833
 Best site-photo                     | Epoch:47 | Val Acc: 1.0000
 Best site-photo                     | Epoch:47 | Val Acc: 1.0000
 Best site-photo                     | Epoch:47 | Val Acc: 1.0000
 Best site-photo                     | Epoch:47 | Val Acc: 0.9886
 Best site-photo                     | Epoch:47 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:47 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:47 | Val Acc: 0.7676
 Best site-cartoon                   | Epoch:47 | Val Acc: 0.7639
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/harmo-fl...
============ Train epoch 48 ============
 Site-art_painting                  | Train Loss: 0.2784 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.5118 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.2454 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.1432 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.3167 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2220 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.2561 | Train Acc: 0.9398
 Site-art_painting                  | Train Loss: 0.1436 | Train Acc: 0.9626
 Site-art_painting                  | Train Loss: 0.1038 | Train Acc: 0.9784
 Site-art_painting                  | Train Loss: 0.0899 | Train Acc: 0.9833
 Site-photo                         | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0119 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0838 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.6927 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 0.6483 | Train Acc: 0.8099
 Site-cartoon                       | Train Loss: 0.7129 | Train Acc: 0.6806
Average Train Accuracy: 0.9147
============ Train epoch 49 ============
 Site-art_painting                  | Train Loss: 0.1709 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.3282 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.4098 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1040 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.1831 | Train Acc: 0.9600
 Site-art_painting                  | Train Loss: 0.1367 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.2149 | Train Acc: 0.9518
 Site-art_painting                  | Train Loss: 0.1214 | Train Acc: 0.9626
 Site-art_painting                  | Train Loss: 0.1252 | Train Acc: 0.9640
 Site-art_painting                  | Train Loss: 0.1241 | Train Acc: 0.9889
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0447 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0914 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 0.7283 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 0.6137 | Train Acc: 0.7746
 Site-cartoon                       | Train Loss: 0.6286 | Train Acc: 0.7222
Average Train Accuracy: 0.9265
 Test site-art_painting              | Epoch:47 | Test Acc: 0.9428
 Test site-photo                     | Epoch:47 | Test Acc: 0.9985
 Test site-sketch                    | Epoch:47 | Test Acc: 0.7097
 Test site-cartoon                   | Epoch:47 | Test Acc: 0.7287
art_painting: 0.9428, photo: 0.9985, sketch: 0.7097, cartoon: 0.7287, 
Average Test Accuracy(group): 0.8449, Average Test Accuracy(individual): 0.9205,
domain std=0.1274, cluster std=-1.0000, individual std=0.0946, 
===2023-08-17 05:49:50===
===2023-08-17 05:50:05===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[18,23,30,38,50,64,83,107,139,180,15,28,49,88,157,14,142,72,
client_nums=[10,5,2,1,]
len_dataset=[1227,568,262,121,]
domain number = 4
Loading snapshots...
 Test site-art_painting              | Epoch:47 | Test Acc: 0.9476
 Test site-photo                     | Epoch:47 | Test Acc: 0.9985
 Test site-sketch                    | Epoch:47 | Test Acc: 0.7065
 Test site-cartoon                   | Epoch:47 | Test Acc: 0.7330
art_painting: 0.9476, photo: 0.9985, sketch: 0.7065, cartoon: 0.7330, 
Average Test Accuracy(group): 0.8464, Average Test Accuracy(individual): 0.9230,
domain std=0.1283, cluster std=-1.0000, individual std=0.0956, 
