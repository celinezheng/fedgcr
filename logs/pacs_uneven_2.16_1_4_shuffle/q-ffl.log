===2023-08-17 02:56:06===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
===2023-08-17 02:56:08===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
===2023-08-17 03:52:50===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[18,23,30,38,50,64,83,107,139,180,15,28,49,88,157,14,142,72,
client_nums=[10,5,2,1,]
len_dataset=[1227,568,262,121,]
domain number = 4
============ Train epoch 0 ============
denominator: 39468.0703125
 Site-art_painting                  | Train Loss: 1.8998 | Train Acc: 0.2222
 Site-art_painting                  | Train Loss: 1.9369 | Train Acc: 0.2609
 Site-art_painting                  | Train Loss: 1.8981 | Train Acc: 0.2667
 Site-art_painting                  | Train Loss: 1.9255 | Train Acc: 0.2632
 Site-art_painting                  | Train Loss: 1.9107 | Train Acc: 0.2000
 Site-art_painting                  | Train Loss: 1.9065 | Train Acc: 0.2188
 Site-art_painting                  | Train Loss: 1.9290 | Train Acc: 0.1928
 Site-art_painting                  | Train Loss: 1.8939 | Train Acc: 0.2430
 Site-art_painting                  | Train Loss: 1.8960 | Train Acc: 0.2446
 Site-art_painting                  | Train Loss: 1.9119 | Train Acc: 0.1833
 Site-photo                         | Train Loss: 1.8740 | Train Acc: 0.3333
 Site-photo                         | Train Loss: 1.8983 | Train Acc: 0.2857
 Site-photo                         | Train Loss: 1.8814 | Train Acc: 0.4082
 Site-photo                         | Train Loss: 1.8914 | Train Acc: 0.3977
 Site-photo                         | Train Loss: 1.8820 | Train Acc: 0.4013
 Site-sketch                        | Train Loss: 1.9156 | Train Acc: 0.1429
 Site-sketch                        | Train Loss: 1.9248 | Train Acc: 0.1620
 Site-cartoon                       | Train Loss: 1.9477 | Train Acc: 0.1111
Average Train Accuracy: 0.2521
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2222
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2609
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2667
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2632
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2000
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2188
 Best site-art_painting              | Epoch:0 | Val Acc: 0.1928
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2430
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2446
 Best site-art_painting              | Epoch:0 | Val Acc: 0.1833
 Best site-photo                     | Epoch:0 | Val Acc: 0.3333
 Best site-photo                     | Epoch:0 | Val Acc: 0.2857
 Best site-photo                     | Epoch:0 | Val Acc: 0.4082
 Best site-photo                     | Epoch:0 | Val Acc: 0.3977
 Best site-photo                     | Epoch:0 | Val Acc: 0.4013
 Best site-sketch                    | Epoch:0 | Val Acc: 0.1429
 Best site-sketch                    | Epoch:0 | Val Acc: 0.1620
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.1111
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 1 ============
denominator: 38731.796875
 Site-art_painting                  | Train Loss: 1.8615 | Train Acc: 0.3889
 Site-art_painting                  | Train Loss: 1.8912 | Train Acc: 0.2174
 Site-art_painting                  | Train Loss: 1.8601 | Train Acc: 0.3000
 Site-art_painting                  | Train Loss: 1.8412 | Train Acc: 0.4737
 Site-art_painting                  | Train Loss: 1.8760 | Train Acc: 0.2400
 Site-art_painting                  | Train Loss: 1.8682 | Train Acc: 0.2500
 Site-art_painting                  | Train Loss: 1.8873 | Train Acc: 0.2530
 Site-art_painting                  | Train Loss: 1.8629 | Train Acc: 0.3645
 Site-art_painting                  | Train Loss: 1.8645 | Train Acc: 0.3165
 Site-art_painting                  | Train Loss: 1.8751 | Train Acc: 0.2667
 Site-photo                         | Train Loss: 1.8275 | Train Acc: 0.4667
 Site-photo                         | Train Loss: 1.8251 | Train Acc: 0.5714
 Site-photo                         | Train Loss: 1.8317 | Train Acc: 0.5918
 Site-photo                         | Train Loss: 1.8443 | Train Acc: 0.4886
 Site-photo                         | Train Loss: 1.8269 | Train Acc: 0.5669
 Site-sketch                        | Train Loss: 1.8893 | Train Acc: 0.2143
 Site-sketch                        | Train Loss: 1.9044 | Train Acc: 0.1690
 Site-cartoon                       | Train Loss: 1.9115 | Train Acc: 0.3056
Average Train Accuracy: 0.3581
 Best site-art_painting              | Epoch:1 | Val Acc: 0.3889
 Best site-art_painting              | Epoch:1 | Val Acc: 0.2174
 Best site-art_painting              | Epoch:1 | Val Acc: 0.3000
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4737
 Best site-art_painting              | Epoch:1 | Val Acc: 0.2400
 Best site-art_painting              | Epoch:1 | Val Acc: 0.2500
 Best site-art_painting              | Epoch:1 | Val Acc: 0.2530
 Best site-art_painting              | Epoch:1 | Val Acc: 0.3645
 Best site-art_painting              | Epoch:1 | Val Acc: 0.3165
 Best site-art_painting              | Epoch:1 | Val Acc: 0.2667
 Best site-photo                     | Epoch:1 | Val Acc: 0.4667
 Best site-photo                     | Epoch:1 | Val Acc: 0.5714
 Best site-photo                     | Epoch:1 | Val Acc: 0.5918
 Best site-photo                     | Epoch:1 | Val Acc: 0.4886
 Best site-photo                     | Epoch:1 | Val Acc: 0.5669
 Best site-sketch                    | Epoch:1 | Val Acc: 0.2143
 Best site-sketch                    | Epoch:1 | Val Acc: 0.1690
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.3056
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 2 ============
denominator: 37908.7734375
 Site-art_painting                  | Train Loss: 1.8190 | Train Acc: 0.4444
 Site-art_painting                  | Train Loss: 1.8636 | Train Acc: 0.3913
 Site-art_painting                  | Train Loss: 1.8345 | Train Acc: 0.3333
 Site-art_painting                  | Train Loss: 1.8120 | Train Acc: 0.5526
 Site-art_painting                  | Train Loss: 1.8323 | Train Acc: 0.4000
 Site-art_painting                  | Train Loss: 1.8146 | Train Acc: 0.4375
 Site-art_painting                  | Train Loss: 1.8392 | Train Acc: 0.4578
 Site-art_painting                  | Train Loss: 1.8224 | Train Acc: 0.4860
 Site-art_painting                  | Train Loss: 1.8284 | Train Acc: 0.3957
 Site-art_painting                  | Train Loss: 1.8336 | Train Acc: 0.3944
 Site-photo                         | Train Loss: 1.7719 | Train Acc: 0.6667
 Site-photo                         | Train Loss: 1.7865 | Train Acc: 0.6786
 Site-photo                         | Train Loss: 1.7612 | Train Acc: 0.7755
 Site-photo                         | Train Loss: 1.7911 | Train Acc: 0.6250
 Site-photo                         | Train Loss: 1.7688 | Train Acc: 0.6879
 Site-sketch                        | Train Loss: 1.8605 | Train Acc: 0.3571
 Site-sketch                        | Train Loss: 1.8849 | Train Acc: 0.1972
 Site-cartoon                       | Train Loss: 1.8770 | Train Acc: 0.2917
Average Train Accuracy: 0.4763
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4444
 Best site-art_painting              | Epoch:2 | Val Acc: 0.3913
 Best site-art_painting              | Epoch:2 | Val Acc: 0.3333
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5526
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4000
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4375
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4578
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4860
 Best site-art_painting              | Epoch:2 | Val Acc: 0.3957
 Best site-art_painting              | Epoch:2 | Val Acc: 0.3944
 Best site-photo                     | Epoch:2 | Val Acc: 0.6667
 Best site-photo                     | Epoch:2 | Val Acc: 0.6786
 Best site-photo                     | Epoch:2 | Val Acc: 0.7755
 Best site-photo                     | Epoch:2 | Val Acc: 0.6250
 Best site-photo                     | Epoch:2 | Val Acc: 0.6879
 Best site-sketch                    | Epoch:2 | Val Acc: 0.3571
 Best site-sketch                    | Epoch:2 | Val Acc: 0.1972
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.2917
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 3 ============
denominator: 37266.10546875
 Site-art_painting                  | Train Loss: 1.7620 | Train Acc: 0.6111
 Site-art_painting                  | Train Loss: 1.8240 | Train Acc: 0.5217
 Site-art_painting                  | Train Loss: 1.7930 | Train Acc: 0.4000
 Site-art_painting                  | Train Loss: 1.7722 | Train Acc: 0.5526
 Site-art_painting                  | Train Loss: 1.7888 | Train Acc: 0.5600
 Site-art_painting                  | Train Loss: 1.7560 | Train Acc: 0.5156
 Site-art_painting                  | Train Loss: 1.8052 | Train Acc: 0.5422
 Site-art_painting                  | Train Loss: 1.7682 | Train Acc: 0.5514
 Site-art_painting                  | Train Loss: 1.7903 | Train Acc: 0.5180
 Site-art_painting                  | Train Loss: 1.7936 | Train Acc: 0.5000
 Site-photo                         | Train Loss: 1.7134 | Train Acc: 0.8667
 Site-photo                         | Train Loss: 1.7275 | Train Acc: 0.7857
 Site-photo                         | Train Loss: 1.7143 | Train Acc: 0.7755
 Site-photo                         | Train Loss: 1.7298 | Train Acc: 0.7614
 Site-photo                         | Train Loss: 1.7056 | Train Acc: 0.8280
 Site-sketch                        | Train Loss: 1.8502 | Train Acc: 0.3571
 Site-sketch                        | Train Loss: 1.8725 | Train Acc: 0.2324
 Site-cartoon                       | Train Loss: 1.8627 | Train Acc: 0.4306
Average Train Accuracy: 0.5728
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6111
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5217
 Best site-art_painting              | Epoch:3 | Val Acc: 0.4000
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5526
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5600
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5156
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5422
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5514
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5180
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5000
 Best site-photo                     | Epoch:3 | Val Acc: 0.8667
 Best site-photo                     | Epoch:3 | Val Acc: 0.7857
 Best site-photo                     | Epoch:3 | Val Acc: 0.7755
 Best site-photo                     | Epoch:3 | Val Acc: 0.7614
 Best site-photo                     | Epoch:3 | Val Acc: 0.8280
 Best site-sketch                    | Epoch:3 | Val Acc: 0.3571
 Best site-sketch                    | Epoch:3 | Val Acc: 0.2324
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.4306
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 4 ============
denominator: 36523.375
 Site-art_painting                  | Train Loss: 1.7404 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.7753 | Train Acc: 0.5217
 Site-art_painting                  | Train Loss: 1.7590 | Train Acc: 0.6000
 Site-art_painting                  | Train Loss: 1.7485 | Train Acc: 0.6579
 Site-art_painting                  | Train Loss: 1.7811 | Train Acc: 0.5200
 Site-art_painting                  | Train Loss: 1.7163 | Train Acc: 0.6250
 Site-art_painting                  | Train Loss: 1.7652 | Train Acc: 0.6145
 Site-art_painting                  | Train Loss: 1.7257 | Train Acc: 0.5981
 Site-art_painting                  | Train Loss: 1.7373 | Train Acc: 0.6043
 Site-art_painting                  | Train Loss: 1.7451 | Train Acc: 0.5778
 Site-photo                         | Train Loss: 1.6602 | Train Acc: 0.9333
 Site-photo                         | Train Loss: 1.6764 | Train Acc: 0.8214
 Site-photo                         | Train Loss: 1.6626 | Train Acc: 0.8571
 Site-photo                         | Train Loss: 1.6779 | Train Acc: 0.8182
 Site-photo                         | Train Loss: 1.6556 | Train Acc: 0.9299
 Site-sketch                        | Train Loss: 1.8292 | Train Acc: 0.2857
 Site-sketch                        | Train Loss: 1.8612 | Train Acc: 0.2535
 Site-cartoon                       | Train Loss: 1.8607 | Train Acc: 0.4861
Average Train Accuracy: 0.6317
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:4 | Val Acc: 0.5217
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6000
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6579
 Best site-art_painting              | Epoch:4 | Val Acc: 0.5200
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6250
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6145
 Best site-art_painting              | Epoch:4 | Val Acc: 0.5981
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6043
 Best site-art_painting              | Epoch:4 | Val Acc: 0.5778
 Best site-photo                     | Epoch:4 | Val Acc: 0.9333
 Best site-photo                     | Epoch:4 | Val Acc: 0.8214
 Best site-photo                     | Epoch:4 | Val Acc: 0.8571
 Best site-photo                     | Epoch:4 | Val Acc: 0.8182
 Best site-photo                     | Epoch:4 | Val Acc: 0.9299
 Best site-sketch                    | Epoch:4 | Val Acc: 0.2857
 Best site-sketch                    | Epoch:4 | Val Acc: 0.2535
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.4861
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 5 ============
denominator: 35648.32421875
 Site-art_painting                  | Train Loss: 1.6932 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.7404 | Train Acc: 0.5217
 Site-art_painting                  | Train Loss: 1.7292 | Train Acc: 0.5333
 Site-art_painting                  | Train Loss: 1.6822 | Train Acc: 0.7368
 Site-art_painting                  | Train Loss: 1.7351 | Train Acc: 0.5400
 Site-art_painting                  | Train Loss: 1.6689 | Train Acc: 0.6719
 Site-art_painting                  | Train Loss: 1.7208 | Train Acc: 0.6506
 Site-art_painting                  | Train Loss: 1.6900 | Train Acc: 0.6729
 Site-art_painting                  | Train Loss: 1.7238 | Train Acc: 0.5827
 Site-art_painting                  | Train Loss: 1.7065 | Train Acc: 0.6389
 Site-photo                         | Train Loss: 1.5846 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.6306 | Train Acc: 0.8929
 Site-photo                         | Train Loss: 1.5960 | Train Acc: 0.9184
 Site-photo                         | Train Loss: 1.6303 | Train Acc: 0.8750
 Site-photo                         | Train Loss: 1.5964 | Train Acc: 0.9490
 Site-sketch                        | Train Loss: 1.8027 | Train Acc: 0.3571
 Site-sketch                        | Train Loss: 1.8360 | Train Acc: 0.2958
 Site-cartoon                       | Train Loss: 1.8278 | Train Acc: 0.4583
Average Train Accuracy: 0.6738
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:5 | Val Acc: 0.5217
 Best site-art_painting              | Epoch:5 | Val Acc: 0.5333
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7368
 Best site-art_painting              | Epoch:5 | Val Acc: 0.5400
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6719
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6506
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6729
 Best site-art_painting              | Epoch:5 | Val Acc: 0.5827
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6389
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.8929
 Best site-photo                     | Epoch:5 | Val Acc: 0.9184
 Best site-photo                     | Epoch:5 | Val Acc: 0.8750
 Best site-photo                     | Epoch:5 | Val Acc: 0.9490
 Best site-sketch                    | Epoch:5 | Val Acc: 0.3571
 Best site-sketch                    | Epoch:5 | Val Acc: 0.2958
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.4583
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 6 ============
denominator: 35032.296875
 Site-art_painting                  | Train Loss: 1.6539 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.7211 | Train Acc: 0.4783
 Site-art_painting                  | Train Loss: 1.7087 | Train Acc: 0.5333
 Site-art_painting                  | Train Loss: 1.6334 | Train Acc: 0.6579
 Site-art_painting                  | Train Loss: 1.6987 | Train Acc: 0.5800
 Site-art_painting                  | Train Loss: 1.6390 | Train Acc: 0.7344
 Site-art_painting                  | Train Loss: 1.7158 | Train Acc: 0.5904
 Site-art_painting                  | Train Loss: 1.6585 | Train Acc: 0.6636
 Site-art_painting                  | Train Loss: 1.6692 | Train Acc: 0.6259
 Site-art_painting                  | Train Loss: 1.6638 | Train Acc: 0.6500
 Site-photo                         | Train Loss: 1.5356 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.5804 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 1.5444 | Train Acc: 0.9388
 Site-photo                         | Train Loss: 1.5835 | Train Acc: 0.8864
 Site-photo                         | Train Loss: 1.5386 | Train Acc: 0.9745
 Site-sketch                        | Train Loss: 1.7865 | Train Acc: 0.4286
 Site-sketch                        | Train Loss: 1.8297 | Train Acc: 0.2746
 Site-cartoon                       | Train Loss: 1.8085 | Train Acc: 0.4722
Average Train Accuracy: 0.6795
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:6 | Val Acc: 0.4783
 Best site-art_painting              | Epoch:6 | Val Acc: 0.5333
 Best site-art_painting              | Epoch:6 | Val Acc: 0.6579
 Best site-art_painting              | Epoch:6 | Val Acc: 0.5800
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7344
 Best site-art_painting              | Epoch:6 | Val Acc: 0.5904
 Best site-art_painting              | Epoch:6 | Val Acc: 0.6636
 Best site-art_painting              | Epoch:6 | Val Acc: 0.6259
 Best site-art_painting              | Epoch:6 | Val Acc: 0.6500
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 0.9643
 Best site-photo                     | Epoch:6 | Val Acc: 0.9388
 Best site-photo                     | Epoch:6 | Val Acc: 0.8864
 Best site-photo                     | Epoch:6 | Val Acc: 0.9745
 Best site-sketch                    | Epoch:6 | Val Acc: 0.4286
 Best site-sketch                    | Epoch:6 | Val Acc: 0.2746
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.4722
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 7 ============
denominator: 34207.3359375
 Site-art_painting                  | Train Loss: 1.5799 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.6982 | Train Acc: 0.4783
 Site-art_painting                  | Train Loss: 1.6348 | Train Acc: 0.7333
 Site-art_painting                  | Train Loss: 1.6092 | Train Acc: 0.6842
 Site-art_painting                  | Train Loss: 1.6289 | Train Acc: 0.6000
 Site-art_painting                  | Train Loss: 1.5667 | Train Acc: 0.7031
 Site-art_painting                  | Train Loss: 1.6347 | Train Acc: 0.6747
 Site-art_painting                  | Train Loss: 1.6243 | Train Acc: 0.7290
 Site-art_painting                  | Train Loss: 1.6150 | Train Acc: 0.6619
 Site-art_painting                  | Train Loss: 1.6326 | Train Acc: 0.6778
 Site-photo                         | Train Loss: 1.4876 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.5282 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.4985 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.5241 | Train Acc: 0.9318
 Site-photo                         | Train Loss: 1.4853 | Train Acc: 0.9809
 Site-sketch                        | Train Loss: 1.7583 | Train Acc: 0.4286
 Site-sketch                        | Train Loss: 1.8127 | Train Acc: 0.2958
 Site-cartoon                       | Train Loss: 1.7619 | Train Acc: 0.5139
Average Train Accuracy: 0.7139
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:7 | Val Acc: 0.4783
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:7 | Val Acc: 0.6842
 Best site-art_painting              | Epoch:7 | Val Acc: 0.6000
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7031
 Best site-art_painting              | Epoch:7 | Val Acc: 0.6747
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7290
 Best site-art_painting              | Epoch:7 | Val Acc: 0.6619
 Best site-art_painting              | Epoch:7 | Val Acc: 0.6778
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 0.9796
 Best site-photo                     | Epoch:7 | Val Acc: 0.9318
 Best site-photo                     | Epoch:7 | Val Acc: 0.9809
 Best site-sketch                    | Epoch:7 | Val Acc: 0.4286
 Best site-sketch                    | Epoch:7 | Val Acc: 0.2958
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.5139
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 8 ============
denominator: 33649.93359375
 Site-art_painting                  | Train Loss: 1.5678 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.6685 | Train Acc: 0.4783
 Site-art_painting                  | Train Loss: 1.6152 | Train Acc: 0.5333
 Site-art_painting                  | Train Loss: 1.5419 | Train Acc: 0.7632
 Site-art_painting                  | Train Loss: 1.6225 | Train Acc: 0.6000
 Site-art_painting                  | Train Loss: 1.5394 | Train Acc: 0.7969
 Site-art_painting                  | Train Loss: 1.6318 | Train Acc: 0.6506
 Site-art_painting                  | Train Loss: 1.5942 | Train Acc: 0.7477
 Site-art_painting                  | Train Loss: 1.5925 | Train Acc: 0.6835
 Site-art_painting                  | Train Loss: 1.5901 | Train Acc: 0.7444
 Site-photo                         | Train Loss: 1.4250 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.4692 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.4558 | Train Acc: 0.9388
 Site-photo                         | Train Loss: 1.4800 | Train Acc: 0.9318
 Site-photo                         | Train Loss: 1.4308 | Train Acc: 0.9809
 Site-sketch                        | Train Loss: 1.7493 | Train Acc: 0.3571
 Site-sketch                        | Train Loss: 1.8063 | Train Acc: 0.3028
 Site-cartoon                       | Train Loss: 1.7583 | Train Acc: 0.5556
Average Train Accuracy: 0.7135
============ Train epoch 9 ============
denominator: 32916.0234375
 Site-art_painting                  | Train Loss: 1.5255 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.5503 | Train Acc: 0.6087
 Site-art_painting                  | Train Loss: 1.5856 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.5066 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 1.5734 | Train Acc: 0.6600
 Site-art_painting                  | Train Loss: 1.4905 | Train Acc: 0.7344
 Site-art_painting                  | Train Loss: 1.5794 | Train Acc: 0.6988
 Site-art_painting                  | Train Loss: 1.5569 | Train Acc: 0.7103
 Site-art_painting                  | Train Loss: 1.5575 | Train Acc: 0.6691
 Site-art_painting                  | Train Loss: 1.5536 | Train Acc: 0.7111
 Site-photo                         | Train Loss: 1.3702 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.4240 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3806 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 1.4326 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 1.3816 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.7215 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.7839 | Train Acc: 0.3380
 Site-cartoon                       | Train Loss: 1.7213 | Train Acc: 0.5833
Average Train Accuracy: 0.7434
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:9 | Val Acc: 0.6087
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7000
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7895
 Best site-art_painting              | Epoch:9 | Val Acc: 0.6600
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7344
 Best site-art_painting              | Epoch:9 | Val Acc: 0.6988
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7103
 Best site-art_painting              | Epoch:9 | Val Acc: 0.6691
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7111
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 0.9592
 Best site-photo                     | Epoch:9 | Val Acc: 0.9545
 Best site-photo                     | Epoch:9 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:9 | Val Acc: 0.5000
 Best site-sketch                    | Epoch:9 | Val Acc: 0.3380
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.5833
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 10 ============
denominator: 32216.7265625
 Site-art_painting                  | Train Loss: 1.5032 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.6054 | Train Acc: 0.5652
 Site-art_painting                  | Train Loss: 1.5304 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.4493 | Train Acc: 0.7105
 Site-art_painting                  | Train Loss: 1.5409 | Train Acc: 0.6800
 Site-art_painting                  | Train Loss: 1.4675 | Train Acc: 0.7656
 Site-art_painting                  | Train Loss: 1.5386 | Train Acc: 0.7349
 Site-art_painting                  | Train Loss: 1.4816 | Train Acc: 0.7477
 Site-art_painting                  | Train Loss: 1.5145 | Train Acc: 0.6906
 Site-art_painting                  | Train Loss: 1.5288 | Train Acc: 0.7111
 Site-photo                         | Train Loss: 1.3108 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3861 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3260 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.3809 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 1.3221 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.7075 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.7699 | Train Acc: 0.3592
 Site-cartoon                       | Train Loss: 1.7147 | Train Acc: 0.5972
Average Train Accuracy: 0.7454
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:10 | Val Acc: 0.5652
 Best site-art_painting              | Epoch:10 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7105
 Best site-art_painting              | Epoch:10 | Val Acc: 0.6800
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7656
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7349
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7477
 Best site-art_painting              | Epoch:10 | Val Acc: 0.6906
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7111
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9796
 Best site-photo                     | Epoch:10 | Val Acc: 0.9432
 Best site-photo                     | Epoch:10 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:10 | Val Acc: 0.5000
 Best site-sketch                    | Epoch:10 | Val Acc: 0.3592
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.5972
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 11 ============
denominator: 31608.884765625
 Site-art_painting                  | Train Loss: 1.4627 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.5767 | Train Acc: 0.5652
 Site-art_painting                  | Train Loss: 1.5249 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.4070 | Train Acc: 0.8421
 Site-art_painting                  | Train Loss: 1.5069 | Train Acc: 0.6000
 Site-art_painting                  | Train Loss: 1.4099 | Train Acc: 0.8281
 Site-art_painting                  | Train Loss: 1.4981 | Train Acc: 0.7470
 Site-art_painting                  | Train Loss: 1.4420 | Train Acc: 0.7944
 Site-art_painting                  | Train Loss: 1.4758 | Train Acc: 0.7122
 Site-art_painting                  | Train Loss: 1.4746 | Train Acc: 0.7500
 Site-photo                         | Train Loss: 1.2722 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3410 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2880 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.3225 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 1.2773 | Train Acc: 0.9745
 Site-sketch                        | Train Loss: 1.6849 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.7744 | Train Acc: 0.3732
 Site-cartoon                       | Train Loss: 1.7062 | Train Acc: 0.5972
Average Train Accuracy: 0.7663
 Best site-art_painting              | Epoch:11 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:11 | Val Acc: 0.5652
 Best site-art_painting              | Epoch:11 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8421
 Best site-art_painting              | Epoch:11 | Val Acc: 0.6000
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8281
 Best site-art_painting              | Epoch:11 | Val Acc: 0.7470
 Best site-art_painting              | Epoch:11 | Val Acc: 0.7944
 Best site-art_painting              | Epoch:11 | Val Acc: 0.7122
 Best site-art_painting              | Epoch:11 | Val Acc: 0.7500
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 0.9796
 Best site-photo                     | Epoch:11 | Val Acc: 0.9432
 Best site-photo                     | Epoch:11 | Val Acc: 0.9745
 Best site-sketch                    | Epoch:11 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:11 | Val Acc: 0.3732
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.5972
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 12 ============
denominator: 30906.53125
 Site-art_painting                  | Train Loss: 1.4143 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.5354 | Train Acc: 0.5652
 Site-art_painting                  | Train Loss: 1.5081 | Train Acc: 0.6000
 Site-art_painting                  | Train Loss: 1.4537 | Train Acc: 0.7368
 Site-art_painting                  | Train Loss: 1.5184 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.3792 | Train Acc: 0.8281
 Site-art_painting                  | Train Loss: 1.4827 | Train Acc: 0.6988
 Site-art_painting                  | Train Loss: 1.4293 | Train Acc: 0.7570
 Site-art_painting                  | Train Loss: 1.4505 | Train Acc: 0.7050
 Site-art_painting                  | Train Loss: 1.4572 | Train Acc: 0.7444
 Site-photo                         | Train Loss: 1.2055 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2980 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2268 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 1.2843 | Train Acc: 0.9205
 Site-photo                         | Train Loss: 1.2227 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.6819 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.7475 | Train Acc: 0.3944
 Site-cartoon                       | Train Loss: 1.6734 | Train Acc: 0.6111
Average Train Accuracy: 0.7571
============ Train epoch 13 ============
denominator: 30315.083984375
 Site-art_painting                  | Train Loss: 1.4097 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.4881 | Train Acc: 0.5652
 Site-art_painting                  | Train Loss: 1.4708 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.3381 | Train Acc: 0.8684
 Site-art_painting                  | Train Loss: 1.4387 | Train Acc: 0.6600
 Site-art_painting                  | Train Loss: 1.3241 | Train Acc: 0.8594
 Site-art_painting                  | Train Loss: 1.4273 | Train Acc: 0.7229
 Site-art_painting                  | Train Loss: 1.4305 | Train Acc: 0.7477
 Site-art_painting                  | Train Loss: 1.3857 | Train Acc: 0.7338
 Site-art_painting                  | Train Loss: 1.4022 | Train Acc: 0.7611
 Site-photo                         | Train Loss: 1.1585 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2390 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1881 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 1.2246 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 1.1696 | Train Acc: 0.9809
 Site-sketch                        | Train Loss: 1.6342 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.7283 | Train Acc: 0.4014
 Site-cartoon                       | Train Loss: 1.6253 | Train Acc: 0.5556
Average Train Accuracy: 0.7613
============ Train epoch 14 ============
denominator: 29471.89453125
 Site-art_painting                  | Train Loss: 1.3646 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.4365 | Train Acc: 0.6087
 Site-art_painting                  | Train Loss: 1.4234 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.2522 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 1.4281 | Train Acc: 0.6400
 Site-art_painting                  | Train Loss: 1.2917 | Train Acc: 0.8594
 Site-art_painting                  | Train Loss: 1.3981 | Train Acc: 0.7590
 Site-art_painting                  | Train Loss: 1.3462 | Train Acc: 0.7944
 Site-art_painting                  | Train Loss: 1.3917 | Train Acc: 0.7266
 Site-art_painting                  | Train Loss: 1.3765 | Train Acc: 0.7667
 Site-photo                         | Train Loss: 1.0969 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1712 | Train Acc: 0.9388
 Site-photo                         | Train Loss: 1.1894 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 1.1249 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.6425 | Train Acc: 0.4286
 Site-sketch                        | Train Loss: 1.7269 | Train Acc: 0.3873
 Site-cartoon                       | Train Loss: 1.5845 | Train Acc: 0.6111
Average Train Accuracy: 0.7637
============ Train epoch 15 ============
denominator: 28915.3125
 Site-art_painting                  | Train Loss: 1.3197 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.4282 | Train Acc: 0.5652
 Site-art_painting                  | Train Loss: 1.4021 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.3081 | Train Acc: 0.8421
 Site-art_painting                  | Train Loss: 1.4190 | Train Acc: 0.6600
 Site-art_painting                  | Train Loss: 1.2786 | Train Acc: 0.8281
 Site-art_painting                  | Train Loss: 1.3714 | Train Acc: 0.7470
 Site-art_painting                  | Train Loss: 1.3330 | Train Acc: 0.8037
 Site-art_painting                  | Train Loss: 1.3783 | Train Acc: 0.7626
 Site-art_painting                  | Train Loss: 1.3398 | Train Acc: 0.8111
 Site-photo                         | Train Loss: 1.0536 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1402 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0951 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.1518 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 1.0806 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.6638 | Train Acc: 0.4286
 Site-sketch                        | Train Loss: 1.6991 | Train Acc: 0.4366
 Site-cartoon                       | Train Loss: 1.6350 | Train Acc: 0.5833
Average Train Accuracy: 0.7729
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:15 | Val Acc: 0.5652
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7000
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8421
 Best site-art_painting              | Epoch:15 | Val Acc: 0.6600
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8281
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7470
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8037
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7626
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8111
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 0.9796
 Best site-photo                     | Epoch:15 | Val Acc: 0.9432
 Best site-photo                     | Epoch:15 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:15 | Val Acc: 0.4286
 Best site-sketch                    | Epoch:15 | Val Acc: 0.4366
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.5833
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 16 ============
denominator: 28411.6484375
 Site-art_painting                  | Train Loss: 1.2988 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.4460 | Train Acc: 0.5652
 Site-art_painting                  | Train Loss: 1.3715 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 1.2001 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 1.3805 | Train Acc: 0.7400
 Site-art_painting                  | Train Loss: 1.2567 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 1.3614 | Train Acc: 0.7470
 Site-art_painting                  | Train Loss: 1.2833 | Train Acc: 0.8037
 Site-art_painting                  | Train Loss: 1.3045 | Train Acc: 0.7626
 Site-art_painting                  | Train Loss: 1.3191 | Train Acc: 0.7944
 Site-photo                         | Train Loss: 1.0198 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1129 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0281 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.0951 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 1.0316 | Train Acc: 0.9809
 Site-sketch                        | Train Loss: 1.6572 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.6777 | Train Acc: 0.4789
 Site-cartoon                       | Train Loss: 1.5744 | Train Acc: 0.5972
Average Train Accuracy: 0.7928
 Best site-art_painting              | Epoch:16 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:16 | Val Acc: 0.5652
 Best site-art_painting              | Epoch:16 | Val Acc: 0.7667
 Best site-art_painting              | Epoch:16 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:16 | Val Acc: 0.7400
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:16 | Val Acc: 0.7470
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8037
 Best site-art_painting              | Epoch:16 | Val Acc: 0.7626
 Best site-art_painting              | Epoch:16 | Val Acc: 0.7944
 Best site-photo                     | Epoch:16 | Val Acc: 1.0000
 Best site-photo                     | Epoch:16 | Val Acc: 1.0000
 Best site-photo                     | Epoch:16 | Val Acc: 0.9796
 Best site-photo                     | Epoch:16 | Val Acc: 0.9545
 Best site-photo                     | Epoch:16 | Val Acc: 0.9809
 Best site-sketch                    | Epoch:16 | Val Acc: 0.5000
 Best site-sketch                    | Epoch:16 | Val Acc: 0.4789
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.5972
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 17 ============
denominator: 27586.197265625
 Site-art_painting                  | Train Loss: 1.2676 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.3288 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.3602 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.1966 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.2764 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 1.2099 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 1.2935 | Train Acc: 0.8434
 Site-art_painting                  | Train Loss: 1.2931 | Train Acc: 0.8131
 Site-art_painting                  | Train Loss: 1.2721 | Train Acc: 0.7914
 Site-art_painting                  | Train Loss: 1.2749 | Train Acc: 0.8000
 Site-photo                         | Train Loss: 0.9460 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0617 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9928 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0645 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 0.9942 | Train Acc: 0.9809
 Site-sketch                        | Train Loss: 1.5965 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.6769 | Train Acc: 0.5141
 Site-cartoon                       | Train Loss: 1.6286 | Train Acc: 0.6111
Average Train Accuracy: 0.8061
 Best site-art_painting              | Epoch:17 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:17 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:17 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:17 | Val Acc: 0.7600
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8906
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8434
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8131
 Best site-art_painting              | Epoch:17 | Val Acc: 0.7914
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8000
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 0.9432
 Best site-photo                     | Epoch:17 | Val Acc: 0.9809
 Best site-sketch                    | Epoch:17 | Val Acc: 0.5714
 Best site-sketch                    | Epoch:17 | Val Acc: 0.5141
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.6111
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 18 ============
denominator: 27075.927734375
 Site-art_painting                  | Train Loss: 1.2419 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.3243 | Train Acc: 0.6087
 Site-art_painting                  | Train Loss: 1.3434 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.1955 | Train Acc: 0.8421
 Site-art_painting                  | Train Loss: 1.3329 | Train Acc: 0.6800
 Site-art_painting                  | Train Loss: 1.1722 | Train Acc: 0.8438
 Site-art_painting                  | Train Loss: 1.2761 | Train Acc: 0.7831
 Site-art_painting                  | Train Loss: 1.2236 | Train Acc: 0.8131
 Site-art_painting                  | Train Loss: 1.2343 | Train Acc: 0.7986
 Site-art_painting                  | Train Loss: 1.2527 | Train Acc: 0.8111
 Site-photo                         | Train Loss: 0.9110 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0347 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9539 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 1.0203 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 0.9413 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.5636 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.6551 | Train Acc: 0.4507
 Site-cartoon                       | Train Loss: 1.5229 | Train Acc: 0.6111
Average Train Accuracy: 0.7866
============ Train epoch 19 ============
denominator: 26572.30859375
 Site-art_painting                  | Train Loss: 1.2525 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.2786 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 1.2299 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 1.1508 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.2403 | Train Acc: 0.7400
 Site-art_painting                  | Train Loss: 1.1598 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 1.2226 | Train Acc: 0.8193
 Site-art_painting                  | Train Loss: 1.2297 | Train Acc: 0.8037
 Site-art_painting                  | Train Loss: 1.2021 | Train Acc: 0.7842
 Site-art_painting                  | Train Loss: 1.1941 | Train Acc: 0.8444
 Site-photo                         | Train Loss: 0.8720 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9776 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9204 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.9596 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.8988 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.5929 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.6503 | Train Acc: 0.4437
 Site-cartoon                       | Train Loss: 1.5163 | Train Acc: 0.6111
Average Train Accuracy: 0.8182
 Best site-art_painting              | Epoch:19 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:19 | Val Acc: 0.7391
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:19 | Val Acc: 0.7400
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8193
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8037
 Best site-art_painting              | Epoch:19 | Val Acc: 0.7842
 Best site-art_painting              | Epoch:19 | Val Acc: 0.8444
 Best site-photo                     | Epoch:19 | Val Acc: 1.0000
 Best site-photo                     | Epoch:19 | Val Acc: 1.0000
 Best site-photo                     | Epoch:19 | Val Acc: 0.9796
 Best site-photo                     | Epoch:19 | Val Acc: 0.9773
 Best site-photo                     | Epoch:19 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:19 | Val Acc: 0.5714
 Best site-sketch                    | Epoch:19 | Val Acc: 0.4437
 Best site-cartoon                   | Epoch:19 | Val Acc: 0.6111
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 20 ============
denominator: 25822.81640625
 Site-art_painting                  | Train Loss: 1.1662 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.2546 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 1.2647 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 1.0166 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 1.2896 | Train Acc: 0.6600
 Site-art_painting                  | Train Loss: 1.0795 | Train Acc: 0.8594
 Site-art_painting                  | Train Loss: 1.2156 | Train Acc: 0.8072
 Site-art_painting                  | Train Loss: 1.1968 | Train Acc: 0.8318
 Site-art_painting                  | Train Loss: 1.2131 | Train Acc: 0.7482
 Site-art_painting                  | Train Loss: 1.1984 | Train Acc: 0.8000
 Site-photo                         | Train Loss: 0.8233 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9558 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8691 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9291 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.8483 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.5163 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.6426 | Train Acc: 0.4718
 Site-cartoon                       | Train Loss: 1.4695 | Train Acc: 0.6250
Average Train Accuracy: 0.8127
============ Train epoch 21 ============
denominator: 25571.87890625
 Site-art_painting                  | Train Loss: 1.0918 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.2749 | Train Acc: 0.5652
 Site-art_painting                  | Train Loss: 1.2276 | Train Acc: 0.7333
 Site-art_painting                  | Train Loss: 0.9525 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 1.2045 | Train Acc: 0.7400
 Site-art_painting                  | Train Loss: 1.0910 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 1.2190 | Train Acc: 0.8554
 Site-art_painting                  | Train Loss: 1.1429 | Train Acc: 0.8692
 Site-art_painting                  | Train Loss: 1.1458 | Train Acc: 0.8129
 Site-art_painting                  | Train Loss: 1.1863 | Train Acc: 0.7944
 Site-photo                         | Train Loss: 0.8024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8716 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8479 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.9061 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 0.8084 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.5303 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.6324 | Train Acc: 0.5141
 Site-cartoon                       | Train Loss: 1.4814 | Train Acc: 0.6111
Average Train Accuracy: 0.8133
============ Train epoch 22 ============
denominator: 25166.212890625
 Site-art_painting                  | Train Loss: 1.1368 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.1366 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 1.1001 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 1.0927 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.1474 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 1.0599 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 1.1966 | Train Acc: 0.7831
 Site-art_painting                  | Train Loss: 1.1039 | Train Acc: 0.8224
 Site-art_painting                  | Train Loss: 1.1408 | Train Acc: 0.8129
 Site-art_painting                  | Train Loss: 1.1310 | Train Acc: 0.8111
 Site-photo                         | Train Loss: 0.7340 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8998 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8343 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 0.8443 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.7798 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.4860 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.6167 | Train Acc: 0.4930
 Site-cartoon                       | Train Loss: 1.4332 | Train Acc: 0.6250
Average Train Accuracy: 0.8177
============ Train epoch 23 ============
denominator: 24632.1953125
 Site-art_painting                  | Train Loss: 1.1209 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.2663 | Train Acc: 0.6087
 Site-art_painting                  | Train Loss: 1.1697 | Train Acc: 0.7333
 Site-art_painting                  | Train Loss: 1.0769 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 1.2032 | Train Acc: 0.7400
 Site-art_painting                  | Train Loss: 1.0050 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 1.1018 | Train Acc: 0.8434
 Site-art_painting                  | Train Loss: 1.1313 | Train Acc: 0.8131
 Site-art_painting                  | Train Loss: 1.1259 | Train Acc: 0.8201
 Site-art_painting                  | Train Loss: 1.1055 | Train Acc: 0.8500
 Site-photo                         | Train Loss: 0.6950 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8342 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8269 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 0.8190 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 0.7434 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.4850 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.5923 | Train Acc: 0.5141
 Site-cartoon                       | Train Loss: 1.4732 | Train Acc: 0.6528
Average Train Accuracy: 0.8248
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:23 | Val Acc: 0.6087
 Best site-art_painting              | Epoch:23 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:23 | Val Acc: 0.7400
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8434
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8131
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8201
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8500
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-photo                     | Epoch:23 | Val Acc: 0.9592
 Best site-photo                     | Epoch:23 | Val Acc: 0.9545
 Best site-photo                     | Epoch:23 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:23 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:23 | Val Acc: 0.5141
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.6528
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 24 ============
denominator: 23883.1171875
 Site-art_painting                  | Train Loss: 1.0259 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 1.2076 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.0910 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.9470 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 1.1238 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 1.0040 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 1.1401 | Train Acc: 0.7711
 Site-art_painting                  | Train Loss: 1.0572 | Train Acc: 0.8692
 Site-art_painting                  | Train Loss: 1.1057 | Train Acc: 0.8058
 Site-art_painting                  | Train Loss: 1.0677 | Train Acc: 0.8333
 Site-photo                         | Train Loss: 0.6839 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7741 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7383 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.7775 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.7003 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.4903 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.6081 | Train Acc: 0.4859
 Site-cartoon                       | Train Loss: 1.4112 | Train Acc: 0.6389
Average Train Accuracy: 0.8346
 Best site-art_painting              | Epoch:24 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:24 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:24 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:24 | Val Acc: 0.7600
 Best site-art_painting              | Epoch:24 | Val Acc: 0.9062
 Best site-art_painting              | Epoch:24 | Val Acc: 0.7711
 Best site-art_painting              | Epoch:24 | Val Acc: 0.8692
 Best site-art_painting              | Epoch:24 | Val Acc: 0.8058
 Best site-art_painting              | Epoch:24 | Val Acc: 0.8333
 Best site-photo                     | Epoch:24 | Val Acc: 1.0000
 Best site-photo                     | Epoch:24 | Val Acc: 1.0000
 Best site-photo                     | Epoch:24 | Val Acc: 0.9796
 Best site-photo                     | Epoch:24 | Val Acc: 0.9773
 Best site-photo                     | Epoch:24 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:24 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:24 | Val Acc: 0.4859
 Best site-cartoon                   | Epoch:24 | Val Acc: 0.6389
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 25 ============
denominator: 23337.412109375
 Site-art_painting                  | Train Loss: 1.0867 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.0919 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.0867 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.8865 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 1.1476 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 1.0327 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 1.0773 | Train Acc: 0.8072
 Site-art_painting                  | Train Loss: 1.0634 | Train Acc: 0.8318
 Site-art_painting                  | Train Loss: 1.0653 | Train Acc: 0.8201
 Site-art_painting                  | Train Loss: 1.0507 | Train Acc: 0.8556
 Site-photo                         | Train Loss: 0.6475 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7348 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7473 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 0.7571 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.6724 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.4682 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 1.5894 | Train Acc: 0.4930
 Site-cartoon                       | Train Loss: 1.3918 | Train Acc: 0.6528
Average Train Accuracy: 0.8385
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:25 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:25 | Val Acc: 0.7600
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8072
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8318
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8201
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8556
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 0.9592
 Best site-photo                     | Epoch:25 | Val Acc: 0.9659
 Best site-photo                     | Epoch:25 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:25 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:25 | Val Acc: 0.4930
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.6528
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 26 ============
denominator: 23122.408203125
 Site-art_painting                  | Train Loss: 1.0165 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.1809 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.0712 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 0.8290 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 1.1259 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 0.9293 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 1.0505 | Train Acc: 0.8313
 Site-art_painting                  | Train Loss: 1.0110 | Train Acc: 0.8785
 Site-art_painting                  | Train Loss: 1.0121 | Train Acc: 0.8273
 Site-art_painting                  | Train Loss: 1.0318 | Train Acc: 0.8556
 Site-photo                         | Train Loss: 0.5973 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7135 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6687 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7244 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 0.6353 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.4408 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.5517 | Train Acc: 0.5070
 Site-cartoon                       | Train Loss: 1.4438 | Train Acc: 0.6250
Average Train Accuracy: 0.8251
============ Train epoch 27 ============
denominator: 22616.724609375
 Site-art_painting                  | Train Loss: 1.0192 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.0755 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.0195 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8230 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 1.1341 | Train Acc: 0.7200
 Site-art_painting                  | Train Loss: 0.8986 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 1.0014 | Train Acc: 0.8434
 Site-art_painting                  | Train Loss: 0.9406 | Train Acc: 0.8598
 Site-art_painting                  | Train Loss: 1.0092 | Train Acc: 0.8273
 Site-art_painting                  | Train Loss: 1.0069 | Train Acc: 0.8500
 Site-photo                         | Train Loss: 0.5378 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6836 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6297 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6848 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.6017 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.4511 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.5807 | Train Acc: 0.4859
 Site-cartoon                       | Train Loss: 1.4264 | Train Acc: 0.6250
Average Train Accuracy: 0.8303
============ Train epoch 28 ============
denominator: 21981.5625
 Site-art_painting                  | Train Loss: 1.0509 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.0014 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 1.1006 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 0.9633 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.0283 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8948 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 1.0242 | Train Acc: 0.8554
 Site-art_painting                  | Train Loss: 0.9803 | Train Acc: 0.8692
 Site-art_painting                  | Train Loss: 1.0016 | Train Acc: 0.7842
 Site-art_painting                  | Train Loss: 0.9753 | Train Acc: 0.8500
 Site-photo                         | Train Loss: 0.5176 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6560 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6188 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.6459 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.5726 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.4836 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.5618 | Train Acc: 0.4718
 Site-cartoon                       | Train Loss: 1.4122 | Train Acc: 0.6528
Average Train Accuracy: 0.8261
============ Train epoch 29 ============
denominator: 21591.51953125
 Site-art_painting                  | Train Loss: 0.9815 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 1.0515 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.9982 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.7882 | Train Acc: 0.8684
 Site-art_painting                  | Train Loss: 1.0611 | Train Acc: 0.6400
 Site-art_painting                  | Train Loss: 0.8342 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.9702 | Train Acc: 0.8313
 Site-art_painting                  | Train Loss: 0.9375 | Train Acc: 0.8505
 Site-art_painting                  | Train Loss: 0.9659 | Train Acc: 0.8417
 Site-art_painting                  | Train Loss: 0.9308 | Train Acc: 0.8556
 Site-photo                         | Train Loss: 0.4940 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6191 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5615 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.6355 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.5612 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.3861 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.5017 | Train Acc: 0.5493
 Site-cartoon                       | Train Loss: 1.3080 | Train Acc: 0.5972
Average Train Accuracy: 0.8281
============ Train epoch 30 ============
denominator: 21206.537109375
 Site-art_painting                  | Train Loss: 0.9414 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.0538 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 1.0509 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.7327 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.9802 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8440 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.9582 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.8771 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.9627 | Train Acc: 0.8273
 Site-art_painting                  | Train Loss: 0.9493 | Train Acc: 0.8167
 Site-photo                         | Train Loss: 0.4779 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5917 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5391 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.6033 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.5082 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.3941 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.5164 | Train Acc: 0.4930
 Site-cartoon                       | Train Loss: 1.2354 | Train Acc: 0.6528
Average Train Accuracy: 0.8431
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:30 | Val Acc: 0.7391
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:30 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8675
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8879
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8273
 Best site-art_painting              | Epoch:30 | Val Acc: 0.8167
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-photo                     | Epoch:30 | Val Acc: 1.0000
 Best site-photo                     | Epoch:30 | Val Acc: 0.9796
 Best site-photo                     | Epoch:30 | Val Acc: 0.9659
 Best site-photo                     | Epoch:30 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:30 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:30 | Val Acc: 0.4930
 Best site-cartoon                   | Epoch:30 | Val Acc: 0.6528
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 31 ============
denominator: 20360.607421875
 Site-art_painting                  | Train Loss: 0.9402 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.0061 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.9700 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 0.8034 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.9516 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8901 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.9258 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.8427 | Train Acc: 0.8785
 Site-art_painting                  | Train Loss: 0.9195 | Train Acc: 0.8417
 Site-art_painting                  | Train Loss: 0.9270 | Train Acc: 0.8556
 Site-photo                         | Train Loss: 0.4519 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5779 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5190 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.5911 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.5048 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.4041 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.5007 | Train Acc: 0.5070
 Site-cartoon                       | Train Loss: 1.3784 | Train Acc: 0.5833
Average Train Accuracy: 0.8348
============ Train epoch 32 ============
denominator: 20517.55078125
 Site-art_painting                  | Train Loss: 0.9415 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.9956 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.9469 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8440 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.0013 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 0.8129 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.9017 | Train Acc: 0.8554
 Site-art_painting                  | Train Loss: 0.8322 | Train Acc: 0.8692
 Site-art_painting                  | Train Loss: 0.9712 | Train Acc: 0.8489
 Site-art_painting                  | Train Loss: 0.8914 | Train Acc: 0.8444
 Site-photo                         | Train Loss: 0.4360 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5526 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4897 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.5387 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 0.4574 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.3443 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.5123 | Train Acc: 0.5141
 Site-cartoon                       | Train Loss: 1.2306 | Train Acc: 0.6944
Average Train Accuracy: 0.8495
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:32 | Val Acc: 0.7826
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:32 | Val Acc: 0.7600
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8554
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8692
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8489
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8444
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 0.9796
 Best site-photo                     | Epoch:32 | Val Acc: 0.9432
 Best site-photo                     | Epoch:32 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:32 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:32 | Val Acc: 0.5141
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.6944
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 33 ============
denominator: 20044.6875
 Site-art_painting                  | Train Loss: 0.8838 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.9091 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.9255 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.6110 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.9686 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.7786 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.8663 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.8265 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.8239 | Train Acc: 0.8345
 Site-art_painting                  | Train Loss: 0.8657 | Train Acc: 0.8611
 Site-photo                         | Train Loss: 0.3856 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5156 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4700 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.5318 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.4303 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.3785 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.4843 | Train Acc: 0.5282
 Site-cartoon                       | Train Loss: 1.2346 | Train Acc: 0.6667
Average Train Accuracy: 0.8648
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:33 | Val Acc: 0.7826
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9036
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8879
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8345
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8611
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 0.9796
 Best site-photo                     | Epoch:33 | Val Acc: 0.9773
 Best site-photo                     | Epoch:33 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:33 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:33 | Val Acc: 0.5282
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 34 ============
denominator: 19518.96484375
 Site-art_painting                  | Train Loss: 0.8386 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8531 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.8106 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.8394 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.9088 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.7865 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.8539 | Train Acc: 0.8554
 Site-art_painting                  | Train Loss: 0.8794 | Train Acc: 0.8692
 Site-art_painting                  | Train Loss: 0.7996 | Train Acc: 0.8345
 Site-art_painting                  | Train Loss: 0.8290 | Train Acc: 0.8667
 Site-photo                         | Train Loss: 0.4004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4884 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4321 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5042 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.4096 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.3790 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.5131 | Train Acc: 0.4859
 Site-cartoon                       | Train Loss: 1.2647 | Train Acc: 0.6111
Average Train Accuracy: 0.8543
============ Train epoch 35 ============
denominator: 19277.193359375
 Site-art_painting                  | Train Loss: 0.8450 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.8674 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.8729 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.6355 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.8884 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 0.7009 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.9378 | Train Acc: 0.8072
 Site-art_painting                  | Train Loss: 0.8579 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.8491 | Train Acc: 0.8201
 Site-art_painting                  | Train Loss: 0.8130 | Train Acc: 0.8611
 Site-photo                         | Train Loss: 0.3581 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4608 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4199 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4785 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.4076 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2688 | Train Acc: 0.8571
 Site-sketch                        | Train Loss: 1.4736 | Train Acc: 0.5563
 Site-cartoon                       | Train Loss: 1.1788 | Train Acc: 0.6806
Average Train Accuracy: 0.8646
============ Train epoch 36 ============
denominator: 19077.087890625
 Site-art_painting                  | Train Loss: 0.8559 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9628 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 0.9073 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.6638 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.7939 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.7324 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.8752 | Train Acc: 0.8434
 Site-art_painting                  | Train Loss: 0.7525 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.8160 | Train Acc: 0.8417
 Site-art_painting                  | Train Loss: 0.8076 | Train Acc: 0.8722
 Site-photo                         | Train Loss: 0.3324 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4307 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3932 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4764 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.3787 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.3497 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.4313 | Train Acc: 0.5493
 Site-cartoon                       | Train Loss: 1.1611 | Train Acc: 0.6528
Average Train Accuracy: 0.8528
============ Train epoch 37 ============
denominator: 18739.05859375
 Site-art_painting                  | Train Loss: 0.7348 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.8533 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.8508 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.4493 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.8895 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.7307 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.8571 | Train Acc: 0.8434
 Site-art_painting                  | Train Loss: 0.6873 | Train Acc: 0.9159
 Site-art_painting                  | Train Loss: 0.8039 | Train Acc: 0.8129
 Site-art_painting                  | Train Loss: 0.7664 | Train Acc: 0.8778
 Site-photo                         | Train Loss: 0.3056 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4400 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3663 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.4334 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.3650 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2890 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 1.4330 | Train Acc: 0.5211
 Site-cartoon                       | Train Loss: 1.2759 | Train Acc: 0.6667
Average Train Accuracy: 0.8616
============ Train epoch 38 ============
denominator: 18638.828125
 Site-art_painting                  | Train Loss: 0.8102 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.8291 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.7583 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.7237 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.7903 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.6899 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.8573 | Train Acc: 0.8434
 Site-art_painting                  | Train Loss: 0.7594 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.8160 | Train Acc: 0.8561
 Site-art_painting                  | Train Loss: 0.7864 | Train Acc: 0.8611
 Site-photo                         | Train Loss: 0.2907 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4355 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3559 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4123 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.3519 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.3001 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.4320 | Train Acc: 0.5493
 Site-cartoon                       | Train Loss: 1.2722 | Train Acc: 0.6528
Average Train Accuracy: 0.8648
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:38 | Val Acc: 0.7800
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8434
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8879
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8561
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8611
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 0.9773
 Best site-photo                     | Epoch:38 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:38 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:38 | Val Acc: 0.5493
 Best site-cartoon                   | Epoch:38 | Val Acc: 0.6528
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 39 ============
denominator: 18141.287109375
 Site-art_painting                  | Train Loss: 0.8138 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 0.8304 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.8258 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5173 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.8149 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.6509 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.8095 | Train Acc: 0.9157
 Site-art_painting                  | Train Loss: 0.7701 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.8112 | Train Acc: 0.8417
 Site-art_painting                  | Train Loss: 0.7539 | Train Acc: 0.8667
 Site-photo                         | Train Loss: 0.2608 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3840 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3338 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3993 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.3310 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.2784 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.4307 | Train Acc: 0.5141
 Site-cartoon                       | Train Loss: 1.1338 | Train Acc: 0.6528
Average Train Accuracy: 0.8553
============ Train epoch 40 ============
denominator: 17537.923828125
 Site-art_painting                  | Train Loss: 0.7720 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.9729 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 0.7849 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.5305 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.8541 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.6420 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.7881 | Train Acc: 0.8795
 Site-art_painting                  | Train Loss: 0.7148 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.7294 | Train Acc: 0.8561
 Site-art_painting                  | Train Loss: 0.7032 | Train Acc: 0.8722
 Site-photo                         | Train Loss: 0.2524 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3694 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3284 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3802 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.3031 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.2637 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.4195 | Train Acc: 0.5423
 Site-cartoon                       | Train Loss: 1.2548 | Train Acc: 0.6667
Average Train Accuracy: 0.8625
============ Train epoch 41 ============
denominator: 17506.05078125
 Site-art_painting                  | Train Loss: 0.8031 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.7310 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.8431 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5181 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.7388 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.5929 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.7645 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.7097 | Train Acc: 0.8692
 Site-art_painting                  | Train Loss: 0.7312 | Train Acc: 0.8705
 Site-art_painting                  | Train Loss: 0.7360 | Train Acc: 0.8611
 Site-photo                         | Train Loss: 0.2542 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3542 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3563 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3572 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.2897 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2087 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.3973 | Train Acc: 0.5634
 Site-cartoon                       | Train Loss: 1.1402 | Train Acc: 0.6389
Average Train Accuracy: 0.8669
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8600
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9036
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8692
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8705
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8611
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 0.9796
 Best site-photo                     | Epoch:41 | Val Acc: 0.9773
 Best site-photo                     | Epoch:41 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:41 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:41 | Val Acc: 0.5634
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.6389
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 42 ============
denominator: 17256.984375
 Site-art_painting                  | Train Loss: 0.7435 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.9202 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.7578 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3934 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.9060 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.6278 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.7812 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.6995 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.7282 | Train Acc: 0.8273
 Site-art_painting                  | Train Loss: 0.7228 | Train Acc: 0.8778
 Site-photo                         | Train Loss: 0.2322 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3390 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2832 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3832 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.2812 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2870 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.3946 | Train Acc: 0.5563
 Site-cartoon                       | Train Loss: 1.1490 | Train Acc: 0.7083
Average Train Accuracy: 0.8584
============ Train epoch 43 ============
denominator: 17098.392578125
 Site-art_painting                  | Train Loss: 0.7542 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.9477 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 0.7444 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.4830 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.7664 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.6369 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.7091 | Train Acc: 0.8916
 Site-art_painting                  | Train Loss: 0.6727 | Train Acc: 0.9159
 Site-art_painting                  | Train Loss: 0.7151 | Train Acc: 0.8489
 Site-art_painting                  | Train Loss: 0.6965 | Train Acc: 0.8778
 Site-photo                         | Train Loss: 0.2164 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3170 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2909 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3575 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.2618 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2458 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 1.4188 | Train Acc: 0.5423
 Site-cartoon                       | Train Loss: 1.1999 | Train Acc: 0.6528
Average Train Accuracy: 0.8643
============ Train epoch 44 ============
denominator: 16917.62890625
 Site-art_painting                  | Train Loss: 0.6749 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.7273 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.6706 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.4734 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.8123 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5759 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.7306 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.6588 | Train Acc: 0.9252
 Site-art_painting                  | Train Loss: 0.7166 | Train Acc: 0.8489
 Site-art_painting                  | Train Loss: 0.6921 | Train Acc: 0.8556
 Site-photo                         | Train Loss: 0.2192 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2945 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2745 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3405 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.2544 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2252 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.3613 | Train Acc: 0.5423
 Site-cartoon                       | Train Loss: 1.1245 | Train Acc: 0.6806
Average Train Accuracy: 0.8669
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:44 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:44 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8675
 Best site-art_painting              | Epoch:44 | Val Acc: 0.9252
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8489
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8556
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 0.9796
 Best site-photo                     | Epoch:44 | Val Acc: 0.9659
 Best site-photo                     | Epoch:44 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:44 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:44 | Val Acc: 0.5423
 Best site-cartoon                   | Epoch:44 | Val Acc: 0.6806
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 45 ============
denominator: 16371.041015625
 Site-art_painting                  | Train Loss: 0.7707 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.6987 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.7417 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.5043 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.7986 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5384 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.7007 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.6861 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.7059 | Train Acc: 0.8849
 Site-art_painting                  | Train Loss: 0.6900 | Train Acc: 0.8611
 Site-photo                         | Train Loss: 0.1781 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3227 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2797 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3281 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.2455 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2387 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.3669 | Train Acc: 0.5634
 Site-cartoon                       | Train Loss: 1.1359 | Train Acc: 0.7083
Average Train Accuracy: 0.8668
============ Train epoch 46 ============
denominator: 16212.3798828125
 Site-art_painting                  | Train Loss: 0.7267 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8531 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.6994 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.4647 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.7491 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.5717 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.6765 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.6191 | Train Acc: 0.9252
 Site-art_painting                  | Train Loss: 0.6765 | Train Acc: 0.8633
 Site-art_painting                  | Train Loss: 0.6318 | Train Acc: 0.8944
 Site-photo                         | Train Loss: 0.1704 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2851 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2306 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3157 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.2309 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.2179 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.3652 | Train Acc: 0.5563
 Site-cartoon                       | Train Loss: 1.1301 | Train Acc: 0.6250
Average Train Accuracy: 0.8660
============ Train epoch 47 ============
denominator: 16295.4775390625
 Site-art_painting                  | Train Loss: 0.6908 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.7731 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.7496 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.5981 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.7414 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5311 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.6617 | Train Acc: 0.9398
 Site-art_painting                  | Train Loss: 0.6030 | Train Acc: 0.9252
 Site-art_painting                  | Train Loss: 0.7061 | Train Acc: 0.8561
 Site-art_painting                  | Train Loss: 0.6431 | Train Acc: 0.8778
 Site-photo                         | Train Loss: 0.1821 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2706 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2420 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.2759 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.2016 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.3365 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.3785 | Train Acc: 0.5141
 Site-cartoon                       | Train Loss: 1.1125 | Train Acc: 0.6806
Average Train Accuracy: 0.8621
============ Train epoch 48 ============
denominator: 16148.85546875
 Site-art_painting                  | Train Loss: 0.6542 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.7720 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.7147 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3602 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.6834 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.5254 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.7379 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.6477 | Train Acc: 0.8972
 Site-art_painting                  | Train Loss: 0.6860 | Train Acc: 0.8633
 Site-art_painting                  | Train Loss: 0.6693 | Train Acc: 0.8722
 Site-photo                         | Train Loss: 0.1530 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2452 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2407 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.2932 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.1957 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.1083 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 1.3712 | Train Acc: 0.5493
 Site-cartoon                       | Train Loss: 1.1416 | Train Acc: 0.6667
Average Train Accuracy: 0.8724
 Best site-art_painting              | Epoch:48 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:48 | Val Acc: 0.7391
 Best site-art_painting              | Epoch:48 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:48 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:48 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:48 | Val Acc: 0.9375
 Best site-art_painting              | Epoch:48 | Val Acc: 0.8675
 Best site-art_painting              | Epoch:48 | Val Acc: 0.8972
 Best site-art_painting              | Epoch:48 | Val Acc: 0.8633
 Best site-art_painting              | Epoch:48 | Val Acc: 0.8722
 Best site-photo                     | Epoch:48 | Val Acc: 1.0000
 Best site-photo                     | Epoch:48 | Val Acc: 1.0000
 Best site-photo                     | Epoch:48 | Val Acc: 0.9796
 Best site-photo                     | Epoch:48 | Val Acc: 0.9659
 Best site-photo                     | Epoch:48 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:48 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:48 | Val Acc: 0.5493
 Best site-cartoon                   | Epoch:48 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
============ Train epoch 49 ============
denominator: 15606.7568359375
 Site-art_painting                  | Train Loss: 0.6312 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.7916 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.7033 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3139 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5605 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.5690 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.6391 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.6121 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.6591 | Train Acc: 0.8417
 Site-art_painting                  | Train Loss: 0.6127 | Train Acc: 0.9056
 Site-photo                         | Train Loss: 0.1424 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2635 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2537 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.2663 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.1860 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.1803 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.3428 | Train Acc: 0.5634
 Site-cartoon                       | Train Loss: 1.0788 | Train Acc: 0.6528
Average Train Accuracy: 0.8784
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:49 | Val Acc: 0.7826
 Best site-art_painting              | Epoch:49 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:49 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:49 | Val Acc: 0.8906
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9036
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9065
 Best site-art_painting              | Epoch:49 | Val Acc: 0.8417
 Best site-art_painting              | Epoch:49 | Val Acc: 0.9056
 Best site-photo                     | Epoch:49 | Val Acc: 1.0000
 Best site-photo                     | Epoch:49 | Val Acc: 1.0000
 Best site-photo                     | Epoch:49 | Val Acc: 0.9796
 Best site-photo                     | Epoch:49 | Val Acc: 0.9659
 Best site-photo                     | Epoch:49 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:49 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:49 | Val Acc: 0.5634
 Best site-cartoon                   | Epoch:49 | Val Acc: 0.6528
 Test site-art_painting              | Epoch:49 | Test Acc: 0.8965
 Test site-photo                     | Epoch:49 | Test Acc: 0.9985
 Test site-sketch                    | Epoch:49 | Test Acc: 0.5883
 Test site-cartoon                   | Epoch:49 | Test Acc: 0.6798
art_painting: 0.8965, photo: 0.9985, sketch: 0.5883, cartoon: 0.6798, 
Average Test Accuracy(group): 0.7908, Average Test Accuracy(individual): 0.8785,
domain std=0.1640, cluster std=-1.0000, individual std=0.1254, 
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/q-ffl...
===2023-08-17 04:16:47===
===2023-08-17 04:16:51===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[18,23,30,38,50,64,83,107,139,180,15,28,49,88,157,14,142,72,
client_nums=[10,5,2,1,]
len_dataset=[1227,568,262,121,]
domain number = 4
Loading snapshots...
 Test site-art_painting              | Epoch:49 | Test Acc: 0.8965
 Test site-photo                     | Epoch:49 | Test Acc: 0.9985
 Test site-sketch                    | Epoch:49 | Test Acc: 0.5883
 Test site-cartoon                   | Epoch:49 | Test Acc: 0.6798
art_painting: 0.8965, photo: 0.9985, sketch: 0.5883, cartoon: 0.6798, 
Average Test Accuracy(group): 0.7908, Average Test Accuracy(individual): 0.8785,
domain std=0.1640, cluster std=-1.0000, individual std=0.1254, 
