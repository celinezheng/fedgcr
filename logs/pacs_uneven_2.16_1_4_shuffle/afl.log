===2023-08-17 02:56:02===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
===2023-08-17 02:56:04===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
===2023-08-17 03:28:34===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[18,23,30,38,50,64,83,107,139,180,15,28,49,88,157,14,142,72,
client_nums=[10,5,2,1,]
len_dataset=[1227,568,262,121,]
domain number = 4
============ Train epoch 0 ============
 Site-art_painting                  | Train Loss: 1.8573 | Train Acc: 0.5000
 Site-art_painting                  | Train Loss: 1.8878 | Train Acc: 0.6087
 Site-art_painting                  | Train Loss: 1.8833 | Train Acc: 0.4000
 Site-art_painting                  | Train Loss: 1.8461 | Train Acc: 0.5263
 Site-art_painting                  | Train Loss: 1.9106 | Train Acc: 0.3000
 Site-art_painting                  | Train Loss: 1.8535 | Train Acc: 0.4062
 Site-art_painting                  | Train Loss: 1.8731 | Train Acc: 0.4819
 Site-art_painting                  | Train Loss: 1.8791 | Train Acc: 0.3645
 Site-art_painting                  | Train Loss: 1.8693 | Train Acc: 0.4676
 Site-art_painting                  | Train Loss: 1.8498 | Train Acc: 0.4889
 Site-photo                         | Train Loss: 1.8086 | Train Acc: 0.6667
 Site-photo                         | Train Loss: 1.8324 | Train Acc: 0.6071
 Site-photo                         | Train Loss: 1.8177 | Train Acc: 0.6735
 Site-photo                         | Train Loss: 1.8622 | Train Acc: 0.4659
 Site-photo                         | Train Loss: 1.8210 | Train Acc: 0.6369
 Site-sketch                        | Train Loss: 1.9445 | Train Acc: 0.0000
 Site-sketch                        | Train Loss: 1.9367 | Train Acc: 0.1972
 Site-cartoon                       | Train Loss: 1.8958 | Train Acc: 0.2361
Average Train Accuracy: 0.4460
 Best site-art_painting              | Epoch:0 | Val Acc: 0.5000
 Best site-art_painting              | Epoch:0 | Val Acc: 0.6087
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4000
 Best site-art_painting              | Epoch:0 | Val Acc: 0.5263
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3000
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4062
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4819
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3645
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4676
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4889
 Best site-photo                     | Epoch:0 | Val Acc: 0.6667
 Best site-photo                     | Epoch:0 | Val Acc: 0.6071
 Best site-photo                     | Epoch:0 | Val Acc: 0.6735
 Best site-photo                     | Epoch:0 | Val Acc: 0.4659
 Best site-photo                     | Epoch:0 | Val Acc: 0.6369
 Best site-sketch                    | Epoch:0 | Val Acc: 0.0000
 Best site-sketch                    | Epoch:0 | Val Acc: 0.1972
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.2361
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 1 ============
 Site-art_painting                  | Train Loss: 1.7742 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.8324 | Train Acc: 0.5217
 Site-art_painting                  | Train Loss: 1.8146 | Train Acc: 0.4667
 Site-art_painting                  | Train Loss: 1.7663 | Train Acc: 0.6316
 Site-art_painting                  | Train Loss: 1.8533 | Train Acc: 0.4800
 Site-art_painting                  | Train Loss: 1.7599 | Train Acc: 0.5938
 Site-art_painting                  | Train Loss: 1.8011 | Train Acc: 0.5542
 Site-art_painting                  | Train Loss: 1.8204 | Train Acc: 0.4953
 Site-art_painting                  | Train Loss: 1.8102 | Train Acc: 0.6043
 Site-art_painting                  | Train Loss: 1.7880 | Train Acc: 0.5722
 Site-photo                         | Train Loss: 1.7314 | Train Acc: 0.7333
 Site-photo                         | Train Loss: 1.7559 | Train Acc: 0.7857
 Site-photo                         | Train Loss: 1.7450 | Train Acc: 0.8367
 Site-photo                         | Train Loss: 1.7692 | Train Acc: 0.6591
 Site-photo                         | Train Loss: 1.7362 | Train Acc: 0.7898
 Site-sketch                        | Train Loss: 1.9127 | Train Acc: 0.0000
 Site-sketch                        | Train Loss: 1.9097 | Train Acc: 0.2606
 Site-cartoon                       | Train Loss: 1.8713 | Train Acc: 0.3194
Average Train Accuracy: 0.5601
 Best site-art_painting              | Epoch:1 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:1 | Val Acc: 0.5217
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4667
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6316
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4800
 Best site-art_painting              | Epoch:1 | Val Acc: 0.5938
 Best site-art_painting              | Epoch:1 | Val Acc: 0.5542
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4953
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6043
 Best site-art_painting              | Epoch:1 | Val Acc: 0.5722
 Best site-photo                     | Epoch:1 | Val Acc: 0.7333
 Best site-photo                     | Epoch:1 | Val Acc: 0.7857
 Best site-photo                     | Epoch:1 | Val Acc: 0.8367
 Best site-photo                     | Epoch:1 | Val Acc: 0.6591
 Best site-photo                     | Epoch:1 | Val Acc: 0.7898
 Best site-sketch                    | Epoch:1 | Val Acc: 0.0000
 Best site-sketch                    | Epoch:1 | Val Acc: 0.2606
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.3194
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 2 ============
 Site-art_painting                  | Train Loss: 1.7281 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.7873 | Train Acc: 0.5217
 Site-art_painting                  | Train Loss: 1.7438 | Train Acc: 0.5333
 Site-art_painting                  | Train Loss: 1.6830 | Train Acc: 0.6842
 Site-art_painting                  | Train Loss: 1.7921 | Train Acc: 0.4800
 Site-art_painting                  | Train Loss: 1.6944 | Train Acc: 0.6719
 Site-art_painting                  | Train Loss: 1.7480 | Train Acc: 0.5542
 Site-art_painting                  | Train Loss: 1.7432 | Train Acc: 0.6355
 Site-art_painting                  | Train Loss: 1.7348 | Train Acc: 0.6115
 Site-art_painting                  | Train Loss: 1.7299 | Train Acc: 0.6389
 Site-photo                         | Train Loss: 1.6442 | Train Acc: 0.7333
 Site-photo                         | Train Loss: 1.6841 | Train Acc: 0.8571
 Site-photo                         | Train Loss: 1.6715 | Train Acc: 0.8367
 Site-photo                         | Train Loss: 1.6952 | Train Acc: 0.7500
 Site-photo                         | Train Loss: 1.6486 | Train Acc: 0.8726
 Site-sketch                        | Train Loss: 1.8794 | Train Acc: 0.1429
 Site-sketch                        | Train Loss: 1.8754 | Train Acc: 0.2746
 Site-cartoon                       | Train Loss: 1.8355 | Train Acc: 0.3889
Average Train Accuracy: 0.6092
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5217
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5333
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6842
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4800
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6719
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5542
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6355
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6115
 Best site-art_painting              | Epoch:2 | Val Acc: 0.6389
 Best site-photo                     | Epoch:2 | Val Acc: 0.7333
 Best site-photo                     | Epoch:2 | Val Acc: 0.8571
 Best site-photo                     | Epoch:2 | Val Acc: 0.8367
 Best site-photo                     | Epoch:2 | Val Acc: 0.7500
 Best site-photo                     | Epoch:2 | Val Acc: 0.8726
 Best site-sketch                    | Epoch:2 | Val Acc: 0.1429
 Best site-sketch                    | Epoch:2 | Val Acc: 0.2746
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.3889
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 3 ============
 Site-art_painting                  | Train Loss: 1.6388 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.7511 | Train Acc: 0.4783
 Site-art_painting                  | Train Loss: 1.7001 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.6142 | Train Acc: 0.8158
 Site-art_painting                  | Train Loss: 1.7402 | Train Acc: 0.6400
 Site-art_painting                  | Train Loss: 1.6163 | Train Acc: 0.7344
 Site-art_painting                  | Train Loss: 1.6821 | Train Acc: 0.6265
 Site-art_painting                  | Train Loss: 1.6849 | Train Acc: 0.6355
 Site-art_painting                  | Train Loss: 1.6711 | Train Acc: 0.6619
 Site-art_painting                  | Train Loss: 1.6675 | Train Acc: 0.7333
 Site-photo                         | Train Loss: 1.5782 | Train Acc: 0.9333
 Site-photo                         | Train Loss: 1.5959 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 1.5876 | Train Acc: 0.8776
 Site-photo                         | Train Loss: 1.6151 | Train Acc: 0.8182
 Site-photo                         | Train Loss: 1.5706 | Train Acc: 0.9618
 Site-sketch                        | Train Loss: 1.8304 | Train Acc: 0.2857
 Site-sketch                        | Train Loss: 1.8577 | Train Acc: 0.3380
 Site-cartoon                       | Train Loss: 1.7853 | Train Acc: 0.4167
Average Train Accuracy: 0.6870
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:3 | Val Acc: 0.4783
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8158
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6400
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7344
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6265
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6355
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6619
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7333
 Best site-photo                     | Epoch:3 | Val Acc: 0.9333
 Best site-photo                     | Epoch:3 | Val Acc: 0.9643
 Best site-photo                     | Epoch:3 | Val Acc: 0.8776
 Best site-photo                     | Epoch:3 | Val Acc: 0.8182
 Best site-photo                     | Epoch:3 | Val Acc: 0.9618
 Best site-sketch                    | Epoch:3 | Val Acc: 0.2857
 Best site-sketch                    | Epoch:3 | Val Acc: 0.3380
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.4167
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 4 ============
 Site-art_painting                  | Train Loss: 1.6057 | Train Acc: 0.7222
 Site-art_painting                  | Train Loss: 1.6899 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.6448 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.5336 | Train Acc: 0.7632
 Site-art_painting                  | Train Loss: 1.6854 | Train Acc: 0.6000
 Site-art_painting                  | Train Loss: 1.5607 | Train Acc: 0.7188
 Site-art_painting                  | Train Loss: 1.6167 | Train Acc: 0.6867
 Site-art_painting                  | Train Loss: 1.6231 | Train Acc: 0.6822
 Site-art_painting                  | Train Loss: 1.6191 | Train Acc: 0.6906
 Site-art_painting                  | Train Loss: 1.5978 | Train Acc: 0.7333
 Site-photo                         | Train Loss: 1.4855 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.5401 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.4902 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.5458 | Train Acc: 0.8977
 Site-photo                         | Train Loss: 1.4871 | Train Acc: 0.9745
 Site-sketch                        | Train Loss: 1.8398 | Train Acc: 0.2143
 Site-sketch                        | Train Loss: 1.8204 | Train Acc: 0.3732
 Site-cartoon                       | Train Loss: 1.7803 | Train Acc: 0.4583
Average Train Accuracy: 0.7137
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7222
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7000
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7632
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6000
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7188
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6867
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6822
 Best site-art_painting              | Epoch:4 | Val Acc: 0.6906
 Best site-art_painting              | Epoch:4 | Val Acc: 0.7333
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 0.9796
 Best site-photo                     | Epoch:4 | Val Acc: 0.8977
 Best site-photo                     | Epoch:4 | Val Acc: 0.9745
 Best site-sketch                    | Epoch:4 | Val Acc: 0.2143
 Best site-sketch                    | Epoch:4 | Val Acc: 0.3732
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.4583
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 5 ============
 Site-art_painting                  | Train Loss: 1.5624 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.5982 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.6018 | Train Acc: 0.6000
 Site-art_painting                  | Train Loss: 1.5202 | Train Acc: 0.8158
 Site-art_painting                  | Train Loss: 1.6580 | Train Acc: 0.5400
 Site-art_painting                  | Train Loss: 1.4807 | Train Acc: 0.7969
 Site-art_painting                  | Train Loss: 1.5678 | Train Acc: 0.7349
 Site-art_painting                  | Train Loss: 1.5903 | Train Acc: 0.7477
 Site-art_painting                  | Train Loss: 1.5447 | Train Acc: 0.7122
 Site-art_painting                  | Train Loss: 1.5463 | Train Acc: 0.7556
 Site-photo                         | Train Loss: 1.4058 | Train Acc: 0.9333
 Site-photo                         | Train Loss: 1.4635 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.4428 | Train Acc: 0.9388
 Site-photo                         | Train Loss: 1.4739 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 1.4137 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.7877 | Train Acc: 0.2143
 Site-sketch                        | Train Loss: 1.7906 | Train Acc: 0.3873
 Site-cartoon                       | Train Loss: 1.7317 | Train Acc: 0.4722
Average Train Accuracy: 0.7265
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6000
 Best site-art_painting              | Epoch:5 | Val Acc: 0.8158
 Best site-art_painting              | Epoch:5 | Val Acc: 0.5400
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7969
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7349
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7477
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7122
 Best site-art_painting              | Epoch:5 | Val Acc: 0.7556
 Best site-photo                     | Epoch:5 | Val Acc: 0.9333
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9388
 Best site-photo                     | Epoch:5 | Val Acc: 0.9432
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:5 | Val Acc: 0.2143
 Best site-sketch                    | Epoch:5 | Val Acc: 0.3873
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.4722
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 6 ============
 Site-art_painting                  | Train Loss: 1.4928 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.5696 | Train Acc: 0.6087
 Site-art_painting                  | Train Loss: 1.5503 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.5560 | Train Acc: 0.7895
 Site-art_painting                  | Train Loss: 1.6212 | Train Acc: 0.5800
 Site-art_painting                  | Train Loss: 1.4332 | Train Acc: 0.7656
 Site-art_painting                  | Train Loss: 1.5108 | Train Acc: 0.7349
 Site-art_painting                  | Train Loss: 1.5257 | Train Acc: 0.8037
 Site-art_painting                  | Train Loss: 1.5012 | Train Acc: 0.7482
 Site-art_painting                  | Train Loss: 1.4988 | Train Acc: 0.7778
 Site-photo                         | Train Loss: 1.3340 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.4046 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3624 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.4001 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 1.3486 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.7639 | Train Acc: 0.2857
 Site-sketch                        | Train Loss: 1.7748 | Train Acc: 0.3873
 Site-cartoon                       | Train Loss: 1.6973 | Train Acc: 0.5139
Average Train Accuracy: 0.7429
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:6 | Val Acc: 0.6087
 Best site-art_painting              | Epoch:6 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7895
 Best site-art_painting              | Epoch:6 | Val Acc: 0.5800
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7656
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7349
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8037
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7482
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7778
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 0.9796
 Best site-photo                     | Epoch:6 | Val Acc: 0.9659
 Best site-photo                     | Epoch:6 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:6 | Val Acc: 0.2857
 Best site-sketch                    | Epoch:6 | Val Acc: 0.3873
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.5139
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 7 ============
 Site-art_painting                  | Train Loss: 1.4288 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.5285 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.4810 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.3240 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.5567 | Train Acc: 0.6600
 Site-art_painting                  | Train Loss: 1.3498 | Train Acc: 0.8594
 Site-art_painting                  | Train Loss: 1.4658 | Train Acc: 0.7952
 Site-art_painting                  | Train Loss: 1.4429 | Train Acc: 0.7850
 Site-art_painting                  | Train Loss: 1.4237 | Train Acc: 0.7698
 Site-art_painting                  | Train Loss: 1.4414 | Train Acc: 0.7833
 Site-photo                         | Train Loss: 1.2617 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3265 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3133 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.3321 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 1.2692 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.7192 | Train Acc: 0.2857
 Site-sketch                        | Train Loss: 1.7537 | Train Acc: 0.3873
 Site-cartoon                       | Train Loss: 1.6895 | Train Acc: 0.5278
Average Train Accuracy: 0.7695
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:7 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7000
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:7 | Val Acc: 0.6600
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8594
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7952
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7850
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7698
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7833
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 0.9796
 Best site-photo                     | Epoch:7 | Val Acc: 0.9432
 Best site-photo                     | Epoch:7 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:7 | Val Acc: 0.2857
 Best site-sketch                    | Epoch:7 | Val Acc: 0.3873
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.5278
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 8 ============
 Site-art_painting                  | Train Loss: 1.4164 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.5141 | Train Acc: 0.6087
 Site-art_painting                  | Train Loss: 1.4269 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 1.3104 | Train Acc: 0.8158
 Site-art_painting                  | Train Loss: 1.5074 | Train Acc: 0.5800
 Site-art_painting                  | Train Loss: 1.3314 | Train Acc: 0.8281
 Site-art_painting                  | Train Loss: 1.4417 | Train Acc: 0.7711
 Site-art_painting                  | Train Loss: 1.4188 | Train Acc: 0.8131
 Site-art_painting                  | Train Loss: 1.4179 | Train Acc: 0.7554
 Site-art_painting                  | Train Loss: 1.3844 | Train Acc: 0.8000
 Site-photo                         | Train Loss: 1.1949 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2670 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2362 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 1.2910 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 1.2066 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.7378 | Train Acc: 0.1429
 Site-sketch                        | Train Loss: 1.7086 | Train Acc: 0.4930
 Site-cartoon                       | Train Loss: 1.6779 | Train Acc: 0.5417
Average Train Accuracy: 0.7550
============ Train epoch 9 ============
 Site-art_painting                  | Train Loss: 1.3403 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.5105 | Train Acc: 0.5652
 Site-art_painting                  | Train Loss: 1.4282 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.2477 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 1.5026 | Train Acc: 0.6600
 Site-art_painting                  | Train Loss: 1.2730 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 1.3659 | Train Acc: 0.7831
 Site-art_painting                  | Train Loss: 1.3859 | Train Acc: 0.8318
 Site-art_painting                  | Train Loss: 1.3503 | Train Acc: 0.7842
 Site-art_painting                  | Train Loss: 1.3300 | Train Acc: 0.8389
 Site-photo                         | Train Loss: 1.1358 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2192 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2047 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 1.2176 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 1.1577 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.6526 | Train Acc: 0.4286
 Site-sketch                        | Train Loss: 1.7007 | Train Acc: 0.4648
 Site-cartoon                       | Train Loss: 1.5877 | Train Acc: 0.5278
Average Train Accuracy: 0.7862
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:9 | Val Acc: 0.5652
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7000
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:9 | Val Acc: 0.6600
 Best site-art_painting              | Epoch:9 | Val Acc: 0.9062
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7831
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8318
 Best site-art_painting              | Epoch:9 | Val Acc: 0.7842
 Best site-art_painting              | Epoch:9 | Val Acc: 0.8389
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 1.0000
 Best site-photo                     | Epoch:9 | Val Acc: 0.9592
 Best site-photo                     | Epoch:9 | Val Acc: 0.9886
 Best site-photo                     | Epoch:9 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:9 | Val Acc: 0.4286
 Best site-sketch                    | Epoch:9 | Val Acc: 0.4648
 Best site-cartoon                   | Epoch:9 | Val Acc: 0.5278
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 10 ============
 Site-art_painting                  | Train Loss: 1.2729 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.4269 | Train Acc: 0.5652
 Site-art_painting                  | Train Loss: 1.3991 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.2268 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.4053 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.2439 | Train Acc: 0.8594
 Site-art_painting                  | Train Loss: 1.3461 | Train Acc: 0.7590
 Site-art_painting                  | Train Loss: 1.3150 | Train Acc: 0.8411
 Site-art_painting                  | Train Loss: 1.2833 | Train Acc: 0.7770
 Site-art_painting                  | Train Loss: 1.3029 | Train Acc: 0.8000
 Site-photo                         | Train Loss: 1.0789 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1575 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1480 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.1623 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 1.0979 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.6099 | Train Acc: 0.4286
 Site-sketch                        | Train Loss: 1.6509 | Train Acc: 0.5211
 Site-cartoon                       | Train Loss: 1.6138 | Train Acc: 0.5139
Average Train Accuracy: 0.7820
============ Train epoch 11 ============
 Site-art_painting                  | Train Loss: 1.2535 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.3759 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 1.2996 | Train Acc: 0.7333
 Site-art_painting                  | Train Loss: 1.2088 | Train Acc: 0.8684
 Site-art_painting                  | Train Loss: 1.3952 | Train Acc: 0.6400
 Site-art_painting                  | Train Loss: 1.2343 | Train Acc: 0.8281
 Site-art_painting                  | Train Loss: 1.2766 | Train Acc: 0.7831
 Site-art_painting                  | Train Loss: 1.2970 | Train Acc: 0.7944
 Site-art_painting                  | Train Loss: 1.2719 | Train Acc: 0.7914
 Site-art_painting                  | Train Loss: 1.2515 | Train Acc: 0.8278
 Site-photo                         | Train Loss: 1.0070 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0842 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0543 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 1.1018 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 1.0297 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.6422 | Train Acc: 0.4286
 Site-sketch                        | Train Loss: 1.6361 | Train Acc: 0.4789
 Site-cartoon                       | Train Loss: 1.5785 | Train Acc: 0.5833
Average Train Accuracy: 0.7893
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:11 | Val Acc: 0.6957
 Best site-art_painting              | Epoch:11 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8684
 Best site-art_painting              | Epoch:11 | Val Acc: 0.6400
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8281
 Best site-art_painting              | Epoch:11 | Val Acc: 0.7831
 Best site-art_painting              | Epoch:11 | Val Acc: 0.7944
 Best site-art_painting              | Epoch:11 | Val Acc: 0.7914
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8278
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 0.9796
 Best site-photo                     | Epoch:11 | Val Acc: 0.9545
 Best site-photo                     | Epoch:11 | Val Acc: 0.9873
 Best site-sketch                    | Epoch:11 | Val Acc: 0.4286
 Best site-sketch                    | Epoch:11 | Val Acc: 0.4789
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.5833
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 12 ============
 Site-art_painting                  | Train Loss: 1.2565 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.3272 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.2872 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 1.0674 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 1.2879 | Train Acc: 0.6800
 Site-art_painting                  | Train Loss: 1.1543 | Train Acc: 0.8281
 Site-art_painting                  | Train Loss: 1.3204 | Train Acc: 0.7470
 Site-art_painting                  | Train Loss: 1.2531 | Train Acc: 0.8505
 Site-art_painting                  | Train Loss: 1.2281 | Train Acc: 0.8129
 Site-art_painting                  | Train Loss: 1.2119 | Train Acc: 0.8278
 Site-photo                         | Train Loss: 0.9523 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0475 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0588 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 1.0690 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 0.9846 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.5491 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.6313 | Train Acc: 0.5000
 Site-cartoon                       | Train Loss: 1.5417 | Train Acc: 0.5694
Average Train Accuracy: 0.7967
 Best site-art_painting              | Epoch:12 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:12 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:12 | Val Acc: 0.7667
 Best site-art_painting              | Epoch:12 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:12 | Val Acc: 0.6800
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8281
 Best site-art_painting              | Epoch:12 | Val Acc: 0.7470
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8505
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8129
 Best site-art_painting              | Epoch:12 | Val Acc: 0.8278
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 1.0000
 Best site-photo                     | Epoch:12 | Val Acc: 0.9592
 Best site-photo                     | Epoch:12 | Val Acc: 0.9545
 Best site-photo                     | Epoch:12 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:12 | Val Acc: 0.5000
 Best site-sketch                    | Epoch:12 | Val Acc: 0.5000
 Best site-cartoon                   | Epoch:12 | Val Acc: 0.5694
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 13 ============
 Site-art_painting                  | Train Loss: 1.2120 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.3024 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.2596 | Train Acc: 0.6667
 Site-art_painting                  | Train Loss: 1.1613 | Train Acc: 0.8421
 Site-art_painting                  | Train Loss: 1.2702 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 1.1264 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 1.1903 | Train Acc: 0.8072
 Site-art_painting                  | Train Loss: 1.1921 | Train Acc: 0.8598
 Site-art_painting                  | Train Loss: 1.1496 | Train Acc: 0.8633
 Site-art_painting                  | Train Loss: 1.1551 | Train Acc: 0.8389
 Site-photo                         | Train Loss: 0.8992 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0048 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.9380 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.9968 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.9323 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.5436 | Train Acc: 0.3571
 Site-sketch                        | Train Loss: 1.5892 | Train Acc: 0.5000
 Site-cartoon                       | Train Loss: 1.4773 | Train Acc: 0.5694
Average Train Accuracy: 0.7933
============ Train epoch 14 ============
 Site-art_painting                  | Train Loss: 1.1892 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.2611 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.2568 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 0.9655 | Train Acc: 0.8684
 Site-art_painting                  | Train Loss: 1.2461 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 1.0629 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 1.1457 | Train Acc: 0.8193
 Site-art_painting                  | Train Loss: 1.1809 | Train Acc: 0.8692
 Site-art_painting                  | Train Loss: 1.1304 | Train Acc: 0.8201
 Site-art_painting                  | Train Loss: 1.1361 | Train Acc: 0.8444
 Site-photo                         | Train Loss: 0.8412 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9539 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9368 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 0.9752 | Train Acc: 0.9318
 Site-photo                         | Train Loss: 0.8665 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.4918 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.5667 | Train Acc: 0.5141
 Site-cartoon                       | Train Loss: 1.4786 | Train Acc: 0.5694
Average Train Accuracy: 0.8041
 Best site-art_painting              | Epoch:14 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:14 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:14 | Val Acc: 0.7000
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8684
 Best site-art_painting              | Epoch:14 | Val Acc: 0.7800
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8193
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8692
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8201
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8444
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 0.9592
 Best site-photo                     | Epoch:14 | Val Acc: 0.9318
 Best site-photo                     | Epoch:14 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:14 | Val Acc: 0.5000
 Best site-sketch                    | Epoch:14 | Val Acc: 0.5141
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.5694
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 15 ============
 Site-art_painting                  | Train Loss: 1.1679 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.2417 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.2431 | Train Acc: 0.7333
 Site-art_painting                  | Train Loss: 0.9866 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.2674 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 1.0391 | Train Acc: 0.8281
 Site-art_painting                  | Train Loss: 1.1350 | Train Acc: 0.8313
 Site-art_painting                  | Train Loss: 1.0821 | Train Acc: 0.8505
 Site-art_painting                  | Train Loss: 1.1391 | Train Acc: 0.7842
 Site-art_painting                  | Train Loss: 1.0810 | Train Acc: 0.8500
 Site-photo                         | Train Loss: 0.8163 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9038 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8753 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.8911 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.8302 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.5122 | Train Acc: 0.4286
 Site-sketch                        | Train Loss: 1.5340 | Train Acc: 0.5423
 Site-cartoon                       | Train Loss: 1.4123 | Train Acc: 0.5694
Average Train Accuracy: 0.8057
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:15 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7600
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8281
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8313
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8505
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7842
 Best site-art_painting              | Epoch:15 | Val Acc: 0.8500
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 0.9796
 Best site-photo                     | Epoch:15 | Val Acc: 0.9659
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:15 | Val Acc: 0.4286
 Best site-sketch                    | Epoch:15 | Val Acc: 0.5423
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.5694
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 16 ============
 Site-art_painting                  | Train Loss: 1.1256 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.2188 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 1.1078 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9448 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.1434 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.0127 | Train Acc: 0.8438
 Site-art_painting                  | Train Loss: 1.0878 | Train Acc: 0.8313
 Site-art_painting                  | Train Loss: 1.0760 | Train Acc: 0.8785
 Site-art_painting                  | Train Loss: 1.0694 | Train Acc: 0.8345
 Site-art_painting                  | Train Loss: 1.0469 | Train Acc: 0.8444
 Site-photo                         | Train Loss: 0.7709 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8642 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7976 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.8621 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.7816 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.5172 | Train Acc: 0.3571
 Site-sketch                        | Train Loss: 1.5047 | Train Acc: 0.5282
 Site-cartoon                       | Train Loss: 1.4671 | Train Acc: 0.5972
Average Train Accuracy: 0.8197
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:16 | Val Acc: 0.7391
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8438
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8313
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8785
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8345
 Best site-art_painting              | Epoch:16 | Val Acc: 0.8444
 Best site-photo                     | Epoch:16 | Val Acc: 1.0000
 Best site-photo                     | Epoch:16 | Val Acc: 1.0000
 Best site-photo                     | Epoch:16 | Val Acc: 0.9796
 Best site-photo                     | Epoch:16 | Val Acc: 0.9659
 Best site-photo                     | Epoch:16 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:16 | Val Acc: 0.3571
 Best site-sketch                    | Epoch:16 | Val Acc: 0.5282
 Best site-cartoon                   | Epoch:16 | Val Acc: 0.5972
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 17 ============
 Site-art_painting                  | Train Loss: 1.0843 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.2232 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 1.1436 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8788 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 1.1710 | Train Acc: 0.7200
 Site-art_painting                  | Train Loss: 0.9535 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 1.0841 | Train Acc: 0.7952
 Site-art_painting                  | Train Loss: 1.0484 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 1.0118 | Train Acc: 0.8201
 Site-art_painting                  | Train Loss: 1.0262 | Train Acc: 0.8556
 Site-photo                         | Train Loss: 0.7387 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8215 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7815 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.8002 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.7476 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.5352 | Train Acc: 0.2857
 Site-sketch                        | Train Loss: 1.5106 | Train Acc: 0.5423
 Site-cartoon                       | Train Loss: 1.3966 | Train Acc: 0.6111
Average Train Accuracy: 0.8153
============ Train epoch 18 ============
 Site-art_painting                  | Train Loss: 1.0170 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.1150 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 1.0679 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9600 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.0948 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 0.9427 | Train Acc: 0.8594
 Site-art_painting                  | Train Loss: 1.0377 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 1.0369 | Train Acc: 0.8692
 Site-art_painting                  | Train Loss: 1.0384 | Train Acc: 0.8201
 Site-art_painting                  | Train Loss: 0.9831 | Train Acc: 0.8500
 Site-photo                         | Train Loss: 0.6721 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7912 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7681 | Train Acc: 0.9592
 Site-photo                         | Train Loss: 0.7756 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.6959 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.4383 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.4898 | Train Acc: 0.5986
 Site-cartoon                       | Train Loss: 1.4562 | Train Acc: 0.5833
Average Train Accuracy: 0.8315
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:18 | Val Acc: 0.6957
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:18 | Val Acc: 0.7600
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8594
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8675
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8692
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8201
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8500
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 0.9592
 Best site-photo                     | Epoch:18 | Val Acc: 0.9773
 Best site-photo                     | Epoch:18 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:18 | Val Acc: 0.5714
 Best site-sketch                    | Epoch:18 | Val Acc: 0.5986
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.5833
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 19 ============
 Site-art_painting                  | Train Loss: 0.9839 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.0774 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.0466 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.9449 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.0613 | Train Acc: 0.7200
 Site-art_painting                  | Train Loss: 0.8778 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.9880 | Train Acc: 0.8193
 Site-art_painting                  | Train Loss: 1.0117 | Train Acc: 0.8598
 Site-art_painting                  | Train Loss: 1.0048 | Train Acc: 0.8561
 Site-art_painting                  | Train Loss: 0.9371 | Train Acc: 0.8833
 Site-photo                         | Train Loss: 0.6439 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7756 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7289 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.7541 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.6652 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.4071 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.4701 | Train Acc: 0.5704
 Site-cartoon                       | Train Loss: 1.4136 | Train Acc: 0.5556
Average Train Accuracy: 0.8250
============ Train epoch 20 ============
 Site-art_painting                  | Train Loss: 0.9764 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.1583 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 1.0098 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8180 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 1.0363 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8934 | Train Acc: 0.8438
 Site-art_painting                  | Train Loss: 0.9835 | Train Acc: 0.8554
 Site-art_painting                  | Train Loss: 1.0087 | Train Acc: 0.8785
 Site-art_painting                  | Train Loss: 0.9481 | Train Acc: 0.8417
 Site-art_painting                  | Train Loss: 0.9444 | Train Acc: 0.8278
 Site-photo                         | Train Loss: 0.6074 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7217 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6764 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.7433 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 0.6250 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.4467 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.4300 | Train Acc: 0.6127
 Site-cartoon                       | Train Loss: 1.3018 | Train Acc: 0.5833
Average Train Accuracy: 0.8309
============ Train epoch 21 ============
 Site-art_painting                  | Train Loss: 0.9328 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.0512 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 1.0004 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8939 | Train Acc: 0.8684
 Site-art_painting                  | Train Loss: 1.0372 | Train Acc: 0.7200
 Site-art_painting                  | Train Loss: 0.8565 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.9595 | Train Acc: 0.8434
 Site-art_painting                  | Train Loss: 0.9389 | Train Acc: 0.8598
 Site-art_painting                  | Train Loss: 0.8936 | Train Acc: 0.8345
 Site-art_painting                  | Train Loss: 0.8715 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 0.5529 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6934 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.6864 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.6814 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.6019 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.4634 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.4512 | Train Acc: 0.5563
 Site-cartoon                       | Train Loss: 1.3718 | Train Acc: 0.5833
Average Train Accuracy: 0.8316
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:21 | Val Acc: 0.7826
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8684
 Best site-art_painting              | Epoch:21 | Val Acc: 0.7200
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8906
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8434
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8598
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8345
 Best site-art_painting              | Epoch:21 | Val Acc: 0.8889
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 0.9643
 Best site-photo                     | Epoch:21 | Val Acc: 0.9796
 Best site-photo                     | Epoch:21 | Val Acc: 0.9659
 Best site-photo                     | Epoch:21 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:21 | Val Acc: 0.5714
 Best site-sketch                    | Epoch:21 | Val Acc: 0.5563
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.5833
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 22 ============
 Site-art_painting                  | Train Loss: 1.0048 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 1.0669 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 0.9971 | Train Acc: 0.7667
 Site-art_painting                  | Train Loss: 0.8490 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 1.0031 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 0.8356 | Train Acc: 0.8438
 Site-art_painting                  | Train Loss: 0.9537 | Train Acc: 0.8313
 Site-art_painting                  | Train Loss: 0.9132 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.9088 | Train Acc: 0.8345
 Site-art_painting                  | Train Loss: 0.8596 | Train Acc: 0.8722
 Site-photo                         | Train Loss: 0.5306 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6758 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6160 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.6556 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.5818 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.3674 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.3991 | Train Acc: 0.6197
 Site-cartoon                       | Train Loss: 1.3347 | Train Acc: 0.5972
Average Train Accuracy: 0.8271
============ Train epoch 23 ============
 Site-art_painting                  | Train Loss: 0.9213 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 0.9651 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 0.9645 | Train Acc: 0.7333
 Site-art_painting                  | Train Loss: 0.6356 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.9490 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 0.7570 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.8895 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.8421 | Train Acc: 0.8598
 Site-art_painting                  | Train Loss: 0.8643 | Train Acc: 0.8489
 Site-art_painting                  | Train Loss: 0.8501 | Train Acc: 0.8778
 Site-photo                         | Train Loss: 0.4864 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5881 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6054 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.6295 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 0.5439 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2288 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.3958 | Train Acc: 0.6408
 Site-cartoon                       | Train Loss: 1.2223 | Train Acc: 0.6111
Average Train Accuracy: 0.8414
 Best site-art_painting              | Epoch:23 | Val Acc: 0.7778
 Best site-art_painting              | Epoch:23 | Val Acc: 0.6522
 Best site-art_painting              | Epoch:23 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:23 | Val Acc: 0.7600
 Best site-art_painting              | Epoch:23 | Val Acc: 0.9531
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8675
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8598
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8489
 Best site-art_painting              | Epoch:23 | Val Acc: 0.8778
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-photo                     | Epoch:23 | Val Acc: 1.0000
 Best site-photo                     | Epoch:23 | Val Acc: 0.9796
 Best site-photo                     | Epoch:23 | Val Acc: 0.9545
 Best site-photo                     | Epoch:23 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:23 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:23 | Val Acc: 0.6408
 Best site-cartoon                   | Epoch:23 | Val Acc: 0.6111
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 24 ============
 Site-art_painting                  | Train Loss: 0.8913 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9911 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 0.9832 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8509 | Train Acc: 0.8684
 Site-art_painting                  | Train Loss: 1.0086 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.7727 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.8964 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.8577 | Train Acc: 0.8505
 Site-art_painting                  | Train Loss: 0.8143 | Train Acc: 0.8561
 Site-art_painting                  | Train Loss: 0.7964 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 0.4794 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5763 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.5408 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.6178 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.5186 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.2846 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.4097 | Train Acc: 0.6056
 Site-cartoon                       | Train Loss: 1.2865 | Train Acc: 0.6806
Average Train Accuracy: 0.8381
============ Train epoch 25 ============
 Site-art_painting                  | Train Loss: 0.9283 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9873 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.8689 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.6992 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.8500 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.7818 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.9360 | Train Acc: 0.8072
 Site-art_painting                  | Train Loss: 0.8608 | Train Acc: 0.8972
 Site-art_painting                  | Train Loss: 0.8282 | Train Acc: 0.8345
 Site-art_painting                  | Train Loss: 0.7805 | Train Acc: 0.8778
 Site-photo                         | Train Loss: 0.4445 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5743 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.5179 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5612 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.4881 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2946 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.3190 | Train Acc: 0.6408
 Site-cartoon                       | Train Loss: 1.2479 | Train Acc: 0.6111
Average Train Accuracy: 0.8547
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:25 | Val Acc: 0.7826
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9062
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8072
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8972
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8345
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8778
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 0.9643
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 0.9659
 Best site-photo                     | Epoch:25 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:25 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:25 | Val Acc: 0.6408
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.6111
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 26 ============
 Site-art_painting                  | Train Loss: 0.8957 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9342 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 0.8634 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.7109 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.8941 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.7159 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.8182 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.8268 | Train Acc: 0.8785
 Site-art_painting                  | Train Loss: 0.8113 | Train Acc: 0.8273
 Site-art_painting                  | Train Loss: 0.8051 | Train Acc: 0.8833
 Site-photo                         | Train Loss: 0.4246 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5048 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4719 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.5484 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.4603 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.4048 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.3356 | Train Acc: 0.6408
 Site-cartoon                       | Train Loss: 1.2088 | Train Acc: 0.5972
Average Train Accuracy: 0.8448
============ Train epoch 27 ============
 Site-art_painting                  | Train Loss: 0.9447 | Train Acc: 0.7222
 Site-art_painting                  | Train Loss: 0.9676 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 0.8322 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8120 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.9219 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.6898 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.7604 | Train Acc: 0.8795
 Site-art_painting                  | Train Loss: 0.8176 | Train Acc: 0.8692
 Site-art_painting                  | Train Loss: 0.7995 | Train Acc: 0.8489
 Site-art_painting                  | Train Loss: 0.7902 | Train Acc: 0.8389
 Site-photo                         | Train Loss: 0.4127 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5464 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4787 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.5454 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.4422 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2864 | Train Acc: 0.5000
 Site-sketch                        | Train Loss: 1.3249 | Train Acc: 0.6620
 Site-cartoon                       | Train Loss: 1.2672 | Train Acc: 0.6250
Average Train Accuracy: 0.8321
============ Train epoch 28 ============
 Site-art_painting                  | Train Loss: 0.8452 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9617 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 0.7822 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5756 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.8621 | Train Acc: 0.7400
 Site-art_painting                  | Train Loss: 0.6677 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.7610 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.7012 | Train Acc: 0.9159
 Site-art_painting                  | Train Loss: 0.7859 | Train Acc: 0.8561
 Site-art_painting                  | Train Loss: 0.7280 | Train Acc: 0.8944
 Site-photo                         | Train Loss: 0.3767 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4747 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4759 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.5039 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.4175 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2591 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.3116 | Train Acc: 0.6620
 Site-cartoon                       | Train Loss: 1.1856 | Train Acc: 0.6389
Average Train Accuracy: 0.8556
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:28 | Val Acc: 0.6957
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:28 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:28 | Val Acc: 0.7400
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8906
 Best site-art_painting              | Epoch:28 | Val Acc: 0.9036
 Best site-art_painting              | Epoch:28 | Val Acc: 0.9159
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8561
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8944
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 0.9796
 Best site-photo                     | Epoch:28 | Val Acc: 0.9659
 Best site-photo                     | Epoch:28 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:28 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:28 | Val Acc: 0.6620
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.6389
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 29 ============
 Site-art_painting                  | Train Loss: 0.8649 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9123 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.8771 | Train Acc: 0.7333
 Site-art_painting                  | Train Loss: 0.6162 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.8892 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 0.6887 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.7977 | Train Acc: 0.8434
 Site-art_painting                  | Train Loss: 0.7624 | Train Acc: 0.8785
 Site-art_painting                  | Train Loss: 0.7610 | Train Acc: 0.8561
 Site-art_painting                  | Train Loss: 0.7300 | Train Acc: 0.8833
 Site-photo                         | Train Loss: 0.3612 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4346 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4417 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.4726 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.4005 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2238 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.2941 | Train Acc: 0.6972
 Site-cartoon                       | Train Loss: 1.0639 | Train Acc: 0.5972
Average Train Accuracy: 0.8522
============ Train epoch 30 ============
 Site-art_painting                  | Train Loss: 0.8138 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 0.9346 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.8096 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.6552 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.9547 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.6719 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.7743 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.7645 | Train Acc: 0.8972
 Site-art_painting                  | Train Loss: 0.6651 | Train Acc: 0.8921
 Site-art_painting                  | Train Loss: 0.6796 | Train Acc: 0.8833
 Site-photo                         | Train Loss: 0.3482 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4527 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4179 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.4640 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.3832 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.1874 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.3093 | Train Acc: 0.6479
 Site-cartoon                       | Train Loss: 1.1461 | Train Acc: 0.6667
Average Train Accuracy: 0.8553
============ Train epoch 31 ============
 Site-art_painting                  | Train Loss: 0.8194 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 0.9172 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.7779 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5023 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.8429 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.6370 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.7554 | Train Acc: 0.8916
 Site-art_painting                  | Train Loss: 0.6549 | Train Acc: 0.8972
 Site-art_painting                  | Train Loss: 0.6972 | Train Acc: 0.8489
 Site-art_painting                  | Train Loss: 0.6702 | Train Acc: 0.8833
 Site-photo                         | Train Loss: 0.3171 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4074 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4072 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.4561 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.3469 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.2137 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.2874 | Train Acc: 0.6408
 Site-cartoon                       | Train Loss: 1.1187 | Train Acc: 0.6111
Average Train Accuracy: 0.8544
============ Train epoch 32 ============
 Site-art_painting                  | Train Loss: 0.7891 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8643 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.7788 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.6083 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.8775 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.6870 | Train Acc: 0.8438
 Site-art_painting                  | Train Loss: 0.7721 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.6568 | Train Acc: 0.8972
 Site-art_painting                  | Train Loss: 0.6459 | Train Acc: 0.8705
 Site-art_painting                  | Train Loss: 0.6644 | Train Acc: 0.8778
 Site-photo                         | Train Loss: 0.3072 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4125 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4238 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.4248 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.3349 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.1715 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 1.2602 | Train Acc: 0.6972
 Site-cartoon                       | Train Loss: 1.1162 | Train Acc: 0.6389
Average Train Accuracy: 0.8656
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:32 | Val Acc: 0.7826
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8333
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8947
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8438
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8675
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8972
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8705
 Best site-art_painting              | Epoch:32 | Val Acc: 0.8778
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 0.9796
 Best site-photo                     | Epoch:32 | Val Acc: 0.9659
 Best site-photo                     | Epoch:32 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:32 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:32 | Val Acc: 0.6972
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.6389
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 33 ============
 Site-art_painting                  | Train Loss: 0.6867 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.8459 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 0.7643 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.6545 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.7302 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.6122 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.7411 | Train Acc: 0.8675
 Site-art_painting                  | Train Loss: 0.6342 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.7183 | Train Acc: 0.8561
 Site-art_painting                  | Train Loss: 0.6727 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 0.3119 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4051 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.3453 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4366 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 0.3227 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.1921 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.2220 | Train Acc: 0.6972
 Site-cartoon                       | Train Loss: 1.2082 | Train Acc: 0.6944
Average Train Accuracy: 0.8695
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:33 | Val Acc: 0.6957
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8675
 Best site-art_painting              | Epoch:33 | Val Acc: 0.9065
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8561
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8889
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 0.9643
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 0.9432
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:33 | Val Acc: 0.6429
 Best site-sketch                    | Epoch:33 | Val Acc: 0.6972
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.6944
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 34 ============
 Site-art_painting                  | Train Loss: 0.7303 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.9558 | Train Acc: 0.6087
 Site-art_painting                  | Train Loss: 0.7336 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.7006 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.7995 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.6203 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.6856 | Train Acc: 0.8434
 Site-art_painting                  | Train Loss: 0.7292 | Train Acc: 0.8785
 Site-art_painting                  | Train Loss: 0.6358 | Train Acc: 0.8777
 Site-art_painting                  | Train Loss: 0.6631 | Train Acc: 0.8833
 Site-photo                         | Train Loss: 0.2867 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3753 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3941 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3960 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.3100 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.2013 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.2299 | Train Acc: 0.6690
 Site-cartoon                       | Train Loss: 1.0922 | Train Acc: 0.6528
Average Train Accuracy: 0.8514
============ Train epoch 35 ============
 Site-art_painting                  | Train Loss: 0.7342 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.7811 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.7961 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3935 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.8203 | Train Acc: 0.7800
 Site-art_painting                  | Train Loss: 0.6138 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.7190 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.6442 | Train Acc: 0.9252
 Site-art_painting                  | Train Loss: 0.6594 | Train Acc: 0.8849
 Site-art_painting                  | Train Loss: 0.6661 | Train Acc: 0.8722
 Site-photo                         | Train Loss: 0.2648 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3856 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.3397 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3921 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.2955 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.1495 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 1.2188 | Train Acc: 0.6831
 Site-cartoon                       | Train Loss: 1.0678 | Train Acc: 0.6250
Average Train Accuracy: 0.8735
 Best site-art_painting              | Epoch:35 | Val Acc: 0.8889
 Best site-art_painting              | Epoch:35 | Val Acc: 0.7826
 Best site-art_painting              | Epoch:35 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9474
 Best site-art_painting              | Epoch:35 | Val Acc: 0.7800
 Best site-art_painting              | Epoch:35 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9036
 Best site-art_painting              | Epoch:35 | Val Acc: 0.9252
 Best site-art_painting              | Epoch:35 | Val Acc: 0.8849
 Best site-art_painting              | Epoch:35 | Val Acc: 0.8722
 Best site-photo                     | Epoch:35 | Val Acc: 1.0000
 Best site-photo                     | Epoch:35 | Val Acc: 0.9643
 Best site-photo                     | Epoch:35 | Val Acc: 0.9796
 Best site-photo                     | Epoch:35 | Val Acc: 0.9659
 Best site-photo                     | Epoch:35 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:35 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:35 | Val Acc: 0.6831
 Best site-cartoon                   | Epoch:35 | Val Acc: 0.6250
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 36 ============
 Site-art_painting                  | Train Loss: 0.6455 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.8841 | Train Acc: 0.7391
 Site-art_painting                  | Train Loss: 0.6952 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5200 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.7113 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.5280 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.7025 | Train Acc: 0.9157
 Site-art_painting                  | Train Loss: 0.6529 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.6347 | Train Acc: 0.8849
 Site-art_painting                  | Train Loss: 0.6102 | Train Acc: 0.8833
 Site-photo                         | Train Loss: 0.2373 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3563 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.3468 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3712 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.3001 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.0962 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 1.1957 | Train Acc: 0.6408
 Site-cartoon                       | Train Loss: 1.1814 | Train Acc: 0.6806
Average Train Accuracy: 0.8793
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:36 | Val Acc: 0.7391
 Best site-art_painting              | Epoch:36 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:36 | Val Acc: 0.8400
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:36 | Val Acc: 0.9157
 Best site-art_painting              | Epoch:36 | Val Acc: 0.8879
 Best site-art_painting              | Epoch:36 | Val Acc: 0.8849
 Best site-art_painting              | Epoch:36 | Val Acc: 0.8833
 Best site-photo                     | Epoch:36 | Val Acc: 1.0000
 Best site-photo                     | Epoch:36 | Val Acc: 0.9643
 Best site-photo                     | Epoch:36 | Val Acc: 0.9796
 Best site-photo                     | Epoch:36 | Val Acc: 0.9773
 Best site-photo                     | Epoch:36 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:36 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:36 | Val Acc: 0.6408
 Best site-cartoon                   | Epoch:36 | Val Acc: 0.6806
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 37 ============
 Site-art_painting                  | Train Loss: 0.6696 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.7841 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.7937 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.4420 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.7437 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.5566 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.6465 | Train Acc: 0.8916
 Site-art_painting                  | Train Loss: 0.5907 | Train Acc: 0.9252
 Site-art_painting                  | Train Loss: 0.6416 | Train Acc: 0.8993
 Site-art_painting                  | Train Loss: 0.5711 | Train Acc: 0.9333
 Site-photo                         | Train Loss: 0.2368 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3648 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3029 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3668 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.2790 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.2011 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.2217 | Train Acc: 0.6901
 Site-cartoon                       | Train Loss: 1.0580 | Train Acc: 0.6111
Average Train Accuracy: 0.8781
============ Train epoch 38 ============
 Site-art_painting                  | Train Loss: 0.6597 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.8432 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.6388 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.5029 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.7559 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5713 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.5932 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.5634 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.6353 | Train Acc: 0.8921
 Site-art_painting                  | Train Loss: 0.6101 | Train Acc: 0.8944
 Site-photo                         | Train Loss: 0.2253 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3035 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3421 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3435 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.2575 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.0538 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.1771 | Train Acc: 0.6972
 Site-cartoon                       | Train Loss: 1.0324 | Train Acc: 0.7222
Average Train Accuracy: 0.8864
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9219
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9036
 Best site-art_painting              | Epoch:38 | Val Acc: 0.9065
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8921
 Best site-art_painting              | Epoch:38 | Val Acc: 0.8944
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-photo                     | Epoch:38 | Val Acc: 0.9796
 Best site-photo                     | Epoch:38 | Val Acc: 0.9659
 Best site-photo                     | Epoch:38 | Val Acc: 1.0000
 Best site-sketch                    | Epoch:38 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:38 | Val Acc: 0.6972
 Best site-cartoon                   | Epoch:38 | Val Acc: 0.7222
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 39 ============
 Site-art_painting                  | Train Loss: 0.7562 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 0.8667 | Train Acc: 0.6522
 Site-art_painting                  | Train Loss: 0.6217 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.4819 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.7706 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5937 | Train Acc: 0.8281
 Site-art_painting                  | Train Loss: 0.6586 | Train Acc: 0.8916
 Site-art_painting                  | Train Loss: 0.5855 | Train Acc: 0.8972
 Site-art_painting                  | Train Loss: 0.5975 | Train Acc: 0.8633
 Site-art_painting                  | Train Loss: 0.5779 | Train Acc: 0.9000
 Site-photo                         | Train Loss: 0.2151 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3146 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2927 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3374 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.2446 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.0817 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.1809 | Train Acc: 0.6901
 Site-cartoon                       | Train Loss: 1.0363 | Train Acc: 0.6806
Average Train Accuracy: 0.8546
============ Train epoch 40 ============
 Site-art_painting                  | Train Loss: 0.6977 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.8514 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 0.6655 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.4008 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.7855 | Train Acc: 0.7600
 Site-art_painting                  | Train Loss: 0.5505 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.5712 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.6126 | Train Acc: 0.8785
 Site-art_painting                  | Train Loss: 0.5928 | Train Acc: 0.8561
 Site-art_painting                  | Train Loss: 0.5708 | Train Acc: 0.9056
 Site-photo                         | Train Loss: 0.2030 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2660 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2845 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3406 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 0.2466 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.1699 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.1644 | Train Acc: 0.6761
 Site-cartoon                       | Train Loss: 1.0602 | Train Acc: 0.6528
Average Train Accuracy: 0.8620
============ Train epoch 41 ============
 Site-art_painting                  | Train Loss: 0.6737 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.7129 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.6719 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.4257 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.6647 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.5003 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.5517 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.5453 | Train Acc: 0.8879
 Site-art_painting                  | Train Loss: 0.5695 | Train Acc: 0.8633
 Site-art_painting                  | Train Loss: 0.5656 | Train Acc: 0.8611
 Site-photo                         | Train Loss: 0.1929 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2742 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2461 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3271 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.2220 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.0410 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.1976 | Train Acc: 0.6408
 Site-cartoon                       | Train Loss: 1.0724 | Train Acc: 0.6528
Average Train Accuracy: 0.8710
============ Train epoch 42 ============
 Site-art_painting                  | Train Loss: 0.7137 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.6457 | Train Acc: 0.8696
 Site-art_painting                  | Train Loss: 0.6429 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.3928 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.6353 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.4930 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.5728 | Train Acc: 0.9157
 Site-art_painting                  | Train Loss: 0.5321 | Train Acc: 0.9346
 Site-art_painting                  | Train Loss: 0.5930 | Train Acc: 0.8777
 Site-art_painting                  | Train Loss: 0.5203 | Train Acc: 0.9111
 Site-photo                         | Train Loss: 0.1837 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2863 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2670 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3143 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.2152 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.1154 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.1438 | Train Acc: 0.6479
 Site-cartoon                       | Train Loss: 1.1142 | Train Acc: 0.5972
Average Train Accuracy: 0.8740
============ Train epoch 43 ============
 Site-art_painting                  | Train Loss: 0.6166 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.7375 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.7172 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.3617 | Train Acc: 0.9211
 Site-art_painting                  | Train Loss: 0.6107 | Train Acc: 0.8200
 Site-art_painting                  | Train Loss: 0.4319 | Train Acc: 0.9531
 Site-art_painting                  | Train Loss: 0.6619 | Train Acc: 0.8795
 Site-art_painting                  | Train Loss: 0.5385 | Train Acc: 0.9159
 Site-art_painting                  | Train Loss: 0.6383 | Train Acc: 0.8705
 Site-art_painting                  | Train Loss: 0.5386 | Train Acc: 0.8944
 Site-photo                         | Train Loss: 0.1686 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2370 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2635 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.3084 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.1994 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.0180 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 1.1787 | Train Acc: 0.6761
 Site-cartoon                       | Train Loss: 0.9357 | Train Acc: 0.6944
Average Train Accuracy: 0.8900
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9444
 Best site-art_painting              | Epoch:43 | Val Acc: 0.8261
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9000
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9211
 Best site-art_painting              | Epoch:43 | Val Acc: 0.8200
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9531
 Best site-art_painting              | Epoch:43 | Val Acc: 0.8795
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9159
 Best site-art_painting              | Epoch:43 | Val Acc: 0.8705
 Best site-art_painting              | Epoch:43 | Val Acc: 0.8944
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 0.9796
 Best site-photo                     | Epoch:43 | Val Acc: 0.9659
 Best site-photo                     | Epoch:43 | Val Acc: 0.9936
 Best site-sketch                    | Epoch:43 | Val Acc: 0.7857
 Best site-sketch                    | Epoch:43 | Val Acc: 0.6761
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.6944
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_shuffle/afl...
============ Train epoch 44 ============
 Site-art_painting                  | Train Loss: 0.6272 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.7421 | Train Acc: 0.6957
 Site-art_painting                  | Train Loss: 0.5252 | Train Acc: 0.9333
 Site-art_painting                  | Train Loss: 0.4098 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.6578 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.4715 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.5865 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.5116 | Train Acc: 0.9252
 Site-art_painting                  | Train Loss: 0.5183 | Train Acc: 0.8705
 Site-art_painting                  | Train Loss: 0.5021 | Train Acc: 0.9000
 Site-photo                         | Train Loss: 0.1650 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2343 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2345 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3140 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.1976 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.0281 | Train Acc: 0.7857
 Site-sketch                        | Train Loss: 1.0949 | Train Acc: 0.6761
 Site-cartoon                       | Train Loss: 0.9124 | Train Acc: 0.6528
Average Train Accuracy: 0.8868
============ Train epoch 45 ============
 Site-art_painting                  | Train Loss: 0.6553 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 0.6804 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.6441 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.6956 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.5796 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.5470 | Train Acc: 0.8906
 Site-art_painting                  | Train Loss: 0.5465 | Train Acc: 0.9277
 Site-art_painting                  | Train Loss: 0.5015 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.4886 | Train Acc: 0.8777
 Site-art_painting                  | Train Loss: 0.5086 | Train Acc: 0.9278
 Site-photo                         | Train Loss: 0.1413 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2548 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2242 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.2721 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.1992 | Train Acc: 0.9936
 Site-sketch                        | Train Loss: 1.0510 | Train Acc: 0.5714
 Site-sketch                        | Train Loss: 1.1398 | Train Acc: 0.6761
 Site-cartoon                       | Train Loss: 1.1290 | Train Acc: 0.6667
Average Train Accuracy: 0.8729
============ Train epoch 46 ============
 Site-art_painting                  | Train Loss: 0.6578 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.6349 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.6244 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3499 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.6892 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.4758 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.5749 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.5606 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.5031 | Train Acc: 0.8921
 Site-art_painting                  | Train Loss: 0.4964 | Train Acc: 0.9222
 Site-photo                         | Train Loss: 0.1510 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2557 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.2112 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.2678 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.1676 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.0450 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.1119 | Train Acc: 0.7113
 Site-cartoon                       | Train Loss: 1.0546 | Train Acc: 0.6944
Average Train Accuracy: 0.8813
============ Train epoch 47 ============
 Site-art_painting                  | Train Loss: 0.5653 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.6828 | Train Acc: 0.8261
 Site-art_painting                  | Train Loss: 0.5843 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.3753 | Train Acc: 0.8947
 Site-art_painting                  | Train Loss: 0.5809 | Train Acc: 0.8800
 Site-art_painting                  | Train Loss: 0.4308 | Train Acc: 0.9219
 Site-art_painting                  | Train Loss: 0.5809 | Train Acc: 0.8916
 Site-art_painting                  | Train Loss: 0.5593 | Train Acc: 0.9159
 Site-art_painting                  | Train Loss: 0.5085 | Train Acc: 0.9137
 Site-art_painting                  | Train Loss: 0.5274 | Train Acc: 0.8722
 Site-photo                         | Train Loss: 0.1406 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2207 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1993 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.2346 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.1879 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.1533 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.0776 | Train Acc: 0.6901
 Site-cartoon                       | Train Loss: 0.9453 | Train Acc: 0.6806
Average Train Accuracy: 0.8890
============ Train epoch 48 ============
 Site-art_painting                  | Train Loss: 0.5665 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.7791 | Train Acc: 0.7826
 Site-art_painting                  | Train Loss: 0.5720 | Train Acc: 0.8667
 Site-art_painting                  | Train Loss: 0.3542 | Train Acc: 0.9474
 Site-art_painting                  | Train Loss: 0.7194 | Train Acc: 0.8400
 Site-art_painting                  | Train Loss: 0.5016 | Train Acc: 0.9062
 Site-art_painting                  | Train Loss: 0.5870 | Train Acc: 0.8916
 Site-art_painting                  | Train Loss: 0.4728 | Train Acc: 0.8785
 Site-art_painting                  | Train Loss: 0.5133 | Train Acc: 0.9065
 Site-art_painting                  | Train Loss: 0.4695 | Train Acc: 0.9056
 Site-photo                         | Train Loss: 0.1354 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1970 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2015 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.2670 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.1777 | Train Acc: 0.9873
 Site-sketch                        | Train Loss: 1.1202 | Train Acc: 0.7143
 Site-sketch                        | Train Loss: 1.1187 | Train Acc: 0.6761
 Site-cartoon                       | Train Loss: 1.0140 | Train Acc: 0.6250
Average Train Accuracy: 0.8788
============ Train epoch 49 ============
 Site-art_painting                  | Train Loss: 0.4915 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.5660 | Train Acc: 0.9130
 Site-art_painting                  | Train Loss: 0.6213 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.2586 | Train Acc: 0.9737
 Site-art_painting                  | Train Loss: 0.5954 | Train Acc: 0.8600
 Site-art_painting                  | Train Loss: 0.4360 | Train Acc: 0.9375
 Site-art_painting                  | Train Loss: 0.5674 | Train Acc: 0.9036
 Site-art_painting                  | Train Loss: 0.4815 | Train Acc: 0.9159
 Site-art_painting                  | Train Loss: 0.4994 | Train Acc: 0.8921
 Site-art_painting                  | Train Loss: 0.5246 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 0.1255 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2251 | Train Acc: 0.9643
 Site-photo                         | Train Loss: 0.1911 | Train Acc: 0.9796
 Site-photo                         | Train Loss: 0.2644 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 0.1595 | Train Acc: 1.0000
 Site-sketch                        | Train Loss: 1.0689 | Train Acc: 0.6429
 Site-sketch                        | Train Loss: 1.0732 | Train Acc: 0.6972
 Site-cartoon                       | Train Loss: 0.9440 | Train Acc: 0.6667
Average Train Accuracy: 0.8877
 Test site-art_painting              | Epoch:43 | Test Acc: 0.9099
 Test site-photo                     | Epoch:43 | Test Acc: 0.9985
 Test site-sketch                    | Epoch:43 | Test Acc: 0.6601
 Test site-cartoon                   | Epoch:43 | Test Acc: 0.6787
art_painting: 0.9099, photo: 0.9985, sketch: 0.6601, cartoon: 0.6787, 
Average Test Accuracy(group): 0.8118, Average Test Accuracy(individual): 0.8939,
domain std=0.1459, cluster std=-1.0000, individual std=0.1088, 
===2023-08-17 03:51:50===
===2023-08-17 03:51:53===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 4
data_number=[18,23,30,38,50,64,83,107,139,180,15,28,49,88,157,14,142,72,
client_nums=[10,5,2,1,]
len_dataset=[1227,568,262,121,]
domain number = 4
Loading snapshots...
 Test site-art_painting              | Epoch:43 | Test Acc: 0.9062
 Test site-photo                     | Epoch:43 | Test Acc: 0.9985
 Test site-sketch                    | Epoch:43 | Test Acc: 0.6518
 Test site-cartoon                   | Epoch:43 | Test Acc: 0.6745
art_painting: 0.9062, photo: 0.9985, sketch: 0.6518, cartoon: 0.6745, 
Average Test Accuracy(group): 0.8078, Average Test Accuracy(individual): 0.8907,
domain std=0.1485, cluster std=-1.0000, individual std=0.1109, 
