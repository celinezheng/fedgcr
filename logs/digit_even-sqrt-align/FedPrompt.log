===2023-03-29 11:27:35===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-MNIST     | Train Loss: 1.9094 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 1.8052 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 2.2340 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1903 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.8012 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 1.8221 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1495 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.1124 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.1958 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.1524 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 1.8572 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.8159 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.1972 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2234 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.8588 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 1.7949 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.1377 | Val  Acc: 0.2203
 Site-SynthDigits| Val  Loss: 2.1184 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1505 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1938 | Val  Acc: 0.1864
Average Valid Accuracy: 0.3593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.5763
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2203
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4648 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.4045 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 2.1220 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1110 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.3472 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.3975 | Train Acc: 0.7614
 Site-SynthDigits| Train Loss: 1.9277 | Train Acc: 0.3523
 Site-SynthDigits| Train Loss: 1.9061 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 2.0446 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.0698 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 1.4592 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.3732 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1114 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.1006 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.4244 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.3788 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.9488 | Val  Acc: 0.3559
 Site-SynthDigits| Val  Loss: 1.8501 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 2.0393 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0870 | Val  Acc: 0.2373
Average Valid Accuracy: 0.4847
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3559
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0533 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 0.9779 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0544 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.9484 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.8922 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.9360 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6379 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.6197 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.8403 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 1.8626 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 1.0629 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.9378 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.0052 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9542 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.9570 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.9077 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.6889 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.5940 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.8723 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.8759 | Val  Acc: 0.3559
Average Valid Accuracy: 0.5627
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3220
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-USPS       | Epoch:2 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.7728 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.7442 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 1.7842 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.8207 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.6056 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.6487 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.4137 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.3817 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.6683 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.5262 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.7967 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.6703 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 1.8179 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.7953 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.6378 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5953 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.4619 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.4252 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.5331 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5667 | Val  Acc: 0.5085
Average Valid Accuracy: 0.6102
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4718 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4795 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.5204 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.6089 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.4352 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4018 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 1.0798 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 1.0550 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.3582 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.2144 | Train Acc: 0.6477
 Site-MNIST     | Val  Loss: 0.5375 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4284 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.6312 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.5655 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.4157 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3551 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.1561 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.0745 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.2139 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.2720 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6966
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4407
 Best site-USPS       | Epoch:4 | Val Acc: 0.9153
 Best site-USPS       | Epoch:4 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3570 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3954 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.2321 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 1.3613 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.3179 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.2745 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.8620 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 0.8565 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.1607 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 0.8968 | Train Acc: 0.7500
 Site-MNIST     | Val  Loss: 0.4178 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.3262 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.3969 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.3369 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.3018 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.2454 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.9038 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 0.9125 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 0.9256 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 0.9056 | Val  Acc: 0.7797
Average Valid Accuracy: 0.7593
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4915
 Best site-USPS       | Epoch:5 | Val Acc: 0.9153
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7797
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2454 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2550 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.0976 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 1.1170 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.2165 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.2318 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.6637 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 0.6466 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.8097 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.6605 | Train Acc: 0.8295
 Site-MNIST     | Val  Loss: 0.2771 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2300 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.1378 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.1526 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.2282 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1668 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.7086 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 0.7077 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.6956 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.6781 | Val  Acc: 0.8814
Average Valid Accuracy: 0.8169
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5254
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8814
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1773 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1983 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 0.9032 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 0.9209 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.1856 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.1468 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.5504 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.4574 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.6417 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.5008 | Train Acc: 0.8636
 Site-MNIST     | Val  Loss: 0.2160 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1673 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.9959 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 0.8781 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 0.1659 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1436 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.5152 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.5521 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.5590 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.5197 | Val  Acc: 0.8644
Average Valid Accuracy: 0.8712
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7119
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8644
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1791 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1732 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 0.6126 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 0.7296 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.1626 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.1258 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.4227 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.3846 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.3913 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.3309 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1862 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1475 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.7550 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 0.7230 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.1403 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1104 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.4042 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.4268 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.3507 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.2961 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9288
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8475
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-USPS       | Epoch:8 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0999 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1117 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 0.6204 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.5844 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.1048 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0764 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3121 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.2668 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.3178 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2880 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1206 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0956 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.6431 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.5625 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.0882 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0754 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.2738 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3442 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.3263 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2555 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9508
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8475
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:9 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt-align/FedPrompt...
===2023-03-29 12:01:41===
===2023-03-29 12:01:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8593
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3668
 Test site-USPS      | Epoch:9 | Test Acc: 0.8925
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6405
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4007
Average Test Accuracy: 0.6319
