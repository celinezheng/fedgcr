===2023-04-27 18:13:06===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,11,23,35,47,48,58,116,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 7, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
denominator: 34508.3359375
 Site-Clipart   | Train Loss: 2.3172 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 2.2154 | Train Acc: 0.1818
 Site-Clipart   | Train Loss: 2.2834 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2872 | Train Acc: 0.1642
 Site-Clipart   | Train Loss: 2.2850 | Train Acc: 0.1310
 Site-Infograph | Train Loss: 2.2778 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.2561 | Train Acc: 0.3636
 Site-Painting  | Train Loss: 2.2974 | Train Acc: 0.1739
 Site-Painting  | Train Loss: 2.2643 | Train Acc: 0.1714
 Site-Painting  | Train Loss: 2.2986 | Train Acc: 0.0638
 Site-QuickDraw | Train Loss: 2.3148 | Train Acc: 0.0833
 Site-Real      | Train Loss: 2.3114 | Train Acc: 0.1552
 Site-Real      | Train Loss: 2.2923 | Train Acc: 0.1293
 Site-Sketch    | Train Loss: 2.2907 | Train Acc: 0.1429
 Site-Sketch    | Train Loss: 2.3002 | Train Acc: 0.1286
 Site-Clipart   | Val  Loss: 2.2863 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2651 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2699 | Val  Acc: 0.1515
 Site-Clipart   | Val  Loss: 2.3055 | Val  Acc: 0.0682
 Site-Clipart   | Val  Loss: 2.2732 | Val  Acc: 0.1071
 Site-Infograph | Val  Loss: 2.2437 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2979 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.2840 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.3218 | Val  Acc: 0.0435
 Site-Painting  | Val  Loss: 2.2986 | Val  Acc: 0.1613
 Site-QuickDraw | Val  Loss: 2.3322 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 2.2921 | Val  Acc: 0.1579
 Site-Real      | Val  Loss: 2.2882 | Val  Acc: 0.1429
 Site-Sketch    | Val  Loss: 2.2878 | Val  Acc: 0.2174
 Site-Sketch    | Val  Loss: 2.3034 | Val  Acc: 0.1304
Average Valid Accuracy: 0.1454
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1515
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0682
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1071
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2500
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.0435
 Best site-Painting   | Epoch:0 | Val Acc: 0.1613
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0625
 Best site-Real       | Epoch:0 | Val Acc: 0.1579
 Best site-Real       | Epoch:0 | Val Acc: 0.1429
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2174
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 1 ============
denominator: 34383.8359375
 Site-Clipart   | Train Loss: 2.3102 | Train Acc: 0.0000
 Site-Clipart   | Train Loss: 2.2940 | Train Acc: 0.2727
 Site-Clipart   | Train Loss: 2.2592 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.2813 | Train Acc: 0.1940
 Site-Clipart   | Train Loss: 2.2680 | Train Acc: 0.2024
 Site-Infograph | Train Loss: 2.2901 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.2233 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.2922 | Train Acc: 0.1739
 Site-Painting  | Train Loss: 2.3081 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 2.2752 | Train Acc: 0.1489
 Site-QuickDraw | Train Loss: 2.3054 | Train Acc: 0.0417
 Site-Real      | Train Loss: 2.2961 | Train Acc: 0.2586
 Site-Real      | Train Loss: 2.2690 | Train Acc: 0.1293
 Site-Sketch    | Train Loss: 2.2413 | Train Acc: 0.1714
 Site-Sketch    | Train Loss: 2.2943 | Train Acc: 0.0857
 Site-Clipart   | Val  Loss: 2.2789 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2449 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2482 | Val  Acc: 0.2121
 Site-Clipart   | Val  Loss: 2.2850 | Val  Acc: 0.1818
 Site-Clipart   | Val  Loss: 2.2599 | Val  Acc: 0.1786
 Site-Infograph | Val  Loss: 2.2883 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.2779 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.3014 | Val  Acc: 0.0667
 Site-Painting  | Val  Loss: 2.3038 | Val  Acc: 0.0870
 Site-Painting  | Val  Loss: 2.2760 | Val  Acc: 0.1935
 Site-QuickDraw | Val  Loss: 2.3251 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.2754 | Val  Acc: 0.1579
 Site-Real      | Val  Loss: 2.2844 | Val  Acc: 0.1429
 Site-Sketch    | Val  Loss: 2.2608 | Val  Acc: 0.2174
 Site-Sketch    | Val  Loss: 2.2876 | Val  Acc: 0.1522
Average Valid Accuracy: 0.1777
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2121
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1818
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1786
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1500
 Best site-Painting   | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.0667
 Best site-Painting   | Epoch:1 | Val Acc: 0.0870
 Best site-Painting   | Epoch:1 | Val Acc: 0.1935
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0938
 Best site-Real       | Epoch:1 | Val Acc: 0.1579
 Best site-Real       | Epoch:1 | Val Acc: 0.1429
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2174
 Best site-Sketch     | Epoch:1 | Val Acc: 0.1522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 2 ============
denominator: 34172.9453125
 Site-Clipart   | Train Loss: 2.3191 | Train Acc: 0.0000
 Site-Clipart   | Train Loss: 2.2501 | Train Acc: 0.2424
 Site-Clipart   | Train Loss: 2.2543 | Train Acc: 0.2200
 Site-Clipart   | Train Loss: 2.2551 | Train Acc: 0.2239
 Site-Clipart   | Train Loss: 2.2525 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.2793 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.2342 | Train Acc: 0.4545
 Site-Painting  | Train Loss: 2.2798 | Train Acc: 0.2174
 Site-Painting  | Train Loss: 2.2815 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 2.2653 | Train Acc: 0.2128
 Site-QuickDraw | Train Loss: 2.3090 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.2627 | Train Acc: 0.2586
 Site-Real      | Train Loss: 2.2562 | Train Acc: 0.2069
 Site-Sketch    | Train Loss: 2.2351 | Train Acc: 0.2286
 Site-Sketch    | Train Loss: 2.2799 | Train Acc: 0.1286
 Site-Clipart   | Val  Loss: 2.2619 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.2563 | Val  Acc: 0.1818
 Site-Clipart   | Val  Loss: 2.2433 | Val  Acc: 0.2424
 Site-Clipart   | Val  Loss: 2.2649 | Val  Acc: 0.2273
 Site-Clipart   | Val  Loss: 2.2554 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2747 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2546 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.2872 | Val  Acc: 0.1333
 Site-Painting  | Val  Loss: 2.2892 | Val  Acc: 0.0435
 Site-Painting  | Val  Loss: 2.2618 | Val  Acc: 0.1935
 Site-QuickDraw | Val  Loss: 2.3242 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.2525 | Val  Acc: 0.2368
 Site-Real      | Val  Loss: 2.2589 | Val  Acc: 0.2078
 Site-Sketch    | Val  Loss: 2.2304 | Val  Acc: 0.2174
 Site-Sketch    | Val  Loss: 2.2844 | Val  Acc: 0.1304
Average Valid Accuracy: 0.2059
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1818
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2424
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2273
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2500
 Best site-Painting   | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.1333
 Best site-Painting   | Epoch:2 | Val Acc: 0.0435
 Best site-Painting   | Epoch:2 | Val Acc: 0.1935
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1250
 Best site-Real       | Epoch:2 | Val Acc: 0.2368
 Best site-Real       | Epoch:2 | Val Acc: 0.2078
 Best site-Sketch     | Epoch:2 | Val Acc: 0.2174
 Best site-Sketch     | Epoch:2 | Val Acc: 0.1304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 3 ============
denominator: 33988.76171875
 Site-Clipart   | Train Loss: 2.3296 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 2.2674 | Train Acc: 0.2424
 Site-Clipart   | Train Loss: 2.2257 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.2490 | Train Acc: 0.2388
 Site-Clipart   | Train Loss: 2.2333 | Train Acc: 0.2024
 Site-Infograph | Train Loss: 2.2845 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.2295 | Train Acc: 0.4545
 Site-Painting  | Train Loss: 2.2737 | Train Acc: 0.2174
 Site-Painting  | Train Loss: 2.2580 | Train Acc: 0.2857
 Site-Painting  | Train Loss: 2.2389 | Train Acc: 0.2128
 Site-QuickDraw | Train Loss: 2.3008 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.2563 | Train Acc: 0.3448
 Site-Real      | Train Loss: 2.2447 | Train Acc: 0.2069
 Site-Sketch    | Train Loss: 2.2156 | Train Acc: 0.3429
 Site-Sketch    | Train Loss: 2.2639 | Train Acc: 0.1714
 Site-Clipart   | Val  Loss: 2.2672 | Val  Acc: 0.1818
 Site-Clipart   | Val  Loss: 2.2309 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2046 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2610 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.2508 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2760 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2371 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.2647 | Val  Acc: 0.1333
 Site-Painting  | Val  Loss: 2.2813 | Val  Acc: 0.2174
 Site-Painting  | Val  Loss: 2.2619 | Val  Acc: 0.1935
 Site-QuickDraw | Val  Loss: 2.3206 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.2431 | Val  Acc: 0.1842
 Site-Real      | Val  Loss: 2.2453 | Val  Acc: 0.2338
 Site-Sketch    | Val  Loss: 2.2296 | Val  Acc: 0.2609
 Site-Sketch    | Val  Loss: 2.2632 | Val  Acc: 0.2391
Average Valid Accuracy: 0.2213
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1818
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2500
 Best site-Painting   | Epoch:3 | Val Acc: 0.2857
 Best site-Painting   | Epoch:3 | Val Acc: 0.1333
 Best site-Painting   | Epoch:3 | Val Acc: 0.2174
 Best site-Painting   | Epoch:3 | Val Acc: 0.1935
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.0938
 Best site-Real       | Epoch:3 | Val Acc: 0.1842
 Best site-Real       | Epoch:3 | Val Acc: 0.2338
 Best site-Sketch     | Epoch:3 | Val Acc: 0.2609
 Best site-Sketch     | Epoch:3 | Val Acc: 0.2391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 4 ============
denominator: 33729.21875
 Site-Clipart   | Train Loss: 2.2909 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.2807 | Train Acc: 0.3030
 Site-Clipart   | Train Loss: 2.2341 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2502 | Train Acc: 0.2836
 Site-Clipart   | Train Loss: 2.2480 | Train Acc: 0.2738
 Site-Infograph | Train Loss: 2.2833 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.2216 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.2310 | Train Acc: 0.2174
 Site-Painting  | Train Loss: 2.2465 | Train Acc: 0.2000
 Site-Painting  | Train Loss: 2.2231 | Train Acc: 0.2979
 Site-QuickDraw | Train Loss: 2.2874 | Train Acc: 0.1458
 Site-Real      | Train Loss: 2.2350 | Train Acc: 0.3621
 Site-Real      | Train Loss: 2.2246 | Train Acc: 0.2931
 Site-Sketch    | Train Loss: 2.1740 | Train Acc: 0.3143
 Site-Sketch    | Train Loss: 2.2476 | Train Acc: 0.1857
 Site-Clipart   | Val  Loss: 2.2542 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2144 | Val  Acc: 0.3182
 Site-Clipart   | Val  Loss: 2.2046 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2384 | Val  Acc: 0.3864
 Site-Clipart   | Val  Loss: 2.2402 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2820 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2539 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.2450 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 2.2705 | Val  Acc: 0.1739
 Site-Painting  | Val  Loss: 2.2442 | Val  Acc: 0.3226
 Site-QuickDraw | Val  Loss: 2.3435 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.2359 | Val  Acc: 0.2368
 Site-Real      | Val  Loss: 2.2342 | Val  Acc: 0.2857
 Site-Sketch    | Val  Loss: 2.2079 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 2.2530 | Val  Acc: 0.2826
Average Valid Accuracy: 0.2708
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3182
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3864
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2000
 Best site-Painting   | Epoch:4 | Val Acc: 0.2857
 Best site-Painting   | Epoch:4 | Val Acc: 0.3333
 Best site-Painting   | Epoch:4 | Val Acc: 0.1739
 Best site-Painting   | Epoch:4 | Val Acc: 0.3226
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.0938
 Best site-Real       | Epoch:4 | Val Acc: 0.2368
 Best site-Real       | Epoch:4 | Val Acc: 0.2857
 Best site-Sketch     | Epoch:4 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:4 | Val Acc: 0.2826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 5 ============
denominator: 33685.2890625
 Site-Clipart   | Train Loss: 2.2770 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.2016 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.2364 | Train Acc: 0.2600
 Site-Clipart   | Train Loss: 2.2428 | Train Acc: 0.3134
 Site-Clipart   | Train Loss: 2.2143 | Train Acc: 0.3571
 Site-Infograph | Train Loss: 2.2765 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.1802 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.2369 | Train Acc: 0.1739
 Site-Painting  | Train Loss: 2.2470 | Train Acc: 0.3429
 Site-Painting  | Train Loss: 2.2126 | Train Acc: 0.3404
 Site-QuickDraw | Train Loss: 2.2933 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.2275 | Train Acc: 0.3276
 Site-Real      | Train Loss: 2.2063 | Train Acc: 0.3103
 Site-Sketch    | Train Loss: 2.1795 | Train Acc: 0.3429
 Site-Sketch    | Train Loss: 2.2420 | Train Acc: 0.2143
 Site-Clipart   | Val  Loss: 2.2342 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.2128 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.1958 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.2345 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2268 | Val  Acc: 0.2321
 Site-Infograph | Val  Loss: 2.2738 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1948 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.2437 | Val  Acc: 0.2667
 Site-Painting  | Val  Loss: 2.2715 | Val  Acc: 0.2174
 Site-Painting  | Val  Loss: 2.2323 | Val  Acc: 0.4194
 Site-QuickDraw | Val  Loss: 2.3234 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 2.2178 | Val  Acc: 0.2895
 Site-Real      | Val  Loss: 2.2207 | Val  Acc: 0.3117
 Site-Sketch    | Val  Loss: 2.1808 | Val  Acc: 0.3913
 Site-Sketch    | Val  Loss: 2.2273 | Val  Acc: 0.2826
Average Valid Accuracy: 0.2896
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:5 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:5 | Val Acc: 0.2321
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2000
 Best site-Painting   | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.2667
 Best site-Painting   | Epoch:5 | Val Acc: 0.2174
 Best site-Painting   | Epoch:5 | Val Acc: 0.4194
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.0625
 Best site-Real       | Epoch:5 | Val Acc: 0.2895
 Best site-Real       | Epoch:5 | Val Acc: 0.3117
 Best site-Sketch     | Epoch:5 | Val Acc: 0.3913
 Best site-Sketch     | Epoch:5 | Val Acc: 0.2826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 6 ============
denominator: 34077.0546875
 Site-Clipart   | Train Loss: 2.2782 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 2.1816 | Train Acc: 0.3636
 Site-Clipart   | Train Loss: 2.2300 | Train Acc: 0.2600
 Site-Clipart   | Train Loss: 2.2123 | Train Acc: 0.3134
 Site-Clipart   | Train Loss: 2.1855 | Train Acc: 0.4524
 Site-Infograph | Train Loss: 2.2595 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.1652 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.1972 | Train Acc: 0.2174
 Site-Painting  | Train Loss: 2.1976 | Train Acc: 0.3429
 Site-Painting  | Train Loss: 2.2004 | Train Acc: 0.2979
 Site-QuickDraw | Train Loss: 2.2939 | Train Acc: 0.0833
 Site-Real      | Train Loss: 2.2136 | Train Acc: 0.3966
 Site-Real      | Train Loss: 2.2052 | Train Acc: 0.3362
 Site-Sketch    | Train Loss: 2.2181 | Train Acc: 0.2857
 Site-Sketch    | Train Loss: 2.2449 | Train Acc: 0.2714
 Site-Clipart   | Val  Loss: 2.2176 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.1958 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.1739 | Val  Acc: 0.3939
 Site-Clipart   | Val  Loss: 2.2217 | Val  Acc: 0.3864
 Site-Clipart   | Val  Loss: 2.2126 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.2747 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1845 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.2179 | Val  Acc: 0.5333
 Site-Painting  | Val  Loss: 2.2509 | Val  Acc: 0.3043
 Site-Painting  | Val  Loss: 2.2132 | Val  Acc: 0.3226
 Site-QuickDraw | Val  Loss: 2.3133 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 2.2081 | Val  Acc: 0.2632
 Site-Real      | Val  Loss: 2.2060 | Val  Acc: 0.3377
 Site-Sketch    | Val  Loss: 2.1859 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 2.2217 | Val  Acc: 0.3261
Average Valid Accuracy: 0.3346
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3939
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3864
 Best site-Clipart    | Epoch:6 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3000
 Best site-Painting   | Epoch:6 | Val Acc: 0.4286
 Best site-Painting   | Epoch:6 | Val Acc: 0.5333
 Best site-Painting   | Epoch:6 | Val Acc: 0.3043
 Best site-Painting   | Epoch:6 | Val Acc: 0.3226
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.0625
 Best site-Real       | Epoch:6 | Val Acc: 0.2632
 Best site-Real       | Epoch:6 | Val Acc: 0.3377
 Best site-Sketch     | Epoch:6 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:6 | Val Acc: 0.3261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 7 ============
denominator: 33301.8671875
 Site-Clipart   | Train Loss: 2.2628 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.1655 | Train Acc: 0.4545
 Site-Clipart   | Train Loss: 2.2050 | Train Acc: 0.3800
 Site-Clipart   | Train Loss: 2.2072 | Train Acc: 0.3881
 Site-Clipart   | Train Loss: 2.1778 | Train Acc: 0.4167
 Site-Infograph | Train Loss: 2.2565 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.1673 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.2063 | Train Acc: 0.3478
 Site-Painting  | Train Loss: 2.2467 | Train Acc: 0.3429
 Site-Painting  | Train Loss: 2.1819 | Train Acc: 0.3830
 Site-QuickDraw | Train Loss: 2.3062 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1991 | Train Acc: 0.4138
 Site-Real      | Train Loss: 2.1908 | Train Acc: 0.3448
 Site-Sketch    | Train Loss: 2.1792 | Train Acc: 0.2857
 Site-Sketch    | Train Loss: 2.2154 | Train Acc: 0.2714
 Site-Clipart   | Val  Loss: 2.1920 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1896 | Val  Acc: 0.4091
 Site-Clipart   | Val  Loss: 2.1826 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.2037 | Val  Acc: 0.4091
 Site-Clipart   | Val  Loss: 2.1951 | Val  Acc: 0.3036
 Site-Infograph | Val  Loss: 2.2636 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.1928 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.2231 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2408 | Val  Acc: 0.3478
 Site-Painting  | Val  Loss: 2.2037 | Val  Acc: 0.4516
 Site-QuickDraw | Val  Loss: 2.3216 | Val  Acc: 0.0312
 Site-Real      | Val  Loss: 2.1785 | Val  Acc: 0.3947
 Site-Real      | Val  Loss: 2.1934 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 2.1855 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 2.2138 | Val  Acc: 0.2826
Average Valid Accuracy: 0.3602
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4091
 Best site-Clipart    | Epoch:7 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4091
 Best site-Clipart    | Epoch:7 | Val Acc: 0.3036
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3500
 Best site-Painting   | Epoch:7 | Val Acc: 0.4286
 Best site-Painting   | Epoch:7 | Val Acc: 0.4000
 Best site-Painting   | Epoch:7 | Val Acc: 0.3478
 Best site-Painting   | Epoch:7 | Val Acc: 0.4516
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.0312
 Best site-Real       | Epoch:7 | Val Acc: 0.3947
 Best site-Real       | Epoch:7 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:7 | Val Acc: 0.2826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 8 ============
denominator: 32967.171875
 Site-Clipart   | Train Loss: 2.2716 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 2.1902 | Train Acc: 0.4848
 Site-Clipart   | Train Loss: 2.1635 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.1807 | Train Acc: 0.4776
 Site-Clipart   | Train Loss: 2.1648 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 2.2674 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.1757 | Train Acc: 0.4545
 Site-Painting  | Train Loss: 2.1927 | Train Acc: 0.3043
 Site-Painting  | Train Loss: 2.1979 | Train Acc: 0.3714
 Site-Painting  | Train Loss: 2.1746 | Train Acc: 0.4468
 Site-QuickDraw | Train Loss: 2.2864 | Train Acc: 0.1667
 Site-Real      | Train Loss: 2.1738 | Train Acc: 0.4483
 Site-Real      | Train Loss: 2.1730 | Train Acc: 0.4138
 Site-Sketch    | Train Loss: 2.1747 | Train Acc: 0.3143
 Site-Sketch    | Train Loss: 2.1949 | Train Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.1967 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1608 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1296 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1701 | Val  Acc: 0.5227
 Site-Clipart   | Val  Loss: 2.1893 | Val  Acc: 0.4107
 Site-Infograph | Val  Loss: 2.2468 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1727 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.2212 | Val  Acc: 0.4667
 Site-Painting  | Val  Loss: 2.2282 | Val  Acc: 0.3913
 Site-Painting  | Val  Loss: 2.1792 | Val  Acc: 0.4839
 Site-QuickDraw | Val  Loss: 2.3079 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 2.1692 | Val  Acc: 0.4211
 Site-Real      | Val  Loss: 2.1748 | Val  Acc: 0.4156
 Site-Sketch    | Val  Loss: 2.1601 | Val  Acc: 0.4348
 Site-Sketch    | Val  Loss: 2.1965 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4091
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5227
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4107
 Best site-Infograph  | Epoch:8 | Val Acc: 0.3000
 Best site-Painting   | Epoch:8 | Val Acc: 0.4286
 Best site-Painting   | Epoch:8 | Val Acc: 0.4667
 Best site-Painting   | Epoch:8 | Val Acc: 0.3913
 Best site-Painting   | Epoch:8 | Val Acc: 0.4839
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.0625
 Best site-Real       | Epoch:8 | Val Acc: 0.4211
 Best site-Real       | Epoch:8 | Val Acc: 0.4156
 Best site-Sketch     | Epoch:8 | Val Acc: 0.4348
 Best site-Sketch     | Epoch:8 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 9 ============
denominator: 32976.79296875
 Site-Clipart   | Train Loss: 2.2633 | Train Acc: 0.1250
 Site-Clipart   | Train Loss: 2.2099 | Train Acc: 0.4848
 Site-Clipart   | Train Loss: 2.1730 | Train Acc: 0.3800
 Site-Clipart   | Train Loss: 2.1566 | Train Acc: 0.4627
 Site-Clipart   | Train Loss: 2.1634 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 2.2595 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.1723 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.1509 | Train Acc: 0.3478
 Site-Painting  | Train Loss: 2.2180 | Train Acc: 0.4857
 Site-Painting  | Train Loss: 2.1652 | Train Acc: 0.4468
 Site-QuickDraw | Train Loss: 2.2924 | Train Acc: 0.0833
 Site-Real      | Train Loss: 2.1618 | Train Acc: 0.4828
 Site-Real      | Train Loss: 2.1515 | Train Acc: 0.5086
 Site-Sketch    | Train Loss: 2.1571 | Train Acc: 0.3429
 Site-Sketch    | Train Loss: 2.1955 | Train Acc: 0.3429
 Site-Clipart   | Val  Loss: 2.1860 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.1771 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1359 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1640 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.1744 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.2543 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.1622 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.1921 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2319 | Val  Acc: 0.3478
 Site-Painting  | Val  Loss: 2.1835 | Val  Acc: 0.4839
 Site-QuickDraw | Val  Loss: 2.3249 | Val  Acc: 0.0312
 Site-Real      | Val  Loss: 2.1542 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 2.1619 | Val  Acc: 0.5065
 Site-Sketch    | Val  Loss: 2.1403 | Val  Acc: 0.4783
 Site-Sketch    | Val  Loss: 2.1888 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4018
============ Train epoch 10 ============
denominator: 32840.69140625
 Site-Clipart   | Train Loss: 2.2499 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.0067 | Train Acc: 0.5758
 Site-Clipart   | Train Loss: 2.1652 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1646 | Train Acc: 0.4179
 Site-Clipart   | Train Loss: 2.1444 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 2.2411 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1574 | Train Acc: 0.4545
 Site-Painting  | Train Loss: 2.1784 | Train Acc: 0.3913
 Site-Painting  | Train Loss: 2.1946 | Train Acc: 0.4571
 Site-Painting  | Train Loss: 2.1594 | Train Acc: 0.4894
 Site-QuickDraw | Train Loss: 2.2847 | Train Acc: 0.1667
 Site-Real      | Train Loss: 2.1606 | Train Acc: 0.5345
 Site-Real      | Train Loss: 2.1432 | Train Acc: 0.4914
 Site-Sketch    | Train Loss: 2.1219 | Train Acc: 0.5143
 Site-Sketch    | Train Loss: 2.1797 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1766 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1494 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1304 | Val  Acc: 0.3939
 Site-Clipart   | Val  Loss: 2.1499 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.1688 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.2641 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1207 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 2.1688 | Val  Acc: 0.5333
 Site-Painting  | Val  Loss: 2.2061 | Val  Acc: 0.4348
 Site-Painting  | Val  Loss: 2.1837 | Val  Acc: 0.4839
 Site-QuickDraw | Val  Loss: 2.3024 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 2.1400 | Val  Acc: 0.4474
 Site-Real      | Val  Loss: 2.1581 | Val  Acc: 0.4805
 Site-Sketch    | Val  Loss: 2.1176 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 2.1921 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4544
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:10 | Val Acc: 0.3939
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:10 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:10 | Val Acc: 0.2500
 Best site-Painting   | Epoch:10 | Val Acc: 0.5714
 Best site-Painting   | Epoch:10 | Val Acc: 0.5333
 Best site-Painting   | Epoch:10 | Val Acc: 0.4348
 Best site-Painting   | Epoch:10 | Val Acc: 0.4839
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.1562
 Best site-Real       | Epoch:10 | Val Acc: 0.4474
 Best site-Real       | Epoch:10 | Val Acc: 0.4805
 Best site-Sketch     | Epoch:10 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:10 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 11 ============
denominator: 32461.8359375
 Site-Clipart   | Train Loss: 2.2166 | Train Acc: 0.3125
 Site-Clipart   | Train Loss: 2.1662 | Train Acc: 0.5455
 Site-Clipart   | Train Loss: 2.1653 | Train Acc: 0.3400
 Site-Clipart   | Train Loss: 2.1318 | Train Acc: 0.5373
 Site-Clipart   | Train Loss: 2.1377 | Train Acc: 0.5357
 Site-Infograph | Train Loss: 2.2356 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.1348 | Train Acc: 0.4545
 Site-Painting  | Train Loss: 2.1571 | Train Acc: 0.3043
 Site-Painting  | Train Loss: 2.1870 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 2.1482 | Train Acc: 0.4894
 Site-QuickDraw | Train Loss: 2.2682 | Train Acc: 0.1458
 Site-Real      | Train Loss: 2.1351 | Train Acc: 0.5345
 Site-Real      | Train Loss: 2.1258 | Train Acc: 0.5172
 Site-Sketch    | Train Loss: 2.1100 | Train Acc: 0.5429
 Site-Sketch    | Train Loss: 2.1605 | Train Acc: 0.3857
 Site-Clipart   | Val  Loss: 2.1831 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1283 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0975 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.1564 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.1579 | Val  Acc: 0.4821
 Site-Infograph | Val  Loss: 2.2417 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1031 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 2.1826 | Val  Acc: 0.5333
 Site-Painting  | Val  Loss: 2.2041 | Val  Acc: 0.3478
 Site-Painting  | Val  Loss: 2.1681 | Val  Acc: 0.4516
 Site-QuickDraw | Val  Loss: 2.3094 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 2.1185 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 2.1369 | Val  Acc: 0.5195
 Site-Sketch    | Val  Loss: 2.1073 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1635 | Val  Acc: 0.4565
Average Valid Accuracy: 0.4609
 Best site-Clipart    | Epoch:11 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:11 | Val Acc: 0.4821
 Best site-Infograph  | Epoch:11 | Val Acc: 0.2500
 Best site-Painting   | Epoch:11 | Val Acc: 0.7143
 Best site-Painting   | Epoch:11 | Val Acc: 0.5333
 Best site-Painting   | Epoch:11 | Val Acc: 0.3478
 Best site-Painting   | Epoch:11 | Val Acc: 0.4516
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.0625
 Best site-Real       | Epoch:11 | Val Acc: 0.5000
 Best site-Real       | Epoch:11 | Val Acc: 0.5195
 Best site-Sketch     | Epoch:11 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:11 | Val Acc: 0.4565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 12 ============
denominator: 32254.794921875
 Site-Clipart   | Train Loss: 2.1986 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 2.0704 | Train Acc: 0.5758
 Site-Clipart   | Train Loss: 2.1604 | Train Acc: 0.3800
 Site-Clipart   | Train Loss: 2.1396 | Train Acc: 0.5821
 Site-Clipart   | Train Loss: 2.1118 | Train Acc: 0.5833
 Site-Infograph | Train Loss: 2.2400 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.1237 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.1349 | Train Acc: 0.3913
 Site-Painting  | Train Loss: 2.1525 | Train Acc: 0.4571
 Site-Painting  | Train Loss: 2.1295 | Train Acc: 0.5319
 Site-QuickDraw | Train Loss: 2.2769 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.1238 | Train Acc: 0.5690
 Site-Real      | Train Loss: 2.1178 | Train Acc: 0.5517
 Site-Sketch    | Train Loss: 2.1446 | Train Acc: 0.6000
 Site-Sketch    | Train Loss: 2.1378 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 2.1758 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1199 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.0797 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1484 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.1589 | Val  Acc: 0.4107
 Site-Infograph | Val  Loss: 2.2658 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0933 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 2.1681 | Val  Acc: 0.5333
 Site-Painting  | Val  Loss: 2.1825 | Val  Acc: 0.4783
 Site-Painting  | Val  Loss: 2.1433 | Val  Acc: 0.5161
 Site-QuickDraw | Val  Loss: 2.3191 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.1139 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 2.1268 | Val  Acc: 0.5584
 Site-Sketch    | Val  Loss: 2.1076 | Val  Acc: 0.3913
 Site-Sketch    | Val  Loss: 2.1650 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4746
 Best site-Clipart    | Epoch:12 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:12 | Val Acc: 0.4107
 Best site-Infograph  | Epoch:12 | Val Acc: 0.3500
 Best site-Painting   | Epoch:12 | Val Acc: 0.7143
 Best site-Painting   | Epoch:12 | Val Acc: 0.5333
 Best site-Painting   | Epoch:12 | Val Acc: 0.4783
 Best site-Painting   | Epoch:12 | Val Acc: 0.5161
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.0938
 Best site-Real       | Epoch:12 | Val Acc: 0.5000
 Best site-Real       | Epoch:12 | Val Acc: 0.5584
 Best site-Sketch     | Epoch:12 | Val Acc: 0.3913
 Best site-Sketch     | Epoch:12 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 13 ============
denominator: 32236.771484375
 Site-Clipart   | Train Loss: 2.2138 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 1.9545 | Train Acc: 0.6061
 Site-Clipart   | Train Loss: 2.1077 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 2.1073 | Train Acc: 0.5373
 Site-Clipart   | Train Loss: 2.1089 | Train Acc: 0.5595
 Site-Infograph | Train Loss: 2.2329 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.1021 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 2.1308 | Train Acc: 0.4348
 Site-Painting  | Train Loss: 2.0965 | Train Acc: 0.5143
 Site-Painting  | Train Loss: 2.1333 | Train Acc: 0.5319
 Site-QuickDraw | Train Loss: 2.2658 | Train Acc: 0.2917
 Site-Real      | Train Loss: 2.1209 | Train Acc: 0.5862
 Site-Real      | Train Loss: 2.1108 | Train Acc: 0.5517
 Site-Sketch    | Train Loss: 2.0895 | Train Acc: 0.5143
 Site-Sketch    | Train Loss: 2.1566 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1604 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1138 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.0736 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.1109 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.1419 | Val  Acc: 0.4464
 Site-Infograph | Val  Loss: 2.2492 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.0934 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 2.1683 | Val  Acc: 0.4667
 Site-Painting  | Val  Loss: 2.1631 | Val  Acc: 0.4783
 Site-Painting  | Val  Loss: 2.1391 | Val  Acc: 0.5161
 Site-QuickDraw | Val  Loss: 2.3113 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.0946 | Val  Acc: 0.5526
 Site-Real      | Val  Loss: 2.1111 | Val  Acc: 0.5455
 Site-Sketch    | Val  Loss: 2.0781 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1368 | Val  Acc: 0.4565
Average Valid Accuracy: 0.4898
 Best site-Clipart    | Epoch:13 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:13 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:13 | Val Acc: 0.5758
 Best site-Clipart    | Epoch:13 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:13 | Val Acc: 0.4464
 Best site-Infograph  | Epoch:13 | Val Acc: 0.3000
 Best site-Painting   | Epoch:13 | Val Acc: 0.7143
 Best site-Painting   | Epoch:13 | Val Acc: 0.4667
 Best site-Painting   | Epoch:13 | Val Acc: 0.4783
 Best site-Painting   | Epoch:13 | Val Acc: 0.5161
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.0938
 Best site-Real       | Epoch:13 | Val Acc: 0.5526
 Best site-Real       | Epoch:13 | Val Acc: 0.5455
 Best site-Sketch     | Epoch:13 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:13 | Val Acc: 0.4565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 14 ============
denominator: 32175.455078125
 Site-Clipart   | Train Loss: 2.2050 | Train Acc: 0.3125
 Site-Clipart   | Train Loss: 2.0258 | Train Acc: 0.6061
 Site-Clipart   | Train Loss: 2.1488 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.1115 | Train Acc: 0.5075
 Site-Clipart   | Train Loss: 2.0775 | Train Acc: 0.5595
 Site-Infograph | Train Loss: 2.2271 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0782 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.0904 | Train Acc: 0.5217
 Site-Painting  | Train Loss: 2.1668 | Train Acc: 0.5429
 Site-Painting  | Train Loss: 2.0870 | Train Acc: 0.6383
 Site-QuickDraw | Train Loss: 2.2783 | Train Acc: 0.2292
 Site-Real      | Train Loss: 2.1011 | Train Acc: 0.6207
 Site-Real      | Train Loss: 2.0942 | Train Acc: 0.5862
 Site-Sketch    | Train Loss: 2.1135 | Train Acc: 0.6286
 Site-Sketch    | Train Loss: 2.1307 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1207 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.1021 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.0582 | Val  Acc: 0.5152
 Site-Clipart   | Val  Loss: 2.1327 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1572 | Val  Acc: 0.4464
 Site-Infograph | Val  Loss: 2.2600 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.0585 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 2.1273 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1697 | Val  Acc: 0.4783
 Site-Painting  | Val  Loss: 2.1162 | Val  Acc: 0.5806
 Site-QuickDraw | Val  Loss: 2.2940 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.0806 | Val  Acc: 0.6316
 Site-Real      | Val  Loss: 2.0906 | Val  Acc: 0.5844
 Site-Sketch    | Val  Loss: 2.0852 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1361 | Val  Acc: 0.4348
Average Valid Accuracy: 0.5135
 Best site-Clipart    | Epoch:14 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5152
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:14 | Val Acc: 0.4464
 Best site-Infograph  | Epoch:14 | Val Acc: 0.3000
 Best site-Painting   | Epoch:14 | Val Acc: 0.7143
 Best site-Painting   | Epoch:14 | Val Acc: 0.6000
 Best site-Painting   | Epoch:14 | Val Acc: 0.4783
 Best site-Painting   | Epoch:14 | Val Acc: 0.5806
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.1250
 Best site-Real       | Epoch:14 | Val Acc: 0.6316
 Best site-Real       | Epoch:14 | Val Acc: 0.5844
 Best site-Sketch     | Epoch:14 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:14 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 15 ============
denominator: 32008.765625
 Site-Clipart   | Train Loss: 2.1911 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 2.1137 | Train Acc: 0.6061
 Site-Clipart   | Train Loss: 2.0934 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 2.1060 | Train Acc: 0.5522
 Site-Clipart   | Train Loss: 2.1011 | Train Acc: 0.6548
 Site-Infograph | Train Loss: 2.2134 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0624 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 2.1080 | Train Acc: 0.5217
 Site-Painting  | Train Loss: 2.0947 | Train Acc: 0.5429
 Site-Painting  | Train Loss: 2.0957 | Train Acc: 0.6170
 Site-QuickDraw | Train Loss: 2.2743 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0817 | Train Acc: 0.6034
 Site-Real      | Train Loss: 2.0885 | Train Acc: 0.6207
 Site-Sketch    | Train Loss: 2.0592 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 2.1308 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 2.1343 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.0785 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0593 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.1093 | Val  Acc: 0.5227
 Site-Clipart   | Val  Loss: 2.1316 | Val  Acc: 0.5357
 Site-Infograph | Val  Loss: 2.2634 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.0848 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 2.1102 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.1630 | Val  Acc: 0.5217
 Site-Painting  | Val  Loss: 2.1145 | Val  Acc: 0.5484
 Site-QuickDraw | Val  Loss: 2.2945 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.0512 | Val  Acc: 0.6316
 Site-Real      | Val  Loss: 2.0820 | Val  Acc: 0.6364
 Site-Sketch    | Val  Loss: 2.0646 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1186 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5098
============ Train epoch 16 ============
denominator: 31933.533203125
 Site-Clipart   | Train Loss: 2.1671 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 2.0478 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 2.0350 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.0842 | Train Acc: 0.5373
 Site-Clipart   | Train Loss: 2.0979 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 2.2208 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.0542 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.1233 | Train Acc: 0.5652
 Site-Painting  | Train Loss: 2.1018 | Train Acc: 0.5429
 Site-Painting  | Train Loss: 2.0698 | Train Acc: 0.7021
 Site-QuickDraw | Train Loss: 2.2721 | Train Acc: 0.1458
 Site-Real      | Train Loss: 2.0667 | Train Acc: 0.6724
 Site-Real      | Train Loss: 2.0567 | Train Acc: 0.6897
 Site-Sketch    | Train Loss: 2.0416 | Train Acc: 0.6857
 Site-Sketch    | Train Loss: 2.1071 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 2.1076 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0718 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.0433 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 2.1067 | Val  Acc: 0.5682
 Site-Clipart   | Val  Loss: 2.1076 | Val  Acc: 0.5536
 Site-Infograph | Val  Loss: 2.2748 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0612 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0974 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1421 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 2.1221 | Val  Acc: 0.5806
 Site-QuickDraw | Val  Loss: 2.3027 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.0526 | Val  Acc: 0.7105
 Site-Real      | Val  Loss: 2.0665 | Val  Acc: 0.6494
 Site-Sketch    | Val  Loss: 2.0475 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.1210 | Val  Acc: 0.4130
Average Valid Accuracy: 0.5618
 Best site-Clipart    | Epoch:16 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:16 | Val Acc: 0.5682
 Best site-Clipart    | Epoch:16 | Val Acc: 0.5536
 Best site-Infograph  | Epoch:16 | Val Acc: 0.3500
 Best site-Painting   | Epoch:16 | Val Acc: 0.8571
 Best site-Painting   | Epoch:16 | Val Acc: 0.6000
 Best site-Painting   | Epoch:16 | Val Acc: 0.5652
 Best site-Painting   | Epoch:16 | Val Acc: 0.5806
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.0938
 Best site-Real       | Epoch:16 | Val Acc: 0.7105
 Best site-Real       | Epoch:16 | Val Acc: 0.6494
 Best site-Sketch     | Epoch:16 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:16 | Val Acc: 0.4130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 17 ============
denominator: 31491.494140625
 Site-Clipart   | Train Loss: 2.1733 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 2.0061 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 2.1014 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 2.0876 | Train Acc: 0.5970
 Site-Clipart   | Train Loss: 2.0737 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 2.2313 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0754 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.0739 | Train Acc: 0.5652
 Site-Painting  | Train Loss: 2.1077 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 2.0509 | Train Acc: 0.6809
 Site-QuickDraw | Train Loss: 2.2688 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0508 | Train Acc: 0.6552
 Site-Real      | Train Loss: 2.0488 | Train Acc: 0.6724
 Site-Sketch    | Train Loss: 1.9992 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 2.1196 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 2.0717 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0665 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.0444 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.0803 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1058 | Val  Acc: 0.5357
 Site-Infograph | Val  Loss: 2.2621 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0168 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.1077 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.1415 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.1036 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.3047 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 2.0353 | Val  Acc: 0.6842
 Site-Real      | Val  Loss: 2.0556 | Val  Acc: 0.7013
 Site-Sketch    | Val  Loss: 2.0587 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 2.1020 | Val  Acc: 0.5217
Average Valid Accuracy: 0.5850
 Best site-Clipart    | Epoch:17 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:17 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:17 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:17 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:17 | Val Acc: 0.5357
 Best site-Infograph  | Epoch:17 | Val Acc: 0.3500
 Best site-Painting   | Epoch:17 | Val Acc: 0.8571
 Best site-Painting   | Epoch:17 | Val Acc: 0.6667
 Best site-Painting   | Epoch:17 | Val Acc: 0.6087
 Best site-Painting   | Epoch:17 | Val Acc: 0.6452
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.1562
 Best site-Real       | Epoch:17 | Val Acc: 0.6842
 Best site-Real       | Epoch:17 | Val Acc: 0.7013
 Best site-Sketch     | Epoch:17 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:17 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 18 ============
denominator: 31390.861328125
 Site-Clipart   | Train Loss: 2.1618 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 2.0380 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 2.0843 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 2.0817 | Train Acc: 0.5672
 Site-Clipart   | Train Loss: 2.0504 | Train Acc: 0.6310
 Site-Infograph | Train Loss: 2.2280 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.0770 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.0840 | Train Acc: 0.5652
 Site-Painting  | Train Loss: 2.0804 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 2.0496 | Train Acc: 0.6809
 Site-QuickDraw | Train Loss: 2.2424 | Train Acc: 0.2917
 Site-Real      | Train Loss: 2.0519 | Train Acc: 0.6552
 Site-Real      | Train Loss: 2.0261 | Train Acc: 0.6810
 Site-Sketch    | Train Loss: 1.9543 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 2.0861 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.1292 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.0588 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.0136 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.0704 | Val  Acc: 0.6136
 Site-Clipart   | Val  Loss: 2.1044 | Val  Acc: 0.5357
 Site-Infograph | Val  Loss: 2.2402 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0607 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 2.0890 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.1196 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0837 | Val  Acc: 0.5806
 Site-QuickDraw | Val  Loss: 2.3030 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.0219 | Val  Acc: 0.6842
 Site-Real      | Val  Loss: 2.0441 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 2.0132 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0953 | Val  Acc: 0.4565
Average Valid Accuracy: 0.5549
============ Train epoch 19 ============
denominator: 31348.3984375
 Site-Clipart   | Train Loss: 2.1796 | Train Acc: 0.3125
 Site-Clipart   | Train Loss: 1.8390 | Train Acc: 0.6970
 Site-Clipart   | Train Loss: 2.1126 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 2.0580 | Train Acc: 0.6269
 Site-Clipart   | Train Loss: 2.0389 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 2.2106 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.0366 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 2.0758 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0397 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 2.0324 | Train Acc: 0.7447
 Site-QuickDraw | Train Loss: 2.2566 | Train Acc: 0.2083
 Site-Real      | Train Loss: 2.0370 | Train Acc: 0.6552
 Site-Real      | Train Loss: 2.0178 | Train Acc: 0.6983
 Site-Sketch    | Train Loss: 2.0231 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 2.0966 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 2.0866 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.0575 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0079 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.0667 | Val  Acc: 0.5682
 Site-Clipart   | Val  Loss: 2.0978 | Val  Acc: 0.6071
 Site-Infograph | Val  Loss: 2.2314 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9978 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0804 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.1026 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0796 | Val  Acc: 0.5806
 Site-QuickDraw | Val  Loss: 2.2950 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.0026 | Val  Acc: 0.7895
 Site-Real      | Val  Loss: 2.0199 | Val  Acc: 0.7532
 Site-Sketch    | Val  Loss: 1.9914 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0656 | Val  Acc: 0.5217
Average Valid Accuracy: 0.5821
============ Train epoch 20 ============
denominator: 31114.5390625
 Site-Clipart   | Train Loss: 2.1331 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 2.0023 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 2.0431 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 2.0429 | Train Acc: 0.6269
 Site-Clipart   | Train Loss: 2.0292 | Train Acc: 0.6548
 Site-Infograph | Train Loss: 2.2217 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.0133 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 2.0384 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 2.0666 | Train Acc: 0.6571
 Site-Painting  | Train Loss: 2.0107 | Train Acc: 0.7660
 Site-QuickDraw | Train Loss: 2.2496 | Train Acc: 0.2083
 Site-Real      | Train Loss: 2.0188 | Train Acc: 0.7241
 Site-Real      | Train Loss: 1.9923 | Train Acc: 0.7414
 Site-Sketch    | Train Loss: 2.0104 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.0760 | Train Acc: 0.5286
 Site-Clipart   | Val  Loss: 2.0579 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.0135 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9805 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.0351 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 2.0729 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 2.2601 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.0047 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0912 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.1062 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 2.0813 | Val  Acc: 0.5806
 Site-QuickDraw | Val  Loss: 2.2939 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 2.0050 | Val  Acc: 0.7105
 Site-Real      | Val  Loss: 2.0124 | Val  Acc: 0.7792
 Site-Sketch    | Val  Loss: 1.9964 | Val  Acc: 0.5217
 Site-Sketch    | Val  Loss: 2.0662 | Val  Acc: 0.5870
Average Valid Accuracy: 0.5981
 Best site-Clipart    | Epoch:20 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:20 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:20 | Val Acc: 0.5758
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6591
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4000
 Best site-Painting   | Epoch:20 | Val Acc: 0.8571
 Best site-Painting   | Epoch:20 | Val Acc: 0.6667
 Best site-Painting   | Epoch:20 | Val Acc: 0.6522
 Best site-Painting   | Epoch:20 | Val Acc: 0.5806
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.1562
 Best site-Real       | Epoch:20 | Val Acc: 0.7105
 Best site-Real       | Epoch:20 | Val Acc: 0.7792
 Best site-Sketch     | Epoch:20 | Val Acc: 0.5217
 Best site-Sketch     | Epoch:20 | Val Acc: 0.5870
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 21 ============
denominator: 30990.1953125
 Site-Clipart   | Train Loss: 2.1243 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.9605 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 2.0418 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 2.0335 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 2.0291 | Train Acc: 0.7024
 Site-Infograph | Train Loss: 2.2077 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9996 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 2.0374 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.1079 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 2.0104 | Train Acc: 0.6809
 Site-QuickDraw | Train Loss: 2.2419 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.0023 | Train Acc: 0.6724
 Site-Real      | Train Loss: 2.0033 | Train Acc: 0.7328
 Site-Sketch    | Train Loss: 2.0331 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 2.0512 | Train Acc: 0.5571
 Site-Clipart   | Val  Loss: 2.0508 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0532 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9791 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.0335 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0538 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.2291 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0191 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 2.1005 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0961 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 2.0815 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2987 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.9763 | Val  Acc: 0.7895
 Site-Real      | Val  Loss: 1.9946 | Val  Acc: 0.7403
 Site-Sketch    | Val  Loss: 1.9937 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0713 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5942
============ Train epoch 22 ============
denominator: 30903.0234375
 Site-Clipart   | Train Loss: 2.0993 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 2.0497 | Train Acc: 0.6970
 Site-Clipart   | Train Loss: 2.0955 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 2.0369 | Train Acc: 0.5522
 Site-Clipart   | Train Loss: 1.9640 | Train Acc: 0.7262
 Site-Infograph | Train Loss: 2.2149 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.9917 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 2.0258 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 2.0368 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.9921 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2654 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.9843 | Train Acc: 0.6897
 Site-Real      | Train Loss: 1.9692 | Train Acc: 0.7759
 Site-Sketch    | Train Loss: 2.0411 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.0760 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 2.0531 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0087 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9484 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 2.0295 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.0501 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2431 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.9800 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0643 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0955 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 2.0762 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2907 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 1.9630 | Val  Acc: 0.7632
 Site-Real      | Val  Loss: 1.9863 | Val  Acc: 0.7532
 Site-Sketch    | Val  Loss: 1.9786 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0495 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6004
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:22 | Val Acc: 0.3500
 Best site-Painting   | Epoch:22 | Val Acc: 0.8571
 Best site-Painting   | Epoch:22 | Val Acc: 0.6000
 Best site-Painting   | Epoch:22 | Val Acc: 0.5652
 Best site-Painting   | Epoch:22 | Val Acc: 0.6452
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.0625
 Best site-Real       | Epoch:22 | Val Acc: 0.7632
 Best site-Real       | Epoch:22 | Val Acc: 0.7532
 Best site-Sketch     | Epoch:22 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:22 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 23 ============
denominator: 30713.423828125
 Site-Clipart   | Train Loss: 2.1154 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.9936 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9492 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 2.0318 | Train Acc: 0.6418
 Site-Clipart   | Train Loss: 1.9734 | Train Acc: 0.6905
 Site-Infograph | Train Loss: 2.2268 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.9674 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 2.0080 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0350 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.9742 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2466 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9787 | Train Acc: 0.7414
 Site-Real      | Train Loss: 1.9667 | Train Acc: 0.7672
 Site-Sketch    | Train Loss: 1.9634 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 2.0773 | Train Acc: 0.5571
 Site-Clipart   | Val  Loss: 2.0389 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0132 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.9377 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.9864 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0609 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2249 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.9361 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0337 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.0955 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 2.0235 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2837 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.9519 | Val  Acc: 0.7368
 Site-Real      | Val  Loss: 1.9798 | Val  Acc: 0.7532
 Site-Sketch    | Val  Loss: 1.9882 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 2.0404 | Val  Acc: 0.5217
Average Valid Accuracy: 0.6405
 Best site-Clipart    | Epoch:23 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:23 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:23 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:23 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:23 | Val Acc: 0.6786
 Best site-Infograph  | Epoch:23 | Val Acc: 0.3500
 Best site-Painting   | Epoch:23 | Val Acc: 0.8571
 Best site-Painting   | Epoch:23 | Val Acc: 0.6000
 Best site-Painting   | Epoch:23 | Val Acc: 0.6522
 Best site-Painting   | Epoch:23 | Val Acc: 0.7419
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.1875
 Best site-Real       | Epoch:23 | Val Acc: 0.7368
 Best site-Real       | Epoch:23 | Val Acc: 0.7532
 Best site-Sketch     | Epoch:23 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:23 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 24 ============
denominator: 30655.58984375
 Site-Clipart   | Train Loss: 2.1174 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.8686 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.9558 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 2.0099 | Train Acc: 0.7015
 Site-Clipart   | Train Loss: 1.9729 | Train Acc: 0.7024
 Site-Infograph | Train Loss: 2.1951 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.9785 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 2.0319 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.9753 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.9886 | Train Acc: 0.7234
 Site-QuickDraw | Train Loss: 2.2334 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9689 | Train Acc: 0.7414
 Site-Real      | Train Loss: 1.9722 | Train Acc: 0.7759
 Site-Sketch    | Train Loss: 1.9676 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 2.0234 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0335 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.9959 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9155 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9965 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 2.0328 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2293 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.9545 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0188 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0820 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0077 | Val  Acc: 0.6774
 Site-QuickDraw | Val  Loss: 2.2894 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.9298 | Val  Acc: 0.8158
 Site-Real      | Val  Loss: 1.9564 | Val  Acc: 0.8052
 Site-Sketch    | Val  Loss: 1.9506 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0324 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6371
============ Train epoch 25 ============
denominator: 30463.708984375
 Site-Clipart   | Train Loss: 2.1383 | Train Acc: 0.3125
 Site-Clipart   | Train Loss: 1.9182 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 2.0144 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.9919 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.9602 | Train Acc: 0.7381
 Site-Infograph | Train Loss: 2.2188 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9785 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.9713 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0551 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.9477 | Train Acc: 0.7447
 Site-QuickDraw | Train Loss: 2.2301 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9671 | Train Acc: 0.7759
 Site-Real      | Train Loss: 1.9656 | Train Acc: 0.7759
 Site-Sketch    | Train Loss: 1.9005 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 2.0485 | Train Acc: 0.5286
 Site-Clipart   | Val  Loss: 2.0297 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.9581 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8833 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.9860 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.0219 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 2.2199 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.9118 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 2.0512 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0550 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0202 | Val  Acc: 0.6129
 Site-QuickDraw | Val  Loss: 2.2806 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.9321 | Val  Acc: 0.8421
 Site-Real      | Val  Loss: 1.9409 | Val  Acc: 0.7662
 Site-Sketch    | Val  Loss: 1.9326 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 2.0216 | Val  Acc: 0.6304
Average Valid Accuracy: 0.6309
============ Train epoch 26 ============
denominator: 30278.947265625
 Site-Clipart   | Train Loss: 2.0857 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.9836 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 2.0392 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.9903 | Train Acc: 0.6567
 Site-Clipart   | Train Loss: 1.9549 | Train Acc: 0.6786
 Site-Infograph | Train Loss: 2.1927 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.9998 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 1.9573 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.9943 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.9375 | Train Acc: 0.8085
 Site-QuickDraw | Train Loss: 2.2405 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.9434 | Train Acc: 0.7414
 Site-Real      | Train Loss: 1.9339 | Train Acc: 0.8190
 Site-Sketch    | Train Loss: 1.9964 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.9884 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.9925 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9679 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9110 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.9789 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0149 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2368 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.9045 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0273 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0560 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0321 | Val  Acc: 0.6774
 Site-QuickDraw | Val  Loss: 2.2699 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.9209 | Val  Acc: 0.8684
 Site-Real      | Val  Loss: 1.9386 | Val  Acc: 0.8312
 Site-Sketch    | Val  Loss: 1.9466 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 2.0040 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6622
 Best site-Clipart    | Epoch:26 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:26 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:26 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:26 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:26 | Val Acc: 0.6786
 Best site-Infograph  | Epoch:26 | Val Acc: 0.3500
 Best site-Painting   | Epoch:26 | Val Acc: 0.8571
 Best site-Painting   | Epoch:26 | Val Acc: 0.6667
 Best site-Painting   | Epoch:26 | Val Acc: 0.6087
 Best site-Painting   | Epoch:26 | Val Acc: 0.6774
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.1250
 Best site-Real       | Epoch:26 | Val Acc: 0.8684
 Best site-Real       | Epoch:26 | Val Acc: 0.8312
 Best site-Sketch     | Epoch:26 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:26 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 27 ============
denominator: 30024.193359375
 Site-Clipart   | Train Loss: 2.0946 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.8632 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.9829 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.9139 | Train Acc: 0.7015
 Site-Clipart   | Train Loss: 1.9112 | Train Acc: 0.7262
 Site-Infograph | Train Loss: 2.2065 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9360 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 2.0141 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0040 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 1.9414 | Train Acc: 0.7234
 Site-QuickDraw | Train Loss: 2.2408 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.9456 | Train Acc: 0.7414
 Site-Real      | Train Loss: 1.8994 | Train Acc: 0.8362
 Site-Sketch    | Train Loss: 1.8949 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.9975 | Train Acc: 0.5571
 Site-Clipart   | Val  Loss: 1.9979 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9556 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9002 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9490 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 2.0155 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.1800 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.8937 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 2.0162 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0348 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.9727 | Val  Acc: 0.6774
 Site-QuickDraw | Val  Loss: 2.2827 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.8983 | Val  Acc: 0.7895
 Site-Real      | Val  Loss: 1.9248 | Val  Acc: 0.8312
 Site-Sketch    | Val  Loss: 1.9020 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.9985 | Val  Acc: 0.6304
Average Valid Accuracy: 0.6743
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7045
 Best site-Clipart    | Epoch:27 | Val Acc: 0.6607
 Best site-Infograph  | Epoch:27 | Val Acc: 0.5000
 Best site-Painting   | Epoch:27 | Val Acc: 1.0000
 Best site-Painting   | Epoch:27 | Val Acc: 0.6667
 Best site-Painting   | Epoch:27 | Val Acc: 0.6522
 Best site-Painting   | Epoch:27 | Val Acc: 0.6774
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.1250
 Best site-Real       | Epoch:27 | Val Acc: 0.7895
 Best site-Real       | Epoch:27 | Val Acc: 0.8312
 Best site-Sketch     | Epoch:27 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:27 | Val Acc: 0.6304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 28 ============
denominator: 30222.05078125
 Site-Clipart   | Train Loss: 2.0468 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.8443 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 2.0147 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.9394 | Train Acc: 0.7015
 Site-Clipart   | Train Loss: 1.9240 | Train Acc: 0.6905
 Site-Infograph | Train Loss: 2.1947 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9101 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9435 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0520 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.9184 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2340 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.9191 | Train Acc: 0.7586
 Site-Real      | Train Loss: 1.9111 | Train Acc: 0.8017
 Site-Sketch    | Train Loss: 1.9104 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 2.0050 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 1.9559 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9721 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.8932 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9605 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 2.0024 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2146 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.9066 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0026 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0446 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 1.9754 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2712 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.8915 | Val  Acc: 0.8158
 Site-Real      | Val  Loss: 1.9088 | Val  Acc: 0.8312
 Site-Sketch    | Val  Loss: 1.9188 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.9909 | Val  Acc: 0.5870
Average Valid Accuracy: 0.6486
============ Train epoch 29 ============
denominator: 29906.9453125
 Site-Clipart   | Train Loss: 2.0413 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.7925 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 2.0263 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.9488 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.9231 | Train Acc: 0.7381
 Site-Infograph | Train Loss: 2.1904 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9588 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9142 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0069 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.9027 | Train Acc: 0.7447
 Site-QuickDraw | Train Loss: 2.2421 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.9091 | Train Acc: 0.8276
 Site-Real      | Train Loss: 1.8905 | Train Acc: 0.8017
 Site-Sketch    | Train Loss: 1.9521 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.9705 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.9551 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9366 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.8568 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.9430 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.9878 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2306 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.8928 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9846 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0266 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9927 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2738 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.8747 | Val  Acc: 0.8684
 Site-Real      | Val  Loss: 1.9000 | Val  Acc: 0.8442
 Site-Sketch    | Val  Loss: 1.9193 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 1.9832 | Val  Acc: 0.6304
Average Valid Accuracy: 0.6539
============ Train epoch 30 ============
denominator: 29662.064453125
 Site-Clipart   | Train Loss: 2.0665 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8149 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.9519 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8941 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.9025 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 2.1761 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9054 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9128 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.8197 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.8839 | Train Acc: 0.8085
 Site-QuickDraw | Train Loss: 2.2264 | Train Acc: 0.2917
 Site-Real      | Train Loss: 1.9080 | Train Acc: 0.7759
 Site-Real      | Train Loss: 1.8811 | Train Acc: 0.8534
 Site-Sketch    | Train Loss: 1.9552 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.9583 | Train Acc: 0.6429
 Site-Clipart   | Val  Loss: 2.0013 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.9239 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.8577 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.9302 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.9772 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2548 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8721 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9732 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0060 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9687 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2710 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.8682 | Val  Acc: 0.8421
 Site-Real      | Val  Loss: 1.8841 | Val  Acc: 0.8312
 Site-Sketch    | Val  Loss: 1.8812 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.9766 | Val  Acc: 0.6739
Average Valid Accuracy: 0.6640
============ Train epoch 31 ============
denominator: 29755.041015625
 Site-Clipart   | Train Loss: 2.0585 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.9732 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 2.0351 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9057 | Train Acc: 0.7164
 Site-Clipart   | Train Loss: 1.8654 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.1938 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9382 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9646 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.9679 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.8765 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2198 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.8869 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.8857 | Train Acc: 0.8448
 Site-Sketch    | Train Loss: 1.8680 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.9658 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 1.9493 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9050 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.8590 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.9643 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.9845 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 2.2209 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8567 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9761 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0025 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9721 | Val  Acc: 0.6774
 Site-QuickDraw | Val  Loss: 2.2653 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.8402 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.8687 | Val  Acc: 0.8831
 Site-Sketch    | Val  Loss: 1.8988 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 2.0018 | Val  Acc: 0.5217
Average Valid Accuracy: 0.6660
============ Train epoch 32 ============
denominator: 29498.83203125
 Site-Clipart   | Train Loss: 2.0121 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.7876 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.8662 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9549 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.9154 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1917 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9225 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9011 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.9963 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.8995 | Train Acc: 0.7447
 Site-QuickDraw | Train Loss: 2.2249 | Train Acc: 0.2708
 Site-Real      | Train Loss: 1.8851 | Train Acc: 0.7931
 Site-Real      | Train Loss: 1.8719 | Train Acc: 0.8190
 Site-Sketch    | Train Loss: 1.8170 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.9914 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 1.9416 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.8858 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.8572 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.9362 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.9852 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 2.1965 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8229 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9376 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0315 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 1.9640 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2777 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.8299 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 1.8562 | Val  Acc: 0.8831
 Site-Sketch    | Val  Loss: 1.8535 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.9442 | Val  Acc: 0.6304
Average Valid Accuracy: 0.6746
 Best site-Clipart    | Epoch:32 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:32 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:32 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:32 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:32 | Val Acc: 0.7679
 Best site-Infograph  | Epoch:32 | Val Acc: 0.4000
 Best site-Painting   | Epoch:32 | Val Acc: 1.0000
 Best site-Painting   | Epoch:32 | Val Acc: 0.7333
 Best site-Painting   | Epoch:32 | Val Acc: 0.5652
 Best site-Painting   | Epoch:32 | Val Acc: 0.7097
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.1250
 Best site-Real       | Epoch:32 | Val Acc: 0.8947
 Best site-Real       | Epoch:32 | Val Acc: 0.8831
 Best site-Sketch     | Epoch:32 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:32 | Val Acc: 0.6304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 33 ============
denominator: 29345.96875
 Site-Clipart   | Train Loss: 1.9711 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.6141 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9774 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.8561 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.9045 | Train Acc: 0.7262
 Site-Infograph | Train Loss: 2.1755 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9086 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8789 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 2.0021 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.8708 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2192 | Train Acc: 0.2917
 Site-Real      | Train Loss: 1.8597 | Train Acc: 0.8276
 Site-Real      | Train Loss: 1.8417 | Train Acc: 0.8534
 Site-Sketch    | Train Loss: 1.8669 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 1.9336 | Train Acc: 0.6714
 Site-Clipart   | Val  Loss: 1.9303 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.8849 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.8292 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.9071 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.9712 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.1923 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.8076 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9466 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.9690 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.9564 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2450 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.8172 | Val  Acc: 0.8684
 Site-Real      | Val  Loss: 1.8522 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.8481 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.9219 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7055
 Best site-Clipart    | Epoch:33 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:33 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:33 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:33 | Val Acc: 0.4500
 Best site-Painting   | Epoch:33 | Val Acc: 1.0000
 Best site-Painting   | Epoch:33 | Val Acc: 0.6667
 Best site-Painting   | Epoch:33 | Val Acc: 0.6957
 Best site-Painting   | Epoch:33 | Val Acc: 0.7419
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.1875
 Best site-Real       | Epoch:33 | Val Acc: 0.8684
 Best site-Real       | Epoch:33 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:33 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:33 | Val Acc: 0.7174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 34 ============
denominator: 29361.322265625
 Site-Clipart   | Train Loss: 2.0182 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.8611 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9300 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.9113 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.8843 | Train Acc: 0.7262
 Site-Infograph | Train Loss: 2.1757 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9174 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.9422 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.9314 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.8498 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2034 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.8606 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.8320 | Train Acc: 0.8362
 Site-Sketch    | Train Loss: 1.9272 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.9430 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 1.9259 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8908 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.8234 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8870 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.9894 | Val  Acc: 0.5536
 Site-Infograph | Val  Loss: 2.2167 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8341 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9479 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9914 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 1.9175 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2655 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.8021 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 1.8475 | Val  Acc: 0.8701
 Site-Sketch    | Val  Loss: 1.8640 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.9236 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6758
============ Train epoch 35 ============
denominator: 28987.31640625
 Site-Clipart   | Train Loss: 2.0273 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8996 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.8710 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8916 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.8781 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.1678 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.8710 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8817 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.8879 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.8202 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2193 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.8449 | Train Acc: 0.7931
 Site-Real      | Train Loss: 1.8120 | Train Acc: 0.8534
 Site-Sketch    | Train Loss: 1.8517 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.9356 | Train Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.9121 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8336 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.8051 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8988 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.9500 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2243 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8556 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 1.9120 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.9674 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.9186 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2630 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.7925 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.8221 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.8512 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.9186 | Val  Acc: 0.6739
Average Valid Accuracy: 0.6722
============ Train epoch 36 ============
denominator: 28554.845703125
 Site-Clipart   | Train Loss: 2.0483 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.5813 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.9267 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8548 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.8611 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.1689 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8339 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8956 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8967 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.8136 | Train Acc: 0.7447
 Site-QuickDraw | Train Loss: 2.2103 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.8106 | Train Acc: 0.8276
 Site-Real      | Train Loss: 1.8108 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.8334 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.9405 | Train Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.8940 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8615 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7868 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8516 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.9234 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 2.2044 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.7708 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9403 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.9756 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.9354 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2539 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.7703 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 1.8193 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.8342 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.9060 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7102
 Best site-Clipart    | Epoch:36 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:36 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:36 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:36 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:36 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:36 | Val Acc: 0.4500
 Best site-Painting   | Epoch:36 | Val Acc: 1.0000
 Best site-Painting   | Epoch:36 | Val Acc: 0.6667
 Best site-Painting   | Epoch:36 | Val Acc: 0.6957
 Best site-Painting   | Epoch:36 | Val Acc: 0.7419
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.0938
 Best site-Real       | Epoch:36 | Val Acc: 0.8947
 Best site-Real       | Epoch:36 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:36 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:36 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 37 ============
denominator: 28771.939453125
 Site-Clipart   | Train Loss: 2.0469 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.7330 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.7925 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.8790 | Train Acc: 0.7313
 Site-Clipart   | Train Loss: 1.8041 | Train Acc: 0.7738
 Site-Infograph | Train Loss: 2.1788 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8085 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8839 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.9176 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.8285 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2094 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.8147 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.8057 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.7978 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.9132 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.9288 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 1.8400 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7761 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8536 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9190 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2089 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8134 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9266 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9908 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9299 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2504 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.7717 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.7986 | Val  Acc: 0.8312
 Site-Sketch    | Val  Loss: 1.8101 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.9155 | Val  Acc: 0.5870
Average Valid Accuracy: 0.6730
============ Train epoch 38 ============
denominator: 28336.6171875
 Site-Clipart   | Train Loss: 2.0056 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.7649 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.9325 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8376 | Train Acc: 0.7015
 Site-Clipart   | Train Loss: 1.8573 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1515 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.8036 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8363 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.9259 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.8140 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.2037 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.7862 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.7913 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.7616 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.9289 | Train Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.8930 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8431 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.7648 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8388 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.8985 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.1914 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8163 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9254 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.9506 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.9082 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2449 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.7555 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.7925 | Val  Acc: 0.8701
 Site-Sketch    | Val  Loss: 1.7725 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.9227 | Val  Acc: 0.6739
Average Valid Accuracy: 0.7015
============ Train epoch 39 ============
denominator: 28412.07421875
 Site-Clipart   | Train Loss: 1.9550 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.9306 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9384 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8471 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.8350 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1576 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.7978 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8546 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.9412 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.8018 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2158 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.7978 | Train Acc: 0.8276
 Site-Real      | Train Loss: 1.7859 | Train Acc: 0.9052
 Site-Sketch    | Train Loss: 1.8306 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.8958 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 1.8738 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8114 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.7403 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.8427 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.9036 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 2.1666 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.7177 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8888 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9613 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.8843 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2494 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.7174 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7750 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.8142 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.8787 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7108
 Best site-Clipart    | Epoch:39 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:39 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:39 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:39 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:39 | Val Acc: 0.4000
 Best site-Painting   | Epoch:39 | Val Acc: 1.0000
 Best site-Painting   | Epoch:39 | Val Acc: 0.7333
 Best site-Painting   | Epoch:39 | Val Acc: 0.6087
 Best site-Painting   | Epoch:39 | Val Acc: 0.7742
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.0938
 Best site-Real       | Epoch:39 | Val Acc: 0.9737
 Best site-Real       | Epoch:39 | Val Acc: 0.8961
 Best site-Sketch     | Epoch:39 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:39 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.7433
 Test site-Infograph | Epoch:39 | Test Acc: 0.3820
 Test site-Painting  | Epoch:39 | Test Acc: 0.7997
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.2420
 Test site-Real      | Epoch:39 | Test Acc: 0.8899
 Test site-Sketch    | Epoch:39 | Test Acc: 0.7184
Average Test Accuracy: 0.6292
============ Train epoch 40 ============
denominator: 28381.869140625
 Site-Clipart   | Train Loss: 1.9460 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.8857 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.9151 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.8220 | Train Acc: 0.7164
 Site-Clipart   | Train Loss: 1.8402 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1637 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.8255 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8370 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.9134 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7982 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 2.2117 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7667 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.7636 | Train Acc: 0.8793
 Site-Sketch    | Train Loss: 1.7948 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.8724 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8211 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7721 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.7577 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.8302 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.9110 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 2.1915 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.7510 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8985 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.9705 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8797 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2546 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.7316 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.7637 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.8141 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.8881 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7173
 Best site-Clipart    | Epoch:40 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:40 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:40 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:40 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:40 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:40 | Val Acc: 0.4500
 Best site-Painting   | Epoch:40 | Val Acc: 0.8571
 Best site-Painting   | Epoch:40 | Val Acc: 0.6667
 Best site-Painting   | Epoch:40 | Val Acc: 0.6522
 Best site-Painting   | Epoch:40 | Val Acc: 0.7419
 Best site-QuickDraw  | Epoch:40 | Val Acc: 0.1250
 Best site-Real       | Epoch:40 | Val Acc: 0.9211
 Best site-Real       | Epoch:40 | Val Acc: 0.8961
 Best site-Sketch     | Epoch:40 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:40 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 41 ============
denominator: 28312.87109375
 Site-Clipart   | Train Loss: 1.9882 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.6654 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.9268 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.8392 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.8419 | Train Acc: 0.7381
 Site-Infograph | Train Loss: 2.1746 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8462 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8203 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.9262 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7698 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1982 | Train Acc: 0.2708
 Site-Real      | Train Loss: 1.7565 | Train Acc: 0.8276
 Site-Real      | Train Loss: 1.7562 | Train Acc: 0.8793
 Site-Sketch    | Train Loss: 1.7407 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.8935 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8832 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7719 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7455 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.8278 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.9135 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2135 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.7438 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8892 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9474 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8786 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2732 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.7186 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.7583 | Val  Acc: 0.8831
 Site-Sketch    | Val  Loss: 1.7498 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.8642 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7065
============ Train epoch 42 ============
denominator: 28431.68359375
 Site-Clipart   | Train Loss: 1.9745 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.8142 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.8675 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.8659 | Train Acc: 0.6866
 Site-Clipart   | Train Loss: 1.7880 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1456 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8290 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7749 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.8779 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.7419 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.2017 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7657 | Train Acc: 0.7931
 Site-Real      | Train Loss: 1.7288 | Train Acc: 0.8879
 Site-Sketch    | Train Loss: 1.8044 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.8465 | Train Acc: 0.6714
 Site-Clipart   | Val  Loss: 1.8652 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7965 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7272 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.8221 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.8986 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.1902 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 1.6735 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8671 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9210 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8567 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2638 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.7166 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7356 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.7493 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.8507 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7232
 Best site-Clipart    | Epoch:42 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:42 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:42 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:42 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:42 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:42 | Val Acc: 0.5000
 Best site-Painting   | Epoch:42 | Val Acc: 1.0000
 Best site-Painting   | Epoch:42 | Val Acc: 0.7333
 Best site-Painting   | Epoch:42 | Val Acc: 0.6957
 Best site-Painting   | Epoch:42 | Val Acc: 0.7742
 Best site-QuickDraw  | Epoch:42 | Val Acc: 0.0938
 Best site-Real       | Epoch:42 | Val Acc: 0.9737
 Best site-Real       | Epoch:42 | Val Acc: 0.8961
 Best site-Sketch     | Epoch:42 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:42 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 43 ============
denominator: 27964.125
 Site-Clipart   | Train Loss: 1.9872 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.6741 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.8124 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.8556 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.8164 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1663 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.7603 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7872 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.8891 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 1.7521 | Train Acc: 0.8085
 Site-QuickDraw | Train Loss: 2.2027 | Train Acc: 0.2708
 Site-Real      | Train Loss: 1.7197 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.7286 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.7211 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.8616 | Train Acc: 0.6714
 Site-Clipart   | Val  Loss: 1.8805 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.7831 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.6926 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7769 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.8692 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 2.2323 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.6448 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8672 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.9295 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8496 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 2.2502 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.6988 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7279 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.7378 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.8745 | Val  Acc: 0.6739
Average Valid Accuracy: 0.7040
============ Train epoch 44 ============
denominator: 27390.701171875
 Site-Clipart   | Train Loss: 1.9291 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.6726 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.8786 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7845 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.7563 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1409 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.7424 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8278 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.8676 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.7500 | Train Acc: 0.8085
 Site-QuickDraw | Train Loss: 2.1908 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.7486 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.7098 | Train Acc: 0.9052
 Site-Sketch    | Train Loss: 1.8096 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.8591 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8112 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.7488 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.6826 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7880 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.8796 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 2.1687 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.7147 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8275 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8842 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 1.8599 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2417 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.6816 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.7251 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.7517 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8509 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7327
 Best site-Clipart    | Epoch:44 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:44 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:44 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:44 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:44 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:44 | Val Acc: 0.4000
 Best site-Painting   | Epoch:44 | Val Acc: 0.8571
 Best site-Painting   | Epoch:44 | Val Acc: 0.7333
 Best site-Painting   | Epoch:44 | Val Acc: 0.7391
 Best site-Painting   | Epoch:44 | Val Acc: 0.7097
 Best site-QuickDraw  | Epoch:44 | Val Acc: 0.0938
 Best site-Real       | Epoch:44 | Val Acc: 0.9211
 Best site-Real       | Epoch:44 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:44 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:44 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/q-ffl...
============ Train epoch 45 ============
denominator: 27742.404296875
 Site-Clipart   | Train Loss: 1.9813 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.6459 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.6811 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.7928 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.7633 | Train Acc: 0.7738
 Site-Infograph | Train Loss: 2.1388 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.7375 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8049 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.9423 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 1.7256 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1901 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.7163 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.7257 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.6517 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.8699 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.8275 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.7583 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7018 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.7624 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.8363 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 2.2116 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.7677 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8467 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8749 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8237 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2399 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6601 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.6938 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.7011 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.8420 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7094
============ Train epoch 46 ============
denominator: 27353.333984375
 Site-Clipart   | Train Loss: 1.9474 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.7945 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.9365 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.7616 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 1.7828 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1455 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.7760 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8037 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.7940 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7091 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.1860 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.7129 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.6852 | Train Acc: 0.9052
 Site-Sketch    | Train Loss: 1.7743 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.8218 | Train Acc: 0.6714
 Site-Clipart   | Val  Loss: 1.8537 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7161 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.6789 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.7718 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8662 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 2.1868 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.6761 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8069 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.8830 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8392 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2387 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6642 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7099 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.7420 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8650 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7298
============ Train epoch 47 ============
denominator: 27611.10546875
 Site-Clipart   | Train Loss: 1.9104 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.7335 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.6987 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7276 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.7349 | Train Acc: 0.7738
 Site-Infograph | Train Loss: 2.1411 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.8047 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8003 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.8131 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7364 | Train Acc: 0.8085
 Site-QuickDraw | Train Loss: 2.1860 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.7043 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.6538 | Train Acc: 0.9052
 Site-Sketch    | Train Loss: 1.6888 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.8459 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.8106 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7740 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.7019 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7554 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8403 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2137 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.6668 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.7912 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.8816 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8234 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2362 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6471 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.6825 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.6852 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.8371 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6895
============ Train epoch 48 ============
denominator: 27087.978515625
 Site-Clipart   | Train Loss: 1.9497 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.6661 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.7079 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7531 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 1.7304 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1330 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.7205 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7754 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.8189 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.7053 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1918 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.6874 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.6771 | Train Acc: 0.8879
 Site-Sketch    | Train Loss: 1.6967 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.7929 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.7830 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7362 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.6709 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7637 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8359 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 2.2070 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.7265 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8308 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.8373 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8164 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2443 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6287 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.6723 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.6885 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8432 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7028
============ Train epoch 49 ============
denominator: 27278.609375
 Site-Clipart   | Train Loss: 1.9381 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.5621 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.8461 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8019 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 1.7001 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 2.1568 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.7455 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7623 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8243 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 1.6815 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.1680 | Train Acc: 0.2917
 Site-Real      | Train Loss: 1.6909 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.6663 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 1.6155 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.8099 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.7904 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.6973 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6693 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7366 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.8331 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 2.1960 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.6960 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 1.7756 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8674 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8228 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2359 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.6136 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.6602 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.6872 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.7943 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7162
===2023-04-27 18:37:58===
===2023-04-27 18:38:00===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,11,23,35,47,48,58,116,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 7, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:44 | Test Acc: 0.7681
 Test site-Infograph | Epoch:44 | Test Acc: 0.3927
 Test site-Painting  | Epoch:44 | Test Acc: 0.8078
 Test site-QuickDraw | Epoch:44 | Test Acc: 0.2570
 Test site-Real      | Epoch:44 | Test Acc: 0.9022
 Test site-Sketch    | Epoch:44 | Test Acc: 0.7310
Average Test Accuracy: 0.6431
