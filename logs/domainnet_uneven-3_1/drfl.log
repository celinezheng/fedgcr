===2023-04-27 18:39:12===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,11,23,35,47,48,58,116,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 7, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 2.3149 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 2.2079 | Train Acc: 0.2121
 Site-Clipart   | Train Loss: 2.2803 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2831 | Train Acc: 0.1791
 Site-Clipart   | Train Loss: 2.2799 | Train Acc: 0.1429
 Site-Infograph | Train Loss: 2.2768 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.2522 | Train Acc: 0.3636
 Site-Painting  | Train Loss: 2.2931 | Train Acc: 0.1739
 Site-Painting  | Train Loss: 2.2616 | Train Acc: 0.1714
 Site-Painting  | Train Loss: 2.2938 | Train Acc: 0.0638
 Site-QuickDraw | Train Loss: 2.3141 | Train Acc: 0.0833
 Site-Real      | Train Loss: 2.3058 | Train Acc: 0.1724
 Site-Real      | Train Loss: 2.2851 | Train Acc: 0.1724
 Site-Sketch    | Train Loss: 2.2852 | Train Acc: 0.1429
 Site-Sketch    | Train Loss: 2.2959 | Train Acc: 0.1286
 Site-Clipart   | Val  Loss: 2.2831 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2612 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2642 | Val  Acc: 0.1515
 Site-Clipart   | Val  Loss: 2.3012 | Val  Acc: 0.0682
 Site-Clipart   | Val  Loss: 2.2697 | Val  Acc: 0.1250
 Site-Infograph | Val  Loss: 2.2437 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2924 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.2800 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.3190 | Val  Acc: 0.0435
 Site-Painting  | Val  Loss: 2.2953 | Val  Acc: 0.1613
 Site-QuickDraw | Val  Loss: 2.3314 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 2.2845 | Val  Acc: 0.1579
 Site-Real      | Val  Loss: 2.2810 | Val  Acc: 0.1429
 Site-Sketch    | Val  Loss: 2.2830 | Val  Acc: 0.2174
 Site-Sketch    | Val  Loss: 2.2990 | Val  Acc: 0.1304
Average Valid Accuracy: 0.1466
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1515
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0682
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1250
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2500
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.0435
 Best site-Painting   | Epoch:0 | Val Acc: 0.1613
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0625
 Best site-Real       | Epoch:0 | Val Acc: 0.1579
 Best site-Real       | Epoch:0 | Val Acc: 0.1429
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2174
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.3053 | Train Acc: 0.0000
 Site-Clipart   | Train Loss: 2.2865 | Train Acc: 0.3030
 Site-Clipart   | Train Loss: 2.2523 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2729 | Train Acc: 0.2090
 Site-Clipart   | Train Loss: 2.2576 | Train Acc: 0.2500
 Site-Infograph | Train Loss: 2.2883 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.2160 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.2825 | Train Acc: 0.1739
 Site-Painting  | Train Loss: 2.3019 | Train Acc: 0.2286
 Site-Painting  | Train Loss: 2.2659 | Train Acc: 0.1489
 Site-QuickDraw | Train Loss: 2.3043 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.2843 | Train Acc: 0.2931
 Site-Real      | Train Loss: 2.2552 | Train Acc: 0.1897
 Site-Sketch    | Train Loss: 2.2301 | Train Acc: 0.1714
 Site-Sketch    | Train Loss: 2.2857 | Train Acc: 0.1143
 Site-Clipart   | Val  Loss: 2.2715 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2371 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2370 | Val  Acc: 0.2121
 Site-Clipart   | Val  Loss: 2.2768 | Val  Acc: 0.2273
 Site-Clipart   | Val  Loss: 2.2534 | Val  Acc: 0.2143
 Site-Infograph | Val  Loss: 2.2886 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.2659 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.2935 | Val  Acc: 0.0667
 Site-Painting  | Val  Loss: 2.2976 | Val  Acc: 0.1304
 Site-Painting  | Val  Loss: 2.2701 | Val  Acc: 0.2581
 Site-QuickDraw | Val  Loss: 2.3239 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.2606 | Val  Acc: 0.1842
 Site-Real      | Val  Loss: 2.2699 | Val  Acc: 0.1818
 Site-Sketch    | Val  Loss: 2.2513 | Val  Acc: 0.2174
 Site-Sketch    | Val  Loss: 2.2789 | Val  Acc: 0.1522
Average Valid Accuracy: 0.1946
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2121
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2273
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2143
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1500
 Best site-Painting   | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.0667
 Best site-Painting   | Epoch:1 | Val Acc: 0.1304
 Best site-Painting   | Epoch:1 | Val Acc: 0.2581
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0938
 Best site-Real       | Epoch:1 | Val Acc: 0.1842
 Best site-Real       | Epoch:1 | Val Acc: 0.1818
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2174
 Best site-Sketch     | Epoch:1 | Val Acc: 0.1522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 2.3124 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 2.2369 | Train Acc: 0.2727
 Site-Clipart   | Train Loss: 2.2452 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2438 | Train Acc: 0.2388
 Site-Clipart   | Train Loss: 2.2377 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.2765 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.2225 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.2662 | Train Acc: 0.2609
 Site-Painting  | Train Loss: 2.2729 | Train Acc: 0.2571
 Site-Painting  | Train Loss: 2.2517 | Train Acc: 0.2766
 Site-QuickDraw | Train Loss: 2.3075 | Train Acc: 0.0833
 Site-Real      | Train Loss: 2.2450 | Train Acc: 0.3448
 Site-Real      | Train Loss: 2.2371 | Train Acc: 0.2672
 Site-Sketch    | Train Loss: 2.2238 | Train Acc: 0.2571
 Site-Sketch    | Train Loss: 2.2676 | Train Acc: 0.1857
 Site-Clipart   | Val  Loss: 2.2516 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.2446 | Val  Acc: 0.1818
 Site-Clipart   | Val  Loss: 2.2270 | Val  Acc: 0.2424
 Site-Clipart   | Val  Loss: 2.2519 | Val  Acc: 0.2273
 Site-Clipart   | Val  Loss: 2.2457 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2744 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2383 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.2758 | Val  Acc: 0.1333
 Site-Painting  | Val  Loss: 2.2800 | Val  Acc: 0.0870
 Site-Painting  | Val  Loss: 2.2515 | Val  Acc: 0.2581
 Site-QuickDraw | Val  Loss: 2.3225 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.2310 | Val  Acc: 0.2895
 Site-Real      | Val  Loss: 2.2385 | Val  Acc: 0.2338
 Site-Sketch    | Val  Loss: 2.2163 | Val  Acc: 0.2609
 Site-Sketch    | Val  Loss: 2.2718 | Val  Acc: 0.1739
Average Valid Accuracy: 0.2241
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1818
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2424
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2273
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2500
 Best site-Painting   | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.1333
 Best site-Painting   | Epoch:2 | Val Acc: 0.0870
 Best site-Painting   | Epoch:2 | Val Acc: 0.2581
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1250
 Best site-Real       | Epoch:2 | Val Acc: 0.2895
 Best site-Real       | Epoch:2 | Val Acc: 0.2338
 Best site-Sketch     | Epoch:2 | Val Acc: 0.2609
 Best site-Sketch     | Epoch:2 | Val Acc: 0.1739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 2.3206 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 2.2496 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.2133 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.2323 | Train Acc: 0.2537
 Site-Clipart   | Train Loss: 2.2137 | Train Acc: 0.2619
 Site-Infograph | Train Loss: 2.2806 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.2152 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.2580 | Train Acc: 0.1739
 Site-Painting  | Train Loss: 2.2419 | Train Acc: 0.3143
 Site-Painting  | Train Loss: 2.2211 | Train Acc: 0.2553
 Site-QuickDraw | Train Loss: 2.2990 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.2337 | Train Acc: 0.3448
 Site-Real      | Train Loss: 2.2186 | Train Acc: 0.2931
 Site-Sketch    | Train Loss: 2.2008 | Train Acc: 0.4286
 Site-Sketch    | Train Loss: 2.2474 | Train Acc: 0.2143
 Site-Clipart   | Val  Loss: 2.2530 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2137 | Val  Acc: 0.4091
 Site-Clipart   | Val  Loss: 2.1814 | Val  Acc: 0.3030
 Site-Clipart   | Val  Loss: 2.2445 | Val  Acc: 0.3182
 Site-Clipart   | Val  Loss: 2.2388 | Val  Acc: 0.2679
 Site-Infograph | Val  Loss: 2.2755 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2156 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.2503 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2694 | Val  Acc: 0.2174
 Site-Painting  | Val  Loss: 2.2502 | Val  Acc: 0.2903
 Site-QuickDraw | Val  Loss: 2.3179 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.2146 | Val  Acc: 0.3158
 Site-Real      | Val  Loss: 2.2184 | Val  Acc: 0.3247
 Site-Sketch    | Val  Loss: 2.2107 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 2.2467 | Val  Acc: 0.3478
Average Valid Accuracy: 0.2946
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4091
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3030
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3182
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2679
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2500
 Best site-Painting   | Epoch:3 | Val Acc: 0.4286
 Best site-Painting   | Epoch:3 | Val Acc: 0.2000
 Best site-Painting   | Epoch:3 | Val Acc: 0.2174
 Best site-Painting   | Epoch:3 | Val Acc: 0.2903
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1250
 Best site-Real       | Epoch:3 | Val Acc: 0.3158
 Best site-Real       | Epoch:3 | Val Acc: 0.3247
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.2809 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.2650 | Train Acc: 0.4545
 Site-Clipart   | Train Loss: 2.2227 | Train Acc: 0.2600
 Site-Clipart   | Train Loss: 2.2298 | Train Acc: 0.3433
 Site-Clipart   | Train Loss: 2.2250 | Train Acc: 0.3690
 Site-Infograph | Train Loss: 2.2790 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.2066 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.2123 | Train Acc: 0.2609
 Site-Painting  | Train Loss: 2.2318 | Train Acc: 0.2571
 Site-Painting  | Train Loss: 2.1999 | Train Acc: 0.3191
 Site-QuickDraw | Train Loss: 2.2850 | Train Acc: 0.1458
 Site-Real      | Train Loss: 2.2076 | Train Acc: 0.4138
 Site-Real      | Train Loss: 2.1922 | Train Acc: 0.3448
 Site-Sketch    | Train Loss: 2.1496 | Train Acc: 0.3714
 Site-Sketch    | Train Loss: 2.2257 | Train Acc: 0.2286
 Site-Clipart   | Val  Loss: 2.2364 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.1950 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.1770 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.2172 | Val  Acc: 0.4318
 Site-Clipart   | Val  Loss: 2.2253 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2826 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2249 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.2254 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 2.2558 | Val  Acc: 0.2609
 Site-Painting  | Val  Loss: 2.2295 | Val  Acc: 0.4194
 Site-QuickDraw | Val  Loss: 2.3416 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.2013 | Val  Acc: 0.2895
 Site-Real      | Val  Loss: 2.2018 | Val  Acc: 0.3766
 Site-Sketch    | Val  Loss: 2.1846 | Val  Acc: 0.4348
 Site-Sketch    | Val  Loss: 2.2330 | Val  Acc: 0.3043
Average Valid Accuracy: 0.3241
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4318
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2000
 Best site-Painting   | Epoch:4 | Val Acc: 0.2857
 Best site-Painting   | Epoch:4 | Val Acc: 0.3333
 Best site-Painting   | Epoch:4 | Val Acc: 0.2609
 Best site-Painting   | Epoch:4 | Val Acc: 0.4194
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.0938
 Best site-Real       | Epoch:4 | Val Acc: 0.2895
 Best site-Real       | Epoch:4 | Val Acc: 0.3766
 Best site-Sketch     | Epoch:4 | Val Acc: 0.4348
 Best site-Sketch     | Epoch:4 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 2.2632 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.1717 | Train Acc: 0.5758
 Site-Clipart   | Train Loss: 2.2213 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.2206 | Train Acc: 0.3881
 Site-Clipart   | Train Loss: 2.1854 | Train Acc: 0.4524
 Site-Infograph | Train Loss: 2.2711 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.1610 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.2169 | Train Acc: 0.3043
 Site-Painting  | Train Loss: 2.2335 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.1852 | Train Acc: 0.3830
 Site-QuickDraw | Train Loss: 2.2903 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.1957 | Train Acc: 0.4310
 Site-Real      | Train Loss: 2.1671 | Train Acc: 0.4138
 Site-Sketch    | Train Loss: 2.1498 | Train Acc: 0.4286
 Site-Sketch    | Train Loss: 2.2178 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.2106 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1872 | Val  Acc: 0.4091
 Site-Clipart   | Val  Loss: 2.1641 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.2106 | Val  Acc: 0.4318
 Site-Clipart   | Val  Loss: 2.2081 | Val  Acc: 0.3036
 Site-Infograph | Val  Loss: 2.2731 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1630 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.2196 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2548 | Val  Acc: 0.3043
 Site-Painting  | Val  Loss: 2.2146 | Val  Acc: 0.3871
 Site-QuickDraw | Val  Loss: 2.3207 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 2.1786 | Val  Acc: 0.3947
 Site-Real      | Val  Loss: 2.1821 | Val  Acc: 0.4156
 Site-Sketch    | Val  Loss: 2.1532 | Val  Acc: 0.4348
 Site-Sketch    | Val  Loss: 2.2023 | Val  Acc: 0.3696
Average Valid Accuracy: 0.3687
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4091
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4318
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3036
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2500
 Best site-Painting   | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.4000
 Best site-Painting   | Epoch:5 | Val Acc: 0.3043
 Best site-Painting   | Epoch:5 | Val Acc: 0.3871
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.0625
 Best site-Real       | Epoch:5 | Val Acc: 0.3947
 Best site-Real       | Epoch:5 | Val Acc: 0.4156
 Best site-Sketch     | Epoch:5 | Val Acc: 0.4348
 Best site-Sketch     | Epoch:5 | Val Acc: 0.3696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 2.2622 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.1487 | Train Acc: 0.4242
 Site-Clipart   | Train Loss: 2.2063 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1848 | Train Acc: 0.4030
 Site-Clipart   | Train Loss: 2.1541 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 2.2539 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.1420 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.1722 | Train Acc: 0.3043
 Site-Painting  | Train Loss: 2.1719 | Train Acc: 0.5143
 Site-Painting  | Train Loss: 2.1724 | Train Acc: 0.4043
 Site-QuickDraw | Train Loss: 2.2903 | Train Acc: 0.1042
 Site-Real      | Train Loss: 2.1768 | Train Acc: 0.4310
 Site-Real      | Train Loss: 2.1621 | Train Acc: 0.4569
 Site-Sketch    | Train Loss: 2.1832 | Train Acc: 0.3429
 Site-Sketch    | Train Loss: 2.2185 | Train Acc: 0.3714
 Site-Clipart   | Val  Loss: 2.1858 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1646 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1374 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.1949 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1915 | Val  Acc: 0.4107
 Site-Infograph | Val  Loss: 2.2751 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1457 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.1907 | Val  Acc: 0.5333
 Site-Painting  | Val  Loss: 2.2314 | Val  Acc: 0.3478
 Site-Painting  | Val  Loss: 2.1951 | Val  Acc: 0.4194
 Site-QuickDraw | Val  Loss: 2.3094 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.1611 | Val  Acc: 0.4211
 Site-Real      | Val  Loss: 2.1609 | Val  Acc: 0.4545
 Site-Sketch    | Val  Loss: 2.1515 | Val  Acc: 0.4348
 Site-Sketch    | Val  Loss: 2.1934 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4147
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4107
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3000
 Best site-Painting   | Epoch:6 | Val Acc: 0.4286
 Best site-Painting   | Epoch:6 | Val Acc: 0.5333
 Best site-Painting   | Epoch:6 | Val Acc: 0.3478
 Best site-Painting   | Epoch:6 | Val Acc: 0.4194
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.0938
 Best site-Real       | Epoch:6 | Val Acc: 0.4211
 Best site-Real       | Epoch:6 | Val Acc: 0.4545
 Best site-Sketch     | Epoch:6 | Val Acc: 0.4348
 Best site-Sketch     | Epoch:6 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 2.2425 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 2.1365 | Train Acc: 0.4848
 Site-Clipart   | Train Loss: 2.1805 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 2.1766 | Train Acc: 0.4925
 Site-Clipart   | Train Loss: 2.1398 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 2.2517 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.1407 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.1789 | Train Acc: 0.3478
 Site-Painting  | Train Loss: 2.2296 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.1457 | Train Acc: 0.4894
 Site-QuickDraw | Train Loss: 2.3006 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1573 | Train Acc: 0.5345
 Site-Real      | Train Loss: 2.1405 | Train Acc: 0.5086
 Site-Sketch    | Train Loss: 2.1490 | Train Acc: 0.4857
 Site-Sketch    | Train Loss: 2.1852 | Train Acc: 0.3857
 Site-Clipart   | Val  Loss: 2.1637 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1536 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.1438 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1733 | Val  Acc: 0.4773
 Site-Clipart   | Val  Loss: 2.1689 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.2598 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1477 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 2.1953 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2213 | Val  Acc: 0.3913
 Site-Painting  | Val  Loss: 2.1804 | Val  Acc: 0.4516
 Site-QuickDraw | Val  Loss: 2.3167 | Val  Acc: 0.0312
 Site-Real      | Val  Loss: 2.1242 | Val  Acc: 0.6316
 Site-Real      | Val  Loss: 2.1429 | Val  Acc: 0.5325
 Site-Sketch    | Val  Loss: 2.1523 | Val  Acc: 0.5217
 Site-Sketch    | Val  Loss: 2.1803 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4509
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4773
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3000
 Best site-Painting   | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 0.4000
 Best site-Painting   | Epoch:7 | Val Acc: 0.3913
 Best site-Painting   | Epoch:7 | Val Acc: 0.4516
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.0312
 Best site-Real       | Epoch:7 | Val Acc: 0.6316
 Best site-Real       | Epoch:7 | Val Acc: 0.5325
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5217
 Best site-Sketch     | Epoch:7 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 2.2475 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.1643 | Train Acc: 0.5152
 Site-Clipart   | Train Loss: 2.1311 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 2.1417 | Train Acc: 0.5373
 Site-Clipart   | Train Loss: 2.1223 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 2.2623 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.1498 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.1614 | Train Acc: 0.3043
 Site-Painting  | Train Loss: 2.1726 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.1366 | Train Acc: 0.4894
 Site-QuickDraw | Train Loss: 2.2810 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.1265 | Train Acc: 0.5862
 Site-Real      | Train Loss: 2.1173 | Train Acc: 0.5517
 Site-Sketch    | Train Loss: 2.1427 | Train Acc: 0.4571
 Site-Sketch    | Train Loss: 2.1590 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1590 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1242 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0808 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.1333 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.1631 | Val  Acc: 0.4821
 Site-Infograph | Val  Loss: 2.2445 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.1245 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 2.1879 | Val  Acc: 0.4667
 Site-Painting  | Val  Loss: 2.2027 | Val  Acc: 0.3913
 Site-Painting  | Val  Loss: 2.1514 | Val  Acc: 0.5806
 Site-QuickDraw | Val  Loss: 2.3025 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.1099 | Val  Acc: 0.5789
 Site-Real      | Val  Loss: 2.1190 | Val  Acc: 0.5714
 Site-Sketch    | Val  Loss: 2.1213 | Val  Acc: 0.4783
 Site-Sketch    | Val  Loss: 2.1604 | Val  Acc: 0.4565
Average Valid Accuracy: 0.4852
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5758
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4821
 Best site-Infograph  | Epoch:8 | Val Acc: 0.3500
 Best site-Painting   | Epoch:8 | Val Acc: 0.5714
 Best site-Painting   | Epoch:8 | Val Acc: 0.4667
 Best site-Painting   | Epoch:8 | Val Acc: 0.3913
 Best site-Painting   | Epoch:8 | Val Acc: 0.5806
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.0938
 Best site-Real       | Epoch:8 | Val Acc: 0.5789
 Best site-Real       | Epoch:8 | Val Acc: 0.5714
 Best site-Sketch     | Epoch:8 | Val Acc: 0.4783
 Best site-Sketch     | Epoch:8 | Val Acc: 0.4565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.2448 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.1703 | Train Acc: 0.5455
 Site-Clipart   | Train Loss: 2.1426 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.1165 | Train Acc: 0.5075
 Site-Clipart   | Train Loss: 2.1215 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.2531 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.1512 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.1135 | Train Acc: 0.4783
 Site-Painting  | Train Loss: 2.1926 | Train Acc: 0.4857
 Site-Painting  | Train Loss: 2.1244 | Train Acc: 0.6596
 Site-QuickDraw | Train Loss: 2.2859 | Train Acc: 0.0833
 Site-Real      | Train Loss: 2.1092 | Train Acc: 0.6034
 Site-Real      | Train Loss: 2.0916 | Train Acc: 0.6034
 Site-Sketch    | Train Loss: 2.1178 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 2.1596 | Train Acc: 0.4429
 Site-Clipart   | Val  Loss: 2.1510 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1412 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0900 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.1244 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.1446 | Val  Acc: 0.4821
 Site-Infograph | Val  Loss: 2.2546 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1120 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 2.1547 | Val  Acc: 0.4667
 Site-Painting  | Val  Loss: 2.2072 | Val  Acc: 0.3478
 Site-Painting  | Val  Loss: 2.1580 | Val  Acc: 0.4839
 Site-QuickDraw | Val  Loss: 2.3185 | Val  Acc: 0.0312
 Site-Real      | Val  Loss: 2.0874 | Val  Acc: 0.5526
 Site-Real      | Val  Loss: 2.1005 | Val  Acc: 0.6364
 Site-Sketch    | Val  Loss: 2.0972 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1503 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4656
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 2.2249 | Train Acc: 0.3125
 Site-Clipart   | Train Loss: 1.9461 | Train Acc: 0.6364
 Site-Clipart   | Train Loss: 2.1337 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.1235 | Train Acc: 0.5522
 Site-Clipart   | Train Loss: 2.0941 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 2.2306 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1255 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.1403 | Train Acc: 0.4783
 Site-Painting  | Train Loss: 2.1646 | Train Acc: 0.5429
 Site-Painting  | Train Loss: 2.1152 | Train Acc: 0.5957
 Site-QuickDraw | Train Loss: 2.2793 | Train Acc: 0.1667
 Site-Real      | Train Loss: 2.1054 | Train Acc: 0.6034
 Site-Real      | Train Loss: 2.0766 | Train Acc: 0.6207
 Site-Sketch    | Train Loss: 2.0758 | Train Acc: 0.6286
 Site-Sketch    | Train Loss: 2.1407 | Train Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1346 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.1042 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0805 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1075 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.1353 | Val  Acc: 0.4821
 Site-Infograph | Val  Loss: 2.2628 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0601 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.1294 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1759 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 2.1565 | Val  Acc: 0.5806
 Site-QuickDraw | Val  Loss: 2.2971 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.0693 | Val  Acc: 0.6316
 Site-Real      | Val  Loss: 2.0903 | Val  Acc: 0.6364
 Site-Sketch    | Val  Loss: 2.0701 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 2.1527 | Val  Acc: 0.3913
Average Valid Accuracy: 0.5610
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:10 | Val Acc: 0.4821
 Best site-Infograph  | Epoch:10 | Val Acc: 0.3500
 Best site-Painting   | Epoch:10 | Val Acc: 0.8571
 Best site-Painting   | Epoch:10 | Val Acc: 0.6000
 Best site-Painting   | Epoch:10 | Val Acc: 0.5652
 Best site-Painting   | Epoch:10 | Val Acc: 0.5806
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.1250
 Best site-Real       | Epoch:10 | Val Acc: 0.6316
 Best site-Real       | Epoch:10 | Val Acc: 0.6364
 Best site-Sketch     | Epoch:10 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:10 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 2.1945 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 2.1313 | Train Acc: 0.6364
 Site-Clipart   | Train Loss: 2.1315 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 2.0854 | Train Acc: 0.6119
 Site-Clipart   | Train Loss: 2.0822 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 2.2243 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 2.0993 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.1152 | Train Acc: 0.5217
 Site-Painting  | Train Loss: 2.1504 | Train Acc: 0.5143
 Site-Painting  | Train Loss: 2.1025 | Train Acc: 0.6596
 Site-QuickDraw | Train Loss: 2.2621 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0758 | Train Acc: 0.6379
 Site-Real      | Train Loss: 2.0581 | Train Acc: 0.6466
 Site-Sketch    | Train Loss: 2.0655 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.1162 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 2.1419 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0860 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.0406 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.1113 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.1245 | Val  Acc: 0.5357
 Site-Infograph | Val  Loss: 2.2403 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.0404 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.1443 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1691 | Val  Acc: 0.4348
 Site-Painting  | Val  Loss: 2.1371 | Val  Acc: 0.4839
 Site-QuickDraw | Val  Loss: 2.3029 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.0425 | Val  Acc: 0.7632
 Site-Real      | Val  Loss: 2.0650 | Val  Acc: 0.6623
 Site-Sketch    | Val  Loss: 2.0601 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1178 | Val  Acc: 0.5435
Average Valid Accuracy: 0.5519
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 2.1695 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 2.0138 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 2.1259 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 2.0955 | Train Acc: 0.6567
 Site-Clipart   | Train Loss: 2.0592 | Train Acc: 0.6429
 Site-Infograph | Train Loss: 2.2333 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.0905 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.0937 | Train Acc: 0.5217
 Site-Painting  | Train Loss: 2.1187 | Train Acc: 0.5143
 Site-Painting  | Train Loss: 2.0812 | Train Acc: 0.6596
 Site-QuickDraw | Train Loss: 2.2717 | Train Acc: 0.1667
 Site-Real      | Train Loss: 2.0614 | Train Acc: 0.6552
 Site-Real      | Train Loss: 2.0436 | Train Acc: 0.6897
 Site-Sketch    | Train Loss: 2.0996 | Train Acc: 0.6857
 Site-Sketch    | Train Loss: 2.0882 | Train Acc: 0.5571
 Site-Clipart   | Val  Loss: 2.1309 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0713 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0170 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 2.1023 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 2.1241 | Val  Acc: 0.5536
 Site-Infograph | Val  Loss: 2.2648 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0274 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.1228 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.1503 | Val  Acc: 0.5217
 Site-Painting  | Val  Loss: 2.1096 | Val  Acc: 0.5484
 Site-QuickDraw | Val  Loss: 2.3120 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.0320 | Val  Acc: 0.7632
 Site-Real      | Val  Loss: 2.0503 | Val  Acc: 0.7013
 Site-Sketch    | Val  Loss: 2.0591 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1174 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5718
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6591
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5536
 Best site-Infograph  | Epoch:12 | Val Acc: 0.3500
 Best site-Painting   | Epoch:12 | Val Acc: 0.8571
 Best site-Painting   | Epoch:12 | Val Acc: 0.6667
 Best site-Painting   | Epoch:12 | Val Acc: 0.5217
 Best site-Painting   | Epoch:12 | Val Acc: 0.5484
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.1250
 Best site-Real       | Epoch:12 | Val Acc: 0.7632
 Best site-Real       | Epoch:12 | Val Acc: 0.7013
 Best site-Sketch     | Epoch:12 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:12 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 2.1844 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 1.8839 | Train Acc: 0.6970
 Site-Clipart   | Train Loss: 2.0689 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 2.0520 | Train Acc: 0.5821
 Site-Clipart   | Train Loss: 2.0549 | Train Acc: 0.6548
 Site-Infograph | Train Loss: 2.2191 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.0629 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 2.0866 | Train Acc: 0.5217
 Site-Painting  | Train Loss: 2.0536 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 2.0826 | Train Acc: 0.6596
 Site-QuickDraw | Train Loss: 2.2567 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0540 | Train Acc: 0.6897
 Site-Real      | Train Loss: 2.0361 | Train Acc: 0.7241
 Site-Sketch    | Train Loss: 2.0341 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.1079 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 2.1100 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.0593 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0097 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 2.0581 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 2.0999 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 2.2462 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0224 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.1211 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.1259 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 2.1027 | Val  Acc: 0.6129
 Site-QuickDraw | Val  Loss: 2.3033 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.0089 | Val  Acc: 0.7632
 Site-Real      | Val  Loss: 2.0298 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 2.0204 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 2.0878 | Val  Acc: 0.5435
Average Valid Accuracy: 0.5881
 Best site-Clipart    | Epoch:13 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6591
 Best site-Clipart    | Epoch:13 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:13 | Val Acc: 0.3500
 Best site-Painting   | Epoch:13 | Val Acc: 0.8571
 Best site-Painting   | Epoch:13 | Val Acc: 0.6667
 Best site-Painting   | Epoch:13 | Val Acc: 0.5652
 Best site-Painting   | Epoch:13 | Val Acc: 0.6129
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.1250
 Best site-Real       | Epoch:13 | Val Acc: 0.7632
 Best site-Real       | Epoch:13 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:13 | Val Acc: 0.5435
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 2.1722 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.9578 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 2.1153 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.0595 | Train Acc: 0.6567
 Site-Clipart   | Train Loss: 2.0151 | Train Acc: 0.6429
 Site-Infograph | Train Loss: 2.2161 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.0315 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 2.0461 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 2.1344 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 2.0270 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2716 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0280 | Train Acc: 0.6897
 Site-Real      | Train Loss: 2.0101 | Train Acc: 0.7931
 Site-Sketch    | Train Loss: 2.0727 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 2.0763 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 2.0584 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0445 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.9916 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.0823 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1181 | Val  Acc: 0.4643
 Site-Infograph | Val  Loss: 2.2604 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9852 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0709 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.1358 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0763 | Val  Acc: 0.6774
 Site-QuickDraw | Val  Loss: 2.2849 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.9904 | Val  Acc: 0.8684
 Site-Real      | Val  Loss: 2.0042 | Val  Acc: 0.7922
 Site-Sketch    | Val  Loss: 2.0257 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 2.0844 | Val  Acc: 0.5217
Average Valid Accuracy: 0.5993
 Best site-Clipart    | Epoch:14 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:14 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5758
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:14 | Val Acc: 0.4643
 Best site-Infograph  | Epoch:14 | Val Acc: 0.3000
 Best site-Painting   | Epoch:14 | Val Acc: 0.8571
 Best site-Painting   | Epoch:14 | Val Acc: 0.6667
 Best site-Painting   | Epoch:14 | Val Acc: 0.6087
 Best site-Painting   | Epoch:14 | Val Acc: 0.6774
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.0938
 Best site-Real       | Epoch:14 | Val Acc: 0.8684
 Best site-Real       | Epoch:14 | Val Acc: 0.7922
 Best site-Sketch     | Epoch:14 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:14 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 2.1560 | Train Acc: 0.3125
 Site-Clipart   | Train Loss: 2.0813 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 2.0498 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 2.0502 | Train Acc: 0.6269
 Site-Clipart   | Train Loss: 2.0375 | Train Acc: 0.7024
 Site-Infograph | Train Loss: 2.2007 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.0110 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 2.0525 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0542 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 2.0344 | Train Acc: 0.6809
 Site-QuickDraw | Train Loss: 2.2667 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0048 | Train Acc: 0.6897
 Site-Real      | Train Loss: 2.0002 | Train Acc: 0.7845
 Site-Sketch    | Train Loss: 2.0021 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 2.0734 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0807 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0190 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.9887 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 2.0496 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.0870 | Val  Acc: 0.6071
 Site-Infograph | Val  Loss: 2.2636 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.0043 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0526 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.1205 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0779 | Val  Acc: 0.5484
 Site-QuickDraw | Val  Loss: 2.2865 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.9529 | Val  Acc: 0.8684
 Site-Real      | Val  Loss: 1.9914 | Val  Acc: 0.7662
 Site-Sketch    | Val  Loss: 2.0042 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0599 | Val  Acc: 0.5435
Average Valid Accuracy: 0.6083
 Best site-Clipart    | Epoch:15 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:15 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:15 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6071
 Best site-Infograph  | Epoch:15 | Val Acc: 0.3000
 Best site-Painting   | Epoch:15 | Val Acc: 0.8571
 Best site-Painting   | Epoch:15 | Val Acc: 0.7333
 Best site-Painting   | Epoch:15 | Val Acc: 0.6087
 Best site-Painting   | Epoch:15 | Val Acc: 0.5484
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.1250
 Best site-Real       | Epoch:15 | Val Acc: 0.8684
 Best site-Real       | Epoch:15 | Val Acc: 0.7662
 Best site-Sketch     | Epoch:15 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:15 | Val Acc: 0.5435
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 2.1326 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.9788 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.9705 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.0271 | Train Acc: 0.6119
 Site-Clipart   | Train Loss: 2.0319 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.2077 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.0006 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.0706 | Train Acc: 0.5652
 Site-Painting  | Train Loss: 2.0600 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 2.0069 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2647 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.9863 | Train Acc: 0.7241
 Site-Real      | Train Loss: 1.9615 | Train Acc: 0.8362
 Site-Sketch    | Train Loss: 1.9790 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 2.0471 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0476 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0078 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.9696 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0494 | Val  Acc: 0.6136
 Site-Clipart   | Val  Loss: 2.0602 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.2749 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.9737 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0392 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0940 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0809 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2934 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 1.9483 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 1.9706 | Val  Acc: 0.8052
 Site-Sketch    | Val  Loss: 1.9865 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 2.0604 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6446
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6136
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4000
 Best site-Painting   | Epoch:16 | Val Acc: 0.8571
 Best site-Painting   | Epoch:16 | Val Acc: 0.7333
 Best site-Painting   | Epoch:16 | Val Acc: 0.6087
 Best site-Painting   | Epoch:16 | Val Acc: 0.6452
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.0625
 Best site-Real       | Epoch:16 | Val Acc: 0.8947
 Best site-Real       | Epoch:16 | Val Acc: 0.8052
 Best site-Sketch     | Epoch:16 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:16 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 2.1314 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.9157 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 2.0508 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 2.0234 | Train Acc: 0.6418
 Site-Clipart   | Train Loss: 2.0058 | Train Acc: 0.6786
 Site-Infograph | Train Loss: 2.2213 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.0187 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.0166 | Train Acc: 0.5652
 Site-Painting  | Train Loss: 2.0694 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.9805 | Train Acc: 0.7234
 Site-QuickDraw | Train Loss: 2.2587 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.9656 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.9459 | Train Acc: 0.8793
 Site-Sketch    | Train Loss: 1.9348 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.0610 | Train Acc: 0.5286
 Site-Clipart   | Val  Loss: 2.0087 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0043 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.9711 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.0188 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0561 | Val  Acc: 0.5536
 Site-Infograph | Val  Loss: 2.2576 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.9320 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0481 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0963 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0606 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2960 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.9291 | Val  Acc: 0.8158
 Site-Real      | Val  Loss: 1.9552 | Val  Acc: 0.8312
 Site-Sketch    | Val  Loss: 1.9943 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0384 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6343
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 2.1216 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.9787 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 2.0384 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 2.0181 | Train Acc: 0.6567
 Site-Clipart   | Train Loss: 1.9761 | Train Acc: 0.6905
 Site-Infograph | Train Loss: 2.2154 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0266 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.0302 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0377 | Train Acc: 0.6571
 Site-Painting  | Train Loss: 1.9812 | Train Acc: 0.7234
 Site-QuickDraw | Train Loss: 2.2308 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9660 | Train Acc: 0.7586
 Site-Real      | Train Loss: 1.9207 | Train Acc: 0.8362
 Site-Sketch    | Train Loss: 1.8812 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 2.0212 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0714 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 1.9921 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.9321 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 2.0054 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.0562 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.2370 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.9675 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0292 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0716 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 2.0355 | Val  Acc: 0.6129
 Site-QuickDraw | Val  Loss: 2.2936 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.9091 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.9374 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.9389 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 2.0346 | Val  Acc: 0.5217
Average Valid Accuracy: 0.6410
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 2.1361 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 1.7544 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 2.0542 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9846 | Train Acc: 0.6418
 Site-Clipart   | Train Loss: 1.9594 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 2.1960 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9863 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 2.0213 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.9894 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 1.9604 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2470 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.9490 | Train Acc: 0.7931
 Site-Real      | Train Loss: 1.9125 | Train Acc: 0.8707
 Site-Sketch    | Train Loss: 1.9541 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.0316 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 2.0299 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.9914 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9252 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0022 | Val  Acc: 0.6136
 Site-Clipart   | Val  Loss: 2.0498 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.2298 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9004 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 2.0117 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 2.0529 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 2.0349 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2870 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.8840 | Val  Acc: 0.8421
 Site-Real      | Val  Loss: 1.9088 | Val  Acc: 0.8701
 Site-Sketch    | Val  Loss: 1.9180 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.9961 | Val  Acc: 0.6739
Average Valid Accuracy: 0.6480
 Best site-Clipart    | Epoch:19 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:19 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6136
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:19 | Val Acc: 0.3000
 Best site-Painting   | Epoch:19 | Val Acc: 1.0000
 Best site-Painting   | Epoch:19 | Val Acc: 0.8000
 Best site-Painting   | Epoch:19 | Val Acc: 0.6522
 Best site-Painting   | Epoch:19 | Val Acc: 0.6452
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.0938
 Best site-Real       | Epoch:19 | Val Acc: 0.8421
 Best site-Real       | Epoch:19 | Val Acc: 0.8701
 Best site-Sketch     | Epoch:19 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:19 | Val Acc: 0.6739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.6787
 Test site-Infograph | Epoch:19 | Test Acc: 0.3455
 Test site-Painting  | Epoch:19 | Test Acc: 0.7464
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.1820
 Test site-Real      | Epoch:19 | Test Acc: 0.8562
 Test site-Sketch    | Epoch:19 | Test Acc: 0.6751
Average Test Accuracy: 0.5806
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 2.1660 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 1.8649 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.9897 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.9474 | Train Acc: 0.6866
 Site-Clipart   | Train Loss: 1.9519 | Train Acc: 0.7024
 Site-Infograph | Train Loss: 2.2112 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9560 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9883 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 2.0207 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.9322 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2472 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.9526 | Train Acc: 0.7759
 Site-Real      | Train Loss: 1.8964 | Train Acc: 0.8707
 Site-Sketch    | Train Loss: 1.9481 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 2.0136 | Train Acc: 0.5857
 Site-Clipart   | Val  Loss: 2.0202 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9568 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.8948 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9821 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 2.0152 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.2366 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8820 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0297 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0833 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0133 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2877 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.8540 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.8925 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.9420 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0006 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6509
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:20 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6591
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4000
 Best site-Painting   | Epoch:20 | Val Acc: 0.8571
 Best site-Painting   | Epoch:20 | Val Acc: 0.6667
 Best site-Painting   | Epoch:20 | Val Acc: 0.6087
 Best site-Painting   | Epoch:20 | Val Acc: 0.6452
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.1250
 Best site-Real       | Epoch:20 | Val Acc: 0.9737
 Best site-Real       | Epoch:20 | Val Acc: 0.8961
 Best site-Sketch     | Epoch:20 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:20 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 2.1251 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.9915 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 2.0272 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9671 | Train Acc: 0.7015
 Site-Clipart   | Train Loss: 1.9230 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.1844 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.9436 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9632 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0850 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.9153 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2396 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9155 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.8770 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.9315 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 2.0083 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.9631 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9528 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8987 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.9865 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9874 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2143 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8617 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 2.0064 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0452 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0224 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2927 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.8434 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.8763 | Val  Acc: 0.8831
 Site-Sketch    | Val  Loss: 1.9348 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.9870 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6842
 Best site-Clipart    | Epoch:21 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:21 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:21 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:21 | Val Acc: 0.4000
 Best site-Painting   | Epoch:21 | Val Acc: 1.0000
 Best site-Painting   | Epoch:21 | Val Acc: 0.6667
 Best site-Painting   | Epoch:21 | Val Acc: 0.6087
 Best site-Painting   | Epoch:21 | Val Acc: 0.6452
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.0938
 Best site-Real       | Epoch:21 | Val Acc: 0.9211
 Best site-Real       | Epoch:21 | Val Acc: 0.8831
 Best site-Sketch     | Epoch:21 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:21 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 2.0947 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 1.8480 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.9808 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.9226 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.8827 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.2125 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9296 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.9274 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 2.0228 | Train Acc: 0.6286
 Site-Painting  | Train Loss: 1.9163 | Train Acc: 0.7447
 Site-QuickDraw | Train Loss: 2.2362 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.9067 | Train Acc: 0.7759
 Site-Real      | Train Loss: 1.8645 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.8948 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.9777 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.9918 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9582 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.8588 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.9338 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9743 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.2553 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8689 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9821 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0438 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9834 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2763 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.8183 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.8635 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.8565 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.9825 | Val  Acc: 0.6304
Average Valid Accuracy: 0.7070
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7321
 Best site-Infograph  | Epoch:22 | Val Acc: 0.3500
 Best site-Painting   | Epoch:22 | Val Acc: 1.0000
 Best site-Painting   | Epoch:22 | Val Acc: 0.7333
 Best site-Painting   | Epoch:22 | Val Acc: 0.6087
 Best site-Painting   | Epoch:22 | Val Acc: 0.7097
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.1250
 Best site-Real       | Epoch:22 | Val Acc: 0.9737
 Best site-Real       | Epoch:22 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:22 | Val Acc: 0.6304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 2.0711 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 1.7863 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 2.0084 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9496 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.9068 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1805 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9903 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.9250 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8961 | Train Acc: 0.6286
 Site-Painting  | Train Loss: 1.8987 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2366 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.9031 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.8236 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.9357 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.9942 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 1.9601 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9403 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8689 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9425 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9837 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2155 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8574 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9691 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0350 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 1.9745 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2673 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.8212 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.8455 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.8685 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.9619 | Val  Acc: 0.6304
Average Valid Accuracy: 0.6709
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 2.0742 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.7877 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.8989 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.9478 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.8490 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1925 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9158 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.9091 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 2.0354 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.8915 | Train Acc: 0.7660
 Site-QuickDraw | Train Loss: 2.2249 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.8805 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.8398 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.9333 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.9550 | Train Acc: 0.6714
 Site-Clipart   | Val  Loss: 1.9418 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.9325 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8176 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.9264 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.9802 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 2.1922 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.8439 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9582 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 2.0179 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9653 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2581 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.7985 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.8247 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.8757 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.9717 | Val  Acc: 0.5870
Average Valid Accuracy: 0.7027
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 2.0752 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.7704 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9791 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.9359 | Train Acc: 0.7164
 Site-Clipart   | Train Loss: 1.8856 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1799 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8656 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8742 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.9721 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.8729 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2402 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.8538 | Train Acc: 0.7931
 Site-Real      | Train Loss: 1.8133 | Train Acc: 0.9052
 Site-Sketch    | Train Loss: 1.8638 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.9509 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.9535 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8479 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8264 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.8967 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9612 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.2296 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8649 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9662 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0198 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 1.9545 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2652 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.7879 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.8174 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.8928 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.9347 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7001
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 2.0664 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8344 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.9474 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.9070 | Train Acc: 0.7164
 Site-Clipart   | Train Loss: 1.8610 | Train Acc: 0.7738
 Site-Infograph | Train Loss: 2.1631 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.9226 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9431 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.9427 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.8492 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2148 | Train Acc: 0.1458
 Site-Real      | Train Loss: 1.8365 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.7914 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.8945 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.9764 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.9511 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8714 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8280 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.8979 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9724 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 2.2680 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8151 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9452 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9786 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.9215 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2601 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.7844 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.7983 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.8083 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.9171 | Val  Acc: 0.6739
Average Valid Accuracy: 0.6938
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 2.0201 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.7977 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.9690 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.8306 | Train Acc: 0.7164
 Site-Clipart   | Train Loss: 1.8405 | Train Acc: 0.7738
 Site-Infograph | Train Loss: 2.1828 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8749 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9051 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.9648 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.8591 | Train Acc: 0.7447
 Site-QuickDraw | Train Loss: 2.2329 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.8154 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.7961 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.8735 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.9041 | Train Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.9118 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8394 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.8270 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.9040 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 1.9516 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.2147 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8149 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9343 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9927 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.9623 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2674 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.7438 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7702 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.8303 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.9208 | Val  Acc: 0.6739
Average Valid Accuracy: 0.6824
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 2.0892 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 1.8285 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.8781 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8881 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.8240 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1542 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.8765 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9006 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.9104 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.8360 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2115 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.8337 | Train Acc: 0.7759
 Site-Real      | Train Loss: 1.7790 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.7580 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.9293 | Train Acc: 0.5857
 Site-Clipart   | Val  Loss: 1.9103 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8524 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7355 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.8855 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.9186 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2464 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.7123 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9015 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9840 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 1.9434 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2534 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.7349 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7756 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.8802 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 1.9123 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6902
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 2.0397 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.6914 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9310 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.8770 | Train Acc: 0.7313
 Site-Clipart   | Train Loss: 1.8292 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1431 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.8713 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9054 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8656 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.8119 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2088 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.7881 | Train Acc: 0.8276
 Site-Real      | Train Loss: 1.7624 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.8166 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.9258 | Train Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.8804 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8374 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7591 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8406 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9302 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2392 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.7740 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8950 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0096 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9436 | Val  Acc: 0.6774
 Site-QuickDraw | Val  Loss: 2.2523 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.7043 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.7573 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.7902 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8989 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6924
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 1.9965 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.5670 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.7754 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.8223 | Train Acc: 0.7164
 Site-Clipart   | Train Loss: 1.7523 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1683 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8831 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.8714 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8298 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7987 | Train Acc: 0.8085
 Site-QuickDraw | Train Loss: 2.2131 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.7899 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.7314 | Train Acc: 0.9138
 Site-Sketch    | Train Loss: 1.8960 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.8813 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.9247 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8128 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7587 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.8394 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.9265 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2470 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.7605 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8864 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9529 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8798 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2658 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6969 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7378 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.7913 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.8986 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7186
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7045
 Best site-Clipart    | Epoch:30 | Val Acc: 0.6786
 Best site-Infograph  | Epoch:30 | Val Acc: 0.4000
 Best site-Painting   | Epoch:30 | Val Acc: 1.0000
 Best site-Painting   | Epoch:30 | Val Acc: 0.8000
 Best site-Painting   | Epoch:30 | Val Acc: 0.6522
 Best site-Painting   | Epoch:30 | Val Acc: 0.7419
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.1250
 Best site-Real       | Epoch:30 | Val Acc: 0.9737
 Best site-Real       | Epoch:30 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:30 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:30 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 1.9572 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.8315 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.8444 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.8612 | Train Acc: 0.7164
 Site-Clipart   | Train Loss: 1.8257 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.1650 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8264 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8687 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.8245 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7894 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.2054 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.7600 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.7052 | Train Acc: 0.9052
 Site-Sketch    | Train Loss: 1.8928 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.8939 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8557 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7990 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.7577 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8424 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 1.8813 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.2321 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.7045 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8815 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9181 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.9043 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2629 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6963 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.7158 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.7867 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.8740 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7131
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 1.9859 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8428 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9424 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8281 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.8176 | Train Acc: 0.8214
 Site-Infograph | Train Loss: 2.1426 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8904 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8511 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.9411 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7453 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2050 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.7422 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.6905 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.8197 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.8728 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8520 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8085 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7262 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7925 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8925 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.1924 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.7677 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8530 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.9388 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8945 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2562 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.6490 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7075 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.7480 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.8610 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7108
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 1.9801 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.4995 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.8682 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.8234 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.7725 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1442 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.7641 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7842 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8993 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7647 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2085 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7481 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.6785 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.7894 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.8389 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.8902 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.7733 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6996 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7725 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8577 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2358 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.6980 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8416 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9162 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8611 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2526 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.6689 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6840 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.7365 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8597 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7195
 Best site-Clipart    | Epoch:33 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:33 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:33 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:33 | Val Acc: 0.3500
 Best site-Painting   | Epoch:33 | Val Acc: 1.0000
 Best site-Painting   | Epoch:33 | Val Acc: 0.8000
 Best site-Painting   | Epoch:33 | Val Acc: 0.6957
 Best site-Painting   | Epoch:33 | Val Acc: 0.7419
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.0938
 Best site-Real       | Epoch:33 | Val Acc: 1.0000
 Best site-Real       | Epoch:33 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:33 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:33 | Val Acc: 0.7174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.9565 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.7410 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.8215 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7823 | Train Acc: 0.7313
 Site-Clipart   | Train Loss: 1.7631 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1525 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.7986 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.8401 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.8088 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 1.7510 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2062 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.7270 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.6593 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.8387 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.8495 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.8449 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8015 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.6999 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.8026 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8850 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.1901 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5796 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8562 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.8995 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8568 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2503 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.6427 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6635 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.7382 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.8329 | Val  Acc: 0.6739
Average Valid Accuracy: 0.7159
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 1.9545 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.6270 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.7600 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7890 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.7722 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1598 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.7234 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7679 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8404 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 1.7273 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1993 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.6964 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.6696 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 1.7388 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.8557 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.8795 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7444 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.6712 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7690 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.8614 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2292 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6410 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.7964 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9146 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8541 | Val  Acc: 0.6774
 Site-QuickDraw | Val  Loss: 2.2480 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 1.6243 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6551 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.7259 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8201 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7041
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 1.9716 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.6095 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 1.9129 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7345 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.7325 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1604 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8103 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.8008 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.8861 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.7455 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1826 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.6870 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.6402 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.7828 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.8123 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8169 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7933 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6579 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7558 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8649 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.2411 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6773 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8184 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.8806 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.8618 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2347 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6057 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6487 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.7402 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.8164 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7019
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 1.9523 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.5314 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.8121 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8027 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.7101 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 2.1573 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.7719 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8525 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.8160 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 1.7447 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1955 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.6662 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.6313 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.7738 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.8255 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.8209 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7379 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6796 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7660 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8687 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.2278 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6574 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8435 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 1.8366 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 1.8126 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2383 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.6009 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6457 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.7184 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.7959 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7120
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 1.9449 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.8554 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.7938 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7392 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.7273 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1327 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.7113 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.7519 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8509 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 1.7054 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1746 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.6902 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.6261 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 1.8362 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.7899 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.7788 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.7003 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.6434 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7964 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.8460 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 2.1747 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6843 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.7730 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8143 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8461 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2613 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.5597 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6168 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.7026 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8371 | Val  Acc: 0.6739
Average Valid Accuracy: 0.7296
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:38 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:38 | Val Acc: 0.7045
 Best site-Clipart    | Epoch:38 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:38 | Val Acc: 0.3000
 Best site-Painting   | Epoch:38 | Val Acc: 0.8571
 Best site-Painting   | Epoch:38 | Val Acc: 0.8000
 Best site-Painting   | Epoch:38 | Val Acc: 0.6957
 Best site-Painting   | Epoch:38 | Val Acc: 0.7097
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.0938
 Best site-Real       | Epoch:38 | Val Acc: 1.0000
 Best site-Real       | Epoch:38 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:38 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:38 | Val Acc: 0.6739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.8851 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.6706 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.8147 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.7407 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.6940 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1478 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.7441 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6913 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8992 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7107 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1893 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.6439 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.5959 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.6652 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.7928 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.7479 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.7288 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5802 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7092 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.8329 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2478 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6360 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7901 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8579 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.8132 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2408 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.5563 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.6077 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.6980 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8135 | Val  Acc: 0.6739
Average Valid Accuracy: 0.7313
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:39 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:39 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:39 | Val Acc: 0.3000
 Best site-Painting   | Epoch:39 | Val Acc: 1.0000
 Best site-Painting   | Epoch:39 | Val Acc: 0.7333
 Best site-Painting   | Epoch:39 | Val Acc: 0.6087
 Best site-Painting   | Epoch:39 | Val Acc: 0.7742
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.1250
 Best site-Real       | Epoch:39 | Val Acc: 0.9737
 Best site-Real       | Epoch:39 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:39 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:39 | Val Acc: 0.6739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.7795
 Test site-Infograph | Epoch:39 | Test Acc: 0.4003
 Test site-Painting  | Epoch:39 | Test Acc: 0.8110
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.2530
 Test site-Real      | Epoch:39 | Test Acc: 0.9302
 Test site-Sketch    | Epoch:39 | Test Acc: 0.7599
Average Test Accuracy: 0.6556
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 1.9156 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.3932 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.7212 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7190 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 1.6951 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1604 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.7876 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.7338 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8517 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.6681 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1910 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.6250 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.6163 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.7421 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.7673 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.8017 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.6790 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.6106 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7109 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8270 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 2.2053 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.6053 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7666 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8798 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.7684 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 2.2370 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.5419 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.5837 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.7077 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.7576 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7384
 Best site-Clipart    | Epoch:40 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:40 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:40 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:40 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:40 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:40 | Val Acc: 0.3500
 Best site-Painting   | Epoch:40 | Val Acc: 1.0000
 Best site-Painting   | Epoch:40 | Val Acc: 0.8000
 Best site-Painting   | Epoch:40 | Val Acc: 0.6087
 Best site-Painting   | Epoch:40 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:40 | Val Acc: 0.1562
 Best site-Real       | Epoch:40 | Val Acc: 0.9737
 Best site-Real       | Epoch:40 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:40 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:40 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 1.9345 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.7534 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9130 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.6415 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.6546 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1258 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.7200 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7740 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.7294 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.6445 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.1846 | Train Acc: 0.2708
 Site-Real      | Train Loss: 1.6224 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.5718 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 1.5821 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.7649 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.7839 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.6788 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6109 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7385 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.7826 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2233 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.5793 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7569 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8661 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.7867 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2314 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.5312 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.5695 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.6415 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7667 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7168
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 1.9114 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.4956 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.7528 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 1.7083 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 1.6564 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 2.1377 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.6994 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7220 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.7779 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.6806 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.1783 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.6011 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.5609 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 1.7840 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.7616 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.7833 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7251 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.5940 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6887 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.8420 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.1552 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 1.5894 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7684 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8089 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 1.7903 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2298 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.5053 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.5720 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.6951 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.7773 | Val  Acc: 0.6739
Average Valid Accuracy: 0.7277
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 1.9219 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.6142 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.6792 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 1.7403 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 1.6345 | Train Acc: 0.7738
 Site-Infograph | Train Loss: 2.1426 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.6632 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6923 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.7705 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.6153 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 2.1751 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.6145 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.5222 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.6887 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 1.7838 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.7529 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6995 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5627 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.7295 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.7537 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 2.1957 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.5140 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7608 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.8099 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.7900 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2305 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.5107 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.5617 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.6152 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7781 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7391
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:43 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:43 | Val Acc: 0.3500
 Best site-Painting   | Epoch:43 | Val Acc: 1.0000
 Best site-Painting   | Epoch:43 | Val Acc: 0.6667
 Best site-Painting   | Epoch:43 | Val Acc: 0.6957
 Best site-Painting   | Epoch:43 | Val Acc: 0.8065
 Best site-QuickDraw  | Epoch:43 | Val Acc: 0.0938
 Best site-Real       | Epoch:43 | Val Acc: 1.0000
 Best site-Real       | Epoch:43 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:43 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:43 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.9256 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.4709 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.8018 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7096 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.6851 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1561 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.6964 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6855 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.7521 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.6256 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1743 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.5928 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.5606 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 1.5415 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.7535 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.7310 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.6546 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.5464 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6915 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.7995 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2364 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5739 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7322 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8386 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8066 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2197 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.5023 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.5391 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.6236 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7200 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7384
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 1.9117 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.6244 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.7790 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.6999 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.6151 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.1210 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.6825 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6389 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.6537 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.6083 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 2.1777 | Train Acc: 0.2917
 Site-Real      | Train Loss: 1.5688 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.5186 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.6313 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.7411 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.6839 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6020 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.5545 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6731 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.7667 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 2.1811 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5337 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7051 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8110 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.7894 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2255 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.4627 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.5182 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.6445 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7233 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7567
 Best site-Clipart    | Epoch:45 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:45 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:45 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:45 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:45 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:45 | Val Acc: 0.4000
 Best site-Painting   | Epoch:45 | Val Acc: 1.0000
 Best site-Painting   | Epoch:45 | Val Acc: 0.8000
 Best site-Painting   | Epoch:45 | Val Acc: 0.6522
 Best site-Painting   | Epoch:45 | Val Acc: 0.7742
 Best site-QuickDraw  | Epoch:45 | Val Acc: 0.1875
 Best site-Real       | Epoch:45 | Val Acc: 1.0000
 Best site-Real       | Epoch:45 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:45 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:45 | Val Acc: 0.7609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/drfl...
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 1.8861 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.5479 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.6935 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.6622 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 1.6055 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 2.1097 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.6893 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7345 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.7082 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.6271 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 2.1538 | Train Acc: 0.2917
 Site-Real      | Train Loss: 1.5779 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.4950 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.6603 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.6998 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.6769 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6380 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5375 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.5952 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7621 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2202 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.4603 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7168 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.8280 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.7554 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2033 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.4488 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.5122 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 1.6095 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7298 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7385
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 1.8772 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.4128 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.7564 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.6827 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 1.6077 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1195 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.6710 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.5695 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.6554 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 1.6302 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1642 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.6024 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.4796 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 1.6858 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.7536 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.6566 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.6550 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.5102 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.6775 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.7607 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 2.1827 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5250 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.7105 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8089 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 1.7876 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2220 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.4404 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.5046 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.5705 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7233 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7392
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 1.8128 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.4417 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.7570 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.6225 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 1.5454 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.1287 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.6825 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6639 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.8410 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.5950 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 2.1727 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.5427 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.5119 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 1.7057 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.6742 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.7656 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.6154 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5463 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.6217 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7493 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 2.1804 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.5265 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7139 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.7647 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 1.7351 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2147 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.4432 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.4790 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.5803 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.6888 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7379
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 1.8398 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.6323 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.7100 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.5857 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 1.5647 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 2.1124 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.5857 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6919 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.7649 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.5720 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1529 | Train Acc: 0.2917
 Site-Real      | Train Loss: 1.5562 | Train Acc: 0.8966
 Site-Real      | Train Loss: 1.4880 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.5583 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.6699 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.6301 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6455 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.4582 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.6497 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.7497 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.1589 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5065 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7126 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8104 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.6995 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2100 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.4402 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.4740 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.5785 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.7250 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7416
===2023-04-27 19:04:52===
===2023-04-27 19:04:54===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,11,23,35,47,48,58,116,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 7, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:45 | Test Acc: 0.7966
 Test site-Infograph | Epoch:45 | Test Acc: 0.4079
 Test site-Painting  | Epoch:45 | Test Acc: 0.8126
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.2790
 Test site-Real      | Epoch:45 | Test Acc: 0.9376
 Test site-Sketch    | Epoch:45 | Test Acc: 0.7690
Average Test Accuracy: 0.6671
