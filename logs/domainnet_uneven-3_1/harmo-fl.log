===2023-04-26 22:55:17===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,11,23,35,47,48,58,116,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 7, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 1.7868 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.5459 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.5882 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.5465 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 1.5538 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.0939 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.6227 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.6500 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.5847 | Train Acc: 0.6286
 Site-Painting  | Train Loss: 1.4808 | Train Acc: 0.8085
 Site-QuickDraw | Train Loss: 2.1717 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.4681 | Train Acc: 0.9310
 Site-Real      | Train Loss: 1.4183 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.6676 | Train Acc: 0.6857
 Site-Sketch    | Train Loss: 1.6149 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 1.6929 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.5213 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.4497 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.5854 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 1.7025 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.2936 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.3572 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.5470 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.6376 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 1.6656 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.1774 | Val  Acc: 0.0312
 Site-Real      | Val  Loss: 1.3234 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.4115 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.5051 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.5945 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7224
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6591
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6607
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2500
 Best site-Painting   | Epoch:0 | Val Acc: 1.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.8000
 Best site-Painting   | Epoch:0 | Val Acc: 0.7826
 Best site-Painting   | Epoch:0 | Val Acc: 0.8065
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0312
 Best site-Real       | Epoch:0 | Val Acc: 1.0000
 Best site-Real       | Epoch:0 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:0 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:0 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 1.3705 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.7092 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 1.2406 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.2433 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 1.0288 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.9939 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.0989 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.1117 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.4496 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 0.9683 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.0878 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.8968 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.7984 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 1.1416 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.1211 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 1.1790 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.1554 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.9301 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.1416 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.2395 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 2.1683 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8619 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.2074 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2420 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 1.1933 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 2.0868 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.7307 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.8383 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 1.1212 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.2126 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7972
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3500
 Best site-Painting   | Epoch:1 | Val Acc: 1.0000
 Best site-Painting   | Epoch:1 | Val Acc: 0.8000
 Best site-Painting   | Epoch:1 | Val Acc: 0.7391
 Best site-Painting   | Epoch:1 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2812
 Best site-Real       | Epoch:1 | Val Acc: 1.0000
 Best site-Real       | Epoch:1 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:1 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 0.9815 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6166 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 1.0704 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.7604 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.8288 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 1.8774 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.7598 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.0465 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 0.9589 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.7166 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.0394 | Train Acc: 0.2292
 Site-Real      | Train Loss: 0.6004 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.5542 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.9253 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.0063 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.1740 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 0.8283 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6119 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8482 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.0336 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 2.1129 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.4874 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.9194 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.1260 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.0630 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.0155 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.4297 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.5257 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.8168 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.0128 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7788
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 1.0796 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 0.5696 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.9307 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.6919 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.6702 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.9226 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 0.6733 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8874 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 0.8130 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.5799 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 2.0082 | Train Acc: 0.2292
 Site-Real      | Train Loss: 0.4571 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.3523 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.8284 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.7597 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.8337 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6309 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5092 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.8006 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.9322 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 2.1707 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3229 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7285 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9171 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 0.8393 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 2.0331 | Val  Acc: 0.2188
 Site-Real      | Val  Loss: 0.2849 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3604 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7713 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.8698 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8011
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3500
 Best site-Painting   | Epoch:3 | Val Acc: 1.0000
 Best site-Painting   | Epoch:3 | Val Acc: 0.8000
 Best site-Painting   | Epoch:3 | Val Acc: 0.6957
 Best site-Painting   | Epoch:3 | Val Acc: 0.8387
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2188
 Best site-Real       | Epoch:3 | Val Acc: 1.0000
 Best site-Real       | Epoch:3 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 0.9698 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 0.4145 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.8689 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.6375 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.6708 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.9342 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.6334 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 0.8265 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 0.7307 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.5445 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.9816 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.4012 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.2551 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.8192 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.6588 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6654 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6327 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.4123 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6344 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.7626 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.8696 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2310 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7099 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9456 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 0.8125 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.9271 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.2173 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2437 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5944 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.7589 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8053
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8864
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8393
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4000
 Best site-Painting   | Epoch:4 | Val Acc: 1.0000
 Best site-Painting   | Epoch:4 | Val Acc: 0.8000
 Best site-Painting   | Epoch:4 | Val Acc: 0.6957
 Best site-Painting   | Epoch:4 | Val Acc: 0.8387
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3125
 Best site-Real       | Epoch:4 | Val Acc: 1.0000
 Best site-Real       | Epoch:4 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 0.7913 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.3739 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.7200 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5561 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.4834 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.9139 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 0.6025 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7987 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 0.6015 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.5286 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 1.8745 | Train Acc: 0.2708
 Site-Real      | Train Loss: 0.3560 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.2189 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.6951 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 0.6690 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.5467 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4511 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3741 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5209 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.7228 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 2.1155 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2138 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7414 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8158 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 0.9038 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.9682 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.1470 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2002 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.5272 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.6132 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8175
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3500
 Best site-Painting   | Epoch:5 | Val Acc: 1.0000
 Best site-Painting   | Epoch:5 | Val Acc: 0.8000
 Best site-Painting   | Epoch:5 | Val Acc: 0.7391
 Best site-Painting   | Epoch:5 | Val Acc: 0.8387
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3438
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Real       | Epoch:5 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 0.7942 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2549 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5441 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6572 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.4763 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.9305 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.5617 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 0.7002 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.4700 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.4207 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.9663 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.2461 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.1942 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7837 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.6032 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.4811 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4752 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2990 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5078 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5521 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 2.0295 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0546 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.7521 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7006 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 0.6444 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.8928 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.1877 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.1507 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5035 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.6328 | Val  Acc: 0.8043
Average Valid Accuracy: 0.8182
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8393
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4000
 Best site-Painting   | Epoch:6 | Val Acc: 1.0000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8000
 Best site-Painting   | Epoch:6 | Val Acc: 0.7391
 Best site-Painting   | Epoch:6 | Val Acc: 0.8387
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2500
 Best site-Real       | Epoch:6 | Val Acc: 0.9737
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 0.6195 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.3115 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.7398 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.4196 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.4257 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.9418 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.5660 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 0.8687 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 0.5820 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.4679 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 1.9365 | Train Acc: 0.2708
 Site-Real      | Train Loss: 0.2480 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.1353 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6502 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.5554 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.3861 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3752 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2589 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4446 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5231 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.1316 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0760 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5656 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8382 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.4824 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.8777 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0698 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1338 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4425 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.5388 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8425
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8929
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3500
 Best site-Painting   | Epoch:7 | Val Acc: 1.0000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8000
 Best site-Painting   | Epoch:7 | Val Acc: 0.7826
 Best site-Painting   | Epoch:7 | Val Acc: 0.9355
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3125
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 0.7919 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2102 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.4600 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.3773 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.4005 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.8925 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.4947 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7487 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.7333 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.3393 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.8376 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.2519 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0943 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5174 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.4738 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4690 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3945 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2472 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3836 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5327 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.9007 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1265 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5956 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7377 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.7078 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.8329 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0530 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0854 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4749 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.5443 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8334
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 0.5758 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2553 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5142 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.3491 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.3476 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.9228 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.5272 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8667 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 0.5236 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.3582 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.7805 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.2028 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0859 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6248 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.5302 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2313 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2626 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2036 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3821 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.5135 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.8217 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1029 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6110 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7039 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.7489 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.8129 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0895 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0808 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4621 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.5681 | Val  Acc: 0.8043
Average Valid Accuracy: 0.8340
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 0.4833 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.3725 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4812 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.3697 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2883 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.7623 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3771 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8460 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.4351 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.3795 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.7680 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1931 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0646 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4575 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.5118 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3968 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3017 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2235 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3658 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5302 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.8683 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1557 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6685 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7389 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 0.6496 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 1.7480 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0397 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0630 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4148 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4664 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8295
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 0.5386 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.6654 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.6621 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.3064 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.2436 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8459 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3885 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.9062 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 0.4397 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.3345 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.7744 | Train Acc: 0.2917
 Site-Real      | Train Loss: 0.1947 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0599 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.3695 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.4067 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.3778 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1921 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1686 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3396 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5107 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.8949 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0907 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6202 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5613 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.5850 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.7240 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0654 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0567 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4180 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.5053 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8481
 Best site-Clipart    | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:11 | Val Acc: 0.4000
 Best site-Painting   | Epoch:11 | Val Acc: 1.0000
 Best site-Painting   | Epoch:11 | Val Acc: 0.8000
 Best site-Painting   | Epoch:11 | Val Acc: 0.8696
 Best site-Painting   | Epoch:11 | Val Acc: 0.8387
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.3438
 Best site-Real       | Epoch:11 | Val Acc: 1.0000
 Best site-Real       | Epoch:11 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:11 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:11 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 0.5680 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.7245 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.4399 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.2655 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.2589 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.8753 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.4395 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7788 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.8982 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.3617 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.8077 | Train Acc: 0.2708
 Site-Real      | Train Loss: 0.1507 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0546 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5869 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.4553 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3093 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1828 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1759 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3315 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.5045 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 2.1238 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.1621 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6216 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5913 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.6759 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.7768 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0388 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0559 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4745 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.5160 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8324
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 0.5078 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2216 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3889 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.2467 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.2358 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.9340 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.3680 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7457 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.4994 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.2931 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.8166 | Train Acc: 0.2708
 Site-Real      | Train Loss: 0.1579 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0497 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5581 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.5206 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.3066 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2663 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1452 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3465 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4408 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 2.1805 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0333 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5693 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6401 | Val  Acc: 0.8261
 Site-Painting  | Val  Loss: 0.4942 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.7368 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0284 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0411 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3251 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.4813 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8472
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 0.5203 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2054 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4292 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.3806 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.2487 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.8463 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.4138 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 0.7102 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.4694 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.3586 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 1.7517 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1575 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0407 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5246 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.4114 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.2168 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2518 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1629 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2897 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5276 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.9817 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1022 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4652 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4942 | Val  Acc: 0.8261
 Site-Painting  | Val  Loss: 0.5847 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.7691 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0366 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0262 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4134 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.4749 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8481
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 0.6260 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2705 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3776 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3133 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2595 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.9555 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3263 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5879 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.4972 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.2773 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.6586 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1385 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0356 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.9532 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.4828 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1570 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2828 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1673 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2834 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4781 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 2.2224 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0559 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5822 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6352 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 0.5726 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.6600 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0185 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0406 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3598 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4741 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8472
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 0.5474 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1791 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3503 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.3342 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1937 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9359 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.1828 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7718 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.6541 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.3564 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 1.6870 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1424 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0363 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3699 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.3909 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.2504 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1441 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1468 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2563 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4186 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.8655 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0104 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4247 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5443 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.5487 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.7100 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0124 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3416 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4398 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8618
 Best site-Clipart    | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:16 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4500
 Best site-Painting   | Epoch:16 | Val Acc: 1.0000
 Best site-Painting   | Epoch:16 | Val Acc: 0.8000
 Best site-Painting   | Epoch:16 | Val Acc: 0.7826
 Best site-Painting   | Epoch:16 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.4375
 Best site-Real       | Epoch:16 | Val Acc: 1.0000
 Best site-Real       | Epoch:16 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:16 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 0.4568 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2429 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.7327 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.2393 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1710 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9170 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3123 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6035 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.3440 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.3139 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.7386 | Train Acc: 0.2917
 Site-Real      | Train Loss: 0.1252 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0331 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7348 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.4264 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.2970 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1588 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1333 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2425 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4000 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.8884 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0661 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4419 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6926 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 0.5542 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 1.7603 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0331 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3716 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4057 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8461
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 0.6227 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.1567 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4016 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.2312 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.2017 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9368 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3949 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 0.7654 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.7106 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.2172 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.7208 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.1219 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0361 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3330 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.3692 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.2078 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1368 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1360 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2128 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3812 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.8417 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0124 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5458 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4128 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.5111 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.8453 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0133 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0223 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2850 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3750 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8643
 Best site-Clipart    | Epoch:18 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:18 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:18 | Val Acc: 0.4500
 Best site-Painting   | Epoch:18 | Val Acc: 1.0000
 Best site-Painting   | Epoch:18 | Val Acc: 0.8000
 Best site-Painting   | Epoch:18 | Val Acc: 0.8696
 Best site-Painting   | Epoch:18 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.3438
 Best site-Real       | Epoch:18 | Val Acc: 1.0000
 Best site-Real       | Epoch:18 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:18 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.5203 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1572 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5492 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.2160 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1702 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8821 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.4078 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5827 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.4540 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.2327 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.7431 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.1251 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0205 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3575 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.3392 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.1947 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1665 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1358 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2541 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4467 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.9452 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4102 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5418 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.4560 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.7485 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0210 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3482 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4322 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8573
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 0.3568 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1650 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3578 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.2234 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1632 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9577 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2426 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4919 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.3913 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2626 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.6601 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1327 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0248 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5176 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.3735 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.3849 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1476 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1639 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2610 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3904 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.8341 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0104 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4375 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5496 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.4648 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6046 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0234 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3041 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4106 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8572
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 0.3163 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2105 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3015 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2140 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1408 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8992 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.3059 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.9217 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.3883 | Train Acc: 0.9429
 Site-Painting  | Train Loss: 0.2884 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.7062 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.1098 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0142 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6074 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.3829 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.2724 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1141 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1370 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2494 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3382 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8929 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1134 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3659 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.4299 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.5018 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6408 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0106 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0161 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2855 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4005 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8654
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:21 | Val Acc: 0.4000
 Best site-Painting   | Epoch:21 | Val Acc: 1.0000
 Best site-Painting   | Epoch:21 | Val Acc: 0.8667
 Best site-Painting   | Epoch:21 | Val Acc: 0.8696
 Best site-Painting   | Epoch:21 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.3125
 Best site-Real       | Epoch:21 | Val Acc: 1.0000
 Best site-Real       | Epoch:21 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:21 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.4411 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.7440 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4368 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.2155 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1834 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 2.0988 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.2542 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.0156 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.3858 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.3815 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 1.5807 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.1076 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0164 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3579 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.3384 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1140 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1482 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1409 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2444 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4242 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.8888 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3491 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6088 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.5440 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.4875 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0150 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3410 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3892 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8540
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.4597 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1161 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3272 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3143 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.2150 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 2.0762 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3336 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6472 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.3543 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2505 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.5597 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0885 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0174 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5890 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.3685 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1391 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2248 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1072 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1966 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3204 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.9132 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0968 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3558 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5294 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 0.4156 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.6113 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0070 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3164 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3132 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8593
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.6136 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1279 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4475 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1784 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1413 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9169 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.3609 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 0.5950 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.3058 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2539 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.5750 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.0832 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0177 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2614 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3636 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0986 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1081 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1211 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2522 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2923 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.0444 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0495 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3826 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.5479 | Val  Acc: 0.8261
 Site-Painting  | Val  Loss: 0.4432 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6684 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2924 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3286 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8700
 Best site-Clipart    | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8929
 Best site-Infograph  | Epoch:24 | Val Acc: 0.4500
 Best site-Painting   | Epoch:24 | Val Acc: 1.0000
 Best site-Painting   | Epoch:24 | Val Acc: 0.8667
 Best site-Painting   | Epoch:24 | Val Acc: 0.8261
 Best site-Painting   | Epoch:24 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.4062
 Best site-Real       | Epoch:24 | Val Acc: 1.0000
 Best site-Real       | Epoch:24 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:24 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:24 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.3069 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1067 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3498 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.1704 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1842 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.9295 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 0.3345 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5925 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.2609 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.3137 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.6857 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.0849 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0118 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6365 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.3531 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.2267 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1176 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1406 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1855 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3244 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.0718 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0082 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3843 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.3930 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.4245 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.4841 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2259 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3697 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8642
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.5701 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1562 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2743 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.1705 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1168 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9270 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.2947 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5503 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.3429 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2091 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.6324 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.0937 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0173 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4649 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.3123 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1832 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1088 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1178 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1862 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3479 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.8105 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3359 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.5043 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.3828 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.6629 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0102 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2642 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3444 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8741
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:26 | Val Acc: 0.4000
 Best site-Painting   | Epoch:26 | Val Acc: 1.0000
 Best site-Painting   | Epoch:26 | Val Acc: 0.9333
 Best site-Painting   | Epoch:26 | Val Acc: 0.8696
 Best site-Painting   | Epoch:26 | Val Acc: 0.9032
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.3125
 Best site-Real       | Epoch:26 | Val Acc: 1.0000
 Best site-Real       | Epoch:26 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:26 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:26 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.2889 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1535 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.2455 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1405 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1119 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9498 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2065 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5642 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.5225 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2824 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.5105 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.0902 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0119 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6073 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3155 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1839 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0851 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0984 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2243 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3036 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.8589 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4124 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.5156 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.3875 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.7023 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0123 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2252 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3860 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8708
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.3163 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2817 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4144 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1660 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1147 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9830 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3143 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6214 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 0.4763 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2575 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.5177 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0992 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0169 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4284 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.2727 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.1012 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1083 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1981 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3355 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.8573 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0545 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4789 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4076 | Val  Acc: 0.8261
 Site-Painting  | Val  Loss: 0.4198 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.5159 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0064 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3029 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3375 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8649
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.3265 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0970 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2777 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2024 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1098 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9823 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2927 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 0.6979 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.3250 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.2585 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.4593 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.1059 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0078 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3337 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.3633 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0589 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0724 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0941 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2258 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3772 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 2.1521 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0398 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3164 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.5023 | Val  Acc: 0.8261
 Site-Painting  | Val  Loss: 0.4414 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6011 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2713 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2659 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8707
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.2595 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1625 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3900 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1903 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1159 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9635 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.4501 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5427 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.3736 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2537 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.5016 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0931 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0132 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7655 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.2806 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.1817 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0667 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1058 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1697 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2575 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.7660 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3301 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.3811 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.4360 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6310 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2403 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3661 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8808
 Best site-Clipart    | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:30 | Val Acc: 0.4500
 Best site-Painting   | Epoch:30 | Val Acc: 1.0000
 Best site-Painting   | Epoch:30 | Val Acc: 0.9333
 Best site-Painting   | Epoch:30 | Val Acc: 0.8696
 Best site-Painting   | Epoch:30 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.3125
 Best site-Real       | Epoch:30 | Val Acc: 1.0000
 Best site-Real       | Epoch:30 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:30 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:30 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.3897 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1431 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4359 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1410 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1516 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9379 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.1576 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4764 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.4715 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.1905 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.4779 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1154 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2756 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.2951 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0826 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0465 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1037 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1429 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2718 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.7428 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0378 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2375 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5144 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.3531 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.5631 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3010 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3752 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8886
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:31 | Val Acc: 0.4500
 Best site-Painting   | Epoch:31 | Val Acc: 1.0000
 Best site-Painting   | Epoch:31 | Val Acc: 1.0000
 Best site-Painting   | Epoch:31 | Val Acc: 0.7826
 Best site-Painting   | Epoch:31 | Val Acc: 0.9355
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.4688
 Best site-Real       | Epoch:31 | Val Acc: 1.0000
 Best site-Real       | Epoch:31 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:31 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:31 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.3439 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1041 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2344 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1406 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1104 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9146 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2581 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5541 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.2647 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2409 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4950 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0933 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0085 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4176 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.3297 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2094 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1146 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1318 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1848 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3239 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.9111 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0978 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2705 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2843 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.4065 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.5926 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2962 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3019 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8849
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.3141 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1045 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2210 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2545 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1166 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8668 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2411 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7442 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.3064 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2048 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.5470 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.0665 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0072 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2877 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.3199 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.1506 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0543 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1174 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1768 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3104 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.7640 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2223 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4190 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.3983 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.4922 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2215 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3352 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8858
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.3617 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1190 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2218 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2059 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.0934 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8943 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2908 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5509 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.3721 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.3259 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 1.5169 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.0671 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0117 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3189 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.3146 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0857 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1076 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1278 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3040 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.7509 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0264 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4282 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.3217 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.3866 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.5879 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2905 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2993 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8729
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.2669 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0891 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2819 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1466 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0875 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7861 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.2169 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5377 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.2397 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.1687 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4491 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0709 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0057 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2758 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2783 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.1171 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0915 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1561 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2794 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 2.0092 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.1283 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2745 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3732 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.4239 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.6450 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1972 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2529 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8847
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.2966 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1286 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2938 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1989 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1476 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9193 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2623 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5521 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.2413 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2630 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.4375 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.1025 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0061 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4343 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2310 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.1268 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0498 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0855 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1850 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2836 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8741 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0382 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2893 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.3538 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.4639 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.5232 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1965 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3169 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8898
 Best site-Clipart    | Epoch:36 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:36 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:36 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:36 | Val Acc: 0.4000
 Best site-Painting   | Epoch:36 | Val Acc: 1.0000
 Best site-Painting   | Epoch:36 | Val Acc: 0.9333
 Best site-Painting   | Epoch:36 | Val Acc: 0.9130
 Best site-Painting   | Epoch:36 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.4375
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:36 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:36 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.4028 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1136 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5445 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.2984 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1140 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8803 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.2854 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6500 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.4002 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.1912 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.3050 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0648 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3907 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2883 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1435 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0719 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1023 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1732 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2788 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.9191 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3380 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.3621 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.3610 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.3605 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2780 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.2373 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8799
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.4225 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1157 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2655 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1165 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1064 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0240 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.3065 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5577 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.3999 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.2567 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4562 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0723 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0080 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4113 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2943 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1316 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1000 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0897 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1518 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2671 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.6882 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.1242 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4248 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.3887 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.3852 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.5723 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2452 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3174 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8860
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4960 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1175 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3026 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1412 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1341 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8145 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.2522 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4472 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.7747 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.1693 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4058 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.0616 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0049 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3262 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.2618 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.1254 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0595 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0831 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1473 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3057 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.6242 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3024 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.2526 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3228 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.5223 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2024 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2409 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9000
 Best site-Clipart    | Epoch:39 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:39 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:39 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8929
 Best site-Infograph  | Epoch:39 | Val Acc: 0.4000
 Best site-Painting   | Epoch:39 | Val Acc: 1.0000
 Best site-Painting   | Epoch:39 | Val Acc: 0.9333
 Best site-Painting   | Epoch:39 | Val Acc: 1.0000
 Best site-Painting   | Epoch:39 | Val Acc: 0.9032
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.4375
 Best site-Real       | Epoch:39 | Val Acc: 1.0000
 Best site-Real       | Epoch:39 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:39 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:39 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8878
 Test site-Infograph | Epoch:39 | Test Acc: 0.4855
 Test site-Painting  | Epoch:39 | Test Acc: 0.8869
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.5010
 Test site-Real      | Epoch:39 | Test Acc: 0.9663
 Test site-Sketch    | Epoch:39 | Test Acc: 0.8520
Average Test Accuracy: 0.7633
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.3501 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1015 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3692 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1316 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0876 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8640 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2069 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.3793 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.4616 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.1702 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4408 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0668 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2833 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2603 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0903 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0445 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0795 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1581 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3121 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.8097 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.0348 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4033 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.4311 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.2824 | Val  Acc: 0.9677
 Site-QuickDraw | Val  Loss: 1.6446 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2918 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3394 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8810
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.4474 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1044 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2884 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.1545 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0970 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8967 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2292 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5982 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.2033 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2391 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.5124 | Train Acc: 0.4583
 Site-Real      | Train Loss: 0.0669 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0044 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4211 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3854 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.1042 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1528 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0976 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1582 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2486 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8599 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2015 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4187 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.3748 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.5388 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2841 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3028 | Val  Acc: 0.9130
Average Valid Accuracy: 0.9016
 Best site-Clipart    | Epoch:41 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:41 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:41 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:41 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:41 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:41 | Val Acc: 0.5000
 Best site-Painting   | Epoch:41 | Val Acc: 1.0000
 Best site-Painting   | Epoch:41 | Val Acc: 1.0000
 Best site-Painting   | Epoch:41 | Val Acc: 0.9130
 Best site-Painting   | Epoch:41 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:41 | Val Acc: 0.4688
 Best site-Real       | Epoch:41 | Val Acc: 1.0000
 Best site-Real       | Epoch:41 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:41 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:41 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.3370 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1088 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2799 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.2152 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1695 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8567 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2194 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4780 | Train Acc: 0.8696
 Site-Painting  | Train Loss: 0.3203 | Train Acc: 0.9429
 Site-Painting  | Train Loss: 0.1510 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.5129 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0678 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4746 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.2875 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1124 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0472 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0815 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1227 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3158 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.7788 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3349 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.4132 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.3187 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.6233 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2747 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2796 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8768
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.3483 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0782 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1947 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2053 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1153 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 2.1375 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3070 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5299 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.3094 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2638 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.4140 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0583 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3589 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2754 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.1865 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2003 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.0882 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1541 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3175 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.7209 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0454 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4065 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.3299 | Val  Acc: 0.9565
 Site-Painting  | Val  Loss: 0.3683 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.5432 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1869 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3073 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8785
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2961 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1059 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.5070 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.1442 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1222 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9658 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3781 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4580 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.4683 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.1813 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4749 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.0733 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3881 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2385 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0953 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0628 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1086 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1279 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2592 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.7153 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3566 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.2994 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.2180 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.4478 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2518 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3087 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8976
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.3222 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0969 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2771 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1737 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0873 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9057 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2035 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.3681 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.4563 | Train Acc: 0.9429
 Site-Painting  | Train Loss: 0.2635 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.5404 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.0626 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0135 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.7530 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2258 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1709 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0495 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0944 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1552 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2764 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7758 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0415 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2870 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.3226 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.3382 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.5836 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1617 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2607 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8856
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.3004 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1363 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3028 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1785 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0942 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8906 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.4176 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 0.5816 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.7720 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2125 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.5774 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.0677 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2871 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2365 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0612 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0957 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0723 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1718 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2753 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7858 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2019 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2833 | Val  Acc: 0.9565
 Site-Painting  | Val  Loss: 0.2905 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.4973 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2155 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2826 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8929
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.2936 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0703 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4454 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1072 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1043 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9674 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2514 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6016 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.3606 | Train Acc: 0.9429
 Site-Painting  | Train Loss: 0.2331 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.7020 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.0499 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0054 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4240 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.2387 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0957 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0383 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1117 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1953 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2803 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.7897 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2392 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3210 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.3269 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.6545 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2428 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3060 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8763
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.3365 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1444 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2216 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1395 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0723 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8590 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.2547 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8766 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.1642 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1871 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4897 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0626 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3132 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2628 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.1917 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0527 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0795 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1651 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2576 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.6555 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0600 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2108 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4569 | Val  Acc: 0.8261
 Site-Painting  | Val  Loss: 0.3225 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6012 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2132 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3028 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8737
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2554 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0717 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1863 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1214 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0704 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7845 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.2266 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6214 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.3316 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.1926 | Train Acc: 0.9787
 Site-QuickDraw | Train Loss: 1.3118 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.0636 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0042 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4201 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2339 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0325 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0366 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1006 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1181 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2713 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.6997 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4165 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.2447 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2568 | Val  Acc: 0.9677
 Site-QuickDraw | Val  Loss: 1.4496 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1756 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3075 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8982
===2023-04-26 23:44:53===
===2023-04-26 23:44:55===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,11,23,35,47,48,58,116,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 7, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:41 | Test Acc: 0.8897
 Test site-Infograph | Epoch:41 | Test Acc: 0.4871
 Test site-Painting  | Epoch:41 | Test Acc: 0.8837
 Test site-QuickDraw | Epoch:41 | Test Acc: 0.4960
 Test site-Real      | Epoch:41 | Test Acc: 0.9663
 Test site-Sketch    | Epoch:41 | Test Acc: 0.8538
Average Test Accuracy: 0.7628
===2023-04-27 15:27:40===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,11,23,35,47,48,58,116,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 7, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 1.7770 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 1.1507 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.6226 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.5510 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 1.5105 | Train Acc: 0.7381
 Site-Infograph | Train Loss: 2.0872 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.5356 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6048 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.7070 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.4836 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.1768 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.4502 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.3331 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 1.4300 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.5861 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.6347 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.4866 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.3890 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5665 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.6157 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.1391 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.3838 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.5775 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.6777 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 1.6740 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2232 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.3174 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.3521 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.5120 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.5842 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7432
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3500
 Best site-Painting   | Epoch:0 | Val Acc: 1.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.8000
 Best site-Painting   | Epoch:0 | Val Acc: 0.7826
 Best site-Painting   | Epoch:0 | Val Acc: 0.8065
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0938
 Best site-Real       | Epoch:0 | Val Acc: 1.0000
 Best site-Real       | Epoch:0 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:0 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:0 | Val Acc: 0.8043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 1.2819 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.3202 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.1167 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 1.0656 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 1.0493 | Train Acc: 0.8214
 Site-Infograph | Train Loss: 2.0170 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.9702 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.1390 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.3428 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 1.0102 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 2.1182 | Train Acc: 0.2292
 Site-Real      | Train Loss: 0.8952 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.7661 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 1.0462 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 1.1671 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.1501 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 0.9870 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8175 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 1.1327 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.2236 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 2.0710 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.7131 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.1492 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.2601 | Val  Acc: 0.8261
 Site-Painting  | Val  Loss: 1.3491 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.1719 | Val  Acc: 0.2188
 Site-Real      | Val  Loss: 0.8000 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.7854 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.1339 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.1596 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7973
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4000
 Best site-Painting   | Epoch:1 | Val Acc: 1.0000
 Best site-Painting   | Epoch:1 | Val Acc: 0.8000
 Best site-Painting   | Epoch:1 | Val Acc: 0.8261
 Best site-Painting   | Epoch:1 | Val Acc: 0.7742
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2188
 Best site-Real       | Epoch:1 | Val Acc: 1.0000
 Best site-Real       | Epoch:1 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:1 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:1 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 1.0721 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.5312 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 1.0466 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.8993 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.7417 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.9375 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.6742 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.9399 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.1204 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.7552 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.0019 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.5939 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.4552 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.9179 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.8654 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 0.9719 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7622 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5848 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.8224 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.9457 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.8529 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4477 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.8691 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.0546 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 0.8828 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 2.0826 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.3970 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4632 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.8300 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.9671 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7923
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 1.0130 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 0.5254 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 1.0130 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.7298 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.6266 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.9115 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.5778 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.9208 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.7354 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.6708 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.0158 | Train Acc: 0.2917
 Site-Real      | Train Loss: 0.4304 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.3043 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.8343 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.7745 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 0.7804 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4590 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4269 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6961 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.9095 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.9043 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3376 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.8452 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.9809 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.0018 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 1.9710 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.2468 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3098 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.7429 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 0.8302 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7920
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.0143 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.5448 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 1.1281 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.5198 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.5875 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.8866 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.5832 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8065 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 0.7810 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 0.4025 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.8914 | Train Acc: 0.2917
 Site-Real      | Train Loss: 0.3724 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.2162 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.4907 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 0.6269 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6504 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4744 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3503 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5660 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.8096 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 2.0049 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1827 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6764 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8124 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 0.8598 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 1.9952 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.1670 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2189 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6338 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.6933 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8227
 Best site-Clipart    | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4000
 Best site-Painting   | Epoch:4 | Val Acc: 1.0000
 Best site-Painting   | Epoch:4 | Val Acc: 0.8000
 Best site-Painting   | Epoch:4 | Val Acc: 0.6957
 Best site-Painting   | Epoch:4 | Val Acc: 0.8065
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2500
 Best site-Real       | Epoch:4 | Val Acc: 1.0000
 Best site-Real       | Epoch:4 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 0.7761 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.4140 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.9905 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6182 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.4460 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.9413 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.5198 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8877 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.8592 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.4008 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.8144 | Train Acc: 0.4167
 Site-Real      | Train Loss: 0.3242 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.1824 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.5305 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.5887 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3897 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3326 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3311 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.5400 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6816 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.7912 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1657 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6172 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8696 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.6853 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.9032 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.1412 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1670 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5289 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.6023 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8366
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4000
 Best site-Painting   | Epoch:5 | Val Acc: 1.0000
 Best site-Painting   | Epoch:5 | Val Acc: 0.8000
 Best site-Painting   | Epoch:5 | Val Acc: 0.7826
 Best site-Painting   | Epoch:5 | Val Acc: 0.9032
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3750
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 0.8966 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.3096 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5806 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.3869 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.4282 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.8812 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.4676 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7784 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.4610 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.4884 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.8296 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.2953 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.1451 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.4743 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.6379 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.3693 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2683 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2528 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5248 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.6953 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.9209 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0721 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6517 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.8452 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 0.7233 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.7853 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0794 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1330 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5231 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.5584 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8443
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8393
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4000
 Best site-Painting   | Epoch:6 | Val Acc: 1.0000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8000
 Best site-Painting   | Epoch:6 | Val Acc: 0.7391
 Best site-Painting   | Epoch:6 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3750
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 0.5635 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2887 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.6931 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.4274 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.3059 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.9325 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3006 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7373 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.8390 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 0.3667 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.7705 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.2761 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0959 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7900 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 0.5814 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.4296 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2611 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2763 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4253 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5230 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.8787 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0516 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5858 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7931 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 0.5204 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.8140 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0657 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1107 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5114 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.5320 | Val  Acc: 0.8478
Average Valid Accuracy: 0.8412
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 0.5599 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.5398 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5291 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.3098 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.2898 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.9407 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.4437 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8864 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 0.4594 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.4516 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 1.7056 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.2346 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0804 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5708 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.4342 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4265 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2488 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2153 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3209 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.5930 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.7561 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.0374 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6129 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6564 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 0.5497 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.8395 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0780 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4610 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.5676 | Val  Acc: 0.8043
Average Valid Accuracy: 0.8412
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 0.7525 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 0.2475 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.6349 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.3213 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.2987 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9734 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.4309 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7295 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 0.7487 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 0.3877 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 1.7336 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.1842 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0664 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3592 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.5007 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.4390 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3118 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2252 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3524 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.4936 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7986 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.1589 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5416 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.7442 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 0.6249 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.8237 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0355 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0674 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3826 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.4988 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8442
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 0.5192 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2672 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.7527 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.3682 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2493 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.8548 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.4254 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6691 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.5003 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.3977 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.6348 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1927 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0596 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3756 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.4664 | Train Acc: 0.8429
 Site-Clipart   | Val  Loss: 0.2568 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1846 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2493 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3080 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5132 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.7827 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0231 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5516 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6478 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 0.5777 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.7454 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0278 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0558 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3749 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4730 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8512
 Best site-Clipart    | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:10 | Val Acc: 0.4500
 Best site-Painting   | Epoch:10 | Val Acc: 1.0000
 Best site-Painting   | Epoch:10 | Val Acc: 0.8000
 Best site-Painting   | Epoch:10 | Val Acc: 0.7391
 Best site-Painting   | Epoch:10 | Val Acc: 0.9032
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.2812
 Best site-Real       | Epoch:10 | Val Acc: 1.0000
 Best site-Real       | Epoch:10 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:10 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:10 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 0.5899 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.4464 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.6281 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.3240 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.2207 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9033 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.5349 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 0.6616 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.4250 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.4058 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.6596 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.1667 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0515 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2832 | Train Acc: 0.9714
 Site-Sketch    | Train Loss: 0.4056 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.2711 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2076 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1795 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3237 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.5153 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.8316 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0510 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5744 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5528 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.6325 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.8068 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0260 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0510 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3889 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 0.4077 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8572
 Best site-Clipart    | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8929
 Best site-Infograph  | Epoch:11 | Val Acc: 0.4500
 Best site-Painting   | Epoch:11 | Val Acc: 1.0000
 Best site-Painting   | Epoch:11 | Val Acc: 0.8000
 Best site-Painting   | Epoch:11 | Val Acc: 0.8696
 Best site-Painting   | Epoch:11 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2812
 Best site-Real       | Epoch:11 | Val Acc: 1.0000
 Best site-Real       | Epoch:11 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:11 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:11 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 0.4247 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2333 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5343 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3058 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2992 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.9633 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.3522 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5358 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.4317 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.3068 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.7367 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.1535 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0645 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.5252 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.3343 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.2847 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1406 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1842 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3336 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.4935 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.9178 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0227 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4813 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6110 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.5683 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.8422 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.0304 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0441 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3519 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.4682 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8461
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 0.4401 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2288 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5928 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.2469 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.2038 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8081 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.3591 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.8041 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 0.4026 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.3805 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.6310 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1413 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0421 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3507 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.4077 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2468 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1326 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1736 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2635 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3716 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.8240 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0961 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4925 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5609 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.5728 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.7919 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0495 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3642 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.4036 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8657
 Best site-Clipart    | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:13 | Val Acc: 0.4000
 Best site-Painting   | Epoch:13 | Val Acc: 1.0000
 Best site-Painting   | Epoch:13 | Val Acc: 0.8000
 Best site-Painting   | Epoch:13 | Val Acc: 0.8696
 Best site-Painting   | Epoch:13 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.3125
 Best site-Real       | Epoch:13 | Val Acc: 1.0000
 Best site-Real       | Epoch:13 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:13 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 0.5959 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.1828 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.7126 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.2725 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.1839 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9935 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2048 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5914 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.5438 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.3438 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 1.6530 | Train Acc: 0.4583
 Site-Real      | Train Loss: 0.1263 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0790 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.5308 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3965 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1761 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0818 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1606 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3175 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.4858 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 2.0299 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0177 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4883 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6094 | Val  Acc: 0.8261
 Site-Painting  | Val  Loss: 0.5326 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.7076 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0213 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0260 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2941 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4715 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8447
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 0.3989 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.9409 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3737 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.2072 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1954 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8135 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2771 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5171 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.3264 | Train Acc: 0.9429
 Site-Painting  | Train Loss: 0.3530 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 1.5184 | Train Acc: 0.4583
 Site-Real      | Train Loss: 0.1345 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0489 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.3731 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.3753 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.1821 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1179 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1498 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2137 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4115 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.9112 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4542 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.6336 | Val  Acc: 0.8261
 Site-Painting  | Val  Loss: 0.5164 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.8340 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0402 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2572 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3330 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8626
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 0.3447 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1779 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2959 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2110 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.2346 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9249 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3768 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6173 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 0.4399 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2592 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.5472 | Train Acc: 0.4583
 Site-Real      | Train Loss: 0.1303 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0216 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6380 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.4275 | Train Acc: 0.8714
 Site-Clipart   | Val  Loss: 0.1136 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1708 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1438 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3133 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3199 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 2.0283 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.0649 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4598 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5348 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.4162 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.7185 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0288 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2785 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.4027 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8650
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 0.4221 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1782 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4675 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.1965 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1686 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 2.0003 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3079 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5274 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.8966 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.2685 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.5518 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1199 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0195 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2842 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3907 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1362 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1221 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1602 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2518 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3528 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.6754 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.0212 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3692 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5839 | Val  Acc: 0.8261
 Site-Painting  | Val  Loss: 0.5304 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 1.6898 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0143 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0197 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2865 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.4112 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8579
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 0.3419 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1289 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3392 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2976 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1441 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9630 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.1647 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4964 | Train Acc: 0.8696
 Site-Painting  | Train Loss: 0.3509 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2659 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.4359 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.0970 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0168 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3683 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2875 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2142 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0748 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1552 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1621 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.4385 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7968 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.0149 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4326 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.5733 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.4597 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.6554 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0163 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2617 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.4433 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8509
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.5368 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1781 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4749 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.1866 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.1324 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8282 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.2778 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6859 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.2749 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2290 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.5332 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.1370 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0220 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3237 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2513 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.1261 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0932 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1127 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2613 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4764 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.8129 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0062 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3662 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 0.4049 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.4450 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.7455 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0116 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2491 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3268 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8683
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:19 | Val Acc: 0.4500
 Best site-Painting   | Epoch:19 | Val Acc: 1.0000
 Best site-Painting   | Epoch:19 | Val Acc: 0.8000
 Best site-Painting   | Epoch:19 | Val Acc: 0.8696
 Best site-Painting   | Epoch:19 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.3125
 Best site-Real       | Epoch:19 | Val Acc: 1.0000
 Best site-Real       | Epoch:19 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:19 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:19 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.8935
 Test site-Infograph | Epoch:19 | Test Acc: 0.4810
 Test site-Painting  | Epoch:19 | Test Acc: 0.8853
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.4880
 Test site-Real      | Epoch:19 | Test Acc: 0.9647
 Test site-Sketch    | Epoch:19 | Test Acc: 0.8574
Average Test Accuracy: 0.7616
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 0.6975 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1451 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3233 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1582 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1289 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0483 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.1478 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.6772 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.3855 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2712 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.4704 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.1327 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0147 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4409 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3146 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1350 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0827 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1116 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2171 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3252 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.6309 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3900 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.6080 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 0.3458 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.6206 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0128 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2456 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 0.3350 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8682
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 0.5519 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2999 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2990 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1590 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1186 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9553 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.2655 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5506 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.6289 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2099 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4596 | Train Acc: 0.4583
 Site-Real      | Train Loss: 0.1068 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4091 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3882 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0651 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0770 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1221 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2288 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3145 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.7061 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0307 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3649 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.4247 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.4749 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.6488 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3440 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3213 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8708
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:21 | Val Acc: 0.4000
 Best site-Painting   | Epoch:21 | Val Acc: 1.0000
 Best site-Painting   | Epoch:21 | Val Acc: 0.8667
 Best site-Painting   | Epoch:21 | Val Acc: 0.8696
 Best site-Painting   | Epoch:21 | Val Acc: 0.9032
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.3750
 Best site-Real       | Epoch:21 | Val Acc: 1.0000
 Best site-Real       | Epoch:21 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:21 | Val Acc: 0.9130
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.5234 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1231 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2432 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1472 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1412 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 2.1475 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.2808 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5403 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.7070 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2166 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4876 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.0922 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0128 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2896 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2751 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0799 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0917 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1268 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1985 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2943 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.7126 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0695 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3396 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.4158 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.4098 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.6918 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0164 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2644 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.3407 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8706
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.3159 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1336 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3878 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1930 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0981 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0268 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.3238 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4981 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.2965 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2105 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.5555 | Train Acc: 0.4167
 Site-Real      | Train Loss: 0.0952 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0111 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3464 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3212 | Train Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.0766 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0796 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1072 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2404 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3083 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8229 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.0823 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3132 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.4631 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.3053 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.5598 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0232 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2162 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3634 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8871
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:23 | Val Acc: 0.5000
 Best site-Painting   | Epoch:23 | Val Acc: 1.0000
 Best site-Painting   | Epoch:23 | Val Acc: 0.8667
 Best site-Painting   | Epoch:23 | Val Acc: 0.8696
 Best site-Painting   | Epoch:23 | Val Acc: 0.9032
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.3750
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:23 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.3424 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1340 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2441 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.1930 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1060 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0088 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.2584 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4868 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.6335 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2489 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.3840 | Train Acc: 0.4583
 Site-Real      | Train Loss: 0.0860 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0102 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5762 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.3025 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0518 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0516 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1126 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2259 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3104 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.4802 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0308 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2603 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5795 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.4361 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.6898 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1932 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3424 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8877
 Best site-Clipart    | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:24 | Val Acc: 0.4000
 Best site-Painting   | Epoch:24 | Val Acc: 1.0000
 Best site-Painting   | Epoch:24 | Val Acc: 1.0000
 Best site-Painting   | Epoch:24 | Val Acc: 0.8696
 Best site-Painting   | Epoch:24 | Val Acc: 0.9032
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.3438
 Best site-Real       | Epoch:24 | Val Acc: 1.0000
 Best site-Real       | Epoch:24 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:24 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:24 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.3946 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1237 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5673 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.2418 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0885 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9368 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.1851 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4671 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.6186 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.1877 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.5476 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.0784 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4302 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2736 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.1103 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0519 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0886 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1113 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3169 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.7753 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0294 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3033 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.4529 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.4986 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 1.6101 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0100 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2589 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3031 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8809
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.2437 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1468 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2824 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1991 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.1494 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.8690 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2439 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5563 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.2787 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2634 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.3856 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0868 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0114 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3855 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.3630 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.1060 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0331 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0979 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1778 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3193 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 2.0158 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0163 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3018 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.4031 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.3618 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.5862 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2394 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2986 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8836
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.2551 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0953 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2299 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1322 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1070 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0232 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.2425 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5520 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.2687 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2845 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.4546 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.0695 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0082 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2369 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2750 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0526 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0674 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1046 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2088 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3276 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.6471 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2991 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.4875 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 0.4844 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.6366 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2100 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2722 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8714
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.6314 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2655 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.3172 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.2325 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1005 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9703 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.1655 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7144 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.2997 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.1604 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4057 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0856 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2933 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.3254 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0967 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0711 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1041 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2046 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2538 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 2.1230 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2657 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.3742 | Val  Acc: 0.9565
 Site-Painting  | Val  Loss: 0.3841 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.5455 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3105 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3561 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8869
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.3778 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1288 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2239 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1710 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.1126 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9704 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.1791 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7198 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.2734 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.1923 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.3178 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.0832 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2735 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2549 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0780 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0446 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1219 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1683 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3038 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.8782 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0306 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3311 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.5004 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.5062 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 1.5614 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0065 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2779 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2897 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8753
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.3235 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1031 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2450 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1566 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0724 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9825 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.2340 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4582 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.4250 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2158 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.4783 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.0681 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0058 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6737 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2677 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.1754 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1287 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1441 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2796 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.8221 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0342 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3281 | Val  Acc: 0.8667
 Site-Painting  | Val  Loss: 0.3762 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.3949 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6648 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1852 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3715 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8832
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.2568 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1803 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1799 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1716 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1008 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0252 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2715 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7163 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.2696 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2454 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 1.3599 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.0636 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0070 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4717 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2447 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0861 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0368 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0968 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1802 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2437 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9985 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0174 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2317 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.3647 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.4347 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.7922 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0079 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2875 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2772 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8739
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.3162 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1381 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3446 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1273 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1493 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8111 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.2091 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7046 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 0.4464 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.1439 | Train Acc: 0.9787
 Site-QuickDraw | Train Loss: 1.3970 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.0809 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0044 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4836 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2511 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0605 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0514 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1040 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1428 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2391 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.5500 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2700 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.3480 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.2689 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.6712 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1004 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2849 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8920
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:32 | Val Acc: 0.4500
 Best site-Painting   | Epoch:32 | Val Acc: 1.0000
 Best site-Painting   | Epoch:32 | Val Acc: 0.9333
 Best site-Painting   | Epoch:32 | Val Acc: 0.9130
 Best site-Painting   | Epoch:32 | Val Acc: 0.9032
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.3750
 Best site-Real       | Epoch:32 | Val Acc: 1.0000
 Best site-Real       | Epoch:32 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:32 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:32 | Val Acc: 0.9348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.2570 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1259 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2502 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1672 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1047 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 2.0828 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.1920 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4598 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.4294 | Train Acc: 0.9429
 Site-Painting  | Train Loss: 0.1807 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.3237 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0857 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2461 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.2489 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0896 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0843 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1145 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1351 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2556 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8609 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0225 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3457 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.3054 | Val  Acc: 0.9565
 Site-Painting  | Val  Loss: 0.3046 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6633 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1965 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2727 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8901
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.3358 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1799 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1952 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2230 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.0723 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9180 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.2704 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5002 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.2670 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2593 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.3964 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.0648 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0076 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3110 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2758 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0386 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0422 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0854 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1552 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2507 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.6101 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2106 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4390 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.3623 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.6899 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2149 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2718 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8953
 Best site-Clipart    | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:34 | Val Acc: 0.4500
 Best site-Painting   | Epoch:34 | Val Acc: 1.0000
 Best site-Painting   | Epoch:34 | Val Acc: 1.0000
 Best site-Painting   | Epoch:34 | Val Acc: 0.9130
 Best site-Painting   | Epoch:34 | Val Acc: 0.9032
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.3438
 Best site-Real       | Epoch:34 | Val Acc: 1.0000
 Best site-Real       | Epoch:34 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:34 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:34 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.2756 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1255 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2212 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1295 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0748 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0334 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2237 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4988 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.2541 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.1587 | Train Acc: 0.9787
 Site-QuickDraw | Train Loss: 1.3687 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.0530 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4136 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 0.1993 | Train Acc: 0.9857
 Site-Clipart   | Val  Loss: 0.0990 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0296 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0759 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1270 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2891 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9041 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2093 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3206 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.3830 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6959 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0079 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2247 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2757 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8786
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.4776 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0864 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3573 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1320 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0733 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9837 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2037 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5490 | Train Acc: 0.8696
 Site-Painting  | Train Loss: 0.5186 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2079 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.2795 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0654 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4138 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.2047 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0710 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1047 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1290 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2003 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2860 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.8356 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0513 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2021 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2963 | Val  Acc: 0.9565
 Site-Painting  | Val  Loss: 0.4078 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6768 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1571 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2738 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8851
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.3106 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0921 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2049 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1360 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0942 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0084 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.1624 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.7807 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.2609 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.2191 | Train Acc: 0.9787
 Site-QuickDraw | Train Loss: 1.3078 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.0426 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2666 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2542 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0868 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0387 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1027 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1522 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2784 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8171 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0138 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2647 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2162 | Val  Acc: 0.9565
 Site-Painting  | Val  Loss: 0.3679 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.6273 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1939 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2355 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8965
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:37 | Val Acc: 0.4000
 Best site-Painting   | Epoch:37 | Val Acc: 1.0000
 Best site-Painting   | Epoch:37 | Val Acc: 1.0000
 Best site-Painting   | Epoch:37 | Val Acc: 0.9565
 Best site-Painting   | Epoch:37 | Val Acc: 0.8710
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.4062
 Best site-Real       | Epoch:37 | Val Acc: 1.0000
 Best site-Real       | Epoch:37 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:37 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:37 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.2860 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1571 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1941 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1438 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0682 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7582 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.1537 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4078 | Train Acc: 0.8696
 Site-Painting  | Train Loss: 0.2980 | Train Acc: 0.9429
 Site-Painting  | Train Loss: 0.1907 | Train Acc: 0.9787
 Site-QuickDraw | Train Loss: 1.3243 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0680 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4498 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.1912 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0654 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0547 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1021 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1770 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2409 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.4227 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.1299 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2520 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.2134 | Val  Acc: 0.9565
 Site-Painting  | Val  Loss: 0.3946 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.7058 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2638 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2564 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8931
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.2693 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1157 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2539 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1199 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0987 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 2.0482 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.1504 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4235 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.6336 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2144 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.4025 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0711 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2041 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2420 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0293 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0473 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0820 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1326 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2630 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.8433 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0216 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1739 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3818 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.4659 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.7090 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2426 | Val  Acc: 0.9130
 Site-Sketch    | Val  Loss: 0.2511 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8848
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.2660 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.6993 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2541 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1186 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0854 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 2.0240 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.2361 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5722 | Train Acc: 0.9130
 Site-Painting  | Train Loss: 0.3126 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.2078 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.3899 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0485 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0042 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2955 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2310 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0866 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0151 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0791 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1723 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2188 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.7075 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.0238 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3285 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.4098 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.4488 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.6216 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2113 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2729 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8960
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.2548 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1146 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2240 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1254 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0981 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 2.0620 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.1331 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.4979 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 0.2889 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.1565 | Train Acc: 0.9787
 Site-QuickDraw | Train Loss: 1.5195 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0592 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2066 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.1906 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.2169 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0929 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1981 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2242 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.7448 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1906 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4144 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.3056 | Val  Acc: 0.9677
 Site-QuickDraw | Val  Loss: 1.5773 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1751 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2150 | Val  Acc: 0.9783
Average Valid Accuracy: 0.8910
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.2649 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1234 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1983 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2200 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0839 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9040 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.1477 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.3964 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.2253 | Train Acc: 0.9714
 Site-Painting  | Train Loss: 0.1586 | Train Acc: 0.9787
 Site-QuickDraw | Train Loss: 1.3132 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0644 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0070 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3765 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2419 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1078 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0589 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0855 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1268 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2179 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.4809 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2613 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3108 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.3128 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.6341 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1105 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1794 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9069
 Best site-Clipart    | Epoch:42 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:42 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:42 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:42 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:42 | Val Acc: 0.9643
 Best site-Infograph  | Epoch:42 | Val Acc: 0.4500
 Best site-Painting   | Epoch:42 | Val Acc: 1.0000
 Best site-Painting   | Epoch:42 | Val Acc: 1.0000
 Best site-Painting   | Epoch:42 | Val Acc: 0.8696
 Best site-Painting   | Epoch:42 | Val Acc: 0.9355
 Best site-QuickDraw  | Epoch:42 | Val Acc: 0.4062
 Best site-Real       | Epoch:42 | Val Acc: 1.0000
 Best site-Real       | Epoch:42 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:42 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:42 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.2213 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0913 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2086 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1872 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0701 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9849 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.1856 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5718 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.4232 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.1830 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.2882 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0556 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2260 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2135 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0713 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0420 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0945 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1189 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2246 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8536 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1946 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2977 | Val  Acc: 0.9565
 Site-Painting  | Val  Loss: 0.1993 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.5200 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1758 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2358 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8982
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3188 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1240 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3055 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1273 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.0885 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.8615 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.0972 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.4570 | Train Acc: 0.8696
 Site-Painting  | Train Loss: 0.3209 | Train Acc: 0.9429
 Site-Painting  | Train Loss: 0.2313 | Train Acc: 0.9362
 Site-QuickDraw | Train Loss: 1.5091 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.0548 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.1936 | Train Acc: 0.9429
 Site-Sketch    | Train Loss: 0.2390 | Train Acc: 0.9571
 Site-Clipart   | Val  Loss: 0.0683 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0348 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0882 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1432 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2387 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.5128 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.0652 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1957 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.3329 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.3670 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 1.5146 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1218 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2279 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8950
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.3026 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1053 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1519 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1237 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0838 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9565 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.1247 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5581 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 0.3706 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 0.1968 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.3764 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0444 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3131 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.2357 | Train Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.0569 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0573 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1236 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1352 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2094 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.7927 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0385 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1637 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2651 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.2964 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.5161 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1405 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2292 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9067
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.2420 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1166 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3715 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1133 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0708 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.9716 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.1170 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.5103 | Train Acc: 0.8696
 Site-Painting  | Train Loss: 0.2921 | Train Acc: 0.9714
 Site-Painting  | Train Loss: 0.1192 | Train Acc: 0.9787
 Site-QuickDraw | Train Loss: 1.3545 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0471 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2256 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2255 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.1250 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0976 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1735 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2064 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.6285 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.0082 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2380 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.2597 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4016 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 1.6180 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1842 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2248 | Val  Acc: 0.9348
Average Valid Accuracy: 0.8828
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.2614 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0996 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1968 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1177 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0665 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.8913 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.1458 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.5327 | Train Acc: 0.8261
 Site-Painting  | Train Loss: 0.2144 | Train Acc: 0.9143
 Site-Painting  | Train Loss: 0.1576 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.2874 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0500 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0027 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2578 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 0.1779 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0727 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0513 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1194 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1429 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2312 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.6906 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1859 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3413 | Val  Acc: 0.9130
 Site-Painting  | Val  Loss: 0.3471 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.5481 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.2000 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2495 | Val  Acc: 0.9565
Average Valid Accuracy: 0.9114
 Best site-Clipart    | Epoch:47 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:47 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:47 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:47 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:47 | Val Acc: 0.9821
 Best site-Infograph  | Epoch:47 | Val Acc: 0.4500
 Best site-Painting   | Epoch:47 | Val Acc: 1.0000
 Best site-Painting   | Epoch:47 | Val Acc: 1.0000
 Best site-Painting   | Epoch:47 | Val Acc: 0.9130
 Best site-Painting   | Epoch:47 | Val Acc: 0.9355
 Best site-QuickDraw  | Epoch:47 | Val Acc: 0.5000
 Best site-Real       | Epoch:47 | Val Acc: 1.0000
 Best site-Real       | Epoch:47 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:47 | Val Acc: 0.9565
 Best site-Sketch     | Epoch:47 | Val Acc: 0.9565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/harmo-fl...
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.3446 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0803 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1884 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.0979 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0745 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8731 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.1187 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.3551 | Train Acc: 0.9130
 Site-Painting  | Train Loss: 0.2835 | Train Acc: 0.8286
 Site-Painting  | Train Loss: 0.1805 | Train Acc: 0.9574
 Site-QuickDraw | Train Loss: 1.3353 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0492 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2867 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.1670 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0444 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0397 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0886 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1582 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2545 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.8146 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.0234 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2325 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.3110 | Val  Acc: 0.9565
 Site-Painting  | Val  Loss: 0.4138 | Val  Acc: 0.9032
 Site-QuickDraw | Val  Loss: 1.4428 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1475 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.3036 | Val  Acc: 0.8913
Average Valid Accuracy: 0.8983
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.3254 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0696 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2335 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1566 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0732 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9373 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.1142 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 0.3473 | Train Acc: 0.9130
 Site-Painting  | Train Loss: 0.2473 | Train Acc: 0.9714
 Site-Painting  | Train Loss: 0.1141 | Train Acc: 0.9787
 Site-QuickDraw | Train Loss: 1.2476 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0515 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0044 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.1656 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 0.2678 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0907 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1160 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2618 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.8331 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.0577 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1974 | Val  Acc: 0.9333
 Site-Painting  | Val  Loss: 0.4691 | Val  Acc: 0.8696
 Site-Painting  | Val  Loss: 0.3951 | Val  Acc: 0.9355
 Site-QuickDraw | Val  Loss: 1.4820 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.1404 | Val  Acc: 0.9565
 Site-Sketch    | Val  Loss: 0.2175 | Val  Acc: 0.9565
Average Valid Accuracy: 0.8890
===2023-04-27 16:25:37===
===2023-04-27 16:25:39===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,11,23,35,47,48,58,116,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 7, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:47 | Test Acc: 0.9068
 Test site-Infograph | Epoch:47 | Test Acc: 0.4977
 Test site-Painting  | Epoch:47 | Test Acc: 0.8901
 Test site-QuickDraw | Epoch:47 | Test Acc: 0.5220
 Test site-Real      | Epoch:47 | Test Acc: 0.9647
 Test site-Sketch    | Epoch:47 | Test Acc: 0.8736
Average Test Accuracy: 0.7758
