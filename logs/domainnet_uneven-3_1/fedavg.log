===2023-04-27 14:58:00===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,11,23,35,47,48,58,116,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 7, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 2.3149 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 2.2079 | Train Acc: 0.2121
 Site-Clipart   | Train Loss: 2.2803 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2831 | Train Acc: 0.1791
 Site-Clipart   | Train Loss: 2.2799 | Train Acc: 0.1429
 Site-Infograph | Train Loss: 2.2768 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.2522 | Train Acc: 0.3636
 Site-Painting  | Train Loss: 2.2931 | Train Acc: 0.1739
 Site-Painting  | Train Loss: 2.2616 | Train Acc: 0.1714
 Site-Painting  | Train Loss: 2.2938 | Train Acc: 0.0638
 Site-QuickDraw | Train Loss: 2.3141 | Train Acc: 0.0833
 Site-Real      | Train Loss: 2.3058 | Train Acc: 0.1724
 Site-Real      | Train Loss: 2.2851 | Train Acc: 0.1724
 Site-Sketch    | Train Loss: 2.2852 | Train Acc: 0.1429
 Site-Sketch    | Train Loss: 2.2959 | Train Acc: 0.1286
 Site-Clipart   | Val  Loss: 2.2831 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2612 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2642 | Val  Acc: 0.1515
 Site-Clipart   | Val  Loss: 2.3012 | Val  Acc: 0.0682
 Site-Clipart   | Val  Loss: 2.2697 | Val  Acc: 0.1250
 Site-Infograph | Val  Loss: 2.2437 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2924 | Val  Acc: 0.1429
 Site-Painting  | Val  Loss: 2.2800 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.3190 | Val  Acc: 0.0435
 Site-Painting  | Val  Loss: 2.2953 | Val  Acc: 0.1613
 Site-QuickDraw | Val  Loss: 2.3314 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 2.2845 | Val  Acc: 0.1579
 Site-Real      | Val  Loss: 2.2810 | Val  Acc: 0.1429
 Site-Sketch    | Val  Loss: 2.2830 | Val  Acc: 0.2174
 Site-Sketch    | Val  Loss: 2.2990 | Val  Acc: 0.1304
Average Valid Accuracy: 0.1466
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1515
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0682
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1250
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2500
 Best site-Painting   | Epoch:0 | Val Acc: 0.1429
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.0435
 Best site-Painting   | Epoch:0 | Val Acc: 0.1613
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0625
 Best site-Real       | Epoch:0 | Val Acc: 0.1579
 Best site-Real       | Epoch:0 | Val Acc: 0.1429
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2174
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.3053 | Train Acc: 0.0000
 Site-Clipart   | Train Loss: 2.2865 | Train Acc: 0.3030
 Site-Clipart   | Train Loss: 2.2523 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2729 | Train Acc: 0.2090
 Site-Clipart   | Train Loss: 2.2576 | Train Acc: 0.2500
 Site-Infograph | Train Loss: 2.2883 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.2160 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.2826 | Train Acc: 0.1739
 Site-Painting  | Train Loss: 2.3019 | Train Acc: 0.2286
 Site-Painting  | Train Loss: 2.2659 | Train Acc: 0.1489
 Site-QuickDraw | Train Loss: 2.3043 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.2844 | Train Acc: 0.2931
 Site-Real      | Train Loss: 2.2553 | Train Acc: 0.1897
 Site-Sketch    | Train Loss: 2.2302 | Train Acc: 0.1714
 Site-Sketch    | Train Loss: 2.2858 | Train Acc: 0.1143
 Site-Clipart   | Val  Loss: 2.2716 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2372 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2371 | Val  Acc: 0.2121
 Site-Clipart   | Val  Loss: 2.2769 | Val  Acc: 0.2273
 Site-Clipart   | Val  Loss: 2.2535 | Val  Acc: 0.2143
 Site-Infograph | Val  Loss: 2.2886 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.2659 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.2935 | Val  Acc: 0.0667
 Site-Painting  | Val  Loss: 2.2977 | Val  Acc: 0.1304
 Site-Painting  | Val  Loss: 2.2701 | Val  Acc: 0.2581
 Site-QuickDraw | Val  Loss: 2.3239 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.2606 | Val  Acc: 0.1842
 Site-Real      | Val  Loss: 2.2700 | Val  Acc: 0.1818
 Site-Sketch    | Val  Loss: 2.2514 | Val  Acc: 0.2174
 Site-Sketch    | Val  Loss: 2.2789 | Val  Acc: 0.1522
Average Valid Accuracy: 0.1946
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2121
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2273
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2143
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1500
 Best site-Painting   | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.0667
 Best site-Painting   | Epoch:1 | Val Acc: 0.1304
 Best site-Painting   | Epoch:1 | Val Acc: 0.2581
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0938
 Best site-Real       | Epoch:1 | Val Acc: 0.1842
 Best site-Real       | Epoch:1 | Val Acc: 0.1818
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2174
 Best site-Sketch     | Epoch:1 | Val Acc: 0.1522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 2.3124 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 2.2368 | Train Acc: 0.2727
 Site-Clipart   | Train Loss: 2.2452 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.2438 | Train Acc: 0.2388
 Site-Clipart   | Train Loss: 2.2376 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.2765 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.2223 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.2662 | Train Acc: 0.2609
 Site-Painting  | Train Loss: 2.2728 | Train Acc: 0.2571
 Site-Painting  | Train Loss: 2.2516 | Train Acc: 0.2766
 Site-QuickDraw | Train Loss: 2.3075 | Train Acc: 0.0833
 Site-Real      | Train Loss: 2.2449 | Train Acc: 0.3448
 Site-Real      | Train Loss: 2.2370 | Train Acc: 0.2672
 Site-Sketch    | Train Loss: 2.2238 | Train Acc: 0.2571
 Site-Sketch    | Train Loss: 2.2676 | Train Acc: 0.1857
 Site-Clipart   | Val  Loss: 2.2516 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.2446 | Val  Acc: 0.1818
 Site-Clipart   | Val  Loss: 2.2270 | Val  Acc: 0.2424
 Site-Clipart   | Val  Loss: 2.2519 | Val  Acc: 0.2273
 Site-Clipart   | Val  Loss: 2.2456 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2744 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2383 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.2757 | Val  Acc: 0.1333
 Site-Painting  | Val  Loss: 2.2799 | Val  Acc: 0.0870
 Site-Painting  | Val  Loss: 2.2514 | Val  Acc: 0.2581
 Site-QuickDraw | Val  Loss: 2.3225 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.2309 | Val  Acc: 0.2895
 Site-Real      | Val  Loss: 2.2384 | Val  Acc: 0.2468
 Site-Sketch    | Val  Loss: 2.2163 | Val  Acc: 0.2609
 Site-Sketch    | Val  Loss: 2.2718 | Val  Acc: 0.1739
Average Valid Accuracy: 0.2250
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1818
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2424
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2273
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2500
 Best site-Painting   | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.1333
 Best site-Painting   | Epoch:2 | Val Acc: 0.0870
 Best site-Painting   | Epoch:2 | Val Acc: 0.2581
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1250
 Best site-Real       | Epoch:2 | Val Acc: 0.2895
 Best site-Real       | Epoch:2 | Val Acc: 0.2468
 Best site-Sketch     | Epoch:2 | Val Acc: 0.2609
 Best site-Sketch     | Epoch:2 | Val Acc: 0.1739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 2.3205 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 2.2493 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.2131 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.2321 | Train Acc: 0.2537
 Site-Clipart   | Train Loss: 2.2135 | Train Acc: 0.2619
 Site-Infograph | Train Loss: 2.2807 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.2150 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.2579 | Train Acc: 0.1739
 Site-Painting  | Train Loss: 2.2418 | Train Acc: 0.3143
 Site-Painting  | Train Loss: 2.2210 | Train Acc: 0.2553
 Site-QuickDraw | Train Loss: 2.2991 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.2335 | Train Acc: 0.3448
 Site-Real      | Train Loss: 2.2183 | Train Acc: 0.2931
 Site-Sketch    | Train Loss: 2.2007 | Train Acc: 0.4286
 Site-Sketch    | Train Loss: 2.2473 | Train Acc: 0.2143
 Site-Clipart   | Val  Loss: 2.2529 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.2135 | Val  Acc: 0.4091
 Site-Clipart   | Val  Loss: 2.1813 | Val  Acc: 0.3030
 Site-Clipart   | Val  Loss: 2.2443 | Val  Acc: 0.3182
 Site-Clipart   | Val  Loss: 2.2387 | Val  Acc: 0.2679
 Site-Infograph | Val  Loss: 2.2755 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.2154 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.2501 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2693 | Val  Acc: 0.2174
 Site-Painting  | Val  Loss: 2.2501 | Val  Acc: 0.2903
 Site-QuickDraw | Val  Loss: 2.3179 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.2143 | Val  Acc: 0.3158
 Site-Real      | Val  Loss: 2.2182 | Val  Acc: 0.3247
 Site-Sketch    | Val  Loss: 2.2105 | Val  Acc: 0.3478
 Site-Sketch    | Val  Loss: 2.2466 | Val  Acc: 0.3478
Average Valid Accuracy: 0.2946
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4091
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3030
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3182
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2679
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2500
 Best site-Painting   | Epoch:3 | Val Acc: 0.4286
 Best site-Painting   | Epoch:3 | Val Acc: 0.2000
 Best site-Painting   | Epoch:3 | Val Acc: 0.2174
 Best site-Painting   | Epoch:3 | Val Acc: 0.2903
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1250
 Best site-Real       | Epoch:3 | Val Acc: 0.3158
 Best site-Real       | Epoch:3 | Val Acc: 0.3247
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3478
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.2807 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.2647 | Train Acc: 0.4545
 Site-Clipart   | Train Loss: 2.2224 | Train Acc: 0.2600
 Site-Clipart   | Train Loss: 2.2295 | Train Acc: 0.3433
 Site-Clipart   | Train Loss: 2.2246 | Train Acc: 0.3690
 Site-Infograph | Train Loss: 2.2790 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.2061 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.2120 | Train Acc: 0.2609
 Site-Painting  | Train Loss: 2.2315 | Train Acc: 0.2571
 Site-Painting  | Train Loss: 2.1995 | Train Acc: 0.3191
 Site-QuickDraw | Train Loss: 2.2851 | Train Acc: 0.1458
 Site-Real      | Train Loss: 2.2072 | Train Acc: 0.4138
 Site-Real      | Train Loss: 2.1915 | Train Acc: 0.3448
 Site-Sketch    | Train Loss: 2.1492 | Train Acc: 0.3714
 Site-Sketch    | Train Loss: 2.2254 | Train Acc: 0.2286
 Site-Clipart   | Val  Loss: 2.2361 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.1946 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.1766 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.2169 | Val  Acc: 0.4318
 Site-Clipart   | Val  Loss: 2.2250 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.2825 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2244 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 2.2250 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 2.2555 | Val  Acc: 0.2609
 Site-Painting  | Val  Loss: 2.2292 | Val  Acc: 0.4194
 Site-QuickDraw | Val  Loss: 2.3416 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.2007 | Val  Acc: 0.2895
 Site-Real      | Val  Loss: 2.2012 | Val  Acc: 0.3766
 Site-Sketch    | Val  Loss: 2.1843 | Val  Acc: 0.4348
 Site-Sketch    | Val  Loss: 2.2328 | Val  Acc: 0.3043
Average Valid Accuracy: 0.3241
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4318
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2000
 Best site-Painting   | Epoch:4 | Val Acc: 0.2857
 Best site-Painting   | Epoch:4 | Val Acc: 0.3333
 Best site-Painting   | Epoch:4 | Val Acc: 0.2609
 Best site-Painting   | Epoch:4 | Val Acc: 0.4194
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.0938
 Best site-Real       | Epoch:4 | Val Acc: 0.2895
 Best site-Real       | Epoch:4 | Val Acc: 0.3766
 Best site-Sketch     | Epoch:4 | Val Acc: 0.4348
 Best site-Sketch     | Epoch:4 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 2.2630 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.1712 | Train Acc: 0.5758
 Site-Clipart   | Train Loss: 2.2209 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.2204 | Train Acc: 0.3881
 Site-Clipart   | Train Loss: 2.1849 | Train Acc: 0.4643
 Site-Infograph | Train Loss: 2.2711 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.1603 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.2164 | Train Acc: 0.3043
 Site-Painting  | Train Loss: 2.2332 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.1845 | Train Acc: 0.3830
 Site-QuickDraw | Train Loss: 2.2904 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.1950 | Train Acc: 0.4310
 Site-Real      | Train Loss: 2.1662 | Train Acc: 0.4138
 Site-Sketch    | Train Loss: 2.1492 | Train Acc: 0.4286
 Site-Sketch    | Train Loss: 2.2174 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.2104 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1868 | Val  Acc: 0.4091
 Site-Clipart   | Val  Loss: 2.1635 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.2103 | Val  Acc: 0.4318
 Site-Clipart   | Val  Loss: 2.2077 | Val  Acc: 0.3036
 Site-Infograph | Val  Loss: 2.2731 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 2.1624 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.2190 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2544 | Val  Acc: 0.3043
 Site-Painting  | Val  Loss: 2.2142 | Val  Acc: 0.3871
 Site-QuickDraw | Val  Loss: 2.3208 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 2.1776 | Val  Acc: 0.3947
 Site-Real      | Val  Loss: 2.1812 | Val  Acc: 0.4156
 Site-Sketch    | Val  Loss: 2.1527 | Val  Acc: 0.4348
 Site-Sketch    | Val  Loss: 2.2019 | Val  Acc: 0.3696
Average Valid Accuracy: 0.3687
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4091
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4318
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3036
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2500
 Best site-Painting   | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.4000
 Best site-Painting   | Epoch:5 | Val Acc: 0.3043
 Best site-Painting   | Epoch:5 | Val Acc: 0.3871
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.0625
 Best site-Real       | Epoch:5 | Val Acc: 0.3947
 Best site-Real       | Epoch:5 | Val Acc: 0.4156
 Best site-Sketch     | Epoch:5 | Val Acc: 0.4348
 Best site-Sketch     | Epoch:5 | Val Acc: 0.3696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 2.2619 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.1477 | Train Acc: 0.4242
 Site-Clipart   | Train Loss: 2.2056 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.1842 | Train Acc: 0.4179
 Site-Clipart   | Train Loss: 2.1534 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 2.2538 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.1410 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.1716 | Train Acc: 0.3043
 Site-Painting  | Train Loss: 2.1712 | Train Acc: 0.5143
 Site-Painting  | Train Loss: 2.1715 | Train Acc: 0.4043
 Site-QuickDraw | Train Loss: 2.2906 | Train Acc: 0.1042
 Site-Real      | Train Loss: 2.1757 | Train Acc: 0.4483
 Site-Real      | Train Loss: 2.1608 | Train Acc: 0.4569
 Site-Sketch    | Train Loss: 2.1822 | Train Acc: 0.3429
 Site-Sketch    | Train Loss: 2.2180 | Train Acc: 0.3714
 Site-Clipart   | Val  Loss: 2.1853 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1640 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1365 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.1944 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1910 | Val  Acc: 0.4107
 Site-Infograph | Val  Loss: 2.2751 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1447 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 2.1899 | Val  Acc: 0.5333
 Site-Painting  | Val  Loss: 2.2307 | Val  Acc: 0.3478
 Site-Painting  | Val  Loss: 2.1946 | Val  Acc: 0.4194
 Site-QuickDraw | Val  Loss: 2.3095 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.1597 | Val  Acc: 0.4211
 Site-Real      | Val  Loss: 2.1596 | Val  Acc: 0.4545
 Site-Sketch    | Val  Loss: 2.1508 | Val  Acc: 0.4783
 Site-Sketch    | Val  Loss: 2.1929 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4176
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4848
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4107
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3000
 Best site-Painting   | Epoch:6 | Val Acc: 0.4286
 Best site-Painting   | Epoch:6 | Val Acc: 0.5333
 Best site-Painting   | Epoch:6 | Val Acc: 0.3478
 Best site-Painting   | Epoch:6 | Val Acc: 0.4194
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.0938
 Best site-Real       | Epoch:6 | Val Acc: 0.4211
 Best site-Real       | Epoch:6 | Val Acc: 0.4545
 Best site-Sketch     | Epoch:6 | Val Acc: 0.4783
 Best site-Sketch     | Epoch:6 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 2.2420 | Train Acc: 0.3125
 Site-Clipart   | Train Loss: 2.1357 | Train Acc: 0.4848
 Site-Clipart   | Train Loss: 2.1799 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 2.1759 | Train Acc: 0.4925
 Site-Clipart   | Train Loss: 2.1388 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 2.2517 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.1394 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.1780 | Train Acc: 0.3478
 Site-Painting  | Train Loss: 2.2289 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.1445 | Train Acc: 0.4894
 Site-QuickDraw | Train Loss: 2.3010 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1561 | Train Acc: 0.5345
 Site-Real      | Train Loss: 2.1388 | Train Acc: 0.5086
 Site-Sketch    | Train Loss: 2.1480 | Train Acc: 0.4857
 Site-Sketch    | Train Loss: 2.1846 | Train Acc: 0.3714
 Site-Clipart   | Val  Loss: 2.1630 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1528 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.1426 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1727 | Val  Acc: 0.4773
 Site-Clipart   | Val  Loss: 2.1682 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.2598 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.1463 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 2.1943 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 2.2204 | Val  Acc: 0.3913
 Site-Painting  | Val  Loss: 2.1795 | Val  Acc: 0.4516
 Site-QuickDraw | Val  Loss: 2.3169 | Val  Acc: 0.0312
 Site-Real      | Val  Loss: 2.1224 | Val  Acc: 0.6316
 Site-Real      | Val  Loss: 2.1412 | Val  Acc: 0.5325
 Site-Sketch    | Val  Loss: 2.1515 | Val  Acc: 0.5217
 Site-Sketch    | Val  Loss: 2.1795 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4509
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4773
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3000
 Best site-Painting   | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 0.4000
 Best site-Painting   | Epoch:7 | Val Acc: 0.3913
 Best site-Painting   | Epoch:7 | Val Acc: 0.4516
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.0312
 Best site-Real       | Epoch:7 | Val Acc: 0.6316
 Best site-Real       | Epoch:7 | Val Acc: 0.5325
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5217
 Best site-Sketch     | Epoch:7 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 2.2469 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 2.1635 | Train Acc: 0.5152
 Site-Clipart   | Train Loss: 2.1299 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 2.1406 | Train Acc: 0.5373
 Site-Clipart   | Train Loss: 2.1210 | Train Acc: 0.5119
 Site-Infograph | Train Loss: 2.2622 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.1484 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.1603 | Train Acc: 0.3043
 Site-Painting  | Train Loss: 2.1716 | Train Acc: 0.4000
 Site-Painting  | Train Loss: 2.1352 | Train Acc: 0.4894
 Site-QuickDraw | Train Loss: 2.2815 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.1249 | Train Acc: 0.5862
 Site-Real      | Train Loss: 2.1152 | Train Acc: 0.5517
 Site-Sketch    | Train Loss: 2.1418 | Train Acc: 0.4571
 Site-Sketch    | Train Loss: 2.1581 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.1582 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1232 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0792 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.1324 | Val  Acc: 0.5909
 Site-Clipart   | Val  Loss: 2.1624 | Val  Acc: 0.4821
 Site-Infograph | Val  Loss: 2.2445 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.1225 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 2.1866 | Val  Acc: 0.4667
 Site-Painting  | Val  Loss: 2.2016 | Val  Acc: 0.3913
 Site-Painting  | Val  Loss: 2.1503 | Val  Acc: 0.5806
 Site-QuickDraw | Val  Loss: 2.3027 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.1076 | Val  Acc: 0.5789
 Site-Real      | Val  Loss: 2.1169 | Val  Acc: 0.5714
 Site-Sketch    | Val  Loss: 2.1202 | Val  Acc: 0.4783
 Site-Sketch    | Val  Loss: 2.1595 | Val  Acc: 0.4565
Average Valid Accuracy: 0.4852
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5758
 Best site-Clipart    | Epoch:8 | Val Acc: 0.5909
 Best site-Clipart    | Epoch:8 | Val Acc: 0.4821
 Best site-Infograph  | Epoch:8 | Val Acc: 0.3500
 Best site-Painting   | Epoch:8 | Val Acc: 0.5714
 Best site-Painting   | Epoch:8 | Val Acc: 0.4667
 Best site-Painting   | Epoch:8 | Val Acc: 0.3913
 Best site-Painting   | Epoch:8 | Val Acc: 0.5806
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.0938
 Best site-Real       | Epoch:8 | Val Acc: 0.5789
 Best site-Real       | Epoch:8 | Val Acc: 0.5714
 Best site-Sketch     | Epoch:8 | Val Acc: 0.4783
 Best site-Sketch     | Epoch:8 | Val Acc: 0.4565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.2441 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 2.1690 | Train Acc: 0.5455
 Site-Clipart   | Train Loss: 2.1416 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.1153 | Train Acc: 0.5075
 Site-Clipart   | Train Loss: 2.1200 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.2530 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.1497 | Train Acc: 0.5455
 Site-Painting  | Train Loss: 2.1118 | Train Acc: 0.4783
 Site-Painting  | Train Loss: 2.1913 | Train Acc: 0.4857
 Site-Painting  | Train Loss: 2.1226 | Train Acc: 0.6596
 Site-QuickDraw | Train Loss: 2.2866 | Train Acc: 0.0833
 Site-Real      | Train Loss: 2.1071 | Train Acc: 0.6034
 Site-Real      | Train Loss: 2.0891 | Train Acc: 0.6207
 Site-Sketch    | Train Loss: 2.1161 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 2.1585 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 2.1500 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.1401 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0882 | Val  Acc: 0.4848
 Site-Clipart   | Val  Loss: 2.1232 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.1435 | Val  Acc: 0.4821
 Site-Infograph | Val  Loss: 2.2546 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.1099 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 2.1529 | Val  Acc: 0.4667
 Site-Painting  | Val  Loss: 2.2059 | Val  Acc: 0.3913
 Site-Painting  | Val  Loss: 2.1568 | Val  Acc: 0.4839
 Site-QuickDraw | Val  Loss: 2.3187 | Val  Acc: 0.0312
 Site-Real      | Val  Loss: 2.0845 | Val  Acc: 0.5526
 Site-Real      | Val  Loss: 2.0979 | Val  Acc: 0.6494
 Site-Sketch    | Val  Loss: 2.0957 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1490 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4694
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 2.2240 | Train Acc: 0.3125
 Site-Clipart   | Train Loss: 1.9433 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 2.1323 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 2.1219 | Train Acc: 0.5522
 Site-Clipart   | Train Loss: 2.0920 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 2.2303 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.1235 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.1385 | Train Acc: 0.4783
 Site-Painting  | Train Loss: 2.1631 | Train Acc: 0.5429
 Site-Painting  | Train Loss: 2.1129 | Train Acc: 0.5957
 Site-QuickDraw | Train Loss: 2.2801 | Train Acc: 0.1667
 Site-Real      | Train Loss: 2.1028 | Train Acc: 0.6034
 Site-Real      | Train Loss: 2.0736 | Train Acc: 0.6293
 Site-Sketch    | Train Loss: 2.0737 | Train Acc: 0.6571
 Site-Sketch    | Train Loss: 2.1393 | Train Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1332 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.1025 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0783 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.1059 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.1340 | Val  Acc: 0.4821
 Site-Infograph | Val  Loss: 2.2628 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0572 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.1273 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1743 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 2.1551 | Val  Acc: 0.5806
 Site-QuickDraw | Val  Loss: 2.2975 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.0658 | Val  Acc: 0.6316
 Site-Real      | Val  Loss: 2.0871 | Val  Acc: 0.6364
 Site-Sketch    | Val  Loss: 2.0683 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 2.1513 | Val  Acc: 0.3913
Average Valid Accuracy: 0.5630
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5758
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:10 | Val Acc: 0.4821
 Best site-Infograph  | Epoch:10 | Val Acc: 0.3500
 Best site-Painting   | Epoch:10 | Val Acc: 0.8571
 Best site-Painting   | Epoch:10 | Val Acc: 0.6000
 Best site-Painting   | Epoch:10 | Val Acc: 0.5652
 Best site-Painting   | Epoch:10 | Val Acc: 0.5806
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.1250
 Best site-Real       | Epoch:10 | Val Acc: 0.6316
 Best site-Real       | Epoch:10 | Val Acc: 0.6364
 Best site-Sketch     | Epoch:10 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:10 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 2.1935 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 2.1297 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 2.1299 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 2.0833 | Train Acc: 0.6119
 Site-Clipart   | Train Loss: 2.0796 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 2.2239 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 2.0968 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.1128 | Train Acc: 0.5217
 Site-Painting  | Train Loss: 2.1483 | Train Acc: 0.5143
 Site-Painting  | Train Loss: 2.0999 | Train Acc: 0.6596
 Site-QuickDraw | Train Loss: 2.2630 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0727 | Train Acc: 0.6379
 Site-Real      | Train Loss: 2.0545 | Train Acc: 0.6552
 Site-Sketch    | Train Loss: 2.0631 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.1144 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 2.1402 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0842 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.0378 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.1094 | Val  Acc: 0.6136
 Site-Clipart   | Val  Loss: 2.1230 | Val  Acc: 0.5357
 Site-Infograph | Val  Loss: 2.2403 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 2.0371 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.1421 | Val  Acc: 0.6000
 Site-Painting  | Val  Loss: 2.1670 | Val  Acc: 0.4348
 Site-Painting  | Val  Loss: 2.1352 | Val  Acc: 0.4839
 Site-QuickDraw | Val  Loss: 2.3033 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.0384 | Val  Acc: 0.7632
 Site-Real      | Val  Loss: 2.0612 | Val  Acc: 0.6623
 Site-Sketch    | Val  Loss: 2.0580 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1160 | Val  Acc: 0.5435
Average Valid Accuracy: 0.5504
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 2.1681 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 2.0107 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 2.1242 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 2.0935 | Train Acc: 0.6567
 Site-Clipart   | Train Loss: 2.0564 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.2331 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.0878 | Train Acc: 0.6364
 Site-Painting  | Train Loss: 2.0911 | Train Acc: 0.5217
 Site-Painting  | Train Loss: 2.1164 | Train Acc: 0.5143
 Site-Painting  | Train Loss: 2.0781 | Train Acc: 0.6596
 Site-QuickDraw | Train Loss: 2.2728 | Train Acc: 0.1667
 Site-Real      | Train Loss: 2.0578 | Train Acc: 0.6552
 Site-Real      | Train Loss: 2.0394 | Train Acc: 0.7069
 Site-Sketch    | Train Loss: 2.0971 | Train Acc: 0.6857
 Site-Sketch    | Train Loss: 2.0860 | Train Acc: 0.5571
 Site-Clipart   | Val  Loss: 2.1290 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.0689 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0136 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 2.1002 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 2.1224 | Val  Acc: 0.5536
 Site-Infograph | Val  Loss: 2.2648 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0236 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.1201 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.1482 | Val  Acc: 0.5217
 Site-Painting  | Val  Loss: 2.1073 | Val  Acc: 0.5484
 Site-QuickDraw | Val  Loss: 2.3125 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.0272 | Val  Acc: 0.7632
 Site-Real      | Val  Loss: 2.0459 | Val  Acc: 0.7403
 Site-Sketch    | Val  Loss: 2.0566 | Val  Acc: 0.5652
 Site-Sketch    | Val  Loss: 2.1153 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5744
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6591
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5536
 Best site-Infograph  | Epoch:12 | Val Acc: 0.3500
 Best site-Painting   | Epoch:12 | Val Acc: 0.8571
 Best site-Painting   | Epoch:12 | Val Acc: 0.6667
 Best site-Painting   | Epoch:12 | Val Acc: 0.5217
 Best site-Painting   | Epoch:12 | Val Acc: 0.5484
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.1250
 Best site-Real       | Epoch:12 | Val Acc: 0.7632
 Best site-Real       | Epoch:12 | Val Acc: 0.7403
 Best site-Sketch     | Epoch:12 | Val Acc: 0.5652
 Best site-Sketch     | Epoch:12 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 2.1829 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 1.8793 | Train Acc: 0.6970
 Site-Clipart   | Train Loss: 2.0666 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 2.0491 | Train Acc: 0.5970
 Site-Clipart   | Train Loss: 2.0519 | Train Acc: 0.6548
 Site-Infograph | Train Loss: 2.2187 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.0597 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 2.0839 | Train Acc: 0.5217
 Site-Painting  | Train Loss: 2.0508 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 2.0793 | Train Acc: 0.6596
 Site-QuickDraw | Train Loss: 2.2578 | Train Acc: 0.2292
 Site-Real      | Train Loss: 2.0499 | Train Acc: 0.6897
 Site-Real      | Train Loss: 2.0316 | Train Acc: 0.7414
 Site-Sketch    | Train Loss: 2.0311 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.1058 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 2.1078 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 2.0565 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0061 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 2.0555 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 2.0978 | Val  Acc: 0.5893
 Site-Infograph | Val  Loss: 2.2461 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 2.0181 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.1181 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.1233 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 2.1002 | Val  Acc: 0.6129
 Site-QuickDraw | Val  Loss: 2.3038 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 2.0036 | Val  Acc: 0.7632
 Site-Real      | Val  Loss: 2.0249 | Val  Acc: 0.7403
 Site-Sketch    | Val  Loss: 2.0174 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 2.0855 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5924
 Best site-Clipart    | Epoch:13 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6591
 Best site-Clipart    | Epoch:13 | Val Acc: 0.5893
 Best site-Infograph  | Epoch:13 | Val Acc: 0.3500
 Best site-Painting   | Epoch:13 | Val Acc: 0.8571
 Best site-Painting   | Epoch:13 | Val Acc: 0.6667
 Best site-Painting   | Epoch:13 | Val Acc: 0.5652
 Best site-Painting   | Epoch:13 | Val Acc: 0.6129
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.1250
 Best site-Real       | Epoch:13 | Val Acc: 0.7632
 Best site-Real       | Epoch:13 | Val Acc: 0.7403
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:13 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 2.1704 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.9534 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 2.1131 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 2.0572 | Train Acc: 0.6567
 Site-Clipart   | Train Loss: 2.0114 | Train Acc: 0.6548
 Site-Infograph | Train Loss: 2.2158 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.0277 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 2.0431 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 2.1319 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 2.0230 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2729 | Train Acc: 0.1875
 Site-Real      | Train Loss: 2.0235 | Train Acc: 0.7069
 Site-Real      | Train Loss: 2.0049 | Train Acc: 0.7931
 Site-Sketch    | Train Loss: 2.0700 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 2.0737 | Train Acc: 0.4714
 Site-Clipart   | Val  Loss: 2.0556 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0417 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9877 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.0800 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 2.1160 | Val  Acc: 0.4643
 Site-Infograph | Val  Loss: 2.2605 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9806 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0673 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.1334 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0734 | Val  Acc: 0.6774
 Site-QuickDraw | Val  Loss: 2.2856 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.9846 | Val  Acc: 0.8684
 Site-Real      | Val  Loss: 1.9988 | Val  Acc: 0.7922
 Site-Sketch    | Val  Loss: 2.0224 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 2.0820 | Val  Acc: 0.5217
Average Valid Accuracy: 0.5983
 Best site-Clipart    | Epoch:14 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:14 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5758
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:14 | Val Acc: 0.4643
 Best site-Infograph  | Epoch:14 | Val Acc: 0.3000
 Best site-Painting   | Epoch:14 | Val Acc: 0.8571
 Best site-Painting   | Epoch:14 | Val Acc: 0.6667
 Best site-Painting   | Epoch:14 | Val Acc: 0.6087
 Best site-Painting   | Epoch:14 | Val Acc: 0.6774
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.1250
 Best site-Real       | Epoch:14 | Val Acc: 0.8684
 Best site-Real       | Epoch:14 | Val Acc: 0.7922
 Best site-Sketch     | Epoch:14 | Val Acc: 0.6087
 Best site-Sketch     | Epoch:14 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 2.1541 | Train Acc: 0.3125
 Site-Clipart   | Train Loss: 2.0779 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 2.0467 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 2.0472 | Train Acc: 0.6269
 Site-Clipart   | Train Loss: 2.0339 | Train Acc: 0.7024
 Site-Infograph | Train Loss: 2.2003 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 2.0066 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 2.0487 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0511 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 2.0301 | Train Acc: 0.6809
 Site-QuickDraw | Train Loss: 2.2683 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.9998 | Train Acc: 0.7069
 Site-Real      | Train Loss: 1.9944 | Train Acc: 0.7931
 Site-Sketch    | Train Loss: 1.9985 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 2.0706 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0781 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0159 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.9845 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 2.0465 | Val  Acc: 0.6136
 Site-Clipart   | Val  Loss: 2.0846 | Val  Acc: 0.6071
 Site-Infograph | Val  Loss: 2.2638 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.9991 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0487 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.1176 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0750 | Val  Acc: 0.5484
 Site-QuickDraw | Val  Loss: 2.2872 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.9464 | Val  Acc: 0.8684
 Site-Real      | Val  Loss: 1.9854 | Val  Acc: 0.7662
 Site-Sketch    | Val  Loss: 2.0009 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0570 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6174
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:15 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6136
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6071
 Best site-Infograph  | Epoch:15 | Val Acc: 0.3000
 Best site-Painting   | Epoch:15 | Val Acc: 0.8571
 Best site-Painting   | Epoch:15 | Val Acc: 0.7333
 Best site-Painting   | Epoch:15 | Val Acc: 0.6087
 Best site-Painting   | Epoch:15 | Val Acc: 0.5484
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.1250
 Best site-Real       | Epoch:15 | Val Acc: 0.8684
 Best site-Real       | Epoch:15 | Val Acc: 0.7662
 Best site-Sketch     | Epoch:15 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:15 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 2.1305 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.9742 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.9664 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 2.0243 | Train Acc: 0.6269
 Site-Clipart   | Train Loss: 2.0279 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.2073 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9961 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.0671 | Train Acc: 0.5652
 Site-Painting  | Train Loss: 2.0567 | Train Acc: 0.6000
 Site-Painting  | Train Loss: 2.0023 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2664 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.9808 | Train Acc: 0.7241
 Site-Real      | Train Loss: 1.9552 | Train Acc: 0.8362
 Site-Sketch    | Train Loss: 1.9745 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 2.0441 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 2.0447 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0043 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.9650 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 2.0463 | Val  Acc: 0.6136
 Site-Clipart   | Val  Loss: 2.0575 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.2752 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.9679 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0350 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0906 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0778 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2941 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 1.9412 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 1.9641 | Val  Acc: 0.8182
 Site-Sketch    | Val  Loss: 1.9830 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 2.0571 | Val  Acc: 0.4783
Average Valid Accuracy: 0.6460
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6136
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4000
 Best site-Painting   | Epoch:16 | Val Acc: 0.8571
 Best site-Painting   | Epoch:16 | Val Acc: 0.7333
 Best site-Painting   | Epoch:16 | Val Acc: 0.6087
 Best site-Painting   | Epoch:16 | Val Acc: 0.6452
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.0625
 Best site-Real       | Epoch:16 | Val Acc: 0.8947
 Best site-Real       | Epoch:16 | Val Acc: 0.8182
 Best site-Sketch     | Epoch:16 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:16 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 2.1289 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.9090 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 2.0480 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 2.0196 | Train Acc: 0.6567
 Site-Clipart   | Train Loss: 2.0017 | Train Acc: 0.6786
 Site-Infograph | Train Loss: 2.2210 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 2.0135 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.0125 | Train Acc: 0.5652
 Site-Painting  | Train Loss: 2.0662 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.9751 | Train Acc: 0.7234
 Site-QuickDraw | Train Loss: 2.2605 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.9595 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.9387 | Train Acc: 0.8793
 Site-Sketch    | Train Loss: 1.9298 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.0578 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 2.0054 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0007 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.9663 | Val  Acc: 0.5758
 Site-Clipart   | Val  Loss: 2.0153 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 2.0530 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 2.2576 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.9260 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0436 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0928 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0569 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2969 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.9214 | Val  Acc: 0.8158
 Site-Real      | Val  Loss: 1.9480 | Val  Acc: 0.8442
 Site-Sketch    | Val  Loss: 1.9903 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 2.0350 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6363
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 2.1191 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.9741 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 2.0349 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 2.0146 | Train Acc: 0.6567
 Site-Clipart   | Train Loss: 1.9712 | Train Acc: 0.6786
 Site-Infograph | Train Loss: 2.2151 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.0214 | Train Acc: 0.7273
 Site-Painting  | Train Loss: 2.0257 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0337 | Train Acc: 0.6571
 Site-Painting  | Train Loss: 1.9755 | Train Acc: 0.7234
 Site-QuickDraw | Train Loss: 2.2329 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9594 | Train Acc: 0.7586
 Site-Real      | Train Loss: 1.9127 | Train Acc: 0.8448
 Site-Sketch    | Train Loss: 1.8754 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 2.0175 | Train Acc: 0.5857
 Site-Clipart   | Val  Loss: 2.0683 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 1.9881 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.9264 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 2.0016 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 2.0531 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 2.2369 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.9607 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0244 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0676 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 2.0313 | Val  Acc: 0.6129
 Site-QuickDraw | Val  Loss: 2.2946 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.9005 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.9293 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.9342 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 2.0311 | Val  Acc: 0.5435
Average Valid Accuracy: 0.6433
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 2.1334 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 1.7469 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 2.0498 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.9798 | Train Acc: 0.6567
 Site-Clipart   | Train Loss: 1.9537 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 2.1953 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9806 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 2.0165 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.9845 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 1.9541 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2493 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.9417 | Train Acc: 0.7931
 Site-Real      | Train Loss: 1.9039 | Train Acc: 0.8707
 Site-Sketch    | Train Loss: 1.9485 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 2.0275 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 2.0265 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.9873 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9191 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9981 | Val  Acc: 0.6136
 Site-Clipart   | Val  Loss: 2.0464 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.2299 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.8923 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 2.0058 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 2.0484 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 2.0307 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2881 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.8742 | Val  Acc: 0.8684
 Site-Real      | Val  Loss: 1.8997 | Val  Acc: 0.8701
 Site-Sketch    | Val  Loss: 1.9130 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.9918 | Val  Acc: 0.6739
Average Valid Accuracy: 0.6498
 Best site-Clipart    | Epoch:19 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:19 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6136
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:19 | Val Acc: 0.3000
 Best site-Painting   | Epoch:19 | Val Acc: 1.0000
 Best site-Painting   | Epoch:19 | Val Acc: 0.8000
 Best site-Painting   | Epoch:19 | Val Acc: 0.6522
 Best site-Painting   | Epoch:19 | Val Acc: 0.6452
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.0938
 Best site-Real       | Epoch:19 | Val Acc: 0.8684
 Best site-Real       | Epoch:19 | Val Acc: 0.8701
 Best site-Sketch     | Epoch:19 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:19 | Val Acc: 0.6739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.6882
 Test site-Infograph | Epoch:19 | Test Acc: 0.3470
 Test site-Painting  | Epoch:19 | Test Acc: 0.7496
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.1770
 Test site-Real      | Epoch:19 | Test Acc: 0.8578
 Test site-Sketch    | Epoch:19 | Test Acc: 0.6805
Average Test Accuracy: 0.5834
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 2.1634 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 1.8574 | Train Acc: 0.6970
 Site-Clipart   | Train Loss: 1.9853 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.9421 | Train Acc: 0.6866
 Site-Clipart   | Train Loss: 1.9461 | Train Acc: 0.7024
 Site-Infograph | Train Loss: 2.2108 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.9489 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9828 | Train Acc: 0.7826
 Site-Painting  | Train Loss: 2.0166 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.9253 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2498 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.9449 | Train Acc: 0.7759
 Site-Real      | Train Loss: 1.8867 | Train Acc: 0.8793
 Site-Sketch    | Train Loss: 1.9425 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 2.0095 | Train Acc: 0.5857
 Site-Clipart   | Val  Loss: 2.0162 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9519 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8877 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9775 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 2.0113 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.2370 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8728 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 2.0233 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0790 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0081 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2890 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.8429 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.8824 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.9368 | Val  Acc: 0.6522
 Site-Sketch    | Val  Loss: 1.9960 | Val  Acc: 0.6304
Average Valid Accuracy: 0.6533
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:20 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:20 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6591
 Best site-Clipart    | Epoch:20 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4000
 Best site-Painting   | Epoch:20 | Val Acc: 0.8571
 Best site-Painting   | Epoch:20 | Val Acc: 0.6667
 Best site-Painting   | Epoch:20 | Val Acc: 0.6087
 Best site-Painting   | Epoch:20 | Val Acc: 0.6452
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.0938
 Best site-Real       | Epoch:20 | Val Acc: 0.9737
 Best site-Real       | Epoch:20 | Val Acc: 0.8961
 Best site-Sketch     | Epoch:20 | Val Acc: 0.6522
 Best site-Sketch     | Epoch:20 | Val Acc: 0.6304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 2.1222 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.9855 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 2.0225 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.9621 | Train Acc: 0.7015
 Site-Clipart   | Train Loss: 1.9166 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1838 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9363 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9567 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 2.0806 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.9077 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2425 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.9070 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.8665 | Train Acc: 0.9052
 Site-Sketch    | Train Loss: 1.9262 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 2.0040 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.9576 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.9475 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8913 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.9817 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9829 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2148 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8524 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9996 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0396 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 2.0173 | Val  Acc: 0.6452
 Site-QuickDraw | Val  Loss: 2.2941 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.8316 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.8654 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.9294 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.9820 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6911
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:21 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:21 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:21 | Val Acc: 0.4000
 Best site-Painting   | Epoch:21 | Val Acc: 1.0000
 Best site-Painting   | Epoch:21 | Val Acc: 0.6667
 Best site-Painting   | Epoch:21 | Val Acc: 0.6087
 Best site-Painting   | Epoch:21 | Val Acc: 0.6452
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.0938
 Best site-Real       | Epoch:21 | Val Acc: 0.9211
 Best site-Real       | Epoch:21 | Val Acc: 0.8961
 Best site-Sketch     | Epoch:21 | Val Acc: 0.6957
 Best site-Sketch     | Epoch:21 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 2.0914 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 1.8395 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.9745 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.9154 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.8754 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.2123 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9209 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.9199 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 2.0169 | Train Acc: 0.6571
 Site-Painting  | Train Loss: 1.9081 | Train Acc: 0.7447
 Site-QuickDraw | Train Loss: 2.2393 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.8972 | Train Acc: 0.7931
 Site-Real      | Train Loss: 1.8529 | Train Acc: 0.9138
 Site-Sketch    | Train Loss: 1.8858 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.9723 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.9866 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9523 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.8505 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.9278 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9694 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.2558 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8583 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9744 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0378 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9775 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2778 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.8051 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.8516 | Val  Acc: 0.8831
 Site-Sketch    | Val  Loss: 1.8496 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.9774 | Val  Acc: 0.6304
Average Valid Accuracy: 0.7130
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7321
 Best site-Infograph  | Epoch:22 | Val Acc: 0.3500
 Best site-Painting   | Epoch:22 | Val Acc: 1.0000
 Best site-Painting   | Epoch:22 | Val Acc: 0.7333
 Best site-Painting   | Epoch:22 | Val Acc: 0.6087
 Best site-Painting   | Epoch:22 | Val Acc: 0.7419
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.1562
 Best site-Real       | Epoch:22 | Val Acc: 0.9737
 Best site-Real       | Epoch:22 | Val Acc: 0.8831
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8696
 Best site-Sketch     | Epoch:22 | Val Acc: 0.6304
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 2.0672 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 1.7759 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 2.0045 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.9430 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.8990 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1802 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9829 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.9172 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8888 | Train Acc: 0.6286
 Site-Painting  | Train Loss: 1.8895 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2401 | Train Acc: 0.1458
 Site-Real      | Train Loss: 1.8929 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.8110 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 1.9283 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.9892 | Train Acc: 0.6143
 Site-Clipart   | Val  Loss: 1.9537 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.9342 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8600 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9363 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 1.9784 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.2160 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8463 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9610 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0287 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 1.9680 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2689 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.8074 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.8329 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.8614 | Val  Acc: 0.8696
 Site-Sketch    | Val  Loss: 1.9560 | Val  Acc: 0.6304
Average Valid Accuracy: 0.6762
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 2.0701 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.7749 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.8921 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.9401 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.8401 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1919 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.9064 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.9007 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 2.0304 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.8817 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2286 | Train Acc: 0.2917
 Site-Real      | Train Loss: 1.8692 | Train Acc: 0.8276
 Site-Real      | Train Loss: 1.8264 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.9253 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.9490 | Train Acc: 0.6714
 Site-Clipart   | Val  Loss: 1.9349 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.9256 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8073 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.9197 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.9748 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 2.1923 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.8316 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9491 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 2.0110 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9583 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2601 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.7833 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.8108 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.8681 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.9656 | Val  Acc: 0.6304
Average Valid Accuracy: 0.7053
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 2.0707 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.7580 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9746 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.9285 | Train Acc: 0.7164
 Site-Clipart   | Train Loss: 1.8769 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1790 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8547 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8648 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.9638 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.8626 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.2443 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.8418 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.7989 | Train Acc: 0.9052
 Site-Sketch    | Train Loss: 1.8554 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.9441 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.9472 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8398 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8158 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.8889 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9549 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2302 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.8529 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.9568 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 2.0126 | Val  Acc: 0.5652
 Site-Painting  | Val  Loss: 1.9473 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2670 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.7719 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.8025 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.8850 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.9273 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6990
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 2.0616 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8226 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.9413 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.8994 | Train Acc: 0.7313
 Site-Clipart   | Train Loss: 1.8514 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.1619 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.9131 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.9348 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.9348 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.8379 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.2190 | Train Acc: 0.1458
 Site-Real      | Train Loss: 1.8232 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.7759 | Train Acc: 0.9052
 Site-Sketch    | Train Loss: 1.8863 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.9698 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.9439 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8630 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8167 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.8899 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 1.9660 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 2.2691 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.8021 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9345 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9701 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.9133 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2622 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.7673 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.7820 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.7993 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.9095 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6960
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 2.0145 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.7861 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.9633 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.8214 | Train Acc: 0.7313
 Site-Clipart   | Train Loss: 1.8302 | Train Acc: 0.7738
 Site-Infograph | Train Loss: 2.1825 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.8632 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8955 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.9571 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.8472 | Train Acc: 0.7660
 Site-QuickDraw | Train Loss: 2.2376 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.8012 | Train Acc: 0.8103
 Site-Real      | Train Loss: 1.7799 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.8620 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.8965 | Train Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.9033 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8301 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.8154 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.8962 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.9446 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.2149 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.7996 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.9233 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9840 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.9548 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2696 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.7252 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7528 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.8212 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.9130 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6949
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 2.0846 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 1.8161 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.8710 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.8791 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.8128 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1534 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.8642 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8905 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.9007 | Train Acc: 0.6857
 Site-Painting  | Train Loss: 1.8234 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2168 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.8192 | Train Acc: 0.7759
 Site-Real      | Train Loss: 1.7614 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.7452 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.9210 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.9023 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8426 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7216 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.8772 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.9107 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2478 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.6950 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8900 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9751 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9345 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2558 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.7153 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7574 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.8716 | Val  Acc: 0.6087
 Site-Sketch    | Val  Loss: 1.9040 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6934
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 2.0339 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.6764 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9251 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.8675 | Train Acc: 0.7313
 Site-Clipart   | Train Loss: 1.8178 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1421 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 1.8582 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8948 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8550 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.7981 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2143 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.7723 | Train Acc: 0.8276
 Site-Real      | Train Loss: 1.7438 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.8043 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.9176 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.8710 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8270 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7455 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8314 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.9224 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.2406 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.7564 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8823 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 2.0011 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.9345 | Val  Acc: 0.6774
 Site-QuickDraw | Val  Loss: 2.2549 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6833 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.7381 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.7801 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8897 | Val  Acc: 0.6957
Average Valid Accuracy: 0.6869
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 1.9900 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.5511 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.7644 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.8107 | Train Acc: 0.7313
 Site-Clipart   | Train Loss: 1.7393 | Train Acc: 0.8214
 Site-Infograph | Train Loss: 2.1676 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8703 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.8596 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8179 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7842 | Train Acc: 0.8085
 Site-QuickDraw | Train Loss: 2.2190 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.7733 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.7118 | Train Acc: 0.9138
 Site-Sketch    | Train Loss: 1.8858 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.8727 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.9165 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8022 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7446 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.8297 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.9187 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.2479 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.7422 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8735 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9422 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8696 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2687 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6748 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.7175 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.7808 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8899 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7157
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:30 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:30 | Val Acc: 0.6607
 Best site-Infograph  | Epoch:30 | Val Acc: 0.3500
 Best site-Painting   | Epoch:30 | Val Acc: 1.0000
 Best site-Painting   | Epoch:30 | Val Acc: 0.8000
 Best site-Painting   | Epoch:30 | Val Acc: 0.6522
 Best site-Painting   | Epoch:30 | Val Acc: 0.7419
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.1250
 Best site-Real       | Epoch:30 | Val Acc: 0.9737
 Best site-Real       | Epoch:30 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:30 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:30 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 1.9497 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.8171 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.8347 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.8519 | Train Acc: 0.7313
 Site-Clipart   | Train Loss: 1.8144 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1643 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.8117 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8584 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.8129 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7744 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.2116 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.7422 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.6841 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.8838 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.8850 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.8453 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7872 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7429 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8324 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 1.8718 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.2337 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.6848 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8682 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9069 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8939 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2666 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6735 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.6945 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.7751 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8643 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7220
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:31 | Val Acc: 0.6591
 Best site-Clipart    | Epoch:31 | Val Acc: 0.7321
 Best site-Infograph  | Epoch:31 | Val Acc: 0.3500
 Best site-Painting   | Epoch:31 | Val Acc: 1.0000
 Best site-Painting   | Epoch:31 | Val Acc: 0.7333
 Best site-Painting   | Epoch:31 | Val Acc: 0.6522
 Best site-Painting   | Epoch:31 | Val Acc: 0.7419
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.1250
 Best site-Real       | Epoch:31 | Val Acc: 0.9474
 Best site-Real       | Epoch:31 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:31 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:31 | Val Acc: 0.7174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 1.9780 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8310 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.9333 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.8171 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.8053 | Train Acc: 0.8214
 Site-Infograph | Train Loss: 2.1415 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.8764 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8393 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.9302 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7283 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2113 | Train Acc: 0.1667
 Site-Real      | Train Loss: 1.7239 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.6678 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.8085 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.8634 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.8411 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7970 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7101 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7812 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8832 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.1923 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.7478 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.8379 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.9274 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8830 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2596 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.6244 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6851 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.7355 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.8509 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7134
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 1.9725 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.4810 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.8616 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.8105 | Train Acc: 0.7313
 Site-Clipart   | Train Loss: 1.7586 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1432 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.7469 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7704 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8872 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.7481 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2156 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7286 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.6550 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.7773 | Train Acc: 0.7429
 Site-Sketch    | Train Loss: 1.8283 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.8801 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7606 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6825 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7601 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8468 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2373 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.6778 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8260 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.9035 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.8488 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2563 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.6434 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6596 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.7240 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8492 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7241
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:33 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:33 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:33 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:33 | Val Acc: 0.3500
 Best site-Painting   | Epoch:33 | Val Acc: 1.0000
 Best site-Painting   | Epoch:33 | Val Acc: 0.8000
 Best site-Painting   | Epoch:33 | Val Acc: 0.6957
 Best site-Painting   | Epoch:33 | Val Acc: 0.7419
 Best site-QuickDraw  | Epoch:33 | Val Acc: 0.0938
 Best site-Real       | Epoch:33 | Val Acc: 1.0000
 Best site-Real       | Epoch:33 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:33 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:33 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.9479 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.7246 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.8132 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7696 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.7485 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1516 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.7813 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.8260 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.7940 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 1.7335 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2136 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7065 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.6348 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.8270 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.8389 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.8338 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7894 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.6821 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7912 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8748 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.1909 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5553 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8403 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.8867 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8439 | Val  Acc: 0.8387
 Site-QuickDraw | Val  Loss: 2.2535 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.6160 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6379 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.7248 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.8211 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7208
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 1.9459 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.6037 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.7484 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.7760 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.7566 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1595 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.7026 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7524 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8248 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 1.7082 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.2070 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.6742 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.6444 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.7249 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.8451 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.8691 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7305 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.6524 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7563 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8506 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2310 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6169 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.7786 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.9013 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.8409 | Val  Acc: 0.6774
 Site-QuickDraw | Val  Loss: 2.2517 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.5959 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6283 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.7120 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.8078 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7044
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 1.9634 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.5895 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.9050 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7193 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.7168 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1600 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.7921 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.7849 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.8726 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.7268 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1909 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.6643 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.6133 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.7721 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.8006 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.8045 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7800 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6386 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7424 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.8539 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.2428 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6539 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.7997 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.8657 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.8489 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2389 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.5755 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6213 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.7261 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.8039 | Val  Acc: 0.7174
Average Valid Accuracy: 0.6989
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 1.9428 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.5126 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.7991 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7890 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.6929 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 2.1571 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.7524 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.8395 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.8010 | Train Acc: 0.7714
 Site-Painting  | Train Loss: 1.7253 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2039 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.6413 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.6031 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 1.7558 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.8134 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.8088 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7230 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.6602 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.7527 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8575 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.2298 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6323 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.8260 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.8200 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 1.7971 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2427 | Val  Acc: 0.2188
 Site-Real      | Val  Loss: 1.5702 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.6169 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.7028 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.7817 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7219
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 1.9352 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.8433 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.7796 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.7222 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.7102 | Train Acc: 0.8214
 Site-Infograph | Train Loss: 2.1312 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.6886 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.7353 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8345 | Train Acc: 0.8857
 Site-Painting  | Train Loss: 1.6843 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1836 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.6659 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.5965 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.8233 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 1.7771 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.7651 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.6849 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.6227 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7833 | Val  Acc: 0.6591
 Site-Clipart   | Val  Loss: 1.8341 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 2.1754 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6599 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.7520 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.7965 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 1.8318 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2662 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 1.5267 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.5863 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.6878 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.8240 | Val  Acc: 0.7174
Average Valid Accuracy: 0.7274
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:38 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:38 | Val Acc: 0.6591
 Best site-Clipart    | Epoch:38 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:38 | Val Acc: 0.3000
 Best site-Painting   | Epoch:38 | Val Acc: 0.8571
 Best site-Painting   | Epoch:38 | Val Acc: 0.8000
 Best site-Painting   | Epoch:38 | Val Acc: 0.7391
 Best site-Painting   | Epoch:38 | Val Acc: 0.7097
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.0625
 Best site-Real       | Epoch:38 | Val Acc: 1.0000
 Best site-Real       | Epoch:38 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:38 | Val Acc: 0.7391
 Best site-Sketch     | Epoch:38 | Val Acc: 0.7174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.8738 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.6529 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.8053 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.7266 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 1.6758 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1479 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.7226 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6712 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8856 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.6894 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1988 | Train Acc: 0.2083
 Site-Real      | Train Loss: 1.6178 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.5649 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 1.6439 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.7791 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.7330 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.7125 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5574 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.6937 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.8201 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2501 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.6101 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7691 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8418 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.7977 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2461 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.5226 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.5763 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 1.6821 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7996 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7328
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:39 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:39 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:39 | Val Acc: 0.6786
 Best site-Infograph  | Epoch:39 | Val Acc: 0.3000
 Best site-Painting   | Epoch:39 | Val Acc: 1.0000
 Best site-Painting   | Epoch:39 | Val Acc: 0.7333
 Best site-Painting   | Epoch:39 | Val Acc: 0.6522
 Best site-Painting   | Epoch:39 | Val Acc: 0.7742
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.0938
 Best site-Real       | Epoch:39 | Val Acc: 0.9737
 Best site-Real       | Epoch:39 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:39 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:39 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.7814
 Test site-Infograph | Epoch:39 | Test Acc: 0.4049
 Test site-Painting  | Epoch:39 | Test Acc: 0.8110
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.2350
 Test site-Real      | Epoch:39 | Test Acc: 0.9351
 Test site-Sketch    | Epoch:39 | Test Acc: 0.7635
Average Test Accuracy: 0.6551
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 1.9049 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.3681 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.7039 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.7025 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 1.6756 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 2.1610 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.7663 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.7170 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.8374 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.6452 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.2013 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.5977 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.5843 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 1.7233 | Train Acc: 0.8286
 Site-Sketch    | Train Loss: 1.7515 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.7866 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.6607 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.5876 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.6953 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8139 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.2072 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.5772 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7448 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.8645 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.7509 | Val  Acc: 0.8710
 Site-QuickDraw | Val  Loss: 2.2423 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.5068 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.5504 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.6916 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.7420 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7315
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 1.9238 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.7378 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.9011 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.6204 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.6337 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1253 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.6967 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7559 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.7095 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.6205 | Train Acc: 0.8298
 Site-QuickDraw | Train Loss: 2.1950 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.5943 | Train Acc: 0.8966
 Site-Real      | Train Loss: 1.5383 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 1.5573 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.7513 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.7691 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.6607 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5874 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.7232 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.7682 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2243 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.5491 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7345 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8502 | Val  Acc: 0.6087
 Site-Painting  | Val  Loss: 1.7696 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2373 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.4947 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.5353 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 1.6238 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7506 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7232
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 1.9005 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.4692 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.7392 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 1.6892 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 1.6358 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 2.1376 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.6756 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7024 | Train Acc: 0.7391
 Site-Painting  | Train Loss: 1.7610 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.6575 | Train Acc: 0.7872
 Site-QuickDraw | Train Loss: 2.1894 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.5713 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.5261 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 1.7659 | Train Acc: 0.8000
 Site-Sketch    | Train Loss: 1.7467 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.7674 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.7072 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.5696 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.6712 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.8290 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.1552 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5586 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7457 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.7894 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 1.7728 | Val  Acc: 0.7419
 Site-QuickDraw | Val  Loss: 2.2362 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.4668 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.5365 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.6785 | Val  Acc: 0.6957
 Site-Sketch    | Val  Loss: 1.7617 | Val  Acc: 0.6739
Average Valid Accuracy: 0.7245
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 1.9109 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.5895 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.6645 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.7219 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 1.6135 | Train Acc: 0.7738
 Site-Infograph | Train Loss: 2.1428 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.6377 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6713 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.7500 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.5882 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 2.1873 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.5841 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.4858 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 1.6680 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 1.7687 | Train Acc: 0.7571
 Site-Clipart   | Val  Loss: 1.7348 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6808 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5368 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.7131 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.7372 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 2.1971 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.4795 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7368 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.7898 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.7721 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2360 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 1.4712 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.5253 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.5965 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7616 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7426
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:43 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:43 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:43 | Val Acc: 0.3500
 Best site-Painting   | Epoch:43 | Val Acc: 1.0000
 Best site-Painting   | Epoch:43 | Val Acc: 0.6667
 Best site-Painting   | Epoch:43 | Val Acc: 0.6957
 Best site-Painting   | Epoch:43 | Val Acc: 0.8065
 Best site-QuickDraw  | Epoch:43 | Val Acc: 0.0625
 Best site-Real       | Epoch:43 | Val Acc: 1.0000
 Best site-Real       | Epoch:43 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:43 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:43 | Val Acc: 0.7609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 1.9143 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.4435 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.7883 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.6886 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.6656 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1567 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.6705 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6633 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.7341 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.5985 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1863 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.5618 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.5240 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 1.5155 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.7367 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.7123 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.6333 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.5194 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.6740 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.7838 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.2395 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.5405 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.7068 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8205 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.7897 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2264 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.4615 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.5009 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.6031 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7025 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7399
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 1.8994 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.5976 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.7636 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.6801 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.5907 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.1212 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.6547 | Train Acc: 0.8182
 Site-Painting  | Train Loss: 1.6147 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.6307 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.5801 | Train Acc: 0.9149
 Site-QuickDraw | Train Loss: 2.1906 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.5363 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.4803 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 1.6095 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.7244 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.6631 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5802 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.5279 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.6540 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.7497 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.1817 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.4991 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.6790 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.7903 | Val  Acc: 0.6522
 Site-Painting  | Val  Loss: 1.7717 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2320 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.4196 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.4777 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.6245 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7052 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7522
 Best site-Clipart    | Epoch:45 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:45 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:45 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:45 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:45 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:45 | Val Acc: 0.4000
 Best site-Painting   | Epoch:45 | Val Acc: 1.0000
 Best site-Painting   | Epoch:45 | Val Acc: 0.8000
 Best site-Painting   | Epoch:45 | Val Acc: 0.6522
 Best site-Painting   | Epoch:45 | Val Acc: 0.7742
 Best site-QuickDraw  | Epoch:45 | Val Acc: 0.1875
 Best site-Real       | Epoch:45 | Val Acc: 1.0000
 Best site-Real       | Epoch:45 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:45 | Val Acc: 0.7826
 Best site-Sketch     | Epoch:45 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 1.8727 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.5190 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.6771 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.6414 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 1.5822 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.1087 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.6618 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.7115 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.6854 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.5987 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 2.1673 | Train Acc: 0.2708
 Site-Real      | Train Loss: 1.5438 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.4546 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 1.6383 | Train Acc: 0.8857
 Site-Sketch    | Train Loss: 1.6813 | Train Acc: 0.8143
 Site-Clipart   | Val  Loss: 1.6552 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.6158 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5092 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.5739 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7447 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2231 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.4225 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.6888 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.8073 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.7351 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2105 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.4047 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.4712 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 1.5885 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7119 | Val  Acc: 0.7609
Average Valid Accuracy: 0.7494
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 1.8643 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.3820 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.7406 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.6608 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 1.5822 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.1199 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.6446 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.5429 | Train Acc: 0.6957
 Site-Painting  | Train Loss: 1.6330 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.6023 | Train Acc: 0.8511
 Site-QuickDraw | Train Loss: 2.1778 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.5689 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.4373 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 1.6604 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.7366 | Train Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.6347 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.6342 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.4799 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.6578 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.7429 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.1845 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.4866 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.6831 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.7878 | Val  Acc: 0.7826
 Site-Painting  | Val  Loss: 1.7683 | Val  Acc: 0.7097
 Site-QuickDraw | Val  Loss: 2.2296 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.3944 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.4622 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.5479 | Val  Acc: 0.7826
 Site-Sketch    | Val  Loss: 1.7048 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7489
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 1.7973 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.4093 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.7408 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.5984 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 1.5188 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 2.1291 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.6518 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6376 | Train Acc: 0.6087
 Site-Painting  | Train Loss: 1.8211 | Train Acc: 0.7429
 Site-Painting  | Train Loss: 1.5655 | Train Acc: 0.8936
 Site-QuickDraw | Train Loss: 2.1876 | Train Acc: 0.2292
 Site-Real      | Train Loss: 1.5068 | Train Acc: 0.8966
 Site-Real      | Train Loss: 1.4707 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 1.6851 | Train Acc: 0.7714
 Site-Sketch    | Train Loss: 1.6541 | Train Acc: 0.7286
 Site-Clipart   | Val  Loss: 1.7468 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.5921 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.5175 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.6004 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.7313 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.1821 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.4903 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.6857 | Val  Acc: 0.7333
 Site-Painting  | Val  Loss: 1.7412 | Val  Acc: 0.7391
 Site-Painting  | Val  Loss: 1.7141 | Val  Acc: 0.7742
 Site-QuickDraw | Val  Loss: 2.2233 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.3959 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.4352 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.5576 | Val  Acc: 0.7391
 Site-Sketch    | Val  Loss: 1.6704 | Val  Acc: 0.8043
Average Valid Accuracy: 0.7468
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 1.8245 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.6037 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.6933 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.5602 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 1.5377 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 2.1113 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.5540 | Train Acc: 0.9091
 Site-Painting  | Train Loss: 1.6688 | Train Acc: 0.6522
 Site-Painting  | Train Loss: 1.7409 | Train Acc: 0.8000
 Site-Painting  | Train Loss: 1.5405 | Train Acc: 0.8723
 Site-QuickDraw | Train Loss: 2.1682 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.5192 | Train Acc: 0.8793
 Site-Real      | Train Loss: 1.4445 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.5301 | Train Acc: 0.9143
 Site-Sketch    | Train Loss: 1.6488 | Train Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.6069 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.6229 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.4258 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.6291 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.7315 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 2.1594 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.4667 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.6820 | Val  Acc: 0.8000
 Site-Painting  | Val  Loss: 1.7889 | Val  Acc: 0.6957
 Site-Painting  | Val  Loss: 1.6773 | Val  Acc: 0.8065
 Site-QuickDraw | Val  Loss: 2.2183 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.3929 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 1.4286 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.5551 | Val  Acc: 0.8261
 Site-Sketch    | Val  Loss: 1.7059 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7619
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:49 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:49 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:49 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:49 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:49 | Val Acc: 0.4000
 Best site-Painting   | Epoch:49 | Val Acc: 1.0000
 Best site-Painting   | Epoch:49 | Val Acc: 0.8000
 Best site-Painting   | Epoch:49 | Val Acc: 0.6957
 Best site-Painting   | Epoch:49 | Val Acc: 0.8065
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.1562
 Best site-Real       | Epoch:49 | Val Acc: 0.9737
 Best site-Real       | Epoch:49 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:49 | Val Acc: 0.8261
 Best site-Sketch     | Epoch:49 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-3_1/fedavg...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8042
 Test site-Infograph | Epoch:49 | Test Acc: 0.4186
 Test site-Painting  | Epoch:49 | Test Acc: 0.8191
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.2650
 Test site-Real      | Epoch:49 | Test Acc: 0.9417
 Test site-Sketch    | Epoch:49 | Test Acc: 0.7816
Average Test Accuracy: 0.6717
===2023-04-27 15:26:27===
===2023-04-27 15:26:28===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,11,23,35,47,48,58,116,35,70,]
label set of clients: [10, 10, 10, 10, 10, 10, 7, 10, 10, 10, 10, 10, 10, 9, 10, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8042
 Test site-Infograph | Epoch:49 | Test Acc: 0.4186
 Test site-Painting  | Epoch:49 | Test Acc: 0.8191
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.2650
 Test site-Real      | Epoch:49 | Test Acc: 0.9417
 Test site-Sketch    | Epoch:49 | Test Acc: 0.7816
Average Test Accuracy: 0.6717
