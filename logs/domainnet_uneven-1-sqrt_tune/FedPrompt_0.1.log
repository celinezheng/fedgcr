===2023-03-27 13:37:59===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.1
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 1.9220 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 1.8969 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.8311 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.9073 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 2.1887 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1243 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0649 | Train Acc: 0.3175
 Site-Painting  | Train Loss: 1.9241 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 1.9694 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 2.3218 | Train Acc: 0.0952
 Site-Real      | Train Loss: 1.8474 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 1.8777 | Train Acc: 0.5556
 Site-Clipart   | Val  Loss: 1.8131 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.8198 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9026 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9953 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.0844 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.0871 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1627 | Val  Acc: 0.1667
 Site-Painting  | Val  Loss: 1.8207 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 2.0905 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2433 | Val  Acc: 0.1190
 Site-Real      | Val  Loss: 1.9080 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.9714 | Val  Acc: 0.4524
Average Valid Accuracy: 0.3849
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1667
 Best site-Painting   | Epoch:0 | Val Acc: 0.5238
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1190
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.4967 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.5733 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.4099 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.3981 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 2.0435 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.8852 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.7816 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.4175 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 1.4711 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.1794 | Train Acc: 0.2698
 Site-Real      | Train Loss: 1.2938 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.3530 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.2813 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.3403 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5692 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5748 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.8506 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8928 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0671 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.2695 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 1.5893 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.1335 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3607 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.5518 | Val  Acc: 0.5714
Average Valid Accuracy: 0.5536
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Painting   | Epoch:1 | Val Acc: 0.7619
 Best site-Painting   | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2381
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.1332 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.1721 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.0352 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.9761 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.8815 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.7510 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.6202 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.0340 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 1.0152 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.1080 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.9060 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.0140 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.8683 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.9794 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1834 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.1808 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6456 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.5974 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.8053 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.9131 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.1617 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 2.1116 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9399 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.2260 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6825
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Painting   | Epoch:2 | Val Acc: 0.8571
 Best site-Painting   | Epoch:2 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3333
 Best site-Real       | Epoch:2 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.8551 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9759 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.7755 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6851 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.7312 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5459 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.4293 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 0.7752 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.7790 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.9786 | Train Acc: 0.3968
 Site-Real      | Train Loss: 0.5805 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.7736 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.6191 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6193 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.9922 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9967 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6098 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.4186 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7999 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.6648 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.8962 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.9155 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7042 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9700 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7163
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.9048
 Best site-Painting   | Epoch:3 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3810
 Best site-Real       | Epoch:3 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.6449 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7715 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.5573 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4748 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.5389 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.2966 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.1602 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.5825 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.5718 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.8607 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.4480 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5796 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.4405 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5800 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7112 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6846 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.3211 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2328 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5831 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4662 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.6816 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.9816 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5540 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8218 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7639
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Painting   | Epoch:4 | Val Acc: 0.9524
 Best site-Painting   | Epoch:4 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2857
 Best site-Real       | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.4562 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5929 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.3997 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3214 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.4355 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.1623 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.9992 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4699 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.4158 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.7676 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.3808 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.4214 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.3025 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3756 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.6749 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4871 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.2627 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1162 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4332 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.3758 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.5326 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.9561 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.4147 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7914 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7877
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5238
 Best site-Painting   | Epoch:5 | Val Acc: 0.9762
 Best site-Painting   | Epoch:5 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3095
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.3700 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4342 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3594 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2188 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.2602 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.1791 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0528 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.2820 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.3394 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.6092 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.2789 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4974 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.2154 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2830 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5769 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.3840 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 1.0971 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0339 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.4135 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.2518 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3534 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.8462 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.3244 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7172 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7976
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5000
 Best site-Painting   | Epoch:6 | Val Acc: 1.0000
 Best site-Painting   | Epoch:6 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3333
 Best site-Real       | Epoch:6 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.2598 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4379 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2243 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1796 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.3332 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 0.9594 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.9897 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2410 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2592 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.5006 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.2061 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2597 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1977 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2176 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4803 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4380 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.0504 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.9054 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2228 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.1696 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2995 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.8117 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3042 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6625 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8155
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Painting   | Epoch:7 | Val Acc: 1.0000
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4286
 Best site-Real       | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2318 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3061 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2460 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1456 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0334 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8016 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.7323 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1750 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1310 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.4408 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.2154 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2150 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1706 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2073 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3083 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2796 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7645 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.7154 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0898 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.1229 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1890 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.8176 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.3018 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7117 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8512
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3810
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2026 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2328 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1709 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0898 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.0619 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.6381 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.7911 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1303 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1844 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.4035 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.1510 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.1677 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.1109 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1201 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2245 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2645 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8483 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.8128 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0618 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.1321 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.1826 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.8407 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.2486 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6263 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8413
===2023-03-27 14:11:15===
===2023-03-27 14:11:16===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.1
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.8422
 Test site-Infograph | Epoch:8 | Test Acc: 0.4795
 Test site-Painting  | Epoch:8 | Test Acc: 0.8465
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.3980
 Test site-Real      | Epoch:8 | Test Acc: 0.9269
 Test site-Sketch    | Epoch:8 | Test Acc: 0.8032
Average Test Accuracy: 0.7161
