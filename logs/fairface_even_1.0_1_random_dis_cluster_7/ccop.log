===2023-05-25 03:04:09===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 1, 3, 6, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.8032 | Train Acc: 0.3741
 Site-White                    | Train Loss: 1.7639 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.8974 | Train Acc: 0.2734
 Site-Latino_Hispanic          | Train Loss: 1.8632 | Train Acc: 0.2638
 Site-Black                    | Train Loss: 2.0082 | Train Acc: 0.2014
 Site-Black                    | Train Loss: 1.9084 | Train Acc: 0.2542
 Site-East_Asian               | Train Loss: 1.7791 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.7840 | Train Acc: 0.3789
 Site-Indian                   | Train Loss: 1.9826 | Train Acc: 0.2590
 Site-Indian                   | Train Loss: 2.0528 | Train Acc: 0.2446
 Site-Southeast_Asian          | Train Loss: 1.9425 | Train Acc: 0.3309
 Site-Southeast_Asian          | Train Loss: 1.9893 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.9342 | Train Acc: 0.2374
 Site-Middle_Eastern           | Train Loss: 1.9351 | Train Acc: 0.2734
 Site-White                     (2) | Val  Loss: 1.8411 | Val  Acc: 0.3152
 Site-White                     (5) | Val  Loss: 1.7778 | Val  Acc: 0.3381
 Site-Latino_Hispanic           (3) | Val  Loss: 1.9175 | Val  Acc: 0.3043
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8637 | Val  Acc: 0.2770
 Site-Black                     (6) | Val  Loss: 1.8671 | Val  Acc: 0.3261
 Site-Black                     (0) | Val  Loss: 1.9050 | Val  Acc: 0.2662
 Site-East_Asian                (4) | Val  Loss: 1.6755 | Val  Acc: 0.4348
 Site-East_Asian                (3) | Val  Loss: 1.7556 | Val  Acc: 0.3741
 Site-Indian                    (3) | Val  Loss: 2.0328 | Val  Acc: 0.2283
 Site-Indian                    (2) | Val  Loss: 2.0327 | Val  Acc: 0.2302
 Site-Southeast_Asian           (3) | Val  Loss: 1.9821 | Val  Acc: 0.2826
 Site-Southeast_Asian           (3) | Val  Loss: 1.9517 | Val  Acc: 0.3237
 Site-Middle_Eastern            (2) | Val  Loss: 1.8755 | Val  Acc: 0.2717
 Site-Middle_Eastern            (1) | Val  Loss: 1.8974 | Val  Acc: 0.2806
Average Valid Accuracy: 0.3038
Aggregated Acc | Val Acc: 0.3166
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.3152
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.3381
 Best site-Latino_Hispanic          (3)  | Epoch:0 | Val Acc: 0.3043
 Best site-Latino_Hispanic          (3)  | Epoch:0 | Val Acc: 0.2770
 Best site-Black                    (6)  | Epoch:0 | Val Acc: 0.3261
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.2662
 Best site-East_Asian               (4)  | Epoch:0 | Val Acc: 0.4348
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.3741
 Best site-Indian                   (3)  | Epoch:0 | Val Acc: 0.2283
 Best site-Indian                   (2)  | Epoch:0 | Val Acc: 0.2302
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2826
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3237
 Best site-Middle_Eastern           (2)  | Epoch:0 | Val Acc: 0.2717
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.2806
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 3, 1, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7453 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.7628 | Train Acc: 0.3717
 Site-Latino_Hispanic          | Train Loss: 1.8340 | Train Acc: 0.3094
 Site-Latino_Hispanic          | Train Loss: 1.8574 | Train Acc: 0.3070
 Site-Black                    | Train Loss: 1.9305 | Train Acc: 0.2158
 Site-Black                    | Train Loss: 1.8489 | Train Acc: 0.2614
 Site-East_Asian               | Train Loss: 1.6700 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.7197 | Train Acc: 0.3957
 Site-Indian                   | Train Loss: 1.8626 | Train Acc: 0.3022
 Site-Indian                   | Train Loss: 1.8825 | Train Acc: 0.2566
 Site-Southeast_Asian          | Train Loss: 1.8489 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.8276 | Train Acc: 0.3477
 Site-Middle_Eastern           | Train Loss: 1.8219 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.7769 | Train Acc: 0.3094
 Site-White                     (0) | Val  Loss: 1.8025 | Val  Acc: 0.2717
 Site-White                     (4) | Val  Loss: 1.7036 | Val  Acc: 0.3453
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8546 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7951 | Val  Acc: 0.3094
 Site-Black                     (6) | Val  Loss: 1.8042 | Val  Acc: 0.3804
 Site-Black                     (5) | Val  Loss: 1.8347 | Val  Acc: 0.2842
 Site-East_Asian                (4) | Val  Loss: 1.6180 | Val  Acc: 0.4239
 Site-East_Asian                (3) | Val  Loss: 1.6668 | Val  Acc: 0.4029
 Site-Indian                    (3) | Val  Loss: 1.9490 | Val  Acc: 0.2826
 Site-Indian                    (3) | Val  Loss: 1.9160 | Val  Acc: 0.2266
 Site-Southeast_Asian           (1) | Val  Loss: 1.8623 | Val  Acc: 0.3261
 Site-Southeast_Asian           (1) | Val  Loss: 1.8364 | Val  Acc: 0.3273
 Site-Middle_Eastern            (2) | Val  Loss: 1.7482 | Val  Acc: 0.4239
 Site-Middle_Eastern            (4) | Val  Loss: 1.8019 | Val  Acc: 0.3094
Average Valid Accuracy: 0.3314
Aggregated Acc | Val Acc: 0.3338
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.2717
 Best site-White                    (4)  | Epoch:1 | Val Acc: 0.3453
 Best site-Latino_Hispanic          (4)  | Epoch:1 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (1)  | Epoch:1 | Val Acc: 0.3094
 Best site-Black                    (6)  | Epoch:1 | Val Acc: 0.3804
 Best site-Black                    (5)  | Epoch:1 | Val Acc: 0.2842
 Best site-East_Asian               (4)  | Epoch:1 | Val Acc: 0.4239
 Best site-East_Asian               (3)  | Epoch:1 | Val Acc: 0.4029
 Best site-Indian                   (3)  | Epoch:1 | Val Acc: 0.2826
 Best site-Indian                   (3)  | Epoch:1 | Val Acc: 0.2266
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.3261
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.3273
 Best site-Middle_Eastern           (2)  | Epoch:1 | Val Acc: 0.4239
 Best site-Middle_Eastern           (4)  | Epoch:1 | Val Acc: 0.3094
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 5, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6921 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.6763 | Train Acc: 0.3933
 Site-Latino_Hispanic          | Train Loss: 1.7502 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.7228 | Train Acc: 0.3549
 Site-Black                    | Train Loss: 1.8542 | Train Acc: 0.2806
 Site-Black                    | Train Loss: 1.8017 | Train Acc: 0.3285
 Site-East_Asian               | Train Loss: 1.6172 | Train Acc: 0.4173
 Site-East_Asian               | Train Loss: 1.5869 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.6719 | Train Acc: 0.3597
 Site-Indian                   | Train Loss: 1.7627 | Train Acc: 0.3094
 Site-Southeast_Asian          | Train Loss: 1.7078 | Train Acc: 0.3741
 Site-Southeast_Asian          | Train Loss: 1.6983 | Train Acc: 0.3741
 Site-Middle_Eastern           | Train Loss: 1.6926 | Train Acc: 0.3597
 Site-Middle_Eastern           | Train Loss: 1.6364 | Train Acc: 0.4077
 Site-White                     (0) | Val  Loss: 1.6228 | Val  Acc: 0.3804
 Site-White                     (0) | Val  Loss: 1.6619 | Val  Acc: 0.3705
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7293 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (2) | Val  Loss: 1.6995 | Val  Acc: 0.3345
 Site-Black                     (4) | Val  Loss: 1.6960 | Val  Acc: 0.4022
 Site-Black                     (3) | Val  Loss: 1.7955 | Val  Acc: 0.3165
 Site-East_Asian                (6) | Val  Loss: 1.5203 | Val  Acc: 0.5652
 Site-East_Asian                (5) | Val  Loss: 1.5661 | Val  Acc: 0.4604
 Site-Indian                    (2) | Val  Loss: 1.8413 | Val  Acc: 0.2935
 Site-Indian                    (2) | Val  Loss: 1.7609 | Val  Acc: 0.3094
 Site-Southeast_Asian           (5) | Val  Loss: 1.6952 | Val  Acc: 0.3913
 Site-Southeast_Asian           (2) | Val  Loss: 1.6908 | Val  Acc: 0.4101
 Site-Middle_Eastern            (1) | Val  Loss: 1.6165 | Val  Acc: 0.4457
 Site-Middle_Eastern            (1) | Val  Loss: 1.6595 | Val  Acc: 0.3885
Average Valid Accuracy: 0.3907
Aggregated Acc | Val Acc: 0.4075
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.3804
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.3705
 Best site-Latino_Hispanic          (2)  | Epoch:2 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (2)  | Epoch:2 | Val Acc: 0.3345
 Best site-Black                    (4)  | Epoch:2 | Val Acc: 0.4022
 Best site-Black                    (3)  | Epoch:2 | Val Acc: 0.3165
 Best site-East_Asian               (6)  | Epoch:2 | Val Acc: 0.5652
 Best site-East_Asian               (5)  | Epoch:2 | Val Acc: 0.4604
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2935
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.3094
 Best site-Southeast_Asian          (5)  | Epoch:2 | Val Acc: 0.3913
 Best site-Southeast_Asian          (2)  | Epoch:2 | Val Acc: 0.4101
 Best site-Middle_Eastern           (1)  | Epoch:2 | Val Acc: 0.4457
 Best site-Middle_Eastern           (1)  | Epoch:2 | Val Acc: 0.3885
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 3 ============
cnt=[3, 2, 2, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6048 | Train Acc: 0.4029
 Site-White                    | Train Loss: 1.5798 | Train Acc: 0.4197
 Site-Latino_Hispanic          | Train Loss: 1.6911 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.6901 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.7739 | Train Acc: 0.3237
 Site-Black                    | Train Loss: 1.7712 | Train Acc: 0.3118
 Site-East_Asian               | Train Loss: 1.5103 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.5060 | Train Acc: 0.4269
 Site-Indian                   | Train Loss: 1.5789 | Train Acc: 0.3957
 Site-Indian                   | Train Loss: 1.7030 | Train Acc: 0.3333
 Site-Southeast_Asian          | Train Loss: 1.6385 | Train Acc: 0.4101
 Site-Southeast_Asian          | Train Loss: 1.7037 | Train Acc: 0.4149
 Site-Middle_Eastern           | Train Loss: 1.5857 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.5945 | Train Acc: 0.4101
 Site-White                     (5) | Val  Loss: 1.5929 | Val  Acc: 0.4130
 Site-White                     (5) | Val  Loss: 1.5890 | Val  Acc: 0.4101
 Site-Latino_Hispanic           (0) | Val  Loss: 1.6804 | Val  Acc: 0.3696
 Site-Latino_Hispanic           (6) | Val  Loss: 1.6433 | Val  Acc: 0.3669
 Site-Black                     (2) | Val  Loss: 1.5846 | Val  Acc: 0.4348
 Site-Black                     (2) | Val  Loss: 1.7164 | Val  Acc: 0.3129
 Site-East_Asian                (1) | Val  Loss: 1.4458 | Val  Acc: 0.4891
 Site-East_Asian                (1) | Val  Loss: 1.4916 | Val  Acc: 0.4604
 Site-Indian                    (0) | Val  Loss: 1.7426 | Val  Acc: 0.2174
 Site-Indian                    (0) | Val  Loss: 1.6946 | Val  Acc: 0.2950
 Site-Southeast_Asian           (3) | Val  Loss: 1.6114 | Val  Acc: 0.4239
 Site-Southeast_Asian           (3) | Val  Loss: 1.6129 | Val  Acc: 0.4281
 Site-Middle_Eastern            (4) | Val  Loss: 1.5865 | Val  Acc: 0.4239
 Site-Middle_Eastern            (4) | Val  Loss: 1.6105 | Val  Acc: 0.4173
Average Valid Accuracy: 0.3902
Aggregated Acc | Val Acc: 0.3954
============ Train epoch 4 ============
cnt=[2, 3, 1, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6011 | Train Acc: 0.3957
 Site-White                    | Train Loss: 1.5531 | Train Acc: 0.4125
 Site-Latino_Hispanic          | Train Loss: 1.6719 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.5824 | Train Acc: 0.3789
 Site-Black                    | Train Loss: 1.7600 | Train Acc: 0.2806
 Site-Black                    | Train Loss: 1.6939 | Train Acc: 0.3549
 Site-East_Asian               | Train Loss: 1.4840 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.4540 | Train Acc: 0.4412
 Site-Indian                   | Train Loss: 1.5258 | Train Acc: 0.4029
 Site-Indian                   | Train Loss: 1.6234 | Train Acc: 0.3501
 Site-Southeast_Asian          | Train Loss: 1.5751 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.6142 | Train Acc: 0.4269
 Site-Middle_Eastern           | Train Loss: 1.5714 | Train Acc: 0.3885
 Site-Middle_Eastern           | Train Loss: 1.4852 | Train Acc: 0.4245
 Site-White                     (6) | Val  Loss: 1.5405 | Val  Acc: 0.3913
 Site-White                     (6) | Val  Loss: 1.5327 | Val  Acc: 0.4245
 Site-Latino_Hispanic           (3) | Val  Loss: 1.6123 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (3) | Val  Loss: 1.5930 | Val  Acc: 0.3921
 Site-Black                     (1) | Val  Loss: 1.5501 | Val  Acc: 0.4674
 Site-Black                     (1) | Val  Loss: 1.6686 | Val  Acc: 0.3453
 Site-East_Asian                (0) | Val  Loss: 1.3795 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.4507 | Val  Acc: 0.4892
 Site-Indian                    (4) | Val  Loss: 1.6639 | Val  Acc: 0.3261
 Site-Indian                    (1) | Val  Loss: 1.6505 | Val  Acc: 0.3345
 Site-Southeast_Asian           (5) | Val  Loss: 1.5750 | Val  Acc: 0.3804
 Site-Southeast_Asian           (5) | Val  Loss: 1.5366 | Val  Acc: 0.4676
 Site-Middle_Eastern            (4) | Val  Loss: 1.5393 | Val  Acc: 0.4457
 Site-Middle_Eastern            (2) | Val  Loss: 1.5460 | Val  Acc: 0.4388
Average Valid Accuracy: 0.4201
Aggregated Acc | Val Acc: 0.4241
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.3913
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.4245
 Best site-Latino_Hispanic          (3)  | Epoch:4 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (3)  | Epoch:4 | Val Acc: 0.3921
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.4674
 Best site-Black                    (1)  | Epoch:4 | Val Acc: 0.3453
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.5652
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.4892
 Best site-Indian                   (4)  | Epoch:4 | Val Acc: 0.3261
 Best site-Indian                   (1)  | Epoch:4 | Val Acc: 0.3345
 Best site-Southeast_Asian          (5)  | Epoch:4 | Val Acc: 0.3804
 Best site-Southeast_Asian          (5)  | Epoch:4 | Val Acc: 0.4676
 Best site-Middle_Eastern           (4)  | Epoch:4 | Val Acc: 0.4457
 Best site-Middle_Eastern           (2)  | Epoch:4 | Val Acc: 0.4388
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 1, 2, 1, 1, 6, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.5417 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.4605 | Train Acc: 0.4412
 Site-Latino_Hispanic          | Train Loss: 1.6763 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.5605 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.7572 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 1.6410 | Train Acc: 0.3717
 Site-East_Asian               | Train Loss: 1.4795 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.4770 | Train Acc: 0.4580
 Site-Indian                   | Train Loss: 1.4891 | Train Acc: 0.4388
 Site-Indian                   | Train Loss: 1.5955 | Train Acc: 0.3789
 Site-Southeast_Asian          | Train Loss: 1.5959 | Train Acc: 0.3741
 Site-Southeast_Asian          | Train Loss: 1.5258 | Train Acc: 0.4269
 Site-Middle_Eastern           | Train Loss: 1.5478 | Train Acc: 0.3813
 Site-Middle_Eastern           | Train Loss: 1.4824 | Train Acc: 0.4412
 Site-White                     (0) | Val  Loss: 1.4923 | Val  Acc: 0.4457
 Site-White                     (3) | Val  Loss: 1.4858 | Val  Acc: 0.4281
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5658 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (5) | Val  Loss: 1.5633 | Val  Acc: 0.3777
 Site-Black                     (5) | Val  Loss: 1.5016 | Val  Acc: 0.4891
 Site-Black                     (6) | Val  Loss: 1.6529 | Val  Acc: 0.3633
 Site-East_Asian                (2) | Val  Loss: 1.3647 | Val  Acc: 0.5543
 Site-East_Asian                (5) | Val  Loss: 1.4462 | Val  Acc: 0.4532
 Site-Indian                    (5) | Val  Loss: 1.6019 | Val  Acc: 0.3587
 Site-Indian                    (4) | Val  Loss: 1.6135 | Val  Acc: 0.3525
 Site-Southeast_Asian           (1) | Val  Loss: 1.5220 | Val  Acc: 0.4457
 Site-Southeast_Asian           (2) | Val  Loss: 1.5254 | Val  Acc: 0.4388
 Site-Middle_Eastern            (5) | Val  Loss: 1.4850 | Val  Acc: 0.4674
 Site-Middle_Eastern            (5) | Val  Loss: 1.5241 | Val  Acc: 0.4245
Average Valid Accuracy: 0.4294
Aggregated Acc | Val Acc: 0.4206
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.4457
 Best site-White                    (3)  | Epoch:5 | Val Acc: 0.4281
 Best site-Latino_Hispanic          (0)  | Epoch:5 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (5)  | Epoch:5 | Val Acc: 0.3777
 Best site-Black                    (5)  | Epoch:5 | Val Acc: 0.4891
 Best site-Black                    (6)  | Epoch:5 | Val Acc: 0.3633
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.5543
 Best site-East_Asian               (5)  | Epoch:5 | Val Acc: 0.4532
 Best site-Indian                   (5)  | Epoch:5 | Val Acc: 0.3587
 Best site-Indian                   (4)  | Epoch:5 | Val Acc: 0.3525
 Best site-Southeast_Asian          (1)  | Epoch:5 | Val Acc: 0.4457
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.4388
 Best site-Middle_Eastern           (5)  | Epoch:5 | Val Acc: 0.4674
 Best site-Middle_Eastern           (5)  | Epoch:5 | Val Acc: 0.4245
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 2, 2, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.4746 | Train Acc: 0.4173
 Site-White                    | Train Loss: 1.4597 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.6785 | Train Acc: 0.3381
 Site-Latino_Hispanic          | Train Loss: 1.5801 | Train Acc: 0.3909
 Site-Black                    | Train Loss: 1.7157 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.6352 | Train Acc: 0.4005
 Site-East_Asian               | Train Loss: 1.4133 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.4440 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.4833 | Train Acc: 0.4101
 Site-Indian                   | Train Loss: 1.5839 | Train Acc: 0.3813
 Site-Southeast_Asian          | Train Loss: 1.4840 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.5806 | Train Acc: 0.4436
 Site-Middle_Eastern           | Train Loss: 1.4927 | Train Acc: 0.3957
 Site-Middle_Eastern           | Train Loss: 1.4693 | Train Acc: 0.4388
 Site-White                     (0) | Val  Loss: 1.4651 | Val  Acc: 0.4130
 Site-White                     (0) | Val  Loss: 1.4532 | Val  Acc: 0.4460
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5683 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (4) | Val  Loss: 1.5324 | Val  Acc: 0.4209
 Site-Black                     (6) | Val  Loss: 1.5114 | Val  Acc: 0.4783
 Site-Black                     (1) | Val  Loss: 1.6410 | Val  Acc: 0.3849
 Site-East_Asian                (5) | Val  Loss: 1.3180 | Val  Acc: 0.5435
 Site-East_Asian                (0) | Val  Loss: 1.3941 | Val  Acc: 0.4568
 Site-Indian                    (3) | Val  Loss: 1.7090 | Val  Acc: 0.2826
 Site-Indian                    (1) | Val  Loss: 1.5638 | Val  Acc: 0.3669
 Site-Southeast_Asian           (2) | Val  Loss: 1.4618 | Val  Acc: 0.4674
 Site-Southeast_Asian           (2) | Val  Loss: 1.4853 | Val  Acc: 0.4748
 Site-Middle_Eastern            (3) | Val  Loss: 1.4637 | Val  Acc: 0.5000
 Site-Middle_Eastern            (3) | Val  Loss: 1.4812 | Val  Acc: 0.4388
Average Valid Accuracy: 0.4332
Aggregated Acc | Val Acc: 0.4458
 Best site-White                    (0)  | Epoch:6 | Val Acc: 0.4130
 Best site-White                    (0)  | Epoch:6 | Val Acc: 0.4460
 Best site-Latino_Hispanic          (4)  | Epoch:6 | Val Acc: 0.3913
 Best site-Latino_Hispanic          (4)  | Epoch:6 | Val Acc: 0.4209
 Best site-Black                    (6)  | Epoch:6 | Val Acc: 0.4783
 Best site-Black                    (1)  | Epoch:6 | Val Acc: 0.3849
 Best site-East_Asian               (5)  | Epoch:6 | Val Acc: 0.5435
 Best site-East_Asian               (0)  | Epoch:6 | Val Acc: 0.4568
 Best site-Indian                   (3)  | Epoch:6 | Val Acc: 0.2826
 Best site-Indian                   (1)  | Epoch:6 | Val Acc: 0.3669
 Best site-Southeast_Asian          (2)  | Epoch:6 | Val Acc: 0.4674
 Best site-Southeast_Asian          (2)  | Epoch:6 | Val Acc: 0.4748
 Best site-Middle_Eastern           (3)  | Epoch:6 | Val Acc: 0.5000
 Best site-Middle_Eastern           (3)  | Epoch:6 | Val Acc: 0.4388
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 1, 2, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.5001 | Train Acc: 0.4173
 Site-White                    | Train Loss: 1.4125 | Train Acc: 0.4293
 Site-Latino_Hispanic          | Train Loss: 1.6333 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.5642 | Train Acc: 0.4125
 Site-Black                    | Train Loss: 1.7458 | Train Acc: 0.3165
 Site-Black                    | Train Loss: 1.6238 | Train Acc: 0.3717
 Site-East_Asian               | Train Loss: 1.4338 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.4352 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.4438 | Train Acc: 0.4317
 Site-Indian                   | Train Loss: 1.5292 | Train Acc: 0.3741
 Site-Southeast_Asian          | Train Loss: 1.5040 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.4657 | Train Acc: 0.4580
 Site-Middle_Eastern           | Train Loss: 1.4368 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.4165 | Train Acc: 0.4556
 Site-White                     (5) | Val  Loss: 1.4984 | Val  Acc: 0.4022
 Site-White                     (6) | Val  Loss: 1.4460 | Val  Acc: 0.4353
 Site-Latino_Hispanic           (0) | Val  Loss: 1.5508 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (0) | Val  Loss: 1.4996 | Val  Acc: 0.4101
 Site-Black                     (4) | Val  Loss: 1.5017 | Val  Acc: 0.4783
 Site-Black                     (1) | Val  Loss: 1.6118 | Val  Acc: 0.4065
 Site-East_Asian                (2) | Val  Loss: 1.3060 | Val  Acc: 0.5761
 Site-East_Asian                (3) | Val  Loss: 1.3984 | Val  Acc: 0.4892
 Site-Indian                    (3) | Val  Loss: 1.6250 | Val  Acc: 0.2826
 Site-Indian                    (3) | Val  Loss: 1.5514 | Val  Acc: 0.3777
 Site-Southeast_Asian           (3) | Val  Loss: 1.4742 | Val  Acc: 0.4457
 Site-Southeast_Asian           (2) | Val  Loss: 1.4462 | Val  Acc: 0.4604
 Site-Middle_Eastern            (0) | Val  Loss: 1.4451 | Val  Acc: 0.4565
 Site-Middle_Eastern            (3) | Val  Loss: 1.4739 | Val  Acc: 0.4209
Average Valid Accuracy: 0.4309
Aggregated Acc | Val Acc: 0.4376
============ Train epoch 8 ============
cnt=[1, 3, 5, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.4503 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.4348 | Train Acc: 0.4436
 Site-Latino_Hispanic          | Train Loss: 1.5995 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.5319 | Train Acc: 0.3981
 Site-Black                    | Train Loss: 1.7294 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.5609 | Train Acc: 0.3837
 Site-East_Asian               | Train Loss: 1.4277 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.3844 | Train Acc: 0.4724
 Site-Indian                   | Train Loss: 1.4327 | Train Acc: 0.4388
 Site-Indian                   | Train Loss: 1.5380 | Train Acc: 0.4149
 Site-Southeast_Asian          | Train Loss: 1.4849 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4505 | Train Acc: 0.4556
 Site-Middle_Eastern           | Train Loss: 1.4444 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.4358 | Train Acc: 0.4484
 Site-White                     (0) | Val  Loss: 1.4432 | Val  Acc: 0.4022
 Site-White                     (1) | Val  Loss: 1.4003 | Val  Acc: 0.4460
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5562 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4905 | Val  Acc: 0.4065
 Site-Black                     (3) | Val  Loss: 1.4577 | Val  Acc: 0.4783
 Site-Black                     (2) | Val  Loss: 1.5918 | Val  Acc: 0.4173
 Site-East_Asian                (5) | Val  Loss: 1.3048 | Val  Acc: 0.5870
 Site-East_Asian                (2) | Val  Loss: 1.3905 | Val  Acc: 0.4892
 Site-Indian                    (2) | Val  Loss: 1.5777 | Val  Acc: 0.3913
 Site-Indian                    (2) | Val  Loss: 1.4882 | Val  Acc: 0.3957
 Site-Southeast_Asian           (1) | Val  Loss: 1.4524 | Val  Acc: 0.4565
 Site-Southeast_Asian           (2) | Val  Loss: 1.4335 | Val  Acc: 0.4604
 Site-Middle_Eastern            (4) | Val  Loss: 1.4220 | Val  Acc: 0.4891
 Site-Middle_Eastern            (4) | Val  Loss: 1.4101 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4487
Aggregated Acc | Val Acc: 0.4580
 Best site-White                    (0)  | Epoch:8 | Val Acc: 0.4022
 Best site-White                    (1)  | Epoch:8 | Val Acc: 0.4460
 Best site-Latino_Hispanic          (6)  | Epoch:8 | Val Acc: 0.3913
 Best site-Latino_Hispanic          (1)  | Epoch:8 | Val Acc: 0.4065
 Best site-Black                    (3)  | Epoch:8 | Val Acc: 0.4783
 Best site-Black                    (2)  | Epoch:8 | Val Acc: 0.4173
 Best site-East_Asian               (5)  | Epoch:8 | Val Acc: 0.5870
 Best site-East_Asian               (2)  | Epoch:8 | Val Acc: 0.4892
 Best site-Indian                   (2)  | Epoch:8 | Val Acc: 0.3913
 Best site-Indian                   (2)  | Epoch:8 | Val Acc: 0.3957
 Best site-Southeast_Asian          (1)  | Epoch:8 | Val Acc: 0.4565
 Best site-Southeast_Asian          (2)  | Epoch:8 | Val Acc: 0.4604
 Best site-Middle_Eastern           (4)  | Epoch:8 | Val Acc: 0.4891
 Best site-Middle_Eastern           (4)  | Epoch:8 | Val Acc: 0.4712
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 3, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.4167 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.3840 | Train Acc: 0.4556
 Site-Latino_Hispanic          | Train Loss: 1.6200 | Train Acc: 0.3669
 Site-Latino_Hispanic          | Train Loss: 1.4667 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.6603 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.5945 | Train Acc: 0.4125
 Site-East_Asian               | Train Loss: 1.4174 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.4155 | Train Acc: 0.4412
 Site-Indian                   | Train Loss: 1.3901 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.5482 | Train Acc: 0.3813
 Site-Southeast_Asian          | Train Loss: 1.4570 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4731 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.4426 | Train Acc: 0.4029
 Site-Middle_Eastern           | Train Loss: 1.3731 | Train Acc: 0.4820
 Site-White                     (5) | Val  Loss: 1.4364 | Val  Acc: 0.4457
 Site-White                     (2) | Val  Loss: 1.4009 | Val  Acc: 0.4604
 Site-Latino_Hispanic           (6) | Val  Loss: 1.5021 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4623 | Val  Acc: 0.4137
 Site-Black                     (4) | Val  Loss: 1.4419 | Val  Acc: 0.5109
 Site-Black                     (4) | Val  Loss: 1.5682 | Val  Acc: 0.4137
 Site-East_Asian                (0) | Val  Loss: 1.3055 | Val  Acc: 0.5543
 Site-East_Asian                (0) | Val  Loss: 1.3702 | Val  Acc: 0.5072
 Site-Indian                    (3) | Val  Loss: 1.5283 | Val  Acc: 0.3587
 Site-Indian                    (1) | Val  Loss: 1.5218 | Val  Acc: 0.3993
 Site-Southeast_Asian           (1) | Val  Loss: 1.4081 | Val  Acc: 0.4348
 Site-Southeast_Asian           (1) | Val  Loss: 1.4223 | Val  Acc: 0.5000
 Site-Middle_Eastern            (3) | Val  Loss: 1.4578 | Val  Acc: 0.4891
 Site-Middle_Eastern            (3) | Val  Loss: 1.4197 | Val  Acc: 0.4353
Average Valid Accuracy: 0.4518
Aggregated Acc | Val Acc: 0.4529
 Best site-White                    (5)  | Epoch:9 | Val Acc: 0.4457
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.4604
 Best site-Latino_Hispanic          (6)  | Epoch:9 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (3)  | Epoch:9 | Val Acc: 0.4137
 Best site-Black                    (4)  | Epoch:9 | Val Acc: 0.5109
 Best site-Black                    (4)  | Epoch:9 | Val Acc: 0.4137
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.5543
 Best site-East_Asian               (0)  | Epoch:9 | Val Acc: 0.5072
 Best site-Indian                   (3)  | Epoch:9 | Val Acc: 0.3587
 Best site-Indian                   (1)  | Epoch:9 | Val Acc: 0.3993
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.4348
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.5000
 Best site-Middle_Eastern           (3)  | Epoch:9 | Val Acc: 0.4891
 Best site-Middle_Eastern           (3)  | Epoch:9 | Val Acc: 0.4353
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
 Test site-White                    | Epoch:9 | Test Acc: 0.4171
 Test site-Latino_Hispanic          | Epoch:9 | Test Acc: 0.3418
 Test site-Black                    | Epoch:9 | Test Acc: 0.3000
 Test site-East_Asian               | Epoch:9 | Test Acc: 0.4643
 Test site-Indian                   | Epoch:9 | Test Acc: 0.3278
 Test site-Southeast_Asian          | Epoch:9 | Test Acc: 0.4222
 Test site-Middle_Eastern           | Epoch:9 | Test Acc: 0.3969
Average Test Accuracy: 0.3814, domain std=0.0549, individual std=0.0549
============ Train epoch 10 ============
cnt=[2, 2, 2, 2, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.4232 | Train Acc: 0.4460
 Site-White                    | Train Loss: 1.3521 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.5938 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.4662 | Train Acc: 0.4125
 Site-Black                    | Train Loss: 1.6849 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.5630 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.3959 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.4058 | Train Acc: 0.4772
 Site-Indian                   | Train Loss: 1.4139 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.5183 | Train Acc: 0.4029
 Site-Southeast_Asian          | Train Loss: 1.4516 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.5465 | Train Acc: 0.4580
 Site-Middle_Eastern           | Train Loss: 1.4324 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.3705 | Train Acc: 0.4604
 Site-White                     (4) | Val  Loss: 1.4099 | Val  Acc: 0.4348
 Site-White                     (0) | Val  Loss: 1.4110 | Val  Acc: 0.4532
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4572 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4658 | Val  Acc: 0.4065
 Site-Black                     (6) | Val  Loss: 1.4398 | Val  Acc: 0.4891
 Site-Black                     (6) | Val  Loss: 1.5629 | Val  Acc: 0.3957
 Site-East_Asian                (5) | Val  Loss: 1.2651 | Val  Acc: 0.5652
 Site-East_Asian                (1) | Val  Loss: 1.3497 | Val  Acc: 0.4892
 Site-Indian                    (1) | Val  Loss: 1.5357 | Val  Acc: 0.3261
 Site-Indian                    (0) | Val  Loss: 1.5136 | Val  Acc: 0.3921
 Site-Southeast_Asian           (3) | Val  Loss: 1.4080 | Val  Acc: 0.4783
 Site-Southeast_Asian           (3) | Val  Loss: 1.4206 | Val  Acc: 0.4748
 Site-Middle_Eastern            (2) | Val  Loss: 1.3894 | Val  Acc: 0.5217
 Site-Middle_Eastern            (2) | Val  Loss: 1.4180 | Val  Acc: 0.4424
Average Valid Accuracy: 0.4518
Aggregated Acc | Val Acc: 0.4613
 Best site-White                    (4)  | Epoch:10 | Val Acc: 0.4348
 Best site-White                    (0)  | Epoch:10 | Val Acc: 0.4532
 Best site-Latino_Hispanic          (4)  | Epoch:10 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (4)  | Epoch:10 | Val Acc: 0.4065
 Best site-Black                    (6)  | Epoch:10 | Val Acc: 0.4891
 Best site-Black                    (6)  | Epoch:10 | Val Acc: 0.3957
 Best site-East_Asian               (5)  | Epoch:10 | Val Acc: 0.5652
 Best site-East_Asian               (1)  | Epoch:10 | Val Acc: 0.4892
 Best site-Indian                   (1)  | Epoch:10 | Val Acc: 0.3261
 Best site-Indian                   (0)  | Epoch:10 | Val Acc: 0.3921
 Best site-Southeast_Asian          (3)  | Epoch:10 | Val Acc: 0.4783
 Best site-Southeast_Asian          (3)  | Epoch:10 | Val Acc: 0.4748
 Best site-Middle_Eastern           (2)  | Epoch:10 | Val Acc: 0.5217
 Best site-Middle_Eastern           (2)  | Epoch:10 | Val Acc: 0.4424
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 3, 1, 2, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3763 | Train Acc: 0.4460
 Site-White                    | Train Loss: 1.3660 | Train Acc: 0.4700
 Site-Latino_Hispanic          | Train Loss: 1.6081 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4456 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.6800 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.5996 | Train Acc: 0.4077
 Site-East_Asian               | Train Loss: 1.4389 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.4039 | Train Acc: 0.4628
 Site-Indian                   | Train Loss: 1.3894 | Train Acc: 0.4604
 Site-Indian                   | Train Loss: 1.5074 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.4747 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.4533 | Train Acc: 0.4484
 Site-Middle_Eastern           | Train Loss: 1.4205 | Train Acc: 0.4245
 Site-Middle_Eastern           | Train Loss: 1.3974 | Train Acc: 0.4652
 Site-White                     (4) | Val  Loss: 1.3541 | Val  Acc: 0.4674
 Site-White                     (5) | Val  Loss: 1.3745 | Val  Acc: 0.4460
 Site-Latino_Hispanic           (5) | Val  Loss: 1.4587 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4607 | Val  Acc: 0.3921
 Site-Black                     (1) | Val  Loss: 1.4115 | Val  Acc: 0.4891
 Site-Black                     (1) | Val  Loss: 1.5397 | Val  Acc: 0.4281
 Site-East_Asian                (6) | Val  Loss: 1.2730 | Val  Acc: 0.5435
 Site-East_Asian                (3) | Val  Loss: 1.3533 | Val  Acc: 0.4748
 Site-Indian                    (5) | Val  Loss: 1.5664 | Val  Acc: 0.3370
 Site-Indian                    (1) | Val  Loss: 1.4652 | Val  Acc: 0.4317
 Site-Southeast_Asian           (0) | Val  Loss: 1.4441 | Val  Acc: 0.3804
 Site-Southeast_Asian           (0) | Val  Loss: 1.4068 | Val  Acc: 0.4353
 Site-Middle_Eastern            (2) | Val  Loss: 1.4082 | Val  Acc: 0.5000
 Site-Middle_Eastern            (5) | Val  Loss: 1.3809 | Val  Acc: 0.4496
Average Valid Accuracy: 0.4404
Aggregated Acc | Val Acc: 0.4583
============ Train epoch 12 ============
cnt=[2, 2, 5, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3881 | Train Acc: 0.4245
 Site-White                    | Train Loss: 1.4276 | Train Acc: 0.4916
 Site-Latino_Hispanic          | Train Loss: 1.6001 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4229 | Train Acc: 0.4125
 Site-Black                    | Train Loss: 1.6367 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.5010 | Train Acc: 0.4436
 Site-East_Asian               | Train Loss: 1.3746 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.3513 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.3789 | Train Acc: 0.4317
 Site-Indian                   | Train Loss: 1.4841 | Train Acc: 0.4365
 Site-Southeast_Asian          | Train Loss: 1.4915 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.5313 | Train Acc: 0.4700
 Site-Middle_Eastern           | Train Loss: 1.4036 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.3288 | Train Acc: 0.4868
 Site-White                     (2) | Val  Loss: 1.4157 | Val  Acc: 0.4565
 Site-White                     (2) | Val  Loss: 1.3693 | Val  Acc: 0.4676
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4500 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4334 | Val  Acc: 0.4209
 Site-Black                     (1) | Val  Loss: 1.3737 | Val  Acc: 0.5326
 Site-Black                     (1) | Val  Loss: 1.4939 | Val  Acc: 0.4496
 Site-East_Asian                (3) | Val  Loss: 1.2534 | Val  Acc: 0.5870
 Site-East_Asian                (2) | Val  Loss: 1.3494 | Val  Acc: 0.4712
 Site-Indian                    (5) | Val  Loss: 1.5495 | Val  Acc: 0.3370
 Site-Indian                    (5) | Val  Loss: 1.4539 | Val  Acc: 0.4245
 Site-Southeast_Asian           (0) | Val  Loss: 1.4487 | Val  Acc: 0.4348
 Site-Southeast_Asian           (0) | Val  Loss: 1.4028 | Val  Acc: 0.4820
 Site-Middle_Eastern            (2) | Val  Loss: 1.4001 | Val  Acc: 0.5000
 Site-Middle_Eastern            (2) | Val  Loss: 1.3938 | Val  Acc: 0.4424
Average Valid Accuracy: 0.4608
Aggregated Acc | Val Acc: 0.4645
 Best site-White                    (2)  | Epoch:12 | Val Acc: 0.4565
 Best site-White                    (2)  | Epoch:12 | Val Acc: 0.4676
 Best site-Latino_Hispanic          (4)  | Epoch:12 | Val Acc: 0.4457
 Best site-Latino_Hispanic          (6)  | Epoch:12 | Val Acc: 0.4209
 Best site-Black                    (1)  | Epoch:12 | Val Acc: 0.5326
 Best site-Black                    (1)  | Epoch:12 | Val Acc: 0.4496
 Best site-East_Asian               (3)  | Epoch:12 | Val Acc: 0.5870
 Best site-East_Asian               (2)  | Epoch:12 | Val Acc: 0.4712
 Best site-Indian                   (5)  | Epoch:12 | Val Acc: 0.3370
 Best site-Indian                   (5)  | Epoch:12 | Val Acc: 0.4245
 Best site-Southeast_Asian          (0)  | Epoch:12 | Val Acc: 0.4348
 Best site-Southeast_Asian          (0)  | Epoch:12 | Val Acc: 0.4820
 Best site-Middle_Eastern           (2)  | Epoch:12 | Val Acc: 0.5000
 Best site-Middle_Eastern           (2)  | Epoch:12 | Val Acc: 0.4424
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 6, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.4134 | Train Acc: 0.4460
 Site-White                    | Train Loss: 1.3710 | Train Acc: 0.4700
 Site-Latino_Hispanic          | Train Loss: 1.5955 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4369 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.6190 | Train Acc: 0.4029
 Site-Black                    | Train Loss: 1.5742 | Train Acc: 0.3981
 Site-East_Asian               | Train Loss: 1.3661 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.3412 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.3841 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.4551 | Train Acc: 0.4293
 Site-Southeast_Asian          | Train Loss: 1.4121 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.4292 | Train Acc: 0.4844
 Site-Middle_Eastern           | Train Loss: 1.4361 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.3003 | Train Acc: 0.4772
 Site-White                     (5) | Val  Loss: 1.3553 | Val  Acc: 0.4674
 Site-White                     (4) | Val  Loss: 1.3437 | Val  Acc: 0.4820
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4654 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4483 | Val  Acc: 0.4173
 Site-Black                     (3) | Val  Loss: 1.3440 | Val  Acc: 0.5435
 Site-Black                     (3) | Val  Loss: 1.5162 | Val  Acc: 0.4640
 Site-East_Asian                (2) | Val  Loss: 1.2432 | Val  Acc: 0.5543
 Site-East_Asian                (2) | Val  Loss: 1.3184 | Val  Acc: 0.5000
 Site-Indian                    (1) | Val  Loss: 1.4583 | Val  Acc: 0.4130
 Site-Indian                    (0) | Val  Loss: 1.4599 | Val  Acc: 0.4281
 Site-Southeast_Asian           (6) | Val  Loss: 1.3919 | Val  Acc: 0.5000
 Site-Southeast_Asian           (1) | Val  Loss: 1.3777 | Val  Acc: 0.4892
 Site-Middle_Eastern            (1) | Val  Loss: 1.3914 | Val  Acc: 0.5326
 Site-Middle_Eastern            (1) | Val  Loss: 1.3926 | Val  Acc: 0.4604
Average Valid Accuracy: 0.4745
Aggregated Acc | Val Acc: 0.4799
 Best site-White                    (5)  | Epoch:13 | Val Acc: 0.4674
 Best site-White                    (4)  | Epoch:13 | Val Acc: 0.4820
 Best site-Latino_Hispanic          (1)  | Epoch:13 | Val Acc: 0.3913
 Best site-Latino_Hispanic          (1)  | Epoch:13 | Val Acc: 0.4173
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.5435
 Best site-Black                    (3)  | Epoch:13 | Val Acc: 0.4640
 Best site-East_Asian               (2)  | Epoch:13 | Val Acc: 0.5543
 Best site-East_Asian               (2)  | Epoch:13 | Val Acc: 0.5000
 Best site-Indian                   (1)  | Epoch:13 | Val Acc: 0.4130
 Best site-Indian                   (0)  | Epoch:13 | Val Acc: 0.4281
 Best site-Southeast_Asian          (6)  | Epoch:13 | Val Acc: 0.5000
 Best site-Southeast_Asian          (1)  | Epoch:13 | Val Acc: 0.4892
 Best site-Middle_Eastern           (1)  | Epoch:13 | Val Acc: 0.5326
 Best site-Middle_Eastern           (1)  | Epoch:13 | Val Acc: 0.4604
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 1, 4, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.4078 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.3375 | Train Acc: 0.4988
 Site-Latino_Hispanic          | Train Loss: 1.5497 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.3999 | Train Acc: 0.4293
 Site-Black                    | Train Loss: 1.6645 | Train Acc: 0.3525
 Site-Black                    | Train Loss: 1.4956 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3443 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.3358 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3763 | Train Acc: 0.4388
 Site-Indian                   | Train Loss: 1.4705 | Train Acc: 0.4125
 Site-Southeast_Asian          | Train Loss: 1.4437 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3627 | Train Acc: 0.4916
 Site-Middle_Eastern           | Train Loss: 1.4074 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3301 | Train Acc: 0.4748
 Site-White                     (4) | Val  Loss: 1.3726 | Val  Acc: 0.4457
 Site-White                     (6) | Val  Loss: 1.3460 | Val  Acc: 0.4820
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4005 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4130 | Val  Acc: 0.4101
 Site-Black                     (3) | Val  Loss: 1.3518 | Val  Acc: 0.5217
 Site-Black                     (3) | Val  Loss: 1.5020 | Val  Acc: 0.4460
 Site-East_Asian                (2) | Val  Loss: 1.2739 | Val  Acc: 0.5543
 Site-East_Asian                (2) | Val  Loss: 1.3124 | Val  Acc: 0.4928
 Site-Indian                    (0) | Val  Loss: 1.5097 | Val  Acc: 0.4239
 Site-Indian                    (0) | Val  Loss: 1.4308 | Val  Acc: 0.4460
 Site-Southeast_Asian           (2) | Val  Loss: 1.3433 | Val  Acc: 0.4348
 Site-Southeast_Asian           (2) | Val  Loss: 1.3699 | Val  Acc: 0.4676
 Site-Middle_Eastern            (1) | Val  Loss: 1.3754 | Val  Acc: 0.4891
 Site-Middle_Eastern            (5) | Val  Loss: 1.3898 | Val  Acc: 0.4281
Average Valid Accuracy: 0.4642
Aggregated Acc | Val Acc: 0.4633
============ Train epoch 15 ============
cnt=[1, 3, 1, 3, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3979 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.2978 | Train Acc: 0.4940
 Site-Latino_Hispanic          | Train Loss: 1.5423 | Train Acc: 0.3813
 Site-Latino_Hispanic          | Train Loss: 1.3975 | Train Acc: 0.4341
 Site-Black                    | Train Loss: 1.6119 | Train Acc: 0.3453
 Site-Black                    | Train Loss: 1.5011 | Train Acc: 0.4365
 Site-East_Asian               | Train Loss: 1.3321 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.4473 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.3883 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.4387 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.3964 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.4555 | Train Acc: 0.4940
 Site-Middle_Eastern           | Train Loss: 1.4088 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3299 | Train Acc: 0.4580
 Site-White                     (5) | Val  Loss: 1.3923 | Val  Acc: 0.4674
 Site-White                     (4) | Val  Loss: 1.3446 | Val  Acc: 0.5144
 Site-Latino_Hispanic           (6) | Val  Loss: 1.4203 | Val  Acc: 0.4130
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4112 | Val  Acc: 0.4245
 Site-Black                     (3) | Val  Loss: 1.3453 | Val  Acc: 0.5109
 Site-Black                     (3) | Val  Loss: 1.4964 | Val  Acc: 0.4640
 Site-East_Asian                (0) | Val  Loss: 1.2440 | Val  Acc: 0.5435
 Site-East_Asian                (6) | Val  Loss: 1.3265 | Val  Acc: 0.5216
 Site-Indian                    (3) | Val  Loss: 1.4924 | Val  Acc: 0.3804
 Site-Indian                    (1) | Val  Loss: 1.4434 | Val  Acc: 0.4281
 Site-Southeast_Asian           (6) | Val  Loss: 1.3802 | Val  Acc: 0.4783
 Site-Southeast_Asian           (2) | Val  Loss: 1.3677 | Val  Acc: 0.5072
 Site-Middle_Eastern            (4) | Val  Loss: 1.3532 | Val  Acc: 0.5543
 Site-Middle_Eastern            (1) | Val  Loss: 1.3748 | Val  Acc: 0.4640
Average Valid Accuracy: 0.4765
Aggregated Acc | Val Acc: 0.4877
 Best site-White                    (5)  | Epoch:15 | Val Acc: 0.4674
 Best site-White                    (4)  | Epoch:15 | Val Acc: 0.5144
 Best site-Latino_Hispanic          (6)  | Epoch:15 | Val Acc: 0.4130
 Best site-Latino_Hispanic          (1)  | Epoch:15 | Val Acc: 0.4245
 Best site-Black                    (3)  | Epoch:15 | Val Acc: 0.5109
 Best site-Black                    (3)  | Epoch:15 | Val Acc: 0.4640
 Best site-East_Asian               (0)  | Epoch:15 | Val Acc: 0.5435
 Best site-East_Asian               (6)  | Epoch:15 | Val Acc: 0.5216
 Best site-Indian                   (3)  | Epoch:15 | Val Acc: 0.3804
 Best site-Indian                   (1)  | Epoch:15 | Val Acc: 0.4281
 Best site-Southeast_Asian          (6)  | Epoch:15 | Val Acc: 0.4783
 Best site-Southeast_Asian          (2)  | Epoch:15 | Val Acc: 0.5072
 Best site-Middle_Eastern           (4)  | Epoch:15 | Val Acc: 0.5543
 Best site-Middle_Eastern           (1)  | Epoch:15 | Val Acc: 0.4640
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 1, 8, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3955 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.2994 | Train Acc: 0.4892
 Site-Latino_Hispanic          | Train Loss: 1.5727 | Train Acc: 0.4173
 Site-Latino_Hispanic          | Train Loss: 1.3887 | Train Acc: 0.4532
 Site-Black                    | Train Loss: 1.6463 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.5142 | Train Acc: 0.4197
 Site-East_Asian               | Train Loss: 1.3946 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.3537 | Train Acc: 0.5084
 Site-Indian                   | Train Loss: 1.3568 | Train Acc: 0.4388
 Site-Indian                   | Train Loss: 1.4224 | Train Acc: 0.4245
 Site-Southeast_Asian          | Train Loss: 1.4046 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3883 | Train Acc: 0.4868
 Site-Middle_Eastern           | Train Loss: 1.3808 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3223 | Train Acc: 0.4892
 Site-White                     (6) | Val  Loss: 1.3556 | Val  Acc: 0.5217
 Site-White                     (4) | Val  Loss: 1.3049 | Val  Acc: 0.5468
 Site-Latino_Hispanic           (1) | Val  Loss: 1.4187 | Val  Acc: 0.4457
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3853 | Val  Acc: 0.4496
 Site-Black                     (5) | Val  Loss: 1.3580 | Val  Acc: 0.5543
 Site-Black                     (3) | Val  Loss: 1.5006 | Val  Acc: 0.4640
 Site-East_Asian                (2) | Val  Loss: 1.2756 | Val  Acc: 0.5435
 Site-East_Asian                (2) | Val  Loss: 1.2873 | Val  Acc: 0.5036
 Site-Indian                    (2) | Val  Loss: 1.4989 | Val  Acc: 0.3913
 Site-Indian                    (2) | Val  Loss: 1.4300 | Val  Acc: 0.4496
 Site-Southeast_Asian           (2) | Val  Loss: 1.3318 | Val  Acc: 0.5000
 Site-Southeast_Asian           (2) | Val  Loss: 1.3463 | Val  Acc: 0.4856
 Site-Middle_Eastern            (2) | Val  Loss: 1.3963 | Val  Acc: 0.4783
 Site-Middle_Eastern            (0) | Val  Loss: 1.3611 | Val  Acc: 0.4640
Average Valid Accuracy: 0.4856
Aggregated Acc | Val Acc: 0.4960
 Best site-White                    (6)  | Epoch:16 | Val Acc: 0.5217
 Best site-White                    (4)  | Epoch:16 | Val Acc: 0.5468
 Best site-Latino_Hispanic          (1)  | Epoch:16 | Val Acc: 0.4457
 Best site-Latino_Hispanic          (2)  | Epoch:16 | Val Acc: 0.4496
 Best site-Black                    (5)  | Epoch:16 | Val Acc: 0.5543
 Best site-Black                    (3)  | Epoch:16 | Val Acc: 0.4640
 Best site-East_Asian               (2)  | Epoch:16 | Val Acc: 0.5435
 Best site-East_Asian               (2)  | Epoch:16 | Val Acc: 0.5036
 Best site-Indian                   (2)  | Epoch:16 | Val Acc: 0.3913
 Best site-Indian                   (2)  | Epoch:16 | Val Acc: 0.4496
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.5000
 Best site-Southeast_Asian          (2)  | Epoch:16 | Val Acc: 0.4856
 Best site-Middle_Eastern           (2)  | Epoch:16 | Val Acc: 0.4783
 Best site-Middle_Eastern           (0)  | Epoch:16 | Val Acc: 0.4640
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 17 ============
cnt=[5, 2, 3, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3937 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.2979 | Train Acc: 0.5084
 Site-Latino_Hispanic          | Train Loss: 1.5465 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.4336 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.6465 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.5080 | Train Acc: 0.4269
 Site-East_Asian               | Train Loss: 1.3376 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.4910 | Train Acc: 0.4940
 Site-Indian                   | Train Loss: 1.3718 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4115 | Train Acc: 0.4269
 Site-Southeast_Asian          | Train Loss: 1.4557 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3534 | Train Acc: 0.4844
 Site-Middle_Eastern           | Train Loss: 1.4092 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.3274 | Train Acc: 0.4988
 Site-White                     (6) | Val  Loss: 1.3323 | Val  Acc: 0.4565
 Site-White                     (2) | Val  Loss: 1.3216 | Val  Acc: 0.4568
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4028 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3798 | Val  Acc: 0.4388
 Site-Black                     (1) | Val  Loss: 1.3008 | Val  Acc: 0.5761
 Site-Black                     (1) | Val  Loss: 1.4968 | Val  Acc: 0.4353
 Site-East_Asian                (0) | Val  Loss: 1.2123 | Val  Acc: 0.5761
 Site-East_Asian                (3) | Val  Loss: 1.2935 | Val  Acc: 0.5000
 Site-Indian                    (5) | Val  Loss: 1.5287 | Val  Acc: 0.3478
 Site-Indian                    (0) | Val  Loss: 1.4202 | Val  Acc: 0.4245
 Site-Southeast_Asian           (0) | Val  Loss: 1.3535 | Val  Acc: 0.4674
 Site-Southeast_Asian           (0) | Val  Loss: 1.3420 | Val  Acc: 0.4892
 Site-Middle_Eastern            (2) | Val  Loss: 1.3596 | Val  Acc: 0.5217
 Site-Middle_Eastern            (2) | Val  Loss: 1.3682 | Val  Acc: 0.4640
Average Valid Accuracy: 0.4738
Aggregated Acc | Val Acc: 0.4640
============ Train epoch 18 ============
cnt=[3, 1, 4, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3902 | Train Acc: 0.4388
 Site-White                    | Train Loss: 1.2687 | Train Acc: 0.4916
 Site-Latino_Hispanic          | Train Loss: 1.5575 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.4149 | Train Acc: 0.4604
 Site-Black                    | Train Loss: 1.6567 | Train Acc: 0.3381
 Site-Black                    | Train Loss: 1.4350 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3710 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2862 | Train Acc: 0.5156
 Site-Indian                   | Train Loss: 1.3269 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.3627 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4192 | Train Acc: 0.4676
 Site-Southeast_Asian          | Train Loss: 1.3360 | Train Acc: 0.5060
 Site-Middle_Eastern           | Train Loss: 1.3740 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.3058 | Train Acc: 0.4964
 Site-White                     (0) | Val  Loss: 1.3696 | Val  Acc: 0.4891
 Site-White                     (2) | Val  Loss: 1.2902 | Val  Acc: 0.4928
 Site-Latino_Hispanic           (3) | Val  Loss: 1.4002 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4181 | Val  Acc: 0.4065
 Site-Black                     (5) | Val  Loss: 1.3014 | Val  Acc: 0.5217
 Site-Black                     (5) | Val  Loss: 1.4565 | Val  Acc: 0.4676
 Site-East_Asian                (6) | Val  Loss: 1.2153 | Val  Acc: 0.5870
 Site-East_Asian                (4) | Val  Loss: 1.2866 | Val  Acc: 0.5360
 Site-Indian                    (3) | Val  Loss: 1.4097 | Val  Acc: 0.4565
 Site-Indian                    (1) | Val  Loss: 1.3753 | Val  Acc: 0.4640
 Site-Southeast_Asian           (2) | Val  Loss: 1.3530 | Val  Acc: 0.4783
 Site-Southeast_Asian           (2) | Val  Loss: 1.3088 | Val  Acc: 0.5036
 Site-Middle_Eastern            (0) | Val  Loss: 1.3709 | Val  Acc: 0.5326
 Site-Middle_Eastern            (0) | Val  Loss: 1.3639 | Val  Acc: 0.4640
Average Valid Accuracy: 0.4882
Aggregated Acc | Val Acc: 0.4990
 Best site-White                    (0)  | Epoch:18 | Val Acc: 0.4891
 Best site-White                    (2)  | Epoch:18 | Val Acc: 0.4928
 Best site-Latino_Hispanic          (3)  | Epoch:18 | Val Acc: 0.4348
 Best site-Latino_Hispanic          (2)  | Epoch:18 | Val Acc: 0.4065
 Best site-Black                    (5)  | Epoch:18 | Val Acc: 0.5217
 Best site-Black                    (5)  | Epoch:18 | Val Acc: 0.4676
 Best site-East_Asian               (6)  | Epoch:18 | Val Acc: 0.5870
 Best site-East_Asian               (4)  | Epoch:18 | Val Acc: 0.5360
 Best site-Indian                   (3)  | Epoch:18 | Val Acc: 0.4565
 Best site-Indian                   (1)  | Epoch:18 | Val Acc: 0.4640
 Best site-Southeast_Asian          (2)  | Epoch:18 | Val Acc: 0.4783
 Best site-Southeast_Asian          (2)  | Epoch:18 | Val Acc: 0.5036
 Best site-Middle_Eastern           (0)  | Epoch:18 | Val Acc: 0.5326
 Best site-Middle_Eastern           (0)  | Epoch:18 | Val Acc: 0.4640
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 19 ============
cnt=[1, 2, 5, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3948 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.2536 | Train Acc: 0.5012
 Site-Latino_Hispanic          | Train Loss: 1.5355 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.4093 | Train Acc: 0.4293
 Site-Black                    | Train Loss: 1.6239 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.4046 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3275 | Train Acc: 0.4964
 Site-East_Asian               | Train Loss: 1.3331 | Train Acc: 0.5204
 Site-Indian                   | Train Loss: 1.3152 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.4342 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.4476 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3579 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.3361 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.3319 | Train Acc: 0.4940
 Site-White                     (2) | Val  Loss: 1.3224 | Val  Acc: 0.5435
 Site-White                     (5) | Val  Loss: 1.3062 | Val  Acc: 0.5036
 Site-Latino_Hispanic           (4) | Val  Loss: 1.4164 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3699 | Val  Acc: 0.4209
 Site-Black                     (3) | Val  Loss: 1.2925 | Val  Acc: 0.5217
 Site-Black                     (3) | Val  Loss: 1.4267 | Val  Acc: 0.4784
 Site-East_Asian                (2) | Val  Loss: 1.2145 | Val  Acc: 0.5435
 Site-East_Asian                (0) | Val  Loss: 1.2627 | Val  Acc: 0.5108
 Site-Indian                    (1) | Val  Loss: 1.4523 | Val  Acc: 0.3587
 Site-Indian                    (1) | Val  Loss: 1.4043 | Val  Acc: 0.4173
 Site-Southeast_Asian           (6) | Val  Loss: 1.2945 | Val  Acc: 0.4348
 Site-Southeast_Asian           (2) | Val  Loss: 1.3254 | Val  Acc: 0.5216
 Site-Middle_Eastern            (2) | Val  Loss: 1.3915 | Val  Acc: 0.4891
 Site-Middle_Eastern            (2) | Val  Loss: 1.3534 | Val  Acc: 0.4748
Average Valid Accuracy: 0.4745
Aggregated Acc | Val Acc: 0.4677
============ Train epoch 20 ============
cnt=[1, 5, 2, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3248 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.2830 | Train Acc: 0.5084
 Site-Latino_Hispanic          | Train Loss: 1.5837 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.3875 | Train Acc: 0.4412
 Site-Black                    | Train Loss: 1.5779 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4496 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.3735 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.3273 | Train Acc: 0.5012
 Site-Indian                   | Train Loss: 1.3171 | Train Acc: 0.4748
 Site-Indian                   | Train Loss: 1.3987 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.4170 | Train Acc: 0.5108
 Site-Southeast_Asian          | Train Loss: 1.3552 | Train Acc: 0.5036
 Site-Middle_Eastern           | Train Loss: 1.3887 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.2795 | Train Acc: 0.4844
 Site-White                     (5) | Val  Loss: 1.3373 | Val  Acc: 0.4674
 Site-White                     (5) | Val  Loss: 1.2845 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3846 | Val  Acc: 0.3913
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3931 | Val  Acc: 0.4245
 Site-Black                     (6) | Val  Loss: 1.3014 | Val  Acc: 0.5652
 Site-Black                     (4) | Val  Loss: 1.3943 | Val  Acc: 0.5036
 Site-East_Asian                (2) | Val  Loss: 1.2096 | Val  Acc: 0.6087
 Site-East_Asian                (3) | Val  Loss: 1.2937 | Val  Acc: 0.5288
 Site-Indian                    (1) | Val  Loss: 1.4437 | Val  Acc: 0.3913
 Site-Indian                    (1) | Val  Loss: 1.4148 | Val  Acc: 0.4353
 Site-Southeast_Asian           (1) | Val  Loss: 1.3081 | Val  Acc: 0.4348
 Site-Southeast_Asian           (2) | Val  Loss: 1.3247 | Val  Acc: 0.4964
 Site-Middle_Eastern            (5) | Val  Loss: 1.3396 | Val  Acc: 0.5217
 Site-Middle_Eastern            (0) | Val  Loss: 1.3324 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4820
Aggregated Acc | Val Acc: 0.5058
============ Train epoch 21 ============
cnt=[3, 4, 3, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3820 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.2606 | Train Acc: 0.5204
 Site-Latino_Hispanic          | Train Loss: 1.5195 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.3270 | Train Acc: 0.4556
 Site-Black                    | Train Loss: 1.6047 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.4195 | Train Acc: 0.4748
 Site-East_Asian               | Train Loss: 1.3113 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.2949 | Train Acc: 0.5132
 Site-Indian                   | Train Loss: 1.3126 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4662 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3752 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.3492 | Train Acc: 0.5108
 Site-Middle_Eastern           | Train Loss: 1.3655 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.2727 | Train Acc: 0.4844
 Site-White                     (5) | Val  Loss: 1.3272 | Val  Acc: 0.4565
 Site-White                     (3) | Val  Loss: 1.2743 | Val  Acc: 0.5180
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3838 | Val  Acc: 0.4348
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3562 | Val  Acc: 0.4388
 Site-Black                     (1) | Val  Loss: 1.2718 | Val  Acc: 0.5652
 Site-Black                     (1) | Val  Loss: 1.4223 | Val  Acc: 0.4820
 Site-East_Asian                (2) | Val  Loss: 1.1655 | Val  Acc: 0.5870
 Site-East_Asian                (2) | Val  Loss: 1.2641 | Val  Acc: 0.5324
 Site-Indian                    (1) | Val  Loss: 1.4407 | Val  Acc: 0.4130
 Site-Indian                    (6) | Val  Loss: 1.4106 | Val  Acc: 0.4353
 Site-Southeast_Asian           (2) | Val  Loss: 1.3251 | Val  Acc: 0.4783
 Site-Southeast_Asian           (1) | Val  Loss: 1.2936 | Val  Acc: 0.5108
 Site-Middle_Eastern            (0) | Val  Loss: 1.3532 | Val  Acc: 0.5000
 Site-Middle_Eastern            (0) | Val  Loss: 1.3422 | Val  Acc: 0.4712
Average Valid Accuracy: 0.4874
Aggregated Acc | Val Acc: 0.4771
============ Train epoch 22 ============
cnt=[1, 2, 3, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3731 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.2466 | Train Acc: 0.5324
 Site-Latino_Hispanic          | Train Loss: 1.5226 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.4123 | Train Acc: 0.4484
 Site-Black                    | Train Loss: 1.5583 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.4423 | Train Acc: 0.4772
 Site-East_Asian               | Train Loss: 1.3480 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.2771 | Train Acc: 0.5084
 Site-Indian                   | Train Loss: 1.3156 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.4241 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3889 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.3564 | Train Acc: 0.5228
 Site-Middle_Eastern           | Train Loss: 1.3525 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.3004 | Train Acc: 0.4892
 Site-White                     (1) | Val  Loss: 1.2922 | Val  Acc: 0.5109
 Site-White                     (0) | Val  Loss: 1.3109 | Val  Acc: 0.4964
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3738 | Val  Acc: 0.4022
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3771 | Val  Acc: 0.4604
 Site-Black                     (4) | Val  Loss: 1.3091 | Val  Acc: 0.5870
 Site-Black                     (4) | Val  Loss: 1.4008 | Val  Acc: 0.4892
 Site-East_Asian                (3) | Val  Loss: 1.1874 | Val  Acc: 0.6196
 Site-East_Asian                (6) | Val  Loss: 1.2711 | Val  Acc: 0.5180
 Site-Indian                    (5) | Val  Loss: 1.4403 | Val  Acc: 0.3587
 Site-Indian                    (2) | Val  Loss: 1.3592 | Val  Acc: 0.4820
 Site-Southeast_Asian           (3) | Val  Loss: 1.3787 | Val  Acc: 0.4783
 Site-Southeast_Asian           (3) | Val  Loss: 1.3191 | Val  Acc: 0.5180
 Site-Middle_Eastern            (2) | Val  Loss: 1.3494 | Val  Acc: 0.4891
 Site-Middle_Eastern            (2) | Val  Loss: 1.3172 | Val  Acc: 0.4748
Average Valid Accuracy: 0.4918
Aggregated Acc | Val Acc: 0.4913
 Best site-White                    (1)  | Epoch:22 | Val Acc: 0.5109
 Best site-White                    (0)  | Epoch:22 | Val Acc: 0.4964
 Best site-Latino_Hispanic          (1)  | Epoch:22 | Val Acc: 0.4022
 Best site-Latino_Hispanic          (5)  | Epoch:22 | Val Acc: 0.4604
 Best site-Black                    (4)  | Epoch:22 | Val Acc: 0.5870
 Best site-Black                    (4)  | Epoch:22 | Val Acc: 0.4892
 Best site-East_Asian               (3)  | Epoch:22 | Val Acc: 0.6196
 Best site-East_Asian               (6)  | Epoch:22 | Val Acc: 0.5180
 Best site-Indian                   (5)  | Epoch:22 | Val Acc: 0.3587
 Best site-Indian                   (2)  | Epoch:22 | Val Acc: 0.4820
 Best site-Southeast_Asian          (3)  | Epoch:22 | Val Acc: 0.4783
 Best site-Southeast_Asian          (3)  | Epoch:22 | Val Acc: 0.5180
 Best site-Middle_Eastern           (2)  | Epoch:22 | Val Acc: 0.4891
 Best site-Middle_Eastern           (2)  | Epoch:22 | Val Acc: 0.4748
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 23 ============
cnt=[1, 3, 3, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3357 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.2523 | Train Acc: 0.5156
 Site-Latino_Hispanic          | Train Loss: 1.5237 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.3616 | Train Acc: 0.4460
 Site-Black                    | Train Loss: 1.6294 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.4622 | Train Acc: 0.4484
 Site-East_Asian               | Train Loss: 1.3798 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.2693 | Train Acc: 0.5276
 Site-Indian                   | Train Loss: 1.2711 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3492 | Train Acc: 0.4772
 Site-Southeast_Asian          | Train Loss: 1.3442 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3157 | Train Acc: 0.5468
 Site-Middle_Eastern           | Train Loss: 1.3819 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.2632 | Train Acc: 0.5084
 Site-White                     (3) | Val  Loss: 1.2546 | Val  Acc: 0.5109
 Site-White                     (3) | Val  Loss: 1.2910 | Val  Acc: 0.5324
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3675 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3600 | Val  Acc: 0.4317
 Site-Black                     (1) | Val  Loss: 1.2645 | Val  Acc: 0.5870
 Site-Black                     (1) | Val  Loss: 1.4597 | Val  Acc: 0.5000
 Site-East_Asian                (6) | Val  Loss: 1.1906 | Val  Acc: 0.6087
 Site-East_Asian                (6) | Val  Loss: 1.2492 | Val  Acc: 0.5504
 Site-Indian                    (5) | Val  Loss: 1.4340 | Val  Acc: 0.4565
 Site-Indian                    (1) | Val  Loss: 1.3794 | Val  Acc: 0.4676
 Site-Southeast_Asian           (4) | Val  Loss: 1.2907 | Val  Acc: 0.4783
 Site-Southeast_Asian           (4) | Val  Loss: 1.2950 | Val  Acc: 0.5252
 Site-Middle_Eastern            (2) | Val  Loss: 1.3565 | Val  Acc: 0.5326
 Site-Middle_Eastern            (2) | Val  Loss: 1.3235 | Val  Acc: 0.4604
Average Valid Accuracy: 0.5070
Aggregated Acc | Val Acc: 0.5013
 Best site-White                    (3)  | Epoch:23 | Val Acc: 0.5109
 Best site-White                    (3)  | Epoch:23 | Val Acc: 0.5324
 Best site-Latino_Hispanic          (0)  | Epoch:23 | Val Acc: 0.4565
 Best site-Latino_Hispanic          (2)  | Epoch:23 | Val Acc: 0.4317
 Best site-Black                    (1)  | Epoch:23 | Val Acc: 0.5870
 Best site-Black                    (1)  | Epoch:23 | Val Acc: 0.5000
 Best site-East_Asian               (6)  | Epoch:23 | Val Acc: 0.6087
 Best site-East_Asian               (6)  | Epoch:23 | Val Acc: 0.5504
 Best site-Indian                   (5)  | Epoch:23 | Val Acc: 0.4565
 Best site-Indian                   (1)  | Epoch:23 | Val Acc: 0.4676
 Best site-Southeast_Asian          (4)  | Epoch:23 | Val Acc: 0.4783
 Best site-Southeast_Asian          (4)  | Epoch:23 | Val Acc: 0.5252
 Best site-Middle_Eastern           (2)  | Epoch:23 | Val Acc: 0.5326
 Best site-Middle_Eastern           (2)  | Epoch:23 | Val Acc: 0.4604
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 24 ============
cnt=[3, 2, 1, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3920 | Train Acc: 0.4317
 Site-White                    | Train Loss: 1.3328 | Train Acc: 0.5180
 Site-Latino_Hispanic          | Train Loss: 1.5436 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.3725 | Train Acc: 0.4580
 Site-Black                    | Train Loss: 1.5274 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.4239 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.3864 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.2767 | Train Acc: 0.5228
 Site-Indian                   | Train Loss: 1.3140 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.3749 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.4522 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.3619 | Train Acc: 0.5084
 Site-Middle_Eastern           | Train Loss: 1.3404 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.2655 | Train Acc: 0.5132
 Site-White                     (0) | Val  Loss: 1.2881 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.2732 | Val  Acc: 0.5072
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3848 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3431 | Val  Acc: 0.4820
 Site-Black                     (5) | Val  Loss: 1.2656 | Val  Acc: 0.5978
 Site-Black                     (5) | Val  Loss: 1.3741 | Val  Acc: 0.5144
 Site-East_Asian                (0) | Val  Loss: 1.2554 | Val  Acc: 0.5217
 Site-East_Asian                (6) | Val  Loss: 1.2702 | Val  Acc: 0.5000
 Site-Indian                    (3) | Val  Loss: 1.4319 | Val  Acc: 0.4783
 Site-Indian                    (3) | Val  Loss: 1.3711 | Val  Acc: 0.4748
 Site-Southeast_Asian           (4) | Val  Loss: 1.3399 | Val  Acc: 0.4783
 Site-Southeast_Asian           (4) | Val  Loss: 1.3616 | Val  Acc: 0.4964
 Site-Middle_Eastern            (1) | Val  Loss: 1.3449 | Val  Acc: 0.5109
 Site-Middle_Eastern            (1) | Val  Loss: 1.3128 | Val  Acc: 0.4784
Average Valid Accuracy: 0.4998
Aggregated Acc | Val Acc: 0.5008
============ Train epoch 25 ============
cnt=[1, 2, 4, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3484 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.2504 | Train Acc: 0.5300
 Site-Latino_Hispanic          | Train Loss: 1.5544 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.3739 | Train Acc: 0.4293
 Site-Black                    | Train Loss: 1.5801 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.4232 | Train Acc: 0.4580
 Site-East_Asian               | Train Loss: 1.2860 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.2547 | Train Acc: 0.5276
 Site-Indian                   | Train Loss: 1.3331 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.4834 | Train Acc: 0.4652
 Site-Southeast_Asian          | Train Loss: 1.4017 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.3091 | Train Acc: 0.5204
 Site-Middle_Eastern           | Train Loss: 1.3747 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.2461 | Train Acc: 0.4844
 Site-White                     (2) | Val  Loss: 1.3106 | Val  Acc: 0.5109
 Site-White                     (0) | Val  Loss: 1.2797 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4070 | Val  Acc: 0.4239
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3825 | Val  Acc: 0.4353
 Site-Black                     (5) | Val  Loss: 1.2944 | Val  Acc: 0.5326
 Site-Black                     (6) | Val  Loss: 1.4135 | Val  Acc: 0.4748
 Site-East_Asian                (3) | Val  Loss: 1.1711 | Val  Acc: 0.5652
 Site-East_Asian                (3) | Val  Loss: 1.2431 | Val  Acc: 0.5252
 Site-Indian                    (1) | Val  Loss: 1.4775 | Val  Acc: 0.4022
 Site-Indian                    (1) | Val  Loss: 1.3593 | Val  Acc: 0.4928
 Site-Southeast_Asian           (3) | Val  Loss: 1.2943 | Val  Acc: 0.5000
 Site-Southeast_Asian           (3) | Val  Loss: 1.3231 | Val  Acc: 0.5072
 Site-Middle_Eastern            (2) | Val  Loss: 1.3206 | Val  Acc: 0.5543
 Site-Middle_Eastern            (2) | Val  Loss: 1.2963 | Val  Acc: 0.5036
Average Valid Accuracy: 0.4949
Aggregated Acc | Val Acc: 0.4875
============ Train epoch 26 ============
cnt=[1, 1, 1, 3, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3087 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.2499 | Train Acc: 0.5180
 Site-Latino_Hispanic          | Train Loss: 1.5396 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.3654 | Train Acc: 0.4676
 Site-Black                    | Train Loss: 1.5854 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.3896 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.3397 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.2545 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.3269 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3564 | Train Acc: 0.4772
 Site-Southeast_Asian          | Train Loss: 1.4129 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.3016 | Train Acc: 0.5252
 Site-Middle_Eastern           | Train Loss: 1.3780 | Train Acc: 0.4676
 Site-Middle_Eastern           | Train Loss: 1.2806 | Train Acc: 0.4916
 Site-White                     (3) | Val  Loss: 1.2776 | Val  Acc: 0.4674
 Site-White                     (4) | Val  Loss: 1.2578 | Val  Acc: 0.5252
 Site-Latino_Hispanic           (2) | Val  Loss: 1.4053 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3631 | Val  Acc: 0.4532
 Site-Black                     (5) | Val  Loss: 1.2709 | Val  Acc: 0.6304
 Site-Black                     (5) | Val  Loss: 1.4259 | Val  Acc: 0.4640
 Site-East_Asian                (0) | Val  Loss: 1.1775 | Val  Acc: 0.5543
 Site-East_Asian                (6) | Val  Loss: 1.2512 | Val  Acc: 0.5324
 Site-Indian                    (3) | Val  Loss: 1.4016 | Val  Acc: 0.4130
 Site-Indian                    (1) | Val  Loss: 1.3566 | Val  Acc: 0.4460
 Site-Southeast_Asian           (6) | Val  Loss: 1.3348 | Val  Acc: 0.4674
 Site-Southeast_Asian           (6) | Val  Loss: 1.2917 | Val  Acc: 0.5360
 Site-Middle_Eastern            (4) | Val  Loss: 1.3153 | Val  Acc: 0.5217
 Site-Middle_Eastern            (4) | Val  Loss: 1.3099 | Val  Acc: 0.4856
Average Valid Accuracy: 0.4998
Aggregated Acc | Val Acc: 0.5021
============ Train epoch 27 ============
cnt=[1, 3, 2, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3595 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.2272 | Train Acc: 0.5180
 Site-Latino_Hispanic          | Train Loss: 1.5480 | Train Acc: 0.3957
 Site-Latino_Hispanic          | Train Loss: 1.3168 | Train Acc: 0.4772
 Site-Black                    | Train Loss: 1.5118 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.4318 | Train Acc: 0.4844
 Site-East_Asian               | Train Loss: 1.3690 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2602 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3497 | Train Acc: 0.4460
 Site-Indian                   | Train Loss: 1.3327 | Train Acc: 0.4940
 Site-Southeast_Asian          | Train Loss: 1.4168 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.3522 | Train Acc: 0.5204
 Site-Middle_Eastern           | Train Loss: 1.3930 | Train Acc: 0.4388
 Site-Middle_Eastern           | Train Loss: 1.2636 | Train Acc: 0.5036
 Site-White                     (1) | Val  Loss: 1.2658 | Val  Acc: 0.5435
 Site-White                     (1) | Val  Loss: 1.2703 | Val  Acc: 0.5144
 Site-Latino_Hispanic           (2) | Val  Loss: 1.2990 | Val  Acc: 0.4891
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3138 | Val  Acc: 0.4820
 Site-Black                     (3) | Val  Loss: 1.1995 | Val  Acc: 0.6413
 Site-Black                     (5) | Val  Loss: 1.3722 | Val  Acc: 0.5360
 Site-East_Asian                (2) | Val  Loss: 1.1437 | Val  Acc: 0.5870
 Site-East_Asian                (1) | Val  Loss: 1.2656 | Val  Acc: 0.5540
 Site-Indian                    (0) | Val  Loss: 1.4094 | Val  Acc: 0.4565
 Site-Indian                    (4) | Val  Loss: 1.3627 | Val  Acc: 0.4784
 Site-Southeast_Asian           (4) | Val  Loss: 1.2719 | Val  Acc: 0.5109
 Site-Southeast_Asian           (4) | Val  Loss: 1.3148 | Val  Acc: 0.5036
 Site-Middle_Eastern            (6) | Val  Loss: 1.3748 | Val  Acc: 0.4891
 Site-Middle_Eastern            (6) | Val  Loss: 1.3190 | Val  Acc: 0.4676
Average Valid Accuracy: 0.5181
Aggregated Acc | Val Acc: 0.5259
 Best site-White                    (1)  | Epoch:27 | Val Acc: 0.5435
 Best site-White                    (1)  | Epoch:27 | Val Acc: 0.5144
 Best site-Latino_Hispanic          (2)  | Epoch:27 | Val Acc: 0.4891
 Best site-Latino_Hispanic          (4)  | Epoch:27 | Val Acc: 0.4820
 Best site-Black                    (3)  | Epoch:27 | Val Acc: 0.6413
 Best site-Black                    (5)  | Epoch:27 | Val Acc: 0.5360
 Best site-East_Asian               (2)  | Epoch:27 | Val Acc: 0.5870
 Best site-East_Asian               (1)  | Epoch:27 | Val Acc: 0.5540
 Best site-Indian                   (0)  | Epoch:27 | Val Acc: 0.4565
 Best site-Indian                   (4)  | Epoch:27 | Val Acc: 0.4784
 Best site-Southeast_Asian          (4)  | Epoch:27 | Val Acc: 0.5109
 Best site-Southeast_Asian          (4)  | Epoch:27 | Val Acc: 0.5036
 Best site-Middle_Eastern           (6)  | Epoch:27 | Val Acc: 0.4891
 Best site-Middle_Eastern           (6)  | Epoch:27 | Val Acc: 0.4676
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 4, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3352 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.2640 | Train Acc: 0.4988
 Site-Latino_Hispanic          | Train Loss: 1.5587 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.3583 | Train Acc: 0.4988
 Site-Black                    | Train Loss: 1.5848 | Train Acc: 0.3669
 Site-Black                    | Train Loss: 1.3987 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.3253 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2374 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.3201 | Train Acc: 0.4964
 Site-Indian                   | Train Loss: 1.3403 | Train Acc: 0.4652
 Site-Southeast_Asian          | Train Loss: 1.3911 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.3161 | Train Acc: 0.5204
 Site-Middle_Eastern           | Train Loss: 1.3594 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.2693 | Train Acc: 0.5060
 Site-White                     (2) | Val  Loss: 1.2619 | Val  Acc: 0.5326
 Site-White                     (3) | Val  Loss: 1.2678 | Val  Acc: 0.5144
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3713 | Val  Acc: 0.5326
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3178 | Val  Acc: 0.4820
 Site-Black                     (0) | Val  Loss: 1.2845 | Val  Acc: 0.5978
 Site-Black                     (4) | Val  Loss: 1.3467 | Val  Acc: 0.5432
 Site-East_Asian                (1) | Val  Loss: 1.1704 | Val  Acc: 0.5543
 Site-East_Asian                (1) | Val  Loss: 1.2611 | Val  Acc: 0.5216
 Site-Indian                    (1) | Val  Loss: 1.3957 | Val  Acc: 0.4457
 Site-Indian                    (0) | Val  Loss: 1.3485 | Val  Acc: 0.4712
 Site-Southeast_Asian           (6) | Val  Loss: 1.2923 | Val  Acc: 0.5109
 Site-Southeast_Asian           (1) | Val  Loss: 1.2746 | Val  Acc: 0.5108
 Site-Middle_Eastern            (2) | Val  Loss: 1.3383 | Val  Acc: 0.5652
 Site-Middle_Eastern            (2) | Val  Loss: 1.2975 | Val  Acc: 0.5108
Average Valid Accuracy: 0.5209
Aggregated Acc | Val Acc: 0.5238
 Best site-White                    (2)  | Epoch:28 | Val Acc: 0.5326
 Best site-White                    (3)  | Epoch:28 | Val Acc: 0.5144
 Best site-Latino_Hispanic          (5)  | Epoch:28 | Val Acc: 0.5326
 Best site-Latino_Hispanic          (2)  | Epoch:28 | Val Acc: 0.4820
 Best site-Black                    (0)  | Epoch:28 | Val Acc: 0.5978
 Best site-Black                    (4)  | Epoch:28 | Val Acc: 0.5432
 Best site-East_Asian               (1)  | Epoch:28 | Val Acc: 0.5543
 Best site-East_Asian               (1)  | Epoch:28 | Val Acc: 0.5216
 Best site-Indian                   (1)  | Epoch:28 | Val Acc: 0.4457
 Best site-Indian                   (0)  | Epoch:28 | Val Acc: 0.4712
 Best site-Southeast_Asian          (6)  | Epoch:28 | Val Acc: 0.5109
 Best site-Southeast_Asian          (1)  | Epoch:28 | Val Acc: 0.5108
 Best site-Middle_Eastern           (2)  | Epoch:28 | Val Acc: 0.5652
 Best site-Middle_Eastern           (2)  | Epoch:28 | Val Acc: 0.5108
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 29 ============
cnt=[4, 3, 2, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3327 | Train Acc: 0.4892
 Site-White                    | Train Loss: 1.2062 | Train Acc: 0.5180
 Site-Latino_Hispanic          | Train Loss: 1.5466 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.3224 | Train Acc: 0.4892
 Site-Black                    | Train Loss: 1.5801 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.3754 | Train Acc: 0.5036
 Site-East_Asian               | Train Loss: 1.3218 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.2313 | Train Acc: 0.5204
 Site-Indian                   | Train Loss: 1.2844 | Train Acc: 0.5396
 Site-Indian                   | Train Loss: 1.3780 | Train Acc: 0.4580
 Site-Southeast_Asian          | Train Loss: 1.3837 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.3475 | Train Acc: 0.5204
 Site-Middle_Eastern           | Train Loss: 1.3666 | Train Acc: 0.4173
 Site-Middle_Eastern           | Train Loss: 1.2332 | Train Acc: 0.5156
 Site-White                     (5) | Val  Loss: 1.2152 | Val  Acc: 0.5543
 Site-White                     (4) | Val  Loss: 1.2540 | Val  Acc: 0.5072
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3379 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3335 | Val  Acc: 0.4496
 Site-Black                     (2) | Val  Loss: 1.2697 | Val  Acc: 0.5326
 Site-Black                     (2) | Val  Loss: 1.3878 | Val  Acc: 0.4892
 Site-East_Asian                (0) | Val  Loss: 1.1371 | Val  Acc: 0.5543
 Site-East_Asian                (0) | Val  Loss: 1.2119 | Val  Acc: 0.5540
 Site-Indian                    (1) | Val  Loss: 1.3598 | Val  Acc: 0.4348
 Site-Indian                    (6) | Val  Loss: 1.3153 | Val  Acc: 0.4928
 Site-Southeast_Asian           (0) | Val  Loss: 1.2599 | Val  Acc: 0.5435
 Site-Southeast_Asian           (0) | Val  Loss: 1.2780 | Val  Acc: 0.5396
 Site-Middle_Eastern            (1) | Val  Loss: 1.2928 | Val  Acc: 0.5109
 Site-Middle_Eastern            (1) | Val  Loss: 1.3061 | Val  Acc: 0.5144
Average Valid Accuracy: 0.5127
Aggregated Acc | Val Acc: 0.5112
============ Train epoch 30 ============
cnt=[2, 3, 2, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.2984 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.2855 | Train Acc: 0.5276
 Site-Latino_Hispanic          | Train Loss: 1.5401 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.3141 | Train Acc: 0.4868
 Site-Black                    | Train Loss: 1.5183 | Train Acc: 0.3597
 Site-Black                    | Train Loss: 1.4381 | Train Acc: 0.4964
 Site-East_Asian               | Train Loss: 1.3316 | Train Acc: 0.4820
 Site-East_Asian               | Train Loss: 1.2281 | Train Acc: 0.5228
 Site-Indian                   | Train Loss: 1.2849 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.3372 | Train Acc: 0.4796
 Site-Southeast_Asian          | Train Loss: 1.4402 | Train Acc: 0.4173
 Site-Southeast_Asian          | Train Loss: 1.3469 | Train Acc: 0.5276
 Site-Middle_Eastern           | Train Loss: 1.3485 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.2295 | Train Acc: 0.5060
 Site-White                     (3) | Val  Loss: 1.2877 | Val  Acc: 0.5435
 Site-White                     (4) | Val  Loss: 1.2286 | Val  Acc: 0.5216
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3581 | Val  Acc: 0.4674
 Site-Latino_Hispanic           (1) | Val  Loss: 1.2984 | Val  Acc: 0.4712
 Site-Black                     (2) | Val  Loss: 1.2105 | Val  Acc: 0.6304
 Site-Black                     (2) | Val  Loss: 1.3429 | Val  Acc: 0.5144
 Site-East_Asian                (5) | Val  Loss: 1.1730 | Val  Acc: 0.5652
 Site-East_Asian                (6) | Val  Loss: 1.2522 | Val  Acc: 0.5360
 Site-Indian                    (0) | Val  Loss: 1.3540 | Val  Acc: 0.4348
 Site-Indian                    (0) | Val  Loss: 1.3419 | Val  Acc: 0.5000
 Site-Southeast_Asian           (1) | Val  Loss: 1.2785 | Val  Acc: 0.5326
 Site-Southeast_Asian           (1) | Val  Loss: 1.2416 | Val  Acc: 0.5324
 Site-Middle_Eastern            (4) | Val  Loss: 1.3439 | Val  Acc: 0.5000
 Site-Middle_Eastern            (4) | Val  Loss: 1.2981 | Val  Acc: 0.4424
Average Valid Accuracy: 0.5137
Aggregated Acc | Val Acc: 0.5256
============ Train epoch 31 ============
cnt=[1, 2, 5, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3351 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.2374 | Train Acc: 0.5276
 Site-Latino_Hispanic          | Train Loss: 1.5172 | Train Acc: 0.4101
 Site-Latino_Hispanic          | Train Loss: 1.2937 | Train Acc: 0.4988
 Site-Black                    | Train Loss: 1.5720 | Train Acc: 0.3813
 Site-Black                    | Train Loss: 1.4325 | Train Acc: 0.4700
 Site-East_Asian               | Train Loss: 1.3478 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2688 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.2827 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.3077 | Train Acc: 0.4700
 Site-Southeast_Asian          | Train Loss: 1.4131 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.3273 | Train Acc: 0.5204
 Site-Middle_Eastern           | Train Loss: 1.3459 | Train Acc: 0.5324
 Site-Middle_Eastern           | Train Loss: 1.1967 | Train Acc: 0.5156
 Site-White                     (3) | Val  Loss: 1.2562 | Val  Acc: 0.5109
 Site-White                     (3) | Val  Loss: 1.2736 | Val  Acc: 0.4928
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3045 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3441 | Val  Acc: 0.4496
 Site-Black                     (2) | Val  Loss: 1.1924 | Val  Acc: 0.6304
 Site-Black                     (0) | Val  Loss: 1.3567 | Val  Acc: 0.4892
 Site-East_Asian                (6) | Val  Loss: 1.1813 | Val  Acc: 0.5652
 Site-East_Asian                (4) | Val  Loss: 1.2262 | Val  Acc: 0.5396
 Site-Indian                    (2) | Val  Loss: 1.3990 | Val  Acc: 0.4457
 Site-Indian                    (2) | Val  Loss: 1.3520 | Val  Acc: 0.4820
 Site-Southeast_Asian           (6) | Val  Loss: 1.2153 | Val  Acc: 0.5652
 Site-Southeast_Asian           (2) | Val  Loss: 1.2763 | Val  Acc: 0.5360
 Site-Middle_Eastern            (1) | Val  Loss: 1.3190 | Val  Acc: 0.5652
 Site-Middle_Eastern            (5) | Val  Loss: 1.2702 | Val  Acc: 0.5144
Average Valid Accuracy: 0.5173
Aggregated Acc | Val Acc: 0.5185
============ Train epoch 32 ============
cnt=[3, 1, 2, 1, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3124 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.2052 | Train Acc: 0.5348
 Site-Latino_Hispanic          | Train Loss: 1.5308 | Train Acc: 0.4532
 Site-Latino_Hispanic          | Train Loss: 1.3161 | Train Acc: 0.4796
 Site-Black                    | Train Loss: 1.5580 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.3775 | Train Acc: 0.5012
 Site-East_Asian               | Train Loss: 1.3339 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2409 | Train Acc: 0.5228
 Site-Indian                   | Train Loss: 1.2715 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.2859 | Train Acc: 0.5060
 Site-Southeast_Asian          | Train Loss: 1.3669 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.3505 | Train Acc: 0.5372
 Site-Middle_Eastern           | Train Loss: 1.3129 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.2298 | Train Acc: 0.5492
 Site-White                     (4) | Val  Loss: 1.2649 | Val  Acc: 0.5435
 Site-White                     (3) | Val  Loss: 1.2538 | Val  Acc: 0.5576
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3458 | Val  Acc: 0.5217
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3317 | Val  Acc: 0.4496
 Site-Black                     (2) | Val  Loss: 1.1685 | Val  Acc: 0.6196
 Site-Black                     (2) | Val  Loss: 1.3482 | Val  Acc: 0.5360
 Site-East_Asian                (6) | Val  Loss: 1.1241 | Val  Acc: 0.5652
 Site-East_Asian                (6) | Val  Loss: 1.2472 | Val  Acc: 0.5504
 Site-Indian                    (5) | Val  Loss: 1.3876 | Val  Acc: 0.4348
 Site-Indian                    (5) | Val  Loss: 1.3127 | Val  Acc: 0.5252
 Site-Southeast_Asian           (6) | Val  Loss: 1.3141 | Val  Acc: 0.5000
 Site-Southeast_Asian           (6) | Val  Loss: 1.2653 | Val  Acc: 0.5324
 Site-Middle_Eastern            (0) | Val  Loss: 1.3525 | Val  Acc: 0.5109
 Site-Middle_Eastern            (0) | Val  Loss: 1.2579 | Val  Acc: 0.5180
Average Valid Accuracy: 0.5261
Aggregated Acc | Val Acc: 0.5300
 Best site-White                    (4)  | Epoch:32 | Val Acc: 0.5435
 Best site-White                    (3)  | Epoch:32 | Val Acc: 0.5576
 Best site-Latino_Hispanic          (1)  | Epoch:32 | Val Acc: 0.5217
 Best site-Latino_Hispanic          (0)  | Epoch:32 | Val Acc: 0.4496
 Best site-Black                    (2)  | Epoch:32 | Val Acc: 0.6196
 Best site-Black                    (2)  | Epoch:32 | Val Acc: 0.5360
 Best site-East_Asian               (6)  | Epoch:32 | Val Acc: 0.5652
 Best site-East_Asian               (6)  | Epoch:32 | Val Acc: 0.5504
 Best site-Indian                   (5)  | Epoch:32 | Val Acc: 0.4348
 Best site-Indian                   (5)  | Epoch:32 | Val Acc: 0.5252
 Best site-Southeast_Asian          (6)  | Epoch:32 | Val Acc: 0.5000
 Best site-Southeast_Asian          (6)  | Epoch:32 | Val Acc: 0.5324
 Best site-Middle_Eastern           (0)  | Epoch:32 | Val Acc: 0.5109
 Best site-Middle_Eastern           (0)  | Epoch:32 | Val Acc: 0.5180
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 33 ============
cnt=[1, 2, 3, 2, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3667 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.2867 | Train Acc: 0.5420
 Site-Latino_Hispanic          | Train Loss: 1.4719 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.3286 | Train Acc: 0.4844
 Site-Black                    | Train Loss: 1.5437 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.3723 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.3331 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.2276 | Train Acc: 0.5516
 Site-Indian                   | Train Loss: 1.2939 | Train Acc: 0.4820
 Site-Indian                   | Train Loss: 1.3909 | Train Acc: 0.4652
 Site-Southeast_Asian          | Train Loss: 1.3853 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.2938 | Train Acc: 0.5348
 Site-Middle_Eastern           | Train Loss: 1.3479 | Train Acc: 0.4604
 Site-Middle_Eastern           | Train Loss: 1.2018 | Train Acc: 0.5372
 Site-White                     (1) | Val  Loss: 1.2522 | Val  Acc: 0.5543
 Site-White                     (4) | Val  Loss: 1.2275 | Val  Acc: 0.5252
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3032 | Val  Acc: 0.5217
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3174 | Val  Acc: 0.5000
 Site-Black                     (6) | Val  Loss: 1.2149 | Val  Acc: 0.6087
 Site-Black                     (0) | Val  Loss: 1.3734 | Val  Acc: 0.5036
 Site-East_Asian                (2) | Val  Loss: 1.1812 | Val  Acc: 0.5761
 Site-East_Asian                (2) | Val  Loss: 1.2641 | Val  Acc: 0.5360
 Site-Indian                    (6) | Val  Loss: 1.3834 | Val  Acc: 0.4674
 Site-Indian                    (5) | Val  Loss: 1.3198 | Val  Acc: 0.4856
 Site-Southeast_Asian           (2) | Val  Loss: 1.2775 | Val  Acc: 0.5109
 Site-Southeast_Asian           (5) | Val  Loss: 1.2598 | Val  Acc: 0.5144
 Site-Middle_Eastern            (3) | Val  Loss: 1.2946 | Val  Acc: 0.5000
 Site-Middle_Eastern            (3) | Val  Loss: 1.2801 | Val  Acc: 0.5036
Average Valid Accuracy: 0.5220
Aggregated Acc | Val Acc: 0.5211
============ Train epoch 34 ============
cnt=[1, 5, 2, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.2977 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.2172 | Train Acc: 0.5324
 Site-Latino_Hispanic          | Train Loss: 1.5712 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.2905 | Train Acc: 0.4820
 Site-Black                    | Train Loss: 1.5335 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.3300 | Train Acc: 0.4844
 Site-East_Asian               | Train Loss: 1.3286 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.2215 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.2753 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.2857 | Train Acc: 0.4940
 Site-Southeast_Asian          | Train Loss: 1.3787 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.2853 | Train Acc: 0.5252
 Site-Middle_Eastern           | Train Loss: 1.3521 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.2609 | Train Acc: 0.5108
 Site-White                     (3) | Val  Loss: 1.2795 | Val  Acc: 0.4457
 Site-White                     (6) | Val  Loss: 1.2222 | Val  Acc: 0.5216
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3007 | Val  Acc: 0.5217
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3083 | Val  Acc: 0.4604
 Site-Black                     (2) | Val  Loss: 1.1942 | Val  Acc: 0.5978
 Site-Black                     (2) | Val  Loss: 1.3449 | Val  Acc: 0.5000
 Site-East_Asian                (5) | Val  Loss: 1.1447 | Val  Acc: 0.5761
 Site-East_Asian                (1) | Val  Loss: 1.2037 | Val  Acc: 0.5719
 Site-Indian                    (1) | Val  Loss: 1.3576 | Val  Acc: 0.4457
 Site-Indian                    (1) | Val  Loss: 1.2922 | Val  Acc: 0.4964
 Site-Southeast_Asian           (1) | Val  Loss: 1.2343 | Val  Acc: 0.5326
 Site-Southeast_Asian           (0) | Val  Loss: 1.2597 | Val  Acc: 0.5360
 Site-Middle_Eastern            (3) | Val  Loss: 1.2928 | Val  Acc: 0.5217
 Site-Middle_Eastern            (3) | Val  Loss: 1.2618 | Val  Acc: 0.5036
Average Valid Accuracy: 0.5165
Aggregated Acc | Val Acc: 0.5280
============ Train epoch 35 ============
cnt=[1, 4, 3, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3140 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.2253 | Train Acc: 0.5396
 Site-Latino_Hispanic          | Train Loss: 1.5065 | Train Acc: 0.4532
 Site-Latino_Hispanic          | Train Loss: 1.3321 | Train Acc: 0.4628
 Site-Black                    | Train Loss: 1.5138 | Train Acc: 0.4388
 Site-Black                    | Train Loss: 1.3324 | Train Acc: 0.4844
 Site-East_Asian               | Train Loss: 1.3361 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.2820 | Train Acc: 0.5468
 Site-Indian                   | Train Loss: 1.2674 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.3085 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3589 | Train Acc: 0.4892
 Site-Southeast_Asian          | Train Loss: 1.2637 | Train Acc: 0.5324
 Site-Middle_Eastern           | Train Loss: 1.3591 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.2260 | Train Acc: 0.5180
 Site-White                     (1) | Val  Loss: 1.2659 | Val  Acc: 0.4891
 Site-White                     (1) | Val  Loss: 1.2231 | Val  Acc: 0.5432
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3307 | Val  Acc: 0.4891
 Site-Latino_Hispanic           (4) | Val  Loss: 1.3058 | Val  Acc: 0.4784
 Site-Black                     (5) | Val  Loss: 1.1822 | Val  Acc: 0.6196
 Site-Black                     (6) | Val  Loss: 1.3301 | Val  Acc: 0.5324
 Site-East_Asian                (3) | Val  Loss: 1.1568 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.1901 | Val  Acc: 0.5540
 Site-Indian                    (2) | Val  Loss: 1.3706 | Val  Acc: 0.4565
 Site-Indian                    (2) | Val  Loss: 1.2888 | Val  Acc: 0.5324
 Site-Southeast_Asian           (4) | Val  Loss: 1.2434 | Val  Acc: 0.5109
 Site-Southeast_Asian           (4) | Val  Loss: 1.2591 | Val  Acc: 0.5468
 Site-Middle_Eastern            (1) | Val  Loss: 1.3293 | Val  Acc: 0.4674
 Site-Middle_Eastern            (1) | Val  Loss: 1.2960 | Val  Acc: 0.4856
Average Valid Accuracy: 0.5193
Aggregated Acc | Val Acc: 0.5389
============ Train epoch 36 ============
cnt=[3, 2, 1, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3158 | Train Acc: 0.4964
 Site-White                    | Train Loss: 1.1963 | Train Acc: 0.5324
 Site-Latino_Hispanic          | Train Loss: 1.4798 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.3353 | Train Acc: 0.4748
 Site-Black                    | Train Loss: 1.5299 | Train Acc: 0.4029
 Site-Black                    | Train Loss: 1.3293 | Train Acc: 0.5060
 Site-East_Asian               | Train Loss: 1.3198 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2277 | Train Acc: 0.5420
 Site-Indian                   | Train Loss: 1.2734 | Train Acc: 0.4676
 Site-Indian                   | Train Loss: 1.3416 | Train Acc: 0.4772
 Site-Southeast_Asian          | Train Loss: 1.4187 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.2656 | Train Acc: 0.5348
 Site-Middle_Eastern           | Train Loss: 1.3501 | Train Acc: 0.4892
 Site-Middle_Eastern           | Train Loss: 1.1903 | Train Acc: 0.5276
 Site-White                     (4) | Val  Loss: 1.2071 | Val  Acc: 0.5652
 Site-White                     (0) | Val  Loss: 1.2148 | Val  Acc: 0.5504
 Site-Latino_Hispanic           (5) | Val  Loss: 1.2823 | Val  Acc: 0.5217
 Site-Latino_Hispanic           (6) | Val  Loss: 1.3139 | Val  Acc: 0.4460
 Site-Black                     (3) | Val  Loss: 1.1424 | Val  Acc: 0.6413
 Site-Black                     (2) | Val  Loss: 1.3379 | Val  Acc: 0.5504
 Site-East_Asian                (5) | Val  Loss: 1.1036 | Val  Acc: 0.5652
 Site-East_Asian                (1) | Val  Loss: 1.1865 | Val  Acc: 0.5719
 Site-Indian                    (3) | Val  Loss: 1.3796 | Val  Acc: 0.4674
 Site-Indian                    (3) | Val  Loss: 1.3221 | Val  Acc: 0.5180
 Site-Southeast_Asian           (1) | Val  Loss: 1.2525 | Val  Acc: 0.5543
 Site-Southeast_Asian           (5) | Val  Loss: 1.2704 | Val  Acc: 0.5180
 Site-Middle_Eastern            (0) | Val  Loss: 1.3210 | Val  Acc: 0.5217
 Site-Middle_Eastern            (0) | Val  Loss: 1.2625 | Val  Acc: 0.4604
Average Valid Accuracy: 0.5323
Aggregated Acc | Val Acc: 0.5304
 Best site-White                    (4)  | Epoch:36 | Val Acc: 0.5652
 Best site-White                    (0)  | Epoch:36 | Val Acc: 0.5504
 Best site-Latino_Hispanic          (5)  | Epoch:36 | Val Acc: 0.5217
 Best site-Latino_Hispanic          (6)  | Epoch:36 | Val Acc: 0.4460
 Best site-Black                    (3)  | Epoch:36 | Val Acc: 0.6413
 Best site-Black                    (2)  | Epoch:36 | Val Acc: 0.5504
 Best site-East_Asian               (5)  | Epoch:36 | Val Acc: 0.5652
 Best site-East_Asian               (1)  | Epoch:36 | Val Acc: 0.5719
 Best site-Indian                   (3)  | Epoch:36 | Val Acc: 0.4674
 Best site-Indian                   (3)  | Epoch:36 | Val Acc: 0.5180
 Best site-Southeast_Asian          (1)  | Epoch:36 | Val Acc: 0.5543
 Best site-Southeast_Asian          (5)  | Epoch:36 | Val Acc: 0.5180
 Best site-Middle_Eastern           (0)  | Epoch:36 | Val Acc: 0.5217
 Best site-Middle_Eastern           (0)  | Epoch:36 | Val Acc: 0.4604
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 37 ============
cnt=[6, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3113 | Train Acc: 0.5036
 Site-White                    | Train Loss: 1.1796 | Train Acc: 0.5228
 Site-Latino_Hispanic          | Train Loss: 1.4960 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.2981 | Train Acc: 0.4916
 Site-Black                    | Train Loss: 1.4880 | Train Acc: 0.4676
 Site-Black                    | Train Loss: 1.3940 | Train Acc: 0.5204
 Site-East_Asian               | Train Loss: 1.3663 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.2592 | Train Acc: 0.5659
 Site-Indian                   | Train Loss: 1.2613 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.2884 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3713 | Train Acc: 0.4317
 Site-Southeast_Asian          | Train Loss: 1.3141 | Train Acc: 0.5564
 Site-Middle_Eastern           | Train Loss: 1.3074 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.2257 | Train Acc: 0.5228
 Site-White                     (0) | Val  Loss: 1.1703 | Val  Acc: 0.5761
 Site-White                     (5) | Val  Loss: 1.2247 | Val  Acc: 0.5504
 Site-Latino_Hispanic           (0) | Val  Loss: 1.2987 | Val  Acc: 0.5326
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3063 | Val  Acc: 0.5000
 Site-Black                     (2) | Val  Loss: 1.2194 | Val  Acc: 0.6087
 Site-Black                     (4) | Val  Loss: 1.2835 | Val  Acc: 0.5288
 Site-East_Asian                (3) | Val  Loss: 1.1323 | Val  Acc: 0.5761
 Site-East_Asian                (3) | Val  Loss: 1.2487 | Val  Acc: 0.5288
 Site-Indian                    (1) | Val  Loss: 1.3396 | Val  Acc: 0.4674
 Site-Indian                    (1) | Val  Loss: 1.2894 | Val  Acc: 0.4892
 Site-Southeast_Asian           (0) | Val  Loss: 1.2326 | Val  Acc: 0.5870
 Site-Southeast_Asian           (0) | Val  Loss: 1.2662 | Val  Acc: 0.5576
 Site-Middle_Eastern            (0) | Val  Loss: 1.3507 | Val  Acc: 0.4565
 Site-Middle_Eastern            (6) | Val  Loss: 1.2837 | Val  Acc: 0.4964
Average Valid Accuracy: 0.5325
Aggregated Acc | Val Acc: 0.5357
 Best site-White                    (0)  | Epoch:37 | Val Acc: 0.5761
 Best site-White                    (5)  | Epoch:37 | Val Acc: 0.5504
 Best site-Latino_Hispanic          (0)  | Epoch:37 | Val Acc: 0.5326
 Best site-Latino_Hispanic          (0)  | Epoch:37 | Val Acc: 0.5000
 Best site-Black                    (2)  | Epoch:37 | Val Acc: 0.6087
 Best site-Black                    (4)  | Epoch:37 | Val Acc: 0.5288
 Best site-East_Asian               (3)  | Epoch:37 | Val Acc: 0.5761
 Best site-East_Asian               (3)  | Epoch:37 | Val Acc: 0.5288
 Best site-Indian                   (1)  | Epoch:37 | Val Acc: 0.4674
 Best site-Indian                   (1)  | Epoch:37 | Val Acc: 0.4892
 Best site-Southeast_Asian          (0)  | Epoch:37 | Val Acc: 0.5870
 Best site-Southeast_Asian          (0)  | Epoch:37 | Val Acc: 0.5576
 Best site-Middle_Eastern           (0)  | Epoch:37 | Val Acc: 0.4565
 Best site-Middle_Eastern           (6)  | Epoch:37 | Val Acc: 0.4964
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 38 ============
cnt=[1, 1, 1, 4, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3126 | Train Acc: 0.4604
 Site-White                    | Train Loss: 1.1869 | Train Acc: 0.5827
 Site-Latino_Hispanic          | Train Loss: 1.4722 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.2604 | Train Acc: 0.5204
 Site-Black                    | Train Loss: 1.5577 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.3774 | Train Acc: 0.4892
 Site-East_Asian               | Train Loss: 1.3052 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.1991 | Train Acc: 0.5635
 Site-Indian                   | Train Loss: 1.2767 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.2927 | Train Acc: 0.4772
 Site-Southeast_Asian          | Train Loss: 1.3921 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.2909 | Train Acc: 0.5468
 Site-Middle_Eastern           | Train Loss: 1.3504 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.2081 | Train Acc: 0.5132
 Site-White                     (6) | Val  Loss: 1.1808 | Val  Acc: 0.5870
 Site-White                     (6) | Val  Loss: 1.2152 | Val  Acc: 0.5612
 Site-Latino_Hispanic           (3) | Val  Loss: 1.2755 | Val  Acc: 0.5217
 Site-Latino_Hispanic           (3) | Val  Loss: 1.3017 | Val  Acc: 0.5036
 Site-Black                     (5) | Val  Loss: 1.1493 | Val  Acc: 0.6304
 Site-Black                     (4) | Val  Loss: 1.3266 | Val  Acc: 0.5252
 Site-East_Asian                (3) | Val  Loss: 1.0834 | Val  Acc: 0.5652
 Site-East_Asian                (2) | Val  Loss: 1.1998 | Val  Acc: 0.5144
 Site-Indian                    (5) | Val  Loss: 1.3436 | Val  Acc: 0.4565
 Site-Indian                    (5) | Val  Loss: 1.3343 | Val  Acc: 0.4640
 Site-Southeast_Asian           (0) | Val  Loss: 1.2329 | Val  Acc: 0.5543
 Site-Southeast_Asian           (3) | Val  Loss: 1.2361 | Val  Acc: 0.5432
 Site-Middle_Eastern            (1) | Val  Loss: 1.3100 | Val  Acc: 0.5109
 Site-Middle_Eastern            (5) | Val  Loss: 1.2743 | Val  Acc: 0.5072
Average Valid Accuracy: 0.5318
Aggregated Acc | Val Acc: 0.5324
============ Train epoch 39 ============
cnt=[1, 1, 3, 4, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3165 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.1918 | Train Acc: 0.5612
 Site-Latino_Hispanic          | Train Loss: 1.4555 | Train Acc: 0.4460
 Site-Latino_Hispanic          | Train Loss: 1.3129 | Train Acc: 0.4820
 Site-Black                    | Train Loss: 1.5698 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.3153 | Train Acc: 0.5372
 Site-East_Asian               | Train Loss: 1.3549 | Train Acc: 0.4964
 Site-East_Asian               | Train Loss: 1.2402 | Train Acc: 0.5444
 Site-Indian                   | Train Loss: 1.2407 | Train Acc: 0.5396
 Site-Indian                   | Train Loss: 1.3360 | Train Acc: 0.4988
 Site-Southeast_Asian          | Train Loss: 1.3709 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.3198 | Train Acc: 0.5612
 Site-Middle_Eastern           | Train Loss: 1.3386 | Train Acc: 0.4748
 Site-Middle_Eastern           | Train Loss: 1.2185 | Train Acc: 0.5060
 Site-White                     (3) | Val  Loss: 1.1897 | Val  Acc: 0.5652
 Site-White                     (3) | Val  Loss: 1.2160 | Val  Acc: 0.5432
 Site-Latino_Hispanic           (3) | Val  Loss: 1.2505 | Val  Acc: 0.5000
 Site-Latino_Hispanic           (2) | Val  Loss: 1.3325 | Val  Acc: 0.4748
 Site-Black                     (6) | Val  Loss: 1.1992 | Val  Acc: 0.5543
 Site-Black                     (6) | Val  Loss: 1.2932 | Val  Acc: 0.5360
 Site-East_Asian                (0) | Val  Loss: 1.1337 | Val  Acc: 0.5652
 Site-East_Asian                (3) | Val  Loss: 1.1999 | Val  Acc: 0.5576
 Site-Indian                    (2) | Val  Loss: 1.3991 | Val  Acc: 0.4239
 Site-Indian                    (2) | Val  Loss: 1.2879 | Val  Acc: 0.4820
 Site-Southeast_Asian           (5) | Val  Loss: 1.2811 | Val  Acc: 0.5109
 Site-Southeast_Asian           (5) | Val  Loss: 1.2609 | Val  Acc: 0.5396
 Site-Middle_Eastern            (1) | Val  Loss: 1.3380 | Val  Acc: 0.4674
 Site-Middle_Eastern            (4) | Val  Loss: 1.2899 | Val  Acc: 0.4964
Average Valid Accuracy: 0.5155
Aggregated Acc | Val Acc: 0.5144
============ Train epoch 40 ============
cnt=[2, 1, 2, 1, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3354 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.1467 | Train Acc: 0.5396
 Site-Latino_Hispanic          | Train Loss: 1.5177 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.3190 | Train Acc: 0.4868
 Site-Black                    | Train Loss: 1.4678 | Train Acc: 0.4460
 Site-Black                    | Train Loss: 1.3277 | Train Acc: 0.5036
 Site-East_Asian               | Train Loss: 1.2853 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.3448 | Train Acc: 0.5492
 Site-Indian                   | Train Loss: 1.2915 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.3435 | Train Acc: 0.4724
 Site-Southeast_Asian          | Train Loss: 1.3593 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.2641 | Train Acc: 0.5564
 Site-Middle_Eastern           | Train Loss: 1.3311 | Train Acc: 0.4964
 Site-Middle_Eastern           | Train Loss: 1.2334 | Train Acc: 0.5396
 Site-White                     (5) | Val  Loss: 1.2200 | Val  Acc: 0.5652
 Site-White                     (3) | Val  Loss: 1.1946 | Val  Acc: 0.5576
 Site-Latino_Hispanic           (6) | Val  Loss: 1.2609 | Val  Acc: 0.5217
 Site-Latino_Hispanic           (1) | Val  Loss: 1.3173 | Val  Acc: 0.4640
 Site-Black                     (0) | Val  Loss: 1.1650 | Val  Acc: 0.6413
 Site-Black                     (0) | Val  Loss: 1.3414 | Val  Acc: 0.4856
 Site-East_Asian                (2) | Val  Loss: 1.1235 | Val  Acc: 0.5978
 Site-East_Asian                (5) | Val  Loss: 1.1745 | Val  Acc: 0.5647
 Site-Indian                    (6) | Val  Loss: 1.3716 | Val  Acc: 0.4783
 Site-Indian                    (6) | Val  Loss: 1.2958 | Val  Acc: 0.4784
 Site-Southeast_Asian           (5) | Val  Loss: 1.2538 | Val  Acc: 0.5326
 Site-Southeast_Asian           (2) | Val  Loss: 1.2328 | Val  Acc: 0.5719
 Site-Middle_Eastern            (4) | Val  Loss: 1.3376 | Val  Acc: 0.4891
 Site-Middle_Eastern            (4) | Val  Loss: 1.2672 | Val  Acc: 0.4820
Average Valid Accuracy: 0.5307
Aggregated Acc | Val Acc: 0.5289
============ Train epoch 41 ============
cnt=[5, 2, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.2999 | Train Acc: 0.4820
 Site-White                    | Train Loss: 1.1825 | Train Acc: 0.5540
 Site-Latino_Hispanic          | Train Loss: 1.5491 | Train Acc: 0.3885
 Site-Latino_Hispanic          | Train Loss: 1.2553 | Train Acc: 0.5084
 Site-Black                    | Train Loss: 1.4726 | Train Acc: 0.4317
 Site-Black                    | Train Loss: 1.3023 | Train Acc: 0.5108
 Site-East_Asian               | Train Loss: 1.3143 | Train Acc: 0.4604
 Site-East_Asian               | Train Loss: 1.2149 | Train Acc: 0.5707
 Site-Indian                   | Train Loss: 1.2536 | Train Acc: 0.5755
 Site-Indian                   | Train Loss: 1.2669 | Train Acc: 0.4916
 Site-Southeast_Asian          | Train Loss: 1.3520 | Train Acc: 0.4460
 Site-Southeast_Asian          | Train Loss: 1.2770 | Train Acc: 0.5564
 Site-Middle_Eastern           | Train Loss: 1.3735 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.1965 | Train Acc: 0.5300
 Site-White                     (1) | Val  Loss: 1.2285 | Val  Acc: 0.5326
 Site-White                     (2) | Val  Loss: 1.2222 | Val  Acc: 0.5252
 Site-Latino_Hispanic           (1) | Val  Loss: 1.2741 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3042 | Val  Acc: 0.4460
 Site-Black                     (6) | Val  Loss: 1.1548 | Val  Acc: 0.6522
 Site-Black                     (0) | Val  Loss: 1.3466 | Val  Acc: 0.4892
 Site-East_Asian                (5) | Val  Loss: 1.1039 | Val  Acc: 0.5543
 Site-East_Asian                (4) | Val  Loss: 1.2227 | Val  Acc: 0.5252
 Site-Indian                    (3) | Val  Loss: 1.3581 | Val  Acc: 0.4565
 Site-Indian                    (3) | Val  Loss: 1.2557 | Val  Acc: 0.5468
 Site-Southeast_Asian           (0) | Val  Loss: 1.2105 | Val  Acc: 0.5543
 Site-Southeast_Asian           (3) | Val  Loss: 1.2327 | Val  Acc: 0.5612
 Site-Middle_Eastern            (0) | Val  Loss: 1.2844 | Val  Acc: 0.5217
 Site-Middle_Eastern            (0) | Val  Loss: 1.2570 | Val  Acc: 0.5036
Average Valid Accuracy: 0.5248
Aggregated Acc | Val Acc: 0.5410
============ Train epoch 42 ============
cnt=[4, 2, 2, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3134 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.2639 | Train Acc: 0.5420
 Site-Latino_Hispanic          | Train Loss: 1.4781 | Train Acc: 0.4604
 Site-Latino_Hispanic          | Train Loss: 1.2711 | Train Acc: 0.4652
 Site-Black                    | Train Loss: 1.5424 | Train Acc: 0.3741
 Site-Black                    | Train Loss: 1.2682 | Train Acc: 0.5324
 Site-East_Asian               | Train Loss: 1.3152 | Train Acc: 0.4388
 Site-East_Asian               | Train Loss: 1.2168 | Train Acc: 0.5468
 Site-Indian                   | Train Loss: 1.2727 | Train Acc: 0.5540
 Site-Indian                   | Train Loss: 1.3125 | Train Acc: 0.5036
 Site-Southeast_Asian          | Train Loss: 1.3864 | Train Acc: 0.4388
 Site-Southeast_Asian          | Train Loss: 1.2005 | Train Acc: 0.5612
 Site-Middle_Eastern           | Train Loss: 1.3157 | Train Acc: 0.4820
 Site-Middle_Eastern           | Train Loss: 1.1677 | Train Acc: 0.5180
 Site-White                     (5) | Val  Loss: 1.1867 | Val  Acc: 0.5761
 Site-White                     (6) | Val  Loss: 1.2009 | Val  Acc: 0.5504
 Site-Latino_Hispanic           (3) | Val  Loss: 1.2776 | Val  Acc: 0.5109
 Site-Latino_Hispanic           (4) | Val  Loss: 1.2808 | Val  Acc: 0.4748
 Site-Black                     (2) | Val  Loss: 1.1893 | Val  Acc: 0.5543
 Site-Black                     (2) | Val  Loss: 1.2839 | Val  Acc: 0.5612
 Site-East_Asian                (0) | Val  Loss: 1.0964 | Val  Acc: 0.5652
 Site-East_Asian                (0) | Val  Loss: 1.1901 | Val  Acc: 0.5683
 Site-Indian                    (4) | Val  Loss: 1.3767 | Val  Acc: 0.4130
 Site-Indian                    (4) | Val  Loss: 1.2699 | Val  Acc: 0.4712
 Site-Southeast_Asian           (0) | Val  Loss: 1.2660 | Val  Acc: 0.5870
 Site-Southeast_Asian           (0) | Val  Loss: 1.2237 | Val  Acc: 0.5719
 Site-Middle_Eastern            (1) | Val  Loss: 1.2924 | Val  Acc: 0.4674
 Site-Middle_Eastern            (1) | Val  Loss: 1.2275 | Val  Acc: 0.4928
Average Valid Accuracy: 0.5260
Aggregated Acc | Val Acc: 0.5288
============ Train epoch 43 ============
cnt=[3, 4, 1, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.2751 | Train Acc: 0.5252
 Site-White                    | Train Loss: 1.2563 | Train Acc: 0.5276
 Site-Latino_Hispanic          | Train Loss: 1.5111 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.2636 | Train Acc: 0.5156
 Site-Black                    | Train Loss: 1.5120 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.3613 | Train Acc: 0.4988
 Site-East_Asian               | Train Loss: 1.3256 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.1836 | Train Acc: 0.5372
 Site-Indian                   | Train Loss: 1.2786 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.2827 | Train Acc: 0.4940
 Site-Southeast_Asian          | Train Loss: 1.3685 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.3018 | Train Acc: 0.5612
 Site-Middle_Eastern           | Train Loss: 1.3473 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.1957 | Train Acc: 0.5516
 Site-White                     (5) | Val  Loss: 1.2017 | Val  Acc: 0.5543
 Site-White                     (0) | Val  Loss: 1.2133 | Val  Acc: 0.5288
 Site-Latino_Hispanic           (5) | Val  Loss: 1.2691 | Val  Acc: 0.5326
 Site-Latino_Hispanic           (6) | Val  Loss: 1.2849 | Val  Acc: 0.4856
 Site-Black                     (3) | Val  Loss: 1.2119 | Val  Acc: 0.5978
 Site-Black                     (3) | Val  Loss: 1.2725 | Val  Acc: 0.5755
 Site-East_Asian                (2) | Val  Loss: 1.1537 | Val  Acc: 0.5978
 Site-East_Asian                (4) | Val  Loss: 1.1913 | Val  Acc: 0.5755
 Site-Indian                    (1) | Val  Loss: 1.3114 | Val  Acc: 0.4674
 Site-Indian                    (1) | Val  Loss: 1.3040 | Val  Acc: 0.4784
 Site-Southeast_Asian           (1) | Val  Loss: 1.2179 | Val  Acc: 0.5435
 Site-Southeast_Asian           (1) | Val  Loss: 1.2001 | Val  Acc: 0.5719
 Site-Middle_Eastern            (0) | Val  Loss: 1.2779 | Val  Acc: 0.4891
 Site-Middle_Eastern            (0) | Val  Loss: 1.2361 | Val  Acc: 0.5216
Average Valid Accuracy: 0.5371
Aggregated Acc | Val Acc: 0.5454
 Best site-White                    (5)  | Epoch:43 | Val Acc: 0.5543
 Best site-White                    (0)  | Epoch:43 | Val Acc: 0.5288
 Best site-Latino_Hispanic          (5)  | Epoch:43 | Val Acc: 0.5326
 Best site-Latino_Hispanic          (6)  | Epoch:43 | Val Acc: 0.4856
 Best site-Black                    (3)  | Epoch:43 | Val Acc: 0.5978
 Best site-Black                    (3)  | Epoch:43 | Val Acc: 0.5755
 Best site-East_Asian               (2)  | Epoch:43 | Val Acc: 0.5978
 Best site-East_Asian               (4)  | Epoch:43 | Val Acc: 0.5755
 Best site-Indian                   (1)  | Epoch:43 | Val Acc: 0.4674
 Best site-Indian                   (1)  | Epoch:43 | Val Acc: 0.4784
 Best site-Southeast_Asian          (1)  | Epoch:43 | Val Acc: 0.5435
 Best site-Southeast_Asian          (1)  | Epoch:43 | Val Acc: 0.5719
 Best site-Middle_Eastern           (0)  | Epoch:43 | Val Acc: 0.4891
 Best site-Middle_Eastern           (0)  | Epoch:43 | Val Acc: 0.5216
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 44 ============
cnt=[7, 1, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.2788 | Train Acc: 0.5252
 Site-White                    | Train Loss: 1.1893 | Train Acc: 0.5420
 Site-Latino_Hispanic          | Train Loss: 1.5070 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.3043 | Train Acc: 0.4916
 Site-Black                    | Train Loss: 1.5374 | Train Acc: 0.3957
 Site-Black                    | Train Loss: 1.3077 | Train Acc: 0.5156
 Site-East_Asian               | Train Loss: 1.2877 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.2216 | Train Acc: 0.5420
 Site-Indian                   | Train Loss: 1.2382 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.2692 | Train Acc: 0.5300
 Site-Southeast_Asian          | Train Loss: 1.3879 | Train Acc: 0.4748
 Site-Southeast_Asian          | Train Loss: 1.2465 | Train Acc: 0.5492
 Site-Middle_Eastern           | Train Loss: 1.3157 | Train Acc: 0.5036
 Site-Middle_Eastern           | Train Loss: 1.1743 | Train Acc: 0.5444
 Site-White                     (3) | Val  Loss: 1.1618 | Val  Acc: 0.5435
 Site-White                     (0) | Val  Loss: 1.1922 | Val  Acc: 0.5396
 Site-Latino_Hispanic           (0) | Val  Loss: 1.3218 | Val  Acc: 0.5326
 Site-Latino_Hispanic           (5) | Val  Loss: 1.3092 | Val  Acc: 0.4640
 Site-Black                     (2) | Val  Loss: 1.1914 | Val  Acc: 0.6304
 Site-Black                     (2) | Val  Loss: 1.2844 | Val  Acc: 0.5432
 Site-East_Asian                (4) | Val  Loss: 1.1263 | Val  Acc: 0.5978
 Site-East_Asian                (0) | Val  Loss: 1.2374 | Val  Acc: 0.5252
 Site-Indian                    (6) | Val  Loss: 1.3317 | Val  Acc: 0.4565
 Site-Indian                    (0) | Val  Loss: 1.2760 | Val  Acc: 0.5000
 Site-Southeast_Asian           (0) | Val  Loss: 1.2033 | Val  Acc: 0.5761
 Site-Southeast_Asian           (0) | Val  Loss: 1.2364 | Val  Acc: 0.5360
 Site-Middle_Eastern            (0) | Val  Loss: 1.2949 | Val  Acc: 0.5109
 Site-Middle_Eastern            (1) | Val  Loss: 1.2295 | Val  Acc: 0.4856
Average Valid Accuracy: 0.5315
Aggregated Acc | Val Acc: 0.5237
============ Train epoch 45 ============
cnt=[1, 3, 2, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3209 | Train Acc: 0.4532
 Site-White                    | Train Loss: 1.1414 | Train Acc: 0.5444
 Site-Latino_Hispanic          | Train Loss: 1.4795 | Train Acc: 0.4317
 Site-Latino_Hispanic          | Train Loss: 1.2673 | Train Acc: 0.4892
 Site-Black                    | Train Loss: 1.5043 | Train Acc: 0.4317
 Site-Black                    | Train Loss: 1.2829 | Train Acc: 0.5420
 Site-East_Asian               | Train Loss: 1.3061 | Train Acc: 0.4676
 Site-East_Asian               | Train Loss: 1.2546 | Train Acc: 0.5084
 Site-Indian                   | Train Loss: 1.2335 | Train Acc: 0.5396
 Site-Indian                   | Train Loss: 1.3224 | Train Acc: 0.4868
 Site-Southeast_Asian          | Train Loss: 1.3203 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.2537 | Train Acc: 0.5156
 Site-Middle_Eastern           | Train Loss: 1.3240 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.2220 | Train Acc: 0.5516
 Site-White                     (3) | Val  Loss: 1.2006 | Val  Acc: 0.5652
 Site-White                     (1) | Val  Loss: 1.2310 | Val  Acc: 0.5504
 Site-Latino_Hispanic           (3) | Val  Loss: 1.2499 | Val  Acc: 0.4565
 Site-Latino_Hispanic           (3) | Val  Loss: 1.2736 | Val  Acc: 0.4712
 Site-Black                     (2) | Val  Loss: 1.1887 | Val  Acc: 0.5543
 Site-Black                     (2) | Val  Loss: 1.2694 | Val  Acc: 0.5576
 Site-East_Asian                (4) | Val  Loss: 1.0517 | Val  Acc: 0.6196
 Site-East_Asian                (3) | Val  Loss: 1.1865 | Val  Acc: 0.5612
 Site-Indian                    (5) | Val  Loss: 1.3508 | Val  Acc: 0.4348
 Site-Indian                    (6) | Val  Loss: 1.2766 | Val  Acc: 0.5180
 Site-Southeast_Asian           (0) | Val  Loss: 1.2547 | Val  Acc: 0.5761
 Site-Southeast_Asian           (3) | Val  Loss: 1.2134 | Val  Acc: 0.5540
 Site-Middle_Eastern            (1) | Val  Loss: 1.2498 | Val  Acc: 0.5000
 Site-Middle_Eastern            (1) | Val  Loss: 1.2214 | Val  Acc: 0.5180
Average Valid Accuracy: 0.5312
Aggregated Acc | Val Acc: 0.5355
 Test site-White                    | Epoch:43 | Test Acc: 0.4305
 Test site-Latino_Hispanic          | Epoch:43 | Test Acc: 0.3671
 Test site-Black                    | Epoch:43 | Test Acc: 0.3375
 Test site-East_Asian               | Epoch:43 | Test Acc: 0.5130
 Test site-Indian                   | Epoch:43 | Test Acc: 0.3660
 Test site-Southeast_Asian          | Epoch:43 | Test Acc: 0.4296
 Test site-Middle_Eastern           | Epoch:43 | Test Acc: 0.4304
Average Test Accuracy: 0.4106, domain std=0.0546, individual std=0.0546
Average Test Accuracy: 0.4106
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 46 ============
cnt=[6, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3070 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.1796 | Train Acc: 0.5228
 Site-Latino_Hispanic          | Train Loss: 1.4589 | Train Acc: 0.4676
 Site-Latino_Hispanic          | Train Loss: 1.2568 | Train Acc: 0.4964
 Site-Black                    | Train Loss: 1.4926 | Train Acc: 0.3885
 Site-Black                    | Train Loss: 1.3061 | Train Acc: 0.5180
 Site-East_Asian               | Train Loss: 1.2969 | Train Acc: 0.4460
 Site-East_Asian               | Train Loss: 1.1855 | Train Acc: 0.5588
 Site-Indian                   | Train Loss: 1.2502 | Train Acc: 0.5612
 Site-Indian                   | Train Loss: 1.2412 | Train Acc: 0.4964
 Site-Southeast_Asian          | Train Loss: 1.3276 | Train Acc: 0.4820
 Site-Southeast_Asian          | Train Loss: 1.2594 | Train Acc: 0.5204
 Site-Middle_Eastern           | Train Loss: 1.3344 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.1810 | Train Acc: 0.5252
 Site-White                     (1) | Val  Loss: 1.1992 | Val  Acc: 0.5543
 Site-White                     (2) | Val  Loss: 1.2012 | Val  Acc: 0.5288
 Site-Latino_Hispanic           (0) | Val  Loss: 1.2667 | Val  Acc: 0.5217
 Site-Latino_Hispanic           (0) | Val  Loss: 1.2996 | Val  Acc: 0.4784
 Site-Black                     (5) | Val  Loss: 1.1579 | Val  Acc: 0.6413
 Site-Black                     (3) | Val  Loss: 1.2592 | Val  Acc: 0.5827
 Site-East_Asian                (6) | Val  Loss: 1.0647 | Val  Acc: 0.6196
 Site-East_Asian                (2) | Val  Loss: 1.1969 | Val  Acc: 0.5432
 Site-Indian                    (0) | Val  Loss: 1.3290 | Val  Acc: 0.4348
 Site-Indian                    (0) | Val  Loss: 1.2516 | Val  Acc: 0.5108
 Site-Southeast_Asian           (0) | Val  Loss: 1.2108 | Val  Acc: 0.5978
 Site-Southeast_Asian           (0) | Val  Loss: 1.2094 | Val  Acc: 0.5647
 Site-Middle_Eastern            (4) | Val  Loss: 1.2760 | Val  Acc: 0.4783
 Site-Middle_Eastern            (4) | Val  Loss: 1.2514 | Val  Acc: 0.5036
Average Valid Accuracy: 0.5400
Aggregated Acc | Val Acc: 0.5633
 Best site-White                    (1)  | Epoch:46 | Val Acc: 0.5543
 Best site-White                    (2)  | Epoch:46 | Val Acc: 0.5288
 Best site-Latino_Hispanic          (0)  | Epoch:46 | Val Acc: 0.5217
 Best site-Latino_Hispanic          (0)  | Epoch:46 | Val Acc: 0.4784
 Best site-Black                    (5)  | Epoch:46 | Val Acc: 0.6413
 Best site-Black                    (3)  | Epoch:46 | Val Acc: 0.5827
 Best site-East_Asian               (6)  | Epoch:46 | Val Acc: 0.6196
 Best site-East_Asian               (2)  | Epoch:46 | Val Acc: 0.5432
 Best site-Indian                   (0)  | Epoch:46 | Val Acc: 0.4348
 Best site-Indian                   (0)  | Epoch:46 | Val Acc: 0.5108
 Best site-Southeast_Asian          (0)  | Epoch:46 | Val Acc: 0.5978
 Best site-Southeast_Asian          (0)  | Epoch:46 | Val Acc: 0.5647
 Best site-Middle_Eastern           (4)  | Epoch:46 | Val Acc: 0.4783
 Best site-Middle_Eastern           (4)  | Epoch:46 | Val Acc: 0.5036
 Test site-White                    | Epoch:46 | Test Acc: 0.4492
 Test site-Latino_Hispanic          | Epoch:46 | Test Acc: 0.3671
 Test site-Black                    | Epoch:46 | Test Acc: 0.3344
 Test site-East_Asian               | Epoch:46 | Test Acc: 0.5130
 Test site-Indian                   | Epoch:46 | Test Acc: 0.3565
 Test site-Southeast_Asian          | Epoch:46 | Test Acc: 0.4222
 Test site-Middle_Eastern           | Epoch:46 | Test Acc: 0.4278
Average Test Accuracy: 0.4100, domain std=0.0574, individual std=0.0574
Average Test Accuracy: 0.4100
============ Train epoch 47 ============
cnt=[1, 2, 1, 5, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3456 | Train Acc: 0.4748
 Site-White                    | Train Loss: 1.1814 | Train Acc: 0.5444
 Site-Latino_Hispanic          | Train Loss: 1.4705 | Train Acc: 0.4388
 Site-Latino_Hispanic          | Train Loss: 1.2398 | Train Acc: 0.4868
 Site-Black                    | Train Loss: 1.5322 | Train Acc: 0.4317
 Site-Black                    | Train Loss: 1.3097 | Train Acc: 0.5252
 Site-East_Asian               | Train Loss: 1.3420 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.2746 | Train Acc: 0.5252
 Site-Indian                   | Train Loss: 1.2542 | Train Acc: 0.4892
 Site-Indian                   | Train Loss: 1.2529 | Train Acc: 0.5228
 Site-Southeast_Asian          | Train Loss: 1.3320 | Train Acc: 0.4604
 Site-Southeast_Asian          | Train Loss: 1.2284 | Train Acc: 0.5468
 Site-Middle_Eastern           | Train Loss: 1.3274 | Train Acc: 0.4317
 Site-Middle_Eastern           | Train Loss: 1.1546 | Train Acc: 0.5396
 Site-White                     (3) | Val  Loss: 1.2098 | Val  Acc: 0.5326
 Site-White                     (1) | Val  Loss: 1.2045 | Val  Acc: 0.5504
 Site-Latino_Hispanic           (1) | Val  Loss: 1.2714 | Val  Acc: 0.5217
 Site-Latino_Hispanic           (3) | Val  Loss: 1.2479 | Val  Acc: 0.5036
 Site-Black                     (2) | Val  Loss: 1.1256 | Val  Acc: 0.6413
 Site-Black                     (4) | Val  Loss: 1.2665 | Val  Acc: 0.5683
 Site-East_Asian                (6) | Val  Loss: 1.0851 | Val  Acc: 0.5761
 Site-East_Asian                (6) | Val  Loss: 1.1723 | Val  Acc: 0.5612
 Site-Indian                    (3) | Val  Loss: 1.3289 | Val  Acc: 0.4674
 Site-Indian                    (3) | Val  Loss: 1.2864 | Val  Acc: 0.4892
 Site-Southeast_Asian           (0) | Val  Loss: 1.2333 | Val  Acc: 0.5326
 Site-Southeast_Asian           (6) | Val  Loss: 1.2584 | Val  Acc: 0.5576
 Site-Middle_Eastern            (5) | Val  Loss: 1.2844 | Val  Acc: 0.5109
 Site-Middle_Eastern            (3) | Val  Loss: 1.2511 | Val  Acc: 0.4964
Average Valid Accuracy: 0.5364
Aggregated Acc | Val Acc: 0.5503
 Test site-White                    | Epoch:46 | Test Acc: 0.4385
 Test site-Latino_Hispanic          | Epoch:46 | Test Acc: 0.3639
 Test site-Black                    | Epoch:46 | Test Acc: 0.3531
 Test site-East_Asian               | Epoch:46 | Test Acc: 0.5227
 Test site-Indian                   | Epoch:46 | Test Acc: 0.3493
 Test site-Southeast_Asian          | Epoch:46 | Test Acc: 0.4370
 Test site-Middle_Eastern           | Epoch:46 | Test Acc: 0.4253
Average Test Accuracy: 0.4128, domain std=0.0579, individual std=0.0579
Average Test Accuracy: 0.4128
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
============ Train epoch 48 ============
cnt=[3, 1, 2, 2, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3063 | Train Acc: 0.4676
 Site-White                    | Train Loss: 1.1462 | Train Acc: 0.5396
 Site-Latino_Hispanic          | Train Loss: 1.4698 | Train Acc: 0.4029
 Site-Latino_Hispanic          | Train Loss: 1.2590 | Train Acc: 0.4988
 Site-Black                    | Train Loss: 1.5218 | Train Acc: 0.4101
 Site-Black                    | Train Loss: 1.3366 | Train Acc: 0.5204
 Site-East_Asian               | Train Loss: 1.3278 | Train Acc: 0.4532
 Site-East_Asian               | Train Loss: 1.1907 | Train Acc: 0.5396
 Site-Indian                   | Train Loss: 1.2316 | Train Acc: 0.5180
 Site-Indian                   | Train Loss: 1.2526 | Train Acc: 0.5204
 Site-Southeast_Asian          | Train Loss: 1.3276 | Train Acc: 0.5180
 Site-Southeast_Asian          | Train Loss: 1.2234 | Train Acc: 0.5707
 Site-Middle_Eastern           | Train Loss: 1.3054 | Train Acc: 0.4532
 Site-Middle_Eastern           | Train Loss: 1.2051 | Train Acc: 0.5372
 Site-White                     (1) | Val  Loss: 1.1901 | Val  Acc: 0.5326
 Site-White                     (5) | Val  Loss: 1.1813 | Val  Acc: 0.5432
 Site-Latino_Hispanic           (2) | Val  Loss: 1.2853 | Val  Acc: 0.4783
 Site-Latino_Hispanic           (2) | Val  Loss: 1.2967 | Val  Acc: 0.4856
 Site-Black                     (0) | Val  Loss: 1.1095 | Val  Acc: 0.6522
 Site-Black                     (0) | Val  Loss: 1.2802 | Val  Acc: 0.5288
 Site-East_Asian                (4) | Val  Loss: 1.1416 | Val  Acc: 0.5000
 Site-East_Asian                (6) | Val  Loss: 1.1849 | Val  Acc: 0.5683
 Site-Indian                    (6) | Val  Loss: 1.2609 | Val  Acc: 0.5217
 Site-Indian                    (0) | Val  Loss: 1.2521 | Val  Acc: 0.5000
 Site-Southeast_Asian           (6) | Val  Loss: 1.2408 | Val  Acc: 0.4891
 Site-Southeast_Asian           (6) | Val  Loss: 1.2096 | Val  Acc: 0.5755
 Site-Middle_Eastern            (3) | Val  Loss: 1.3291 | Val  Acc: 0.5217
 Site-Middle_Eastern            (3) | Val  Loss: 1.2239 | Val  Acc: 0.5360
Average Valid Accuracy: 0.5309
Aggregated Acc | Val Acc: 0.5265
 Test site-White                    | Epoch:47 | Test Acc: 0.4492
 Test site-Latino_Hispanic          | Epoch:47 | Test Acc: 0.3671
 Test site-Black                    | Epoch:47 | Test Acc: 0.3438
 Test site-East_Asian               | Epoch:47 | Test Acc: 0.5065
 Test site-Indian                   | Epoch:47 | Test Acc: 0.3373
 Test site-Southeast_Asian          | Epoch:47 | Test Acc: 0.4296
 Test site-Middle_Eastern           | Epoch:47 | Test Acc: 0.4201
Average Test Accuracy: 0.4077, domain std=0.0571, individual std=0.0571
Average Test Accuracy: 0.4077
============ Train epoch 49 ============
cnt=[3, 3, 2, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.3058 | Train Acc: 0.5036
 Site-White                    | Train Loss: 1.1333 | Train Acc: 0.5492
 Site-Latino_Hispanic          | Train Loss: 1.5220 | Train Acc: 0.4245
 Site-Latino_Hispanic          | Train Loss: 1.2639 | Train Acc: 0.4916
 Site-Black                    | Train Loss: 1.5123 | Train Acc: 0.4173
 Site-Black                    | Train Loss: 1.3280 | Train Acc: 0.5084
 Site-East_Asian               | Train Loss: 1.2635 | Train Acc: 0.4317
 Site-East_Asian               | Train Loss: 1.2017 | Train Acc: 0.5324
 Site-Indian                   | Train Loss: 1.2270 | Train Acc: 0.5108
 Site-Indian                   | Train Loss: 1.2383 | Train Acc: 0.5180
 Site-Southeast_Asian          | Train Loss: 1.3628 | Train Acc: 0.4532
 Site-Southeast_Asian          | Train Loss: 1.2466 | Train Acc: 0.5492
 Site-Middle_Eastern           | Train Loss: 1.3109 | Train Acc: 0.4460
 Site-Middle_Eastern           | Train Loss: 1.1749 | Train Acc: 0.4988
 Site-White                     (0) | Val  Loss: 1.1286 | Val  Acc: 0.5870
 Site-White                     (5) | Val  Loss: 1.1950 | Val  Acc: 0.5612
 Site-Latino_Hispanic           (0) | Val  Loss: 1.2836 | Val  Acc: 0.5109
 Site-Latino_Hispanic           (0) | Val  Loss: 1.2562 | Val  Acc: 0.5108
 Site-Black                     (1) | Val  Loss: 1.1731 | Val  Acc: 0.5978
 Site-Black                     (4) | Val  Loss: 1.2684 | Val  Acc: 0.5504
 Site-East_Asian                (6) | Val  Loss: 1.0674 | Val  Acc: 0.5435
 Site-East_Asian                (3) | Val  Loss: 1.1979 | Val  Acc: 0.5396
 Site-Indian                    (1) | Val  Loss: 1.3120 | Val  Acc: 0.4348
 Site-Indian                    (1) | Val  Loss: 1.2439 | Val  Acc: 0.5324
 Site-Southeast_Asian           (3) | Val  Loss: 1.1907 | Val  Acc: 0.5652
 Site-Southeast_Asian           (3) | Val  Loss: 1.2278 | Val  Acc: 0.5468
 Site-Middle_Eastern            (2) | Val  Loss: 1.2792 | Val  Acc: 0.4783
 Site-Middle_Eastern            (2) | Val  Loss: 1.2500 | Val  Acc: 0.5216
Average Valid Accuracy: 0.5343
Aggregated Acc | Val Acc: 0.5376
 Test site-White                    | Epoch:47 | Test Acc: 0.4412
 Test site-Latino_Hispanic          | Epoch:47 | Test Acc: 0.3734
 Test site-Black                    | Epoch:47 | Test Acc: 0.3594
 Test site-East_Asian               | Epoch:47 | Test Acc: 0.5130
 Test site-Indian                   | Epoch:47 | Test Acc: 0.3421
 Test site-Southeast_Asian          | Epoch:47 | Test Acc: 0.4370
 Test site-Middle_Eastern           | Epoch:47 | Test Acc: 0.4278
Average Test Accuracy: 0.4134, domain std=0.0548, individual std=0.0548
Average Test Accuracy: 0.4134
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7/ccop_q=1...
 Test site-White                    | Epoch:49 | Test Acc: 0.4412
 Test site-Latino_Hispanic          | Epoch:49 | Test Acc: 0.3734
 Test site-Black                    | Epoch:49 | Test Acc: 0.3594
 Test site-East_Asian               | Epoch:49 | Test Acc: 0.5130
 Test site-Indian                   | Epoch:49 | Test Acc: 0.3421
 Test site-Southeast_Asian          | Epoch:49 | Test Acc: 0.4370
 Test site-Middle_Eastern           | Epoch:49 | Test Acc: 0.4278
Average Test Accuracy: 0.4134, domain std=0.0548, individual std=0.0548
===2023-05-25 06:55:34===
===2023-05-25 06:55:35===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
label set of clients: [9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
Loading snapshots...
 Test site-White                    | Epoch:49 | Test Acc: 0.4412
 Test site-Latino_Hispanic          | Epoch:49 | Test Acc: 0.3734
 Test site-Black                    | Epoch:49 | Test Acc: 0.3594
 Test site-East_Asian               | Epoch:49 | Test Acc: 0.5130
 Test site-Indian                   | Epoch:49 | Test Acc: 0.3421
 Test site-Southeast_Asian          | Epoch:49 | Test Acc: 0.4370
 Test site-Middle_Eastern           | Epoch:49 | Test Acc: 0.4278
Average Test Accuracy: 0.4134, domain std=0.0548, individual std=0.0548
